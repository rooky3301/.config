"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1290],{58188:(e,t,o)=>{o.d(t,{Lg:()=>u,N:()=>c,aG:()=>d});var n=o(13493),i=o(29369),s=o(82530),r=(o(77907),o(30806)),a=o(80444),l=o(14900);o(72711);function d(e){const{environment:t,currentSpaceViewStore:o,...n}=e,i=o.getModel();if(!i)return;const a=!i.showFeatureOnPersonalHome(e.feature);s.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{s.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:a}},transaction:t})}}),(0,r.cY)({environment:t,show:a,...n})}function c(e){let{environment:t,option:o,from:n,userAction:i}=e;const l=a.default.state.currentSpaceViewStore;if(!l)return!1;const d=l.getOnAppStartStore().getValue();return s.createAndCommit({userAction:i,environment:t,perform:e=>{s.applyOperation({store:l,operation:{pointer:l.pointer,path:["settings","on_app_start"],command:"set",args:o},transaction:e})}}),(0,r.BX)({environment:t,oldValue:d,newValue:o,from:n}),!0}function u(e){const{environment:t,selectedStore:o,currentSpaceViewStore:a,collectionContextStore:d}=e,c=d.collectionViewStore(),u=d.collectionStore(),p=d.collectionViewBlockStore();if(!(u&&c&&p&&a))return;const h=a.getTeamsStores(),g=o.table===i.e0?h.indexOf(o)+1:0,m=o.table===i.e0?o.id:void 0;s.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{s.applyOperation({store:c,operation:{pointer:{id:c.id,table:n.n},path:["format","collection_view_source","teamId"],command:"set",args:m},transaction:e}),l.mc({environment:t,collectionViewBlockStore:p,collectionViewStore:c,collectionStore:u,collectionContextStore:d,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}}),(0,r.Ay)({environment:t,teamId:m,index:g})}},55587:(e,t,o)=>{o.d(t,{j:()=>r});var n=o(89101),i=o(32441),s=o(69915);async function r(e){i.T3(e,{variant:"open_notion"}),i.eb(e,{target:"open_notion"}),await s.yF(e,{utmContent:"topbar_cta",nextRoute:n._j.root})}},28040:(e,t,o)=>{o.d(t,{i:()=>u});var n=o(26263),i=o(65958),s=o(21202),r=o(80444),a=o(77080),l=o(26136),d=o(35057),c=o(54642);async function u(e){const{environment:t,sudoModeStore:o,pageBlockId:u}=e,p=o.state.privatePageStore&&o.state.privatePageStore.id===u;if(t.device.isMobile||p||o.state.loading||o.state.error)return;if(!a.default.checkGate("enable_get_private_page_info_endpoint"))return;const{currentSpaceStore:h}=r.default.state,g=null==h?void 0:h.canAdmin();if(!(u&&g&&h&&(0,d.wP)()))return;o.setState({...o.state,loading:!0});const m=h.id,b=await c.getPrivatePageInfo(t,{id:u});if("failed"===b.type)return void o.setState({...o.state,loading:!1,error:b.error});const v=b.data,f=new n.Z({name:i.Gh});for(const n of v)switch(n.table){case"block":case"collection":f.setRecord({pointer:{spaceId:m,table:n.table,id:n.value.id},userId:t.currentUser.id},{role:"editor",value:n.value});break;case"team":f.setRecord({pointer:{spaceId:m,table:n.table,id:n.value.id},userId:t.currentUser.id},{role:"editor",value:n.value})}const S=new l.G(t,{table:s.iU,id:u},{inMemoryRecordCache:f});S.inMemoryRecordCache.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),o.setState({...o.state,privatePageStore:S,loading:!1,error:void 0})}},7476:(e,t,o)=>{o.d(t,{t:()=>r});var n=o(80444),i=o(56681),s=o(34047);function r(e){var t;let{discussionStore:o,commentStore:r}=e;if(!r.isDefined())return!1;const a=null===(t=n.default.state.currentUserStore)||void 0===t?void 0:t.id;const l=i.Z.state.lastInteractionTimes[o.id];if(r.getCreatedById()===a)return!1;const d=function(){if(!o.isDefined()||!a)return 0;const{pageVisitStore:e}=n.default.state,{lastViewTime:t,lastExitTime:i}=e.state;return i||t}();if(void 0===d)return!1;const c=(0,s.NI)(o).filter((e=>e.getCreatedById()===a)).reverse()[0],u=r.getCreatedTime();return!u||!(c&&u<c.getCreatedTime())&&(!(l&&u<l)&&u>d)}},39849:(e,t,o)=>{o.d(t,{N:()=>l,Z:()=>d});o(67294);var n=o(24405),i=o(8848),s=o(82990),r=o(85893);const a={display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,fontSize:10,textAlign:"center",fontWeight:s.Z.fontWeight.semibold,borderRadius:4,color:i.ZP.white,position:"static",marginLeft:6,WebkitFontSmoothing:"auto"};let l=function(e){return e[e.Red=0]="Red",e[e.Gray=1]="Gray",e}({});const d=function(e){let{count:t,color:o,style:i,numberStyle:s}=e;window.__c={n:"MentionsBadge"};const d=(0,n.Fg)(),u=o===l.Red;return!t||t<=0?null:(0,r.jsx)("div",{style:{...a,...i,...t>99&&{width:void 0,padding:2},background:u?d.redBadgeBackground:d.lightIconColor},children:(0,r.jsx)(c,{count:t,numberStyle:s})})};function c(e){let{count:t,numberStyle:o}=e;return t?1===t?(0,r.jsx)("span",{style:{marginLeft:-.5,...o},children:"1"}):t>99?(0,r.jsx)("span",{style:{letterSpacing:-.5,...o},children:"99+"}):t>9?(0,r.jsx)("span",{style:{letterSpacing:-.5,marginLeft:-.5,...o},children:t}):(0,r.jsx)("span",{style:{...o},children:t}):null}},22789:(e,t,o)=>{o.d(t,{Z:()=>j});o(67294);var n=o(83355),i=o(86628),s=o(24405),r=o(16184),a=o(47020),l=o(3123),d=o(58687),c=o(19889),u=o(7928),p=o(9291),h=o(50906),g=o(96802),m=o(82530),b=o(34700),v=o(92547),f=o(26136),S=o(64921),x=o(26388),y=o(85893);const w={width:16,marginRight:4};class M extends n.Z{constructor(){super(...arguments),this.storeTypes={lockStore:v.Z},this.handleLockClick=()=>{const{store:e}=this.props;m.createAndCommit({userAction:"PageLockTopbarIndicator.handleLockClick",environment:this.environment,perform:t=>{g.Wq({environment:this.environment,store:e,isLocked:!1,transaction:t})}}),this.stores.lockStore.setState({...this.stores.lockStore.state,justUnlocked:!0});const t=this.props.store.getType();if(t){var o;let n;e.isCollectionView()&&(n=e.getCollectionViewCollectionStore()),h.UJr(this.environment,{from:"topbar",block_type:t,locked:!1,collection_id:null===(o=n)||void 0===o?void 0:o.id})}},this.handleUnlockClick=()=>{const{store:e}=this.props;m.createAndCommit({userAction:"PageLockTopbarIndicator.handleUnlockClick",environment:this.environment,perform:t=>{g.Wq({environment:this.environment,store:e,isLocked:!0,transaction:t})}}),this.stores.lockStore.setState({...this.stores.lockStore.state,justUnlocked:!1});const t=this.props.store.getType();if(t){var o;let n;e.isCollectionView()&&(n=e.getCollectionViewCollectionStore()),h.UJr(this.environment,{from:"topbar",block_type:t,locked:!0,collection_id:null===(o=n)||void 0===o?void 0:o.id})}}}renderComponent(){return this.props.isMobile?this.renderMobile():this.renderDesktop()}renderDesktop(){return this.props.store.isLocked()?(0,y.jsx)(x.ZP,{renderTooltip:()=>(0,y.jsx)(C,{store:this.props.store}),disableTooltip:this.props.disableTooltip,render:e=>{return(0,y.jsxs)(S.Z,{style:(t=this.props.isMobile,o=this.environment,n=this.theme,i=this.props.isInlineCollection,s=this.props.buttonStyle,{...k(t,i,s),...(0,b.X)({noDrag:o.device.isElectronMac}),color:n.lightTextColor,fill:n.lightIconColor}),onClick:this.handleLockClick,...e,children:[(0,r.Q)(w),(0,y.jsx)("div",{style:{lineHeight:1},children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Locked",id:"pageLockIndicator.lockedButton.label"})})]});var t,o,n,i,s}}):this.stores.lockStore.state.justUnlocked?(0,y.jsxs)(S.Z,{style:(e=this.props.isMobile,t=this.environment,o=this.theme,n=this.props.isInlineCollection,i=this.props.buttonStyle,{...k(e,n,i),...(0,b.X)({noDrag:t.device.isElectronMac}),paddingLeft:5,border:`1px solid ${o.blueColor}`,color:o.blueColor,fill:o.blueColor}),onClick:this.handleUnlockClick,hoveredStyle:{background:this.theme.outlineBlueButtonHoveredBackground},pressedStyle:{background:this.theme.outlineBlueButtonPressedBackground},children:[(0,d.H)(w),(0,y.jsx)("div",{style:{lineHeight:1},children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Re-lock",id:"pageLockIndicator.relockButton.label"})})]}):void 0;var e,t,o,n,i}renderMobile(){const{WindowSizeStore:e}=this.environment;return this.props.store.isLocked()?(0,y.jsxs)(S.Z,{onClick:this.handleLockClick,mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:e.getSafePaddingLeftCSS(10),paddingRight:e.getSafePaddingRightCSS(14)},children:[(0,a.B)({width:20,marginRight:6}),(0,y.jsx)("div",{children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Locked",id:"pageLockIndicator.mobileLockedButton.label"})})]}):this.stores.lockStore.state.justUnlocked?(0,y.jsxs)(S.Z,{onClick:this.handleUnlockClick,mobileFeedback:!0,style:{display:"flex",alignItems:"center",width:"100%",height:"100%",paddingLeft:e.getSafePaddingLeftCSS(10),paddingRight:e.getSafePaddingRightCSS(14),color:this.theme.blueColor,fill:this.theme.blueColor},children:[(0,l.j)({height:26,width:32,marginRight:6}),(0,y.jsx)("div",{children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Re-lock",id:"pageLockIndicator.mobileRelockButton.label"})})]}):void 0}}M.displayName="PageLockTopbarIndicator";const j=M;function k(e,t,o){return{display:"flex",alignItems:"center",whiteSpace:"nowrap",fontSize:e?12:14,borderRadius:4,padding:"0 6px",marginRight:2,height:24,marginTop:e?1:0,marginLeft:e?0:-5,...t&&{marginLeft:e?8:12,marginRight:0},...o}}function C(e){let{store:t}=e;window.__c={n:"TooltipComponent"};const o=(0,s.Fg)(),n=(0,i.VK)((()=>t.getFormat().block_locked_by),[t]),r=(0,p.useIntl)(),a=(0,i.VK)((()=>n&&(0,u.Nz)(r,f.t1.createChildStore(t,{table:c.KJ,id:n}).getModel())),[n,r,t]);return n?(0,y.jsx)("div",{children:(0,y.jsx)(p.FormattedMessage,{defaultMessage:"Locked by {lockedByPerson}{br}to prevent accidental editing.{br}<prompttext>Click to unlock</prompttext>",id:"pageLockIndicator.lockedTooltip",values:{lockedByPerson:(0,y.jsx)("b",{children:a}),br:(0,y.jsx)("br",{}),prompttext:e=>(0,y.jsx)("span",{style:{color:o.mediumInvertedTextColor},children:e})}})}):null}},13612:(e,t,o)=>{o.d(t,{Z:()=>h});o(67294);var n=o(480),i=o(56666),s=o(90334),r=o(9291),a=o(50906),l=o(24677),d=o(77907),c=o(64921),u=o(31945),p=o(85893);const h=function(e){let{buttonPopupStore:t,useEllipsisIcon:o,store:i}=e;window.__c={n:"PublicTopbarMoreButton"};const s=(0,n.O7)(),{device:r}=s;return(0,p.jsx)(u.ZP,{popupType:r.isMobile?u.Z4.SlideUp:u.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,p.jsx)(m,{buttonPopupEvents:e,useEllipsisIcon:o}),onClick:()=>b(s),render:()=>(0,p.jsx)(d.LazyPublicTopbarMoreMenu,{block:i,onDismiss:()=>b(s)}),originGap:8})};function g(e){const{device:t}=e;return t.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",marginLeft:8,marginRight:8}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}function m(e){let{buttonPopupEvents:t,useEllipsisIcon:o}=e;window.__c={n:"OriginComponent"};const a=(0,r.useIntl)(),l=(0,n.O7)(),{device:d}=l;return(0,p.jsx)(c.Z,{ariaLabel:a.formatMessage({id:"publicTopbarMoreButton.ariaLabel",defaultMessage:"More actions"}),style:g(l),mobileFeedback:d.isMobile,...t,children:o?(0,s.O)({width:18,height:18}):(0,i.o)({width:18,height:18})})}function b(e){l.ZH(e),a.FjP(e)}},46457:(e,t,o)=>{o.d(t,{_:()=>h});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(9291),l=o(77907),d=o(34859),c=o(7184),u=o(53336),p=o(85893);function h(e){let{loginModalStore:t,loginStore:o,title:r,description:a,isSignup:d,disableLoginLink:u,redirectURL:h,className:v,onDismiss:f}=e;window.__c={n:"LoginModal"};const S=(0,i.O7)(),x=(0,s.VK)((()=>t.state.open),[t]),y=(0,n.useId)(),w=(0,n.useId)(),M={loginStore:o,title:r,description:a,isSignup:d,redirectURL:h,disableLoginLink:u,titleAriaId:y,descriptionAriaId:w};return(0,p.jsx)(c.c,{ariaLabelledBy:y,ariaDescribedBy:w,isOpen:x,onDismiss:()=>{b({loginModalStore:t,loginStore:o,onDismiss:f})},areaConstraint:{width:{min:480,max:480},height:{scroll:!0}},children:(0,p.jsx)(g,{children:(0,p.jsxs)("div",{className:v,children:[!S.device.isMobile&&(0,p.jsx)(m,{loginModalStore:t,loginStore:o,onDismiss:f}),(0,p.jsx)(l.LazyLoginModalContent,{...M})]})})})}function g(e){let{children:t}=e;window.__c={n:"MobileScroller"};return(0,i.O7)().device.isMobile?(0,p.jsx)(u.Z,{type:d.Z.Y,children:t}):t}function m(e){let{loginModalStore:t,loginStore:o,onDismiss:n}=e;window.__c={n:"CancelButton"};const i=(0,r.Fg)();return(0,p.jsx)("div",{style:{fontSize:14,color:i.mediumTextColor,position:"absolute",right:0,marginTop:16,marginRight:16,cursor:"pointer"},onClick:()=>{b({loginModalStore:t,loginStore:o,onDismiss:n})},children:(0,p.jsx)(a.FormattedMessage,{defaultMessage:"Cancel",id:"sidebarSwitcherMultiAccount.addAccountModal.cancelButton.label"})})}function b(e){const{loginModalStore:t,loginStore:o,onDismiss:n}=e;o.reset(),t.setState({open:!1}),n&&n()}},9045:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(9291),i=o(85893);function s(){return(0,i.jsx)(n.FormattedMessage,{id:"signupPage.title",defaultMessage:"Sign up"})}},92955:(e,t,o)=>{o.d(t,{Z:()=>l});o(67294);var n=o(86628),i=o(97880),s=o(19034),r=o(39849),a=o(85893);function l(e){window.__c={n:"UnreadMentionsBadge"};const{type:t,...o}=e,l=(0,n.VK)((()=>{switch(t){case"currentSpace":return s.Z.getUnreadCountForCurrentSpace().mentions;case"otherSpaces":return s.Z.getUnreadMentionsCountForOtherSpaces();case"allSpaces":return s.Z.getTotalUnreadMentionsCount();default:(0,i.t1)(t)}}),[t]);return(0,a.jsx)(r.Z,{count:l,...o})}},10388:(e,t,o)=>{o.d(t,{C:()=>Ke,nk:()=>Ve,ZP:()=>Ne});var n=o(67294),i=o(73935),s=o(83355),r=o(15145),a=o(88437),l=o(60651),d=o(25651),c=o(35840),u=o(45137),p=o(89101),h=o(21202),g=o(80503),m=o(9291),b=o(32441),v=o(47307),f=o(3297),S=o(99553),x=o(40277),y=o(69915),w=o(8055),M=o(87531),j=o(98104),k=o(3043),C=o(28020),T=o(43250),P=o(34700),I=o(84210),Z=o(12534),B=o(67669),_=o(17504),F=o(18514),E=o(95697),R=o(11540),L=o(77907),O=o(480),D=o(86628),U=o(24405),V=o(15560),A=o(32662),N=o(34541),K=o(61394),H=o(84920),G=o(42543),W=o(44332),z=o(51454);function q(e){return{...(0,P.X)({noDrag:e.device.isElectronMac}),height:"100%",flexGrow:0,marginRight:8,fontSize:14,minWidth:0}}function X(e){let{theme:t,isPhone:o,isFloatingPersonalHomeTopbar:n}=e;return{background:n&&!o?"transparent":t.contentBackground,maxWidth:"100vw",zIndex:z.lI,WebkitUserSelect:"none",userSelect:"none"}}function Y(e){let{environment:t,isShowingTabBar:o,shouldShowSidebar:n,isSidebarExpanded:i,isNotificationPanelOpen:s,isBrowserFullScreen:r,shouldRenderTemplateGalleryTopbar:a,isFloatingPersonalHomeTopbar:l}=e;const{device:d}=t,c=d.isElectronMac&&(!n||!i&&!s)&&!r&&!o;let u=g.R6(d.isElectronMac);return a?u=g.TT:l&&(u=g.Aj),{...(0,P.X)({drag:d.isElectronMac&&!o}),display:"flex",justifyContent:"space-between",alignItems:"center",overflow:"hidden",height:u,paddingLeft:c?73:d.isMobile?4:12,paddingRight:d.isMobile?4:10}}var Q=o(24646),$=o(61436),J=o(24042),ee=o(45325),te=o(69150),oe=o(94841),ne=o(64719),ie=o(85893);const se=function(e){window.__c={n:"PersonalHomeTopbar"};const t=(0,O.O7)(),o=(0,D.VK)((()=>te.Z.state.isHovered),[]),n=(0,D.VK)((()=>J.Z.state.isShowingTabBar),[]),i=(0,D.VK)((()=>ee.default.isOpen()),[]),s=(0,D.VK)((()=>$.Z.state.isFullScreen),[]),r=(0,D.VK)((()=>(0,Q.in)(t)),[t]),a=(0,D.VK)((()=>(0,C.h1)(t)),[t]),l=(0,D.VK)((()=>e.store.hasCover()),[e.store]),d=(0,D.VK)((()=>(0,E.QI)("dev_only")),[]),c=(0,U.yK)((e=>({container:{...Y({environment:t,isShowingTabBar:Boolean(n),shouldShowSidebar:a.shouldShowSidebar,isSidebarExpanded:r,isNotificationPanelOpen:i,isBrowserFullScreen:s,isFloatingPersonalHomeTopbar:d&&l}),...d&&l?{display:"flex",alignItems:"flex-start",paddingTop:12,opacity:o?1:0,transition:"opacity 0.2s ease"}:{}},divider:{flexGrow:1,flexShrink:1},betaBadgeWithoutCover:{background:e.home.betaBadge.background,color:e.home.betaBadge.color},betaBadgeWithCover:{position:"absolute",top:8,right:8,background:e.home.betaBadge.background,color:e.home.betaBadge.color,opacity:o?0:1,transition:"opacity 0.2s ease"}})),[a.shouldShowSidebar,t,l,s,d,o,i,n,r]);return(0,ie.jsx)(N.Z,{store:e.store,disableRectangularSelection:!0,disableEditNearestBlock:!0,render:()=>(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsxs)("div",{style:c.container,onClick:e.handleClickTopbar,onMouseDown:e.handleMouseDown,onDoubleClick:G.wq,onMouseEnter:()=>te.Z.setState({isHovered:!0}),onMouseLeave:()=>te.Z.setState({isHovered:!1}),children:[(0,ie.jsx)(re,{store:e.store,showSidebarButton:Boolean(e.showSidebarButton)}),!e.isInvalidPage&&(0,ie.jsx)(H.Z,{}),(0,ie.jsx)("div",{style:c.divider}),(0,ie.jsx)(ae,{store:e.store,showSidebarButton:Boolean(e.showSidebarButton),isInvalidPage:e.isInvalidPage})]}),d&&l&&(0,ie.jsx)("div",{onMouseEnter:()=>te.Z.setState({isHovered:!0}),style:{pointerEvents:"none"},children:(0,ie.jsx)(V.Z,{style:c.betaBadgeWithCover})})]})})};function re(e){window.__c={n:"LeftSideActionButtons"};const t=(0,O.O7)(),o=(0,O.Fy)(),n=(0,D.VK)((()=>e.store.hasCover()),[e.store]),i=(0,D.VK)((()=>(0,E.QI)("dev_only")),[]),s=(0,D.VK)((()=>J.Z.state.isShowingTabBar),[]),r=(0,D.VK)((()=>{const e=(0,Q.in)(t);return s&&e}),[t,s]),a=(0,U.yK)((e=>({noDragArea:{...(0,P.X)({noDrag:o.isElectronMac}),width:150,height:"100%"},electronButtonWrapper:{...(0,oe.Er)({theme:e,isPhone:o.isPhone,buttonState:"base",hasCover:n}),width:"fit-content",paddingLeft:2,paddingRight:2}})),[o,n]);return i&&n?o.isElectron?r?null:(0,ie.jsx)("div",{style:a.noDragArea,children:(0,ie.jsxs)("div",{style:a.electronButtonWrapper,children:[e.showSidebarButton&&(0,ie.jsx)(W.Z,{}),!s&&(0,ie.jsx)(K.Z,{})]})}):(0,ie.jsx)(ie.Fragment,{children:e.showSidebarButton&&(0,ie.jsx)(W.Z,{isFloatingButton:!0})}):(0,ie.jsxs)(ie.Fragment,{children:[e.showSidebarButton&&(0,ie.jsx)(W.Z,{}),o.isElectron&&!s&&(0,ie.jsx)(K.Z,{})]})}function ae(e){window.__c={n:"RightSideActionButtons"};const t=(0,O.Fy)(),o=(0,D.VK)((()=>e.store.hasCover()),[e.store]),n=(0,D.VK)((()=>(0,E.QI)("dev_only")),[]),i=(0,U.yK)((e=>({noDragArea:{...(0,P.X)({noDrag:t.isElectronMac}),width:150,height:"100%",display:"flex",justifyContent:"flex-end"},betaBadgeWithoutCover:{background:e.home.betaBadge.background,color:e.home.betaBadge.color}})),[t.isElectronMac]);return n&&o?t.isElectron?(0,ie.jsx)("div",{style:i.noDragArea,children:(0,ie.jsx)(ne.E,{store:e.store,isInvalidPage:e.isInvalidPage})}):(0,ie.jsx)(ne.E,{store:e.store,isInvalidPage:e.isInvalidPage}):(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(V.Z,{style:i.betaBadgeWithoutCover}),(0,ie.jsx)(A.Z,{size:4}),(0,ie.jsx)(ne.E,{store:e.store,isInvalidPage:e.isInvalidPage})]})}var le=o(51),de=o(80444),ce=o(96071),ue=o(85974),pe=o(83212),he=o(26136),ge=o(52258),me=o(66708),be=o(63296),ve=o(89728),fe=o(26388),Se=o(46457),xe=o(9045),ye=o(22789),we=o(13612),Me=o(58178),je=o(25729),ke=o(55587),Ce=o(95477),Te=o(93827),Pe=o(38676),Ie=o(42922),Ze=o(16354),Be=o(5002);function _e(e){window.__c={n:"TemplateGalleryPublicPageTopbar"};const{blockStore:t,style:o,onDoubleClick:i,onClickDuplicate:s,templateBlockStore:r}=e,a=(0,O.O7)(),d=(0,D.VK)((()=>le.Z.state.publicPageData),[]),c=(0,D.VK)((()=>(0,B.S4)(r)),[r]),[u,p]=(0,n.useState)(!1),h=(0,U.yK)((e=>({topbarContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",overflow:"hidden",height:g.TT,paddingLeft:12,paddingRight:10},topbarContents:{display:"flex",alignItems:"center"},notionLogoStyle:{width:20,height:20},templatesIcon:{width:20,height:20,marginRight:4,marginTop:2},templateGalleryButton:{display:"flex",alignItems:"center",fontSize:15,fontWeight:600},centerText:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",overflow:"hidden",textWrap:"nowrap"},templateNameText:{fontSize:13.5,fontWeight:600},templateCreatorText:{fontSize:12,color:e.lightTextColor},templateCreatorLink:{fontSize:12,color:e.lightTextColor,cursor:"pointer"},publicTopbarMoreButton:{marginRight:8}})),[]),v=(0,D.VK)((()=>{const e=(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(ve.Z,{onClick:async()=>{await ke.j(a)},children:(0,l.h)(h.notionLogoStyle)}),(0,ie.jsx)(Be.Z,{})]});return(0,Te.C)()?Pe.sidebarExpandedStore.state?null:(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(W.Z,{}),e]}):e}),[a,h.notionLogoStyle]);if(!d||!d.template)return(0,ie.jsx)(ie.Fragment,{});const f=(0,ie.jsx)("a",{href:`${Ce.default.domainBaseUrl}/@${d.template.creator.username}`,target:"_blank",style:h.templateCreatorLink,onClick:()=>{var e;b.eb(a,{target:"creator",slug:null===(e=d.template)||void 0===e?void 0:e.creator.username})},children:d.template.creator.name});return(0,ie.jsxs)("div",{style:o??h.topbarContainer,onDoubleClick:i,children:[(0,ie.jsxs)("div",{style:h.topbarContents,children:[v,(0,ie.jsx)(Ze.Z,{href:(0,F.UY)("templateGallery"),external:!0,children:(0,ie.jsxs)(ve.Z,{style:h.templateGalleryButton,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onClick:()=>{b.eb(a,{target:"gallery"})},children:[u?(0,je.U)(h.templatesIcon):(0,Me.s)(h.templatesIcon),(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Templates",id:"templateGalleryPublicPageTopbar.templatesButton.label"})]})})]}),(0,ie.jsxs)("div",{style:h.centerText,children:[(0,ie.jsx)(Ze.Z,{href:`${(0,F.UY)("templateGallery")}/${d.template.slug}`,style:h.templateNameText,external:!0,onClick:()=>{var e;b.eb(a,{target:"template",slug:null===(e=d.template)||void 0===e?void 0:e.slug})},children:d.template.name}),(0,ie.jsx)("div",{style:h.templateCreatorText,children:(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Template by {templateCreatorNameWithLink}",id:"templateGalleryPublicPageTopbar.templateName.subtitle",values:{templateCreatorNameWithLink:f}})})]}),(0,ie.jsxs)("div",{style:h.topbarContents,children:[(0,ie.jsx)("div",{style:h.publicTopbarMoreButton,children:(0,ie.jsx)(we.Z,{store:t,buttonPopupStore:ge.Z})}),c&&(0,ie.jsx)(Ie.Z,{onClick:s,children:(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Start with this template",id:"templateGalleryPublicPageTopbar.duplicateButton.label"})})]})]})}var Fe=o(61881),Ee=o(7715);const Re={width:18,height:18,marginRight:6},Le={width:14,height:14,marginRight:6},Oe={width:14,height:14},De={width:15,height:15},Ue={width:14,height:14,marginLeft:6},Ve=700;class Ae extends s.Z{constructor(){super(...arguments),this.startedInitialPublicPageEdit=!1,this.screenXAtLastMouseDown=0,this.screenYAtLastMouseDown=0,this.storeTypes={loginModalStore:ce.Z,loginStore:ue.Z},this.handleMouseDown=()=>{this.screenXAtLastMouseDown=window.screenX,this.screenYAtLastMouseDown=window.screenY},this.handleClickTopbar=e=>{const t=window.screenX,o=window.screenY;this.screenXAtLastMouseDown===t&&this.screenYAtLastMouseDown===o&&(e.target===e.currentTarget&&j.ZH(this.environment),(0,Z.ZP)({event:e,context:Z.Af.EditorClick,callback:()=>{S.E5(this.environment)}}))},this.maybeOpenOnBaseUrl=()=>{var e;const{RouterStore:t}=this.environment,o=t.state.route,n=null===(e=this.pageContext)||void 0===e?void 0:e.pageStore;if("page"===o.name&&o.requestedOnPublicDomain&&n){const e=(0,I.ZP)({store:n,preferPublicLink:!1,pageVisitSource:r.tY.EditPublicPage});return w.Li({environment:this.environment,url:e}),!0}return!1},this.handleStartPublicEdit=()=>{this.maybeOpenOnBaseUrl()||(this.environment.currentUser.isLoggedIn()?v.showDialog({showCancel:!0,keepFocus:!1,message:(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"topbar.startPublicEditDialog.message"}),items:[{label:(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Continue",id:"topbar.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){pe.Z.setState({editing:!0,commenting:!0})}}]}):(x.Hr({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),w.Li({environment:this.environment,url:p._j.login})))},this.handleAttemptPublicComment=()=>{x.Hr({currentUserId:this.environment.currentUser.id,blockId:this.props.store.id}),this.maybeOpenOnBaseUrl()||w.Li({environment:this.environment,url:p._j.login})},this.forkPageRef=null,this.handleForkPageRef=e=>{this.forkPageRef=e},this.handleOpenForkPage=()=>{f.S({environment:this.environment,store:this.props.store,originRect:this.getDuplicateClientRect()})},this.shouldRenderTemplateGalleryTopbar=this.createComputedStore((()=>{const{device:e}=this.environment;if(e.isMobile||!(0,F.Sr)())return!1;if(!G.cE(this.props.store,this.environment))return!1;const{publicPageData:t}=le.Z.state;return!(null==t||!t.template)})),this.appRenderState=this.createComputedStore((()=>C.h1(this.environment))),this.isNotificationPanelOpen=this.createComputedStore((()=>ee.default.isOpen())),this.isBrowserFullScreen=this.createComputedStore((()=>$.Z.state.isFullScreen)),this.isSidebarExpanded=this.createComputedStore((()=>(0,Q.in)(this.environment))),this.isFloatingPersonalHomeTopbar=this.createComputedStore((()=>{const e=(0,oe.WE)(this.props.store),t=(0,E.QI)("dev_only"),o=this.props.store.hasCover();return e&&t&&o}))}didUpdate(){const{store:e}=this.props,{RouterStore:t}=this.environment,o=t.state.route,{publicPageData:n}=le.Z.state;G.DK(this.props.store,this.environment)&&e.canComment()&&!e.canEdit()&&"page"===o.name&&!o.requestedOnPublicDomain&&G.cE(this.props.store,this.environment)&&null!=n&&n.requireLogin?pe.Z.setState({commenting:!0,editing:!1}):!G.DK(this.props.store,this.environment)||!e.canEdit()||"page"!==o.name||pe.Z.state.editing||pe.Z.state.commenting||o.shouldDuplicate||o.requestedOnPublicDomain||!G.cE(this.props.store,this.environment)||this.startedInitialPublicPageEdit||null==n||!n.requireLogin||(this.startedInitialPublicPageEdit=!0,this.handleStartPublicEdit())}renderComponent(){const e=this.pickSidebar();return(0,_.Z)((t=>(0,ie.jsxs)("header",{style:X({theme:this.theme,isPhone:this.environment.device.isPhone,isFloatingPersonalHomeTopbar:this.isFloatingPersonalHomeTopbar.state}),...t,children:[(0,ie.jsx)("div",{style:this.getStyle(),className:T.lIT,onFocus:G.Iw,onBlur:G.u1,children:e}),(0,ie.jsx)(L.LazyBannersRenderer,{banners:this.props.banners,isMobile:!1,isInPeekRenderer:!1})]})))}pickSidebar(){const e=(0,oe.WE)(this.props.store);return G.DK(this.props.store,this.environment)?G.cE(this.props.store,this.environment)?this.shouldRenderTemplateGalleryTopbar.state?this.renderTemplateGalleryPublicPageTopbar():this.renderPublicPageTopbar():e?(0,ie.jsx)(se,{store:this.props.store,isInvalidPage:this.props.isInvalidPage,showSidebarButton:this.props.showSidebarButton,handleClickTopbar:this.handleClickTopbar,handleMouseDown:this.handleMouseDown}):this.renderDefaultTopbar():null}renderPublicPageTopbar(){const{store:e,isInvalidPage:t,isElectron:o}=this.props,{isShowingTabBar:n}=J.Z.state,i=Boolean(this.environment.currentUser.isLoggedIn()||this.environment.publicDomainUserId)?"control":(0,R.R)();return(0,ie.jsxs)("div",{style:Y({environment:this.environment,isShowingTabBar:Boolean(n),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state}),onDoubleClick:G.wq,children:[(0,ie.jsx)(Se._,{loginModalStore:this.stores.loginModalStore,loginStore:this.stores.loginStore,title:(0,ie.jsx)(xe.Z,{}),isSignup:!0}),o&&!n&&(0,ie.jsx)(K.Z,{}),!t&&(0,ie.jsx)(k.l2,{store:e,style:q(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),(0,ie.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),"control"===i?this.renderTopbarRightSectionDefault():this.renderTopbarRightSectionExp({experimentGroup:i})]})}renderTopbarRightSectionDefault(){const{device:e,currentUser:t}=this.environment,{store:o,isInvalidPage:n}=this.props,i=Boolean(t.isLoggedIn()||this.environment.publicDomainUserId);return(0,ie.jsxs)(ie.Fragment,{children:[o.canEdit()&&!pe.Z.state.editing&&(0,ie.jsxs)(be.Z,{onClick:this.handleStartPublicEdit,style:{marginRight:8,padding:"0 8px"},children:[(0,d.R)(Le),(0,ie.jsx)(m.FormattedMessage,{id:"topbar.publicPage.edit",defaultMessage:"Edit"})]}),!this.environment.currentUser.isLoggedIn()&&o.canComment()&&!o.canEdit()&&(0,ie.jsxs)(be.Z,{onClick:this.handleAttemptPublicComment,style:{marginRight:8,padding:"0 8px"},children:[(0,u.o)(Le),(0,ie.jsx)(m.FormattedMessage,{id:"topbar.publicPage.comment",defaultMessage:"Comment"})]}),(0,ie.jsxs)(ve.Z,{onClick:()=>He(this.environment),children:[(0,c.R)(Le),(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Search",id:"topbar.publicPage.searchButton.label"})]}),(0,B.S4)(this.props.store)&&(0,ie.jsx)(ve.Z,{onClick:this.handleOpenForkPage,ref:this.handleForkPageRef,children:(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Duplicate",id:"topbar.publicPage.duplicateButton.label"})}),!e.isMobile&&!n&&(0,ie.jsx)(we.Z,{store:o,buttonPopupStore:ge.Z}),(0,ie.jsx)("div",{style:(s=this.theme,{flex:"none",width:1,height:16,marginLeft:8,marginRight:8,background:s.darkDividerColor})}),i?(0,ie.jsxs)(ve.Z,{onClick:()=>async function(e){b.T3(e,{variant:"open_notion"}),await y.yF(e,{utmContent:"topbar_cta",nextRoute:p._j.root})}(this.environment),children:[(0,l.h)(Re),(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Open Notion",id:"topbar.publicPage.cta.label.open"})]}):(0,ie.jsxs)(ve.Z,{onClick:()=>async function(e){b.T3(e,{variant:"try_notion"}),await y.yF(e,{utmContent:"topbar_cta",nextRoute:p._j.signup})}(this.environment),children:[(0,l.h)(Re),(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Try Notion",id:"topbar.publicPage.cta.label.try"})]})]});var s}renderTopbarRightSectionExp(e){let{experimentGroup:t}=e;const{device:o}=this.environment,{store:n,isInvalidPage:i}=this.props,s="on_marketing"===t?()=>async function(e){await G.i3({environment:e,route:p._j.product})}(this.environment):()=>async function(e){await G.i3({environment:e,route:p._j.signup})}(this.environment);return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(ve.Z,{onClick:()=>He(this.environment),children:(0,c.R)(Oe)}),(0,B.S4)(n)&&this.renderPublicPageTopbarExpDuplicateIconButton(),!o.isMobile&&!i&&(0,ie.jsx)(we.Z,{store:n,buttonPopupStore:ge.Z,useEllipsisIcon:!0}),(0,ie.jsx)(Ke,{onClick:s})]})}renderTemplateGalleryPublicPageTopbar(){var e;const{store:t,isInvalidPage:o}=this.props,{isShowingTabBar:n}=J.Z.state,{publicPageData:i}=le.Z.state,s=null!=i&&null!==(e=i.template)&&void 0!==e&&e.blockId?new he.G(this.environment,{table:h.iU,id:null==i?void 0:i.template.blockId}):void 0;return s?(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(_e,{blockStore:t,style:{...Y({environment:this.environment,isShowingTabBar:Boolean(n),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state}),borderBottom:`1px solid ${this.theme.lightDividerColor}`},onDoubleClick:G.wq,onClickDuplicate:()=>{f.S({environment:this.environment,store:s,originRect:this.getDuplicateClientRect()})},templateBlockStore:s}),(0,ie.jsxs)("div",{style:Y({environment:this.environment,isShowingTabBar:Boolean(n),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state}),onDoubleClick:G.wq,children:[!o&&(0,ie.jsx)(k.l2,{store:t,style:q(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),(0,ie.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),(0,ie.jsxs)(ve.Z,{onClick:()=>He(this.environment),children:[(0,c.R)(Le),(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Search",id:"topbar.publicPage.searchButton.label"})]})]})]}):this.renderPublicPageTopbar()}renderDefaultTopbar(){const{store:e,isInvalidPage:t,isElectron:o,showSidebarButton:n,collectionViewStore:i,hideActionButtons:s}=this.props,{isMobile:r}=this.environment.device,{pageVisitStore:a,presenceStore:l,currentSpaceStore:d,currentSpaceViewStore:c}=de.default.state,u=(0,B.IJ)(this.environment,this.props.store),{isShowingTabBar:p}=J.Z.state;return(0,ie.jsx)(N.Z,{store:e,disableRectangularSelection:!0,disableEditNearestBlock:!0,render:()=>(0,ie.jsxs)("div",{style:Y({environment:this.environment,isShowingTabBar:Boolean(p),shouldShowSidebar:this.appRenderState.state.shouldShowSidebar,isSidebarExpanded:this.isSidebarExpanded.state,isNotificationPanelOpen:this.isNotificationPanelOpen.state,isBrowserFullScreen:this.isBrowserFullScreen.state,shouldRenderTemplateGalleryTopbar:this.shouldRenderTemplateGalleryTopbar.state}),onClick:this.handleClickTopbar,onMouseDown:this.handleMouseDown,onDoubleClick:G.wq,children:[n&&(0,ie.jsx)(W.Z,{}),o&&!p&&(0,ie.jsx)(K.Z,{}),!t&&(0,ie.jsx)(k.l2,{store:e,style:q(this.environment),maxAncestorCount:2,ancestorMaxWidth:160,currentPageMaxWidth:240,showCurrentPageControls:!0,isMobile:!1}),e.canEditCollection()&&(0,ie.jsx)(ye.Z,{store:e,isMobile:!1},e.id),e.isRestricted()&&(0,ie.jsx)(Ee.Z,{style:{...(0,P.X)({noDrag:this.environment.device.isElectronMac}),marginRight:10},onClick:()=>{me.Z.setState({open:!0})}}),!t&&(0,ie.jsx)(H.Z,{}),(0,ie.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),!r&&!u&&!s&&(0,ie.jsx)(Fe.iY,{store:e,collectionViewStore:i,spaceStore:d,spaceViewStore:c,pageVisitStore:a,presenceStore:l,isInvalidPage:t})]})})}getDuplicateClientRect(){if(this.forkPageRef){const e=i.findDOMNode(this.forkPageRef);if(e instanceof Element)return e.getBoundingClientRect()}}getStyle(){let e=g.R6(this.environment.device.isElectronMac);return this.shouldRenderTemplateGalleryTopbar.state?e=2*g.TT:this.isFloatingPersonalHomeTopbar.state&&(e=g.Aj),{width:"100%",maxWidth:"100vw",height:e,opacity:C.tu.state?0:1,transition:`\n \t\t\t\topacity ${Ve}ms,\n \t\t\t\tcolor ${Ve}ms\n\t\t\t`,position:"relative"}}renderPublicPageTopbarExpDuplicateIconButton(){return(0,ie.jsx)(fe.ZP,{renderTooltip:()=>(0,ie.jsx)("div",{style:{display:"flex"},children:(0,ie.jsx)(m.FormattedMessage,{id:"topbar.publicPage.duplicateButton.tooltip",defaultMessage:"Duplicate"})}),placement:fe.ug.Bottom,alignment:fe.v2.Center,originGap:6,render:e=>(0,ie.jsx)(ve.Z,{onClick:this.handleOpenForkPage,ref:this.handleForkPageRef,...e,children:(0,a.a)(De)})})}}Ae.displayName="Topbar";const Ne=Ae;function Ke(e){return(0,ie.jsxs)(be.Z,{style:{padding:"0 10px",marginLeft:8},onClick:e.onClick,children:[(0,ie.jsx)(m.FormattedMessage,{defaultMessage:"Built with",id:"topbar.publicPage.cta.label.builtWithNotion"}),(0,l.h)(Ue)]})}function He(e){M.UT({environment:e,analyticsFrom:"public-page-topbar",isPublicPageSearch:!0})}},61881:(e,t,o)=>{o.d(t,{iY:()=>z,UP:()=>q,W2:()=>X});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(7525),l=o(80503),d=o(51454),c=o(9291),u=o(92650),p=o(95477),h=o(28651),g=o(28020),m=o(43250),b=o(81170),v=o(74948),f=o(24646),S=o(36391),x=o(21273),y=o(77080),w=o(61766);const M=new w.Z,j=new w.Z;var k=o(52258),C=o(66708),T=o(77503),P=o(34700),I=o(16402),Z=o(16011),B=o(26388),_=o(85893);function F(e){window.__c={n:"PageFreshnessMetadata"};const{store:t,isExpanded:o,isWindowSmall:i,isElectronMac:a}=e,l=(0,r.Fg)(),d=(0,s.VK)((()=>t.getLastEditedTime()),[t]),[u,p]=(0,n.useState)("flex"),[h,g]=(0,n.useState)(1);(0,n.useEffect)((()=>{let e;return o||i?o?(g(0),p("none")):(g(0),e=setTimeout((()=>p("none")),150)):(p("flex"),e=setTimeout((()=>g(1)),150)),()=>clearTimeout(e)}),[o,i]);const m=d?(0,I.IS)(d,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0}):"";return m?(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("span",{style:{opacity:h,transition:"opacity 150ms linear",display:u,alignItems:"center",fontSize:14,color:l.lightTextColor,height:28,whiteSpace:"nowrap",lineHeight:1.2},children:(0,_.jsx)("div",{style:{display:"flex",flexFlow:"wrap"},children:(0,_.jsx)(B.ZP,{placement:B.ug.Bottom,alignment:B.v2.Start,renderTooltip:()=>(0,_.jsx)(Z.Z,{store:t,compactFormat:!0}),render:e=>{return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{...e,style:{...(0,P.X)({noDrag:a})},children:(t=m,(0,_.jsx)(c.FormattedMessage,{defaultMessage:"Edited {timestamp}",id:"pagePropertiesHeader.edited.label",values:{timestamp:t}}))})});var t}})})})}):null}var E=o(10388),R=o(11751),L=o(41747),O=o(73063),D=o(28311);function U(e){let{blockStore:t,spaceStore:o,buttonPopupStore:a}=e;window.__c={n:"TopbarAiContextButton"};const l=(0,i.O7)(),d=(0,s.VK)((()=>L.Z.getUnreadAIContext()),[]),c=(0,n.useCallback)((()=>{(0,v.handleSidebarButtonClick)(l,t,S.gY.AiContext,"topbar"),L.Z.setUnreadAIContext(!1)}),[l,t]),u=function(){const{isElectronMac:e}=(0,i.O7)().device;return(0,r.yK)((t=>({icon:{height:18,width:18,fill:t.regularIconColor},button:{...(0,P.X)({noDrag:e}),width:33,height:28,marginRight:2},buttonWrapper:{...(0,P.X)({noDrag:e}),position:"relative"}})),[e])}();return(0,_.jsx)(B.ZP,{placement:B.ug.Bottom,renderTooltip:()=>"AI Context [ai_team]",render:e=>(0,_.jsxs)("div",{style:u.buttonWrapper,children:[(0,_.jsx)(O.Z,{icon:R.t,iconStyle:u.icon,style:u.button,ariaLabel:"AI Context [ai_team]",onClick:c,...e}),d&&(0,_.jsx)(D.I,{})]})})}var V=o(24097),A=o(43377),N=o(72485),K=o(86467),H=o(82774),G=o(22165),W=o(94107);function z(e){window.__c={n:"TopbarActionButtons"};const t=(0,i.O7)(),{device:o}=t,p=(0,c.useIntl)(),{store:w,spaceStore:P,pageVisitStore:I,presenceStore:Z,collectionViewStore:B,spaceViewStore:R}=e,L=(0,s.VK)((()=>w.canEdit()),[w]),[O,z]=(0,s.AF)(void 0,h.Z),[Y,Q]=(0,n.useState)(!1),[$]=(0,s.AF)(S.ZP),J=(0,s.VK)((()=>g.qG(w.id)),[w]),ee=(0,s.VK)((()=>X({canEditPage:L,device:o})&&!J),[L,o,J]),te=(0,s.VK)((()=>Boolean(P&&!P.canEdit())),[P]),oe=(0,s.VK)((()=>(0,f.Sx)(t)),[t]),ne=(0,s.VK)((()=>(0,u.ui)(t,!1)<1150),[t]),ie=(0,s.VK)((()=>q({isSpaceGuest:te,canEditPage:L})&&!J),[L,J,te]);(0,n.useEffect)((()=>{Q(!oe)}),[oe]);const{canShowUpdateSidebarUnexpander:se,shouldShowUpdateSidebarUnexpander:re}=(0,s.VK)((()=>{const e=!Y&&oe&&!(0,f._c)(t);return{canShowUpdateSidebarUnexpander:e,shouldShowUpdateSidebarUnexpander:e&&($.mouseEntered||O.mouseEntered)}}),[Y,oe,t,O,$]),[ae]=(0,s.AF)(S.ZP),le=(0,s.Kw)(g.tu),de=(0,s.VK)((()=>!o.isMobile&&!J&&(!w.isCollectionView()||w.isCollectionViewPageWithContent())),[o.isMobile,J,w]),ce=(0,s.VK)((()=>x.Z.isContextEnabled()),[]),ue=(0,s.VK)((()=>!o.isMobile&&!J),[o.isMobile,J]),pe=(0,s.VK)((()=>y.default.checkGate("show_topbar_layout_info_button")),[]),he=(0,r.yK)((()=>({actionButtonsWrapStyle:{flexGrow:0,flexShrink:0,display:"flex",alignItems:"center",paddingRight:o.isMobile?4:0,paddingLeft:o.isMobile?4:12,width:se?ae.width:void 0,justifyContent:"space-between",zIndex:d.A_,height:l.R6(t.device.isElectronMac),opacity:le?0:1,transition:`\n\t\t\t\t\topacity ${E.nk}ms,\n\t\t\t\t\tcolor ${E.nk}ms\n\t\t\t\t`},rightButtonsContainer:{display:"flex"}})),[se,o,ae,t,le]);if(e.isInvalidPage)return null;const ge=o.isElectronMac&&le||!se||!o.isElectron&&!re||$.isAnimating;return(0,_.jsxs)("div",{style:he.actionButtonsWrapStyle,onMouseMove:()=>{z({...O,mouseEntered:!0})},onMouseLeave:()=>{z({...O,mouseEntered:!1})},className:m.A_D,children:[ge?(0,_.jsx)("div",{}):(0,_.jsx)("div",{className:m.JiD,children:(0,_.jsx)(G.C,{shouldHide:ge,icon:a.t,caption:p.formatMessage({defaultMessage:"Close sidebar",id:"updateSidebarUnexpandButton.closeSidebar.tooltip"}),onClick:()=>{Q(!0),v.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"})},keyboardShortcutName:"toggleUpdateSidebar",isElectron:o.isElectron})}),(0,_.jsxs)("div",{style:he.rightButtonsContainer,children:[!J&&(0,_.jsx)(F,{store:w,isExpanded:oe,isWindowSmall:ne,isElectronMac:o.isElectronMac}),L&&I&&Z&&(0,_.jsx)(K.Z,{rootStore:w,pageVisitStore:I,presenceStore:Z,maxUsers:$.expanded?3:void 0}),ie&&(0,_.jsx)(H.Z,{store:w,buttonPopupStore:C.Z}),ce&&w&&P&&(0,_.jsx)(U,{blockStore:w,spaceStore:P,buttonPopupStore:M}),de&&(0,_.jsx)(D.Z,{blockStore:w,spaceStore:P,buttonPopupStore:j}),ee&&(0,_.jsx)(W.Z,{blockStore:w,spaceStore:P,buttonPopupStore:T.Z}),pe&&(0,_.jsx)(A.b,{blockStore:w}),(0,_.jsx)(V.Z,{store:w,spaceViewStore:R}),J&&(0,_.jsx)(b.Z,{}),ue&&(0,_.jsx)(N.Z,{store:w,collectionViewStore:B,buttonPopupStore:k.Z})]})]})}function q(e){const{canEditPage:t,isSpaceGuest:o}=e;return!!p.default.isAdminMode||(!o||t)}function X(e){const{canEditPage:t,device:o}=e;return!!p.default.isAdminMode||!!t&&!o.isPhone}},61394:(e,t,o)=>{o.d(t,{Z:()=>P});var n=o(67294),i=o(480),s=o(86628),r=o(1464),a=o(81270),l=o(10020),d=o(12392),c=o(13530),u=o(73361),p=o(9291),h=o(50906),g=o(47839),m=o(8055),b=o(24098),v=o(34700),f=o(18514),S=o(24042),x=o(88923),y=o(64921),w=o(73063),M=o(58261),j=o(53437),k=o(26388),C=o(85893);const T={position:"relative",display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:32};const P=function(e){let{supportsNativeHomeTabPhone:t}=e;return window.__c={n:"TopbarBrowserButtons"},(0,i.O7)().device.isMobile?(0,C.jsx)(O,{supportsNativeHomeTabPhone:t}):(0,C.jsx)(U,{supportsNativeHomeTabPhone:t})};function I(){g.openInNewTab({url:"",makeTabActive:!0,position:"start"})}function Z(){window.__c={n:"NewTabButtonComponent"};const e=(0,i.Fy)();return(0,s.VK)((()=>S.Z.state.isTabsFeatureEnabled),[])?(0,C.jsx)(k.ZP,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButton.newTabButton.label",defaultMessage:"New tab"}),(0,C.jsx)(M.Z,{name:"newTab",style:{opacity:.5,marginLeft:4}})]}),placement:k.ug.Bottom,alignment:k.v2.Center,originGap:6,render:t=>(0,C.jsx)(w.Z,{icon:e=>(0,u.K)({...e,width:"24px",height:"24px"}),isDarkIconColor:!0,className:"notion-new-tab-button",style:{position:"relative",...(0,v.X)({noDrag:e.isElectronMac})},onClick:I,...t})}):null}function B(e){h.MEX(e,{type:"forward"}),m.eH()}function _(e,t){const{mobileNative:o}=e;h.MEX(e,{type:"back"}),f.__(e)?m.op(e):t&&!f.NW(e)?null==o||o.showNativeHomeTab():m.op(e)}function F(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"BackButtonComponent"};const o=(0,i.O7)(),r=(0,n.useCallback)((e=>(0,a.z)({...e,width:"24px",height:"24px"})),[]),l=(0,n.useCallback)((e=>(0,d.S)(e)),[]),c=(0,s.VK)((()=>!f.NW(o)),[o]),u=(0,s.VK)((()=>S.Z.state.isTabsFeatureEnabled?r:l),[l,r]);return(0,C.jsx)(k.ZP,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButtons.goBackButton.label",defaultMessage:"Go back"}),(0,C.jsx)(M.Z,{name:"goBack",style:{opacity:.5,marginLeft:4}})]}),placement:k.ug.Bottom,alignment:k.v2.Center,originGap:6,render:e=>(0,C.jsx)(w.Z,{icon:u,isDarkIconColor:!0,className:"notion-history-back-button",disabled:c,style:{position:"relative",...(0,v.X)({noDrag:o.device.isElectronMac})},onClick:()=>_(o,t),...e})})}function E(){window.__c={n:"ForwardButtonComponent"};const e=(0,i.O7)(),t=(0,n.useCallback)((e=>(0,l.C)({...e,width:"24px",height:"24px"})),[]),o=(0,n.useCallback)((e=>(0,c.s)(e)),[]),r=(0,s.VK)((()=>!f.vy(e)),[e]),a=(0,s.VK)((()=>S.Z.state.isTabsFeatureEnabled?t:o),[o,t]);return(0,C.jsx)(k.ZP,{renderTooltip:()=>(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(p.FormattedMessage,{id:"topbarBrowserHistoryButton.goForwardButton.label",defaultMessage:"Go forward"}),(0,C.jsx)(M.Z,{name:"goForward",style:{opacity:.5,marginLeft:4}})]}),placement:k.ug.Bottom,alignment:k.v2.Center,originGap:6,render:t=>(0,C.jsx)(w.Z,{icon:a,isDarkIconColor:!0,className:"notion-history-forward-button",disabled:r,style:{position:"relative",...(0,v.X)({noDrag:e.device.isElectronMac})},onClick:()=>B(e),...t})})}function R(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"MobileBackButtonComponent"};const o=(0,i.O7)(),{RouterStore:n}=o,a=(0,s.VK)((()=>!t&&!n.canGoBack()),[t,n]);return(0,C.jsx)(y.Z,{onClick:()=>_(o,t),className:"notion-history-back-button",disabled:a,disabledFeedback:!0,mobileFeedback:!0,style:T,children:t?(0,r.k)():(0,d.S)({width:16,height:16})})}function L(){window.__c={n:"MobileForwardButtonComponent"};const e=(0,i.O7)(),t=(0,s.VK)((()=>!f.vy(e)),[e]);return(0,C.jsx)(y.Z,{onClick:()=>B(e),className:"notion-history-forward-button",disabled:t,mobileFeedback:!0,disabledFeedback:!0,style:T,children:(0,c.s)({width:16,height:16})})}function O(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"MobileComponent"};const o=(0,i.O7)(),n=(0,s.VK)((()=>o.device.isTablet),[o]);return t||n?(0,C.jsx)(b.Z,{capture:!0,render:e=>(0,C.jsxs)("div",{style:{display:"flex",flexShrink:0,height:"100%",paddingLeft:4,paddingRight:t?0:4},...e,children:[(0,C.jsx)(R,{supportsNativeHomeTabPhone:t}),!t&&(0,C.jsx)(L,{})]})}):null}function D(e){let{supportsNativeHomeTabPhone:t}=e;return(0,C.jsx)(b.Z,{capture:!0,render:e=>(0,C.jsxs)("div",{style:{display:"flex",flexShrink:0},...e,children:[(0,C.jsx)(F,{supportsNativeHomeTabPhone:t}),(0,C.jsx)(E,{}),(0,C.jsx)(Z,{})]})})}function U(e){let{supportsNativeHomeTabPhone:t}=e;window.__c={n:"DesktopComponent"};const o=(0,s.VK)((()=>x.default.isCenterPeekOpen()),[]);return(0,C.jsx)(j.ZP,{style:{background:"transparent",borderRadius:0,boxShadow:"none"},origin:(0,C.jsx)(D,{supportsNativeHomeTabPhone:t}),render:()=>(0,C.jsx)(D,{supportsNativeHomeTabPhone:t}),placementToOrigin:j.ZP.Placement.Center,alignmentToOrigin:j.ZP.Alignment.Center,open:o,disableMouseCapture:!0,preventCaptureEsc:!0,preventScaleTransition:!0,preventOpacityTransition:!0,popupType:j.ZP.PopupType.Popup})}},28311:(e,t,o)=>{o.d(t,{I:()=>w,Z:()=>M});o(67294);var n=o(83355),i=o(24405),s=o(8848),r=o(47560),a=o(9291),l=o(7476),d=o(34047),c=o(43250),u=o(34700),p=o(33929),h=o(74948),g=o(24646),m=o(36391),b=o(88923),v=o(73063),f=o(26388),S=o(85893);const x=(0,a.defineMessages)({updates:{id:"topbar.commentsButton.title",defaultMessage:"Comments"}});class y extends n.Z{constructor(){super(...arguments),this.hasUnreadCommentsStore=this.createComputedStore((()=>(0,d.DF)({blockStore:this.props.blockStore,ignoreAfterTime:Date.now()}).some((e=>!e.getResolved()&&(0,d.NI)(e).some((t=>l.t({discussionStore:e,commentStore:t})))))),!1)}renderComponent(){const e=p.default.getIntl(),t=g.vK(this.environment)?(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)(a.FormattedMessage,{defaultMessage:"Close all comments",id:"topbar.commentsButton.closeSidebartTooltip"})}):(0,S.jsx)("div",{style:{textAlign:"center"},children:(0,S.jsx)(a.FormattedMessage,{defaultMessage:"View all comments",id:"topbar.commentsButton.openSidebartTooltip"})});return(0,S.jsx)(f.ZP,{placement:f.ug.Bottom,renderTooltip:()=>t,render:t=>(0,S.jsxs)("div",{style:{...(0,u.X)({noDrag:this.environment.device.isElectronMac}),position:"relative"},children:[(0,S.jsx)(v.Z,{...t,icon:r.o,iconStyle:{height:20,width:20,fill:this.theme.regularIconColor},onClick:()=>{return e=this.props.blockStore,t=this.environment,void h.handleSidebarButtonClick(t,e,m.gY.Comments,"topbar");var e,t},style:{width:33,height:28,marginRight:2},ariaLabel:e.formatMessage(x.updates),hovered:g.vK(this.environment)&&!b.default.state.open,className:c.p0b}),this.hasUnreadCommentsStore.state&&(0,S.jsx)(w,{})]}),children:t})}}y.displayName="TopbarCommentsButton";const w=()=>{window.__c={n:"TopBarNotificationDot"};const{dot:e}=(0,i.yK)((e=>({dot:{position:"absolute",top:1.8,right:5.5,height:11,width:11,border:`2px solid ${e.whiteButtonBackground}`,borderRadius:12,background:s.ZP.red,pointerEvents:"none"}})),[]);return(0,S.jsx)("div",{style:e})},M=y},84920:(e,t,o)=>{o.d(t,{Z:()=>D});var n=o(67294),i=o(12183),s=o(480),r=o(86628),a=o(24405),l=o(27961),d=o(38737),c=o(9291),u=o(50906),p=o(47307),h=o(53323),g=o(34700),m=o(45023),b=o(87279),v=o(15517),f=o(88632),S=o(99757),x=o(38335),y=o(8848),w=o(80750),M=o(16402),j=o(85893);function k(e){window.__c={n:"ConnectionErrorIndicatorLabel"};const t=(0,x.f)(500);if(e.device.isMobile)return(0,w.l)({width:24,height:"100%"});if(void 0===e.error.approximateBackoffDelayEndTime)return(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right.",id:"connectionErrorIndicator.label.shortMessage"});const o=Math.floor((e.error.approximateBackoffDelayEndTime-t)/1e3);return o>0?(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right. Retrying in {numberOfSeconds}s…",values:{numberOfSeconds:o},id:"connectionErrorIndicator.label.retryingInSeconds"}):(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Something's not right. Retrying…",id:"connectionErrorIndicator.label.retrying"})}function C(e){window.__c={n:"ConnectionErrorIndicatorDetails"},(0,x.f)(1e4);const{startTime:t}=e,o=(0,M.IS)(t),i=(0,s.O7)();return(0,n.useEffect)((()=>{u.apd(i,{errorSinceMs:Date.now()-t})}),[i,t]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(c.FormattedMessage,{defaultMessage:"{sinceSomeTimeAgo}, an error occurred saving your changes. We'll try again soon.",values:{sinceSomeTimeAgo:o},id:"connectionErrorIndicator.details.message"}),e.retryReason?(0,j.jsx)("div",{style:{marginTop:8,fontSize:12,color:y.ZP.whiteWithAlpha(.7),fontStyle:"italic"},children:(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Debug info: {debugInfo}",values:{debugInfo:e.retryReason},id:"connectionErrorIndicator.details.debugInfo"})}):void 0]})}var T=o(31945),P=o(68785),I=o(78140),Z=o(89728),B=o(26388);const _=e=>(0,j.jsx)(c.FormattedMessage,{defaultMessage:"You can no longer make edits: {errorMessage} {usageInfoMessage}",id:"connectionState.errorIndicator.cannotMakeEdits.detailedMessage",values:{errorMessage:e.errorMessage,usageInfoMessage:e.usageInfoMessage}}),F=e=>{window.__c={n:"ErrorIndicator"};const t=(0,a.Fg)(),o=(0,s.O7)(),i=(0,l.z)({marginLeft:6,width:14,height:14,fill:e.errorStateStyle.color}),r="transactionQueue"===e.type?e.message:void 0,d="lowStorage"===e.type?e.estimate:void 0;return(0,n.useEffect)((()=>{"transactionQueue"===e.type?u.sIE(o,{message:r}):"connection"===e.type?u.SLv(o):"lowStorage"===e.type&&u.zQ6(o,{estimate:d})}),[e.type,r,d,o]),(0,n.useEffect)((()=>{r&&p.showThrottledErrorMessage((0,j.jsx)(_,{errorMessage:r}))}),[r]),o.device.isMobile?(0,j.jsx)(T.ZP,{popupType:T.Z4.SlideUp,renderOrigin:t=>(0,j.jsx)(Z.Z,{style:e.errorStateStyle,...t,children:e.indicatorText||i}),render:o=>{let{close:n}=o;return(0,j.jsx)(I.Z,{menuType:b.og.ActionSheet,children:(0,j.jsx)("div",{style:{padding:15,background:t.errorText,color:"white"},onClick:n,children:e.detailsText})})}}):(0,j.jsx)(B.ZP,{renderTooltip:()=>(0,j.jsx)("div",{style:{width:320,whiteSpace:"normal"},children:e.detailsText}),render:t=>(0,j.jsxs)("div",{style:e.errorStateStyle,...t,children:[e.indicatorText,i]})})};function E(e){let{showLoadingSpinner:t}=e;window.__c={n:"MobileLoadingSpinner"};const o=(0,s.O7)(),n=(0,r.VK)((()=>{var e;return null===(e=o.mobileNative)||void 0===e?void 0:e.supportsNativeHomeOnPhone()}),[o]);return(0,j.jsx)("div",{style:{display:"flex",alignItems:"center",height:"100%",marginLeft:"auto",paddingLeft:!n||t?4:0,paddingRight:!n||t?8:0,visibility:t?"visible":"hidden"},children:(!n||t)&&(0,j.jsx)(P.Z,{style:{height:18,width:18}})})}function R(e){return{display:"flex",alignItems:"center",marginRight:e?0:18,fontSize:e?12:14}}function L(e){let{isOnline:t,showLoadingSpinner:o}=e;window.__c={n:"DesktopIndicators"};const n=(0,c.useIntl)(),i=(0,s.Fy)(),r=(0,a.yK)((e=>({offlineBadge:{...(0,g.X)({noDrag:i.isElectronMac}),display:"flex",alignItems:"center",padding:"0px 6px",height:i.isMobile?20:24,borderRadius:4,marginRight:i.isMobile?4:18,whiteSpace:"nowrap",fontSize:i.isMobile?12:14,color:e.mediumTextColor,border:`1px solid ${e.darkDividerColor}`},loadingState:{...(0,g.X)({noDrag:i.isElectronMac}),...R(i.isMobile),color:e.lightTextColor}})),[i]);return t?o?(0,j.jsx)(B.ZP,{renderTooltip:()=>(0,j.jsx)(c.FormattedMessage,{defaultMessage:"{percent} complete.",id:"connectionState.savePercentangeIndicator.tooltip",values:{percent:S.Z.percentComplete(n)}}),render:e=>(0,j.jsxs)("div",{style:r.loadingState,...e,children:[(0,j.jsx)(P.Z,{style:{margin:4,marginRight:8}}),(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Saving…",id:"connectionState.saving.message"})]})}):null:(0,j.jsx)(B.ZP,{renderTooltip:()=>(0,j.jsx)("div",{style:{width:200},children:(0,j.jsx)(c.FormattedMessage,{defaultMessage:"{numberOfEdits, plural, one {You have {numberOfEdits} edit that will be synced next time you are online.} other {You have {numberOfEdits} edits that will be synced next time you are online.}}",id:"connectionState.offlineBadge.tooltip",values:{numberOfEdits:S.Z.state.totalPending}})}),textWrap:!0,render:e=>(0,j.jsx)("div",{style:r.offlineBadge,...e,children:(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Offline",id:"connectionState.offlineBadge.label"})})})}function O(){window.__c={n:"ErrorMessages"};const e=(0,s.Fy)(),t=(0,r.VK)((()=>S.Z.state.transactionQueueError),[]),o=(0,r.VK)((()=>S.Z.state.storageUsageEstimate),[]),i=(0,c.useIntl)(),l=(0,a.yK)((t=>({errorState:{...(0,g.X)({noDrag:e.isElectronMac}),...R(e.isMobile),whiteSpace:"nowrap",color:t.errorText}})),[e]),u=(0,r.VK)((()=>(0,h.L)()),[]),p=()=>{if(o){const e=o.usage/o.quota;return(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Notion is using {percentageOfStorageBytesUsed} of its available storage on your device ({usedNumberOfBytes} of {totalNumberOfBytes}).",id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart1",values:{usedNumberOfBytes:(0,d.uf)(o.usage,"bytes",i),totalNumberOfBytes:(0,d.uf)(o.quota,"bytes",i),percentageOfStorageBytesUsed:i.formatNumber(e,{style:"percent",maximumFractionDigits:2})}})}};if(t){const e=(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Cannot save changes",id:"connectionState.errorIndicator.cannotSaveChanges.message"}),o=(0,j.jsx)(_,{errorMessage:t.message,usageInfoMessage:p()});return(0,j.jsx)(F,{type:"transactionQueue",message:t.message,indicatorText:e,detailsText:o,errorStateStyle:l.errorState})}if(void 0!==o&&!(0,v.mn)(o)){const t=e.isBrowser?(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Low browser storage",id:"connectionState.errorIndicator.lowStorageOnWebApp.message"}):e.isMobileNative?(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Low app storage",id:"connectionState.errorIndicator.lowStorageOnMobileApp.message"}):(0,j.jsx)(c.FormattedMessage,{defaultMessage:"Low disk space",id:"connectionState.errorIndicator.lowStorageOnDesktopApp.message"});return(0,j.jsx)(F,{type:"lowStorage",estimate:o,indicatorText:t,detailsText:(0,j.jsxs)(n.Fragment,{children:[p()," ",(0,j.jsx)(c.FormattedMessage,{id:"connectionState.errorIndicator.possibleLostEdits.detailedMessagePart2",defaultMessage:"You may lose changes made while offline. Try closing and re-opening your app, and contact support if that doesn’t fix the issue."})]}),errorStateStyle:l.errorState})}return u?(0,j.jsx)(F,{type:"connection",indicatorText:(0,j.jsx)(k,{error:u,device:e}),detailsText:(0,j.jsx)(C,{...u}),errorStateStyle:l.errorState}):null}const D=function(){window.__c={n:"TopbarConnectionIndicator"};const e=(0,r.VK)((()=>f.Z.state.online),[]),t=(0,r.VK)((()=>!S.n.state),[]),o=function(){const e=(0,n.useRef)(!1),[t,o]=(0,n.useState)(!1),s=(0,i.v)((()=>{f.Z.state.syncing&&!e.current&&(e.current=!0,o(!0))}),8e3),r=(0,i.v)((()=>{e.current&&!f.Z.state.syncing&&(e.current=!1,o(!1))}),200);return(0,n.useEffect)((()=>(f.Z.addListener(s),f.Z.addListener(r),()=>{f.Z.removeListener(s),f.Z.removeListener(r)})),[s,r]),e.current}(),a=function(e,t){const o=(0,s.O7)(),[i,r]=(0,n.useState)(!1),a=(0,n.useCallback)((n=>{(0,m.Z)(o,n,"command+s")&&(n.preventDefault(),e&&!i&&t&&(r(!0),setTimeout((()=>{r(!1)}),500)))}),[o,i,t,e]);return(0,n.useEffect)((()=>(window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)})),[a]),i}(e,t),l=(0,s.Fy)(),d=(0,r.VK)((()=>!(0,h.n)()),[]),c=(a||o)&&t&&d;return(0,j.jsxs)(j.Fragment,{children:[l.isMobile?(0,j.jsx)(E,{showLoadingSpinner:c}):(0,j.jsx)(L,{isOnline:e,showLoadingSpinner:c}),(0,j.jsx)(O,{})]})}},24097:(e,t,o)=>{o.d(t,{Z:()=>w});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(18387),l=o(52926),d=o(9291),c=o(50906),u=o(24677),p=o(82530),h=o(43250),g=o(34700),m=o(92783),b=o(74948),v=o(73063),f=o(58261),S=o(26388),x=o(85893);const y=(0,d.defineMessages)({isBookmarkedMessage:{defaultMessage:"Favorited",id:"topbar.favoriteButton.activeTitle"},isNotBookmarkedMessage:{defaultMessage:"Favorite",id:"topbar.favoriteButton.title"},isBookmarkedTooltip:{defaultMessage:"Remove from your favorites",id:"topbar.favoriteButton.activeTooltip1"},isNotBookmarkedTooltip:{defaultMessage:"Add to your favorites",id:"topbar.favoriteButton.tooltip1"}});const w=function(e){let{spaceViewStore:t,store:o}=e;window.__c={n:"TopbarFavoriteButton"};const f=(0,r.Fg)(),w=(0,i.O7)(),j=(0,d.useIntl)(),k=(0,s.VK)((()=>!!t&&(0,m.Z)({spaceViewStore:t,pageId:o.id})),[t,o]),C=k?l.b:a.A,T=(0,n.useMemo)((()=>k?()=>function(e,t,o){if(!o)return;u.ZH(t),c.P9p(t,{from:"topbar"}),p.createAndCommit({userAction:"TopbarFavoriteButton.handleUnbookmarkClick",environment:t,perform:t=>{b.unbookmarkPage({spaceViewStore:o,store:e,transaction:t})}})}(o,w,t):()=>function(e,t,o){if(!o)return;u.ZH(t),c.V0c(t,{from:"topbar"}),p.createAndCommit({userAction:"TopbarFavoriteButton.handleBookmarkClick",environment:t,perform:t=>{b.bookmarkPage({spaceViewStore:o,store:e,transaction:t})}})}(o,w,t)),[k,o,w,t]);return(0,x.jsx)(S.ZP,{placement:S.ug.Bottom,renderTooltip:()=>(0,x.jsx)(M,{isBookmarked:k}),render:e=>(0,x.jsx)(v.Z,{...e,className:h.GbT,icon:C,style:{...(0,g.X)({noDrag:w.device.isElectronMac}),width:33,height:28,marginRight:2},iconStyle:{height:20,width:20,fill:k?f.topbarFavorite:f.regularIconColor},onClick:T,ariaLabel:j.formatMessage(k?y.isBookmarkedMessage:y.isNotBookmarkedMessage)})})};function M(e){let{isBookmarked:t}=e;window.__c={n:"TooltipMessageComponent"};const o=(0,r.Fg)();return(0,x.jsxs)("div",{style:{textAlign:"center"},children:[(0,x.jsx)("div",{children:(0,x.jsx)(d.FormattedMessage,{...t?y.isBookmarkedTooltip:y.isNotBookmarkedTooltip})}),(0,x.jsx)(f.Z,{style:{color:o.mediumInvertedTextColor},name:"toggleFavorite"})]})}},43377:(e,t,o)=>{o.d(t,{b:()=>p});o(67294);var n=o(480),i=o(24405),s=o(44495),r=o(9291),a=o(74948),l=o(36391),d=o(73063),c=o(26388),u=o(85893);function p(e){window.__c={n:"TopbarLayoutInfoButton"};const{blockStore:t}=e,o=(0,i.Fg)(),p=(0,n.O7)(),h=(0,r.useIntl)(),g=(0,u.jsx)("div",{style:{textAlign:"center"},children:(0,u.jsx)(r.FormattedMessage,{defaultMessage:"Show page info",id:"topbar.infoButton.tooltip"})});return(0,u.jsx)(c.ZP,{placement:c.ug.Bottom,renderTooltip:()=>g,render:e=>(0,u.jsx)(d.Z,{...e,style:{width:33,height:28},icon:s.D,iconStyle:{height:20,width:20,fill:o.regularIconColor},onClick:()=>a.handleSidebarButtonClick(p,t,l.gY.Info,"info"),ariaLabel:h.formatMessage({defaultMessage:"Info",id:"topbar.infoButton.text"})})})}},72485:(e,t,o)=>{o.d(t,{Z:()=>C});o(67294);var n=o(73935),i=o(83355),s=o(56666),r=o(30681),a=o(9291),l=o(50906),d=o(24677),c=o(43250),u=o(34700),p=o(98742),h=o(35328),g=o(77907),m=o(80444),b=o(21884),v=o(64921),f=o(31945),S=o(26388),x=o(28451),y=o(81415),w=o(71424),M=o(85893);function j(e){return(0,M.jsx)(x.P,{calloutId:"wiki_promo",children:(0,M.jsx)(y.U,{origin:()=>e.origin,placementToOrigin:"bottom",header:"Upgrade your existing wikis",content:"Look for the Turn into wiki action here",onCloseClick:()=>{b.E.reset()},pointerPosition:"98%",pointerLength:24,pointerOffset:-3,style:{width:w.G5}})})}class k extends i.Z{constructor(){super(...arguments),this.originEl=null,this.onClickOriginRect=void 0,this.renderOrigin=e=>{const{device:t}=this.environment;return(0,M.jsx)(S.ZP,{renderTooltip:()=>this.environment.currentUser.isLoggedIn()?(0,M.jsx)(a.FormattedMessage,{defaultMessage:"Style, export, and more…",id:"topbarMoreButton.tooltip"}):(0,M.jsx)(a.FormattedMessage,{defaultMessage:"More…",id:"topbarMoreButton.loggedOut.tooltip"}),placement:S.ug.Bottom,delayThreshold:400,render:o=>(0,M.jsx)(v.Z,{ref:this.handleButtonMount,style:T(this.environment),mobileFeedback:t.isMobile,className:c.mSZ,...(0,p.Z)(e,o),children:t.isMobile?(0,r.I)({width:26}):(0,s.o)({width:18,height:18,fill:this.theme.regularIconColor})})})},this.handleButtonMount=e=>{e&&(this.originEl=n.findDOMNode(e))},this.handleClick=()=>{b.E.reset(),d.ZH(this.environment),this.originEl&&(this.onClickOriginRect=this.originEl.getBoundingClientRect()),l.kq7(this.environment)}}renderComponent(){const{device:e}=this.environment,t=b.E.state.showConvertTooltip;return(0,M.jsxs)(M.Fragment,{children:[t?(0,M.jsx)(j,{origin:this.originEl}):null,(0,M.jsx)(f.ZP,{popupType:e.isMobile?f.Z4.SlideUp:f.Z4.Popup,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderOrigin,onClick:this.handleClick,render:()=>(0,M.jsx)(g.LazyTopbarMoreMenu,{blockStore:this.props.store,onClickOriginRect:this.onClickOriginRect,handleAccept:e=>function(e,t,o){const{mainEditorCurrentBlockStore:n}=m.default.state;if(n){const t=n.getType();t&&l.dhV(o,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"topbar_more_menu",block_id:n.id,block_type:t,is_toggleable:(0,h._A)(t,n.getFormat())})}e.closeParentMenu&&P(t)}(e,this.props.buttonPopupStore,this.environment),handleDismiss:()=>P(this.props.buttonPopupStore)}),originGap:8,trapFocus:!0,forceInitialInbound:!0,style:e.isMobile?{}:{width:240,maxHeight:"80vh"}})]})}}k.displayName="TopbarMoreButton";const C=k;function T(e){const{device:t}=e;return t.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingLeft:8,paddingRight:8,marginRight:2}:{...(0,u.X)({noDrag:e.device.isElectronMac}),display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}}function P(e){e.setState({...e.state,open:!1})}},5002:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(24405),i=o(85893);const s=function(){window.__c={n:"TopbarPeekControlsSeparator"};const e=(0,n.yK)((e=>({separator:{height:14,width:1,marginLeft:6,marginRight:6,background:e.darkDividerColor}})),[]);return(0,i.jsx)("div",{style:e.separator})}},86467:(e,t,o)=>{o.d(t,{Z:()=>Z});o(57658),o(67294);var n=o(83355),i=o(13991),s=o(480),r=o(86628),a=o(24405),l=o(7057),d=o(72126),c=o(19889),u=o(7928),p=o(9291),h=o(61045),g=o(34700),m=o(20095),b=o(26136),v=o(64921),f=o(26388),S=o(64369),x=o(29302),y=o(45653),w=o(44615),M=o(25320),j=o(2688),k=o(53730);class C extends n.Z{constructor(){super(...arguments),this.messageStoreListenerReference=void 0}UNSAFE_willMount(){this.startMessageStoreListener()}willUnmount(){this.stopMessageStoreListener()}didUpdate(){this.stopMessageStoreListener(),this.startMessageStoreListener()}async startMessageStoreListener(){const{block:e}=this.props;if(await k.transactionQueue.awaitRecordTransaction(e.pointer),!this.componentIsMounted)return;const t=(0,w.pb)(e.id);this.messageStoreListenerReference=j.Z.addListener(t,d.P2((()=>M.Ri(this.environment,{block:this.props.block,pageVisitStore:this.props.pageVisitStore,incremental:!0,limit:this.props.limit})),1e3),void 0,this.environment)}stopMessageStoreListener(){this.messageStoreListenerReference&&(j.Z.removeListener(this.messageStoreListenerReference,this.environment),this.messageStoreListenerReference=void 0)}}C.displayName="PageVisitListener";const T=C;var P=o(85893);class I extends n.Z{constructor(){super(...arguments),this.renderStateStore=this.createComputedStore((()=>{const{pageVisitStore:e,presenceStore:t}=this.props,o=(0,m.AQ)(e,t),n=this.environment.currentUser.id;if(!n)return;const i=F(n,this.props.rootStore),s=o.find((e=>e.userId===n));if(!s||!i.isDefined())return;let r=o.filter((e=>e.userId!==n&&(0,m.MR)(this.environment,e)));r=B(r).reverse();const a=B(d.e5(o,r,[s])).reverse(),l=[...r,...a],c=_(this.props.maxUsers)-1;return{visibleUsers:l.slice(0,c),hiddenUsers:l.slice(c)}}),!0)}renderComponent(){return(0,P.jsxs)(P.Fragment,{children:[this.renderPresence(),(0,P.jsx)(T,{block:this.props.rootStore,pageVisitStore:this.props.pageVisitStore,limit:1+_(this.props.maxUsers)+25})]})}renderPresence(){const e=this.environment.currentUser.id;if(!e)return;const t=this.renderStateStore.state;if(!t)return;const{visibleUsers:o,hiddenUsers:n}=t;var i;if([e,...o.map((e=>e.userId)),...n.map((e=>e.userId))].map((e=>F(e,this.props.rootStore))).every((e=>e.isReady()))&&(o.length>0||n.length>0)){const t=[...o];return t.reverse(),(0,P.jsxs)("div",{style:(i=this.environment,{...(0,g.X)({noDrag:i.device.isElectronMac}),display:"flex",alignItems:"center",position:"relative",flexDirection:"row-reverse",marginLeft:9,marginTop:-2,transform:"translateZ(0)"}),children:[n.length>0&&(0,P.jsx)(O,{rootStore:this.props.rootStore,hiddenUsers:n}),t.map((e=>(0,P.jsx)(D,{userData:e,rootStore:this.props.rootStore},e.userId))),(0,P.jsx)(D,{rootStore:this.props.rootStore,userData:{userId:e,present:!0}})]})}}}I.displayName="TopbarPresence";const Z=I;function B(e){return d.MR(e,(e=>e.activityTimestampNearestMinuteMs))}function _(e){return e??5}function F(e,t){return b.U6.createChildStore(t,{table:c.KJ,id:e})}function E(e){return{color:e.mediumInvertedTextColor,fontSize:10,textTransform:"uppercase",letterSpacing:"0.015em"}}function R(e){let{userData:t,isPresent:o,rootStore:n}=e;window.__c={n:"AvatarTooltipComponent"};const d=(0,a.Fg)(),c=(0,s.O7)(),h=(0,p.useIntl)(),g=c.currentUser.id,m=(0,r.VK)((()=>F(t.userId,n)),[t,n]),b=(0,r.VK)((()=>m.isDefined()),[m]),v=(0,r.VK)((()=>(0,u.Nz)(h,m.getModel())),[h,m]),f=(0,r.VK)((()=>m.getEmail()),[m]);if(!b)return null;let S;return o?g!==m.id&&(S=t.blockId?(0,P.jsx)(p.FormattedMessage,{defaultMessage:"Viewing now. Click to see where they are.",id:"topbar.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,P.jsx)(p.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.viewingNow.tooltip"})):g!==m.id&&t.activityTimestampNearestMinuteMs&&(S=(0,P.jsx)(p.FormattedMessage,{defaultMessage:"Last viewed {timeFromNow}",id:"topbar.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,l.tv)(Math.min(t.activityTimestampNearestMinuteMs,Date.now()),i.SP)}})),(0,P.jsxs)("div",{children:[(0,P.jsx)("div",{className:"notranslate",children:v}),(0,P.jsx)("div",{style:{fontWeight:400},children:f}),S&&(0,P.jsx)("div",{style:{color:d.mediumInvertedTextColor,minWidth:150,paddingTop:2,paddingBottom:2,lineHeight:1.3},children:S})]})}function L(e){let{userData:t,index:o,rootStore:n}=e;window.__c={n:"HiddenUsersTooltipItemComponent"};const d=(0,a.Fg)(),c=(0,s.O7)(),u=(0,m.MR)(c,t),p=(0,r.VK)((()=>F(t.userId,n)),[t,n]);if(!(0,r.VK)((()=>p.isDefined()),[p]))return null;let g;!u&&t.activityTimestampNearestMinuteMs&&(g=(0,l.tv)(t.activityTimestampNearestMinuteMs,i.SP));const b=(0,P.jsxs)("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},children:[(0,P.jsx)(x.Z,{userStore:p,avatarSize:18,style:{flexGrow:1}}),(0,P.jsx)("div",{style:{marginLeft:"auto",paddingLeft:12,textAlign:"right",flexShrink:1,color:d.mediumInvertedTextColor},children:g})]});if(u&&t.blockId){const e=t.blockId;return(0,P.jsx)(v.Z,{onClick:()=>h.hl([e],!0),style:{display:"flex",alignItems:"center"},children:b})}return(0,P.jsx)("div",{style:{display:"flex",alignItems:"center"},children:b})}function O(e){let{hiddenUsers:t,rootStore:o}=e;window.__c={n:"HiddenUsersComponent"};const n=(0,a.Fg)(),i=(0,s.O7)();return(0,P.jsx)(f.ZP,{allowHover:!0,originGap:7,renderTooltip:e=>{const s=[],r=[];for(const o of t)(0,m.MR)(i,o)?s.push(o):r.push(o);const a=r.slice(0,25-s.length);return(0,P.jsxs)("div",{...e,children:[s.length>0&&(0,P.jsxs)("div",{style:{marginBottom:4},children:[(0,P.jsx)(S.Z,{style:E(n),children:(0,P.jsx)(p.FormattedMessage,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.hiddenUsers.viewingNow.tooltip"})}),s.map(((e,t)=>(0,P.jsx)(L,{userData:e,index:t,rootStore:o},t)))]}),a.length>0&&(0,P.jsxs)("div",{style:{marginBottom:4},children:[(0,P.jsx)(S.Z,{style:{...E(n)},children:(0,P.jsx)(p.FormattedMessage,{defaultMessage:"Last viewed by",id:"topbar.presenceIndicator.hiddenUsers.lastViewedBy.tooltip"})}),a.map(((e,t)=>(0,P.jsx)(L,{userData:e,index:t,rootStore:o},t)))]}),r.length>a.length&&(0,P.jsx)("div",{style:{marginLeft:2,marginTop:2,color:n.mediumInvertedTextColor},children:(0,P.jsx)(p.FormattedMessage,{defaultMessage:"{notViewingMoreUsersCount} more…",id:"topbarPresence.presenceIndicator.hiddenUsers.moreUsersNotViewing.tooltip",values:{notViewingMoreUsersCount:r.length-a.length}})})]})},render:e=>(0,P.jsx)("div",{style:{color:n.mediumTextColor,fontSize:14,marginLeft:10,marginRight:-5,whiteSpace:"nowrap"},...e,children:(0,P.jsx)(p.FormattedMessage,{defaultMessage:"{hiddenUsersCount, plural, one {+{hiddenUsersCount}} other {+{hiddenUsersCount}}}",id:"topbar.presenceIndicator.hiddenUsers.otherCount.message",values:{hiddenUsersCount:t.length}})})})}function D(e){let{userData:t,rootStore:o}=e;window.__c={n:"AvatarComponent"};const n=(0,s.O7)(),{userId:i}=t,a=(0,m.MR)(n,t),l=F(i,o);if(!(0,r.VK)((()=>l.isDefined()&&!l.getIsSuspended()),[l]))return null;const d={transition:"all 0.2s ease",transform:"scale(1)"},c={transform:"scale(1.15)",background:"none"},u={transform:"scale(0.9)",background:"none"},p={width:23,height:23,borderRadius:23,marginRight:-5,position:"relative"};return(0,P.jsx)(f.ZP,{textWrap:!0,renderTooltip:()=>(0,P.jsx)(R,{rootStore:o,userData:t,isPresent:a}),render:e=>{const o=(0,P.jsx)(y.Z,{userStore:l,style:p,isOffline:!a,size:23,avatarShouldShowShadow:!0});if(a&&t.blockId){const n=t.blockId;return(0,P.jsx)(v.Z,{...e,onClick:()=>h.hl([n],!0),style:d,hoveredStyle:c,pressedStyle:u,children:o})}return(0,P.jsx)("div",{...e,children:o})}})}},7715:(e,t,o)=>{o.d(t,{Z:()=>u});o(67294);var n=o(480),i=o(24405),s=o(61061),r=o(9291),a=o(34700),l=o(89728),d=o(26388),c=o(85893);const u=function(e){window.__c={n:"TopbarRestrictedBadge"};const t=(0,i.Fg)(),o=(0,n.O7)(),{device:u}=o;return(0,c.jsx)(d.ZP,{placement:d.ug.Bottom,renderTooltip:()=>(0,c.jsxs)("div",{style:{...(0,a.X)({noDrag:o.device.isElectronMac}),textAlign:"center"},children:[(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Access restricted from parent page",id:"blockAuthorInfo.restrictedBadge.infoText"}),(0,c.jsx)("br",{}),(0,c.jsx)("span",{style:{color:t.mediumInvertedTextColor},children:(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Click to view access",id:"blockAuthorInfo.restrictedBadge.clickText"})})]}),render:o=>(0,c.jsxs)(l.Z,{onClick:e.onClick,style:{marginRight:u.isMobile?4:2,color:t.lightTextColor,fill:t.lightIconColor},...o,children:[(0,s.B)({width:20,marginRight:4,fill:t.lightIconColor}),(0,c.jsx)("div",{style:{color:t.lightTextColor,fontSize:u.isMobile?16:14,lineHeight:u.isAndroid?1.5:1,whiteSpace:"nowrap"},children:(0,c.jsx)(r.FormattedMessage,{id:"blockAuthorInfo.restrictedBadge",defaultMessage:"Restricted"})})]})})}},82774:(e,t,o)=>{o.d(t,{Z:()=>A});var n=o(67294),i=o(83355),s=o(15769),r=o(43876),a=o(63143),l=o(9291),d=o(24677),c=o(28040),u=o(37181),p=o(43250),h=o(34700),g=o(98742),m=o(45101),b=o(77907),v=o(57345),f=o(4023),S=o(80444),x=o(77080),y=o(55899),w=o(8675),M=o(52878),j=o(34583),k=o(88893),C=o(88280),T=o(31945),P=o(58261),I=o(89728),Z=o(53437),B=o(26388),_=o(24405),F=o(8848),E=o(13148),R=o(23063),L=o(73063),O=o(28451),D=o(85893);function U(e){window.__c={n:"ShareButtonIntroTooltip"};const{visible:t,onDismiss:o}=e,n=(0,_.yK)((e=>({overlayContainer:{position:"relative",width:240,height:140,paddingTop:0,paddingBottom:20,paddingLeft:20,paddingRight:20},container:{fontSize:12,color:F.ZP.white,position:"absolute",top:13,background:F.ZP.blue,borderRadius:6,padding:"8px 12px 12px 12px",width:200,boxShadow:e.largeLightBoxShadow,zIndex:9999},circle:{position:"absolute",top:-12,left:"calc(50% - 2.5px)",background:F.ZP.blue,width:5,height:5,borderRadius:5,boxShadow:`0 0 0 1.5px ${e.contentBackground}`},verticalLine:{position:"absolute",top:-12,left:"calc(50% - 1px)",background:F.ZP.blue,width:2,height:12},textContainer:{width:"90%",fontWeight:500},iconButton:{position:"absolute",top:4,right:4,opacity:.8},iconStyle:{width:12,fill:F.ZP.white}})),[]);return(0,D.jsx)("div",{style:n.overlayContainer,children:(0,D.jsx)(R.Z,{isVisible:t,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:function(){return(0,D.jsx)(O.P,{calloutId:"share_button_tooltip",children:(0,D.jsxs)("div",{style:n.container,children:[(0,D.jsx)("div",{style:n.circle}),(0,D.jsx)("div",{style:n.verticalLine}),(0,D.jsx)("div",{style:n.textContainer,children:(0,D.jsx)(l.FormattedMessage,{defaultMessage:"You can share your content with your teammates here",id:"shareButtonIntroTooltip.title"})}),(0,D.jsx)(L.Z,{icon:E.U,style:n.iconButton,iconStyle:n.iconStyle,onClick:()=>o()})]})})}})})}class V extends i.Z{constructor(){super(...arguments),this.storeTypes={universalMemberInviteStore:M.Z,sudoModeStore:w.Z,inviteTargetsStore:y.ZP},this.showShareButtonTooltip=this.createComputedStore((()=>function(e){const{currentUserSettingsStore:t,mainEditorCurrentBlockStore:o,inAppCalloutStore:n}=S.default.state;if(null!=o&&o.isTypedCollectionViewBlock())return!1;if(!t)return!1;if(t.id!==e.currentUser.id)return!1;const i=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();if(Boolean(i))return!1;const s=t.getKeyStore("settings").getKeyStore("signup_time").getValue();if(!s)return!1;if(!n.canShow("share_button_tooltip"))return!1;const r=Date.now()-s;if(r<=30*a.A0){switch(x.default.getEligibleGroup({experimentId:"intro_share_tooltip_condition",defaultGroup:"control"})){case"b200":const t=C.subscriptionDataStoreInstance.state;if(t){return(0,k.Lz)(e,t)>=200}return!1;case"d3":return r>=3*a.A0;case"control":return r>=10*a.A0}}return!1}(this.environment))),this.buttonPopupStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{width:460}:{width:500,overflow:"hidden"}})),this.shareButtonStyle=this.createComputedStore((()=>{const{device:e}=this.environment;return e.isMobile?{display:"flex",alignItems:"center",height:"100%",paddingLeft:8,paddingRight:8}:{...(0,h.X)({noDrag:e.isElectronMac}),marginRight:2,marginLeft:12}})),this.shareButtonRef=n.createRef(),this.renderShareButtonOrigin=e=>{const{device:t}=this.environment;return(0,D.jsx)(B.ZP,{disableTooltip:t.isMobile,renderTooltip:()=>(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{children:(0,D.jsx)(l.FormattedMessage,{defaultMessage:"Share or publish to the web",id:"topbar.shareButton.tooltip"})}),(0,D.jsx)(P.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"openShareMenu"})]}),placement:f.u.Bottom,delayThreshold:400,render:t=>this.renderShareButton((0,g.Z)(e,t))})},this.renderShareButton=e=>{const{device:t}=this.environment,o=this.showShareButtonTooltip.state,n=t.isMobile?t.isAndroid?(0,s.Q)({width:16,height:16}):(0,r.s)({width:26}):(0,D.jsx)(l.FormattedMessage,{defaultMessage:"Share",id:"topbar.shareButton.title"}),i=(0,D.jsx)("div",{ref:this.shareButtonRef,children:(0,D.jsx)(I.Z,{className:p.MD7,...(0,g.Z)(e,{onClick:o?()=>u.Qm(this.environment):()=>{}}),mobileFeedback:t.isMobile,style:this.shareButtonStyle.state,children:n})});return o?(0,D.jsx)(Z.ZP,{popupType:Z.kQ.Popup,open:!0,origin:i,placementToOrigin:f.u.Bottom,alignmentToOrigin:Z.ZP.Alignment.Center,preventScaleTransition:!0,preventOpacityTransition:!0,viewportPadding:4,preventCaptureEsc:!0,preventPointerEvents:!1,disableMouseCapture:!0,render:()=>this.showShareButtonTooltip.state?(0,D.jsx)(U,{visible:this.showShareButtonTooltip.state,onDismiss:()=>u.Qm(this.environment)}):null,style:{boxShadow:"none",backgroundColor:"rgba(0, 0, 0, 0)"}}):i},this.getBlockStoreForPermissionsSettings=()=>this.stores.sudoModeStore.shouldUserHaveAccessToPrivatePageBlock()&&this.stores.sudoModeStore.state.changePermissionsEnabled&&this.stores.sudoModeStore.state.privatePageStore?this.stores.sudoModeStore.state.privatePageStore:this.props.store,this.handleClick=()=>{this.resetStores(),d.ZH(this.environment),v.lG(this.environment),j.bi(this.environment)},this.handleClose=async()=>{if(this.stores.inviteTargetsStore.state.inviteTargets.length>0){return void(await v.zd({environment:this.environment,inviteTargetsStore:this.stores.inviteTargetsStore})&&(v.a6(this.environment),this.resetStores()))}const{permissionsInviteStore:e}=this.stores.universalMemberInviteStore.state;"invitee"===e.state.inputFocus&&e.setState({...e.state,inputFocus:"none"});await(0,m.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:"share_menu"})||(v.a6(this.environment),this.resetStores())},this.resetStores=()=>{this.props.buttonPopupStore.reset(),this.stores.universalMemberInviteStore.reset(),this.stores.inviteTargetsStore.reset()},this.hasInviteTargets=()=>{const{universalMemberInviteStore:e,inviteTargetsStore:t}=this.stores,{permissionsInviteStore:o}=e.state;return o.state.inviteTargets.length>0||t.state.inviteTargets.length>0}}didMountOrUpdate(){this.props.store.canAdmin()?this.stores.sudoModeStore.reset():c.i({environment:this.environment,sudoModeStore:this.stores.sudoModeStore,pageBlockId:this.props.store.id})}renderComponent(){const{device:e}=this.environment;return(0,D.jsx)(T.ZP,{popupType:e.isMobile?T.Z4.SlideUp:T.Z4.Popup,forceInitialInbound:!0,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderShareButtonOrigin,originGap:e.isMobile?void 0:8,style:this.buttonPopupStyle.state,onClick:this.handleClick,render:()=>(0,D.jsx)(b.LazyShareMenuContainer,{buttonPopupStore:this.props.buttonPopupStore,sudoModeStore:this.stores.sudoModeStore,store:this.getBlockStoreForPermissionsSettings(),inviteTargetsStore:this.stores.inviteTargetsStore,onUpgradeButtonClick:()=>{this.props.buttonPopupStore.reset()},location:e.isMobile?"topbar_mobile":"topbar_share_button",onClose:this.handleClose}),persistOnClose:!e.isMobile&&this.hasInviteTargets(),onDismiss:this.handleClose,onClose:this.handleClose})}}V.displayName="TopbarShareButton";const A=V},44332:(e,t,o)=>{o.d(t,{Z:()=>M});o(67294);var n=o(480),i=o(86628),s=o(24405),r=o(7525),a=o(63261),l=o(9291),d=o(43250),c=o(34700),u=o(12534),p=o(94841),h=o(74948),g=o(38676),m=o(23063),b=o(64921),v=o(73063),f=o(58261),S=o(26388),x=o(39849),y=o(92955),w=o(85893);function M(e){window.__c={n:"TopbarSidebarButton"};const t=(0,n.O7)(),o=(0,n.Fy)(),M=(0,l.useIntl)(),j=(0,i.VK)((()=>g.sidebarOpenStore.state),[]),k=(0,s.yK)((t=>({root:{...(0,c.X)({noDrag:o.isElectronMac}),flexShrink:0,width:48,height:48,margin:-12,padding:12,marginRight:-6},hamburgerButton:{position:"absolute",top:0,left:0,willChange:"opacity",display:"flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,...e.isFloatingButton?{...(0,p.Er)({theme:t,isPhone:o.isPhone,buttonState:"base"}),width:28}:{}},sidebarButton:{position:"absolute",top:0,left:0,willChange:"opacity",...e.isFloatingButton?{...(0,p.Er)({theme:t,isPhone:o.isPhone,buttonState:"base"}),width:28}:{}},svg:{width:16,height:16,fill:t.regularIconColor,...e.isFloatingButton?{width:12,height:12}:{}},chevron:{...e.isFloatingButton?{width:14,height:14}:{width:16,height:16}},keyboardShortcut:{color:t.mediumInvertedTextColor},mentionBadge:{position:"absolute",top:-1,right:-4,...e.isFloatingButton?{top:-4}:{}}})),[o,e.isFloatingButton]),C=e=>{(0,u.ZP)({event:e,context:u.Af.SidebarMouseMove,callback:()=>{const t=e.currentTarget.getBoundingClientRect();g.sidebarMousePeekXStore.setState(t.right),h.open()}})},T=M.formatMessage({defaultMessage:"Lock sidebar open",id:"sidebarExpandButton.tooltip"});return(0,w.jsx)("div",{style:k.root,onMouseEnter:C,onMouseMove:C,children:(0,w.jsxs)("div",{style:{position:"relative"},children:[(0,w.jsx)(m.Z,{isVisible:!0,animationStyle:{opacity:j?0:1},render:()=>(0,w.jsxs)(b.Z,{style:k.hamburgerButton,children:[(0,a._)(k.svg),(0,w.jsx)(y.Z,{type:"allSpaces",color:x.N.Red,style:k.mentionBadge})]})}),(0,w.jsx)(m.Z,{isVisible:!0,animationStyle:{opacity:j?1:0},render:()=>(0,w.jsx)(S.ZP,{renderTooltip:()=>(0,w.jsxs)("div",{children:[(0,w.jsx)("div",{children:T}),(0,w.jsx)(f.Z,{style:k.keyboardShortcut,name:"toggleSidebar"})]}),placement:S.ug.Right,alignment:S.v2.Start,delayThreshold:0,originGap:6,render:e=>(0,w.jsx)(v.Z,{ariaLabel:T,icon:r.t,style:k.sidebarButton,hoveredStyle:k.sidebarButton,iconStyle:k.chevron,isDarkIconColor:!0,onClick:()=>h.setExpand({environment:t,isExpanded:!0,from:"topbar_sidebar_button"}),className:d.exn,...e})})})]})})}},22165:(e,t,o)=>{o.d(t,{C:()=>y,V:()=>x});o(67294);var n=o(480),i=o(86628),s=o(24405),r=o(97439),a=o(9291),l=o(28020),d=o(43250),c=o(34700),u=o(74948),p=o(38676),h=o(24042),g=o(45325),m=o(23063),b=o(73063),v=o(58261),f=o(26388),S=o(85893);function x(e){let{}=e;window.__c={n:"TopbarSidebarUnexpandButton"};const t=(0,n.O7)(),o=(0,n.Fy)(),s=(0,a.useIntl)(),d=(0,i.VK)((()=>!p.sidebarMouseEnteredStore.state),[]),c=(0,i.VK)((()=>h.Z.state.isShowingTabBar||!1),[]),m=(0,i.VK)((()=>l.tu.state),[]),b=s.formatMessage({defaultMessage:"Close sidebar",id:"sidebarUnexpandButton.closeSidebar.tooltip"});return(0,S.jsx)(y,{shouldHide:o.isElectronMac&&m||c||d,icon:r.D,caption:b,onClick:()=>{u.setExpand({environment:t,isExpanded:!1,from:"topbar_sidebar_unexpand_button"}),g.default.isOpen()&&u.close()},keyboardShortcutName:"toggleSidebar",isElectron:o.isElectron})}function y(e){window.__c={n:"TopbarUnexpandButton"};const t=(0,n.Fy)(),o=(0,s.yK)((e=>({keyboardShortcut:{color:e.mediumInvertedTextColor}})),[]),i=e.isElectron&&!e.shouldHide?1:0,r=e.shouldHide?0:1,a=e.keyboardShortcutName;return(0,S.jsx)(f.ZP,{disableTooltip:e.shouldHide,renderTooltip:()=>(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:e.caption}),a&&(0,S.jsx)(v.Z,{style:o.keyboardShortcut,name:a})]}),originGap:6,render:o=>(0,S.jsx)(m.Z,{isVisible:!0,animationStyle:{opacity:r},enterAnimationStyle:{opacity:i},render:()=>(0,S.jsx)(b.Z,{ariaLabel:e.caption,disabled:e.shouldHide,icon:e.icon,style:{...(0,c.X)({noDrag:t.isElectronMac}),position:"relative",marginLeft:10,...t.isMobile&&{height:"100%"},...e.style},iconStyle:{width:16,height:16},mobileFeedback:t.isMobile,onClick:e.onClick,className:d.Mfh,...o})})})}},94107:(e,t,o)=>{o.d(t,{Z:()=>T,l:()=>C});o(67294);var n=o(83355),i=o(480),s=o(24405),r=o(44292),a=o(9291),l=o(19719),d=o(24677),c=o(43250),u=o(34700),p=o(98742),h=o(48451),g=o(57538),m=o(74948),b=o(24646),v=o(36391),f=o(64970),S=o(88923),x=o(31945),y=o(73063),w=o(26388),M=o(85893);const j=(0,a.defineMessages)({updates:{id:"topbar.updatesButton.title",defaultMessage:"Updates"}});class k extends n.Z{constructor(){super(...arguments),this.peekStoreTarget=this.createComputedStore((()=>S.default.state.open&&S.default.state.target))}renderComponent(){const{spaceStore:e,buttonPopupStore:t,blockStore:o}=this.props,{device:n}=this.environment;if(this.peekStoreTarget.state!==o){const e=b.J5(this.environment)?(0,M.jsx)("div",{style:{textAlign:"center"},children:(0,M.jsx)(a.FormattedMessage,{defaultMessage:"Close all updates",id:"topbar.updatesButton.closeSidebartTooltip"})}):(0,M.jsx)("div",{style:{textAlign:"center"},children:(0,M.jsx)(a.FormattedMessage,{defaultMessage:"View all updates",id:"topbar.updatesButton.openSidebartTooltip"})});return f.m.state&&(I(this.props.blockStore,this.environment),f.m.setState(!1),l.Z8({environment:this.environment,pageId:o.pointer.id,isCurrentlyFollowing:(0,g.Z)(o.getFollowSettingsKey()).following,from:"email"})),(0,M.jsx)(w.ZP,{placement:w.ug.Bottom,renderTooltip:()=>e,render:e=>(0,M.jsx)(C,{...e,onClick:()=>I(this.props.blockStore,this.environment),hovered:b.J5(this.environment)&&!S.default.state.open}),children:e})}return(0,M.jsx)(x.ZP,{onClick:()=>{return e=this.environment,d.ZH(e),void l.gM(e);var e},disabled:!e,popupType:n.isMobile?x.Z4.SlideUp:x.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,M.jsx)(P,{buttonPopupEvents:e}),originGap:8,render:()=>(0,M.jsx)(h.tY,{blockStore:this.props.blockStore,spaceStore:this.props.spaceStore}),style:{width:440,overflow:"hidden"}})}}function C(e){window.__c={n:"TopbarUpdatesIcon"};const{isElectronMac:t}=(0,i.O7)().device,o=(0,a.useIntl)(),n=(0,s.yK)((e=>({icon:{height:20,width:20,fill:e.regularIconColor},button:{...(0,u.X)({noDrag:t}),width:33,height:28,marginRight:2}})),[t]);return(0,M.jsx)(y.Z,{icon:r.d,iconStyle:n.icon,style:n.button,ariaLabel:o.formatMessage(j.updates),className:c.K3y,...e})}k.displayName="TopbarUpdatesButton";const T=k;function P(e){let{buttonPopupEvents:t}=e;window.__c={n:"OriginComponent"};const o=(0,i.O7)(),{device:n}=o,s=(0,M.jsx)(a.FormattedMessage,{defaultMessage:"View past changes to this page",id:"topbar.updatesButton.tooltip"});return n.isMobile?null:(0,M.jsx)(w.ZP,{placement:w.ug.Bottom,renderTooltip:()=>s,render:e=>(0,M.jsx)(C,{...(0,p.Z)(t,e)})})}function I(e,t){m.handleSidebarButtonClick(t,e,v.gY.Updates,"topbar")}},42543:(e,t,o)=>{o.d(t,{DK:()=>b,Iw:()=>x,cE:()=>v,i3:()=>f,u1:()=>y,wq:()=>S});var n=o(6740),i=o(89101),s=o(19889),r=o(32441),a=o(47839),l=o(69915),d=o(95477),c=o(12534),u=o(67669),p=o(65598),h=o(24042),g=o(26136),m=o(16194);function b(e,t){const o=(0,p.Oh)(e),{id:n}=t.currentUser,i=n?g.U6.createChildStore(e,{table:s.KJ,id:n}):void 0,r=!i||i.isReady();return o&&r}function v(e,t){return!d.default.isAdminMode&&(0,u.IJ)(t,e)}i._j.signup,i._j.product;async function f(e){const{environment:t,route:o}=e;r.T3(t,{variant:"built_with_notion"}),await l.yF(t,{utmContent:"topbar_cta",nextRoute:o})}function S(e){e.target!==e.currentTarget||h.Z.state.isShowingTabBar||(0,c.ZP)({event:e,context:c.Af.EditorDoubleClick,callback:a.toggleMaximized})}function x(e){const t=e.target;t instanceof HTMLElement&&(0,n.E)(t)&&m.Z.setState(!0)}function y(){m.Z.setState(!1)}},71424:(e,t,o)=>{o.d(t,{EZ:()=>i,FD:()=>s,G5:()=>n,rK:()=>r});const n=220,i=24,s=-7,r=-3},90683:(e,t,o)=>{o.d(t,{a:()=>l});o(67294);var n=o(66897),i=o(97880),s=o(70301),r=o(45653),a=o(85893);function l(e){const{actor:t}=e,o={size:e.size??14,style:{marginRight:2,...e.style}};return(0,n.YU)(t)?(0,a.jsx)(s.Z,{botValue:t.asActor,...o}):(0,n.$S)(t)?(0,a.jsx)(r.Z,{userValue:t.asActor,...o}):(0,n.Iq)(t)?(0,a.jsx)(r.Z,{userValue:void 0,...o}):void(0,i.t1)(t)}},34700:(e,t,o)=>{function n(e){return"drag"in e&&e.drag?{WebkitAppRegion:"drag"}:"noDrag"in e&&e.noDrag?{WebkitAppRegion:"no-drag"}:{}}o.d(t,{X:()=>n})},26907:(e,t,o)=>{o.d(t,{B:()=>s,H:()=>n});const n=e=>{const{target:t,inviteTargetsStore:o}=e;return o.state.inviteTargets.some((e=>"newUser"===t.type?e.type===t.type&&t.value.email===e.value.email:"invalidUser"===t.type?e.type===t.type&&t.value.text===e.value.text:e.type===t.type&&e.value.id===t.value.id))};function i(e){return"invalidUser"!==e.type}const s=e=>{const{inviteTargetsStore:t}=e,{inviteTargets:o}=t.state;return o.filter(i)}},20095:(e,t,o)=>{o.d(t,{AQ:()=>u,EB:()=>d,MR:()=>c});o(57658);var n=o(72126),i=o(72141),s=o(63143),r=o(88893),a=o(88280),l=o(67669);function d(e){if(e&&e.blockId)return e.blockId}function c(e,t){const o=e.currentUser.id;if(t.userId===o)return!0;{const e=Date.now();return Boolean(t.present&&t.activityTimestampNearestMinuteMs&&e-t.activityTimestampNearestMinuteMs<=6e4)}}function u(e,t){const o=a.subscriptionDataStoreInstance.state,{remotePresenceData:d,rootStore:c}=t.state;if(!c||!c.canEdit()||!o)return[];let u=[];d&&n.M6(d,(e=>{e&&e.userId&&u.push(e)}));const{pageId:p,lastViewTime:h,lastExitTime:g,omittedUserIds:m,...b}=e.state;n.M6(b,(e=>{e.isDefined()&&u.push({userId:e.getUserId(),activityTimestampNearestMinuteMs:(0,s.ud)(e.getVisitedAt()),present:!1})})),u=n.mN(u,(e=>e.userId));const v=(0,l.YO)(c).map((e=>{let{permissionItem:t}=e;return t})).filter(i.jg).map((e=>e.user_id)),f=(0,r.CM)(o).map((e=>e.userId)),S=n.G0(v,f),x=new Set(m);return u=u.filter((e=>!!S.includes(e.userId)&&!(!e.present&&x.has(e.userId)))),u=n.MR(u,(e=>{let{activityTimestampNearestMinuteMs:t}=e;return t?-t:0})),u}},51811:(e,t,o)=>{o.d(t,{EX:()=>n,HB:()=>l,IS:()=>d,Tj:()=>a,yW:()=>r});let n=function(e){return e[e.Sidebar=0]="Sidebar",e[e.SidebarMobile=1]="SidebarMobile",e[e.MobileBottomBarPhone=2]="MobileBottomBarPhone",e[e.MobileBottomBarTablet=3]="MobileBottomBarTablet",e[e.TopbarMobile=4]="TopbarMobile",e[e.RenderAsPage=5]="RenderAsPage",e}({});const i=new Map,s=new Map;function r(e,t){i.set(c(e),t)}function a(e){return i.get(c(e))}function l(e,t){s.set(u(e),t)}function d(e){return s.get(u(e))??[]}function c(e){return Object.keys(e).sort().map((t=>{const o=e[t];return JSON.stringify(o)})).join("-")}function u(e){return Object.keys(e).sort().map((t=>{const o=e[t];return JSON.stringify(o)})).join("-")}},57538:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(57883),i=o(97880);function s(e){switch(e){case"all":return{following:!0,followSettings:(0,n.yI)({explicitly_set_by_user:!0})};case"important":return{following:!0,followSettings:(0,n.GC)({explicitly_set_by_user:!0})};case"comments":return{following:!0,followSettings:(0,n.r$)({explicitly_set_by_user:!0})};case"none":return{following:!1,followSettings:(0,n.vU)({explicitly_set_by_user:!0})};default:(0,i.t1)(e)}}},48451:(e,t,o)=>{o.d(t,{$H:()=>s,HX:()=>r,LV:()=>a,tY:()=>i});var n=o(77907);(0,n.lazyComponent)(n.deps.notifications,(e=>e.GetNotifiedFor));const i=(0,n.lazyComponent)(n.deps.notifications,(e=>e.TopbarUpdatesMenu)),s=(0,n.lazyComponent)(n.deps.notifications,(e=>e.UpdateSidebar)),r=(0,n.lazyComponent)(n.deps.notifications,(e=>e.NotificationInboxPanel)),a=(0,n.lazyComponent)(n.deps.notifications,(e=>e.MobileInboxPopup))},64719:(e,t,o)=>{o.d(t,{E:()=>z});var n=o(67294),i=o(480),s=o(86628),r=o(24405),a=o(64788),l=o(5257),d=o(56666),c=o(55964),u=o(80875),p=o(30681),h=o(54851),g=o(72126),m=o(9291),b=o(25888),v=o(79698),f=o(39634),S=o(64921),x=o(52275),y=o(31945),w=o(96525),M=o(78140),j=o(32163),k=o(72495),C=o(34700),T=o(87279),P=o(98742),I=o(95697),Z=o(4023),B=o(80444),_=o(30806),F=o(94841),E=o(36591),R=o(97880),L=o(58188),O=o(85893);const D={tasks:{key:"tasks",label:(0,O.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.tasks.label",defaultMessage:"My Tasks"})},tips:{key:"tips",label:(0,O.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.tips.label",defaultMessage:"Learn"})},templates:{key:"templates",label:(0,O.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.templates.label",defaultMessage:"Featured Templates"}),shouldShow:e=>{let{isMobile:t}=e;return!t}}},U=["tasks","tips","templates"];function V(e){let{parent:t}=e;window.__c={n:"HomeFeaturesMenu"};const o=(0,i.O7)(),a=(0,s.VK)((()=>U.map((e=>D[e])).filter((e=>{var t;return(null===(t=e.shouldShow)||void 0===t?void 0:t.call(e,o.device))??!0}))),[o.device]),l=(0,i.MO)(),d=(0,s.VK)((()=>B.default.state.currentSpaceViewStore),[]),c=(0,s.VK)((()=>(null==d?void 0:d.getHomeEnabledFeatures())??{}),[d]),u=(0,n.useCallback)((e=>{d&&L.aG({environment:o,currentSpaceViewStore:d,feature:e,from:"home_more_menu"})}),[d,o]),p=(0,r.yK)((e=>({selectedOptionCheck:{width:l?16:14},icon:{width:20,height:20}})),[l]);let h;h=l?{menuType:T.og.Modal,title:(0,O.jsx)(m.FormattedMessage,{id:"HomeFeaturesMenu.title",defaultMessage:"Experimental features"}),right:(0,O.jsx)(m.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:t.close}:{menuType:T.og.Popup,width:200};const g=[{key:"settings-item-section",render:e=>(0,O.jsx)(k.Z,{...e}),items:a.map((e=>{let{key:t,label:o}=e;return{key:t,action:()=>u(t),render:e=>(0,O.jsx)(x.Z,{...e,title:o,shouldWrapCaption:!0,right:Boolean(c[t])?(0,O.jsx)("div",{style:p.selectedOptionCheck,children:(0,E.e)()}):void 0})}}))}];return(0,O.jsx)(M.Z,{...h,children:(0,O.jsx)(j.Z,{type:j.i.Vertical,sections:g.filter(R.$K),initialFocus:void 0})})}const A=n.memo(V);var N=o(64964),K=o(38755),H=o(34980);function G(e){let{onClose:t}=e;window.__c={n:"OpenOnStartMenu"};const o=(0,i.O7)(),a=(0,s.VK)((()=>(0,H.o)()),[]),{isPhone:l,isElectron:d}=(0,i.Fy)(),c=(0,s.VK)((()=>(0,K.g4)(o,B.default.state.currentSpaceViewStore)),[o]),u=(0,n.useCallback)((e=>{const n=c;L.N({userAction:"userHomeActions.setPersonalHomeAsLandingPage",environment:o,option:e,from:"home_more_menu"}),N.d4({item:{label:(0,O.jsx)(m.FormattedMessage,{defaultMessage:"Updated default landing page",id:"openOnStartMenu.snackbar.updatedDefaultLandingPage"})},undoFunc:()=>L.N({userAction:"userHomeActions.setPersonalHomeAsLandingPage.undo",environment:o,option:n,from:"home_toast_undo_button"})}),t("selectedOption")}),[c,o,t]),p=(0,r.yK)((e=>({selectedOptionCheck:{width:l?16:14},icon:{width:20,height:20}})),[l]);let h;h=l?{menuType:T.og.Modal,title:(0,O.jsx)(m.FormattedMessage,{id:"openOnStartMenuSetting.title",defaultMessage:"Open on start"}),right:(0,O.jsx)(m.FormattedMessage,{defaultMessage:"Done",id:"settingItem.buttonPopup.done.label"}),onClickRight:()=>t("clickedDone")}:{menuType:T.og.Popup,width:250,onClickOutside:()=>t("clickedOutside")};const g=[{key:"settings-item-section",render:e=>(0,O.jsx)(k.Z,{...e}),items:a.map((e=>{let{key:t,label:o,renderIcon:n}=e;return{key:t,action:()=>u(t),render:e=>(0,O.jsx)(x.Z,{...e,title:o,icon:n(p.icon),shouldWrapCaption:!0,right:c===t?(0,O.jsx)("div",{style:p.selectedOptionCheck,children:(0,E.e)()}):void 0})}}))}];return(0,O.jsx)(M.Z,{...h,children:(0,O.jsx)(j.Z,{style:(0,C.X)({noDrag:d}),type:j.i.Vertical,sections:g,initialFocus:void 0})})}const W=n.memo(G);function z(e){window.__c={n:"HomeTopbarActionButtons"};const t=(0,i.O7)(),{device:o}=t,a=(0,i.MO)(),l=(0,s.VK)((()=>e.store.hasCover()),[e.store]),c=(0,s.VK)((()=>(0,I.QI)("dev_only")),[]),u=(0,n.useCallback)((()=>(0,_.lj)({environment:t})),[t]),h=(0,r.yK)((e=>({dotsIcon:{width:c&&l?12:18,height:c&&l?12:18,fill:e.regularIconColor},moreIconPhone:{width:26},pencilIcon:{width:20,height:20,padding:2},button:a?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",paddingLeft:8,paddingRight:8,marginRight:2,...c&&l?(0,F.Er)({theme:e,isPhone:a,buttonState:"base",hasCover:l}):{}}:{...(0,C.X)({noDrag:o.isElectron}),display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4,...c&&l?(0,F.Er)({theme:e,isPhone:a,buttonState:"base",hasCover:l}):{}},buttonHovered:l?(0,F.Er)({theme:e,isPhone:a,buttonState:"hovered"}):{},buttonPressed:l?(0,F.Er)({theme:e,isPhone:a,buttonState:"pressed"}):{},moreButtonStyle:a?{}:{width:250,maxHeight:"80vh"}})),[o,l,c,a]);return e.isInvalidPage?null:(0,O.jsx)(y.ZP,{popupType:a?y.Z4.SlideUp:y.Z4.Popup,renderOrigin:e=>(0,O.jsx)(S.Z,{style:h.button,hoveredStyle:c?h.buttonHovered:void 0,pressedStyle:c?h.buttonPressed:void 0,mobileFeedback:a,...(0,P.Z)(e,{onClick:u}),children:a?(0,p.I)(h.moreIconPhone):(0,d.o)(h.dotsIcon)}),render:e=>(0,O.jsx)(q,{mainMenuParent:e}),originGap:4,trapFocus:!0,forceInitialInbound:!0,style:h.moreButtonStyle})}function q(e){let{mainMenuParent:t}=e;window.__c={n:"HomeMoreMenu"};const{isPhone:o}=(0,i.Fy)(),n=(0,i.O7)(),d=(0,m.useIntl)(),p=(0,s.VK)((()=>B.default.state.mainEditorCurrentBlockStore),[]),S=(0,s.VK)((()=>(0,I.QI)("beta_wave_3_only")),[]),C=(0,s.VK)((()=>Boolean(null==p?void 0:p.getCover())),[p]),_=(0,r.yK)((e=>({coverPhotoIcon:{width:18,height:18,padding:2,marginLeft:1,marginRight:1},pageIcon:{width:20,height:20,padding:2},messageIcon:{width:20,height:20,padding:2},chevronRightIcon:{width:14,height:14,fill:e.lightIconColor},eyeIcon:{width:20,height:20}})),[]),F=[{key:"all",render:e=>(0,O.jsx)(k.Z,{...e}),items:g.oA([{key:"changeDefaultPage",render:e=>(0,O.jsx)(w.Z,{...e,stopClickPropagation:!0,popupType:o?y.Z4.SlideUp:y.Z4.Popup,render:e=>(0,O.jsx)(W,{onClose:o=>(e=>{let{immediateParent:o,closeMainParent:n}=e;o.close(),n&&t.close()})({immediateParent:e,closeMainParent:"selectedOption"===o})}),placementToOrigin:Z.u.Left,renderOrigin:t=>(0,O.jsx)(x.Z,{...(0,P.Z)(e,t),icon:(0,h.S)(_.pageIcon),right:(0,l.o)(_.chevronRightIcon),title:(0,O.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.changeStartPage",defaultMessage:"Change default start page"})})}),action:()=>{}},{key:"showHideTiles",render:e=>(0,O.jsx)(w.Z,{...e,stopClickPropagation:!0,popupType:o?y.Z4.SlideUp:y.Z4.Popup,render:e=>(0,O.jsx)(A,{parent:e}),placementToOrigin:Z.u.Left,renderOrigin:t=>(0,O.jsx)(x.Z,{...(0,P.Z)(e,t),icon:(0,c.N)(_.eyeIcon),right:(0,l.o)(_.chevronRightIcon),title:(0,O.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.showHideTiles",defaultMessage:"Show/hide tiles"})})}),action:()=>{}},{key:"manageCoverPhoto",render:e=>(0,O.jsx)(x.Z,{...e,icon:(0,a.P)(_.coverPhotoIcon),right:(0,l.o)(_.chevronRightIcon),onClick:e=>{if(!p)return;const t=e.currentTarget.getBoundingClientRect();v.j({environment:n,intl:d,store:p,rect:t})},title:C?(0,O.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.changeBackground",defaultMessage:"Change background"}):(0,O.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.addBackground",defaultMessage:"Add background"})}),action:()=>{}},S?{key:"provide-feedback",render:e=>(0,O.jsx)(x.Z,{...e,icon:(0,u.k)(_.messageIcon),title:(0,O.jsx)(m.FormattedMessage,{id:"HomeTopbarActionButtons.provideFeedback",defaultMessage:"Provide feedback"})}),action:()=>{b.V(n,{item:"help_feedback",from:"home_more_menu"}),f.j({environment:n,from:"help_button"})}}:void 0])}];return(0,O.jsx)(M.Z,{menuType:o?T.og.ActionSheet:T.og.Popup,children:(0,O.jsx)(j.Z,{type:j.i.Vertical,sections:F,initialFocus:void 0})})}},81170:(e,t,o)=>{o.d(t,{Z:()=>h});o(67294);var n=o(480),i=o(24405),s=o(84169),r=o(9291),a=o(12714),l=o(73063),d=o(26388),c=o(34700),u=o(94841),p=o(85893);const h=function(){window.__c={n:"TopbarTasksLearnMoreButton"};const e=(0,r.useIntl)(),t=(0,n.O7)(),o=(0,r.defineMessages)({helpTitle:{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}}),h=(0,i.yK)((e=>({iconStyle:{width:20,height:20,fill:e.regularIconColor},iconContainer:{width:33,height:28}})),[]);return(0,p.jsx)(d.ZP,{placement:d.ug.Bottom,renderTooltip:t=>e.formatMessage(o.helpTitle),render:n=>(0,p.jsx)(l.Z,{icon:()=>(0,s.m)(h.iconStyle),ariaLabel:e.formatMessage(o.helpTitle),style:{...(0,c.X)({noDrag:t.device.isElectronMac}),...h.iconContainer},onClick:e=>{e.preventDefault(),a.D({environment:t,url:u.h5,targetSelf:!1})},...n})})}},34980:(e,t,o)=>{o.d(t,{o:()=>d});o(57658),o(67294);var n=o(89968),i=o(54851),s=o(56996),r=o(9291),a=o(95697),l=o(85893);function d(){const e=[];return(0,a.QI)("dev_or_beta")&&e.push({key:"personal_home",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.home.label",defaultMessage:"Home"}),renderIcon:e=>(0,s.z)({width:20,height:20,...e})}),e.push({key:"last_visited_page",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.lastVisitedPage.label",defaultMessage:"Last visited page"}),renderIcon:e=>(0,n.Y)({width:20,height:20,...e})},{key:"first_page",label:(0,l.jsx)(r.FormattedMessage,{id:"pageOnAppStoreSetting.firstPage.label",defaultMessage:"Top page in sidebar"}),renderIcon:e=>(0,i.S)({width:20,height:20,padding:2,...e})}),e}},57345:(e,t,o)=>{o.d(t,{Cv:()=>k,a6:()=>j,lG:()=>M,qg:()=>P,zd:()=>T});o(67294);var n=o(33728),i=o(68626),s=o(91155),r=o(72141),a=o(4615),l=o(9291),d=o(50906),c=o(47307),u=o(76464),p=o(64964),h=o(19306),g=o(26907),m=o(67669),b=o(18245),v=o(88923),f=o(99332),S=o(29677),x=o(66708),y=o(28578),w=o(85893);function M(e){v.default.state.open?f.Z.setState({...f.Z.state,open:!0}):x.Z.setState({...x.Z.state,open:!0}),d.DB2(e,{share_menu_session_id:y.ZP.state.sessionId})}function j(e){v.default.state.open?f.Z.setState({...f.Z.state,open:!1}):x.Z.setState({...x.Z.state,open:!1}),d.Rb9(e,{share_menu_session_id:y.ZP.state.sessionId}),y.ZP.reset()}function k(e){const{success:t,inviteTargets:o,requestedUserEmails:n}=e;if(0!==o.length){if(!t||0!==(null==n?void 0:n.length))return t&&n.length>0?n.length===o.length?void p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage.requestedUsersOnly",defaultMessage:"Sent request to invite {users} to this page",values:{users:C(o)}})}):void p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage.requestedAndInvitedUsers",defaultMessage:"Invited {users} and requested inviting {numberOfRequestedUsers, plural, one {{numberOfRequestedUsers} guest} other {{numberOfRequestedUsers} guests}}",values:{users:C(o.filter((e=>!(0,S.fZ)(e)&&!(0,S.cl)(e)||!n.includes(e.value.email)))),numberOfRequestedUsers:n.length}})}):void p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteFailure.snackbarMessage",defaultMessage:"Failed to invite {users}",values:{users:C(o)}})});p.oV({label:(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.inviteSuccess.snackbarMessage",defaultMessage:"Successfully invited {users}",values:{users:C(o)}})})}}function C(e){return(0,h.W)(e.map((e=>"group"===e.type?e.value.name??"group":"invalidUser"===e.type?e.value.text:e.value.email)))}async function T(e){const{inviteTargetsStore:t}=e,o=(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),n=(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),i=(0,w.jsx)(l.FormattedMessage,{id:"shareMenu.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(t.state.inviteTargets.length>0){return(await c.confirmUserActionV2({message:o,acceptLabel:n,cancelLabel:i})).accept}return!1}async function P(e){const t=b.default.mark("share_menu.invite_user_lag"),{environment:o,blockStore:l,inviteTargetsStore:d,sudoModeStore:c,onInviteClick:p,onInviteComplete:h,inviteOrigin:v,role:f,emailMessage:S,flowId:x}=e;let y={success:!1,requestedUserEmails:[]};try{y=await async function(e){const{environment:t,blockStore:o,sudoModeStore:i,inviteTargetsStore:s,role:l,inviteOrigin:d,emailMessage:c,onInviteStart:p}=e,h=e.flowId||(0,a.ZP)();if(!(0,r.iC)(l))return{success:!1,requestedUserEmails:[]};const{tokenQuery:b,inviteTargets:v}=s.state;if((0,n.oH)(b.trim())&&0===v.length){const e={type:"newUser",value:{email:b.trim()},source:"email"};g.H({target:e,inviteTargetsStore:s})||s.setState({inviteTargets:[...s.state.inviteTargets,e],tokenQuery:""})}const f=m.mU(o,g.B({inviteTargetsStore:s}));null==p||p();const S=await u.n_({environment:t,store:o,sudoModeStore:i,inviteTargets:f,inviteRole:l,isOnboarding:!1,invite:{inviteFlowId:h,inviteMessage:c,inviteOrigin:d}});return{success:S.success,requestedUserEmails:S.success?Object.keys(S.requestedUsers):[]}}({environment:o,blockStore:l,sudoModeStore:c,inviteTargetsStore:d,role:f,emailMessage:S,inviteOrigin:v,onInviteStart:p,flowId:x})}catch(w){i.log({level:"error",from:"shareMenuActions",type:"handleInviteClick",error:(0,s.Ui)(w)})}finally{null==h||h(y.success,y.requestedUserEmails)}b.default.measure(t,{environment:o})}},41747:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(49085),i=o(92595),s=o(98180);class r extends n.default{getInitialState(){return{subTab:"by_topic",unreadAIContext:!1,skillRunStates:{}}}getUnreadAIContext(){return this.state.unreadAIContext}setUnreadAIContext(e){this.update((t=>({...t,unreadAIContext:e})))}getSubTab(){return this.state.subTab}setSubTab(e){this.update((t=>({...t,subTab:e})))}getSkillRunStatesWithSteps(){return Object.values(this.state.skillRunStates).map((e=>{if(e.aiSessionId){const t=function(e){const t=s.Z.getSessionContextOrThrow(e);if(!t.assistantRuntimeStore.state)return;const{clientSteps:o,temporaryClientSteps:n}=t.assistantRuntimeStore.state;return n.length>0?n.filter((e=>"assistantChat"===e.type)).pop():o.filter((e=>"assistantChat"===e.type)).pop()}(e.aiSessionId);return{...e,step:t}}return e}))}}const a=new r,l=a;(0,i.exposeDebugValue)("AiContextStore",a)},61436:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(49085),i=o(47839);class s extends n.default{getInitialState(){return{isFullScreen:!1}}constructor(){super(),this.updateFromElectronState=()=>{const e=i.fullscreen.get();void 0!==e&&this.setState({isFullScreen:e})},i.fullscreen.addListener(this.updateFromElectronState),this.updateFromElectronState()}}const r=new s},85834:(e,t,o)=>{o.d(t,{TG:()=>r,ZP:()=>l,uq:()=>s});var n=o(49085),i=o(4615);let s=function(e){return e.workspace_member="workspace_member",e.request_workspace_member="request_workspace_member",e.page_guest="page_guest",e.closed="closed",e}({}),r=function(e){return e[e.closed=0]="closed",e[e.share_page=1]="share_page",e[e.share_workspace=2]="share_workspace",e[e.request_workspace=3]="request_workspace",e}({});class a extends n.default{getInitialState(){return{inviteStage:r.closed,selection:s.workspace_member,order:[s.workspace_member,s.page_guest],invitedUsers:[],inviteTargets:[],invitedEmailToUserIdMap:{},flowId:(0,i.ZP)()}}startWorkspaceInvite(){this.setState({...this.state,inviteStage:r.share_workspace,order:[s.workspace_member,s.page_guest],selection:s.workspace_member})}startRequestMembership(){this.setState({...this.state,inviteStage:r.request_workspace,order:[s.request_workspace_member,s.page_guest],selection:s.request_workspace_member})}hasGuests(){return this.state.invitedUsers.some((e=>e.isGuest))}getGuestEmails(){return this.state.invitedUsers.filter((e=>e.isGuest)).map((e=>e.email))}}const l=a},55899:(e,t,o)=>{o.d(t,{KU:()=>s,ZP:()=>a,fZ:()=>i});var n=o(49085);function i(e){return"existingUser"===e.type}function s(e){return"newUser"===e.type&&"email"!==e.source}class r extends n.default{getInitialState(){return{tokenQuery:"",inviteTargets:[]}}}const a=r},92547:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085);class i extends n.default{getInitialState(){return{justUnlocked:!1}}}const s=i},1903:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(49085),i=o(21202);class s extends n.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"editor",isInviteTargetsEmpty:!0,table:i.iU,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const r=s},8675:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(49085),i=o(80444),s=o(77080),r=o(26136);class a extends n.default{getInitialState(){return{changePermissionsEnabled:!1,privatePageStore:void 0,loading:!1,error:void 0}}shouldSaveTransactionWithSudoMode(e){const t=e===this.state.privatePageStore,o=s.default.checkGate("enable_get_private_page_info_endpoint"),n=this.doesUserAlreadyHaveEditorAccessOnBlock(e.id);return t&&o&&this.state.changePermissionsEnabled&&!n}shouldUserHaveAccessToPrivatePageBlock(){var e,t;const o=null===(e=i.default.state.currentSpaceStore)||void 0===e?void 0:e.canAdmin(),n="enterprise"===(null===(t=i.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier());return this.state.privatePageStore&&o&&n}doesUserAlreadyHaveEditorAccessOnBlock(e){const t=i.default.state.currentSpaceStore;if(!t)return!1;return r.G.createChildStore(t,{table:"block",id:e}).canAdmin()}}const l=a},69150:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085);class i extends n.default{getInitialState(){return{isHovered:!1}}}const s=new i},52878:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),i=o(85834),s=o(1903);class r extends n.default{getInitialState(){return{permissionsInviteStore:new s.Z,contextualInviteStore:new i.ZP}}get stage(){return this.state.contextualInviteStore.state.inviteStage}}const a=r},21884:(e,t,o)=>{o.d(t,{E:()=>n});const n=o(49085).default.createValue({showConvertTooltip:!1,forceShow:!1})},96071:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085);class i extends n.default{getInitialState(){return{open:!1}}}const s=i},80503:(e,t,o)=>{o.d(t,{Aj:()=>i,R6:()=>r,TT:()=>n,br:()=>s,u3:()=>a});const n=52,i=45,s=37;function r(e){return e?s:i}function a(e){return 2*r(e)}}}]);