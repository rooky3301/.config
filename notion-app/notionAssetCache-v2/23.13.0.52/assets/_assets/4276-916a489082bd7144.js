"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4276],{5581:(e,i,t)=>{t.d(i,{Y:()=>o,h:()=>n});var s=t(77472);function n(e){s.j(e,"view_public_site_click")}function o(e,i){s.j(e,"share_menu_tab_click",i)}},3096:(e,i,t)=>{t.d(i,{J_:()=>d,a2:()=>l,oM:()=>a});var s=t(77907),n=t(88632),o=t(29026),r=t(29974);async function a(e){const{environment:i,spaceStore:t,domainName:s}=e;return await r._u({environment:i,spaceStore:t,domain:s}).then((e=>"success"!==e.type?"loading":e.data.domainState))}const l=async(e,i)=>{if(!n.Z.state.online)return[];const t=await s.deps.searchActions.loader(),r=await t.searchPublicPages({environment:i,query:e,source:"public_home_page_menu",limit:o.Xv});return""===e?r.splice(0,5):r};async function d(e){const{environment:i,spaceStore:t,domain:s,shouldUpdateDomain:n,publicHomePageId:o,shouldUpdatePublicHomePageId:a,onSubmit:l}=e;let d=!1,m=!0;n&&s&&(m=Boolean(await r.Y5({environment:i,spaceId:t.id,domain:s})),m&&(await r.u3({environment:i,spaceStore:t,domain:s}),d=!0)),m&&a&&o&&(await r.BR({environment:i,spaceStore:t,publicHomePage:o}),d=!0),d&&l()}},18878:(e,i,t)=>{t.d(i,{mX:()=>h,mo:()=>g,nH:()=>f});t(67294);var s=t(86628),n=t(24405),o=t(72141),r=t(97880),a=t(82990),l=t(9291),d=t(34859),m=t(80444),c=t(53336),u=t(63381),p=t(85893);function g(e){window.__c={n:"RestorePermissionEdits"};const{openState:i}=e,{mainEditorCurrentBlockStore:t,currentSpaceStore:o}=(0,s.VK)((()=>m.default.state),[]),r=(0,n.yK)((e=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290},editContainer:{marginTop:2,marginBottom:2,color:e.regularTextColor}})),[]);if(!t||!o)return null;const a=Date.now();return(0,p.jsx)(c.Z,{type:d.Z.Y,style:r.scroller,children:i.permissionChanges.map(((e,i)=>{let[s,n]=e;const l={timestamp:a,space_id:o.id,type:"permission-changed",permission_data:{before:s,after:n}};return(0,p.jsx)("div",{style:r.editContainer,children:(0,p.jsx)(u.Z,{rootStore:t,edit:l})},`${s.type}-${i}`)}))})}function f(e){return["remove","restrict"].includes(e.type)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccess",defaultMessage:"Restrict access"}):"restoreTeamPermissions"===e.type?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreTeamPermissions",defaultMessage:"Reset Permissions"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreAccess",defaultMessage:"Restore access"})}function h(e){switch(e.type){case"remove":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restrict.description",defaultMessage:"Are you sure you want to remove this {permissionGroup} and restrict access? This page will no longer inherit share settings from the parent page.",values:{permissionGroup:x(e)}});case"restrict":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.remove.description",defaultMessage:"Are you sure you want to change this role and restrict access? This page will no longer inherit share settings from the parent page."});case"restore":return e.permissionChanges.length>0?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restore.description",defaultMessage:"Are you sure you want to restore access? This will inherit the following permissions from the parent page:"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreNoChanges.description",defaultMessage:"Are you sure you want to restore access?"});case"restoreTeamPermissions":return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:{fontWeight:a.Z.fontWeight.semibold,marginBottom:4},children:(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.mainDescription",defaultMessage:"Are you sure you want to reset permissions to match the teamspace defaults?"})}),(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.warningMessage",defaultMessage:"Everyone else who is not part of the teamspace will lose access, including guests."})]});default:throw r.t1(e)}}function x(e){return(0,o.jg)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.user",defaultMessage:"user"}):(0,o.hV)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.group",defaultMessage:"group"}):(0,o.ix)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.space",defaultMessage:"workspace"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.generic",defaultMessage:"permission"})}},31075:(e,i,t)=>{t.d(i,{i:()=>h});t(21703),t(57658),t(67294);var s=t(86517),n=t(23867),o=t(9291),r=t(91536),a=t(54642),l=t(47307),d=t(76464),m=t(82530),c=t(64369),u=t(18878),p=t(18245),g=t(77080),f=t(85893);async function h(e){const{oldPermissionItem:i,newPermissionItem:t,wasInherited:h,environment:x,store:b,sudoModeStore:P,restrictingVisibility:y,fromPermissionWrapper:S}=e;if(!(0,s.Kf)(i,t))throw new Error("Permission type mismatch.");const w=!!P&&P.shouldSaveTransactionWithSudoMode(b),M=(0,s.nl)(i.role,t.role);if(h&&M!==t.role||y)return void(await async function(e){const{environment:i,useSudoMode:t,store:s,permissionItem:n,fromPermissionWrapper:r}=e,a="none"===n.role?{type:"remove",permissionItem:n}:{type:"restrict"},p="user_permission"===n.type&&n.user_id===i.currentUser.id;(p||await l.confirmUserAction({message:(0,u.mX)(a),acceptLabel:(0,u.nH)(a),cancelLabel:(0,f.jsx)(o.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,f.jsx)(c.Z,{isSmall:!0,isMultiline:!0,children:(0,f.jsx)(o.FormattedMessage,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."})})}))&&m.createAndCommit({userAction:"PermissionItem.onAccept",environment:i,useSudoMode:t,perform:e=>{d.Pk({environment:i,store:s,permissionItem:n,shouldInherit:!0,transaction:e,fromPermissionWrapper:r})}})}({environment:x,useSudoMode:w,store:b,permissionItem:t,fromPermissionWrapper:S}));!b.isTopLevel()&&i.role!==t.role&&M!==i.role&&r.SM(x);const v="public_permission"===i.type&&"public_permission"===t.type&&!i.allow_search_engine_indexing&&t.allow_search_engine_indexing&&Boolean(g.default.checkGate("enable_public_content_scanning"));m.createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:x,useSudoMode:w,perform:i=>{const s=p.default.mark("share_menu.update_page_permission_lag");d.ep({environment:x,store:b,permissionItems:[t],transaction:i,pagePermissionChangeLocation:e.location,metric:s,fromPermissionWrapper:S}),v&&i.postSubmitCallbacks.push((async e=>{e||await a.enqueueScanContentTask(x,{pagePointer:{id:b.id,table:"block",spaceId:(0,n.C)(b.pointer.spaceId)}})}))}})}},32326:(e,i,t)=>{t.d(i,{x:()=>a});var s=t(67294),n=t(24405),o=t(91376),r=t(85893);function a(e){window.__c={n:"DomainWorkspaceSettingsLink"};const{children:i}=e,t=(0,s.useCallback)((()=>{o.r$({currentTab:"settings"})}),[]),a=(0,n.yK)((e=>({settingsLink:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:e.mediumTextColor,textDecoration:"underline"}})),[]);return(0,r.jsx)("span",{style:a.settingsLink,onClick:t,children:i})}},259:(e,i,t)=>{t.d(i,{V:()=>u});t(67294);var s=t(480),n=t(86628),o=t(24405),r=t(9291),a=t(64369),l=t(80444),d=t(81236),m=t(32326),c=t(85893);function u(e){window.__c={n:"LearnAboutAutogeneratedDomainsCTA"};const i=(0,s.O7)(),{WindowSizeStore:t}=i,{safePaddingLeftCSS:u,safePaddingRightCSS:p}=(0,n.VK)((()=>({safePaddingLeftCSS:t.getSafePaddingLeftCSS(8),safePaddingRightCSS:t.getSafePaddingRightCSS(8)})),[t]),{isMobile:g}=(0,s.Fy)(),{spaceStore:f,canChangeSettings:h,publicSpaceData:x}=(0,n.VK)((()=>{const e=l.default.state.currentSpaceStore;return e?{spaceStore:e,canChangeSettings:e.canAdmin(),publicSpaceData:d.Z.getPublicSpaceData(i,e.id)}:{}}),[i]),b=(0,o.yK)((i=>({container:{boxShadow:`0 -1px 0 ${i.regularDividerColor}`,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:u,paddingRight:p,color:i.mediumTextColor,backgroundColor:i.inputBackground,...e.style}})),[e.style,u,p]);if(!f)return null;if(g)return null;if(!x)return null;return(e.ignoreAutogeneratedStatus||x.domainIsAutogenerated)&&h?(0,c.jsx)("span",{style:b.container,children:(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)(a.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"},children:e.title?e.title:(0,c.jsx)(r.FormattedMessage,{defaultMessage:"You can set up a public domain in your <settings>workspace settings</settings>.",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks",values:{settings:e=>(0,c.jsx)(m.x,{children:e})}})})})}):null}},21267:(e,i,t)=>{t.d(i,{Z:()=>he});var s=t(67294),n=t(480),o=t(86628),r=t(24405),a=t(15145),l=t(41892),d=t(9999),m=t(39226),c=t(40462),u=t(84169),p=t(27714),g=t(72141),f=t(21202),h=t(70203),x=t(82990),b=t(9291),P=t(50906),y=t(5581),S=t(893),w=t(91376),M=t(12714),v=t(42922),I=t(64921),j=t(61519),C=t(73063),_=t(74194),k=t(63296),T=t(24006),Z=t(26388),L=t(64369),F=t(60442),A=t(4708),D=t(84210),R=t(33929),B=t(18514),W=t(38755),U=t(31075),V=t(68973),K=t(80444),O=t(77080),E=t(81236),G=t(54669),H=t(88893),N=t(259),z=t(13991),Y=t(7057),$=t(42853),J=t(72126),q=t(63143),Q=t(52275),X=t(31945),ee=t(78140),ie=t(32163),te=t(89728),se=t(72495),ne=t(93289),oe=t(42782),re=t(28020),ae=t(43250),le=t(87279),de=t(61766),me=t(31194),ce=t(85893);function ue(e){window.__c={n:"PublicPermissionItemLinkExpirationMenu"};const i=(0,n.Fy)(),[,,t]=(0,o.AF)(void 0,de.Z),s=(0,r.Fg)(),a=(0,n.O7)(),l=(0,o.VK)((()=>(0,H.y$)(a)),[a]),{buttonMenuItemStyle:d}=(0,r.yK)((()=>({buttonMenuItemStyle:{opacity:e.disabled?.6:1,cursor:e.disabled?"not-allowed":""}})),[e.disabled]);return(0,ce.jsx)(X.ZP,{...e.upsellEvents,disablePopup:!l,disabled:e.disabled,popupType:i.isMobile?X.Z4.SlideUp:X.Z4.Popup,buttonPopupStore:t,renderOrigin:i=>(0,ce.jsx)(Q.Z,{...i,focused:!1,disabled:e.disabled,style:d,title:(0,ce.jsxs)(L.Z,{children:[(0,ce.jsx)(b.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expiration"})," ",e.upgradeLabel]}),right:(0,ce.jsxs)(te.Z,{...i,disabled:e.disabled,ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0},children:[(0,ce.jsx)(pe,{permissionItem:e.permissionItem}),(0,$.i)({width:10,marginLeft:4,fill:s.lightIconColor})]})}),alignmentToOrigin:me.lU.End,placementToOrigin:me.Iw.Bottom,render:t=>{const s=[{key:"options",render:e=>(0,ce.jsx)(se.Z,{...e}),items:fe().map((i=>({key:i.type,action:()=>{ge(e,a,i.time),t.close()},render:e=>(0,ce.jsx)(Q.Z,{...e,focused:e.focused,disabled:!1,title:i.title,caption:i.caption})})))},{key:"custom",render:e=>(0,ce.jsx)(se.Z,{...e,topBorder:!0}),items:[{key:"custom",action:()=>{t.close()},render:(i,s)=>(0,ce.jsx)(oe.Z,{...i,renderOrigin:e=>(0,ce.jsx)(Q.Z,{...e,disabled:!1,title:(0,ce.jsx)(b.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})}),onFocus:s.onFocus,disableDefaultClick:!0,renderExtension:(i,s)=>(0,ce.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,ce.jsx)(ne.Z,{...i,firstDayOfWeek:re.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:i=>{ge(e,a,i),s.close(),t.close()},disabledDays:{before:new Date}})})})}]}];let n;return n=i.isMobile?{menuType:le.og.Modal,title:(0,ce.jsx)(b.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:(0,ce.jsx)(b.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:t.close}:{menuType:le.og.Popup,width:264},(0,ce.jsx)(ee.Z,{className:ae.IpQ,...n,children:(0,ce.jsx)(ie.Z,{type:ie.i.Vertical,initialFocus:void 0,sections:s})})}})}function pe(e){const{permissionItem:i}=e;return!i.expiration_timestamp||(0,g.o7)(i)?(0,ce.jsx)(b.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"}):(0,ce.jsx)(L.Z,{children:e.permissionItem.expiration_timestamp&&(0,Y.tv)(e.permissionItem.expiration_timestamp,z.SP)})}function ge(e,i,t){const{permissionItem:s,onChange:n}=e;if("public_permission"!==s.type)return;if(void 0!==t&&t<=(new Date).getTime())return;const o=s,r=J.d9(o),a=t;r.expiration_timestamp=a,n(r),P.n4j(i,{expiration_time:a})}function fe(){const e=(new Date).getTime()+q.U6,i=(new Date).getTime()+q.A0,t=(new Date).getTime()+7*q.A0;return[{type:"never",time:void 0,title:(0,ce.jsx)(b.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:(0,ce.jsx)(b.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(z.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:i,title:(0,ce.jsx)(b.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(z.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)},{type:"week",time:t,title:(0,ce.jsx)(b.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(z.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)}]}function he(e){window.__c={n:"PublishToWebSettings"};const{store:i,mostPermissivePublicItem:t,permissionItemArgs:l,shouldAskForConfirmationOnPublish:p,onUnpublish:g,showAllPublishedSites:P}=e,{permissionItem:S,from:_}=t,{sudoModeStore:T,location:F,onUpgradeButtonClick:R}=l,O=(0,n.O7)(),{isMobile:G}=O.device,H=(0,o.VK)((()=>{const e=K.default.state.currentSpaceStore;return(0,A.T2)()&&!G&&!(0,W.Cx)(e)&&P}),[G,P]),z=(0,o.VK)((()=>{const e=O.WindowSizeStore;return{paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14),fontWeight:x.Z.fontWeight.semibold}}),[O]),Y=(0,o.VK)((()=>{const e=O.WindowSizeStore;return{marginLeft:e.getSafePaddingLeftCSS(14),marginRight:e.getSafePaddingRightCSS(14)}}),[O]),$=(0,r.yK)((e=>({titleContainer:{color:e.blueColor,fontWeight:x.Z.fontWeight.medium,fontSize:14,display:"flex",alignItems:"center",margin:"0px 16px 10px",paddingTop:G?4:0},title:{display:"flex",alignItems:"center",color:e.blueColor,fontWeight:x.Z.fontWeight.medium},helpIcon:{width:16,height:16,fill:e.blueColor},icon:{height:16,width:16,marginRight:6},linkSharingOptions:{marginTop:10,marginBottom:15,marginLeft:2,marginRight:2},learnAboutDomainsCTA:{fontSize:14,marginTop:3,marginLeft:6,marginRight:6,padding:0,backgroundColor:void 0,boxShadow:void 0,textAlign:"left",alignItems:"flex-start"},buttonGroup:{marginLeft:14,marginRight:14,marginTop:16,marginBottom:12,display:"flex",gap:10},button:{flexGrow:1,height:34},disabledButton:{opacity:.7,cursor:"not-allowed"},allSitesButton:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:12,padding:4,borderRadius:4,...Y},aliasIcon:{marginRight:4,height:16,width:16,fill:e.mediumTextColor},divider:{color:e.regularDividerColor}})),[G,Y]),J=(0,o.VK)((()=>!i.canAdmin()),[i]),q=_.table===f.iU?_.blockId:_.teamId,Q=(0,s.useCallback)((e=>{(0,U.i)({oldPermissionItem:S,newPermissionItem:{...S,...e},wasInherited:q!==i.id,environment:O,store:i,sudoModeStore:T,location:F})}),[S,q,i,O,T,F]),X=(0,s.useCallback)((async()=>{let e=!0;p&&(e=await V.eT(h.QaF(i.getTitleValue()))),e&&(Q({role:"none"}),g&&g())}),[Q,g,p,i]),ee=(0,o.VK)((()=>(0,D.ZP)({store:i,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=E.Z.getPublicSpaceData(O,i.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:a.tY.LinkInPage})),[i,O]),ie=(0,s.useCallback)((()=>{y.h(O),M.D({url:ee,environment:O})}),[O,ee]),te=(0,s.useCallback)((()=>{w.r$({currentTab:"sites"})}),[]);return(0,ce.jsxs)("div",{children:[(0,ce.jsxs)("div",{style:$.titleContainer,children:[(0,m.v)($.icon),(0,ce.jsx)("div",{style:$.title,children:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"This page is live on the web.",id:"publishTab.settings.liveOnWeb.title"})}),(0,ce.jsx)(C.Z,{iconStyle:$.helpIcon,onClick:()=>{M.D({environment:O,url:(0,B.UY)("guides.autogeneratedDomains")})},icon:u.m,ariaLabel:"Learn more about sites"})]}),(0,ce.jsx)(L.Z,{isSmall:!0,style:z,children:(0,ce.jsx)(b.FormattedMessage,{id:"publishTab.settings.liveOnWeb.linkCaption",defaultMessage:"Direct site link"})}),(0,ce.jsx)(N.V,{style:$.learnAboutDomainsCTA}),(0,ce.jsx)(xe,{currentBlockStore:i}),(0,ce.jsxs)("div",{style:$.linkSharingOptions,children:[(0,ce.jsx)(L.Z,{isSmall:!0,style:z,children:(0,ce.jsx)(b.FormattedMessage,{id:"publishTab.settings.liveOnWeb.siteCaptions",defaultMessage:"Site actions"})}),(0,ce.jsx)(Pe,{currentBlockStore:i,permissionItem:S,onChange:Q,onUpgradeButtonClick:R})]}),(0,ce.jsx)(j.Z,{size:1,innerStyle:$.divider}),(0,ce.jsxs)("div",{style:$.buttonGroup,children:[(0,ce.jsx)(Z.ZP,{disableTooltip:!J,renderTooltip:()=>(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"You must have full access to this page to unpublish it",id:"publishTab.settings.liveOnWeb.unpublishTooltip"}),render:e=>(0,ce.jsx)(k.Z,{onClick:X,disabled:J,style:J?{...$.button,...$.disabledButton}:$.button,...e,children:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Unpublish",id:"publishTab.settings.liveOnWeb.unpublish"})})}),(0,ce.jsxs)(v.Z,{onClick:ie,style:$.button,children:[(0,c.o)({height:16,width:16,marginRight:4}),(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"View site",id:"publishTab.settings.liveOnWeb.viewSite"})]})]}),H?(0,ce.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,ce.jsxs)(I.Z,{onClick:te,style:$.allSitesButton,children:[(0,d.J)($.aliasIcon),(0,ce.jsx)(L.Z,{isSecondaryColor:!0,children:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"All published sites",id:"publishTab.settings.liveOnWeb.allSites"})})]})}):null]})}function xe(e){window.__c={n:"PageLinkButton"};const{currentBlockStore:i}=e,t=(0,n.O7)(),l=(0,o.VK)((()=>be(t)),[t]),d=(0,r.yK)((e=>({container:{...l,height:"auto"},flex:{flex:1},wrapper:{display:"flex",padding:"1px 0"},input:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0},button:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}})),[l]),m=(0,o.VK)((()=>(0,D.ZP)({store:i,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=E.Z.getPublicSpaceData(t,i.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:a.tY.CopyLink})),[i,t]),c=(0,s.useCallback)((()=>{t.mobileNative?t.mobileNative.copyText(m,R.default.formatMessage(S.tq.copiedLinkToClipboard)):S.RD({environment:t,stringValue:m,copiedMessage:S.tq.copiedLinkToClipboard}),P.c7L(t)}),[t,m]);return(0,ce.jsx)("div",{style:d.container,children:(0,ce.jsx)("div",{style:d.flex,children:(0,ce.jsxs)("div",{style:d.wrapper,children:[(0,ce.jsx)(_.Z,{value:m,disabled:!0,style:d.input}),(0,ce.jsx)(k.Z,{onClick:c,style:d.button,icon:p.N})]})})})}function be(e){const i=e.WindowSizeStore;return{display:"flex",alignItems:"center",width:"100%",height:e.device.isMobile?36:30,paddingTop:5,paddingBottom:5,paddingLeft:i.getSafePaddingLeftCSS(14),paddingRight:i.getSafePaddingRightCSS(14)}}function Pe(e){window.__c={n:"PageLinkOptions"};const{permissionItem:i,onUpgradeButtonClick:t,onChange:a,currentBlockStore:l}=e,d=(0,n.O7)(),m=(0,o.VK)((()=>!l.canAdmin()),[l]),c=(0,o.VK)((()=>{var e;return Boolean(null===(e=K.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())}),[]),u=g.RF(i.role),p=!1!==i.allow_duplicate,f=g.J5(i.role),h=Boolean(i.allow_search_engine_indexing),x=(0,s.useCallback)((()=>{a({role:f?"comment_only":"read_and_write"})}),[f,a]),y=(0,s.useCallback)((()=>{a({role:u?"reader":"comment_only"})}),[u,a]),S=(0,s.useCallback)((()=>{const e=!h;a({allow_search_engine_indexing:e}),P.g0v(d,{allow_search_engine_indexing:e})}),[d,a,h]),w=(0,s.useCallback)((()=>{const e=!p;a({allow_duplicate:e}),P.l7z(d,{allow_duplicate:e})}),[p,d,a]),M=(0,o.VK)((()=>O.default.checkGate("expiring_public_links")),[]),v=(0,o.VK)((()=>!(0,H.y$)(d)&&(0,H.M9)(d)),[d]),j=(0,o.VK)((()=>!(0,A.H1)()&&(!(0,H.f3)(d)&&(0,H.M9)(d))),[d]),C=(0,o.VK)((()=>be(d)),[d]),_=(0,o.VK)((()=>m||c&&!p),[m,p,c]),k=(0,r.yK)((()=>({container:{display:"flex",flexDirection:"column",marginTop:8},optionLabel:{marginRight:"auto",opacity:m?.6:1},optionButton:m?{...C,cursor:"not-allowed"}:C})),[m,C]);return(0,ce.jsxs)("div",{style:k.container,children:[(0,ce.jsxs)(ce.Fragment,{children:[M&&(0,ce.jsx)(G.Z,{alwaysAllowClick:Boolean(i.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:v,tooltipPlacement:Z.ug.Left,renderTooltip:we,renderUpgradeTooltip:Me,onUpgradeClick:t,render:(e,t)=>(0,ce.jsx)(ue,{upsellEvents:e,upgradeLabel:t,permissionItem:i,onChange:a,disabled:m})}),(0,ce.jsx)(Z.ZP,{placement:Z.ug.Left,renderTooltip:ye,render:e=>(0,ce.jsxs)(I.Z,{onClick:x,style:k.optionButton,disabled:m,...e,children:[(0,ce.jsx)(L.Z,{style:k.optionLabel,children:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})}),(0,ce.jsx)(T.Z,{on:f,onClick:x,disabled:m})]})}),(0,ce.jsx)(Z.ZP,{placement:Z.ug.Left,renderTooltip:Se,render:e=>(0,ce.jsxs)(I.Z,{onClick:y,style:k.optionButton,disabled:m,...e,children:[(0,ce.jsx)(L.Z,{style:k.optionLabel,children:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Allow commenting",id:"pagePermissionItem.allowComments.setting"})}),(0,ce.jsx)(T.Z,{on:u,onClick:y,disabled:m})]})})]}),(0,ce.jsx)(Z.ZP,{placement:Z.ug.Left,renderTooltip:c&&!p?Ie:ve,render:e=>(0,ce.jsxs)(I.Z,{onClick:w,disabled:_,style:k.optionButton,...e,children:[(0,ce.jsx)(L.Z,{style:k.optionLabel,children:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})}),(0,ce.jsx)(T.Z,{on:p,onClick:w,disabled:_})]})}),(0,ce.jsx)(G.Z,{requireUpgradeToTier:j,alwaysAllowClick:i.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:S,onUpgradeClick:t,tooltipPlacement:Z.ug.Left,renderTooltip:we,renderUpgradeTooltip:Me,render:(e,i)=>(0,ce.jsxs)(I.Z,{style:k.optionButton,disabled:m,...e,children:[(0,ce.jsxs)(L.Z,{style:k.optionLabel,children:[(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",i]}),(0,ce.jsx)(T.Z,{on:h,onClick:S,disabled:m||Boolean(i)})]})})]})}function ye(){return(0,ce.jsx)(F.Z,{caption:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowEditingPng})}function Se(){return(0,ce.jsx)(F.Z,{caption:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowCommentsPng})}function we(){return(0,ce.jsx)(F.Z,{caption:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowSearchEnginesPng})}function Me(){return(0,ce.jsx)(F.Z,{imageURL:l.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})}function ve(){return(0,ce.jsx)(F.Z,{caption:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowDuplicatePng})}function Ie(){return(0,ce.jsx)(F.Z,{caption:(0,ce.jsx)(b.FormattedMessage,{defaultMessage:"This workspace does not allow page duplication to other workspaces.",id:"pagePermissionItem.duplicateTemplateDisabled.tooltip"}),imageWidth:240})}},90335:(e,i,t)=>{t.d(i,{HB:()=>h,Np:()=>f,bQ:()=>g,gi:()=>x,mk:()=>y,pR:()=>b,up:()=>p});var s=t(72126),n=t(86517),o=t(72141),r=t(21202),a=t(15047),l=t(29369),d=t(98165),m=t(67669),c=t(80444),u=t(26136);function p(e){const{store:i,showRestrictedPermissionBanner:t}=e,{canAccessParent:s}=h({store:i});return s&&(t||f({store:i}))}function g(e){const{store:i}=e;if(i.getParentTable()===a.bx)return;const t=(0,d.Om)(i);if(!t)return;const s=(0,n.Wo)((0,d.fJ)(t));for(const n of s)if((0,o.ix)(n))return n}function f(e){const{store:i}=e;if(i.getParentTable()===a.bx)return!1;const t=(0,d.Om)(i),s=t?(0,n.Wo)((0,d.fJ)(t)):[],r=i.getPermissionItems(),l={};for(const o of s)l[(0,n.OC)(o)]=o;for(const a of r){const e=a.role,i=l[(0,n.OC)(a)];if(i){if((0,o.iC)(e)&&(0,o.iC)(i.role)&&(0,n.xO)(e,i.role))return!0;if(o.KF(i)&&!o.KF(a))return!0}else if((0,o.ix)(a)||(0,o.ZQ)(a)||(0,o.RI)(a))return!0}return!1}function h(e){const{store:i}=e,t=(0,d.uJ)(i)[1];return{parentStore:t,canAccessParent:t&&t.canRead()}}function x(e){const{store:i}=e,t=(0,d.uJ)(i),s=t.find((e=>e instanceof u.G&&e.isRestricted())),n=t[t.length-1];return s||n.getParentTable()===a.bx&&n.canRead()}function b(e){const{store:i}=e,t=(0,d.VP)(i),s=c.default.state.currentSpaceStore;return Boolean((null==s?void 0:s.getDisableGuests())||(null==t?void 0:t.getDisableGuests()))}function P(e){const{mostPermissivePermissions:i,store:t,ancestorTeamId:s,type:n}=e;if(!s)return;const a=i.find((e=>{let{permissionItem:i}=e;return i.type===n&&i.team_id===s}));if(a)return a;const l=i.find((e=>{let{permissionItem:i}=e;return o.Le(i)}));return"explicit_team_guest_permission"!==n||l?{permissionItem:{type:n,role:"none",team_id:s},from:(null==l?void 0:l.from)??{table:r.iU,blockId:t.id}}:void 0}function y(e){const{spaceStore:i,store:t}=e,n=(0,m.YO)(t);let a=[];i&&(a=i.getPermissionGroups());const c=d.VP(t),u=function(e){let{mostPermissivePermissions:i,store:t}=e;return i.find((e=>{let{permissionItem:i}=e;return o.$D(i)}))||{permissionItem:{type:"public_permission",role:"none"},from:{table:r.iU,blockId:t.id}}}({mostPermissivePermissions:n,store:t}),p=function(e){let{mostPermissivePermissions:i,store:t,teamStore:s}=e;const n=i.find((e=>{let{permissionItem:i}=e;return o.ix(i)}));if(n)return n;const a=i.find((e=>o.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=a&&a.from||!s||"none"!==s.getSpacePermissionRole()?(null==a?void 0:a.from)??{table:r.iU,blockId:t.id}:{table:l.e0,teamId:s.id}}}({mostPermissivePermissions:n,store:t,teamStore:c}),g=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_guest_permission"}),f=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_permission"}),h=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_owner_permission"});let x=n.filter((e=>{let{permissionItem:i}=e;return o.hV(i)}));x=s.MR(x,(e=>{if(i){return i.getPermissionGroups().findIndex((i=>i.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let b=n.filter((e=>{let{permissionItem:i}=e;return(o.zU(i)||o.LW(i))&&i.team_id!==(null==c?void 0:c.id)}));const y=new Map;b.forEach(((e,i)=>{let{permissionItem:t}=e;y.has(t.team_id)||y.set(t.team_id,i)})),b=s.MR(b,[e=>{let{permissionItem:i}=e;return y.get(i.team_id)||0},e=>{let{permissionItem:i}=e;return"explicit_team_owner_permission"===i.type?0:1}]);const S=n.filter((e=>{let{permissionItem:i}=e;return o.jg(i)})),w=Boolean(null==c?void 0:c.isDefined()),M="none"!==p.permissionItem.role,v=M||w||S.length>1||S.length&&!o.zz(S[0].permissionItem.role)||x.length||o.YX(p.permissionItem.role);return{showRestrictedPermissionBanner:n.some((e=>o.Le(e.permissionItem)&&e.from.table===r.iU&&e.from.blockId===t.id)),showTeamPermission:w,showSpacePermission:M,mostPermissivePublicItem:u,mostPermissiveAncestorTeamOwnerItem:h,mostPermissiveAncestorTeamMemberItem:f,mostPermissiveAncestorTeamGuestItem:g,mostPermissiveSpaceItem:p,pagePermissionUIModel:{showUserPermissions:v,mostPermissiveGroupPermissions:x,mostPermissiveTeamPermissions:b,mostPermissiveUserPermissions:S,spacePermissionGroups:a},permissionItemsCount:(v?S.length:0)+b.length+x.length+(M?1:0)+(w?1:0)}}}}]);