"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[7866],{45669:(e,t,o)=>{o.d(t,{Z:()=>a});o(67294);var r=o(9291),i=o(78316),s=o(62896),n=o(85893);const a=function(e){let{collectionViewName:t,collectionViewType:o}=e;return t?(0,n.jsx)(s.Z,{children:t}):"page"===o?(0,n.jsx)(r.FormattedMessage,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,n.jsx)(r.FormattedMessage,{...i.b1[o]})}},23160:(e,t,o)=>{o.r(t),o.d(t,{default:()=>oe});o(57658);var r=o(67294),i=o(83355),s=o(480),n=o(86628),a=o(24405),l=o(40902),d=o(15145),c=o(41432),u=o(39068),h=o(68626),p=o(55061),g=o(89101),m=o(21202),v=o(6287),b=o(13493),f=o(70279),y=o(33709),A=o(15047),S=o(99108),O=o(97880),x=o(9291),j=o(26136),M=o(1136),k=o(45669),_=o(84076),T=o(63381),w=o(13658),P=o(17022),R=o(90060),B=o(12472),C=o(36081),I=o(22649),Z=o(78976),V=o(74970),E=(o(92996),o(23867)),F=o(70203),D=o(82990),L=o(19719),N=o(95306),K=o(60682),U=o(14976),W=o(98165),z=o(62385),G=o(92559),X=o(85893);function Y(e){let{activity:t,tabArgs:o,rootStore:i,isLast:a}=e;window.__c={n:"CommentActivityUpdate"};const l=(0,n.VK)((()=>t.getEdits()),[t]),{source:c,tab:u,notification:h}=o;let p=l.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":return!0;default:(0,O.t1)(e)}}));0===p.length&&0!==l.length&&"updates_sidebar"!==c&&(p=l);const g=p.length>0,v=(0,s.O7)(),b=(0,n.VK)((()=>{const e=i.getRecordStore(i,{table:y.qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,i]),f=(0,n.VK)((()=>{const e=null==b?void 0:b.getParentPointer();if(e)return j.G.createChildStore(i,e)}),[b,i]),A=(0,n.VK)((()=>Boolean(f&&f.isDefined())),[f]),S=(0,n.VK)((()=>{const e=null==f?void 0:f.getNavigableBlockStore();return(null==e?void 0:e.id)||t.navigable_block_id}),[t,f]),M=j.G.createChildStore(i,{table:m.iU,id:S}),k=(0,n.VK)((()=>M.isDefined()),[M]),B=(0,n.VK)((()=>Boolean(f&&(0,W.fl)((0,W.qA)(f)))),[f]),C=(0,n.VK)((()=>{if(!B||!f)return;const e=f.getModel();return e?e.getRenderUrl({getRecordModel:i.getRecordModel,discussionId:t.discussion_id,pageVisitSource:d.tY.Notification}):void 0}),[B,f,i,t]),E=(0,n.VK)((()=>(0,R.P6)({edits:p,rootStore:i})),[p,i]),F=(0,n.VK)((()=>(0,R.XW)(E)),[E]),D=B,L=(0,r.useCallback)((e=>{if((0,P.dG)({...o,environment:v,activity:t,mightCloseTab:D}),!B&&f&&b){var r;const i=e.target;N.oK({environment:v,discussionStore:b,rect:i.getBoundingClientRect(),blockStore:f,discussionLocation:J({forReplyMenu:!0,source:o.source}),activityId:t.id,notificationId:null===(r=o.notification)||void 0===r?void 0:r.id})}}),[t,B,f,b,v,o,D]),K=(0,r.useCallback)((()=>{(0,P.BE)({...o,environment:v,activity:t,mightCloseTab:D})}),[o,v,t,D]),U=(0,X.jsx)(Z.Z,{titledRecordStore:M,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),z=(0,n.VK)((()=>(0,R.jC)({recordId:S,recordType:m.iU,tab:u,rootStore:i,environment:v})),[S,u,i,v]),G=v.device.isMobile,Y=(0,n.VK)((()=>J({source:c,forReplyMenu:!1})),[c]),$=(0,n.VK)((()=>(0,R.cr)({activity:t,rootStore:i})),[t,i]),Q=null==$?void 0:$.id,ee=null==$?void 0:$.context,te=(0,n.VK)((()=>parseInt(t.end_time)),[t]);return g&&k&&A&&b?(0,X.jsxs)(V.ZP,{timestamp:te,header:(0,X.jsx)("span",{children:(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:E.length,authorOrAuthors:F,blockName:U},id:"activity.commentActivity.header"})}),isLast:a,isPrivate:z,rootStore:i,navigableBlockId:S,icon:(0,X.jsx)(V.BE,{authors:E,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:h,environment:v,tab:u,activity:t}),children:[(0,X.jsx)(q,{url:C,onClick:L,discussionId:Q,discussionContext:ee,alwaysHighlightWithBlockBar:!1,rootStore:i,source:c}),(0,X.jsx)(w.Z,{visible:5,items:p.map(((e,t,o)=>(0,X.jsx)(_.Z,{onClick:L,href:C,innerStyle:(0,I.OD)({source:c,isMobile:G}),children:(0,X.jsx)(T.Z,{edit:e,rootStore:i,type:"comment-edit",discussionLocation:Y,onReactionClick:K,hideAuthorName:!1})},t)))}),(0,X.jsx)(H,{activity:t,rootStore:i,tabArgs:o})]}):null}function q(e){window.__c={n:"CommentContext"};const{url:t,onClick:o,rootStore:r,source:i,discussionId:l,alwaysHighlightWithBlockBar:d,discussionContext:c}=e,u=0===(0,F.llS)(c).length||d,h=(0,s.O7)(),p=h.device.isMobile,g=(0,a.Fg)(),m=(0,a.yK)((e=>({linkbox:{...(0,I.OD)({source:i,isMobile:p}),display:"flex",alignItems:"center",fontSize:14,...u&&{color:e.mediumTextColor},paddingTop:2,paddingBottom:6,marginBottom:0}})),[p,i,u]),v=(0,n.VK)((()=>(0,U.IY)({environment:h,textValue:c?{value:c,spaceId:r.id}:void 0,parentStore:r,disableHover:!0,disableStyleAnnotations:u,disableInsertedDeletedAnnotations:u,disableDateStyleAnnotations:!1,disabled:!0,highlightDiscussionId:l,theme:g,emojiType:(0,K.e_)(h),katex:h.KatexStore.getKatex(),formulaValueTypes:[]})),[r,h,c,l,g,u]);return c?(0,X.jsxs)(_.Z,{href:t,onClick:o,innerStyle:m.linkbox,children:[u&&(0,X.jsx)(G.Z,{}),(0,X.jsx)("div",{style:D.Z.textOverflowStyle,children:v})]}):null}function H(e){window.__c={n:"CommentActions"};const{activity:t,rootStore:o,tabArgs:i}=e,{source:l,notification:d,tab:c}=i,u=(0,n.VK)((()=>{const e=o.getRecordStore(o,{table:y.qF,id:t.discussion_id,spaceId:t.space_id});if(e.isDefined())return e}),[t,o]),h=(0,s.O7)(),p=h.device.isMobile,g=(0,n.VK)((()=>j.t1.createChildStore(o,{table:y.qF,id:t.discussion_id,spaceId:(0,E.C)(o.pointer.spaceId)})),[t,o]),v=(0,n.VK)((()=>null==u?void 0:u.getParentId()),[u]),b=(0,r.useCallback)((e=>{if(!v)return;const r=j.G.createChildStore(o,{table:m.iU,id:v}),i=e.target,s=null==d?void 0:d.id;N.oK({environment:h,discussionStore:g,rect:i.getBoundingClientRect(),blockStore:r,discussionLocation:J({forReplyMenu:!0,source:l}),activityId:t.id,notificationId:s}),"notifications_tab"===l&&L.gY({environment:h,notificationId:s,alreadyRead:Boolean(null==d?void 0:d.read),activity:t,tab:c})}),[t,g,h,d,v,o,l,c]),f=(0,a.yK)((e=>({container:{paddingLeft:(0,I.c3)({source:l,isMobile:p}),paddingTop:12,paddingBottom:4},actionButton:(0,I.b9)(e)})),[p,l]),A=Boolean(null==d?void 0:d.visited);return u?(0,X.jsxs)("div",{style:f.container,children:[(0,X.jsx)(z.Z,{onClick:b,style:f.actionButton,children:(0,X.jsx)(x.FormattedMessage,{defaultMessage:"Reply",id:"activity.replyButton.label"})}),A&&(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)($,{}),(0,X.jsx)(B.D,{tabArgs:i,environment:h,rootStore:o,activity:t})]})]}):null}function $(){return(0,X.jsx)("div",{style:{width:5,display:"inline-block"}})}function J(e){const{forReplyMenu:t,source:o}=e;if("updates_sidebar"===o)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${L.Jn()}`}const Q=r.memo(Y),ee={width:12,height:12,display:"inline-block",verticalAlign:"middle",marginBottom:2,marginRight:4};class te extends i.Z{constructor(){super(...arguments),this.renderBlockEdit=(e,t,o)=>{const{tabArgs:r}=this.props,{source:i}=r;let s=this.getRecordModel({table:m.iU,id:e.block_id});s&&s.type===c.Ti.tableRow&&(s=this.getRecordModel({table:m.iU,id:s.parent_id}));const n=s?s.getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:d.tY.Activity}):g._j.root,a=this.environment.device.isMobile;return"block-deleted"===e.type?e.block_data.block_value.type===c.Ti.page?(0,X.jsx)(_.Z,{href:n,onClick:()=>(0,P.dG)({...r,environment:this.environment,activity:o}),innerStyle:(0,I.OD)({source:i,isMobile:a}),children:(0,X.jsx)(T.Z,{edit:e,rootStore:this.props.rootStore})},t):(0,X.jsx)("div",{style:(0,I.OD)({source:i,isMobile:a}),children:(0,X.jsx)(T.Z,{edit:e,rootStore:this.props.rootStore})},t):(0,X.jsx)(_.Z,{href:n,onClick:()=>(0,P.dG)({...r,environment:this.environment,activity:o}),innerStyle:(0,I.OD)({source:i,isMobile:a}),children:(0,X.jsx)(T.Z,{edit:e,rootStore:this.props.rootStore})},t)}}UNSAFE_willMountOrUpdate(){!function(e,t){if("commented"===e.type){const r=se({table:y.qF,id:e.discussion_id,spaceId:e.space_id},t);if(r.isDefined()){const e=r.getCommentStores();for(const t of e){var o;null===(o=t.getCreatedByStore())||void 0===o||o.load()}}}}(this.props.activity,this.props.rootStore),this.environment.KatexStore.loadIfNeeded((()=>function(e,t){const o=(0,R.cr)({activity:e,rootStore:t});if(!o)return;return o.context}(this.props.activity,this.props.rootStore)))}renderComponent(){const{activity:e,rootStore:t,tabArgs:o,isLast:r}=this.props,i=e.type;if(!l.KN(i))return h.log({level:"error",from:"ActivityUpdate",type:"unsupportedActivityType",data:{message:`Activity type ${i} is not supported for ActivityUpdate`}}),null;switch(i){case"block-edited":return this.renderBlockEditActivity(e);case"collection-row-created":case"collection-row-deleted":return this.renderCollectionRowActivity(e);case"top-level-block-created":case"top-level-block-deleted":return this.renderTopLevelBlockActivity(e);case"permissions-edited":return this.renderPermissionsActivity(e);case"permission-group-edited":return this.renderPermissionGroupActivity(e);case"commented":return(0,X.jsx)(Q,{activity:e,tabArgs:o,rootStore:t,isLast:r});case"collection-edited":return this.renderCollectionEdited(e);case"collection-view-edited":return this.renderCollectionViewEdited(e);case"collection-property-edited":return this.renderCollectionPropertyEdited(e);case"page-locked":case"page-unlocked":return this.renderPageLockActivity(e);case"page-deleted":case"page-restored":case"page-permanently-deleted":return(0,X.jsx)(le,{tabArgs:this.props.tabArgs,rootStore:this.props.rootStore,isLast:this.props.isLast,activity:e});default:(0,O.t1)(i)}}renderBlockEditActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i}=t,s=e.getEdits();if(!s.length)return;const n=(0,S.hI)(s).filter((e=>{const{block_value:t}="block-changed"===e.type?e.block_data.after:e.block_data;return t.parent_table!==f.x_}));if(0===n.length)return;const a=this.getBlockStore(n[0].navigable_block_id);if(!a.isDefined())return;const l=(0,R.P6)({edits:n,rootStore:o}),d=(0,R.XW)(l),c=(0,X.jsx)(Z.Z,{titledRecordStore:a,activity:e,tabArgs:t,getRecordModel:o.getRecordModel});return(0,X.jsxs)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",values:{numberOfAuthors:l.length,authorOrAuthors:d,pageTitle:c}})}),isLast:this.props.isLast,isPrivate:(0,R.jC)({recordId:a.id,recordType:"block",tab:i,rootStore:o,environment:this.environment}),rootStore:this.props.rootStore,navigableBlockId:a.id,icon:(0,X.jsx)(V.BE,{authors:l,size:24}),showSnapshotButton:ie(this.props.tabArgs),...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:[(0,X.jsx)(w.Z,{visible:5,items:n.map(((t,o)=>this.renderBlockEdit(t,o,e)))}),(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})]})}renderCollectionRowActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i}=t,s=e.getEdits();if(!s.length)return;const n=s[0],a=this.getBlockStore(e.collection_row_id);if(!a.isDefined())return;if(!a.getProperties())return;const l=(0,R.P6)({edits:s,rootStore:o}),d=(0,R.XW)(l),c=(0,X.jsx)(Z.Z,{titledRecordStore:a,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),u="collection-row-created"===n.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {pageTitle}} other {{authorOrAuthors} created {pageTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:d,pageTitle:c},id:"activity.collectionRowCreated.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {pageTitle}} other {{authorOrAuthors} deleted {pageTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:d,pageTitle:c},id:"activity.collectionRowDeleted.header"});return(0,X.jsx)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:u}),isLast:this.props.isLast,isPrivate:(0,R.jC)({recordId:a.id,recordType:"block",tab:i,rootStore:o,environment:this.environment}),rootStore:this.props.rootStore,navigableBlockId:a.id,icon:(0,X.jsx)(V.BE,{authors:l,size:24}),showSnapshotButton:ie(this.props.tabArgs),...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})})}renderTopLevelBlockActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i}=t,s=e.getEdits();if(!s.length)return;const n=s[0],a=this.getBlockStore(e.top_level_block_id);if(!a.isDefined())return;const l=a.hasSpacePermission(),d=(0,R.P6)({edits:s,rootStore:o}),c=(0,R.XW)(d),u=(0,X.jsx)(Z.Z,{titledRecordStore:a,activity:e,tabArgs:t,getRecordModel:o.getRecordModel});let h;return h=l?"top-level-block-created"===n.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created workspace page {pageTitle}} other {{authorOrAuthors} created workspace page {pageTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,pageTitle:u},id:"activity.topLevelBlockWorkspaceCreated.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted workspace page {pageTitle}} other {{authorOrAuthors} deleted workspace page {pageTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,pageTitle:u},id:"activity.topLevelBlockWorkspaceDeleted.header"}):"top-level-block-created"===n.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created private page {pageTitle}} other {{authorOrAuthors} created private page {pageTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,pageTitle:u},id:"activity.topLevelBlockPrivateCreated.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted private page {pageTitle}} other {{authorOrAuthors} deleted private page {pageTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:c,pageTitle:u},id:"activity.topLevelBlockPrivateDeleted.header"}),(0,X.jsx)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:h}),isLast:this.props.isLast,isPrivate:(0,R.jC)({recordId:a.id,recordType:"block",tab:i,rootStore:o,environment:this.environment}),rootStore:this.props.rootStore,icon:(0,X.jsx)(V.BE,{authors:d,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i})})}renderPermissionsActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i,source:s}=t,n=e.getEdits();if(!n.length)return;const a=(0,S.hI)(n);if(0===a.length)return;let d,c;const u=a[0];if(u.navigable_block_id){const r=this.getBlockStore(u.navigable_block_id);if(!r.isDefined())return;c=(0,X.jsx)(Z.Z,{titledRecordStore:r,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),d=(0,R.jC)({recordId:r.id,recordType:"block",tab:i,rootStore:o,environment:this.environment})}else{const r=ne(u.space_id,this.props.rootStore);if(!r.isDefined())return;c=(0,X.jsx)(Z.Z,{titledRecordStore:r,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),d=(0,R.jC)({recordId:u.space_id,recordType:"space",tab:i,rootStore:o,environment:this.environment})}const{autojoinEdits:h,inheritanceEdits:p,otherEdits:g}=l.md(a),m=[];h.forEach(((t,s)=>{const n=(0,R.P6)({edits:[t],rootStore:o}),a=(0,R.XW)(n);m.push((0,X.jsx)(V.ZP,{timestamp:t.timestamp,header:(0,X.jsx)("span",{children:(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} joined {pageOrSpaceName}} other {{authorOrAuthors} joined {pageOrSpaceName}}}",values:{numberOfAuthors:n.length,authorOrAuthors:a,pageOrSpaceName:c},id:"activity.permissionsActivity.header"})}),isLast:this.props.isLast,isPrivate:d,rootStore:this.props.rootStore,navigableBlockId:t.navigable_block_id,icon:(0,X.jsx)(V.BE,{authors:n,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i})},`autojoin-${s}`))}));const v=this.environment.device.isMobile;p.forEach(((n,a)=>{const l=(0,R.P6)({edits:[n],rootStore:o}),u=(0,R.XW)(l);let h;"permission-restriction-created"===n.type?h=(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restricted access for {pageOrSpaceName}} other {{authorOrAuthors} restricted access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:l.length,authorOrAuthors:u,pageOrSpaceName:c,inSudoMode:n.inSudoMode},id:"activity.restrictPermissionsForActivity.header"}):"permission-restriction-deleted"===n.type&&(h=(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored inherited access for {pageOrSpaceName}} other {{authorOrAuthors} restored inherited access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:l.length,authorOrAuthors:u,pageOrSpaceName:c,inSudoMode:n.inSudoMode},id:"activity.restorePermissionsForActivity.header"})),m.push((0,X.jsxs)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:h}),isLast:this.props.isLast,isPrivate:d,rootStore:this.props.rootStore,navigableBlockId:n.navigable_block_id,icon:(0,X.jsx)(V.BE,{authors:l,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:[(0,X.jsx)("div",{style:(0,I.OD)({source:s,isMobile:v}),children:(0,X.jsx)(T.Z,{edit:n,rootStore:this.props.rootStore})}),(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:v,environment:this.environment,rootStore:o})]},`inheritance-${a}`))}));const b=(n,a,l)=>{if(n.length>0){const c=(0,R.P6)({edits:n,rootStore:o});m.push((0,X.jsxs)(V.ZP,{timestamp:parseInt(e.end_time),header:l,isLast:this.props.isLast,isPrivate:d,rootStore:this.props.rootStore,navigableBlockId:u.navigable_block_id,icon:(0,X.jsx)(V.BE,{authors:c,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:[n.map(((e,t,o)=>(0,X.jsx)("div",{style:(0,I.OD)({source:s,isMobile:v}),children:(0,X.jsx)(T.Z,{edit:e,rootStore:this.props.rootStore},t)},t))),(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})]},a))}},f=g.filter((e=>!e.inSudoMode));if(f.length>0){const e=(0,R.P6)({edits:f,rootStore:o}),t=(0,R.XW)(e);b(f,"other",(0,X.jsx)("span",{children:(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}}",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:c},id:"activity.updatedPermissionsForActivity.header"})}))}const y=g.filter((e=>e.inSudoMode));if(y.length>0){const e=(0,R.P6)({edits:y,rootStore:o}),t=(0,R.XW)(e);b(y,"other-sudo",(0,X.jsx)("span",{children:(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}} using administrator privileges",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:c},id:"activity.updatedPermissionsForActivityInSudoMode.header"})}))}return m}renderPermissionGroupActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i,source:s}=t,n=e.getEdits();if(!n.length)return;const a=(0,S.hI)(n),l=a[0];if(!l)return;const d=ne(l.space_id,this.props.rootStore);if(!d.isDefined())return;const c=(0,P.ME)(d.getModel().getRenderUrl({})),u=(0,X.jsx)(C.Z,{permissionGroup:(0,p.c_)({activity:e,getRecordValue:this.getRecordValue}),spaceId:e.space_id}),h=(0,R.P6)({edits:a,rootStore:o}),g=this.environment.device.isMobile;return(0,X.jsxs)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:(0,X.jsx)(re,{activity:e,authors:h,groupName:u})}),isLast:this.props.isLast,isPrivate:(0,R.jC)({recordId:e.space_id,recordType:"space",tab:i,rootStore:o,environment:this.environment}),rootStore:o,icon:(0,X.jsx)(V.BE,{authors:h,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:[(0,X.jsx)(_.Z,{href:c,onClick:()=>(0,P.dG)({...t,environment:this.environment,activity:e}),innerStyle:(0,I.OD)({source:s,isMobile:g}),children:(0,X.jsx)(T.Z,{edit:l,rootStore:o})}),(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:g,environment:this.environment,rootStore:o})]})}renderCollectionEdited(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i}=t,s=e.getEdits();if(!s.length)return;const n=se({table:v.v,id:e.collection_id,spaceId:e.space_id},this.props.rootStore);if(!n.isDefined())return;const a=s[0];if(!a)return;const c=n.getModel().getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:d.tY.Activity}),u=(0,R.P6)({edits:s,rootStore:o}),h=(0,R.XW)(u),p=(0,X.jsx)(Z.Z,{titledRecordStore:n,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),g="collection-created"===a.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {collectionTitle}} other {{authorOrAuthors} created {collectionTitle}}}",values:{numberOfAuthors:u.length,authorOrAuthors:h,collectionTitle:p},id:"activity.collectionCreated.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {collectionTitle}} other {{authorOrAuthors} edited {collectionTitle}}}",values:{numberOfAuthors:u.length,authorOrAuthors:h,collectionTitle:p},id:"activity.collectionEdited.header"});return(0,X.jsxs)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:g}),isLast:this.props.isLast,isPrivate:(0,R.jC)({recordId:e.collection_id,recordType:"collection",tab:i,rootStore:o,environment:this.environment}),rootStore:o,navigableBlockId:e.navigable_block_id,icon:(0,X.jsx)(V.BE,{authors:u,size:24}),showSnapshotButton:ie(this.props.tabArgs),...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:[l.OC(a)&&(0,X.jsx)(ae,{tabArgs:this.props.tabArgs,rootStore:this.props.rootStore,edit:a,url:c}),(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})]})}renderCollectionViewEdited(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i}=t,s=e.getEdits();if(!s.length)return;const n=se({table:v.v,id:e.collection_id,spaceId:e.space_id},this.props.rootStore);if(!n.isDefined())return;const a=se({table:b.n,id:e.collection_view_id,spaceId:e.space_id},this.props.rootStore);if(!a.isDefined())return;const l=(0,S.hI)(s),d=l[0];if(!d)return;const c=this.renderCollectionViewTitle(a,e),u=(0,X.jsx)(Z.Z,{titledRecordStore:n,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),h=(0,R.P6)({edits:l,rootStore:o}),p=(0,R.XW)(h);let g;return g="collection-view-created"===d.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:p,collectionTitle:u,collectionViewTitle:c},id:"activity.collectionViewCreated.header"}):"collection-view-deleted"===d.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:p,collectionTitle:u,collectionViewTitle:c},id:"activity.collectionViewDeleted.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:p,collectionTitle:u,collectionViewTitle:c},id:"activity.collectionViewEdited.header"}),(0,X.jsx)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:g}),isLast:this.props.isLast,isPrivate:(0,R.jC)({recordId:e.collection_id,recordType:"collection",tab:i,rootStore:o,environment:this.environment}),rootStore:o,navigableBlockId:e.navigable_block_id,icon:(0,X.jsx)(V.BE,{authors:h,size:24}),showSnapshotButton:ie(this.props.tabArgs),...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})})}renderCollectionPropertyEdited(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i}=t,s=e.getEdits();if(!s.length)return;const n=(0,S.hI)(s),a=n[0];if(!a)return;const l=se({table:v.v,id:e.collection_id,spaceId:e.space_id},this.props.rootStore);if(!l.isDefined())return;const c=l.getModel().getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:d.tY.Activity}),u="collection-property-changed"===a.type?a.collection_property_data.after:a.collection_property_data,h=(0,R.P6)({edits:n,rootStore:o}),p=(0,R.XW)(h),g=(0,X.jsx)(Z.Z,{titledRecordStore:l,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),m=(0,X.jsx)(ce,{propertySchema:u});let b;return b="collection-property-created"===a.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:p,collectionTitle:g,collectionPropertyTitle:m},id:"activity.collectionPropertyCreated.header"}):"collection-property-deleted"===a.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:p,collectionTitle:g,collectionPropertyTitle:m},id:"activity.collectionPropertyDeleted.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:p,collectionTitle:g,collectionPropertyTitle:m},id:"activity.collectionPropertyEdited.header"}),(0,X.jsxs)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:b}),isLast:this.props.isLast,isPrivate:(0,R.jC)({recordId:e.collection_id,recordType:"collection",tab:i,rootStore:o,environment:this.environment}),rootStore:o,navigableBlockId:e.navigable_block_id,icon:(0,X.jsx)(V.BE,{authors:h,size:24}),showSnapshotButton:ie(this.props.tabArgs),...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:[(0,X.jsx)(w.Z,{visible:5,items:n.map((e=>(0,X.jsx)(de,{tabArgs:this.props.tabArgs,rootStore:this.props.rootStore,edit:e,url:c},e.collection_property_id)))}),(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})]})}renderPageLockActivity(e){const{tabArgs:t,rootStore:o}=this.props,{notification:r,tab:i}=t,s=e.getEdits();if(!s.length)return;const n=s[0],a=this.getBlockStore(n.navigable_block_id);if(!a.isDefined())return;const l=(0,R.P6)({edits:s,rootStore:o}),d=(0,R.XW)(l),c=(0,X.jsx)(Z.Z,{titledRecordStore:a,activity:e,tabArgs:t,getRecordModel:o.getRecordModel}),u="page-locked"===e.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} locked {blockTitle}} other {{authorOrAuthors} locked {blockTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:d,blockTitle:c},id:"activity.pageLocked.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} unlocked {blockTitle}} other {{authorOrAuthors} unlocked {blockTitle}}}",values:{numberOfAuthors:l.length,authorOrAuthors:d,blockTitle:c},id:"activity.pageUnlocked.header"});return(0,X.jsx)(V.ZP,{timestamp:parseInt(e.end_time),header:(0,X.jsx)("span",{children:u}),isPrivate:(0,R.jC)({recordId:a.id,recordType:"block",tab:i,rootStore:o,environment:this.environment}),isLast:this.props.isLast,rootStore:o,navigableBlockId:a.id,icon:(0,X.jsx)(V.BE,{authors:l,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:r,activity:e,environment:this.environment,tab:i}),children:(0,X.jsx)(B.Z,{tabArgs:t,activity:e,isMobile:this.environment.device.isMobile,environment:this.environment,rootStore:o})})}renderCollectionViewTitle(e,t){const{tabArgs:o}=this.props;if(!e.isDefined())return;const r=e.getModel().getRenderUrl({getRecordModel:this.getRecordModel,pageVisitSource:d.tY.Activity}),i=e.getFormat().collection_view_icon,s=e.getType();return(0,X.jsxs)(_.Z,{href:r,onClick:()=>(0,P.V3)({environment:this.environment,activity:t,...o}),external:!1,innerStyle:{...I.lS,...I.nP},inline:!0,children:[(0,X.jsx)(M.F,{viewIcon:i,viewType:s,color:"light",style:{display:"inline-block",verticalAlign:"middle",marginRight:4,marginBottom:2},size:12}),(0,X.jsx)(k.Z,{collectionViewName:e.getName(),collectionViewType:e.getType()})]})}get getRecordValue(){return this.props.rootStore.getRecordValue}get getRecordModel(){return this.props.rootStore.getRecordModel}getBlockStore(e){return j.G.createChildStore(this.props.rootStore,{table:m.iU,id:e})}}te.displayName="ActivityUpdate";const oe=te;function re(e){window.__c={n:"PermissionGroupEditedHeader"};const{activity:t,authors:o,groupName:r}=e,i=(0,n.VK)((()=>(0,R.XW)(o)),[o]),s=(0,n.VK)((()=>(0,S.hI)(t.getEdits())),[t])[0];return s?"permission-group-created"===s.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created group {groupName}} other {{authorOrAuthors} created group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:i,groupName:(0,X.jsx)("span",{style:I.nP,children:r})},id:"activity.updatedPermissionGroupCreated.header"}):"permission-group-deleted"===s.type?(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted group {groupName}} other {{authorOrAuthors} deleted group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:i,groupName:(0,X.jsx)("span",{style:I.nP,children:r})},id:"activity.updatedPermissionGroupDeleted.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:i,groupName:(0,X.jsx)("span",{style:I.nP,children:r})},id:"activity.updatedPermissionGroupEditedDefault.header"}):(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:o.length,authorOrAuthors:i,groupName:(0,X.jsx)("span",{style:I.nP,children:r})},id:"activity.updatedPermissionGroupEdit.header"})}function ie(e){return"pageUpdatesSidebar"===e.tab}function se(e,t){return t.getRecordStore(t,e)}function ne(e,t){return j.H2.createChildStore(t,{table:A.bx,id:e})}function ae(e){let{edit:t,url:o,tabArgs:r,rootStore:i}=e;window.__c={n:"CollectionDescriptionEditComponent"};const n=(0,s.O7)(),{source:a}=r,l=n.device.isMobile;return(0,X.jsx)(_.Z,{href:o,innerStyle:(0,I.OD)({source:a,isMobile:l}),children:(0,X.jsx)(T.Z,{edit:t,rootStore:i})})}function le(e){let{activity:t,tabArgs:o,rootStore:r,isLast:i}=e;window.__c={n:"PageDeleteOrRestoreActivityComponent"};const a=(0,s.O7)(),{notification:l,tab:d}=o,c=(0,n.VK)((()=>t.getEdits()),[t]),u=c[0],h=(0,n.VK)((()=>(0,R.P6)({edits:c,rootStore:r})),[c,r]),p=(0,n.VK)((()=>se({table:m.iU,id:u.navigable_block_id,spaceId:u.space_id},r)),[u,r]),g=(0,n.VK)((()=>p.isDefined()),[p]),v=(0,n.VK)((()=>(0,R.jC)({recordId:p.id,recordType:"block",tab:d,rootStore:r,environment:a})),[p,a,r,d]),b=(0,n.VK)((()=>(0,R.XW)(h)),[h]),f=(0,n.VK)((()=>t.type),[t]),y=(0,n.VK)((()=>t.end_time),[t]);if(!c.length||!u||!g)return null;const A=(0,X.jsx)(Z.Z,{titledRecordStore:p,activity:t,tabArgs:o,getRecordModel:r.getRecordModel});let S;return"page-deleted"===f?S=(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {blockTitle}} other {{authorOrAuthors} deleted {blockTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:b,blockTitle:A},id:"emailActivity.pageDeleted.header"}):"page-restored"===f?S=(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored {blockTitle}} other {{authorOrAuthors} restored {blockTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:b,blockTitle:A},id:"emailActivity.pageRestored.header"}):"page-permanently-deleted"===f?S=(0,X.jsx)(x.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} permanently deleted {blockTitle}} other {{authorOrAuthors} permanently deleted {blockTitle}}}",values:{numberOfAuthors:h.length,authorOrAuthors:b,blockTitle:A},id:"emailActivity.pagePermanentlyDeleted.header"}):(0,O.t1)(f),(0,X.jsx)(V.ZP,{timestamp:parseInt(y),header:(0,X.jsx)("span",{children:S}),isPrivate:v,isLast:i,rootStore:r,navigableBlockId:p.id,icon:(0,X.jsx)(V.BE,{authors:h,size:24}),showSnapshotButton:!1,...(0,P.h9)({notification:l,activity:t,environment:a,tab:d}),children:(0,X.jsx)(B.Z,{tabArgs:o,activity:t,isMobile:a.device.isMobile,environment:a,rootStore:r})})}function de(e){let{edit:t,url:o,tabArgs:r,rootStore:i}=e;window.__c={n:"CollectionPropertyEditComponent"};const n=(0,s.O7)();if("collection-property-changed"!==t.type)return null;const{source:a}=r,l=n.device.isMobile;return(0,X.jsx)(_.Z,{href:o,innerStyle:(0,I.OD)({source:a,isMobile:l}),children:(0,X.jsx)(T.Z,{edit:t,rootStore:i})})}function ce(e){let{propertySchema:t}=e;window.__c={n:"CollectionPropertyTitleComponent"};const o=(0,a.Fg)();return(0,X.jsxs)("span",{style:{...I.nP,whiteSpace:"nowrap"},children:[(0,X.jsx)(u.ZP,{icon:t.icon,type:t.type,size:12,style:ee,theme:o}),t.name]})}}}]);