"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[2578],{38088:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QuickJSAsyncContext=void 0;const n=i(60830),s=i(48211),o=i(17407);class c extends n.QuickJSContext{async evalCodeAsync(e,t="eval.js",i){const n=void 0===i?1:0,c=(0,o.evalOptionsToFlags)(i);let u=0;try{u=await this.memory.newHeapCharPointer(e).consume((e=>this.ffi.QTS_Eval_MaybeAsync(this.ctx.value,e.value,t,n,c)))}catch(r){throw(0,s.debugLog)("QTS_Eval_MaybeAsync threw",r),r}const a=this.ffi.QTS_ResolveException(this.ctx.value,u);return a?(this.ffi.QTS_FreeValuePointer(this.ctx.value,u),{error:this.memory.heapValueHandle(a)}):{value:this.memory.heapValueHandle(u)}}newAsyncifiedFunction(e,t){return this.newFunction(e,t)}}t.QuickJSAsyncContext=c},62578:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QuickJSAsyncWASMModule=void 0;const n=i(55653),s=i(51965),o=i(39575),c=i(71535);class u extends o.QuickJSWASMModule{constructor(e,t){super(e,t),this.ffi=t,this.module=e}newRuntime(e={}){const t=new s.Lifetime(this.ffi.QTS_NewRuntime(),void 0,(e=>{this.callbacks.deleteRuntime(e),this.ffi.QTS_FreeRuntime(e)})),i=new c.QuickJSAsyncRuntime({module:this.module,ffi:this.ffi,rt:t,callbacks:this.callbacks});return(0,o.applyBaseRuntimeOptions)(i,e),e.moduleLoader&&i.setModuleLoader(e.moduleLoader),i}newContext(e={}){const t=this.newRuntime(),i=e.ownedLifetimes?e.ownedLifetimes.concat([t]):[t],n=t.newContext({...e,ownedLifetimes:i});return t.context=n,n}evalCode(){throw new n.QuickJSNotImplemented("QuickJSWASMModuleAsyncify.evalCode: use evalCodeAsync instead")}evalCodeAsync(e,t){return s.Scope.withScopeAsync((async i=>{const n=i.manage(this.newContext());(0,o.applyModuleEvalRuntimeOptions)(n.runtime,t);const s=await n.evalCodeAsync(e,"eval.js");if(void 0!==t.memoryLimitBytes&&n.runtime.setMemoryLimit(-1),s.error){throw n.dump(i.manage(s.error))}return n.dump(i.manage(s.value))}))}}t.QuickJSAsyncWASMModule=u},71535:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QuickJSAsyncRuntime=void 0;const n=i(3663),s=i(38088),o=i(31794),c=i(17407);class u extends o.QuickJSRuntime{constructor(e){super(e)}newContext(e={}){if(e.intrinsics&&e.intrinsics!==c.DefaultIntrinsics)throw new Error("TODO: Custom intrinsics are not supported yet");const t=new n.Lifetime(this.ffi.QTS_NewContext(this.rt.value),void 0,(e=>{this.contextMap.delete(e),this.callbacks.deleteContext(e),this.ffi.QTS_FreeContext(e)})),i=new s.QuickJSAsyncContext({module:this.module,ctx:t,ffi:this.ffi,rt:this.rt,ownedLifetimes:[],runtime:this,callbacks:this.callbacks});return this.contextMap.set(t.value,i),i}setModuleLoader(e,t){super.setModuleLoader(e,t)}setMaxStackSize(e){return super.setMaxStackSize(e)}}t.QuickJSAsyncRuntime=u}}]);