"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1460],{54814:(e,t,a)=>{a.d(t,{nc:()=>u,rG:()=>i});a(57658);var n=a(6287),s=a(98165),o=a(26136),r=a(54642);async function i(e){let{environment:t,spaceId:a,databaseType:s,parentStore:i}=e;if(!a)return;const u=await r.getTypedDatabases(t,{spaceId:a,databaseType:s});return"success"===u.type?u.data.result.map((e=>o.NW.createChildStore(i,{table:n.v,id:e.collectionId}))):void 0}async function u(e){let{environment:t,spaceId:a,databaseTypes:n,parentStore:o,teamId:r}=e;const u=[];return await Promise.all(n.map((async e=>{await async function(e){let{environment:t,spaceId:a,databaseType:n,parentStore:o,teamId:r}=e;const u=await i({spaceId:a,environment:t,databaseType:n,parentStore:o});if(!u)return!1;for(const i of u){const e=s.VP(i);if(e&&e.id===r)return!0}return!1}({environment:t,spaceId:a,databaseType:e,parentStore:o,teamId:r})&&u.push(e)}))),u}},33052:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(49085),s=a(29369);class o extends n.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"member",isInviteTargetsEmpty:!0,table:s.e0,isFocused:!0,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const r=o},49204:(e,t,a)=>{a.d(t,{Id:()=>w,Ng:()=>M,Px:()=>h,ow:()=>b,t_:()=>T,um:()=>y});var n=a(15145),s=a(19889),o=a(9291),r=a(50906),i=a(54642),u=a(9953),d=a(64964),l=a(29974),m=a(82530),c=a(33929),g=a(38755),p=a(80444),f=a(9867),v=a(28517);const S=(0,o.defineMessages)({joinTeamSuccessMessage:{id:"teamInviteLinkActions.joinTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},requestTeamSuccessMessage:{id:"teamInviteLinkActions.requestAccess.successMessage",defaultMessage:"Successfully requested membership"},requestTeamFailureMessage:{id:"teamInviteLinkActions.requestAccess.failureMessage",defaultMessage:"Failed to request membership"}});async function y(e){let{environment:t,userId:a,teamStore:n,user:s}=e;const o=n.getSpaceId();if(!o)return;await f.Cj({environment:t,teamId:n.id,spaceId:o,teamMemberInfos:s,isSettingDefaultTeam:!1,inviterId:a})&&(r.UD9(t,{store:n,joined_role:"member",from:"team_invite_link"}),await T({environment:t,userId:a,teamStore:n}),d.oV({label:c.default.formatMessage(S.joinTeamSuccessMessage,{teamName:n.getName()})}))}async function T(e){let{environment:t,userId:a,teamStore:s}=e;const o=p.default.state.currentUserRootStore,r=s.getSpaceId();if(!r||!o)return;const i=o.getSpaceViewStores().filter((e=>e.getSpaceId()===r))[0];await l.y3({environment:t,spaceViewStore:i,userSettingsStore:void 0,userRootStore:o,pageVisitSource:n.tY.JoinTeam}),await v.I({environment:t,spaceId:r,userId:a}),f.hI({environment:t,teamStore:s,shouldScroll:!0})}async function h(e){let{environment:t,teamId:a,message:n}=e;if(!t.currentUser.id)return;"success"===(await i.requestAccess(t,{type:"current-actor-to-team",teamId:a,message:n})).type?(r.LBE(t,{teamId:a}),await w({environment:t}),new Promise((e=>setTimeout(e,500))).then((()=>{d.oV({label:c.default.formatMessage(S.requestTeamSuccessMessage)})}))):d.oV({label:c.default.formatMessage(S.requestTeamFailureMessage)})}async function b(e){let{environment:t,teamStore:a,accessRequestStore:n,status:o}=e;const i=n.getForActorId();if(!i)return;const d=n.getRecordModel({table:s.KJ,id:i});if(d){if("approved"===o){const e=[{type:"member",entity_type:"user",user_id:d.id}];if(!(await f.Uj({environment:t,teamStore:a,teamMemberInfos:e,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})))return}m.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{u.sW({store:n,transaction:e,data:{resolved_time:Date.now(),resolved_by_table:s.KJ,resolved_by_id:t.currentUser.id,status:o}})}}),r.coX(t,{store:a,resolution:o})}}async function w(e){let{environment:t}=e;const{lastVisitedSpaceView:a,userRootStore:s,userSettingsStore:o}=await(0,g.iX)({environment:t,disableRedirectUrl:!1});a?await l.y3({environment:t,spaceViewStore:a,userRootStore:s,userSettingsStore:o,pageVisitSource:n.tY.BackForward}):await l.L5({environment:t,userRootStore:s,userSettingsStore:o,pageVisitSource:n.tY.BackForward})}async function M(e){let{environment:t,teamId:a}=e;const n=await i.getTeamAccessRequestMetadata(t,{teamId:a});if("success"===n.type)return n.data}},86232:(e,t,a)=>{a.d(t,{M:()=>b});var n=a(67294),s=a(480),o=a(86628),r=a(24405),i=a(82990),u=a(38755),d=a(95697),l=a(1083),m=a(64552),c=a(9291),g=a(89728),p=a(80444),f=a(9867),v=a(85893);const S=function(e){window.__c={n:"TeamJoinButton"};const{teamStore:t,from:a,navigateToTeamHomeOnJoin:r,onJoinedTeam:i,style:u,hoveredStyle:d,icon:l,isRed:m}=e,S=(0,s.O7)(),y=(0,o.VK)((()=>p.default.state.currentSpaceStore),[]),T=(0,n.useCallback)((async()=>{y&&(await f.um({environment:S,teamStore:t,currentSpaceStore:y,from:a,andNavigateToTeamHome:r??!1}),null==i||i())}),[y,S,t,a,r,i]);return(0,v.jsx)(g.Z,{style:u,hoveredStyle:d,onClick:T,icon:l,isRed:m,children:(0,v.jsx)(c.FormattedMessage,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var y=a(8787),T=a(14889);const h=function(e){window.__c={n:"TeamRequestButton"};const{teamStore:t,style:a,hoveredStyle:s}=e,[r,i]=(0,n.useState)(!1),u=(0,o.VK)((()=>t.getName()),[t]);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.Z,{style:a,hoveredStyle:s,onClick:()=>i(!0),children:(0,v.jsx)(c.FormattedMessage,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,v.jsx)(T.Z,{teamStore:t,teamName:u,teamId:t.id,isModalOpen:r,onDismiss:()=>i(!1)})]})};function b(e){window.__c={n:"TeamJoinLeaveButton"};const{teamStore:t,style:a,hoveredStyle:n}=e,c=(0,s.O7)(),g=(0,l.Q)(),p=(0,m.e)(t),f=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),T=(0,r.yK)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:i.Z.fontWeight.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...a},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...n}})),[a,n]),b=(0,o.VK)((()=>(0,d.Hu)({membership:t.getRawMembership()})&&(0,u.Fn)(c)),[c,t]),w=!p&&"open"===f||b,M=!p&&"closed"===f;return g?null:p?(0,v.jsx)(y.Z,{...e,style:T.joinTeamButton,hoveredStyle:T.joinTeamButtonHoveredStyle}):w?(0,v.jsx)(S,{...e,style:T.joinTeamButton,hoveredStyle:T.joinTeamButtonHoveredStyle}):M?(0,v.jsx)(h,{teamStore:t,style:T.joinTeamButton,hoveredStyle:T.joinTeamButtonHoveredStyle}):null}},8787:(e,t,a)=>{a.d(t,{Z:()=>f});var n=a(67294),s=a(480),o=a(86628),r=a(36591),i=a(72126),u=a(64684),d=a(9291),l=a(89728),m=a(26388),c=a(80444),g=a(9867);var p=a(85893);const f=function(e){window.__c={n:"TeamLeaveButton"};const{teamStore:t,from:a,onLeavingTeam:f,style:v,hoveredStyle:S,icon:y,isRed:T,placement:h,alignment:b,buttonInternals:w}=e,M=(0,s.O7)(),I=(0,o.VK)((()=>c.default.state.currentSpaceStore),[]),j=(0,n.useCallback)((async()=>{if(!I)return;await g.s({environment:M,teamStore:t,currentSpaceStore:I,from:a})&&(null==f||f())}),[I,M,t,a,f]),x=(0,p.jsx)(d.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),B=function(e){let{teamStore:t}=e;const a=(0,s.O7)().currentUser.id,{isDefaultTeam:n}=(0,o.VK)((()=>({isDefaultTeam:t.isDefault()})),[t]),r=function(e){const t=(0,o.VK)((()=>c.default.state.currentSpaceStore),[]);return(0,o.VK)((()=>e.isDefined()&&null!=t&&t.isDefined()?(0,u.x4)({members:e.getMembers(),groups:(null==t?void 0:t.getPermissionGroups())??[]}):[]),[e,t])}(t),l=(0,o.VK)((()=>a?r.filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(a)})):[]),[r,a]),m=(0,o.VK)((()=>{if(!t.isReady())return!1;const e=(0,u.XO)({membership:t.getMembers()});return 1===e.length&&e[0]===a}),[t,a]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:a,userGroups:n}=e;if(t)return(0,p.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You canâ€™t leave this teamspace because everyone in the workspace must be a member"});if(a)return(0,p.jsx)(d.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(n.length>0)return(0,p.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:i.oA(n.map((e=>e.name))).join()}})}({isDefaultTeam:n,isOnlyTeamOwner:m,userGroups:l})}({teamStore:t}),R=Boolean(B),k=R?B:x;return(0,p.jsx)(m.ZP,{style:R?{width:240}:void 0,disableTooltip:!Boolean(k),renderTooltip:e=>(0,p.jsx)("div",{...e,children:k}),textWrap:R,placement:h,alignment:b,render:e=>(0,p.jsx)(l.Z,{...e,style:v,hoveredStyle:S,onClick:j,disabled:R,disabledFeedback:R,icon:y,isRed:T,children:w||(0,p.jsxs)(p.Fragment,{children:[(0,r.e)({width:12.5,marginRight:4}),(0,p.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},14889:(e,t,a)=>{a.d(t,{Z:()=>f});var n=a(67294),s=a(480),o=a(24405),r=a(9291),i=a(42922),u=a(74194),d=a(50506),l=a(64369),m=a(49204),c=a(74016),g=a(85893);const p=(0,r.defineMessages)({message_placeholder:{id:"teamInviteLinkRequestPage.message.placeholder",defaultMessage:"Message (optional)"}});const f=function(e){window.__c={n:"TeamInviteLinkRequestModal"};const{teamStore:t,teamName:a,teamId:f,isModalOpen:v,onDismiss:S}=e,[y,T]=(0,n.useState)(""),h=(0,s.O7)(),b=(0,r.useIntl)(),w=async()=>{await m.Px({environment:h,teamId:f,message:y}),S()},M=(0,o.yK)((()=>({modal:{alignSelf:"center",overflow:"visible",padding:15,width:420},requestTitle:{display:"inline-flex",marginBottom:10},icon:{marginLeft:4,marginRight:4},footer:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:15},requestInvitesButton:{marginLeft:20},input:{padding:8}})),[]);return(0,g.jsx)(d.Z,{open:v,onDismiss:S,innerStyle:M.modal,preventHideChildrenWhileOpening:!0,render:()=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{style:M.requestTitle,children:(0,g.jsx)(r.FormattedMessage,{id:"teamInviteLinkRequestModal.reasonForRequest.title",defaultMessage:"Request access to {icon} {teamName}",values:{teamName:a,icon:(0,g.jsx)(c.p,{style:M.icon,store:t,disabled:!0,size:22})}})}),(0,g.jsx)(u.Z,{textarea:!0,style:M.input,value:y,onChange:e=>{T(e.target.value)},placeholder:b.formatMessage(p.message_placeholder)}),(0,g.jsxs)("div",{style:M.footer,children:[(0,g.jsx)(l.Z,{isSecondaryColor:!0,isSmall:!0,isMultiline:!0,children:(0,g.jsx)(r.FormattedMessage,{id:"teamInviteLinkRequestModal.caption",defaultMessage:"Your teamspace owners will approve or decline your request."})}),(0,g.jsx)(i.Z,{isLarge:!0,style:M.requestInvitesButton,onClick:w,children:(0,g.jsx)(r.FormattedMessage,{id:"teamInviteLinkRequestModal.requestAccessButton.label",defaultMessage:"Request"})})]})]})})}},1083:(e,t,a)=>{a.d(t,{Q:()=>u});var n=a(480),s=a(86628),o=a(38755),r=a(80444),i=a(88280);function u(){const e=function(){const e=(0,n.O7)();return(0,s.VK)((()=>{const t=r.default.state.currentSpaceStore,a=i.subscriptionDataStoreInstance.state;return t?o.Cx(t)?a?{loading:!1,isUserTeamGuestOfSpace:o.di(e,a)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,s.VK)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},64552:(e,t,a)=>{a.d(t,{e:()=>i});var n=a(480),s=a(86628),o=a(95697),r=a(80444);function i(e){const t=(0,n.O7)(),a=(0,s.VK)((()=>r.default.state.currentSpaceStore),[]);return(0,s.VK)((()=>(0,o.AL)({teamStore:e,spaceStore:a,userId:t.currentUser.id})),[a,t.currentUser.id,e])}}}]);