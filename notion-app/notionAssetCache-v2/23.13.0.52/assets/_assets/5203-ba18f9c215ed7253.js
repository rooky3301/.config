"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5203],{73657:(e,t,r)=>{r.d(t,{Z:()=>s});r(67294);var i=r(28992),o=r(85893);const s=function(e){return(0,o.jsx)(i.Z,{...e,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}},75203:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});r(67294);var i=r(83355),o=r(39068),s=r(56666),n=r(39132),p=r(61061),l=r(72126),a=r(82990),d=r(9291),c=r(50906),h=r(31869),y=r(96802),m=r(82530),u=r(87279),g=r(29376),x=r(4023),b=r(29798),v=r(73657),P=r(52275),f=r(31945),j=r(79131),S=r(73063),T=r(78140),k=r(32163),Z=r(53437),w=r(72495),C=r(26388),M=r(85893);class I extends i.Z{constructor(){super(...arguments),this.storeTypes={menuListStore:b.Z},this.renderRelationPropertyMenuPopup=e=>{const t=this.allRelatedTargetProperties.state;if(!t)return;const r=t.filter((e=>e.visible)),i=t.filter((e=>!e.visible));return(0,M.jsxs)(T.Z,{menuType:u.og.Popup,maxWidth:240,maxHeight:500,children:[0===t.length&&(0,M.jsx)(w.Z,{children:(0,M.jsx)(v.Z,{caption:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"No properties",id:"database.relationMenu.noProperties"})})}),t.length>0&&(0,M.jsx)(k.Z,{type:k.i.Vertical,store:this.stores.menuListStore,initialFocus:void 0,sections:l.oA([r.length>0&&{key:"visible_and_hidden_properties",render:e=>(0,M.jsx)(w.Z,{...e,noTextOverflow:!0,isTitleUppercase:!1,title:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Shown in relation",id:"database.relationMenu.shownInRelationTitle"}),desktopTitleStyle:{height:18},children:this.renderPropertyDraggableList({visibleProperties:r,hiddenProperties:i,children:e.children})}),items:l.oA([...this.getPropertySortListItems({properties:r,visibility:!0}),i.length>0&&{key:"group-header-hidden-property",render:e=>(0,M.jsx)(R,{props:e,children:(0,M.jsx)(M.Fragment,{})}),action:()=>{}},...this.getPropertySortListItems({properties:i,visibility:!1})])},0===r.length&&i.length>0&&{key:"hidden_properties",render:e=>(0,M.jsx)(R,{props:e,children:this.renderPropertyDraggableList({visibleProperties:r,hiddenProperties:i,children:e.children})}),items:this.getPropertySortListItems({properties:i,visibility:!1})}])})]})},this.handlePropertyReorder=e=>{const{newPropertyKeys:t}=e,{collectionStore:r,property:i}=this.props,o=g.U1({collectionStore:r,property:i}),s=t.indexOf("group-header-hidden-property"),n=l.oA(t.filter((e=>!e.startsWith("group-header-"))).map(((e,t)=>{const r=o.find((t=>t.property===e));return r?s>0?"title"===e&&t>=s?r:{...r,visible:Boolean(t<s)}:r:{property:e,visible:!(s>0)||Boolean(t<s)}}))),p=o.filter((e=>!t.includes(e.property))),a={...g.ZI(r)};a[i]||(a[i]={}),a[i].related_properties=[...n,...p],m.createAndCommit({userAction:"RelationPropertyCustomizeLayoutMenu.handlePropertyReorder",environment:this.environment,perform:e=>{y.FH({stores:[r],update:{collection_relation_options:a},transaction:e})}}),this.stores.menuListStore.reset()},this.allRelatedTargetProperties=this.createComputedStore((()=>{const{collectionStore:e,targetCollectionStore:t,property:r}=this.props,i=g.U1({collectionStore:e,property:r}),o=Object.keys(t.getSchema()).map((e=>i.find((t=>t.property===e))??{property:e,visible:!1})),s=i.map((e=>e.property)),n=e=>{const t=s.indexOf(e);return-1!==t?t:1/0};return o.sort(((e,t)=>n(e.property)-n(t.property))),o}),!0)}renderComponent(){const{device:e}=this.environment;if(!e.isPhone||"section"===this.props.rowType)return(0,M.jsx)(C.ZP,{renderTooltip:()=>(0,M.jsx)(d.FormattedMessage,{id:"database.RelationCustomizeLayoutMenu.tooltip.button.message",defaultMessage:"Customize shown properties"}),placement:"section"===this.props.rowType?x.u.Top:x.u.Right,render:e=>(0,M.jsx)(f.ZP,{popupType:Z.kQ.Popup,alignmentToOrigin:x.v.Start,...e,renderOrigin:t=>(0,M.jsx)(S.Z,{icon:s.o,iconStyle:{width:16,color:this.theme.mediumIconColor,fill:this.theme.mediumIconColor},...t,...e}),onClick:()=>{c.gP4(this.environment,{from:"section"===this.props.rowType?"relation_section":"configure_relation_modal"})},originGap:16,render:this.renderRelationPropertyMenuPopup})})}getPropertySortListItems(e){const{properties:t,visibility:r}=e;return l.oA(t.map((e=>function(e,t,r,i,s,l,d){const{propertyFormat:c,visibility:y}=e,m=!y,u=s.getSchema();if(!u)return;const g=u[c.property];if(!g)return;return{key:c.property,render:e=>(0,M.jsx)(P.Z,{...e,showDragHandle:!d,title:(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,M.jsx)(o.ZP,{icon:g.icon,type:g.type,size:16,theme:r,style:{fill:r.regularIconColor}}),(0,M.jsx)("span",{style:{marginLeft:8,...a.Z.textOverflowStyle},children:g.name})]}),right:(0,M.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,M.jsx)(S.Z,{icon:m?p.B:n.c,iconStyle:{width:16,height:16},isDarkIconColor:!m,onClick:()=>{h.qK({propertyFormat:c,visibility:y,collectionStore:i,property:l,environment:t})},disabled:d||"title"===c.property})})}),action:()=>{}}}({propertyFormat:e,visibility:r},this.environment,this.theme,this.props.collectionStore,this.props.targetCollectionStore,this.props.property,this.props.disabled))))}renderPropertyDraggableList(e){const{visibleProperties:t,hiddenProperties:r,children:i}=e,o=l.oA([...t.map((e=>e.property)),t.length>0&&r.length>0&&{key:"group-header-hidden-property",draggable:!1},...r.map((e=>e.property))]);return(0,M.jsx)(j.ZP,{direction:"vertical",keys:o,renderKey:(e,t)=>i[t],onDrop:e=>{this.handlePropertyReorder({newPropertyKeys:e})},disabled:this.props.disabled})}}I.displayName="RelationPropertyCustomizeLayoutMenu";const L=I;function R(e){const{props:t,children:r}=e;return(0,M.jsx)(w.Z,{...t,noTextOverflow:!0,isTitleUppercase:!1,title:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Hidden in relation",id:"database.relationMenu.hiddenInRelationTitle"}),desktopTitleStyle:{height:19},children:r,disableDesktopPadding:!0})}},39132:(e,t,r)=>{r.d(t,{c:()=>s});r(67294);var i=r(45238),o=r(85893);const s=(0,i.I)("eye",{viewBox:"0 0 32 32",svg:(0,o.jsx)("path",{d:"M16.006 25.812c8.863 0 14.994-7.17 14.994-9.406C31 14.16 24.858 7 16.006 7 7.252 7 1 14.16 1 16.406c0 2.236 6.252 9.406 15.006 9.406zm0-3.242a6.194 6.194 0 01-6.197-6.164c-.012-3.452 2.744-6.164 6.197-6.164 3.419 0 6.185 2.711 6.185 6.164 0 3.364-2.766 6.164-6.185 6.164zm0-3.94c1.228 0 2.246-1.007 2.246-2.224 0-1.228-1.018-2.235-2.246-2.235-1.24 0-2.258 1.007-2.258 2.235 0 1.217 1.018 2.224 2.258 2.224z"})})}}]);