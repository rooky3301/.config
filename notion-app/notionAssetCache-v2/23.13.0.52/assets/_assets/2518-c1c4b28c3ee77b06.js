"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[2518],{62967:(e,t,n)=>{n.d(t,{$J:()=>A,CJ:()=>E,MV:()=>R,RE:()=>k,cN:()=>T,cs:()=>C,fi:()=>F,kv:()=>D,wL:()=>B,zz:()=>I});n(67294);var o=n(41432),i=n(8848),r=n(97880),a=n(9291),s=n(96802),l=n(82530),c=n(40663),d=n(93405),u=n(48019),p=n(52275),m=n(78140),f=n(40721),g=n(86825),h=n(26388),v=n(42782),b=n(19037),y=n(33929),_=n(87279),S=n(98742),w=n(85893);const k=(0,a.defineMessages)({deleteName:{id:"action.delete.name",defaultMessage:"Delete"},undoName:{id:"action.undo.name",defaultMessage:"Undo"},redoName:{id:"action.redo.name",defaultMessage:"Redo"},duplicateName:{id:"action.duplicate.name",defaultMessage:"Duplicate"},duplicateToPrivateName:{id:"action.duplicateToPrivate.name",defaultMessage:"Duplicate to Private"},turnIntoName:{id:"action.turnInto.name",defaultMessage:"Turn into"},copyLinkName:{id:"action.copyLink.name",defaultMessage:"Copy link to block"},copyLinkNavigableTypeName:{id:"action.copyLinkNavigableType.name",defaultMessage:"Copy link"},showCodePreviewFormat:{id:"action.showCodePreviewFormat.name",defaultMessage:"Preview"},showOnlyCodeFormat:{id:"action.showOnlyCodeFormat.name",defaultMessage:"Code"},showSplitViewFormat:{id:"action.showSplitViewFormat.name",defaultMessage:"Split"},searchPlaceholder:{defaultMessage:"Search for a languageâ€¦",id:"codeBlock.searchPrompt"},backgroundColorDefaultKeywords:{id:"action.backgroundColor.default.fuzzySearchKeyword",defaultMessage:"Default Black White"},foregroundColorGrayKeywords:{id:"action.foregroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray"},backgroundColorGrayKeywords:{id:"action.backgroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray background Greybackground Graybackground"},foregroundColorBrownKeywords:{id:"action.foregroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown"},backgroundColorBrownKeywords:{id:"action.backgroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown background Brownbackground"},foregroundColorOrangeKeywords:{id:"action.foregroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange"},backgroundColorOrangeKeywords:{id:"action.backgroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange background Orangebackground"},foregroundColorYellowKeywords:{id:"action.foregroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow"},backgroundColorYellowKeywords:{id:"action.backgroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow background Yellowbackground"},foregroundColorTealKeywords:{id:"action.foregroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green"},backgroundColorTealKeywords:{id:"action.backgroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green background Tealbackground Greenbackground"},foregroundColorBlueKeywords:{id:"action.foregroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue"},backgroundColorBlueKeywords:{id:"action.backgroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue background Bluebackground"},foregroundColorPurpleKeywords:{id:"action.foregroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple"},backgroundColorPurpleKeywords:{id:"action.backgroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple background Purplebackground"},foregroundColorPinkKeywords:{id:"action.foregroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink"},backgroundColorPinkKeywords:{id:"action.backgroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink background Pinkbackground"},foregroundColorRedKeywords:{id:"action.foregroundColor.red.fuzzySearchKeyword",defaultMessage:"Red"},backgroundColorRedKeywords:{id:"action.backgroundColor.red.fuzzySearchKeyword",defaultMessage:"Red background Redbackground"},backgroundSectionKeywords:{id:"action.section.background.fuzzySearchKeywords",defaultMessage:"Color Background"},backgroundSection:{id:"action.section.background",defaultMessage:"Background"},colorSection:{id:"action.section.color",defaultMessage:"Color"},colorName:{id:"action.color.name",defaultMessage:"Color"},duplicateCollectionSchemaOnlyName:{id:"action.duplicateSchemaOnly.name",defaultMessage:"Duplicate without content"},duplicateCollectionWithDataName:{id:"action.duplicateWithData.name",defaultMessage:"Duplicate with content"}}),I=e=>{let{title:t}=e;return t},x={maxWidth:400,whiteSpace:"pre-wrap"};function C(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:i,analyticsName:r,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,shortcuts:d,sortScoreMultiplier:u,closeParentMenu:p,action:m,subActions:f,collapseSubActionsIntoParent:g,nativeRender:h,alwaysShowInSearch:v,right:b,renderTooltip:y,userProvidedSearchName:_,hideFromSlashActionMenu:S}=e,{formattedDisplayName:w,searchName:k}=M({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:_,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:w,analyticsName:r,analyticsActionType:a,searchName:k,validators:c,shortcuts:d,sortScoreMultiplier:u,action:m,subActions:f,collapseSubActionsIntoParent:g,closeParentMenu:p,render:e.render??P({svg:l,formattedDisplayName:w,right:b,contextualDisplayName:i,shortcut:d[0],renderTooltip:y}),nativeRender:h,alwaysShowInSearch:v,hideFromSlashActionMenu:S}}function T(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:i,analyticsName:r,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,sortScoreMultiplier:d,closeParentMenu:u,action:p,subActions:m,collapseSubActionsIntoParent:f,nativeRender:g,alwaysShowInSearch:h,right:v,renderTooltip:b,userProvidedSearchName:y}=e,{formattedDisplayName:_,searchName:S}=M({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:y,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:_,analyticsName:r,analyticsActionType:a,searchName:S,validators:c,sortScoreMultiplier:d,action:p,subActions:m,collapseSubActionsIntoParent:f,closeParentMenu:u,render:e.render??P({svg:l,formattedDisplayName:_,right:v,contextualDisplayName:i,renderTooltip:b}),nativeRender:g,alwaysShowInSearch:h}}function M(e){const{displayName:t,displayNameInterpolatedValues:n,fuzzySearchKeywords:o,userProvidedSearchName:i}=e,r=t?y.default.formatMessage(t,n):void 0,a=o||t,s=o?y.default.formatMessage(o):r;let l=i;return l||(l=a?s===a.defaultMessage?s:`${s} ${a.defaultMessage}`:void 0),{formattedDisplayName:r,searchName:l}}function P(e){const{formattedDisplayName:t,svg:n,shortcut:o,right:i,renderTooltip:r}=e;return(a,s,l)=>{const c=(e.contextualDisplayName?e.contextualDisplayName(s):void 0)||t;return(0,w.jsx)(h.ZP,{render:e=>(0,w.jsx)(d.Z,{...(0,S.Z)(a,e),title:c,svg:n,shortcut:o,right:"function"==typeof i?i(a,s,l):i}),renderTooltip:()=>(0,w.jsx)("div",{style:x,children:null==r?void 0:r({title:c})}),disableTooltip:!r,placement:h.ug.Right})}}function A(e){const{key:t,title:n,overrideSearchTitle:o,render:i,actions:r}=e,a=n?y.default.formatMessage(n):void 0,s=o||n,l=s&&y.default.formatMessage(s);return{key:t,title:a,searchTitle:s?l===s.defaultMessage?l:`${l} ${s.defaultMessage}`:void 0,render:i,actions:r}}function R(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,analyticsName:i,validators:r,subActions:a,collapseSubActionsIntoParent:s,svg:l,icon:c,right:g,width:h,initialFocus:b}=e,y=T({key:`extension ${t}`,displayName:n,displayNameInterpolatedValues:o,analyticsName:i,validators:r,subActions:a,collapseSubActionsIntoParent:s,closeParentMenu:!0,action:()=>{},render:(e,t,n)=>(0,w.jsx)(v.Z,{...e,renderOrigin:(e,t)=>l?(0,w.jsx)(d.Z,{...e,title:y.displayName,svg:l,right:g,ref:t}):(0,w.jsx)(p.Z,{...e,title:y.displayName,icon:c,right:g,ref:t}),onFocus:n.onFocus,renderExtension:(e,o)=>{let i;return i=t.environment.device.isPhone?{menuType:_.og.Modal,right:(0,w.jsx)(f.DoneMenuText,{}),onClickRight:o.close,...e}:{menuType:_.og.Popup,width:h??220,...e},(0,w.jsx)(m.Z,{...i,children:(0,w.jsx)(u.Z,{initialFocus:b??0,context:t,sections:a(t),onAccept:n.onAccept})})}})});return y}const D=[b.ff(b.P9(o.Ti.externalObjectInstancePage)),b.ff(b.K5),b.or([b.QL("collection_typed_db_duplication"),b.ff(b.Rg),b.f7]),b.J5,b.ff((e=>e.blocks.some((e=>e.isDefined()&&(0,c.h7)(e))))),b.vd];function B(e){return T({key:`format ${e.key}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:e.validators,render:(t,n,o)=>{let{blocks:i,environment:r}=n;const a=i[0].getFormat(),s=Boolean(a[e.property]),{isMobile:l}=r.device;return(0,w.jsx)(g.Z,{...t,title:e.label,icon:e.svg?(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.svg({width:l?20:17,height:l?20:17})}):void 0,on:s})},closeParentMenu:!1,action:t=>{let{environment:n,blocks:o}=t;l.createAndCommit({userAction:"actionRegistry.createFormatAction",environment:n,perform:t=>{const i=o[0],r=i.getFormat(),a=!Boolean(r[e.property]);s.FH({stores:[i],update:{[e.property]:a},transaction:t}),e.afterAction(a,n)}})}})}function E(e){switch(e){case"default":return k.backgroundColorDefaultKeywords;case"gray":return k.foregroundColorGrayKeywords;case"gray_background":return k.backgroundColorGrayKeywords;case"brown":return k.foregroundColorBrownKeywords;case"brown_background":return k.backgroundColorBrownKeywords;case"orange":return k.foregroundColorOrangeKeywords;case"orange_background":return k.backgroundColorOrangeKeywords;case"yellow":return k.foregroundColorYellowKeywords;case"yellow_background":return k.backgroundColorYellowKeywords;case"teal":return k.foregroundColorTealKeywords;case"teal_background":return k.backgroundColorTealKeywords;case"blue":return k.foregroundColorBlueKeywords;case"blue_background":return k.backgroundColorBlueKeywords;case"purple":return k.foregroundColorPurpleKeywords;case"purple_background":return k.backgroundColorPurpleKeywords;case"pink":return k.foregroundColorPinkKeywords;case"pink_background":return k.backgroundColorPinkKeywords;case"red":return k.foregroundColorRedKeywords;case"red_background":return k.backgroundColorRedKeywords;default:return(0,r.t1)(e)}}function F(e,t,n){const o=e.device.isAndroid?(0,i.gh)({theme:"light"}):(0,i.gh)({theme:e.ThemeStore.state.mode}),r=(0,i.fi)(t,o);let a,s,l;const c="default"!==t;t.includes("background")||null!=n&&n.includes("background")?(a="background",s=c?"square.fill":"square",l="textBackgroundColor"):(a="color",s="character",l="textColor");const d=a in r?r[a]:void 0,u=d&&(0,i.J1)(d);return{sfProGlyphName:s,localImageIdentifier:l,imageTintColor:c?u:void 0}}},52229:(e,t,n)=>{n.d(t,{k:()=>p});n(21703);var o=n(15145),i=n(41432),r=n(4615),a=n(21202),s=n(70279),l=n(95477),c=n(98165),d=n(26136),u=n(9953);function p(e){const{environment:t,parentBlock:n,targetStore:p,transaction:m}=e;if(!p.isDefined())throw new Error("Target store was not defined.");if(!n.isDefined())throw new Error("Parent block store was not defined.");const f=(0,r.ZP)(),g=p instanceof d.G;let h;if(!g){if(c.Dg(p)&&p.isDefined()){const e=p.getParentStore(),t=null==e?void 0:e.getParentStore();var v;if(null!=e&&e.isDefined())h=null==t||null===(v=t.getModel())||void 0===v?void 0:v.getRenderUrl({getRecordModel:p.getRecordModel,baseUrl:l.default.domainBaseUrl,discussionId:e.id,pageVisitSource:o.tY.LinkInPage})}}const b={id:f,type:i.Ti.alias,format:{alias_pointer:{table:g?a.iU:s.x_,id:p.id,spaceId:p.getSpaceId()},comment_alias_url:h},parent_id:n.id,parent_table:"block",alive:!0,space_id:n.getSpaceId()};return u.ae({environment:t,table:"block",value:b,inMemoryRecordCache:n.inMemoryRecordCache,transaction:m}),d.G.createChildStore(n.getContentStore(),{table:a.iU,id:f,spaceId:n.getSpaceId()})}},50906:(e,t,n)=>{n.d(t,{$1W:()=>Uo,$CH:()=>U,$Xl:()=>ct,$aC:()=>qo,$eA:()=>ki,$fF:()=>Ui,$qu:()=>ke,A01:()=>nn,A6G:()=>de,AQD:()=>Xt,Af_:()=>Rt,Al4:()=>Oe,An9:()=>Fn,BWF:()=>Go,Bb7:()=>S,Bdq:()=>Do,Bp3:()=>ro,Byg:()=>bn,CBn:()=>Ne,CDl:()=>Dn,Cdl:()=>I,Cez:()=>gi,DB2:()=>mn,DCH:()=>eo,DRv:()=>ie,DoK:()=>ui,EDS:()=>K,EVQ:()=>ao,F4S:()=>wo,FGU:()=>jn,FNU:()=>ii,FT:()=>Mt,FjP:()=>vn,Fn4:()=>z,Fo$:()=>pn,G14:()=>oe,G7$:()=>di,Gbs:()=>ho,GlI:()=>te,Gpy:()=>No,H6t:()=>Le,HNg:()=>Ro,HYP:()=>Rn,Hcc:()=>Et,Her:()=>$t,ICF:()=>yi,IMD:()=>It,IWJ:()=>Wo,IwD:()=>Pi,JEO:()=>$e,Jgl:()=>ee,Jin:()=>Ee,JrP:()=>O,JvT:()=>Si,K1b:()=>Ye,KCu:()=>Mi,KIh:()=>Ot,Kge:()=>Hi,Khd:()=>nr,LAz:()=>vo,LBE:()=>li,LC7:()=>tr,LDb:()=>re,LEn:()=>qe,LMg:()=>Nt,LbR:()=>Ri,Lfx:()=>Ii,MEX:()=>Mn,MRb:()=>xn,MU3:()=>Te,Md8:()=>_n,Mzl:()=>he,NMx:()=>_,NOz:()=>Zo,O$H:()=>Qt,OFH:()=>A,ORE:()=>$o,Opj:()=>un,P$y:()=>it,P9p:()=>qt,PL5:()=>Pt,P_7:()=>Qn,Phj:()=>ri,Prc:()=>Vo,PyM:()=>q,QFO:()=>_i,QIc:()=>Q,QUd:()=>ne,QdK:()=>zt,QkQ:()=>Qo,Qqh:()=>wt,R9m:()=>Yn,ROv:()=>dt,Rb9:()=>fn,RcY:()=>De,Rm2:()=>Ki,SJp:()=>ti,SK1:()=>_t,SLv:()=>Io,SUq:()=>Ht,Se:()=>Tn,Sh9:()=>x,TIz:()=>gt,TJp:()=>Lt,UD9:()=>Oo,UJm:()=>Ct,UJr:()=>fe,UZT:()=>Ae,Uk:()=>$,Usb:()=>ir,V0c:()=>Wt,V5j:()=>no,VJs:()=>Wn,VN$:()=>St,VSH:()=>Cn,V_i:()=>G,VaH:()=>dn,W2j:()=>F,WFT:()=>et,Wbl:()=>en,Wlu:()=>W,X0y:()=>J,XI1:()=>Kt,XTk:()=>ai,XWf:()=>y,XXm:()=>ot,Y35:()=>ln,Y8X:()=>ue,YFJ:()=>an,YMV:()=>ut,YO0:()=>T,YOV:()=>Vn,YP3:()=>Xo,YU0:()=>Se,Y_F:()=>Mo,YcY:()=>mi,Yg1:()=>wn,Yo0:()=>yt,Z0d:()=>ht,Z41:()=>Xn,ZZ8:()=>Ve,ZaS:()=>Bi,Zmw:()=>uo,Zrf:()=>rt,ZyU:()=>Ji,ZzP:()=>Jn,_6i:()=>B,_Hi:()=>we,_T2:()=>se,_fo:()=>io,_kX:()=>Ke,a5A:()=>D,a6v:()=>pe,aOs:()=>pi,a_g:()=>Ge,air:()=>Pn,apd:()=>xo,azK:()=>hi,bfr:()=>C,bmu:()=>fo,c7L:()=>oo,cXp:()=>Lo,coX:()=>ci,ctm:()=>L,dhV:()=>H,dld:()=>Zn,duO:()=>Bt,dw6:()=>Xe,e2:()=>Fi,eO1:()=>bi,eT_:()=>ae,efr:()=>xi,elP:()=>Y,enk:()=>st,eoz:()=>on,ers:()=>Ko,ewV:()=>ft,f73:()=>yn,fAb:()=>Hn,fMl:()=>lt,fW6:()=>wi,g0v:()=>Zt,gEE:()=>Ai,gL0:()=>Oi,gP4:()=>tt,gVk:()=>Gt,g_k:()=>At,gl7:()=>Ut,gw_:()=>ze,h$X:()=>Ci,h23:()=>To,hym:()=>ve,iA$:()=>kt,iBN:()=>yo,iDe:()=>er,iHH:()=>vt,iRP:()=>je,iSD:()=>M,ieV:()=>b,ikP:()=>Be,ixp:()=>jo,j1w:()=>pt,jDo:()=>Un,jMN:()=>Zi,jPN:()=>k,jRT:()=>N,j_p:()=>zi,jdc:()=>Ni,kVp:()=>to,kY8:()=>_o,kq7:()=>gn,krX:()=>Eo,kyK:()=>Di,kz9:()=>qn,l7z:()=>jt,lfq:()=>He,lgT:()=>Pe,llH:()=>so,m0A:()=>Ti,mCV:()=>X,mFL:()=>zo,mcx:()=>Po,mfs:()=>le,mgu:()=>Gi,miu:()=>Ho,mt_:()=>ge,n4j:()=>Vt,nBz:()=>Ln,nKJ:()=>Vi,neX:()=>We,nlj:()=>P,o_A:()=>Fo,phe:()=>co,piC:()=>Ao,piO:()=>bt,psf:()=>Jt,q5U:()=>w,qA6:()=>qi,qDg:()=>$n,qPY:()=>Yt,qYb:()=>En,r5L:()=>Re,rFP:()=>oi,rYq:()=>ce,rZ2:()=>Yi,rvl:()=>_e,s$$:()=>$i,s4j:()=>vi,sGw:()=>ye,sIE:()=>ko,sSR:()=>hn,sdb:()=>be,sos:()=>An,sxo:()=>Z,t8_:()=>In,tMA:()=>Ze,tPt:()=>kn,tZo:()=>cn,tir:()=>fi,tn$:()=>Dt,txh:()=>Ft,uAt:()=>si,uDZ:()=>Qe,uSc:()=>Ei,udZ:()=>nt,v$O:()=>lo,v2V:()=>Bo,v2k:()=>Me,vN5:()=>Li,vVs:()=>R,vcz:()=>j,vkP:()=>go,vqh:()=>sn,vtR:()=>bo,w3M:()=>Nn,w6U:()=>me,wWx:()=>Xi,wds:()=>Ce,wrY:()=>tn,wtf:()=>Wi,wy9:()=>xt,wz6:()=>Qi,xGP:()=>rn,xYN:()=>mo,xbC:()=>xe,xh4:()=>Tt,xti:()=>Bn,xud:()=>zn,xx2:()=>On,y4:()=>Sn,y9R:()=>So,y9e:()=>Ie,yT1:()=>Je,ya1:()=>Kn,yeF:()=>or,yef:()=>ji,yjq:()=>at,z7J:()=>mt,zIF:()=>Ue,zP:()=>V,zQ6:()=>Co,zah:()=>Yo,zes:()=>Fe});var o=n(1302),i=n(72126),r=n(4615),a=n(9852),s=n(49902),l=n(97880),c=n(64002),d=n(77472),u=n(28020),p=n(75079),m=n(12955),f=n(68418),g=n(55838),h=n(77080),v=n(27724);function b(e,t){d.$A({environment:e,userId:(0,r.F9)(t.user_id),traits:{...t,...t.tags?{original_tags:t.tags}:void 0,user_id:(0,r.F9)(t.user_id)}})}function y(e,t){d.$A({environment:e,userId:(0,r.F9)(t.user_id),traits:{...t,user_id:(0,r.F9)(t.user_id)}})}async function _(){await d.NM()}async function S(e){const{environment:t,experiment_id:n,experiment_group:o,experiment_version:i,logging_source:r}=e,s=(0,a.getSessionExperimentExposure)(n),l=await m.getExperimentDeviceId(t);Boolean(s)&&s===(0,a.getCombinedExperimentValue)(i,o)||(d.j(t,"experiment_exposure",{experiment_id:n,experiment_group:o,experiment_version:i,experiment_device_id:l,logging_source:r}),(0,a.setSessionExperimentExposure)(n,o,i))}function w(e,t){d.j(e,"persona_form_step",{event:t.event})}function k(e,t){d.j(e,"persona_form_action",{event:t.event})}function I(e){d.j(e,"add_on_discount_popup_seen")}function x(e){d.j(e,"add_on_discount_popup_dismissed")}function C(e,t){d.j(e,"member_requested_ai_addon",t),h.default.logEvent("member_requested_ai_addon",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function T(e){d.j(e,"delete_workspace_click"),h.default.logEvent("delete_workspace_click")}function M(e){d.j(e,"quick_workspace_creation_click"),h.default.logEvent("quick_workspace_creation_click")}function P(e){d.j(e,"workspace_invite_copy_link"),h.default.logEvent("workspace_invite_copy_link")}function A(e){d.j(e,"sidebar_promo_click")}function R(e){d.j(e,"student_plan_prompt_click")}function D(e){d.j(e,"student_plan_prompt_close_click")}function B(e){d.j(e,"sidebar_upgrade_nudge_dismiss",{})}const E=i.P2((e=>{d.Zf(e,{created_page:!0})}),864e5,{trailing:!1});function F(e,t){const{teamStore:n,new_page_id:o,...i}=t;ei(e,"create_block",`create_block-${t.type}-${t.from}`,60,{store:n,...i}),"page"===t.type&&(Xo(e,"create_page",{store:n,...i,new_page_id:o}),E(e))}function Z(e,t){d.j(e,"open_peek_as_page",t)}function V(e,t){d.j(e,"peek_arrow_navigation",t)}function j(e,t){d.j(e,"close_side_peek",t)}function U(e,t){d.j(e,"close_peek",t)}function L(e,t){d.lu(e,"edit_block_text_60","edit_block_text_60",60,t)}function O(e,t){d.j(e,"todo_block_check",t)}function N(e,t){d.j(e,"toggle_block_toggle")}function z(e,t){d.j(e,"embed_block_action",t)}function W(e,t){d.j(e,"embed_block_resize",t)}function q(e,t){d.j(e,"equation_block_edit",t)}function H(e,t){o.default.afterNextFlush((()=>{let n;const o=v.default.state.stores[0];o&&(n=o.getType());const{parentTeamStore:i,...r}=t;ei(e,"block_action",`block_action-${t.analyticsName}-${t.from}-${t.block_id}`,60,{store:i,...r,final_block_type:n})}))}function K(e,t){const{optionalAnalyticsProperties:n,...o}=t,{teamStore:i,collectionContextStore:r,...a}=t.optionalAnalyticsProperties||{};Xo(e,"open_block_menu",{store:i,...(0,p.Pn)(r)||{},...o,...a})}function G(e){d.j(e,"open_slash_menu")}function $(e,t){d.j(e,"download_file",t)}function Q(e,t){d.j(e,"file_open_attempt",t)}function Y(e,t){const n=(0,c.gy)(t.url);d.j(e,"open_embed_menu",{url_domain:null==n?void 0:n.hostname})}function J(e,t){var n;d.j(e,"click_embed_menu",{url_domain:t.url?null===(n=(0,c.gy)(t.url))||void 0===n?void 0:n.hostname:void 0,type:t.type})}function X(e,t){d.j(e,"url_turned_bookmark",t)}function ee(e,t){d.j(e,"embed_type",t)}function te(e,t){d.j(e,"embed_render",t)}function ne(e,t){d.j(e,"embed_client_error",t)}function oe(e,t){d.j(e,"change_font_type",t)}function ie(e,t){d.j(e,"change_font_size",t)}function re(e,t){d.j(e,"change_page_width",t)}function ae(e){d.j(e,"click_add_menu")}function se(e,t){d.j(e,"move_to",t)}function le(e,t){d.j(e,"move_to_value_selected",t)}function ce(e,t){d.j(e,"move_to_menu_open",t)}function de(e,t){d.j(e,"move_to_menu_cancel",t)}function ue(e,t){d.j(e,"add_editor_permission_to_ensure_undo",t)}function pe(e,t){d.j(e,"move_to_autocomplete_query_change",t)}function me(e,t){d.j(e,"move_to_toggle_click",t)}function fe(e,t){d.j(e,"edit_lock_toggle",t)}function ge(e,t){d.j(e,"rich_text_menu_click",t)}function he(e,t){d.j(e,"update_page_section_visibility",t)}function ve(e,t){d.j(e,"expand_block",t)}function be(e,t,n){d.j(e,t,n)}function ye(e,t){d.j(e,"board_item_delete_newly_created",t)}function _e(e,t,n){if(!0===n)d.j(e,"edit_block_property_60",t);else{const n=(0,u.zj)(),{property_type:o,collection_id:i,collection_view_id:r}=t;d.lu(e,"edit_block_property_60",`edit_block_property_60-${n||""}-${o||""}-${i||""}-${r||""}`,60,t)}}function Se(e,t){d.j(e,"click_block_property_url",t)}function we(e,t){d.j(e,"create_property",t)}function ke(e,t){d.j(e,"configure_property",t)}function Ie(e,t){d.j(e,"delete_property",t)}function xe(e,t){d.j(e,"create_view",t)}function Ce(e,t){d.j(e,"configure_view",t)}function Te(e,t){d.j(e,"open_peek_mode_picker",t)}function Me(e,t){d.j(e,"open_peek_mode_picker",t)}function Pe(e,t){d.j(e,"update_peek_mode_format",t)}function Ae(e,t){d.j(e,"update_peek_mode_format",t)}function Re(e,t){d.j(e,"view_settings",t)}function De(e,t){d.j(e,"delete_view",t)}function Be(e,t){d.j(e,"collection_search",t)}function Ee(e,t){d.j(e,"open_collection_as_page",t)}function Fe(e){d.j(e,"collection_no_date_menu_add")}function Ze(e){d.j(e,"collection_no_date_menu_view")}function Ve(e,t){d.j(e,"relation_database_click",t)}function je(e,t){d.lu(e,"timeline_view","timeline_view",5,t)}function Ue(e,t){d.j(e,"timeline_zoom_level_update",t)}function Le(e,t){d.j(e,"timeline_today_click",t)}function Oe(e,t){d.j(e,"timeline_shift_time_click",t)}function Ne(e,t){d.j(e,"timeline_toggle_table_click",t)}function ze(e,t){d.j(e,"timeline_item_scroll_arrow_click",t)}function We(e,t){d.j(e,"timeline_item_resize",t)}function qe(e,t){d.j(e,"timeline_dependency_arrow_add",t)}function He(e,t){d.j(e,"timeline_dependency_arrow_delete",t)}function Ke(e,t){d.j(e,"subitem_toggle_block_open",t)}function Ge(e,t){d.j(e,"subitem_toggle_block_close",t)}function $e(e,t){d.j(e,"create_subitem",t)}function Qe(e){d.j(e,"inline_collection_load_more_click")}function Ye(e,t){d.j(e,"relation_show_as",t)}function Je(e,t){d.j(e,"relation_reorder",t)}function Xe(e,t){d.j(e,"relation_add_block",t)}function et(e,t){d.j(e,"relation_remove_block",t)}function tt(e,t){d.j(e,"relation_customize_displayed_properties",t)}function nt(e,t){d.j(e,"relation_section_link_pages",t)}function ot(e,t){d.j(e,"relation_navigate_block",t)}function it(e,t){d.j(e,"relation_update_property_visibility",t)}function rt(e,t){d.j(e,"configure_rollup_relation",t)}function at(e,t){d.j(e,"configure_rollup_target_property",t)}function st(e,t){d.j(e,"configure_rollup_aggregation",t)}function lt(e,t){d.j(e,"collection_table_drag_and_fill",t)}function ct(e,t){d.j(e,"complete_sprint_action",t)}function dt(e,t){const{collectionContextStore:n}=t.optionalAnalyticsProperties||{},o=(0,p.Pn)(n)||{},i={from:t.from,block_types:t.draggedTypes,block_count:t.draggedTypes.length,as_copy:t.asCopy||!1,draggable:t.draggableProps,dropzone:t.dropzoneProps,...o};d.j(e,"drag",i)}function ut(e,t){d.j(e,"click_selection_menu",{block_type:t.blockType})}function pt(e,t){const{analyticsFrom:n,flowId:o}=t;d.j(e,"open_mention_menu",{analyticsFrom:n,flowId:o})}function mt(e,t){const{clickIndexGlobal:n,clickIndexLocal:o,sectionIndex:i,timeToClickInMs:r,analyticsFrom:a,queryLength:s,mentionType:l}=t,c={clickIndexGlobal:n,clickIndexLocal:o,sectionIndex:i,timeToClickInMs:r,analyticsFrom:a,queryLength:s,mentionType:l};d.j(e,"insert_mention_from_mention_menu",c),h.default.logEvent("insert_mention_from_mention_menu",void 0,c)}function ft(e,t){const{timeToAbandonInMs:n,analyticsFrom:o,queryLength:i,flowId:r}=t,a={timeToAbandonInMs:n,analyticsFrom:o,queryLength:i,flowId:r};d.j(e,"mention_menu_abandon",a),h.default.logEvent("mention_menu_abandon",void 0,a)}function gt(e,t){d.j(e,"mention_user",{mentioned_user_id:(0,r.F9)(t.user_id),from:t.from,block_type:t.block_type})}function ht(e,t){d.j(e,"mention_group",{mentioned_group_id:(0,r.F9)(t.group_id),from:t.from,block_type:t.block_type})}function vt(e,t){d.j(e,"hover_mention_group",{group_id:(0,r.F9)(t.group_id)})}function bt(e,t){d.j(e,"hover_page_mention_start",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function yt(e,t){d.j(e,"hover_page_mention_end",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function _t(e,t){d.j(e,"page_mention_click",{page_visit_id:t.page_visit_id,mentioned_page_id:t.mentioned_page_id,source_type:t.source_type,hover_preview_enabled:t.hover_preview_enabled,is_navigable_block:t.is_navigable_block})}function St(e,t){d.j(e,"mention_date",{date:t.date,from:t.from,block_type:t.block_type})}function wt(e,t){d.j(e,"mention_page",{mentioned_page_id:(0,r.F9)(t.page_id),from:t.from,block_type:t.block_type})}function kt(e,t){d.j(e,"inline_equation_edit",t)}function It(e,t){d.j(e,"set_reminder",{date:t.date,reminder:t.reminder})}function xt(e){d.j(e,"resize_column")}function Ct(e){d.j(e,"reset_column_sizes")}function Tt(e){d.j(e,"create_column_list")}function Mt(e,t){d.j(e,"insert_column",t)}function Pt(e,t){d.j(e,"drag_near_edge_scroll",t)}function At(e,t){d.j(e,"transform_text_block_filter",t)}function Rt(e,t){d.j(e,"unicode_filter",t)}function Dt(e,t){d.j(e,"annotation_filter",t)}function Bt(e,t){d.j(e,"keyboard_annotation",t)}function Et(e,t){d.j(e,"link_filter",t)}function Ft(e,t){d.j(e,"change_email",t)}function Zt(e,t){d.j(e,"toggle_allow_search_engine_indexing",t)}function Vt(e,t){d.j(e,"set_expiration_time_on_public_page",t)}function jt(e,t){d.j(e,"toggle_allow_duplicate",t)}function Ut(e,t){d.j(e,"restrict_permissions",t)}function Lt(e,t){d.j(e,"restore_permissions",t)}function Ot(e,t){d.j(e,"set_database_sync_permissions",t)}function Nt(e){d.j(e,"sidebar_expand")}function zt(e){d.j(e,"sidebar_unexpand")}function Wt(e,t){d.j(e,"bookmark",t)}function qt(e,t){d.j(e,"unbookmark",t)}function Ht(e,t){d.j(e,"open_settings",t)}function Kt(e,t){d.j(e,"toggle_settings_tab",t)}function Gt(e,t){d.j(e,"site_settings_action",t)}function $t(e){d.j(e,"upload_profile_photo")}function Qt(e,t){d.j(e,"name_changed",t)}function Yt(e){d.j(e,"delete_account_clicked")}function Jt(e){d.j(e,"delete_account_confirmed")}function Xt(e){d.j(e,"log_out_from_active_sessions_clicked")}function en(e){d.j(e,"change_password_clicked")}function tn(e){d.j(e,"remove_password_clicked")}function nn(e,t){d.j(e,"locale_changed",t)}function on(e,t){d.j(e,"invite_link_updated",t),h.default.logEvent("invite_link_updated",String(t.enabled),t)}function rn(e,t){d.j(e,"allowed_email_domains_updated",t)}function an(e){d.j(e,"open_trash")}function sn(e,t){d.j(e,"toggle_trash_tab",t)}function ln(e){d.j(e,"restore_trash_page")}function cn(e){d.j(e,"delete_trash_page")}function dn(e){d.j(e,"open_breadcrumb_current_page_menu")}function un(e){d.j(e,"click_breadcrumb_current_page_scroll_to_top")}function pn(e){d.j(e,"click_breadcrumb_move_to")}function mn(e,t){d.j(e,"open_page_share",t),h.default.logEvent("open_page_share")}function fn(e,t){d.j(e,"close_page_share",t)}function gn(e){d.j(e,"open_more_menu")}function hn(e){d.j(e,"open_more_connections_menu")}function vn(e){d.j(e,"open_public_more_menu")}function bn(e){d.j(e,"confirm_app_update")}function yn(e,t){d.j(e,"show_page_reload_confirmation_dialog",t)}function _n(e,t){d.j(e,"export",t)}function Sn(e,t){d.j(e,"export_failed",t)}function wn(e,t){const{teamStore:n,...o}=t;Xo(e,"click_outliner_item",{store:n,...o})}function kn(e,t){"onboarding"===t.from?function(e,t){const{teamStore:n,...o}=t;Xo(e,"create_onboarding_page",{store:n,...o})}(e,{from:t.from,teamStore:t.teamStore,forkedTemplateId:t.pageId}):F(e,{type:"page",from:t.from,teamStore:t.teamStore,new_page_id:t.pageId,creating_block_id:t.pageId})}function In(e,t){const{teamStore:n,...o}=t;Xo(e,"outliner_item_toggle",{store:n,...o})}function xn(e,t){Xo(e,"outliner_team_toggle",t)}function Cn(e,t){d.j(e,"outliner_section_toggle",t)}function Tn(e){d.j(e,"click_nested_child_page")}function Mn(e,t){d.j(e,"click_desktop_navigator",t)}function Pn(e){d.j(e,"open_space_switcher")}function An(e){d.j(e,"space_switcher_select_space")}function Rn(e){d.j(e,"space_switcher_logout_click")}function Dn(e,t){d.j(e,"toggle_dark_mode",t)}function Bn(e){d.j(e,"delete_user")}function En(e,t){d.j(e,"pin_page",t)}function Fn(e,t){d.j(e,"unpin_page",t)}function Zn(e){d.j(e,"notion_calendar_connect")}function Vn(e,t){d.j(e,"tap_mobile_action_bar_item",{item_name:t.itemName,from:t.from})}function jn(e){d.j(e,"scroll_mobile_action_bar")}function Un(e){d.j(e,"open_mobile_sidebar")}function Ln(e,t){d.j(e,"tap_mobile_bottom_bar_item",{...t})}function On(e){d.j(e,"mobile_add_to_menu_accept")}function Nn(e,t){d.j(e,"navigation",{...t})}function zn(e){d.j(e,"open_emoji_menu")}function Wn(e,t){d.j(e,"emoji_no_results",t)}function qn(e,t,n){d.j(e,t,n)}function Hn(e,t,n){d.j(e,t,n),h.default.logEvent(t,n.icon)}function Kn(e,t){d.j(e,"open_history",{from:t})}function Gn(e){return Date.now()-parseInt(e.timestamp)}function $n(e,t){d.j(e,"select_snapshot",{ageMs:Gn(t)})}function Qn(e,t){d.j(e,"history_copy",{ageMs:Gn(t)})}function Yn(e,t){d.j(e,"restore_snapshot",{ageMs:Gn(t)})}function Jn(e,t){var n;d.j(e,"fork_page",{blockId:t},{dontWait:!0}),h.default.logEvent("fork_page",null===(n=document.location)||void 0===n||null===(n=n.host)||void 0===n||null===(n=n.split(".notion."))||void 0===n?void 0:n[1])}function Xn(e,t){const{type:n,bytes:o,data:i}=t;d.j(e,n,{bytes:o,...i})}function eo(e,t){d.j(e,"offline_access_failure",t)}function to(e,t){d.j(e,"open_view_all_popover",t)}function no(e){d.j(e,"copy_link_from_permissions_setting")}function oo(e){d.j(e,"copy_web_link")}function io(e,t){d.j(e,"select_page_from_view_all_popover",t)}function ro(e){d.j(e,"dismiss_new_page_suggested_templates")}function ao(e){d.j(e,"transclusion_container_copy_button")}function so(e,t){d.j(e,"transclusion_container_open_backlinks",t)}function lo(e,t){d.j(e,"open_comments_sidebar",t)}function co(e,t){d.j(e,"open_updates_sidebar",t)}function uo(e,t){d.j(e,"updates_sidebar_tab_click",t)}const po={tracked:!1};function mo(e){let{environment:t,type:n,onboardingState:o}=e;if(po.tracked)return;const i={type:n,onboardingStage:null==o?void 0:o.stage};d.j(t,"cookie_banner_shown",i),po.tracked=!0}function fo(e){d.j(e,"cookie_modal_shown")}function go(e,t){d.lu(e,"legacy_transclusion_show",`legacy_transclusion_show_${t.block_type}`,3600,t)}function ho(e,t){d.j(e,"legacy_transclusion_autofix",t)}function vo(e,t){d.j(e,"transaction_timestamp_collision",t)}function bo(e,t){d.j(e,"transaction_timestamp_regression",t)}function yo(e,t){d.j(e,"transaction_race_hazard",t)}function _o(e,t){d.j(e,"transaction_async_data_loss",t)}function So(e,t){d.j(e,"transaction_deadlock_warning",t)}function wo(e,t){d.j(e,"transaction_too_large",t)}function ko(e,t){d.j(e,"transaction_queue_error_show",t)}function Io(e){d.j(e,"connection_error_show",{})}function xo(e,t){d.j(e,"connection_error_indicator_details_show",t)}function Co(e,t){d.j(e,"low_storage_error_show",t)}function To(e,t){d.j(e,"transaction_queue_healthcheck",t)}function Mo(e,t){d.j(e,"save_edits_error_modal_show",t)}function Po(e,t){d.j(e,"unsaved_transaction_error",t)}function Ao(e,t){d.j(e,"open_team_browser",t)}function Ro(e,t){d.j(e,"close_team_browser",{...t,num_of_total_teams:t.num_of_joined_teams+t.num_of_unjoined_teams})}function Do(e,t){d.j(e,"team_browser_search_cleared",t)}function Bo(e,t){const{teamStore:n,outliner_type:o}=t;Xo(e,"team_browser_member_list_hover",{store:n,outliner_type:o})}function Eo(e,t){d.j(e,"create_team_start",{from:t.from,flow_id:t.flowId}),h.default.logEvent("create_team_start",1,t)}async function Fo(e,t){const{store:n}=t;await n.load(),Xo(e,"create_team_complete",t),Jo("create_team_complete",t)}async function Zo(e,t){const{store:n}=t;await n.load(),Xo(e,"enable_teams",t)}function Vo(e,t){const{screen:n,...o}=t;if(n===f.F.Team){const t={screen:"team",...o};return Xo(e,"close_create_team_modal",t),void Jo("close_create_team_modal",t)}const i={screen:"members",flow_id:t.flow_id,from:t.from,team_id:t.team_id,store:t.store};Xo(e,"close_create_team_modal",i),Jo("close_create_team_modal",i)}function jo(e,t){Xo(e,"invite_team_members",t),Jo("invite_team_members",t)}function Uo(e,t){Xo(e,"invite_team_groups",t),Jo("invite_team_groups",t)}function Lo(e,t){Xo(e,"set_default_team",t)}function Oo(e,t){Xo(e,"join_team",t),Jo("join_team",t)}function No(e,t){Xo(e,"archive_team",t)}function zo(e,t){Xo(e,"transition_to_zero_teams",t)}function Wo(e,t){Xo(e,"restore_team",t)}function qo(e,t){Xo(e,"remove_team_members",t)}function Ho(e,t){Xo(e,"remove_team_groups",t)}function Ko(e,t){Xo(e,"change_teams_order",t)}function Go(e,t){Xo(e,"change_team_access_level",t)}function $o(e,t){Xo(e,"update_team_settings",t)}function Qo(e,t){Xo(e,"open_outliner_team_overflow",t)}function Yo(e,t){Xo(e,"click_outliner_team_overflow_option",t),Jo("click_outliner_team_overflow_option",t)}function Jo(e,t){const{store:n,...o}=t;n?h.default.logEvent(e,1,{...(0,d.nB)(n),...o}):h.default.logEvent(e,1,t)}async function Xo(e,t,n){const{store:o,...r}=n;if(!o)return void(await d.j(e,t,{...r}));const a=(0,d.nB)(o),s=i.CE(a,"team_id");await d.j(e,t,{...s,...r},{forceOverrideAutomaticEventData:{team_id:a.team_id}})}function ei(e,t,n,o,r){const{store:a,...s}=r;if(!a)return void d.lu(e,t,n,o,{...s});const l=(0,d.nB)(a),c=i.CE(l,"team_id");d.lu(e,t,n,o,{...c,...s},{forceOverrideAutomaticEventData:{team_id:l.team_id}})}function ti(e,t){Xo(e,"open_team_home",t)}function ni(e){switch(e){case g.a.General:return"general";case g.a.Members:return"members";case g.a.Security:return"security";default:(0,l.t1)(e)}}function oi(e,t){Xo(e,"click_team_settings_tab",{store:t.store,tab_old_value:ni(t.tab_old_value),tab_new_value:ni(t.tab_new_value)})}function ii(e,t){Xo(e,"restore_team_permissions",t)}function ri(e,t){Xo(e,"team_invite_link_confirmation_selection",t)}function ai(e,t){Xo(e,"copy_team_invite_link",t),Jo("copy_team_invite_link",t)}function si(e,t){Xo(e,"click_team_invite_link",t)}function li(e,t){Xo(e,"request_access_to_team",t)}function ci(e,t){Xo(e,"resolve_team_access_request",t)}function di(e,t){d.j(e,"domain_verification_domain_added",t)}function ui(e,t){d.j(e,"domain_verification_verification_attempted",t)}function pi(e,t){d.j(e,"domain_verification_domain_verified",t)}function mi(e,t){d.j(e,"workspace_creation_ability",t)}function fi(e,t){d.j(e,"workspace_creation_setting_updated",t)}function gi(e,t){d.j(e,"claimable_spaces_viewed",t)}function hi(e,t){d.j(e,"space_transfer_requested",t)}function vi(e,t){d.j(e,"space_transfer_completed",t)}function bi(e,t){d.j(e,"space_claim_upgrade_requested",t)}function yi(e,t){d.j(e,"space_claim_upgrade_completed",t)}function _i(e,t){d.j(e,"space_claim_deletion_started",t)}function Si(e,t){d.j(e,"space_claim_deletion_canceled",t)}function wi(e,t){d.j(e,"move_to_error",t)}function ki(e,t){d.j(e,"show_user_validation_response",t)}function Ii(e,t){d.j(e,"full_screen_action",t)}function xi(e,t){d.j(e,"recurrence_menu_open",t)}function Ci(e,t){d.j(e,"recurrence_saved",t)}function Ti(e,t){d.j(e,"overview_analytics_filter_change",t)}function Mi(e,t){d.j(e,"user_analytics_engagement_timerange_filter_change",t)}function Pi(e,t){d.j(e,"user_analytics_table_filter_change",t)}function Ai(e,t){d.j(e,"user_analytics_table_sort_change",t)}function Ri(e,t){d.j(e,"user_analytics_export_requested",t)}function Di(e,t){d.j(e,"content_analytics_engagement_timerange_filter_change",t)}function Bi(e,t){d.j(e,"content_analytics_export_requested",t)}function Ei(e,t){d.j(e,"content_analytics_table_filter_change",t)}function Fi(e,t){d.j(e,"content_analytics_table_timerange_filter_change",t)}function Zi(e,t){d.j(e,"content_analytics_table_sort_change",t)}function Vi(e,t){d.j(e,"workspace_analytics_tab_click",t)}function ji(e,t){d.j(e,"search_analytics_table_timerange_filter_change",t)}function Ui(e,t){d.j(e,"search_analytics_table_sort_change",t)}function Li(e){d.j(e,"admin_content_search_analytics_acknowledge_confirm")}function Oi(e,t){d.j(e,"admin_content_search_analytics_filter_change",t)}function Ni(e,t){d.j(e,"admin_content_search_analytics_queried",t)}function zi(e,t){d.j(e,"admin_content_search_analytics_export_requested",t)}function Wi(e,t){d.j(e,"wiki_convert",t),h.default.logEvent("wiki_convert",void 0,t)}function qi(e,t){d.j(e,"wiki_undo_conversion",t),h.default.logEvent("wiki_undo_conversion",void 0,t),s.j({name:"wiki_undo_conversion",args:t})}function Hi(e,t){d.j(e,"wiki_promo_show",t),h.default.logEvent("wiki_promo_show",void 0,t)}function Ki(e){d.j(e,"wiki_promo_click_learn_more")}function Gi(e){d.j(e,"wiki_promo_dismiss")}function $i(e,t){d.j(e,"verification_update",t),h.default.logEvent("verification_update",t.action)}function Qi(e,t){d.j(e,"toggle_open_in_desktop_app",t)}function Yi(e){d.j(e,"configure_open_in_desktop_app")}function Ji(e){d.j(e,"open_in_desktop_app_popup_dismiss")}function Xi(e){d.j(e,"open_in_desktop_app_popup_display")}function er(e){d.j(e,"open_in_desktop_app_popup_download")}function tr(e,t){d.j(e,"open_in_desktop_app_popup_open_in_app",t)}function nr(e,t){const{from:n}=t;d.j(e,"show_tooltip",{from:n,time:Date.now()})}function or(e,t){const{from:n}=t;d.j(e,"dismiss_tooltip",{from:n,time:Date.now()})}function ir(e){d.j(e,"luxon_hacky_offset_parses_correctly_false")}},10910:(e,t,n)=>{n.d(t,{Bp:()=>f,HC:()=>p,NF:()=>r,RL:()=>l,Tl:()=>u,UD:()=>_,Vo:()=>s,WP:()=>v,Xw:()=>m,_e:()=>d,bd:()=>y,g_:()=>g,ov:()=>h,qG:()=>c,rT:()=>a,zi:()=>b});var o=n(77472),i=n(77080);function r(e,t){o.j(e,"ai_action",t)}function a(e,t,n){const i={site:"client",...n};o.j(e,t,i)}function s(e,t){o.j(e,"ai_favorite_action",t)}function l(e,t){o.j(e,"ai_block_action",t)}function c(e,t){o.j(e,"ai_autofill_action",t),i.default.logEvent("ai_autofill_action",1,{action_type:t.type})}function d(e,t){o.j(e,"ai_autofill_settings_action",t)}function u(e,t){o.j(e,"ai_completion_popup_open",t)}function p(e,t){o.j(e,"ai_completion_popup_close",t),i.default.logEvent("ai_completion_popup_close",1,{exit_type:t.exit_type})}function m(e,t){o.j(e,"ai_completion_popup_retry",t)}function f(e,t){o.j(e,"ai_completion_popup_history_navigation",t)}function g(e,t){o.j(e,"ai_completion_popup_preview_start",t),i.default.logEvent("ai_completion_popup_preview_start",1,{from:t.from,prompt_key:t.prompt_key})}function h(e,t){o.j(e,"ai_completion_popup_update_prompt_text",t)}function v(e,t){o.j(e,"ai_completion_popup_preview_end",t),i.default.logEvent("ai_completion_popup_preview_end",1,{preview_time:t.preview_time})}function b(e,t){o.j(e,"ai_completion_popup_preview_stopped_by_user",t)}function y(e,t){o.j(e,"ai_user_data_sharing_opt_in_submit",t)}function _(e,t){o.j(e,"getCompletion.emptyResponse",t),i.default.logEvent("getCompletion.emptyResponse",1,{promptKey:t.promptKey})}},8406:(e,t,n)=>{n.d(t,{$q:()=>f,Ac:()=>_,Rc:()=>g,S$:()=>v,YU:()=>w,_H:()=>l,bW:()=>x,bn:()=>T,g2:()=>I,gd:()=>k,gl:()=>m,mH:()=>c,nS:()=>p,qm:()=>S,rv:()=>b,tW:()=>C,tf:()=>M,wd:()=>u,xb:()=>d,y9:()=>h,zF:()=>y});var o=n(34296),i=n(97880),r=n(77472),a=n(75079),s=n(50906);function l(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};s._Hi(t,{...i,...o})}function c(e,t){r.j(e,"collection_create_suggested_property_latency",t)}function d(e){const{environment:t,collectionContextStore:n,view_type:o,view_config_uri:i,...r}=e,l=(0,a.Pn)(n)||{};s.xbC(t,{...l,...r,view_type:o,view_config_uri:i})}function u(e){const{environment:t,collectionContextStore:n,action:o,original_view_type:i,new_view_type:r,new_view_id:l,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u}=e,p=(0,a.Pn)(n);p&&p.view_type&&s.wds(t,{action:o,...p,view_type:p.view_type,original_view_type:i,new_view_type:r,new_view_id:l,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u})}function p(e){const t=(0,a.Pn)(e.collectionContextStore);t&&t.view_type&&s.MU3(e.environment,{from:e.from,from_peek_mode:e.from_peek_mode,...t,view_type:t.view_type})}function m(e){const{peek_mode:t,from_peek_mode:n}=e,o=(0,a.Pn)(e.collectionContextStore);o&&o.view_type&&s.lgT(e.environment,{from:e.from,peek_mode:t,from_peek_mode:n,...o,view_type:o.view_type})}function f(e){const{environment:t,collectionContextStore:n,property:o,from:i,action:r,new_property_type:l,...c}=e,d=n.normalizedSchemaStore.state[o],u=(0,a.Pn)(n)||{};s.$qu(t,{property_type:null==d?void 0:d.type,new_property_type:l,property:o,from:i,action:r,...c,...u})}function g(e){const{environment:t,collectionContextStore:n,view_type:o,from:i,...r}=e,l=(0,a.Pn)(n)||{};s.RcY(t,{from:i,...r,...l,view_type:o})}function h(e){const{environment:t,collectionContextStore:n,property_type:o,from:i,property:r,...l}=e,c=(0,a.Pn)(n)||{};s.y9e(t,{property:r,property_type:o,from:i,...l,...c})}function v(e,t,n){var o,s,l;let c="page_properties";const d=(0,a.Pn)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;default:(0,i.t1)(d.view_type)}const u={...n,collection_id:null==t||null===(o=t.collectionStore())||void 0===o?void 0:o.id,collection_view_id:null==t||null===(s=t.collectionViewStore())||void 0===s?void 0:s.id,collection_view_block_id:null==t||null===(l=t.collectionViewBlockStore())||void 0===l?void 0:l.id,from:c};r.j(e,"copy_property",u)}function b(e){var t;const{environment:n,collectionContextStore:o,block_id:i,property:r,property_type:l,from:c,isFromBulkActionsToolbar:d,isUnthrottled:u,collection_id:p,...m}=e,f=(0,a.Pn)(o,p)||{};let g;null!==(t=o.currentSubitemFormatStore.state)&&void 0!==t&&t.property?g="subitem":o.currentArrowsByFormatStore.state&&(g="timeline_arrows_by"),s.rvl(n,{block_id:i,property:r,property_type:l,property_context:g,from:c,isFromBulkActionsToolbar:d,...m,...f},u||!1)}function y(e){const{environment:t,collectionContextStore:n,property:o,property_type:i,from:s,isFromBulkActionsToolbar:l,...c}=e,d=(0,a.Pn)(n)||{};r.j(t,"collection_open_block_property_overlay",{property:o,property_type:i,property_context:undefined,from:s,isFromBulkActionsToolbar:l,...c,...d})}function _(e){const{environment:t,collectionContextStore:n,checkbox_type:o,...i}=e,s=(0,a.Pn)(n)||{};r.j(t,"collection_multi_select_checkbox_clicked",{...s,checkbox_type:o,...i})}function S(e){const{environment:t,collectionContextStore:n,property_type:o,num_rows:i}=e,r=(0,a.Pn)(n)||{};s.fMl(t,{property_type:o,num_rows:i,...r})}function w(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};s.YU0(t,{...i,...o})}function k(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};r.j(t,"convert_db_start",{...i,...o})}function I(e){const{environment:t,collectionContextStore:n,...o}=e,i=(0,a.Pn)(n)||{};r.j(t,"convert_db_complete",{...i,...o})}function x(e){r.j(e,"collections.bypassed_query_collection_request")}function C(e){const{environment:t,totalResults:n,clickedIndex:i,eventName:a,sessionId:s,source:l,queryLength:c}=e;let d;l===o.S.Automation?d="automation_collection_picker":l===o.S.Relation?d="collection_settings_select_relation_source":l===o.S.Source&&(d="collection_settings_source");const u=Boolean(0===c);(0,r.j)(t,a,{source:d,"server-indexAlias":"collection",totalResults:n,clickedIndex:i,sessionId:s,queryLength:c,isEmptyQuery:u})}function T(e){r.j(e,"collection_load_more_blocks")}function M(e){r.j(e,"collection_load_more_groups")}},85344:(e,t,n)=>{n.d(t,{$5:()=>c,Em:()=>w,Je:()=>a,Rn:()=>s,SU:()=>y,Uw:()=>_,Yz:()=>u,ZW:()=>r,Zq:()=>k,bR:()=>m,d2:()=>g,hJ:()=>b,jX:()=>p,k$:()=>h,lL:()=>d,pP:()=>S,x6:()=>f,yr:()=>l,zd:()=>v});var o=n(77472),i=n(77080);function r(e,t){o.j(e,"open_block_discussion_menu",t)}function a(e){let{environment:t,from:n,notificationId:i,activityId:r}=e;o.j(t,"open_reply_discussion_menu",{from:n,notificationId:i,activityId:r})}function s(e){let{environment:t,from:n,notificationId:i,activityId:r}=e;o.j(t,"close_reply_discussion_menu",{from:n,notificationId:i,activityId:r})}function l(e){o.j(e,"open_new_block_discussion")}function c(e){o.j(e,"open_new_inline_discussion")}function d(e){o.j(e,"discard_new_discussion_dialog_show")}function u(e){o.j(e,"discard_new_discussion_dialog_confirm")}function p(e){o.j(e,"discard_new_discussion_dialog_cancel")}function m(e,t){o.j(e,"create_block_discussion",t),i.default.logEvent("create_block_discussion")}function f(e,t){o.j(e,"create_inline_discussion",t),i.default.logEvent("create_inline_discussion")}function g(e,t){o.j(e,"add_comment",t),i.default.logEvent("add_comment",t.from)}function h(e,t){o.j(e,"delete_comment",t)}function v(e,t){o.oP(e,{eventName:"edit_comment",eventProperties:t})}function b(e,t){o.j(e,"resolve_discussion",t),i.default.logEvent("resolve_discussion",t.from)}function y(e,t){o.j(e,"reopen_discussion",t)}function _(e,t){o.j(e,"click_discussion",t)}function S(e){const{environment:t,...n}=e;o.j(t,"add_reaction",n),i.default.logEvent("add_reaction",n.reaction_value)}function w(e){const{environment:t,...n}=e;o.j(t,"remove_reaction",n)}function k(e,t){o.j(e,"comment_upload_attachments",t)}},57549:(e,t,n)=>{n.d(t,{AS:()=>H,B3:()=>Y,BI:()=>C,Cm:()=>R,D:()=>N,D6:()=>S,DU:()=>P,DW:()=>L,EJ:()=>M,EU:()=>te,FB:()=>B,FI:()=>f,G7:()=>v,Gl:()=>h,IG:()=>z,IN:()=>j,IV:()=>D,Iv:()=>K,L3:()=>p,Mp:()=>Q,Ng:()=>T,PR:()=>A,SC:()=>J,SO:()=>y,Sy:()=>u,Vf:()=>m,YY:()=>E,Z3:()=>g,Z9:()=>V,_x:()=>$,a1:()=>c,ay:()=>l,bO:()=>k,cV:()=>w,eR:()=>W,fc:()=>Z,iI:()=>U,lL:()=>G,oQ:()=>X,oS:()=>I,pZ:()=>x,pp:()=>ee,qJ:()=>b,qy:()=>d,tf:()=>O,uu:()=>_,uy:()=>F,wi:()=>q});var o=n(30845),i=n(64002),r=n(77472),a=n(71776),s=n(77080);function l(e,t){r.j(e,"import_button_click",t)}function c(e,t){r.j(e,"import_source_auth",t)}function d(e,t){r.j(e,"import_source_input",t)}function u(e,t){r.j(e,"open_import_modal",t)}function p(e,t){r.j(e,"auth_integration",t)}function m(e,t){r.j(e,"integration_select_all",t)}function f(e,t){r.j(e,"integration_deselect_all",t)}function g(e,t){r.j(e,"integration_select_item",t)}function h(e,t){r.j(e,"integration_deselect_item",t)}function v(e,t){r.j(e,"import_integration",t)}function b(e,t){r.j(e,"remove_integration",t)}function y(e,t){r.j(e,"integration_prompt_auth",t)}function _(e){r.j(e,"open_google_drive_file_picker")}function S(e,t){r.j(e,"google_drive_pick_file",t)}function w(e,t){r.j(e,"google_drive_embed_file",t)}function k(e,t){const{pastedText:n}=t;let a;if(o.B(n,"url")){const e=i.Qc(n);e.host&&(a=e.host)}if(a){const{pastedText:n,...o}={...t,url_domain:a};r.j(e,"paste_url",o)}}function I(e,t){const n=t.url?(0,i.gy)(t.url):void 0;r.j(e,"edit_link",{type:t.type,url_domain:null==n?void 0:n.hostname})}function x(e){r.j(e,"edit_link_title")}function C(e){r.j(e,"developer_integrations_list_visit")}function T(e){r.j(e,"developer_integrations_new_click")}function M(e,t){r.j(e,"developer_integrations_filter_click",t)}function P(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_view_visit",{type:n})}function A(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_create",{type:n})}function R(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_view_secret",{type:n})}function D(e,t){const n=a.OS[t.table];r.j(e,"developer_integrations_copy_secret",{type:n})}function B(e,t){const n=a.OS[t.table],{table:o,...i}=t;r.j(e,"developer_integrations_update",{type:n,...i})}function E(e,t){r.j(e,"developer_integrations_my_integrations_click",t)}function F(e,t){r.j(e,"developer_integrations_all_integrations_click",t)}function Z(e,t){r.j(e,"developer_integrations_visit_developer_website_click",t)}function V(e,t){r.j(e,"developer_integrations_contact_developer_click",t)}function j(e,t){r.j(e,"developer_integrations_disconnect_click",t)}function U(e,t){r.j(e,"developer_integrations_open_card_dropdown_click",t)}function L(e,t){r.j(e,"developer_integrations_delete_click",t)}function O(e,t){r.j(e,"developer_integrations_confirm_delete_click",t)}function N(e,t){r.j(e,"install_public_integration_oauth",t)}function z(e,t){r.j(e,"security_and_compliance_integration_oauth_attempt",t)}function W(e,t){r.j(e,"security_and_compliance_integration_install",t)}function q(e,t){r.j(e,"security_and_compliance_integration_uninstall",t)}function H(e,t){r.j(e,"security_and_compliance_integration_update",t)}function K(e,t){r.j(e,"connect_external_integration",t),s.default.logEvent("connect_external_integration",void 0,t)}function G(e,t){r.j(e,"disconnect_external_integration",t)}function $(e,t){r.j(e,"activate_link_preview_menu",t)}function Q(e,t){r.j(e,"save_link_preview",t)}function Y(e,t){r.j(e,"update_link_preview",t)}function J(e,t){r.j(e,"open_link_preview_help_guide",t)}function X(e,t){r.j(e,"remove_link_preview_with_error",t)}function ee(e,t){r.j(e,"link_preview_url_miss",t)}function te(e,t){r.j(e,"show_all_discoverable_connected_apps",t)}},91219:(e,t,n)=>{n.d(t,{$2:()=>T,$z:()=>R,E0:()=>M,Mq:()=>A,TC:()=>x,UW:()=>k,bR:()=>B,ci:()=>P,hE:()=>I,jB:()=>w,l5:()=>S,q_:()=>C,yE:()=>D});var o=n(79946),i=n(33728),r=n(72126),a=n(4615),s=n(19889),l=n(77472),c=n(15010),d=n(80444),u=n(77080),p=n(29677),m=n(26136),f=n(88893),g=n(35057),h=n(88280),v=(n(50906),n(81918)),b=n(82530),y=n(37181);function _(e){var t;const n=e.invite_targets.filter(p.cl),o=e.invite_targets.filter(p.fZ),s=n.length+o.length,l=r.oA(e.permission_items.map((e=>{if("user_permission"===e.type)return e.user_id&&(0,a.cj)(e.user_id)}))),c=new Set(null===(t=d.default.state.currentSpaceStore)||void 0===t?void 0:t.getEmailDomains()),u=e.invite_targets.filter((e=>{if("existingUser"!==e.type&&"newUser"!==e.type)return!1;const t=(0,i.Gd)(e.value.email);return t&&c.has(t)})).flatMap((e=>e.value.id?[e.value.id]:[])),m=(0,g.zt)();return{role:e.role,user_count:s,new_user_count:n.length,new_workspace_member_count:e.is_space?s:u.length,new_workspace_member_ids:e.is_space?l:u,is_onboarding:e.is_onboarding,invite_flow_id:e.invite_flow_id,invite_origin:e.invite_origin,invitee_ids:l,invite_message_length:e.invite_message_length,subscription_tier:m,domain_type:e.domainType,...!e.is_space&&{share_menu_session_id:e.share_menu_session_id},allow_domain_auto_invite:u.length>0,is_space:e.is_space}}function S(e,t){const n=_(t);l.j(e,"invite_error",n)}function w(e,t){const n=(0,g.zt)(),r=_(t);l.j(e,"invite",{...r,is_space:t.is_space}),h.subscriptionDataStoreInstance.waitUntilLoaded().then((()=>{const n=h.subscriptionDataStoreInstance.state,o=n?f.Ln(e,n):void 0,a=n?f.Lz(e,n):void 0;l.j(e,"invite_debug_with_block_usage",{...r,is_space:t.is_space,is_over_block_limit:o,block_usage:a}),t.is_space||(!function(e,t){const{currentSpaceStore:n,currentUserStore:o}=d.default.state,r=n&&n.canEditMembership(),a=c.JF(),u=null==o?void 0:o.getEmail();if(!r||!a||!u)return;if("professional"!==a)return;const p=(0,i.Gd)(u),g=f.A7().slice(0,50).map((e=>m.U6.createChildStore(n,{table:s.KJ,id:e.userId}).getEmail())).filter((e=>e&&(0,i.Gd)(e)===p)).length;l.j(e,"page_invite_guest_summary",{...t,guest_with_same_domain_count:g})}(e,r),v.fN(e,{inviteTargets:t.invite_targets,origin:t.invite_origin}))})),(t.is_space||r.allow_domain_auto_invite)&&(l.j(e,"space_invite",r),l.Zf(e,{space_invited:!0}),u.default.logEvent("space_invite",r.allow_domain_auto_invite?`${t.invite_origin}_allow_domain`:t.invite_origin,r),v.Jk(e,{invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:r.new_workspace_member_count,new_workspace_member_ids:r.new_workspace_member_ids,allow_domain_auto_invite:r.allow_domain_auto_invite}),function(e,t){const n=(0,g.zt)();t.visibleMembersCount<=1&&(l.j(e,"workspace_first_invite_sent"),o.kd(n,t.domainType),"professional"===t.domainType&&(l.j(e,"professional_workspace_first_invite_sent",{visible_members_count:t.visibleMembersCount,is_professional_team_user:t.isProfessionalTeamUser,domain_type:t.domainType}),o.Dq()))}(e,{visibleMembersCount:f.qX(),isProfessionalTeamUser:t.isProfessionalTeamUser,domainType:t.domainType})),t.is_space||r.new_workspace_member_ids.length===t.invite_targets.length||(l.j(e,"page_invite",r),u.default.logEvent("page_invite",n,r),function(e,t){const{currentUserSettingsStore:n}=d.default.state;if(!n)return;const o=n.getKeyStore("settings").getKeyStore("signup_time").getValue(),i=n.getKeyStore("settings").getKeyStore("first_page_invite_at").getValue();if(!Boolean(i)){const i=Date.now(),r={...t,...o?{signup_time_ready:!0,time_from_signup_to_first_page_invite:o-i}:{signup_time_ready:!1}};l.j(e,"page_invite_time",r),u.default.logEvent("page_invite_time",t.subscription_tier,r),b.createAndCommit({userAction:"firstPageInvite",environment:e,userId:n.id,perform:e=>{y.d2({userSettingsStore:n,data:{first_page_invite_at:i},transaction:e})}})}}(e,r))}function k(e,t){l.j(e,"invite_typed",t),u.default.logEvent("invite_typed",t.subscription_tier,{...t})}function I(e,t){l.j(e,"invite_select_target",t),u.default.logEvent("invite_select_target",t.subscription_tier,{selected_user_token_rank:t.selected_user_token_rank,from:t.from,type:t.type??"permission_invite"})}function x(e,t){l.j(e,"invite_change_role",t),u.default.logEvent("invite_change_role",t.subscription_tier,{...t})}function C(e,t){l.j(e,"abandon_permissions_invite",t),u.default.logEvent("abandon_permissions_invite",t.subscription_tier,{...t})}function T(e,t){l.j(e,"open_share_workspace_invite",t),u.default.logEvent("open_share_workspace_invite",t.subscription_tier,{...t})}function M(e,t){l.j(e,"send_share_workspace",t),u.default.logEvent("send_share_workspace",t.subscription_tier,{...t})}function P(e,t){l.j(e,"send_membership_request",t),u.default.logEvent("send_membership_request",t.subscription_tier,{...t})}function A(e,t){l.j(e,"open_page_share_invite",t),u.default.logEvent("open_page_share_invite",t.subscription_tier,{...t})}function R(e){l.j(e,"open_space_invite")}function D(e,t){l.j(e,"invite_modal_input_focus",t)}function B(e,t){l.j(e,"invite_users_to_page",t)}},32441:(e,t,n)=>{n.d(t,{$k:()=>T,AM:()=>v,BR:()=>M,D6:()=>_,Es:()=>m,PB:()=>u,Pu:()=>p,Q4:()=>y,Sn:()=>C,T3:()=>w,VU:()=>x,Wg:()=>h,_W:()=>f,eb:()=>k,es:()=>g,ux:()=>S,yv:()=>I,zX:()=>b});var o=n(79946),i=n(15145),r=n(29477),a=n(9852),s=n(64002),l=n(77472),c=n(14654),d=n(77080);function u(e,t){const{page_id:n,query:o,team_id:r,page_visit_id:a,previous_page_visit_id:d,...u}=t,p=s.Ph(o,i.$X),m=parseInt(p),f="push"===e.RouterStore.getState().action,g=(0,i.bh)(m)&&f?i.tY.LinkInPage:(0,i.xt)(m),h=s.Ph(o,i.Qs),v=c.t3({blockOrCollectionId:n});l.j(e,"page_visit",{...u,page_visit_source:g,notificationId:h,page_visit_id:a,previous_page_visit_id:d,entered_at:Date.now(),home_page_type:v},{forceOverrideAutomaticEventData:{team_id:r}})}function p(e,t){d.default.checkGate("log_page_exit_events_to_analytics")&&l.j(e,"page_exit",{exited_at:Date.now(),page_visit_id:t.pageVisitId},{forceOverrideAutomaticEventData:t})}function m(e){const t=[{name:"initial_partner_stack_key",value:e.partner_stack_key,operation:"setOnce"},{name:"partner_stack_key",value:e.partner_stack_key,operation:"set"}];l.fK(t)}function f(e,t){const n=s.nx(t,(0,a.getUrlAnalyticsFromSessionStorage)());if(n){const{fbclid:e,gclid:t}=n;e&&o.xx({type:"facebook",id:e}),t&&o.xx({type:"google",id:t}),(0,a.saveUrlAnalyticsInSessionStorage)(n)}l.j(e,"visit",{})}function g(e,t){l.j(e,"database_visit",t)}function h(e,t){l.lu(e,"type_aggregated_database_visit",`type_aggregated_database_visit-${t.databaseType}`,60,t)}function v(e,t){l.j(e,"page_error",t)}function b(e,t){return l.j(e,"page_error_button_click",t)}function y(e,t){l.j(e,"reorder_workspaces",t)}function _(e,t){l.j(e,"multi_account_add_or_create_account_clicked",t)}function S(e){l.j(e,"content_classification_proceed")}function w(e,t){l.j(e,"notion_topbar_click",t,{dontWait:!0}),d.default.logEvent("notion_topbar_click",t.variant)}function k(e,t){l.j(e,"template_gallery_public_page_topbar_click",t,{dontWait:!0}),d.default.logEvent("template_gallery_public_page_topbar_click",t.target)}function I(e,t){l.j(e,"getting_started_page_create",t)}function x(e,t){l.j(e,"debug_getting_started_page_error",t)}function C(e,t){l.j(e,"landing_page_visit",{routerName:t}),(0,r.Vs)(4e3).then((n=>{d.default.logEvent(`${t}_page_visit`,e.device.deviceType,{})}))}function T(e,t){l.j(e,"desktop_app_signup_browser_visit",{desktop_app_reroute_email:t.desktopAppRerouteEmail,desktop_app_device_id:t.desktopAppDeviceId})}function M(e,t,n){const o=e=>({blockId:"blockId"in e?e.blockId:void 0,peekViewBlockId:"peekViewBlockId"in e?e.peekViewBlockId:void 0}),{blockId:r,peekViewBlockId:a}=o(t),{blockId:s,peekViewBlockId:c}=o(n),d="pageVisitSource"in n&&n.pageVisitSource?(0,i.xt)(parseInt(n.pageVisitSource)):void 0;l.j(e,"click_in_page_navigation",{current_route_name:t.name,next_route_name:n.name,page_visit_source:d,current_page_id:r,current_peek_view_page_id:a,next_page_id:s,next_peek_view_page_id:c})}},19719:(e,t,n)=>{n.d(t,{Br:()=>R,Cg:()=>j,EH:()=>F,EQ:()=>b,Ee:()=>B,F5:()=>p,FR:()=>Z,GP:()=>k,Jn:()=>x,Md:()=>L,Q6:()=>I,RJ:()=>O,U0:()=>P,Up:()=>w,Xf:()=>M,Z8:()=>v,Zh:()=>U,_H:()=>D,_b:()=>u,b2:()=>C,bE:()=>E,cC:()=>m,gM:()=>V,gY:()=>h,ix:()=>g,kL:()=>z,l2:()=>A,nI:()=>_,pw:()=>S,u_:()=>f,ub:()=>N,zD:()=>T});var o=n(27328),i=n(82813),r=n(97880),a=n(41549),s=n(77080),l=n(4761),c=n(17659),d=n(77472);function u(e){y({...e,target:"archive"})}function p(e){y({...e,target:"unarchive"})}function m(e){y({...e,target:"mark_as_read"})}function f(e){y({...e,target:"mark_as_unread"})}function g(e){y({...e,target:"frame"})}function h(e){y({...e,target:"open_reply_menu"})}function v(e){let{environment:t,pageId:n,isCurrentlyFollowing:o,from:i,notificationId:r}=e;d.j(t,"click_page_updates_notifications_button",{pageId:n,isCurrentlyFollowing:o,from:i,notificationId:r})}function b(e){let{environment:t,backlinkPageId:n,notificationId:o,alreadyRead:i,activity:r,tab:a}=e;y({environment:t,target:"title",notificationId:o,alreadyRead:i,activity:r,tab:a,otherArgs:{backlinkPageId:n}})}function y(e){let{environment:t,target:n,notificationId:o,alreadyRead:r,activity:a,tab:s,otherArgs:c}=e;S({environment:t,target:n});const u=l.ZP.state.sessionId;j(t,{target:n,notification_id:o,activity_id:a.id,tab:s,sessionId:u,is_filtered:l.ZP.isFilteredToUnreadOnly(),...c}),o&&i.e(d.mc(t),{alreadyRead:r,notificationId:o,activityId:a.id,from:n,sessionId:u})}function _(e){const t=l.ZP.state.sessionId;t&&(d.j(e,"close_sidebar_updates",{sessionId:t,tab:x()}),l.ZP.endSession())}function S(e){let{environment:t,target:n}=e,o=!1;switch(n){case"title":case"body":o=!0;break;case"archive":case"unarchive":case"mark_as_read":case"mark_as_unread":case"add_reaction":case"open_reply_menu":case"frame":case"main":o=!1;break;default:(0,r.t1)(n)}o&&_(t)}function w(e){let{environment:t,from:n}=e;const i=(0,o.w_)(t.TabbedRouterStore.state);var r;"web"===(r=i).type&&"nativeTab"===r.route.name&&"updates"===r.route.tab&&k({environment:t,from:n})}function k(e){let{environment:t,forceRestartSession:n,from:o}=e;l.ZP.startSession({forceRestart:n??!1}),function(e,t){s.default.logEvent("open_sidebar_updates",t.tab,t),d.j(e,"open_sidebar_updates",t)}(t,{tab:x(),unread_notifications_count:c.aY(),sessionId:l.ZP.state.sessionId,from:o})}function I(e){let{environment:t,activityUpdatesSource:n,filters:o,prevFilters:i}=e;d.j(t,"update_notification_filters",{source:n,prev_date_range_filter_start:i.dateRange.start,prev_date_range_filter_end:i.dateRange.end,prev_activity_types:i.activityTypes,date_range_filter_start:o.dateRange.start,date_range_filter_end:o.dateRange.end,activity_types:o.activityTypes})}function x(){const e=l.ZP.state.currentTab;switch(e){case"mentions":return"mentions_comments";case"archive":return"archive";case"allPages":return"all_updates";default:(0,r.t1)(e)}}function C(e){let{environment:t,action:n,args:o}=e;d.j(t,"push_notification_desktop",{...o,action:n})}function T(e,t){d.j(e,"archive_all_notifications",{...t,onlyRead:"read"===t.readFilter,sessionId:l.ZP.state.sessionId})}function M(e){d.j(e,"mark_all_notifications_as_read",{sessionId:l.ZP.state.sessionId})}function P(e,t){d.j(e,"toggle_filter_for_unread_notifications",t)}function A(e){let{environment:t}=e;l.ZP.startSession({forceRestart:!0}),d.j(t,"open_sidebar_updates",{tab:a.Fz(),unread_notifications_count:c.aY(),sessionId:l.ZP.state.sessionId,from:"inbox"})}function R(e){let{environment:t}=e;const n=l.ZP.state.sessionId;n&&(d.j(t,"close_sidebar_updates",{tab:a.Fz(),sessionId:n}),l.ZP.endSession())}function D(e){y({...e,target:"main"})}function B(e,t){const{notificationActivityPairs:n,affectedNotificationIds:o,target:i}=t,r=new Set(o),a=n.filter((e=>{let{notification:t}=e;return r.has(t.id)}));if(0===a.length)return;const s=new Set,c=new Set;a.forEach((e=>{let{notification:t,activity:n}=e;"commented"===t.type?s.add(n.discussion_id):c.add(t.id)})),d.j(e,"click_update_group",{target:i,sessionId:l.ZP.state.sessionId,notification_ids:Array.from(c),discussion_ids:Array.from(s),notification_page_id:a[0].notification.navigable_block_id})}function E(e,t){d.j(e,"toggle_inbox_tab",{...t,sessionId:l.ZP.state.sessionId})}function F(e,t){d.j(e,"click_expand_replies",{...t,sessionId:l.ZP.state.sessionId})}function Z(e){d.j(e,"open_notification_settings_from_all_updates")}function V(e){d.j(e,"open_page_updates")}function j(e,t){d.j(e,"click_update",t)}function U(e,t){const{target:n,...o}=t;let i;"notify_mobile"===n?i="set_mobile_notification":"notify_desktop"===n?i="set_desktop_notification":"notify_email"===n?i="set_email_notification":"notify_email_always"===n?i="set_email_always_notification":"notify_email_digest"===n?i="set_email_digest_notification":(0,r.t1)(n),d.j(e,i,o)}function L(e){d.j(e,"set_marketing_emails_preferences")}function O(e,t){d.j(e,"follow_page",t)}function N(e,t){d.j(e,"unfollow_page",t)}function z(e,t){d.j(e,"update_page_follow_settings",t)}},38208:(e,t,n)=>{n.d(t,{$D:()=>g,$l:()=>_,AD:()=>R,C$:()=>I,Gk:()=>c,IE:()=>b,J7:()=>m,NG:()=>d,PL:()=>A,SY:()=>T,TL:()=>P,VZ:()=>B,YV:()=>y,_0:()=>u,a7:()=>E,ax:()=>S,e7:()=>w,fP:()=>C,ho:()=>l,iI:()=>M,jw:()=>p,o7:()=>v,p5:()=>x,qB:()=>Z,qJ:()=>f,rx:()=>D,vd:()=>k,wq:()=>F,y6:()=>h});var o=n(79946),i=n(77472),r=n(15010),a=n(80444),s=n(77080);function l(e,t){i.j(e,"onboarding_dialog_error",t),v(e,"onboarding_dialog_error",t)}function c(e,t){i.j(e,"onboarding_error",t),v(e,"onboarding_error",t)}function d(e,t){if(i.j(e,"onboarding_show",t),s.default.logEvent("onboarding_show",1,{...t}),t.is_new_onboarding){var n;const{currentUserSettingsStore:e}=a.default.getState();s.default.logEvent("sign_up_by_domain_type",null==e||null===(n=e.getSettings())||void 0===n?void 0:n.domain_type,{})}}function u(e,t){i.j(e,"onboarding_invite_copy",t),v(e,"onboarding_invite_copy",t)}function p(e,t){i.j(e,"onboarding_close",t),v(e,"onboarding_close",t)}function m(e,t){i.j(e,"onboarding_skip",t),v(e,"onboarding_skip",t)}function f(e,t){i.j(e,"onboarding_invite_send",t),v(e,"onboarding_invite_send",t)}function g(e,t){i.j(e,"onboarding_space_icon_upload",t),v(e,"onboarding_space_icon_upload",t)}function h(e,t){i.j(e,"onboarding_stage",t),s.default.logEvent("onboarding_stage",1,{stage:t.stage,workspace_type:t.initial_workspace_type,is_new_onboarding:t.is_new_onboarding,device_type:e.device.deviceType}),s.default.logEvent("onboarding_stage_by_stage",t.stage,{}),s.default.logEvent("onboarding_stage_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),s.default.logEvent("onboarding_stage_by_device_type",e.device.deviceType,{})}function v(e,t,n){i.j(e,"onboarding_serverside",{...n,phase:t},{dontWait:!0})}function b(e,t){i.j(e,"onboarding_join_space_click",t),s.default.logEvent("onboarding_join_space_click",t.joined_space_index,{...t})}function y(e,t){i.j(e,"onboarding_invite_click",t);const{invited_emails:n,...o}=t;s.default.logEvent("onboarding_invite_click",n.length,{...o})}function _(e,t){i.j(e,"onboarding_invite_attempt",t)}function S(e,t){i.j(e,"onboarding_upload_profile_photo",t)}function w(e,t){i.j(e,"onboarding_join_space",t)}function k(e,t){i.j(e,"onboarding_create_space",t)}function I(e,t){i.j(e,"onboarding_plan_type_select",t),s.default.logEvent("onboarding_plan_type_select",t.planType,{...t})}function x(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","persona",{...t})}function C(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","role",{...t})}function T(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","useCases",{...t})}function M(e,t){i.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","companySize",{...t})}function P(e,t){i.j(e,"onboarding_persona_survey_action",{...t,action:t.action}),s.default.logEvent("onboarding_persona_survey_action",t.action,{}),s.default.logEvent(`onboarding_persona_survey_action_${t.action}`,t.plan_selection,{})}function A(e,t){var n,l;const{currentUserSettingsStore:c,currentUserRootStore:d}=a.default.state,u=s.default.getExperimentsMap();i.Zf(e,{onboarding_complete:!0,onboarding_emails_experiment:u["onboarding-emails"]}),i.j(e,"onboarding_complete",t),o.PL(),s.default.logEvent("onboarding_complete",1,{domain_type:null==c||null===(n=c.getSettings())||void 0===n?void 0:n.domain_type,device_type:e.device.deviceType,is_new_onboarding:t.is_new_onboarding,is_professional_team_user:r.QZ(),user_persona:t.user_persona,plan_type:t.plan_type,create_or_join:t.initial_workspace_type}),s.default.logEvent("onboarding_complete_by_plan_type",t.plan_type,{}),s.default.logEvent("onboarding_complete_by_device_type",e.device.deviceType,{}),s.default.logEvent("onboarding_complete_by_user_persona",t.user_persona,{}),s.default.logEvent("onboarding_complete_by_user_team_role",t.user_team_role,{}),t.user_use_cases&&t.user_use_cases.forEach((e=>{s.default.logEvent("onboarding_complete_by_user_use_case",e,{})})),s.default.logEvent("onboarding_complete_by_domain_type",null==c||null===(l=c.getSettings())||void 0===l?void 0:l.domain_type,{}),s.default.logEvent("onboarding_complete_by_create_or_join_space",t.initial_workspace_type,{}),s.default.logEvent("onboarding_complete_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),s.default.logEvent("onboarding_complete_by_workspaces_count",(null==d?void 0:d.getSpaceViewStores().length)||0,{}),r.QZ()&&s.default.logEvent("pro_team_onboarding_complete",1,{})}function R(e,t){i.j(e,"proj_management_onboarding_tooltip_show",t),s.default.logEvent("proj_management_tooltip_show")}function D(e,t){i.j(e,"proj_management_onboarding_tooltip_dismiss",t),s.default.logEvent("proj_management_tooltip_dismiss")}function B(e,t){i.j(e,"onboarding_team_invite_email_entered",t)}function E(e,t){i.j(e,"onboarding_team_invite_add_more_clicked",t)}function F(e,t){i.j(e,"onboarding_bulk_invites_rendered",t)}function Z(e,t){i.j(e,"onboarding_desktop_app_download_click",t),s.default.logEvent("onboarding_desktop_app_download_click",1)}},91536:(e,t,n)=>{n.d(t,{Ad:()=>m,E5:()=>K,If:()=>W,Jp:()=>H,Kf:()=>D,L7:()=>y,LA:()=>h,Mv:()=>x,NL:()=>w,O8:()=>F,PH:()=>$,Pd:()=>M,RP:()=>g,SM:()=>O,Xb:()=>A,b4:()=>b,cO:()=>q,d:()=>E,dE:()=>C,dS:()=>k,dU:()=>N,g9:()=>G,gR:()=>T,hY:()=>I,kM:()=>Z,kx:()=>f,nC:()=>z,oE:()=>V,pZ:()=>v,qT:()=>P,xt:()=>B,zU:()=>R});var o=n(72126),i=n(86517),r=n(72141),a=n(4615),s=n(49902),l=n(77472),c=n(67669),d=n(28578),u=n(77080),p=n(50906);function m(e,t){l.j(e,"permissions_settings_security_banner_show",t)}function f(e,t){l.j(e,"permissions_settings_security_banner_click",t)}function g(e,t){l.j(e,"permissions_settings_search_click",t),u.default.logEvent("permissions_settings_search_click",t.current_tab)}function h(e,t){l.j(e,"permissions_settings_export_guests_button_click",t),u.default.logEvent("permissions_settings_export_guests_button_click",1,t)}function v(e,t){l.j(e,"permissions_settings_table_multiselect_click",t)}function b(e,t){l.j(e,"permissions_settings_table_button_click",t)}function y(e,t){l.j(e,"permissions_settings_invite_button_click",t),u.default.logEvent("permissions_settings_invite_button_click",t.type)}function _(e){const{user_id:t,page_id:n,...o}=e;return o}function S(e,t){l.j(e,"update_page_permission","user_id"in t||"page_id"in t?_(t):t)}function w(e,t){l.j(e,"set_permission_item",t)}function k(e,t){if("team"===t.type){const{team_id:n,...o}=t;l.j(e,"expand_permission",{...o},{forceOverrideAutomaticEventData:{team_id:n}})}else l.j(e,"expand_permission",t)}function I(e,t){l.j(e,"page_share_user_access_role",t)}function x(e){const{newRole:t,availableRoles:n}=e;if("none"===t||"content_only_editor"===t)return;n.some((e=>"content_only_editor"===e.role))&&s.j({name:"save_non_content_editor_role"})}function C(e,t,n){l.j(e,"update_space_permission",{...r.jg(t)&&{updated_user_id:(0,a.cj)(t.user_id)},...r.FB(t)&&{updated_bot_id:(0,a.cj)(t.bot_id)},..."user_id"in t||"page_id"in t?_(t):t,...n}),u.default.logEvent("update_space_permission",null==n?void 0:n.from,{role:t.role})}function T(e,t){var n;let{item:o,teamStore:i}=t;const r=null===(n=i.getPermissionItems())||void 0===n?void 0:n.find((e=>e.type===o.type));(null==r?void 0:r.role)!==o.role&&p.YP3(e,"update_team_permission",{store:i,..."user_id"in o||"page_id"in o?_(o):o,..."user_id"in o&&{permission_user_id:(0,a.cj)(o.user_id)},old_role:null==r?void 0:r.role,is_team_role_change:!1,is_permission_change:!0})}function M(e,t){let{permission_user_id:n,store:o,team_role:i}=t;p.YP3(e,"update_team_permission",{store:o,permission_user_id:n,team_role:i,is_team_role_change:!0,is_permission_change:!1})}function P(e,t){l.j(e,"permissions_settings_tab_click",t),u.default.logEvent("permissions_settings_tab_click",t.tab,t)}function A(e){l.j(e,"permission_group_rename")}function R(e,t){l.j(e,"permission_group_set_icon",t)}function D(e,t){l.j(e,"permission_group_add_members",t)}function B(e){l.j(e,"permission_group_remove_member")}function E(e){l.j(e,"permission_group_delete")}function F(e){l.j(e,"permission_group_create")}function Z(e){let{environment:t,location:n,inSudoMode:o,store:i,newItems:r,fromPermissionWrapper:a}=e;j({store:i,newItems:r}).forEach((e=>{let{role_old_inherited_or_most_permissive:i,role_old_on_page:r,privacy_level:s,old_privacy_level:l,newItem:c}=e;S(t,s||l?{...c,location:n,in_sudo_mode:o||void 0,role_old_inherited_or_most_permissive:i,role_old_on_page:r,privacy_level:s,old_privacy_level:l,share_menu_session_id:d.ZP.state.sessionId,from_permission_wrapper:a}:{...c,location:n,in_sudo_mode:o||void 0,role_old_inherited_or_most_permissive:i,role_old_on_page:r,share_menu_session_id:d.ZP.state.sessionId,from_permission_wrapper:a})}))}function V(e){const{environment:t,calculatedPermissions:n}=e;l.j(t,"page_share_permissions_summary",{share_menu_session_id:d.ZP.state.sessionId,page_permission_summary:L(n)})}function j(e){let{store:t,newItems:n}=e;const a=e=>`${e.type}:${i.D3(e)}`,s=t.getPermissionItems(),l=o.KX(s,a),d=c.YO(t).map((e=>e.permissionItem)),u=o.KX(d,a);return n.map((e=>{var t;const n=a(e),o=u[n],i=null===(t=l[n])||void 0===t?void 0:t.role,s=null==o?void 0:o.role;return(0,r.ix)(e)?{newItem:e,role_old_inherited_or_most_permissive:s,role_old_on_page:i,privacy_level:U(e),old_privacy_level:o&&(0,r.ix)(o)?U(o):"private"}:{newItem:e,role_old_inherited_or_most_permissive:s,role_old_on_page:i}}))}function U(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function L(e){const{mostPermissiveSpaceItem:t,mostPermissiveAncestorTeamOwnerItem:n,mostPermissiveAncestorTeamMemberItem:o,pagePermissionUIModel:i}=e,{mostPermissiveGroupPermissions:a,mostPermissiveUserPermissions:s}=i;return{space:t.permissionItem.role,team_owner:null==n?void 0:n.permissionItem.role,team_member:null==o?void 0:o.permissionItem.role,groups:{full_access:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.zz(t)})).length,can_edit:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.VM(t)})).length,can_edit_content:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.WY(t)})).length,can_comment:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.rG(t)})).length,can_view:a.filter((e=>{let{permissionItem:{role:t}}=e;return r.rz(t)})).length},users:{full_access:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.zz(t)})).length,can_edit:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.VM(t)})).length,can_edit_content:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.WY(t)})).length,can_comment:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.rG(t)})).length,can_view:s.filter((e=>{let{permissionItem:{role:t}}=e;return r.rz(t)})).length},privacy_level:U(t.permissionItem)}}function O(e){l.j(e,"widen_permissions")}function N(e,t){l.j(e,"request_access",t)}function z(e,t){l.j(e,"grant_access",t)}function W(e,t){l.j(e,"grant_access_update_access_level",t)}function q(e,t){l.j(e,"ignore_access_request",t)}function H(e,t){l.j(e,"toggle_request_access_security_setting",t)}function K(e,t){l.j(e,"view_all_requests_from_membership_request_notification",t),u.default.logEvent("view_all_requests_from_membership_request_notification","notification",t)}function G(e){l.j(e,"open_guest_membership_request_modal"),u.default.logEvent("open_guest_membership_request_modal")}function $(e){l.j(e,"render_guest_membership_request_entry_point"),u.default.logEvent("render_guest_membership_request_entry_point")}},51787:(e,t,n)=>{n.d(t,{EH:()=>d,Eb:()=>m,Kk:()=>p,Sn:()=>g,WC:()=>s,Zb:()=>h,Zf:()=>u,fh:()=>f,nL:()=>l,sb:()=>c,wF:()=>a});var o=n(77472),i=n(77080),r=n(87956);function a(e,t){const n={...t,isSidePanelCloseable:i.default.checkGate("search_toggle_side_peek")};o.j(e,"open_search",n)}function s(e,t){o.j(e,"space_invitation_email_clicked",t)}function l(e,t){o.j(e,"select_search_item",t);const{numKeystrokes:n,timeToSelectMs:r,selectedItemIndex:a,originalPosition:s,context:l,numLocalResults:c,searchSessionId:d,searchSessionFlowNumber:u,numVisibleMembers:p,localSources:m,isMobile:f}=t,g=Boolean(!!m&&m.length>0),h=p>1;i.default.logEvent("select_search_item",a,{numKeystrokes:n,timeToSelectMs:r,selectedItemIndex:a,numLocalResults:c,originalItemIndex:s,searchSessionFlowNumber:u,searchSessionId:d,context:l,isMultiplayer:h,isLocalResult:g,isMobile:f});const v=1/(a+1);o.j(e,"quick_find_reciprocal_rank",{reciprocalRank:v,context:l,searchSessionId:d,numLocalResults:c,isMultiplayer:h}),i.default.logEvent("quick_find_reciprocal_rank",v,{context:l,searchSessionId:d,numLocalResults:c,isMultiplayer:h,isLocalResult:g,isMobile:f})}function c(e,t){o.j(e,"search_copy_link",t)}function d(e,t){o.j(e,"abandoned_search",t);const{numKeystrokes:n,timeToAbandonMs:r,numLocalResults:a,numVisibleMembers:s,isMobile:l}=t,c=s>1;i.default.logEvent("abandoned_search",n,{numKeystrokes:n,timeToAbandonMs:r,numLocalResults:a,searchSessionId:t.searchSessionId,isMultiplayer:c,isMobile:l}),o.j(e,"quick_find_reciprocal_rank",{reciprocalRank:0,searchSessionId:t.searchSessionId,numLocalResults:a,isMultiplayer:c}),i.default.logEvent("quick_find_reciprocal_rank",0,{searchSessionId:t.searchSessionId,numLocalResults:a,isMultiplayer:c,isMobile:l})}function u(e,t){o.j(e,"search_client_results",t)}function p(e,t){o.j(e,"search_post_click_page_interaction",t)}function m(e,t){var n;o.j(e,"search_post_click_page_exit",{dwellTime:(new Date).getTime()-t.timeEntered.getTime()},{forceOverrideAutomaticEventData:{queryId:null===(n=r.Z.state)||void 0===n?void 0:n.queryId}})}function f(e,t){const{currentSearchSessionId:n,currentWorkspaceId:i,newWorkspaceId:r}=t;o.j(e,"search_quick_search_switch_workspace",{current_search_session_id:n,current_workspace_id:i,new_workspace_id:r})}function g(e,t){o.j(e,"search_open_shortcut_settings_from_command_search_hint",{search_session_id:t.searchSessionId})}function h(e,t){o.j(e,"search_hover_command_search_hint",{search_session_id:t.searchSessionId})}},81918:(e,t,n)=>{n.d(t,{$B:()=>Z,BP:()=>g,Cg:()=>ae,Ci:()=>y,Dn:()=>_,Ef:()=>k,HH:()=>S,Io:()=>oe,JX:()=>E,Jk:()=>W,Jo:()=>D,KF:()=>R,KZ:()=>ee,LO:()=>B,NF:()=>T,O8:()=>se,Om:()=>ne,P0:()=>q,P1:()=>x,Rb:()=>h,S4:()=>J,Sw:()=>b,T4:()=>w,TJ:()=>Y,VM:()=>le,VT:()=>p,Vi:()=>$,Y7:()=>X,ZA:()=>G,Zm:()=>P,Zv:()=>te,_6:()=>O,_m:()=>V,aT:()=>N,am:()=>C,bw:()=>v,dw:()=>j,fN:()=>de,j7:()=>F,jk:()=>re,kj:()=>m,l0:()=>I,o8:()=>ce,pC:()=>z,pR:()=>Q,rZ:()=>A,rv:()=>L,tB:()=>ie,tX:()=>K,vC:()=>U,wV:()=>M,x8:()=>H,z0:()=>f});var o=n(79946),i=n(54642),r=n(77472),a=n(15010),s=n(77080),l=n(29677),c=n(88893),d=n(35057),u=n(88280);function p(e,t){r.oP(e,{eventName:"create_space",eventProperties:t});const n=(0,d.zt)();if("professional"===t.domain_type&&(r.j(e,"professional_workspace_created",t),o.L1({subscriptionTier:n,planType:t.planType})),"team"===t.planType&&(r.j(e,"team_workspace_created",t),o.tO({subscriptionTier:n,planType:t.planType})),o.VT({subscriptionTier:n,domainType:t.domain_type}),"team"===t.planType){const t=o.Q3(),n=o.SY();i.trackConversionEvent(e,{eventName:"create_team_space",fbp:t,clickIds:n})}}function m(e,t){r.j(e,"join_space",t)}function f(e){r.j(e,"leave_space"),W(e,{invite_origin:"workspace_leave",domainType:(0,a.JF)(),new_workspace_member_count:-1,new_workspace_member_ids:[e.currentUser.id??""]})}function g(e){r.j(e,"delete_space"),s.default.logEvent("delete_space")}function h(e,t){r.j(e,"convert_guest_to_member",t),s.default.logEvent("convert_guest_to_member",t.convert_to,{origin:t.origin})}function v(e){r.j(e,"remove_guest")}function b(e,t){s.default.logEvent("remove_member",t.member_user_id,t),W(e,{invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:t.new_workspace_member_count,new_workspace_member_ids:[t.member_user_id]}),r.j(e,"remove_member",{member_user_id:t.member_user_id,member_role:t.member_role,contraction_survey_id:t.contraction_survey_id})}function y(e){r.j(e,"managed_user_reactivate_button_clicked")}function _(e,t){r.j(e,"managed_user_support_access_toggled",t)}function S(e,t){r.j(e,"managed_users_dashboard_search",t)}function w(e,t){r.j(e,"managed_users_external_space_access_set",t)}function k(e,t){r.j(e,"managed_users_prevent_support_access_toggled",t)}function I(e,t){r.j(e,"managed_users_session_duration_modal_confirmed",t)}function x(e,t){r.j(e,"managed_user_delete_button_clicked",t)}function C(e,t){r.j(e,"managed_user_edit_modal_submitted",t)}function T(e){r.j(e,"managed_user_log_out_button_clicked")}function M(e,t){r.j(e,"managed_user_remove_from_external_workspace_button_clicked",t)}function P(e){r.j(e,"managed_user_reset_password_button_clicked")}function A(e){r.j(e,"managed_user_suspend_button_clicked")}function R(e,t){r.j(e,"managed_users_log_out_all_button_clicked",t)}function D(e,t){r.j(e,"managed_users_reset_passwords_all_button_clicked",t)}function B(e,t){r.j(e,"managed_users_session_duration_selected",t)}function E(e,t){r.j(e,"managed_user_edit_profile_modal_open",t)}function F(e,t){r.j(e,"managed_user_delete_modal_confirmed",t)}function Z(e,t){r.j(e,"managed_user_edit_modal_confirmed",t)}function V(e){r.j(e,"managed_user_log_out_modal_confirmed")}function j(e,t){r.j(e,"managed_user_remove_from_external_workspace_modal_confirmed",t)}function U(e){r.j(e,"managed_user_reset_password_modal_confirmed")}function L(e){r.j(e,"managed_user_suspend_modal_confirmed")}function O(e,t){r.j(e,"managed_users_log_out_all_modal_confirmed",t)}function N(e,t){r.j(e,"managed_users_reset_passwords_all_modal_confirmed",t)}function z(e){r.j(e,"managed_users_dashboard_button_clicked")}function W(e,t){const n=(0,d.zt)();r.j(e,"workspace_member_number_update",{new_workspace_member_count:t.new_workspace_member_count,new_workspace_member_ids:t.new_workspace_member_ids,origin:t.invite_origin,subscription_tier:n,domain_type:t.domainType,allow_domain_auto_invite:t.allow_domain_auto_invite,company_segment:(0,c.Ns)()}),s.default.logEvent("workspace_member_number_update",t.new_workspace_member_count,{origin:t.allow_domain_auto_invite?`${t.invite_origin}_allow_domain`:t.invite_origin,subscription_tier:n,domain_type:t.domainType,company_segment:(0,c.Ns)()})}function q(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_click_menu_item",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function H(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_render_menu_item",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function K(e,t){const n=(0,d.zt)(),o=(0,a.JF)(),i="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";r.j(e,"person_property_invite_click_invite_button",{subscription_tier:n,domain_type:o,invited_type:i,invited_user_count:t.invited_user_count,origin:t.origin,invite_token_query:t.inviteTokenQuery,invite_targets:t.inviteTargets,invite_flow_id:t.invite_flow_id})}function G(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_click_upgrade_button",{subscription_tier:n,domain_type:o,origin:t.origin,invited_user_count:t.invited_user_count,invite_flow_id:t.invite_flow_id})}function $(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_guest_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Q(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_member_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Y(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_member_requested",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function J(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_error",{subscription_tier:n,domain_type:o,invite_stage:t.invite_stage,invite_flow_id:t.invite_flow_id,error:t.error})}function X(e,t){const n=(0,d.zt)(),o=(0,a.JF)(),i="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";r.j(e,"person_property_invite_completed",{subscription_tier:n,domain_type:o,invited_type:i,invited_user_count:t.invited_user_count,is_success:t.is_success,origin:t.origin,invite_flow_id:t.invite_flow_id})}function ee(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_message_typed",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function te(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_dismiss_popup",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function ne(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_change_permission",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,invited_role:t.invited_role})}function oe(e,t){const n=(0,d.zt)(),o=(0,a.JF)();r.j(e,"person_property_invite_click_invite_option",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,invite_option:t.invite_option})}function ie(e,t){r.j(e,"guest_invite_request_setting_toggled",t)}function re(e,t){r.j(e,"settings_deeplink_clicked",t)}function ae(e,t){r.j(e,"guest_invite_request_resolved",t)}function se(e,t){r.j(e,"resolve_membership_request",t),s.default.logEvent("resolve_membership_request",t.status,t)}function le(e,t){r.j(e,"request_access_review_button_clicked",t),s.default.logEvent("request_access_review_button_clicked",t.status,{from:t.from,user_count:t.user_count,request_type:t.request_type})}function ce(e,t){if(r.j(e,"disable_guest_toggle",t),!0===t.new_value&&!t.keep_existing_guests_if_disabled){const t=u.subscriptionDataStoreInstance.state;if(!t)return;const n=(0,c.ND)(t).length;n>0&&de(e,{origin:"space_setting_disable_guest",changedNumber:-n})}}function de(e,t){let{inviteTargets:n,origin:o,changedNumber:i}=t;const p=(0,a.JF)(),m=(0,d.zt)();if(i)return r.j(e,"workspace_guest_number_update",{new_workspace_guest_count:i,origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}),void s.default.logEvent("workspace_guest_number_update",i,{origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()});const f=u.subscriptionDataStoreInstance.state;if(!f||!n)return;const g=c.CM(f).map((e=>e.userId)),h=n.filter((e=>!!(0,l.cl)(e)||"existingUser"===e.type&&!g.includes(e.value.id)));0!==h.length&&(r.j(e,"workspace_guest_number_update",{new_workspace_guest_count:h.length,origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}),s.default.logEvent("workspace_guest_number_update",h.length,{origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}))}},86572:(e,t,n)=>{n.d(t,{$l:()=>b,Aq:()=>L,Bg:()=>U,Dc:()=>R,EU:()=>v,FR:()=>D,LY:()=>N,Lc:()=>A,Ls:()=>G,NI:()=>me,OK:()=>ae,OX:()=>X,Og:()=>ne,PN:()=>F,Pg:()=>de,QO:()=>Y,Qr:()=>M,R3:()=>C,SM:()=>ee,TP:()=>ue,VQ:()=>Z,Wr:()=>se,YT:()=>y,Zb:()=>$,_j:()=>q,_q:()=>z,b0:()=>w,b9:()=>re,cY:()=>j,d_:()=>te,fZ:()=>E,g3:()=>Q,iL:()=>V,jh:()=>H,jw:()=>P,k1:()=>I,k6:()=>W,lj:()=>ge,lq:()=>x,n8:()=>ce,nd:()=>_,oI:()=>ie,q7:()=>S,qz:()=>B,rO:()=>h,rY:()=>O,ri:()=>be,rx:()=>J,sA:()=>pe,sS:()=>he,vw:()=>oe,wj:()=>le,wl:()=>K,xo:()=>T,y:()=>ve,y$:()=>k,z2:()=>fe});var o=n(79946),i=n(72126),r=n(4615),a=n(99405),s=n(2438),l=n(63143),c=n(47839),d=n(95477),u=n(77472),p=n(15010),m=n(77080),f=n(88893),g=n(35057);function h(e,t){u.j(e,"pricing_grid_button_click",t),m.default.logEvent("pricing_grid_button_click",void 0,t),me(e,{location:"plans_page",cta_item:t.plan,currency_code:t.currency_code,page_section:"all_plans_grid",button_text:t.button_text})}function v(e){u.j(e,"pricing_grid_contact_sales_click")}function b(e,t){u.j(e,"pricing_grid_view",t),m.default.logEvent("pricing_grid_view",void 0,t)}function y(e,t){u.j(e,"subscription_update_modal_open",t),m.default.logEvent("subscription_update_modal_open",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function _(e,t){u.j(e,"subscription_update_modal_confirmation_click",{...i.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_confirmation_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function S(e,t){u.j(e,"subscription_update_modal_exit",{...i.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function w(e,t){u.j(e,"subscription_update_modal_billing_interval_updated",t),m.default.logEvent("subscription_update_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function k(e,t){u.j(e,"subscription_update_modal_expand_billing_summary",{...i.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_expand_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function I(e,t){u.j(e,"subscription_update_modal_hide_billing_summary",{...i.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_hide_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function x(e){u.j(e,"subscription_billing_dismissed"),m.default.logEvent("subscription_billing_dismissed",void 0,{device_os:e.device.os,platform:e.device.platform})}function C(e,t){u.j(e,"subscription_billing_opened",t),m.default.logEvent("subscription_billing_opened",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function T(e){u.j(e,"subscription_plans_dismissed"),m.default.logEvent("subscription_plans_dismissed",void 0,{device_os:e.device.os,platform:e.device.platform})}function M(e,t){u.j(e,"subscription_plans_opened",t),m.default.logEvent("subscription_plans_opened",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function P(e){u.j(e,"currently_subscribed")}function A(e,t){u.j(e,"subscription_upgrade_modal_open",t),m.default.logEvent("subscription_upgrade_modal_open",void 0,t)}function R(e,t){const{event:n,modal_id:o}=t,i={...(0,l.by)(n),modal_id:o};u.j(e,"subscription_upgrade_modal_payment_element_changed",i),m.default.logEvent("subscription_upgrade_modal_payment_element_changed",void 0,{...i,device_os:e.device.os,platform:e.device.platform})}function D(e,t){u.j(e,"subscription_upgrade_modal_billing_interval_updated",t),m.default.logEvent("subscription_upgrade_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function B(e,t){u.j(e,"subscription_upgrade_modal_add_on_features_updated",t),m.default.logEvent("subscription_upgrade_modal_add_on_features_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function E(e,t){u.j(e,"subscription_upgrade_modal_upgrade_accepted",t),m.default.logEvent("subscription_upgrade_modal_upgrade_accepted",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function F(e,t){u.j(e,"subscription_upgrade_modal_upgrade_click",t),m.default.logEvent("subscription_upgrade_modal_upgrade_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Z(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_validation",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_validation",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function V(e,t){u.j(e,"subscription_upgrade_onboarding_failed_validation",t)}function j(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_payment",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function U(e){u.j(e,"subscription_upgrade_onboarding_failed_payment")}function L(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function O(e,t){u.j(e,"subscription_upgrade_modal_address_form_updated",t),m.default.logEvent("subscription_upgrade_modal_address_form_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function N(e,t){u.j(e,"subscription_upgrade_modal_exit",t),m.default.logEvent("subscription_upgrade_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function z(e,t){u.j(e,"subscription_upgrade_modal_stripe_error",t),m.default.logEvent("subscription_upgrade_modal_stripe_error",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function W(e,t){u.j(e,"create_subscription",t),m.default.logEvent("create_subscription",t.plan,t)}async function q(e,t){var n,i;const l=p.JF(),g=f.qX();u.j(e,"update_subscription_tier",{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,is_professional_team:t.isProfessionalTeamUser,domain_type:l,space_visible_members:g,is_trial:t.isTrial,is_mm_or_ent_trial:t.isMmOrEnt}),m.default.logEvent("update_subscription_tier",void 0,{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,space_visible_members:g,is_trial:t.isTrial,device_os:e.device.os,platform:e.device.platform,is_mm_or_ent_trial:t.isMmOrEnt});const h=null===(n=t.oldAddOns)||void 0===n?void 0:n.includes("ai"),v=null===(i=t.newAddOns)||void 0===i?void 0:i.includes("ai");if(!h&&v&&(u.j(e,"ai_addon_purchased",t),o.dG({eventType:"ai_addon_purchased",source:"client"})),!t.oldSubscriptionTier||!t.newSubscriptionTier)return;const{device:b}=e;if(!(0,s.nR)(t.oldSubscriptionTier)&&(0,s.nR)(t.newSubscriptionTier)&&"personal"!==t.newSubscriptionTier){const n={country:t.addressCountry,productName:t.newPriceId,price:t.creditAmount||0,spaceId:(0,r.cj)(t.spaceId),deviceType:b.isTablet?"tablet":b.isMobile?"mobile":"desktop",subscriptionTier:t.newSubscriptionTier};if("professional"===l&&u.j(e,"professional_workspace_upgraded",t),u.j(e,"workspace_upgraded",t),o.dG({eventType:"workspace_upgraded",source:"client",eventData:{...n,domainType:l}}),"professional"===l&&o.dG({eventType:"professional_workspace_upgraded",source:"client"}),"team"===t.planType&&(u.j(e,"team_workspace_upgraded",t),o.dG({eventType:"team_workspace_upgraded",source:"client"})),e.device.isElectron){const o=(0,a.fo)(d.default.domainBaseUrl,{deviceId:await u.cG(e),oldSubscriptionTier:t.oldSubscriptionTier,newSubscriptionTier:t.newSubscriptionTier,isProfessionalTeamUser:t.isProfessionalTeamUser,deviceType:e.device.deviceType,domainType:l,eventData:n});return void c.openExternalUrl(o)}}}function H(e,t){u.j(e,"subscription_update_plan",t),m.default.logEvent("subscription_update_plan",void 0,t)}function K(e,t){u.j(e,"subscription_update_billing",t),m.default.logEvent("subscription_update_billing",void 0,t)}function G(e,t){const{step:n,name:o,email:i,...r}=t;u.j(e,"enterprise_sales_contact",{...r,enterprise_name:o,enterprise_email:i}),m.default.logEvent("enterprise_sales_contact")}function $(e){u.j(e,"enterprise_sales_contact_opened")}function Q(e){u.j(e,"enterprise_sales_contact_dismissed")}function Y(e,t){u.j(e,"enterprise_sales_contact_updated",t)}function J(e,t){u.j(e,"cancel_subscription",t),m.default.logEvent("cancel_subscription",void 0,t)}function X(e,t,n){u.j(e,"churn_survey",{...t,churnType:n})}function ee(e,t,n){u.j(e,"churn_survey_close",{...t,churnType:n})}function te(e,t,n){u.j(e,"churn_survey_nudge",{...t,churnType:n})}function ne(e,t,n){u.j(e,"churn_survey_submitted",{...t,churnType:n})}function oe(e){const{environment:t,userContractionData:n}=e;u.j(t,"contraction_contextual_confirmation_cancelled",{userContractionData:n})}function ie(e){const{environment:t,userContractionData:n}=e;u.j(t,"contraction_contextual_confirmation_confirmed",{userContractionData:n})}function re(e){const{environment:t,userContractionData:n}=e;u.j(t,"contraction_contextual_confirmation_shown",{userContractionData:n})}function ae(e){const{environment:t,contractionSurveyId:n,reasons:o,reasonIndexes:i,reasonOther:r}=e;u.j(t,"contraction_survey_completed",{contraction_survey_id:n,reasons:o,reason_indexes:i,reason_other:r})}function se(e){const{environment:t,contractionSurveyId:n}=e;u.j(t,"contraction_survey_dismissed",{contractionSurveyId:n})}function le(e){const{environment:t,contractionSurveyId:n}=e;u.j(t,"contraction_survey_opened",{contractionSurveyId:n})}function ce(e,t){u.j(e,"currency_select_changed",t)}function de(e,t){u.j(e,"currency_select_dismissed",t)}function ue(e,t){u.j(e,"currency_select_opened",t)}function pe(e,t){u.j(e,"click_upgrade_button",t),m.default.logEvent("click_upgrade_button",void 0,t)}function me(e,t){u.j(e,"plan_cta_click",t),m.default.logEvent("plan_cta_click",void 0,t)}function fe(e){u.lu(e,"approaching_block_limit","approaching_block_limit",60)}function ge(e){const t=u.lu(e,"reach_block_limit","reach_block_limit",60);m.default.logEvent("reach_block_limit",1),t&&u.Zf(e,{reach_block_limit:!0,reach_block_limit_time:Date.now(),subscription_tier:g.zt()})}function he(e,t){u.j(e,"coupon_typeform_clicked",t)}function ve(e,t){u.j(e,"payment_status_banner_displayed",t)}function be(e,t){u.j(e,"payment_status_banner_action",t)}},25888:(e,t,n)=>{n.d(t,{Ar:()=>a,Fs:()=>l,LS:()=>c,Ot:()=>r,V:()=>s,wk:()=>d});var o=n(77472),i=n(77080);function r(e,t){o.j(e,"open_support_chat",t)}function a(e,t){o.j(e,"click_help",{from:t.from,qna_session_id:t.qnaSessionId}),i.default.logEvent("click_help")}function s(e,t){o.j(e,"click_help_item",t),"sales_chat"===t.item&&i.default.logEvent("click_help_item")}function l(e,t){o.j(e,"global_click_learn",t)}function c(e){o.j(e,"zendesk_metadata_open_messenger")}function d(e){o.j(e,"zendesk_metadata_signup")}},81193:(e,t,n)=>{n.d(t,{$6:()=>B,$K:()=>S,Cu:()=>M,EZ:()=>D,HU:()=>u,Hg:()=>F,Ib:()=>c,JJ:()=>R,Jw:()=>x,PE:()=>p,T2:()=>l,XQ:()=>b,Xy:()=>d,Y4:()=>A,Yn:()=>k,ZE:()=>w,bR:()=>C,dZ:()=>v,en:()=>h,gI:()=>E,jW:()=>m,me:()=>P,n1:()=>f,nn:()=>I,rN:()=>y,sY:()=>_,ye:()=>g});n(57658);var o=n(92996),i=n(4615),r=n(97880),a=n(77472),s=n(77080);function l(e){a.j(e,"browse_more_templates_click"),s.default.logEvent("browse_more_templates_click",1)}function c(e){a.j(e,"in_app_template_gallery_brand_click")}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a.j(e,"duplicate_template",{...t,is_paid:!1,is_selectable_fork_page:n}),n&&s.default.logEvent("duplicate_template_from_fork_page_multiple_spaces",t.success?"succeed":"error",{from:t.from,context:t.context})}function u(e,t){a.j(e,"duplicate_template_attempt",t)}function p(e,t){a.j(e,"configure_template_button",t)}function m(e,t){a.j(e,"template_modal_open",t),s.default.logEvent("template_modal_open",1)}function f(e,t){a.j(e,"template_modal_item_click",t),s.default.logEvent("template_modal_item_click",1)}function g(e,t){a.j(e,"template_modal_get_template_click",t),s.default.logEvent("template_modal_get_template_click",1)}function h(e,t){const{team_id:n,...o}=t;a.j(e,"template_modal_accept",o,{forceOverrideAutomaticEventData:{team_id:n}}),s.default.logEvent("template_modal_accept",1)}function v(e,t){a.j(e,"create_collection_template",t),s.default.logEvent("create_collection_template",1)}function b(e,t){a.j(e,"activate_collection_template",t),s.default.logEvent("activate_collection_template",1)}function y(e,t){a.j(e,"select_template",t)}function _(e,t){a.j(e,"collection_template_action",t)}function S(e,t){a.j(e,"click_outliner_team_new_page",t)}function w(e,t){a.j(e,"click_team_new_page_option",t)}function k(e,t){a.j(e,"show_team_duplicate_template_confirmation",t)}function I(e,t){a.j(e,"click_team_duplicate_template_confirmation_option",t)}function x(e,t){let{from:n,wiki_block_id:i,destination_team_id:r,wiki_template_id:a}=t;T(e,{from:n,preset_uri:"notion://wiki/wiki_preset",created_page_ids:[i],database_types:[o.GZ],destination_team_id:r,wiki_template_id:a})}function C(e,t){let{from:n,preset_uri:o,created_block_stores:i,destination_team_id:a}=t;const s=[],l=[];for(const r of i){var c;const e=null===(c=r.getCollectionStore())||void 0===c?void 0:c.getDatabaseType();e&&(l.push(r.id),s.push(e))}const d=i.map((e=>{var t;return null===(t=e.getFormat())||void 0===t?void 0:t.app_id})).filter(r.$K);T(e,{from:n,preset_uri:o,created_page_ids:l,database_types:s,destination_team_id:a,app_ids:[...new Set(d)]})}function T(e,t){a.j(e,"create_app_template",t)}function M(e,t){a.j(e,"delete_app_template",t)}function P(e,t){a.j(e,"create_typed_dbs_in_team_latency",t)}function A(e,t){a.j(e,"apply_preset_features",t)}function R(e,t){a.j(e,"template_duplication_v2_modal_open",{template_block_id:(0,i.F9)(t.templateBlockId),from:t.from,num_of_space_views:t.numOfSpaceViews})}function D(e,t){a.j(e,"template_duplication_v2_modal_close",{template_block_id:t.templateBlockId&&(0,i.F9)(t.templateBlockId)})}function B(e,t){a.j(e,"template_duplication_v2_account_switcher_open",{template_block_id:(0,i.F9)(t.templateBlockId),num_of_users:t.numOfUsers})}function E(e,t){a.j(e,"template_duplication_v2_switch_space",{template_block_id:(0,i.F9)(t.templateBlockId),template_destination_space_id:t.templateDestinationSpaceId&&(0,i.F9)(t.templateDestinationSpaceId),num_of_users:t.numOfUsers})}function F(e,t){a.j(e,"template_duplication_v2_fork_page",{template_block_id:(0,i.F9)(t.templateBlockId),template_destination_space_id:t.templateDestinationSpaceId&&(0,i.F9)(t.templateDestinationSpaceId),template_destination_type:t.templateDestinationType,template_destination_team_id:t.templateDestinationTeamId&&(0,i.F9)(t.templateDestinationTeamId)})}},54642:(e,t,n)=>{n.r(t),n.d(t,{activateReferral:()=>uo,addUserToWaitlist:()=>$l,addUsersToSpace:()=>dn,addWebClipperFile:()=>ht,addWebClipperURLs:()=>xo,adminAddLinkPreviewToSpace:()=>Zl,adminAddPublicEmailDomains:()=>qi,adminAddZeroRetentionSpace:()=>zt,adminAllowlistCreditDomain:()=>zo,adminBanUser:()=>La,adminBlockEmailDomain:()=>Jr,adminBulkAddEduUniversitiesAndDomains:()=>Xl,adminBulkAddPromotionCodes:()=>Or,adminBulkApplyPromotionCodes:()=>Wr,adminBulkBanUsers:()=>Oa,adminBulkCreateTimedTrials:()=>al,adminBulkRemoveSpaceGuests:()=>Nr,adminBulkUpgradeEduPlusUser:()=>Kr,adminBypassEmailReputationChecks:()=>si,adminCancelSpaceConsolidation:()=>$a,adminCancelSubscription:()=>Pi,adminChangeEmail:()=>Fi,adminCheckHIPAAComplianceStatus:()=>Wt,adminCheckStatsigSegment:()=>Lo,adminClaimAndUpgradeForSalesAssisted:()=>Ha,adminContentSearch:()=>Ds,adminCopyPageBetweenEnvironments:()=>ta,adminCountWordsInPage:()=>na,adminCreateMarketingRoute:()=>Ua,adminDelayClaimSpaceDeletion:()=>Ka,adminDeleteFileFromS3:()=>Pr,adminDeleteSpaces:()=>en,adminDeleteUser:()=>Nt,adminDescribeAccountsToReset:()=>tn,adminDescribeDeleteFileFromS3:()=>Ar,adminDescribeDeletedBlockPermissions:()=>Zr,adminDescribeEditSpacePermission:()=>$t,adminDescribeRestoreDeletedGuestPermissions:()=>Fl,adminDescribeRunSpaceConsolidation:()=>Xt,adminDescribeSpacesToDelete:()=>Jt,adminDisableReverifyForUser:()=>Yt,adminDowngradeFraudSubscription:()=>ps,adminEditBlockPermissions:()=>Ht,adminEditSpacePermissions:()=>Gt,adminEditTeamMembership:()=>an,adminExplainPaymentStatus:()=>fl,adminFindDeletedUser:()=>No,adminForceResyncExternalObjects:()=>Za,adminGetAutomationsForRecordId:()=>Jl,adminGetBulkIds:()=>gl,adminGetBulkSpaceIdsByDomain:()=>Yo,adminGetBulkSpaceIdsByEmail:()=>Jo,adminGetBulkUserIdsByEmail:()=>Xo,adminGetClientExperiments:()=>Vo,adminGetCurrentUserPermissions:()=>xr,adminGetDataAccessConsent:()=>Qo,adminGetDomainClaimEligibleSpaces:()=>Wa,adminGetDomainManagementSettings:()=>qa,adminGetIntegrationData:()=>Ra,adminGetOwnership:()=>Ir,adminGetPublicPages:()=>sa,adminGetRateLimits:()=>Cr,adminGetSamlConfig:()=>Tr,adminGetSlackIntegrationData:()=>Ba,adminGetSpaceMembershipUpdates:()=>rl,adminGetSpacesForAllowedEmailDomain:()=>Rr,adminGetStatsigExperiment:()=>jo,adminGetStatsigFeatureGate:()=>Uo,adminGetSyncedDatabaseData:()=>Ea,adminGetUserBillingInformation:()=>ai,adminGetWorkspaceWebhookSubscriptions:()=>Ql,adminIsSpaceDomainClaimEligible:()=>za,adminIsWorkspaceInQnA:()=>Wl,adminJoinSpacesForOauthRedirect:()=>Fa,adminListData:()=>qt,adminMergeUsers:()=>ql,adminModifyBlock:()=>Er,adminMonetizationTaskRunnerEnqueue:()=>Hr,adminOnboardAISlackQnA:()=>nn,adminOptOutNotionAIDataSharing:()=>ul,adminPartnerStackFixMissingProductKeys:()=>qr,adminPrimaryWorkspaceChange:()=>Mr,adminQnACheckIndexingStatus:()=>on,adminReadBlockPermissions:()=>Kt,adminRecoverMfa:()=>ii,adminRecoverUserContentInSpace:()=>Hl,adminReleaseSubscriptionSchedule:()=>el,adminRemoveAllowedEducationEmails:()=>zr,adminRemoveChildFromExternalCollection:()=>Ga,adminRemoveSpaceUsersAndTransferContent:()=>ri,adminResetAccounts:()=>rn,adminResetRateLimits:()=>Dr,adminRestoreBlock:()=>Fr,adminRestoreDeletedCollectionProperties:()=>la,adminRestoreDeletedGuestPermissions:()=>El,adminRevokeBotToken:()=>Zt,adminRunSpaceConsolidation:()=>Qa,adminSamlConfigForSpace:()=>li,adminSearchAuditLog:()=>Na,adminSearchBlocks:()=>ei,adminSearchBots:()=>Yl,adminSearchCollectionViews:()=>oi,adminSearchCollections:()=>ni,adminSearchForUsersInSpaces:()=>$o,adminSearchPermanentlyDeletedPages:()=>Xr,adminSearchSpaceActivity:()=>ea,adminSearchSpaces:()=>Go,adminSearchTeams:()=>ti,adminSearchUserAdminToolRoles:()=>Zo,adminSearchUsers:()=>Fo,adminSetDisableSpacePublicAccess:()=>Ui,adminSetPageContentClassification:()=>Qt,adminSetSpaceDomain:()=>Li,adminSetupExperiment:()=>Ci,adminShowCustomerInvoice:()=>Hi,adminSwapUserDomains:()=>Ki,adminSwapUserEmails:()=>Gi,adminUpdateAddOnSubscription:()=>Xs,adminUpdateExperiment:()=>xi,adminUpdateIntegrationData:()=>Da,adminUpdateNotionAIAvailabilityForSpace:()=>il,adminUpdatePaymentStatus:()=>hl,adminUpdateStatsigSegmentIds:()=>Oo,adminUpdateSubscription:()=>Mi,adminUpdateTeamMember:()=>sn,adminUpdateUserSettings:()=>ln,adminViewDeletedCollectionProperties:()=>ca,adminViewExperiments:()=>Ii,aiSourcePicker:()=>ua,allowEducationEmails:()=>Ai,annotateRecentIntercomConversation:()=>Br,applyCustomerOffer:()=>Ss,authCreateBackupCodes:()=>qs,authCreateSms:()=>Mt,authCreateTotp:()=>Ns,authGetLoginConfiguration:()=>yt,authSendSms:()=>At,authUpdateMfa:()=>Dt,authVerifyBackupCodesLogin:()=>Hs,authVerifyPassword:()=>Ks,authVerifySmsEnroll:()=>Pt,authVerifySmsLogin:()=>Rt,authVerifyTotpEnroll:()=>Ws,authVerifyTotpLogin:()=>zs,authWithAsana:()=>mo,authWithEvernote:()=>To,authWithExternalIntegration:()=>yo,authWithGoogleForDrive:()=>bo,authWithSlack:()=>vo,authWithTrello:()=>ho,authenticateConfluenceUser:()=>Ue,authenticateJiraUser:()=>Le,authenticateMondayUser:()=>Oe,calculateTax:()=>Gr,cancelSpaceDeletionForDomain:()=>us,cancelSubscription:()=>Fe,changeEmail:()=>Ct,checkFilePermission:()=>Kn,checkSpaceDomain:()=>$r,claimAndUpgradeSpace:()=>ss,completeMultipartUpload:()=>fs,createDomainVerificationCode:()=>Xa,createEmailUser:()=>fe,createOauthAuthorizationCode:()=>aa,createSpace:()=>ji,createTeam:()=>Sa,deleteBlocks:()=>gn,deleteBot:()=>Qr,deleteDomainVerificationCode:()=>Ya,deleteGroup:()=>Cn,deleteIntegration:()=>Yr,deleteManagedUser:()=>mi,deleteSpace:()=>jt,deleteSpaceForDomain:()=>ds,deleteTemplate:()=>Il,deleteUser:()=>Ut,disableUserAnalytics:()=>no,disconnectAsana:()=>St,disconnectConfluence:()=>qe,disconnectDrive:()=>It,disconnectEvernote:()=>kt,disconnectMonday:()=>He,disconnectTrello:()=>wt,duplicateBlock:()=>te,enableTeams:()=>Ot,enqueueScanContentTask:()=>tc,enqueueTask:()=>lt,exportAdminContentSearch:()=>eo,exportAuditLog:()=>Qn,exportBlock:()=>st,exportBlockPreview:()=>Do,exportContentAnalytics:()=>Xn,exportDomainClaimableSpaces:()=>Yn,exportSpace:()=>$n,exportSpaceGuests:()=>Ol,exportSpaceMembers:()=>Ll,exportUserAnalytics:()=>Jn,finalizeAppTemplate:()=>Eo,findUser:()=>oe,getAIUsageEligibility:()=>tl,getAboutNotionDevelopers:()=>Vs,getAccessRequests:()=>Ji,getActiveExportTasks:()=>ml,getActiveImportTasks:()=>ne,getActivityLog:()=>xt,getAdminHistory:()=>wr,getAllTeamsInSpaceForAdmin:()=>xa,getAsanaAccount:()=>$,getAsanaWorkspaces:()=>G,getAsanaWorkspacesNames:()=>J,getAssetsJson:()=>q,getAssetsJsonV2:()=>H,getAssetsJsonV3:()=>K,getAssistantLibraryCode:()=>Ae,getAssistantLogs:()=>Pe,getAuthorizedEmailPreferenceCenterLink:()=>er,getAvailableCountries:()=>vr,getBacklinksForBlock:()=>Bt,getBillingHistory:()=>Gn,getBlockAdminApiLog:()=>Sr,getBlockFileDownloadUrl:()=>ue,getBookmarks:()=>fn,getBotToken:()=>Et,getBots:()=>io,getChatTranscriptSessionHistoryForUser:()=>Te,getClientExperiments:()=>wi,getClientExperimentsV2:()=>ki,getCollectionViewBlocksByAppId:()=>hs,getCompletion:()=>go,getCompletionForProperty:()=>nl,getCompletionForSelectOption:()=>ol,getConfluenceAccount:()=>We,getConfluenceSpaces:()=>ze,getConnectedAppsStatus:()=>fo,getContentEngagementAnalytics:()=>Cs,getCostForSpaceUpgrade:()=>as,getCsatMilestones:()=>rr,getCustomerOffer:()=>ys,getCustomerOfferEligibility:()=>_s,getDailyUsersAnalytics:()=>Is,getDataAccessConsent:()=>or,getDataAccessConsentForManagedUser:()=>hi,getDesktopAppRegistration:()=>Ls,getDesktopDownloadUrl:()=>Ee,getDeveloperBotsAndIntegrations:()=>jr,getDomainVerificationCodesForSpace:()=>es,getEmailDomainSettings:()=>yi,getEmailDomainsForSpace:()=>di,getEmailsWithoutAccessToBlock:()=>fa,getEvernoteAccount:()=>Q,getEvernoteNotebooks:()=>ko,getExternalCollectionSyncState:()=>ma,getExternalIntegrationAccessToken:()=>ws,getExternalIntegrations:()=>oa,getExternalNotificationChannels:()=>Rs,getExternalOrgData:()=>Gl,getGenericEmbedBlockData:()=>Bi,getGeoIpLocation:()=>sl,getGiphyRandomId:()=>Ho,getGoogleDriveAccounts:()=>_o,getHarmonicData:()=>ke,getHistoricalAuditLogUsers:()=>ce,getIdFromUniqueId:()=>Qs,getInAppCategoriesAndTemplates:()=>Js,getInferenceTestExamples:()=>Es,getIntegrationDataForGallery:()=>Ma,getIntegrationDomainVerifications:()=>Ur,getIntegrationIdsForGallery:()=>Pa,getIntegrationSecret:()=>Lr,getInvoiceData:()=>cn,getJoinableSpaces:()=>pn,getLivestormEvents:()=>De,getLivestormSessions:()=>Be,getLoginOptions:()=>bt,getManagedUsers:()=>ui,getMondayFoldersAndBoards:()=>Ge,getMondayUser:()=>Ne,getMondayWorkspaces:()=>Ke,getNextRelabelingTask:()=>Me,getNotificationLog:()=>Pn,getNotificationLogV2:()=>An,getPageAnalytics:()=>bs,getPageAssistantPreferences:()=>Dl,getPageVisitors:()=>sr,getPrivatePageInfo:()=>Ca,getPromoCode:()=>Di,getPublicApiObject:()=>Os,getPublicPageData:()=>Lt,getPublicSpaceData:()=>Nn,getPublishedPagesForUser:()=>zl,getQnaOnboardingData:()=>Ve,getRecentPageVisits:()=>me,getRecoverableSpaceUserContent:()=>Va,getSamlConfigForSpace:()=>ci,getSamlRedirect:()=>_t,getSelectPropertyValues:()=>Tn,getSignedFileUrl:()=>cc,getSkillsInSpace:()=>Ce,getSnapshotContents:()=>lo,getSnapshotsList:()=>so,getSpaceAdminApiLog:()=>_r,getSpaceMembershipUpdates:()=>Tl,getSpaces:()=>mn,getSpacesCreatedByUserWithDomains:()=>is,getSpacesInOrganization:()=>ec,getSprintBoardViewBlocks:()=>vs,getSubitems:()=>W,getSubscriptionData:()=>Ze,getTasks:()=>Qi,getTeamAccessRequestMetadata:()=>ll,getTeams:()=>Ia,getTeamsAndProjectsInAsanaWorkspace:()=>X,getTemplateChecklistForBlock:()=>ar,getTemplateContentGroup:()=>ve,getTemplateCreator:()=>yl,getTemplateDrafts:()=>xl,getTemplateSearchResults:()=>vl,getTemplates:()=>bl,getTestFlightStatus:()=>Yi,getTransitivePageRelations:()=>pl,getTrelloAccount:()=>Y,getTrelloBoards:()=>ee,getTypedDatabases:()=>gs,getUniversitiesAndDomains:()=>Ul,getUnreadAccessRequestCount:()=>Xi,getUnvisitedNotificationIds:()=>Rn,getUploadFileUrl:()=>Vt,getUserAdminApiLog:()=>yr,getUserAnalyticsSettings:()=>vn,getUserContractionData:()=>Ml,getUserEngagementAnalytics:()=>xs,getUserHomePages:()=>hr,getUserNotifications:()=>Zn,getUserSharedPagesInSpace:()=>fr,getUserSignals:()=>gr,getUserSpaceExternalBots:()=>ra,getUserTasks:()=>$i,getVerifiedEmailDomain:()=>As,getVisibleUsers:()=>je,getWebClipperData:()=>Io,getWebhookSubscriptions:()=>ro,getZendeskTicketConversation:()=>ia,handleRecordMapForResponse:()=>F,identifySegmentUser:()=>En,identifySegmentWorkspace:()=>Bn,importAsana:()=>et,importAsanaIntoBetterTemplate:()=>tt,importConfluenceExport:()=>Qe,importEvernote:()=>at,importFile:()=>$e,importJiraProjectsIntoTeamspace:()=>nt,importTrello:()=>Xe,initializeGoogleDriveBlock:()=>So,initializePageTemplate:()=>Bo,initializeUserAnalytics:()=>Wn,initializeUserAnalyticsEmptySync:()=>qn,initiateMultipartUpload:()=>ms,initiateWorkspaceTransfer:()=>rs,invalidateSubscriptionData:()=>br,inviteGuestsToSpace:()=>zi,isEligibleForGuestMembershipRequest:()=>Fs,isEmailEducation:()=>Ri,isRecordKeyAvailable:()=>$s,isUserDomainJoinable:()=>Ei,leaveBlock:()=>On,listExternalCollections:()=>ya,listExternalObjects:()=>_a,listPrices:()=>ye,loadBlockSubtree:()=>zn,loadCachedPageChunk:()=>_n,loadCachedPageChunkBatched:()=>oc,loadCachedPageChunks:()=>Sn,loadContacts:()=>js,loadContentAnalytics:()=>Ms,loadPageChunk:()=>wn,loadSearchAnalytics:()=>Ps,loadUserContent:()=>yn,loadWorkspaceAnalyticsUsers:()=>Ts,loginWithAppleAuth:()=>ct,loginWithAppleNativeAuth:()=>dt,loginWithEmail:()=>ut,loginWithGoogleAuth:()=>mt,loginWithGoogleJwt:()=>pt,logout:()=>ft,logoutActiveSessions:()=>Vi,logoutManagedUsers:()=>_i,markDiscussionNotificationsRead:()=>Ta,moveToSpace:()=>Ni,parallelAsanaImport:()=>it,parallelImportConfluenceExport:()=>Ye,parallelImportConfluenceViaApi:()=>Je,parallelJiraImport:()=>ot,parallelMondayImport:()=>rt,pendingTaskEventsById:()=>dc,pendingTaskIds:()=>N,performAiSearch:()=>xe,ping:()=>Po,postGiphyAnalytics:()=>Ko,previewMidtermSubscriptionChanges:()=>_e,processShareActionToBlock:()=>ga,publishAiSession:()=>Nl,queryCollection:()=>kn,queryCollectionStream:()=>In,recordCookieConsent:()=>Aa,recordPageExit:()=>cr,recordPageVisit:()=>lr,recoverSpace:()=>Ao,recoverUser:()=>Mo,refetchExternalObjectInstanceBlocks:()=>ba,refreshGoogleDriveBlock:()=>wo,refreshInviteLink:()=>Wi,registerDesktopApp:()=>Us,releaseSubscriptionSchedule:()=>be,removeManagedUserFromSpace:()=>bi,removeUsersFromSpace:()=>un,renameGroup:()=>xn,reportBadQnA:()=>le,reportBadSearch:()=>se,reportPage:()=>kr,requestAccess:()=>tr,requestClaimAndUpgrade:()=>ls,resetExperimentOverrides:()=>va,resetPasswordsForManagedUsers:()=>Si,resolveAccessRequest:()=>Kl,resolveAddress:()=>Vr,restoreBlock:()=>hn,restoreSnapshot:()=>co,resubscribeExternalCollection:()=>pa,revokeBotToken:()=>Ft,revokeUserTokens:()=>Ro,saveAssistantFeedback:()=>Ie,saveRelabelingTaskFeedback:()=>Re,saveTransactions:()=>Oi,search:()=>ie,searchAuditLog:()=>re,searchContacts:()=>ae,searchGiphyImages:()=>qo,searchIntegrations:()=>de,searchUnsplashImages:()=>Wo,searchVectors:()=>Bs,searchWebClipperPages:()=>Co,sendEmailVerification:()=>Tt,sendTemporaryPassword:()=>vt,sendVerifyTransferEmail:()=>ks,setAdminPrivilegedTeamMembership:()=>wa,setBookmarkMetadata:()=>po,setDataAccessConsent:()=>ir,setDataAccessConsentForManagedUser:()=>vi,setLocale:()=>pe,setNotificationsAsRead:()=>Fn,setNotificationsStatus:()=>jn,setPageAssistantPreferences:()=>Bl,setPageNotificationsAsRead:()=>Vn,setPassword:()=>Zi,setRecordKey:()=>Gs,setSamlConfig:()=>os,setSeenGuestMembershipRequests:()=>Zs,setSpaceNotificationsAsRead:()=>Un,setStatusPropertyDefaults:()=>Mn,spaceAdminRestoreAccess:()=>dr,stripeAdvanceTestClock:()=>cl,stripeGetTestClock:()=>dl,submitContactSales:()=>Se,submitCsatFeedback:()=>nr,submitEducationGroupApplication:()=>jl,submitFormstack:()=>we,submitTemplate:()=>_l,submitTemplateCreator:()=>Sl,suggestRecordKey:()=>Ys,syncRecordValue:()=>rc,syncRecordValues:()=>bn,testCreatePage:()=>Al,testDeleteRecord:()=>Rl,testSetupWorkspace:()=>Pl,testWebhookConnection:()=>ao,trackConversionEvent:()=>ur,trackSegmentEvent:()=>Dn,transferPermissionGroup:()=>to,transferSpaceUserContent:()=>ja,transferWorkspaceToUser:()=>cs,unfurlUrl:()=>da,unsubscribeFromEmails:()=>Ln,unsubscribeFromIntercomEmails:()=>oo,updateDisableGuestsOnSpace:()=>Vl,updateEmailDomainSettings:()=>fi,updateExperimentOverride:()=>ha,updatePaymentMethod:()=>he,updatePinnedTemplates:()=>Cl,updatePublicHomePage:()=>mr,updateSpaceDomain:()=>pr,updateSubscription:()=>ge,updateSubscriptionToEducationPlan:()=>Ti,updateTeamMembers:()=>ka,updateUserProfile:()=>gi,updateUserSuspension:()=>pi,updateWorkspaceCreationForEmailDomains:()=>ts,validateTemplate:()=>wl,validateTemplateCreatorHandle:()=>kl,validateUserCanCreateWorkspace:()=>ns,verifyDomain:()=>Ja,verifyEmail:()=>gt});n(57658);var o=n(39593),i=n.n(o),r=n(28084),a=n(54064),s=n(43593),l=n(68626),c=n(59730),d=n(74229),u=n(72126),p=n(59753),m=n(45953),f=n(606),g=n(89101),h=n(32739),v=n(63143),b=n(95477),y=n(23823),_=n(33954),S=n(24608),w=n(33929),k=n(18514),I=n(80444),x=n(88632),C=n(79167),T=n(77144),M=n(33759),P=n(50906),A=n(47307),R=n(97977),D=n(4408),B=n(8055),E=n(12170);function F(e){const{environment:t,eventName:n,response:o,userId:i}=e;if(o&&o.recordMap){const e=m.PF.create(o.recordMap);"syncRecordValues"!==n&&D.fL({environment:t,userId:i,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,recordMap:e,maybeStaleRecordMap:"loadCachedPageChunk"===n||"loadCachedPageChunks"===n,debugSource:"handleRecordMapForResponse"})}}let Z;async function V(e,t,n,o){if((0,c.tn)(n.body)){A.showError(n);const t=n.body.clientData&&(0,_.cq)(n.body.clientData);P.$eA(e,{type:null==t?void 0:t.type})}if(n.offline)return n;console.error(n.error);const{RouterStore:i}=e;if(401===n.status&&l.log({level:"error",from:"api",type:"httpTrigger401",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},routeName:i.state.route.name}}),403===n.status&&n.headers["content-type"]&&n.headers["content-type"].startsWith("text/html")&&l.logWithSampleRate({logMessage:{level:"error",from:"api",type:"httpTrigger403",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},userId:e.currentUser.id,routeName:i.state.route.name}},samplePercentage:1}),401===n.status&&Boolean(n.body&&n.body.errorId)&&e.currentUser.isLoggedIn())switch(i.state.route.name){case"page":if((0,k.Sr)()){await R.actuallyLogoutAndDeleteAllLocalData({environment:e,nextLocation:window.location.pathname});break}case"root":case"space":case"onboarding":case"myIntegrations":case"inAppTemplateSubmission":case"inAppTemplateCreatorSubmission":case"creatorProfile":case"creatorProfileAnalytics":case"creatorProfileTemplates":case"studentGroupSignup":if(o&&o===e.currentUser.id){const t=u.Ds((async()=>await R.actuallyLogoutAndDeleteAllLocalData({environment:e,userId:o,doNotRedirect:!0})),1e3);await t();!function(e,t){if((0,c.Jx)(t.body)&&"saml_sso_required"===t.body.clientData.type){const e=(0,_.wf)(w.default.getIntl(),t);M.Z.setState({...M.Z.state,loginType:"saml",alert:e})}B.c4({environment:e,url:g._j.login})}(await R.clearCurrentUser(e),n)}}return n}async function j(e){const{environment:t,eventName:n,data:o,userId:i,tracking:r,abortSignal:a,prefetchCacheKey:s,encoding:c}=e;!function(e){for(const t of Object.keys(e)){const n=e[t];(u.Ft(n)||u.o8(n))&&delete e[t]}}(o);const d=i||t.currentUser.id,p=(0,y.yX)({environment:t,eventName:n,data:o,activeUserId:d,tracking:r,abortSignal:a,encoding:c});let m;s&&t.prefetchCache&&(m=t.prefetchCache.getPrefetchedHttpRequest(s,p,a)),m||(m=(0,S.ZP)(p)),T.Z.incrementNumApiCallsInitiated();const f=await m;return T.Z.incrementNumApiCallsCompleted(),"success"===f.type?(F({environment:t,eventName:n,response:f.data,userId:d}),function(e){const{environment:t,responseUserId:n,eventName:o}=e;if(!n)return;if("saveTransactions"!==o)return;const{id:i}=t.currentUser;if(n!==i){if(Z===n)return;const{currentUserStore:e,currentUserRootStore:t,currentUserSettingsStore:r,currentSpaceViewStore:a}=I.default.state,s=i||"<undefined>",c=`currentUser ${s} didn't match user's cookie ${n}`;l.log({from:"client/api",level:"error",type:"currentUserWrong",data:{eventName:o,miscDataToConvertToString:{responseUserId:n,connectionStoreState:x.Z.state,currentUserId:s,userStoreId:e&&e.id,userRootStoreId:t&&t.id,userSettingsStoreId:r&&r.id,currentSpaceViewStoreParentId:a&&a.getParentId()},message:c}}),Z=n}else Z=void 0}({environment:t,eventName:n,responseUserId:f.headers["X-Notion-User-Id"]}),f):V(t,n,f,d)}function U(e){return function(t,n,o,i,r,a,s){return j({environment:t,eventName:e,data:n,userId:o,tracking:i,abortSignal:r,prefetchCacheKey:a,encoding:s})}}function L(e){return async function(t,n,o,i){const r=o||t.currentUser.id,a=(0,y.tZ)({environment:t,eventName:e,data:n,activeUserId:r,tracking:i,abortSignal:void 0,format:"jsonStream"}),s=await(0,S.ZP)(a);return"failed"===s.type?V(t,e,s,r):(d.H1.is(s.data)?s.data=d.H1.filter(s.data,(e=>"recordValue"!==e.type||(function(e){const{environment:t,streamItem:n,userId:o}=e,{pointer:i,value:r,role:a}=n;D.Wl({environment:t,userId:o,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:i,model:p.kk.fromValue(i.table,r),role:a,updatePaths:[[]],maybeStaleRecordMap:!1,debugSource:"handleRecordStreamForResponse"})}({environment:t,streamItem:e,userId:r}),!1))):F({environment:t,eventName:e,response:s.data,userId:r}),s)}}const O=async function(e){return new Promise(((t,n)=>{dc.addOnceListener(e,(e=>{t(e)}))}))},N=new Set,z=function(e){return async function*(t,n){const o={task:{eventName:e,request:n}},i=await lt(t,o);if("failed"===i.type)yield{error:i.error,taskStatus:"not_started"};else{const{taskId:o}=i.data;for(N.add(o);;){const i=await O(o);if("success"===i.state){const n=i.status;F({environment:t,eventName:e,response:n}),yield{value:n,taskStatus:i.state};break}if("failure"===i.state){yield{error:new c.hm(i.error||"Something went wrong.",{eventName:e,request:n},i.clientData),taskStatus:i.state};break}"in_progress"===i.state&&i.status&&(yield{value:i.status,taskStatus:i.state})}}}},W=U("getSubitems"),q=U("getAssetsJson"),H=U("getAssetsJsonV2"),K=U("getAssetsJsonV3"),G=U("getAsanaWorkspaces"),$=U("getAsanaAccount"),Q=U("getEvernoteAccount"),Y=U("getTrelloAccount"),J=U("getAsanaWorkspacesNames"),X=U("getTeamsAndProjectsInAsanaWorkspace"),ee=U("getTrelloBoards"),te=z("duplicateBlock"),ne=U("getActiveImportTasks"),oe=U("findUser"),ie=U("search"),re=U("searchAuditLog"),ae=U("searchContacts"),se=U("reportBadSearch"),le=U("reportBadQnA"),ce=U("getHistoricalAuditLogUsers"),de=U("searchIntegrations"),ue=U("getBlockFileDownloadUrl"),pe=U("setlocale"),me=U("getRecentPageVisits"),fe=U("createEmailUser"),ge=U("updateSubscription"),he=U("updatePaymentMethod"),ve=U("getTemplateContentGroup"),be=U("releaseSubscriptionSchedule"),ye=U("listPrices"),_e=U("previewMidtermSubscriptionChanges"),Se=U("submitContactSales"),we=U("submitFormstack"),ke=U("getHarmonicData"),Ie=U("saveAssistantFeedback"),xe=U("performAiSearch"),Ce=U("getSkillsInSpace"),Te=U("getChatTranscriptSessionHistoryForUser"),Me=U("getNextRelabelingTask"),Pe=U("getAssistantLogs"),Ae=U("getAssistantLibraryCode"),Re=U("saveRelabelingTaskFeedback"),De=U("getLivestormEvents"),Be=U("getLivestormSessions"),Ee=U("getDesktopDownloadUrl"),Fe=U("cancelSubscription"),Ze=U("getSubscriptionData"),Ve=U("getQnaOnboardingData"),je=U("getVisibleUsers"),Ue=U("authenticateConfluenceUser"),Le=U("authenticateJiraUser"),Oe=U("authenticateMondayUser"),Ne=U("getMondayUser"),ze=U("getConfluenceSpaces"),We=U("getConfluenceAccount"),qe=U("disconnectConfluence"),He=U("disconnectMonday"),Ke=U("getMondayWorkspaces"),Ge=U("getMondayFoldersAndBoards"),$e=z("importFile"),Qe=z("importConfluenceExport"),Ye=z("parallelImportConfluenceExport"),Je=z("parallelImportConfluenceViaApi"),Xe=z("importTrello"),et=z("importAsana"),tt=z("importAsanaIntoBetterTemplate"),nt=z("importJiraProjectsIntoTeamspace"),ot=z("parallelJiraImport"),it=z("parallelAsanaImport"),rt=z("parallelMondayImport"),at=z("importEvernote"),st=z("exportBlock"),lt=U("enqueueTask"),ct=U("loginWithAppleAuth"),dt=U("loginWithAppleNativeAuth"),ut=U("loginWithEmail"),pt=U("loginWithGoogleJwt"),mt=U("loginWithGoogleAuth"),ft=U("logout"),gt=U("verifyEmail"),ht=U("addWebClipperFile"),vt=U("sendTemporaryPassword"),bt=U("getLoginOptions"),yt=U("authGetLoginConfiguration"),_t=U("getSamlRedirect"),St=U("disconnectAsana"),wt=U("disconnectTrello"),kt=U("disconnectEvernote"),It=U("disconnectDrive"),xt=U("getActivityLog"),Ct=U("changeEmail"),Tt=U("sendEmailVerification"),Mt=U("authCreateSms"),Pt=U("authVerifySmsEnroll"),At=U("authSendSms"),Rt=U("authVerifySmsLogin"),Dt=U("authUpdateMfa"),Bt=U("getBacklinksForBlock"),Et=U("getBotToken"),Ft=U("revokeBotToken"),Zt=U("adminRevokeBotToken"),Vt=U("getUploadFileUrl"),jt=z("deleteSpace"),Ut=U("deleteUser"),Lt=U("getPublicPageData"),Ot=U("enableTeams"),Nt=U("adminDeleteUser"),zt=U("adminAddZeroRetentionSpace"),Wt=U("adminCheckHIPAAComplianceStatus"),qt=U("adminListData"),Ht=U("adminEditBlockPermissions"),Kt=U("adminReadBlockPermissions"),Gt=U("adminEditSpacePermissions"),$t=U("adminDescribeEditSpacePermission"),Qt=U("adminSetPageContentClassification"),Yt=U("adminDisableReverifyForUser"),Jt=U("adminDescribeSpacesToDelete"),Xt=U("adminDescribeRunSpaceConsolidation"),en=U("adminDeleteSpaces"),tn=U("adminDescribeAccountsToReset"),nn=U("adminOnboardAISlackQnA"),on=U("adminQnACheckIndexingStatus"),rn=U("adminResetAccounts"),an=U("adminEditTeamMembership"),sn=U("adminUpdateTeamMember"),ln=U("adminUpdateUserSettings"),cn=U("getInvoiceData"),dn=U("addUsersToSpace"),un=U("removeUsersFromSpace"),pn=U("getJoinableSpaces"),mn=U("getSpaces"),fn=U("getBookmarks"),gn=U("deleteBlocks"),hn=U("restoreBlock"),vn=U("getUserAnalyticsSettings"),bn=U("syncRecordValues"),yn=U("loadUserContent"),_n=U("loadCachedPageChunk"),Sn=U("loadCachedPageChunks"),wn=U("loadPageChunk"),kn=U("queryCollection"),In=L("queryCollection"),xn=z("renameGroup"),Cn=z("deleteGroup"),Tn=U("getSelectPropertyValues"),Mn=U("setStatusPropertyDefaults"),Pn=U("getNotificationLog"),An=U("getNotificationLogV2"),Rn=U("getUnvisitedNotificationIds"),Dn=U("trackSegmentEvent"),Bn=U("identifySegmentWorkspace"),En=U("identifySegmentUser"),Fn=U("setNotificationsAsRead"),Zn=U("getUserNotifications"),Vn=U("setPageNotificationsAsRead"),jn=U("setNotificationsStatus"),Un=U("setSpaceNotificationsAsRead"),Ln=U("unsubscribeFromEmails"),On=U("leaveBlock"),Nn=U("getPublicSpaceData"),zn=U("loadBlockSubtree"),Wn=U("initializeUserAnalytics"),qn=U("initializeUserAnalyticsEmptySync"),Hn=U("getSignedFileUrls"),Kn=U("checkFilePermission"),Gn=U("getBillingHistory"),$n=z("exportSpace"),Qn=z("exportAuditLog"),Yn=z("exportDomainClaimableSpaces"),Jn=z("exportUserAnalytics"),Xn=z("exportContentAnalytics"),eo=z("exportAdminContentSearch"),to=U("transferPermissionGroup"),no=U("disableUserAnalytics"),oo=U("unsubscribeFromIntercomEmails"),io=U("getBots"),ro=U("getWebhookSubscriptions"),ao=U("testWebhookConnection"),so=U("getSnapshotsList"),lo=U("getSnapshotContents"),co=z("restoreSnapshot"),uo=U("activateReferral"),po=U("setBookmarkMetadata"),mo=U("authWithAsana"),fo=U("getConnectedAppsStatus"),go=L("getCompletion"),ho=U("authWithTrello"),vo=U("authWithSlack"),bo=U("authWithGoogleForDrive"),yo=U("authWithExternalIntegration"),_o=U("getGoogleDriveAccounts"),So=U("initializeGoogleDriveBlock"),wo=U("refreshGoogleDriveBlock"),ko=U("getEvernoteNotebooks"),Io=U("getWebClipperData"),xo=U("addWebClipperURLs"),Co=U("searchWebClipperPages"),To=U("authWithEvernote"),Mo=U("recoverUser"),Po=U("ping"),Ao=U("recoverSpace"),Ro=U("revokeUserTokens"),Do=U("exportBlockPreview"),Bo=U("initializePageTemplate"),Eo=U("finalizeAppTemplate"),Fo=U("adminSearchUsers"),Zo=U("adminSearchUserAdminToolRoles"),Vo=U("adminGetClientExperiments"),jo=U("adminGetStatsigExperiment"),Uo=U("adminGetStatsigFeatureGate"),Lo=U("adminCheckStatsigSegment"),Oo=U("adminUpdateStatsigSegmentIds"),No=U("adminFindDeletedUser"),zo=U("adminAllowlistCreditDomain"),Wo=U("searchUnsplashImages"),qo=U("searchGiphyImages"),Ho=U("getGiphyRandomId"),Ko=U("postGiphyAnalytics"),Go=U("adminSearchSpaces"),$o=U("adminSearchForUsersInSpaces"),Qo=U("adminGetDataAccessConsent"),Yo=U("adminGetBulkSpaceIdsByDomain"),Jo=U("adminGetBulkSpaceIdsByEmail"),Xo=U("adminGetBulkUserIdsByEmail"),ei=U("adminSearchBlocks"),ti=U("adminSearchTeams"),ni=U("adminSearchCollections"),oi=U("adminSearchCollectionViews"),ii=U("adminRecoverMfa"),ri=U("adminRemoveSpaceUsersAndTransferContent"),ai=U("adminGetUserBillingInformation"),si=U("adminBypassEmailReputationChecks"),li=U("adminSamlConfigForSpace"),ci=U("getSamlConfigForSpace"),di=U("getEmailDomainsForSpace"),ui=U("getManagedUsers"),pi=U("updateUserSuspension"),mi=U("deleteManagedUser"),fi=U("updateEmailDomainSettings"),gi=U("updateUserProfile"),hi=U("getDataAccessConsentForManagedUser"),vi=U("setDataAccessConsentForManagedUser"),bi=U("removeManagedUserFromSpace"),yi=U("getEmailDomainSettings"),_i=U("logoutManagedUsers"),Si=U("resetPasswordsForManagedUsers"),wi=U("getClientExperiments"),ki=U("getClientExperimentsV2"),Ii=U("adminViewExperiments"),xi=U("adminUpdateExperiment"),Ci=U("adminSetupExperiment"),Ti=U("updateSubscriptionToEducationPlan"),Mi=U("adminUpdateSubscription"),Pi=U("adminCancelSubscription"),Ai=U("allowEducationEmails"),Ri=U("isEmailEducation"),Di=U("getPromoCode"),Bi=U("getGenericEmbedBlockData"),Ei=U("isUserDomainJoinable"),Fi=U("adminChangeEmail"),Zi=U("setPassword"),Vi=U("logoutActiveSessions"),ji=U("createSpace"),Ui=U("adminSetDisableSpacePublicAccess"),Li=U("adminSetSpaceDomain"),Oi=U("saveTransactions"),Ni=z("moveToSpace"),zi=U("inviteGuestsToSpace"),Wi=U("refreshInviteLink"),qi=U("adminAddPublicEmailDomains"),Hi=U("adminShowCustomerInvoice"),Ki=U("adminSwapUserDomains"),Gi=U("adminSwapUserEmails"),$i=U("getUserTasks"),Qi=U("getTasks"),Yi=U("getTestFlightStatus"),Ji=U("getAccessRequests"),Xi=U("getUnreadAccessRequestCount"),er=U("getAuthorizedEmailPreferenceCenterLink"),tr=U("requestAccess"),nr=U("submitCsatFeedback"),or=U("getDataAccessConsent"),ir=U("setDataAccessConsent"),rr=U("getCsatMilestones"),ar=U("getTemplateChecklistForBlock"),sr=U("getPageVisitors"),lr=U("recordPageVisit"),cr=U("recordPageExit"),dr=U("spaceAdminRestoreAccess"),ur=U("trackConversionEvent"),pr=U("updateSpaceDomain"),mr=U("updatePublicHomePage"),fr=U("getUserSharedPagesInSpace"),gr=U("getUserSignals"),hr=U("getUserHomePages"),vr=U("getAvailableCountries"),br=U("invalidateSubscriptionData"),yr=U("getUserAdminApiLog"),_r=U("getSpaceAdminApiLog"),Sr=U("getBlockAdminApiLog"),wr=U("getAdminHistory"),kr=U("reportPage"),Ir=U("adminGetOwnership"),xr=U("adminGetCurrentUserPermissions"),Cr=U("adminGetRateLimits"),Tr=U("adminGetSamlConfig"),Mr=U("adminPrimaryWorkspaceChange"),Pr=U("adminDeleteFileFromS3"),Ar=U("adminDescribeDeleteFileFromS3"),Rr=U("adminGetSpacesForAllowedEmailDomain"),Dr=U("adminResetRateLimits"),Br=U("annotateRecentIntercomConversation"),Er=U("adminModifyBlock"),Fr=U("adminRestoreBlock"),Zr=U("adminDescribeDeletedBlockPermissions"),Vr=U("resolveAddress"),jr=U("getDeveloperBotsAndIntegrations"),Ur=U("getIntegrationDomainVerifications"),Lr=U("getIntegrationSecret"),Or=U("adminBulkAddPromotionCodes"),Nr=U("adminBulkRemoveSpaceGuests"),zr=U("adminRemoveAllowedEducationEmails"),Wr=U("adminBulkApplyPromotionCodes"),qr=U("adminPartnerStackFixMissingProductKeys"),Hr=U("adminMonetizationTaskRunnerEnqueue"),Kr=U("adminBulkUpgradeEduPlusUser"),Gr=U("calculateTax"),$r=U("checkSpaceDomain"),Qr=U("deleteBot"),Yr=U("deleteIntegration"),Jr=U("adminBlockEmailDomain"),Xr=U("adminSearchPermanentlyDeletedPages"),ea=U("adminSearchSpaceActivity"),ta=U("adminCopyPageBetweenEnvironments"),na=U("adminCountWordsInPage"),oa=U("getExternalIntegrations"),ia=U("getZendeskTicketConversation"),ra=U("getUserSpaceExternalBots"),aa=U("createOauthAuthorizationCode"),sa=U("adminGetPublicPages"),la=U("adminRestoreDeletedCollectionProperties"),ca=U("adminViewDeletedCollectionProperties"),da=U("unfurlUrl"),ua=U("aiSourcePicker"),pa=U("resubscribeExternalCollection"),ma=U("getExternalCollectionSyncState"),fa=U("getEmailsWithoutAccessToBlock"),ga=U("processShareActionToBlock"),ha=U("updateExperimentOverride"),va=U("resetExperimentOverrides"),ba=U("refetchExternalObjectInstanceBlocks"),ya=U("listExternalCollections"),_a=U("listExternalObjects"),Sa=U("createTeam"),wa=U("setAdminPrivilegedTeamMembership"),ka=U("updateTeamMembers"),Ia=U("getTeams"),xa=U("getAllTeamsInSpaceForAdmin"),Ca=U("getPrivatePageInfo"),Ta=U("markDiscussionNotificationsRead"),Ma=U("getIntegrationDataForGallery"),Pa=U("getIntegrationIdsForGallery"),Aa=U("recordCookieConsent"),Ra=U("adminGetIntegrationData"),Da=U("adminUpdateIntegrationData"),Ba=U("adminGetSlackIntegrationData"),Ea=U("adminGetSyncedDatabaseData"),Fa=U("adminJoinSpacesForOauthRedirect"),Za=U("adminForceResyncExternalObjects"),Va=U("getRecoverableSpaceUserContent"),ja=U("transferSpaceUserContent"),Ua=U("adminCreateMarketingRoute"),La=U("adminBanUser"),Oa=U("adminBulkBanUsers"),Na=U("adminSearchAuditLog"),za=U("adminIsSpaceDomainClaimEligible"),Wa=U("adminGetDomainClaimEligibleSpaces"),qa=U("adminGetDomainManagementSettings"),Ha=U("adminClaimAndUpgradeForSalesAssisted"),Ka=U("adminDelayClaimSpaceDeletion"),Ga=U("adminRemoveChildFromExternalCollection"),$a=U("adminCancelSpaceConsolidation"),Qa=U("adminRunSpaceConsolidation"),Ya=U("deleteDomainVerificationCode"),Ja=U("verifyDomain"),Xa=U("createDomainVerificationCode"),es=U("getDomainVerificationCodesForSpace"),ts=U("updateWorkspaceCreationForEmailDomains"),ns=U("validateUserCanCreateWorkspace"),os=U("setSamlConfig"),is=U("getSpacesCreatedByUserWithDomains"),rs=U("initiateWorkspaceTransfer"),as=U("getCostForSpaceUpgrade"),ss=U("claimAndUpgradeSpace"),ls=U("requestClaimAndUpgrade"),cs=U("transferWorkspaceToUser"),ds=U("deleteSpaceForDomain"),us=U("cancelSpaceDeletionForDomain"),ps=U("adminDowngradeFraudSubscription"),ms=U("initiateMultipartUpload"),fs=U("completeMultipartUpload"),gs=U("getTypedDatabases"),hs=U("getCollectionViewBlocksByAppId"),vs=U("getSprintBoardViewBlocks"),bs=U("getPageAnalytics"),ys=U("getCustomerOffer"),_s=U("getCustomerOfferEligibility"),Ss=U("applyCustomerOffer"),ws=U("getExternalIntegrationAccessToken"),ks=U("sendVerifyTransferEmail"),Is=U("getDailyUsersAnalytics"),xs=U("getUserEngagementAnalytics"),Cs=U("getContentEngagementAnalytics"),Ts=U("loadWorkspaceAnalyticsUsers"),Ms=U("loadContentAnalytics"),Ps=U("loadSearchAnalytics"),As=U("getVerifiedEmailDomain"),Rs=U("getExternalNotificationChannels"),Ds=U("adminContentSearch"),Bs=U("searchVectors"),Es=U("getInferenceTestExamples"),Fs=U("isEligibleForGuestMembershipRequest"),Zs=U("setSeenGuestMembershipRequests"),Vs=U("getAboutNotionDevelopers"),js=U("loadContacts"),Us=U("registerDesktopApp"),Ls=U("getDesktopAppRegistration"),Os=U("getPublicApiObject"),Ns=U("authCreateTotp"),zs=U("authVerifyTotpLogin"),Ws=U("authVerifyTotpEnroll"),qs=U("authCreateBackupCodes"),Hs=U("authVerifyBackupCodesLogin"),Ks=U("authVerifyPassword"),Gs=U("setRecordKey"),$s=U("isRecordKeyAvailable"),Qs=U("getIdFromUniqueId"),Ys=U("suggestRecordKey"),Js=U("getInAppCategoriesAndTemplates"),Xs=U("adminUpdateAddOnSubscription"),el=U("adminReleaseSubscriptionSchedule"),tl=U("getAIUsageEligibility"),nl=L("getCompletionForProperty"),ol=U("getCompletionForSelectOption"),il=U("adminUpdateNotionAIAvailabilityForSpace"),rl=U("adminGetSpaceMembershipUpdates"),al=U("adminBulkCreateTimedTrials"),sl=U("getGeoIpLocation"),ll=U("getTeamAccessRequestMetadata"),cl=U("stripeAdvanceTestClock"),dl=U("stripeGetTestClock"),ul=U("adminOptOutNotionAIDataSharing"),pl=U("getTransitivePageRelations"),ml=U("getActiveExportTasks"),fl=U("adminExplainPaymentStatus"),gl=U("adminGetBulkIds"),hl=U("adminUpdatePaymentStatus"),vl=U("getTemplateSearchResults"),bl=U("getTemplates"),yl=U("getTemplateCreator"),_l=U("submitTemplate"),Sl=U("submitTemplateCreator"),wl=U("validateTemplate"),kl=U("validateTemplateCreatorHandle"),Il=U("deleteTemplate"),xl=U("getTemplateDrafts"),Cl=U("updatePinnedTemplates"),Tl=U("getSpaceMembershipUpdates"),Ml=U("getUserContractionData"),Pl=U("testSetupWorkspace"),Al=U("testCreatePage"),Rl=U("testDeleteRecord"),Dl=U("getPageAssistantPreferences"),Bl=U("setPageAssistantPreferences"),El=U("adminRestoreDeletedGuestPermissions"),Fl=U("adminDescribeRestoreDeletedGuestPermissions"),Zl=U("adminAddLinkPreviewToSpace"),Vl=U("updateDisableGuestsOnSpace"),jl=U("submitEducationGroupApplication"),Ul=U("getUniversitiesAndDomains"),Ll=U("exportSpaceMembers"),Ol=U("exportSpaceGuests"),Nl=U("publishAiSession"),zl=U("getPublishedPagesForUser"),Wl=U("adminIsWorkspaceInQnA"),ql=U("adminMergeUsers"),Hl=U("adminRecoverUserContentInSpace"),Kl=U("resolveAccessRequest"),Gl=U("getExternalOrgData"),$l=U("addUserToWaitlist"),Ql=U("adminGetWorkspaceWebhookSubscriptions"),Yl=U("adminSearchBots"),Jl=U("adminGetAutomationsForRecordId"),Xl=U("adminBulkAddEduUniversitiesAndDomains"),ec=U("getSpacesInOrganization"),tc=U("enqueueScanContentTask"),nc=new r.Z({performRequests:async e=>{const{environment:t}=e[0],n=e.map((e=>e.args)),o=await Sn(t,{requests:n});if("failed"===o.type)throw o.error;return[]},batchSize:50,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:10*v.C0});async function oc(e,t){return await nc.enqueue({environment:e,args:t})}const ic=new r.Z({performRequests:async e=>{const t=new Array(e.length),n=e.map(((e,t)=>({environment:e.environment,request:e.args,index:t}))),o=u.vM(n,(e=>e.request.userId));for(const[i,r]of Object.entries(o)){const e=r[0].environment,n=[];for(const{request:t}of r){const{pointer:e,version:o}=t;n.push({pointer:e,version:o})}const o=await bn(e,{requests:n},i);if("failed"===o.type)throw o.error;const a=m.PF.create(o.data.recordMap);C.Z.addFromRecordMapWithRole(a),C.Z.isEmpty()||E.dY({environment:e});for(const{request:i,index:s}of r)if(i.pointer){const e=a.getValue(i.pointer),n=a.getRole(i.pointer);n&&(t[s]={value:e,role:n})}}return t},batchSize:500,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:30*v.C0});async function rc(e,t){if(t.pointer&&(0,f.Ok)(t.pointer))try{const n=await ic.enqueue({environment:e,args:t});return n||-1!==t.version?n:{value:void 0,role:"editor"}}catch(n){}}const ac=e=>[e.url,e.downloadName,e.download].filter(Boolean).join(":");const sc=new class{constructor(){this.lru=new(i())({max:1e3,maxAge:v.U6})}set(e,t){this.lru.set(ac(e),t)}get(e){return this.lru.get(ac(e))}},lc=new r.Z({performRequests:async e=>{const t=e.map((e=>{let{url:t}=e;return t})),n=await Hn(e[0].environment,{urls:t});if("failed"===n.type)throw n.error;const{signedUrls:o}=n.data;return t.forEach(((e,t)=>{const n=o[t];sc.set(e,n)})),o},batchSize:500,maxWorkers:1});async function cc(e,t,n){const o=sc.get(t);let i;return i=o||await lc.enqueue({environment:e,url:t}),i&&(0,s.x$)(i)&&n&&(i=(0,h.NV)({httpUrl:i,protocol:b.default.protocol,includePort:!0})),i}const dc=new a.Z},90287:(e,t,n)=>{n.d(t,{Bs:()=>ce,KJ:()=>pe,Uz:()=>de,_S:()=>ue,mc:()=>le,qY:()=>he});var o=n(50112),i=n(15145),r=n(82813),a=n(7406),s=n(68626),l=n(4615),c=n(99405),d=n(21202),u=n(13493),p=n(65311),m=n(19889),f=n(66079),g=n(28182),h=n(9852),v=n(54153),b=n(64002),y=n(63143),_=n(25320),S=n(17707),w=n(77472),k=n(19124),I=n(84210),x=n(98165),C=n(18514),T=n(51),M=n(80444),P=n(81258),A=n(69327),R=n(64970),D=n(93220),B=n(72014),E=n(89523),F=n(26136),Z=n(32470),V=n(87956),j=n(29026),U=n(34583),L=n(28517),O=n(32441),N=n(98688),z=n(50950),W=n(47307),q=n(57400),H=n(94273),K=n(97977),G=n(98958),$=n(17659),Q=n(31304),Y=n(40277),J=n(32953),X=n(8055),ee=n(87531),te=n(29974),ne=n(82530),oe=n(12170),ie=n(70782),re=n(12321),ae=n(37181),se=n(65452);function le(e){M.default.setState(M.default.getInitialState());const{id:t}=e.currentUser;(!M.default.state.currentUserStore||t&&t!==M.default.state.currentUserStore.id)&&(t?(re.j(e,t),H.Bk(e,t),pe(e,t)):(M.default.setState({...M.default.state,initialized:!0}),z.dd(e)))}function ce(){const{currentSpaceStore:e}=M.default.getState();return e?e.id:void 0}async function de(e){const{nextRoute:t,currentRoute:n,environment:m,query:f}=e,g=M.default.state.mainEditorCurrentBlockStore,v=M.default.state.currentCollectionViewStore,y=m.currentUser.id,x=e=>{M.default.state.lastUpdater===x&&(m.device.isMobileNative&&e.currentSpaceStore&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"AppStore setting space with update in updateCurrentRoute: ",spaceId:e.currentSpaceStore.id}}),M.default.setState({...M.default.state,...e}))};M.default.setState({...M.default.state,lastUpdater:x});const C=e=>{M.default.state.lastUpdater===x&&T.Z.setState({publicPageData:e})};if("page"===t.name&&t.queryId&&V.Z.setState({queryId:t.queryId,pageId:t.blockId,timeEntered:new Date}),"page"===t.name||"space"===t.name||"nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name||"workspaceSetup"===t.name){let e;H.nr(t,y);const u=async()=>{e||(e=Y.I6({environment:m,request:{type:"block-space",...t}}));const[n]=await Promise.all([e.next(),M.default.waitUntil((()=>M.default.state.initialized))]),o=n.value;return C(o),o},v=(0,h.getAppRefreshed)();if((0,k.AC)(m),"page"===t.name&&(!g||g.id!==t.blockId||n&&"page"===n.name&&n.blockId!==t.blockId||g.userId!==y)){J.Pg(m),J.LU(m),U.$B(),J.rM(m);const{blockId:e}=t,a=new F.G(m,{table:d.iU,id:e}),c=new D.Z;x({mainEditorCurrentBlockStore:a,currentLoadingContainerStore:c}),g||await ue({environment:m,store:a});const h=await u(),{currentUserSettingsStore:k}=M.default.state;if(ge({publicPageData:h}))return void function(e){const{store:t,environment:n}=e,o=(0,I.ZP)({store:t,preferPublicLink:!1,pageVisitSource:void 0});X.c4({environment:n,url:o})}({store:a,environment:m});const{presenceStore:C,currentUserRootStore:T}=M.default.state;Q.E(C,m,B.$g,g),_.UX(m,{block:a,fromPageRefresh:v,pageVisitStore:M.default.state.pageVisitStore,timestamp:Date.now()}),S.Y0(a.id);const P=new E.Z;x({presenceStore:P});const R=B.$g.getCurrentPageVisitId();if(B.$g.initializeNewPageVisitId(),Q._({userId:y,rootStore:a,presenceStore:P,environment:m,pageVisitIdStore:B.$g}),T){if("root"===(null==n?void 0:n.name)){if(T.getSpaceViewStores().map((e=>e.getSpaceId())).indexOf(h.spaceId)<0){if(k)return m.device.isMobileNative&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{message:"SpaceDebug: navigateToFirstSpace because updateCurrentRoute is root and page is not in current spaceView"}}),void(await te.L5({environment:m,userRootStore:T,userSettingsStore:k,pageVisitSource:i.tY.BackForward}));if(y)return void(await K.logoutSingleAccount({environment:m,userId:y}))}}if(h.spaceId&&(h.canJoinSpace||h.userHasExplicitAccess)){const e=await te.j({environment:m,userRootStore:T,spaceId:h.spaceId,navigate:!1,analyticsFrom:"redirect",userSettingsStore:k});m.device.isMobileNative&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because the route is a page with spaceId",spaceId:h.spaceId}}),x({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}else if(!h.spaceId&&M.default.state.currentSpaceStore){const e=await te.j({environment:m,userRootStore:T,spaceId:M.default.state.currentSpaceStore.id,navigate:!1,analyticsFrom:"redirect",userSettingsStore:k});var O;if(m.device.isMobileNative)s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because of joinSpaceResult of current space",spaceId:null===(O=e.spaceViewStore)||void 0===O?void 0:O.getSpaceId()}});x({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}}h.spaceId&&y&&(se.h({environment:m,spaceId:h.spaceId,userId:y}),L.I({environment:m,spaceId:h.spaceId,userId:y}));const{currentSpaceStore:Z}=M.default.state;Z?(U.OR({environment:m,spaceId:Z.id}).then((async()=>{await a.load(),fe(m,a,f,B.$g,R)})),w.Jq(m)):h&&h.spaceId&&(await a.load(),fe(m,a,f,B.$g,R)),async function(e,t,n){const a=(0,b.Qc)(t).query,s=a[o.gS];if(parseInt(a[i.$X])===i.tY.Email&&(s.includes("email_digest")||s.includes("email_push"))&&a[i.Qs]&&n){const t=(0,l.wr)(a[i.Qs]),o=F.Xo.createChildStore(n,{table:p.uX,id:t});await o.load();const s=o.getModel();if(!s)return;if((0,r.e)((0,w.mc)(e),{alreadyRead:s.getRead(),notificationId:t,activityId:s.getActivityId(),from:"email"}),!s.getRead()){const t={id:s.id,space_id:s.getSpaceId(),read:s.getRead()};ne.createAndCommit({userAction:"appActions.setNotificationAsReadFromEmail",environment:e,perform:e=>$.$h({notification:t,rootStore:n,transaction:e,read:!0})})}}}(m,f,Z);const V=(null==Z?void 0:Z.id)||h.spaceId;V&&(oe.pt({environment:m,spaceId:V,force:!1}),N.L({environment:m,spaceId:V,force:!1})),V&&y&&(A.Z.isInitialized||A.Z.reinitializeState(m,y,V))}else if("space"===t.name){const e=await u();if(e.publicHomePage){const t=new F.G(m,{table:d.iU,id:e.publicHomePage}),n=new D.Z;x({mainEditorCurrentBlockStore:t,currentLoadingContainerStore:n})}else if(x({mainEditorCurrentBlockStore:void 0,currentLoadingContainerStore:void 0}),ge({publicPageData:e}))return void he({spaceDomain:e.spaceDomain,environment:m})}else if("nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name){J.Pg(m),J.LU(m),U.$B(),J.rM(m),await M.default.waitUntil((()=>M.default.state.initialized));const e="spaceId"in t?t.spaceId:void 0;if((!M.default.state.currentSpaceViewStore||!M.default.state.currentSpaceStore||e&&M.default.state.currentSpaceStore.id!==e)&&M.default.state.currentUserRootStore){const n=M.default.state.currentUserRootStore.getSpaceViewStores(),o=e?n.find((t=>{var n;return(null===(n=t.getSpaceId())||void 0===n?void 0:n.replaceAll("-",""))===(null==e?void 0:e.replaceAll("-",""))})):n[0],i=null==o?void 0:o.getSpaceStore();if(o&&i){var z,G;if(m.device.isMobileNative)s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:`updateCurrentRoute updating space because it's native tab and current space store id (${null===(z=M.default.state.currentSpaceStore)||void 0===z?void 0:z.id}, spaceView: ${null===(G=M.default.state.currentSpaceViewStore)||void 0===G?void 0:G.id}) doesn't match nextRoute space id`,spaceId:e}});x({currentSpaceStore:i,currentSpaceViewStore:o});const n="nativeTab"===t.name&&"search"===t.tab&&y&&!1,r="quickSearch"===t.name&&y;(n||r)&&A.Z.reinitializeState(m,y,i.id)}}"chat"===t.name&&x({mainEditorCurrentBlockStore:void 0,currentCollectionViewStore:void 0})}else if((0,c.wO)(t)&&(J.Pg(m),J.LU(m),U.$B(),J.rM(m),await M.default.waitUntil((()=>M.default.state.initialized)),t.spaceId&&M.default.state.currentUserRootStore)){const e=M.default.state.currentUserRootStore.getSpaceViewStores().find((e=>e.getSpaceId()===t.spaceId)),n=null==e?void 0:e.getSpaceStore();e&&n&&(m.device.isMobileNative&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because routeWithoutSpecificBlock and current nextRoute space id is",spaceId:t.spaceId}}),x({currentSpaceStore:n,currentSpaceViewStore:e,mainEditorCurrentBlockStore:void 0}))}if("searchQuery"in t||"searchRequest"in t)if(t.searchQuery)ee.UT({environment:m,analyticsFrom:"query-args",renderAsPage:!1}),j.ZP.setState({...j.ZP.state,query:{...j.ZP.state.query,text:t.searchQuery}});else if(t.searchRequest)try{const e=JSON.parse(t.searchRequest),{text:n,sort:o,filters:i}=e;f&&j.ZP.setState({...j.ZP.state,query:{text:n,sort:o,filters:i}}),Z.ZP.setState({...Z.ZP.state,showDebugInfo:!0,debug:"everything"})}catch(ae){W.deprecatedShowErrorMessage("Invalid json in searchRequest param"),s.log({level:"error",from:"appActions",type:"JSONParseError",error:{miscDataString:(0,a.tg)(ae).message}})}if(e)for await(const t of e)C(t);q.Yh(m),(0,h.setAppRefreshed)(!1)}const ie=v?v.id:void 0;if("page"===t.name&&ie!==t.collectionViewId){const e=t.collectionViewId;x({currentCollectionViewStore:e?new F.Xr(m,{table:u.n,id:e}):void 0})}const re=(0,b.Qc)(f).query[i.RL];Boolean(re)&&(R.m.setState(!0),P.Z.setState({open:!0}))}async function ue(e){const{environment:t,store:n}=e,o=await async function(e){const{environment:t,blockId:n}=e,{currentUser:o}=t,i=(0,y.jj)([...o.id?[o.id]:[],...o.loggedInUserIds]);for(const r of i){const e=new F.G(t,{table:d.iU,id:n},{userId:r});if(await e.load(),e.isDefined())return o.id===r?void 0:r}}({environment:t,blockId:n.id});o&&await ie.f({newCurrentUserId:o,environment:t,store:n})}async function pe(e,t){const n=new F.U6(e,{table:m.KJ,id:t},{userId:t}),o=new F.vO(e,{table:g.Sr,id:t},{userId:t});o.addListener(me);const i=new F.r9(e,{table:f.dx,id:t},{userId:t});G.registerPushNotifications(e),M.default.setState({...M.default.state,currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:i,initialized:!1}),await re.w(),M.default.setState({...M.default.state,initialized:!0}),ae.fG(e),z.oG(e)}function me(e){const t=e.getSettingsStore().getKeyStore("preferred_locale").getValue();t||v.Z.set("preferredLocale",t)}function fe(e,t,n,o,i){var r,a;O.PB(e,{query:n,page_id:t.id,is_peek:!1,peek_mode:void 0,type:"collection"===t.getParentTable()?"database_page":"page",collection_id:t.getParentCollectionId()??(null===(r=t.getCollectionViewCollectionStore())||void 0===r?void 0:r.id),team_id:null===(a=(0,x.VP)(t))||void 0===a?void 0:a.id,page_visit_id:o.getCurrentPageVisitId(),previous_page_visit_id:i})}function ge(e){const{publicPageData:t}=e;return!(!(0,C.Sr)()||"none"!==t.publicAccessRole||!t.spaceName)}function he(e){const{spaceDomain:t,environment:n}=e,o=(0,C.Rs)(t);X.c4({environment:n,url:o,redirect:!0})}},2449:(e,t,n)=>{n.d(t,{D$:()=>g,M0:()=>p,W$:()=>v,ac:()=>h,cM:()=>m,hC:()=>u,uG:()=>b});n(21703);var o=n(68626),i=n(9852),r=n(54153),a=n(63143),s=n(11342),l=n(95477),c=n(53730),d=n(47839);function u(e){var t;const{environment:n,url:r,version:a}=e,{AppUpdateStore:s,device:l}=n;l.isElectron&&r.startsWith("https:")?o.log({level:"error",from:"appUpdateActions",type:"installAppJsUpdate",error:{message:"Attempting to refresh app js on desktop for an https url",stack:(new Error).stack},data:{url:r}}):(s.setState({electronUpdate:s.state.electronUpdate,appUpdate:void 0}),a&&g(a),p(a)||(n.mobileNative&&n.mobileNative.showSplashscreen(),(0,i.setAppRefreshed)(!0),null!==(t=d.electronApi)&&void 0!==t&&t.installAppJsUpdate?d.electronApi.installAppJsUpdate(r):r!==window.location.href?window.location.href=r:window.location.reload()))}function p(e){return(0,s.isEqualVersion)(e,b())}function m(e,t){if(!t)return!1;if("ready"!==t.state)return!1;if(c.transactionQueue.hasTasks())return!1;if(!e.currentUser.isLoggedIn())return!1;if(t.type===s.UpdateType.Silent){if(e.device.isMobileNative)return!1;const t=v(),n=168;if(t&&(Date.now()-t)/a.U6<n)return!1;o.log({level:"info",from:"appUpdateActions",type:"shouldUpdateOnNavigate",data:{lastKnownUpdateTime:t}})}return!0}const f="lastKnownAppJsVersion";function g(e){r.Z.set(f,{version:e,time:Date.now()})}function h(){const e=r.Z.get(f);if(e&&e.version)return e.version;{const e=(0,s.parseVersion)(l.default.version);return r.Z.set(f,{version:e,time:Date.now()}),e}}function v(){const e=r.Z.get(f);if(e&&e.time)return e.time}function b(){return(0,s.parseVersion)(l.default.version)}},35253:(e,t,n)=>{n.d(t,{Bw:()=>r,Js:()=>s,qL:()=>a});var o=n(97880),i=n(22294);const r=e=>{const{id:t,styleKey:n,contentKey:r,removeTimeout:s,bannerStore:l,blockStore:c,context:d,disabled:u}=e,{banners:p}=l.state;if(!p.find((e=>e.id===t))){let m;switch(r){case"template_in_page":case"template_in_button":m={id:t,contentKey:r,styleKey:n,blockStore:c,context:d,disabled:u};break;case"space_content_duplication":case"deleted_or_moved_page":case"importing_evernote":case"asana_importer_banner":case"site":m={id:t,contentKey:r,styleKey:n,blockStore:c};break;case"over_free_block_limit":case"editing_page":case"subscription_trial_add_payment_method":case"upload_limit_exceeded":case"admin_mode":case"subscription_payment_status":case"minor_app_update":case"mobile_platform_unsupported":case"page_in_archived_team":case"crdt_page":case"test_clock":m={id:t,contentKey:r,styleKey:n};break;default:(0,o.t1)(r)}const f=e.prepend?[m,...p]:[...p,m];l.setState({banners:f}),i.Z.setKeyboardMode(!1),s&&setTimeout((()=>{a({bannerStore:l,id:t})}),s)}},a=e=>{const{id:t,bannerStore:n}=e,{banners:o}=n.state,i=o.filter((e=>e.id!==t));i.length!==o.length&&n.setState({banners:i})},s=e=>{e.bannerStore.state.banners.length>0&&e.bannerStore.setState({banners:[]})}},54564:(e,t,n)=>{n.d(t,{Ib:()=>w,LZ:()=>k,Xv:()=>I});var o=n(1302),i=n(72126),r=n(29477),a=n(33709),s=n(23867),l=n(17707),c=n(34047),d=n(65598),u=n(58202),p=n(46351),m=n(74948),f=n(24646),g=n(36391),h=n(24229),v=n(26136),b=n(85344),y=n(24677),_=n(98104);function S(e,t){const n=p.Z.find((e=>e.getStore().id===t));n&&(y.ZH(e),_.NX({store:n.getInputStore().state.textStore}))}async function w(e){var t;const{environment:n,blockStore:p,analyticsFrom:w,discussionIds:k,shouldFocusDiscussion:I,recursivelyLoadAllDiscussions:x}=e,C=(null==k?void 0:k.map((e=>v.t1.createChildStore(p,{table:a.qF,id:e,spaceId:(0,s.C)(p.pointer.spaceId)}))))||d.al(p,{recursivelyLoadAllDiscussions:x});let{rect:T}=e;const{resolved:M,unresolved:P}=d.bB(C),A=(0,c.uC)(P.length>0?P:M)||[],R=null==A||null===(t=A[0])||void 0===t?void 0:t.id,{device:D}=n;D.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),D.isIOS&&_.sD()),l.AM(A.map((e=>e.id))),await o.default.afterNextFlush();const B=(0,f.Sx)(n);if(p.isNavigableBlock()){if(R){"PageDetailsStore"in n&&n.PageDetailsStore.setToggleState({type:"discussion",id:p.id,environment:n},!0);const e=v.t1.createChildStore(p,{table:a.qF,id:R,spaceId:(0,s.C)(p.pointer.spaceId)});if((B||!B&&I)&&l.T4(R),e.getResolved())if((0,f.Sx)(n))m.setUpdateSidebarCommentsMode(g.F7.Resolved);else{const e=u.R.findBlockFromStoreWithMethod(p,"openResolvedDiscussionPopup");e&&(e.openResolvedDiscussionPopup(),await o.default.afterNextFlush(),l.T4(R))}b.ZW(n,{from:w,discussion_id:e.id})}if(!B)return}if(!T&&!B&&"margin_comments"!==w){const e=u.R.getRect(p);if(!e)return;const t=e.width,n=e.height,o=e.right-t;T=new DOMRect(o,e.top,t,n)}let E=h.u.Open;if(R){const e=v.t1.createChildStore(p,{table:a.qF,id:R,spaceId:(0,s.C)(p.pointer.spaceId)});e.getResolved()&&(E=h.u.Resolved),e.getResolved()||(m.setUpdateSidebarCommentsMode(g.F7.Unresolved),m.setUpdateSidebarTab(g.gY.Comments))}else E=h.u.Resolved;if(D.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),D.isIOS&&_.sD()),h.Z.setState({open:!0,rect:T,tab:E,blockStore:p,discussionIds:C.map((e=>e.id)),recursivelyLoadAllDiscussions:x}),b.ZW(n,{from:w,discussion_id:R}),I)if(R){if(await r.Vs(10),await o.default.afterNextFlush(),l.T4(R),n.device.isMobile)return;(function(e){var t;const{blockStore:n,discussionIds:o}=e;return h.Z.state.open&&h.Z.state.blockStore.id===n.id&&i.Xy(null===(t=h.Z.state)||void 0===t?void 0:t.discussionIds,o)})(e)||S(n,R)}else{if(n.device.isMobile)return;P.length>0&&(await r.Vs(10),await o.default.afterNextFlush(),S(n,P[0].id))}}function k(){const e=h.Z.state;e.open&&h.Z.setState({open:!1,rect:e.rect})}function I(){const e=h.Z.state;if(e.open&&e.tab===h.u.Open){0===d.vV(e.blockStore,{recursivelyLoadAllDiscussions:!1}).length&&k()}}},6404:(e,t,n)=>{n.d(t,{$Z:()=>d,Qn:()=>c,xv:()=>u});var o=n(95802),i=n(8949),r=n(17903),a=n(83212),s=n(50628),l=n(50906);function c(e){const{environment:t,left:n,top:o,actionSectionGroupKey:s,showInput:c,stores:d,analyticsFrom:u,optionalAnalyticsProperties:p,pageAnnotationToken:m}=e,f=new DOMRect(n,o,1,1);i.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:s,stores:d,frameScrollTop:r.Z.state.scrollTop,originBlockRect:f,showInput:c,analyticsFrom:u,publicEditMode:d[0]?a.Z.getMode(t,d[0]):void 0,collectionContextStore:null==p?void 0:p.collectionContextStore,clickedPageAnnotation:m}),l.EDS(t,{from:u,block_type:d[0]&&d[0].getType(),optionalAnalyticsProperties:p})}const d=function(e){const{environment:t,analyticsFrom:n,actionSectionGroupKey:c,stores:d,showInput:u}=e,p=o.C.findSelectableFromStore(d[0]);if(!p)return;const m=s.Z.state.selectableRectMap.get(p);m&&i.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:c,stores:d,frameScrollTop:r.Z.state.scrollTop,originBlockRect:m,showInput:void 0===u||u,analyticsFrom:n,publicEditMode:d[0]?a.Z.getMode(t,d[0]):void 0}),t&&l.EDS(t,{from:n,block_type:d[0]&&d[0].getType()})},u=function(){i.Z.setState({isActive:!1})}},79554:(e,t,n)=>{n.d(t,{Dq:()=>A,H8:()=>R,RH:()=>T,_x:()=>I,kE:()=>k,ry:()=>D,wK:()=>M,xv:()=>x});n(21703);var o=n(15145),i=n(41432),r=n(1800),a=n(72126),s=n(606),l=n(21202),c=n(70203),d=n(97880),u=n(95477),p=n(28020),m=n(95802),f=n(61207),g=n(26136),h=n(52229),v=n(19785),b=n(9953),y=n(42858),_=n(24677),S=n(993),w=n(82530);function k(e){const{blocks:t,copiedStores:n,pageSource:o}=e,i=a.Z$(t);if(!i)return;const r=m.C.getRectFromStore(i);r&&f.Z.setState({open:!0,type:"blocks",blocks:t,rect:r,copiedStores:n,pageSource:o})}function I(e){const{blocks:t,copiedLinks:n,rootStore:o}=e;if(!t.every(C))return!1;if(n.some((e=>e.blockId===o.id)))return!1;const i=a.Z$(t);if(!i)return!1;const r=m.C.getRectFromStore(i);return!!r&&(f.Z.setState({open:!0,type:"links",blocks:t,rect:r,copiedLinks:n}),!0)}function x(){f.Z.setState({open:!1})}function C(e){return!(e.isType(i.Ti.copyIndicator)||e.isTransclusionType()||e.isInsideCollection())}function T(e){const{blocks:t,pageSource:n,wasContiguousSelection:o,action:r,rootStore:a,copiedStores:l}=e;return"copy"===r&&o&&!(0,s.qo)(n,a.pointer)&&(M(e)||R({currentSpaceId:a.getSpaceId(),...e}))&&t.every(C)&&!l.every((e=>e.getType()===i.Ti.externalObjectInstance))}function M(e){const{blocks:t}=e;return 1===t.length}function P(e){const{transaction:t,blockUrl:n,spaceId:o,useCrdt:r,environment:a}=e,s=b.j4({environment:a,type:i.Ti.text,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:o,useCrdt:r}),l=[(0,c.V3y)(n,[(0,c.edl)(n)])];return S.sO({environment:a,store:s.getBlockTitleStore(),value:l,transaction:t}),s}async function A(e){const{environment:t,blocks:n,source:i}=e,s=a.Ps(n);if(!s)return;const c=s.getParentBlockStore();if(!c)return;const p=s.getContentStore();let m;await w.createAndCommitAsync({environment:t,userAction:"blockPasteMenuActions.acceptLinkToPage",waitForServerCommit:!0,perform:async e=>{if("blocks"===i.type){const{copiedStores:n,pageSource:a}=i,d=s,f=n[0];if(!d||!f)return;const v=g.G.createChildStore(p,{table:l.iU,id:f.id});if(v.isNavigableBlock())await v.load(),m=[h.k({environment:t,parentBlock:c,targetStore:v,transaction:e})];else{const n=(0,r.Z)({pageId:a.id,scrollToBlockId:v.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage});m=[P({blockUrl:n,spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})]}}else if("links"===i.type){const{copiedLinks:a}=i;if(a.length!==n.length)return;m=await Promise.all(a.map((async n=>{const i=n.scrollToBlockId||n.peekViewBlockId||n.blockId,a=g.G.createChildStore(p,{table:l.iU,id:i});if(await a.load(),a.isNavigableBlock())return h.k({environment:t,parentBlock:c,targetStore:a,transaction:e});{const i=n.peekViewBlockId||n.blockId,c=g.G.createChildStore(p,{table:l.iU,id:i});await c.load();return P({blockUrl:(0,r.Z)({pageId:i,pageModel:c.getModel(),scrollToBlockId:a.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage}),spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})}})))}else(0,d.t1)(i);const a=y.is({environment:t,blocks:m,selection:n,replaceEmptyTextBlock:!0,transaction:e});y.Cl({environment:t,blocks:n,transaction:e}),_.Z5({environment:t,stores:a}),x()}})}function R(e){const{currentSpaceId:t,blocks:n,copiedStores:o}=e;return n.length>0&&!o.some((e=>e.isInsideCollection()))&&o.every((e=>e.canEdit()))&&o.every((e=>e.getSpaceId()===t))}async function D(e){const{environment:t,blocks:n,copiedBlockIds:o}=e,r=await Promise.all(o.map((async e=>{const t=g.G.createChildStore(n[0],{table:l.iU,id:e});await t.load();const o=t.getParentBlockStore();if(!o)throw new Error("Block has no parent.");await o.load();const i=o.getContentStore();return{store:g.G.createChildStore(i,{table:l.iU,id:e}),parentStore:o,parentContentStore:i}}))),a=r[0];if(!a)return;const{serverCommitResult:s}=w.createAndCommit({userAction:"blockPasteMenuActions.acceptCreateTransclusion",environment:t,perform:e=>{var o,s;let l;if(a.store.getType()===i.Ti.transclusionContainer)l=a.store;else if(a.store.getType()===i.Ti.transclusionReference){const e=a.store.getTransclusionReferenceTargetStore();if(!e)throw new Error("Could not find target");l=e}else if(a.parentStore.getType()===i.Ti.transclusionContainer)l=a.parentStore;else{l=b.j4({environment:t,type:i.Ti.transclusionContainer,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:a.store.pointer.spaceId,useCrdt:a.store.useCrdt()});const n=l.getContentStore();v.rS({parentStore:a.parentContentStore,oldChildStore:a.store,newChildStore:l,transaction:e});for(const{store:t}of r)v.jG({parentStore:n,childStore:t,transaction:e})}const c=b.j4({environment:t,type:i.Ti.transclusionReference,format:{transclusion_reference_pointer:l.pointer},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:0!==n.length?n[n.length-1].pointer.spaceId:null===(o=(0,p.RM)())||void 0===o?void 0:o.pointer.spaceId,useCrdt:0!==n.length?n[n.length-1].useCrdt():(null===(s=(0,p.RM)())||void 0===s?void 0:s.useCrdt())??!1}),d=y.is({environment:t,blocks:[c],selection:n,transaction:e,replaceEmptyTextBlock:!0});y.Cl({environment:t,blocks:n,transaction:e}),_.Z5({environment:t,stores:d}),x()}});await s}},51365:(e,t,n)=>{n.d(t,{$o:()=>b,RX:()=>y,bA:()=>g,fG:()=>w,gT:()=>_,i2:()=>S,mm:()=>k,vO:()=>v,xv:()=>h});var o=n(73935),i=n(1302),r=n(99036),a=n(80951),s=n(70203),l=n(58299),c=n(9953),d=n(61045),u=n(24677),p=n(993),m=n(98104),f=n(82530);function g(e){const{environment:t,blockPropertyValueOverlayStore:n,store:a,additionalStores:c=[],property:g,format:h,preventClearSelection:v,insertChar:b,uploadFiles:y,disableHorizontalEdgeScroll:_,isNewBlock:S,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I}=e,x=((null==w?void 0:w.normalizedSchemaStore.state)??a.getSchema())[g],C=l.Z.findBlockPropertyValue(a,g);let T=e.rect;const M=null==C?void 0:C.getNode();if(M&&(d.bx({element:M,vertical:{reveal:"closest"},horizontal:_?void 0:{reveal:"closest"},scrollers:{verticalScroller:null==C?void 0:C.getContextVerticalScroller(),horizontalScroller:null==C?void 0:C.getContextHorizontalScroller()}}),!T)){const e=o.findDOMNode(M);e instanceof Element&&(T=e.getBoundingClientRect())}if(!T)return;const P=a.clone();if(n.setState({isOpen:!0,store:a,clonedStore:P,additionalStores:c,property:g,format:h,rect:T,preventClearSelection:v,insertChar:b,uploadFiles:y,isNewBlock:S,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I}),!I||"title"!==(null==x?void 0:x.type)&&"text"!==(null==x?void 0:x.type)||null==I||I.setState({textStoresBeingEdited:[...c,a],lastBlockPropertyValueOverlayCloseTime:void 0}),x&&r.Yl(x.type)){v||u.ZH(t);const e=P.getNormalizedPropertyStore(g);b&&f.createAndCommit({userAction:"blockPropertyValueOverlayActions.open",environment:t,perform:n=>{p.sO({environment:t,store:e,value:s.TPx(b),transaction:n})}}),i.default.afterNextFlush((()=>{i.default.afterNextFlush((()=>{i.default.afterNextFlush((()=>{m.NX({store:e})}))}))}))}else v||u.ZH(t),m.ZH(t)}function h(e){const{environment:t,blockPropertyValueOverlayStore:n}=e,o=n.state;o.isOpen&&(o.preventClearSelection||u.ZH(t),n.reset(),i.default.afterNextFlush((()=>{var e;return null===(e=o.collectionsBulkActionsToolbarStore)||void 0===e?void 0:e.setState({textStoresBeingEdited:[],lastBlockPropertyValueOverlayCloseTime:Date.now()})})))}const v=function(e){const{stores:t,property:n,transaction:o}=e,i=t[0].getPropertyStore(n),r=(0,a.Ml)(i.getValue());for(const s of t)c.sO({store:s.getPropertyStore(n),value:(0,a._I)(!r),transaction:o})};function b(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onTab)null==a||null===(o=(i=a.getProps()).onTab)||void 0===o||o.call(i);else h(e)}}function y(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onUntab)null==a||null===(o=(i=a.getProps()).onUntab)||void 0===o||o.call(i);else h(e)}}function _(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onEnter)null==a||null===(o=(i=a.getProps()).onEnter)||void 0===o||o.call(i);else h(e)}}function S(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onEsc)null==a||null===(o=(i=a.getProps()).onEsc)||void 0===o||o.call(i);else h(e)}}function w(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:r}=n,a=l.Z.findBlockPropertyValue(t,r);var o,i;if(null!=a&&a.getProps().onBgClick)null==a||null===(o=(i=a.getProps()).onBgClick)||void 0===o||o.call(i);else h(e)}}function k(e){const{blockPropertyValueOverlayStore:t,openProperty:n}=e,o=t.state;if(o.isOpen){var i,r;const{store:t,property:a}=o,s=l.Z.findBlockPropertyValue(t,a);(null==s||null===(i=(r=s.getProps()).onOpenProperty)||void 0===i?void 0:i.call(r,n))||h(e)}}},48948:(e,t,n)=>{n.d(t,{K:()=>u});var o=n(41432),i=n(29477),r=n(23867),a=n(70203),s=n(80444),l=n(54642),c=n(9953),d=n(82530);async function u(e){const{store:t,url:n,environment:u,teamId:p}=e,m=void 0!==e.transformTimeout?e.transformTimeout:3e3,{serverCommitResult:f}=d.createAndCommit({userAction:"bookmarkBlockActions.createBookmark",environment:u,perform:e=>{c.sW({store:t.getPropertiesStore(),data:{link:a.TPx(n),title:a.TPx(n)},transaction:e})}}),{winner:g,rest:h}=await i.S3([f,i.Vs(m)]);if(1===g&&(await async function(e,t){const{serverCommitResult:n}=d.createAndCommit({userAction:"bookmarkBlockActions.transformIntoBookmark",environment:e,perform:e=>{c.sW({store:t,data:{type:o.Ti.bookmark},transaction:e})}});await n}(u,t),await h),p){const{currentSpaceStore:e}=s.default.state;await l.setBookmarkMetadata(u,{type:"team-invite-bookmark",block:{id:t.id,spaceId:(0,r.C)(t.pointer.spaceId)},url:n,teamId:p,spaceId:e&&e.id})}else await l.setBookmarkMetadata(u,{type:"external-bookmark",block:{id:t.id,spaceId:(0,r.C)(t.pointer.spaceId)},url:n})}},893:(e,t,n)=>{n.d(t,{tq:()=>ot,JG:()=>Dt,IK:()=>ln,VG:()=>an,g9:()=>cn,Hs:()=>rn,Dw:()=>sn,RD:()=>dn,Pm:()=>mn,by:()=>Rt,tk:()=>Qt,of:()=>Ot,e0:()=>It,Mt:()=>gn,wc:()=>fn,v:()=>tn,AL:()=>Bt,R$:()=>jt,jm:()=>Tt,f4:()=>pn,Lh:()=>hn});n(57658);var o=n(27856),i=n.n(o),r=n(1302),a=n(66897),s=n(15145),l=n(41432),c=n(99036),d=n(8848),u=n(1800),p=n(15095),m=n(64962),f=n(61075),g=n(42509),h=n(43593),v=n(78106),b=n(68626),y=n(38297),_=n(42875),S=n(19531),w=n(64572),k=n(22808),I=n(30845),x=n(72126),C=n(25718),T=n(59753),M=n(482),P=n(77337),A=n(19233),R=n(4615),D=n(71644),B=n(45953),E=n(606),F=n(82883),Z=n(99405),V=n(21202),j=n(6287),U=n(70279),L=n(23867),O=n(54153),N=n(70203),z=n(44805),W=n(95371),q=n(97880),H=n(64002),K=n(9291),G=n(96313),$=n(94419),Q=n(95477),Y=n(24990),J=n(28020),X=n(56518),ee=n(44486),te=n(84210),ne=n(33929),oe=n(68056),ie=n(45162),re=n(70219),ae=n(65598),se=n(73959),le=n(41984),ce=n(40150),de=n(89224),ue=n(89086),pe=n(28685),me=n(41662),fe=n(80444),ge=n(87143),he=n(88632),ve=n(77080),be=n(30874),ye=n(22294),_e=n(26136),Se=n(27724),we=n(24666),ke=n(34583),Ie=n(50906),xe=n(57549),Ce=n(79554),Te=(n(21703),n(374)),Me=n(70842),Pe=n(82798),Ae=n(78791),Re=n(65273),De=n(98165),Be=n(69645),Ee=n(95802),Fe=n(54532),Ze=n(19358),Ve=n(993),je=n(98104),Ue=n(68422);function Le(e){const{environment:t,clipboardData:n,transaction:o,allowPasteIntoHeaderWithoutChildren:i,selectAll:a,developerDebug:s}=e;if(we.default.isEditingComment()||(0,ue.qK)())return!1;if(n.blockSelection.blocks.some((e=>!e.blockSubtree)))return!1;const c=we.default.state;if("editing"!==c.mode)return!1;const d=c.multiSelection.start.store;if(!d.isTable(V.iU))return!1;const u=(0,se.sQ)(d);if(!u)return!1;if(d!==u.getBlockTitleStore())return!1;const p=u.getType(),m=u.getFormat();if(!p)return!1;if(!((0,l.Um)(p,m)||i&&(0,l.zp)(p)))return!1;if(i&&(0,l.zp)(p)){const e=n.blockSelection.blocks[0],t=null==e?void 0:e.blockId,o=null==e?void 0:e.blockSubtree,i=t&&o?o.getModel({id:t,table:"block"}):void 0;if(Boolean(null==i?void 0:i.getContentLength()))return!1}const f=(0,Be.dq)({includeNonSelectableListContainer:!0});if(!f)return!1;const g=(0,Be.v5)(u,[f]);if(!g)return!1;let h=0;for(let r=g.length-1;r>=0;r--){const e=g[r].value.store,t=Ee.C.findSelectableFromStore(e),n=e.getModel();if(null!=n&&n.isType(l.$t)||t&&!t.props.canSelect){h=r;break}}const v=g.slice(h);if(0===v.length)return!1;const b=v[0].value.store,y=b.pointer.spaceId,_=b.isInsideTemplate()||b.isInsideFactoryOrDuplicateBlocksAction();s("pasting at",v,{spaceId:y,pastingIntoTemplate:_,insertionPathRootStore:b});const S=n.blockSelection.blocks.map((e=>{var n;let{blockId:i,blockSubtree:r}=e;if(!r)throw new Error("Missing data for local duplicate block during paste");const a=(null===(n=r.getModel({table:V.iU,id:i}))||void 0===n?void 0:n.getType())===l.Ti.factory,s=!(_||a),c=_e.G.createChildStore(b,{table:V.iU,id:i}),d=Fe.E9({environment:t,sourceBlockId:i,targetBlockPointer:{table:V.iU,id:(0,R.ZP)(),spaceId:y},sourceBlockSubtree:r,targetInMemoryRecordCache:b.inMemoryRecordCache,addCopyName:(0,le.Z)(c),deepCopyTransclusionContainers:!1,resolveTemplateVariables:s,transaction:o,useCrdt:b.useCrdt()}),u=d.targetBlock.getType();return u&&Ie.W2j(t,{from:"paste",type:u,new_page_id:"page"===u?d.targetBlock.id:void 0,creating_block_id:d.targetBlock.id}),d})),w=n.multiTextSelection.start.pointerPath,k=n.multiTextSelection.end.pointerPath,I=[],x=[],C=Math.max(w.length,k.length),T=(v[v.length-C]||v[0]).value.store,M=(0,W.MW)({node:n.tree,recordStoreParent:T},(e=>{let{node:t,recordStoreParent:n}=e;const o=((e,t)=>{let n;for(const{originalToDuplicate:o}of S)if(n=o.get(t),n)break;if(n)return _e.G.createChildStore(e,n)})(n,t.value),i=I.length<w.length?w[I.length]:void 0,r=x.length<k.length?k[x.length]:void 0;let a=!1;if((null==i?void 0:i.id)===t.value.id&&(a=!0,I.push(o)),(null==r?void 0:r.id)===t.value.id&&(a=!0,x.push(o)),!a)return{value:{store:o}};const s=(null==o?void 0:o.getContentStore())||b;return{value:{store:o},children:t.children.map((e=>({node:e,recordStoreParent:s})))}}));if(I.length!==w.length||0===I.length)throw new Error(`Failed to hydrate start path during paste (found ${I.length} of ${w.length})`);if(x.length!==k.length||0===x.length)throw new Error(`Failed to hydrate end path during paste (found ${x.length} of ${k.length})`);const P=I[I.length-1],A=x[x.length-1];if(!P||!A)throw new Error(`Failed to hydrate position during paste (${P?"":"missing start"} ${A?"":"missing end"})`);const D=(0,W.DY)([M],(e=>e.value.store===P)),B=(0,W.DY)([M],(e=>e.value.store===A)),E=D&&B&&Me.T.fromNearestCommonAncestor(D,B);if(!E)throw new Error(`Failed to build range for paths: ${D?"":"missing start"} ${B?"":"missing end"}`);Ve.pz({environment:t,multiSelection:c.multiSelection,transaction:o});const F=we.default.state,Z="editing"===F.mode?F.multiSelection:c.multiSelection;if((0,ae.PF)(u)&&0===n.multiTextSelection.start.textIndex){const e=P.getType();e&&(0,l.Zu)(e)&&Ue.Cj({environment:t,blocks:[u],blockType:e,transaction:o})}let j;return b.useCrdt()?(Ne({transaction:o,developerDebug:s,clipboardData:n,startBlock:u,duplicateStartStore:P,range:E,insertionPath:v,duplicates:S,insertionPathRootStore:b}),j=Oe({environment:t,transaction:o,clipboardData:n,insertionPoint:Z,developerDebug:s,textSelectionState:c,duplicateEndStore:A,pastingIntoTemplate:_}).newSelectionIndex):(j=Oe({environment:t,transaction:o,clipboardData:n,insertionPoint:Z,developerDebug:s,textSelectionState:c,duplicateEndStore:A,pastingIntoTemplate:_}).newSelectionIndex,Ne({transaction:o,developerDebug:s,clipboardData:n,startBlock:u,duplicateStartStore:P,range:E,insertionPath:v,duplicates:S,insertionPathRootStore:b})),r.default.afterNextFlush((()=>{const e=(0,Be.kC)({rootStore:b,root:f,target:E.end}),t=e&&(0,se.mh)(e[e.length-1]);if(!t)return;const n={start:{index:a?Z.start.index:j,store:a?Z.start.store:t},end:{index:j,store:t}};je.NA({multiSelection:n})})),!0}function Oe(e){const{insertionPoint:t,duplicateEndStore:n,pastingIntoTemplate:o,environment:i,transaction:r,developerDebug:a,clipboardData:s}=e;let l=0;const c=t.end.store,d=t.end.index,u=(0,se.mh)(n);if(u){l=N.eeV(u.getValue()).length;const e=(0,Pe.TO)((0,se.sQ)(c)),t=(0,Pe.TO)((0,se.sQ)(u));Re.Ls({store:c,blockStore:e})&&Re.Ls({store:u,blockStore:t})?(Ae.Wc({sourceBlockStore:e,targetBlockStore:t,splitAtGraphemeIndex:d,transaction:r,moveIntoNewBlock:!1}),a("(CRDT) pasted suffix into end",u)):(Ve.gc({environment:i,sourceStore:c,sourceIndex:d,targetStore:u,targetIndex:l,transaction:r}),a("pasted suffix into end",u))}else Ve.pe({environment:i,transaction:r,store:c,selection:{startIndex:d,endIndex:1/0}}),a("no end title store to paste text into");let p=N.OAI(s.multiTextSelection.start.copiedText);return o||(p=N.KV2(p,{currentUserId:i.currentUser.id,currentTimeZone:(0,_.r)()})),Ve.mM({environment:i,index:t.start.index,store:t.start.store,tokens:p,transaction:r}),{newSelectionIndex:l}}function Ne(e){const{transaction:t,clipboardData:n,startBlock:o,duplicateStartStore:i,insertionPath:r,insertionPathRootStore:a,duplicates:s,range:l,developerDebug:c}=e;for(const u of l.iterateInsertionAt(r))(0,Be.D_)({transaction:t,treeOperation:u,deleteFrom:"tree-parent"}),Te.f.applyMutable(u);if(n.blockSelection.wasContiguousSelection&&n.blockSelection.blocks.length>0&&!o.hasContent())for(const u of i.getContentStores())$.R3({parent:o.getContentStore(),append:u,transaction:t});const d=new Set;for(const{originalToDuplicate:u}of s){const e=u.getByTable(V.iU);for(const{value:n}of e){if(!n||d.has(n.id))continue;d.add(n.id);const e=_e.G.createChildStore(i,n);(0,De.qA)(e).find((e=>e.id===a.id))||(c("disposing of unwanted duplicated block:",e,e.id===i.id),Ze.YM({childStore:e,parentStore:a,alive:!1,transaction:t}))}}}var ze=n(42274),We=n(14900),qe=n(47307),He=n(31781),Ke=n(89951),Ge=n(9953),$e=n(42858),Qe=n(24677),Ye=n(64964),Je=n(80402),Xe=n(82530),et=n(12170);function tt(){}const nt=(0,K.defineMessages)({offlineError:{id:"clipboardActions.offlineError.message",defaultMessage:"Please go online to copy this block."}}),ot=(0,K.defineMessages)({copiedQnAMessageToClipboard:{id:"action.copiedQnAMessageToClipboard",defaultMessage:"Copied response to clipboard"},copiedLinkToClipboard:{id:"action.copiedLinkToClipboard.snackBarMessage",defaultMessage:"Copied link to clipboard"},copiedBlockLinkToClipboard:{id:"action.copiedBlockLinkToClipboard.snackBarMessage",defaultMessage:"Copied block link to clipboard"},copiedLinksToClipboard:{id:"action.copiedLinksToClipboard.snackBarMessage",defaultMessage:"Copied links to clipboard"},copiedPropertyToClipboard:{id:"action.copiedPropertyToClipboard.snackBarMessage",defaultMessage:"Copied property to clipboard"},copiedCodeToClipboard:{id:"action.copiedCodeToClipboard.snackBarMessage",defaultMessage:"Copied code to clipboard"},copiedTokenToClipboard:{id:"action.copiedTokenToClipboard.snackBarMessage",defaultMessage:"Copied token to clipboard"},copiedToClipboard:{id:"action.copiedToClipboard.snackBarMessage",defaultMessage:"Copied to clipboard"},copiedApiObjectToClipboard:{id:"action.copiedApiObjectToClipboard.snackBarMessage",defaultMessage:"Copied API object to clipboard"}}),it={...A.Y,dockerfile:"Docker",javascriptreact:"JavaScript",jsonc:"JSON","objective-c":"Objective-C",proto:"Protobuf",shellscript:"Shell",typescriptreact:"TypeScript",vb:"Visual Basic"},rt="text/_notion-blocks-v3-production",at="text/_notion-text-production",st="text/_notion-multi-text-production",lt="text/_notion-page-source-production",ct="vscode-editor-data",dt=[rt,at,st,lt],ut=new Set(dt);const pt={fromJson:e=>e,toJson:e=>e},mt=pt,ft=pt,gt=pt,ht={fromJson(e){const t=(0,W.MW)(e.tree,(e=>e)),n=vt.fromJson(e.blockSelection);return{...e,tree:t,blockSelection:n}},toJson(e){const t=vt.toJson(e.blockSelection);return{...e,blockSelection:t}}},vt={fromJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?B.Ak.create(e.blockSubtree):void 0})))}),toJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?e.blockSubtree.toJson({allowVersionDowngrade:!1}):void 0})))})},bt="VirtualClipboard:production";let yt;function _t(e){return e.isAndroid}function St(e,t){if(!_t(t))return e;const n=(0,X.nZ)(e.getData("text/html"));if(n){yt||(yt=O.Z.get(bt));const t=yt;if(n===(null==t?void 0:t.id))return{getData(n){const o=e.getData(n);return!o&&function(e){return ut.has(e)}(n)?t.mimeTypes[n]||"":o}}}return e}function wt(e,t,n,o){if(!e.clipboardData)return;const i=n.toJson(o),r=JSON.stringify(i);e.clipboardData.setData(t,r)}function kt(e,t,n){try{const o=e.getData(t),i=JSON.parse(o);return n.fromJson(i)}catch(o){return}}function It(e){const{clipboardData:t}=e,{text:n,html:o,isFromMicrosoftOffice:i,isHtmlTable:r}=function(e){const{clipboardData:t,tinyMceMicrosoftWordPasteFilter:n}=e,o=t.getData("text/uri-list").trim(),i=t.getData("text/plain").trim().replace(en,"\n")||o,r=t.getData("text/html").trim(),a=Ht(r),{isHtmlTable:s,htmlContainsRichFormatting:l}=function(e){var t;const n=document.createElement("div");n.innerHTML=Kt(e);const o=Boolean("table"===(null===(t=n.firstElementChild)||void 0===t?void 0:t.nodeName.toLowerCase()));return{htmlContainsRichFormatting:S.RE({node:n,window,emojiData:Y.Z.state}),isHtmlTable:o}}({html:r,tinyMceMicrosoftWordPasteFilter:n});if(!l&&!function(e,t){return Xt.test(e)&&Xt.test(t)}(r,i))return{text:i,isFromMicrosoftOffice:a,isHtmlTable:s};return{text:i,html:r,isFromMicrosoftOffice:a,isHtmlTable:s}}(e);return{text:n,html:o,multiTextSelectionData:kt(t,st,ht),textSelectionData:kt(t,at,mt),blockSelectionData:kt(t,rt,vt),isFromMicrosoftOffice:i,isHtmlTable:r}}function xt(e){const{blocks:t,action:n,environment:o}=e;if(0===t.length)return{action:n,blocks:[],wasContiguousSelection:!1};const i=t[0],r=i.inMemoryRecordCache,a=x.jj(x.oA(t.map((e=>e.id)))),s=i.getParentBlockStore(),l=s?s.getRenderableContentIds():[],c=l.indexOf(i.id),d=Boolean(s&&t.every(((e,t)=>l.indexOf(e.id)===c+t)));if(r.isTemplatePreview){return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Fe.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}if(r.snapshotData){Ie.P_7(o,r.snapshotData);return{blocks:a.map((e=>({blockId:e,snapshotData:r.snapshotData,blockSubtree:Fe.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}{const e=(0,X.IU)(t),i=e&&function(e){var t;const{environment:n,multiColumnPasteInfo:o,inMemoryRecordCache:i}=e,{columnListId:r,columnIds:a,spaceId:s}=o,l=B.Ak.create(),c=null===(t=i.getEntry({pointer:{table:V.iU,id:r,spaceId:s},userId:n.currentUser.id}))||void 0===t?void 0:t.value.value;if("column_list"!==(null==c?void 0:c.type))return;const d={...c,content:(c.content||[]).filter((e=>a.has(e)))};l.setValue({table:V.iU,id:r,spaceId:s},d);for(const m of a){var u;const e=null===(u=i.getEntry({pointer:{table:V.iU,id:m,spaceId:s},userId:n.currentUser.id}))||void 0===u?void 0:u.value.value;if("column"!==(null==e?void 0:e.type))return;const t={...e,content:(e.content||[]).filter((e=>o.blockIds.has(e)))};l.setValue({table:V.iU,id:m,spaceId:s},t)}const p=[l];for(const m of o.blockIds){const e=Fe.K8(n,{blockId:m,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!e)return;p.push(e)}return B.Ak.merge(p)}({environment:o,inMemoryRecordCache:r,multiColumnPasteInfo:e});if(e&&i){let t=!1;const s=[];for(const n of a)e.blockIds.has(n)?t||(s.push({blockId:e.columnListId,snapshotData:void 0,blockSubtree:i}),t=!0):s.push({blockId:n,snapshotData:void 0,blockSubtree:Fe.K8(o,{blockId:n,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})});return{blocks:s,action:n,wasContiguousSelection:d}}return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Fe.K8(o,{blockId:e,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}}function Ct(e){const{markdown:t,markdownOptions:n,markdownLinkifyIt:o}=e;if(o)return C.c8({...o,markdown:t,plugin:null==n?void 0:n.plugin})}function Tt(e){const{rootBlock:t,getRecordValue:n}=e,o=n(t);if(!o)return;const i=(0,y.ky)({block:o,getRecordValue:n});if(!i)return;const r=(0,X.ax)({rootBlock:t,getRecordValue:n}),a=(0,c.oC)(i),s=Object.keys(a),l=x.MR(s,(e=>{const t=a[e];return t&&t.name||""}));let d="";for(const c of l){const e=a[c];if(e&&"title"!==c){const t=(0,f.Wy)({property:c,schema:a,block:o,exportArgs:r,renderers:m.O});t&&(d+=`${e.name}: ${t}\n`)}}return d||void 0}function Mt(e){const{treePath:t,textPosition:n,endpoint:o}=e,{store:i,index:r}=n,a=t.map((e=>e.value.store.pointer)),s=n.store.path,l=N.xrQ(i.getValue(),r,r);return{copiedText:"end"===o?l.tokensBeforeRange:l.tokensAfterRange,textIndex:r,attributePath:s,pointerPath:a}}function Pt(e){var t;const{multiSelection:n,action:o,environment:i}=e;(0,oe.qS)(n)&&console.warn("Warning, serializeMultiTextSelectionToClipboardData() was called with a single-store text selection! This function should only be  called with a multi-selection that spans multiple blocks.");const r=null===(t=(0,ie.tp)({filterCommonAncestors:!0,multiSelection:n,focus:void 0}))||void 0===t?void 0:t.stores;if(!r)return;const a=xt({action:o,blocks:r,environment:i});if(0===a.blocks.length)return;const s=(0,ie.Nj)({multiSelection:n,includeNonSelectable:!1});if(!s)return;const{treeRange:l}=s,c=[],d=new Map,u=(e,t)=>{t.forEach((e=>u(e,[])));const n=d.get(e),o=n&&n.length>t.length?n:t;d.set(e,o)};for(const{start:v,end:b}of l.iterateAnalogousNodes()){if(v){const e=v.childrenBeforeRange.slice(-1).concat(v.childrenInsideRange);u(v.parent,e)}b&&(u(b.parent,b.childrenInsideRange),c.push(M.op.set({pointer:b.parent.value.store.pointer,path:["content"],args:b.childrenInsideRange.map((e=>e.value.store.id))})))}const p=Mt({textPosition:n.start,endpoint:"start",treePath:l.startPath}),m=Mt({textPosition:n.end,endpoint:"end",treePath:l.endPath});c.push(...(0,X.FQ)(p),...(0,X.FQ)(m));for(const v of[null===(f=a.blocks[0])||void 0===f?void 0:f.blockSubtree,null===(g=a.blocks[a.blocks.length-1])||void 0===g?void 0:g.blockSubtree]){var f,g;v&&(0,P.FS)({recordMap:v,operations:c,updateOnly:!0})}const h=(0,W.MW)(l.commonAncestor,(e=>{const t=d.get(e);if(t)return{value:e.value.store.pointer,children:t}}));return h?{blockSelection:a,tree:h,multiTextSelection:{start:p,end:m},action:o}:void 0}function At(e){const{environment:t,event:n}=e,o=(0,R.ZP)();!function(e){const{environment:t,event:n,markdownLinkifyIt:o}=e;if(!n.clipboardData)return;const i=Se.default.state.stores,r=we.default.isEditingComment(),a=me.g$.getSimpleTableCellFromTextSelection(),s="empty"!==we.default.state.mode&&we.default.state.multiSelection,c=t.currentUser.id,u="copy"===n.type?"copy":"cut",p=J.RM();p&&(0,E.$O)(p.pointer,V.iU)&&wt(n,lt,ft,p.pointer);const m=s&&(0,oe.QY)(s);if(m&&m.selection.startIndex!==m.selection.endIndex){const e=ne.default.getIntl(),{store:o,selection:i}=m,r=o.inMemoryRecordCache,a=o.getValue();if(n.preventDefault(),a&&!Qt()){var f;const e="title"===o.path[o.path.length-1],t=null===(f=(0,se.sQ)(o))||void 0===f?void 0:f.getType(),r=e&&t&&(0,l.Zu)(t)?t:void 0,s=a.filter((e=>!N.eIM(e)));wt(n,at,mt,{blockType:r,editing:s,selection:i,action:u})}const s=N.KU1(a,i.startIndex,i.endIndex),p=T.om.fromGetRecordValueFn(r.makeGetRecordValueFn(c)),g=r.makeGetRecordRoleFn(c),h=(0,F.X)({intl:e,textValue:s,getRecordModel:p,userTimeZone:(0,_.r)()});n.clipboardData.setData("text/plain",(0,X.ZI)(t.device.isWindows,h));const v=z.hW({textValue:s&&{value:s,spaceId:(0,L.C)(o.pointer.spaceId)},getRecordModel:p,getRecordRole:g,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:e,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,re.b)(t),externalIntegrations:be.Z.integrations.state,formulaValueTypes:[],emojiData:Y.Z.state,isMobileNative:!1});return void n.clipboardData.setData("text/html",(0,X.ZI)(t.device.isWindows,v))}if(s&&!(0,oe.iG)(s)&&!r&&s.start.store.table===V.iU&&s.end.store.table===V.iU){const e=Pt({environment:t,multiSelection:s,action:u});if(e){n.preventDefault(),wt(n,st,ht,e);const i=s.start.store.inMemoryRecordCache,r=s.start.store.getRecordStoreUIRoot().getValue();if(!r)return;const{markdown:a,html:l}=(0,X.Ef)({clipboardData:e,rootBlock:{id:r.id,table:V.iU,spaceId:r.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:i.makeGetRecordValueFn(c),markdownLinkifyIt:o});return a&&n.clipboardData.setData("text/plain",a),void(l&&n.clipboardData.setData("text/html",l))}}if(s&&!(0,oe.iG)(s)&&!r&&s.start.store.table===U.x_&&s.end.store.table===U.x_){n.preventDefault();const e=(0,ie.L5)(s),o=ne.default.getIntl(),i=e.map((e=>{let{store:n,selection:i}=e;if(i.startIndex===i.endIndex)return;const r=n.inMemoryRecordCache,a=T.om.fromGetRecordValueFn(r.makeGetRecordValueFn(c)),s=r.makeGetRecordRoleFn(c),l=N.KU1(n.getValue(),i.startIndex,i.endIndex);return{plainText:(0,F.X)({intl:o,textValue:l,getRecordModel:a,userTimeZone:(0,_.r)()}),htmlContent:z.hW({textValue:l&&{value:l,spaceId:(0,L.C)(n.pointer.spaceId)},getRecordModel:a,getRecordRole:s,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:o,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,re.b)(t),externalIntegrations:be.Z.integrations.state,formulaValueTypes:[],emojiData:Y.Z.state,isMobileNative:!1}),textValue:l}})).filter(q.$K),r=i.map((e=>e.plainText)).join("\n\n"),a=`<div>${i.map((e=>e.htmlContent)).join("</div><div>")}</div>`;return n.clipboardData.setData("text/plain",(0,X.ZI)(t.device.isWindows,r)),void n.clipboardData.setData("text/html",(0,X.ZI)(t.device.isWindows,a))}if(i.length>0&&!r&&!a){n.preventDefault();const e=i[0],r=e.inMemoryRecordCache,a=xt({blocks:i,environment:t,action:u});if(wt(n,rt,vt,a),!e.isDefined())return;const s=x.oA(i.map((e=>e.computeWithRecordValues((t=>{let{getRecordValueAndSubscribe:n}=t;return n(e)}))))),l=r.makeGetRecordValueFn(c),{markdown:d,html:p}=(0,X.X4)({rootBlock:{id:e.id,table:V.iU,spaceId:e.getSpaceId()},blockValues:s,getRecordValue:l,isWindows:t.device.isWindows,markdownLinkifyIt:o});return d&&n.clipboardData.setData("text/plain",d),void(p&&n.clipboardData.setData("text/html",p))}}(e),(0,X.Li)(n,o),function(e){let{event:t,device:n,customEventId:o}=e;if(!t.clipboardData||!_t(n))return;const i={};for(const s of dt)i[s]=t.clipboardData.getData(s);const r=t.clipboardData.getData("text/html");t.clipboardData.setData("text/html",`${r}${(0,X.Gp)(o)}`),yt={id:o,mimeTypes:i};try{O.Z.set(bt,yt)}catch(a){b.log({level:"error",from:"clipboardActions",type:"setVirtualClipboardData",error:{message:"Unable to persistently store virtual clipboard data."}})}}({event:n,device:t.device,customEventId:o})}async function Rt(e){const{event:t,environment:n,markdownLinkifyIt:o}=e;je.Zk(n);const i=Se.default.state.stores,r=we.default.isEditingComment(),a=J.JE(),s="editing"===we.default.state.mode&&we.default.state.multiSelection,{phase:l}=Se.default.state;Dt({environment:n,event:t,disableSyncTextSelection:!0,markdownLinkifyIt:o}),s&&!(0,oe.iG)(s)?Xe.createAndCommit({userAction:"clipboardActions.cutWithMaybeConfirmation",environment:n,perform:e=>{Ve.pz({environment:n,multiSelection:s,transaction:e})}}):(l===Se.SelectionPhase.Selected||s)&&i.length>0&&!r&&!a&&await $e.Qw({environment:n,blocks:i}),ye.Z.setKeyboardMode(!0)}function Dt(e){const{environment:t,event:n,disableSyncTextSelection:o,markdownLinkifyIt:i}=e;o||je.Zk(t),At({environment:t,event:n,markdownLinkifyIt:i}),ye.Z.setKeyboardMode(!0)}function Bt(e){const{environment:t,files:n,transaction:o}=e,i=Se.default.getCurrentRecordCache(),r=J.qQ(t);if(i){var a,s;const e=Se.default.state.stores,l=He.z({environment:t,files:n,inMemoryRecordCache:i,transaction:o,pageWidth:r,spaceId:0!==e.length?e[0].pointer.spaceId:null===(a=J.RM())||void 0===a?void 0:a.pointer.spaceId,useCrdt:0!==e.length?e[0].useCrdt():(null===(s=J.RM())||void 0===s?void 0:s.useCrdt())??!1});l.forEach((e=>{const n=e.getType();n&&Ie.W2j(t,{from:"paste",type:n,creating_block_id:e.id})})),Zt({environment:t,blocks:l,transaction:o,replaceEmptyTextBlock:!0})}}function Et(e){const{environment:t,store:n,tokens:o,index:i,transaction:a,multiTextSelection:s,disableEmbedMenu:l,selectAll:c}=e,d=(0,oe.QY)(s),u=d?{value:d.store.getValue()}:void 0;Ve.mM({environment:t,store:n,tokens:o,index:i,transaction:a,selectAll:c});const m=Ft(o);!l&&u&&m&&function(e){const{environment:t,hyperlink:n,oldTextValue:o}=e,i="editing"===we.default.state.mode&&(0,oe.QY)(we.default.state.multiSelection),a=Se.default.state;if(i&&a.stores.length>0){const e=i.store.getValue(),a=N.QaF(e),s=p.p4(a.substring(0,a.indexOf(n.text))).length,l=s+p.p4(n.text).length;if(i.store.isTable(V.iU)||i.store.isTable(U.x_)){if(et.KT({environment:t,blockStore:Se.default.state.stores[0],textStore:i.store,textValueBeforePaste:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return;if(G.QZ({environment:t,textStore:i.store,blockStore:Se.default.state.stores[0],oldTextValue:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return}r.default.afterNextFlush((()=>{let e=n.url;try{e=decodeURIComponent(n.url)}catch(r){b.log({level:"info",from:"clipboardActions",type:"activateMenuFromLink",error:{message:`Encountered error in decodeURIComponent ${n.url}`}})}Ke.KT({environment:t,textStore:i.store,oldTextValue:o,url:e,urlSelection:{startIndex:s,endIndex:l}})}))}}({environment:t,hyperlink:m,oldTextValue:u.value,transaction:a})}function Ft(e){if(1!==e.length)return;const t=e[0];if(!N.AJd(t))return;const[n,o]=t;if(1!==o.length)return;const i=o[0];if(!N.j0F(i))return;return{text:n,url:N.zW$(i)}}function Zt(e){const{environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:i}=e,r=Se.default.state.stores;if(1===r.length){const e=r[0];if(e.getType()&&e.isType(l.hY)&&function(e){if("editing"!==we.default.state.mode||!we.default.state.multiSelection)return!1;const t=(0,oe.QY)(we.default.state.multiSelection);if(!t)return!1;return t.store===e.getTitleStore()}(e)){const i=e.getContentStore(),r=x.d9(n).reverse().map((e=>$.Ce({parent:i,prepend:e,transaction:o}).child));return Qe.Z5({environment:t,stores:r}),r}}return $e.is({selection:r,environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:i})}function Vt(e,t,n,o){const i=(0,J.RM)();if(!i)return;const a=Se.default.state.stores,s=0!==a.length?a[0].pointer.spaceId:i.pointer.spaceId,c=0!==a.length?a[0].useCrdt():i.useCrdt();let d=function(e,t){if("cut"!==t.action||!ve.default.checkGate("convert_cut_paste_to_move"))return;const n=[];for(const o of t.blocks){const t=_e.G.createChildStore(e,{table:V.iU,id:o.blockId});if(!t.isReady())return;const i=t.getModel();if(!i)return;if(i.getSpaceId()!==e.getSpaceId())return;if(!1!==i.alive)return;n.push(t)}return n}(i,t);d||(d=t.blocks.map((t=>{var n;let{blockId:r,blockSubtree:a,snapshotData:l}=t;const d=_e.G.createChildStore(i,{table:V.iU,id:r});let u;if(d.isDefined())u=d.getModel();else{const e=null==a?void 0:a.getValue({table:V.iU,id:r});u=e&&T.kk.fromBlock(e)}const p=!(i.isInsideTemplate()||Yt()||i.isInsideFactoryOrDuplicateBlocksAction()||null!==(n=u)&&void 0!==n&&n.isTemplateVariableContainerBlock());if(a){const t=Fe.E9({environment:e,sourceBlockId:r,targetBlockPointer:{table:V.iU,spaceId:s,id:(0,R.ZP)()},sourceBlockSubtree:a,targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,le.Z)(d),deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,transaction:o,useCrdt:c}).targetBlock,n=t.getType();return n&&Ie.W2j(e,{from:"paste",type:n,new_page_id:"page"===n?t.id:void 0,creating_block_id:t.id}),t}{he.Z.state.online||qe.showErrorMessage(ne.default.formatMessage(nt.offlineError));const[t,n]=Fe.WJ({environment:e,sourceBlocks:[{id:r,spaceId:(0,L.C)(void 0)}],targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,le.Z)(d),transaction:o,deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,snapshotData:l,targetSpaceId:(0,L.C)(s),convertExternalObjectInstancesToPlaceholders:!1,useCrdt:c}),i=t[0],a=i.getType();return n.then((t=>{t?qe.showErrorMessage(t):a&&Ie.W2j(e,{from:"paste",type:a,new_page_id:"page"===a?i.id:void 0,creating_block_id:i.id})})),i}}))),Zt({environment:e,blocks:d,transaction:o,replaceEmptyTextBlock:!0});const u=Se.default.state.stores,p=u.length>0?u:[i],m=t.blocks.map((e=>{const t=p.length>0?p[0]:function(e){return e.isCollectionView()?e.getCollectionViewCollectionStore()||e:e.getContentStore()}(i);return _e.G.createChildStore(t,{table:V.iU,id:e.blockId})}));r.default.afterNextFlush((async()=>{await Promise.all(p.map((e=>e.waitUntil((()=>{const t=e.getType();return Boolean(t&&t!==l.Ti.copyIndicator)}))))),await Promise.all(m.map((e=>e.load()))),n&&Ce.RH({environment:e,blocks:p,pageSource:n,copiedStores:m,action:t.action,wasContiguousSelection:t.wasContiguousSelection,rootStore:i})&&Ce.kE({copiedStores:m,blocks:p,pageSource:n})}))}function jt(e){const{environment:t,disableEmbedMenu:n,transaction:o,overwrite:i,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c=e.text.trim(),d=c.includes("\n"),u=we.default.state,p=$t(u);d&&"inline"!==p||"editing"!==u.mode?i?function(e){const{environment:t,text:n,transaction:o,selectAll:i,markdownOptions:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=Ct({markdown:n,markdownOptions:r,markdownLinkifyIt:a});if(!l)return;let c=Lt({html:l,wrapInEmptyBlocks:!1,tinyMceMicrosoftWordPasteFilter:s});c||(c=Lt({html:l,wrapInEmptyBlocks:!0,tinyMceMicrosoftWordPasteFilter:s}));if(!c)return;Le({environment:t,clipboardData:c,transaction:o,allowPasteIntoHeaderWithoutChildren:!0,selectAll:i,developerDebug:tt})}({environment:t,text:c,transaction:o,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}):c&&function(e){const{environment:t,text:n,transaction:o,markdownOptions:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}=e,s=Ct({markdown:n,markdownOptions:i,markdownLinkifyIt:r});if(s)zt({environment:t,html:s,transaction:o,tinyMceMicrosoftWordPasteFilter:a})}({environment:t,text:c,transaction:o,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}):function(e){const{environment:t,text:n,disableEmbedMenu:o,transaction:i,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===we.default.state.mode&&we.default.state.multiSelection;if(c){const e=(0,oe.QY)(c);if(e&&function(e){const t=we.default.state;return"editing"===t.mode&&!(0,oe.iG)(t.multiSelection)&&(0,oe.qS)(t.multiSelection)&&I.B(e,"url")}(n))Jt({environment:t,text:n,transaction:i,editingSelection:e,selectAll:r});else if((0,ue.Ld)("c"))Ve.hJ({environment:t,multiSelection:c,string:n,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:i,selectAll:r});else{const e=s&&C.lM({...s,markdown:n,plugin:null==a?void 0:a.plugin});if(!e)return;Nt({environment:t,html:e,transaction:i,stripText:!0,disableEmbedMenu:o,selectAll:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}}}({environment:t,text:c,disableEmbedMenu:n,transaction:o,selectAll:r,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}function Ut(e,t){const n=e.getValue({table:V.iU,id:t});if(!n)return;const o={table:V.iU,id:t,spaceId:n.space_id},i=(n.content??[]).map((t=>Ut(e,t))).filter(q.$K);return new W.mp(o,i)}function Lt(e){var t,n,o,i;const{html:r,wrapInEmptyBlocks:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=qt({html:r,tinyMceMicrosoftWordPasteFilter:s,useCrdt:!1});if(!l)return;let{allOperations:c,rootContentIds:d}=l;if(a){const e=Wt(),t=Wt();if(!e||!t)return;c=[e.operation,...c,t.operation],d=[e.id,...d,t.id]}const u=B.Ak.create();(0,P.FS)({recordMap:u,operations:c,updateOnly:!1});const p=[];for(const S of d)p.push({blockId:S,snapshotData:void 0,blockSubtree:u.clone()});const m=new W.mp({table:V.iU,id:(0,R.ZP)(),spaceId:void 0},d.map((e=>Ut(u,e))).filter(q.$K));if(0===m.children.length)return;const f=m.children[0],g=null===(t=(0,W.DY)([m],(e=>e===f)))||void 0===t?void 0:t.map((e=>e.value)),h=null===(n=u.getValue(f.value))||void 0===n||null===(n=n.properties)||void 0===n?void 0:n.title,v=(0,W.CY)(m),b=null===(o=(0,W.DY)([m],(e=>e===v)))||void 0===o?void 0:o.map((e=>e.value)),y=null===(i=u.getValue(v.value))||void 0===i||null===(i=i.properties)||void 0===i?void 0:i.title,_=y?N.QaF(y).length:0;return h&&g&&y&&b?{blockSelection:{blocks:p,wasContiguousSelection:!0,action:"copy"},tree:m,multiTextSelection:{start:{textIndex:0,copiedText:h,attributePath:["properties","title"],pointerPath:g},end:{textIndex:_,copiedText:y,attributePath:["properties","title"],pointerPath:b}},action:"copy"}:void 0}function Ot(e){const{text:t,html:n,stripText:o,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r}=e,a=n||(t?Ct({markdown:t,markdownLinkifyIt:i}):void 0);if(!a)return;const s=document.createElement("div");return s.innerHTML=Kt({html:a,tinyMceMicrosoftWordPasteFilter:r}),S.xR({node:s,window,stripText:o,emojiData:Y.Z.state})}function Nt(e){const{environment:t,html:n,transaction:o,stripText:i,disableEmbedMenu:r,selectAll:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===we.default.state.mode&&we.default.state.multiSelection;if(c){const e=Ot({html:n,stripText:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l});if(!e)return;const d=1===e.length;if(d){if(d&&(!e[0][1]||0===e[0][1].length)){const n=e[0][0];return void Ve.hJ({environment:t,multiSelection:c,string:n,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o,selectAll:a})}const n=(0,oe.QY)(c);if(n&&!(0,oe.iG)(c)){const[,i]=e[0],r=i&&N.rlz(i);if(r){return void Jt({environment:t,text:N.zW$(r),transaction:o,editingSelection:n,selectAll:a})}}}Ve.pz({environment:t,multiSelection:c,transaction:o}),Et({environment:t,store:c.start.store,tokens:e,index:c.start.index,transaction:o,disableEmbedMenu:r,multiTextSelection:c,selectAll:a})}}function zt(e){const{environment:t,html:n,transaction:o,tinyMceMicrosoftWordPasteFilter:i}=e,a=J.RM();if(!a)return;const s=qt({html:n,tinyMceMicrosoftWordPasteFilter:i,useCrdt:a.useCrdt()});if(!s)return;const{allOperations:c,rootContentIds:d}=s;for(const r of c){const e=(0,_e.Kv)(a,r.pointer);Xe.applyOperation({store:e,operation:r,transaction:o})}const u=d.map((e=>_e.G.createChildStore(a,{table:V.iU,id:e})));u.forEach((e=>{const n=e.getType();n&&Ie.W2j(t,{from:"paste",type:n,creating_block_id:e.id})}));const p=Zt({environment:t,blocks:u,transaction:o,replaceEmptyTextBlock:!0}).slice().reverse();return r.default.afterNextFlush((()=>{const e=p.map((e=>{if(e.getType()!==l.Ti.text)return;const n=Ft(e.getTitleValue());if(!n)return;const o=(0,Z.Wj)({url:n.url,baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName,isMobile:t.device.isMobile,protocol:Q.default.protocol,currentUrl:window.location.href});return"page"===o.name?o:void 0})).filter(q.$K);e.length===p.length&&Ce._x({environment:t,rootStore:a,blocks:p,copiedLinks:e})})),u}function Wt(){const e=(0,R.ZP)(),{currentUserStore:t}=fe.default.state,n=J.RM();if(!t||!n)return;const o=t.id;if(!o)return;const i=n.id,r=n.pointer.spaceId;return{operation:{pointer:{table:"block",id:e,spaceId:r},command:"set",path:[],args:{id:e,version:1,type:"text",properties:{title:[[""]]},parent_id:i,parent_table:"block",space_id:r,created_by_table:"notion_user",created_by_id:o,created_time:Date.now(),last_edited_by_table:"notion_user",last_edited_by_id:o,last_edited_time:Date.now(),alive:!0}},id:e}}function qt(e){const{useCrdt:t,...n}=e,o=document.createElement("div");o.innerHTML=Kt(n);const{currentUserStore:i}=fe.default.state,r=J.RM();if(!i||!r)return;const s=i.getValue();return s?S.$O({actor:(0,a.dp)(s),parentId:r.id,parentTable:"block",spaceId:r.pointer.spaceId,rootNode:o,importFileMap:{},window,secureFileS3Url:Q.default.secureFileS3.url,secureFileS3UrlV2:Q.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:ne.default.getIntl(),randomID:R.ZP,randomShortID:D.ZP,isPhoneNumber:Gt,emojiData:Y.Z.state,useCrdt:t}):void 0}function Ht(e){return/schemas-microsoft-com:office/.test(e)||/xmlns:m="http:\/\/schemas.microsoft.com\/office\/2004\/12\/omml"/.test(e)}function Kt(e){const{html:t,tinyMceMicrosoftWordPasteFilter:n}=e;return i().sanitize(n&&Ht(t)?n(t):t)}function Gt(e){return/^(\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function $t(e){const t="editing"===e.mode&&e.multiSelection;if(!t)return;const n=pe.E.findEditableWithStore(t.start.store),o=null==n?void 0:n.props;return o&&!o.disabled?o.pasteBehavior:void 0}function Qt(){if("editing"!==we.default.state.mode)return;const e=we.default.state.multiSelection.start,t=e.store.path;if("formula"!==t[t.length-1])return;const n=e.store.getRecordStoreAtRootPath();if(n.table!==V.iU)return;const o=n.getParentId();if(!o)return;const i={table:j.v,id:o,spaceId:n.getSpaceId()},r=n.getRecordModel(i);return r?{parentCollection:r,start:e,getRecordModel:n.getRecordModel}:void 0}function Yt(){const e=Se.default.state.stores;if("editing"!==we.default.state.mode)return e.length>0&&e[0].isInsideFactoryOrDuplicateBlocksAction();if(0===e.length)return!1;const{multiSelection:t}=we.default.state,n=t.start.store;if(!n.isTable(V.iU))return!1;const o=ee.W(n);return Boolean(o)}function Jt(e){const{text:t,transaction:n,environment:o,editingSelection:i,selectAll:r}=e,a=(0,Z.Wj)({url:t,baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName,isMobile:o.device.isMobile,protocol:Q.default.protocol,currentUrl:window.location.href}),s="page"===a.name?(0,w.nR)({pageId:a.blockId,peekViewBlockId:a.peekViewBlockId,peekMode:a.peekMode,discussionId:a.discussionId,scrollToBlockId:a.scrollToBlockId,collectionViewId:a.collectionViewId}):t;Ve.Be({environment:o,store:i.store,selection:i.selection,type:"a",transaction:n}),Ve.i8({environment:o,store:i.store,selection:i.selection,annotation:["a",s],transaction:n}),je.Z5({store:i.store,selection:{startIndex:r?i.selection.startIndex:i.selection.endIndex,endIndex:i.selection.endIndex}})}const Xt=/\<\!-- wp:/;const en=/\u2028/g;function tn(e){const{environment:t,event:n,disableEmbedMenu:o,transaction:i,onPasteFiles:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(n.preventDefault(),je.Zk(t),!n.clipboardData)return;if(!ke.M_(t))return;const c=St(n.clipboardData,t.device),{text:d,html:u,multiTextSelectionData:m,textSelectionData:f,blockSelectionData:g,isFromMicrosoftOffice:h,isHtmlTable:b}=It({clipboardData:c,tinyMceMicrosoftWordPasteFilter:s}),y=kt(c,lt,ft),S=function(e){return e.clipboardData?e.clipboardData.items?x.oA(x.UI(e.clipboardData.items,(e=>{const t=e.getAsFile();if(t&&t.size>0)return new File([t],"Untitled",{type:e.type})}))):p.p4(e.clipboardData.files):[]}(n),w=$t(we.default.state),k=(null==g?void 0:g.action)||(null==m?void 0:m.action)||(null==f?void 0:f.action);i.annotateWithUserAction("cut"===k?"paste.from_cut":X.xF);const I=d.includes("\n"),C=function(e){const t=kt(e,ct,gt),n=null==t?void 0:t.mode;if(!n)return;return it[n]||"Plain Text"}(c),T=I&&C&&"inline"!==w&&!(0,ue.qK)()?function(e){const{codeLanguage:t,environment:n,transaction:o}=e,i=we.default.state,r="editing"===i.mode&&i.multiSelection,a=Se.default.state.stores;if(!r&&0===a.length)return;let s,c,d;r?(s=r.start.store,c=r.end.store,d=(0,se.sQ)(c)):(s=a[0],c=a[a.length-1],d=c);if(!d)return;let u=d;if((0,ae.PF)(d))!function(e){const{block:t,environment:n,transaction:o,codeLanguage:i}=e;Ue.Cj({environment:n,blocks:[t],blockType:"code",transaction:o}),ze.E5({blocks:[t],language:i,transaction:o})}({block:d,environment:n,transaction:o,codeLanguage:t});else{const e=(0,se.sQ)(d);if(!e)return;const t=s.inMemoryRecordCache;if(!t)return;u=Ge.j4({environment:n,type:l.Ti.code,inMemoryRecordCache:t,transaction:o,spaceId:e.pointer.spaceId,useCrdt:e.useCrdt()}),$.BE({parent:e.getContentStore(),after:c,insert:u,transaction:o})}de.clear(n);const p=(0,se.mh)(u);p&&je.N_({store:p});return u}({codeLanguage:C,environment:t,transaction:i}):void 0;xe.bO(t,{pastedText:d,source:"editor_paste"});const M=me.g$.getSimpleTableCellFromTextSelection(),P=n.clipboardData.getData(ce.mH),A=Qt();if(S.length>0&&!h&&!b)r({environment:t,files:S,transaction:i});else if("body"!==(0,ue.qK)()||f)if(T)nn(t,d,i);else if(A){const{parentCollection:e,start:n}=A,o=[[d]],r=e;if(!r)return void nn(t,d,i);const a=we.default.state;"multiSelection"in a&&Ve.pz({environment:t,multiSelection:a.multiSelection,transaction:i});const s=(0,v.UQ)(o,r,A.getRecordModel);Ve.mM({environment:t,tokens:s,store:n.store,index:n.index,transaction:i})}else if(m){(function(e){const{environment:t,transaction:n,multiTextSelectionData:o,disableEmbedMenu:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}=e,s=e.pasteBehavior||"inline",l=e.html||Ct({markdown:e.text,markdownLinkifyIt:r});if("editing"===we.default.state.mode)switch(s){case"inline":return!!l&&(Nt({environment:t,html:l,transaction:n,stripText:!1,disableEmbedMenu:i,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:a}),!0);case"block":return Le({environment:t,clipboardData:o,transaction:n,developerDebug:tt});default:(0,q.t1)(s)}})({multiTextSelectionData:m,environment:t,html:u,text:d,transaction:i,disableEmbedMenu:o,pasteBehavior:w,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})||Vt(t,m.blockSelection,y,i)}else if(f&&f.editing)!function(e){const{environment:t,textSelectionData:n,transaction:o,disableEmbedMenu:i}=e,r=Se.default.getCurrentRecordCache(),{editing:a,selection:s}=n;let{tokensInsideRange:c}=N.xrQ(a,s.startIndex,s.endIndex);c=N.OAI(c);const d=(0,J.RM)();if(d&&!(d.isInsideTemplate()||Yt()||d.isInsideFactoryOrDuplicateBlocksAction())&&(c=N.KV2(c,{currentUserId:t.currentUser.id,currentTimeZone:(0,_.r)()})),"body"===(0,ue.qK)()){const e=N.vNd(c);e&&(c=e)}const u="editing"===we.default.state.mode&&we.default.state.multiSelection;if(u){Ve.pz({environment:t,multiSelection:u,transaction:o});const e=we.default.state;if("editing"===e.mode){const r=e.multiSelection;if(n.blockType&&0===s.startIndex){const e=(0,se.sQ)(r.start.store);e&&"page"!==n.blockType&&(0,ae.PF)(e)&&Ue.Cj({environment:t,blocks:[e],blockType:n.blockType,transaction:o})}Et({environment:t,store:r.end.store,tokens:c,index:r.end.index,transaction:o,disableEmbedMenu:i,multiTextSelection:u})}}else if(r){var p,m;const e=Se.default.state.stores,n=Ge.j4({environment:t,type:l.Ti.text,inMemoryRecordCache:r,transaction:o,spaceId:0!==e.length?e[e.length-1].pointer.spaceId:null===(p=J.RM())||void 0===p?void 0:p.pointer.spaceId,useCrdt:0!==e.length?e[e.length-1].useCrdt():(null===(m=J.RM())||void 0===m?void 0:m.useCrdt())??!1}),i=n.getTitleStore();i&&Ve.mM({environment:t,store:i,tokens:c,index:0,transaction:o}),Ie.W2j(t,{from:"paste",type:l.Ti.text,creating_block_id:n.id}),Zt({environment:t,blocks:[n],transaction:o,replaceEmptyTextBlock:!1})}}({environment:t,textSelectionData:f,transaction:i,disableEmbedMenu:o});else if(g&&g.blocks.length>0&&"inline"!==w)Vt(t,g,y,i);else if(M&&P){const{simpleTableStore:e,selection:o}=M.getProps(),r=me.g$.getColumnOrder(e);o&&r&&Je.j0({environment:t,simpleTableStore:e,selection:o,currentRows:e.getContentStores(),columnOrder:r,event:n,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})}else if(u)if(M){const{simpleTableStore:e,selection:o}=M.getProps(),r=me.g$.getColumnOrder(e);o&&r&&Je.j0({environment:t,simpleTableStore:e,selection:o,currentRows:e.getContentStores(),columnOrder:r,event:n,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})}else(I||b)&&"inline"!==w?zt({environment:t,html:u,transaction:i,tinyMceMicrosoftWordPasteFilter:s}):Nt({environment:t,html:u,transaction:i,stripText:!1,disableEmbedMenu:o,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});else jt({environment:t,text:d,disableEmbedMenu:o,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});else nn(t,d,i);ye.Z.setKeyboardMode(!0)}function nn(e,t,n){const o="editing"===we.default.state.mode&&we.default.state.multiSelection;o&&Ve.hJ({environment:e,multiSelection:o,string:t,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:n})}function on(e){const t=e.getNavigableBlockStore();if(t)return(0,te.Hu)({store:t,scrollToBlockId:t.id===e.id?void 0:e.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink})}function rn(e){const{environment:t,blocks:n}=e,o=n[0];We.wG(),me.HM.clearSelection();const i=on(o);if(i){dn({environment:t,stringValue:i,copiedMessage:o.isPageBlock()?ot.copiedLinkToClipboard:ot.copiedBlockLinkToClipboard})}}function an(e){const{environment:t,blocks:n}=e,o=n[0];We.wG(),me.HM.clearSelection();const i=on(o),r=function(e,t){var n;const o=on(t);if(!o)return;const i=e.currentUser.id,r=(0,f.Ho)({blockId:t.id,intl:ne.default.getIntl(),getRecordValue:t.inMemoryRecordCache.makeGetRecordValueFn(i),userTimeZone:(0,_.r)()}),a=null===(n=t.getBlockIconStore())||void 0===n?void 0:n.getValue(),s=[(0,k.Z)(a)?a:void 0,r].filter(q.$K).join(" ");return s?`<a href="${o}"><span>${s}</span></a>`:o}(t,o);if(i&&r){cn({environment:t,stringValue:i,htmlValue:r,copiedMessage:ot.copiedLinkToClipboard})}}function sn(e){const{environment:t,blocks:n}=e;if(n.length<2)return rn(e);We.wG(),me.HM.clearSelection();const o=n.map(on).filter(q.$K);if(o.some(Boolean)){const e=o.length>1?ot.copiedLinksToClipboard:ot.copiedLinkToClipboard;dn({environment:t,stringValue:o.join("\n\n"),copiedMessage:e})}}function ln(e){const{environment:t,blocks:n}=e,o=n[0];if(!o.isDefined())return;const i=o.getModel(),r=o.getProperties(),a=o.getFormat();let s;if(o.isType(l.Ti.bookmark))s=null==r?void 0:r.link,s=N.QaF(s);else if(i.isType(l.Ok))s=null==r?void 0:r.source,s=N.QaF(s);else if(o.isType(l.Ti.file))s=null==r?void 0:r.source,s=N.QaF(s);else if(o.isType(l.Ti.externalObjectInstance)||o.isType(l.Ti.externalObjectInstancePage))s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);else if(o.isType(l.Ti.collectionView)){var c;const e=null===(c=o.getCollectionViewCollectionStore())||void 0===c?void 0:c.getValue();var d;if(e&&(0,g.Gq)(e))s=null===(d=e.format)||void 0===d?void 0:d.original_url}else{if(!o.isType(l.Ti.alias))return;s=null==a?void 0:a.comment_alias_url}if(!s)return;if(h.E$(s,[Q.default.secureFileS3.url,Q.default.secureFileS3V2.url]))return void b.log({level:"error",from:"clipboardActions",type:"copyDirectLinkToContent",error:{message:"Attempted to copy a direct signed url for S3-housed content."}});if(s=H.yn(s),!s)return;We.wG(),me.HM.clearSelection();dn({environment:t,stringValue:s,copiedMessage:ot.copiedLinkToClipboard})}function cn(e){return un(e)}function dn(e){return un(e)}async function un(e){const{environment:t,htmlValue:n,stringValue:o,copiedMessage:i,showCopyModal:r}=e;function a(){Qe.ZH(t),ge.Z.setState({...ge.Z.state,active:!0,stringValue:o})}if(r)a();else try{if("undefined"==typeof ClipboardItem)await navigator.clipboard.writeText(o);else{const e={"text/plain":new Blob([o],{type:"text/plain"})};n&&(e["text/html"]=new Blob([n],{type:"text/html"}));const t=new ClipboardItem(e);await navigator.clipboard.write([t])}Ye.oV({label:ne.default.formatMessage(i)})}catch{a()}}function pn(){document.queryCommandSupported("copy")&&document.execCommand("copy")}async function mn(e,t){let n;n="string"==typeof t?t:JSON.stringify(t),n&&await dn({environment:e,stringValue:n,copiedMessage:ot.copiedToClipboard})}function fn(e){const{environment:t,textSelection:n,markdownSerializationOptions:o,markdownLinkifyIt:i}=e,r=(0,oe.QY)(n);if(r&&r.selection.startIndex!==r.selection.endIndex)return function(e){const{environment:t,singleStoreTextSelection:n,markdownSerializationOptions:o}=e,{store:i,selection:r}=n,a=t.currentUser.id,l=i.inMemoryRecordCache,c=ne.default.getIntl(),d=i.getValue(),p=N.KU1(d,r.startIndex,r.endIndex),m=i.getRecordStoreUIRoot().getValue();if(!m)return;const f={id:m.id,table:V.iU,spaceId:m.space_id},g=l.makeGetRecordValueFn(a);return C.CK({textValue:p,exportArgs:{root:f,navigableBlockId:f.id,renderParentBlockId:void 0,blockId:f.id,userTimeZone:(0,_.r)(),intl:c,getRecordValue:g,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,u.Z)({pageId:t,pageValue:g({table:V.iU,id:t}),baseUrl:Q.default.domainBaseUrl,pageVisitSource:s.tY.Export})},baseUrl:Q.default.domainBaseUrl,publicDomainName:Q.default.publicDomainName,transformAnnotation:null==o?void 0:o.transformAnnotation,transformBlockMapping:null==o?void 0:o.transformBlockMapping,resultCache:new Map}})}({environment:t,singleStoreTextSelection:r,markdownSerializationOptions:o});const a=Pt({environment:t,multiSelection:n,action:"copy"});if(!a)return;const l=n.start.store.inMemoryRecordCache,c=n.start.store.getRecordStoreUIRoot().getValue();if(!c)return;const d=t.currentUser.id,{markdown:p}=(0,X.Ef)({clipboardData:a,rootBlock:{id:c.id,table:V.iU,spaceId:c.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:l.makeGetRecordValueFn(d),markdownSerializationOptions:o,markdownLinkifyIt:i});return p}function gn(e){const{environment:t,inMemoryRecordCache:n,text:o,transaction:i,markdownOptions:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l,useCrdt:c}=e,d=Ct({markdown:o,markdownOptions:r,markdownLinkifyIt:s});if(!d)return;const u=document.createElement("div");u.innerHTML=Kt({html:d,tinyMceMicrosoftWordPasteFilter:l});const{currentUserStore:p,currentSpaceStore:m}=fe.default.state;if(!p||!m)return;const f=p.getValue();if(!f)return;const g=(J.RM()??m).id,{allOperations:h,rootContentIds:v}=S.$O({actor:(0,a.dp)(f),parentId:g,parentTable:"block",spaceId:m.id,rootNode:u,importFileMap:{},window,secureFileS3Url:Q.default.secureFileS3.url,secureFileS3UrlV2:Q.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:ne.default.getIntl(),randomID:R.ZP,randomShortID:D.ZP,isPhoneNumber:Gt,emojiData:Y.Z.state,useCrdt:c});for(const a of h){const e=new _e.ST({environment:t,pointer:a.pointer,inMemoryRecordCache:n,userId:f.id});Xe.applyOperation({store:e,operation:a,transaction:i})}return v.map((e=>new _e.G(t,{table:V.iU,id:e},{inMemoryRecordCache:n})))}function hn(e){const{environment:t,stores:n,listId:o,inMemoryRecordCache:i,transaction:r}=e,a=new _e.ST({environment:t,pointer:{table:V.iU,id:o||(0,R.ZP)()},inMemoryRecordCache:i,userId:t.currentUser.id,path:["content"]});for(const s of n)$.R3({parent:a,append:s,transaction:r}),Ge.sW({store:s,data:{parent_id:a.id,parent_table:a.table,alive:!0},transaction:r});return a}},42274:(e,t,n)=>{n.d(t,{Cn:()=>d,pZ:()=>c,E5:()=>l});const o={TypeScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),JavaScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),GraphQL:async()=>({plugins:[(await n.e(214).then(n.t.bind(n,80214,23))).default],parser:"graphql"}),HTML:async()=>({plugins:[(await n.e(2237).then(n.t.bind(n,72237,23))).default],parser:"html"}),CSS:async()=>({plugins:[(await n.e(5657).then(n.t.bind(n,45657,23))).default],parser:"css"}),Scss:async()=>({plugins:[(await n.e(5657).then(n.t.bind(n,45657,23))).default],parser:"scss"}),JSON:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"json"}),XML:async()=>({plugins:[await Promise.all([n.e(9236),n.e(4219)]).then(n.t.bind(n,84219,23))],parser:"xml",prettierOptionsOverride:{xmlWhitespaceSensitivity:"ignore"}}),Rust:async()=>({plugins:[await Promise.all([n.e(9236),n.e(3411)]).then(n.bind(n,73411))],parser:"jinx-rust"})};var i=n(70203),r=n(96802),a=n(9953),s=n(82530);function l(e){const{blocks:t,language:n,transaction:o}=e,r=i.TPx(n);for(const i of t)a.sW({store:i.getPropertiesStore(),data:{language:r},transaction:o})}function c(e){const{environment:t,blocks:n,previewFormat:o}=e;s.createAndCommit({userAction:"codeBlockActions.setPersistedCodePreviewFormat",environment:t,perform:e=>{r.FH({stores:n,update:{code_preview_format:o},transaction:e})}})}async function d(e){const{codeBlock:t,environment:r}=e,{title:l,language:c}=t.getProperties(),d=i.QaF(l);if(!d||0===d.length)return;const u=i.QaF(c),p=await async function(e){const{codeSnippet:t,language:i}=e,r=o[i];if(!r)return;const{parser:a,plugins:s,prettierOptionsOverride:l}=await r();let c="";try{c=(await n.e(3945).then(n.t.bind(n,73945,23))).format(t,{parser:a,plugins:s,...l})}finally{if(!c||c===t)return}return c=function(e){const t=e.split("\n");return t.length>0&&""===t[t.length-1].trim()&&t.pop(),t.join("\n")}(c),c}({codeSnippet:d,language:u});if(!p)return;const m=i.TPx(p);s.createAndCommit({userAction:"codeBlockActions.formatCode",environment:r,perform:e=>{a.sW({store:t.getPropertiesStore(),data:{title:m},transaction:e})}})}},74882:(e,t,n)=>{n.d(t,{K:()=>a});var o=n(68626),i=n(6287),r=n(54642);async function a(e){const{environment:t,collectionStore:n}=e,a={id:n.id,table:i.v,spaceId:n.getSpaceId()},s=await r.suggestRecordKey(t,{...a,shouldSetSuccessfullySuggestedRecord:!0});if("success"===s.type)return s.data.key;o.log({level:"error",from:"collectionAutoIncrementIdActions.suggestRecordKeyResponse",type:"JSONParseError",error:{miscDataString:s.error.message}})}},40778:(e,t,n)=>{n.d(t,{mO:()=>w,Ys:()=>k,k7:()=>I,ul:()=>M,iU:()=>x,RD:()=>T,_x:()=>C});n(67294);var o=n(1302),i=n(76205),r=n(14714),a=n(72126),s=n(97880),l=n(64964),c=n(480),d=n(9291),u=n(52423),p=n(6854),m=n(85893);function f(){return(0,m.jsx)(d.FormattedMessage,{defaultMessage:"Changes saved for everyone.",id:"database.filterBar.saved.title"})}function g(e){window.__c={n:"SaveChangesSnackbarUndoButton"};const{collectionContextStore:t,temporaryState:n}=e,o=(0,c.O7)();return(0,m.jsx)(p.Pn,{onClick:()=>{u.Yw(o,!0),l.rN(),x({environment:o,collectionContextStore:t,temporaryState:n})},children:(0,m.jsx)(d.FormattedMessage,{defaultMessage:"Undo",id:"database.filterBar.undo.title"})})}var h=n(97004),v=n(80444),b=n(5149),y=n(14900),_=n(82530),S=n(37181);let w=function(e){return e[e.All=0]="All",e[e.Filters=1]="Filters",e[e.Sorts=2]="Sorts",e}({});function k(e){const{environment:t,collectionContextStore:n,targetCollectionView:o,preventSnackbarNotification:i,type:r,transaction:a}=e,s=n.temporaryState.state,c=n.currentPropertyFiltersStore.state,d=o.getPropertyFiltersStore(),u=(0,h.Zh)(n,"persisted");if(r===w.All||r===w.Filters){u.combinatorFilter&&y.Es({collectionViewStore:o,update:{filter:u.combinatorFilter.value||null},transaction:a});for(const e of u.filters.removed)_.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListRemove",path:d.path,args:{remove:{id:e}}},transaction:a});for(const{id:e,beforeId:t}of u.filters.moveOps){const n=c.find((t=>t.id===e));n&&(t?_.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListBefore",path:d.path,args:{before:{id:t},value:n}},transaction:a}):_.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListAfter",path:d.path,args:{value:n}},transaction:a}))}for(const e of u.filters.updated){const t=c.find((t=>t.id===e));t&&_.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListUpdate",path:d.path,args:{value:t}},transaction:a})}}r!==w.All&&r!==w.Sorts||!u.sorts||y.Es({collectionViewStore:o,update:{sort:u.sorts.value||null},transaction:a}),C({environment:t,collectionContextStore:n,temporaryState:r===w.All?void 0:r===w.Filters?{...s,combinatorFilter:void 0,propertyFilters:void 0}:{...s,sorts:void 0}}),i||l.oV({label:(0,m.jsx)(f,{}),right:(0,m.jsx)(g,{collectionContextStore:n,temporaryState:s})})}function I(e){const{environment:t,intl:n,collectionContextStore:i,transaction:r}=e,a=i.collectionViewStore(),s=i.isFullScreen.state,l=i.isRootChild.state,c=i.isInPeekRenderer.state;if(!a)return;const d=y.tG({environment:t,collectionContextStore:i,collectionViewStore:a,intl:n,collectionSettingsStore:i.settingsStore,transaction:r});d&&(k({environment:t,type:w.All,collectionContextStore:i,targetCollectionView:d,transaction:r}),d&&(y.f8({environment:t,collectionContextStore:i,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),o.default.afterNextFlush((()=>{b.r$({collectionContextStore:i,collectionSettingsStore:i.settingsStore,selectViewNameInitial:!0})}))))}function x(e){C(e),function(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewStore();if(!o)return;n.blockIsPrivateStore.state&&n.permissionScopes.state.canConfigureBlock&&_.createAndCommit({userAction:"collectionFilterActions.applyTemporaryStateIfPrivate",environment:t,perform:e=>{k({environment:t,collectionContextStore:n,type:w.All,targetCollectionView:o,preventSnackbarNotification:!0,transaction:e})}})}(e)}function C(e){const{environment:t,collectionContextStore:n,temporaryState:o}=e,i=n.collectionViewStore();if(!i)return;const r=t.currentUser.id;n.temporaryState.setState(o||{}),y.bu({currentUserId:r,collectionViewId:i.id,temporaryState:o}),n.groupsStore.resetAllLimits()}function T(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=v.default.state;o&&_.createAndCommit({userAction:"collectionFilterActions.setSeenFiltersIntroTooltip",environment:t,perform:e=>{S.d2({userSettingsStore:o,transaction:e,data:{seen_filters_tooltip:n}})}})}function M(e){var t;let{transaction:n,newGroups:o,collectionContextStore:l,environment:c}=e;const d=l.collectionViewStore(),u=l.currentCombinatorFilterStore.state,p=(0,a.Xh)(u),m=null==p||null===(t=p.filters)||void 0===t?void 0:t.find(i.s9),f=(0,h.yU)(l);if(!(d&&p&&p.filters&&m))return;const g=m.filter.value.filter((e=>"exact"===e.type)).map((e=>e.value)).filter(s.$K),v=o.map((e=>e.value)).filter(r.tL).map((e=>e.value)).filter(r.RA).map((e=>e.id)),b=(0,a.zu)(v,...g);0!==b.length&&(m.filter.value=[...m.filter.value,...b.map((e=>({type:"exact",value:e})))],C({environment:c,collectionContextStore:l,temporaryState:{...l.temporaryState.state,combinatorFilter:{value:p}}}),f||k({environment:c,collectionContextStore:l,type:w.Filters,targetCollectionView:d,preventSnackbarNotification:!0,transaction:n}))}},49865:(e,t,n)=>{n.d(t,{$D:()=>ve,$T:()=>ne,A6:()=>de,BN:()=>ee,BO:()=>le,ID:()=>ke,IW:()=>ce,Od:()=>te,V$:()=>ye,by:()=>re,hz:()=>ue,iE:()=>pe,mp:()=>oe,o3:()=>he,tH:()=>we,tQ:()=>ae,uo:()=>_e,w$:()=>Se,yk:()=>me});n(57658);var o=n(15145),i=n(92996),r=n(41432),a=n(14248),s=n(14714),l=n(99036),c=n(93824),d=n(43593),u=n(42875),p=n(15157),m=n(72126),f=n(21202),g=n(6287),h=n(23867),v=n(70203),b=n(95371),y=n(97880),_=n(9291),S=n(28020),w=n(97004),k=n(75079),I=n(92918),x=n(52821),C=n(78316),T=n(77181),M=n(33929),P=n(18245),A=n(80444),R=n(55367),D=n(26136),B=n(8406),E=n(54642),F=n(40778),Z=n(98834),V=n(14900),j=n(30188),U=n(47307),L=n(42239),O=n(31781),N=n(96802),z=n(94419),W=n(19785),q=n(9953),H=n(79978),K=n(26999),G=n(42858),$=n(24677),Q=n(82530),Y=n(27370),J=n(37181);const X=(0,_.defineMessages)({removeSortingConfirmation:{id:"databaseActions.removeSortingConfirmationDialog.prompt",defaultMessage:"Would you like to remove sorting?"},removeSortingButton:{id:"databaseActions.removeSortingConfirmationDialog.removeSortingButton.label",defaultMessage:"Remove"},removeSortingCancel:{id:"databaseActions.removeSortingConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"Don't remove"}});function ee(e){const{store:t,groupsPointer:n,environment:o,collectionContextStore:i,transaction:r}=e;if(!t.isDefined())return;const s=i.normalizedSchemaStore.state,l=i.relativeVariableStore.state,c=new Map;for(const d of n){const e=a.ND({block:t.getModel(),schema:s,propertyMapping:void 0,userFilterContext:{userId:o.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:S.AK.state},group:d,getRecordModel:t.getRecordModel,intl:M.default.getIntl(),relativeVariableResult:l,resultCache:c});Object.keys(e).length>0&&q.sW({store:t.getPropertiesStore(),data:e,transaction:r})}}function te(e){const{store:t,transaction:n}=e;W.hh({childStore:t,transaction:n})}function ne(e){var t,n;const{environment:o,collectionContextStore:i,before:r,insertStores:a,store:s,groupsPointer:l,transaction:c,collectionStore:d}=e,u=i.collectionViewStore(),p=(null===(t=i.groupsStore.getGroupState(l))||void 0===t?void 0:t.resultsStore.state)||[],m=null===(n=i.groupsStore.getGroupState(l))||void 0===n?void 0:n.groupUiParentStore;if(!m)return[];const g=[];for(const y of a)oe({environment:o,store:y,collectionStore:d,collectionContextStore:i,groupsPointer:l,shouldCoerce:!0,transaction:c}),g.push(D.G.createChildStore(m,{table:f.iU,id:y.id}));const h=p.indexOf(s),v=r?h:h+1,b=[...p.slice(0,v),...g,...p.slice(v)];return u&&ie({resultIds:b.map((e=>e.id)),collectionViewStore:u,collectionContextStore:i,transaction:c}),i.groupsStore.setLimitIfGreater(l,b.length),g}function oe(e){var t;const{environment:n,store:o,collectionStore:i,collectionContextStore:s,groupsPointer:c,transaction:d,shouldCoerce:p,alreadyMovedToCollection:f}=e,g=i.getSchema(),h=i.getParentBlockStore(),v=h&&h.isLocked();let b=!p;const y=(null==s||null===(t=s.groupsStore.getGroupState(c))||void 0===t?void 0:t.resultsStore.state)||[];if(o.isDefined()){var _,k;const e=f?(0,l.Kc)(M.default.getIntl()):o.getSchema()||{},t=null===(_=o.getAssociatedCollectionStore())||void 0===_?void 0:_.getDatabaseType(),r=i.getDatabaseType(),s=void 0!==t&&t===r,c=a.Xq({blockProperties:o.getProperties(),oldSchema:e,oldPropertyMapping:null===(k=o.getAssociatedCollectionStore())||void 0===k?void 0:k.getPropertyMapping(),newPropertyMapping:i.getPropertyMapping(),newSchema:g,typesMatch:s});c.propertyUpdate&&Object.keys(c.propertyUpdate).length>0&&q.sW({store:o.getPropertiesStore(),data:c.propertyUpdate,transaction:d}),m.Xy(g,c.newSchema)||v||!C.eD({collectionStore:i,collectionViewBlockStore:h,checkNavigableAncestorLocked:!1})||V.Rm({environment:n,collectionStore:i,update:{schema:c.newSchema},transaction:d})}if(o.getType()===r.Ti.page||o.getType()===r.Ti.collectionViewPage&&o.isAssociatedCollectionAPageTree()||i.isPageTreeCollection()||o.getType()===r.Ti.copyIndicator||o.getType()===r.Ti.externalObjectInstancePage||q.sW({store:o,data:{type:r.Ti.page},transaction:d}),s){if(s.collectionViewStore()){const e=o.getModel(),t=s.relativeVariableStore.state,r=(0,w.ze)(s);if(e&&p){const l=o.getAssociatedCollectionStore(),p="collectionTypedView"===s.contextType&&l?l.getSchema():s.normalizedSchemaStore.state,m=a.RA({block:e,schema:p,propertyMapping:i.getPropertyMapping(),filter:r,userFilterContext:{userId:n.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:S.AK.state},relativeVariableResult:t,groupsPointer:c,getRecordModel:i.getRecordModel,intl:M.default.getIntl(),resultCache:new Map}),f=m.update;Object.keys(f).length>0&&q.sW({store:o.getPropertiesStore(),data:f,transaction:d}),b=m.coercionSucceeded}}}const I="collectionTypedView"===(null==s?void 0:s.contextType)&&C.fm(o)===s;if(f||I?Q.applyOperation({store:o,operation:{pointer:o.pointer,path:["alive"],command:"set",args:!0},transaction:d}):W.zw({childStore:o,parentStore:i,transaction:d}),s&&s.resultSet.addLocalChange([o.id]),s){var x;const e=null===(x=s.groupsStore.getGroupState(c))||void 0===x?void 0:x.currentLimit;if(e){const t=e.state,n=y.find((e=>e.id===o.id));y.length>=t&&!n&&e.setState(y.length+1)}}return b}function ie(e){const{resultIds:t,collectionViewStore:n,collectionContextStore:o,transaction:i}=e,r=n.getPageSortStore(),a=r.getValue()||[],{beforeOps:s}=(0,c.q)(a,t.slice(0,l.gq));for(const[l,c]of Object.entries(s))if(c){const e=(0,D.Kv)(n,{table:f.iU,id:c});z.Vt({parent:r,insert:(0,D.Kv)(n,{table:f.iU,id:l}),before:e,transaction:i})}else{const e=t.findIndex((e=>e===l)),o=t[e-1],a=o?(0,D.Kv)(n,{table:f.iU,id:o}):void 0;z.BE({parent:r,insert:(0,D.Kv)(n,{table:f.iU,id:l}),after:a,transaction:i})}!function(e){const{collectionContextStore:t,collectionViewStore:n,transaction:o}=e,i=n.getPageSortStore(),r=i.getValue(),a=t.groupsStore.getAllGroupStates(),s=new Set(a.flatMap((e=>e.resultsStore.state.map((e=>e.id))))),c=function(e){const{pageSort:t,currentResults:n}=e;if(!t||t.length<=l.gq)return[];const o=t.filter((e=>!n.has(e)));return m.jj([...o.reverse(),...m.d9(t).reverse()]).slice(0,t.length-l.gq)}({pageSort:r,currentResults:s});for(const l of c)z.Od({parent:i,childToRemove:(0,D.Kv)(i,{table:f.iU,id:l}),transaction:o})}({collectionContextStore:o,collectionViewStore:n,transaction:i})}function re(e){var t,n,o;const{environment:r,collectionStore:a,targetStore:s,droppedDirection:c,droppedStores:d,transaction:u,duplicate:p,collectionContextStore:h,groupsPointer:v,subitemPath:y}=e,_=h.collectionViewStore();if(!_)return;if(!(null===(t=h.groupsStore.getGroupState(v))||void 0===t?void 0:t.groupUiParentStore))return;const S=(null===(n=h.groupsStore.getGroupState(v))||void 0===n?void 0:n.resultsStore.state)||[],w=d.every((e=>e.isExternalObjectInstancePageBlockStore()))&&!(a.isSyncedCollection()&&(null===(o=d[0])||void 0===o?void 0:o.getParentId())===(null==a?void 0:a.id))||p;if(c===R.vh.Onto){$.ZH(r);const e=s.getContentStore(),t=L.LQ({environment:r,droppedStores:d,duplicate:w,duplicateUseCrdt:s.useCrdt(),transaction:u,resolveTemplateVariables:!1});for(const n of t)z.R3({parent:e,append:n,transaction:u});return[]}let k=!1,I=[];if(!w){const e=function(e){const{environment:t,droppedStores:n,collectionStore:o,transaction:i}=e,r=he({environment:t,stores:n,collectionStore:o,transaction:i});for(const a of r){if(a.getParentTable()===g.v||a.getAssociatedCollectionStore())return;if(!W.zw({childStore:a,parentStore:o,transaction:i}))return}return r}({environment:r,droppedStores:d,collectionStore:a,transaction:u});k=void 0!==e,I=e??[]}const x=L.LQ({environment:r,droppedStores:d,duplicate:w,duplicateUseCrdt:!1,transaction:u,resolveTemplateVariables:!1});k||(I=he({environment:r,stores:x,transaction:u,collectionStore:a})),u.postSubmitCallbacks.push((async e=>{e||await j.YE({droppedStores:d,createdStores:x,collectionStore:a,environment:r,collectionContextStore:h,groupsPointer:v,alreadyMovedToCollection:k,shouldDuplicate:w})}));for(const i of I)oe({environment:r,store:i,collectionStore:a,collectionContextStore:h,groupsPointer:v,shouldCoerce:!0,transaction:u,alreadyMovedToCollection:k});const C=(0,T.Af)([...(null==y?void 0:y.map((e=>e.value.store.pointer)))??[]]),M=h.subitemExpandedStore.state.get(C),P=y&&y.length>1||(null==M?void 0:M.isExpanded)&&c===R.vh.Below;!function(e){var t;const{environment:n,isInsertingAsSubitem:o,shouldDuplicate:i,collectionContextStore:r,collectionStore:a,droppedStores:s,wrappedStores:c,targetSubitemExpandedState:d,subitemPath:u,targetStore:p,transaction:m}=e,f=r.currentSubitemFormatStore.state,g=null==f?void 0:f.inverse,h=g&&r.normalizedSchemaStore.state[g],v=null==f?void 0:f.property,y=v&&r.normalizedSchemaStore.state[v],_=null===(t=r.collectionViewStore())||void 0===t?void 0:t.getType(),S=f&&_&&(0,T.Av)(_)&&h&&(0,l.p_)(h),w=(0,T.g0)(s[0]);null!=w&&w.subitemFormat&&f&&y&&(0,l.p_)(y)&&j.i6({blocksToDuplicate:[...s],duplicatedBlocks:[...c],environment:n,shouldDuplicate:i,originSubitemFormat:w.subitemFormat,destinationSubitemFormat:f,transaction:m,subitemRelationSchema:y,relationPropertyCollectionId:a.id});const k=f?(0,T.Kg)(c,f):void 0,I=k?c.filter(((e,t)=>k.includes(t))):[];for(const l of I){if(S){const e=(0,T.xb)({store:l,subitemFormat:f,propertySchema:h});for(const t of e){const e=D.G.createChildStore(l,t);H.Bl({environment:n,sourceStore:e,destStore:l,propertyWithInverse:f,transaction:m})}}if(o){const e=null!=d&&d.isExpanded?"into":"below";fe({environment:n,collectionContextStore:r,collectionStore:a,subitemPath:u&&(null==u?void 0:u.length)>0?u:[new b.mp((0,T.SM)(p),[])],store:p,before:"into"===e,insertBlock:l,insertDirection:e,transaction:m})}}}({environment:r,isInsertingAsSubitem:Boolean(P),shouldDuplicate:w,collectionContextStore:h,collectionStore:a,droppedStores:d,wrappedStores:I,targetSubitemExpandedState:M,subitemPath:y,targetStore:s,transaction:u});const B=S.filter((e=>!x.includes(e))),E=B.indexOf(s),F=c===R.vh.Above||c===R.vh.Left?E:E+1;ie({resultIds:[...B.slice(0,F),...I,...B.slice(F)].map((e=>e.id)),collectionViewStore:_,collectionContextStore:h,transaction:u}),se({environment:r,collectionContextStore:h});const Z=h.collectionViewBlockStore();if(!Z)return;const V=P?s:Z,U=m.UI(I,(e=>D.G.createChildStore(V,{table:f.iU,id:e.id})));return $.Z5({environment:r,stores:U}),function(e,t){var n,o;(null===(n=e.collectionViewStore())||void 0===n?void 0:n.getFormat().app_config_uri)===i.g3&&"sprint_board"===(null===(o=A.default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.getFormat().special_page_for_pm_launch)&&Y.tutorialAdvanceToStepAfter(t,"sprints-onboarding","sprint-task-tooltip")}(h,u),U}function ae(e){const{environment:t,collectionStore:n,targetStore:o,droppedDirection:i,files:r,transaction:a,collectionContextStore:s,groupsPointer:l}=e,c=s.collectionViewStore(),u=S.qQ(t);if(!c)return;const p=n.inMemoryRecordCache,m=O.z({environment:t,files:r,inMemoryRecordCache:p,pageWidth:u,transaction:a,spaceId:n.pointer.spaceId,useCrdt:!1}).map(((e,o)=>{const i=r[o],s=q.j4({environment:t,type:"page",inMemoryRecordCache:p,properties:{title:(0,v.TPx)(d.AA(i.name))},transaction:a,spaceId:n.pointer.spaceId,useCrdt:!1});return z.R3({parent:s.getContentStore(),append:e,transaction:a}),s}));re({environment:t,collectionStore:n,targetStore:o,droppedDirection:i,collectionContextStore:s,groupsPointer:l,droppedStores:m,duplicate:!1,transaction:a})}function se(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewBlockStore(),i=n.collectionViewStore();if(!i||!o)return!1;const r=n.currentViewHasSort(),a=i.getType(),s=n.permissionScopes.state;return!!(r&&a&&x.Km[a]&&s.canConfigureBlock)&&(U.showDialog({message:M.default.formatMessage(X.removeSortingConfirmation),items:[{label:M.default.formatMessage(X.removeSortingButton),color:"red",onAccept:()=>{Q.createAndCommit({userAction:"collectionGroupActions.offerToRemoveSort",environment:t,perform:e=>{V.Es({collectionViewStore:i,update:{sort:[]},transaction:e})}})}},{label:M.default.formatMessage(X.removeSortingCancel),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}function le(e){const{environment:t,droppedStores:n,duplicate:o,collectionContextStore:i,groupsPointer:r,transaction:a}=e,s=i.collectionStore(),l=i.collectionViewStore(),c=L.LQ({environment:t,droppedStores:n,duplicate:o,duplicateUseCrdt:!1,transaction:a,resolveTemplateVariables:!1});if(s)for(const d of c)oe({environment:t,store:d,collectionStore:s,collectionContextStore:i,groupsPointer:r,shouldCoerce:!0,transaction:a});return l&&ie({resultIds:c.map((e=>e.id)),collectionViewStore:l,collectionContextStore:i,transaction:a}),[]}function ce(e){var t,n,o;const{environment:i,collectionContextStore:a,groupsPointer:s,insertAtIndex:l,shouldCoerce:c,initializeDefaultTemplate:d,transaction:u,from:p,tracker:m,useCrdt:g}=e,h=P.default.mark("collections.add_item_lag");P.default.measureAfterNextFlush(h,{environment:i,getData:()=>({...k.vS(a),from:p})});const v=null===(t=A.default.state.currentSpaceStore)||void 0===t?void 0:t.id,b=q.j4({environment:i,type:r.Ti.page,inMemoryRecordCache:i.defaultRecordCache.inMemoryRecordCache,transaction:u,spaceId:v,tracker:m,useCrdt:g??!1}),y=a.collectionStoresStore.state,_=a.databaseType,S="collectionTypedView"===a.contextType,w=y.length?y[0]:void 0,I=A.default.state.currentUserSettingsStore;!S&&_&&w&&J.zq({transaction:u,dbType:_,collectionId:w.id});const x=S&&_&&v&&I?I.getPreferredCollections(v,_)[0]:void 0,C=(x?y.find((e=>e.id===x)):void 0)??w,T=a.collectionViewStore(),M=a.getViewType();if(!C||!T||!M)return{coercionSucceeded:!0,newStore:b};const R=null===(n=a.groupsStore.getGroupState(s))||void 0===n?void 0:n.groupUiParentStore;if(!R)return{coercionSucceeded:!0,newStore:b};const B=D.G.createChildStore(R,{table:f.iU,id:b.id});if(d){const e=a.defaultPageTemplateStore.state;e&&Z.ob({title:"template",environment:i,store:b,templateStore:e,isKeyboard:!1,isCreateIn:!1,transaction:u,from:"collection_group_actions"})}const E=oe({environment:i,store:b,collectionStore:C,collectionContextStore:a,groupsPointer:s,shouldCoerce:c,transaction:u}),F=(null===(o=a.groupsStore.getGroupState(s))||void 0===o||null===(o=o.reducerResultStore.state)||void 0===o?void 0:o.blockIds)||[],V=void 0!==l?l:F.length;if(a.permissionScopes.state.canEditContent){ie({resultIds:[...F.slice(0,V),B.id,...F.slice(V)],collectionViewStore:T,collectionContextStore:a,transaction:u})}return{coercionSucceeded:E,newStore:B}}function de(e){const{collectionContextStore:t,newGroups:n,groupsFormatKey:o,transaction:i}=e,r=t.collectionViewStore();r&&N.FH({stores:[r],update:{[o]:n},transaction:i})}function ue(e){const{environment:t,collectionStore:n,property:o,oldValue:i,newValue:r,transaction:s}=e,l=n.getSchema(),c=t.currentUser.id;n.inMemoryRecordCache.forEachRecord(c,(e=>{var t;let{model:c}=e;if(c.table!==f.iU)return;const d=D.G.createChildStore(n,{table:f.iU,id:c.id});if(d.canEdit()&&(null===(t=d.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===n.id){const e=a.hz({block:c,schema:l,property:o,oldValue:i,newValue:r});if(Object.keys(e).length>0){const t=d.getPropertiesStore();q.sW({store:t,data:e,transaction:s})}}})),n.isDefaultRecordCache()&&s.postSubmitCallbacks.push((async e=>{const a=n.pointer,{value:s}=await E.renameGroup(t,{collection:{id:a.id,spaceId:(0,h.C)(a.spaceId)},property:o,oldValue:i,newValue:r}).next();if(s.error)throw s.error}))}function pe(e){const{environment:t,collectionStore:n,groupsFormatKey:o,property:i,groupFormat:r,currentGroups:c,collectionContextStore:d,transaction:p,intl:m}=e,g=n.getSchema(),v=g[r.property];de({collectionContextStore:d,newGroups:c.filter((e=>!(0,s.we)(r.value,e.value))),groupsFormatKey:o,transaction:p});const b=r.value;if(v&&(0,l.cu)(v)&&b.type===v.type&&n){const e=(v.options||[]).filter((e=>e.value!==b.value)),o={...v,options:e},i={...g,[r.property]:o};V.Rm({environment:t,collectionStore:n,update:{schema:i},transaction:p})}const y=t.currentUser.id,_=new Map;n.inMemoryRecordCache.forEachRecord(y,(async e=>{let{model:o}=e;if(o.table!==f.iU)return;const r=D.G.createChildStore(n,o.pointer);if(a.wg({block:o,schema:g,property:i,value:b,intl:m,timeZone:(0,u.r)(),getRecordModel:n.getRecordModel,resultCache:_}))if(o.parent_id===n.id)W.hh({childStore:r,transaction:p});else{const e=r.getAssociatedCollectionStore();e&&e.id===n.id&&("page"===r.getType()||"collection_view_page"===r.getType()&&!r.isCollectionViewPageWithContent())&&await G.Qw({environment:t,blocks:[r]})}})),n.isDefaultRecordCache()&&p.postSubmitCallbacks.push((async e=>{const o=await E.deleteGroup(t,{collection:{id:n.id,spaceId:(0,h.C)(n.pointer.spaceId)},property:i,value:b}).next();if(o.value.error)throw o.value.error}))}function me(e){const{environment:t,collectionContextStore:n,before:i,store:a,groupsPointer:s,collectionStore:l,transaction:c,subitemPath:d,subitemInsertDirection:u}=e,p=n.collectionViewStore();if(!p)return;const m=n.groupsStore.getGroupState(s),g=null==m?void 0:m.groupUiParentStore,h=(null==m?void 0:m.resultsStore.state)||[];if(!g)return;const v=q.j4({environment:t,type:r.Ti.page,inMemoryRecordCache:a.inMemoryRecordCache,transaction:c,spaceId:p.pointer.spaceId,useCrdt:!1}),b=oe({environment:t,store:v,collectionStore:l,collectionContextStore:n,groupsPointer:s,shouldCoerce:!0,transaction:c}),y=n.defaultPageTemplateStore.state;y&&Z.ob({title:"template",environment:t,store:v,templateStore:y,isKeyboard:!1,isCreateIn:!1,transaction:c,from:"collection_group_actions"});const _=D.G.createChildStore(g,{table:f.iU,id:v.id});d&&d.length>0&&fe({environment:t,collectionContextStore:n,subitemPath:d,collectionStore:l,store:a,before:!1,insertBlock:_,insertDirection:u,transaction:c});const S=h.indexOf(a),w=i?S:S+1;if(ie({resultIds:[...h.slice(0,w),_,...h.slice(w)].map((e=>e.id)),collectionViewStore:p,collectionContextStore:n,transaction:c}),b){if(d){var k;const e="into"===u?a:null===(k=d[d.length-2])||void 0===k?void 0:k.value.store;return e?D.G.createChildStore(e,_.pointer):_}return $.Ys({environment:t,store:_}),se({environment:t,collectionContextStore:n}),_}K.CH({environment:t,store:_,peekMode:C.kr(p),resultsStore:null==m?void 0:m.resultsStore,collectionContextStore:n,pageVisitSource:o.tY.Create})}function fe(e){const{environment:t,collectionContextStore:n,subitemPath:o,collectionStore:i,store:r,before:a,insertBlock:s,insertDirection:l,transaction:c}=e,d=n.currentSubitemFormatStore.state;if(!d)return;const u=i.getSchema()[d.property];if(!u||"relation"!==u.type)return;if("into"===l){var p;const e=o[o.length-1],n=e.value.store;return void H.hE({environment:t,sourceStore:n,destStore:s,position:a?{type:"before",before:null===(p=e.children[0])||void 0===p?void 0:p.value.store.id}:{type:"after"},propertyWithInverse:d,transaction:c})}const m=o[o.length-2];if(!m)return;const f=m.value.store;H.hE({environment:t,sourceStore:f,destStore:s,propertyWithInverse:d,position:a?{type:"before",before:r.id}:{type:"after",after:r.id},transaction:c})}function ge(e){const{environment:t,collectionContextStore:n,groupFormat:o,newGroupFormat:i,groupsFormatKey:r,currentGroups:a,transaction:l}=e,c=n.collectionStore();!(0,s.we)(o.value,i.value)&&c&&ue({environment:t,collectionStore:c,property:o.property,oldValue:o.value,newValue:i.value,transaction:l});de({collectionContextStore:n,newGroups:a.map((e=>(0,s.we)(o.value,e.value)?i:e)),groupsFormatKey:r,transaction:l})}function he(e){const{environment:t,stores:n,transaction:o,collectionStore:i}=e;return n.map((e=>{const n=e.getType();if(n&&(r.Ok[n]||n===r.Ti.file||n===r.Ti.externalObjectInstance)){const n=q.j4({environment:t,type:"page",inMemoryRecordCache:e.inMemoryRecordCache,transaction:o,spaceId:i.pointer.spaceId,useCrdt:!1});return W.jG({parentStore:n,childStore:e,transaction:o}),n}return e}))}function ve(e){const{environment:t,format:n,groupsFormatKey:o,collectionContextStore:i,currentGroups:r}=e,a=n[o]||[];if(!i.permissionScopes.state.canConfigureBlock)return;if(0===r.length)return;const s=r.slice(0,I.XD),l=a.slice(0,I.XD);m.Xy(s,l)||Q.createAndCommit({userAction:"collectionGroupActions.persistFormatGroups",environment:t,canUndo:!1,perform:e=>{de({collectionContextStore:i,newGroups:r,groupsFormatKey:o,transaction:e})}})}function be(e,t){return`group-${e}-${(0,s.mD)(t)}`}function ye(e){const{environment:t,groupFormat:n,collectionContextStore:o}=e,i=o.collectionViewStore();if(!i)return;const r=o.groupsStore.getGroupState(n);if(!r)return;const a=p.Z.get({userId:t.currentUser.id,key:be(i.id,n)});r.toggleStateStore.setState(a??!0)}function _e(e){const{environment:t,groupFormat:n,toggleStateStore:o,newValue:i,collectionContextStore:r}=e,a=r.collectionViewStore();a&&(o.setState(i),p.Z.set({userId:t.currentUser.id,key:be(a.id,n),value:i}))}function Se(e){const{newGroupValue:t,groupFormat:n,schema:o,collectionContextStore:i,currentGroups:r,groupsFormatKey:a,collectionStore:c,environment:d}=e,u=o[n.property];if(!u)return;if(!(0,s.LG)(u))return;const p=n.value;if((0,l.cu)(u)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(void 0===t.value)return;const e=u.options||[],s=t.value,l=e.map((e=>e.value===p.value?{...e,value:s}:e)),m={...u,options:l},f={...o,[n.property]:m},g={...n,value:{...p,value:s}};Q.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:e=>{ge({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:g,currentGroups:r,transaction:e,groupsFormatKey:a}),V.Rm({environment:d,collectionStore:c,update:{schema:f},transaction:e})}})}else if("person"!==u.type)if((0,s.HB)(u.type)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(!t.value||"exact"!==t.value.type)return;const e={...n,value:t};Q.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{ge({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:e,currentGroups:r,groupsFormatKey:a,transaction:t})}})}else"status"===u.type||(0,s.A1)(u.type)||"created_by"===u.type||"last_edited_by"===u.type||"number"===u.type||"checkbox"===u.type||"formula"===u.type||"relation"===u.type||"location"===u.type||(0,y.t1)(u.type);else{if(p.type!==u.type)return;if(t.type!==u.type)return;const e={...n,value:t};Q.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{ge({environment:d,collectionContextStore:i,groupFormat:n,newGroupFormat:e,currentGroups:r,groupsFormatKey:a,transaction:t})}})}}async function we(e){const{update:t,collectionContextStore:n,groupsFormatKey:o,collectionStore:i,environment:a,schema:s,groupBy:c}=e,d=s[c.property];if(!d)return;const u="relation"===d.type&&(0,l.F0)(d),p=u&&new D.NW(a,{table:g.v,id:u});p&&await p.load(),Q.createAndCommit({userAction:"collectionGroupActions.handleCollectionAddGroupButtonAccept",environment:a,perform:e=>{if(t.newGroups&&(de({collectionContextStore:n,newGroups:t.newGroups,groupsFormatKey:o,transaction:e}),F.ul({transaction:e,newGroups:t.newGroups,collectionContextStore:n,environment:a})),t.newSchema&&V.Rm({environment:a,collectionStore:i,update:{schema:t.newSchema},transaction:e}),t.newPage&&"relation"===d.type&&p){const n=(0,v.TPx)(t.newPage.name),o={id:t.newPage.id,version:0,type:r.Ti.page,parent_id:u,parent_table:g.v,alive:!0,properties:{title:n},collection_id:void 0,space_id:t.newPage.spaceId},s=q.ae({environment:a,table:f.iU,value:o,inMemoryRecordCache:i.inMemoryRecordCache,transaction:e}),l=p.getDefaultTemplatePageStore();l&&Z.ob({title:{text:n},environment:a,store:D.G.createChildStore(p,s.pointer),templateStore:l,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"collection_group_actions"})}}})}function ke(e){const{collectionContextStore:t,environment:n,incrementLimitArgs:o}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetails.setState({type:"load_more_blocks",group:o.groupsPointer}),B.bn(n)}},16956:(e,t,n)=>{n.d(t,{Bv:()=>D,E2:()=>j,G3:()=>P,LC:()=>A,OK:()=>B,TI:()=>Z,bL:()=>R,er:()=>E,fH:()=>F,yV:()=>V});n(57658),n(67294);var o=n(46283),i=n(99036),r=n(95200),a=n(71644),s=n(6287),l=n(97880),c=n(82990),d=n(9291),u=n(91851),p=n(76798),m=n(52821),f=n(78316),g=n(33929),h=n(29376),v=n(85526),b=n(26136),y=n(8406),_=n(31869),S=n(5149),w=n(87085),k=n(14900),I=n(47307),x=n(96802),C=n(82530),T=n(29919),M=n(85893);function P(e){const{environment:t,collectionViewArgs:n,collectionStore:s,propertyName:c,propertyType:d,transaction:u}=e,p={},f=s.getSchema(),h=Object.keys(f),v=(0,r.Z)(c??m.SO[d],(e=>!h.find((t=>{const n=f[t];return Boolean(n&&n.name===e)})))),b=(0,a.ZP)();let y;const _=(0,m.k4)();if((0,i.XU)(d))switch(d){case"ai_custom_prompt":y={name:v,type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:_}};break;case"ai_summary":y={name:v,type:"text",ai_inference:{type:"summarize",auto_update_on_edit:_}};break;case"ai_extract":y={name:v,type:"text",ai_inference:{type:"extract",prompt:"",auto_update_on_edit:_}};break;case"ai_translate":y={name:v,type:"text",ai_inference:{type:"translate",targetProperties:["title"],toLanguage:"english",auto_update_on_edit:_}};break;default:(0,l.t1)(d)}else y={name:v,type:d};if(p[b]=y,i.iE(y)&&(h.includes(o.k.Owner)||(p[o.k.Owner]={name:g.default.formatMessage(T.Zi.ownerPropertyName),type:"person",default:"created_by"}),y.verifier_property=o.k.Owner),n){const{format:e,formatKey:t,collectionViewStore:o}=n,i=[...e[t]||[],{property:b,visible:!0}];x.FH({stores:[o],update:{[t]:i},transaction:u})}return k.xO({environment:t,collectionStore:s,update:p,transaction:u}),b}function A(e){const{environment:t,collectionStore:n,property:o,type:r,transaction:a}=e,s=n.getSchema()[o];if(!s||s.type===r)return;const l={...s};l.type=(0,i.TN)(r),k.xO({environment:t,collectionStore:n,update:{[o]:l},transaction:a})}function R(e){const{collectionStore:t,property:n,autoRelate:o,transaction:i}=e;t.getSchema()[n]&&C.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"autoRelate"],command:"set",args:o},transaction:i})}function D(e){const{collectionStore:t,property:n,name:o,transaction:i}=e;t.getSchema()[n]&&C.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"name"],command:"set",args:o},transaction:i})}function B(e){const{collectionStore:t,property:n,icon:o,transaction:i}=e;t.getSchema()[n]&&C.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"icon"],command:"set",args:o},transaction:i})}function E(e){const{formatStore:t,formatKey:n,property:o,update:i,transaction:r}=e,a=[...t.getFormat()[n]||[]],s=a.findIndex((e=>e.property===o));-1!==s?a[s]={...a[s],...i}:a.push({property:o,...i}),x.FH({stores:[t],update:{[n]:a},transaction:r})}function F(e){const{collectionContextStore:t,collectionStore:n,environment:o,isInPeekRenderer:r,onCloseMenu:a}=e,s=t.settingsStore;S.H4({collectionSettingsStore:s,item:{type:"propertyType",onAccept:(e,l)=>{if("relation"===e)return void S.H4({collectionSettingsStore:s,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});const{performResult:c}=C.createAndCommit({userAction:"PageProperties.handleAddPropertyClick",environment:o,perform:t=>P({environment:o,collectionStore:n,collectionViewArgs:void 0,propertyType:e,propertyName:l,transaction:t})});null==a||a(),S.FK({collectionSettingsStore:s,item:{type:"property",formatKey:"collection_page_properties",property:c,selectNameInitial:!o.device.isMobile}}),v.Z.setState({...v.Z.state,openProperty:{property:c,isInPeekRenderer:r},forceShowProperties:!0}),(0,i.XU)(e)&&w.K7({propertyType:e,propertyId:c,collectionContextStore:t}),y._H({environment:o,collectionContextStore:t,from:"page_properties",property_type:(0,i.TN)(e)})},propertyTypes:(0,m.TP)({isSyncedCollection:n.isSyncedCollection(),collectionContextStore:t,environment:o})}})}async function Z(e){const{environment:t,collectionContextStore:n,property:o,handleDeleteAccept:i}=e,r=n.collectionStore();if(!r)return;if(r.isTypedProperty(o)){if(await u.w0({environment:t,property:o,collectionContextStore:n,theme:e.theme,from:e.from}))return}const a=n.normalizedSchemaStore.state,s=a[o],l=h.ny(n,s);await(null==l?void 0:l.load());const m=l&&h.OP(n,o,l),f=l&&h.gZ(l),g=l&&r.id===l.id,v=[{label:(0,M.jsx)(d.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:i}];let b;if(m&&r&&f&&!g&&v.push({label:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{C.createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,perform:e=>{if(s&&"relation"===s.type&&s.property&&l){const n=s.property,o=l.getSchema();_.q0({environment:t,collectionStore:l,propertySchema:o[n],property:n,targetPropertyID:void 0,autoRelate:r.isSyncedCollection()&&!l.isSyncedCollection()?{enabled:!1}:s.autoRelate,transaction:e})}_.kQ({environment:t,collectionStore:r,property:o,transaction:e})}})}}),"auto_increment_id"===(null==s?void 0:s.type))b=h.pR(a)?(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==s?void 0:s.type)){const e=h.Pi(a);if(e){const t=e.connectedRelation.automation;t&&t[o]&&(b=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else l&&f&&!g&&m&&(b=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,M.jsx)(p.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},store:l})}}));I.showDialog({message:(0,M.jsx)("span",{children:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property for everyone on {databaseName}?",values:{databaseName:(0,M.jsx)(p.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},shouldWrap:!0,store:r})}})}),description:b,showCancel:!0,keepFocus:!0,items:v,mode:"wide"})}async function V(e){const{environment:t,collectionStore:n,schema:o,property:r,transaction:a}=e,s=o[r];if(s)if("relation"===s.type&&i.F0(s)&&s.property&&i.F0(s)!==n.id){const e=new b.NW(t,i.j0(s));await e.load(),j({environment:t,collectionStore:n,schema:o,property:r,transaction:a,targetCollectionStore:e})}else j({environment:t,collectionStore:n,schema:o,property:r,transaction:a})}function j(e){const{environment:t,collectionStore:n,schema:o,property:i,transaction:r,targetCollectionStore:a,permanentlyDelete:l}=e;if(!n.isDefined())return;const c=Boolean(l),d=f.zm({environment:t,collectionId:n.id,schema:o,property:i,targetCollectionStore:a});if(!d)return;k.Rm({environment:t,collectionStore:n,update:{schema:d.newSchema,...!c&&d.deletedSchema&&{deleted_schema:d.deletedSchema}},transaction:r}),d.otherCollectionId&&d.otherCollectionSchema&&k.Rm({environment:t,collectionStore:b.NW.createChildStore(n,{table:s.v,id:d.otherCollectionId}),update:{schema:d.otherCollectionSchema,...!c&&d.otherCollectionDeletedSchema&&{deleted_schema:d.otherCollectionDeletedSchema}},transaction:r});const u=o[i];("auto_increment_id"===(null==u?void 0:u.type)||c)&&k.$N({collectionStore:n,update:{[i]:null},transaction:r})}},75134:(e,t,n)=>{n.d(t,{H:()=>x,r:()=>C});n(67294);var o=n(40682),i=n(52936),r=n(42875),a=n(72126),s=(n(57658),n(21703),n(80951)),l=n(61158),c=n(45953);function*d(e){const{startingBlock:t,relationPropertyIdGroups:n,receiver:o}=e;let i,r=n.map((e=>function*(e){const{startingBlock:t,relationPropertyIds:n,receiver:o}=e,i=new Set,r=[{block:t}];let l=0;for(;;){const e=r.shift();if(!e)break;const{block:t}=e;if(i.has(t.id))continue;i.add(t.id);const c=n.flatMap((e=>{var n;return(0,s.rq)(null===(n=t.properties)||void 0===n?void 0:n[e])}));if(!o.receive(c))return;if(c.length>0){const{recordMap:e}=yield{recordPointers:c};r.push(...a.oA(c.map((t=>{const n=e.getValue(t);if(n&&n.alive)return{block:n}}))))}if(l++,l>500)throw new Error("Reached maximum number of iterations")}}({relationPropertyIds:e,startingBlock:t,receiver:o})));for(;r.length>0;){const e=[];r=r.filter((t=>{const n=i?t.next(i):t.next();return!n.done&&(e.push(n.value),!0)})),e.length>0&&(i=yield{recordPointers:e.flatMap((e=>e.recordPointers))})}}class u{constructor(e){this.blockPointerSet=new l.Z,this.limit=e}getBlockPointers(){return this.blockPointerSet.entries()}receive(e){return this.blockPointerSet.add(...e),this.blockPointerSet.size<this.limit}}function p(e){return function(e){const{startingBlock:t,relationPropertyIdGroups:n,getRecordValue:o,limit:i}=e,r=new u(i),a=d({startingBlock:t,relationPropertyIdGroups:n,receiver:r});let s=a.next();for(;!s.done;){const e=c.Ak.create();for(const t of s.value.recordPointers)e.setValue(t,o(t));s=a.next({recordMap:e})}return r.getBlockPointers()}(e).every((t=>Boolean(e.getRecordValue(t))))}var m=n(97880),f=n(9291),g=n(6854),h=n(42937),v=n(80444),b=n(77080),y=n(26136),_=n(54642),S=n(64964),w=n(82530),k=n(85893);const I=100;function x(e){const{environment:t,store:n}=e;M({environment:t,store:n,change:{type:"date",...e}})}function C(e){const{environment:t,store:n}=e;M({environment:t,store:n,change:{type:"relation",...e}})}const T=new o.z(1);function M(e){const{environment:t,store:n,change:o}=e;if(!b.default.checkGate("dependency_date_shifting_by_space"))return;const s=n.getAssociatedCollectionStore();if(!s)return;const l=s.getDatabaseType(),c=s.getSchema(),d=s.getNormalizedDependencyDateShiftingConfig();if(!d)return;const u=s.getFormatStore().getKeyStore("collection_default_arrows_by").getValue();if(!u)return;const x=c[u];if("relation"!==(null==x?void 0:x.type))return;const C=x.property;C&&T.enqueue((()=>async function(e){var t,n;const{environment:o,store:s,dateShiftConfig:l,databaseType:c,blockedByPropertyId:d,blockingPropertyId:u,change:b,collectionSchema:x}=e,C={id:s.id,properties:s.getProperties()},T=null===(t=v.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.locale,M=(0,r.r)();let P,A,R;if("date"===b.type){var D;if(0===a.jV(a.oA([l.date_property,l.end_date_property]),a.oA([b.dateProperty.id,null===(D=b.otherDateProperty)||void 0===D?void 0:D.id])).length)return;const e=new Map;e.set(b.dateProperty.id,b.dateProperty),b.otherDateProperty&&e.set(b.otherDateProperty.id,b.otherDateProperty);const t=t=>{const n=e.get(t);if((0,m.$K)(n))return n;{var o;const e=null===(o=C.properties)||void 0===o?void 0:o[t];return{id:t,oldValue:e,newValue:e}}};P=t(l.date_property),(0,m.$K)(l.end_date_property)&&(A=t(l.end_date_property))}else if("relation"===b.type){if(b.relationPropertyId!==u&&b.relationPropertyId!==d)return;if("preserve_gap"===l.mode)return;P={id:l.date_property,oldValue:void 0,newValue:C.properties[l.date_property]},l.end_date_property&&(A={id:l.end_date_property,oldValue:void 0,newValue:C.properties[l.end_date_property]})}else(0,m.t1)(b);"preserve_gap"===l.mode?R=[[d,u]]:"consume_gap"===l.mode?R=[[d],[u]]:(0,m.t1)(l.mode);p({startingBlock:C,relationPropertyIdGroups:R,limit:I,getRecordValue:s.getRecordValue})?await Promise.resolve():await _.getTransitivePageRelations(o,{blockId:C.id,limit:I,relationPropertyIdGroups:R}).then((()=>{}));const B=(0,i.yu)({block:{id:C.id,properties:{...C.properties,...P.oldValue?{[P.id]:P.oldValue}:{},...null!==(n=A)&&void 0!==n&&n.oldValue?{[A.id]:A.oldValue}:{}}},blockingPropertyId:u,blockedByPropertyId:d,dateProperty:P,endDateProperty:A,getRecordValue:s.getRecordValue,timeZone:M,locale:T,options:l,collectionSchema:x,getRecordRole:s.getRecordRole}),{operations:E}=B;w.createAndCommit({userAction:"collectionDateActions.handleDependencyDateShifting",environment:o,perform:e=>{for(const t of E){const n=(0,y.Kv)(s,t.pointer);w.applyOperation({store:n,operation:t,transaction:e})}}});const F=(0,h.vi)({result:B,databaseType:c});F&&S.oV({label:(0,k.jsx)(f.FormattedMessage,{...F.message}),right:F.canUndo?(0,k.jsx)(g.ow,{}):void 0})}({environment:t,store:n,dateShiftConfig:d,databaseType:l,blockedByPropertyId:C,blockingPropertyId:u,change:o,collectionSchema:c}))).catch((e=>{console.error(e)}))}},31869:(e,t,n)=>{n.d(t,{gy:()=>b,kQ:()=>h,n7:()=>v,q0:()=>g,qK:()=>_,sf:()=>y});var o=n(80951),i=n(71644),r=n(50906),a=n(9953),s=n(29376),l=n(8406),c=n(16956),d=n(75134),u=n(14900),p=n(96802),m=n(82530);function f(e){const{environment:t,collectionStore:n,collectionPointer:o,property:i,name:r,autoRelate:a,limit:s,targetPropertyID:l,connectedRelation:c,transaction:d,hideByDefaultInUnconfiguredViews:p}=e,m={type:"relation",name:r,collection_id:o.id,collection_pointer:o,limit:"1"===s?1:void 0,property:l,version:"v2",autoRelate:a,connectedRelation:c,hideByDefaultInUnconfiguredViews:p};u.xO({environment:t,collectionStore:n,update:{[i]:m},transaction:d})}function g(e){const{environment:t,collectionStore:n,propertySchema:o,targetPropertyID:i,property:r,autoRelate:a,transaction:s}=e;u.xO({environment:t,collectionStore:n,update:{[r]:{...o,autoRelate:a,property:i,version:"v2"}},transaction:s})}function h(e){const{environment:t,collectionStore:n,property:o,transaction:i}=e,r=n.getSchema()[o];r&&"relation"===r.type&&(u.xO({environment:t,collectionStore:n,update:{[o]:null},transaction:i}),u.$N({collectionStore:n,update:{[o]:r},transaction:i}))}function v(e){const{environment:t,collectionContextStore:n,collectionStore:o,property:r,propertyName:a,propertyLimit:d,targetCollectionStore:u,hasInverseRelation:p,inverseName:m,autoRelate:g,intl:h,connectedRelation:v,transaction:b,from:y}=e,_=u.pointer.id===o.id&&Boolean(p)?"separate_property":"same_property",S=s.KV(n,r),w="subitem"===y||void 0,k=function(e){const{environment:t,collectionContextStore:n,property:o,limit:r,collectionPointer:a,selfRelationType:s,oneWay:l,autoRelate:c,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}=e,m=n.collectionStore();if(!m)return;const g=m.getSchema()[o];if(!g)return;const h=a.id===m.id?"same_property"===s?o:(0,i.ZP)():l?void 0:(0,i.ZP)();return f({environment:t,collectionStore:m,collectionPointer:a,property:o,name:g.name,autoRelate:c,limit:r,targetPropertyID:h,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}),h}({environment:t,collectionContextStore:n,property:r,limit:d,collectionPointer:u.pointer,selfRelationType:_,oneWay:!p,autoRelate:g,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:w});if((null==S?void 0:S.name)!==a&&(c.Bv({collectionStore:o,property:r,name:a,transaction:b}),l.$q({environment:t,collectionContextStore:n,property:r,from:"view_settings",action:"rename"})),p&&s.gZ(u)&&k){const e=s.rj({inverseName:m,collectionStore:o,propertySchema:S,intl:h,targetCollectionStore:u,from:y});f({environment:t,collectionStore:u,collectionPointer:o.pointer,property:k,name:e,autoRelate:g,limit:"no_limit",targetPropertyID:r,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:w})}}function b(e){const{environment:t,collectionContextStore:n,property:o,hasInverseRelation:r,inverseName:a,autoRelate:l,intl:d,transaction:u}=e,p=s.KV(n,o);if(!p||"relation"!==p.type)return;const m=s.ny(n,p),v=n.collectionStore();if(!v||!m)return;const b=s.rj({inverseName:a,collectionStore:v,propertySchema:p,intl:d,targetCollectionStore:m});if(r&&!s.OP(n,o,m)){const e=(0,i.ZP)();g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:e,autoRelate:l,transaction:u}),f({environment:t,collectionStore:m,collectionPointer:v.pointer,property:e,name:b,autoRelate:l,limit:"no_limit",targetPropertyID:o,transaction:u,hideByDefaultInUnconfiguredViews:void 0})}else if(r){const e=p.property;if(!e)return;c.Bv({collectionStore:m,property:e,name:b,transaction:u}),l&&(c.bL({collectionStore:v,property:o,autoRelate:l,transaction:u}),c.bL({collectionStore:m,property:e,autoRelate:l,transaction:u}))}else{l&&c.bL({collectionStore:v,property:o,autoRelate:l,transaction:u});const e=p.property;if(!e)return;g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:void 0,autoRelate:l,transaction:u}),h({environment:t,collectionStore:m,property:e,transaction:u})}}function y(e){var t;const{store:n,propertyId:i,value:r,environment:s,relatedPageId:c,propertySchema:u,transaction:p,collectionContextStore:m,analyticsData:f,isUnthrottled:g}=e,{analyticsFrom:h,isFromBulkActionsToolbar:v}=f,b=n.getPropertyStore(i),y=o.ow(r);a.sO({store:b,value:y,transaction:p}),l.rv({environment:s,block_id:c,property:i,property_type:u.type,from:h,collectionContextStore:m,isFromBulkActionsToolbar:v,isUnthrottled:g,integration_id:null===(t=u.connectedRelation)||void 0===t?void 0:t.integration_id,action:"remove"}),d.r({environment:s,store:n,relationPropertyId:i})}function _(e){const{propertyFormat:t,visibility:n,collectionStore:i,property:a,environment:l}=e,c=t.property,d=s.U1({collectionStore:i,property:a}),u=(0,o.pX)(d,c,!n),f={...s.ZI(i)};f[a]||(f[a]={}),f[a].related_properties=u,m.createAndCommit({userAction:"collectionRelationActions.updateRelationPropertyVisibility",environment:l,perform:e=>{p.FH({stores:[i],update:{collection_relation_options:f},transaction:e})}}),r.P$y(l,{collection_id:i.id,property_id:a,related_property_id:c,visible:!n})}},5149:(e,t,n)=>{n.d(t,{E3:()=>j,FK:()=>L,H4:()=>U,NG:()=>V,Ol:()=>H,R0:()=>G,TT:()=>W,iN:()=>K,nr:()=>$,qU:()=>z,r$:()=>Z,wl:()=>O,z$:()=>N,zt:()=>q});n(67294);var o=n(1302),i=n(15145),r=n(92996),a=n(41432),s=n(59730),l=n(15157),c=n(29477),d=n(21202),u=n(15047),p=n(29369),m=n(63143),f=n(9291),g=n(40663),h=n(95477),v=n(92918),b=n(84210),y=n(33929),_=n(16402),S=n(77907),w=n(80444),k=n(8406),I=n(54642),x=n(893),C=n(14900),T=n(47307),M=n(96802),P=n(19785),A=n(9953),R=n(42858),D=n(64964),B=n(82530),E=n(85893);const F=(0,f.defineMessages)({copySuccessMessage:{defaultMessage:"Link to view copied to clipboard",id:"database.viewSettings.copyLinkSnackBarItem.title"}});function Z(e){const{collectionContextStore:t,selectViewNameInitial:n,collectionSettingsStore:o,hideSettingsPopup:i,fromBlock:r}=e,a=t.hasSingleCollection()&&!t.collectionStore()?{type:"createViewSource"}:{type:"main",selectViewNameInitial:n};o.setState({open:!0,hideSettingsPopup:i,stack:[a],fromBlock:r})}function V(e){const{collectionSettingsStore:t}=e;O({collectionSettingsStore:t,item:{type:"createSyncedViewSource"}})}function j(e){const{collectionSettingsStore:t}=e;t.setState({...t.state,open:!1,hideSettingsPopup:void 0,stack:[]})}function U(e){const{collectionSettingsStore:t,item:n,hideSettingsPopup:o}=e,i=t.state;t.setState({...i,open:!0,stack:[...i.stack,n],...void 0!==o?{hideSettingsPopup:o}:{}})}function L(e){const{collectionSettingsStore:t,item:n}=e,o=t.state;t.setState({open:!0,stack:[...o.stack.slice(0,o.stack.length-1),n]})}function O(e){const{collectionSettingsStore:t,item:n}=e;t.setState({open:!0,stack:[n]})}function N(e){const{collectionSettingsStore:t}=e,n=t.state,o=n.stack.slice(0,n.stack.length-1);0===o.length?j({collectionSettingsStore:t}):t.setState({open:!0,stack:o})}function z(e){const{collectionSettingsStore:t,property:n,formatKey:o,selectNameInitial:i}=e,r=t.state,a=r.stack.findIndex((e=>"property"===e.type));t.setState({open:!0,stack:[...a>=0?r.stack.slice(0,a):r.stack,{type:"property",property:n,formatKey:o,selectNameInitial:i}]})}function W(e){const{environment:t,collectionContextStore:n,collectionViewStore:o,collectionSettingsStore:i,from:r}=e,a=(0,c.UZ)();return T.showDialog({showCancel:!0,keepFocus:!1,message:(0,E.jsx)(f.FormattedMessage,{defaultMessage:"Are you sure you want to delete this view?",id:"database.viewSettings.mainTab.deleteViewConfirm.text"}),items:[{label:(0,E.jsx)(f.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.deleteButton.text"}),color:"red",onAccept:()=>{const e=n.collectionViewStore(),s=n.collectionViewBlockStore(),l=n.isFullScreen.state,c=o.getType();e&&s&&c&&(B.createAndCommit({userAction:"collectionSettingsActions.handleDeleteCollectionView",environment:t,perform:a=>{if(C.dp({collectionViewBlockStore:s,collectionViewStore:o,transaction:a}),j({collectionSettingsStore:i}),e.id===o.id){const e=s.getCollectionViewStores()[0];e?C.f8({environment:t,collectionContextStore:n,collectionViewId:e.id,isFullScreen:n.isFullScreen.state,isRootChild:n.isRootChild.state,isInPeekRenderer:n.isInPeekRenderer.state}):(C.ME({environment:t,collectionContextStore:n,transaction:a}),l||R.Cl({environment:t,blocks:[s],transaction:a}))}k.Rc({environment:t,collectionContextStore:n,view_type:c,from:r})}}),a.resolve(!0))}}],handleCancel:()=>a.resolve(!1)}),a.promise}function q(e){const{environment:t,collectionContextStore:n,collectionViewStore:i,collectionSettingsStore:r,intl:a}=e,s=n.isFullScreen.state,l=n.isRootChild.state,c=n.isInPeekRenderer.state,{performResult:d}=B.createAndCommit({userAction:"collectionSettingsActions.newView",environment:t,perform:e=>C.tG({environment:t,collectionContextStore:n,collectionViewStore:i,collectionSettingsStore:r,intl:a,transaction:e})});d&&(C.f8({environment:t,collectionContextStore:n,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),o.default.afterNextFlush((()=>{Z({collectionContextStore:n,collectionSettingsStore:r,selectViewNameInitial:!0})})))}async function H(e){const{environment:t,collectionContextStore:n,collectionViewStore:o}=e,r=n.collectionViewBlockStore();if(!o||!r)return;const a=(0,b.ZP)({store:r,collectionViewId:o.id,fullyQualified:!0,pageVisitSource:i.tY.CopyLink});await x.RD({environment:t,stringValue:a,copiedMessage:x.tq.copiedLinkToClipboard}),D.oV({label:y.default.formatMessage(F.copySuccessMessage)})}function K(e){const{environment:t,collectionContextStore:n}=e,o=n.normalizedFormatStore.state.board_columns_by,i=n.collectionViewStore();if(!o||!i)return;const r=!(0,v.h6)(t,n);B.createAndCommit({userAction:"collectionSettingsActions.handleBoardGroupColorColumnsClick",environment:t,perform:e=>{M.FH({stores:[i],update:{board_columns_by:{...o,disableBoardColorColumns:r}},transaction:e})}}),k.wd({environment:t,collectionContextStore:n,action:"toggle_group_color_columns"})}async function G(e){const{environment:t,uri:n,botId:o,collectionId:i,isStale:r,nextSync:a,setNextSync:c}=e;if(!a||Date.now()>a){var d;let e=Date.now()+m.U6;const a=await I.resubscribeExternalCollection(t,{botId:o,uri:n,isStale:r,collectionId:i});if("failed"===a.type&&(0,s.A6)(a.body)&&"rate_limited"===(null===(d=a.body.clientData)||void 0===d?void 0:d.type)){const t=a.body.clientData.retryAfter;t&&(e=Date.now()+t*m.C0),D.oV({label:(0,E.jsx)(f.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.update.rateLimitError",defaultMessage:"This database was synced recently. You may try again in {time}.",values:{time:(0,_.hH)(Date.now(),e)}})})}if(h.default.isAdminMode)return;l.Z.set({userId:t.currentUser.id,key:`${o}:${n}`,value:e}),c(e)}}async function $(e){const{appTemplatesSetupActions:t,appConfigs:n}=await S.deps.AppTemplates.loader(),{environment:i,selectedDBType:s,collectionName:l,collectionContextStore:c,collectionViewBlockStore:m,collectionViewStore:f,useTemporaryRecordCache:h,temporaryRecordCache:v,baseViewType:b}=e,{currentSpaceViewStore:y}=w.default.state;let _=f,I=m,x=m.getParentStore();var T;h&&(_=f.clone(v),I=m.clone(v),x=null===(T=m.getParentStore())||void 0===T?void 0:T.clone(v));if(s===r.br)k.wd({environment:i,collectionContextStore:c,action:"select_new_collection"}),B.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:i,perform:e=>{if(h){A.sW({store:_,data:{name:void 0,format:void 0,query2:void 0,type:b??"table"},transaction:e}),A.sW({store:I,data:{properties:void 0},transaction:e});const t=I.getCollectionViewSourceCollectionStore();t&&C.A9({collectionViewBlockStore:I,collectionStore:t,transaction:e})}C.TM({environment:i,collectionViewStore:_,collectionViewBlockStore:I,name:l,transaction:e});const t=I.getCollectionViewSourceCollectionStore();c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:t,collectionViewStore:f})}}),o.default.afterNextFlush((()=>{C.W1({environment:i,collectionContextStore:c})}));else{const e=s,o=(0,g.YB)(n(),e);if(!o)return;const r=(0,g.Zu)(o,e);if(!r)return;B.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:i,perform:e=>{if(!x||x.table!==u.bx&&x.table!==p.e0&&x.table!==d.iU||!y)return;if(!h&&v){i.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(v);I.getCollectionViewStores().forEach((t=>C.dp({collectionViewBlockStore:I,collectionViewStore:t,transaction:e})))}const s=(0,g.KC)(n(),r);t.applyFeatures({environment:i,spaceViewStore:y,appParentStore:x,appUri:o.uri,features:s,createOrModify:"create",initializeStore:I,transaction:e});const l=I.getCollectionViewSourceCollectionStore();if(l){const t=x.table===u.bx?x.id:x.getSpaceId();if(!t)return;for(let o=0;o<3;o++){const n=A.j4({environment:i,type:a.Ti.page,inMemoryRecordCache:I.inMemoryRecordCache,transaction:e,spaceId:t,useCrdt:!1});P.zw({childStore:n,parentStore:l,transaction:e})}const n=I.getCollectionViewStores()[0];c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:l,collectionViewStore:n}),c.filtersBarOpen.setState(!1)}}})}}},87085:(e,t,n)=>{n.d(t,{G0:()=>E,Jw:()=>V,K7:()=>F,PW:()=>Z});n(57658),n(21703);var o=n(92996),i=n(90559),r=n(99036),a=n(77657),s=n(74181),l=n(72126),c=n(21202),d=n(9844),u=n(15047),p=n(29369),m=n(97880),f=n(9291),g=n(40663),h=n(78316),v=n(33929),b=n(77907),y=n(80444),_=n(77080),S=n(30874),w=n(26136),k=n(8406),I=n(54642),x=n(74882),C=n(16956),T=n(31869),M=n(5149),P=n(14900),A=n(28673),R=n(96802),D=n(82530);const B=(0,f.defineMessages)({aiCustomPromptDefaultPropertyName:{id:"collectionSettingsCreatePropertyActions.createProperty",defaultMessage:"Text"}});async function E(e){var t;const{appTemplatesSetupActions:n,appTemplatesSprintBoardActions:r,appConfigs:l}=await b.deps.AppTemplates.loader(),{environment:m,collectionContextStore:f,feature:h}=e,{currentSpaceViewStore:v}=y.default.state,C=f.collectionStore(),T=f.collectionViewStore(),P=null==C?void 0:C.getParentBlockStore(),B=null==P?void 0:P.getParentStore(),E=null==C||null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri,F=E&&(0,g.YB)(l(),E);if(!C||!P||!B||B.table!==u.bx&&B.table!==c.iU&&B.table!==p.e0||!F)return;const Z=C.getSchema(),V=P.getFormat().app_id,j=V?await I.getCollectionViewBlocksByAppId(m,{spaceId:P.getSpaceId(),appId:V}):void 0,U="success"===(null==j?void 0:j.type)&&j.data.result.length?j.data.result.map((e=>w.G.createChildStore(B,{table:c.iU,id:e.blockId,spaceId:P.getSpaceId()}))):[P],L=h.integrationId;if(L){const e=S.Z.getIntegrationsAsRecordMap().getValue({table:d.K2,id:L});if(!e||!(0,s.VM)(e))return;await A.V(m,C,e,Boolean(h.canOnlyAdminAuth))}L===a.U9&&Z&&0===(0,i.$z)(Z).length&&await x.K({environment:m,collectionStore:C});const O=Date.now();D.createAndCommit({environment:m,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewSuggestedProperty",perform:e=>{var t;if(!F||!v)return;const i=null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri;if(!i)return;const a=n.applyFeatures({environment:m,spaceViewStore:v,appParentStore:B,appUri:F.uri,features:[{type:"simple",featureUri:h.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:U});r.createSprintPage({environment:m,spaceViewStore:v,appParentStore:B,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_relation"}});const s=_.default.checkGate("collection_level_subitems_setting");if("notion://tasks/sub_task_feature"===h.uri&&(R.FH({stores:[C],update:{...s?{subitem_property:o.Es.SubTaskRelation}:{},collection_default_subitem:o.Es.SubTaskRelation},transaction:e}),T&&R.FH({stores:[T],update:{collection_view_subitem:{property:o.Es.SubTaskRelation}},transaction:e})),"notion://tasks/task_dependencies_feature"===h.uri&&(R.FH({stores:[C],update:{collection_default_arrows_by:o.Es.BlockingRelation},transaction:e}),T&&R.FH({stores:[T],update:{timeline_arrows_by:{property:o.Es.BlockingRelation}},transaction:e})),"dependencies"in h&&h.dependencies.forEach((e=>{"property"===e.type&&e.collectionUri===i&&k._H({environment:m,collectionContextStore:f,from:"view_settings",property:e.uri,property_type:e.propertySchema.type})})),"dependencies"in h&&h.dependencies.map((e=>e.type)).every((e=>"property"===e))){const t=f.collectionViewStore(),n=f.getPropertyFormatKey(),o=f.normalizedFormatStore.state;if(n&&t){const i=o[n]||[],r=[...i];h.dependencies.forEach((e=>{const t=i.findIndex((t=>t.property===e.uri));-1===t?r.push({visible:!0,property:e.uri}):r[t]={...i[t],visible:!0}})),R.FH({stores:[t],update:{[n]:r},transaction:e})}}if(void 0!==h.propertyIdCollectionSettingToNavigateTo){const e={type:"property",property:h.propertyIdCollectionSettingToNavigateTo,selectNameInitial:!1,formatKey:f.getPropertyFormatKey()};M.H4({collectionSettingsStore:f.settingsStore,item:e})}else M.E3({collectionSettingsStore:f.settingsStore});e.postSubmitCallbacks.push((e=>{k.mH(m,{collection_uri:h.collectionUri,feature_uri:h.uri,time:Date.now()-O,status:Boolean(e)?"fail":"success"})}))}})}function F(e){let{propertyType:t,collectionContextStore:n,propertyId:o}=e;switch(t){case"ai_custom_prompt":case"ai_summary":case"ai_extract":case"ai_translate":return M.H4({collectionSettingsStore:n.settingsStore,item:{type:"propertyAiAutofill",propertySchema:n.normalizedSchemaStore[o],property:o}});default:(0,m.t1)(t)}}function Z(e){const{environment:t,collectionContextStore:n,propertyType:o,propertyName:i,from:a}=e,s=n.collectionStore(),l=n.collectionViewStore(),c=n.getPropertyFormatKey();if(!s||!c)return;if("relation"===o)return void M.H4({collectionSettingsStore:n.settingsStore,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});let d=i;"ai_custom_prompt"===o&&(d=v.default.formatMessage(B.aiCustomPromptDefaultPropertyName));const{performResult:u}=D.createAndCommit({userAction:"collectionSettingsCreatePropertyActions.handleCreateNewStandardProperty",environment:t,perform:e=>C.G3({environment:t,collectionStore:s,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:c}:void 0,propertyName:d,propertyType:o,transaction:e})});(0,r.XU)(o)?F({propertyType:o,propertyId:u,collectionContextStore:n}):M.qU({collectionSettingsStore:n.settingsStore,property:u,formatKey:c,selectNameInitial:!0}),k._H({environment:t,collectionContextStore:n,from:a,property_type:(0,r.TN)(o)})}async function V(e){const{environment:t,collectionContextStore:n,intl:o,connectedRelationProperty:s}=e,c=n.collectionStore(),d=n.collectionViewStore(),u=n.getPropertyFormatKey();if(!c||!u)return;const p=s.integration.id;[a.f3,a.mQ].includes(p)||await A.V(t,c,s.integration,Boolean(s.canOnlyAdminAuth));const f=c.getSchema();let g;s.integration.id===a.U9&&f&&0===(0,i.$z)(f).length&&(g=await x.K({environment:t,collectionStore:c})),D.createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewConnectedRelationProperty",perform:e=>{g&&C.G3({environment:t,collectionStore:c,collectionViewArgs:d?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyType:"auto_increment_id",transaction:e});const i=c.getDeletedSchema(),p=(0,m.qP)(i).map((e=>{let[t,n]=e;if(n&&r.NK(n)&&n.connectedRelation.integration_id===a.U9)return{propertyId:t,propertySchema:n}})).filter(m.$K);if(!l.xb(p)){const{propertyId:o}=p[0],r=(0,h.D8)({deletedSchema:i,property:o});if(!r)throw new Error("Deleted property schema was not found");P.xO({environment:t,collectionStore:c,update:r.updateSchema,transaction:e}),P.$N({collectionStore:c,update:r.updateDeletedSchema,transaction:e});const a={type:"property",property:o,formatKey:u};return void M.H4({collectionSettingsStore:n.settingsStore,item:a})}const f=A.c({environment:t,pattern:s.pattern,integration:s.integration,parentCollectionStore:c,transaction:e}),v=C.G3({environment:t,collectionStore:c,collectionViewArgs:d&&u?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyType:"relation",transaction:e});T.n7({environment:t,collectionContextStore:n,collectionStore:c,property:v,propertyName:s.name,propertyLimit:"no_limit",targetCollectionStore:f,hasInverseRelation:!0,autoRelate:void 0,intl:o,connectedRelation:{integration_id:s.integration.id},transaction:e});const b={type:"property",property:v,formatKey:u};M.H4({collectionSettingsStore:n.settingsStore,item:b}),k._H({environment:t,collectionContextStore:n,from:"view_settings",property_type:"relation",integration_id:s.integration.id})}})}},98834:(e,t,n)=>{n.d(t,{$p:()=>A,R5:()=>T,Zh:()=>C,nx:()=>x,ob:()=>P});n(21703),n(57658);var o=n(41432),i=n(76837),r=n(42875),a=n(23867),s=n(70203),l=n(9291),c=n(33929),d=n(18245),u=n(94896),p=n(26136),m=n(81193),f=n(54642),g=n(47307),h=n(54532),v=n(96802),b=n(94419),y=n(9953),_=n(993),S=n(98724),w=n(29373);const k=(0,l.defineMessages)({duplicateTemplateError:{id:"databaseTemplatePickerActions.duplicateTemplateFailedError.message",defaultMessage:"Duplicate template failed."}});function I(e){const{environment:t,pageStore:n,copiedFromPointer:o,useInMemoryRecordCache:s,addCopyName:l,transaction:d,resolveTemplateVariables:m}=e,v=n.useCrdt(),b=new p.G(t,o,{inMemoryRecordCache:s});if(s){const e=h.K8(t,{blockId:b.id,inMemoryRecordCache:b.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!e)throw new Error("Client copy could not be created.");h.E9({environment:t,sourceBlockId:b.id,targetBlockPointer:n.pointer,sourceBlockSubtree:e,targetInMemoryRecordCache:n.inMemoryRecordCache,addCopyName:l,transaction:d,deepCopyTransclusionContainers:!1,resolveTemplateVariables:m,useCrdt:v})}else{if(M({environment:t,store:n,properties:b.getProperties(),transaction:d}),m&&S.bt({store:n,context:{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},transaction:d}),l){const e=n.getBlockTitleStore();_.sO({environment:t,store:e,value:i.eb(e.getValue()),transaction:d})}const e={copied_from:o.id};y.sW({store:n,data:e,transaction:d});const s={...b.getFormat(),copied_from_pointer:o};delete s.automation_id,delete s.app_config_uri,y.sW({store:n.getFormatStore(),data:s,transaction:d}),b.hasContent()&&(u.Z.setStatus(n.id,!0),d.postSubmitCallbacks.push((async e=>{if(e)return g.showErrorMessage(c.default.formatMessage(k.duplicateTemplateError)),void u.Z.setStatus(n.id,!1);await f.duplicateBlock(t,{sourceBlocks:[{id:o.id,spaceId:(0,a.C)(o.spaceId)}],targetBlocks:[{id:n.id,spaceId:(0,a.C)(n.pointer.spaceId)}],addCopyName:l,appendContentOnly:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!!m&&{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},deepCopyTransclusionContainers:!1,useCrdt:v}).next().finally((()=>{u.Z.setStatus(n.id,!1)}))})))}return n}function x(e){const{environment:t,collectionStore:n,transaction:i,title:r}=e,a=y.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,spaceId:n.getTemplatePagesStore().pointer.spaceId,properties:{title:(0,s.TPx)(r||"")},useCrdt:!1});return y.sW({store:a,data:{is_template:!0},transaction:i}),b.R3({parent:n.getTemplatePagesStore(),append:a,transaction:i}),a}function C(e){const{environment:t,collectionStore:n,templateStore:i,transaction:r}=e,a=y.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:r,spaceId:n.getTemplatePagesStore().pointer.spaceId,useCrdt:!1});y.sW({store:a,data:{is_template:!0},transaction:r}),b.BE({parent:n.getTemplatePagesStore(),after:i,insert:a,transaction:r});try{I({environment:t,copiedFromPointer:i.pointer,pageStore:a,addCopyName:!0,transaction:r,resolveTemplateVariables:!1})}catch(s){g.showErrorMessage(c.default.formatMessage(k.duplicateTemplateError))}return a}function T(e){const{collectionStore:t,templateStore:n,transaction:o}=e;b.Od({parent:t.getTemplatePagesStore(),childToRemove:n,transaction:o})}function M(e){const{environment:t,store:n,properties:o,transaction:i}=e,r=n.getPropertiesStore();if("title"in o){const{title:e,...a}=o;return _.sO({environment:t,store:n.getBlockTitleStore(),value:e,transaction:i}),void y.sW({store:r,data:a,transaction:i})}y.sW({store:r,data:o,transaction:i})}function P(e){const{environment:t,store:n,templateStore:o,title:i,isKeyboard:r,isCreateIn:a,transaction:s,from:l}=e,c=n.getProperties(),u=d.default.mark("rum.initialize_collection_template");if(I({environment:t,pageStore:n,copiedFromPointer:o.pointer,useInMemoryRecordCache:n.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache?n.inMemoryRecordCache:void 0,transaction:s,resolveTemplateVariables:!0}),"template"!==i){const e="empty"===i?void 0:i.text;_.sO({environment:t,store:n.getBlockTitleStore(),value:e,transaction:s})}M({environment:t,store:n,properties:c,transaction:s}),y.sW({store:n,data:{is_template:null},transaction:s}),v.Wq({environment:t,store:n,isLocked:!1,transaction:s}),0===o.getContentLength()&&w.ls({environment:t,store:n,transaction:s}),d.default.measure(u,{environment:t}),m.XQ(t,{template_id:o.id,collection_id:o.getParentId(),is_keyboard:r,is_create_in:a,from:l})}function A(e){const{collectionStore:t,newTemplateIds:n,transaction:o}=e;y.sW({store:t,data:{template_pages:n},transaction:o})}},14900:(e,t,n)=>{n.d(t,{zz:()=>gt,TM:()=>ft,wG:()=>Tt,MO:()=>Pt,pi:()=>wt,ME:()=>tt,NZ:()=>Ut,Ki:()=>Rt,HW:()=>vt,dp:()=>nt,ob:()=>Qe,IH:()=>At,tG:()=>et,dj:()=>_t,lG:()=>Bt,oh:()=>kt,rm:()=>jt,C_:()=>bt,mS:()=>yt,fI:()=>Dt,A9:()=>ht,Wu:()=>ot,mc:()=>$e,Ip:()=>ut,n1:()=>pt,W1:()=>Ct,bu:()=>Ft,f8:()=>xt,t5:()=>Ye,Z5:()=>Mt,Rm:()=>at,$N:()=>lt,$D:()=>It,xO:()=>st,iG:()=>it,Uy:()=>dt,Es:()=>rt,yc:()=>mt,z2:()=>ct,Ug:()=>Je});n(21703),n(57658),n(52262),n(24506);var o=n(30120),i=n(1302),r=n(15145),a=n(92996),s=n(21202),l=n(97880);function c(e){switch(e){case"trending":case"similarUsers":return{title:{name:"Name",type:"title"}};case"myTasks":return{};default:(0,l.t1)(e)}}function d(e){let{source:t,collectionId:n}=e;const{type:o}=t;return{id:n,parent_table:s.iU,parent_id:o,version:1,alive:!0,space_id:t.spaceId,format:{},schema:c(o)}}var u=n(41432),p=n(50475),m=n(14248),f=n(76205),g=n(14714),h=n(99036),v=n(43690),b=n(10070),y=n(28155),_=n(53877),S=n(93824),w=n(76837),k=n(6695),I=n(68626),x=n(42875),C=n(60310),T=n(74229),M=n(15157),P=n(72126),A=n(77897),R=n(59753),D=n(29477),B=n(4615),E=n(71644),F=n(45953),Z=n(96367),V=n(98963),j=n(18844),U=n(6287),L=n(13493),O=n(23867),N=n(54153),z=n(70203),W=n(63143),q=n(9291),H=n(75754),K=n(2553),G=n(28020),$=n(42),Q=n(97004),Y=n(75079),J=n(92918),X=n(52821),ee=n(26991),te=n(78316),ne=n(77181),oe=n(27383),ie=n(33929),re=n(45950),ae=n(89796),se=n(77546),le=n(18245),ce=n(14654),de=n(94841),ue=n(58202),pe=n(74948),me=n(80444),fe=n(17746),ge=n(77556),he=n(6776),ve=n(19511),be=n(88632),ye=n(77080),_e=n(79167),Se=n(37598),we=n(53730),ke=n(26136),Ie=n(27724),xe=n(34583),Ce=n(50906),Te=n(54642),Me=n(49865),Pe=n(5149),Ae=n(41433),Re=n(47307),De=n(96802),Be=n(94419),Ee=n(92625),Fe=n(19785),Ze=n(9953),Ve=n(4408),je=n(32953),Ue=n(26999),Le=n(80402),Oe=n(98104),Ne=n(82530),ze=n(12170),We=n(53471);const qe=(0,q.defineMessages)({importingCSV:{id:"databaseViewActions.importingCSV.loadingMessage",defaultMessage:"Importing"},uploadingCSV:{id:"databaseViewActions.uploadingCSV.loadingMessage",defaultMessage:"Uploading"},importFailed:{id:"databaseViewActions.importFailedError.message",defaultMessage:"Import failed."}}),He=(0,q.defineMessages)({renameButtonTitle:{defaultMessage:"Rename",id:"database.collectionEditViewButtonPopup.renameButtonTitle"},statusName:{defaultMessage:"Status",id:"database.collectionEditViewButtonPopup.statusNameProperty"},dateName:{defaultMessage:"Date",id:"database.collectionEditViewButtonPopup.dateNameProperty"}});function Ke(e,t){if(e||t){if(!e)return"add_filter";if(!t)return"remove_filter";if(!P.Xy(e,t)){if((0,f.aN)(e)&&(0,f.aN)(t))return e.property!==t.property?"change_filter":e.filter.operator!==t.filter.operator?"change_filter_operator":P.Xy(e.filter,t.filter)?void 0:"change_filter_value";if((0,f.Mm)(e)&&(0,f.Mm)(t))return e.timestamp!==t.timestamp?"change_filter":e.filter.operator!==t.filter.operator?"change_filter_operator":P.Xy(e.filter,t.filter)?void 0:"change_filter_value";if(!(0,f.vA)(e)||!(0,f.vA)(t))return"change_filter";{if(e.operator!==t.operator)return"change_filter_operator";function n(e){return(0,f.aN)(e)?`property/${e.property}`:(0,f.Mm)(e)?`property/${e.timestamp}`:(0,f.vA)(e)?`combinator/${e.operator}`:void(0,l.t1)(e)}const o=P.MR(e.filters??[],n),i=P.MR(t.filters??[],n),r=o.length,a=i.length;if(r<a)return"add_filter";if(a<r)return"remove_filter";for(let e=0;e<a;e++){const t=Ke(o[e],i[e]);if(t)return t}}}}}function Ge(e,t){if(void 0===t)return;if(void 0===e)return"initial_load";if(!P.Xy(e.collectionView,t.collectionView))return"change_view";if(!P.Xy(e.loader.searchQuery,t.loader.searchQuery))return"change_search";if(!P.Xy(e.loader.sort,t.loader.sort))return"change_sort";const n=Ke(e.loader.filter,t.loader.filter);if(n)return n;const o=e&&"reducer"===e.loader.type&&e.loader.reducers||{},i=t&&"reducer"===t.loader.type&&t.loader.reducers||{};if(Object.keys(i).find((e=>{const t=o[e],n=i[e];return n&&(!t||!P.Xy(t,n))})))return"change_group";const r={reducers:void 0,filter:void 0,sort:void 0,reducerDependencies:void 0},a={...null==e?void 0:e.loader,...r},s={...null==t?void 0:t.loader,...r};return P.Xy(a,s)?void 0:"change_loader"}function $e(e){const{environment:t,collectionViewBlockStore:n,collectionViewStore:a,collectionStore:s,collectionContextStore:c,isFullScreen:d,isRootChild:u,isInPeekRenderer:m}=e;Qe({collectionContextStore:c}),d&&(je.Pg(t),je.rM(t));const{remoteRequestStore:g,localResultStore:h}=c;if(a){var v;const e=Boolean(!c.isViewSpecificClientModeEnabled.state&&c.isClientModeEnabled.state&&s&&s.id===(null===(v=c.collectionStore())||void 0===v?void 0:v.id)),b=o.ou.fromMillis(fe.Z.getLocalDateRangeStart({collectionViewId:a.id,currentUserId:t.currentUser.id}));let S;const w=()=>{i.default.afterNextFlush((()=>{const e=g.state;c.isViewSpecificClientModeEnabled.state&&S&&e&&!P.Xy(S.loader.filter,e.loader.filter)&&(c.isClientModeEnabled.setState(!1),c.isViewSpecificClientModeEnabled.setState(!1));const o=Ge(S,e);void 0===o||c.isClientModeEnabled.state&&!function(e,t,n,o){if(!n)return!1;if(null!=t&&t.loader.filter&&(0,f.SH)(null==t?void 0:t.loader.filter,(e=>(0,f.aN)(e)&&(0,Z.zy)(e,n.getSchema()))))return!0;return(0,ee.ki)(null==t?void 0:t.loader.reducers,n.getSchema(),o)}(0,e,s,n)||_t(t,c,{src:o}),S=e}))};g.addListener(w);const k=()=>{if((0,A.lB)(1)){const e=le.default.mark("database_update_lag");le.default.measureAfterNextFlush(e,{environment:t})}};h.addListener(k),c.remoteResult.setState(void 0),c.remoteCollectionIds.setState([]),c.isLoaded.setState(!1),c.searchQuery.setState(""),c.searchOpen.setState(!1),c.calendarByMenuOpen.setState(!1),c.timelineByMenuOpen.setState(!1),c.isFullScreen.setState(d),c.isRootChild.setState(u),c.reducers.setState({}),c.groupsStore.reset(),c.groupsLimit.setState(J.XD),c.boardColumnsLimitStore.setState(J.XD),c.filtersBarOpen.setState(void 0),c.isInPeekRenderer.setState(m),c.subitemExpandedStore.setState(new Map),c.isClientModeEnabled.setState(e),c.isViewSpecificClientModeEnabled.setState(!1),c.asyncAggregationStatus.reset(),c.dateRangeStart.setState((0,_.IS)(b.startOf("month").valueOf(),G.AK.state).valueOf()),c.dateRangeEnd.setState(d&&!t.device.isMobile?(0,_.V7)(b.endOf("month").plus({month:1}).valueOf(),G.AK.state).valueOf():(0,_.V7)(b.endOf("month").valueOf(),G.AK.state).valueOf());const I=null==a?void 0:a.getFormat(),x=null==I?void 0:I.collection_view_source;"typed"===(null==x?void 0:x.type)?c.setContext({type:"collectionTypedView",collectionViewBlockStore:n,databaseType:x.databaseType,collectionViewStore:a,pageVisitSourceOverride:(0,ce.ib)({blockOrCollectionId:n.id}),analyticsFromOverride:(0,ce.t3)({blockOrCollectionId:n.id})}):(0,y.nx)(x)?s&&c.setContext({type:"collectionVirtualView",collectionViewBlockStore:n,collectionViewStore:a,collectionStore:s,pageVisitSourceOverride:(0,ce.ib)({blockOrCollectionId:a.id}),analyticsFromOverride:(0,ce.t3)({blockOrCollectionId:a.id})}):x&&"collection"!==x.type?(0,l.t1)(x):c.setContext({type:"collectionView",collectionViewBlockStore:n,collectionStore:s,collectionViewStore:a}),c.remoteRequestStoreCallback=w,c.localResultStoreCallback=k;const C=Vt(a),T=oe.y.get(C);if(T){const e=0===T.resultSet.blockIds.size,t=c.getPageVisitSourceOverride();(t===r.tY.PersonalHomeTileTasks||t===r.tY.PersonalHomePageTasks)&&(e||oe.y.locallyMutatedTasksDatabase)?oe.y.locallyMutatedTasksDatabase=!1:(c.resetLoadingState(),c.resultSet.setState(P.Xh(T.resultSet)),c.remoteCollectionIds.setState(P.Xh(T.collectionIds)),c.remoteResult.setState(P.Xh(T.remoteResult)),c.isLoaded.setState(!0))}const R=we.transactionQueue.isPendingTransactionForRecord(a.pointer);c.wasCreatedThisSession.setState(R);const D=function(e){let{currentUserId:t,collectionViewId:n}=e;const o=M.Z.get({userId:t,key:Zt(n)});if(o)return(0,W.dj)(o)}({currentUserId:t.currentUser.id,collectionViewId:a.id});c.temporaryState.setState(D||{});const{currentSpaceStore:B}=me.default.state;if(s&&B&&s.getSpaceId()===B.id&&s.isDefaultRecordCache()&&!(0,p.EW)(n.getSystemBlockTypeStore().getValue())){!function(e){let{currentUserId:t,spaceId:n,collectionId:o}=e;const i=Bt({currentUserId:t,spaceId:n}),r=P.jj([o,...i]).slice(0,10);M.Z.set({userId:t,key:Et(n),value:JSON.stringify(r)})}({currentUserId:t.currentUser.id,spaceId:B.id,collectionId:s.id})}d&&(s&&n.getCollectionViewSourceCollectionStore()&&!s.getName()?Ct({environment:t,collectionContextStore:c}):!s&&c.hasSingleCollection()&&Pe.r$({collectionContextStore:c,collectionSettingsStore:c.settingsStore})),c.frozoneStore.setState({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1})}}function Qe(e){const{collectionContextStore:t}=e,{localResultStore:n,remoteRequestStore:o,remoteRequestStoreCallback:i,localResultStoreCallback:r}=t;i&&o.removeListener(i),r&&n.removeListener(r),t.infiniteScrollLongTaskObserver.disconnect()}function Ye(e){const{dateRangeStart:t,dateRangeEnd:n,collectionContextStore:o}=e;o.dateRangeStart.setState(t),o.dateRangeEnd.setState(n)}function Je(e){const{searchQuery:t,collectionContextStore:n}=e;n.collectionViewStore()&&(n.searchQuery.setState(t||""),n.groupsStore.resetAllLimits())}function Xe(e){const{environment:t,collectionViewBlockStore:n,collectionView:o,transaction:i}=e,r=Ze.ae({environment:t,table:L.n,value:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i}),a=ke.Xr.createChildStore(n,{table:L.n,id:r.id,spaceId:n.getSpaceId()});return Be.R3({parent:n.getCollectionViewsStore(),append:a,transaction:i}),a}function et(e){const{environment:t,collectionContextStore:n,collectionViewStore:o,intl:i,transaction:r}=e,a=n.collectionViewBlockStore();if(!a)return;const s=o.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(o)}));if(!s)return;return Xe({environment:t,collectionViewBlockStore:a,collectionView:{...s,id:(0,B.ZP)(),name:(0,w.nM)(s.name||i.formatMessage(te.b1[s.type]))},transaction:r})}function tt(e){var t,n,o;const{environment:r,collectionContextStore:a,transaction:l}=e,c=a.collectionViewBlockStore(),d=a.collectionViewStore(),u=a.settingsStore;if(!c)return;const p=null===(t=a.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_subitem,m=null===(n=a.collectionStore())||void 0===n||null===(n=n.getFormat())||void 0===n?void 0:n.collection_default_arrows_by,f=Xe({environment:r,collectionViewBlockStore:c,collectionView:{type:"table",parent_id:c.id,parent_table:s.iU,alive:!0,space_id:c.getSpaceId(),format:{table_properties:null==d||null===(o=d.getFormat())||void 0===o?void 0:o.table_properties,collection_view_subitem:p?{property:p}:void 0,timeline_arrows_by:m?{property:m}:void 0,table_subitem_toggle_column:"title",...d&&"collectionTypedView"===a.contextType?{collection_view_source:d.getFormat().collection_view_source,property_filters:d.getFormat().property_filters}:{}}},transaction:l});xt({environment:r,collectionContextStore:a,collectionViewId:f.id,isFullScreen:a.isFullScreen.state,isRootChild:a.isRootChild.state,isInPeekRenderer:a.isInPeekRenderer.state}),i.default.afterNextFlush((()=>{c.getCollectionViewSourceCollectionStore()?(Pe.r$({collectionContextStore:a,collectionSettingsStore:u}),Pe.wl({collectionSettingsStore:u,item:{type:"createView"}})):Pe.r$({collectionContextStore:a,collectionSettingsStore:u})}))}function nt(e){const{collectionViewBlockStore:t,collectionViewStore:n,transaction:o}=e,i=ke.Xr.createChildStore(t,{table:L.n,id:n.id,spaceId:t.getSpaceId()}),r=n.getFormat().app_config_uri;if(r){var a;const e=null===(a=t.getFormat())||void 0===a?void 0:a.app_uri_map;e&&delete e[r],De.FH({stores:[t],update:{app_uri_map:e},transaction:o})}Be.Od({parent:t.getCollectionViewsStore(),childToRemove:i,transaction:o})}function ot(e){const{collectionViewBlockStore:t,newViewIds:n,transaction:o}=e,i=t.getCollectionViewStores(),{beforeOps:r}=(0,S.q)(i.map((e=>e.id)).slice(0,n.length),n);P.Ed(r,((e,i)=>{const r=ke.Xr.createChildStore(t,{table:L.n,id:i,spaceId:t.getSpaceId()});if(e)Be.Vt({parent:t.getCollectionViewsStore(),insert:r,before:ke.Xr.createChildStore(t,{table:L.n,id:e,spaceId:t.getSpaceId()}),transaction:o});else{const e=P.Z$(n.filter((e=>e!==i)));Be.BE({parent:t.getCollectionViewsStore(),insert:r,after:e?ke.Xr.createChildStore(t,{table:L.n,id:e,spaceId:t.getSpaceId()}):void 0,transaction:o})}}))}function it(e){const{collectionViewStore:t,update:n,transaction:o}=e;Ze.sW({store:t,data:n,transaction:o})}function rt(e){const{collectionViewStore:t,update:n,transaction:o}=e;Ze.sW({store:t.getQueryStore(),data:n,transaction:o})}function at(e){const{environment:t,collectionStore:n,update:o,transaction:i}=e,r=n.getSchema();o.schema&&(o.schema=h.Fn(o.schema)),o.deleted_schema&&(o.deleted_schema=h.Fn(o.deleted_schema));const a={...o};if(o.deleted_schema){const e=n.getDeletedSchema(),t=(0,b.jf)({schemas:[e,o.deleted_schema],prioritizeLooserLimitRule:!0});t.error?I.log({level:"error",from:"collectionViewActions",type:"updateCollection",error:t.error}):a.deleted_schema=t.value}Ze.sW({store:n,data:a,transaction:i}),o.schema&&bt({environment:t,collectionStore:n,oldSchema:r,newSchema:o.schema,transaction:i})}function st(e){const{environment:t,collectionStore:n,update:o,transaction:i}=e,r=n.getSchema(),a=h.Fn(o);Ze.sW({store:n.getSchemaStore(),data:a,transaction:i}),bt({environment:t,collectionStore:n,oldSchema:r,newSchema:n.getSchema(),transaction:i})}function lt(e){const{collectionStore:t,update:n,transaction:o}=e;Ze.sW({store:(0,ke._J)(t,t.pointer,["deleted_schema"]),data:n,transaction:o})}function ct(e){var t;const{environment:n,collectionContextStore:o,newViewType:i,transaction:r,intl:a}=e,s=o.collectionViewStore(),l=o.collectionViewBlockStore(),c=o.collectionStore();if(!s||!l)return;const d=o.normalizedSchemaStore.state;if(i===s.getType())return;const u=o.permissionScopes.state,p=s.getType();if(Ze.sW({store:s,data:{type:i},transaction:r}),"board"===p&&De.FH({stores:[s],update:{board_columns_by:void 0,collection_group_by:s.getFormat().board_columns_by},transaction:r}),"table"===i)Ze.sW({store:s.getQueryStore(),data:{aggregations:[{property:"title",aggregator:"count"}]},transaction:r});else if("board"===i){var m;let e=(null===(m=s.getFormat().collection_group_by)||void 0===m?void 0:m.property)??te.Se(d);if(c&&!e){e=(0,E.ZP)();const t={name:a.formatMessage(He.statusName),type:"select",options:[]};u.canConfigureCollection&&st({environment:n,collectionStore:c,update:{[e]:t},transaction:r})}const t=o.normalizedSchemaStore.state,i=e&&t[e];if(!e||!i||!(0,g.LG)(i))return;De.FH({stores:[s],update:{board_columns_by:(0,g.fw)(e,i,"collectionTypedView"===o.contextType),collection_group_by:void 0},transaction:r})}else if("calendar"===i){let e=te.PD(d);if(c&&!e){e=(0,E.ZP)();const t={name:a.formatMessage(He.dateName),type:"date"};u.canConfigureCollection&&st({environment:n,collectionStore:c,update:{[e]:t},transaction:r})}Ze.sW({store:s.getQueryStore(),data:{aggregations:[],calendar_by:e},transaction:r})}else if("gallery"===i)De.FH({stores:[s],update:{gallery_cover:{type:"page_content"}},transaction:r}),Ze.sW({store:s.getQueryStore(),data:{aggregations:[]},transaction:r});else if("list"===i){const e=Object.keys(d).find((e=>{const t=d[e];return Boolean(t&&(0,X.Rb)(t))}));De.FH({stores:[s],update:{list_properties:e?[{property:e,visible:!0}]:[]},transaction:r}),Ze.sW({store:s.getQueryStore(),data:{aggregations:[]},transaction:r})}else if("timeline"===i){let e=te.HI(d);if(c&&!e){e=(0,E.ZP)();const t={name:a.formatMessage(He.dateName),type:"date"};u.canConfigureCollection&&st({environment:n,collectionStore:c,update:{[e]:t},transaction:r})}Ze.sW({store:s.getQueryStore(),data:{aggregations:[{property:"title",aggregator:"count"}],timeline_by:e},transaction:r})}const f=null===(t=s.getFormat().collection_view_subitem)||void 0===t?void 0:t.property;if(f&&!(0,ne.Av)(i)){const e=p&&!(0,ne.Av)(i)?(0,k.oz)(p):void 0,t=(e?s.getFormat()[e]??[]:[]).find((e=>e.property===f))??{property:f,visible:!0},n=(0,k.oz)(i),o=s.getFormat()[n]??[];De.FH({stores:[s],update:{[n]:[...o,t]},transaction:r})}ut({collectionContextStore:o})}function dt(e){const{icon:t,collectionViewBlockStore:n,transaction:o}=e;De.FH({stores:[n],update:{collection_view_icon:t},transaction:o})}function ut(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(!n)return;const o=ue.R.findCollectionViewBlockFromStore(n);null!=o&&o.resetLeftScrollAfterFlush&&o.resetLeftScrollAfterFlush()}function pt(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(n){const e=ue.R.findCollectionViewBlockFromStore(n);if(e){const t=e.getNode();t&&(0,se.Wr)(t,{edgeDist:0,animate:!1})}}}function mt(e){var t,n,o,i;const{collectionContextStore:r,collectionStore:a,transaction:s}=e,l=r.collectionViewStore();if(!l||!a.isDefined())return;const c=te.Vv(a),d=null===(t=a.getFormat())||void 0===t?void 0:t.collection_default_subitem,u=null===(n=a.getFormat())||void 0===n?void 0:n.collection_default_arrows_by,p={table_properties:null==c||null===(o=c.getFormat())||void 0===o?void 0:o.table_properties,collection_pointer:{table:U.v,id:a.id,spaceId:a.getSpaceId()},collection_view_subitem:d?{property:d}:void 0,timeline_arrows_by:u?{property:u}:void 0,table_subitem_toggle_column:"title"},m=null==r?void 0:r.normalizedSchemaStore.state;Ze.sW({store:l,data:(0,W.Q2)({format:p,query2:{sort:null==c||null===(i=c.getQuery(m))||void 0===i?void 0:i.sort}}),transaction:s})}function ft(e){var t;const{environment:n,name:o,collectionViewStore:i,collectionViewBlockStore:r,transaction:a}=e,s=i.getType();if(!s||!r.isDefined())return;const l=r.getCollectionPointer(),c=r.getFormat(),d=(0,z.QaF)(null===(t=r.getTitleStore())||void 0===t?void 0:t.getValue()),p=l||o||!d?o:d,m=(0,$.Yu)({environment:n,isInline:r.getType()===u.Ti.collectionView,name:p,viewType:s}),f=F.Ao.create();f.set({table:L.n,id:"collection_view"},i.pointer),Ae.ZI({environment:n,sourceBlockId:"root",targetBlockPointer:r.pointer,sourceBlockSubtree:m?(0,F.R3)(m):F.Ak.create(),targetRecordCache:r.inMemoryRecordCache,transaction:a,recordPointerMap:f,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:r.useCrdt()});const g=f.get({table:U.v,id:"collection"});if(!g)return;De.FH({stores:[r],update:{collection_pointer:g},transaction:a});const h=r.getCollectionStore();h&&(at({collectionStore:h,update:{icon:null==c?void 0:c.page_icon,cover:null==c?void 0:c.page_cover},environment:n,transaction:a}),De.FH({stores:[h],update:{collection_cover_position:null==c?void 0:c.page_cover_position},transaction:a}))}function gt(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;if(t.getCollectionPointer())throw new Error("CollectionViewBlock already has a collection");De.FH({stores:[t],update:{collection_pointer:n.pointer},transaction:o})}function ht(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;[t].forEach((e=>{var t;e.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===n.id})).forEach((t=>nt({collectionViewBlockStore:e,collectionViewStore:t,transaction:o}))),(null===(t=e.getFormat().collection_pointer)||void 0===t?void 0:t.id)===n.id&&Ze.sW({store:e,data:{format:{...e.getFormat(),collection_pointer:void 0},collection_id:null},transaction:o})})),Fe.hh({childStore:n,transaction:o})}function vt(e){const{environment:t,collectionStore:n,performTransaction:o}=e;return Ne.createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:t,perform:e=>{const i=n.getSchema(),r=o(e),a=n.getSchema();return bt({environment:t,collectionStore:n,oldSchema:i,newSchema:a,transaction:e}),r}}).performResult}function bt(e){const{environment:t,collectionStore:n,oldSchema:o,newSchema:i,transaction:r}=e,a=h.Fn(o),s=h.Fn(i),l=Object.keys(s);for(const d of l){const e=a[d],o=s[d];if(o){if("status"===o.type&&"status"!==(null==e?void 0:e.type)){let i;i="select"===(null==e?void 0:e.type)||"multi_select"===(null==e?void 0:e.type)?(0,m.r9)(o.name,e.options??[],ie.default.getIntl()):o.groups&&o.options&&o.defaultOption?o:h.I4(o.name,ie.default.getIntl());const a={...s,[d]:i};if(Ze.sW({store:n,data:{schema:a},transaction:r}),"checkbox"===(null==e?void 0:e.type)&&"status"===o.type){const e=i.groups??[],o=e[e.length-1];o&&Me.hz({environment:t,collectionStore:n,property:d,oldValue:{type:"checkbox",value:!0},newValue:{type:"status",value:{type:"by_group",group:o.name}},transaction:r})}}if("status"===(null==e?void 0:e.type)&&"checkbox"===o.type){const o=e.groups??[],i=e.options??[],a=o[o.length-1],s=i.filter((e=>{var t;return null==a||null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id)}));for(const e of s)Me.hz({environment:t,collectionStore:n,property:d,newValue:{type:"checkbox",value:!0},oldValue:{type:"status",value:{type:"by_option",option:e.value}},transaction:r})}}}for(const d of l){const e=a[d],o=s[d];!o||e&&h.cu(e)||!h.cu(o)||Te.getSelectPropertyValues(t,{collection:{id:n.id,spaceId:(0,O.C)(n.pointer.spaceId)},property:d}).then((e=>{if("failed"===e.type)throw e.error;const{results:i}=e.data,r=o.options||[],a=h.Fn(n.getSchema()),s=P.mN([...r,...i.map((e=>({id:(0,E.ZP)(),value:e})))],(e=>e.value)),l={...o,options:s},c={...a,[d]:l};Ne.createAndCommit({userAction:"collectionViewActions.handleCollectionSchemaUpdated",environment:t,perform:e=>{Ze.sW({store:n,data:{schema:c},transaction:e})}})})).catch((()=>{}))}const c=P.jj([...Object.keys(a),...Object.keys(s)]);for(const d of c){const e=a[d],o=s[d],i=e&&h.cu(e)||"status"===(null==e?void 0:e.type),l=o&&h.cu(o)||"status"===(null==o?void 0:o.type);if(i&&l&&e.type===o.type){const i=o,a=e.options||[],s=i.options||[],l=P.jj([...a.map((e=>e.id)),...s.map((e=>e.id))]);for(const c of l){const i=a.find((e=>e.id===c)),l=s.find((e=>e.id===c));if(i&&l&&i.value!==l.value){const a="status"===e.type?{type:"status",value:{type:"by_option",option:i.value}}:{type:e.type,value:i.value},s="status"===o.type?{type:"status",value:{type:"by_option",option:l.value}}:{type:o.type,value:l.value};Me.hz({environment:t,collectionStore:n,property:d,oldValue:a,newValue:s,transaction:r})}}}}for(const d of c){const e=s[d];"button"!==(null==e?void 0:e.type)||e.automation_id||K.Hj({environment:t,collectionStore:n,property:d,transaction:r})}}function yt(e){const{store:t,environment:n}=e;let o;We.cR({environment:n,bucket:"temporary",onStart:e=>{o=e,Ee.j({message:qe.uploadingCSV})},onComplete:e=>{(async(e,o)=>{Ee.j({message:qe.importingCSV});const i=t.getCollectionViewCollectionStore();if(!i)return;if(!ue.R.findCollectionViewBlockFromStore(t))return;const{value:r}=await Te.importFile(n,{importType:"MergeIntoCollection",fileURL:e,fileName:o,collection:{id:i.id,spaceId:(0,O.C)(i.pointer.spaceId)}}).next();r.error&&Re.showErrorMessage(ie.default.formatMessage(qe.importFailed)),Ee.x()})(e[0],o[0].name)},onError:e=>{Ee.x(),Re.showErrorMessage(ie.default.formatMessage(qe.importFailed))}})}async function _t(e,t,n){const o=t.collectionViewStore(),{remoteRequestStore:i}=t;if(!i||!o)return;const r=i.state;if(!r)return;const l=t.createUpdateCounter(),c=t.remoteResult.state;be.Z.state.online&&c&&await we.transactionQueue.drain();const d=o.inMemoryRecordCache;if(!t.shouldUpdate(l))return;t.isLoading.setState(!0);const u=le.default.mark("collections.remote_query_collection_latency");let p;if(d===e.defaultRecordCache.inMemoryRecordCache&&be.Z.state.online){const o="initial_load"===n.src?(0,X.Cg)(r):r,i=[];if(ye.default.checkGate("collection_split_aggregation_v2")&&"msg"!==n.src&&!Object.values(o.loader.reducers||{}).some((e=>"groups"===e.type))){let a=!1;const s={};Object.entries(o.loader.reducers||{}).forEach((e=>{let[t,n]=e;"aggregation"!==n.type?s[t]=n:a=!0}));const c={...o,loader:{...o.loader,reducers:s},aggregationStatus:a?"stripped":void 0};if(p=Te.queryCollection(e,c,void 0,n,void 0,"queryCollection").then((o=>{const i=Y.vS(t,n.src);if(le.default.measure(u,{environment:e,data:i}),"success"===o.type)return"initial_load"===n.src&&N.Z.set((0,ae.Z)(r.collectionView.id),c),St({environment:e,remoteRequest:r,collectionContextStore:t,response:o.data,updateCounter:l,keepAggregationResults:a})})),i.push(p),a){t.asyncAggregationStatus.setState({...t.asyncAggregationStatus.state,calculating:!0});const o=p.then((()=>Te.queryCollection(e,{...r,aggregationStatus:"full"},void 0,n,void 0,"queryCollection").then((n=>{if("success"===n.type)return St({environment:e,remoteRequest:r,collectionContextStore:t,response:n.data,updateCounter:l})})).finally((()=>{t.asyncAggregationStatus.setState({calculating:!1})}))));i.push(o)}}else p=Te.queryCollection(e,o,void 0,n,void 0,"queryCollection").then((o=>{const i=Y.vS(t,n.src);if(le.default.measure(u,{environment:e,data:i}),"success"===o.type)return"initial_load"===n.src&&N.Z.set((0,ae.Z)(r.collectionView.id),r),t.asyncAggregationStatus.setState({calculating:!1}),St({environment:e,remoteRequest:r,collectionContextStore:t,response:o.data,updateCounter:l})})),i.push(p);if(!(await(0,D.OI)(1e4,i)).timeout)return}else try{const n=await async function(e,t,n){const{source:o,collectionView:i,loader:r}=t,l=e.currentUser.id;let c;if("collection"!==o.type)throw new Error("TODO: support typed source");c={table:U.v,id:o.id};const d=Date.now(),u=await re.Ye({environment:e,pointer:c,inMemoryRecordCache:n});if(null==u||!u.model)throw new Error("Collection not found.");const p=u.model,m=await re.Ye({environment:e,pointer:{table:L.n,id:i.id},inMemoryRecordCache:n});if(null==m||!m.model)throw new Error("Collection view not found.");const f=R.s8.fromMonomorphicFunctionUnsafe((async t=>{const n=await re.Ye({environment:e,pointer:t});return null==n?void 0:n.model})),g=m.model,h=F.Ak.create(),b=R.om.fromRecordMap(h),y=p.getNormalizedSchema(),{groupsReducerIds:_,reducerIdsWithNoGroupDependencies:S}=v.x3(r.reducers,r.reducerDependencies),w=ye.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),k={schema:y,pageSort:(null==g?void 0:g.getPageSort())||[],collectionViewId:i.id,loader:r,userId:l,userStartOfWeek:G.AK.state,currentTime:d,getRecordModel:b,intl:ie.default.getIntl(),isSorted:!1,relativeVariableResult:void 0,isSprintPlanningView:(null==g?void 0:g.getAppConfigUri())===a.sV,collectionSourceType:o.type,groupsReducerIds:_,reducerIdsWithNoGroupDependencies:S,formulaTimeoutMs:w,resultCache:new Map},I=p.__IM_SORRY__getValue(),x=v.fk(k),C=(await re.ne({environment:e,collection:p,inMemoryRecordCache:n})).filter((e=>{let{model:t}=e;return null==t?void 0:t.alive})),T=P.oA(C.map((e=>{let{model:t}=e;return null==t?void 0:t.__IM_SORRY__getValue()}))),M=(r.reducers?Object.values(r.reducers):[]).some((e=>Boolean("results"===e.type&&e.loadContentCover))),A=new Map,{filterStageDependencies:D,incrementStageDependencies:B}=await v.Ct({collectionValue:I,loader:r,loadAllProperties:!1,recordMap:h,loadRecordModel:f,dependencyCache:A}),E=[...D,...B];await v.c_({blocks:T,dependencies:E,recordMap:h,loadRecordModel:f,dependencyCache:A,resultCache:k.resultCache}),M&&await v.jF({blocks:T,loadRecordModel:f,recordMap:h});for(const a of T)v.BW(a,I,k,x);const{result:Z}=v.kk(k,x),V=F.PF.create(),j=v.aW({result:Z});return await Promise.all(j.map((async t=>{const o=await re.Ye({environment:e,pointer:{table:s.iU,id:t},inMemoryRecordCache:n});o&&V.setModelAndRole({table:s.iU,id:t},o.model,o.role)}))),V.setModelAndRole(c,u.model,u.role),V.setModelAndRole({table:L.n,id:i.id},m.model,m.role),{result:Z,recordMap:V.toJson({allowVersionDowngrade:!1}),relativeVariableResult:void 0,collectionIds:void 0,shouldUseClientMode:!1,isViewSpecificClientMode:!1,allBlockIds:void 0}}(e,r,d),o=F.PF.create(n.recordMap);Ve.fL({environment:e,inMemoryRecordCache:d,recordMap:o,debugSource:"collectionViewActions.fetchRemoteResult (localResponse)"}),await St({environment:e,collectionContextStore:t,remoteRequest:void 0,response:n,updateCounter:l})}catch(m){}finally{t.resetLoadingState()}p&&p.catch((e=>{}))}async function St(e){const{environment:t,remoteRequest:n,collectionContextStore:o,response:i,updateCounter:r,keepAggregationResults:a}=e,s=o.collectionViewStore();if(!o.shouldUpdate(r))return;if(T.H1.is(i)){for await(const l of i)if("reducer"===l.type){const e=o.remoteResult.state,t=null==e?void 0:e.reducerResults[l.name];if(!t||!P.Xy(t,l.result)){const t={type:"reducer",reducerResults:{...null==e?void 0:e.reducerResults,[l.name]:l.result}};o.remoteResult.setState(t);const n=new Set(v.aW({result:t,onlyTypes:["results"]}));o.resultSet.resetWithRemote(n)}}else if("sizeHint"===l.type){const e=o.remoteResult.state,t={type:"reducer",reducerResults:(null==e?void 0:e.reducerResults)??{},sizeHint:l.sizeHint};o.remoteResult.setState(t)}else if("relativeVariableResult"===l.type)o.relativeVariables.setState({...o.relativeVariables.state,...l.relativeVariableResult});else if("collectionIds"===l.type){const e=o.remoteCollectionIds.state;P.Xy(e,l.collectionIds)||o.remoteCollectionIds.setState(l.collectionIds)}}else{const e=o.remoteResult.state;if(!e||!P.Xy(e,i.result)){const t=i.result;if("reducer"===i.result.type){if(a){const n=Object.entries((null==e?void 0:e.reducerResults)||{}).filter((e=>{let[t,n]=e;return"aggregation"===n.type})).reduce(((e,t)=>{let[n,o]=t;return e[n]=o,e}),{});t.reducerResults={...n,...t.reducerResults}}o.remoteResult.setState(t)}if(i.shouldUseClientMode)o.isClientModeEnabled.setState(!0),o.isViewSpecificClientModeEnabled.setState(Boolean(i.isViewSpecificClientMode)),o.resultSet.resetWithRemote(i.allBlockIds);else{const e=new Set(v.aW({result:i.result,onlyTypes:["results"]}));o.resultSet.resetWithRemote(e)}}const n=o.remoteCollectionIds.state,r=i.collectionIds||[];P.Xy(n,r)||o.remoteCollectionIds.setState(r),_e.Z.addFromRecordMapWithRoleJson(i.recordMap),_e.Z.isEmpty()||ze.dY({environment:t}),o.relativeVariables.setState({...o.relativeVariables.state,...i.relativeVariableResult})}if(o.remoteResult.state&&(o.resetLoadingState(),o.isLoaded.setState(!0),a||o.lastRemoteRequest.setState(n),s)){const e=Vt(s);oe.y.set(e,{remoteResult:o.remoteResult.state,resultSet:o.resultSet.state,collectionIds:o.remoteCollectionIds.state})}}function wt(e,t){const{blockIds:n,hasLocalUpdates:o}=t.resultSet.state,i=t.collectionViewStore(),r=e.currentUser.id,c=t.remoteRequestStore.state,u=t.remoteResult.state;if(!i||!i.isDefined()||!c)return;const p=Date.now(),m=ie.default.getIntl(),f=i.getRecordModel,g=i.getFormat(),h=i.getType(),_=i.getCollectionSource();if(!_)return;const S=t.collectionStoresStore.state,w=[];for(const a of S){const e=f(a);e&&w.push(e)}if(0===w.length)return;t.isLoaded.setState(!1);const k=w.some((e=>Se.Z.getEditedBlocksForCollection(e.id).size>0)),I=P.Xy(t.lastRemoteRequest.state,c);if(!k&&u&&!o&&I)return t.isLoaded.setState(!0),u;const x=le.default.mark("collections.compute_local_result_latency");let T={};switch(t.contextType){case"collectionTypedView":const e=(t.databaseType&&(0,a.uV)(m))??{},n=(0,b.jf)({schemas:[...w.map((e=>{var t;const n=null==e||null===(t=e.getFormat())||void 0===t?void 0:t.app_uri_map,o=e.getNormalizedSchema();return b.aQ.toViewSchema(o,n)})),e],onlyPropertyIds:Object.keys(e),prioritizeLooserLimitRule:!0});if(n.error)throw n.error;T=n.value;break;case"collectionVirtualView":case"collectionView":case"collectionViewBlock":case"collectionPage":case void 0:T=w[0].getNormalizedSchema();break;default:(0,l.t1)(t.contextType)}const M=v.ps(g,h,T),A=t.relativeVariableStore.state,{groupsReducerIds:D,reducerIdsWithNoGroupDependencies:B}=v.x3(c.loader.reducers,c.loader.reducerDependencies),E=ye.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),F={pageSort:i.getPageSort(),schema:T,loader:c.loader,userId:r,userStartOfWeek:G.AK.state,currentTime:p,getRecordModel:me.default.getCurrentBlockModelFn(),intl:ie.default.getIntl(),isSorted:!1,visibleProperties:M,relativeVariableResult:A,isSprintPlanningView:g.app_config_uri===a.sV,collectionSourceType:_.type,groupsReducerIds:D,reducerIdsWithNoGroupDependencies:B,formulaTimeoutMs:E,resultCache:new Map},Z={...F,loader:{...c.loader,filter:void 0}},V=u?new Set(v.aW({result:u,onlyTypes:["results"]})):new Set,j=v.fk(F);for(const a of n){const e=ke.G.createChildStore(i,{table:s.iU,id:a}),n=e.getAssociatedCollectionStore();if(y.Sl.hasCollections(_)&&(!n||!S.find((e=>{let{id:t}=e;return n.id===t}))))continue;const o=f(e);let r;switch(t.contextType){case"collectionVirtualView":if((0,y.nx)(_)){const e=(0,de.Ep)((0,C.Eq)(_));r=e&&R.kk.fromCollection(d({source:_,collectionId:e}))}break;case"collectionTypedView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:r=n&&f(n);break;default:(0,l.t1)(t.contextType)}if(!r||!o)continue;const u={...c.loader.upwardTraversalRelation&&V.has(a)&&(0,ne.uU)({block:R.kk.fromBlock(o),collectionContextStore:t})&&!t.isClientModeEnabled.state?Z:F,schema:(0,b.Hs)(_.type,T,r)};v.BW(o,r,u,j)}for(const a of w){const e=Se.Z.getEditedBlocksForCollection(a.id),t=(0,b.Hs)(_.type,T,a);for(const o of e){if(n.has(o))continue;const e=f(ke.G.createChildStore(i,{table:s.iU,id:o}));e&&v.BW(e,a,{...F,schema:t},j)}}const{result:U}=v.kk(F,j);if(t.isLoaded.setState(!0),"reducer"!==U.type)return;const L=Y.vS(t);return le.default.measure(x,{environment:e,data:L}),U}function kt(e,t){const n=t.collectionViewStore(),o=t.searchQuery.state;if(!n)return;const i=t.currentSubitemFormatStore.state,r=null==n?void 0:n.getType(),a=(0,Q.ze)(t),s=t.currentSortsStore.state,l=function(e){const t=e.reducers.state,n={};return P.Ed(t,((e,t)=>{e&&(n[t]=e.reducer)})),n}(t);if(P.xb(l))return;let c;if(t.reducerDependencies.size>0){c={};for(const[e,n]of t.reducerDependencies)c[e]=[...n]}const d=(0,O.C)(n.pointer.spaceId),u=n.getCollectionSource();if(!u)return;const p=t.normalizedSchemaStore.state,m=(null==i?void 0:i.property)&&p[i.property];return{source:u,collectionView:{id:n.id,spaceId:d},loader:{type:"reducer",reducers:l,filter:a,sort:s,searchQuery:o,userId:e.currentUser.id,userTimeZone:(0,x.r)(),...m&&(0,h.p_)(m)&&r&&(0,ne.Av)(r)&&{upwardTraversalRelation:m},reducerDependencies:c}}}function It(e){const{reducerId:t,instanceId:n,reducer:o,collectionContextStore:i,groupsPointer:r}=e,a=i.reducers.state,s=a[t];let l,c;if(r&&r.length>0&&(l=(0,g.KW)(r)),o){if(c={instanceIds:P.jj([...(null==s?void 0:s.instanceIds)||[],n]),reducer:o},l){i.reducerDependencies.has(l)||i.reducerDependencies.set(l,new Set);const e=i.reducerDependencies.get(l);null==e||e.add(t)}}else{if(l){const e=i.reducerDependencies.get(l);e&&(e.delete(t),0===e.size&&i.reducerDependencies.delete(l))}const e=P.zu((null==s?void 0:s.instanceIds)||[],n);c=s&&e.length>0?{instanceIds:e,reducer:s.reducer}:void 0}P.Xy(s,c)||i.reducers.setState({...a,[t]:c})}function xt(e){const{environment:t,collectionViewId:n,openInNew:o,collectionContextStore:i,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}=e,c=i.collectionViewBlockStore();if(c){if(c===me.default.state.mainEditorCurrentBlockStore||o)H._({environment:t,store:c,openInNew:o,collectionViewId:n,pageVisitSource:r.tY.ChangeCollectionView});else{const e=new ke.Xr(t,{table:L.n,id:n},{inMemoryRecordCache:c.inMemoryRecordCache}),o=e.getCollectionStore();$e({environment:t,collectionViewBlockStore:c,collectionViewStore:e,collectionStore:o,collectionContextStore:i,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}),M.Z.set({userId:t.currentUser.id,key:ge.Z.getLocalViewPreferenceKey(c.id),value:n})}ut({collectionContextStore:i})}}function Ct(e){const{environment:t,collectionContextStore:n}=e;let o=n.collectionStore();const i=n.collectionViewBlockStore();if(!o||!i)return;const{mainEditorCurrentBlockStore:r}=me.default.state;r&&n.isFullScreen.state&&(o=ke.NW.createChildStore(r,o.pointer)),Oe.mT({environment:t,store:o.getNameStore(),canSelectAllBlocks:!1})}function Tt(){Le.MO(),function(){const e=ve.Z.state,t=Ie.default.state;if(e.isActive&&1===t.stores.length&&t.stores[0].id===e.store.id)return;Pt()}()}function Mt(e){const{store:t,transient:n}=e;ve.Z.setState({isActive:!0,store:t,transient:Boolean(n)})}function Pt(){ve.Z.setState({...ve.Z.state,isActive:!1})}function At(e){const{store:t}=e;"new"===he.Z.state.editMode&&he.Z.state.store.id===t.id&&he.Z.reset()}function Rt(e){const{environment:t,update:n,transaction:o,collectionStore:i}=e;Ze.ae({environment:t,table:V.cv,value:n.newAutomationValue,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o});for(const r of n.newAutomationActionValues)Ze.ae({environment:t,table:j.Xj,value:r,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o})}async function Dt(e){const{environment:t,collectionContextStore:n,blockIdToMinimumVersion:o}=e;await async function(e,t){return await Promise.all((0,l.qP)(t).map((async t=>{let[n,o]=t;return Ve.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:s.iU,id:n},userId:e.currentUser.id,minimumVersion:o})})))}(t,o),n.resultSet.addLocalChange(Object.keys(o))}function Bt(e){let{currentUserId:t,spaceId:n}=e;const o=M.Z.get({userId:t,key:Et(n)});if(o){const e=(0,W.dj)(o);return Array.isArray(e)?e:[]}return[]}function Et(e){return`getRecentlyNavigatedCollections:${e}`}function Ft(e){let{currentUserId:t,collectionViewId:n,temporaryState:o}=e;const i=Zt(n);o?M.Z.set({userId:t,key:i,value:JSON.stringify(o)}):M.Z.remove({userId:t,key:i})}function Zt(e){return`collectionViewTemporaryState2:${e}`}function Vt(e){const t=e.id,n=e.getCollectionSource();return"trending"===(null==n?void 0:n.type)?{collectionViewId:t,teamId:n.teamId}:{collectionViewId:t}}function jt(e){var t;const{store:n,typedDatabases:o,environment:i}=e,r=te.fm(n);if(!(0,xe.M_)(i))return;i.device.isMobile&&pe.close();const a=null===(t=n.getCollectionViewStores().at(0))||void 0===t?void 0:t.id;if(!r&&!a)return;const s=r??new ge.Z(i);if(!r&&a){const e=ke.Xr.createChildStore(n,{table:L.n,id:a});$e({environment:i,collectionViewBlockStore:n,collectionViewStore:e,collectionStore:void 0,collectionContextStore:s,isFullScreen:!0,isRootChild:!0,isInPeekRenderer:!1}),s.remoteCollectionIds.setState(o.map((e=>e.id)))}else 0===s.collectionStoresStore.state.length&&s.remoteCollectionIds.setState(o.map((e=>e.id)));Ne.createAndCommit({userAction:"collectionViewActions.handleAddMultiSourceViewPageButtonClick",environment:i,perform:e=>{Ut({transaction:e,store:n,collectionContextStore:s,environment:i,shouldCoerce:!0,showMoveTo:!0,peekModeOverride:"center_peek",from:"sidebar_new_page_button",useCrdt:!1})}})}function Ut(e){const{transaction:t,store:n,collectionContextStore:o,environment:i,shouldCoerce:a,showMoveTo:s,peekModeOverride:l,from:c,useCrdt:d}=e,u=Me.IW({environment:i,collectionContextStore:o,groupsPointer:[],insertAtIndex:0,shouldCoerce:a,initializeDefaultTemplate:a,transaction:t,from:c,useCrdt:d});if(!u)return;let p=te.kr(o.collectionViewStore());l&&(p=l);const m=(0,G.qG)(n.id),f="collectionTypedView"===o.contextType,g=o.isCompactView.state;Ue.CH({environment:i,store:u.newStore,peekMode:p,showMoveTo:s,resultsStore:void 0,collectionContextStore:o,pageVisitSource:m?g?r.tY.PersonalHomeTileTasksCreate:r.tY.PersonalHomeTasksCreate:r.tY.Create});const h=f?u.newStore.getParentCollectionId():void 0;return Ce.W2j(i,{from:c,type:"page",new_page_id:u.newStore.id,creating_block_id:u.newStore.id,...Y.Pn(o,h)}),u.newStore}},30188:(e,t,n)=>{n.d(t,{Bb:()=>ue,Cz:()=>he,FC:()=>oe,R2:()=>le,VP:()=>me,W9:()=>ge,YE:()=>de,cI:()=>ce,dR:()=>ie,e2:()=>ne,h5:()=>fe,i6:()=>pe,jA:()=>re,rT:()=>te,wA:()=>Y,xr:()=>ae});n(57658),n(21703),n(52262),n(24506),n(67294);var o=n(1302),i=n(15145),r=n(92996),a=n(41432),s=n(99036),l=n(80951),c=n(6695),d=n(72126),u=n(4615),p=n(21202),m=n(23867),f=n(29369),g=n(95371),h=n(39721),v=n(73597),b=n(70842),y=n(97880),_=n(82990),S=n(9291),w=n(75754),k=n(51592),I=n(77472),x=n(78316),C=n(77181),T=n(33929),M=n(29376),P=n(35328),A=n(80444),R=n(77556),D=n(77080),B=n(53730),E=n(26136),F=n(50906),Z=n(8406),V=n(54642),j=n(49865),U=n(16956),L=n(31869),O=n(47307),N=n(54532),z=n(96802),W=n(19785),q=n(9953),H=n(79978),K=n(42858),G=n(24677),$=n(82530),Q=n(85893);function Y(e){const{environment:t,transaction:n,blocks:o,action:i}=e,r=(0,x.fm)(o[0]);if(!r)return;const a=r.subitemTreeStore.state;if(!a)return;const s=r.currentSubitemFormatStore.state;if(!s||!s.property)return;const l=r.collectionViewBlockStore();if(!l)return;const c=new g.mp({store:l,pathKey:""},a.map((e=>e)).children),d=function(e,t){const n=new Set(e);let o,i;for(const r of v.JK(t)){if(!n.has(r.value.store)){if(o)return;continue}const e=(0,g.DY)([t],(e=>e===r));if(!e||e.length<2)return;if(o??=e,i=e,n.delete(r.value.store),0===n.size)break}if(o&&i)return b.T.fromNearestCommonAncestor(o,i)}(o,c);if(!d)return;const u=h.o.getIndentOperationsFromTreeRange(d,i),p=new Set,m=[],f="unindentSelf"===i?new Set(u.map((e=>e.target))):new Set;for(const v of u){const{target:e,operation:o}=v,i=(0,g.DY)([c],(t=>t===e));if(void 0===i)return;const a=i[i.length-2];if("indentSelfAndSubtree"===o){if(p.has(a)){p.add(e),m.push(e.value.store);continue}const o=a.children,i=o.indexOf(e);if(0===i)return;const l=o[i-1].value.store;J({environment:t,parentStore:a.value.store,previousSiblingStore:l,targetStore:e.value.store,subitemFormat:s,transaction:n}),m.push(E.G.createChildStore(l,e.value.store.pointer)),te({collectionContextStore:r,pathKey:(0,C.zV)(a.value.pathKey,l)})}else{if("unindentSelf"!==o)break;{var _;if(f.has(a)){f.delete(e),m.push(e.value.store);continue}if(1===i.length)return;const o=null===(_=i[i.length-3])||void 0===_?void 0:_.value.store;X({environment:t,parentStore:a.value.store,grandparentStore:o,targetStore:e.value.store,subitemFormat:s,transaction:n}),m.push(E.G.createChildStore(o&&o.isPageBlock()?o:r.collectionViewBlockStore(),e.value.store.pointer))}}if(h.F.applyMutable(c,v))if("indentSelfAndSubtree"===o)p.add(e);else if("unindentSelf"===o){const t=r.subitemExpandedStore.state,n=a.value.pathKey,o=t.get(n);0===a.children.length&&null!=o&&o.isExpanded&&(t.delete(n),r.subitemExpandedStore.emit()),f.delete(e)}else(0,y.t1)(o)}m&&G.Z5({environment:t,stores:m})}function J(e){const{environment:t,parentStore:n,previousSiblingStore:o,targetStore:i,subitemFormat:r,transaction:a}=e;n.isPageBlock()&&H.Bl({environment:t,sourceStore:n,destStore:i,propertyWithInverse:r,transaction:a}),H.hE({environment:t,sourceStore:o,destStore:i,propertyWithInverse:r,transaction:a,position:{type:"after"}})}function X(e){const{environment:t,parentStore:n,grandparentStore:o,targetStore:i,subitemFormat:r,transaction:a}=e;H.Bl({environment:t,sourceStore:n,destStore:i,propertyWithInverse:r,transaction:a}),o&&o.isPageBlock()&&H.hE({environment:t,sourceStore:o,destStore:i,propertyWithInverse:r,position:{type:"after",after:n.id},transaction:a})}function ee(e){var t,n;const{blocksToDuplicate:o,duplicatedBlocks:i,environment:r,transaction:a,migrateSubitemFormat:l,collectionContextStoreFromPage:c,originalSubitemSchemas:u}=e;if(o.length!==i.length)throw new Error("Error rebuilding relations. blocksToDuplicate and duplicatedBlocks must be the same length");const p=o.at(0);if(!p)return;const{from:m,to:f}=l||function(e){const t=(0,C.g0)(e);if(!t)throw new Error("Error rebuilding relations");const{subitemFormat:n}=t;return{from:n,to:n}}(p),g=(0,x.fm)(p)||c;if(!g)return;const h=(null===(t=g.collectionStore())||void 0===t?void 0:t.getSchema()[m.property])||(null==u?void 0:u.subitemRelationSchema),v=(null===(n=g.collectionStore())||void 0===n?void 0:n.getSchema()[m.inverse])||(null==u?void 0:u.parentRelationSchema);if(!(h&&v&&(0,s.p_)(h)&&(0,s.p_)(v)))return;const b=new Map(d.$R(o.map((e=>e.id)),i));d.$R(o,i).forEach((e=>{let[t,n]=e;const o=(0,C.CJ)({store:t,subitemFormat:{property:m.property},propertySchema:h}),i=(0,C.xb)({store:t,subitemFormat:m,propertySchema:v});o.forEach((e=>{const t=E.G.createChildStore(n,e),o=b.get(e.id);o&&(H.Bl({environment:r,sourceStore:n,destStore:t,propertyWithInverse:m,transaction:a}),H.hE({environment:r,sourceStore:n,destStore:o,propertyWithInverse:f,transaction:a,position:{type:"after"}}))})),i.forEach((e=>{const t=E.G.createChildStore(n,e);b.get(e.id)&&H.Bl({environment:r,sourceStore:t,destStore:n,propertyWithInverse:m,transaction:a})}))}))}function te(e){const{collectionContextStore:t,pathKey:n}=e,o=t.subitemExpandedStore.state,i=o.get(n);null!=i&&i.isExpanded||(o.set(n,{isExpanded:!0,limit:20}),t.subitemExpandedStore.emit())}function ne(e){const t=(0,x.fm)(e);if(!t)return;const n=t.subitemTreeStore.state,o=(0,g.DY)(n.children,(t=>t.value.store===e));if(!o)return;const i=o.map((e=>e.value.store.pointer)),r=(0,C.Af)(i),a=t.subitemExpandedStore.state,s=a.get(r);s&&s.isExpanded&&(a.delete(r),t.subitemExpandedStore.emit())}function oe(e){var t;const n=(0,x.fm)(e);if(!n)return;const o=n.subitemTreeStore.state,i=(0,g.DY)(o.children,(t=>t.value.store===e));if(!i)return;const r=n.currentSubitemFormatStore.state;if(!r)return;const a=null===(t=n.collectionStore())||void 0===t?void 0:t.getSchema()[r.property];if(!a||"relation"!==a.type)return;if(0===(0,C.CJ)({store:e,subitemFormat:r,propertySchema:a}).length)return;const s=i.map((e=>e.value.store.pointer));te({collectionContextStore:n,pathKey:(0,C.Af)(s)})}function ie(e){const{collectionViewStore:t,propertyId:n,transaction:o}=e,i=t.getType(),r=i&&!(0,C.Av)(i)?(0,c.oz)(i):void 0,a=r?t.getFormat()[r]??[]:[],s=(null==a?void 0:a.find((e=>e.property===n)))??{property:n,visible:!0},l=r?{[r]:[...a,s]}:{};z.FH({stores:[t],update:{collection_view_subitem:n?{property:n}:void 0,collection_view_toggle_by:n?{property:n}:void 0,...l},transaction:o})}function re(e){var t;const{collectionContextStore:n,relationPropertyId:o,transaction:i,environment:a}=e,s=n.collectionStore();if(!s)return;const l=o?s.getSchema()[o]:void 0,c="relation"===(null==l?void 0:l.type)&&l.property&&"relation"===(null===(t=s.getSchema()[l.property])||void 0===t?void 0:t.type)?l.property:void 0,d=s.getFormat().subitem_property&&o?"collectionViewSubitemActions.changeSubitemProperty":s.getFormat().subitem_property?"collectionViewSubitemActions.turnOffSubitems":"collectionViewSubitemActions.turnOnSubitems",u=D.default.checkGate("collection_level_subitems_setting");z.FH({stores:[s],update:{...u?{subitem_property:o}:{},collection_default_subitem:o,...s.getFormat().app_config_uri===r.iS?{app_uri_map:{...s.getFormat().app_uri_map?s.getFormat().app_uri_map:{},[r.Es.SubTaskRelation]:o,[r.Es.ParentTaskRelation]:c}}:{}},transaction:i}),I.j(a,"update_subitem_property",{userAction:d})}async function ae(e){const{environment:t,blocks:n,options:o}=e;if(n.some((e=>!e.isPageBlock())))return[];const i=d.Ps(n);if(!i)return[];const r=e.collectionContextStore??(0,x.fm)(i);if(!r)return[];const a=r.collectionStore();if(!a)return[];const l=r.currentSubitemFormatStore.state,c=r.normalizedSchemaStore.state,u=(null==l?void 0:l.inverse)&&c[l.inverse];if(!u||!(0,s.p_)(u))return[];const p=u.property;if(!p)return[];const m=a.id,f=a.getSpaceId();if(!n.some((e=>(0,C.CJ)({store:e,subitemFormat:l,propertySchema:u}).length>0)))return[];await B.transactionQueue.drain();const g=await V.getSubitems(t,{collection:{id:m,spaceId:f},blocks:n.map((e=>({id:e.id,spaceId:f}))),childRelationProperty:p,canEdit:null==o?void 0:o.canEdit});return"failed"===g.type?[]:g.data.blocks.map((e=>E.G.createChildStore(a,{table:"block",...e})))}function se(e){const t=d.Ps(e);if(!t)return[];const n=(0,x.fm)(t);if(!n)return[];const o=n.collectionStore(),i=n.collectionViewBlockStore();if(!o||!i)return[];const r=n.currentSubitemFormatStore.state,a=n.normalizedSchemaStore.state,l=(null==r?void 0:r.inverse)&&a[r.inverse];if(!l||!(0,s.p_)(l))return[];if(!l.property)return[];const c=new Set(e.map((e=>e.id)));let u=e;const p=[];for(;u.length>0;){const e=d.xH(u.map((e=>(0,C.CJ)({store:e,subitemFormat:r,propertySchema:l})))).filter((e=>!c.has(e.id))).map((e=>E.G.createChildStore(i,e)));for(const t of e)c.add(t.id);p.push(...e),u=e}return p}function le(e){let{environment:t,blocks:n,recordMaps:o,analyticsFrom:i,transaction:r,migrateSubitemFormat:a,collectionContextStore:s,originalSubitemSchemas:l}=e;const c=n.at(0);if(!c)return[];const d=e=>{const n=o?o.get(e.id):N.K8(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!n)throw new Error("Could not find cached copy of block during sub-item duplication.");return n};n.forEach((e=>{var n;const o=e.getModel();if(!o)return[];const{currentSpaceStore:r}=A.default.getState();let a;r&&o.getParentTable()===f.e0&&o.parent_id&&(a=E.zX.createChildStore(r,{table:f.e0,id:o.parent_id})),F.W2j(t,{from:i??"copy",type:o.type,teamStore:a,is_toggleable:(0,P._A)(o.type,o.getFormat()),collection_id:e.getParentCollectionId()??(null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.id),new_page_id:"page"===o.type?e.id:void 0,creating_block_id:e.id})}));const g=n.map((e=>N.E9({environment:t,transaction:r,sourceBlockId:e.id,targetBlockPointer:{id:(0,u.ZP)(),table:p.iU,spaceId:(0,m.C)(e.pointer.spaceId)},sourceBlockSubtree:d(e),targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:!1,deepCopyTransclusionContainers:!c.isTransclusionType(),resolveTemplateVariables:!(c.isInsideTemplate()||c.isInsideFactoryOrDuplicateBlocksAction()),useCrdt:!1}).targetBlock));return ee({blocksToDuplicate:n,duplicatedBlocks:g,environment:t,transaction:r,migrateSubitemFormat:a,collectionContextStoreFromPage:s,originalSubitemSchemas:l}),g}function ce(e){let{blocks:t,transaction:n,from:o,to:i,environment:r,subitemRelationSchema:a,relationPropertyCollectionId:s,originAction:l}=e;return t.forEach((e=>{(0,C.dI)({store:e,subitemFormat:{property:o.property},propertySchema:a,relationPropertyCollectionId:s,originAction:l}).forEach((t=>{const o=E.G.createChildStore(e,t);H.hE({environment:r,sourceStore:e,destStore:o,propertyWithInverse:i,transaction:n,position:{type:"after"}})}))})),t}async function de(e){let{droppedStores:t,createdStores:n,collectionStore:o,environment:i,collectionContextStore:r,groupsPointer:a,alreadyMovedToCollection:s,shouldDuplicate:l}=e;if(!D.default.checkGate("collection_subitem_nested_operations"))return;const c=t.at(0);if(!c)return;const d=(0,C.g0)(c);let u=(0,C.ko)(o);if(!d)return;const p=await ae({environment:i,blocks:t,options:{canEdit:!0}});if(p.length<=0)return;let m=[...p];if(l){const e=await ge({environment:i,blocks:p});e&&(m=[...e])}$.createAndCommit({userAction:"collectionGroupActions.handleGroupDrop.subitemsDrop",environment:i,perform:e=>{if(!u){ue({transaction:e,collectionContextStore:r,environment:i})&&(u=(0,C.ko)(o))}for(const t of m)j.mp({environment:i,store:t,collectionStore:o,collectionContextStore:r,groupsPointer:a,shouldCoerce:!0,transaction:e,alreadyMovedToCollection:s});u&&pe({blocksToDuplicate:[...t,...p],duplicatedBlocks:[...n,...m],environment:i,shouldDuplicate:l,originSubitemFormat:d.subitemFormat,destinationSubitemFormat:u,transaction:e,subitemRelationSchema:d.childRelationSchema,relationPropertyCollectionId:o.id})}})}function ue(e){let{transaction:t,collectionContextStore:n,environment:o}=e;const i=n.collectionStore(),r=n.collectionViewStore();if(!i)return;const a=n.normalizedSchemaStore.state,s=M.m8(T.default.getIntl(),{targetCollectionStore:i,isSelfRelation:!0,sourceSchema:a,createUnique:!0,from:"subitem"}),l=U.G3({environment:o,collectionStore:i,collectionViewArgs:r?{collectionViewStore:r,format:r.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:t});return L.n7({environment:o,collectionContextStore:n,collectionStore:i,property:l,propertyName:s,targetCollectionStore:i,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:T.default.getIntl(),transaction:t,from:"subitem"}),r&&ie({collectionViewStore:r,propertyId:l,transaction:t}),re({environment:o,collectionContextStore:n,relationPropertyId:l,transaction:t}),Z._H({environment:o,collectionContextStore:n,from:"subitem",property_type:"relation"}),l}function pe(e){let{blocksToDuplicate:t,duplicatedBlocks:n,environment:o,shouldDuplicate:i,originSubitemFormat:r,destinationSubitemFormat:a,transaction:s,subitemRelationSchema:l,relationPropertyCollectionId:c}=e;const d=r.property===a.property&&r.inverse===a.inverse;i?ee({blocksToDuplicate:t,duplicatedBlocks:n,environment:o,transaction:s,migrateSubitemFormat:{from:r,to:a}}):d||ce({blocks:t,transaction:s,from:r,to:a,environment:o,subitemRelationSchema:l,relationPropertyCollectionId:c})}async function me(e){var t;let{blocks:n,subitems:o,environment:i,canUndo:r,skipConfirmation:s}=e;const l=o||se(n),c=[...n,...l];K.zO(c);const d=n.at(0);if(!d)return;const u=(0,x.fm)(d)??function(e,t){if(!e)return;if(!e.isType(a.Ti.collectionViewPage)&&!e.isType(a.Ti.page))return;const n=e.getParentCollectionStore();if(!n)return;const o=new R.Z(t);return o.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:n}),o}(d,i),p=o||await ae({environment:i,blocks:n,options:{canEdit:!0},collectionContextStore:u}),m=null==u||null===(t=u.collectionStore())||void 0===t?void 0:t.getFormat().app_config_uri,f=(0,k.sN)(m,!0),g=(0,k.Q_)(m,!0);if(!s&&p.length>0){if(!(await function(e){let{itemCount:t,subitemCount:n,newItemName:o,newItemNamePlural:i}=e;return new Promise((e=>{O.showDialog({onDismiss(){e(!1)},description:(0,Q.jsx)(S.FormattedMessage,{id:"deleteSubitems.confirmation.description",defaultMessage:"You are about to delete <b>{itemCount, plural, one {{itemCount} {newItemName}} other {{itemCount} {newItemNamePlural}}}</b> and <b>{subitemCount, plural, one {{subitemCount} sub-{newItemName}} other {{subitemCount} sub-{newItemNamePlural}}}</b>",values:{itemCount:t,subitemCount:n,newItemName:o,newItemNamePlural:i,b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,Q.jsx)("b",{children:t})}}}),message:(0,Q.jsx)("div",{style:{fontWeight:_.Z.fontWeight.semibold,fontSize:18},children:(0,Q.jsx)(S.FormattedMessage,{id:"deleteSubitems.confirmation.message",defaultMessage:"Confirm delete"})}),innerStyle:{textAlign:"center"},showCancel:!0,keepFocus:!0,items:[{label:(0,Q.jsx)(S.FormattedMessage,{id:"deleteSubitems.confirmation.acceptLabel",defaultMessage:"Delete"}),color:"red",onAccept:()=>{e(!0)}}]})}))}({itemCount:n.length,subitemCount:p.length,newItemName:f,newItemNamePlural:g})))return K.bj(c),!1}const{serverCommitResult:h}=$.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:i,canUndo:r,perform:e=>{K.Cl({environment:i,blocks:n,transaction:e});for(const t of p)q.sW({store:t,data:{alive:!1},transaction:e})}});return await h,!0}async function fe(e){let{environment:t,blocks:n,collectionContextStore:o}=e;const r=await ae({environment:t,blocks:n,collectionContextStore:o,options:{canEdit:!0}});await Promise.all(r.map((e=>e.load())));const a=(0,C.JR)(o);if(!a)throw new Error("Could not find subitem info during duplication");const s=a.subitemFormat;$.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,perform:e=>{const a=le({blocks:[...n,...r],environment:t,transaction:e,migrateSubitemFormat:{from:s,to:s},collectionContextStore:o}),l=o.collectionStore();if(!l)return;a.map((t=>{W.zw({childStore:t,parentStore:l,transaction:e})}));const c=a.at(0);c&&w._({environment:t,store:c,pageVisitSource:i.tY.Duplicate})}})}async function ge(e){var t;let{environment:n,blocks:i}=e;const r=i.at(0);if(!r)return;const a=(0,C.g0)(r),s=null===(t=(0,x.fm)(r))||void 0===t?void 0:t.collectionViewBlockStore();if(!s||!a)return;const{parentRelationProperty:l,parentRelationSchema:c}=a,d=[...i,...se(i)];K.zO(d);const u=i.at(-1);if(!u)return;const p=await ae({environment:n,blocks:i,options:{canEdit:!0}});let m=[],f=[];$.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:n,perform:e=>{f=le({blocks:[...i,...p],environment:n,transaction:e}),m=K.is({environment:n,blocks:f,selection:i,transaction:e,replaceEmptyTextBlock:!1,insertAfterBlock:u,preventSetSelection:!0})}});const g=(0,C.T2)({blocks:m,parentRelationProperty:l,parentRelationSchema:c,collectionViewBlockStore:s});return o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{G.Z5({environment:n,stores:g})}))})),K.bj(d),f}function he(e){const{environment:t,block:n,collectionStore:o,subitemFormat:i,transaction:r}=e,a=n.getPropertyValue(i.inverse);l.rq(a).forEach((e=>{const a=E.G.createChildStore(o,e);H.Bl({environment:t,sourceStore:n,destStore:a,propertyWithInverse:{property:i.inverse,inverse:i.property},transaction:r})}))}},98688:(e,t,n)=>{n.d(t,{L:()=>p,v:()=>u});n(21703);var o=n(72126),i=n(45953),r=n(9844),a=n(35794),s=n(80444),l=n(72371),c=n(54642),d=n(9377);async function u(e){const{currentSpaceStore:t}=s.default.state;t&&await p({environment:e.environment,spaceId:t.id,force:!0})}async function p(e){const{environment:t,spaceId:n,force:u}=e;await s.default.waitUntilRendered();const p=l.Z.state;if(!p.loaded&&!p.loading||p.loaded&&n!==p.spaceId||u){l.Z.setState({...l.Z.state,loading:!0});const[e,s]=await Promise.all([c.searchIntegrations(t,{query:"",type:"compliance",spaceId:n}),d.j({environment:t,spaceId:n})]);if("success"!==e.type)throw new Error("Request failed.");const u=i.PF.create(e.data.recordMap),p=i.PF.create(s.recordMap);l.Z.setState({loaded:!0,loading:!1,spaceId:n,integrations:o.MR(o.oA(e.data.integrationIds.map((e=>u.getModel({table:r.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),webhookSubscriptions:o.oA(s.webhookSubscriptionIds.map((e=>p.getModel({table:a.b,id:e,spaceId:n}))))})}}},86080:(e,t,n)=>{n.d(t,{b:()=>r,x:()=>a});var o=n(29477),i=n(81700);const r=function(e){const t=o.UZ();return i.Z.setState({...e,open:!0,onComplete:t.resolve,inputValue:""}),t.promise},a=function(e){const t=i.Z.state;t.open&&(t.onComplete(e.didConfirm),i.Z.reset())}},28673:(e,t,n)=>{n.d(t,{V:()=>h,c:()=>v});n(21703);var o=n(4615),i=n(6287),r=n(23867),a=n(97880),s=n(9291),l=n(70764),c=n(33929),d=n(32363),u=n(26136),p=n(47307),m=n(89475),f=n(9953);const g=(0,s.defineMessages)({authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.propertyTypeSection.connected.authFail"},mobileAdminError:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) app in settings to use this feature.",id:"database.viewSettings.propertyTypeSection.connected.mobileAdminError"},mobileError:{defaultMessage:"Please authorize this integration on the desktop app or a browser.",id:"database.viewSettings.propertyTypeSection.connected.mobileError"}});async function h(e,t,n,o){const i=e.device.isMobile,r=null==t?void 0:t.getSpaceStore();if(!r)return;const a=(0,l.NP)(n.id).length;if(i&&o&&!a){const e=c.default.formatMessage(g.mobileAdminError);throw p.showErrorMessage(e),new Error(e)}if(i&&!o&&!a){const e=c.default.formatMessage(g.mobileError);throw p.showErrorMessage(e),new Error(e)}if(!a&&o&&r.canAdmin()||!a&&!o)try{await m.hM({environment:e,integration:n,spaceId:r.id,from:"collection_settings_property_type"})}catch(s){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}if(!(0,l.NP)(n.id).length){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}}function v(e){const{environment:t,pattern:n,integration:s,parentCollectionStore:l,transaction:c}=e;if(!n.connected_relation_properties)throw new Error("Cannot create a connected relation collection without properties");const p=new u.NW(t,{table:i.v,id:(0,o.ZP)(),spaceId:l.pointer.spaceId}),m={};n.connected_relation_sub_schemas&&(0,a.qP)(n.connected_relation_sub_schemas).map((e=>{let[n,a]=e;const s=new u.NW(t,{table:i.v,id:(0,o.ZP)(),spaceId:l.pointer.spaceId}),d={bot_id:void 0,external_object_id:void 0,uri:n,integration_id:void 0,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:a,sync_state:void 0,pattern_name:void 0},g={id:s.id,version:0,space_id:(0,r.C)(l.pointer.spaceId),parent_table:i.v,parent_id:p.id,alive:!0,format:d,schema:{}};m[n]=s.id,f.sW({store:s,data:g,transaction:c})}));const g={id:p.id,version:0,space_id:(0,r.C)(l.pointer.spaceId),parent_table:i.v,parent_id:l.id,alive:!0,format:{attributes:[{id:"title",name:"title",type:"inline",format:{type:"title",section:"title"},values:[(0,d.ni)({pattern:n,integration:s})]}],bot_id:void 0,external_object_id:void 0,uri:`notion://user-defined-collection/${s.id}/${n.name}`,integration_id:s.id,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:n.connected_relation_properties,sync_state:void 0,pattern_name:n.name,related_external_object_uris_to_instance_ids:m},schema:{}};return f.sW({store:p,data:g,transaction:c}),p}},50950:(e,t,n)=>{n.d(t,{wk:()=>B,Tz:()=>F,OM:()=>O,qo:()=>N,oG:()=>z,dd:()=>W,Nh:()=>Z,a9:()=>j});n(67294);var o=n(15145),i=n(86658),r=n(74686),a=n(55632),s=n(68626),l=n(72126),c=n(91155),d=n(71644),u=n(63143),p=n(9291),m=n(54642),f=n(480),g=n(24405),h=n(56666),v=n(10182),b=n(89728),y=n(85893);const _=function(){window.__c={n:"CookieSnackbarButtons"};const e=(0,f.O7)(),t=(0,g.Fg)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(b.Z,{onClick:()=>O(e,{necessary:!0,performance:!0,preference:!0,targeting:!0}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(p.FormattedMessage,{...i.ze.acceptAllButtonLabel})})}),(0,y.jsx)(b.Z,{onClick:()=>O(e,{necessary:!0,performance:!1,preference:!1,targeting:!1}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(p.FormattedMessage,{...i.ze.rejectAllButtonLabel})})}),(0,y.jsx)(v.Z,{hasDismissButton:!0,renderOrigin:e=>(0,y.jsx)(b.Z,{style:{paddingLeft:8,paddingRight:8},...e,children:(0,h.o)({width:14,marginLeft:4,fill:t.contentBackground})})})]})};var S=n(42402),w=n(77472),k=n(12955),I=n(33929),x=n(36867),C=n(80444),T=n(61893),M=n(45293),P=n(1310),A=n(50906),R=n(47307);const D=(0,p.defineMessages)({cookieConsentSaveError:{id:"cookieConsent.saveError",defaultMessage:"Cannot record cookie consent, please try again later."}});async function B(e){const{environment:t,onboardingState:n}=e;if(await E(t))return(0,x.g)(t.currentUser.id)>=2?(L(),M.Z.setState({open:!0}),A.xYN({environment:t,type:"modal",onboardingState:n}),void A.bmu(t)):void(P.ZP.state.currentItem||(P.ZP.setState({...P.ZP.state,currentItem:{key:(0,d.ZP)(),label:(0,y.jsx)("div",{children:(0,i.Fd)(F,"snackbar")}),right:(0,y.jsx)(_,{})}}),A.xYN({environment:t,type:"snackbar",onboardingState:n})))}async function E(e){if(!(0,k.canSetCookie)(e))return!1;if(!(0,k.canShowCookieUi)(e))return!1;const t=await(0,k.getHasPermissionArgs)(e);return"true"===(null==t?void 0:t.notion_check_cookie_consent)&&(null==t||!t.notion_cookie_consent)}function F(e,t){return(0,y.jsx)(S.Z,{href:e,children:t})}function Z(e,t){if("necessary"===t)return;const n={...T.Z.getState().permission};n[t]=!n[t],T.Z.setPermission(n),V(e,n)}const V=l.Ds(((e,t)=>{j(e,t)}),2e3);async function j(e,t){const n=await m.recordCookieConsent(e,{id:T.Z.getId(),permission:t,document_version:i.fV,userId:e.currentUser.id}).catch((e=>{U({type:"recordCookieConsentError",error:(0,c.Ui)(e)})}));if(!n)return void U({type:"recordCookieConsentEmptyResult"});if("success"!==n.type)return void U({type:"recordCookieConsentReturnsNonSuccess",data:{miscDataToConvertToString:{result:n}}});const s=n.data;await T.Z.setCookieConsent(e,s),o.e9();const l=await w.cG(e),d=o.Zk(l);await a.Pv(d);const{permission:u}=s;w.j(e,"record_cookie_consent",{permission:u,consent_type:(0,r.JT)(u)})}function U(e){let{type:t,data:n,error:o}=e;R.showErrorMessage(I.default.formatMessage(D.cookieConsentSaveError)),s.log({level:"error",from:"cookieActions",type:t,data:n,error:o})}function L(){P.ZP.setState({...P.ZP.state,currentItem:void 0})}function O(e,t){j(e,t),L(),N()}function N(){R.showMessage({message:I.default.formatMessage(i.ze.reloadAfterSaveMessage),onAccept:()=>{window.location.reload()}})}async function z(e){const{currentUserSettingsStore:t}=C.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const o=n.cookie_consent;o?(await T.Z.setCookieConsent(e,o),L()):(T.Z.clearCookieConsent(),await E(e)&&T.Z.setPermission(i.cW))}async function W(e){const t=await(0,k.getCookieConsentCookie)(e);if(!t)return;const n=(0,u.dj)(t);n&&T.Z.setState(n)}},41433:(e,t,n)=>{n.d(t,{Ns:()=>k,ZI:()=>x,fC:()=>I,jf:()=>C,nF:()=>w});n(21703),n(57658);var o=n(80951),i=n(76837),r=n(42875),a=n(59730),s=n(15157),l=n(19233),c=n(4615),d=n(45953),u=n(21202),p=n(19889),m=n(70203),f=n(95477),g=n(83960),h=n(80444),v=n(26136),b=n(50906),y=n(96802),_=n(9953),S=n(993);const w="calloutBlockIcon",k="calloutBlockBackground";function I(e){var t,n,o;const{environment:i,createBlockItem:r,from:a,inMemoryRecordCache:s,transaction:l,useCrdt:p}=e;if(!r.templateRootBlockId||!r.createTemplate)throw new Error("Invalid createBlock item.");const m=(null===(t=h.default.state.currentSpaceStore)||void 0===t?void 0:t.id)??(null===(n=h.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getSpaceId()),{targetBlock:f}=x({environment:i,sourceBlockId:r.templateRootBlockId,targetBlockPointer:{id:(0,c.ZP)(),table:u.iU,spaceId:m},sourceBlockSubtree:(0,d.R3)(r.createTemplate(i)),targetRecordCache:s,transaction:l,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,useCrdt:p});if(null===(o=r.postCreateCallback)||void 0===o||o.call(r,f,i),C({store:f,transaction:l}),a&&r.blockType){var g;const e=r.collectionViewType;b.W2j(i,{from:a,type:r.blockType,collection_id:f.getParentCollectionId()??(null===(g=f.getCollectionViewCollectionStore())||void 0===g?void 0:g.id),view_type:"inline"===e||"full_page"===e?"table":e,is_toggleable:r.isToggleable,automation_id:f.getAutomationId(),new_page_id:"page"===r.blockType?f.id:void 0,creating_block_id:f.id})}return f}function x(e){const{environment:t,sourceBlockId:n,sourceBlockSubtree:o,targetBlockPointer:s,targetRecordCache:l,transaction:c,deepCopyTransclusionContainers:d,resolveTemplateVariables:u,recordPointerMap:m,useCrdt:g}=e,h=t.currentUser.id,{duplicateRecordMap:b,originalToDuplicate:y}=i.PZ({sourceBlockId:n,targetBlockPointer:s,recordMap:o,recordPointerMap:m,options:{deepCopyTransclusionContainers:d,resolveTemplateVariables:!!u&&{currentUserId:h,currentTimeZone:(0,r.r)()},blocksShouldUseCrdt:g},baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,actor:h?{table:p.KJ,id:h}:void 0,getRecordRole:l.makeGetRecordRoleFn(h)}),w=new v.G(t,s,{inMemoryRecordCache:l});c.postPerformAssertions.push((function(){if(c.isLocal)return;if(!w.getParentStore())throw new a.p8(`Initialized template was not given a parent before being committed in transaction ${c.getUserActionForAnalyticsPurposesOnly()}`)}));for(const{pointer:i,model:r}of b){const e=null==r?void 0:r.__IM_SORRY__getValue();if(!e)continue;const n=(0,v.Kv)(w,i);if(i.table===s.table&&i.id===s.id&&void 0!==l.getRecord({pointer:i,userId:h})){const o=e,{format:r,properties:a,...s}=o,{title:d,...u}=a??{};_.sW({store:n,data:{...s,properties:u},transaction:c});const p=n;if(r){var k;const e=(null===(k=l.getRecord({pointer:i,userId:h}))||void 0===k||null===(k=k.value)||void 0===k?void 0:k.format)??{};for(const t of Object.keys(e))void 0===r[t]&&(r[t]=null);delete r.use_crdt,delete r.text_slice_tree,delete r.text_clocks,Object.keys(r).length>0&&_.sW({store:p.getFormatStore(),data:r,transaction:c})}S.sO({environment:t,store:p.getBlockTitleStore(),value:null==a?void 0:a.title,transaction:c})}else _.sO({store:n,value:e,transaction:c})}return{targetBlock:w,originalToDuplicate:y}}function C(e){const{store:t,transaction:n}=e;"code"===t.getType()?function(e){const{store:t,transaction:n}=e,i=t.getProperties(),r=t.getFormat(),a=t.environment.currentUser.id,c=s.Z.get({userId:a,key:g.T.localLanguagePreferenceKey}),d=c&&l.W[c]?c:g.T.defaultLanguage,u=s.Z.get({userId:a,key:g.T.localCodeWrapPreferenceKey}),p=t.getBlockTitleStore(),f=p.getValue(),h=m.vNd(f);h&&S.sO({environment:t.environment,store:p,value:h,transaction:n});void 0===i.language&&_.sW({store:t.getPropertiesStore(),data:{language:o.O2(d)},transaction:n});void 0===r.code_wrap&&_.sW({store:t.getFormatStore(),data:{code_wrap:u},transaction:n})}({store:t,transaction:n}):"table_of_contents"===t.getType()?function(e){const{store:t,transaction:n}=e;void 0===t.getFormat().block_color&&y.FH({stores:[t],update:{block_color:"gray"},transaction:n})}({store:t,transaction:n}):"callout"===t.getType()?function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,i=s.Z.get({userId:o,key:w})||"ðŸ’¡",r=s.Z.get({userId:o,key:k})||"gray_background",a=t.getFormat();void 0===a.block_color&&y.FH({stores:[t],update:{block_color:r},transaction:n});void 0===a.page_icon&&y.FH({stores:[t],update:{page_icon:i},transaction:n})}({store:t,transaction:n}):"quote"===t.getType()&&function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,i=s.Z.get({userId:o,key:g.l.localSizePreferenceKey});void 0!==i&&_.sW({store:t.getFormatStore(),data:{quote_size:i},transaction:n})}({store:t,transaction:n})}},67133:(e,t,n)=>{n.d(t,{b:()=>a,x:()=>s});var o=n(28748),i=n(24677),r=n(98104);function a(e,t){i.ZH(e),r.ZH(e),o.Z.setState({open:!0,...t})}function s(){o.Z.setState({open:!1,originRect:o.Z.state.originRect})}},99813:(e,t,n)=>{n.d(t,{Wl:()=>b,ji:()=>g,oi:()=>h});var o=n(43593),i=n(17755),r=n(68626),a=n(29477),s=n(11342),l=n(95477),c=n(50906),d=n(54642),u=n(47839),p=n(12714);function m(e){if(!Boolean(e.mobileNative))return!1;const{device:t}=e,n=(0,s.parseMobileAppVersion)(t.mobileAppVersion,t.isAndroid);return!!n&&(t.isIOS?(0,s.isGreaterThanOrEqualToVersion)(n,[0,4,669]):!!t.isAndroid&&(0,s.isGreaterThanOrEqualToVersion)(n,[0,6,735]))}async function f(e,t){return e.device.isElectron||e.device.isMobileNative?await d.getSignedFileUrl(e,t,!1):(0,i.g)({...t,baseURL:l.default.domainBaseUrl,currentUserId:e.currentUser&&e.currentUser.id})}async function g(e,t){let n=t.url;const s=e.mobileNative&&m(e),c=o.E$(t.url,[l.default.secureFileS3.url,l.default.secureFileS3V2.url]);c&&(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"fetching"}),n=await Promise.race([f(e,t),a.Xb(i.nK,void 0)])),n?c&&s?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:"file",from:"download",state:"url_ready"}):c?v({environment:e,url:n}):p.D({environment:e,url:n}):(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"error"}),r.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}function h(e,t){const n=e.mobileNative&&m(e);if(o.x$(t)&&n){const n=o.rF({title:void 0,source:t});e.mobileNative.showLightBoxV2({url:void 0,downloadName:n,type:"file",from:"download",state:"fetching"}),e.mobileNative.showLightBoxV2({url:t,downloadName:n,type:"file",from:"download",state:"url_ready"})}else v({environment:e,url:t})}function v(e){const{environment:t,url:n}=e;t.mobileNative?t.mobileNative.openInAppBrowser(n):t.device.isElectron?u.downloadUrl(n):window.location.href=n}async function b(e,t){c.QIc(e,{from:"embedded_block_click",type:t.type});let n=t.url;const s=e.mobileNative&&m(e),d=o.E$(t.url,[l.default.secureFileS3.url,l.default.secureFileS3V2.url]);d&&(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"fetching"}),n=await Promise.race([f(e,t),a.Xb(i.nK,void 0)])),n?d&&s?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:t.type,from:t.from,state:"url_ready"}):p.D({environment:e,url:n}):(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"error"}),r.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}},42239:(e,t,n)=>{n.d(t,{LQ:()=>F,_4:()=>D,cQ:()=>A,eN:()=>Z,f$:()=>E,fX:()=>R,td:()=>B});n(57658);var o=n(41432),i=n(8848),r=n(15095),a=n(42875),s=n(72126),l=n(4615),c=n(23867),d=n(97880),u=n(95477),p=n(77472),m=n(43250),f=n(78316),g=n(98165),h=n(41984),v=n(27406),b=n(81844),y=n(95802),_=n(55367),S=n(86486),w=n(27724),k=n(50906),I=n(47307),x=n(54532),C=n(42858),T=n(24677),M=n(98724),P=n(98104);function A(e,t){_.ZP.state.isDragging&&(_.ZP.reset(),T.$Y({environment:e,phase:w.SelectionPhase.Selected,preventClearEditingText:t}))}function R(e){if(_.ZP.state.isDragging){const{draggedStores:i,currentDropZone:r}=_.ZP.state,a=e.optionKey;let c;if(r){var t,n;const e=r.type===_.Dl.Selectable?y.C.findSelectablesFromStore(r.store):v.Z.findDropTargetsFromKey(r.key);null===(t=e.find((e=>Boolean(e.props.onSelectableDrop))))||void 0===t||null===(t=t.props)||void 0===t||null===(n=t.onSelectableDrop)||void 0===n||n.call(t,{droppedDirection:r.direction,droppedStores:i,duplicate:a}),c=function(e,t){const n=t.props,o="store"in n?n.store:void 0,i=o?b.Z.findOutlinerItemFromStore(o):void 0,r=o&&g.VP(o),a=r&&(0,p.nB)(r),s={...i&&{...a,type:i.type},..."analyticsName"in n&&{dropzone_from:n.analyticsName}};if(!e)return{...s,has_dropzone:!1};let c;switch(e.direction){case _.vh.Above:c="above";break;case _.vh.Below:c="below";break;case _.vh.Left:c="left";break;case _.vh.Onto:c="onto";break;case _.vh.Right:c="right";break;default:(0,d.t1)(e.direction)}if(e.type===_.Dl.Selectable)return{...s,has_dropzone:!0,dropzone_type:"selectable",dropzone_block_id:(0,l.cj)(e.store.id),dropzone_direction:c};return{...s,has_dropzone:!0,dropzone_type:"drop_target",dropzone_key:e.key,dropzone_direction:c}}(r,e[0])}const u=i.find((e=>{const t=e.getType();return Boolean(t&&(0,o.S9)(t))})),m=u&&g.VP(u),h=u&&(0,f.fm)(u);k.ROv(e.environment,{draggedTypes:s.oA(i.map((e=>e.getType()))),from:e.analyticsFrom,asCopy:a,draggableProps:{draggable_from:e.analyticsFrom,...m&&(0,p.nB)(m)},dropzoneProps:c,optionalAnalyticsProperties:{collectionContextStore:h}}),A(e.environment),e.environment.device.isPhone&&T.ZH(e.environment)}}function D(e){const{environment:t,files:n,analyticsFrom:o}=e;if(_.ZP.state.isDragging){var i;const e=_.ZP.state.currentDropZone;let s;var r,a;if(e)s=e.type===_.Dl.Selectable?y.C.findSelectableFromStore(e.store):v.Z.findDropTargetFromKey(e.key),null===(r=s)||void 0===r||null===(r=r.props)||void 0===r||null===(a=r.onNativeDrop)||void 0===a||a.call(r,{files:n,droppedDirection:e.direction});k.ROv(t,{draggedTypes:[],from:o,asCopy:!1}),A(t,null===(i=s)||void 0===i?void 0:i.props.keepTextSelectionOnDrop)}}function B(e,t){_.ZP.state.isDragging&&(P.ZH(e),_.ZP.setState({..._.ZP.state,...t}))}function E(e,t){if(_.ZP.state.isDragging)return!1;{const{startX:n,startY:o,isNativeDrag:i}=t,r=T.aw(t.stores);P.ZH(e);const a=y.C.getRectFromStore(r[0]);return _.ZP.setState({isDragging:!0,startX:n,startY:o,currentX:n,currentY:o,offsetX:n-(a&&a.left||0),offsetY:o-(a&&a.top||0),currentHintDropZones:[],draggedStores:r,isNativeDrag:i,ghostElements:r.map((e=>t.getGhostElement?t.getGhostElement(e):function(e){const{store:t}=e,n=y.C.findSelectablesFromStore(t);return s.oA(n.map((e=>{if(e.props.canSelect){const t=e.getNode();if(t)return Z(t)}})))}({store:e})))}),T.$Y({environment:e,phase:w.SelectionPhase.Selected}),S.default.reset(),!0}}function F(e){const{droppedStores:t,transaction:n,environment:i,duplicate:r,duplicateUseCrdt:s}=e,l=e.resolveTemplateVariables;return t.map((e=>{if(!y.C.findSelectableFromStore(e))return e;if(r){const t=!e.isTransclusionType(),[r,a]=x.Qi({environment:i,stores:[e],addCopyName:(0,h.Z)(e),transaction:n,deepCopyTransclusionContainers:t,targetSpaceId:(0,c.C)(e.pointer.spaceId),resolveTemplateVariables:e.getType()!==o.Ti.factory&&l,baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:s}),d=r[0];return a.then((e=>{e&&I.showErrorMessage(e)})),d}return l&&M.bt({store:e,context:{currentUserId:i.currentUser.id,currentTimeZone:(0,a.r)()},transaction:n}),C.Od({store:e,transaction:n}),e}))}function Z(e){const t=e.style.transform,n=e.style.transition;e.style.transform="",e.style.transition="";const o=e.getBoundingClientRect();e.style.transform=t,e.style.transition=n;const r=e.cloneNode(!0);!function(e,t){const{firstElementChild:n}=e;if(n&&n.hasAttribute("embed-ghost")){const n=V(e,[]);if(n){const r=j(e,n),a=j(t,n);if(r&&a)if(r.shadowRoot){const e=r.shadowRoot;let t=null;if(a.createShadowRoot)t=a.createShadowRoot();else if(a.attachShadow)try{t=a.attachShadow({mode:"open"})}catch(o){}t&&(t.innerHTML=e.innerHTML)}else if(!r.src&&r.contentDocument){const e=document.createElement("iframe");e.width=r.offsetWidth,e.height=r.offsetHeight,U(e,a),a.parentElement.replaceChild(e,a),e.onload=t=>{const n=e.contentDocument.children[0],o=r.contentDocument.children[0];U(n,o),n.innerHTML=o.innerHTML}}else a.width=r.offsetWidth,a.height=r.offsetHeight,a.style.backgroundColor=i.ZP.blackWithAlpha(.12),a.style.backgroundImage=null,a.src=""}}}(e,r);const a=getComputedStyle(e);for(let i=0;i<a.length;i++){const e=a[i],t=a.getPropertyValue(e);"app-region"===e&&"none"===t||(r.style[e]=t)}"absolute"!==a.position&&"relative"!==a.position||(r.style.position="",r.style.top="",r.style.left="",r.style.bottom="",r.style.right="");const s=r.querySelectorAll(`.${m.No6}`);for(const i of s)i.remove();r.style.pointerEvents="none";const l=r.querySelectorAll("*");for(const i of l)i.style&&(i.style.pointerEvents="none");return{cloned:r,rect:o}}function V(e,t){if(e.shadowRoot)return t;if(e instanceof HTMLIFrameElement)return t;{const{firstElementChild:n,nextElementSibling:o}=e;if(n){t.push(0);const e=V(n,t);if(e)return e;t.pop()}if(o){t[t.length-1]+=1;const e=V(o,t);if(e)return e}return null}}function j(e,t){return t.reduce(((e,t)=>e&&e.children&&e.children[t]?e.children[t]:null),e)}function U(e,t){r.p4(t.attributes).forEach((t=>{let{name:n,value:o}=t;e.setAttribute(n,o)}))}},91584:(e,t,n)=>{n.d(t,{O$:()=>k,Ui:()=>b,WO:()=>y,cR:()=>S,qN:()=>w,vQ:()=>_});var o=n(99405),i=n(23867),r=n(64002),a=n(9291),s=n(57549),l=n(47307),c=n(47839),d=n(95477),u=n(91924),p=n(7844),m=n(53730),f=n(54642),g=n(92625),h=n(15356);const v=(0,a.defineMessages)({authenticatingWithGoogle:{id:"googleDriveActions.authenticatingWithGoogle.loadingMessage",defaultMessage:"Authenticating with Googleâ€¦"},googleLoginTitle:{defaultMessage:"Google login",id:"googleDriveActions.loginWithGoogleModal.title"}});async function b(e){const{environment:t,store:n,fileId:o,token:r}=e;await m.transactionQueue.awaitRecordTransaction(n.pointer);const a=await f.initializeGoogleDriveBlock(t,{block:{id:n.id,spaceId:(0,i.C)(n.pointer.spaceId)},fileId:o,token:r});if("failed"!==a.type)return a.data.file&&s.cV(t,{file_type:a.data.file.mimeType??void 0}),a.data;l.showError(a)}function y(e,t){f.refreshGoogleDriveBlock(e,{block:t})}async function _(e){const t=await f.getGoogleDriveAccounts(e,{});return"success"===t.type&&t.data.accounts?t.data:{accounts:[]}}function S(e,t){const{onSuccess:n,onFailure:o}=t;p.Z.setState({open:!0,onConfirm:async()=>{const t=await w(e);t&&t.token?n(t.token):o&&o()},onDecline:o})}async function w(e){const t=(0,u.eC)(e);let n=(0,o.ZQ)(d.default.domainBaseUrl,{authType:t});if(n=t.redirectToAuth?n:await(0,u.HU)(e,n),e.device.isElectron)return void c.openExternalUrl(n);const i=await h.M(e,{width:610,height:700,url:n,titleMessage:v.googleLoginTitle});if(!i)return;const a=r.Qc(i);return await k(e,a.query.code)}async function k(e,t){if(!t)return;g.j({message:v.authenticatingWithGoogle});const n=await f.authWithGoogleForDrive(e,{code:t});if(g.x(),"failed"!==n.type)return s.L3(e,{integration_name:"google"}),n.data;{const e=n.error;console.error(e),l.showError(n)}}},54532:(e,t,n)=>{n.d(t,{E9:()=>Z,K8:()=>U,Qi:()=>j,WJ:()=>V});n(21703),n(57658);var o=n(41432),i=n(76837),r=n(42875),a=n(59730),s=n(64572),l=n(59753),c=n(29477),d=n(4615),u=n(45953),p=n(606),m=n(98963),f=n(18844),g=n(21202),h=n(6287),v=n(13493),b=n(29369),y=n(70203),_=n(9291),S=n(95477),w=n(33954),k=n(33929),I=n(35328),x=n(80444),C=n(88632),T=n(26136),M=n(50906),P=n(54642),A=n(41433),R=n(47307),D=n(29533),B=n(9953),E=n(39865);const F=(0,_.defineMessages)({offlineError:{id:"duplicateActions.offlineError.message",defaultMessage:"Please go online to copy this block."},unknownError:{id:"duplicateActions.unknownError.message",defaultMessage:"An unknown error occurred."}});function Z(e){const{environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:r,targetInMemoryRecordCache:a,addCopyName:s,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,transaction:d,useCrdt:u}=e,{targetBlock:p,originalToDuplicate:m}=A.ZI({environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:r,targetRecordCache:a,transaction:d,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,useCrdt:u});if(s&&p&&p.isNavigableBlock()){const e=p.getTitleStore();if(e){const t=e.getValue(),n=i.eb(t);B.sO({store:e,value:n,transaction:d})}}return{targetBlock:p,originalToDuplicate:m}}function V(e){const{environment:t,sourceBlocks:n,targetInMemoryRecordCache:i,snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:u,transaction:p,targetSpaceId:m,convertExternalObjectInstancesToPlaceholders:f,useCrdt:g,duplicateOnlyCollectionSchema:h}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const v=n.map(((e,n)=>B.j4({environment:t,type:o.Ti.copyIndicator,inMemoryRecordCache:i,transaction:p,spaceId:m,useCrdt:g}))),b=c.UZ();return p.postSubmitCallbacks.push((async e=>{if(e)(0,a.Jx)(e)?b.resolve((0,w.nX)(k.default.getIntl(),e)):b.resolve(k.default.formatMessage(F.unknownError));else{const e=P.duplicateBlock(t,{sourceBlocks:n,targetBlocks:v.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:!!u&&{currentUserId:t.currentUser.id,currentTimeZone:(0,r.r)()},convertExternalObjectInstancesToPlaceholders:f,useCrdt:g,duplicateOnlyCollectionSchema:h});let o;for await(const t of e){for(const e of v)D.R(t,e.id);o=t}for(const t of v)D.h(t.id);if(!o)return void b.resolve(void 0);if(o.error){E.Tq({environment:t,blocks:v});const e=(0,w.HV)(k.default.getIntl(),o.error);b.resolve(e)}else b.resolve(void 0)}})),[v,b.promise]}function j(e){const{environment:t,stores:n,addCopyName:o,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,transaction:a,targetSpaceId:s,preferDuplicateLocation:l,analyticsFrom:c,useCrdt:u,duplicateOnlyCollectionSchema:p}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const m=n[0].getSpaceId();if(!n.every((e=>e.getSpaceId()===m)))throw new Error("All stores must be in the same space");if(n.length>1&&!n.every((e=>e.isTypedCollectionViewBlock())))throw new Error("Multiple source blocks only supported for grouped typed DB duplication");for(const d of n){const e=d.getRecordStoreAtRootPath().getValue();let n;const{currentSpaceStore:o}=x.default.getState();var f;if(o&&(null==e?void 0:e.parent_table)===b.e0&&(n=T.zX.createChildStore(o,{table:b.e0,id:e.parent_id})),e)M.W2j(t,{from:c??"copy",type:e.type,teamStore:n,is_toggleable:(0,I._A)(e.type,e.format),collection_id:d.getParentCollectionId()??(null===(f=d.getCollectionViewCollectionStore())||void 0===f?void 0:f.id),new_page_id:"page"===e.type?d.id:void 0,creating_block_id:d.id})}const h=m!==s;if("local"===l&&1===n.length){const e=n[0],l=U(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!i,allowCopyExternalObjectInstances:!h});if(l){const{targetBlock:n}=Z({environment:t,sourceBlockId:e.id,targetBlockPointer:{id:(0,d.ZP)(),table:g.iU,spaceId:s},sourceBlockSubtree:l,targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:o,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,transaction:a,useCrdt:u});return[[n],Promise.resolve(void 0)]}}for(const d of n)if(d.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache)throw new Error("Can only server duplicate from the environment.defaultRecordCache.inMemoryRecordCache.");const v=t.defaultRecordCache.inMemoryRecordCache;return C.Z.state.online||R.showErrorMessage(k.default.formatMessage(F.offlineError)),V({environment:t,sourceBlocks:n.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),targetInMemoryRecordCache:v,addCopyName:o,transaction:a,deepCopyTransclusionContainers:i,resolveTemplateVariables:r,targetSpaceId:s,convertExternalObjectInstancesToPlaceholders:h,useCrdt:u,duplicateOnlyCollectionSchema:p})}function U(e,t){const{blockId:n,inMemoryRecordCache:i,allowCopyCollections:r,requireFullSubtree:a,skipTransclusionContainerChildren:c,allowCopyExternalObjectInstances:d}=t,b=e.currentUser.id,_=u.Ak.create(),w=new Set,k=[{pointer:{table:g.iU,id:n},parentId:"doesn't matter"}];for(;k.length>0;){const e=k.shift();if(!e)continue;if(w.has(e.pointer.id))continue;w.add(e.pointer.id);const t=n===e.pointer.id;if((0,p.$O)(e.pointer,g.iU)){var I,x,C;const n=i.getRecord({pointer:e.pointer,userId:b});if(!n||!n.value){if(a)return;continue}const r=n.value;if(!t&&r.parent_id!==e.parentId)continue;if(r.type===o.Ti.externalObjectInstance&&!d)return;if(_.setValue(e.pointer,r),null!==(I=r.format)&&void 0!==I&&I.collection_pointer&&k.push({pointer:r.format.collection_pointer,parentId:r.id}),r.collection_id&&k.push({pointer:{table:h.v,id:r.collection_id},parentId:r.id}),r.view_ids)for(const e of r.view_ids)k.push({pointer:{table:v.n,id:e,spaceId:r.space_id},parentId:r.id});if(!c||"transclusion_container"!==r.type){const e=l.kk.fromBlock(r).getRenderableContentIds();for(const t of e)k.push({pointer:{table:g.iU,id:t},parentId:r.id})}if(r.type===o.Ti.externalObjectInstance){var T,M;const e=(null===(T=r.format)||void 0===T?void 0:T.related_external_object_uris_to_instance_ids)&&Object.values(null===(M=r.format)||void 0===M?void 0:M.related_external_object_uris_to_instance_ids)||[];for(const t of e)k.push({pointer:{table:g.iU,id:t,spaceId:r.space_id},parentId:r.id})}if(r.properties)for(const e of Object.values(r.properties))if(e)for(const t of e)for(const e of y.hDy(t)){if(y.STW(e)){const t=y.TOT(e);k.push({pointer:{table:g.iU,id:t},parentId:r.id})}if(y.j0F(e)){const t=y.zW$(e),n=(0,s.A5)({url:t,baseUrl:S.default.domainBaseUrl,publicDomainName:S.default.publicDomainName});n&&k.push({pointer:{table:g.iU,id:n},parentId:r.id})}if(y.nSN(e)){const t=y.frW(e);t&&k.push({pointer:{table:g.iU,id:t,spaceId:r.space_id},parentId:r.id})}}null!==(x=r.format)&&void 0!==x&&x.automation_id&&k.push({pointer:{table:m.cv,id:r.format.automation_id,spaceId:r.space_id},parentId:r.id}),null!==(C=r.format)&&void 0!==C&&C.ai_instructions_page_pointer&&k.push({pointer:r.format.ai_instructions_page_pointer,parentId:r.id})}else if((0,p.$O)(e.pointer,h.v)){var P;if(!r)return;const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;const n=t.value;_.setValue(e.pointer,n),i.forEachRecord(b,(t=>{let{model:n}=t;n.table===g.iU&&n&&n.parent_id===e.pointer.id&&n.alive&&k.push({pointer:n.pointer,parentId:e.pointer.id})}));const o=(null===(P=n.format)||void 0===P?void 0:P.automation_ids)??[];for(const e of o)k.push({pointer:{table:m.cv,id:e,spaceId:n.space_id},parentId:n.id})}else if((0,p.$O)(e.pointer,v.n)){const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;_.setValue(e.pointer,t.value)}else if((0,p.$O)(e.pointer,m.cv)){const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;_.setValue(e.pointer,t.value);for(const e of t.value.action_ids??[])k.push({pointer:{table:f.Xj,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,p.$O)(e.pointer,f.Xj)){const t=i.getRecord({pointer:e.pointer,userId:b});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;_.setValue(e.pointer,t.value);for(const e of t.value.blocks??[])k.push({pointer:{table:g.iU,id:e,spaceId:t.value.space_id},parentId:t.value.id})}}return _}},47839:(e,t,n)=>{n.r(t),n.d(t,{appUpdateAvailable:()=>T,appUpdateChecking:()=>C,appUpdateError:()=>x,appUpdateFinished:()=>R,appUpdateInstall:()=>D,appUpdateNotAvailable:()=>M,appUpdateProgress:()=>A,appUpdateReady:()=>I,appUpdateReload:()=>P,checkForUpdates:()=>y,clearBrowserHistory:()=>f,clearCookies:()=>te,clearGoogleAuthCookies:()=>ne,closeGlobalSearchModal:()=>he,closeQuickSearch:()=>be,downloadUrl:()=>ie,electronApi:()=>c,electronAppFeatures:()=>ue,electronUpdateAvailable:()=>S,electronUpdateChecking:()=>_,electronUpdateError:()=>b,electronUpdateNotAvailable:()=>w,electronUpdateProgress:()=>k,electronUpdateReady:()=>v,fullscreen:()=>F,getAppPath:()=>oe,getCurrentZoom:()=>L,getDesktopVersion:()=>d,getSubstitutions:()=>K,inPageSearch:()=>Z,initializeElectron:()=>ce,installElectronUpdate:()=>B,isActiveTab:()=>fe,isMainTabOrWindow:()=>G,isProtocolRegistered:()=>se,isRunningUnderArm64Translation:()=>E,onNewWindow:()=>Y,openDevTools:()=>q,openExternalUrl:()=>m,openGoogleDrivePickerPopup:()=>X,openInNewTab:()=>u,openInNewWindow:()=>p,openOauthPopup:()=>J,openPageFromGlobalSearch:()=>ve,openQuickSearchResult:()=>ye,openQuickSearchShortcutSetting:()=>ke,openSearchModalFromQuickSearch:()=>xe,quickSearchNotReady:()=>Se,quickSearchReady:()=>_e,quickSearchRefresh:()=>we,quickSearchVisibilityState:()=>Ie,ready:()=>le,refreshAll:()=>de,setBadge:()=>g,setLogglyData:()=>ee,setOverlay:()=>h,setTabColors:()=>Q,setTheme:()=>$,setWindowTitle:()=>H,sidebarState:()=>pe,subscribeToProtocolUrl:()=>re,subscribeToSettingsMenuItem:()=>ae,toggleMaximized:()=>W,track:()=>ge,windowSidebarState:()=>me,zoomIn:()=>O,zoomOut:()=>N,zoomReset:()=>z});n(97391);var o=n(68626),i=n(72126),r=n(64002);function a(e){const t=e.match(/Mac OS X (\d+_\d+)/);if(t)return t[1].split("_").map((e=>parseInt(e,10)))}var s=n(63643);let l="lastProtocolUrlDeduplicationId";const c=s.electronApi,d=s.getDesktopVersion;function u(e){const t=r.T1(e.url);c&&(c.openInNewTab?c.openInNewTab(t,e.makeTabActive,e.position):c.openInNewWindow(t))}function p(e){const t=r.T1(e);null==c||c.openInNewWindow(t)}function m(e){if(c){void 0!==r.yn(e)&&c.openExternalUrl(e)}}function f(){null==c||c.clearBrowserHistory()}function g(e){return null==c?void 0:c.setBadge(e)}function h(e){var t;return null==c||null===(t=c.setOverlay)||void 0===t?void 0:t.call(c,e)}const v={addListener(e){null==c||c.updateReady.addListener(e)},removeListener(e){null==c||c.updateReady.removeListener(e)}},b={addListener(e){var t;null==c||null===(t=c.updateError)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.updateError)||void 0===t||t.removeListener(e)}},y=()=>{var e;null==c||null===(e=c.checkForUpdates)||void 0===e||e.call(c)},_={addListener(e){var t;null==c||null===(t=c.updateChecking)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.updateChecking)||void 0===t||t.removeListener(e)}},S={addListener(e){var t;null==c||null===(t=c.updateAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.updateAvailable)||void 0===t||t.removeListener(e)}},w={addListener(e){var t;null==c||null===(t=c.updateNotAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.updateNotAvailable)||void 0===t||t.removeListener(e)}},k={addListener(e){var t;null==c||null===(t=c.updateProgress)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.updateProgress)||void 0===t||t.removeListener(e)}},I={addListener(e){var t;null==c||null===(t=c.appUpdateReady)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateReady)||void 0===t||t.removeListener(e)}},x={addListener(e){var t;null==c||null===(t=c.appUpdateError)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateError)||void 0===t||t.removeListener(e)}},C={addListener(e){var t;null==c||null===(t=c.appUpdateChecking)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateChecking)||void 0===t||t.removeListener(e)}},T={addListener(e){var t;null==c||null===(t=c.appUpdateAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateAvailable)||void 0===t||t.removeListener(e)}},M={addListener(e){var t;null==c||null===(t=c.appUpdateNotAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateNotAvailable)||void 0===t||t.removeListener(e)}},P={emit:e=>{var t;null==c||null===(t=c.appUpdateReload)||void 0===t||t.emit(e)},addListener(e){var t;null==c||null===(t=c.appUpdateReload)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateReload)||void 0===t||t.removeListener(e)}},A={addListener(e){var t;null==c||null===(t=c.appUpdateProgress)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateProgress)||void 0===t||t.removeListener(e)}},R={addListener(e){var t;null==c||null===(t=c.appUpdateFinished)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateFinished)||void 0===t||t.removeListener(e)}},D={addListener(e){var t;null==c||null===(t=c.appUpdateInstall)||void 0===t||t.addListener(e)},removeListener(e){var t;null==c||null===(t=c.appUpdateInstall)||void 0===t||t.removeListener(e)}};function B(){null==c||c.installUpdate()}function E(){var e;return null==c||null===(e=c.isRunningUnderArm64Translation)||void 0===e?void 0:e.call(c)}const F={get:()=>null==c?void 0:c.fullscreen.get(),addListener(e){null==c||c.fullscreen.addListener(e)},removeListener(e){null==c||c.fullscreen.removeListener(e)}},Z={start(e){c&&c.inPageSearch&&c.inPageSearch.start(e)},stop(){c&&c.inPageSearch&&c.inPageSearch.stop()},started:{addListener(e){c&&c.inPageSearch&&c.inPageSearch.started.addListener(e)},removeListener(e){c&&c.inPageSearch&&c.inPageSearch.started.removeListener(e)}},stopped:{addListener(e){c&&c.inPageSearch&&c.inPageSearch.stopped.addListener(e)},removeListener(e){c&&c.inPageSearch&&c.inPageSearch.stopped.removeListener(e)}}},V=(e,t,n)=>Math.min(Math.max(e,n),t);let j,U=1;function L(){return U}function O(){c&&c.zoom&&(U+=.1,c.zoom.set(V(.1,4.9,U)))}function N(){c&&c.zoom&&(U-=.1,c.zoom.set(V(.1,4.9,U)))}function z(){c&&c.zoom&&(U=1,c.zoom.set(U))}function W(){c&&c.toggleMaximized&&c.toggleMaximized()}function q(){c&&c.openDevTools&&c.openDevTools()}function H(e){c&&c.setWindowTitle&&c.setWindowTitle(e)}function K(){return j||[]}async function G(){return c&&c.isMainTab?c.isMainTab():!c||!c.isMainWindow||c.isMainWindow()}function $(e){c&&c.setTheme&&c.setTheme(e)}function Q(e){c&&c.setTabColors&&c.setTabColors(e)}function Y(e){c&&c.newWindow&&c.newWindow.addListener(e)}async function J(e){if(c&&c.openOauthPopup)return c.openOauthPopup(e)}async function X(e){if(c&&c.openGoogleDrivePickerPopup)return c.openGoogleDrivePickerPopup(e)}function ee(e){c&&(c.setLoggerData?c.setLoggerData(e):c.setLogglyData&&c.setLogglyData(e))}function te(){c&&c.clearCookies&&c.clearCookies()}function ne(){c&&c.clearAllCookies&&c.clearAllCookies()}async function oe(){if(c&&c.getAppPath)return c.getAppPath()}function ie(e){if(c&&c.downloadUrl)c.downloadUrl(e);else{const t=document.createElement("a");t.download=e,t.href=e,t.click()}}function re(e){c&&c.onNavigate&&c.onNavigate.addListener(((t,n)=>{if("string"!=typeof n&&n.deduplicationID){const e=n.deduplicationID;if(l===e)return void o.log({level:"warning",from:"electronActions",type:"duplicateOnNavigateObjectDetected"});l=e}e(n)}))}function ae(e){c&&c.onOpenSettings&&c.onOpenSettings.addListener(((t,n)=>e(n)))}async function se(e){return!(!c||!c.isProtocolRegistered)&&c.isProtocolRegistered(e)}function le(){c&&c.ready&&c.ready()}async function ce(e){const{device:t,electronSqlite:n}=e;if(c){if(await s.getAndCacheDesktopVersionAsync(),c.zoom&&(U=await c.zoom.get()),n&&n.sqliteConnection&&(await n.sqliteConnection.ensureMigrated(),n.sqliteConnection.optimize()),c.getSubstitutions&&t.isElectronMac){const e=await c.getSubstitutions();j=e.filter((e=>e.replace!==e.with)).map((e=>({length:e.replace.length,replace:new RegExp(`\\b${i.hr(e.replace)} $`),with:`${e.with} `})))}t.isElectronMac&&function(){const e=a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent);return!!e&&10===e[0]&&e[1]<15}()&&ue.setPreference("isAutoUpdaterDisabled",!0)}}function de(e){c&&c.refreshAll&&c.refreshAll(e.includeFocusedWindow)}const ue={get(){if(c&&c.electronAppFeatures)return c.electronAppFeatures.get()},setPreference(e,t){var n;c&&null!==(n=c.electronAppFeatures)&&void 0!==n&&n.setPreference&&c.electronAppFeatures.setPreference(e,t)},addListener(e){c&&c.electronAppFeatures&&c.electronAppFeatures.addListener(e)},removeListener(e){c&&c.electronAppFeatures&&c.electronAppFeatures.removeListener(e)}},pe={set(e){c&&c.sidebarState&&c.sidebarState.set(e)},addToggleListener(e){c&&c.sidebarState&&c.sidebarState.addToggleListener(e)},removeToggleListener(e){c&&c.sidebarState&&c.sidebarState.removeToggleListener(e)}},me={get:()=>c&&c.windowSidebarState?c.windowSidebarState.get():Promise.resolve(void 0),set(e){c&&c.windowSidebarState&&c.windowSidebarState.set(e)},addListener(e){c&&c.windowSidebarState&&c.windowSidebarState.addListener(e)},removeListener(e){c&&c.windowSidebarState&&c.windowSidebarState.removeListener(e)}},fe={get:()=>c&&c.isActiveTab?c.isActiveTab.get():Promise.resolve(!1),addListener(e){c&&c.isActiveTab&&c.isActiveTab.addListener(e)},removeListener(e){c&&c.isActiveTab&&c.isActiveTab.removeListener(e)}},ge={addListener(e){c&&c.track&&c.track.addListener(e)},removeListener(e){c&&c.track&&c.track.removeListener(e)}};function he(){c&&c.closeGlobalSearchModal&&c.closeGlobalSearchModal()}function ve(e){c&&c.openPageFromGlobalSearch&&c.openPageFromGlobalSearch(e)}function be(){c&&c.closeQuickSearch&&c.closeQuickSearch()}function ye(e){c&&c.openQuickSearchResult&&c.openQuickSearchResult(e)}function _e(){c&&c.quickSearchReady&&c.quickSearchReady()}function Se(){c&&c.quickSearchNotReady&&c.quickSearchNotReady()}function we(){c&&c.quickSearchRefresh&&c.quickSearchRefresh()}function ke(){c&&c.openQuickSearchShortcutSetting&&c.openQuickSearchShortcutSetting()}const Ie={isVisible:()=>c&&c.quickSearchVisibilityState?c.quickSearchVisibilityState.isVisible():Promise.resolve(!1),addListener(e){c&&c.quickSearchVisibilityState&&c.quickSearchVisibilityState.addListener(e)},removeListener(e){c&&c.quickSearchVisibilityState&&c.quickSearchVisibilityState.removeListener(e)}},xe={addListener(e){c&&c.openSearchModalFromQuickSearch&&c.openSearchModalFromQuickSearch.addListener(e)},removeListener(e){c&&c.openSearchModalFromQuickSearch&&c.openSearchModalFromQuickSearch.removeListener(e)}}},31781:(e,t,n)=>{n.d(t,{vW:()=>B,z:()=>F,TH:()=>O,I:()=>V,qC:()=>E,qL:()=>U,x1:()=>N,cT:()=>Z});n(57658);var o=n(1302),i=n(41432),r=n(80951),a=n(95538),s=n(43593),l=n(70203),c=n(9291),d=n(54642),u=n(48948),p=n(95477),m=n(33929),f=n(45010),g=n(18245),h=n(58202),v=n(53809),b=n(30548);const y=new v.D({key:"urlTurnedBookmarkToastStatusSetting",namespace:b.$p,important:!0,trackingType:"preference"});var _=n(77080),S=n(27411),w=n(50906),k=n(99813),I=n(62365),x=n(96802),C=n(27153),T=n(9953),M=n(64964),P=n(993),A=n(82530),R=n(53471);const D=(0,c.defineMessages)({urlTurnedBookmark:{id:"action.urlTurnedBookmark.snackBarMessage",defaultMessage:"Pasted url is not embeddable, turned to bookmark instead!"}});let B=function(e){return e[e.Page=0]="Page",e[e.PageComment=1]="PageComment",e[e.SidebarComment=2]="SidebarComment",e}({});function E(e){return e===B.PageComment||e===B.SidebarComment}function F(e){const{environment:t,files:n,inMemoryRecordCache:o,transaction:i,pageWidth:r,ignoreOversizedFiles:a,spaceId:s,useCrdt:l}=e;return n.filter((e=>{if(a){if(!R.Q7({environment:t,file:e,preventLimitFreeFileSize:!1}))return R.A3(t),!1}return!0})).map((e=>{if(!e.type||0!==e.type.indexOf("image")&&0!==e.type.indexOf("video")&&0!==e.type.indexOf("audio")||e.type.includes("photoshop")){const n=T.j4({environment:t,type:"file",inMemoryRecordCache:o,transaction:i,spaceId:s,useCrdt:l});return i.postSubmitCallbacks.push((o=>{o||I.c({environment:t,store:n,file:e})})),n}{const n=T.j4({environment:t,type:"embed",inMemoryRecordCache:o,transaction:i,spaceId:s,useCrdt:l});return i.postSubmitCallbacks.push((o=>{o||Z({environment:t,store:n,file:e,pageWidth:r,preferredType:void 0})})),n}}))}function Z(e){const{environment:t,store:n,file:i,pageWidth:r,preferredType:s}=e,l=S.default.getBlockKey(n.id);C.Z(),R.cT({environment:t,file:i,bucket:"secure",record:n.pointer,onStart:e=>{if(S.default.setKeyState(l,{progressPercent:0,file:i,name:e.name,size:e.size}),i.type.indexOf("image")>=0&&!(0,a.y_)(e.name,"tiff")&&!(0,a.y_)(e.name,"tif")){const e=URL.createObjectURL(i),a=new Image;a.onload=function(){j(t,{store:n,width:a.naturalWidth,height:a.naturalHeight,scale:!0,type:"image",pageWidth:r}),t.device.isMobile&&o.default.afterNextFlush((()=>{f.Z.PageScroller&&f.Z.PageScroller.scrollerHack()})),URL.revokeObjectURL(e)},a.src=e}else{const e=(0,a.Dz)({url:i.name||"",baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:s});j(t,{store:n,width:r,type:e,pageWidth:r})}},onProgress:e=>{const t=S.default.getKeyState(l);t&&S.default.setKeyState(l,{...t,progressPercent:e.progressPercent})},onComplete:async e=>{const o=S.default.getKeyState(l);if(o){const i=Boolean(o.dataURL),a=o.name,c=o.size;await V(t,{source:e,store:n,isDataURL:i,pageWidth:r,preferredType:s,name:a,size:c}),S.default.setKeyState(l,void 0)}},onError:()=>{S.default.setKeyState(l,void 0)},retryWhenOffline:!0})}async function V(e,t){const{store:n,source:o,isDataURL:r,pageWidth:s,preferredType:c,name:f,size:h}=t;let v=r?"image":(0,a.Dz)({url:o,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:c});const b=z(v,o),{properties:_,type:S,format:k}=await(0,a.Ol)({source:b,type:v,isDataURL:r,pageWidth:s,isMobileDevice:e.device.isMobile,getEmbedData:async t=>{const n=await d.getGenericEmbedBlockData(e,t);return"failed"===n.type?void console.error(n.error):n.data},trackEmbedType:t=>w.Jgl(e,{embedType:t})});if(v=S,v===i.Ti.bookmark){const o=n;return await u.K({environment:e,store:o,url:b,transformTimeout:0}),w.mCV(e),function(){if("do_not_prompt"===y.state)return;y.state?"displayed_once"===y.state?y.setState("displayed_twice"):"displayed_twice"===y.state&&y.setState("do_not_prompt"):y.setState("displayed_once");M.oV({label:m.default.formatMessage(D.urlTurnedBookmark)})}(),void(t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}}))}let I,C;w.GlI(e,{embedType:S}),f&&h&&(I={size:l.TPx(h)},C=l.TPx(f));const{serverCommitResult:R}=A.createAndCommit({userAction:"embedBlockActions.initializeEmbedBlock",environment:e,perform:t=>{T.sW({store:n.getPropertiesStore(),data:{..._||{},...I},transaction:t}),C&&P.sO({environment:e,store:n.getBlockTitleStore(),value:C,transaction:t}),x.FH({stores:[n],update:k,transaction:t}),T.sW({store:n,data:{type:v},transaction:t})}});await R,t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}})}function j(e,t){let{store:n,...o}=t;A.createAndCommit({userAction:"embedBlockActions.initializeFormat",environment:e,perform:e=>{x.FH({stores:[n],update:(0,a.tj)(o),transaction:e})}})}async function U(e,t){const{store:n}=t,o=n.getProperties();if(o){const u=n.getType(),p=u===i.Ti.bookmark?o.link:o.source,m=r.zB(p),f=l.QaF(o.title),{display_source:g,original_url:h}=n.getFormat(),v=n.isExternalObjectInstanceBlockStore()?h:m||g;let b;v&&(b=s.rF({title:f,source:v}));var a,c,d="file";if("image"===u?d="image":"video"===u&&(d="video"),v)await k.Wl(e,{url:v,downloadName:b,type:d,from:t.from,permissionRecord:t.store.pointer,download:(null===(a=b)||void 0===a?void 0:a.endsWith(".html"))||(null===(c=b)||void 0===c?void 0:c.endsWith(".htm"))})}}const L=(0,c.defineMessages)({downloadingImage:{id:"embedBlockActions.downloading.label",defaultMessage:"Downloadingâ€¦"}});async function O(e){const{store:t,environment:n}=e,o=await async function(e){let{store:t,environment:n,calledFrom:o}=e;const i=t.getNavigableBlockStore();if(!i)return;const r=await d.getBlockFileDownloadUrl(n,{blockId:t.id,pageBlockId:i.id,meta:{name:o}});if("success"!==r.type)return;const{url:a,fileName:s}=r.data;return{url:a,fileName:s}}({store:t,environment:n,calledFrom:"downloadSource"});if(!o)return;const{url:i,fileName:r}=o;if(i){let o;w.Uk(n,{url:i,fileName:r,from:"embedBlockActions"}),o=s.E$(i,[p.default.secureFileS3.url,p.default.secureFileS3V2.url])?k.ji(n,{url:i,download:!0,downloadName:r,permissionRecord:t.pointer}):function(e){const{store:t,environment:n}=e;if(!n.currentUser.id)return Promise.resolve();const o=t.getProperties(),i=l.QaF(null==o?void 0:o.source),r=l.QaF(null==o?void 0:o.caption);return s.GN(i,t.pointer,p.default.domainBaseUrl,n.currentUser.id,r)}(e),M.oV({label:m.default.formatMessage(L.downloadingImage),durationMs:"keep"}),await o.finally((()=>{M.rN()}))}}const N=e=>{const{store:t}=e,n=h.R.findBlockFromStoreWithMethod(t,"replace");n&&n.replace()},z=function(e,t){return"maps"===e?/^https?:\/\//i.test(t)?_.default.checkGate("remove_apostrophe_for_maps_url")?t.replace(/'/g,""):t:`https://maps.google.com/maps/search/${encodeURIComponent(t)}`:"embed"===e&&/^https:\/\/[^\/]+\.streamlit\.app/.test(t)?`${t}?embed=true`:(0,a.x$)(t)}},89951:(e,t,n)=>{n.d(t,{KT:()=>B,RL:()=>E,xv:()=>F});var o=n(1302),i=n(41432),r=n(43593),a=n(72126),s=n(99405),l=n(21202),c=n(13493),d=n(70203),u=n(95477),p=n(69783),m=n(28020),f=n(63085),g=n(89224),h=n(58202),v=n(64233),b=n(19111),y=n(26136),_=n(27724),S=n(10743),w=n(52229),k=n(50906),I=n(79554),x=n(48948),C=n(96802),T=n(72711),M=n(9953),P=n(42858),A=n(993),R=n(82530),D=n(68422);function B(e){const{environment:t,textStore:n,url:o,oldTextValue:i,urlSelection:r}=e;if(S.Z.state.open||p.Z.state.open||b.Z.state.open||v.Z.state.open)return;const a=g.get();if(!a)return;const s=g.getRect(a);s&&(v.Z.setState({open:!0,textStore:n,url:o,oldTextValue:i,urlSelection:r,selectionRect:s}),k.elP(t,{url:o}))}async function E(e){const{environment:t}=e,n=v.Z.state;if(n.open){const{url:p,textStore:g,oldTextValue:v}=n,b=_.default.state.stores,S=b[0];if(!S)return;const k=(0,r.Wv)(p,u.default.secureFileS3.url,u.default.secureFileS3V2.url,u.default.secureFileConfig.rootPath,u.default.secureFileConfig.hostname),B=k?k.link:p,E=(0,s.Wj)({url:B,baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,isMobile:t.device.isMobile,protocol:u.default.protocol,currentUrl:window.location.href});if("page"===E.name)await R.createAndCommitAsync({environment:t,userAction:"embedMenuActions.embedPageAlias",waitForServerCommit:!1,perform:async i=>{let r;if(A.sO({environment:t,store:g,value:v,transaction:i}),E.peekViewBlockId){const e=y.G.createChildStore(g,{table:l.iU,id:E.peekViewBlockId});await e.load(),e.isPageBlock()&&(r=e)}if(r||(r=y.G.createChildStore(g,{table:l.iU,id:E.blockId})),r){if("mention-page"===e.type){const e=r.getRecordModel({id:r.id,table:l.iU});A.lZ({environment:t,store:g,selection:{startIndex:n.urlSelection.startIndex,endIndex:n.urlSelection.startIndex},annotation:d.$0A(E.scrollToBlockId??r.id,null==e?void 0:e.space_id),transaction:i,analyticsFrom:"block"})}else if("create-transclusion"===e.type){if(!E.scrollToBlockId)return;I.ry({environment:t,blocks:_.default.state.stores,copiedBlockIds:[E.scrollToBlockId]})}else if(r.isCollectionView()){const e=E.collectionViewId?y.Xr.createChildStore(r,{table:c.n,id:E.collectionViewId}):void 0;await Promise.all([r.load(),e?e.load():void 0]);const n=e?e.getCollectionStore():r.getCollectionViewCollectionStore();n&&(await n.load(),T.Y_({environment:t,store:S,collectionStore:n,collectionViewStore:e,transaction:i}))}else{const e=S.getParentBlockStore();if(e){const n=w.k({environment:t,parentBlock:e,targetStore:r,transaction:i});P.is({environment:t,blocks:[n],selection:b,transaction:i,replaceEmptyTextBlock:!0})}}o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}))}}});else if(e.type===i.Ti.bookmark||"teamsInvite"===E.name){const{performResult:e}=R.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;A.sO({environment:t,store:g,value:v,transaction:e});const r=M.j4({environment:t,type:i.Ti.bookmark,inMemoryRecordCache:S.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,m.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,m.RM)())||void 0===o?void 0:o.useCrdt())??!1}),a=P.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0});return C.FH({stores:[r],transaction:e,update:{bookmark_loading_ttl:Date.now()}}),a}});o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}));const n=e[0];"teamsInvite"===E.name?await x.K({environment:t,store:n,url:p,teamId:E.teamId}):await x.K({environment:t,store:n,url:p})}else if(e.type===i.Ti.drive){const{performResult:e}=R.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;A.sO({environment:t,store:g,value:v,transaction:e});const r=M.j4({environment:t,type:i.Ti.drive,inMemoryRecordCache:S.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,m.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,m.RM)())||void 0===o?void 0:o.useCrdt())??!1});return P.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}));const n=e[0];o.default.afterNextFlush((()=>{const e=h.R.find((e=>e.getBlockStore()===n));e&&e.initializeGoogleDriveBlockFromUrl(p)}))}else{const{performResult:n}=R.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;A.sO({environment:t,store:g,value:v,transaction:e});const r=M.j4({environment:t,type:i.Ti.copyIndicator,inMemoryRecordCache:S.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,m.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,m.RM)())||void 0===o?void 0:o.useCrdt())??!1});return P.is({environment:t,blocks:[r],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{R.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:b,transaction:e})}})}));const r=n[0],s=n=>{R.createAndCommit({environment:t,userAction:"embedMenuActions.accept.insertExtractedData",perform:t=>{let o;e.type&&"mention-page"!==e.type&&"create-transclusion"!==e.type?o=e.type:(o=i.Ti.embed,n&&n.media&&("photo"===n.media.type?o=i.Ti.image:"video"===n.media.type&&(o=i.Ti.video))),D.vs({environment:e.environment,block:r,blockType:o,transaction:t})}}),o.default.afterNextFlush((()=>{const e=h.R.find((e=>e.getBlockStore()===r&&a.mf(e.embed)));e&&e.embed(B)}))};f.W4(t,B).then(s)}}F()}const F=function(){v.Z.setState({url:v.Z.getState().url,open:!1})}},4727:(e,t,n)=>{n.d(t,{RL:()=>g,_P:()=>f,jZ:()=>v,xv:()=>h});var o=n(70203),i=n(69783),r=n(68056),a=n(89224),s=n(64233),l=n(19111),c=n(10743),d=n(24666),u=n(50906),p=n(993),m=n(82530);function f(e){const{environment:t,textStore:n,oldSelection:r,oldTextValue:d}=e,p=o.eeV(n.getValue()||[]),m=r.startIndex;if(":"!==p[m])return;const f=o.gPn(p,m-5,m).join("");if(/[0-9]$/.test(f[f.length-1]))return;if(f.endsWith("http")||f.endsWith("https"))return;if(f.endsWith(":"))return;if(c.Z.state.open||i.Z.state.open||l.Z.state.open||s.Z.state.open)return;if(t.device.isPhone)return;const g=a.get();if(!g)return;const h=a.getRect(g);h&&(i.Z.setState({open:!0,textStore:n,oldTextValue:d,oldSelection:r,selectionRect:h}),u.xud(t))}function g(e){const t=i.Z.state,{environment:n,emoji:o,transaction:r}=e;t.open&&(p.sO({environment:n,store:t.textStore,value:t.oldTextValue,transaction:r}),p.Q0({environment:n,store:t.textStore,selection:t.oldSelection,emoji:o,transaction:r}),h())}function h(){i.Z.setState({open:!1})}function v(e){p.N3({direction:"end"});const t=d.default.state;if("editing"!==t.mode)return;const n=(0,r.QY)(t.multiSelection);if(!n)return;let a=!1;if(n.selection.startIndex>0){const e=n.store.getValue()||[],t=o.eeV(e)[n.selection.startIndex-1];/[\s]/g.test(t)||(a=!0)}m.createAndCommit({userAction:"emojiMenuActions.triggerInsertEmojiMenu",environment:e,perform:t=>{a?(p.hJ({environment:e,store:n.store,string:" ",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),p.hJ({environment:e,store:n.store,string:":",selection:{startIndex:n.selection.startIndex+1,endIndex:n.selection.endIndex+1},disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})):p.hJ({environment:e,store:n.store,string:":",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})}});const s=i.Z.state;s.open&&i.Z.setState({...s,showPopupWithEmptyFilter:!0})}},36280:(e,t,n)=>{n.d(t,{Wj:()=>g,gt:()=>v,qn:()=>f});n(21703);var o=n(1302),i=n(70203),r=n(97880),a=n(83631),s=n(68056),l=n(89224),c=n(89086),d=n(66949),u=n(24666),p=n(993),m=n(98104);function f(e){var t;const{environment:n,selectedToken:o,selectionRect:r,analyticsFrom:p}=e,f=l.get();if(!f)return;if("editing"!==u.default.state.mode)return;const g=null===(t=(0,s.QY)(u.default.state.multiSelection))||void 0===t?void 0:t.store;if(!g)return;const h=o||a.JT(u.default.state);h&&m.Z5({store:g,selection:h.position});const v=c.lV(u.default.state),b=h?i.o0h(h.token):a.Jf(v),y=a.by({environment:n,equation:b,displayMode:"inline"}),_=h?{editingToken:h.token}:{annotations:a.nk(u.default.state)};d.Z.setState({open:!0,value:b,error:y,savedTextSelectionState:u.default.state,savedTextSelectionRect:r||a.TJ({environment:n,selection:f}),..._,analyticsFrom:a.D9({source:p,currentEquationToken:Boolean(h),selectedText:v})}),u.default.setState({mode:"empty"})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.P.Forward;d.Z.isOpen()&&(h({equationStore:d.Z,getNextSelection:t=>e===d.P.Forward?{startIndex:t.endIndex,endIndex:t.endIndex}:e===d.P.Backward?{startIndex:t.startIndex,endIndex:t.startIndex}:(0,r.t1)(e)}),d.Z.reset(),o.default.afterNextFlush((()=>{u.default.emit()})))}function h(e){const{equationStore:t,getNextSelection:n}=e;if(!t.isOpen())return;const{savedTextSelectionState:o}=t.state,i=(0,s.QY)(o.multiSelection);if(!i)return;const r=n(i.selection);if(m.Z5({store:i.store,selection:r}),"editing"!==u.default.state.mode)throw new Error("TextSelectionStore should have a selection after calling `setSelection`.");t.setState({...t.state,savedTextSelectionState:u.default.state})}function v(e){const{environment:t,equationStore:n,transaction:o}=e;n.isOpen()&&(n.state.error||n.state.editingToken&&i.o0h(n.state.editingToken)===n.state.value||(!function(e){const{environment:t,equationStore:n,transaction:o}=e;if(!n.isOpen())return;if(n.state.error)return;const{savedTextSelectionState:r}=n.state,{multiSelection:s}=r;let l;p.pz({environment:t,multiSelection:s,transaction:o}),n.state.value&&(l=a.qZ({equationState:n.state,isTemporary:!1}),p.mM({environment:t,store:s.start.store,index:s.start.index,tokens:[l],transaction:o})),h({equationStore:n,getNextSelection:e=>{const t=l?i.eeV([l]).length:0;return{startIndex:e.startIndex,endIndex:e.startIndex+t}}}),u.default.setState({mode:"empty"})}({environment:t,equationStore:d.Z,transaction:o}),h({equationStore:n,getNextSelection:e=>({startIndex:e.endIndex,endIndex:e.endIndex})}),a.ND({environment:t,equation:n.state.value,from:n.state.analyticsFrom})))}},57400:(e,t,n)=>{n.d(t,{BX:()=>f,Of:()=>g,Th:()=>p,Tm:()=>m,Yh:()=>u,mc:()=>v});var o=n(15157),i=n(12139),r=n(54642),a=n(47307),s=n(12955),l=n(64496),c=n(77080),d=n(7339);async function u(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id;let i;const r=(0,l.qE)();if(i=(0,l._3)(e)&&r?(0,l.fP)(t,n,r):o.Z.get({userId:n,key:c.localExperimentsV2Key}),i){const e=i.deviceId!==t,o=i.userId!==n,r=Boolean(i.test);!e&&!o||r||(i=void 0,c.default.reset())}i?c.default.updateState(i,e):await p({environment:e,force:!1}),c.default.getState().isLoaded||c.default.updateState({experimentsBySpace:{},experimentsWithoutSpace:[],isLoaded:!0,userId:n,deviceId:t,test:!1},e),c.default.isStatsigEnabled()&&await d.C.initialize(e)}async function p(e){const{environment:t,force:n}=e;if((0,l._3)(t)&&!n){var o;if(null!==(o=t.mobileNative)&&void 0!==o&&o.api.getExperimentData){const e=await t.mobileNative.api.getExperimentData();e?c.default.updateState(e,t):b({message:"Attempt to get experiments from the mobile cache did not return a result."})}else b({message:"getExperimentData is not implemented in the react native API."})}else{const e=await h(t);"failed"!==e.type&&c.default.updateState(e.data,t)}}async function m(e){const t=await h(e);"failed"!==t.type&&o.Z.set({userId:t.data.userId,key:c.localExperimentsV2Key,value:t.data})}async function f(e,t,n){if(!c.default.state.isLoaded)return;const o=await(0,s.getExperimentDeviceId)(e),i=await r.updateExperimentOverride(e,{experimentId:t,experimentGroup:n,deviceId:o});"failed"!==i.type?await p({environment:e,force:!1}):a.showError(i)}async function g(e){if(!c.default.state.isLoaded)return;const t=await(0,s.getExperimentDeviceId)(e),n=await r.resetExperimentOverrides(e,{deviceId:t});"failed"!==n.type?(await p({environment:e,force:!1}),a.showMessage({message:"Successfully reset experiment overrides."})):a.showError(n)}async function h(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id,o=await r.getClientExperimentsV2(e,{deviceId:t});return"failed"===o.type&&b(o,n,t),o}function v(){c.default.reset()}function b(e,t,n){i.rn(e,{from:"experimentActions",type:"ExperimentFetchError",data:{deviceId:n,userId:t}})}},89475:(e,t,n)=>{n.d(t,{$$:()=>A,cM:()=>D,hM:()=>R});n(21703);var o=n(77657),i=n(74181),r=n(149),a=n(99405),s=n(89101),l=n(98275),c=n(9852),d=n(94826),u=n(64002),p=n(9291),m=n(95477),f=n(91924),g=n(24608),h=n(77080),v=n(30874),b=n(92083),y=n(57549),_=n(54642),S=n(47307),w=n(47839),k=n(94273),I=n(15356),x=n(31120),C=n(8055),T=n(97627),M=n(12170);const P=(0,p.defineMessages)({authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integrationâ€¦"},titleMessage:{id:"externalIntegrationAuthActions.loginWithExternalIntegrationPopupModal.title",defaultMessage:"Authenticate"}});async function A(e){const{environment:t,integration:n,spaceId:o,from:i}=e,r=n.id,s=t.currentUser.id,l=(0,f.eC)(t);if(!s)throw new Error("No user id found");let c;y.Iv(t,{integrationId:r,from:i});const u=(0,d.I$)(r);if("dlp"===(null==u?void 0:u.type)||"ediscovery"===(null==u?void 0:u.type)){const e=await _.createOauthAuthorizationCode(t,{integrationId:r,spaceId:o});if("failed"===e.type)return S.showError(e),{error:`Unexpected error creating authorization code: ${(0,g.pO)(e)}`};c=e.data.code}await B({environment:t,notionAuthorizationCode:c,integration:n,spaceId:o,userId:s,authType:l,from:i,callbackRouteName:(null==u?void 0:u.id)===d.ZB.datadog.id?a.AY.datadogAuthCallback:a.AY.authCallback}),await M.pJ({environment:t}),"workspace_connections_redirect"===i&&b.Z.setState({open:!0,openedFrom:"workspace_connections_redirect",currentTab:"integrations",defaultSubtab:"workspace_connections",highlightedSetting:void 0})}async function R(e){const{environment:t,spaceId:n,integration:d,externalObjectInstanceBlockId:p,unfurlUrl:b,from:A}=e;c.setOauthAuthorizationParams(void 0);const R=d.id,D=R===o.nO?v.Z.completeSlackAuthentications.state:v.Z.externalAuthentications.state,E=new Set(D.filter((e=>{let{integration_id:t}=e;return t===R})).map((e=>e.parent_id)));R===o.f3&&T.pc(t);const F=(0,o.BP)({integrationId:R,env:"production"}),Z=(0,i.lT)(m.default.domainBaseUrl),V=d.redirect_uris.includes(Z)?Z:d.redirect_uris[0],j=await _.createOauthAuthorizationCode(t,{integrationId:R,spaceId:n,...F?{redirectUri:V}:{}});if("failed"===j.type)return S.showError(j),{error:`Unexpected error creating authorization code: ${(0,g.pO)(j)}`};const U=j.data.code,L=t.currentUser.id,O=(0,f.eC)(t),N=a.AY.authCallback;if(!L)return{error:"User must be signed in."};const z={environment:t,notionAuthorizationCode:U,integration:d,spaceId:n,externalObjectInstanceBlockId:p,unfurlUrl:b,authType:O,from:A,userId:L,callbackRouteName:N};(0,o.BP)({integrationId:R,env:"production"})?await async function(e){const{environment:t,redirectUri:n,notionAuthorizationCode:o,integration:i,spaceId:c,externalObjectInstanceBlockId:d,unfurlUrl:p,authType:f,userId:g}=e,v=await async function(e){const{integration:t}=e;if("external"===t.type&&void 0!==t.info.handled_by_integrations_server){if("github"===t.info.handled_by_integrations_server)return await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:i}=e,r={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,callback_type:i.callbackType,...i.redirectToAuth&&{redirectToAuth:"true"}},c=(0,u.bf)({url:(0,l.r8)("production"),query:{...r}});if((t.device.isTablet||t.device.isMobile)&&t.mobileNative&&"on"===h.default.getEligibleGroup({experimentId:"allow_auth_with_app_browser_for_mobile",defaultGroup:"control"}))return void t.mobileNative.openInAppBrowser(c);if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,u.bf)({url:`${m.default.domainBaseUrl}${s._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(c)}});w.openExternalUrl(e)}else w.openExternalUrl(c);return}const d=await I.M(t,{width:610,height:700,url:c,titleMessage:P.titleMessage});if(!d)return;const p=(0,a.Wj)({url:d,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href}),{url:f}=k.Vr(t);"externalAuthCallback"===p.name&&await x.xp({route:p,environment:t});C.c4({url:f||s._j.root,environment:t})}(e),{value:{success:!0}};if("slack"===t.info.handled_by_integrations_server){return h.default.checkGate("link_preview_auth_with_server_integration")?(await async function(e){const{environment:t,userId:n,spaceId:o,authType:i,from:r,externalObjectInstanceBlockId:s,options:c}=e,d={notion_workspace_id:o,notion_user_id:n,notion_last_visited_url:window.location.href,auth_initiator:r,callback_type:i.callbackType,slack_workspace_id:null==c?void 0:c.slackWorkspaceId,external_object_instance_block_id:s,...i.redirectToAuth&&{redirectToAuth:"true"}},p=(0,u.bf)({url:(0,l.St)("production"),query:{...d}});if(t.mobileNative)return void t.mobileNative.openInAppBrowser(p);if(t.device.isElectron)return void w.openExternalUrl(p);const f=await I.M(t,{width:610,height:700,url:p,titleMessage:P.titleMessage});if(!f)return;const g=(0,a.Wj)({url:f,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===g.name&&await x.xp({route:g,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return"zendesk"===t.info.handled_by_integrations_server?(await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:i,externalObjectInstanceBlockId:r}=e,l={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,external_object_instance_block_id:r,callback_type:i.callbackType,integration_id:e.integration.id,...i.redirectToAuth&&{redirectToAuth:"true"}},c=(0,u.bf)({url:`${m.default.domainBaseUrl}/initiateExternalAuthentication`,query:{...l}});if(t.device.isElectron)return void w.openExternalUrl(c);const d=await I.M(t,{width:610,height:700,url:c,titleMessage:P.titleMessage});if(console.log(`The popup callback: ${d}`),!d)return;const p=(0,a.Wj)({url:d,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href}),{url:f}=k.Vr(t);"externalAuthCallback"===p.name&&await x.xp({route:p,environment:t});C.c4({url:f||s._j.root,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return{error:{success:!1}}}(e);if(r.x.isSuccess(v))return;const b={externalObjectInstanceBlockId:d,spaceId:c,userId:g,callbackType:f.callbackType,...f.redirectToAuth&&{redirectToAuth:"true"}},y={code:o,notion_state:JSON.stringify(b),integration_id:i.id,external_url:p,redirect_uri:n},_=(0,u.bf)({url:n,query:{...y}});if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,u.bf)({url:`${m.default.domainBaseUrl}${s._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(_)}});w.openExternalUrl(e)}else w.openExternalUrl(_);return}const S=await I.M(t,{width:610,height:700,url:_,titleMessage:P.titleMessage});if(!S)return;const T=(0,a.Wj)({url:S,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===T.name&&await x.xp({route:T,environment:t})}({...z,integration:d,notionAuthorizationCode:U,redirectUri:V}):await B(z),y.Iv(t,{integrationId:d.id,numberOfAccountsAlreadyConnected:E.size,from:A}),await M.pJ({environment:t});return{value:{externalAuthentication:v.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===R})).find((e=>!E.has(e.parent_id)))}}}function D(e){const{environment:t,notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:i,notion_authorization_code:r,external_object_instance_block_id:a,callback_type:s,redirectToAuth:c,zendeskSubDomain:d}=e,p={notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:i,notion_authorization_code:r,external_object_instance_block_id:a,callback_type:s,zendeskSubDomain:d,...c&&{redirectToAuth:"true"}},m=(0,u.bf)({url:(0,l.vl)("production"),query:{...p}});t.device.isElectron?w.openExternalUrl(m):window.location.href=m}async function B(e){const{environment:t,notionAuthorizationCode:n,integration:o,spaceId:i,userId:r,authType:l,externalObjectInstanceBlockId:c,from:d,callbackRouteName:p}=e,g=o.id,h={notionAuthorizationCode:n,userId:r,spaceId:i,integrationId:g,externalObjectInstanceBlockId:c,callbackType:l.callbackType,...l.redirectToAuth&&{redirectToAuth:"true"}};let v=(0,u.bf)({url:`${m.default.domainBaseUrl}${s._j.externalIntegrationPopupRedirect}`,query:{...h}});if(v=l.redirectToAuth?v:await(0,f.HU)(t,v),t.device.isElectron)return void w.openExternalUrl(v);const b=await I.M(t,{width:610,height:700,url:v,titleMessage:P.titleMessage});if(!b)return;const y=(0,a.Wj)({url:b,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});y.name===p&&await x.wN({route:y,environment:t,integrationId:g,from:d})}},62365:(e,t,n)=>{n.d(t,{c:()=>u,v:()=>p});var o=n(70203),i=n(64002),r=n(27411),a=n(27153),s=n(9953),l=n(993),c=n(82530),d=n(53471);function u(e){const{store:t,file:n,environment:o}=e,i=r.default.getBlockKey(t.id);a.Z(),d.cT({environment:o,file:n,bucket:"secure",record:t.pointer,onStart:e=>{r.default.setKeyState(i,{progressPercent:0,file:n,name:e.name,size:e.size})},onProgress:e=>{const t=r.default.getKeyState(i);t&&r.default.setKeyState(i,{...t,progressPercent:e.progressPercent})},onComplete:e=>{const n=r.default.getKeyState(i);n&&c.createAndCommit({userAction:"fileBlockActions.uploadFile",environment:o,perform:a=>{p({environment:o,store:t,source:e,name:n.name,size:n.size,transaction:a}),r.default.setKeyState(i,void 0)}})},onError:()=>{r.default.setKeyState(i,void 0)},retryWhenOffline:!0})}const p=function(e){const{environment:t,store:n,source:r,name:a,size:c,transaction:d}=e;let u;a?u=a:r&&(u=(0,i.je)(r)),l.sO({environment:t,store:n.getBlockTitleStore(),value:o.TPx(u),transaction:d}),s.sW({store:n.getPropertiesStore(),data:{source:o.TPx(r),size:o.TPx(c)},transaction:d})}},3297:(e,t,n)=>{n.d(t,{DK:()=>V,OH:()=>U,S:()=>F,VE:()=>O,fD:()=>L,nM:()=>N,qd:()=>z,sC:()=>E,yR:()=>j});var o=n(15145),i=n(42875),r=n(15157),a=n(72126),s=n(29477),l=n(89101),c=n(97880),d=n(9291),u=n(35683),p=n(75754),m=n(91851),f=n(95477),g=n(77472),h=n(28020),v=n(84210),b=n(33929),y=n(80444),_=n(89256),S=n(50906),w=n(81193),k=n(47307),I=n(54532),x=n(96802),C=n(92625),T=n(11302),M=n(19785),P=n(69915),A=n(8055),R=n(28014),D=n(82530);const B="forkPageTemplate";function E(){_.Z.setState({open:!1})}async function F(e){const{environment:t,store:n,originRect:i}=e;S.ZzP(t,n.id);const{RouterStore:r}=t,a=r.state.route;if("page"===a.name&&a.requestedOnPublicDomain){const e=(0,v.ZP)({store:n,fullyQualified:!1,duplicate:!0,pageVisitSource:o.tY.Duplicate});return void A.Li({environment:t,url:e,extraSearchParams:{...await P.tc(t),utm_source:"public_page",utm_content:"duplicate_button",tid:await(0,g.cG)(t),from:"public_page",n:"duplicate_public_page"}})}const{currentUserRootStore:s}=y.default.state;if(s){const e=h.o(s);if(1===e.length){const o=e[0],i=o.getSpaceStore();if(!i)return;V({environment:t,store:n,spaceStore:i,spaceViewStore:o,isPrivate:!0,context:"public_page_duplicate_single_workspace"})}else _.Z.setState({open:!0,store:n,originRect:i})}else N({currentUserId:t.currentUser.id,blockId:n.id}),A.c4({environment:t,url:l._j.login})}const Z=(0,d.defineMessages)({untitledBlockRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledBlockRecordTitle"},untitledSpaceRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledSpaceRecordTitle"},loadingStateDisplayText:{defaultMessage:"Duplicating {blockTitle} to {spaceTitle}â€¦",id:"forkPageActions.loadingStateDisplayText"}});async function V(e){const{environment:t,store:n,spaceStore:i,context:r}=e,{blockTitle:a}=j({store:n,spaceStore:i}),l=Date.now();let c;const d=e.duplicateFunc?e.duplicateFunc():U({...e}),[m]=await Promise.all([d.then((e=>(c=Date.now()-l,e))),(0,s.Vs)(750)]);C.x();const f=Date.now()-l;"public_page_duplicate_multiple_workspace"!==r&&"public_page_duplicate_single_workspace"!==r&&"signin_after_duplicate"!==r||w.Xy(t,{from:"publicPage",success:!m.error,template_name:a,template_block_id:n.id,target_space_id:i.id,context:r,template_duplication_duration_ms:c,template_duplication_duration_with_minimum_ms:f},e.shouldLogToStatsig),void 0!==m.error?k.showErrorMessage(m.error):p._({environment:t,store:m.value,visitType:u.vu.Link,pageVisitSource:o.tY.Duplicate})}function j(e){var t,n;const{store:o,spaceStore:r}=e,a=b.default.getIntl();let s=null===(t=o.getModel())||void 0===t?void 0:t.getRenderTitleWithEmoji({getRecordModel:o.getRecordModel,userTimeZone:(0,i.r)(),placeholder:a.formatMessage(Z.untitledBlockRecordTitle),intl:a});void 0===s&&(s=a.formatMessage(Z.untitledBlockRecordTitle));let l=null===(n=r.getModel())||void 0===n?void 0:n.getRenderTitleWithEmoji({placeholder:a.formatMessage(Z.untitledSpaceRecordTitle)});return void 0===l&&(l=a.formatMessage(Z.untitledSpaceRecordTitle)),C.j({message:Z.loadingStateDisplayText,interpolatedValues:{blockTitle:s,spaceTitle:l}}),{blockTitle:s,spaceTitle:l}}async function U(e){const{environment:t,store:n,spaceStore:o,spaceViewStore:i,isPrivate:r,duplicateOnlyCollectionSchema:a}=e;return new Promise((e=>{D.createAndCommit({userAction:"forkPageActions.forkPage",environment:t,perform:s=>{const[l,c]=I.Qi({environment:t,stores:[n],transaction:s,addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:o.id,baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1,duplicateOnlyCollectionSchema:a}),d=l[0];c.then((n=>{n?e({error:n}):(e({value:d}),d.isLocked()&&D.createAndCommit({userAction:"forkPageActions.forkPageWithLoadingAndNavigate",environment:t,perform:e=>{x.Wq({environment:t,store:d,isLocked:!1,transaction:e})}}))})),R.Hj({environment:t,spaceStore:o,spaceViewStore:i,pageStore:d,isPrivate:r,location:{type:"prepend"},transaction:s})}})}))}async function L(e){const{environment:t,store:n,duplicateOnlyCollectionSchema:o}=e,i=y.default.state.currentSpaceStore,r=y.default.state.currentSpaceViewStore,s=y.default.state.mainEditorCurrentBlockStore;if(!i||!r||!s)return;const l=await m.NN({environment:t,block:n,action:"duplicate"});if("user_canceled"===l)return;return await new Promise((s=>{D.createAndCommit({userAction:"forkPageActions.duplicateTo",environment:t,perform:d=>{const[u,p]=I.Qi({environment:t,stores:l,transaction:d,addCopyName:e.addCopyName,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:i.id,baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:"block"===e.newParent.table&&e.newParent.useCrdt(),duplicateOnlyCollectionSchema:o});p.then((n=>{n?s({error:n}):(s({value:u}),e.unlockPage&&u.find((e=>e.isLocked()))&&D.createAndCommit({userAction:"forkPageActions.duplicateToHelper",environment:t,perform:e=>{u.forEach((n=>{n.isLocked()&&x.Wq({environment:t,store:n,isLocked:!1,transaction:e})}))}}))}));const m={type:"append",after:e.appendWithoutAfter?void 0:n.id},g=a.d9(u).reverse();if("team"===e.newParent.table)T.at({transaction:d,currentSpaceViewStore:r,teamStore:e.newParent,targets:u,environment:t,location:m,action:"move",value:{type:"team",id:e.newParent.id,spaceId:i.id}});else if("block"===e.newParent.table)for(const t of g)M.jG({parentStore:e.newParent,childStore:t,transaction:d,after:m.after});else if("space"===e.newParent.table)for(const e of g)R.Hj({environment:t,spaceStore:i,spaceViewStore:r,pageStore:e,isPrivate:!0,location:m,transaction:d});else(0,c.t1)(e.newParent);return u}})}))}async function O(e){const{environment:t}=e,n=await L({...e,addCopyName:!0});n&&(void 0!==n.error?k.showErrorMessage(n.error):p._({environment:t,store:n.value[0],visitType:u.vu.Link,pageVisitSource:o.tY.Duplicate}))}function N(e){let{currentUserId:t,blockId:n}=e;r.Z.set({userId:t,key:B,value:n})}function z(e){return r.Z.get({userId:e,key:B})}},96802:(e,t,n)=>{n.d(t,{FH:()=>m,MF:()=>y,Mp:()=>_,Wq:()=>f,bf:()=>S,fs:()=>h,hc:()=>g,is:()=>b,zM:()=>v});var o=n(41432),i=n(43593),r=n(15157),a=n(72126),s=n(63143),l=n(95477),c=n(24990),d=n(26136),u=n(41433),p=n(9953);function m(e){const{stores:t,update:n,transaction:i}=e;for(const a of t)p.sW({store:a.getFormatStore(),data:(0,s.Q2)(n),transaction:i}),a instanceof d.G&&a.getType()===o.Ti.callout&&n.block_color&&r.Z.set({userId:a.environment.currentUser.id,key:u.Ns,value:n.block_color})}function f(e){const{environment:t,store:n,isLocked:o,transaction:i}=e,{id:r}=t.currentUser;if(!r)return;const a={block_locked:o,block_locked_by:r};p.sW({store:n.getFormatStore(),data:a,transaction:i})}function g(e){const{environment:t,store:n,alignment:o,transaction:i}=e,{id:r}=t.currentUser;if(!r)return;const a={block_alignment:o};p.sW({store:n.getFormatStore(),data:a,transaction:i})}function h(e){const{store:t,url:n,position:o,transaction:r}=e,a=(0,i.Wv)(n,l.default.secureFileS3.url,l.default.secureFileS3V2.url,l.default.secureFileConfig.rootPath,l.default.secureFileConfig.hostname),s=a?a.link:n;m({stores:[t],update:{page_cover_position:o},transaction:r});const c=t.getCoverStore();c&&p.sO({store:c,value:s,transaction:r})}function v(){const e=a.UP(["Activities","Objects","Travel & Places"]),t=c.Z.state.emojiByCategory[e];return a.UP(t)}function b(e){const{store:t,transaction:n}=e,o=t.getIconStore();if(o){if(!o.getValue()){const e=v();p.sO({store:o,value:e,transaction:n})}}}function y(e){const{store:t,transaction:n}=e,o=t.getCoverStore();o&&p.sO({store:o,value:null,transaction:n})}function _(e){const{store:t,coverPosition:n,transaction:o}=e;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e)return void p.sW({store:e.getFormatStore(),data:{collection_cover_position:n},transaction:o})}m({stores:[t],update:{page_cover_position:n},transaction:o})}function S(e){const{store:t,coverPosition:n,transaction:o}=e;m({stores:[t],update:{card_cover_position:n},transaction:o})}},47678:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(72126),i=n(45010),r=n(80444),a=n(24612),s=n(27724),l=n(77503),c=n(54564),d=n(42858);function u(e){const{RouterStore:t}=e,{PageScroller:n}=i.Z;if("page"===t.state.route.name&&r.default.state.currentLoadingContainerStore&&r.default.state.currentLoadingContainerStore.state.ready)if(a.Z.reset(),l.Z.reset(),t.state.route.scrollToBlockId){const n=[t.state.route.scrollToBlockId];d.WG(e,n);const o=s.default.state.stores[0];o&&t.state.route.discussionId&&c.Ib({environment:e,blockStore:o,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1})}else t.state.route.discussionId&&r.default.state.mainEditorCurrentBlockStore?c.Ib({environment:e,blockStore:r.default.state.mainEditorCurrentBlockStore,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):"pop"===t.state.action&&t.state.historyState&&(n&&o.hj(t.state.historyState.scrollTop)&&n.scrollTo(t.state.historyState.scrollTop,void 0),t.state.historyState.blockIds&&d.DQ(e,t.state.historyState.blockIds))}},54604:(e,t,n)=>{n.d(t,{ui:()=>a,xv:()=>s,zp:()=>l});var o=n(50906),i=n(17903),r=n(38302);function a(e){const{environment:t,renderFullScreenNode:n,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c}=e;o.Lfx(t,{type:"open"}),r.Z.setState({...r.Z.state,isOpen:!0,fullscreenNodeAnimationComplete:!1,backgroundAnimationComplete:!1,renderFullScreenNode:n,startScrollTop:i.Z.state.scrollTop,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c})}function s(){r.Z.setState({...r.Z.state,isOpen:!1})}function l(e){return e<1020?0:32}},44886:(e,t,n)=>{n.d(t,{A1:()=>h,WY:()=>f,dD:()=>p,gq:()=>y,nt:()=>b,rB:()=>g,uv:()=>m,vi:()=>v});n(57658);var o=n(41432),i=n(72126),r=n(28020),a=n(73959),s=n(35328),l=n(95802),c=n(26664),d=n(45131),u=n(94419);function p(e){const{parentStore:t,block:n,type:o,transaction:i}=e,r=t.getTransclusionReferenceTargetStore()??t,a=r.getContentStores(),l=a.indexOf(n);if(l<=0)return;const c=a[l-1];if(!c)return;if(!_(r)||!_(c))return;u.Od({parent:r.getContentStore(),childToRemove:n,transaction:i});const{child:p}=u.R3({parent:c.getContentStore(),append:n,transaction:i});if("self"===o&&!p.isType("table"))for(const s of p.getContentStores().reverse())u.Od({parent:p.getContentStore(),childToRemove:s,transaction:i}),u.BE({parent:c.getContentStore(),insert:s,after:p,transaction:i});return s.BX(c)&&d.Z.setOpen(c.id,!0),p}function m(e){const{grandparentStore:t,parentStore:n,block:o,transaction:i}=e,r=t.getTransclusionReferenceTargetStore()??t;if(r.getContentStores().indexOf(n)<0)return;const a=n.getContentStores(),s=a.indexOf(o);if(s<0)return;if(!_(r)||!_(n))return;if("transclusion_container"===n.getType()||"transclusion_reference"===n.getType())return;if(_(o))for(let c=s+1;c<a.length;c++){const e=a[c];u.Od({parent:n.getContentStore(),childToRemove:e,transaction:i}),u.R3({parent:o.getContentStore(),append:e,transaction:i})}u.Od({parent:n.getContentStore(),childToRemove:o,transaction:i});const{child:l}=u.BE({parent:r.getContentStore(),insert:o,after:n,transaction:i});return l}function f(e){const{transaction:t}=e,n=e.blocks,o=n[0];if(!o)return;const i=S(o);if(!i)return;const{previousChildStore:r}=i,a=r.getContentStore();return s.BX(r)&&d.Z.setOpen(r.id,!0),n.map((e=>{const n=e.getRecordStoreUIParent();null!=n&&n.valueIs(c.i)&&u.Od({parent:n,childToRemove:e,transaction:t});return u.R3({parent:a,append:e,transaction:t}).child}))}function g(e){const{transaction:t}=e;let n=e.blocks;const o=n[0];if(!o)return;const r=w(o);if(!r)return;const{closestParentStore:a,closestParentParentStore:s}=r,l=a.getContentStores(),d=s.getContentStore();if(l){let e;for(const[t,o]of l.entries())if(o.id===n[n.length-1].id){e=l.splice(t+1);break}n=i.d9(n).reverse(),n=n.map(((n,o)=>{const i=n.getRecordStoreUIParent();null!=i&&i.valueIs(c.i)&&u.Od({parent:i,childToRemove:n,transaction:t});const r=u.BE({parent:d,insert:n,after:a,transaction:t});if(0===o&&e&&_(n))for(const a of e){const e=a.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&u.Od({parent:e,childToRemove:a,transaction:t}),u.BE({parent:n.getContentStore(),insert:a,transaction:t})}return r.child}))}return n}function h(e){const{transaction:t,blocks:n}=e,o=n[0];if(!o)return;const a=r.RM();if(!a)return;const s=I(a),l=i.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=i.qr(s,((e,t)=>t<l&&e.parent===o.getRecordStoreUIParent())),d=i.dF(s,((e,t)=>t<c&&!o.uiContains(e.parent)));return d?C({blocks:n,listPosition:d,transaction:t}):void 0}function v(e){const{transaction:t,blocks:n}=e,o=i.Z$(n);if(!o)return;const a=r.RM();if(!a)return;const s=I(a),l=i.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=s.find(((e,t)=>t>l&&!o.uiContains(e.parent)));return c?C({blocks:n,listPosition:c,transaction:t}):void 0}function b(e){return Boolean(e&&S(e))}function y(e){return Boolean(e&&w(e))}function _(e){const t=r.np(),n=e.getType(),i=e.getFormat();return n&&((0,o.TT)(n,i)||e===t)}function S(e){const t=(0,a.sQ)(e);if(null==t||!t.isDefined()||!_(t))return;const n=t.getContentStores(),o=n[n.indexOf(e)-1];return null!=o&&o.isDefined()&&_(o)?{previousChildStore:o}:void 0}function w(e){const t=(0,a.sQ)(e);if(!t)return;if(!t.isDefined()||!_(t))return;const n=(0,a.sQ)(t);return n&&n.isDefined()&&_(n)?{closestParentStore:t,closestParentParentStore:n}:void 0}function k(e,t){let n=[];const{store:o}=e.props;if(e.props.canDropAbove&&x(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&n.push({parent:e})}const r=t.filter((t=>t.getContextClosestSelectable()===e));for(const a of r)n=i.G0(n,k(a,t));if(e.props.canDropBelow&&x(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&(e.id===o.id?n.push({parent:e}):n.push({parent:e,after:o}))}return n}function I(e){let t=[];const n=l.C.getMembersByDOMOrder({filter:()=>!0}),o=e.getContentStores();for(const r of o){const e=n.find((e=>e.props.store===r));e&&(t=i.G0(t,k(e,n)))}return t}function x(e){return"collection"!==e.getParentTable()}function C(e){const{blocks:t,listPosition:n,transaction:o}=e,r=i.d9(t).reverse();for(const i of t){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&u.Od({parent:e,childToRemove:i,transaction:o})}let a;return a=n.after?r.map((e=>u.BE({insert:e,after:n.after,parent:n.parent,transaction:o}).child)):r.map((e=>u.Ce({prepend:e,parent:n.parent,transaction:o}).child)),a}},88295:(e,t,n)=>{n.d(t,{Hk:()=>M,c_:()=>x,f8:()=>I,gt:()=>T,lP:()=>C});var o=n(41432),i=n(21202),r=n(97880),a=n(82798),s=n(19785),l=n(68422),c=n(28020),d=n(98165),u=n(67669),p=n(80444),m=n(83212),f=n(26136),g=n(50906),h=n(49865),v=n(98834),b=n(94419),y=n(60870),_=n(11302),S=n(19358),w=n(9953),k=n(82530);function I(e){const{environment:t,transaction:n,titleText:o,recordStoreParent:r}=e,{databaseTemplate:s,createInValue:l}=function(e,t){let n;if("page"===e.type){const o=f.G.createChildStore(t,{table:i.iU,id:e.id});if(o.isTemplate()){const t=(0,d.Dg)(o,1);t&&(n=o,e={type:"page",id:t.id})}}return{databaseTemplate:n,createInValue:e}}(e.createInValue,r),c="block"===l.type?f.G.createChildStore(r,{table:i.iU,id:l.id}):void 0,u=w.j4({transaction:n,environment:t,type:"page",inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,properties:o?{title:[[o]]}:void 0,spaceId:r.pointer.spaceId,useCrdt:"block"===l.type&&(0,a.TO)(c).useCrdt()});let p;switch(l.type){case"block":S.YM({transaction:n,childStore:u,parentStore:(0,a.TO)(c),alive:!0});break;default:p=_.Ws({transaction:n,environment:t,targets:[u],value:l})}return{environment:t,databaseTemplate:s,createdPages:[u],moveToStorePromise:p}}async function x(e){const{environment:t,createdPages:n,databaseTemplate:o,moveToStorePromise:r}=e.createInState;let a;(null==n?void 0:n.length)>0&&(a=n[0].id),g.W2j(t,{type:"page",from:e.analyticsFrom,new_page_id:a,creating_block_id:a});const{currentSpaceStore:s}=p.default.state;if(o)k.createAndCommit({userAction:"inlinePageActions.completeCreateIn",environment:t,perform:e=>{n.forEach((n=>v.ob({title:{text:n.getTitleValue()},environment:t,store:n,templateStore:o,isKeyboard:!1,isCreateIn:!0,transaction:e,from:"inline_page_action"})))}}),s&&await y.j2(s,s.id,o.id);else{const e=await r;s&&e&&e.table===i.iU&&await y.j2(s,s.id,e.id)}}function C(e){const{environment:t,transaction:n,parentStore:a,inlinePageIds:l}=e;if(0===l.length)return;const c=f.G.createChildStore(a,a.pointer),p=(0,d.qA)(c).find((e=>{if(e.table!==i.iU)return!1;const t=e.getType(),n=e.getFormat();return!(!t||!n)&&((0,o.Um)(t,n)||(0,o.S9)(t))})),g=p&&p.isCollectionView()?p.getCollectionViewCollectionStore():p,v=g&&m.Z.getMode(t,g);if(!g||(0,u.YF)(v)||!g.canEdit()){for(const e of l)s.nO({pageStore:f.G.createChildStore(a,{table:i.iU,id:e}),transaction:n});return}let y=a;for(const o of l){const e=f.G.createChildStore(a,{table:i.iU,id:o});if(e.isEmptyPage()){s.nO({pageStore:e,transaction:n});continue}const l=!e.isDefined()||Boolean(e.getAlive());S.YM({parentStore:g,childStore:e,transaction:n,alive:l}),"block"!==g.table?"collection"!==g.table?(0,r.t1)(g):h.mp({environment:t,store:e,collectionStore:g,shouldCoerce:!0,groupsPointer:[],transaction:n}):(b.BE({parent:g.getContentStore(),after:y,insert:e,transaction:n}),y=e)}}function T(e){const t=c.np();if(t){if(e&&e.table===i.iU)return{pageStore:(0,d.Dg)(e,0)||t,createInValue:{type:"block",id:e.id}};if(e&&(0,d.n3)(e)){const t=(0,d.Dg)(e,0);if(t)return{pageStore:t,createInValue:{type:"page",id:t.id}}}return{pageStore:t,createInValue:{type:"page",id:t.id}}}}async function M(e,t){const{createInValue:n,blocksToTransform:o}=t,r="page"===n.type?new f.G(e,{table:i.iU,id:n.id}):void 0,a=Boolean(r&&r.isTemplate()),{performResult:{transformedPages:s,pageStore:c}}=await k.createAndCommitAsync({environment:e,userAction:"inlinePageActions.createNewPageIn",waitForServerCommit:!0,perform:async t=>{const s=o.map((n=>l.vs({environment:e,block:n,blockType:"page",transaction:t})));let c;if("page"===n.type)if(r&&a){const n=r.getParentCollectionStore(),o=null==n?void 0:n.getParentPointer();o&&o.table===i.iU&&(c=await _.Y({transaction:t,environment:e,targets:s,value:{type:"page",id:o.id}}))}else{const{mainEditorCurrentBlockStore:o}=p.default.state;o&&o.id!==n.id&&(c=await _.Y({transaction:t,environment:e,targets:s,value:n}))}else"team"===n.type&&await _.Ws({transaction:t,environment:e,targets:s,value:n});return{transformedPages:s,pageStore:c}}});await x({analyticsFrom:"new_page_in",createInState:{environment:e,createdPages:s,databaseTemplate:a?r:void 0,moveToStorePromise:Promise.resolve(c)}})}},96313:(e,t,n)=>{n.d(t,{QZ:()=>D,az:()=>E,pg:()=>B});var o=n(26263),i=n(14577),r=n(41432),a=n(59753),s=n(99405),l=n(21202),c=n(33709),d=n(23867),u=n(70203),p=n(97880),m=n(9953),f=n(24677),g=n(98104),h=n(95477),v=n(69783),b=n(65598),y=n(89224),_=n(70726),S=n(64233),w=n(48863),k=n(19111),I=n(26136),x=n(10743),C=n(52229),T=n(50906),M=n(94419),P=n(4408),A=n(993),R=n(82530);function D(e){const{environment:t,textStore:n,blockStore:r,url:a,oldTextValue:u,urlSelection:p}=e;if(x.Z.state.open||v.Z.state.open||k.Z.state.open||S.Z.state.open)return!1;const m=y.get();if(!m)return!1;const f=y.getRect(m);if(!f)return!1;const g=(0,s.Wj)({url:a,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,isMobile:t.device.isMobile,protocol:h.default.protocol,currentUrl:window.location.href});if("page"===g.name&&!!g.discussionId&&g.discussionId){const e=g.discussionId,s=g.blockId,m=r.getParentBlockStore();if(!m)return!1;const h=(0,I.Kv)(m,{table:l.iU,id:s,spaceId:(0,d.C)(m.pointer.spaceId)}),v=(0,I.Kv)(h,{table:c.qF,id:e,spaceId:(0,d.C)(r.pointer.spaceId)});if("none"===v.getRole())return!1;const y=new i.Z((()=>b.D4(v)[0]),{debugName:"firstCommentStore"}),S=new o.Z({name:"internalUnfurlingMenuActions.activate",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(S);const k=r.clone(S),x=n.clone(S),C=m.clone(S);return w.Z.setState({args:{commentStore:y},stores:{blockStore:r,textStore:n,parentStore:m},temporaryStores:{blockStore:k,textStore:x,parentStore:C},temporaryRecordCache:S,focusedIndex:_.Z.Preview,selectionRect:f,oldTextValue:u,open:!0,url:a,urlSelection:p}),T.elP(t,{url:a}),!0}return!1}function B(e){const{actionType:t,environment:n,commentStore:o,useTempStores:i}=e,r=w.Z.state;if(!r.open)return;const{oldTextValue:s}=r,l=i?r.temporaryStores:r.stores,{textStore:c,blockStore:m,parentStore:h}=l,v=n.currentUser.id;if(v){if(i){r.temporaryRecordCache.clearCache();for(const e in r.temporaryStores){const t=r.temporaryStores[e],o={userId:v,pointer:t.pointer},i=n.defaultRecordCache.inMemoryRecordCache.getRecord(o);i?P.Wl({environment:n,inMemoryRecordCache:r.temporaryRecordCache,pointer:t.pointer,model:a.kk.fromValue(t.pointer.table,i.value),role:i.role,updatePaths:[[]],userId:v,force:!0,debugSource:"setUnfurlType"}):P.uo({environment:n,inMemoryRecordCache:r.temporaryRecordCache,persistedRecordCache:void 0,pointer:t.pointer,userId:v})}}else n.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(r.temporaryRecordCache);switch(t){case _.Z.Link:f.eP({environment:n,store:r.stores.blockStore}),g.Z5({store:r.stores.textStore,selection:{startIndex:r.urlSelection.endIndex,endIndex:r.urlSelection.endIndex}}),w.Z.setState({...r,focusedIndex:_.Z.Link});break;case _.Z.Mention:if(!o)return;const e=(0,d.C)(c.pointer.spaceId);if(!e)return;const i=o.id;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.mention",perform:t=>{A.sO({environment:n,store:c,value:s,transaction:t}),A.lZ({environment:n,store:c,selection:{startIndex:r.urlSelection.startIndex,endIndex:r.urlSelection.startIndex},annotation:u.mfJ(i,e),transaction:t,analyticsFrom:"block"})}}),w.Z.setState({...r,focusedIndex:_.Z.Mention});break;case _.Z.Preview:if(!o)return;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.preview",perform:e=>{A.sO({environment:n,store:c,value:s,transaction:e});const t=b.GP(o);if(!t)return;if(!b.HK(t)||!h||!t.getParentId())return;const i=C.k({environment:n,parentBlock:h,targetStore:o,transaction:e});if(M.BE({parent:h.getContentStore(),insert:i,after:m,transaction:e}),0===u.QaF(r.oldTextValue).trim().length){const t=I.G.createChildStore(h.getContentStore(),r.stores.blockStore.pointer);M.Od({parent:h.getContentStore(),childToRemove:t,transaction:e})}}}),w.Z.setState({...r,focusedIndex:_.Z.Preview});break;default:throw(0,p.t1)(t)}i||w.Z.setState({open:!1})}}function E(e){var t,n;const{block:o,transaction:i}=e,a=o.getType(),s=o.getFormat(),l=o.getSpaceId();if(!o.isDefined()||a!==r.Ti.alias||null==s||null===(t=s.alias_pointer)||void 0===t||!t.id)return;const c=[u.YCD(u.mfJ(null==s||null===(n=s.alias_pointer)||void 0===n?void 0:n.id,l))];m.sO({store:o,value:{type:r.Ti.text,properties:{title:c},format:null},transaction:i})}},62134:(e,t,n)=>{n.d(t,{B4:()=>d,Fe:()=>a,Zm:()=>l,dJ:()=>r,fg:()=>c,ys:()=>s});n(57658);var o=n(72126);function i(e,t){return e.KeyboardShortcutStackStore.state.stack.some((e=>t===e.listener))}function r(e,t,n){const{stack:o}=e.KeyboardShortcutStackStore.state;for(let i=o.length-1;i>=0;i--){const e=o[i],r=e.shortcuts[n];if(e.enable&&r)return void r(t)}}function a(e){const{environment:t,stackItem:n}=e,r=t.KeyboardShortcutStackStore;if(i(t,n.listener)){const e=r.state.stack.map((e=>e.listener===n.listener?n:e));r.setState({...r.state,stack:e})}else r.state.stack.push(n),r.setState({stack:o.MR(r.state.stack,(e=>e.priority))})}function s(e,t){if(i(e,t)){const n=e.KeyboardShortcutStackStore,i=n.state.stack,r=o.d1(i,(e=>t===e.listener));n.setState({...n.state,stack:r})}}function l(e,t){r(e,t,t.type)}function c(e){return{command:e.device.isMac?"âŒ˜":"ctrl",enter:"â†µ",delete:"del",backspace:"del",esc:"escape",left:"â†",right:"â†’",up:"â†‘",down:"â†“",tab:"â‡¥",alt:e.device.isMac?"âŒ¥":"alt"}}function d(e){return{command:e.device.isMac?"command":"control",esc:"escape"}}},94273:(e,t,n)=>{n.d(t,{Bk:()=>p,Ie:()=>f,Vr:()=>m,nr:()=>g,vq:()=>h});var o=n(99405),i=n(21202),r=n(54153),a=n(95477),s=n(84210),l=n(67669),c=n(26136);const d="lastVisitedRoute",u="lastVisitedRouteUserId";function p(e,t){const n=o.Wj({url:window.location.href,isMobile:e.device.isMobile,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,protocol:a.default.protocol,currentUrl:window.location.href}),{route:r,userId:s}=v();("root"===n.name||"new"===n.name||"nativeTab"===n.name)&&r&&"page"===r.name&&r.blockId&&s===t&&new c.G(e,{table:i.iU,id:r.blockId,spaceId:r.spaceId}).load()}function m(e){const{route:t,userId:n}=v();if(t&&"page"===t.name){return{url:(0,s.ZP)({fullyQualified:!1,store:new c.G(e,{table:i.iU,id:t.blockId,spaceId:t.spaceId},{userId:n}),scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),userId:n}}if(t&&"space"===t.name){return{url:(0,o.Xs)({route:t}),userId:n}}return{}}async function f(e){const{route:t,userId:n}=v();let r,a;if(t)if("page"===t.name){const d=new c.G(e,{table:i.iU,id:t.blockId,spaceId:t.spaceId},{userId:n});await d.load();l.IJ(e,d)?(a=t.spaceId??d.getSpaceId(),r=a?o.pv(a):void 0):(r=(0,s.ZP)({fullyQualified:!1,store:d,scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),a=d.getSpaceId())}else"space"===t.name?(a=t.spaceId,r=(0,o.Xs)({route:t})):("nativeTab"===t.name||"workspaceSetup"===t.name)&&(a=t.spaceId);return{url:r,userId:n,route:t,spaceId:a}}function g(e,t){r.Z.set(d,e),r.Z.set(u,t)}function h(){r.Z.remove(d),r.Z.remove(u)}function v(){return{route:r.Z.get(d),userId:r.Z.get(u)}}},20747:(e,t,n)=>{n.d(t,{FZ:()=>v,U_:()=>h,fU:()=>_});var o=n(41432),i=n(21202),r=n(82798),a=n(26136),s=n(26664),l=n(50906),c=n(96802),d=n(94419),u=n(9953);const p=function(e){const t=e.getRecordStoreUIAncestor(2);if(t&&t instanceof a.G&&t.isType(o.Ti.columnList))return t},m=function(e){return e&&e instanceof a.G&&e.isType(o.Ti.column)};function f(e){const{environment:t,targets:n,inMemoryRecordCache:i,transaction:a}=e;(0,r.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.columnList,properties:{},inMemoryRecordCache:i,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),c=s.getContentStore();for(const o of n)d.R3({parent:c,append:o,transaction:a});return l.xh4(t),s}function g(e){const{environment:t,targets:n,inMemoryRecordCache:i,transaction:a}=e;(0,r.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.column,format:{column_ratio:1},inMemoryRecordCache:i,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),l=s.getContentStore();for(const o of n)d.R3({parent:l,append:o,transaction:a});return s}function h(e){const{environment:t,parent:n,insertStores:o,left:r,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"left"}),m(r))c=r,u=p(r);else{c=g({environment:t,targets:[r],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:r,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.Vt({parent:t,insert:h,before:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:i.iU,id:h.id}).getContentStores()}return[]}function v(e){const{environment:t,parent:n,insertStores:o,right:r,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"right"}),m(r))c=r,u=p(r);else{c=g({environment:t,targets:[r],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:r,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.BE({parent:t,insert:h,after:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:i.iU,id:h.id}).getContentStores()}return[]}const b=function(e){const{columnList:t,addedColumn:n,transaction:o}=e,i=t.getContentStores(),r=1/i.length;c.FH({stores:[n],update:{column_ratio:r},transaction:o});for(const a of i)if(a.id!==n.id){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:(1-r)*e},transaction:o})}},y=function(e){const{columnList:t,removedColumn:n,transaction:o}=e,i=t.getContentStores(),r=n.getColumnRatio();for(const a of i){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:e/(1-r)},transaction:o})}},_=function(e){const{parent:t,transaction:n}=e,o=t.getRecordStoreUIParent();let i;if(m(o)&&(i=p(o)),i){const e=i.getContentStore(),t=i.getContentStores();for(const r of t){0===r.getContentStores().length&&(d.Od({parent:e,childToRemove:r,shouldGarbageCollect:!1,transaction:n}),y({columnList:i,removedColumn:r,transaction:n}))}const o=i.getContentStores();if(0===o.length){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(s.i)&&d.Od({parent:e,childToRemove:i,transaction:n,shouldGarbageCollect:!1})}else if(1===o.length){const e=i.getRecordStoreUIParent(),t=o[0],r=t.getContentStore(),a=t.getContentStores();if(a.reverse(),null!=e&&e.valueIs(s.i)){for(const t of a)d.Od({parent:r,childToRemove:t,shouldGarbageCollect:!1,transaction:n}),d.BE({parent:e,insert:t,after:i,transaction:n});d.Od({parent:e,childToRemove:i,transaction:n,shouldGarbageCollect:!1})}}}}},65770:(e,t,n)=>{n.d(t,{YJ:()=>y,Z2:()=>b});n(57658),n(21703),n(41432);var o=n(68626),i=n(91155),r=n(4615),a=n(21202),s=n(23867),l=(n(9953),n(42858)),c=(n(993),n(82530)),d=n(95477),u=(n(28020),n(65598)),p=(n(41662),n(63208),n(26136)),m=(n(27724),n(50906)),f=n(54532),g=n(94419),h=n(24677);const v=new Set(["text","table_row","header","sub_header","sub_sub_header","to_do","bulleted_list","numbered_list"]);function b(e){const{parentStore:t,transaction:n,store:s,environment:l}=e,c=s.path[1];if(2!==s.path.length||"properties"!==s.path[0]||"string"!=typeof c)return;const d=s.getRecordStoreAtRootPath();if(!(d instanceof p.G))return;const u=d.getType();if(!u||!v.has(u))return;const h=function(e){var t;const{environment:n,store:o,parentStore:i,transaction:s}=e;if(o.getSpaceId()!==i.getSpaceId())return;const l=null===(t=i.getModel())||void 0===t?void 0:t.getContentIds();if(null==l||!l.includes(o.id))return;const c=f.K8(n,{blockId:o.id,inMemoryRecordCache:o.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!c)return;const d=f.E9({environment:n,sourceBlockId:o.id,targetBlockPointer:{table:a.iU,id:(0,r.ZP)(),spaceId:o.pointer.spaceId},sourceBlockSubtree:c,targetInMemoryRecordCache:o.inMemoryRecordCache,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,transaction:s,useCrdt:i.getRecordStoreAtRootPath().useCrdt()});return g.rS({parent:i.getContentStore(),oldChild:o,newChild:d.targetBlock,transaction:s}),d.targetBlock}({environment:l,store:d,parentStore:t,transaction:n}),b=null==h?void 0:h.getPropertyStore(c);if(b)return n.postSubmitCallbacks.push((e=>{e&&o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{miscErrorString:(0,i.LK)(e)}}),m.Gbs(l,{block_type:u,successful:!e})})),b;o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{message:"copied transclusion block does not have expected property"}})}function y(e){const{environment:t,store:n}=e,o=n.getRecordStoreUIParent();o&&(0,u.dz)(o)&&c.createAndCommit({userAction:"legacyTransclusionActions.fixLegacyTransclusion",environment:t,perform:e=>{const[i]=f.Qi({environment:t,stores:[n],addCopyName:!1,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,s.C)(n.pointer.spaceId),baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.getRecordStoreAtRootPath().useCrdt()}),r=i[0],{child:a}=g.BE({parent:o,insert:r,after:n,transaction:e});l.Od({store:n,transaction:e}),h.Z5({environment:t,stores:[a]})}})}},45990:(e,t,n)=>{n.d(t,{F5:()=>h,PP:()=>f,dz:()=>p,gp:()=>m,iX:()=>g});var o=n(70203),i=n(48709),r=n(68056),a=n(89224),s=n(23178),l=n(24666),c=n(993),d=n(98104),u=n(82530);const p=e=>{const t=l.default.state;if("editing"!==t.mode)return;const n="selectionFocus"===e.type?(0,r.TD)({store:e.store,selection:e.selection}):t.multiSelection,c=(0,r.QY)(n);if(!c)return;const{tokensInsideRange:d}=o.xrQ(c.store.getValue(),n.start.index,n.end.index),u=d.find((e=>Boolean(o.Hze(e)))),p=a.get();if(!p)return;const m=a.getRect(p);if(!m)return;const f=Boolean(u);s.Z.setState({open:!0,url:"",title:u&&(0,i.Ts)(u)||"",editingToken:u,savedTextSelectionState:{...t,multiSelection:n},selectionRect:m,focusLinkInput:!f&&e.focus,focusTitleInput:f&&e.focus})};function m(e){const{environment:t,transaction:n,url:o,title:i,editingToken:a,savedTextSelectionState:s}=e,l=(0,r.QY)(s.multiSelection);if(!l)return;a&&c.Be({environment:t,store:l.store,type:"a",selection:l.selection,transaction:n});const u=["a",o];return c.i8({environment:t,store:l.store,annotation:u,selection:l.selection,transaction:n}),d.Z5({store:l.store,selection:{startIndex:l.selection.startIndex,endIndex:l.selection.endIndex}}),i?{editingToken:[i,[u]]}:void 0}function f(e){const t=s.Z.state;if(!t.open)return;const{editingToken:n,savedTextSelectionState:o}=t;if(!n)return;const i=(0,r.QY)(o.multiSelection);i&&(u.createAndCommit({userAction:"linkAnnotationActions.unlinkSelection",environment:e,perform:t=>{c.Be({environment:e,store:i.store,type:"a",selection:i.selection,transaction:t})}}),l.default.emit(),s.Z.reset())}function g(e){const{environment:t,title:n,transaction:i,editingToken:a,savedTextSelectionState:s}=e;if(!n||!a)return;const l=(0,r.QY)(s.multiSelection);if(!l)return;const u=l.store;c.pz({environment:t,multiSelection:s.multiSelection,transaction:i});const p=l.selection.startIndex,m=p+n.length,f={startIndex:p,endIndex:m},g=["a",o.Hze(a)],h=o.V3y(n);return c.mM({environment:t,store:u,tokens:[h],index:p,transaction:i}),c.i8({environment:t,store:u,annotation:g,selection:f,transaction:i}),d.Z5({store:u,selection:f}),{editingToken:[n,[g]],savedTextSelectionState:{...s,multiSelection:{start:{store:u,index:p},end:{store:u,index:m}}}}}function h(){s.Z.setState({open:!1})}},94419:(e,t,n)=>{n.d(t,{BE:()=>s,Ce:()=>p,HP:()=>m,MK:()=>d,Od:()=>c,R3:()=>u,Vt:()=>l,rS:()=>a});n(57658);var o=n(20747),i=n(19358),r=n(82530);const a=function(e){const{parent:t,oldChild:n,newChild:o,transaction:a}=e,s=n.id,l=o.id,c=(t.getValue()||[]).indexOf(s);i.D0({parentStore:t,childStore:o,transaction:a}),i.If({parentStore:t,childStore:n,transaction:a}),c>=0&&(r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:l,after:s}}}),r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:s}}}));return{parent:t,child:o.cloneWithNewUIParent(t)}},s=function(e){const{parent:t,insert:n,after:o,transaction:a}=e;let s;o&&(s=o.id),i.D0({parentStore:t,childStore:n,transaction:a}),r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{after:s,id:n.id}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},l=function(e){const{parent:t,insert:n,before:o,transaction:a}=e;let s;o&&(s=o.id),i.D0({parentStore:t,childStore:n,transaction:a}),r.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{before:s,id:n.id}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},c=function(e){void 0===e.shouldGarbageCollect&&(e.shouldGarbageCollect=!0);const{parent:t,childToRemove:n,shouldGarbageCollect:a,transaction:s}=e;i.If({parentStore:t,childStore:n,transaction:s}),r.applyOperation({transaction:s,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}}),a&&s.preEnqueueActions.push((()=>{o.fU({parent:t,transaction:s})}));const l=n.cloneWithNewUIParent(t);return{parent:t,child:l}},d=function(e){const{parent:t,append:n,transaction:o}=e;i.D0({parentStore:t,childStore:n,transaction:o}),r.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"keyedObjectListAfter",args:{value:n.pointer,after:void 0}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},u=function(e){const{parent:t,append:n,transaction:o,after:a}=e;i.D0({parentStore:t,childStore:n,transaction:o}),r.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id,after:a}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},p=function(e){const{parent:t,prepend:n,transaction:o,before:a}=e;i.D0({parentStore:t,childStore:n,transaction:o}),r.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{id:n.id,before:a}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},m=function(e){const{parent:t,current:n,after:o,transaction:i}=e;o?s({parent:t,insert:n,after:o,transaction:i}):p({parent:t,prepend:n,transaction:i});return{parent:t,child:n.cloneWithNewUIParent(t)}}},13084:(e,t,n)=>{n.d(t,{Bm:()=>M,DC:()=>T,HO:()=>P,LQ:()=>x,UG:()=>A,dM:()=>B,uQ:()=>C});n(21703);var o=n(1302),i=n(41432),r=n(14248),a=n(72126),s=n(21202),l=n(95371),c=n(28020),d=n(65598),u=n(69645),p=n(73959),m=n(55367),f=n(26136),g=n(34583),h=n(49865),v=n(42239),b=n(31781),y=n(20747),_=n(94419),S=n(9953),w=n(42858),k=n(24677),I=n(98104);function x(e){const{environment:t,droppedDirection:n,droppedStores:o,targetStore:l,targetParentStore:c,transaction:d,duplicate:u}=e,p=o.every((e=>e.isExternalObjectInstancePageBlockStore()))||u;if(l&&n===m.vh.Onto){k.ZH(t);const e=!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction()),n=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l.useCrdt()});let a=l;if(l.isType(i.Ti.alias)){const e=l.getAliasTargetStore();if(!e)throw new Error("Alias has no target.");e instanceof f.G&&(a=e)}const s=a.getCollectionViewCollectionStore();if(a.isCollectionView()&&!a.isCollectionViewPageWithContent()){if(!s)throw new Error("CollectionStore is not defined.");const e=h.o3({environment:t,stores:n,transaction:d,collectionStore:s});for(const n of e)h.mp({environment:t,store:n,collectionStore:s,shouldCoerce:!0,groupsPointer:[],transaction:d});return e}{const e=a.getAssociatedCollectionStore();if(null!=e&&e.isPageTreeCollection())for(const o of n){if("page"!==o.getType())continue;if(!o.isDefined())continue;const t=r.Xq({blockProperties:o.getProperties(),oldSchema:o.getSchema(),newSchema:e.getSchema(),typesMatch:!1,oldPropertyMapping:void 0,newPropertyMapping:void 0});t.propertyUpdate&&Object.keys(t.propertyUpdate).length>0&&S.sW({store:o.getPropertiesStore(),data:t.propertyUpdate,transaction:d})}const t=a.getContentStore();for(const o of n)_.R3({parent:t,append:o,transaction:d});return n}}{const e=!!l&&!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction(!1)),i=c.getRecordStoreAtRootPath();let r=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l?l.useCrdt():i.table===s.iU&&i.useCrdt()});return n===m.vh.Above?(r=a.d9(r),l?r=a.UI(r,(e=>_.Vt({parent:c,insert:e,before:l,transaction:d}).child)):(r.reverse(),r=a.UI(r,(e=>_.Ce({parent:c,prepend:e,transaction:d}).child)))):n===m.vh.Below?(r=a.d9(r),l?(r.reverse(),r=a.UI(r,(e=>_.BE({parent:c,insert:e,after:l,transaction:d}).child))):r=a.UI(r,(e=>_.R3({parent:c,append:e,transaction:d}).child))):l&&n===m.vh.Left?r=y.U_({environment:t,parent:c,insertStores:r,left:l,transaction:d}):l&&n===m.vh.Right&&(r=y.FZ({environment:t,parent:c,insertStores:r,right:l,transaction:d})),w.DV({environment:t,insertedStores:r}),k.Z5({environment:t,stores:r}),r}}function C(e){var t;const{environment:n,files:o,droppedDirection:i,targetStore:r,targetParentStore:a,transaction:s}=e,l=a.inMemoryRecordCache,d=c.qQ(n);x({environment:n,targetParentStore:a,targetStore:r,droppedDirection:i,droppedStores:b.z({environment:n,files:o,inMemoryRecordCache:l,pageWidth:d,transaction:s,spaceId:null==r?void 0:r.pointer.spaceId,useCrdt:(null===(t=(0,p.sQ)(a))||void 0===t?void 0:t.useCrdt())??!1}),duplicate:!1,transaction:s})}function T(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;(function(e){const{environment:t,isClick:n,targetStore:o}=e;if(!n)return!1;const r=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.isTransclusionType())).ancestor;if(r&&r instanceof f.G){const e=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.getType()===i.Ti.transclusionReference)).ancestor,n=(e&&e instanceof f.G?e:void 0)||r,a=n.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;return k.Z5({environment:t,stores:[n]}),!0}return!1})(e)||B({environment:t,store:n,isAtStartOfLine:o})||function(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e,i=k.KX(),r=i.indexOf(n);if(-1===r)return!1;if(o)for(let a=r;a>=0&&a>r-20;a--){if(B({environment:t,store:i[a],isAtStartOfLine:!1}))return!0}else for(let a=r;a<i.length&&a<r+20;a++){if(B({environment:t,store:i[a],isAtStartOfLine:!0}))return!0}}(e)}function M(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;B({environment:t,store:n,isAtStartOfLine:o})||D({...e,placement:"after"})}function P(e){return R(e)}function A(e){return R(e)}function R(e){const{environment:t,container:n,store:o,transaction:r}=e,c=function(e){var t;const{container:n,store:o}=e;let r=(0,u.dq)({includeNonSelectableListContainer:!0,container:n});r&&o&&(r=a.Z$((0,l.DY)([r],(e=>e.value.store===o))));if(!r)return;let s=r;for(;s.children.length>0;){const e=a.Z$(s.children);if(0===e.children.length)break;const t=e.value.store.getType();if(t&&i.BT[t])break;s=e}return{parentStore:s.value.store,siblingStore:null===(t=a.Z$(s.children))||void 0===t?void 0:t.value.store}}({container:n,store:o});if(!c)return!1;const{parentStore:p,siblingStore:m}=c;if(m&&(0,d.PF)(m))return!1;const f=p.getParentStore();return D({environment:t,targetParentStore:(p.getType()===i.Ti.tab&&(null==f?void 0:f.table)===s.iU?f:p).getContentStore(),placement:"after",transaction:r})}function D(e){const{environment:t,targetStore:n,targetParentStore:r,placement:a,transaction:s}=e;if(r.getValue()&&g.M_(t)&&g.M_(t)){var l;const e=S.j4({environment:t,type:i.Ti.text,inMemoryRecordCache:r.inMemoryRecordCache,transaction:s,spaceId:r.pointer.spaceId,useCrdt:(null===(l=(0,p.sQ)(r))||void 0===l?void 0:l.useCrdt())??!1}),c="after"===a?_.BE({parent:r,after:n,insert:e,transaction:s}):_.Vt({parent:r,before:n,insert:e,transaction:s});return o.default.afterNextFlush((()=>{B({environment:t,store:c.child,isAtStartOfLine:!1})})),!0}return!1}function B(e){const{environment:t,store:n,isAtStartOfLine:o}=e,i=(0,p.mh)(n);return!!i&&(k.eP({environment:t,store:n}),o?I.N_({store:i}):I.NX({store:i}),!0)}},92625:(e,t,n)=>{n.d(t,{j:()=>r,x:()=>a});var o=n(33929),i=n(31104);const r=function(e){let{message:t,interpolatedValues:n,targetRecordId:r}=e;i.Z.setState({open:!0,message:o.default.formatMessage(t,n),targetRecordId:r})},a=function(){i.Z.setState({open:!1,targetRecordId:void 0})}},98730:(e,t,n)=>{n.d(t,{S:()=>s});var o=n(97638),i=n(85019),r=n(80444),a=n(84166);const s=async e=>{const{hasPublicAccessPermission:t}=o.bC(e),n=r.default.state.currentSpaceStore,s=r.default.state.currentSpaceViewStore;if(t)return;if(!n)return;const l=await(0,i.S)({environment:e,currentSpaceStore:n,currentSpaceViewStore:s,excludeCurrentPage:!1});a.Z.update((e=>({...e,localSearchableBlocksCache:l})))}},35979:(e,t,n)=>{n.d(t,{Be:()=>c,TR:()=>h,V_:()=>u,WA:()=>v,_5:()=>d,lJ:()=>m,nk:()=>g,wt:()=>f,z_:()=>l});var o=n(79946),i=n(38208),r=n(77472),a=n(77080);function s(e,t){r.j(e,t)}function l(e){s(e,"request_login_with_apple"),p(e,"login-with-apple")}function c(e){s(e,"request_login_with_google"),p(e,"login-with-google")}function d(e){s(e,"send_temporary_password"),p(e,"temporary-passcode")}function u(e){s(e,"redirect_to_saml_login"),p(e,"saml")}function p(e,t){r.j(e,"login_attempt",{login_method:t})}function m(e,t){i.o7(e,"signup_login_button_clicked",t),a.default.logEvent("signup_login_button_clicked",t.login_method,t)}function f(e,t){r.j(e,"login_success",t,{dontWait:!0})}function g(e,t){const{isBannedGoogleSSOUserAgent:n,isSignup:r}=t;i.o7(e,"onboarding_landing_page",{is_banned_google_sso_user_agent:n,is_signup:r}),r&&o.T1()}function h(e,t){const{actionType:n,isSignup:o}=t;r.j(e,"google_one_tap_login_button_click",{is_signup:Boolean(o),action_type:n},{dontWait:!0})}function v(e,t){r.lu(e,"login_email_input_updates","login_email_input_updates",1)}},97977:(e,t,n)=>{n.r(t),n.d(t,{actuallyLogoutAndDeleteAllLocalData:()=>ke,clearCurrentUser:()=>we,handleLoginFailureIfSamlRequired:()=>De,handleLoginSuccess:()=>Ie,handleLoginWithMfa:()=>xe,handleLoginWithTemporaryPasscodeSuccess:()=>me,initialize:()=>Me,loginPasswordReset:()=>be,loginSamlUser:()=>ye,loginSamlUserWithToken:()=>ve,loginWithAppleAuth:()=>fe,loginWithGoogleAuth:()=>ge,loginWithTemporaryPasscode:()=>pe,logout:()=>Se,logoutSingleAccount:()=>_e,openBrowserInMobileNative:()=>ue,redirectToSaml:()=>he,requestLoginWithGoogleOneTap:()=>de,setLocalStorageUserId:()=>Te,shouldCreatePassword:()=>Ae,showSamlRedirectMessage:()=>Be});n(57658),n(21703);var o=n(87997),i=n(79946),r=n(15145),a=n(53504),s=n(68626),l=n(72126),c=n(91155),d=n(29477),u=n(4615),p=n(99405),m=n(89101),f=n(19889),g=n(66079),h=n(9852),v=n(54153),b=n(64002),y=n(66504),_=n(9291),S=n(47839),w=n(29974),k=n(95477),I=n(77472),x=n(91924),C=n(12955),T=n(33954),M=n(87381),P=n(33929),A=n(28125),R=n(57491),D=n(78873),B=n(18514),E=n(15517),F=n(32223),Z=n(75538),V=n(18245),j=n(19034),U=n(78861),L=n(84693),O=n(58455),N=n(80444),z=n(77080),W=n(53730),q=n(26136),H=n(27724),K=n(24666),G=n(88893),$=n(50906),Q=n(54642),Y=n(90287),J=n(47307),X=n(57400),ee=n(3297),te=n(94273),ne=n(92625),oe=n(35979),ie=n(4408),re=n(8055),ae=n(32219),se=n(70782);const le=(0,_.defineMessages)({unsavedChanges:{id:"loginActions.dialogError.logoutUnsavedChanges.message",defaultMessage:"You have unsaved changes. If you log out now, you could lose them."},logoutWithoutSaving:{defaultMessage:"Discard edits and log out",id:"loginActions.dialogError.logoutUnsavedChanges.confirmButton.label"},signupPendingMessage:{defaultMessage:"Creating Notion accountâ€¦",id:"loginActions.signup.pending.message"},loginPendingMessage:{defaultMessage:"Logging in to Notionâ€¦",id:"loginActions.login.pending.message"},redirectSamlMessage:{defaultMessage:"SAML SSO required. Redirecting to the configured login page.",id:"loginActions.login.redirect.saml.message"}});async function ce(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];if(t){const e=(0,h.getOauthAuthorizationParams)();sessionStorage.clear(),(0,h.setOauthAuthorizationParams)(e)}else sessionStorage.clear();if(E.ZL(),n&&o.push(we(e)),o.push($.NMx()),e.mobileNative&&(o.push(e.mobileNative.logoutOfGoogle()),o.push(e.mobileNative.cancelUserBackgroundTasks())),e.device.isElectron&&(S.clearBrowserHistory(),t||S.clearCookies()),N.default.reset(),H.default.reset(),K.default.reset(),ie.LK(e),F.resetRecordSubscriptions(),j.Z.reset(),O.default.reset(),Z.default.reset(),o.push(W.transactionQueue.reset()),"on"===z.default.getGroup("clear-record-cache-on-login")){const t=e.defaultRecordCache.persistedRecordCache;t&&"reset"in t&&o.push(t.reset())}z.default.reset(),await Promise.all(o)}async function de(e){const{environment:t,idToken:n,store:o,frontPathName:i}=e,r=await(0,M.loadCurrentUserId)(t),a=V.default.mark("login_time.google"),s=await Q.loginWithGoogleJwt(t,{idToken:n});if(V.default.measure(a,{environment:t}),"success"===s.type){const{isNewSignup:e,userId:n}=s.data;return await Ie({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:r,loginMethod:"login-with-google-onetap",frontPathName:i}),{status:"success"}}{await De(t,s);const e=(0,T.wf)(P.default.getIntl(),s);return o.setState({...o.state,alert:e}),{status:"fail"}}}function ue(e,t){e.mobileNative&&((0,x.Q7)(e)?e.mobileNative.openAuthSessionBrowser(t):e.mobileNative.openInAppBrowser(t))}async function pe(e){const{environment:t,state:n,password:o,redirectURL:i,webBrowserDeviceId:r,passcodeEnterMethod:a,showInvitationVersion:s}=e,l=V.default.mark("login_time.passcode"),c=await(0,M.loadCurrentUserId)(t),d=await Q.loginWithEmail(t,{state:n,password:o});if(V.default.measure(l,{environment:t}),"success"!==d.type){await De(t,d);return(0,T.wf)(P.default.getIntl(),d)}{const{isNewSignup:e,userId:n}=d.data;if(S.electronApi&&function(e){let{environment:t,isNewSignup:n,webBrowserDeviceId:o}=e;if(!t.device.isElectron||!n||o)return!1;return z.default.checkGate("desktop_app_login_with_email_redirect")}({environment:t,isNewSignup:e,webBrowserDeviceId:r})){const e=b.$U(b.bf({url:`${k.default.domainBaseUrl}${m._j.loginSuccess}`}));S.electronApi.openExternalUrl(e)}else await me({environment:t,isNewSignup:e,userId:n,redirectURL:i,previousPersistedUserId:c,loginMethod:"temporary-passcode",webBrowserDeviceId:r,passcodeEnterMethod:a,showInvitationVersion:s})}}async function me(e){const{environment:t}=e;await Ie(e);const[n,o,i]=await Promise.all([Ae(t),Re(t),Pe()]);(n&&o||n&&i)&&D.E({environment:t})}async function fe(e){const{environment:t,code:n,encryptedToken:o,encryptedNonce:i,encryptedUserObject:r,webBrowserDeviceId:a}=e,s=V.default.mark("login_time.apple"),l=await(0,M.loadCurrentUserId)(t),c=await Q.loginWithAppleAuth(t,{code:n,encryptedToken:o,encryptedNonce:i,encryptedUserObject:r});if(V.default.measure(s,{environment:t}),"success"!==c.type)return await De(t,c),(0,T.wf)(P.default.getIntl(),c);{const{isNewSignup:e,userId:n}=c.data;await Ie({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:l,loginMethod:"login-with-apple",webBrowserDeviceId:a})}}async function ge(e){const{environment:t,encryptedToken:n,code:o,callbackType:i,webBrowserDeviceId:r}=e,a=await(0,M.loadCurrentUserId)(t),s=await Q.loginWithGoogleAuth(t,{code:o,encryptedToken:n,callbackType:i});if("success"!==s.type)return await De(t,s),(0,T.wf)(P.default.getIntl(),s);{const{isNewSignup:e,userId:n}=s.data;await Ie({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:a,loginMethod:"login-with-google",webBrowserDeviceId:r})}}function he(e,t){oe.V_(e),e.mobileNative?ue(e,t):e.device.isElectron&&S.electronApi?S.electronApi.openExternalUrl(t):window.location.href=t}async function ve(e){const{environment:t,csrfState:n,token:o,isNewSignup:i}=e,r=await(0,M.loadCurrentUserId)(t),a=await C.getBrowserId(t);n||o||s.log({level:"error",type:"loginSamlUserWithToken",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:a,isNewSignup:i}}});const l=await Q.loginWithEmail(t,{state:n,password:o});if("success"!==l.type)return await De(t,l),(0,T.wf)(P.default.getIntl(),l);{const{userId:e}=l.data;await Ie({environment:t,isNewSignup:i,userId:e,previousPersistedUserId:r,loginMethod:"saml"})}}async function be(e){const{environment:t,csrfState:n,password:o,loginStore:i}=e,r=await(0,M.loadCurrentUserId)(t);if(!n){const e=await C.getCookie(t,"notion_browser_id");s.log({level:"error",type:"loginPasswordReset",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:e,previousPersistedUserId:r}}})}const a=await Q.loginWithEmail(t,{state:n,password:o,passwordReset:!0});if("success"!==a.type)return await De(t,a),(0,T.wf)(P.default.getIntl(),a);{const{userId:e,enabledMfaSettings:n}=a.data;n&&n.length>0?(xe({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:r,loginMethod:"password-reset",loginStore:i,mfaSettings:n}),re.Li({environment:t,url:m._j.login}),D.E({environment:t})):(await Ie({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:r,loginMethod:"password-reset"}),D.E({environment:t}))}}async function ye(e){const{environment:t,userId:n,previousUserId:o,isNewSignup:i}=e;await Ie({environment:t,isNewSignup:i,userId:n,previousPersistedUserId:o,loginMethod:"saml"})}async function _e(e){const{environment:t,userId:n}=e,{nextUserId:o,nextSpaceViewStore:i}=function(e){const{environment:t,userId:n}=e,o=t.currentUser.id;if(n===o){const e=U.Z.getAllSpaceViewStores(t).filter((e=>{const t=e.getUserRootParentId();return t&&t!==n}))[0];return{nextUserId:e&&e.getUserRootParentId(),nextSpaceViewStore:e}}{const{currentSpaceViewStore:e}=N.default.state;return{nextUserId:o,nextSpaceViewStore:e}}}(e);if(o&&i){if(await W.transactionQueue.hasTasksForUser(n)){if(!(await J.confirmUserAction({message:P.default.formatMessage(le.unsavedChanges),acceptLabel:P.default.formatMessage(le.logoutWithoutSaving)})))return}await Q.logout(t,{userId:n}),await W.transactionQueue.clearForUser(n),E.ZL(n);const e=await se.x({environment:t,newCurrentUserId:o,loggedOutUserId:n}),{currentUserRootStore:a,currentUserSettingsStore:s}=N.default.state;a&&s&&w.y3({environment:e,spaceViewStore:i,userSettingsStore:s,userRootStore:a,pageVisitSource:r.tY.Login}),S.refreshAll({includeFocusedWindow:!1})}else await Se(t),S.refreshAll({includeFocusedWindow:!1})}async function Se(e){if(await W.transactionQueue.anySessionHasTasks()){if(!(await J.confirmUserAction({message:P.default.formatMessage(le.unsavedChanges),acceptLabel:P.default.formatMessage(le.logoutWithoutSaving)})))return}(0,B.Sr)()?window.location.href=`${k.default.domainBaseUrl}/logout`:re.c4({environment:e,url:m._j.logout})}async function we(e){if(e.mobileNative&&await e.mobileNative.unregisterPushNotifications(),e.updateCurrentUserId){const t={environment:e,currentUserId:void 0,userIds:[]};e.updateCurrentUserId(t)}return{...e,currentUser:new o.CurrentUser}}async function ke(e){const{environment:t,nextLocation:n,userId:o,doNotRedirect:i}=e;o?await Q.logout(t,{userId:o}):await Q.logout(t,{}),await ce(t),S.clearGoogleAuthCookies(),S.refreshAll({includeFocusedWindow:!1}),i||(window.location.href=n||m._j.root)}async function Ie(e){const{environment:t,isNewSignup:n,userId:o,redirectURL:r,previousPersistedUserId:l,frontPathName:c,webBrowserDeviceId:f,passcodeEnterMethod:g,showInvitationVersion:v}=e;n?ne.j({message:le.signupPendingMessage}):ne.j({message:le.loginPendingMessage});try{const b=A.k(t);if(ie.LK(t),t.device.isElectron&&(S.clearBrowserHistory(),S.refreshAll({includeFocusedWindow:!1})),l&&l!==o){const e=await W.transactionQueue.getTotalNumberOfTasks();e>5&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{userId:o,currentUserId:l,clearedTransactionCount:e}}),await ce(t,b,!t.currentUser.loggedInUserIds.includes(l))}if(!l){const e=ee.qd(void 0);ee.nM({currentUserId:o,blockId:e}),ee.nM({currentUserId:void 0,blockId:void 0})}const y=await Ce(t,o);if(oe.lJ(y,{is_new_signup:n,login_method:e.loginMethod,front_pathname:c}),n){$.ieV(y,{user_id:o,tags:(0,h.getSessionAnalyticsTags)(),origin_initial_page:ae.getInitialPage(o)});const t=await(0,I.of)(y);await(0,d.OI)(200,[Q.initializeUserAnalyticsEmptySync(y,{isNewSignup:n,analyticsProperties:(0,a.Z)({...(0,I.Ts)(),...(0,I.eR)(),...(0,R.getMobileNativeDeviceInfo)(),...t,experiments:z.default.getExperimentsMap(),login_method:e.loginMethod,signup_from:t.route_name,front_pathname:c,web_browser_device_id:f,passcode_enter_method:g},"ignore-class-instances")})])}if(r){const e=p.Wj({url:r,isMobile:y.device.isMobile,baseUrl:k.default.domainBaseUrl,publicDomainName:k.default.publicDomainName,protocol:k.default.protocol,currentUrl:window.location.href});if(!e||"space"!==e.name&&"page"!==e.name){if(e&&"oauthAuthorization"===e.name){const{responseType:t,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s}=e;(0,h.setOauthAuthorizationParams)({responseType:t,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s})}}else te.nr(e,o)}if(Y.mc(y),X.mc(),await X.Yh(y),n&&(z.default.logEvent("sign_up",void 0,{login_method:e.loginMethod,device_type:t.device.deviceType}),z.default.logEvent("sign_up_by_login_method",e.loginMethod),z.default.logEvent("sign_up_by_device_type",t.device.deviceType)),oe.wt(y,{is_new_signup:n,login_method:e.loginMethod,logged_in_user_ids:y.currentUser.loggedInUserIds.map((e=>(0,u.F9)(e))),most_recent_user_id:(0,u.F9)(o),web_browser_device_id:f,passcode_enter_method:g}),i.j({device:y.device,event:{facebook:{eventName:"ViewContent"},google:{eventName:"loggedIn"}},cookieService:t.cookieService}),k.default.isAdminMode){if(!(await C.getGhostAdminUserId(t)))return void re.c4({environment:t,url:"/__admin"})}const _=z.default.checkGate("enable_oauth_from_desktop_ux_v2"),w=(0,h.getPostLoginRedirect)({config:_?k.default:void 0,fileHostProtocol:k.default.secureFileConfig.protocol,fileHostName:k.default.secureFileConfig.hostname});w?((0,h.unsetPostLoginRedirect)(),window.location.href=w):!b&&l&&l!==o?window.location.href=m._j.root:n&&v?re.c4({environment:y,url:m._j.onboarding}):re.c4({environment:y,url:m._j.root})}finally{ne.x()}}function xe(e){const{loginStore:t,userId:n}=e,o=new q.U6(e.environment,{table:f.KJ,id:n},{userId:n});t.setState({...t.state,settings:e.mfaSettings,loginType:"mfa",redirectURL:e.redirectURL,previousPersistedUserId:e.previousPersistedUserId,userStore:o})}async function Ce(e,t){await async function(e,t){await Te(e,t)}(e,t);let n=[t];const i=await(0,M.getUserIdsFromCookie)(e);i&&(i.push(t),n=l.jj(i));const r=await C.getGhostAdminUserId(e),a={...e,currentUser:new o.CurrentUser({id:t,loggedInUserIds:n,adminUserId:r})};if(e.updateCurrentUserId){const o={environment:e,currentUserId:t,userIds:n};await e.updateCurrentUserId(o)}return a.device.isFirefox||E.lr(),a}async function Te(e,t){const n=await(0,M.getUserIdsFromCookie)(e);n&&!n.includes(t)||v.Z.set(M.currentUserIdKey,t)}async function Me(e){const t=await(0,M.loadCurrentUserId)(e),{mobileNative:n}=e;if(n&&n.sqliteConnection)try{await L.y6(n.sqliteConnection,t||y.I)}catch(o){s.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,c.Ui)(o),data:{}})}return t?await Ce(e,t):e}async function Pe(){var e;const{currentUserStore:t}=N.default.state;if(!t)return!1;if(!t.getEmail())return!1;const{currentUserSettingsStore:n}=N.default.state;return!!n&&(await n.load(),Boolean(null===(e=n.getSettings())||void 0===e?void 0:e.should_set_password_on_login))}async function Ae(e){const{currentUserStore:t}=N.default.state;if(!t)return!1;const n=t.getEmail();if(!n)return!1;const o=await D.c({environment:e,userEmail:n});if(o.error)throw o.error;return!o.value.isSamlEnforced&&!o.value.hasPassword&&!o.value.didLogInWithSaml}async function Re(e){const t=e.currentUser.id;if(!t)return!1;const n=new q.r9(e,{table:g.dx,id:t});await n.load();return(await(0,G.Gh)({environment:e,userRootStore:n})||[]).some((e=>e===k.default.pricing.student.productId))}async function De(e,t){var n,o;if("saml_sso_required"===(null===(n=t.body.clientData)||void 0===n?void 0:n.type)&&null!==(o=t.body.clientData)&&void 0!==o&&o.redirectUrl){await Be(2e3);he(e,t.body.clientData.redirectUrl)}}async function Be(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;ne.j({message:le.redirectSamlMessage}),await(0,d.Vs)(e),ne.x()}},27153:(e,t,n)=>{n.d(t,{$:()=>r,Z:()=>a});var o=n(91390),i=n(24677);function r(e,t){t.disableClearSelection||i.ZH(e),o.Z.setState({...t,isActive:!0})}function a(){const e=o.Z.state;e.isActive&&e.onCancel&&e.onCancel(),o.Z.reset()}},67060:(e,t,n)=>{n.d(t,{Br:()=>V,RL:()=>F,WI:()=>E,_P:()=>D,lZ:()=>B,xv:()=>Z});var o=n(49085),i=n(72126),r=n(4615),a=n(21202),s=n(70203),l=n(69783),c=n(28020),d=n(49117),u=n(44486),p=n(68056),m=n(98165),f=n(89224),g=n(80444),h=n(64233),v=n(77080),b=n(19111),y=n(83212),_=n(72087),S=n(10743),w=n(24666),k=n(34583),I=n(35057),x=n(50906),C=n(88295),T=n(98730),M=n(993),P=n(82530);function A(e){const{textStore:t,environment:n}=e,o=(0,m.n3)(t)&&y.Z.getMode(n,t).hasPublicPermission,i=!o,r=!o;return{page:true,createPage:t.isDefaultRecordCache(),user:i,inviteUser:i&&function(e){const t=(0,c.np)(),n=g.default.state.currentSpaceStore;if(!t||!n)return!1;return v.default.checkGate("inline_mention_invites")&&t.canEditMembership()&&n.canEditMembership()&&"enterprise"!==(0,I.zt)()&&!e.device.isMobile}(n),bot:i,date:!0,reminder:!0,templateVariable:R(t),group:r,heading:!0}}function R(e){const t=(0,c.RM)();if(!t||"block"!==e.table)return!1;if(t.isInsideTemplate())return!0;const n=u.W(e);if(n||t.isInsideFactoryOrDuplicateBlocksAction()){const t=null==n?void 0:n.getTitleStore();return!(n&&t&&t.id===e.id&&i.Xy(t.path,e.path))}return!!(0,d.td)(e)}function D(e){const{environment:t,textStore:n,oldSelection:i,oldTextValue:a,disableDateMentions:c,disableDateReminderMentions:d,disableTemplateVariableMentions:u}=e,p=function(e){const{textStore:t,oldSelection:n}=e;if(S.Z.state.open||l.Z.state.open||h.Z.state.open)return;const o=s.eeV(t.getValue()||[]),i=n.startIndex,r=(o[i]||"").normalize("NFKD"),a=(o[i-1]||"").normalize("NFKD"),c=b.Z.state;if(c.open)return"[["===c.insertionType&&"]"===r&&"]"===a?"]]":void 0;if("@"===r){if(a&&!/[\s\(\)\[\]]/g.test(a))return;return"@"}if("+"===r){if(a&&!/[\s\(\)\[\]]/g.test(a))return;return"+"}if("[["===o.slice(i-1,i+1).join("")){const e=o[i-1];if(e&&!/[\s\(\)\[\]]/g.test(e))return;return"[["}}(e);if(!p)return;const m=b.Z.state;if("]]"===p){if(m.open){const e=m.temporaryInputData.state;e&&m.temporaryInputData.setState({...e,suffix:"]]"}),b.Z.setState({...m,showCreateIn:!0})}return}const g=f.get();if(!g)return;const v=f.getRect(g);if(!v)return;const y=A({textStore:n,environment:t}),w=y.page,k=y.heading,I=y.createPage,C=y.user&&"@"===p,M=y.inviteUser&&"@"===p,P=y.bot&&"@"===p,R=y.date&&"@"===p&&!c,D=y.reminder&&"@"===p&&!c&&!d,B=y.templateVariable&&"@"===p&&!c&&!u,F=y.group&&"@"===p;if(!(C||F||w||I||R||D||B))return;if("+"===p&&!I)return;const Z=(0,r.ZP)();T.S(t),b.Z.setState({open:!0,flowId:Z,openTime:Date.now(),insertionType:p,textStore:n,oldTextValue:a,oldSelection:i,selectionRect:v,userRequestStore:new _.Z,botRequestStore:new _.Z,pageRequestStore:new _.Z,temporaryInputData:o.default.createValue(void 0),mentionTypes:{page:w,createPage:I,user:C,inviteUser:M,bot:P,date:R,reminder:D,templateVariable:B,group:F,heading:k},expandSection:void 0,showCreateIn:!1,showInvite:!1,createInQuery:"",isEmptyPageTitle:!1}),x.j1w(t,{analyticsFrom:E(),flowId:Z})}function B(e,t){M.N3({direction:"end"});const n=w.default.state;if("editing"!==n.mode)return;const o=(0,p.QY)(n.multiSelection);if(!o)return;let i=!1;if(o.selection.startIndex>0){const e=o.store.getValue()||[],t=s.eeV(e)[o.selection.startIndex-1];/[\s]/g.test(t)||(i=!0)}P.createAndCommit({userAction:"mentionMenuActions.insertMention",environment:e,perform:t=>{i?(M.hJ({environment:e,store:o.store,string:" ",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),M.hJ({environment:e,store:o.store,string:"@",selection:{startIndex:o.selection.startIndex+1,endIndex:o.selection.endIndex+1},disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})):M.hJ({environment:e,store:o.store,string:"@",selection:o.selection,disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}});const r=b.Z.state;if(!r.open)return;const a=A({environment:e,textStore:o.store});b.Z.setState({...r,mentionTypes:{page:a.page&&t.page,createPage:a.createPage&&t.createPage,user:a.user&&t.user,inviteUser:a.inviteUser&&t.inviteUser,bot:a.bot&&t.bot,date:a.date&&t.date,reminder:a.reminder&&t.reminder,templateVariable:a.templateVariable&&t.templateVariable,group:a.group&&t.group,heading:a.heading&&t.heading}})}function E(){const e=b.Z.state;if(e.open)return e.textStore.table===a.iU?"block":"comment"}function F(e){const t=b.Z.state,{environment:n,annotations:o=[],transaction:i,menuListItemAction:r,query:a,mentionType:l}=e;if(t.open){let e=t.oldTextValue,c=t.oldSelection;const d=t.insertionType.length-1;d>0&&(e=s._QS(e,t.oldSelection.startIndex-d,t.oldSelection.startIndex),c={startIndex:c.startIndex-d,endIndex:c.endIndex-d}),M.sO({environment:n,store:t.textStore,value:e,transaction:i});const u=E();o.forEach((e=>{M.lZ({environment:n,store:t.textStore,selection:c,annotation:e,analyticsFrom:u,transaction:i})})),l&&x.z7J(n,{clickIndexGlobal:null==r?void 0:r.index,clickIndexLocal:null==r?void 0:r.indexLocal.indexLocal,sectionIndex:null==r?void 0:r.indexLocal.section,analyticsFrom:u,timeToClickInMs:Date.now()-t.openTime,queryLength:a.length,mentionType:l,flowId:t.flowId}),Z()}}function Z(){b.Z.setState({open:!1,userRequestStore:b.Z.state.userRequestStore,botRequestStore:b.Z.state.botRequestStore,pageRequestStore:b.Z.state.pageRequestStore,mentionTypes:b.Z.state.mentionTypes})}async function V(e){const{environment:t,titleText:n,ignoreSelectionAreaStore:o,createInValue:i,onPageCreated:r,menuListItemAction:a}=e,s=b.Z.state;if(!s.open)return;if(!k.M_(t))return;o.reset();const{performResult:l}=await P.createAndCommitAsync({environment:t,userAction:"mentionMenuActions.acceptCreateIn",waitForServerCommit:!0,perform:async e=>{const o=C.f8({environment:t,transaction:e,titleText:n,createInValue:i,recordStoreParent:s.textStore}),l=o.createdPages[0];if(l)return r&&r(l),F({environment:t,annotations:[["p",l.id]],transaction:e,menuListItemAction:a,query:n,mentionType:"createPage"}),await o.moveToStorePromise,{createInState:o}}});if(l){const{createInState:e}=l;return await C.c_({analyticsFrom:"mention_menu",createInState:e}),e}}},91376:(e,t,n)=>{n.d(t,{CT:()=>l,r$:()=>s});var o=n(97799),i=n(80444),r=n(64404),a=n(92083);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{currentTab:t,subtab:n,isMobile:r,openedFrom:s}=e;if(r)"notifications"!==t&&"notifications_and_settings"!==t&&"user_settings"!==t||o.Z.setState({open:!0});else if(t)a.Z.setState({open:!0,openedFrom:s,...c({currentTab:t,subtab:n}),highlightedSetting:void 0});else{const{currentSpaceStore:e}=i.default.state;a.Z.setState({open:!0,openedFrom:s,currentTab:l(e),defaultSubtab:void 0,highlightedSetting:void 0})}}function l(e){return e&&e.canRead()?"members":"settings"}function c(e){const{currentTab:t,subtab:n}=e;if("members"===t){return{currentTab:"members",defaultSubtab:n===r.Q.Members||n===r.Q.Groups||n===r.Q.Guests||n===r.Q.Reprovisioning||n===r.Q.Requests?n:void 0}}if("integrations"===t){return{currentTab:"integrations",defaultSubtab:"member_connections"===n||"workspace_connections"===n?n:void 0}}return{currentTab:t,defaultSubtab:void 0}}},60971:(e,t,n)=>{n.d(t,{aV:()=>r,eV:()=>a,kW:()=>c,sv:()=>d});var o=n(72126),i=n(85818);function r(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:i}=e,{focus:r}=t.state;if(void 0===r.indexLocal)return c({store:t,sections:o,indexGlobal:0});const a=r.indexLocal+n,d=o[r.section],u=d.items.length-1;if(a<=u)return c({store:t,sections:o,indexLocal:{section:r.section,indexLocal:a}});const p=function(e){const{indexLocal:t,section:n,itemsPerRow:o}=e,i=l({indexLocal:t,section:n,itemsPerRow:o});if(!i)return;const r=s({section:n,itemsPerRow:o});if(!r)return;return i.rowsBefore===r.rowsBefore}({indexLocal:r.indexLocal,section:d,itemsPerRow:n});if(void 0===p)return;if(!1===p)return c({store:t,sections:o,indexLocal:{section:r.section,indexLocal:u}});const m=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(t&&t>=n.length&&o)return;const i=void 0===t?0:(t+1)%n.length,r=n[i];if(!r)return;return{index:i,section:r}}({currentSection:r.section,sections:o,disableWrap:i});if(!m)return;const f=r.indexLocal%n;return m.section.items.length<=f?c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:0}}):c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:f}})}function a(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:r}=e,{focus:a}=t.state;if(void 0===a.indexLocal){return c({store:t,indexGlobal:i.tM(o)-1,sections:o})}const l=a.indexLocal-n;if(l>=0)return c({store:t,sections:o,indexLocal:{section:a.section,indexLocal:l}});const d=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(0===t||void 0===t){if(o)return;const e=n.length-1,t=n[e];if(!t)return;return{index:e,section:t}}const i=n[t-1];if(!i)return;return{index:t-1,section:i}}({currentSection:a.section,sections:o,disableWrap:r});if(!d)return;const u=s({section:d.section,itemsPerRow:n});if(!u)return;const p=a.indexLocal%n;if(u.column<p)return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:u.indexLocal}});{const e=u.rowsBefore*n+p;return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:e}})}}function s(e){const{section:t,itemsPerRow:n}=e;if(0===t.items.length)return;if(0===n)return;const o=t.items.length-1,i=l({indexLocal:o,section:t,itemsPerRow:n});return i?{indexLocal:o,...i}:void 0}function l(e){const{indexLocal:t,section:n,itemsPerRow:o}=e;if(!(o<=0||t>=n.items.length))return{rowsBefore:Math.trunc(t/o),column:t%o}}function c(e){const{store:t,sections:n}=e;if(e.indexLocal){const o=i.$6(e.indexLocal,n);if(!i._K(e.indexLocal,n))return;t.setState({...t.state,focus:{...e.indexLocal,indexGlobal:o}})}else if(void 0===e.indexGlobal)t.unsetFocus();else{const o=i.Ds(e.indexGlobal,n);if(!o)return;t.setState({...t.state,focus:{...o.index,indexGlobal:e.indexGlobal}})}}function d(e){let{store:t,focus:n}=e;"number"==typeof t.state.focus.indexLocal&&(o.Xy(n,t.state.focus)||t.setState({...t.state,focus:n}))}},98958:(e,t,n)=>{n.r(t),n.d(t,{handleTokenRefresh:()=>m,initializeMobileNativeApp:()=>u,registerPushNotifications:()=>p,waitForCssInsets:()=>f});var o=n(68626),i=n(91155),r=n(29477),a=n(62643),s=(n(95477),n(77472)),l=n(54642),c=n(9953),d=n(82530);async function u(e){if(e.device.isMobileNative&&e.mobileNative&&(await f(e),e.mobileNative.updateReceiveApiHandlers({track:t=>{s.j(e,t.eventName,{...t.eventData,logging_source:"mobile_native"})}}),e.mobileNative&&e.mobileNative.sqliteConnection))try{await e.mobileNative.sqliteConnection.ensureMigrated(),e.mobileNative.sqliteConnection.optimize()}catch(t){o.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,i.Ui)(t),data:{}})}}async function p(e){const{mobileNative:t}=e;if(t&&t.api.registerPushNotifications){const n=await t.api.registerPushNotifications();n&&m(e,n,"registration")}}async function m(e,t,n){const o=e.currentUser.id;if(t&&o){const n=(0,a.r9)({user_id:o,token:t}),i=await l.syncRecordValue(e,{pointer:{table:a.q4,id:n},userId:o,version:-1});let r=!1;i&&(i.value&&!i.value.invalid||(d.createAndCommit({userAction:"mobileNativeActions.handleTokenRefresh",environment:e,perform:i=>{c.ae({environment:e,table:a.q4,value:{id:n,token:t,user_id:o,invalid:!1},inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,transaction:i})}}),r=!0))}}async function f(e){if(!e.device.isIOS||!e.device.isMobileNative)return;const t=document.createElement("div");t.style.width=`calc(${["env(safe-area-inset-top)","env(safe-area-inset-bottom)","env(safe-area-inset-left)","env(safe-area-inset-right)"].join(" + ")})`,t.style.visibility="hidden",document.body.appendChild(t);let n=0;for(;n<50&&!(t.offsetWidth>0);)await r.Vs(1),n++;document.body.removeChild(t),e.WindowSizeStore.updateWindowSize()}},29533:(e,t,n)=>{n.d(t,{R:()=>r,h:()=>a});var o=n(149),i=n(17294);function r(e,t){const n={taskStatus:e.taskStatus,...o.x.isSuccess(e)?{completeBlocks:e.value.completeBlocks,totalBlocks:e.value.totalBlocks}:{}};i.Z.update((e=>({...e,[t]:n})))}function a(e){i.Z.update((t=>({...t,[e]:void 0})))}},60870:(e,t,n)=>{n.d(t,{I0:()=>b,eX:()=>h,j2:()=>v,wS:()=>g});n(67294);var o=n(15157),i=n(72126),r=n(21202),a=n(63143),s=n(75770),l=n(98110),c=n(80444),d=n(26136),u=n(50906),p=n(76464),m=n(64964),f=n(85893);function g(e){const{environment:t,movedItems:n,previousParentIds:o,moveToLocation:i,disableSuccessToast:r,numSubitems:a}=e,c=n.some((e=>{const t=o[e.id],n=e.getParentId();return!(!t||t===n)}));!r&&c&&m.oV({label:(0,s.ah)({environment:t,movedItems:n,moveToLocation:i,numSubitems:a}),right:(0,f.jsx)(l.Z,{moveToLocation:i,movedItems:n})})}function h(e){const{environment:t,transaction:n,moveToStore:o,targetBlocks:i,from:r}=e,{currentUserStore:a}=c.default.state;null!=a&&a.isDefined()&&o.canEdit()&&!o.canAdmin()&&i.forEach((e=>{if(e.canAdmin())return u.Y8X(t,{from:r}),p.ep({transaction:n,store:e,environment:t,permissionItems:[{type:"user_permission",user_id:a.id,role:"editor"}]})}))}async function v(e,t,n){const r=await b(e,t),a=i.jj([n,...r]).slice(0,10);o.Z.set({userId:e.environment.currentUser.id,key:y(t),value:JSON.stringify(a)})}async function b(e,t){const n=o.Z.get({userId:e.environment.currentUser.id,key:y(t)});if(n){const t=(0,a.dj)(n);if(t){const n=await Promise.all(t.map((async t=>{const n=d.G.createChildStore(e,{table:r.iU,id:t});return await n.load(),n.canEdit()})));return t.filter(((e,t)=>n[t]))}}return[]}function y(e){return`recentMoveToTargets2:${e}`}},11302:(e,t,n)=>{n.d(t,{$X:()=>ne,QF:()=>oe,RL:()=>re,Ws:()=>se,Y:()=>ce,at:()=>me,bA:()=>te,kj:()=>le,pB:()=>ie,xv:()=>ae,z1:()=>X});n(52262),n(24506),n(21703);var o=n(15145),i=n(92996),r=n(41432),a=n(99036),s=n(68626),l=n(59730),c=n(72126),d=n(4615),u=n(21202),p=n(6287),m=n(97880),f=n(9291),g=n(65273),h=n(19037),v=n(77472),b=n(78316),y=n(77181),_=n(33929),S=n(75770),w=n(98165),k=n(38755),I=n(5162),x=n(80444),C=n(77556),T=n(77080),M=n(42330),P=n(98452),A=n(26136),R=n(52258),D=n(52229),B=n(50906),E=n(6404),F=n(49865),Z=n(30188),V=n(47307),j=n(57400),U=n(94419),L=n(92625),O=n(60870),N=n(72711),z=n(19785),W=n(9953),q=n(1357),H=n(24677),K=n(64964),G=n(29974),$=n(150),Q=n(82530),Y=n(68422),J=n(65452);const X=()=>[h._z,h.Gg,h.jl,h.ff(h.$I),h.ff(h.xw),h.ff(h.P9(r.Ti.externalObjectInstancePage)),h.ff(h.Vw),h.k5,h.ff(h.q4)],ee=(0,f.defineMessages)({duplicatingContent:{id:"moveToMenuActions.duplicatingContent.loadingMessage",defaultMessage:"Duplicating contentâ€¦"},duplicatedToSpace:{id:"moveToMenuActions.duplicatedToSpace.toast",defaultMessage:"Duplicated {name} to {spaceName}"}});function te(e){const{environment:t,blocks:n,originRect:o,moveToContext:r,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,disableSuccessToast:c,forceUntyped:u}=e,p=Date.now(),m=(0,M.rJ)(n),f=function(e){const{hasDatabaseType:t,forceUntyped:n}=e;if(n)return i.br;if(t)return"typedUninitialized";return i.br}({forceUntyped:u,hasDatabaseType:Boolean(m)}),g=(0,d.ZP)();n.length&&(R.Z.reset(),P.Z.reset(),E.xv(),M.ZP.setState({variant:f,isOpen:!0,rect:o,targets:n,autocompleteQuery:"",moveToContext:r,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,lastPageId:M.ZP.state.lastPageId,disableSuccessToast:c,openedTimeMs:p,flowId:g}),B.rYq(t,{from:r,render_type:"web",target_block_ids:n.map((e=>e.id)),targets_database_type:m,flowId:g}))}async function ne(e){await async function(e){var t;const{environment:n,blocks:o,originRect:r,moveToContext:a,onAccept:s,isAddTo:l}=e,{currentSpaceStore:c}=x.default.state,u=Date.now(),p=M.ZP.state.isOpen?M.ZP.state.flowId:(0,d.ZP)(),m=(0,M.rJ)(o);if(m&&m!==i.GZ)return!1;if(!(0,I.Y)("supportsNativeMoveTo")||null===(t=n.mobileNative)||void 0===t||!t.api.moveTo||0===o.length||!c)return!1;const f=o.map((e=>e.id)),g=await n.mobileNative.moveTo({targets:f,spaceId:c.id,isAddTo:l||!1,moveToContext:a,flowId:p});if(!g)return!1;if(!g.supported||!g.destination)return g.supported;R.Z.reset(),P.Z.reset(),E.xv(),M.ZP.setState({variant:i.br,isOpen:!0,rect:r,targets:o,autocompleteQuery:"",moveToContext:a,onAccept:s,isAddTo:l,lastPageId:M.ZP.state.lastPageId,renderType:"mobileNative",openedTimeMs:u,flowId:p});const h=M.ZP.state.isOpen&&M.ZP.state.useSudoMode;return await ie({environment:n,value:g.destination,useSudoMode:h,renderType:"native",isSearchResult:g.isSearchResult}),ae(n),!0}(e)||te(e)}function oe(e,t,n){if("page"!==n.type)return!1;const o=new A.G(e,{table:u.iU,id:n.id}),i=(0,w.qA)(o);for(const r of i)if(t.includes(r.id))return!0;return!1}async function ie(e){const{environment:t,value:n,useSudoMode:o,renderType:i,shouldClearPagePermissions:r,isSearchResult:a}=e;await Q.createAndCommitAsync({environment:t,userAction:"MoveToMenuRenderer.completeMoveTransaction",waitForServerCommit:!1,useSudoMode:o,perform:async e=>{const o=M.ZP.state;if(!o.isOpen)return;const{targets:s,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,flowId:u,autocompleteQuery:p}=o;await re({targets:s,value:n,transaction:e,environment:t,shouldClearPagePermissions:r,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,renderType:i,timeToSelectMs:Date.now()-o.openedTimeMs,flowId:u,isSearchResult:Boolean(p)||a}),o.onAccept&&o.onAccept(n)}})}async function re(e){let{targets:t}=e;const{value:n,transaction:o,environment:i,shouldClearPagePermissions:s,disableSuccessToast:l,moveToContext:d,isDefaultPrivateLocation:f,renderType:g,timeToSelectMs:h,flowId:_,isSearchResult:k}=e,{currentSpaceStore:I}=x.default.state;if(!I)return;let P=[];T.default.checkGate("collection_subitem_nested_operations")&&(P=await async function(e,t,n,o){let i=[];const r=c.Ps(e);if(!r)return[];const s=(0,b.fm)(r);if(!s)return[];if(!s.collectionStore())return[];const l=s.currentSubitemFormatStore.state,d=s.normalizedSchemaStore.state,u=(null==l?void 0:l.inverse)&&d[l.inverse];if(!u||!(0,a.p_)(u))return[];if(!e.some((e=>(0,y.CJ)({store:e,subitemFormat:l,propertySchema:u}).length>0)))return[];const p=(0,S.uw)(t);if(p instanceof A.NW||p instanceof A.G){const t=await ue(p);if(t instanceof A.NW){const r=new C.Z(n);r.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:t});let a=(0,y.JR)(r);if(!a){Z.Bb({transaction:o,collectionContextStore:r,environment:n})&&(a=(0,y.JR)(r))}if(a)return i=await Z.xr({environment:n,blocks:e,options:{canEdit:!0}}),i}}return[]}(t,n,i,o),t=[...t,...P]),ae(i);const R=I.id,D=function(e){const{type:t}=e;switch(t){case"page":case"collection":case"space-private-pages":case"team":return e.spaceId;case"space":return e.id;default:(0,m.t1)(t)}}(n);if(D&&R!==D){if(!(await(0,S.cJ)()))return}const E=t.find((e=>{const t=e.getType();return Boolean(t&&(0,r.S9)(t))})),F=E&&(0,w.VP)(E),V=(0,M.rJ)(t),j=Object.fromEntries(t.map((e=>[e.id,e.getParentId()]))),U=await le({environment:i,value:n,targets:t,transaction:o,shouldClearPagePermissions:s});if(!U)return;const L=(0,S.HE)(n,i);O.wS({environment:i,previousParentIds:j,movedItems:t,moveToLocation:L,disableSuccessToast:l,numSubitems:P.length});const N=E&&(0,w.VP)(E);B._T2(i,{table:U.table,from:d,type:null==L?void 0:L.type,team_before:F&&(0,v.nB)(F),team_after:N&&(0,v.nB)(N),targets_database_type:V,destination_database_type:U.table===p.v?U.getDatabaseType():void 0,isDefaultPrivateLocation:f,render_type:g,time_to_select_ms:h,flowId:_,isSearchResult:k}),U.table===u.iU&&await O.j2(I,I.id,U.id)}function ae(e){const t=M.ZP.state;M.ZP.setState({isOpen:!1,lastPageId:t.lastPageId}),H.ZH(e),t.isOpen&&"home_tab"===t.moveToContext&&q.d(e)}async function se(e){return de({...e,action:"add"})}async function le(e){return de({...e,action:"move"})}async function ce(e){return de({...e,action:"retain-alias"})}async function de(e){const{value:t,transaction:n,targets:i,shouldClearPagePermissions:r}=e;if("user_cancelled_move"===await $.Hl({transaction:n,moveStores:i,moveTargetStore:(0,S.uw)(t)}))return;r&&G.O2({blocks:i,transaction:n});const a=await async function(e){const{transaction:t,targets:n,value:i,environment:r,action:a}=e,{mainEditorCurrentBlockStore:l,currentSpaceStore:c,currentSpaceViewStore:d}=x.default.state,{id:p}=r.currentUser;if(!l||!p||!d)return;const f=(0,S.uw)(i);if(!f)return;if(f instanceof A.G&&T.default.checkGate("enable_text_crdt_client")&&(await f.load(),(0,g.iG)(f,n)))return void K.oV({label:"Cannot move a CRDT block into a non-CRDT parent or vice versa!"});let h;const{table:v}=f;switch(v){case"collection":case"block":h=await async function(e){const{environment:t,blockOrCollectionStore:n,targets:o,transaction:i,retainAliasInCurrentParent:r}=e,a=await ue(n);if(!a)throw new Error("Move to store invalid.");for(const s of o){const e=s.getParentStore();if(e instanceof A.G&&r){const n=D.k({environment:t,parentBlock:e,targetStore:s,transaction:i});z.jG({parentStore:e.getContentStore(),after:s.id,childStore:n,transaction:i})}if(a instanceof A.G)z.jG({parentStore:a,childStore:s,transaction:i});else if(a instanceof A.NW){const e=F.o3({environment:t,stores:[s],collectionStore:a,transaction:i})[0];F.mp({environment:t,store:e,collectionStore:a,shouldCoerce:!0,groupsPointer:[],transaction:i}),z.zw({parentStore:a,childStore:e,transaction:i})}}return a}({environment:r,blockOrCollectionStore:f,targets:n,transaction:t,retainAliasInCurrentParent:"retain-alias"===a});break;case"space":h="space-private-pages"===i.type&&f.id===(null==c?void 0:c.id)?pe({environment:r,spaceStore:f,spaceViewStore:d,targets:n,transaction:t,currentUserId:p,retainAliasToBlock:"retain-alias"===a}):await async function(e){const{environment:t,transaction:n,currentSpaceViewStore:i,currentBlockStore:r,currentUserId:a,spaceStore:l,targets:c,action:d,value:p}=e;if("space"!==p.type&&p.spaceId&&p.spaceId!==l.id)throw new Error("Wrong value to move to another space");Y._w({environment:t,blocks:c,transaction:n});const m=r.getSpaceId()||l.id;let f;if("move"===d&&("space"!==p.type&&p.spaceId&&p.spaceId!==m||"space"===p.type&&p.id!==m||"space-private-pages"!==p.type)){L.j({message:ee.duplicatingContent,targetRecordId:l.id});const e=await G.eX({environment:t,blockStores:c,spaceId:l.id,targetParent:fe(p)});if(L.x(),void 0!==e.error)return void V.showErrorMessage(e.error);f=e.value}else"space-private-pages"===p.type&&pe({environment:t,spaceStore:l,spaceViewStore:i,targets:c,transaction:n,currentUserId:a,retainAliasToBlock:"retain-alias"===d});await async function(e){const{environment:t,currentBlockStore:n,currentUserId:i,spaceStore:r,targets:a,crossSpaceTargetBlockId:l}=e,c=Boolean(a.find((e=>e.id===n.id))),d=(0,k.w3)(r.id);if(!c||!d)return;const p=l?A.G.createChildStore(n,{table:u.iU,id:l}):n;await J.l({environment:t,spaceId:r.id,userId:i}),await async function(e){const{environment:t,spaceStore:n,spaceViewStore:o,blockStore:i}=e;n&&o&&(t.device.isMobileNative&&s.log({level:"info",from:"moveToMenuActions",type:"SpaceSwitchingDebug",data:{message:"moveToMenuActions.switchToSpace"}}),x.default.setState({...x.default.state,currentSpaceStore:n,currentSpaceViewStore:o,mainEditorCurrentBlockStore:i}),await j.Yh(t))}({environment:t,spaceStore:r,spaceViewStore:d,blockStore:p}),N.ru({environment:t,blocks:[p],pageVisitSource:o.tY.Move})}({environment:t,currentBlockStore:r,currentUserId:a,targets:c,spaceStore:l,crossSpaceTargetBlockId:f}),f&&K.oV({label:_.default.formatMessage(ee.duplicatedToSpace,{name:(0,S.EC)({movedItems:c}),spaceName:l.getName()})});return l}({environment:r,transaction:t,currentSpaceViewStore:d,currentBlockStore:l,currentUserId:p,spaceStore:f,targets:n,value:i,action:a});break;case"team":h=me({environment:r,transaction:t,currentSpaceViewStore:d,teamStore:f,targets:n,value:i,action:a,location:{type:"append"}});break;default:(0,m.t1)(v)}"move"===a&&O.eX({environment:r,transaction:t,moveToStore:f,targetBlocks:n,from:"move_to"});return h}({...e});if(!a)return;if(T.default.checkGate("collection_subitem_nested_operations")&&a instanceof A.NW){const t=i.at(0);if(t){const o=(0,y.g0)(t);let r=(0,y.ko)(a);if(!r){const t=new C.Z(e.environment);if(t.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:a}),t){Z.Bb({transaction:n,collectionContextStore:t,environment:e.environment})&&(r=(0,y.ko)(a))}}o&&r&&Z.cI({blocks:i,transaction:n,from:o.subitemFormat,to:{property:r.property,inverse:r.inverse},environment:e.environment,subitemRelationSchema:o.childRelationSchema,relationPropertyCollectionId:a.id})}}return a}async function ue(e){let t;return await e.load(),t=e instanceof A.NW?e:e.isLinkedCollectionView()?e.getCollectionViewSourceOrLinkCollectionStores()[0]:e.isCollectionView()?e.getCollectionViewCollectionStore():e,t}function pe(e){let{environment:t,spaceStore:n,spaceViewStore:o,targets:i,currentUserId:r,transaction:a,retainAliasToBlock:s}=e;for(const c of i){const e=c.getParentStore();if(e instanceof A.H2){if(e.id!==n.id)throw new l.D3("moveOrAddToPrivatePages: Try to move to a different space");U.Od({parent:e.getPagesStore(),childToRemove:c,transaction:a})}else if(e instanceof A.zX)$.sp({teamStore:e,store:c,transaction:a});else if(e instanceof A.G){if(s){const n=D.k({environment:t,parentBlock:e,targetStore:c,transaction:a});z.jG({parentStore:e.getContentStore(),after:c.id,childStore:n,transaction:a})}z.hr({parentStore:e,childStore:c,transaction:a})}const i={type:"user_permission",user_id:r,role:"editor"};W.sW({store:c,data:{permissions:[i]},transaction:a}),U.R3({parent:o.getPrivatePagesStore(),append:c,transaction:a})}return n}function me(e){let{transaction:t,currentSpaceViewStore:n,teamStore:o,targets:i,location:r,environment:a}=e;const s=n.getTeamsStores(),l=o.getTeamPagesStore();Y._w({environment:a,blocks:i,transaction:t});for(const d of i){const e=c.sE(s,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(d.id)}));(null==e?void 0:e.id)!==o.id&&("append"===r.type?z.jG({parentStore:l,childStore:d,after:r.after,transaction:t}):"prepend"===r.type?z.SH({parentStore:l,childStore:d,before:r.before,transaction:t}):(0,m.t1)(r),e&&$.sp({teamStore:e,store:d,transaction:t}))}return o}function fe(e){const{type:t}=e;switch(t){case"space":case"space-private-pages":return;case"page":return e.spaceId?{id:e.id,table:"block",spaceId:e.spaceId}:void 0;case"collection":case"team":return e.spaceId?{id:e.id,table:t,spaceId:e.spaceId}:void 0;default:(0,m.t1)(t)}}},17659:(e,t,n)=>{n.d(t,{$h:()=>E,E1:()=>B,G7:()=>V,Jl:()=>P,Qy:()=>Z,aY:()=>F,aZ:()=>D,go:()=>T,qQ:()=>j,rG:()=>A,w1:()=>U});var o=n(68626),i=n(91155),r=n(65311),a=n(97880),s=n(9291),l=n(95477),c=n(33929),d=n(50770),u=n(74948),p=n(24646),m=n(19034),f=n(38676),g=n(80444),h=n(45325),v=n(88923),b=n(26136),y=n(4761),_=n(50906),S=n(19719),w=n(54642),k=n(47307),I=n(99553),x=n(82530);const C=(0,s.defineMessages)({archiveError:{id:"notificationActions.archiveNotification.errorMessage",defaultMessage:"Failed to archive. Please try again."},setReadError:{id:"notificationActions.setRead.errorMessage",defaultMessage:"Failed to mark notification as read. Please try again."},setAllAsReadError:{id:"notificationActions.setAllAsRead.errorMessage",defaultMessage:"Failed to mark all notifications as read. Please try again."},setUnreadError:{id:"notificationActions.setUnread.errorMessage",defaultMessage:"Failed to mark notification as unread. Please try again."}});async function T(e){const t=y.ZP.state.currentTab,{currentSpaceStore:n}=g.default.state;if(n&&!l.default.isAdminMode&&(0,y.g0)(t)){try{await w.setNotificationsAsRead(e,{spaceId:n.id,timestamp:Date.now(),type:t})}catch(r){return k.showErrorMessage(c.default.formatMessage(C.setAllAsReadError)),void o.log({level:"error",from:"notificationActions",type:"setCurrentUpdatesTabAsRead",error:(0,i.Ui)(r)})}P(t,n.id,M.decrementToZero)}}const M={incrementByOne:e=>e+1,decrementByOne:e=>Math.max(e-1,0),decrementToZero:e=>0};function P(e,t,n){const{results:o}=m.Z.state,i=o.map((o=>{if(o.spaceId===t){const t=o.unread[e];return void 0===t?o:{...o,unread:{...o.unread,[e]:n(t)}}}return o}));m.Z.setState({results:i})}async function A(e,t,n){const{currentSpaceStore:r}=g.default.state;if(r&&!l.default.isAdminMode){try{for(;;){if(!(await R({environment:e,currentSpaceStore:r,inbox:t,readFilter:n})).more)break}}catch(a){return k.showErrorMessage(c.default.formatMessage(C.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveAll",error:(0,i.Ui)(a)})}"read"!==n&&P(t,r.id,M.decrementToZero)}}async function R(e){const{environment:t,currentSpaceStore:n,inbox:r,readFilter:a}=e,s=await w.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:r,size:500,readFilter:a});if("failed"===s.type)return k.showErrorMessage(c.default.formatMessage(C.archiveError)),o.log({level:"error",from:"notificationActions",type:"archiveApiError",error:(0,i.Ui)(s.error)}),{more:!1};const{notificationIds:l}=s.data;return await async function(e){const{environment:t,notificationIds:n,rootStore:o}=e,{serverCommitResult:i}=x.createAndCommit({userAction:"notificationActions.archiveNotificationIds",environment:t,canUndo:!0,undoCheckpoint:!0,perform:e=>{for(const t of n)B({transaction:e,rootStore:o,visited:!0,notificationId:t})}});await i}({environment:t,notificationIds:l,rootStore:n}),l.length>=500?{more:!0}:{more:!1}}function D(e){const{notification:t,rootStore:n,transaction:a}=e;if(!t.visited){try{B({notificationId:t.id,rootStore:n,transaction:a,visited:!0})}catch(s){return k.showErrorMessage(c.default.formatMessage(C.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveNotification",error:(0,i.Ui)(s)})}if(!t.read){P(r.hE[t.type],t.space_id,M.decrementByOne)}}}function B(e){const{transaction:t,notificationId:n,rootStore:o,visited:i}=e,a=(0,b.Kv)(o,{table:r.uX,id:n});x.applyOperation({transaction:t,store:a,operation:{command:"update",pointer:{table:r.uX,id:n},path:[],args:i?{visited:!0,read:!0,archived_at:Date.now()}:{visited:!1,archived_at:null}}})}function E(e){const{transaction:t,notification:n,rootStore:a,read:s}=e;if(n.read===s)return;const l=(0,b.Kv)(a,{table:r.uX,id:n.id});try{x.applyOperation({transaction:t,store:l,operation:{command:"update",pointer:{table:r.uX,id:n.id},path:[],args:{read:s}}})}catch(d){return e.suppressErrorMessage||k.showErrorMessage(c.default.formatMessage(s?C.setReadError:C.setUnreadError)),void o.log({level:"error",from:"notificationActions",type:"setRead",error:(0,i.Ui)(d)})}P("mentions",n.space_id,s?M.decrementByOne:M.incrementByOne)}function F(){return m.Z.getUnreadCountForCurrentSpace().mentions}async function Z(e){const{environment:t}=e,{currentSpaceStore:n}=g.default.state;if(!n)return[];const o=await w.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:"mentions",size:100,readFilter:"unread"});return"failed"===o.type?[]:o.data.notificationIds}function V(e){let{environment:t,newTab:n,shouldTrack:o}=e;const i=y.ZP.state.currentTab;if(i!==n&&("mentions"===n?y.ZP.update((e=>({...e,currentTab:n,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}))):y.ZP.update((e=>({...e,currentTab:n})))),o){const e=t.device.isMobile;S.GP({environment:t,forceRestartSession:!1,from:"updates-tab-click"}),e&&_.nBz(t,{itemName:"updates"})}"mentions"===i&&async function(e){const t=(0,d.H)(),n=await w.getUserNotifications(e,{size:1e3,isInboxV2:t});if("failed"===n.type)return;const{results:o}=n.data;m.Z.setState({results:o})}(t)}function j(e){const{environment:t,open:n}=e;if(n){h.default.setState({...h.default.state,openState:"opening"});const e=f.sidebarExpandedStore.state;f.sidebarOpenStore.state&&!e&&u.close(),(0,p.Sx)(t)&&u.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"}),v.default.isSidePeekOpen()&&I.xv(t,"inbox_panel_expand"),S.l2({environment:t})}else h.default.setState({...h.default.state,openState:"closing"}),S.Br({environment:t})}function U(e){const{openState:t}=h.default.state;switch(t){case"open":case"opening":j({environment:e,open:!1});break;case"closed":case"closing":j({environment:e,open:!0});break;default:(0,a.t1)(t)}}},36110:(e,t,n)=>{n.d(t,{V:()=>v,g:()=>h});var o=n(77657),i=n(74181),r=n(56589),a=n(82036),s=n(89101),l=n(9852),c=n(64002),d=n(63143),u=n(50906),p=n(54642),m=n(47307),f=n(12714),g=n(8055);function h(e){const{environment:t,responseType:n,integrationId:o,redirectUri:i,state:r,owner:a,userId:l,spaceId:u}=e,p=c.bf({url:s._j.oauthAuthorization,query:(0,d.m8)(Object.entries({response_type:n,client_id:o,redirect_uri:i,state:r,owner:a,user_id:l,space_id:u}).filter((e=>{let[,t]=e;return t})))});g.c4({environment:t,url:p,redirect:!0})}async function v(e){const{environment:t,params:n,integration:d}=e;l.setOauthAuthorizationParams(void 0);const h=d&&r._(d,n.redirectUri);if(!h)return void g.c4({environment:t,url:s._j.root,redirect:!0});let b;if("errorType"in e)b={error:e.errorType,state:n.state};else{const{integration:o,spaceId:r,blockIdsForBot:s,acceptedIntegrationCapabilities:l}=e;let c;if(c=(0,i.VM)(o)?await p.createOauthAuthorizationCode(t,{integrationId:o.id,spaceId:r,redirectUri:n.redirectUri,acceptedIntegrationCapabilities:l}):await p.createOauthAuthorizationCode(t,{integrationId:o.id,spaceId:r,redirectUri:n.redirectUri,blockIdsForBot:s,templatePageId:e.templatePageId,acceptedIntegrationCapabilities:l}),"failed"===c.type){m.showError(c);return v({environment:t,params:n,integration:o,errorType:503===c.status?a._.temporarily_unavailable:a._.server_error})}b={code:c.data.code,state:n.state}}d.id===o.Dv&&u.dld(t);const y=c.bf({url:h,query:{...b}});f.D({environment:t,url:y,targetSelf:!0})}},15356:(e,t,n)=>{n.d(t,{M:()=>m});var o=n(29477),i=n(89101),r=n(64002),a=n(9291),s=n(95477),l=n(33929),c=n(77080),d=n(47307),u=n(47839);const p=(0,a.defineMessages)({allowPopup:{id:"authAction.authorize.popupBlocked",defaultMessage:"It looks like your browser is currently blocking popups. Please allow pop-ups to continue"},dismissButtonLabel:{defaultMessage:"Okay",id:"dialog.dismissButton.label"}});async function m(e,t){const{width:n,height:a,url:m,titleMessage:g}=t,h=l.default.formatMessage(g);if(e.device.isElectron)return u.openOauthPopup({width:n,height:a,url:m,title:h});const v=e.device.isMobile,b=void 0!==window.screenX?window.screenX:window.screenLeft,y=void 0!==window.screenY?window.screenY:window.screenTop,_=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,S=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,w=v?0:n,k=v?0:a;let I="toolbar=0,menubar=0,location=0";0!==w&&(I+=`,width=${w}`),0!==k&&(I+=`,height=${k}`),I+=`,left=${(b<0?window.screen.width+b:b)+(_-w)/2}`,I+=`,top=${y+(S-k)/2.5}`,I+=",scrollbars=1";const x=f()?(0,r.bf)({url:`${s.default.domainBaseUrl}${i._j.verifyNoPopupBlockerHtmlAndRedirect}`,query:{redirectUri:m}}):m,C=window.open(x,h,I);if(C)C.focus();else if(f())return void d.showDialog({showCancel:!1,keepFocus:!1,message:l.default.formatMessage(p.allowPopup),items:[{label:l.default.formatMessage(p.dismissButtonLabel),onAccept:()=>{}}]});const T=o.UZ();if(x.includes("evernotepopupredirect")&&c.default.checkGate("is_evernote_authpopup_closing_fix_enabled")){const e=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;T.resolve(t)}const t=localStorage.getItem("externalAuthCallback");t&&T.resolve(t)};window.addEventListener("message",e,!1);const t=await T.promise;return window.removeEventListener("message",e,!1),localStorage.removeItem("externalAuthCallback"),C&&C.close(),window.focus(),t}{const e=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;T.resolve(t)}},t=setInterval((()=>{const e=localStorage.getItem("externalAuthCallback");e?T.resolve(e):C&&C.closed&&T.resolve(void 0)}),300);window.addEventListener("message",e,!1);const n=await T.promise;return window.removeEventListener("message",e,!1),localStorage.removeItem("externalAuthCallback"),clearInterval(t),C&&C.close(),window.focus(),n}}function f(){return"on"===c.default.getEligibleGroup({experimentId:"show_instruction_on_auth_popup_blocked",defaultGroup:"control"})}},89858:(e,t,n)=>{n.d(t,{A5:()=>ne,B8:()=>K,D0:()=>G,Eo:()=>te,LR:()=>ee,NP:()=>X,kC:()=>$,mv:()=>Q,pq:()=>Y,v9:()=>J});n(21703),n(57658),n(67294);var o=n(15145),i=n(41432),r=n(15157),a=n(72126),s=n(72141),l=n(29369),c=n(9291),d=n(35683),u=n(75754),p=n(91851),m=n(65273),f=n(75770),g=n(35026),h=n(38755),v=n(95697),b=n(81844),y=n(74948),_=n(77999),S=n(80444),w=n(55367),k=n(42330),I=n(26136),x=n(34583),C=n(88893),T=n(88280),M=n(73292),P=n(50906),A=n(98834),R=n(47307),D=n(94419),B=n(13084),E=n(60870),F=n(11302),Z=n(19785),V=n(76464),j=n(9953),U=n(26999),L=n(29974),O=n(28014),N=n(150),z=n(82530),W=n(68422),q=n(1742),H=n(85893);function K(e,t){return`${e.id}:${t}`}function G(e){var t;const{environment:n,store:r,transaction:a,navigateToParent:s}=e,l=j.j4({environment:n,type:i.Ti.page,inMemoryRecordCache:r.inMemoryRecordCache,transaction:a,spaceId:r.isCollectionView()?null===(t=r.getCollectionViewCollectionStore())||void 0===t?void 0:t.pointer.spaceId:r.pointer.spaceId,useCrdt:!1}),c=r.getAssociatedCollectionStore();if(r.isCollectionView()){const e=r.getCollectionViewCollectionStore()||c;if(!e)throw new Error("getCollectionViewCollectionStore() returned undefined");if(!Z.zw({parentStore:e,childStore:l,transaction:a}))throw new Error("parentChildActions.moveToCollection() returned false");const t=e.getDefaultTemplatePageStore();t&&A.ob({title:"template",environment:n,store:l,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:a,from:"outliner_actions"})}r.isCollectionView()||Z.jG({parentStore:r.getContentStore(),childStore:l,transaction:a}),k.ZP.setState({...k.ZP.state,lastPageId:S.default.state.mainEditorCurrentBlockStore?S.default.state.mainEditorCurrentBlockStore.id:void 0}),n.device.isMobile?u._({environment:n,store:l,showMoveTo:!1,saveParent:!1,visitType:d.vu.Link,pageVisitSource:o.tY.Create}):U.CH({environment:n,store:l,showMoveTo:!0,saveParent:!1,currentBlockStore:s?r:void 0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:o.tY.Create}),P.W2j(n,{from:"sidebar_outliner_item",type:"page",new_page_id:l.id,creating_block_id:l.id})}async function $(e){const{environment:t,spaceStore:n,spaceViewStore:i,type:r,prepend:a,outlinerToggleButtonStore:s,shouldPersistToggleState:l,title:p,useCrdt:m}=e,f=new q.sA(t,"createPageInSection");if(x.M_(t)){if("workspace"===r){const e=T.subscriptionDataStoreInstance.state,t=e?(0,C.su)(e):1;if(t>=10){if(!(await R.confirmUserAction({message:(0,H.jsx)("span",{children:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Are you sure you want to create a new top-level page? <strongtext>This page will be visible in the sidebar to all {memberCount} members of your workspace.</strongtext>",id:"sidebarActions.confirmDialog.newWorkspacePage.message",values:{strongtext:e=>(0,H.jsx)("strong",{children:e}),memberCount:t}})}),acceptLabel:(0,H.jsx)(c.FormattedMessage,{defaultMessage:"Create top-level page",id:"sidebarActions.confirmDialog.newWorkspacePage.confirmButton.label"})})))return null}}const{serverCommitResult:e,performResult:{createdPage:g}}=z.createAndCommit({userAction:"outlinerActions.createPageInSection",environment:t,perform:e=>{const o=O.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:"private"===r,prepend:a,transaction:e,title:p,tracker:f,useCrdt:m});return s&&te({environment:t,spaceViewStore:i,type:r,outlinerToggleButtonStore:s,newIsHidden:!1,shouldPersistToggleState:Boolean(l)}),t.device.isMobile&&y.close(),{createdPage:o}}});"private"===r?P.W2j(t,{from:"sidebar_private_section",type:"page",new_page_id:g.id,creating_block_id:g.id}):"workspace"===r&&P.W2j(t,{from:"sidebar_workspace_section",type:"page",new_page_id:g.id,creating_block_id:g.id});const h=n.getDisableSpacePageEdits();return"workspace"===r&&h&&await e,u._({environment:t,store:g,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),g}}async function Q(e){const{environment:t,spaceStore:n,spaceViewStore:i,teamStore:r,andNavigate:a,from:s,outlinerToggleButtonStore:l,shouldPersistToggleState:c,title:p,loading:m,appendOrPrepend:f}=e,{serverCommitResult:g,performResult:{createdPage:h}}=z.createAndCommit({userAction:"outlinerActions.createPageInTeam",environment:t,perform:e=>({createdPage:Y({environment:t,spaceStore:n,spaceViewStore:i,teamStore:r,from:s,title:p,loading:m,appendOrPrepend:f,transaction:e})})});return await g,a&&u._({environment:t,store:h,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),l&&M.k7({environment:t,spaceViewStore:i,teamStore:r,outlinerToggleButtonStore:l,newIsHidden:!1,shouldPersistToggleState:Boolean(c),isExplicitUserAction:!1}),h}function Y(e){const{environment:t,spaceStore:n,spaceViewStore:o,teamStore:i,from:r,title:a,loading:s,appendOrPrepend:c,transaction:d}=e;if(!(0,g.si)({teamStore:i,environment:t}))throw new Error("User is not eligible to create top-level page in team");const u=O.KE({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:!1,prepend:!1,title:a,loading:s,transaction:d});P.tPt(t,{teamStore:i,from:r,pageId:u.id,transaction:d}),V.u9({store:u,transaction:d});const p=(0,f.uw)({type:"team",id:i.id});if(p.table!==l.e0)throw new Error("Assertion failure, moveToStore table is not TeamTable!");return F.at({environment:t,transaction:d,action:"add",teamStore:p,currentSpaceViewStore:o,targets:[u],value:{type:"team",id:i.id},location:{type:c}}),u}async function J(e){var t,n;const{environment:o,droppedStores:r,droppedDirection:a,type:l,targetStore:d,targetParentStore:u}=e,g=await(0,f.ed)({environment:e.environment,blocks:r,from:"dragAndDrop",dropArgs:{direction:a,destination:d,destinationOutlinerType:l}});if(!g.confirmed)return;const{shouldClearPagePermissions:v}=g;if(1===r.length&&(null===(t=u.getValue())||void 0===t||null===(n=t.includes)||void 0===n||!n.call(t,r[0].id))){let e=[];for(const n of r)if(e=await p.NN({environment:o,block:n,action:"move"}),"user_canceled"===e)return;const t=r[0].id;for(const n of e)n.id!==t&&r.push(n)}const y=Object.fromEntries(r.map((e=>[e.id,e.getParentId()]))),{performResult:{moved:_}}=await z.createAndCommitAsync({environment:o,userAction:"outlinerActions.confirmAndHandleDrop",waitForServerCommit:!0,perform:async t=>({moved:await async function(e){const{environment:t,type:n,droppedDirection:o,targetStore:r,targetParentStore:a,droppedStores:l,transaction:d,isTopLevelItem:u,shouldClearPagePermissions:p}=e,g=function(e){for(const t of e){const e=b.Z.findOutlinerItemFromStore(t);if(e)return e.type}}(l),{currentSpaceStore:v,currentUserStore:y}=S.default.state,_=null==v?void 0:v.id,k=T.subscriptionDataStoreInstance.state,x="bookmarks"===g&&"bookmarks"===n,M=oe(e),P=_&&l.some((e=>e.isTopLevelWorkspacePage(_))),A=r&&_&&r.isTopLevelWorkspacePage(_),D=null==v?void 0:v.getDisableSpacePageEdits();if(_&&D&&(P||A)&&!x&&o!==w.vh.Onto&&null!=y&&y.isDefined()&&k){const e=(0,C.hn)(k).filter((e=>e.userId===y.id))[0];if(e&&!s.zz(e.role))return R.showErrorMessage((0,H.jsx)(c.FormattedMessage,{defaultMessage:"This workspace has locked top-level workspace page operations.",id:"sidebarActions.confirmDialog.lockedWorkspaceTopLevel.message"})),!1}const F=function(e){let{targetStore:t,targetParentStore:n}=e;if(t)return t;const{id:o,table:i}=n;let r;switch(i){case"space":case"space_view":r={type:"space",id:o};break;case"block":r={type:"page",id:o};break;case"team":r={type:"team",id:o};break;default:throw new Error("Unexpected table type")}return(0,f.uw)(r)}({targetStore:r,targetParentStore:a});if(function(e){const{droppedDirection:t,targetStore:n,droppedStores:o,targetParentStore:i}=e,r=t===w.vh.Onto?n:i.getRecordStoreAtRootPath();if(!(r instanceof I.G))return!1;return(0,m.iG)(r,o)}(e))return R.deprecatedShowErrorMessage("Cannot move a CRDT block into a non-CRDT parent or vice versa!"),!1;if(!x&&!M){if("user_cancelled_move"===await N.Hl({transaction:d,moveStores:l,moveTargetStore:F}))return!1}E.eX({environment:t,transaction:d,moveToStore:F,targetBlocks:l,from:"drag_and_drop"});const Z=function(e){const{environment:t,type:n,targetStore:o,targetParentStore:r,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c}=e,{currentSpaceViewStore:d,currentSpaceStore:u,currentUserSettingsStore:p}=S.default.state;let m;const f=null==o?void 0:o.getModel();if(a===w.vh.Onto&&o&&r&&null!=f&&f.isType(i.m3))m=B.LQ({environment:t,targetParentStore:r,targetStore:o,droppedDirection:w.vh.Below,droppedStores:s,duplicate:l,transaction:c});else if(oe(e)&&o){if(!d||!p)throw new Error("currentSpaceViewStore or currentUserSettingsStore not found");const{visibleSharedPagesStores:e}=(0,h.MC)({environment:t,spaceViewStore:d,userSettingsStore:p}).state,n=e.map((e=>e.id)),i=s.map((e=>e.id)),r=n.filter((e=>i.indexOf(e)<0)),l=r.findIndex((e=>e===o.id));let u=[];u=a===w.vh.Above?[...r.slice(0,l),...i,...r.slice(l)]:[...r.slice(0,l+1),...i,...r.slice(l+1)],j.sW({store:d,data:{shared_pages:u},transaction:c}),m=s}else"private"===n&&u&&d&&O.OQ({environment:t,spaceStore:u,spaceViewStore:d,transaction:c}),m=B.LQ({environment:t,targetParentStore:r,targetStore:o,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c});return m}(e),V=Z.filter((e=>e.isTopLevel()));p&&L.O2({blocks:Z,transaction:d});"workspace"===n?L.lF({environment:t,blocks:V,transaction:d}):"private"===n&&L.IY({environment:t,blocks:V,transaction:d});u&&o!==w.vh.Onto&&W._w({environment:t,blocks:l,transaction:d});return!0}({...e,transaction:t,shouldClearPagePermissions:v})})});_&&E.wS({environment:o,movedItems:r,previousParentIds:y,moveToLocation:(0,f.vz)({targetStore:d,droppedDirection:a,outlinerSectionType:l,environment:o})})}async function X(e){const{droppedStores:t,duplicate:n}=e.dropArgs,{environment:o,type:i,isTopLevel:r,parentStore:a}=e,s=w.vh.Below;return!!a&&(await J({environment:o,type:i,targetParentStore:a,isTopLevelItem:r,droppedDirection:s,droppedStores:t,duplicate:n}),!0)}function ee(e){const{environment:t,store:n,parentStore:o,insertStores:i,transaction:r,before:s,type:l}=e,{currentSpaceViewStore:c,currentSpaceStore:d}=S.default.state,u=a.d9(i).reverse();"private"===l&&d&&c&&O.OQ({environment:t,spaceStore:d,spaceViewStore:c,transaction:r});const p=s?i.map((e=>D.Vt({parent:o,insert:e,before:n,transaction:r}).child)):u.map((e=>D.BE({parent:o,insert:e,after:n,transaction:r}).child)),m=p.filter((e=>e.isTopLevel()));return"workspace"===l?L.lF({environment:t,blocks:m,transaction:r}):"private"===l&&L.IY({environment:t,blocks:m,transaction:r}),p}function te(e){const{environment:t,spaceViewStore:n,type:o,outlinerToggleButtonStore:i,newIsHidden:a,shouldPersistToggleState:s}=e;i.setState({...i.state,isHidden:a}),P.VSH(t,{is_toggled:!a,outliner_type:o}),s&&r.Z.set({userId:n.environment.currentUser.id,key:K(n,o),value:a}),"inactive"!==_.default.state.type&&a&&_.default.setState({type:"inactive"})}function ne(e){const{type:t,targetStore:n,targetParentStore:o,transaction:i,isTopLevelItem:r}=e,a=(0,v.bq)()&&"team"===t&&o.table===l.e0&&r;if(D.Od({childToRemove:n,parent:o,transaction:i}),a&&n.getParentId()===o.id){const t=I.zX.createChildStore(e.targetParentStore,{...e.targetParentStore.pointer,table:l.e0});N.sp({teamStore:t,store:n,transaction:i})}}function oe(e){let{type:t,droppedDirection:n,isTopLevelItem:o}=e;return"shared"===t&&n!==w.vh.Onto&&o}},65889:(e,t,n)=>{n.d(t,{I:()=>o,O:()=>i});const o=function(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)||(n.state.overlays.add(t),n.emit())},i=function(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)&&(n.state.overlays.delete(t),n.emit())}},72711:(e,t,n)=>{n.d(t,{Y_:()=>A,bo:()=>D,hc:()=>P,og:()=>E,ru:()=>R,tk:()=>B});n(21703);var o=n(1302),i=n(41432),r=n(72126),a=n(4615),s=n(21202),l=n(6287),c=n(19889),d=n(75754),u=n(78316),p=n(84210),m=n(12534),f=n(39500),g=n(89014),h=n(58202),v=n(80444),b=n(94896),y=n(26136),_=n(26664),S=n(17963),w=n(52229),k=n(96802),I=n(94419),x=n(9953),C=n(8055),T=n(29373),M=n(82530);const P=function(e){const{environment:t,store:n,targetStore:o,transaction:i}=e,r=n.getParentBlockStore();if(r){const e=r.getContentStore(),a=w.k({environment:t,parentBlock:r,targetStore:o,transaction:i});return I.rS({parent:e,oldChild:n,newChild:a,transaction:i}).child}throw new Error("Could not create alias block.")};function A(e){const{environment:t,store:n,collectionStore:r,collectionViewStore:d,transaction:p}=e,{id:m}=t.currentUser,f=n.getRecordStoreUIParent();if(null!=f&&f.valueIs(_.i)){if(!n.isDefined())throw new Error("Block to replace was not defined.");if(f&&m){var v,b;const e=Date.now(),_=(0,a.ZP)(),S=null===(v=(0,u.Vv)(r))||void 0===v?void 0:v.getFormatStore().getKeyStore("table_properties").getValue(),w=null===(b=(0,u.Vv)(r))||void 0===b||null===(b=b.getQueryStore())||void 0===b?void 0:b.getKeyStore("sort").getValue(),k={id:(0,a.ZP)(),version:0,type:"table",parent_id:_,parent_table:"block",alive:!0,space_id:n.getSpaceId(),format:{table_properties:S,collection_pointer:{table:l.v,id:r.id,spaceId:r.pointer.spaceId}},query2:{sort:w}};x.ae({environment:t,table:"collection_view",value:k,inMemoryRecordCache:n.inMemoryRecordCache,transaction:p});const C={id:_,type:i.Ti.collectionView,view_ids:[k.id],properties:{},parent_id:f.id,parent_table:"block",alive:!0,created_by_table:c.KJ,created_by_id:m,created_time:e,last_edited_by_table:c.KJ,last_edited_by_id:m,last_edited_time:e,space_id:n.getSpaceId()};x.ae({environment:t,table:"block",value:C,inMemoryRecordCache:n.inMemoryRecordCache,transaction:p});const T=I.rS({parent:f,oldChild:n,newChild:y.G.createChildStore(f,{table:s.iU,id:_}),transaction:p}).child;return(0,g.u)(k.id,{viewPointer:null==d?void 0:d.pointer}),o.default.afterNextFlush((()=>{const e=h.R.findBlockFromStoreWithMethod(T,"handleCreated");e&&e.handleCreated()})),T}}}function R(e){const{environment:t,blocks:n,openInNew:o,pageVisitSource:i}=e,r=n[0];if(o){const e=(0,p.ZP)({store:r,pageVisitSource:i});C.c4({environment:t,url:e,openInNew:o})}else{const e=r.recordStoreUIParentStore instanceof y.G&&r.recordStoreUIParentStore.isCollectionView(),{mainEditorCurrentBlockStore:n}=v.default.state;if(e&&n){const e=(0,p.ZP)({store:n,fullyQualified:!1,peekViewBlockId:r.id,pageVisitSource:i});C.c4({environment:t,url:e})}else d._({environment:t,store:r,pageVisitSource:i})}}function D(e){const{environment:t,store:n,lock:o}=e,{id:i}=t.currentUser;if(!i)return;const r={block_locked:o,block_locked_by:i};M.createAndCommit({userAction:"pageBlockActions.setPageLock",environment:t,perform:e=>{x.sW({store:n.getFormatStore(),data:r,transaction:e})}})}function B(e){const{transaction:t,store:n,coverStore:o,pageCovers:i}=e,a=Object.keys(i),s=i[a[r.MX(0,a.length-1)]],l=s.items[r.MX(0,s.items.length-1)],c=l.coverUrl,d=l.position;x.sO({store:o,value:c,transaction:t}),k.Mp({store:n,coverPosition:d,transaction:t})}function E(e,t,n){(0,m.ZP)({event:e,context:m.Af.EditorClick,callback:()=>function(e,t){const n=Boolean(S.Z.state.pageMap[e.id])||b.Z.state.pages.has(e.id);!e.canEdit()||e.isLocked()||n||(0,f.X9)()||M.createAndCommit({userAction:"PageViewBlock.handlePlaceholderClick",environment:t,perform:n=>{T.ls({environment:t,store:e,transaction:n})}})}(t,n)})}},73661:(e,t,n)=>{n.d(t,{P:()=>a});var o=n(55320),i=n(32441),r=n(54642);function a(e,t,n){i.Pu(t,{page_id:e.id,searchSessionId:o.default.state.sessionId,spaceId:e.getSpaceId(),pageVisitId:n.getCurrentPageVisitId()}),r.recordPageExit(t,{block:{id:e.id,spaceId:e.getSpaceId()},timestamp:Date.now()})}},25320:(e,t,n)=>{n.d(t,{Ri:()=>v,UX:()=>h,s4:()=>g});var o=n(72126),i=n(21202),r=n(70017),a=n(89470),s=n(23867),l=n(97880),c=n(67669),d=n(65598),u=n(80444),p=n(53730),m=n(26136),f=n(54642);const g=100;async function h(e,t){await u.default.waitUntilRendered();const{fromPageRefresh:n,block:o,pageVisitStore:l,timestamp:g}=t,h=e.currentUser.id;if(void 0===h||n)return;t.block.id!==l.state.pageId&&l.setState({...l.getInitialState(),pageId:t.block.id});const v=(0,m.Kv)(o,{table:a.UI,id:(0,a.Pv)({parent_id:o.id,user_id:h}),spaceId:(0,s.C)(o.pointer.spaceId)}),y=(0,m.Kv)(o,{table:r.Kk,id:(0,a.Pv)({parent_id:o.id,user_id:h}),spaceId:(0,s.C)(o.pointer.spaceId)});if(await p.transactionQueue.awaitRecordTransaction({table:i.iU,id:o.id}),await(0,d.M1)(o),!o.canRead()||(0,c.IJ)(e,o))return;await v.load(),await y.load();const _=v.getKeyStore("visited_at").getValue(),S=y.getKeyStore("exited_at").getValue(),w=await async function(e,t,n,o){const{id:i}=e.currentUser;var r;i&&(null==e||null===(r=e.mobileNative)||void 0===r||r.recordPageVisit(i,{blockId:t,spaceId:n,visitedAt:o}));return await f.recordPageVisit(e,{block:{id:t,spaceId:n},timestamp:o})}(e,o.id,(0,s.C)(o.pointer.spaceId),g);if("failed"===w.type)return;const k=b({pageVisits:w.data.pageVisits,omittedUserIds:[],currentState:l.state,block:o});l.state.pageId===o.id&&l.setState({...k,lastViewTime:_,lastExitTime:S})}async function v(e,t){await u.default.waitUntilRendered();const n=e.currentUser.id;if(void 0===n)return;const{block:i,pageVisitStore:r,incremental:a}=t,c=t.limit||32;let d;if(a){const{pageId:e,lastViewTime:t,lastExitTime:i,omittedUserIds:a,...s}=r.state,c=Object.entries(s).map((e=>{let[t,o]=e;if(n===t)return;const i=o.getVisitedAt();return void 0!==i?i+1:void 0}));d=o.Fp(c.filter(l.$K))}const p=await f.getPageVisitors(e,{block:{id:i.id,spaceId:(0,s.C)(i.pointer.spaceId)},sinceTimestamp:d,limit:c});if("failed"===p.type)return;const m=b({pageVisits:p.data.pageVisits,omittedUserIds:p.data.omittedUserIds,block:i,currentState:r.state});let h;if(Object.keys(m).length<=g)h=m;else{const{pageId:e,lastViewTime:t,lastExitTime:n,omittedUserIds:i,...r}=m,a=(0,l.qP)(r).map((e=>{let[t,n]=e;return[t,n.getVisitedAt()??0]}));h={pageId:e,omittedUserIds:i,lastViewTime:void 0,lastExitTime:void 0};const s=o.MR(a,(e=>{let[,t]=e;return-t})).slice(0,g);for(const[o]of s)h[o]=m[o]}r.state.pageId===m.pageId&&r.setState(h)}function b(e){const{block:t,pageVisits:n,currentState:o,omittedUserIds:i}=e,r={...o,pageId:t.id,omittedUserIds:[...o.omittedUserIds,...i]};for(const l of n){const{id:e,user_id:n}=l;n in r||(r[n]=m.t1.createChildStore(t,{table:a.UI,id:e,spaceId:(0,s.C)(t.pointer.spaceId)}))}return r}},19785:(e,t,n)=>{n.d(t,{SH:()=>m,hh:()=>c,hr:()=>u,jG:()=>p,nO:()=>d,rS:()=>f,zo:()=>l,zw:()=>s});n(21703);var o=n(79317),i=n(65598),r=n(9953),a=n(82530);const s=e=>{const{childStore:t,parentStore:n,transaction:o}=e,i=t.getRecordStoreAtRootPath().getValue(),r=n.getParentBlockStore();if(r&&r.isCollectionViewPageWithContent())return p({parentStore:r,childStore:t,transaction:o}),!0;if(i){const{parent_id:e,parent_table:r,alive:s}=i;if(e!==n.id||r!==n.table||!s)return a.applyOperation({store:n,operation:{pointer:t.pointer,path:[],command:"setParent",args:{parentId:n.id,parentTable:n.table}},transaction:o}),!0}return!1},l=e=>{const{block:t,transaction:n}=e,i=t.getParentStore();if(i){(0,o.A6)(i.table,t.table)?u({parentStore:i,childStore:t,transaction:n}):c({childStore:t,transaction:n})}},c=e=>{const{childStore:t,transaction:n}=e;if((0,i.OY)(t)){const e=t,o=e.getAssociatedCollectionStore();if(null!=o&&o.isPageTreeCollection()){const o=t.getParentBlockStore();o&&u({childStore:e,parentStore:o,transaction:n})}}t.getRecordStoreAtRootPath().getAlive()&&r.sW({store:t,data:{alive:!1},transaction:n})},d=e=>{const{pageStore:t,transaction:n}=e;t.getRecordStoreAtRootPath().getAlive()&&r.sW({store:t,data:{alive:!1},transaction:n})},u=e=>{const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"removeChild",args:{id:t.id}},transaction:i})},p=e=>{const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"insertChildrenAfter",args:{ids:[t.id],after:e.after}},transaction:i})},m=e=>{const{childStore:t,parentStore:n,transaction:i}=e,r=(0,o.A6)(n.table,t.table);if(!r)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:r,command:"insertChildrenBefore",args:{ids:[t.id],before:e.before}},transaction:i})},f=function(e){const{parentStore:t,oldChildStore:n,newChildStore:o,transaction:i}=e,r=n.id;(t.getValue()||[]).indexOf(r)>=0&&(p({parentStore:t,childStore:o,transaction:i,after:r}),u({parentStore:t,childStore:n,transaction:i}))}},19358:(e,t,n)=>{n.d(t,{D0:()=>h,If:()=>v,YM:()=>g});n(57658);var o=n(73360),i=n(18844),r=n(21202),a=n(6287),s=n(70279),l=n(91644),c=n(15047),d=n(77858),u=n(29369),p=n(66079),m=n(65273),f=n(9953);function g(e){const{childStore:t,parentStore:n,transaction:o}=e,i=t.getRecordStoreAtRootPath().getValue();if(i){const{parent_id:r,parent_table:a,alive:s}=i;r===n.id&&a===n.table&&s===e.alive||(f.sW({store:t,data:{parent_id:n.id,parent_table:n.table,alive:e.alive},transaction:o}),o.postPerformAssertions.push((()=>{(0,m.be)({parentStore:n,childStore:t})})))}}function h(e){if((0,o.hL)(e.childStore.table)){const t=e.childStore;return function(e){const{childStore:t,parentStore:n,transaction:o}=e,m=t.getRecordStoreUIParent();if(n.table===c.bx&&t.table===r.iU||n.table===u.e0&&t.table===r.iU||n.table===p.dx&&t.table===d.zU||n.table===i.Xj&&t.table===r.iU||n.table===l.AT&&t.table===r.iU)g({childStore:t,parentStore:n,alive:!0,transaction:o});else if(n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&t.table===r.iU){const e=n.getRecordStoreUIParent().getSpaceStore();e&&g({childStore:t,parentStore:e,alive:!0,transaction:o})}else n.table===r.iU&&m&&m.table===d.zU&&m.path&&"private_pages"===m.path[0]?g({childStore:t,parentStore:n,alive:!0,transaction:o}):n.table!==r.iU&&n.table!==a.v&&n.table!==s.x_||g({childStore:t,parentStore:n,alive:!0,transaction:o})}({...e,childStore:t})}{const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:i,parent_table:r}=t.getValue()||{};i===n.id&&r===n.table||f.sW({store:t,data:{parent_id:n.id,parent_table:n.table},transaction:o})}}function v(e){const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:i,parent_table:r,alive:a}=t.getValue()||{},s=n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&a,l=i===n.id&&r===n.table&&a;(s||l)&&f.sW({store:t,data:{alive:!1},transaction:o})}},99553:(e,t,n)=>{n.d(t,{Af:()=>T,E5:()=>P,ME:()=>D,Om:()=>B,Xd:()=>E,bA:()=>C,jG:()=>M,xv:()=>R});n(57658);var o=n(15145),i=n(89101),r=n(28020),a=n(78316),s=n(84210),l=n(74948),c=n(38676),d=n(80444),u=n(22294),p=n(45325),m=n(88923),f=n(86486),g=n(27724),h=n(29370),v=n(24666),b=n(50906),y=n(94419),_=n(17659),S=n(32953),w=n(8055),k=n(82530),I=n(39865),x=n(37181);function C(e,t){const{mode:n}=t,o=e.WindowSizeStore.state.width,i=m.default.state.preferredSidePeekWidth||o/2;m.default.setState({...m.default.state,open:!0,preferredSidePeekWidth:Math.min(i,o/1.5),isOpening:!0,isClosing:!1,...t}),n===m.PeekModeSide&&l.toggleLeftSidebarByWindowSize(e),p.default.isOpen()&&_.qQ({environment:e,open:!1})}function T(e){const{resultsStore:t,collectionContextStore:n,pageVisitSource:o}=e;null==n||n.searchOpen.setState(!1),m.default.setState({...m.default.state,resultsStore:t,collectionContextStore:n,pageVisitSource:o})}function M(e){(m.default.isSidePeekOpen()||m.default.isCenterPeekOpen())&&A(e)}function P(e){m.default.isSidePeekOpen()&&A(e)}function A(e){r.kw.state&&!u.Z.state.isKeyboardMode||f.default.state.isOpen&&f.default.state.menuIsOpen||g.default.isSelected()||v.default.hasSelection()||R(e,"empty_space_click")}function R(e,t,n){const r=m.default.state;if(!r.open||r.isClosing)return;m.default.isSidePeekOpen()&&(m.default.setState({...r,isClosing:!0}),B({environment:e,seen:!0}));const{mode:a,target:l,showMoveTo:u,collectionContextStore:p,savedSelectionStoreState:f,savedTableSelectionStoreState:v,savedSidebarExpandedStoreState:_}=r,x=l.getContentStores(),C=1===x.length?x[0]:void 0,T=C&&C.isEmptyEditableBlock(),M=u&&l.isEmptyTitle()&&(l.isEmptyPage()||T);k.createAndCommit({userAction:"PeekRenderer.close",environment:e,perform:t=>{M?(I.y8({environment:e,blocks:[r.target],transaction:t}),t.postSubmitCallbacks.push((t=>{t||b.dhV(e,{analyticsName:"delete",from:"peek_actions",block_id:l.id,block_type:"page"})}))):T&&y.Od({parent:l.getContentStore(),childToRemove:C,transaction:t})}}),t&&"side_peek"===a&&b.vcz(e,{from:t}),b.$CH(e,{peek_mode:a,from:t,target_page_id:l.id,target_parent_id:l.getParentId(),page_source:n,should_delete:M}),S.jC(e,a),S.LU(e),S.rM(e),g.default.setState({...g.default.state,...f}),v.isActive&&h.Z.setState(v),_&&c.sidebarExpandedStore.setState(!0);const{mainEditorCurrentBlockStore:P}=d.default.state,{RouterStore:A}=e,R=A.state.route;if(null!=p&&p.searchQuery.state&&(null==p||p.searchOpen.setState(!0)),P&&"page"===R.name){const t=(0,s.ZP)({store:P,fullyQualified:!1,scrollToBlockId:R.scrollToBlockId,collectionViewId:R.collectionViewId,discussionId:R.discussionId,showMoveTo:R.showMoveTo,saveParent:R.saveParent,pageVisitSource:o.tY.PeekClose});w.c4({environment:e,url:t})}else"chat"===R.name&&w.c4({environment:e,url:i._j.chat})}function D(){const e=m.default.state;e.open&&!e.isClosing&&m.default.setState({...e,open:!1,resultsStore:void 0,collectionContextStore:void 0})}function B(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=d.default.state;o&&k.createAndCommit({userAction:"peekActions.setSeenPeekModeIntroTooltip",environment:t,perform:e=>{x.d2({userSettingsStore:o,transaction:e,data:{seen_peek_mode_tooltip:n}})}})}function E(e){const{collectionContextStore:t,resultsStore:n}=e;(0,a.YG)(null==t?void 0:t.collectionViewStore())||T({collectionContextStore:t,resultsStore:n,pageVisitSource:void 0})}},76464:(e,t,n)=>{n.d(t,{GQ:()=>le,Kh:()=>oe,MX:()=>te,Pk:()=>ee,ep:()=>Y,hs:()=>ne,n_:()=>ae,u9:()=>de});n(57658);var o=n(1302),i=n(66897),r=n(7406),a=n(59730),s=n(24211),l=n(72126),c=n(63306),d=n(86517),u=n(72141),p=n(4615),m=n(77420),f=n(84683),g=n(15047),h=n(29369),v=n(19889),b=n(94044),y=n(64684),_=n(97880),S=n(9291),w=n(15010),k=n(33954),I=n(33929),x=n(98165),C=n(67669),T=n(45101),M=n(65598),P=n(38755),A=n(95697),R=n(18245),D=n(28578),B=n(80444),E=n(81236),F=n(26136),Z=n(34583),V=n(88893),j=n(35057),U=n(88280),L=n(9867),O=n(50906),N=n(91219),z=n(91536),W=n(81918),q=n(54642),H=n(47307),K=n(9953),G=n(29974),$=n(82530);const Q=(0,S.defineMessages)({preventFullPageAccessDeletion:{id:"permissionsActions.preventRemovingAllFullAccess.message",defaultMessage:"Please give someone else Full Access before removing this permission."},preventUserOrGroupDeletion:{id:"permissionsActions.preventUserOrGroupDeletion.message",defaultMessage:"At least one person or group must have access."},confirmUpgradeMessage:{defaultMessage:"To add members to your workspace, you need to switch it to the Team plan. You will be charged a prorated amount based on your current billing interval and account balance.",id:"permissions.confirmDialog.upgradeToTeamWorkspace.message"},confirmUpgradeButtonLabel:{defaultMessage:"Upgrade to Team workspace",id:"permissions.confirmDialog.upgradeToTeamWorkspace.confirmButton.label"}});function Y(e){const{environment:t,store:n,permissionItems:i,transaction:r,from:a,skipAnalytics:s,pagePermissionChangeLocation:c,fromPermissionWrapper:p}=e;if((0,C.Kz)(e))return!1;if(!n.isDefined())return!1;const m=n.getPermissionItems();let f=[...m];const{id:h}=t.currentUser,v=n instanceof F.H2,b=n instanceof F.G&&n.getParentTable()===g.bx,S=n instanceof F.G&&(b||n.isRestricted());s||(n instanceof F.G?z.kM({environment:t,store:n,newItems:i,location:c,inSudoMode:r.useSudoMode,fromPermissionWrapper:p}):i.forEach((e=>{v?z.dE(t,e,{from:a}):n instanceof F.zX?z.gR(t,{item:e,teamStore:n}):(0,_.t1)(n)}))),f=f.filter((e=>!i.some((t=>d.Kf(e,t)))));for(const o of i)f.push(o);f=f.filter((e=>"none"!==u.cY(e)));const w=Boolean(i.find((e=>"user_permission"===e.type&&e.user_id===h&&!u.zz(e.role))));if(n instanceof F.G&&S&&h){const e=x.Pj(n),t=e?(0,P.jv)(e):[],o=e?e.getPermissionGroups():[],a=Boolean(f.find((e=>"user_permission"===e.type&&u.zz(e.role)&&e.user_id===h))),s=x.VP(n),l=null==s?void 0:s.getMembers(),c=void 0!==l&&(0,y.pd)({membership:l},h),d=e&&s&&(0,A.AL)({teamStore:s,spaceStore:e,userId:h}),p=t.find((e=>"user_permission"===e.type&&e.user_id===h)),m=i.find((e=>"space_permission"===e.type&&u.zz(e.role))),g=i.find((e=>"space_permission"===e.type&&u.YX(e.role))),v=i.find((e=>"space_permission"===e.type&&!u.YX(e.role))),b=f.find((e=>Boolean("group_permission"===e.type&&u.zz(e.role)&&o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(h)>=0)))))),_=(0,A.bq)();if(e&&e.canEdit()&&!_){const t=e.getPagesStore();g?$.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id}}}):v&&$.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}})}if(!_&&a&&p&&(m||b)&&(f=f.filter((e=>!("user_permission"===e.type&&e.user_id===h)))),!w){f.some((e=>!("space_permission"!==e.type||!u.zz(e.role)||!p)||(!("user_permission"!==e.type||!u.zz(e.role)||e.user_id!==h)||(!("group_permission"!==e.type||!u.zz(e.role)||!o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(h)>=0))))||(!!((0,u.zU)(e)&&u.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&d)||!!((0,u.LW)(e)&&u.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&c))))))||r.useSudoMode||(f=f.filter((e=>!("user_permission"===e.type&&e.user_id===h))),f.push({type:"user_permission",user_id:h,role:"editor"}))}}if(!f.some((e=>{const t=u.cY(e);return u.zz(t)}))&&(v||S))return o.default.afterNextFlush((()=>{H.showErrorMessage(I.default.formatMessage(Q.preventFullPageAccessDeletion))})),!1;const k=f.some((e=>(u.jg(e)||u.hV(e))&&"editor"===e.role));if((0,A.bq)()&&b&&!k)return o.default.afterNextFlush((()=>{H.showErrorMessage(I.default.formatMessage(Q.preventUserOrGroupDeletion))})),!1;const T=(0,F.Vh)(n,n.pointer,"permissions"),M=[];for(const o of m){!f.find((e=>d.Kf(o,e)))&&u.C2(o)&&M.push({...o,role:"none"})}for(const o of f){const e=m.find((e=>d.Kf(o,e)));!u.C2(o)||e&&l.Xy(e,o)||M.push(o)}let D=[];const B=x.Om(n);if(n instanceof F.G&&!n.isRestricted()&&B&&B instanceof F.G){const e=(0,C.YO)(B);D=M.map((t=>e.find((e=>l.Xy(e.permissionItem,t)))?{...t,role:"none"}:t))}else D=M;for(const o of D)$.applyOperation({store:T,operation:{pointer:T.pointer,command:"setPermissionItem",path:T.path,args:o},transaction:r});return r.postSubmitCallbacks.push((async n=>{z.NL(t,{status:Boolean(n)?"fail":"success",location:c}),n||await Z.bi(t),e.metric&&R.default.measure(e.metric,{environment:t})})),!0}function J(e){var t;const{environment:n,store:o,permissionItems:i,transaction:r,inviteFlowId:a,inviteMessage:s,inviteOrigin:l,disable_invite_email:c}=e,d=null===(t=B.default.state.currentSpaceStore)||void 0===t?void 0:t.id,{id:u}=n.currentUser;for(const p of i)if(d&&"user_permission"===p.type&&p.invite_id){const{inviteeId:e,inviteeTable:t}=X({item:p,spaceId:d}),n={id:p.invite_id,version:1,flow_id:a,space_id:d,target_id:o.id,target_table:o.table,inviter_id:u,inviter_table:v.KJ,invitee_id:e,invitee_table_or_group:t,message:s,created_time:Date.now(),attributes:{permission:p,origin_type:l,disable_invite_email:c}};K.sW({store:(0,F.Kv)(o,{table:"invite",id:n.id,spaceId:d}),data:n,transaction:r})}return r.postSubmitCallbacks.push((e=>{N.bR(n,{status:Boolean(e)?"fail":"success",origin:l})})),!0}function X(e){const{item:t,spaceId:n}=e;return u.jg(t)?{inviteeId:t.user_id,inviteeTable:v.KJ}:u.FB(t)?{inviteeId:t.bot_id,inviteeTable:m.cZ}:u.hV(t)?{inviteeId:t.group_id,inviteeTable:f._e}:u.ix(t)?{inviteeId:n,inviteeTable:g.bx}:u.zU(t)?{inviteeId:t.team_id,inviteeTable:h.e0}:{}}function ee(e){const{environment:t,store:n,permissionItem:o,transaction:r,shouldInherit:a,fromPermissionWrapper:s}=e;if(!n.isDefined())return;const l=[];if(a){const e=(0,C.YO)(n).map((e=>e.permissionItem)).filter((e=>!d.Kf(e,o)));for(const t of e)u.C2(t)&&(n.isCollectionView()||!u.WY(t.role)||u.FB(t)?l.push(t):l.push({...t,role:"read_and_write"}))}const p=t.currentUser.id,m=p?n.getRecordValue({table:v.KJ,id:p}):void 0,f=m&&(0,i.dp)(m),g=c.DW(n.pointer,n.getRecordModel);!p||d.ZO({actor:f,ancestors:g,updatedPermissionItem:o})||r.useSudoMode||l.push({type:"user_permission",user_id:p,role:"editor"}),l.push(o);const h=n.getPermissionItemsStore();z.kM({environment:t,store:n,newItems:[o],fromPermissionWrapper:s});for(const i of l)$.applyOperation({store:h,operation:{pointer:h.pointer,command:"setPermissionItem",path:h.path,args:i},transaction:r});$.applyOperation({store:h,operation:{pointer:h.pointer,command:"setSingletonPermissionItem",path:h.path,args:{singletonPermissionItem:{type:"restricted_permission"},set:!0}},transaction:r}),O.gl7(t,{type:"none"===o.role?"remove":"narrow"}),r.postSubmitCallbacks.push((e=>{e||Z.bi(t)}))}function te(e){const{environment:t,store:n,transaction:o}=e;if(!n.isDefined())return;const i=n.getPermissionItems(),r=x.Om(n),a=r?d.Wo(x.fJ(r)):[],s=d.Ub(n.getModel(),i,a),l=n.getPermissionItemsStore();for(const c of s)$.applyOperation({store:l,operation:c,transaction:o});O.TJp(t,{using_admin_api:!1}),o.postSubmitCallbacks.push((e=>{e||Z.bi(t)}))}async function ne(e){const{environment:t,store:n}=e,{currentSpaceStore:o}=B.default.state;if(o){const e=o.id,i=n.id,r=await q.spaceAdminRestoreAccess(t,{spaceId:e,blockId:i});O.TJp(t,{using_admin_api:!0}),"failed"===r.type&&H.showError(r)}}function oe(e){const{environment:t,store:n,transaction:o}=e,i=n.getPermissionItems();if(!n.isTopLevelTeamPage()||0===i.length)return;const r=i.filter((e=>u.FB(e)));K.sW({store:n,transaction:o,data:{permissions:r}}),O.FNU(t,{store:x.VP(n)})}function ie(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function re(e){return u.jg(e.permissionItem)&&(0,T.OA)(e.inviteTarget)}async function ae(e){const{environment:t,isOnboarding:n,invite:o}=e;if(0===e.inviteTargets.length)return{success:!0,invitedUsers:{},requestedUsers:{}};const i=U.subscriptionDataStoreInstance.state,a=(0,V.qX)();let s;if(ie(e))if((0,M.Mm)(e.store)){const t=e.inviteRole;s=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:t,bot_id:e.value.id}})))}else(0,M.OY)(e.store)?s=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:d.uH(e.value.capabilities),bot_id:e.value.id,parent_table:e.value.parent_table,parent_id:e.value.parent_id}}))):(0,_.t1)(e.store);else s=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e;return Promise.all(n.map((async n=>{if("newUser"===n.type){const e=await se(t,n),i={type:"user_permission",role:o,user_id:e};return{inviteTarget:{...n,value:{...n.value,id:e}},permissionItem:i}}if("existingUser"===n.type){return{inviteTarget:n,permissionItem:{type:"user_permission",role:e.inviteRole,user_id:n.value.id}}}if("group"===n.type){return{inviteTarget:n,permissionItem:{type:"group_permission",role:e.inviteRole,group_id:n.value.id}}}(0,_.t1)(n)})))}({environment:t,inviteTargets:e.inviteTargets,inviteRole:e.inviteRole,data:i});const{toInvite:l,toRequest:c}=function(e,t){if(!((0,P.Q6)(B.default.state.currentSpaceStore)&&e instanceof F.G))return{toInvite:t,toRequest:[]};const n=[],o=[];for(const i of t)re(i)?n.push(i):o.push(i);return{toInvite:o,toRequest:n}}(e.store,s),m={};if(e.store instanceof F.G&&c.length>0){if(!(await async function(e){const{environment:t,permissionItems:n,inviteMessage:o,store:i}=e;return!(await Promise.allSettled(n.map((async e=>q.requestAccess(t,{type:"guest-invite-request",block:{id:i.id,spaceId:i.getSpaceId()},forActorId:e.user_id,message:void 0,attributes:{role:e.role,inviteMessage:o}}))))).find((e=>"rejected"===e.status||"fulfilled"===e.status&&"failed"===e.value.type))}({environment:t,store:e.store,permissionItems:c.map((e=>e.permissionItem)),inviteMessage:o.inviteMessage})))return{success:!1};for(const e of c)m[e.inviteTarget.value.email]=e.permissionItem.user_id}if(0===l.length)return{success:!0,invitedUsers:{},requestedUsers:m};const f=l.map((e=>e.inviteTarget)),g=l.map((e=>e.permissionItem));let h,v;if(e.store instanceof F.G&&V.He())h=await async function(e){const{environment:t,store:n,permissionItems:o,invite:i}=e,r=n.getSpaceId();if(!r)return!1;if(!E.Z.getPublicSpaceData(t,r))return!1;const a=o.filter(u.jg).map((e=>({...e,invite_id:(0,p.ZP)()})));if("failed"===(await q.inviteGuestsToSpace(t,{block:{id:n.id,spaceId:r},permissionItems:a})).type)return!1;const{serverCommitResult:s}=$.createAndCommit({userAction:"permissionsActions.saveInvites",environment:t,perform:e=>{const{inviteFlowId:o,inviteMessage:r,inviteOrigin:s,disable_invite_email:l}=i;J({environment:t,store:n,permissionItems:a,transaction:e,inviteFlowId:o,inviteMessage:(0,b.my)(r),inviteOrigin:s,disable_invite_email:l})}});await s;const l=o.filter(u.FB);l.length>0&&await ce({environment:t,store:n,permissionItems:l,invite:i});return!0}({environment:t,store:e.store,permissionItems:g,invite:o});else try{await ce({environment:t,store:e.store,sudoModeStore:e.sudoModeStore,permissionItems:g,invite:o}),h=!0}catch(x){h=!1,v=(0,r.tg)(x)}var y,S;ie(e)||(h?N.jB(t,{role:e.inviteRole,is_space:e.store instanceof F.H2,invite_targets:f,is_onboarding:e.isOnboarding,invite_origin:o.inviteOrigin,permission_items:g,invite_message_length:(null===(y=o.inviteMessage)||void 0===y?void 0:y.length)??0,invite_flow_id:o.inviteFlowId,isProfessionalTeamUser:(0,w.QZ)(),domainType:(0,w.JF)(),share_menu_session_id:D.ZP.state.sessionId}):N.l5(t,{error:v,role:e.inviteRole,is_space:e.store instanceof F.H2,invite_targets:f,is_onboarding:e.isOnboarding,invite_origin:o.inviteOrigin,permission_items:g,invite_message_length:(null===(S=o.inviteMessage)||void 0===S?void 0:S.length)??0,invite_flow_id:o.inviteFlowId,isProfessionalTeamUser:(0,w.QZ)(),domainType:(0,w.JF)(),share_menu_session_id:D.ZP.state.sessionId}));n||await Z.bi(t);const k={};f.forEach(((e,t)=>{var n;const o=g[t];"newUser"!==e.type&&"existingUser"!==e.type||null===(n=e.value)||void 0===n||!n.email||"user_permission"!==o.type||(k[e.value.email]=o.user_id)}));const I=1===a&&(0,V.qX)()>1;return(0,j.QM)()&&I&&(G.sw(t),G.Yj(t)),{success:h,error:v,invitedUsers:k,requestedUsers:m}}async function se(e,t){const n=(0,s.E2)(I.default.getIntl()),o=t.value.email,i=await q.createEmailUser(e,{email:o,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:n});if("failed"===i.type){if((0,a.Jx)(i.error)){const e=(0,k.nX)(I.default.getIntl(),i.error);e?H.showErrorMessage(e):H.deprecatedShowErrorMessage(i.error.message)}else H.deprecatedShowErrorMessage(i.error.message);throw i.error}return i.data.userId}async function le(e){let{environment:t,store:n,inviteTargets:o,inviteRole:i,createNewTeamFlowId:r}=e;const a=n.getSpaceId(),s=t.currentUser.id;if(0===o.length)return!0;if(!a||!s)return!1;const l=U.subscriptionDataStoreInstance.state,{teamMemberInfos:c,invitedMemberIds:d}=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e,i=[],r=[];for(const a of n){let e;if("newUser"===a.type){const n=await se(t,a);e={entity_type:"user",type:o,user_id:n},i.push(n)}else"existingUser"===a.type?(e={entity_type:"user",type:o,user_id:a.value.id},"none"!==a.spaceRole&&"not_in_space"!==a.spaceRole||i.push(a.value.id)):"group"===a.type?e={entity_type:"group",type:"member",group_id:a.value.id}:(0,_.t1)(a);r.push(e)}return{teamMemberInfos:r,invitedMemberIds:i}}({environment:t,inviteTargets:o,inviteRole:i,data:l}),u=await L.Uj({environment:t,teamMemberInfos:c,teamStore:n,isSettingDefaultTeam:!1,createNewTeamFlowId:r});return u&&(W.Jk(t,{invite_origin:"team_invite_overlay",domainType:(0,w.JF)(),new_workspace_member_count:d.length,new_workspace_member_ids:d}),await Z.bi(t)),u}async function ce(e){const{environment:t,store:n,sudoModeStore:o,permissionItems:i,invite:r}=e,{serverCommitResult:a}=$.createAndCommit({userAction:"permissionsActions.savePermissionItems",environment:t,useSudoMode:"block"===n.table&&(null==o?void 0:o.shouldSaveTransactionWithSudoMode(n)),perform:e=>{const o=i.map((e=>"user_permission"!==e.type?e:{...e,invite_id:(0,p.ZP)()})),{inviteFlowId:a,inviteMessage:s,inviteOrigin:l,disable_invite_email:c}=r;J({environment:t,store:n,permissionItems:o,transaction:e,inviteFlowId:a,inviteMessage:(0,b.my)(s),inviteOrigin:l,disable_invite_email:c}),Y({environment:t,store:n,permissionItems:o,transaction:e,from:l})}});await a}const de=function(e){const{store:t,transaction:n}=e;K.sW({store:t,data:{permissions:null},transaction:n})}},9700:(e,t,n)=>{n.d(t,{m:()=>m});var o=n(87078),i=n(4023),r=n(15723),a=n(31194);const{Top:s,Bottom:l,Left:c,Right:d}=i.u,{Start:u,Center:p}=i.v,m=function(e){const{store:t,placementToOrigin:n,alignmentToOrigin:i,popupRect:u,originRect:p,viewportPadding:m,placementFlipped:g,viewportAdditionalBottomPadding:h}=e,v=(0,o.Z)();let b=r.jn(v,-m||0);0!==h&&(b=new r.iL(b.x,b.y,b.width,b.height-h));const y=f(u,p,n,i),_=Math.max(b.left-y.left,0)+Math.min(b.right-y.right,0),S=Math.max(b.top-y.top,0)+Math.min(b.bottom-y.bottom,0),w=n===c&&Math.abs(_)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),k=n===d&&Math.abs(_)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),I=n===s&&Math.abs(S)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),x=n===l&&Math.abs(S)>0&&r.aP(b,f(u,p,(0,a.FJ)(n),i)),C={placementFlipped:!1,offsetX:0,offsetY:0};C.placementFlipped=g||w||k||I||x,(!C.placementFlipped||n!==c&&n!==d)&&(C.offsetX=Math.round(_)),(!C.placementFlipped||n!==s&&n!==l)&&(C.offsetY=Math.round(S)),t.setState({...t.state,...C})},f=function(e,t,n,o){if(n===s||n===l){let i,r;return i=o===u?t.left:o===p?t.left+t.width/2-e.width/2:t.right-e.width,r=n===s?t.top-e.height:t.bottom,new DOMRect(i,r,e.width,e.height)}{let i,r;return i=o===u?t.top:o===p?t.top+t.height/2-e.height/2:t.bottom-e.height,r=n===c?t.left-e.width:t.right,new DOMRect(r,i,e.width,e.height)}}},31304:(e,t,n)=>{n.d(t,{E:()=>S,_:()=>w});var o=n(18466),i=n(68626),r=n(72126),a=n(91155),s=n(75189),l=n(44615),c=n(63143),d=n(36054),u=n(41641),p=n(95477),m=n(2688),f=n(85844),g=n(26136),h=n(27724),v=n(24666),b=n(73661);const y=1*c.U6,_="presenceActions";function S(e,t,n,o){!function(e,t){const{persistAutoListener:n,rootStore:o,isActive:r,listenerReference:s,userId:c}=e.state;if(r){if(n&&n.destroy(),s&&m.Z.removeListener(s,t),c&&o&&x({userId:c,rootStore:o})){const e=(0,l.T0)(o.id);m.Z.updateField(e,c,{present:!1},y,t),m.Z.clearOnDisconnect(e,_,t).catch((e=>{i.log({level:"error",from:"destroyPresence",type:"SystemError",error:(0,a.Ui)(e)})}))}e.reset()}}(e,t),o&&b.P(o,t,n)}async function w(e){const{userId:t,rootStore:n,presenceStore:i,environment:a,pageVisitIdStore:c}=e;if(await n.load(),I({userId:t,rootStore:n})){i.setState({...i.state,isActive:!0,rootStore:n,userId:t});const e=r.P2((()=>{i&&i.state.isActive&&i.state.rootStore===n&&k(i,a)}),1e3),u=(e,t)=>{i&&i.state.isActive&&i.state.rootStore===n&&function(e,t){const{remotePresenceData:n}=t.state,o=e||{};r.Xy(n,o)||t.setState({...t.state,remotePresenceData:o})}(function(e){const t={};if(r.Kn(e)){const n=Object.keys(e);for(const o of n){const n=e[o];n&&!(0,d.Gu)(s.uP,n)&&(t[o]=n)}}return t}(t),i)},p=(0,l.T0)(n.id),f=m.Z.addListener(p,u,void 0,a);i.setState({...i.state,persistAutoListener:new o.Z({onChange:e}),listenerReference:f}),t&&x({userId:t,rootStore:n})&&await m.Z.onDisconnect(p,[{operation:"updateField",key:p,field:t,updates:{present:!1},ttl:y},{operation:"logPageExit",userId:t,blockId:n.id,spaceId:n.getSpaceId(),pageVisitId:c.getCurrentPageVisitId()}],_,a),k(i,a)}}function k(e,t){const{persistAutoListener:n,rootStore:o,userId:i}=e.state;if(n&&n.startListener({incrementCycle:!0}),!o||!x({userId:i,rootStore:o}))return;let r;if(i&&o.canEdit()){var a,s;let e;const t=h.default.state;t.stores.length&&(e=t.stores[0]);const n=v.default.state,l="editing"===n.mode&&n.multiSelection;l&&o.uiContains(l.start.store)&&"block"===l.start.store.table&&(e=l.start.store),e||t.pivot&&(e=t.pivot);const d=null===(a=e)||void 0===a?void 0:a.findRecordStoreUIAncestors((e=>e instanceof g.G)).map((e=>e.id)),u=c.ud(Date.now());r={userId:i,present:f.Z.state.isVisible,activityTimestampNearestMinuteMs:u,blockId:(null===(s=e)||void 0===s?void 0:s.id)||null,blockPath:d||null}}if(n&&n.stopListener({isEndOfCycle:!0}),r){const e=(0,l.T0)(o.id);i&&m.Z.updateField(e,i,r,y,t)}}function I(e){const{userId:t,rootStore:n}=e;return Boolean(n)&&(0,u.Z)(n.id)&&n.canEdit()&&t}function x(e){const{userId:t,rootStore:n}=e;return I({userId:t,rootStore:n})&&!p.default.isAdminMode}},40277:(e,t,n)=>{n.d(t,{th:()=>R,Jv:()=>T,I6:()=>M,Hr:()=>A});n(21703),n(57658);var o=n(7406),i=n(68626),r=n(15157),a=n(91155),s=n(63306),l=n(66897),c=n(33728),d=n(72126),u=n(59753),p=n(86517),m=n(72141),f=n(21202),g=n(6287),h=n(15047);function v(e,t){if(b(e,t))return!0;return t&&(0,l.pu)(t),!1}function b(e,t){if(!t)return!1;if(!t.isUser())return!1;let n=!1;const o=e.getEmailDomains()||[],i=e.getPermissionItems()||[];if(t&&t.email&&o){const e=(0,c.Gd)(t.email);n=d.q9(o,e)}return i.find((e=>"user_permission"===e.type&&e.user_id===t.id))&&(n=!0),n}function y(e){const{block:t,space:n,viewer:o}=e;if(!t)return;if(!b(n,o))return;const i=t.getPermissionItems().filter((e=>"user_permission"===e.type&&(0,m.zz)(e.role))).map((e=>e.user_id));if(0===i.length)return;const r=n.getUserPermissionItems();return i.find((e=>(0,p.GU)({spacePermissions:r,userId:e})))}var _=n(73360),S=n(19889),w=n(33929),k=n(45950),I=n(5659),x=n(54642);const C="publicAccessPageId";async function*T(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>P(t,n)));"value"in e&&(yield e.value)}const o=await x.getPublicPageData(t,n);"success"===o.type?yield o.data:(i.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageData",error:(0,a.Ui)(o.error)}),yield)}async function*M(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>P(t,n)));"value"in e&&(yield e.value)}const o=await x.getPublicPageData(t,n);if("success"!==o.type)throw i.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageDataUnsafely",error:(0,a.Ui)(o.error)}),o.error;yield o.data}async function P(e,t){if("block-space"!==t.type)return{error:Error("Shouldn't be looking for a non-block-space page")};const{blockId:n}=t,{id:i}=e.currentUser;if(n&&i){let t,a,l,c;try{const o=await k.yY({environment:e,recordPointers:[{table:f.iU,id:n},{table:S.KJ,id:i}],recurFn:e=>{const o=[];return e.table===f.iU&&e.id===n&&(t=e),e.table===h.bx&&(a=e),e.table===g.v&&t&&t.parent_id===e.id&&(l=e),e.table===S.KJ&&(c=e),(0,_.tz)(e)&&o.push(e.getParentPointer()),o},recordIsRequired:()=>!0});if(t&&a&&c){const e=s.om({table:f.iU,id:n},o),i=c,r=Boolean(s.YL(e,i)),d=s.YP(e);return{value:function(e){window.__c={n:"getPublicPageData"};const{spaceDomain:t,actor:n,userHasExplicitAccess:o,intl:i,requireInterstitial:r,requireLogin:a,publicAccessRole:s,publicHomePage:l,template:c,securitySettings:d}=e,p=u.kk.fromValue(f.iU,e.block),m=u.kk.fromValue(h.bx,e.space),_=u.kk.fromValue(g.v,e.associatedCollectionValue),S="none"!==s,w=b(m,n),k=_&&(o||S)?_.getNormalizedSchema():void 0,I=_&&(o||S)?_.id:void 0,x=_&&(o||S)?_.getFormat():void 0;return{pageId:null==p?void 0:p.id,spaceName:m.name||i.formatMessage({id:"publicPageDataHelpers.untitledWorkspace.placeholder",defaultMessage:"Untitled Workspace"}),spaceId:m.id,spaceDomain:t,canJoinSpace:w,icon:m.icon,userHasExplicitAccess:o,ownerUserId:y({block:p,space:m,viewer:n}),collectionId:I,collectionSchema:k,collectionFormat:x,betaEnabled:m.beta_enabled,canRequestAccess:v(m,n),requireInterstitial:r,requireLogin:Boolean(a),publicAccessRole:s,publicHomePage:l,securitySettings:d,template:c}}({block:t,space:a,spaceDomain:void 0,associatedCollectionValue:l,actor:i,userHasExplicitAccess:r,intl:w.default.getIntl(),requireInterstitial:void 0,publicAccessRole:d,securitySettings:void 0,publicHomePage:void 0,template:void 0})}}}catch(r){return{error:(0,o.tg)(r)}}}return{error:Error("No offline public page data found.")}}function A(e){let{currentUserId:t,blockId:n}=e;r.Z.set({userId:t,key:C,value:n})}function R(e){return r.Z.get({userId:e,key:C})}},68305:(e,t,n)=>{n.d(t,{tA:()=>S});n(21703);var o=n(43690),i=n(42875),r=n(606),a=n(149),s=n(21202),l=n(97880),c=n(28020),d=n(33929),u=n(80444),p=n(77080),m=n(37598),f=n(26136),g=n(54642);const h=1e3;class v extends Error{constructor(e,t){super(t),this.type=e}}class b extends v{constructor(){super("query_collection_limit_outside_range","Query collection limit must be between 0 andÂ 1000")}}class y extends v{constructor(e){super("query_collection_failed",`Query collection failed: ${e.reason}`),this.data=e}}class _ extends v{constructor(){super("query_collection_too_many_items","Query collection updating too many items")}}async function S(e,t){const{source:n,parentRecordStore:v,collectionPointer:S,filter:w,sort:k,limit:I,vectorSearch:x}=t,C=I??h;if(C<0||C>h)return{error:new b};const T=f.NW.createChildStore(v,S);await T.load();const M=T.getModel();if(!M)return{error:new y({reason:"no collection value"})};const P=T.getParentBlockStore();if(!P)return{error:new y({reason:"no collection parent"})};await P.load();const A=P.getCollectionViewStores()[0],R=A.getSpaceId();if(!A||!R)return{error:new y({reason:"no first collection view"})};const D="results",B={[D]:{type:"results",limit:C}},E=Object.keys(t.aggregations??{});for(const o of E){var F;if(o===D)return{error:new y({reason:"results is a reserved reducer keyword."})};const e=null===(F=t.aggregations)||void 0===F?void 0:F[o];if(!e)return{error:new y({reason:`no aggregation provided for ${o}.`})};e&&(B[o]={type:"aggregation",aggregation:e})}const Z=T.getSchema(),V={type:"reducer",filter:w&&o.Ih(w,Z),sort:k&&o.zh(k,Z),userId:e.currentUser.id,userTimeZone:(0,i.r)(),searchQuery:void 0,vectorSearch:x,reducers:B},j=await g.queryCollection(e,{source:{type:"collection",id:S.id,spaceId:S.spaceId},collectionView:{id:A.id,spaceId:R},loader:V},void 0,{src:n});if("failed"===j.type)return{error:new y({reason:"server query failed",cause:j.error})};const U=j.data.result.reducerResults.results;if(!U||"results"!==U.type)return{error:new y({reason:"unexpected server result"})};if(U.blockIds.length===h&&U.hasMore)return{error:new _};const{groupsReducerIds:L,reducerIdsWithNoGroupDependencies:O}=o.x3(V.reducers,V.reducerDependencies),N=p.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),z=Date.now(),W={pageSort:[],schema:Z,loader:V,userId:e.currentUser.id,userStartOfWeek:c.AK.state,currentTime:z,getRecordModel:u.default.getCurrentBlockModelFn(),intl:d.default.getIntl(),isSorted:!1,visibleProperties:void 0,relativeVariableResult:null==j?void 0:j.data.relativeVariableResult,isSprintPlanningView:!1,collectionSourceType:"collection",groupsReducerIds:L,reducerIdsWithNoGroupDependencies:O,formulaTimeoutMs:N,resultCache:new Map},q=o.fk(W);for(const i of U.blockIds){var H;const e=f.G.createChildStore(v,{table:s.iU,id:i}),t=null===(H=e.getAssociatedCollectionStore())||void 0===H?void 0:H.pointer;if(!(t&&r.dr.isEqualIdTable(t,T.pointer)))continue;const n=v.getRecordModel(e);n&&o.BW(n,M,W,q)}const K=m.Z.getEditedBlocksForCollection(M.id),G=new Set(U.blockIds);for(const i of K){if(G.has(i))continue;const e=v.getRecordModel({table:s.iU,id:i});e&&o.BW(e,M,W,q)}const{result:$}=o.kk(W,q),Q=o.aW({result:$}),Y={};for(const i of E){var J;const e=o.Oi({expectedAggregator:null===(J=t.aggregations)||void 0===J||null===(J=J[i])||void 0===J?void 0:J.aggregator,aggregationReducerResult:j.data.result.reducerResults[i]});if(a.x.isFail(e)){const t="no aggregation provided"===e.error?`no aggregation provided for ${i}`:"unexpected response returned for aggregation"===e.error?`unexpected response returned for aggregation ${i}`:(0,l.t1)(e.error);return{error:new y({reason:t})}}Y[i]=e.value}return{value:{blockIds:Q,...Y}}}},9953:(e,t,n)=>{n.d(t,{Ue:()=>b,ae:()=>m,j4:()=>f,nj:()=>v,sO:()=>g,sW:()=>h});n(57658);var o=n(97531),i=n(59730),r=n(59753),a=n(4615),s=n(73360),l=n(606),c=n(21202),d=n(26136),u=n(82530),p=n(1742);function m(e){const{environment:t,table:n,value:o,transaction:i,inMemoryRecordCache:r}=e;o.id||(o.id=(0,a.ZP)());const c=o,p=s.mk.create(n,c),m=l.dr.fromRecordWithTable(p),f=d.t1.createUniqueRootStore(t,m,{userId:i.userId,inMemoryRecordCache:r});return u.applyOperation({store:f,operation:{pointer:f.pointer,path:[],command:"set",args:o},transaction:i}),f}function f(e){var t;const{environment:n,type:r,properties:s,permissions:l,transaction:m,inMemoryRecordCache:f,useCrdt:h}=e;let v=e.tracker;const b=e.id||(0,a.ZP)(),y=e.format||h?{...e.format??{},...h?o.K$(b,null==s?void 0:s.title):{}}:void 0,_=e.spaceId||m.spaceId,S=new d.G(n,{table:c.iU,id:b,spaceId:_},{userId:m.userId,inMemoryRecordCache:f});if(!v&&!m.getUserFlowForAnalyticsPurposesOnly()){const e="page"===r?"user_flow_create_page":"user_flow_create_block";v=new p.BW({environment:n,entryPointName:"recordActions.createBlock",userFlow:e,succeedOnEnqueue:!0})}return null===(t=v)||void 0===t||t.track(S.pointer,m),g({store:S,transaction:m,value:{type:r,permissions:l,properties:s,format:y,space_id:_}}),u.updateMetadataForTransaction({environment:n,transaction:m}),m.postPerformAssertions.push((function(){if(m.isLocal)return;if(!S.getParentStore())throw new i.p8(`Created block was not given a parent before being committed in transaction ${m.getUserActionForAnalyticsPurposesOnly()}`)})),S}const g=function(e){const{store:t,value:n,transaction:o}=e,i=t.path;u.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"set",args:n||null},transaction:o})};function h(e){const{store:t,data:n,transaction:o}=e,i=t.path;u.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"update",args:n},transaction:o})}function v(e){const{store:t,source:n,fileIds:o,transaction:i}=e,r=t.path;for(const a of o)u.applyOperation({store:t,operation:{pointer:t.pointer,path:r,command:"copyFile",args:{source:n,fileId:a}},transaction:i})}function b(e){let{environment:t,table:n,args:o,transaction:i,inMemoryRecordCache:a}=e;const s=r.vk[n],{model:l,operation:c}=s.create(o),p=d.t1.createUniqueRootStore(t,l.pointer,{userId:i.userId,inMemoryRecordCache:a});return u.applyOperation({store:p,operation:c,transaction:i}),p}},4408:(e,t,n)=>{n.d(t,{HB:()=>me,LK:()=>ge,Wl:()=>de,bG:()=>pe,fL:()=>ue,uo:()=>fe});var o=n(59753),i=n(72141),r=n(29477),a=n(54368),s=n(51650),l=n(8542),c=n(10188),d=n(98963),u=n(18844),p=n(21202),m=n(6359),f=n(44312),g=n(19639),h=n(32161),v=n(82447),b=n(49953),y=n(14710),_=n(66726),S=n(30754),w=n(84683),k=n(94578),I=n(80396),x=n(24836),C=n(86135),T=n(84323),M=n(83200),P=n(67627),A=n(65963),R=n(14130),D=n(34406),B=n(42314),E=n(16663),F=n(19221),Z=n(93646),V=n(91644),j=n(15047),U=n(96740),L=n(75990),O=n(57829),N=n(56877),z=n(47238),W=n(35623),q=n(77858),H=n(26195),K=n(14718),G=n(14327),$=n(71495),Q=n(53412),Y=n(24494),J=n(19889),X=n(98897),ee=n(66079),te=n(58161),ne=n(28182),oe=n(35794),ie=n(70203),re=n(44133),ae=n(84709),se=n(69475),le=n(53730),ce=n(54642);function de(e){const{environment:t,pointer:n,userId:o,inMemoryRecordCache:r,model:a,role:s,force:l,maybeStaleRecordMap:c,updatePaths:d,debugSource:u}=e;"block"===n.table&&(0,re.setBlockIdDebugSource)(n.id,u);const m=o||t.currentUser.id,f=null==a?void 0:a.getVersion(),g=r.getRole({pointer:n,userId:m}),h=r.getVersion({pointer:n,userId:m}),v="number"==typeof f&&f>h;if(!(l||v||void 0!==s&&g!==s))return;let b=a;if(!l&&!v&&function(e){const{oldRole:t,newRole:n}=e;if(!i.YX(n))return!1;if(t&&!i.J5(t))return!1;return!0}({oldRole:g,newRole:s})){const e=r.getRecordModel({pointer:n,userId:m});e&&(b=e)}r.setModelAndRole({pointer:n,userId:m},b,s);for(const i of d)r.emitRecord(n,i);if(b){const e=b.__IM_SORRY__getValue();if(n.table===p.iU&&e){const t=e;t.properties&&t.properties.title&&(t.properties.title=t.properties.title.map((e=>ie.Y_F(e))))}const o=t.defaultRecordCache.persistedRecordCache;if(o&&be[n.table]){const r=function(e){const{environment:t,pointer:n,model:o,role:r}=e,{id:a}=t.currentUser;if((n.table===J.KJ||n.table===ee.dx||n.table===ne.Sr)&&a===n.id)return he;if((null==o?void 0:o.table)===q.zU&&o.parent_id===a)return ve;if(n.table===j.bx&&(0,i.Jy)(r))return ve;return}({environment:t,pointer:n,model:b,role:s}),a={value:e,role:s};o.set(n,a,r,m,c)}}r===t.defaultRecordCache.inMemoryRecordCache&&ae.unsubscribeAfterDelay({pointer:n,userId:m,environment:t})}function ue(e){const{environment:t,userId:n,recordMap:i,inMemoryRecordCache:a,force:s,maybeStaleRecordMap:l,debugSource:c}=e,d=t.defaultRecordCache.persistedRecordCache;(0,r.ON)(i,(async e=>{let{pointer:i,model:r,role:u}=e,p=r,m=u;if(le.transactionQueue.isPendingTransactionForRecord(i)&&d){const e=await d.get(i,n||t.currentUser.id);e&&(p=o.kk.fromValue(i.table,e.value),m=u)}de({environment:t,inMemoryRecordCache:a,pointer:i,userId:n,model:p,role:m,updatePaths:[[]],force:s,maybeStaleRecordMap:l,debugSource:c})})).catch(ye)}async function pe(e){const{inMemoryRecordCache:t,pointer:n,userId:i,environment:r,minimumVersion:a}=e,s=le.transactionQueue.isPendingTransactionForRecord(n),l=r.defaultRecordCache.persistedRecordCache;if(s)return l&&await l.get(n,i);let c,d;try{l&&(c=await l.get(n,i),c&&de({environment:r,inMemoryRecordCache:t,pointer:n,userId:i,model:o.kk.fromValue(n.table,c.value),role:c.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (localResult)"}))}catch(u){ye(u)}try{const e=t.getEntry({pointer:n,userId:i}),s=e?e.value:void 0,l=e?e.pointer:void 0;if(a&&null!=s&&s.value&&(null==s?void 0:s.value.version)>=a)return s;d=await ce.syncRecordValue(r,{userId:i,version:s&&s.value&&s.value.version?s.value.version:-1,pointer:l||n}),d&&de({environment:r,inMemoryRecordCache:t,pointer:n,userId:i,model:o.kk.fromValue(n.table,d.value),role:d.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (remoteResult)"})}catch(p){console.error(p)}return d||c}async function me(e){const{inMemoryRecordCache:t,pointer:n,userId:i,environment:r}=e,{defaultRecordCache:a}=r,s=await ce.syncRecordValue(r,{pointer:n,userId:i,version:-1});s&&(fe({environment:r,inMemoryRecordCache:t,persistedRecordCache:a.persistedRecordCache,pointer:n,userId:i}),de({environment:r,inMemoryRecordCache:t,pointer:n,userId:i,model:o.kk.fromValue(n.table,s.value),role:s.role,updatePaths:[[]],debugSource:"forceFetchRemoteRecord"}))}function fe(e){const{inMemoryRecordCache:t,persistedRecordCache:n,pointer:o,userId:i}=e;t.deleteRecord({pointer:o,userId:i}),t.emitRecord(o,[]),null==n||n.deleteRecord(o,i)}function ge(e){const t=e.defaultRecordCache.inMemoryRecordCache;for(const{pointer:n}of t.data)ae.unsubscribeForAllUsers({pointer:n,environment:e});t.clearCache()}const he=100,ve=50,be={block:!0,notion_user:!0,space:!0,space_bot:!0,space_user:!0,organization:!0,organization_space:!0,space_view:!0,user_root:!0,collection:!0,collection_view:!0,follow:!0,discussion:!0,comment:!0,user_settings:!0,slack_integration:!0,bot:!0,integration:!0,space_invite_link:!0,template_checklist:!0,page_visit:!0,page_exit:!0,[h.P]:!0,team:!0,[I.yo]:!0,[a.y]:!0,[V.AT]:!0,[Y.w]:!0,activity:!1,notification:!1,access_request:!1,customer:!1,temporary_password:!1,password:!1,slack_notification:!1,snapshot:!1,credit:!1,used_credit:!1,space_recover_pages:!1,user_metadata:!1,saml_config:!1,experiment:!1,education_domain:!1,education_email:!1,public_email_domain:!1,user_data_consent_permissions:!1,token:!1,apple_token:!1,google_token:!1,firebase_token:!1,trello_token:!1,asana_token:!1,confluence_token:!1,monday_token:!1,external_entity:!1,external_integration_app:!1,external_token:!1,evernote_token:!1,drive_token:!1,block_token:!1,bot_token:!1,integration_token:!1,csat_feedback:!1,subscription:!1,space_domain:!1,admin_api_log:!1,admin_api_op_log:!1,oauth_authorization_code:!1,mfa_settings:!1,device:!1,user_device:!1,[y.Dw]:!1,[te.t]:!1,[Z.O]:!1,[m.H]:!1,[S.G]:!1,[_.l]:!1,[v.r]:!1,[b.r9]:!1,[f.Jd]:!1,[g.mz]:!1,[L.F]:!1,[w.Tu]:!1,[d.cv]:!1,[x.qV]:!1,[C.FM]:!1,[u.Xj]:!1,[O.fF]:!1,[z.x]:!1,[X.pm]:!1,[U.L]:!1,[N.L9]:!1,[Q.nt]:!1,[H.nE]:!1,[G.z]:!1,[K.u]:!1,[$.Az]:!1,[W.M]:!1,[s.b]:!1,[oe.b]:!1,[l.t_]:!1,[c.J4]:!1,[A.a]:!1,[E.h]:!1,[D.f1]:!1,[B.P]:!1,[M.w]:!1,[R.O]:!1,[P.m]:!1,[T.b]:!1,[F.a]:!1,[k.P9]:!1};function ye(e){if(!(e instanceof se.V))throw e;console.error(e)}},52989:(e,t,n)=>{n.d(t,{AI:()=>h,MZ:()=>v,qw:()=>b});n(57658);var o=n(72126),i=n(73744),r=n(28314),a=n(77546),s=n(95802),l=n(41662),c=n(15723),d=n(4926),u=n(69784),p=n(50628),m=n(27724),f=n(14900),g=n(24677);function h(e){const{environment:t,target:n,startX:o,startY:c,showSelectionRect:p,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}=e,_=m.default.getDefaultContainerFromTarget(n);if(!_)return;if(o>=window.innerWidth-d.Z.state)return;if(c>=window.innerHeight-d.Z.state)return;const S=a.VW(n),w=a.xH(n),k=s.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===_}),I=()=>{u.default.state.isActive&&(g.Jy(),v({environment:t,currentX:u.default.state.currentX,currentY:u.default.state.currentY,toggle:r.yA().shift}))};S&&i.lj(S,"scroll",I),w&&i.lj(w,"scroll",I),u.default.setState({moved:!1,isActive:!0,startX:o,startY:c,currentX:o,currentY:c,currentRect:void 0,defaultContainer:_,startSelection:m.default.state.stores,startSelectables:k,verticalScrollerEl:S,horizontalScrollerEl:w,startScrollTop:S?S.scrollTop:0,startScrollLeft:w?w.scrollLeft:0,showSelectionRect:p,handleScroll:I,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}),g.ZH(t),f.wG(),l.HM.clearSelection()}function v(e){const{environment:t}=e,n=u.default.state;if(n.isActive){const{currentX:i,currentY:r,verticalScrollerEl:a,horizontalScrollerEl:s,startScrollTop:l,startScrollLeft:d,preventSelectStores:m}=n;let f=n.startY;if(a){f-=a.scrollTop-l}let h=n.startX;if(s){h-=s.scrollLeft-d}const v={top:Math.min(f,r),bottom:Math.max(f,r),left:Math.min(h,i),right:Math.max(h,i)},b=p.Z.state.selectableRectMap,y=n.startSelectables.filter((e=>{const t=b.get(e),o=e.props.store;return e.props.canSelect&&t&&c.kK(v,t)&&m.indexOf(o)<0&&(!n.showSelectionRect||o.isTransclusionType()||!o.isInsideTransclusion())})),S=_(y);let w=[];const k=S.find((e=>e.length>1));if(k)w=k;else{const e=o.Z$(S);e&&(w=e)}let I=o.UI(w,(e=>e.props.store));if(e.toggle)for(const e of n.startSelection)o.q9(I,e)?I=o.zu(I,e):I.push(e);u.default.setState({...n,moved:!0,currentX:e.currentX,currentY:e.currentY,currentRect:v}),g.Z5({environment:t,stores:I})}}function b(e){const t=u.default.state;if(t.isActive){const{moved:n,verticalScrollerEl:o,horizontalScrollerEl:r,handleScroll:a}=t;n||g.ZH(e),o&&i.ZV(o,"scroll",a),r&&i.ZV(r,"scroll",a),u.default.setState({isActive:!1})}}const y=function(e){if(e)for(;;){if(!(e=e.getContextClosestSelectable()))return;if(e.props.canSelect)return e}},_=function(e){const t=new Map,n={root:!0};for(const o of e){const e=y(o)||n;t.get(e)||t.set(e,[]),t.get(e).push(o)}return Array.from(t.values())}},79978:(e,t,n)=>{n.d(t,{Bl:()=>u,hE:()=>d,tG:()=>c});var o=n(80951),i=n(75134),r=n(9953),a=n(82530);function s(e){const{environment:t,store:n,propertyId:o,id:r,position:s,transaction:l}=e;let c;c="before"===s.type?{pointer:n.pointer,path:["properties",o],command:"addRelationBefore",args:{id:r,spaceId:n.getSpaceId(),before:s.before}}:{pointer:n.pointer,path:["properties",o],command:"addRelationAfter",args:{id:r,spaceId:n.getSpaceId(),after:s.after}},a.applyOperation({store:n,operation:c,transaction:l}),i.r({environment:t,store:n,relationPropertyId:o})}function l(e){const{environment:t,store:n,propertyId:o,id:r,transaction:s}=e;a.applyOperation({store:n,operation:{pointer:n.pointer,path:["properties",o],command:"removeRelation",args:{id:r,spaceId:n.getSpaceId()}},transaction:s}),i.r({environment:t,store:n,relationPropertyId:o})}function c(e){const{environment:t,store:n,propertyId:a,transaction:s,pointers:l}=e,c=(0,o.ow)(l);r.sW({store:n.getPropertiesStore(),data:{[a]:c},transaction:s}),i.r({environment:t,relationPropertyId:a,store:n})}function d(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:i,position:r,transaction:a}=e;s({environment:t,store:n,propertyId:i.property,id:o.id,position:r,transaction:a}),s({environment:t,store:o,propertyId:i.inverse,id:n.id,transaction:a,position:{type:"after"}})}function u(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:i,transaction:r}=e;l({environment:t,store:n,propertyId:i.property,id:o.id,transaction:r}),l({environment:t,store:o,propertyId:i.inverse,id:n.id,transaction:r})}},43008:(e,t,n)=>{n.d(t,{g:()=>l,x:()=>c});var o=n(95802),i=n(80444),r=n(26136),a=n(64951),s=n(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=i.default.state;if(t){const n=r.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),blockStore:n})}};function c(e){a.Z.reset(),s.ZH(e)}},52771:(e,t,n)=>{n.d(t,{$:()=>l,x:()=>c});var o=n(95802),i=n(80444),r=n(26136),a=n(82187),s=n(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=i.default.state;if(t){const n=r.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),clonedBlockStore:n,originalBlockStore:e.blockStore,renderDelete:e.renderDelete})}};function c(e){a.Z.reset(),s.ZH(e)}},52423:(e,t,n)=>{n.d(t,{AZ:()=>Z,L0:()=>F,hv:()=>L,K9:()=>R,dA:()=>E,M7:()=>U,XT:()=>j,KX:()=>B,Yw:()=>D,qB:()=>V});n(57658),n(52262),n(24506);var o=n(59730),i=n(72126),r=n(606),a=n(67175),s=n(97880),l=n(82798),c=n(16861),d=n(26136),u=n(70354),p=n(27724),m=n(24666),f=n(993),g=n(82530),h=n(73959),v=n(65663),b=n(54843);function y(e,t,n,o){const r=o.getClosestPageAndTransclusionReferenceAncestorIds(t),a=o.getClosestPageAndTransclusionReferenceAncestorIds(n);if(0===r.length||0===a.length)return[];const s=[];for(const c of i.jV(r,a)){const i=(0,l.TO)(o.getPathToBlock(c)),r=(0,l.TO)(S(e,i));s.push(..._(r,t,n))}return s.sort(((e,t)=>e.length-t.length)),s}function _(e,t,n){const o=[];let i=[];for(const r of function*(e,t){let n=!1;for(const o of function*(e){function t(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){if(yield e,(!e.isNavigableBlock()||n)&&("transclusion_reference"!==e.getType()||o))for(const n of(0,b.y)(e))yield*t(n,!1,!1)}()}yield*t(e,!0,!0)}(e))o.id===t&&(n=!0),n&&(yield o)}(e,t))if(r.id!==t){if(i.length>0){if("transclusion_reference"===r.getType()){i=[];continue}i.push(r),r.id===n&&(o.push(i),i=[])}}else i=[r],t===n&&(o.push(i),i=[]);return o.sort(((e,t)=>e.length-t.length)),o}function S(e,t){(0,l.T)(t.length>0,"Path must not be empty"),(0,l.T)(e.id===t.shift(),"Path must start with root store id");let n=e;for(;t.length>0;){const e=(0,l.TO)(t.shift()),o=(0,b.y)(n).find((t=>t.id===e));if(!o)return;n=o}return n}var w=n(77282),k=n(28685);function I(e){const{store:t}=e;let n;(0,l.T)(t.useCrdt());const o=w.Z.getPageStoreForBlockStore(t);if(n=o?x({...e,pageStore:o,allowNonRenderedSingleStoreSelection:!1}):C(e),n&&(n.start.store!==n.end.store||n.start.index<n.end.index))return n}function x(e){var t,n;const{store:o,startTextInstanceId:r,startId:a,endTextInstanceId:s,endId:c,pageStore:d,allowNonRenderedSingleStoreSelection:u}=e,p=(0,l.TO)(w.Z.getPageTextInstanceTrackerForPage(d.pointer)),m=p.getBlockIdForTextInstanceItemId(r,a),f=p.getBlockIdForTextInstanceItemId(s,c);if(void 0===m||void 0===f)return;const g=y(d,m,f,(0,l.TO)(w.Z.getPageBlockTrackerForPage(d.pointer)));let h,v;const b=i.MR(g,(e=>(0,l.TO)(e.at(0))===o?-1:1));for(const i of b){const e=(0,l.TO)(i.at(0)),t=(0,l.TO)(i.at(-1));if(k.E.findEditableWithStore(e.getBlockTitleStore())&&k.E.findEditableWithStore(t.getBlockTitleStore())){h=e,v=t;break}}if((!h||!v)&&u&&b.length>0&&b[0].at(0)===b[0].at(-1)&&(h=(0,l.TO)(b[0].at(0)),v=(0,l.TO)(b[0].at(-1))),!h||!v)return;let _=(0,l.TO)(null===(t=h.getTextSliceTree())||void 0===t?void 0:t.findGraphemeIndexOfOpId(r,a)),S=(0,l.TO)(null===(n=v.getTextSliceTree())||void 0===n?void 0:n.findGraphemeIndexOfOpId(s,c));return _<0&&(_=-_-1),S<0?S=-S-1:S+=1,{start:{store:h.getBlockTitleStore(),index:_},end:{store:v.getBlockTitleStore(),index:S}}}function C(e){const{store:t,startTextInstanceId:n,startId:o,endTextInstanceId:i,endId:r}=e;(0,l.T)(t.useCrdt());const a=t.getSerializedTextClocksStore().getValue();if(!a||void 0===a[n]||void 0===a[i])return;const s=(0,l.TO)(t.getTextSliceTree());let c=s.findGraphemeIndexOfOpId(e.startTextInstanceId,e.startId);if(!c)return;let d=i===n&&r===o?c:s.findGraphemeIndexOfOpId(e.endTextInstanceId,e.endId);return d?(c<0&&(c=-c-1),d<0?d=-d-1:d+=1,{start:{store:t.getBlockTitleStore(),index:c},end:{store:t.getBlockTitleStore(),index:d}}):void 0}function T(e){const{store:t,textInstanceId:n,itemId:o,options:i}=e;(0,l.T)(t.useCrdt());const r=w.Z.getPageStoreForBlockStore(t);if(!r)return;const a=(0,l.TO)(w.Z.getPageTextInstanceTrackerForPage(r.pointer)).getBlockIdForTextInstanceItemId(n,o,i);if(!a)return;const s=y(r,a,a,(0,l.TO)(w.Z.getPageBlockTrackerForPage(r.pointer)));if(s.length>0){const e=s[0];return(0,l.T)(1===e.length),e[0]}}function M(e){const{store:t,transaction:n,operation:o}=e,i=function(e){const{store:t,textInstanceId:n,id:o}=e;(0,l.T)(t.useCrdt());const i=w.Z.getPageStoreForBlockStore(t),r=i?x({store:t,startTextInstanceId:n,startId:o,endTextInstanceId:n,endId:o,pageStore:i,allowNonRenderedSingleStoreSelection:!0}):C({store:t,startTextInstanceId:n,startId:o,endTextInstanceId:n,endId:o});return null==r?void 0:r.end}({store:t,textInstanceId:o.args.textInstanceId,id:o.args.originId});if(!i)return"err_no_store_position";const r=(0,l.TO)((0,h.sQ)(i.store)),a=(0,l.TO)(r.getTextSliceTree()),{operations:s,invertedOperations:c}=a.getOperationsForInsertTextValueAfterOriginId(o.args.textInstanceId,o.args.originId,o.args.textValue);return v.F({transaction:n,store:r,crdtOperations:s,invertedOperations:c}),"success"}function P(e){const{environment:t,store:n,transaction:o,operation:i}=e;switch(i.command){case"invertedInsertText":return function(e){const{environment:t,store:n,transaction:o,operation:i}=e,r=I({store:n,startTextInstanceId:i.args.textInstanceId,startId:i.args.startId,endTextInstanceId:i.args.textInstanceId,endId:i.args.endId});return r?(f.pz({environment:t,multiSelection:r,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:n,transaction:o,operation:i});case"invertedDeleteText":return M({environment:t,store:n,transaction:o,operation:i});case"invertedMoveTextSlice":return function(e){const{store:t,transaction:n,operation:o}=e,i=T({store:t,textInstanceId:o.args.textInstanceId,itemId:o.args.textSliceStartItemId,options:{type:"start"}});if(!i)return"err_no_source_block_store";const r=T({store:t,textInstanceId:o.args.targetTextInstanceId,itemId:o.args.targetTextSliceEndItemId,options:{type:"end"}});if(!r)return"err_no_target_block_store";const a=(0,l.TO)(i.getTextSliceTree()),s=(0,l.TO)(a.findTextSliceTreeBeforeTextSliceStartingWithItemId(o.args.textInstanceId,o.args.textSliceStartItemId)).getTextSlice();return g.applyCrdtTextOperation({transaction:n,store:i,operation:{command:"moveTextSlice",path:[],pointer:i.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetBlockId:r.id,targetTextInstanceId:o.args.targetTextInstanceId,targetTextSliceEndItemId:o.args.targetTextSliceEndItemId}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:i.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetTextInstanceId:s.textInstanceId,targetTextSliceEndItemId:s.getEndItem().id}}}),"success"}({environment:t,store:n,transaction:o,operation:i});case"invertedAddAnnotation":return function(e){const{environment:t,store:n,transaction:o,operation:i}=e,r=I({store:n,startTextInstanceId:i.args.startTextInstanceId,startId:i.args.startId,endTextInstanceId:i.args.endTextInstanceId,endId:i.args.endId});return r?(f.QX({environment:t,multiSelection:r,annotationTypeOrKey:i.args.annotationKey,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:n,transaction:o,operation:i});case"invertedRemoveAnnotation":return function(e){const{environment:t,store:n,transaction:o,operation:i}=e,r=I({store:n,startTextInstanceId:i.args.startTextInstanceId,startId:i.args.startId,endTextInstanceId:i.args.endTextInstanceId,endId:i.args.endId});return r?(f.KM({environment:t,multiSelection:r,annotation:i.args.annotation,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:n,transaction:o,operation:i});default:(0,s.t1)(i)}}var A=n(24161);const R=function(e){const t=u.default.state,{undoStack:n,invertedTextOperationIdMapper:o}=t,i=e.currentTime??Date.now(),r=e.transaction.getUserActionForAnalyticsPurposesOnly()??"unknown";if("string"==typeof e.undoCheckpoint){const t=n.find((t=>t.namedRevisionId===e.undoCheckpoint));t?(t.transactions.push(e.transaction),t.userActions.push(r)):n.push({userActions:[r],transactions:[e.transaction],timestamp:i,namedRevisionId:e.undoCheckpoint,undoRedoCount:0})}else{const t=n.at(-1);!e.undoCheckpoint&&t&&!t.namedRevisionId&&i-t.timestamp<=u.groupIntervalMs&&0===t.undoRedoCount&&t.transactions[0].isLocal===e.transaction.isLocal&&t.transactions[0].operations.some(a.Qf)===e.transaction.operations.some(a.Qf)?(t.transactions.push(e.transaction),t.userActions.push(r)):n.push({userActions:[r],transactions:[e.transaction],timestamp:i,undoRedoCount:0})}u.default.setState({undoStack:n,redoStack:[],invertedTextOperationIdMapper:o}),u.default.emit()};function D(e,t){const n=u.default.state,{invertedTextOperationIdMapper:o}=n,{undoStack:i,redoStack:r}=W(n),a=i.pop();if(a){const n=N({environment:e,revision:a,preventSelectText:t,invertedTextOperationIdMapper:o});r.push(n),u.default.setState({undoStack:i,redoStack:r,invertedTextOperationIdMapper:o})}}function B(e,t){const n=u.default.state,{invertedTextOperationIdMapper:o}=n,{undoStack:i,redoStack:r}=W(n),a=r.pop();if(a){const n=N({environment:e,revision:a,preventSelectText:t,invertedTextOperationIdMapper:o});i.push(n),u.default.setState({undoStack:i,redoStack:r,invertedTextOperationIdMapper:o})}}const E=function(){u.default.reset()},F=function(){return Boolean(j())},Z=function(){return Boolean(U())};function V(e){const t=u.default.state,{environment:n,namedRevisionId:o}=e,{invertedTextOperationIdMapper:i}=t,{undoStack:r,redoStack:a}=W(t),s=r.findIndex((e=>e.namedRevisionId===o));if(s<0)return;const l=N({environment:n,revision:r.splice(s,1)[0],invertedTextOperationIdMapper:i});a.push(l),u.default.setState({undoStack:r,redoStack:a,invertedTextOperationIdMapper:i})}function j(){const e=u.default.state.undoStack.at(-1);return e?O(e):void 0}function U(){const e=u.default.state.redoStack.at(-1);return e?O(e):void 0}function L(e){return u.default.state.undoStack.some((t=>t.namedRevisionId===e))}function O(e){return{getUserActions:()=>e.userActions.slice(),getFirstStore(){var t;return null==e||null===(t=e.transactions)||void 0===t||null===(t=t[0].stores)||void 0===t?void 0:t[0]}}}function N(e){const{environment:t,revision:n,invertedTextOperationIdMapper:o,preventSelectText:a}=e;let{transactions:u}=n;c.Z.provider&&console.log("Undoing/redoing transactions with user actions",n.userActions.join(","));const{performResult:f}=g.createAndCommit({userAction:"revisionActions.performUndoRedoRevisionTransaction",environment:t,canUndo:!1,perform:e=>{u=i.d9(u),u.reverse();for(const n of u){const u=i.d9(n.invertedOperations);u.reverse();for(const i of u)if((0,A.v)(i)){const a=n.stores.filter((e=>(0,r.qo)(e.pointer,i.pointer)&&e instanceof d.G)),u=a.find((e=>Boolean(e.uiLocation.uiParent)))??a.at(0);if(!u)continue;const p=e.operations.length,m=o.getInvertedTextOperationWithMaybeRemappedIds(i),f=P({environment:t,store:u,transaction:e,operation:m});"success"!==f&&c.Z.logInvertedTextOperationError({transaction:n,invertedOperation:i,maybeRemappedInvertedOperation:m,errorCode:f});const g=e.operations.length;if("invertedDeleteText"===m.command&&g>p){const t=z(e.operations.slice(p,g));o.remapIdsForReinsertedText(m,(0,l.Fb)(t,(0,s.AO)((e=>"insertText"===e.command?{true:e}:{false:e}))))}}else{const t=n.stores.find((e=>(0,r.qo)(e.pointer,i.pointer)));if(!t)continue;g.applyOperation({transaction:e,store:t,operation:i})}n.beforeSelection&&p.default.setState({...p.default.state,...n.beforeSelection}),n.beforeTextSelection&&!a&&m.default.setState(n.beforeTextSelection)}return e}});return{...n,transactions:[f],undoRedoCount:n.undoRedoCount+1}}function z(e){for(const t of e)if("insertText"===t.command)return t;throw new o.p8("Operations should conatin an InsertTextOperation")}function W(e){const{undoStack:t,redoStack:n}=e;return{undoStack:t.slice(),redoStack:n.slice()}}},56863:(e,t,n)=>{n.d(t,{w:()=>r});var o=n(49557),i=n(4935);const r=function(){o.Z.state.isActive&&(i.Z.setState({...i.Z.state,open:!1}),o.Z.setState({...o.Z.state,isActive:!1,isAnimatingClosed:!0}))}},75754:(e,t,n)=>{n.d(t,{_:()=>c});var o=n(15145),i=n(64002),r=n(35683),a=n(84210),s=n(46735),l=n(8055);function c(e){const{environment:t,store:n,redirect:c,scrollToBlockId:d,collectionViewId:u,openInNew:p,discussionId:m,showMoveTo:f,saveParent:g,visitType:h,templateGalleryItem:v,projectManagementLaunch:b,pageVisitSource:y,openInSidePeek:_,queryId:S,callback:w,peekMode:k}=e,I=(0,a.Hu)({store:n,fullyQualified:!1,scrollToBlockId:d,collectionViewId:u,discussionId:m,showMoveTo:f,saveParent:g,templateGalleryItem:v,projectManagementLaunch:b,openInSidePeek:_,pageVisitSource:y,peekMode:k});n.isNavigableBlock()&&s.Z.recordVisit({id:n.id,systemBlockType:n.getSystemBlockTypeStore().getValue(),type:void 0!==h?h:r.vu.Default,currentUserId:t.currentUser.id}),l.c4({environment:t,url:y?i.SK(I,{[o.$X]:y,[o.Mf]:p?S:void 0}):I,redirect:c,openInNew:p,queryId:S,callback:w})}},12714:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(64002),i=n(95477),r=n(47839);function a(e){const{environment:t,targetSelf:n}=e;let a=e.url;"/"===a[0]&&(a=i.default.domainBaseUrl+a);const s=o.yn(a);if(s)if(t.device.isElectron)r.openExternalUrl(s);else if(t.mobileNative)s.startsWith("http:")||s.startsWith("https:")?t.mobileNative.openInAppBrowser(s):window.location.href=s;else{const t=document.createElement("a");t.href=e.url,t.classList.add("notion-link"),n||t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),document.body.appendChild(t),t.click(),t.remove()}}},32953:(e,t,n)=>{n.d(t,{Hu:()=>G,LU:()=>z,M3:()=>q,Pg:()=>L,UV:()=>H,Vz:()=>K,jC:()=>O,rM:()=>N});var o=n(15157),i=n(72126),r=n(18821),a=n(95306),s=n(9080),l=n(74948),c=n(36896),d=n(41662),u=n(80444),p=n(16772),m=n(89256),f=n(17903),g=n(19671),h=n(13023),v=n(98452),b=n(99332),y=n(24612),_=n(55320),S=n(86486),w=n(27724),k=n(52258),I=n(66708),x=n(77503),C=n(62820),T=n(54564),M=n(6404),P=n(51365),A=n(14900),R=n(47839),D=n(54604),B=n(43008),E=n(52771),F=n(52423),Z=n(24677),V=n(64964),j=n(98104),U=n(53471);function L(e){I.Z.reset(),x.Z.reset(),k.Z.reset(),m.Z.reset(),P.xv({environment:e,blockPropertyValueOverlayStore:g.Z}),U.W8(),V.C1()}function O(e,t){v.Z.reset(),b.Z.reset(),y.Z.reset(),P.xv({environment:e,blockPropertyValueOverlayStore:h.Z})}function N(e){var t;R.inPageSearch.stop(),Z.ZH(e),j.ZH(e),A.wG(),d.HM.clearSelection(),Z.Fp({pivot:void 0}),M.xv(),S.default.reset(),F.dA(),T.LZ(),E.x(e),B.x(e),p.default.resetStore({environment:e}),D.xv(),null===(t=e.NativeMobileActionBarStore)||void 0===t||t.clear(!1)}function z(e){c.Z.reset(),_.default.reset(),C.Z.state.open&&(C.Z.reset(),e.device.isMobile&&l.close()),s.Z.state.open&&a.UZ(e),r.Cd(e)}function W(){const{mainEditorCurrentBlockStore:e}=u.default.state;let t=0,n=[];if(e){const{stores:e}=w.default.state;n=i.oA(e.map((e=>e.id))),t=f.Z.state.scrollTop}return{scrollTop:t,blockIds:n}}function q(e){let{historyId:t,currentUserId:n}=e;const i=o.Z.get({userId:n,key:t});return i?i.index:0}function H(e){let{historyId:t,historyIndex:n,currentUserId:i}=e;const r={...W(),index:n};o.Z.set({userId:i,key:t,value:r})}function K(e){let{historyId:t,currentUserId:n}=e;const i=o.Z.get({userId:n,key:t});if(!i)return;const r={...W(),index:i.index};o.Z.set({userId:n,key:t,value:r})}function G(e){let{RouterStore:t,currentUserId:n}=e;const i=t.state.id;o.Z.remove({userId:n,key:i})}},31120:(e,t,n)=>{n.d(t,{Rd:()=>bt,fE:()=>rt,dH:()=>$e,FA:()=>kt,xp:()=>dt,E4:()=>st,LW:()=>ct,ST:()=>Xe,WC:()=>et,wo:()=>ht,OO:()=>mt,kd:()=>pt,hY:()=>_t,o9:()=>Ke,HR:()=>Ye,r$:()=>gt,uO:()=>Je,KR:()=>ft,td:()=>nt,D_:()=>Ge,nN:()=>it,rH:()=>at,OP:()=>wt,JW:()=>St,YU:()=>lt,cQ:()=>yt,Z_:()=>ot,Mj:()=>tt,wN:()=>ut,AL:()=>vt,yD:()=>Qe,HB:()=>We,tY:()=>He,pN:()=>qe});n(82801),n(21703);var o=n(15145),i=n(7406),r=n(68626),a=n(4615),s=n(71644),l=n(99405),c=n(89101),d=n(21202),u=n(33709),p=n(23867),m=n(77858),f=n(19889),g=n(66079),h=n(9852),v=n(54153),b=n(94826),y=n(97880),_=n(64002),S=n(36054),w=n(74487),k=n(9291),I=n(72899),x=n(91851),C=n(95477),T=n(28020),M=n(70764),P=n(12955),A=n(21969),R=n(35683),D=n(15070),B=n(9844),E=n(80444),F=n(49065);var Z=n(33929),V=n(98165),j=n(18514),U=n(38755),L=n(55081),O=n(10929),N=n(75538),z=n(30806),W=n(74948),q=n(38676),H=n(36391),K=n(51),G=n(19511),$=n(77080),Q=n(30874),Y=n(46735),J=n(33759),X=n(89403),ee=n(49085);class te extends ee.default{getInitialState(){return{args:void 0}}}const ne=new te;var oe=n(42330),ie=n(93220),re=n(72014),ae=n(30539),se=n(88923),le=n(89523),ce=n(26136),de=n(55320),ue=n(27724),pe=n(92083),me=n(29370),fe=n(83941),ge=n(29949),he=n(57549),ve=n(32441),be=n(19719),ye=n(51787),_e=n(54642),Se=n(90287),we=n(47307),ke=n(91584),Ie=n(47839),xe=n(3297),Ce=n(94273),Te=n(92625),Me=n(97977),Pe=n(36110),Ae=n(73661),Re=n(25320),De=n(99553),Be=n(31304),Ee=n(40277),Fe=n(87531),Ze=n(29974),Ve=n(12170),je=n(75754),Ue=n(32953),Le=n(21862),Oe=n(65729),Ne=n(8055);const ze=(0,k.defineMessages)({errorSamlMessage:{defaultMessage:"Could not log you in.",id:"router.loginWithSamlError.message"},appleErrorMessage:{id:"loginActions.loggingInWithApple.errorMessage",defaultMessage:"Something went wrong while trying to log in with Apple."},authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integrationâ€¦"},joinedTeamMessage:{id:"joinedTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},backToContent:{id:"router.joinSpaceError.acceptLabel.backToContent",defaultMessage:"Back to my content"},goBack:{id:"router.joinSpaceError.acceptLabel.goBack",defaultMessage:"Go back"},thirdPartyDebugPrefix:{id:"router.debugMessage.thirdPartyError",defaultMessage:"Error from third party"}});function We(e,t){if(P.canSetCookie(e))try{const n=new URL(t),o=n.searchParams.get("ps_partner_key"),i=n.searchParams.get("ps_xid");if(i&&o){const t={partnerKey:window.atob(o),clickId:i};return P.setS2STrackingCookie(e,t),void ve.Es({partner_stack_key:t.partnerKey})}const r=n.searchParams.get("gspk");if(r){const t=window.atob(r);return P.setPartnerStackCookie(e,t),void ve.Es({partner_stack_key:t})}}catch(n){}}function qe(e,t){if(t)try{const{experimentGroups:n,inviteeEmail:o,inviterName:i}=JSON.parse(window.atob(t));ye.WC(e,{invitee_email:o,invitation_experiment_groups:n}),X.Z.setState({...X.Z.state,inviteeEmail:o,inviterName:i}),o&&J.Z.setState({...J.Z.state,email:o})}catch(n){}}function He(e,t){try{const e=new URL(t).searchParams.get("product")||void 0;e&&J.Z.setState({...J.Z.state,productType:e})}catch(n){}}async function Ke(e,t,n,o){if(!e.currentUser.id)return void Ne.c4({environment:e,url:c._j.root,redirect:!0});let i;if(t.spaceId)i=t.spaceId;else{const{spaceId:t}=await Ce.Ie(e);i=t}if(Se.Uz({nextRoute:{...t,spaceId:i},currentRoute:n,environment:e,query:""}),"search"===t.tab){if(!de.default.state.sessionId){const t=(0,a.ZP)();de.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:t}))),ye.wF(e,{from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar",searchSessionId:t})}}else"updates"===t.tab&&be.Up({environment:e,from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar"})}async function Ge(e,t,n){if(!e.currentUser.id)return;Se.Uz({nextRoute:t,currentRoute:n,environment:e,query:""});const o=e.device.isElectron&&!(await Ie.quickSearchVisibilityState.isVisible());Fe.UT({environment:e,analyticsFrom:"quick-search",renderAsPage:!0,isQuickSearch:!0,doNotTrackOpenSearchEvent:o})}function $e(e,t,n){e.currentUser.id&&Se.Uz({nextRoute:t,currentRoute:n,environment:e,query:""})}function Qe(e,t,n){e.currentUser.id&&t.spaceId&&N.default.state.isOnboarding?Se.Uz({nextRoute:t,currentRoute:n,environment:e,query:""}):Ne.c4({environment:e,url:c._j.root,redirect:!0})}async function Ye(e,t){if(!e.currentUser.id)return void Ne.c4({environment:e,url:c._j.root,redirect:!0});const{id:n,type:o,from:r}=t;let a,s;if(t.spaceId)a=t.spaceId;else{const{spaceId:t}=await Ce.Ie(e);a=t}if(a){const{currentUserSettingsStore:t}=E.default.state,n=new ce.r9(e,{table:g.dx,id:e.currentUser.id});if(await n.load(),void 0===E.default.state.currentSpaceStore||E.default.state.currentSpaceStore.id!==a)try{await Ze.j({environment:e,userRootStore:n,spaceId:a,navigate:!0,analyticsFrom:"redirect",userSettingsStore:t})}catch(l){return void we.showMessage({message:(0,i.tg)(l).message,onAccept:()=>{Ne.op(e)}})}}else Ne.c4({environment:e,url:c._j.root,redirect:!0}),await E.default.waitUntil((()=>void 0!==E.default.state.currentSpaceStore&&void 0!==E.default.state.currentSpaceViewStore&&void 0!==E.default.state.currentUserRootStore));if(o){if(!(0,S.Gu)(w.literals(...oe.o1),o)){const e=o;switch(e){case"page":case"team":n&&(s={type:e,spaceId:a,id:n});break;case"space":n&&(s={type:e,id:n});break;case"space-private-pages":s={type:e,spaceId:a}}}}W.quickAddPage({environment:e,from:r||"route",redirect:!0,quickAddParentOverride:s})}async function Je(e){if(e.currentUser.isLoggedIn()){await L.zJ(e)&&await L.yH(e)}else{const t=N.default.state,n=v.Z.get(O.WX);t.isOnboarding||n?Ne.c4({environment:e,url:c._j.signup}):Ne.c4({environment:e,url:c._j.login})}}async function Xe(e,t){const{code:n,frontPathName:o}=t;if(!n)return void Ne.c4({environment:e,url:c._j.signup});"fail"===(await Me.requestLoginWithGoogleOneTap({environment:e,store:J.Z,idToken:n,frontPathName:o})).status&&Ne.c4({environment:e,url:c._j.signup})}function et(e){e.currentUser.isLoggedIn()||Ne.c4({environment:e,url:c._j.login})}function tt(e){e.currentUser.isLoggedIn()||Ne.c4({environment:e,url:c._j.login})}function nt(e,t,n){if(e.device.isMobile)return;const o=se.default.state;let i,r,a=!1,s=!1;if("page"===t.name&&t.peekViewBlockId){const{mainEditorCurrentBlockStore:e}=E.default.state;if(e){const n=ce.G.createChildStore(e,{table:d.iU,id:t.peekViewBlockId});a=Boolean(t.showMoveTo),s=Boolean(t.saveParent),i=n;const o="page"===t.name&&t.peekMode?t.peekMode:void 0;r=(0,se.getPeekModeFromUrlParam)(o)}}else if("chat"===t.name&&t.peekViewBlockId){a=!1,s=!1,i=new ce.G(e,{table:d.iU,id:t.peekViewBlockId}),r=se.PeekModeSide}if(i&&(!o.open||i.id!==o.target.id||r!==o.mode)){var l,c;o.open&&Ae.P(o.target,e,re.jx);const t=re.jx.getCurrentPageVisitId();re.jx.initializeNewPageVisitId();const d=ue.default.cloneState(),u=me.Z.cloneState(),p=G.Z.cloneState(),m=e.currentUser.id;Ue.jC(e,o.mode),Ue.LU(e),Ue.rM(e),ve.PB(e,{page_id:i.id,collection_id:i.getParentCollectionId()??(null===(l=i.getCollectionViewCollectionStore())||void 0===l?void 0:l.id),team_id:null===(c=(0,V.VP)(i))||void 0===c?void 0:c.id,is_peek:!0,peek_mode:r,type:"page",query:n,page_visit_id:re.jx.getCurrentPageVisitId(),previous_page_visit_id:t});const f=new ce.G(e,i.pointer),g=new ae.Z,v=new le.Z,b=new ie.Z;De.bA(e,{mode:r??se.PeekModeCenter,target:f,pageVisitStore:g,presenceStore:v,showMoveTo:a,saveParent:s,loadingContainerStore:b,savedSelectionStoreState:d,savedTableSelectionStoreState:u,savedCollectionViewSelectionStoreState:p,savedSidebarExpandedStoreState:q.sidebarExpandedStore.state}),Be._({userId:m,rootStore:f,presenceStore:v,environment:e,pageVisitIdStore:re.jx}),Re.UX(e,{block:f,pageVisitStore:g,timestamp:Date.now(),fromPageRefresh:(0,h.getAppRefreshed)()}),Y.Z.recordVisit({id:i.id,systemBlockType:i.getSystemBlockTypeStore().getValue(),type:R.vu.Default,currentUserId:m})}o.open&&!i&&(De.ME(),Be.E(o.presenceStore,e,re.jx,o.target),Ue.jC(e,o.mode))}function ot(e,t){if(e.device.isMobile)return;const{mainEditorCurrentBlockStore:n}=E.default.state;if(n)if("page"===t.name&&t.templateGalleryItem){if("closed"===ge.Z.state.status){const e=t.pageVisitSource===o.tY.PersonalHomeTileTemplates.toString()?"home_tile_templates":"direct_link";ge.Z.open({analyticsFrom:e,cloneTo:"destination_picker"})}}else"closed"!==ge.Z.state.status&&ge.Z.setState({...ge.Z.state,status:"closed"})}async function it(e,t,n){const i=t.currentUser.isLoggedIn(),{RouterStore:a,device:s}=t,l=s.isMobileNative&&s.isIOS,c=a.state.route,u=(e,t)=>{l&&"root"!==a.state.route.name?r.log({level:"warning",from:"routerActions",type:"handleRootRedirect",data:{message:`Prevented ${e} as route has since changed to "${a.state.route.name}"]. Initial route at the start of handleRootRedirect was "${c.name}"}`}}):(l&&r.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:`Redirecting for ${e} as route is still root. Initial route at the start of handleRootRedirect was "${c.name}"}`}}),t())};if(i){l&&r.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:"Called handleRootRedirect"}});const e=await(0,U.iX)({environment:t,disableRedirectUrl:!1}),{firstSpaceView:a,lastVisitedSpaceView:s,forkPageBlockId:c,publicAccessPageId:p,oauthAuthorizationParams:f,userRootStore:g,redirectUrl:h,userSettingsStore:b,userStore:y,isPersonalHomeRedirect:S}=e;S&&(0,z.$X)({environment:t,from:"on_app_start_page"}),await $.default.waitUntil((()=>$.default.state.isLoaded));await L.zJ(t,y)&&await L.yH(t);const w=N.default.state,k=t.currentUser.id,I=v.Z.get(O.WX);if(I&&i)return void(await yt(t,I));if(f&&a&&(e.onboardingCompleted||O.BB(w))){const{responseType:e,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s}=f;return void Pe.g({environment:t,responseType:e,redirectUri:n,integrationId:o,state:i,owner:r,userId:a,spaceId:s})}const C=Oe.A(void 0);Oe.j({currentUserId:void 0,params:void 0});const M=(null==n?void 0:n.templateGalleryItem)||(null==C?void 0:C.tg),P=(null==n?void 0:n.projectManagementLaunch)||Boolean(null==C?void 0:C.pjm);if(w.isOnboarding)if(O.BB(w)){if(w.spaceViewId){const e=new ce.V9(t,{table:m.zU,id:w.spaceViewId});"workspace_setup"===w.stage?x.Xi(t,{spaceViewStore:e}):await Ze.y3({environment:t,spaceViewStore:e,userSettingsStore:b,userRootStore:g,templateGalleryItem:null==n?void 0:n.templateGalleryItem,projectManagementLaunch:null==n?void 0:n.projectManagementLaunch,pageVisitSource:o.tY.Onboarding})}}else Ne.T4(t);else if(f&&e.onboardingCompleted){const{responseType:e,integrationId:n,redirectUri:o,state:i,owner:r,userId:a,spaceId:s}=f;Pe.g({environment:t,responseType:e,integrationId:n,redirectUri:o,state:i,owner:r,userId:a,spaceId:s})}else if(p&&e.onboardingCompleted){Ee.Hr({currentUserId:k,blockId:void 0});const e=ce.G.createChildStore(g,{table:d.iU,id:p});await e.load(),je._({environment:t,store:e,pageVisitSource:o.tY.Direct})}else if(a&&e.onboardingCompleted){const n=h;if(t.device.isMobile&&!e.mobileOnboardingCompleted)return void(await L.I1(t,{type:"mobile-onboarding",redirectUrl:h}));if(c){xe.nM({currentUserId:k,blockId:void 0});const e=ce.G.createChildStore(g,{table:d.iU,id:c});await e.load(),await T.wU(g);const n=T.o(g);if(1===n.length){const o=n[0],i=o.getSpaceStore();if(!i)return;return void xe.DK({environment:t,store:e,spaceStore:i,spaceViewStore:o,isPrivate:!0,context:"signin_after_duplicate"})}await $.default.waitUntilStatsigReady();if(!(0,fe.M)({disableExposureLogging:!0}))return void je._({environment:t,store:e,pageVisitSource:o.tY.Duplicate})}if(n){let e=n;(P||M)&&(e=_.SK(e,{tg:M,pjm:P})),u("redirectUrl",(()=>{Ne.c4({environment:t,url:e,redirect:!0})}))}else s?u("lastVisitedSpaceView",(()=>{Ze.y3({environment:t,spaceViewStore:s,userRootStore:g,userSettingsStore:b,templateGalleryItem:M,projectManagementLaunch:P,pageVisitSource:o.tY.Login})})):(t.device.isMobileNative&&r.log({level:"info",from:"routerActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because handleRootRedirect"}}),u("spaceActions.navigateToFirstSpace",(()=>{Ze.L5({environment:t,userRootStore:g,userSettingsStore:b,templateGalleryItem:M,projectManagementLaunch:P,pageVisitSource:o.tY.Login})})))}else await L.I1(t,{type:"new-user",redirectUrl:h})}}async function rt(e,t){const{callbackType:n,encryptedToken:o,encryptedNonce:i,code:r,error:a,encryptedUserObject:s,webBrowserDeviceId:l}=e;if("native"===n&&!t.device.isNative)return void Ne.RX({url:window.location.href,environment:t});if("user_cancelled_authorize"===a)return J.Z.setState({...J.Z.state,loginType:"email"}),void Ne.c4({environment:t,url:c._j.login});if(a||!r||!o||!i){const e=Z.default.formatMessage(ze.appleErrorMessage);return J.Z.setState({...J.Z.state,alert:e}),void Ne.c4({environment:t,url:c._j.login})}const d=await Me.loginWithAppleAuth({environment:t,encryptedToken:o,encryptedNonce:i,code:r,encryptedUserObject:s,webBrowserDeviceId:l});d&&(J.Z.setState({...J.Z.state,alert:d}),Ne.c4({url:c._j.login,environment:t}))}async function at(e,t){let n;e.userId?await Me.loginSamlUser({environment:t,userId:e.userId,isNewSignup:e.isNewSignup||!1,previousUserId:e.previousUserId}):n=e.token&&e.csrfState?await Me.loginSamlUserWithToken({environment:t,csrfState:e.csrfState,token:e.token,isNewSignup:e.isNewSignup||!1}):e.error||Z.default.formatMessage(ze.errorSamlMessage),n&&(J.Z.setState({...J.Z.state,alert:n}),Ne.c4({environment:t,url:c._j.login}))}async function st(e,t){const{callbackType:n,encryptedToken:o,code:i,error:r,webBrowserDeviceId:a}=e;if("native"===n&&!t.device.isNative)return void Ne.RX({url:window.location.href,environment:t});if("access_denied"===r&&J.Z.setState({...J.Z.state,loginType:"email"}),r||!i||!o)return J.Z.setState({...J.Z.state,alert:r}),void Ne.c4({environment:t,url:c._j.login});const s=await Me.loginWithGoogleAuth({environment:t,encryptedToken:o,code:i,callbackType:"native"===n||"nativeredirect"===n?n:void 0,webBrowserDeviceId:a});s&&(J.Z.setState({...J.Z.state,alert:s}),Ne.c4({url:c._j.login,environment:t}))}async function lt(e){const{route:t,environment:n}=e;"legacy"===t.type?await async function(e){const{route:{code:t,state:n},environment:o}=e;let i;if(t&&n){const e=await _e.authWithSlack(o,{code:t,encryptedState:n});"failed"===e.type&&(i=e.error.message)}else i="Something went wrong.";i&&we.deprecatedShowErrorMessage(i);const{url:r}=Ce.Vr(o);Ne.c4({url:r||c._j.root,environment:o})}({environment:n,route:t}):"new"===t.type?await async function(e){const{route:{error:t},environment:n}=e;if(t){const e=Z.default.formatMessage((0,M.mO)(t),{value:t});we.showErrorMessage(e)}else await Ve.pJ({environment:n});const{url:o}=Ce.Vr(n);Ne.c4({url:o||c._j.root,environment:n})}({environment:n,route:t}):(0,y.t1)(t)}function ct(e,t){const{code:n,error:o}=e;!o&&n&&ke.O$(t,n);const{url:i}=Ce.Vr(t);Ne.c4({url:i||c._j.root,environment:t})}async function dt(e){const{route:t,environment:n}=e;let o=t.error?t.errorDescription||Z.default.formatMessage((0,M.mO)(t.error),{value:t.error}):void 0;try{if(!t.notionState)throw new Error("No notionState.");const e=JSON.parse(decodeURIComponent(t.notionState));await Ve.pJ({environment:n}),await Ve.FD({environment:n,notionState:e})}catch(i){o||(o="An unknown error occurred.")}o&&we.deprecatedShowErrorMessage(o),Ne.iy(n)}async function ut(e){const{route:t,environment:n,integrationId:o,from:r,options:a}=e;let s=t.error?t.errorDescription||Z.default.formatMessage((0,M.mO)(t.error),{value:t.error}):void 0;try{if(!t.state)throw new Error("No state provided.");if(!t.code)throw new Error("No code provided.");Te.j({message:ze.authenticating});const e=await _e.authWithExternalIntegration(n,{code:t.code,state:t.state,...t.name===l.AY.datadogAuthCallback?{accountName:t.organizationName,accountId:t.organizationId,accountDomain:t.site}:void 0});if(Te.x(),"failed"===e.type){var c;const t="access_token_retrieval_failed"===(null===(c=e.body)||void 0===c||null===(c=c.clientData)||void 0===c?void 0:c.type)?Z.default.formatMessage(ze.thirdPartyDebugPrefix):void 0;we.showError(e,t)}else{const{externalObjectInstanceBlockId:t,spaceId:i}=e.data;if(await Ve.pJ({environment:n}),await Ve.FD({environment:n,notionState:{externalObjectInstanceBlockId:t,spaceId:i}}),o&&(0,b.z6)(o)){const e=Q.Z.bots.state.filter((e=>e.integration_id===o))[0];he.eR(n,{integration_id:o,configuration_type:"oauth",bot_id:null==e?void 0:e.id})}}}catch(d){s||(s=(0,i.tg)(d).message)}s&&we.deprecatedShowErrorMessage(s),await async function(e){const{environment:t,integrationId:n,from:o}=e;if(function(e){const{currentUserRootStore:t}=E.default.state;if(!t||!e)return!1;const n=(0,F.Kv)(t,{id:e,table:B.K2}).getKeyStore("capabilities").getValue();return(0,D.ms)(n)}(n)&&!(0,b.uw)(n)){const{spaceId:e}=await Ce.Ie(t);Pe.g({environment:t,responseType:"code",spaceId:e,integrationId:n,redirectUri:void 0,state:void 0,owner:void 0,userId:void 0})}else"workspace_connections_redirect"!==o&&Ne.iy(t)}({environment:n,integrationId:o,shouldOpenSettings:null==a?void 0:a.shouldOpenSettings,from:r})}async function pt(e,t){const{state:n,password:o,isSignup:i,redirectURL:r,webBrowserDeviceId:a}=e,s=await Me.loginWithTemporaryPasscode({environment:t,state:n,password:o,redirectURL:r,webBrowserDeviceId:a,passcodeEnterMethod:"magic_link"});s&&(J.Z.setState({...J.Z.state,alert:s}),i?Ne.c4({url:c._j.signup,environment:t}):Ne.c4({url:c._j.login,environment:t}))}async function mt(e,t){const{args:n}=ne.getState(),{webBrowserDeviceId:o}=e;n?await Me.handleLoginWithTemporaryPasscodeSuccess({environment:t,...n,webBrowserDeviceId:o}):(r.log({level:"error",from:"routerActions",type:"handleLoginSuccessRedirect",data:{message:"empty args for handleLoginSuccessRedirect"}}),Ne.c4({url:c._j.root,environment:t}))}async function ft(e,t){const{state:n,password:o}=e,i=await Me.loginPasswordReset({environment:t,csrfState:n,password:o,loginStore:J.Z});i&&(J.Z.setState({...J.Z.state,loginType:"email",alert:i}),Ne.c4({url:c._j.login,environment:t}))}async function gt(e,t){h.setOauthAuthorizationParams(e);const{userId:n,spaceId:o}=e;if(o){const e=n?[n]:t.currentUser.loggedInUserIds;for(const n of e){const e=new ce.r9(t,{table:g.dx,id:n},{userId:n});await e.load();const i=e.getSpaceViewStores();if(i.length>0){await Promise.all(i.map((e=>e.load())));const e=i.find((e=>e.getSpaceId()===o));if(e)return void(await Ze.ce({environment:t,spaceViewStore:e}))}}}const{currentUserRootStore:i}=E.default.state;if(i){await i.load();const e=i.getSpaceViewStores().find((e=>{var t;return Boolean(null===(t=e.getSpaceStore())||void 0===t?void 0:t.canRead())}));if(e)return void(await Ze.ce({environment:t,spaceViewStore:e}))}Ne.c4({environment:t,url:c._j.login,redirect:!0})}function ht(e,t,n){if((0,j.Sr)()){const t=_.TW({publicDomainName:C.default.publicDomainName},window.location.host);Se.qY({spaceDomain:t,environment:e})}else!e.currentUser.isLoggedIn()||null!=n&&n.doNotRedirectWhenLoggedIn?ve.Sn(e,t):Ne.c4({environment:e,url:c._j.root,redirect:!0})}async function vt(e,t){var n;const i=e.currentUser.id;if(!i)return void It(e);const r=new ce.r9(e,{table:g.dx,id:i},{userId:i});await r.load();const a=null===(n=r.getSpaceViewStores())||void 0===n?void 0:n[0].getSpaceId();if(!a)return void It(e);const s=await _e.getIdFromUniqueId(e,{spaceId:a,uniqueId:t});if("failed"===s.type||!s.data.id)return void It(e);const l=s.data.id,c=ce.G.createChildStore(r,{table:d.iU,id:l});await c.load(),Le.r({environment:e,store:c,pageVisitSource:o.tY.Direct})}async function bt(e){const{environment:t,route:n}=e;Ne.c4({environment:t,url:c._j.root,redirect:!0});const[{favoriteImportActions:o}]=await Promise.all([I.E0.loader(),async()=>{await E.default.waitUntil((()=>void 0!==E.default.state.currentUserSettingsStore&&void 0!==E.default.state.currentSpaceStore&&void 0!==E.default.state.currentSpaceViewStore&&void 0!==E.default.state.currentUserRootStore)),await E.default.waitUntilRendered()}]);await o.importGtmFavorite({environment:t,importArgs:n})}async function yt(e,t){const n=Ee.I6({environment:e,request:{type:"invite-link",inviteLinkCode:t}}),r=(await n.next()).value;K.Z.setState({publicPageData:r});const a=()=>{v.Z.set(O.WX,t),Ne.T4(e)};if(e.currentUser.isLoggedIn()&&r.spaceId){const{id:n}=e.currentUser;if(n){const l=new ce.U6(e,{table:f.KJ,id:n});await l.load();if(!l.getFullName(Z.default.getIntl())){a();const t=await(0,U.iX)({environment:e,disableRedirectUrl:!1});return void(await L.I1(e,{type:"new-user",redirectUrl:t.redirectUrl}))}const c=new ce.r9(e,{table:g.dx,id:n});await c.load();try{const n=await Ze.j({environment:e,userRootStore:c,userSettingsStore:void 0,spaceId:r.spaceId,navigate:!1,analyticsFrom:"redirect",inviteCode:t});await Ze.y3({environment:e,spaceViewStore:n.spaceViewStore,userSettingsStore:void 0,userRootStore:c,pageVisitSource:o.tY.SwitchSpace})}catch(s){const{currentUserRootStore:t,currentUserSettingsStore:n}=E.default.state,r=t&&n;we.showMessage({message:(0,i.tg)(s).message,acceptLabel:r?Z.default.formatMessage(ze.backToContent):Z.default.formatMessage(ze.goBack),onAccept:()=>{v.Z.remove(O.WX),r?Ze.L5({environment:e,userRootStore:t,userSettingsStore:n,pageVisitSource:o.tY.Onboarding}):Ne.op(e)}})}}}else a()}async function _t(e){await Me.actuallyLogoutAndDeleteAllLocalData({environment:e})}async function St(e,t){const{mainEditorCurrentBlockStore:n}=E.default.state;if(n&&"page"===t.name&&t.scrollToBlockId&&t.discussionId){const o=ce.G.createChildStore(n,{table:d.iU,id:t.blockId}),i=(0,ce.Kv)(o,{table:u.qF,id:t.discussionId,spaceId:(0,p.C)(o.pointer.spaceId)});await i.load(),i.getKeyStore("resolved").getValue()&&(W.setUpdateExpand({environment:e,isExpanded:!0,from:"resolved_comment"}),W.setUpdateSidebarCommentsMode(H.F7.Resolved))}}async function wt(e,t){"configureOpenInDesktopApp"in t&&t.configureOpenInDesktopApp&&(await $.default.waitUntilStatsigReady(),e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows)&&pe.Z.setState({open:!0,openedFrom:"misc",currentTab:"user_settings",defaultSubtab:void 0,highlightedSetting:pe.R.OpenInDesktopApp}))}function kt(e){let t;try{t=_.$U((0,A.W)(window.location.href))}catch{}t&&Ne.c4({environment:e,url:t})}function It(e){const t={name:"notFound"};e.RouterStore.setState({id:(0,s.ZP)(),route:t,action:"push",initialRoute:e.RouterStore.state.initialRoute||t})}},21862:(e,t,n)=>{n.d(t,{r:()=>d});var o=n(15157),i=n(72126),r=n(63143),a=n(35683),s=n(98165),l=n(80444),c=n(75754);function d(e){const{store:t,openInNew:n,environment:d,pageVisitSource:p,openInSidePeek:m}=e,{currentSpaceStore:f}=l.default.state;if(!t.isDefined())return;const g=t.isNavigableBlock(),{page:h,block:v}=g?{page:t,block:void 0}:{page:s.Dg(t),block:t};h&&(!v&&f&&function(e){let{currentUserId:t,spaceId:n,blockId:a}=e;const s=function(e){let{currentUserId:t,spaceId:n}=e;const i=o.Z.get({userId:t,key:u(n)});if(i){const e=(0,r.dj)(i);return Array.isArray(e)?e:[]}return[]}({currentUserId:t,spaceId:n}),l=i.jj([a,...s]).slice(0,10);o.Z.set({userId:t,key:u(n),value:JSON.stringify(l)})}({currentUserId:d.currentUser.id,spaceId:f.id,blockId:h.id}),c._({environment:d,store:h,scrollToBlockId:v&&v.id,openInNew:n,visitType:a.vu.Search,pageVisitSource:p,queryId:e.queryId,openInSidePeek:m}))}function u(e){return`recentQuickJumps:${e}`}},26999:(e,t,n)=>{n.d(t,{CH:()=>d,OW:()=>p,Qk:()=>u});var o=n(15145),i=n(84210),r=n(80444),a=n(88923),s=n(50906),l=n(99553),c=n(8055);function d(e){const{environment:t,store:n,peekMode:o,openInNew:s,showMoveTo:d,saveParent:u,resultsStore:p,collectionContextStore:m,pageVisitSource:f}=e,g=e.currentBlockStore??r.default.state.mainEditorCurrentBlockStore;if(!g)return;const h=Boolean(s)||"full_page"===o?(0,i.Hu)({store:n,fullyQualified:!1,showMoveTo:d,saveParent:u,pageVisitSource:f}):(0,i.Hu)({store:g,peekViewBlockId:n.id,peekMode:(0,a.getUrlParamFromPeekMode)(o),fullyQualified:!1,showMoveTo:d,saveParent:u,pageVisitSource:f});c.c4({environment:t,url:h,openInNew:s}),l.Af({resultsStore:p,collectionContextStore:m,pageVisitSource:f})}function u(){const{resultsStore:e}=a.default.state,t=null==e?void 0:e.getState();if(a.default.state.open&&t){const{target:e}=a.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:l}=r.default.state;if(l&&n>0){const e=(0,i.Hu)({store:l,fullyQualified:!1,peekViewBlockId:t[n-1].id,peekMode:(0,a.getUrlParamFromPeekMode)(a.default.state.mode),pageVisitSource:o.tY.PeekScroll});c.c4({environment:l.environment,url:e}),s.zP(l.environment,{direction:"up"})}}}function p(){const{resultsStore:e}=a.default.state,t=null==e?void 0:e.getState();if(a.default.state.open&&t){const{target:e}=a.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:l}=r.default.state;if(l&&n<t.length-1){const e=(0,i.Hu)({store:l,fullyQualified:!1,peekViewBlockId:t[n+1].id,peekMode:(0,a.getUrlParamFromPeekMode)(a.default.state.mode),pageVisitSource:o.tY.PeekScroll});c.c4({environment:l.environment,url:e}),s.zP(l.environment,{direction:"down"})}}}},69915:(e,t,n)=>{n.d(t,{tc:()=>c,yF:()=>l});n(82801);var o=n(4615),i=n(77472),r=n(12955),a=n(80444),s=n(8055);async function l(e,t){const{utmContent:n,nextRoute:o}=t,[i,r]=await Promise.all([c(e),d(e,{utmContent:n,utmSource:"public_page"})]);s.Li({environment:e,url:o,extraSearchParams:{...i,...r}})}async function c(e){const t=await r.getPartnerStackCookie(e);if(t){return{gspk:window.btoa(t)}}const n=await r.getS2STrackingCookie(e);if(n&&n.partnerKey){return{ps_partner_key:window.btoa(n.partnerKey),ps_xid:n.clickId}}return{}}async function d(e,t){const{utmContent:n,utmSource:r}=t,s={utm_source:r,utm_content:n,tid:await(0,i.cG)(e)},{mainEditorCurrentBlockStore:l}=a.default.state;return null!=l&&l.id&&(s.utm_campaign=(0,o.F9)(null==l?void 0:l.id)),s}},65729:(e,t,n)=>{n.d(t,{A:()=>a,j:()=>r});var o=n(15157);const i="queryParamsRedirect";function r(e){let{currentUserId:t,params:n}=e;o.Z.set({userId:t,key:i,value:n})}function a(e){return o.Z.get({userId:e,key:i})}},8055:(e,t,n)=>{n.d(t,{CZ:()=>$,LU:()=>J,Li:()=>N,Oj:()=>q,RX:()=>G,T4:()=>W,c4:()=>z,eH:()=>Y,iy:()=>te,j7:()=>K,op:()=>Q,up:()=>X});n(21703);var o=n(1302),i=n(27328),r=n(15145),a=n(72126),s=n(71644),l=n(99405),c=n(89101),d=n(32739),u=n(97880),p=n(64002),m=n(95477),f=n(77472),g=n(98165),h=n(18514),v=n(18245),b=n(95802),y=n(74948),_=n(24646),S=n(38676),w=n(36391),k=n(5162),I=n(80444),x=n(88923),C=n(26136),T=n(87956),M=n(32441),P=n(51787),A=n(2449),R=n(47839),D=n(47678),B=n(94273),E=n(3898),F=n(29974),Z=n(75754),V=n(12714),j=n(32953),U=n(91100),L=n(1357);const O=[`${r.tY.MentionInPage}`,`${r.tY.LinkInPage}`,`${r.tY.PeekOpen}`,`${r.tY.Expand}`,`${r.tY.Duplicate}`,`${r.tY.Move}`];function N(e){const t=function(e,t){try{const n=e.startsWith("/")?new URL(e,m.default.domainBaseUrl):new URL(e);if(t)for(const[e,o]of Object.entries(t))n.searchParams.append(e,o);return n.pathname+n.search+n.hash}catch{throw new Error(`${e} is neither a URL nor an absolute path`)}}(e.url,e.extraSearchParams);return z({...e,url:`${m.default.domainBaseUrl}${t}`})}function z(e){var t,n;const{environment:o,openInNew:i,frontPreserveScrollPosition:r,queryId:a,callback:c}=e,{RouterStore:f,currentUser:g}=o,h=g.id,{savedSidebarExpandedStoreState:b}=x.default.state;b&&S.sidebarExpandedStore.setState(!0);const k=l.Wj({url:e.url,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,isMobile:o.device.isMobile,protocol:m.default.protocol,currentUrl:window.location.href}),{redirect:C,updateMobileTabbedRouterArgs:D}=H(e,k),B=p.gy(window.location.href),E=p.gy(e.url),F=Boolean((null==E?void 0:E.hostname)&&E.hostname!==(null==B?void 0:B.hostname));if("external"===k.name||F)return void V.D({environment:o,url:e.url,targetSelf:F});const Z=d.u5({schemeUrl:e.url,baseUrl:m.default.domainBaseUrl}),L=p.T1(e.url);if("tab"===i)return void(o.device.isElectron&&"page"===k.name?R.openInNewTab({url:L,position:"after-children"}):V.D({environment:o,url:Z}));if("window"===i&&o.device.isElectron&&"page"===k.name)return void R.openInNewWindow(L);const N=f.state.route;if("quickSearch"===N.name&&o.device.isElectron)return void R.openQuickSearchResult(L);const z="page"===N.name&&"page"===k.name&&N.blockId===k.blockId,W="page"===N.name&&"page"===k.name&&N.spaceDomain!==k.spaceDomain&&(N.requestedOnPublicDomain||k.requestedOnPublicDomain),K=o.AppUpdateStore.state.appUpdate;if(!z&&!e.redirect&&A.cM(o,K))return void A.hC({environment:o,url:L,version:K.version});if(C||z||(j.Vz({historyId:f.state.id,currentUserId:h}),(0,_.Sx)(o)&&(y.setUpdateExpand({environment:o,isExpanded:!1,from:"close_for_space"}),w.ZP.update((e=>({...e,canRender:!1}))))),j.LU(o),W)return void V.D({environment:o,url:e.url,targetSelf:!0});const G=(0,s.ZP)();C?window.history.replaceState({id:G,currentUserId:o.currentUser.id},void 0,L):window.history.pushState({id:G,currentUserId:o.currentUser.id},void 0,L);const $=j.M3({historyId:f.state.id,currentUserId:h});j.UV({historyId:G,historyIndex:C?$:$+1,currentUserId:h}),"pageVisitSource"in k&&(0,u.DE)(O,k.pageVisitSource)&&M.BR(o,N,k),!z&&"page"===N.name&&T.Z.state&&(null===(t=T.Z.state)||void 0===t?void 0:t.pageId)===N.blockId&&P.Eb(o,T.Z.state),U.e({environment:o,id:G,action:C?"replace":"push",href:L,updateMobileTabbedRouterArgs:D}).then((()=>{"page"===k.name&&!z&&a?T.Z.setState({queryId:a,pageId:k.blockId,timeEntered:new Date}):T.Z.reset()})).then((()=>{c&&c()}));(z||"nativeTab"===N.name&&"page"===k.name&&(null===(n=I.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id)===k.blockId)&&q(o),!r&&window.scrollTo(0,0),v.default.markEitherOf(["navigation_page_render","navigation_database_render"]),v.default.mark("initial_page_render_after_login")}function W(e){z({environment:e,url:c._j.onboarding})}async function q(e){const{RouterStore:t}=e,n=I.default.state.mainEditorCurrentBlockStore;if(n&&"page"===t.state.route.name){if(t.state.route.scrollToBlockId){const e=[t.state.route.scrollToBlockId];0===a.oA(b.C.findSelectablesFromIds(e)).length&&(await E.Nz(n,e),await o.default.afterNextFlush())}D.Y(e)}}const H=function(e,t){const n={redirect:e.redirect,updateMobileTabbedRouterArgs:e.updateMobileTabbedRouterArgs};return h.__(e.environment)?("login"!==t.name&&"logout"!==t.name&&"onboarding"!==t.name||(n.redirect=!0,n.updateMobileTabbedRouterArgs={...n.updateMobileTabbedRouterArgs,clearNativeRootPageOverride:!0}),n):n};function K(e){var t;const{environment:n,url:o}=e;if(!h.__(n))return;const{TabbedRouterStore:r}=n,a=(0,i.w_)(r.state);if("web"!==a.type)return;const s=l.Wj({url:o,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,isMobile:n.device.isMobile,protocol:m.default.protocol,currentUrl:window.location.href}),c=(null===(t=a.redirectedTo)||void 0===t?void 0:t.route)??a.route;if(s.name!==c.name)return;const d=p.T1(e.url);a.redirectedTo?(a.redirectedTo.route=s,a.redirectedTo.url=d):(a.route=s,a.url=d)}async function G(e){const{environment:t,url:n}=e,o=p.T1(n);t.device.isNative?z({url:o,environment:t}):window.location.href=p.SK(d.NV({httpUrl:o,protocol:m.default.protocol}),{di:await(0,f.cG)(t)})}async function $(e){const{environment:t,blocks:n}=e,{mainEditorCurrentBlockStore:o,currentSpaceViewStore:i,currentUserSettingsStore:a,currentUserRootStore:s}=I.default.state,l=o&&n.find((e=>e.id===o.id));if(l&&i){const e=g.Dg(l,1);(0,k.Y)("supportsNativeHome")?h.NW(t)?Q(t):L.d(t):e?Z._({environment:t,store:e,pageVisitSource:r.tY.LeaveOrRemove}):await F.y3({environment:t,spaceViewStore:i,userSettingsStore:a,userRootStore:s,pageVisitSource:r.tY.LeaveOrRemove})}Boolean(n.find((e=>{var t;return e.id===(null===(t=x.default.peekTarget.state)||void 0===t?void 0:t.id)})))&&o&&Z._({environment:t,store:o,pageVisitSource:r.tY.LeaveOrRemove})}const Q=function(e){h.__(e)?ee(e):window.history.back()},Y=function(){window.history.forward()},J=function(){const e=I.default.state.mainEditorCurrentBlockStore;return!!e&&!!g.Dg(e,1)},X=function(e){const t=I.default.state.mainEditorCurrentBlockStore;if(!t)return;const n=g.Dg(t,1);n&&Z._({environment:e,store:C.G.createChildStore(n,n.pointer),pageVisitSource:r.tY.Breadcrumb})},ee=function(e){const{TabbedRouterStore:t}=e,n=t.state,o=(0,i.Os)(n);if(!o)return;const r=o.type;"native"===r?t.updateWithNativePage({page:o,clearPages:!1,navigationAction:"pop",navigationSource:"mobile-back-navigation"}):"web"===r?window.history.back():(0,u.t1)(r)};function te(e){const{url:t}=B.Vr(e);z({url:t||c._j.root,environment:e})}},32219:(e,t,n)=>{n.r(t),n.d(t,{getInitialPage:()=>d,initialize:()=>c});var o=n(71644),i=n(72128),r=n(18514),a=n(5162),s=n(32953),l=n(91100);const c=async function(e){const t=window.history.state&&window.history.state.id||(0,o.ZP)();if(!window.history.state){const n=e.currentUser.id;window.history.replaceState({id:t,currentUserId:n},void 0,window.location.href),s.UV({historyId:t,historyIndex:0,currentUserId:n})}r.__(e)&&e.TabbedRouterStore.setUp({nativeInboxEnabled:(0,a.Y)("supportsNativeInbox")}),await l.e({environment:e,id:t,action:"pop",href:window.location.href,updateMobileTabbedRouterArgs:{forceUpdate:!0,silenceErrors:!0,clearNativeRootPageOverride:"/"!==window.location.pathname},enableDesktopAppRedirect:!0});const n=e.currentUser.id,c=d(n);if(!c||"undefined"===c){const e=window.location.pathname;e&&function(e){let{currentUserId:t,value:n}=e;i.Z.set({userId:t,key:"sourceInitialPage",value:n})}({currentUserId:n,value:e})}};function d(e){return i.Z.get({userId:e,key:"sourceInitialPage"})}},91100:(e,t,n)=>{n.d(t,{e:()=>E});var o=n(17673),i=n(50112),r=n(15157),a=n(29477),s=n(90850),l=n(99405),c=n(89101),d=n(7678),u=n(9852),p=n(93724),m=n(12139),f=n(64002),g=n(95477),h=n(78873),v=n(18514),b=n(77907),y=n(80444),_=n(21273),S=n(77080),w=n(73796),k=n(45946),I=n(70060),x=n(88280),C=n(22500),T=n(32441),M=n(90287),P=n(91376),A=n(87531),R=n(39634),D=n(31120),B=n(8055);async function E(e){const{id:t,action:n,href:E,environment:Z,updateMobileTabbedRouterArgs:V}=e,{RouterStore:j,currentUser:U,TabbedRouterStore:L}=Z,O=(null==V?void 0:V.restoringTab)||!1,[N,z]=l.DP({url:E,isMobile:Z.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href});m.FB(N.name),p.setRouteTags(N,z);const W=j.state.route,q=r.Z.get({userId:U.id,key:t});if(j.setState({id:t,historyState:q,action:n,route:N,initialRoute:j.state.initialRoute||N}),null!=V&&V.forceUpdate||v.__(Z)&&!O){const e={type:"web",url:f.T1(E),route:N};L.updateWithWebPage({page:e,action:null!=V&&V.forceUpdate?"replace":n,updateMobileTabbedRouterArgs:V})}const H=f.Qc(E),K=H.query[d.Vt];K&&(0,s.Zj)({currentUserId:U.id,promoCode:K});const G=H.query[i.gS];G&&((0,u.setSessionAnalyticsTags)(G),F(i.gS)),"page"===N.name||l.KV[N.name]||T._W(Z,E);const{target:$,subtarget:Q}=function(e){if(!e)return{target:void 0};const t=null==e?void 0:e.indexOf(".");if(-1===t)return{target:e};return{target:e.substring(0,t),subtarget:e.substring(t+1)}}(H.query.target);if("intercom"===$)R.j({environment:Z,from:"query_param"}),F("target");else if(Z.device.isMobileBrowser&&"plans"===$){if(await S.default.waitUntilStatsigReady(),(0,I.bQ)()){const e=await b.deps.payments.loader();await y.default.waitUntil((()=>void 0!==y.default.state.currentSpaceStore)),await y.default.waitUntilRendered();const t=y.default.state.currentSpaceStore;e.plans.canShowPlans(t)&&e.plans.showPlans({environment:Z,from:"deeplink"}),F("target")}}else if(Z.device.isMobileBrowser&&"billing"===$){if(await S.default.waitUntilStatsigReady(),(0,I.bQ)()){const e=await b.deps.payments.loader();await y.default.waitUntil((()=>void 0!==y.default.state.currentSpaceStore)),await Promise.all([y.default.waitUntilRendered(),x.subscriptionDataStoreInstance.waitUntilLoaded()]);const t=y.default.state.currentSpaceStore,n=x.subscriptionDataStoreInstance.state;t&&n&&e.billing.canShowBilling({subscriptionData:n,spaceStore:t})&&e.billing.showBilling({environment:Z,from:"deeplink"}),F("target")}}else"billing"===$||"plans"===$||"members"===$||"audit_log"===$||"connected_apps"===$||"identity_provisioning"===$||"analytics"===$||"admin_content_search"===$||"profile"===$||"notifications_and_settings"===$||"user_settings"===$||"notifications"===$||"language_and_region"===$||"settings"===$||"integrations"===$||"sites"===$||"imports"===$?(P.r$({currentTab:$,subtab:Q,isMobile:Z.device.isMobile,openedFrom:"email"}),F("target")):"contact_us"===$?(w.Z.setState({open:!0}),F("target")):"quickfind"===$?(Promise.race([async()=>{await y.default.waitUntil((()=>void 0!==y.default.state.currentUserSettingsStore&&void 0!==y.default.state.currentSpaceStore&&void 0!==y.default.state.currentSpaceViewStore&&void 0!==y.default.state.currentUserRootStore)),await y.default.waitUntilRendered(),A.UT({environment:Z,analyticsFrom:"deeplink"})},a.Xb(1500,void 0).then((()=>{A.UT({environment:Z,analyticsFrom:"deeplink"})}))]),F("target")):"qna"===$&&(Promise.race([(async()=>{if(await y.default.waitUntil((()=>void 0!==y.default.state.currentUserSettingsStore&&void 0!==y.default.state.currentSpaceStore&&void 0!==y.default.state.currentSpaceViewStore&&void 0!==y.default.state.currentUserRootStore)),await y.default.waitUntilRendered(),!_.Z.isQnaRightSideDeeplinkEnabled()||_.Z.isQnATooltipsVisible(Z.device,y.default.state.currentUserSettingsStore))return!1;const e=await b.deps.assistant.loader();return await e.assistantMenuActions.openAssistantRightHandSideMenu({environment:Z,from:"deeplink"}),!0})(),(async()=>{if(!_.Z.isQnaRightSideDeeplinkEnabled())return!1;await a.Xb(1500,void 0);const e=await b.deps.assistant.loader();return await e.assistantMenuActions.openAssistantRightHandSideMenu({environment:Z,from:"deeplink"}),!0})()]),F("target"));await S.default.waitUntil((()=>S.default.state.isLoaded));const Y=f.T1(E),J=o.parse(Y.split("?")[1]||"");if("settingsConsoleDefault"===N.name)return await S.default.waitUntilStatsigReady(),S.default.checkGate("admin_console_enabled")?void B.c4({environment:Z,url:c._j.settingsConsoleWorkspace,redirect:!0}):void B.c4({environment:Z,url:c._j.root,redirect:!0});if("settingsConsoleOrganization"!==N.name||(await S.default.waitUntilStatsigReady(),S.default.checkGate("admin_console_enabled")))if("settingsConsoleWorkspace"!==N.name||(await S.default.waitUntilStatsigReady(),S.default.checkGate("admin_console_enabled")))if(e.enableDesktopAppRedirect&&function(e){const{route:t}=e.RouterStore.state;return l.c$[t.name]&&"always"===k.Z.state&&e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows||!1)&&(!("configureOpenInDesktopApp"in t)||!t.configureOpenInDesktopApp)}(Z))D.FA(Z);else{if("root"===N.name){const e={templateGalleryItem:N.templateGalleryItem,projectManagementLaunch:"true"===(Array.isArray(J.pjm)?J.pjm[0]:J.pjm)};D.nN(N,Z,e)}else if("onboarding"===N.name)D.uO(Z);else if("modal"===N.name)if(Z.currentUser.isLoggedIn()){let e="/";N.projectManagementLaunch?e+="?tg=gallery":N.templateGalleryItem&&(e+=`?tg=${N.templateGalleryItem}`),B.c4({environment:Z,url:e,redirect:!0})}else B.c4({environment:Z,url:c._j.login,redirect:!0});else if("googleOneTapRedirect"===N.name)D.ST(Z,{code:N.code,frontPathName:N.frontPathName});else if("samlAuthCallback"===N.name)D.rH(N,Z);else if("appleAuthCallback"===N.name)D.fE(N,Z);else if("googleAuthCallback"===N.name)D.E4(N,Z);else if("googleDriveAuthCallback"===N.name)D.LW(N,Z);else if("slackAuthCallback"===N.name)D.YU({route:N,environment:Z});else if(N.name===l.AY.datadogAuthCallback)D.wN({route:N,environment:Z});else if("externalAuthCallback"===N.name)D.xp({route:N,environment:Z});else if(N.name===l.AY.authCallback)D.wN({route:N,environment:Z});else if("loginWithEmailCallback"===N.name)D.kd(N,Z);else if("loginSuccessCallback"===N.name)D.OO(N,Z);else if("passwordResetCallback"===N.name)D.KR(N,Z);else if("passwordChangeRedirect"===N.name)B.Li({environment:Z,url:c._j.login}),h.E({environment:Z});else if("logout"===N.name)D.hY(Z);else if("login"===N.name||"signup"===N.name){D.HB(Z,E),D.tY(Z,E);const e={doNotRedirectWhenLoggedIn:Boolean(J.newSignup)};D.wo(Z,N.name,e)}else"oauthAuthorization"===N.name?D.r$(N,Z):"page"===N.name||"space"===N.name?(!Z.device.isMobile&&"page"===N.name&&N.shouldDuplicate&&await S.default.waitUntilStatsigReady(),D.HB(Z,E),D.pN(Z,N.state),M.Uz({nextRoute:N,currentRoute:W,environment:Z,query:Y}),D.Z_(Z,N),await D.JW(Z,N)):"templatesRedirect"===N.name?B.c4({environment:Z,url:(0,v.UY)("templateGallery"),redirect:!0}):"communityRedirect"===N.name?B.c4({environment:Z,url:(0,v.UY)("community"),redirect:!1}):"guideRedirect"===N.name?B.c4({environment:Z,url:(0,v.UY)("guides.guides"),redirect:!0}):"invoiceRedirect"===N.name?B.c4({environment:Z,url:c._j.root,redirect:!0}):"termsRedirect"===N.name?B.c4({environment:Z,url:(0,v.UY)("terms"),redirect:!0}):"contentPolicyRedirect"===N.name?B.c4({environment:Z,url:(0,v.UY)("contentPolicy"),redirect:!0}):"uiDoc"===N.name||"exportPreview"===N.name?B.c4({environment:Z,url:c._j.root,redirect:!0}):"admin"===N.name?g.default.isAdminMode||B.c4({environment:Z,url:c._j.root,redirect:!0}):"teamInvite"===N.name?D.cQ(Z,N.inviteCode):"teamsInvite"===N.name?Z.currentUser.isLoggedIn()||B.c4({environment:Z,url:c._j.signup,redirect:!0}):"aiGtmFavoriteImport"===N.name?D.Rd({environment:Z,route:N}):"new"===N.name?D.HR(Z,N):"myIntegrations"===N.name?D.WC(Z):"inAppTemplateSubmission"===N.name||"inAppTemplateCreatorSubmission"===N.name?D.Mj(Z):"studentGroupSignup"===N.name?Z.currentUser.isLoggedIn()||B.c4({environment:Z,url:c._j.login}):"unknown"===N.name?B.c4({environment:Z,url:c._j.root,redirect:!0}):"nativeTab"===N.name?D.o9(Z,N,W,n):"quickSearch"===N.name?await D.D_(Z,N,W):"chat"===N.name?D.dH(Z,N,W):"workspaceSetup"===N.name?D.yD(Z,N,W):"uniqueId"===N.name?await D.AL(Z,N.uniqueId):"signupForPlus"===N.name?((0,C.zQ)("plus"),B.c4({environment:Z,url:c._j.signup,redirect:!0})):"signupForBusiness"===N.name&&((0,C.zQ)("business"),B.c4({environment:Z,url:c._j.signup,redirect:!0}));l.kd(N)&&(D.td(Z,N,Y),D.OP(Z,N))}else B.c4({environment:Z,url:c._j.root,redirect:!0});else B.c4({environment:Z,url:c._j.root,redirect:!0})}function F(e){const t=f.T1(f.iO(window.location.href,e));window.history.replaceState(history.state,void 0,t)}},40468:(e,t,n)=>{n.d(t,{P:()=>c,T:()=>l});var o=n(33147),i=n(35683),r=n(97638),a=n(75754),s=n(21862);const l=new o.Z;function c(e){const{searchResult:t,environment:n,openInNew:o,pageVisitSource:l,queryId:c,openInSidePeek:d}=e,{store:u}=t,p=(0,r.dy)(t);void 0===p?s.r({store:u,openInNew:o,environment:n,pageVisitSource:l,queryId:c,openInSidePeek:d,peekMode:d?"s":void 0}):a._({environment:n,store:u,scrollToBlockId:p,openInNew:o,visitType:i.vu.Search,pageVisitSource:l,queryId:c,openInSidePeek:d,peekMode:d?"s":void 0})}},1357:(e,t,n)=>{n.d(t,{S:()=>b,d:()=>y});n(57658);var o=n(27328),i=n(72126),r=n(71644),a=n(99405),s=n(95477),l=n(18514),c=n(80444),d=n(3418),u=n(50906),p=n(19719),m=n(82530),f=n(39865),g=n(8055),h=n(40468);const v=function(e){return"web"===e.type&&"nativeTab"===e.route.name&&"search"===e.route.tab};function b(e){var t,n,d;const{environment:b,tab:y,navigationAction:_,navigationSource:S}=e,{TabbedRouterStore:w,currentUser:k}=b;if(!l.__(b))return;"updates"!==y&&p.nI(b);const I=w.state.activeTab,x=(0,o.w_)(w.state),C=i.Xh(w.state);C.activeTab=y,C.navigationAction=_,C.navigationSource=S,void 0!==e.nativeRootPageOverrideEnabled&&(C.tabs[C.activeTab].nativeRootPageOverrideEnabled=e.nativeRootPageOverrideEnabled);let T=!1;if(void 0!==e.pages){const t=e.pages.map((e=>{const t=(0,o.Gt)(e,!0),n=a.Wj({url:t,baseUrl:s.default.domainBaseUrl,publicDomainName:s.default.publicDomainName,isMobile:b.device.isMobile,protocol:s.default.protocol,currentUrl:window.location.href});return{...e,route:n}})),n=C.tabs[C.activeTab].pages;T=!i.Xy(n,t),C.tabs[C.activeTab].pages=t}if(v(x)&&!v((0,o.w_)(C))&&h.T.emit(Date.now()),w.setState(C),w.state.activeTab===I&&!T)return;const M=c.default.state.mainEditorCurrentBlockStore,P="web"===x.type&&(null===(t=x.redirectedTo)||void 0===t?void 0:t.route)&&"page"===(null===(n=x.redirectedTo)||void 0===n?void 0:n.route.name)&&(null===(d=x.redirectedTo)||void 0===d?void 0:d.route.showMoveTo),A=M&&(null==M?void 0:M.canEdit())&&M.isEmptyTitle()&&M.isEmptyPage();"addPage"===I&&P&&A&&k.isLoggedIn()&&m.createAndCommit({userAction:"routerActions.navigateToTab",environment:b,perform:e=>{f.y8({environment:b,blocks:[M],transaction:e}),e.postSubmitCallbacks.push((e=>{e||u.dhV(b,{analyticsName:"delete",from:"mobile_navigation",block_id:M.id,block_type:"page"})}))}});const R="addPage"===y,D=w.state.tabs[y],{rootPage:B,pages:E}=D;let F=!1;switch(B.type){case"native":break;case"web":if(0===E.length||R)g.c4({environment:b,redirect:!0,url:(0,o.Gt)(B,!0,{...e.queryParams,from:"mobile_bottom_bar"}),updateMobileTabbedRouterArgs:{restoringTab:!0}});else{F=!0;const e=(0,r.ZP)();window.history.replaceState({id:e,currentUserId:b.currentUser.id},void 0,(0,o.Gt)(B))}}if(R)return;const Z=!0===C.tabs[C.activeTab].nativeRootPageOverrideEnabled;E.forEach(((e,t)=>{if(!Z&&t===E.length-1)return void g.c4({environment:b,redirect:!F,url:(0,o.Gt)(e),updateMobileTabbedRouterArgs:{restoringTab:!0}});const n=(0,r.ZP)(),i=(0,o.Gt)(e);F?window.history.pushState({id:n,currentUserId:b.currentUser.id},void 0,i):(F=!0,window.history.replaceState({id:n,currentUserId:b.currentUser.id},void 0,i))}))}function y(e,t){var n,o;if(l.__(e))return e.device.isMobileNative&&e.device.isAndroid&&d.Z.closeAll(),b({environment:e,tab:"home",nativeRootPageOverrideEnabled:!0}),void(t&&t());Boolean(null===(n=e.mobileNative)||void 0===n?void 0:n.supportsNativeHomeOnPhone())&&(null===(o=e.mobileNative)||void 0===o||o.showNativeHomeTab(t))}},3898:(e,t,n)=>{n.d(t,{Nz:()=>g,uE:()=>p});var o=n(72126),i=n(21202),r=n(98165),a=n(52315),s=n(35328),l=n(80444),c=n(26136),d=n(15690),u=n(29373);function p(e){const t=e.state;return"page"===t.route.name&&t.route.scrollToBlockId?[t.route.scrollToBlockId]:t.historyState?t.historyState.blockIds:[]}function m(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:i.iU,id:t}))).map((e=>r.qA(e))).filter((t=>{let n=!1;const o=t.slice(1).find((e=>{if("block"===e.table)return e.isTransclusionType()&&(n=!0),e.isNavigableBlock()}));return o&&(o.id===e.id||n)})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>"block"===e.table&&(0,s.BX)(e)))}));return o.mN(o.xH(n),(e=>e.id))}(e,t);for(const o of n)u.rd({blockId:o.id,state:!0,currentUserId:o.environment.currentUser.id});return n}function f(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:i.iU,id:t,spaceId:e.pointer.spaceId}))).map((e=>r.qA(e))).filter((t=>{const n=t.slice(1).find((e=>"block"===e.table&&e.isNavigableBlock()));return n&&n.id===e.id})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>{if("block"!==e.table)return!1;const t=e.getParentStore();return"block"===(null==t?void 0:t.table)&&"tab"===(null==t?void 0:t.getType())}))}));return o.mN(o.xH(n),(e=>e.id))}(e,t);for(const o of n){const e=o.getParentStore();var a;if((null==e?void 0:e.table)===i.iU&&"tab"===(null==e?void 0:e.getType()))d.x2({store:e,id:o.id,currentUserId:null===(a=l.default.state.currentUserStore)||void 0===a?void 0:a.id})}return n}async function g(e,t){await async function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:i.iU,id:t})));await Promise.all(n.map((e=>r.s(e))))}(e,t);const n=o.mN([...m(e,t),...f(e,t)],(e=>e.id));await async function(e){await Promise.all(e.map((e=>a.r(e))))}(n)}},61045:(e,t,n)=>{n.d(t,{NQ:()=>j,Q7:()=>K,YC:()=>W,Zv:()=>U,_4:()=>z,aB:()=>Z,bx:()=>V,hQ:()=>q,hl:()=>L});var o=n(73935),i=n(14577),r=n(72126),a=n(68056),s=n(77546),l=n(89224),c=n(47372),d=n(3994),u=n(75987),p=n(95802),m=n(55521),f=n(96198),g=n(5162),h=n(34859),v=n(80796),b=n(64233),y=n(65686),_=n(19111),S=n(69454),w=n(19671),k=n(13023),I=n(88923),x=n(26136),C=n(27724),T=n(10743),M=n(24666),P=n(50906);function A(e,t,n,o){const i=(n-t)/n,r=o/10/60,a=r+(3*o/60-r)*Math.min(i*i,1);return e.device.isIOS?Math.ceil(a):a}const R=1e3,D=r.P2((e=>{P.PL5(e,{direction:"top"})}),R),B=r.P2((e=>{P.PL5(e,{direction:"bottom"})}),R),E=r.P2((e=>{P.PL5(e,{direction:"left"})}),R),F=r.P2((e=>{P.PL5(e,{direction:"right"})}),R);function Z(e){const{environment:t,scroller:n,currentMouseX:o,currentMouseY:i,verticalEdgeThreshold:r,horizontalEdgeThreshold:a,disableVerticalEdgeScroll:s,disableHorizontalEdgeScroll:l}=e,{clientRect:c,scrollTop:d,scrollHeight:u,scrollLeft:p,scrollWidth:m}=n.stores.store.state;if(c){if(n.props.type!==h.Z.X&&!s){const e=i-c.top;let o,a;S.Z.state.phase!==S.i.shown?(o=r,a=(0,g.Y)("supportsNativeBottomBarOverlappingWebView")?c.bottom-S.Z.estimatedNativeWebBottomOverlap()-i:c.bottom-i):(o=.25*S.Z.state.estimatedKeyboardWebViewOverlap,a=c.bottom-S.Z.estimatedNativeWebBottomOverlap()+o-i);const s=0===d,l=d+c.height===u;if(e<r&&!s){const o=A(t,e,r,c.height);n.scrollTo(d-o,void 0),o>0&&D(t)}if(a<o&&!l){const e=A(t,a,o,c.height);n.scrollTo(d+e,void 0),e>0&&B(t)}}if(n.props.type!==h.Z.Y&&!l){const e=o-c.left,i=c.right-o,r=0===p,s=p+c.width===m;if(e<a&&!r){const o=A(t,e,a,c.width);n.scrollTo(void 0,p-o),o>0&&E(t)}if(i<a&&!s){const e=A(t,i,a,c.width);n.scrollTo(void 0,p+e),e>0&&F(t)}}}}function V(e){const{element:t,scrollers:n,vertical:o,horizontal:i,animate:r}=e,a=t.getBoundingClientRect();if(o&&n.verticalScroller){const{reveal:e}=o,t=o.paddingToTopEdge||64,i=o.paddingToBottomEdge||64,s=n.verticalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.top+t,o=l.bottom-i,c=a.top>n&&a.top<o,d=a.bottom>n&&a.bottom<o,u=a.top<n&&a.bottom>o,p=a.bottom-o,m=a.top-n;"top"===e?c||s.scrollByOffset(m,0,{animate:r}):"bottom"===e?d||s.scrollByOffset(p,0,{animate:r}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(p,0,{animate:r}):s.scrollByOffset(m,0,{animate:r}))}}if(i&&n.horizontalScroller){const{reveal:e}=i,t=i.paddingToLeftEdge||64,o=i.paddingToRightEdge||64,s=n.horizontalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.left+t,i=l.right-o,c=a.left>n&&a.left<i,d=a.right>n&&a.right<i,u=a.left<n&&a.right>i,p=a.right-i,m=a.left-n;"left"===e?c||s.scrollByOffset(0,m,{animate:r}):"right"===e?d||s.scrollByOffset(0,p,{animate:r}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(0,p,{animate:r}):s.scrollByOffset(0,m,{animate:r}))}}}function j(e){const{component:t,horizontal:n,vertical:i,animate:r}=e;if(!t)return;const a=o.findDOMNode(t);return a&&a instanceof Element?V({vertical:i,animate:r,horizontal:n,element:a,scrollers:{verticalScroller:t.getContextVerticalScroller?t.getContextVerticalScroller():void 0,horizontalScroller:t.getContextHorizontalScroller?t.getContextHorizontalScroller():void 0}}):void 0}function U(){if(C.default.state.pivot)L([C.default.state.pivot.id]);else{L(C.default.state.stores.map((e=>e.id)))}}function L(e,t){const n=p.C.findScrollToSelectablesFromIds(e)[0];if(n){const{disableScrollToRevealHorizontal:e}=n.props;j({component:n,vertical:{reveal:"closest"},horizontal:e?void 0:{reveal:"closest"},animate:t})}}let O=function(e){return e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.natural=3]="natural",e}({});function N(e){let{position:t}=e;const{paddingTop:n}=e;if("editing"!==M.default.state.mode)return;let o=e.paddingBottom;c.Z.find((e=>e.props.show))&&(o+=f.O);const i=l.get();if(i){const e=s.SD(i.commonAncestorContainer);if(!e)return;const r=s.hI(e).find((e=>e.scrollHeight>e.clientHeight));if(!r)return;const a=l.getRect(i);if(!a||!r)return;const c=r.getBoundingClientRect();if(!(i.startContainer instanceof Text)){const e=a;e.top+=4,e.bottom-=5,e.height-=9}const d=a.top<c.top+n,u=a.bottom>c.bottom-o;if(i.startContainer instanceof Text&&i.startOffset!==i.endOffset)return;if(t===O.natural)if(u)t=O.bottom;else{if(!d)return;t=O.top}if(t===O.top){const e=r.scrollTop+a.top,t=c.top+n;r.scrollTop=e-t}else if(t===O.bottom){const e=r.scrollTop+a.bottom,t=c.bottom-o;r.scrollTop=e-t}else if(t===O.middle){const e=r.scrollTop+a.top,t=c.top+c.height/2-10;r.scrollTop=e-t}}}function z(){return S.Z.estimatedNativeWebBottomOverlap()+20}function W(e){if(u.Z.isInlineAutocompleteOpen())return!0;const t=e.device.isMobile&&(!e.device.isNative||e.device.isTablet);return!!(!t&&_.Z.state.open||!t&&T.Z.state.open||!t&&function(){var e;const t="editing"===M.default.state.mode&&(null===(e=(0,a.QY)(M.default.state.multiSelection))||void 0===e?void 0:e.store);if(t){const e=t.getRecordStoreAtRootPath();if(e instanceof x.G){const t=e.getValue(),n=t&&t.type;return"link_to_page"===n||"link_to_collection"===n}}return!1}()||b.Z.state.open)}function q(e){const t=d.Z.shouldPreventMobileAutoScroll(e);W(e)?N({position:O.top,paddingTop:20,paddingBottom:z()}):t||w.Z.state.isOpen&&!I.default.state.open||k.Z.state.isOpen||N({position:O.natural,paddingTop:20,paddingBottom:z()})}const H=r.IH((e=>{const{device:t}=e;return new i.Z((()=>t.isMobile&&v.Z.state.isDragging||t.isMobile&&m.Z.state.swiping?h.Z.All:y.Z.getPreventScrollType()),{debugName:"preventScrollTypeStore"})}));function K(e){return H(e).state}},87531:(e,t,n)=>{n.d(t,{IB:()=>w,Kf:()=>_,LR:()=>y,UT:()=>S,bn:()=>I,em:()=>k});var o=n(4615),i=n(89101),r=n(94804),a=n(70203),s=n(63594),l=n(81598),c=n(28344),d=n(56206),u=n(80444),p=n(21273),m=n(98180),f=n(22294),g=n(55320),h=n(29026),v=n(51787),b=n(8055);const y=6;function _(e){g.default.state.open?w(e.environment):S(e)}function S(e){const{environment:t,renderAsPage:n,isQuickSearch:a,isPublicPageSearch:s}=e,l=(0,o.ZP)(),d=Date.now();if(Boolean(a))g.default.setState({open:!1,openAsPage:!0,openedTimeMs:d,sessionId:l,isPublicPageSearch:s??!1,preferSidePeekOpen:(0,r.w8)(t.currentUser.id)});else if(Boolean(n))b.c4({environment:t,url:`${i.VP.nativeTab}/search`,redirect:!0}),g.default.setState({open:!1,openAsPage:!0,openedTimeMs:d,sessionId:l,isPublicPageSearch:s??!1,preferSidePeekOpen:(0,r.w8)(t.currentUser.id)});else{if(g.default.state.open)return;g.default.update((e=>({...e,open:!0,openAsPage:!1,isQuickSearch:!1,openedTimeMs:d,sessionId:l,isPublicPageSearch:s??!1,preferSidePeekOpen:(0,r.w8)(t.currentUser.id)})))}if(Boolean(e.doNotTrackOpenSearchEvent)||v.wF(e.environment,{from:e.analyticsFrom,searchSessionId:l}),"assistant"===h.ZP.state.mode){const t=m.Z.getActiveAssistantConfigurationState();if(t){const n=g.default.state.sessionId;c.trackQnAOpened(e.environment,{configurationState:t,from:"return_to_search",hasQuery:!1,runtimeState:m.Z.getActiveAssistantRuntimeState(),searchSessionId:n})}}}const w=e=>{if(g.default.state.open&&(g.default.reset(),f.Z.setKeyboardMode(!1),"assistant"===h.ZP.state.mode)){const t=m.Z.getActiveAssistantConfigurationState();t&&c.trackQnaClosed(e,{configurationState:t,runtimeState:m.Z.getActiveAssistantRuntimeState(),from:"search"})}};async function k(e){const{environment:t,shouldResetAssistantStore:n=!0}=e,o=u.default.state.mainEditorCurrentBlockStore??u.default.state.currentSpaceStore,i=h.ZP.state.query.text,r=g.default.state.sessionId;if(!o)return;const{assistantActions:f,assistantMenuActions:v}=await l.L6.loader();if(p.Z.isXMLAssistantEnabled(void 0)){if(i.length>y&&s.Z.state){const{sessionId:e}=await f.resetAndInitializeAssistantSession({environment:t});f.commitHumanStep({environment:t,text:(0,a.TPx)(i),sessionId:e})}else f.clearActiveAssistantSession({environment:t});w(t),v.openAssistantRightHandSideMenu({environment:t,from:void 0})}else{var b;let e=m.Z.getActiveSessionId();if(!e||n){e=(await f.resetAndInitializeAssistantSession({environment:t,primeTextInput:i.length<=y?i:void 0})).sessionId}d.d.state.open&&v.closeAssistantRightHandSideMenu(),h.ZP.update((e=>({...e,mode:"assistant"})));const o=i.length>y&&s.Z.state;o&&f.commitHumanStep({environment:t,text:(0,a.TPx)(i),sessionId:e});const l=null===(b=m.Z.getSessionContext(e))||void 0===b||null===(b=b.assistantConfigurationStore)||void 0===b?void 0:b.state;var _;if(l)c.trackQnAOpened(t,{configurationState:l,runtimeState:null===(_=m.Z.getSessionContext(e))||void 0===_||null===(_=_.assistantRuntimeStore)||void 0===_?void 0:_.state,hasQuery:o,from:"search",searchSessionId:r})}}function I(){g.default.update((e=>({...e,preferSidePeekOpen:!e.preferSidePeekOpen})))}},5851:(e,t,n)=>{n.d(t,{n:()=>f,y:()=>g});n(57658);var o=n(72126),i=n(97880),r=n(9291),a=n(33929),s=n(81918),l=n(54642),c=n(47307),d=n(9953),u=n(29974),p=n(82530);const m=(0,r.defineMessages)({saveFieldError:{id:"securitySAMLSettings.saveSettingsError.message",defaultMessage:"Something went wrong."}});function f(e,t){const{securitySettingsState:n,spaceStore:o}=t,{disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:h,disableTeamGuests:v,enableGuestInviteRequests:b}=n;return p.createAndCommit({userAction:"securitySettingsActions.saveSecuritySettings",environment:e,perform:t=>{u.Xr({environment:e,transaction:t,spaceStore:o,disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:Boolean(h),disableTeamGuests:v,enableGuestInviteRequests:b})}})}function g(e,t){const{securitySettingsStore:n,spaceStore:r,fields:u}=t,f={...n.state},g={...n.state,...u};n.setState(g),void 0!==u.disableGuests&&(l.updateDisableGuestsOnSpace(e,{spaceId:r.id,newDisableGuestsValue:u.disableGuests,keepExistingGuests:Boolean(u.keepExistingGuests)}).then((e=>{if("failed"===e.type)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)})),s.o8(e,{new_value:u.disableGuests,keep_existing_guests_if_disabled:Boolean(u.keepExistingGuests)})),p.createAndCommit({userAction:"SecuritySettings.saveToggle",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{if(e)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)}));const t=o.GM({disable_public_access:u.disablePublicAccess,disable_move_to_space:u.disableMoveToSpace,disable_export:u.disableExport,disable_space_page_edits:u.disableSpacePageEdits,disable_public_access_requests:u.disablePublicAccessRequests},(e=>o.kK(e)));d.sW({store:r,data:t,transaction:e});const s=o.GM({enable_guest_invite_requests:u.enableGuestInviteRequests,disable_membership_requests:u.disableMembershipRequests,disable_external_membership_requests:u.disableExternalMembershipRequests,disable_guest_membership_requests:u.disableGuestMembershipRequests},(e=>!(0,i.$K)(e)));Object.keys(s).length>0&&p.applyOperation({store:r,operation:{pointer:r.pointer,path:["settings"],command:"update",args:s},transaction:e})}}),(0,i.$K)(u.enableGuestInviteRequests)&&s.tB(e,{new_value:u.enableGuestInviteRequests})}},42858:(e,t,n)=>{n.d(t,{Ah:()=>me,Cl:()=>oe,DQ:()=>he,DV:()=>Se,MD:()=>X,Od:()=>J,QZ:()=>pe,Qw:()=>ne,VJ:()=>ge,WG:()=>ve,YP:()=>be,ZJ:()=>ye,aO:()=>ae,at:()=>le,bj:()=>te,dK:()=>ue,is:()=>ie,jQ:()=>fe,mp:()=>re,nG:()=>ce,uE:()=>_e,zO:()=>ee});n(57658),n(21703),n(52262),n(24506);var o=n(1302),i=n(15145),r=n(41432),a=n(72126),s=n(21202),l=n(23867),c=n(63143),d=n(9291),u=n(75754),p=n(91851),m=n(97496),f=n(95477),g=n(19037),h=n(28020),v=n(78316),b=n(77181),y=n(40959),_=n(35683),S=n(33929),w=n(65598),k=n(41984),I=n(58202),x=n(95802),C=n(80444),T=n(77080),M=n(88923),P=n(26136),A=n(27724),R=n(34583),D=n(81193),B=n(54642),E=n(30188),F=n(41433),Z=n(47307),V=n(54532),j=n(54604),U=n(94419),L=n(19785),O=n(99553),N=n(8055),z=n(61045),W=n(24677),q=n(84084),H=n(64964),K=n(15690),G=n(98104),$=n(82530),Q=(n(68422),n(1742));const Y=(0,d.defineMessages)({deletePages:{id:"action.deletePages.snackBarMessage",defaultMessage:"Moved to trash"}});function J(e){var t,n;const{store:o,transaction:i}=e,r=x.C.findSelectablesFromStore(o).find((e=>Boolean(e.props.onRemove)));null==r||null===(t=(n=r.props).onRemove)||void 0===t||t.call(n,{transaction:i})}function X(e){const{blocks:t,transaction:n}=e;if(1===t.length){const e=t[0];e&&w.PF(e)&&J({store:e,transaction:n})}}function ee(e){const t=x.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!0})}function te(e){const t=x.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!1})}async function ne(e){const{environment:t,blocks:n}=e;let o=!0;const i=[];for(const s of n){const e=I.R.findBlockFromStore(s);if(e&&a.mf(e.handleRemoveBlockFromComment)){if(await e.handleRemoveBlockFromComment())continue}else if(e&&a.mf(e.canRemoveBlock)){const t=await e.canRemoveBlock();if(!t.canRemove)return;o=t.canUndo}const n=await p.NN({environment:t,block:s,action:"delete"});if("user_canceled"===n)return;n.length>1?i.push(...n):i.push(s)}if(0===i.length)return;if(T.default.checkGate("collection_subitem_nested_operations")){if(!(await E.VP({environment:t,blocks:i,canUndo:o})))return}else{const{serverCommitResult:e}=$.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:t,canUndo:o,perform:e=>{oe({environment:t,blocks:i,transaction:e})}});await e}const{currentSpaceStore:r}=C.default.state;r&&i.some((e=>e.isPageBlock()))&&H.d4({item:{label:S.default.formatMessage(Y.deletePages)},undoFunc:()=>{for(const e of i)B.restoreBlock(t,{pointer:{table:s.iU,id:e.id,spaceId:e.pointer.spaceId||r.id}})}}),i.some((e=>{var t;return e.id===(null===(t=M.default.peekTarget.state)||void 0===t?void 0:t.id)}))&&O.xv(t,void 0)}function oe(e){const{environment:t,blocks:n,transaction:o,preventClearSelection:i}=e,s=n[0],d=function(e){const t=x.C.getMembersByDOMOrder({filter:()=>!0}),n=a.cx(t,(t=>t.props.store===e)),o=t[n];if(!o)return;const i=o.getContextSelectableContainer(),r=a.tP(t,0,n),s=a.dF(r,(e=>e.props.canSelect&&e.getContextSelectableContainer()===i));if(s)return s.props.store;const l=a.tP(t,n+1).find((e=>Boolean(e.props.canSelect&&e.getContextSelectableContainer()===i)));if(l)return l.props.store}(s);!function(e){const{environment:t,block:n,entryPointName:o}=e,i=new Q.GD({environment:t,userFlow:"user_flow_delete_block",entryPointName:o,timeoutMs:90*c.C0});if(i.isDisabled())return;const r=()=>{n.pathIsDead()&&i.succeed()};i.postFinishCallbacks.push((()=>{n.removeListener(r)})),n.addListener(r)}({environment:t,block:s,entryPointName:o.getUserActionForAnalyticsPurposesOnly()||"selectableBlockActions.removeBlocks"});for(const r of n)J({store:r,transaction:o});if(i||(W.ZH(t),W.Fp({pivot:d})),g._J({environment:t,blocks:n,publicEditMode:void 0})||g.Nn({environment:t,blocks:n,publicEditMode:void 0})||g.oY({environment:t,blocks:n,publicEditMode:void 0})||n.some((e=>{var t;return e.getType()===r.Ti.transclusionContainer||(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))){o.postSubmitCallbacks.push((e=>{e||B.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,l.C)(e.pointer.spaceId)}))),permanentlyDelete:!1})}));for(const e of n){const{app_id:n,app_config_uri:i}=e.getFormat();n&&i&&D.Cu(t,{block_id:e.id,app_id:n,app_config_uri:i}),L.zo({block:e,transaction:o})}N.CZ({environment:t,blocks:n})}i||G.ZH(t)}function ie(e){const{environment:t,blocks:n,selection:o,transaction:i,replaceEmptyTextBlock:r,preventSetSelection:s,insertAfterBlock:l}=e,c=h.RM();if(!c)throw new Error("No root store.");let d;if(o.length>0){const e=l||o.at(-1);let s=e;if(Boolean(n.find((e=>e.isType("column_list"))))){const t=null==e?void 0:e.findRecordStoreUIAncestor((e=>e&&e instanceof P.G&&e.isType("column_list"))).ancestor;t&&t instanceof P.G&&(s=t)}const u=x.C.find((e=>e.props.store===s&&e.props.canInsertBelow&&e.props.onInsertBelow));if(u&&u.props.onInsertBelow)d=a.oA(u.props.onInsertBelow({insertStores:n,transaction:i})),r&&e&&e.isEmptyTextBlock()&&oe({environment:t,blocks:[e],transaction:i});else{d=a.d9(n).reverse().map((e=>U.Ce({parent:c.getContentStore(),prepend:e,transaction:i}).child))}}else if(c.isCollectionView()){const e=I.R.findBlockFromStoreWithMethod(c,"insertBlocks");if(!e)throw new Error("No collection view found.");d=e.insertBlocks(n,i)}else{const e=c.getContentStore();d=n.map((t=>U.R3({parent:e,append:t,transaction:i}).child))}return Boolean(s)||(d=d.flatMap((e=>e.isType("column_list")?e.getContentStores().flatMap((e=>e.getContentStores())):[e])),W.Z5({environment:t,stores:d})),d}function re(e){const{blocks:t}=e,n=t[0];if(n){const t=x.C.findSelectableFromStore(n);t&&t.props.onEnter&&t.props.onEnter(e)}}function ae(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r,preventSetSelection:a}=e,s=A.default.getCurrentRecordCache(),l=new Q.BW({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let c;if(R.M_(t)&&n&&s){var d;const e=F.fC({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:s,from:r,useCrdt:0!==o.length?o[0].useCrdt():(null===(d=h.RM())||void 0===d?void 0:d.useCrdt())??!1});l.track(e.pointer,i),c=ie({environment:t,blocks:[e],selection:o,transaction:i,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else l.fail("invalid_state");return c}function se(e){const{environment:t,createBlockItem:n,selection:o,transaction:i,analyticsFrom:r}=e,a=A.default.getCurrentRecordCache();let s;if(R.M_(t)&&n&&a){var l;s=function(e){const{environment:t,selection:n,transaction:o}=e,{blocks:i}=e,r=h.RM();if(!r)throw new Error("No root store.");if(n.length>0){const e=n[0],r=x.C.find((t=>t.props.store===e&&t.props.canInsertAbove&&t.props.onInsertAbove));if(!r||!r.props.onInsertAbove)throw new Error("No Selectable found.");const a=r.props.onInsertAbove({insertStores:i,transaction:o});return W.Z5({environment:t,stores:a}),a}{const e=r.getContentStore(),n=i.map((t=>U.R3({parent:e,append:t,transaction:o}).child));return W.Z5({environment:t,stores:n}),n}}({environment:t,blocks:[F.fC({environment:t,createBlockItem:n,transaction:i,inMemoryRecordCache:a,from:r,useCrdt:0!==o.length?o[0].useCrdt():(null===(l=h.RM())||void 0===l?void 0:l.useCrdt())??!1})],selection:o,transaction:i})[0]}return s}function le(e){const{environment:t,selection:n,transaction:o}=e,i=ae({...e,preventSetSelection:!0});i&&Se({environment:t,insertedStores:[i],isCreated:!0}),X({transaction:o,blocks:n})}async function ce(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:i}=e;if(!R.M_(t))return;let r=n;if(1===n.length){const e=await p.NN({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return;r=e}const a=T.default.checkGate("collection_subitem_nested_operations"),s=r.at(0);if(!s)return;const l=(0,v.fm)(s);a&&(0,b.wP)(s,l)?await E.W9({blocks:r,environment:t}):$.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,perform:e=>{de({environment:t,blocks:r,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:i})},transactionTooBigFallback:e=>{de({environment:t,blocks:r,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:i})}}),o.default.afterNextFlush((()=>{z.Zv()}))}function de(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:i,lastTopLevelBlock:r,preventSetSelection:s,duplicateOnlyCollectionSchema:c}=e,d=a.vM(n,(e=>e.getFormat().app_id??e.id)),u=[];return a.Ed(d,(e=>{const r=e[0],a=!r.isTransclusionType(),[s,d]=V.Qi({environment:t,stores:e,addCopyName:(0,k.Z)(r),transaction:o,deepCopyTransclusionContainers:a,resolveTemplateVariables:!(r.isInsideTemplate()||r.isInsideFactoryOrDuplicateBlocksAction()),targetSpaceId:(0,l.C)(r.pointer.spaceId),baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,preferDuplicateLocation:i,useCrdt:0!==n.length&&n[0].useCrdt(),duplicateOnlyCollectionSchema:c});u.push(...s),d.then((e=>{e&&Z.showErrorMessage(e)}))})),ie({environment:t,blocks:u,selection:r?[r]:n,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:s}),u}function ue(e){const t=e.blocks[0],{blockLocationOfTargetBlock:n}=e,o=I.R.find((e=>e instanceof m.ZP&&e.props.store===t&&(!n||e.props.blockLocation===n)));o&&o.canRenderFullScreen()&&j.ui({environment:o.environment,renderFullScreenNode:o.renderFullScreenNode,fullScreenNodeRect:o.getFullScreenNodeRect(),block:t})}function pe(e){let t;e.blocks.find((e=>{const n=I.R.findBlockFromStoreWithMethod(e,"activate");return!!n&&(t=n,!0)})),t&&t.activate()}function me(e){e.blocks.forEach((t=>{const n=t.getParentStore();n&&n.table===s.iU&&n.getType()===r.Ti.tab&&K.x2({store:n,id:t.id,currentUserId:e.environment.currentUser.id})}))}function fe(e){const t=e.blocks[0],n=I.R.findBlockFromStoreWithMethod(t,"configure");n&&(n.configure(),D.PE(e.environment,{from:"block_action"}))}function ge(e){const t=e.blocks[0],n=I.R.findBlockFromStoreWithMethod(t,"caption");n&&n.caption()}function he(e,t){const n=a.oA(x.C.findSelectablesFromIds(t)).map((e=>e.props.store));W.Z5({environment:e,stores:n})}function ve(e,t){const n=x.C.findScrollToSelectablesFromIds(t);n[0]&&(z.NQ({component:n[0],vertical:{reveal:"top"},horizontal:{reveal:"closest"}}),W.Z5({environment:e,stores:n.map((e=>e.props.store))}))}function be(e){const{environment:t,blocks:n}=e,o=n[0].findRecordStoreUIAncestor((e=>e instanceof P.G&&e.isCollectionView())).ancestor;o&&u._({environment:t,store:o,visitType:_.vu.Link,pageVisitSource:i.tY.Expand})}function ye(e){const{blocks:t,transaction:n,environment:i}=e,r=ae({environment:i,selection:t,createBlockItem:y.Hc.text,analyticsFrom:"text_insert_below",transaction:n});return r&&o.default.afterNextFlush((()=>{q.hb({environment:i,blockStore:r})})),r}function _e(e){const{blocks:t,transaction:n,environment:i}=e,r=se({environment:i,selection:t,createBlockItem:y.Hc.text,analyticsFrom:"text_insert_above",transaction:n});return r&&o.default.afterNextFlush((()=>{q.hb({environment:i,blockStore:r})})),r}function Se(e){const{environment:t,insertedStores:n,isCreated:i}=e;i?o.default.afterNextFlush((()=>{const e=n[0];if(!e)return;const o=I.R.findBlockFromStoreWithMethod(e,"handleCreated");o?o.handleCreated():(W.Ys({environment:t,store:e}),W.Db(t))})):W.Z5({environment:t,stores:n})}},24677:(e,t,n)=>{n.d(t,{$Y:()=>E,Af:()=>F,Ch:()=>ee,DI:()=>K,Db:()=>O,FC:()=>$,Fp:()=>Z,Jy:()=>X,KX:()=>M,OS:()=>R,Ys:()=>U,Z5:()=>j,ZH:()=>z,aw:()=>B,e2:()=>H,eP:()=>L,hn:()=>J,ji:()=>A,td:()=>Q,w5:()=>Y,wI:()=>V,yu:()=>N,zJ:()=>W});n(57658);var o=n(55010),i=n(1302),r=n(72126),a=n(95371),s=n(77181),l=n(28314),c=n(69645),d=n(35328),u=n(27406),p=n(16339),m=n(95802),f=n(41662),g=n(12211),h=n(50628),v=n(27724),b=n(45131),y=n(14900),_=n(30188),S=n(89951),w=n(67060),k=n(61045),I=n(84084),x=n(98104),C=n(29373),T=n(82530);function M(){const e=v.default.getCurrentDefaultContainer();if(e){return m.C.getMembersByDOMOrder({filter:t=>t.getContextSelectableContainer()===e&&t.props.canSelect}).map((e=>e.props.store))}return[]}function P(e){const t=v.default.state.stores,n=v.default.state.pivot,o=r.oA(r.zu(t,n));let i;i=n===r.Z$(t)?t[t.length-2]:t[1],j({environment:e,stores:o,pivot:i})}function A(e){const t=l.yA();return e.device.isMac?t.shift&&t.command:t.shift&&t.option}function R(){return l.yA().shift}function D(e){e.sort(((e,t)=>(0,o.Z)(m.C.findNodeFromStore(e),m.C.findNodeFromStore(t))))}function B(e){const t=new Array(e.length);return m.C.forEach((n=>{if(n.props.canSelect){const o=e.indexOf(n.props.store);if(o>=0){const e=n.getNode();e&&(t[o]=e)}}})),e.filter(((n,o)=>{const i=t[o];return n&&!e.some(((e,n)=>{const o=t[n];return Boolean(o&&o!==i&&i&&o.contains(i))}))}))}function E(e){v.default.setState({...v.default.state,phase:e.phase}),e.phase===v.SelectionPhase.Editing||e.preventClearEditingText||x.ZH(e.environment)}function F(e){const{stores:t}=e,n=v.default.state.stores,o=r.G0(t,n);o.length===t.length&&o.length===n.length||v.default.setState({...v.default.state,stores:e.stores}),t.length>0&&(y.wG(),f.g$.blockSelectionInSimpleTable(t)||f.HM.clearSelection())}function Z(e){v.default.setState({...v.default.state,pivot:e.pivot})}function V(e){const{stores:t}=v.default.state;F({stores:t.map((t=>t===e.store?e.replace:t))})}function j(e){const{environment:t}=e,n=B(e.stores);F({stores:n}),E({environment:e.environment,phase:e.phase||v.SelectionPhase.Selected}),1===n.length&&function(e){var t;const n=e.anchor,o=null===(t=m.C.findSelectableFromStore(n))||void 0===t?void 0:t.getNode();let i;o&&(i=v.default.getDefaultContainerFromTarget(o)),v.default.setState({...v.default.state,anchor:n,anchorContainer:i})}({anchor:n[0]});const o=e.pivot||n[0];if(Z({pivot:o}),i.default.afterNextFlush((()=>{D(n)})),e.phase===v.SelectionPhase.Editing&&o)if(t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=m.C.findScrollToSelectableFromStore(o);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function U(e){void 0===e.toggle&&(e.toggle=!1),void 0===e.selectBetween&&(e.selectBetween=!1);const{stores:t}=v.default.state;if(e.toggle)r.q9(t,e.store)?j({environment:e.environment,stores:r.zu(t,e.store)}):j({environment:e.environment,stores:r.G0(t,[e.store])});else if(e.selectBetween){let n=r.d9(t);const o=M(),i=o.indexOf(e.store);r.q9(n,e.store)||n.push(e.store);const a=t[0];if(a){const e=o.indexOf(a);if(e>=0){const t=r.tP(o,i,e);n=r.G0(n,t)}}const s=r.Z$(t);if(s){const e=o.indexOf(s);if(e>=0){const t=r.tP(o,e,i);n=r.G0(n,t)}}j({environment:e.environment,stores:n})}else r.q9(t,e.store)||j({environment:e.environment,stores:[e.store]});E({environment:e.environment,phase:v.SelectionPhase.Selected})}function L(e){const{environment:t,store:n}=e;if(n)if(F({stores:[n]}),Z({pivot:void 0}),E({environment:t,phase:v.SelectionPhase.Editing}),t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=m.C.findScrollToSelectableFromStore(n);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function O(e){const{stores:t}=v.default.state,n=t[0];if(!n)return;const o=m.C.findSelectableFromStore(n);if(o&&o.props.onEditText){const t=o.props.onEditText;T.createAndCommit({userAction:"selectionActions.editSelection",environment:e,perform:e=>{t({isAtStartOfLine:!1,isClick:!1,transaction:e})}})}}function N(e){const{environment:t,stores:n}=e,o=r.Z$(n);if(!o)return;const i=m.C.findSelectableFromStore(o);if(i&&i.props.onEditText){const e=i.props.onEditText;T.createAndCommit({userAction:"selectionActions.editStoresAtEnd",environment:t,perform:t=>{e({isAtStartOfLine:!1,isClick:!1,transaction:t})}})}}function z(e){F({stores:[]}),E({environment:e,phase:v.SelectionPhase.Selected}),w.xv(),I.xv(),S.xv()}function W(e){const{environment:t}=e,n=v.default.state.stores;D(n);const o=v.default.state.pivot,i=n[0];if(i)if(e.shiftKey)if(o===i){const o=(0,c.Bj)({includeNonSelectableListContainer:!1}),s=(0,c.v5)(i,o.children),{prev:l,parent:d}=e.altKey?(0,a.Sr)(o,s):(0,a.YL)(o,s);if(l){const e=l.value.store;j({environment:t,stores:r.G0(n,[e]),pivot:e})}else if(d){const e=d.value.store;j({environment:t,stores:r.G0(n.filter((e=>!(0,a.Yz)(d,(t=>t.store===e)))),[e]),pivot:e})}}else P(e.environment);else{const n=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(i,n.children),{prev:r,parent:s}=e.altKey?(0,a.Sr)(n,o):(0,a.YL)(n,o);if(r){const e=r.value.store;j({environment:t,stores:[e],pivot:e})}else if(s){const e=s.value.store;j({environment:t,stores:[e],pivot:e})}else j({environment:t,stores:[i],pivot:i})}else if(o)j({environment:t,stores:[o]});else{const e=M(),n=r.Z$(e);n&&j({environment:t,stores:[n],pivot:n})}q()}function q(){const e=v.default.state.pivot||v.default.state.stores[0],t=m.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"top"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}function H(e){const t=v.default.state.stores;D(t);const n=v.default.state.pivot;if(0!==t.length&&n)if((0,d.BX)(n)&&b.Z.isOpen(n.id))j({environment:e,stores:[n],pivot:n}),C.rd({blockId:n.id,state:!1,currentUserId:e.currentUser.id});else if((0,s.bX)(n))_.e2(n);else{const t=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(n,t.children),i=(0,a.ub)(o);if(i){const t=i.value.store;j({environment:e,stores:[t],pivot:t})}else j({environment:e,stores:[n],pivot:n})}else if(n)j({environment:e,stores:[n]});else{const t=M(),n=r.Z$(t);n&&j({environment:e,stores:[n],pivot:n})}q()}function K(e){const{environment:t}=e,n=v.default.state.stores;D(n);const o=v.default.state.pivot,i=r.Z$(n);if(i)if(e.shiftKey)if(o===i){const e=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(i,e.children),{next:s}=(0,a.Xf)(e,o);if(s){const e=s.value.store;j({environment:t,stores:r.G0(n,[e]),pivot:e})}}else P(t);else{const n=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(i,n.children),{next:r}=e.altKey?(0,a.Xf)(n,o):(0,a.lj)(n,o);if(r){const e=r.value.store;j({environment:t,stores:[e],pivot:e})}else j({environment:t,stores:[i],pivot:i})}else if(o)j({environment:t,stores:[o]});else{const e=M()[0];e&&j({environment:t,stores:[e],pivot:e})}G()}function G(){const e=v.default.state.pivot||r.Z$(v.default.state.stores);if(e){const t=m.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function $(e){const t=v.default.state.stores;D(t);const n=v.default.state.pivot;if(0!==t.length&&n)if((0,d.BX)(n)&&!b.Z.isOpen(n.id))j({environment:e,stores:[n],pivot:n}),C.rd({blockId:n.id,state:!0,currentUserId:e.currentUser.id});else if((0,s.bX)(n))_.FC(n);else{const t=(0,c.Bj)({includeNonSelectableListContainer:!1}),o=(0,c.v5)(n,t.children),i=(0,a.si)(o);if(i){const t=i.value.store;j({environment:e,stores:[t],pivot:t})}else j({environment:e,stores:[n],pivot:n})}else if(n)j({environment:e,stores:[n]});else{const t=M()[0];t&&j({environment:e,stores:[t],pivot:t})}G()}function Q(e){const t=M();j({environment:e,stores:t,pivot:t[0]})}function Y(e){const t=M()[0];if(t){j({environment:e,stores:[t],pivot:t});const n=m.C.findScrollToSelectableFromStore(t);n&&k.NQ({component:n,vertical:{reveal:"top"},horizontal:n.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function J(e){const t=M(),n=t[t.length-1];if(n){j({environment:e,stores:[n],pivot:n});const t=m.C.findScrollToSelectableFromStore(n);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function X(){const e=performance.now(),t=new Map,n=new Map;m.C.forEach((e=>{const o=e.getNode();if(o&&o instanceof Element){const i=o.getBoundingClientRect();t.set(e,i),n.set(o,i)}}));const o=new Map;p.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&o.set(e,t.getBoundingClientRect())}));const i=new Map;u.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&i.set(e,t.getBoundingClientRect())})),h.Z.setState({...h.Z.state,selectableRectMap:t,selectableContainerRectMap:o,selectableElementRectMap:n,lastUpdate:e}),g.Z.setState({...g.Z.state,dropTargetRectMap:i})}const ee=r.P2(X,200)},84084:(e,t,n)=>{n.d(t,{RL:()=>_,_P:()=>b,hb:()=>y,xv:()=>S});var o=n(13991),i=n(70203),r=n(69783),a=n(73959),s=n(89224),l=n(95802),c=n(64233),d=n(19111),u=n(10743),p=n(50906),m=n(24677),f=n(993),g=n(98104);const h=new Set(["/","ï¼"]),v={"ja-JP":new Set(["ï¼›"])};function b(e){const{environment:t,textStore:n,oldSelection:a,oldTextValue:l}=e,m=i.eeV(n.getValue()||[]),f=a.startIndex,g=m[f],b=v[o.SP]||new Set;if(!h.has(g)&&!b.has(g))return;const y=i.gPn(m,f-10,f).join("");if(/[0-9]$/.test(y[y.length-1]))return;if(y.endsWith("http:")||y.endsWith("http:/")||y.endsWith("https:")||y.endsWith("https:/"))return;if(u.Z.state.open||r.Z.state.open||d.Z.state.open||c.Z.state.open)return;if(t.device.isPhone)return;const _=s.get();if(!_)return;const S=s.getRect(_);S&&(u.Z.setState({open:!0,isAddMenu:!1,textStore:n,oldTextValue:l,oldSelection:a,selectionRect:S,lettersAtLastResult:0,filter:""}),p.V_i(t))}function y(e){const{environment:t,blockStore:n}=e,o=u.Z.state;if(m.eP({environment:t,store:n}),g.N_({store:n.getBlockTitleStore()}),!o.open&&!t.device.isPhone){const e=n.getBlockTitleStore(),t=l.C.getRectFromStore(n);t&&u.Z.setState({open:!0,isAddMenu:!0,textStore:e,oldTextValue:e.getValue(),oldSelection:{startIndex:0,endIndex:0},selectionRect:t,lettersAtLastResult:0,filter:""})}}function _(e){const{transaction:t,environment:n}=e,o=u.Z.state;if(o.open){const{textStore:e,oldTextValue:i,oldSelection:r}=o;f.sO({environment:n,store:e,value:i,transaction:t}),S();const s=(0,a.sQ)(e);s&&m.eP({environment:n,store:s}),g.Z5({store:e,selection:r})}}function S(){u.Z.setState({open:!1,previousFilter:u.Z.state.open?u.Z.state.filter:void 0})}},64964:(e,t,n)=>{n.d(t,{C1:()=>d,d4:()=>c,oV:()=>s,rN:()=>l});n(67294);var o=n(71644),i=n(6854),r=n(1310),a=n(85893);function s(e){const t={...e,key:(0,o.ZP)()};r.ZP.setState({...r.ZP.state,currentItem:t}),"keep"!==t.durationMs&&setTimeout((()=>{r.ZP.state.currentItem===t&&"keep"!==r.ZP.state.currentItem.durationMs&&r.ZP.setState({...r.ZP.state,currentItem:void 0})}),t.durationMs??r.Ty)}function l(){r.ZP.setState({...r.ZP.state,currentItem:void 0})}function c(e){const{item:t,undoFunc:n}=e;s({...t,right:(0,a.jsx)(i.ow,{onUndo:n})})}function d(){r.ZP.state.shouldReset&&r.ZP.reset()}},29974:(e,t,n)=>{n.d(t,{$F:()=>be,BR:()=>_e,F1:()=>ge,IY:()=>Me,L5:()=>he,LV:()=>Ne,Ns:()=>Te,O2:()=>Ae,OF:()=>we,Xr:()=>ke,Xv:()=>Be,Y5:()=>Ve,Yi:()=>ve,Yj:()=>Le,_Q:()=>Ee,_u:()=>Se,bf:()=>Ce,cU:()=>Oe,ce:()=>me,eX:()=>pe,j:()=>xe,jF:()=>De,lF:()=>Pe,mo:()=>Re,oy:()=>Fe,sw:()=>Ue,u3:()=>ye,wg:()=>je,wh:()=>ue,y3:()=>fe,ys:()=>Ie});n(21703),n(57658),n(67294);var o=n(15145),i=n(68626),r=n(72126),a=n(91155),s=n(72141),l=n(4615),c=n(45953),d=n(21202),u=n(15047),p=n(77858),m=n(29369),f=n(66079),g=n(62965),h=n(90965),v=n(54153),b=n(97880),y=n(9291),_=n(75754),S=n(81598),w=n(95477),k=n(77472),I=n(15010),x=n(33929),C=n(67669),T=n(38755),M=n(95697),P=n(55081),A=n(10929),R=n(30806),D=n(94841),B=n(78861),E=n(80444),F=n(21273),Z=n(88632),V=n(73329),j=n(69327),U=n(81236),L=n(26136),O=n(34583),N=n(70060),z=n(33493),W=n(60027),q=n(50906),H=n(91536),K=n(81918),G=n(54642),$=n(35253),Q=n(47307),Y=n(57400),J=n(94273),X=n(94419),ee=n(92625),te=n(29533),ne=n(76464),oe=n(9953),ie=n(4408),re=n(5851),ae=n(28014),se=n(82530),le=n(70782),ce=n(85893);const de=(0,y.defineMessages)({deletingWorkspace:{id:"spaceActions.deletingWorkspace.loadingMessage",defaultMessage:"Deleting workspaceâ€¦"},goOnlineCreateSpace:{defaultMessage:"Please go online to create your workspace.",id:"spaceActions.dialogError.createWorkspaceError.goOnline.message"},createSpaceError:{defaultMessage:"Sorry! We could not create your workspace. Please try again.",id:"spaceActions.dialogError.createWorkspaceError.message"},loginToCreateSpace:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.createWorkspaceError.notLoggedIn.message"},moveToSpaceOnlineError:{defaultMessage:"Please go online to move content to another space.",id:"spaceActions.dialogError.moveContentError.goOnline.message"},cannotMoveShardRestriction:{defaultMessage:"Cannot move these pages at once.",id:"spaceActions.dialogError.moveContentError.cannotMovePages.message"},cannotMoveContent:{defaultMessage:"Sorry! We could not move this content. Please try again.",id:"spaceActions.dialogError.couldNotMoveContentError.message"},loginToMoveContent:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.movetoWorkspace.notLoggedIn.message"},invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnNavigate:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.navigateToWorkspace.invalidStorage.message"},noSpaceViewOnJoin:{defaultMessage:"No space view data was created.",id:"spaceActions.dialogError.joinWorkspace.invalidWorkspaceStorage.message"},noLocalDataForPermissionGroup:{defaultMessage:"No local data about this workspace.",id:"spaceActions.dialogError.createOrUpdatePermissionGroup.invalidWorkspaceStorage.message"}});async function ue(e){const{environment:t,name:n,domain:o,userRootStore:a,emailDomains:s,analyticsFrom:l,icon:c,planType:d,userPersona:g,shouldCreateUserPersonaTeam:h,shouldMakeUserPersonaTeamDefault:v}=e,{id:b}=t.currentUser;if(b){const e=await G.createSpace(t,{name:n,domain:o,emailDomains:s,icon:c,planType:d,initialPersona:g,shouldCreateUserPersonaTeam:h,shouldMakeUserPersonaTeamDefault:v});if("failed"===e.type){if(e.offline)throw new Error(x.default.formatMessage(de.goOnlineCreateSpace));throw new Error(x.default.formatMessage(de.createSpaceError))}const{spaceId:y,teamId:_,personaTeamId:S,inviteLinkCode:w}=e.data,k=new L.H2(t,{table:u.bx,id:y}),C=_?L.zX.createChildStore(k,{table:m.e0,id:_}):void 0,T=S?L.zX.createChildStore(k,{table:m.e0,id:S}):void 0,{serverCommitResult:M,performResult:{spaceViewStore:P}}=se.createAndCommit({userAction:"spaceActions.createSpace",environment:t,perform:e=>{const n=oe.ae({environment:t,table:p.zU,value:{space_id:k.id,notify_mobile:!0,notify_desktop:!0,notify_email:!0,parent_id:b,parent_table:f.dx,alive:!0,joined:!0,joined_teams:(C||T)&&r.oA([null==C?void 0:C.id,null==T?void 0:T.id]),settings:{notify_email_digest:!0}},inMemoryRecordCache:a.inMemoryRecordCache,transaction:e}),o=new L.V9(t,n.pointer);return X.R3({parent:a.getSpaceViewsStore(),append:n,transaction:e}),X.MK({parent:a.getSpaceViewPointersStore(),append:n,transaction:e}),t.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.createSpace setting space"}}),E.default.setState({...E.default.state,currentSpaceStore:k,currentSpaceViewStore:o}),K.VT(t,{from:l,planType:d,isProfessionalTeamUser:(0,I.QZ)(),domain_type:(0,I.JF)()}),{spaceViewStore:o}}});return await M,await Y.Yh(t),{spaceViewStore:P,spaceStore:k,inviteLinkCode:w,teamStore:C,personaTeamStore:T}}throw new Error(x.default.formatMessage(de.loginToCreateSpace))}async function pe(e){const{environment:t,blockStores:n,spaceId:o,targetParent:s}=e,{id:l}=t.currentUser;if(l){if(!Z.Z.state.online)return{error:x.default.formatMessage(de.moveToSpaceOnlineError)};const e=[],m=[];for(const t of n)t.isDefined()&&(e.push({id:t.id,spaceId:t.getSpaceId()}),m.push(o));if(r.jj(m).length>1)return{error:x.default.formatMessage(de.cannotMoveShardRestriction)};if(s&&s.spaceId!==o)return{error:x.default.formatMessage(de.cannotMoveShardRestriction)};const f=G.moveToSpace(t,{blocks:e,targetSpaceId:o,targetParent:s,clearPermissions:(0,M.bq)()});let g;for await(const n of f){if(te.R(n,o),n.error)return k.j(t,"move_to_space_error",{}),i.log({level:"error",from:"spaceActions",type:"moveSpaceError",error:(0,a.Ui)(n.error),data:{userId:l,blocks:e,spaceId:o}}),{error:x.default.formatMessage(de.cannotMoveContent)};{const e=c.PF.create(n.value.recordMap).getByTable(d.iU);for(const{value:t}of e){var u,p;if("copy_indicator"===(null==t||null===(u=t.value)||void 0===u?void 0:u.type))g=null==t||null===(p=t.value)||void 0===p?void 0:p.id}}}return te.h(o),{value:g}}return{error:x.default.formatMessage(de.loginToMoveContent)}}async function me(e){const{environment:t,spaceViewStore:n,openInNew:o,isNewlyCreatedSpace:r,leavingSpace:a}=e;await n.awaitNonNullValue();const s=n.getSpaceStore();if(!s)throw new Error(x.default.formatMessage(de.invalidSpaceStoreOnNavigate));if(!o&&($.qL({bannerStore:V.Z,id:"SubscriptionEditingBlocker"}),t.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.switchToSpace",spaceId:s.id}}),E.default.setState({...E.default.state,currentSpaceStore:s,currentSpaceViewStore:n}),a)){const e=await(0,T.rg)(t,n);E.default.setState({...E.default.state,mainEditorCurrentBlockStore:e})}z.Z.reset();const l=t.currentUser.id,c=n.getUserRootParentId();if(c&&l!==c){const e=await le.x({environment:t,newCurrentUserId:c});await O.OR({environment:e,spaceId:s.id,isNewlyCreatedSpace:r});const{currentUserSettingsStore:n,currentUserRootStore:o}=E.default.state;return{switchedUser:!0,newEnvironment:e,newUserRootStore:o,newUserSettingsStore:n}}return await O.OR({environment:t,spaceId:s.id,isNewlyCreatedSpace:r}),{switchedUser:!1}}async function fe(e){E.default.setState({...E.default.state,isTransitioning:!0}),await async function(e){const{spaceViewStore:t,redirectPageId:n,openInNew:r,isNewlyCreatedSpace:a,templateGalleryItem:s,projectManagementLaunch:l,leavingSpace:c,pageVisitSource:u}=e;let{environment:p,userSettingsStore:m,userRootStore:f}=e;const g=t.getSpaceStore();if(!g)throw new Error(x.default.formatMessage(de.invalidSpaceStoreOnNavigate));const h=await me({environment:p,spaceViewStore:t,openInNew:r,isNewlyCreatedSpace:a,leavingSpace:c});h.switchedUser&&(p=h.newEnvironment,m=h.newUserSettingsStore,f=h.newUserRootStore),F.Z.isAiEnabled()&&S.L6.loader().then((e=>{let{assistantActions:t}=e;t.clearAllAssistantSessions()}));const v=f&&f.getSpaceViewStores(),b=T.g4(p,t),y=D.Al(t);if(n)return void _._({environment:p,store:new L.G(p,{table:d.iU,id:n}),openInNew:r,pageVisitSource:u});if(f&&await j.Z.reinitializeState(p,f.id,g.id),"last_visited_page"===b){const e=ge({environment:p,spaceId:g.id});if(e&&e.canRead()&&e.pathIsAccessibleAndAlive()&&!C.IJ(p,e))return void _._({environment:p,store:e,openInNew:r,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:o.tY.LastVisitedPage})}if("personal_home"===b&&y&&(await y.load(),y.canRead()))return _._({environment:p,store:y,openInNew:r,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:o.tY.DefaultHome}),void(0,R.$X)({environment:p,from:"on_app_start_page"});const w=await(0,T.rg)(p,t);if(w)_._({environment:p,store:w,openInNew:r,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:u});else if(g.canEdit()){const{performResult:e}=se.createAndCommit({userAction:"spaceActions.createdPage",environment:p,perform:e=>ae.KE({environment:p,spaceStore:g,spaceViewStore:t,isPrivate:!0,transaction:e,prepend:!1})});_._({environment:p,store:e,openInNew:r,pageVisitSource:u})}else{if(m&&f&&v&&v.length>0&&v[0]&&v[0].id!==t.id)return J.vq(),p.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because navigateToSpace didn't find a page"}}),void(await he({environment:p,userRootStore:f,userSettingsStore:m,openInNew:r,pageVisitSource:u}));J.vq(),await P.xN(p)}}(e),await Y.Yh(e.environment),E.default.setState({...E.default.state,isTransitioning:!1})}function ge(e){const{spaceId:t}=e,n=j.Z.getWithoutSubscribing(t);if(!Array.isArray(n))return;const o=n[0];return void 0!==(null==o?void 0:o.pageId)?o.store:void 0}async function he(e){const{environment:t,userRootStore:n,ignoreSpaceId:o,userSettingsStore:i,openInNew:r,skipPendingTransferWorkspaces:a,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}=e;await n.load();const u=n.getSpaceViewStores();await Promise.all(u.map((e=>e.load())));const p=u.filter((e=>{var t;return!!e.isDefined()&&(o?e.getSpaceId()!==o:!a||!(0,h.DI)(null===(t=e.getSpaceStore())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.space_request))}));let m;for(const f of p){if(!T.Cx(f.getSpaceStore())){m=f;break}{const e=await(0,T.rg)(t,f);if(e&&e.isDefined()){m=f;break}}}m?await fe({environment:t,spaceViewStore:m,userSettingsStore:i,userRootStore:n,openInNew:r,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}):(J.vq(),await P.xN(t))}async function ve(e){const{environment:t,index:n,userRootStore:i,userSettingsStore:r}=e,a=B.Z.getAllSpaceViewStores(t)[n];a&&await fe({environment:t,spaceViewStore:a,userSettingsStore:r,userRootStore:i,pageVisitSource:o.tY.SwitchSpace})}async function be(e){const{environment:t,spaceStore:n}=e;n.isDefined()&&!(0,g.Z)(n.getEmailDomains(),e.emailDomains)&&q.xGP(t,{domains:e.emailDomains||[],confirmed:!0});const o={email_domains:e.emailDomains};e.name&&(o.name=e.name);const i={};for(const a of(0,b.Yd)(o)){const e=n.getKeyStore(a).getValue(),t=o[a];r.Xy(e,t)||(i[a]=t||null)}r.xb(i)||await new Promise(((e,o)=>{se.createAndCommit({userAction:"spaceActions.updateSpace",environment:t,perform:t=>{oe.sW({store:n,data:i,transaction:t}),t.postSubmitCallbacks.push((t=>{t?o(t):e()}))}})}))}async function ye(e){var t;const{environment:n,spaceStore:o,domain:i}=e;(null===(t=U.Z.state.publicSpaceDataMap[o.id])||void 0===t?void 0:t.domain)!==i&&(await G.updateSpaceDomain(n,{spaceId:o.id,domain:i}),U.Z.getPublicSpaceData(n,o.id,!0))}async function _e(e){var t;const{environment:n,spaceStore:o,publicHomePage:i}=e;(null===(t=U.Z.state.publicSpaceDataMap[o.id])||void 0===t?void 0:t.publicHomePage)!==i&&(await G.updatePublicHomePage(n,{spaceId:o.id,publicHomePage:i}),U.Z.getPublicSpaceData(n,o.id,!0))}function Se(e){const{environment:t,spaceStore:n,domain:o}=e,{currentUserStore:i}=E.default.state;return G.checkSpaceDomain(t,{spaceId:n.id,domain:o},null==i?void 0:i.id)}async function we(e){const{environment:t,spaceStore:n,spaceBasicSettingsStore:o,securitySettingsStore:i}=e,{name:r,domain:a,emailDomains:s,publicHomePage:l}=o.state;await Promise.all([be({environment:t,spaceStore:n,name:r,emailDomains:s}),ye({environment:t,spaceStore:n,domain:a}),_e({environment:t,spaceStore:n,publicHomePage:l}),i?re.n(t,{spaceStore:n,securitySettingsState:i.state}):Promise.resolve()])}const ke=function(e){const{environment:t,transaction:n,spaceStore:o,disablePublicAccess:i,disableGuests:r,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:u,disableExternalMembershipRequests:p,disableGuestMembershipRequests:m,enableAiFeature:f,disableTeamGuests:g,enableGuestInviteRequests:h}=e;oe.sW({store:o,data:{disable_public_access:i,disable_guests:r,disable_move_to_space:a,disable_export:s,disable_space_page_edits:l,disable_public_access_requests:c,settings:{...o.getSettings(),enable_ai_feature:f,disable_team_guests:g,enable_guest_invite_requests:h},disable_team_creation:d},transaction:n}),se.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_membership_requests"],command:"set",args:u},transaction:n}),se.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_external_membership_requests"],command:"set",args:p},transaction:n}),se.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_guest_membership_requests"],command:"set",args:m},transaction:n}),c&&H.Jp(t,{disable_public_access_requests:c})},Ie=function(e){const{transaction:t,spaceStore:n,inviteLinkEnabled:o}=e;oe.sW({store:n,data:{invite_link_enabled:o},transaction:t})};async function xe(e){const{environment:t,spaceId:n,userRootStore:r,navigate:s,analyticsFrom:l,userSettingsStore:c,redirectPageId:d,inviteCode:u}=e,p=r.getSpaceViewStores().find((e=>e.getSpaceId()===n));if(w.default.isAdminMode||G.setSpaceNotificationsAsRead(t,{timestamp:Date.now(),spaceId:n}),p)return!0!==p.getJoined()&&se.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Ze({spaceViewStore:p,transaction:e})}}),s&&await fe({environment:t,spaceViewStore:p,userSettingsStore:c,redirectPageId:d,userRootStore:r,pageVisitSource:o.tY.SwitchSpace}),{spaceViewStore:p};{const p=await G.addUsersToSpace(t,{userIds:[r.id],spaceId:e.spaceId,inviteCode:u});if("failed"===p.type)throw p.body&&p.body.clientData&&"invite_link_disabled"===p.body.clientData.type&&v.Z.remove(A.WX),i.log({level:"error",from:"spaceActions",type:"addUsersToSpace",error:(0,a.Ui)(p.error),data:{miscDataToConvertToString:{response:p}}}),p.error;const m=r.getSpaceViewStores();await Promise.all(m.map((e=>e.load())));const f=m.find((e=>e.getSpaceId()===n));if(!f)throw new Error(x.default.formatMessage(de.noSpaceViewOnJoin));const g=f.getJoined();if(!0!==g&&se.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Ze({spaceViewStore:f,transaction:e})}}),s&&await fe({environment:t,spaceViewStore:f,userSettingsStore:c,redirectPageId:d,userRootStore:r,pageVisitSource:o.tY.SwitchSpace}),O.OR({environment:t,spaceId:e.spaceId}).then((()=>{K.kj(t,{from:l})})),v.Z.remove(A.WX),t.device.isMobileNative&&i.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.joinSpace"}}),E.default.setState({...E.default.state,currentSpaceStore:f.getSpaceStore(),currentSpaceViewStore:f}),Y.Th({environment:t,force:!0}),await Y.Yh(t),!0!==g){const e=u?"shareable_link_join":"verified_domain_join";K.Jk(t,{invite_origin:e,domainType:(0,I.JF)(),new_workspace_member_count:1,new_workspace_member_ids:[r.id]})}return{spaceViewStore:f}}}async function Ce(e){const{environment:t,spaceId:n,userSettingsStore:i}=e,{currentUserRootStore:r,currentUserStore:a}=E.default.state;if(r&&a){const e=await G.removeUsersFromSpace(t,{userIds:[a.id],spaceId:n,removePagePermissions:!0,revokeUserTokens:!1});return"success"===e.type?(he({environment:t,userRootStore:r,ignoreSpaceId:n,userSettingsStore:i,leavingSpace:!0,pageVisitSource:o.tY.SwitchSpace}),!0):(Q.showError(e),!1)}}async function Te(e){const{environment:t,spaceId:n,userSettingsStore:i}=e,{currentUserRootStore:r,currentUserStore:a}=E.default.state;if(r&&a){ee.j({message:de.deletingWorkspace});try{const{value:e}=await G.deleteSpace(t,{spaceId:n}).next();if(e.error)throw e.error;await ie.bG({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:{table:f.dx,id:r.id},userId:t.currentUser.id}),he({environment:t,userRootStore:r,ignoreSpaceId:n,userSettingsStore:i,pageVisitSource:o.tY.SwitchSpace})}finally{ee.x()}}}function Me(e){const{environment:t,blocks:n,transaction:o}=e,i=t.currentUser.id;if(i)for(const r of n){const e=r.getPermissionItems().filter((e=>(0,s.FB)(e)));oe.sW({store:r,data:{permissions:[...e,{type:"user_permission",role:"editor",user_id:i}]},transaction:o})}}function Pe(e){const{environment:t,blocks:n,transaction:o}=e;if(t.currentUser.id)for(const i of n){const e=i.getPermissionItems(),n=e.find((e=>"space_permission"===e.type)),r=e.filter((e=>(0,s.FB)(e)));n||ne.ep({environment:t,store:i,permissionItems:[...r,{type:"space_permission",role:"editor"}],transaction:o})}}function Ae(e){const{blocks:t,transaction:n}=e;for(const o of t){const e=o.getPermissionItems().filter((e=>(0,s.FB)(e)));oe.sW({store:o,data:{permissions:e.length>0?e:null},transaction:n})}}function Re(e){const{spaceStore:t,transaction:n}=e;if(!t.isDefined())throw new Error(x.default.formatMessage(de.noLocalDataForPermissionGroup));const o=Date.now(),i={id:(0,l.ZP)(),last_edited_time:o},r=[i,...t.getPermissionGroups()];return oe.sW({store:t,data:{permission_groups:r},transaction:n}),i}function De(e){const{spaceStore:t,group:n,transaction:o}=e;if(!t.isDefined())throw new Error(x.default.formatMessage(de.noLocalDataForPermissionGroup));const i=t.getPermissionGroups();let r;r=i.findIndex((e=>e.id===n.id))>=0?i.map((e=>e.id===n.id?n:e)):[...i,n],oe.sW({store:t,data:{permission_groups:r},transaction:o})}async function Be(e){const{environment:t,spaceStore:n,group:o,transaction:i}=e;if(!n.isDefined())throw new Error(x.default.formatMessage(de.noLocalDataForPermissionGroup));const r=n.getPermissionGroups().filter((e=>e.id!==o.id));oe.sW({store:n,data:{permission_groups:r},transaction:i}),await G.transferPermissionGroup(t,{spaceId:n.id,groupId:o.id})}const Ee=function(e){const{userRootStore:t,spaceViewIds:n,transaction:o,spaceViewPointers:i}=e;oe.sW({store:t,data:{space_views:n,space_view_pointers:i},transaction:o})};function Fe(e){const{planType:t,spaceStore:n,transaction:o}=e;oe.sW({store:n,data:{plan_type:t},transaction:o})}function Ze(e){oe.sW({store:e.spaceViewStore,data:{joined:!0},transaction:e.transaction})}function Ve(e){let{domain:t,environment:n,spaceId:o}=e;return new Promise(((e,i)=>{const r=U.Z.getPublicSpaceData(n,o);t!==(null==r?void 0:r.domain)&&null!=r&&r.hasPublicPages?Q.showDialog({message:(0,ce.jsxs)("div",{style:{overflowWrap:"anywhere"},children:[(0,ce.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.prompt",defaultMessage:"This workspace has public pages. If you proceed with changing the domain, any existing links starting with {current_domain}.notion.site will no longer work.",values:{current_domain:(null==r?void 0:r.domain)||"your_domain"}}),(0,ce.jsx)("p",{}),(0,ce.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.areYouSure",defaultMessage:"Are you sure you want to change your domain?"})]}),showCancel:!1,keepFocus:!0,items:[{label:(0,ce.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.changeButton.label",defaultMessage:"Change"}),color:"red",onAccept:()=>e(!0)},{label:(0,ce.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.cancelButton.label",defaultMessage:"Cancel"}),color:void 0,onAccept:()=>e(!1)}]}):e(!0)}))}function je(e,t,n){const o=n||E.default.state.currentSpaceStore;if(!o)throw i.log({level:"error",from:"spaceActions",type:"setSpaceSurveyData",error:{message:"Couldn't find a SpaceStore."}}),new Error;se.createAndCommit({userAction:"spaceActions.setSpaceSurveyData",environment:e,perform:e=>{ze(o,e,{space_survey_data:t})}})}function Ue(e){var t;const n=E.default.state.currentSpaceStore;n?null!==(t=n.getSettings())&&void 0!==t&&t.seen_block_limit_reduction_v2||((0,N.KC)(),se.createAndCommit({userAction:"spaceActions.setBlockLimitIncrease",environment:e,perform:e=>{ze(n,e,{seen_block_limit_increase:!0})}})):i.log({level:"error",from:"spaceActions",type:"setBlockLimitIncrease",error:{message:"Couldn't find a SpaceStore to set block increase experiment."}})}function Le(e){const t=E.default.state.currentSpaceStore;t?((0,N.lF)(),se.createAndCommit({userAction:"spaceActions.setShowBlockLimitEarlier",environment:e,perform:e=>{ze(t,e,{seen_block_limit_earlier:!0})}})):i.log({level:"error",from:"spaceActions",type:"setShowBlockLimitEarlier",error:{message:"Couldn't find a SpaceStore to set show block limit earlier experiment."}})}async function Oe(e){const t=E.default.state.currentSpaceStore;return t?!e.device.isMobile&&(await(0,W.n)(e)?!!(0,N.SF)()&&((0,N.yt)(),se.createAndCommit({userAction:"spaceActions.setTimedTrialsForMmOrEntInOnboarding",environment:e,perform:e=>{ze(t,e,{exposed_to_timed_trials_in_onboarding_v2:!0})}}),!0):!(0,N.Z$)()&&((0,N.bI)(),se.createAndCommit({userAction:"spaceActions.setTimedTrialsInOnboarding",environment:e,perform:e=>{ze(t,e,{exposed_to_timed_trials_in_onboarding:!0})}}),!0)):(i.log({level:"error",from:"spaceActions",type:"initializeTimedTrialsOnboardingExp",error:{message:"Couldn't find a SpaceStore to initialize the TT onboarding experiment."}}),!1)}function Ne(e){const t=e.getEditDomain();return t?`${window.location.host}/${t}`:null}function ze(e,t,n){se.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}},28014:(e,t,n)=>{n.d(t,{Hj:()=>w,KE:()=>S,OQ:()=>k,cc:()=>I,sY:()=>_,ux:()=>x});n(21703);var o=n(41432),i=n(4615),r=n(21202),a=n(70203),s=n(97880),l=n(9291),c=n(33929),d=n(38755),u=n(77080),p=n(26136),m=n(81193),f=n(54532),g=n(3297),h=n(94419),v=n(9953),b=n(4408),y=n(993);const _=(0,l.defineMessages)({createAndDuplicatePageError:{defaultMessage:"Duplicated page could not be created.",id:"spaceActions.createAndDuplicatePageInSpace.copyNotCreated.error"},forkPageError:{defaultMessage:"Could not fork page.",id:"spaceActions.dialogError.forkPageError.message"}});function S(e){const{environment:t,spaceViewStore:n,spaceStore:i,isPrivate:r,prepend:a,title:s,transaction:l,loading:c,tracker:d}=e,p=Boolean(u.default.checkGate("enable_text_crdt_client")&&e.useCrdt),m=v.j4({environment:t,type:c?o.Ti.copyIndicator:o.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:l,spaceId:i.id,tracker:d,useCrdt:p});return s&&y.sO({environment:t,store:m.getBlockTitleStore(),value:[[s]],transaction:l}),w({environment:t,spaceStore:i,spaceViewStore:n,pageStore:m,isPrivate:r,location:{type:a?"prepend":"append"},transaction:l}),m}function w(e){const{environment:t,spaceStore:n,spaceViewStore:o,pageStore:i,isPrivate:r,location:a,transaction:l}=e,{id:c}=t.currentUser;let d;r?c&&(d={type:"user_permission",role:"editor",user_id:c}):d={type:"space_permission",role:"editor"},v.sW({store:i,data:{permissions:d?[d]:[]},transaction:l}),r&&k({environment:t,spaceStore:n,spaceViewStore:o,transaction:l});const u=a||{type:"append"};"prepend"===u.type?h.Ce({parent:r?o.getPrivatePagesStore():n.getPagesStore(),prepend:i,before:u.before,transaction:l}):"append"===u.type?h.R3({parent:r?o.getPrivatePagesStore():n.getPagesStore(),append:i,after:u.after,transaction:l}):(0,s.t1)(u)}function k(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:i}=e,r=new Set(o.getPrivatePageStores().map((e=>e.id)));(0,d.XD)(t,n).filter((e=>e.isTopLevelPrivatePage({spaceStore:n,environment:t}))).forEach((e=>{r.has(e.id)||h.R3({parent:o.getPrivatePagesStore(),append:e,transaction:i})}))}function I(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:i,copyPageId:r,recordMap:a,isPrivate:s,allowCopyExternalObjectInstances:l}=e,d=S({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:s,loading:!0,transaction:i});b.fL({environment:t,inMemoryRecordCache:d.inMemoryRecordCache,recordMap:a,debugSource:"spaceActions.createAndDuplicatePageInSpace"});const u=f.K8(t,{blockId:r,inMemoryRecordCache:d.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:l});if(!u)throw new Error(c.default.formatMessage(_.createAndDuplicatePageError));return f.E9({environment:t,sourceBlockId:r,targetBlockPointer:d.pointer,sourceBlockSubtree:u,targetInMemoryRecordCache:d.inMemoryRecordCache,transaction:i,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:d.useCrdt()}),d}async function x(e){const{environment:t,userRootStore:n,isPrivate:o,forkedPageId:s,spaceStore:l,spaceViewStore:d}=e;if(l.canEdit()){const e=p.G.createChildStore(n,{table:r.iU,id:s});g.nM({currentUserId:t.currentUser.id,blockId:void 0});const c=Date.now(),u=await g.OH({environment:t,store:e,spaceStore:l,spaceViewStore:d,isPrivate:o}),f=Date.now()-c;if(m.Xy(t,{from:"onboarding",success:!u.error,template_name:a.QaF(e.getTitleValue()),template_block_id:s,target_space_id:(0,i.F9)(l.id),context:"fork_page_into_space",template_duplication_duration_ms:f}),void 0===u.error)return u.value}throw new Error(c.default.formatMessage(_.forkPageError))}},97627:(e,t,n)=>{n.d(t,{E6:()=>p,GZ:()=>u,MA:()=>h,NY:()=>v,Q1:()=>y,TY:()=>d,ZJ:()=>m,aW:()=>_,kY:()=>f,lo:()=>l,pE:()=>c,pc:()=>b,pu:()=>g});n(21703);var o=n(68626),i=n(77472),r=n(80444),a=n(82530);function s(e,t,n){a.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}function l(e){var t;const{currentSpaceViewStore:n}=r.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeSpaceAnalyticsPromptSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:{status:"showing",num_times_shown:0}})}})}function c(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const i={...o,num_times_shown:o.num_times_shown+1};i.num_times_shown>3&&(i.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementSpaceAnalyticsSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:i})}})}function d(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;o&&"dismissed"!==o.status&&a.createAndCommit({userAction:"spaceViewActions.incrementspaceAnalyticsSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:{status:"dismissed"}})}})}function u(e){var t;const{currentSpaceViewStore:n}=r.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeMfaPromptSettings",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:{status:"showing",num_times_shown:0}})}})}function p(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const i={...o,num_times_shown:o.num_times_shown+1};i.num_times_shown>3&&(i.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementOrHideMfaPrompt",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:i})}})}function m(e){var t;const{currentSpaceViewStore:n}=r.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;o&&"dismissed"!==o.status&&a.createAndCommit({userAction:"spaceViewActions.dismissMfaPromptSetting",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:{status:"dismissed"}})}})}function f(e,t){var n;const{currentSpaceViewStore:o}=r.default.state;if(!o)return;const l=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];l.includes(t)||(a.createAndCommit({userAction:"spaceViewActions.optOutOfPageAnalyticsForPage",environment:e,perform:e=>{s(o,e,{page_analytics_opt_out_list:[...l,t]})}}),i.j(e,"page_analytics_page_opt_out"))}function g(e,t){var n;const{currentSpaceViewStore:o}=r.default.state;if(!o)return;const l=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];l.includes(t)&&(a.createAndCommit({userAction:"spaceViewActions.optInToPageAnalyticsForPage",environment:e,perform:e=>{s(o,e,{page_analytics_opt_out_list:l.filter((e=>e!==t))})}}),i.j(e,"page_analytics_page_opt_in"))}function h(e,t){const{currentSpaceViewStore:n}=r.default.state;n&&a.createAndCommit({userAction:"userSettingsActions.emailDigestSetting.onToggle",environment:e,perform:e=>{s(n,e,{notify_email_digest:t})}})}function v(e){const{currentSpaceViewStore:t}=r.default.state;t&&a.createAndCommit({userAction:"spaceViewActions.confirmAdminContentSearchAcknowledgement",environment:e,perform:e=>{s(t,e,{admin_content_search_acknowledgement:!0})}})}function b(e){var t;const{currentSpaceViewStore:n}=r.default.state;n&&(null!==(t=n.getSettings())&&void 0!==t&&t.has_migrated_to_google_drive_external_integration||a.createAndCommit({userAction:"spaceViewActions.setUserMigratedToGoogleDriveExternalIntegrationInSpace",environment:e,perform:e=>{s(n,e,{has_migrated_to_google_drive_external_integration:!0})}}))}function y(e,t,n){const i=n||r.default.state.currentSpaceViewStore;if(!i)throw o.log({level:"error",from:"spaceActions",type:"setUserSurveyData",error:{message:"Couldn't find a SpaceViewStore."}}),new Error;a.createAndCommit({userAction:"spaceViewActions.setUserSurveyData",environment:e,perform:e=>{s(i,e,{user_survey_data:t})}})}function _(e,t){const{shown:n,transactionUserAction:o,spaceViewStore:i}=t;a.createAndCommit({environment:e,userAction:o,perform:e=>{s(i,e,{ai_qna_waitlist_shown:n})}})}},15690:(e,t,n)=>{n.d(t,{gG:()=>S,jL:()=>f,nz:()=>b,ls:()=>y,x2:()=>h,a:()=>g});var o=n(41432),i=n(15157),r=n(9291),a=n(33929),s=n(49085);class l extends s.default{getInitialState(){return{}}setSelected(e,t){this.setState({...this.state,[e]:t})}getSelectedTab(e){return this.state[e]}}const c=new l;var d=n(94419),u=n(9953),p=n(24677),m=n(98104);function f(e){const t=e.getContentStores(),n=e.id,o=c.getSelectedTab(n);return o?t.findIndex((e=>e.id===o)):0}function g(e){const{store:t,index:n,currentUserId:o}=e,i=t.getContentStores()[n];i&&h({store:t,id:i.id,currentUserId:o})}function h(e){const{store:t,id:n,currentUserId:o}=e;c.setSelected(t.id,n),i.Z.set({userId:o,key:v(t.id),value:n})}function v(e){return`TabBlock-${e}`}function b(e){const{blockId:t,currentUserId:n}=e,o=i.Z.get({userId:n,key:v(t)});o&&c.setSelected(t,o)}function y(e){const{environment:t,store:n,transaction:i}=e,r=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,useCrdt:n.useCrdt()});d.R3({parent:n.getContentStore(),append:r,transaction:i});const a=n.getContentStores()[0];p.eP({environment:t,store:a});const s=a.getBlockTitleStore();m.N_({store:s})}const _=(0,r.defineMessages)({newTab:{id:"tabBlockActions.addTab.title",defaultMessage:"New tab"}});function S(e){const{environment:t,store:n,transaction:i}=e,r=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,properties:{title:[[a.default.formatMessage(_.newTab)]]},useCrdt:n.useCrdt()});return d.R3({parent:n.getContentStore(),append:r,transaction:i}),c.setSelected(n.id,r.id),r}},80402:(e,t,n)=>{n.d(t,{AU:()=>X,DI:()=>O,FC:()=>U,K4:()=>ne,MO:()=>V,NE:()=>z,Z5:()=>Z,d1:()=>ee,e2:()=>j,j0:()=>G,nA:()=>W,oz:()=>oe,qY:()=>te,qn:()=>q,zJ:()=>L});n(57658),n(21703);var o=n(15145),i=n(68497),r=n(35011),a=n(80951),s=n(1800),l=n(53877),c=n(61075),d=n(78106),u=n(84682),p=n(42875),m=n(5773),f=n(72126),g=n(59753),h=n(82883),v=n(21202),b=n(23867),y=n(19889),_=n(70203),S=n(95477),w=n(17809),k=n(33929),I=n(40150),x=n(41662),C=n(77080),T=n(29370),M=n(8406),P=n(893),A=n(49865),R=n(14900),D=n(96802),B=n(9953),E=n(24677),F=n(82530);function Z(e){const{environment:t,selectionKey:n,selection:o}=e;T.Z.setState({isActive:!0,selectionKey:n,selection:o}),E.ZH(t)}function V(){T.Z.setState({isActive:!1})}function j(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:i,selection:r}=e;if(o&&r.end.col>0){const e={col:r.end.col-1,row:r.end.row};Z({environment:t,selectionKey:n,selection:{start:r.start,end:e}})}else if(!o&&r.start.col>0){const e={col:r.start.col-1,row:r.start.row};Z({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&0===r.start.col&&r.start.row>0){const e={col:i-1,row:r.start.row-1};Z({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function U(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:i,rowCount:r,selection:a}=e;if(o&&a.end.col<i-1){const e={col:a.end.col+1,row:a.end.row};Z({environment:t,selectionKey:n,selection:{start:a.start,end:e}})}else if(!o&&a.start.col<i-1){const e={col:a.start.col+1,row:a.start.row};Z({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&a.start.col>=i-1&&a.start.row<r-1){const e={col:0,row:a.start.row+1};Z({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function L(e){const{environment:t,selectionKey:n,shiftKey:o,selection:i}=e;if(o&&i.end.row>0){const e={col:i.end.col,row:i.end.row-1};Z({environment:t,selectionKey:n,selection:{start:i.start,end:e}})}else if(!o&&i.start.row>0){const e={col:i.start.col,row:i.start.row-1};Z({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function O(e){const{environment:t,selectionKey:n,shiftKey:o,rowCount:i,selection:r}=e;if(o&&r.end.row<i-1){const e={col:r.end.col,row:r.end.row+1};Z({environment:t,selectionKey:n,selection:{start:r.start,end:e}})}else if(!o&&r.start.row<i-1){const e={col:r.start.col,row:r.start.row+1};Z({environment:t,selectionKey:n,selection:{start:e,end:e}})}}const N=new Set(["auto_increment_id"]);function z(e){const{selection:t,schema:n,currentRows:o,currentPropertyFormats:i,transaction:r}=e,a=I.AV(t);for(let s=a.minRow;s<=a.maxRow;s++){const e=o[s];if(e)for(let t=a.minCol;t<=a.maxCol;t++){const o=i[t],a=n[o.property];null!=a&&a.type&&N.has(a.type)||B.sO({store:e.getPropertyStore(o.property),value:null,transaction:r})}}}const W=e=>{q(e),z(e)},q=e=>{const{selection:t,currentRows:n,event:i}=e;if(null===i.clipboardData)return;const r=I.AV(t);let a="";const l=[],d=n.slice(Math.max(0,r.minRow),r.maxRow+1).filter((e=>e&&e.isDefined()));for(const o of d){const t=[];l.push(t);for(let n=r.minCol;n<=r.maxCol;n++){const[i,s]="selectionKey"in e?H({row:o,x:n,collectionViewBlockStore:e.selectionKey.collectionViewBlockStore,...e}):K({row:o,x:n,...e});t.push([i,o.pointer]),s&&(a+=s),n<r.maxCol&&(a+="\t")}o!==f.Z$(d)&&(a+="\n")}if(i.preventDefault(),i.clipboardData.setData("text/plain",a),function(e,t){if(null===e.clipboardData)return;e.clipboardData.setData(I.mH,JSON.stringify(t))}(i,l),"simpleTableStore"in e){const{environment:t,simpleTableStore:n,columnOrder:a,exportJsxRenderer:l}=e;if(!l)return;const{default:u,jsxToStaticMarkup:m}=l,f=t.currentUser.id,h=t.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(f),y=g.om.fromGetRecordValueFn(h),_=a.slice(r.minCol,r.maxCol+1).filter((e=>void 0!==e)),w=(0,c._2)({exportArgs:{root:{table:v.iU,id:n.id,spaceId:(0,b.C)(n.pointer.spaceId)},navigableBlockId:n.id,renderParentBlockId:void 0,blockId:n.id,userTimeZone:(0,p.r)(),intl:k.default.getIntl(),getRecordValue:h,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,s.Z)({pageId:t,pageModel:y({table:v.iU,id:t}),baseUrl:S.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:S.default.domainBaseUrl,publicDomainName:S.default.publicDomainName,table:{[n.id]:{renderRows:d.map((e=>e.id)),renderColumns:_}},katex:t.KatexStore.getKatex(),resultCache:new Map},renderers:u});if(w){const e=m(w);i.clipboardData.setData("text/html",e)}}};function H(e){const{row:t,x:n,collectionViewBlockStore:o,schema:r,currentPropertyFormats:a}=e,s=a[n],l=J(t,r,s.property);if(!t.isDefined())return[l,void 0];return[l,(0,i.L)({property:s.property,schema:r,block:t.getModel(),getRecordModel:o.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:k.default.getIntl(),visitedProperties:new Set,resultCache:new Map},exportedFilePaths:!1})]}function K(e){const{row:t,x:n,columnOrder:o,simpleTableStore:i}=e,r=t.getPropertyStore(o[n]);return[r.getValue()||[],(0,h.X)({textValue:r.getValue(),getRecordModel:i.getRecordModel,userTimeZone:(0,p.r)(),intl:k.default.getIntl()})]}function G(e){const{environment:t,selection:n,currentRows:o,event:i,transaction:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(!i.clipboardData)return;let l;const c=i.clipboardData.getData(I.mH),d=i.clipboardData.getData("text/html");if(c)l=JSON.parse(c);else if(d){const e=document.createElement("div");e.innerHTML=d;const t=e.querySelector("table");if(t){const e=t.querySelectorAll("tr");l=[];for(const t of Array.from(e)){const e=[],n=t.querySelectorAll("td, th");for(const t of Array.from(n)){const n=_.TPx(t.textContent||"");e.push([n,void 0])}l.push(e)}}}if(!l){const e=function(e){const{event:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}=e;if(!t.clipboardData)return;const{text:i,html:r,multiTextSelectionData:a,textSelectionData:s,blockSelectionData:l}=P.e0({clipboardData:t.clipboardData,tinyMceMicrosoftWordPasteFilter:o});if(a)return P.of({text:i,html:r,stripText:!1,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o});if(s){const{editing:e,selection:t}=s;return _.OAI(_.xrQ(e,t.startIndex,t.endIndex).tokensInsideRange)}if(r||i)return function(e){const{text:t,html:n,blockSelectionData:o,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r}=e;return t.includes("\n")||o&&o.blocks.length>0?_.TPx(t):P.of({text:t,html:n,stripText:!1,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:r})}({text:i,html:r,blockSelectionData:l,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}({event:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});e&&(l=[[[e,void 0]]])}if(l){const i=I.AV(n),a=l[0].length;let s=Math.floor((i.maxCol-i.minCol+1)/a);0===s&&(s=1);const c=l.length;let d=Math.floor((i.maxRow-i.minRow+1)/c);0===d&&(d=1);for(let t=0;t<d;t++)for(let n=0;n<s;n++){const s=i.minCol+n*a,d=i.minRow+t*c;for(let t=0;t<c;t++){let n=o[d+t];if(!n){const t="selectionKey"in e?$(e):x.HM.appendRow(e);t&&(e.currentRows.push(t),n=t)}for(let o=0;o<a;o++){const i=l[t][o];if(!i)continue;const a=s+o;"currentPropertyFormats"in e?Q({row:n,x:a,serializedValue:i,currentPropertyFormats:e.currentPropertyFormats,transaction:r,schema:e.schema}):Y({row:n,x:a,serializedValue:i,columnOrder:e.columnOrder,transaction:r})}}}const u={start:{col:i.minCol,row:i.minRow},end:{col:i.minCol+a*s-1,row:i.minRow+c*d-1}};"selectionKey"in e?Z({environment:t,selectionKey:e.selectionKey,selection:u}):x.HM.selectMultiCell({environment:t,start:u.start,end:u.end,simpleTableStore:e.simpleTableStore})}}function $(e){const{environment:t,currentRows:n,collectionContextStore:o,selectionKey:i,transaction:r}=e,{groupFormat:a}=i,s=A.IW({environment:t,collectionContextStore:o,groupsPointer:a?[a]:[],insertAtIndex:n.length,shouldCoerce:!0,initializeDefaultTemplate:!1,transaction:r,from:"table_paste_selection"});return null==s?void 0:s.newStore}function Q(e){var t;const{row:n,x:o,serializedValue:i,currentPropertyFormats:r,transaction:s,schema:l}=e,c=r[o];if(!c)return;if("verification"===(null===(t=l[c.property])||void 0===t?void 0:t.type))return;const[d,u]=i;if(B.sO({store:n.getPropertyStore(c.property),value:d,transaction:s}),u){var p;const e=d?a.g(d):void 0,t=(0,m.jy)(e,[S.default.secureFileS3.url,S.default.secureFileS3V2.url],(null===(p=S.default.secureFileConfig)||void 0===p?void 0:p.rootPath)??"");B.nj({store:n,source:u,fileIds:t.map((e=>e.id)),transaction:s})}}function Y(e){const{row:t,x:n,serializedValue:o,transaction:i,columnOrder:r}=e,a=r[n];if(!a)return;const[s,l]=o;B.sO({store:t.getPropertyStore(a),value:_.OAI(s),transaction:i})}const J=function(e,t,n){const o=t[n];if(!o)throw new Error("Property not found");if(!e.isDefined())return[];const i=e.getPropertyValue(n);if("formula"===o.type){if("v2"===o.version&&(0,w.V1)()){if(!o.formula2)return[];const t=(0,r.EC)({block:e.getModel(),property:n,formulaCode:o.formula2.code,getRecordModel:e.getRecordModel,intl:k.default.getIntl(),userTimeZone:(0,p.r)(),depth:0,visitedProperties:new Set,resultCache:new Map});return t?(0,d.j4)(t):[]}{const o=(0,u.y4)({property:n,schema:t,block:e.getModel(),getRecordModel:e.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:k.default.getIntl(),resultCache:new Map,visitedProperties:new Set}});return _.TPx(o)}}if("created_time"===o.type&&e.getCreatedTime())return a.d7(l.CQ(e.getCreatedTime(),(0,p.r)()));if("created_by"===o.type&&e.getCreatedByPointer()){const{table:t,id:n}=e.getCreatedByPointer()??{};return n&&t===y.KJ?[_.YCD(["u",n])]:n?[_.YCD(["r",n])]:[]}if("last_edited_time"===o.type&&e.getLastEditedTime())return a.d7(l.CQ(e.getLastEditedTime(),(0,p.r)()));if("last_edited_by"===o.type&&e.getLastEditedByPointer()){const{table:t,id:n}=e.getLastEditedByPointer()??{};return n&&t===y.KJ?[_.YCD(["u",n])]:n?[_.YCD(["r",n])]:[]}return i||[]};function X(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;F.createAndCommit({userAction:"tableActions.toggleTableVerticalLines",environment:t,perform:e=>{D.FH({stores:[n],update:{hide_table_vertical_lines:!o},transaction:e})}})}function ee(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const i="title"===o?void 0:"title";F.createAndCommit({userAction:"tableActions.toggleTableSubitemToggleOnTitle",environment:t,perform:e=>{D.FH({stores:[n],update:{table_subitem_toggle_column:i},transaction:e})}})}function te(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const i=n.getFormat().table_properties,r=null==i?void 0:i.map((e=>({...e,wrap:!o})));F.createAndCommit({userAction:"tableActions.toggleTableWrapCells",environment:t,perform:e=>{D.FH({stores:[n],update:{table_wrap:!o,table_properties:r},transaction:e})}})}function ne(e){let{property:t,collectionViewStore:n,format:o,formatKey:i,environment:r,currentValue:a}=e;const s=!a,l=n.getFormat().table_wrap,c=o[i]||[];let d=!0;const u=c.map((e=>{let n;return n=e.property===t?s:Boolean(l||e.wrap),n||(d=!1),{...e,wrap:n}})),p={...o,[i]:u,table_wrap:d};F.createAndCommit({userAction:"tableActions.toggleWrapColumn",environment:r,perform:e=>{R.iG({collectionViewStore:n,update:{format:p},transaction:e})}})}function oe(e){let{environment:t,collectionContextStore:n,currentIndex:o,entrypoint:i,transaction:r,propertyAction:a}=e;const s=n.collectionViewStore(),l=n.normalizedFormatStore.state;if(!s||void 0===o)return;const c=n.frozoneStore.state.frozenIndex;let d;switch(a){case"toggle":c!==o?d=o:c===o&&(d=-1);break;case"delete":case"hide":if(!(void 0!==c&&o<=c))return;d=c-1;break;case"duplicate":if(!(void 0!==c&&o<=c))return;d=c+1;break;case void 0:if(c!==o)d=o;else if(c===o)return}const u={...l,table_frozen_column_index:d};n.frozoneStore.setState({...n.frozoneStore.state,frozenIndex:d}),d&&C.default.logEvent("freeze_columns","true",{from:i}),M.wd({environment:t,collectionContextStore:n,action:void 0===d?"table_unfreeze_columns":"table_freeze_column",entrypoint:i,propertyIndex:d}),B.sW({store:s.getFormatStore(),data:u,transaction:r})}},150:(e,t,n)=>{n.d(t,{Ct:()=>g,Hl:()=>h,c0:()=>b,sp:()=>y});n(57658),n(67294);var o=n(72141),i=n(29369),r=n(64684),a=n(9291),s=n(98165),l=n(26136),c=n(50906),d=n(47307),u=n(94419),p=n(9953),m=n(82530),f=n(85893);function g(e){const{environment:t,currentSpaceViewStore:n,orderedTeamIds:o,userAction:r}=e;if(m.createAndCommit({userAction:r,environment:t,perform:e=>{p.sW({store:n,data:{joined_teams:o},transaction:e})}}),e.isExplicitUserAction){const{key:o,startPosition:r,endPosition:a}=e.dropArgs,s=l.zX.createChildStore(n,{table:i.e0,id:o});c.ers(t,{store:s,start_position:r,end_position:a})}}async function h(e){let{transaction:t,...n}=e;const{moveToTeam:o,permissionsUpdateItems:i}=function(e){let{moveStores:t,moveTargetStore:n}=e;const o=t.reduce(((e,t)=>(e[t.id]=(0,s.VP)(t),e)),{}),i=(0,s.VP)(n),r=[];for(const a of t){const e=v({blockStore:a,moveFromTeam:o[a.id],moveToTeam:i});e&&r.push(e)}return{moveToTeam:i,permissionsUpdateItems:r}}(n);if(0===i.length)return"not_cleared";if(!(await async function(e){let{numPagesMoved:t,moveToTeam:n,permissionsUpdateItems:o}=e;if(0===o.length)return!0;if(!n)return!0;const i=n.getName(),r=o.some((e=>{let{isRemovingRestricted:t}=e;return!0===t}))&&(0,f.jsx)(a.FormattedMessage,{id:"teamActions.confirmMoveToTeam.removeRestrictedDescription",defaultMessage:" {numPagesMoved, plural, one {This page} other {These pages}} will no longer have restricted access.",values:{numPagesMoved:t}});return await d.confirmUserAction({message:(0,f.jsx)(a.FormattedMessage,{defaultMessage:"Are you sure you want to move {numPagesMoved, plural, one {this page} other {these pages}} to {moveToTeamName}?",id:"teamActions.confirmMoveToTeam.title",values:{moveToTeamName:i,numPagesMoved:t}}),description:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a.FormattedMessage,{id:"teamActions.confirmMoveFromTeam.description",defaultMessage:"This will transfer the permissions on {numPagesMoved, plural, one {this page} other {these pages}} to members of {moveToTeamName}. ",values:{moveToTeamName:i,numPagesMoved:t}}),r]})})}({numPagesMoved:n.moveStores.length,moveToTeam:o,permissionsUpdateItems:i})))return"user_cancelled_move";for(const{blockStore:r,permissions:a}of i)p.sW({store:r,data:{permissions:a},transaction:t});return"cleared"}function v(e){let{blockStore:t,moveFromTeam:n,moveToTeam:i}=e;if(void 0===n&&void 0===i)return;if((null==n?void 0:n.id)===(null==i?void 0:i.id))return;const a=t.getPermissionItems();let s=!1;const l=a.filter((e=>(0,o.Le)(e)?(s=!0,!1):!(0,o.ix)(e)&&(!n||!(0,r.J2)(e,n.id)&&!(0,r.jc)(e,n.id))));return a.length!==l.length?{blockStore:t,permissions:l,moveFromTeam:n,isRemovingRestricted:s}:void 0}function b(e){const{store:t,teamStore:n,transaction:o,location:i}=e,r=n.getTeamPagesStore(),a=l.G.createChildStore(r,t.pointer);"append"===i.type?u.R3({parent:r,append:a,transaction:o,after:i.after}):"prepend"===i.type&&u.Ce({parent:r,prepend:a,transaction:o,before:i.before})}function y(e){const{store:t,teamStore:n,transaction:o}=e,i=n.getTeamPagesStore(),r=l.G.createChildStore(i,t.pointer);u.Od({childToRemove:r,parent:i,transaction:o})}},993:(e,t,n)=>{n.d(t,{AE:()=>Qe,Be:()=>je,Du:()=>Fe,KM:()=>De,MY:()=>Re,N3:()=>Ie,Nh:()=>Xe,O5:()=>$e,ON:()=>Je,Q0:()=>Ke,QT:()=>Ze,QX:()=>Be,VO:()=>Ye,YV:()=>ze,Zl:()=>et,aS:()=>We,fs:()=>Ne,g2:()=>qe,gc:()=>Le,gy:()=>ot,hJ:()=>xe,i8:()=>Ee,lZ:()=>He,mM:()=>Ce,n2:()=>Oe,pe:()=>we,pz:()=>Se,sO:()=>Me,vE:()=>it,wA:()=>Ge});n(57658),n(21703),n(30541);var o=n(1302),i=n(15145),r=n(37167),a=n(1800),s=n(15095),l=n(78106),c=n(68626),d=n(64572),u=n(72126),p=n(99405),m=n(21202),f=n(70279),g=n(33709),h=n(23867),v=n(70203),b=n(39721),y=n(64002),_=n(82798),S=n(54564),w=n(67133),k=n(62878),I=n(28344),x=n(17707),C=n(95477),T=n(78791),M=n(65273),P=n(14976),A=n(73744),R=n(84210),D=n(68056),B=n(45162),E=n(98165),F=n(65598),Z=n(18514),V=n(69645),j=n(73959),U=n(60846),L=n(89224),O=n(89086),N=n(35328),z=n(89574),W=n(95802),q=n(98180),H=n(24229),K=n(66949),G=n(77080),$=n(72014),Q=n(88923),Y=n(81236),J=n(26136),X=n(27724),ee=n(24666),te=n(45131),ne=n(65663),oe=n(50906),ie=n(6404),re=n(893),ae=n(4727),se=n(36280),le=n(44886),ce=n(88295),de=n(67060),ue=n(9953),pe=n(12714),me=n(8055),fe=n(61045),ge=n(24677),he=n(84084),ve=n(17269),be=n(98104),ye=n(32741),_e=n(82530);function Se(e){const{multiSelection:t,environment:n,transaction:o}=e,i=(0,B.L5)(t);if(0===i.length)return;if(1===i.length){const{store:e,selection:t}=i[0];return we({environment:n,transaction:o,store:e,selection:t})}const r=t.start.store,a=M.FX(r),s=(0,B.Nj)({multiSelection:t,includeNonSelectable:!1});if(!s)return;const{treeRange:l}=s;if(a){const e=new Set,i=[];for(const t of l.iterateDeletion())if("delete"===t.operation)for(const{childToRemove:e}of(0,V.XL)({treeOperation:t,deleteFrom:"record-store-parent"}))i.push(e);else if("move"===t.operation)for(const n of t.movingChildren)n.value.store&&e.add(n.value.store);let r=0;for(const t of i)r+=1+(0,F.MI)({blockStore:t,traverseTransclusionReferences:!1}).length;const a=G.default.getConfigKey("text_crdt_config","delete_merge_slice_tree_block_limit");r<=a?T.Cf({environment:n,transaction:o,multiSelection:t,removedBlocks:i,movedBlocks:e}):c.log({level:"info",from:"deleteMultiSelection",type:"crdt:deleteMultiSelectionOverBlockLimit",data:{miscDataToConvertToString:{blockLimit:a,numBlocksInSelection:r}}})}const{start:d,end:u}=t;we({environment:n,transaction:o,selection:{startIndex:d.index,endIndex:1/0},store:d.store});const p=(0,O.x0)(d.store);if(a){const e=(0,_.TO)((0,j.sQ)(u.store),"End of selection must be in a block");we({environment:n,transaction:o,selection:{startIndex:0,endIndex:u.index},store:u.store}),T.tE({transaction:o,block:e,targetStore:r})}else p?Le({environment:n,transaction:o,sourceStore:u.store,sourceIndex:u.index,targetStore:d.store,targetIndex:p.endIndex}):we({environment:n,transaction:o,store:u.store,selection:{startIndex:u.index,endIndex:1/0}});for(const c of l.iterateDeletion())(0,V.D_)({transaction:o,treeOperation:c,deleteFrom:"record-store-parent"});be.Z5({store:d.store,selection:p}),ge.eP({environment:n,store:l.start.value.store})}function we(e){ke({...e,updateSelection:!0,removeInlineRecords:!0})}function ke(e){const{environment:t,store:n,selection:o,transaction:i,updateSelection:r,removeInlineRecords:a}=e,l=n.getValue(),c=v.Ulv(l,o);if(c.startIndex===c.endIndex)return void(r&&be.Z5({store:n,selection:c}));let d;const u=n.isTable(m.iU)&&(0,j.sQ)(n)||n.getRecordStoreAtRootPath();if(u instanceof J.G&&M.Ls({store:n,blockStore:u})){const t=(0,_.TO)(u.getTextSliceTree()),o=new s.W3(v.eeV(l)),{startIndex:r,endIndex:a}=o.getInclusiveStringRangeForSelection(c),{operations:p,invertedOperations:m}=t.getOperationsForDeleteText(r,a);ne.F({transaction:i,store:u,crdtOperations:p,invertedOperations:m}),Ae(e),d=(0,_.TO)(n.getValue())}else d=v._QS(l,o.startIndex,o.endIndex),Pe({environment:t,store:n,value:d,transaction:i});nt({environment:t,store:n,oldTextValue:l,newTextValue:d,transaction:i,rootStore:u,removeInlineRecords:a}),r&&be.Z5({store:n,selection:{startIndex:c.startIndex,endIndex:c.startIndex}})}function Ie(e){const t=ee.default.state;if("editing"!==t.mode)return;if((0,D.iG)(t.multiSelection))return;const{start:n,end:o}=t.multiSelection,i="start"===e.direction?n:o;ee.default.setState({...t,multiSelection:{start:i,end:i}})}function xe(e){const{environment:t,disableMentions:n,disableDateMentions:o,disableDateReminderMentions:i,disableSlashCommands:r,disableEmojiCommands:a,disableFilters:l,disableTemplateVariableMentions:c,string:d,transaction:u,selectAll:p}=e;if("editing"!==ee.default.state.mode)return;const m="multiSelection"in e?e.multiSelection:(0,D.TD)(e),f=(0,D.QY)(m),g=f?{canRestore:!0,oldSelection:f,toTextValue:f.store.getValue()}:{canRestore:!1};Se({environment:t,multiSelection:m,transaction:u});const h=v.vJ3(d),b=s.p4(h).length;if(0===b)return;const y=(0,O.bj)(),_=v.V3y(h,y);Te({environment:t,store:m.start.store,tokens:[_],index:m.start.index,transaction:u,updateSelection:!1});const S={startIndex:p?m.start.index:m.start.index+b,endIndex:m.start.index+b};be.Z5({store:m.start.store,selection:S}),l||ve.f({environment:t,store:m.start.store,transaction:u}),g.canRestore&&(n||de._P({environment:t,textStore:g.oldSelection.store,oldSelection:g.oldSelection.selection,oldTextValue:g.toTextValue,disableDateMentions:o,disableDateReminderMentions:o||Boolean(i),disableTemplateVariableMentions:Boolean(c)}),r||he._P({environment:t,textStore:g.oldSelection.store,oldSelection:g.oldSelection.selection,oldTextValue:g.toTextValue}),a||ae._P({environment:t,textStore:g.oldSelection.store,oldSelection:g.oldSelection.selection,oldTextValue:g.toTextValue}))}function Ce(e){Te({...e,updateSelection:!0})}function Te(e){const{environment:t,store:n,index:o,transaction:i,selectAll:r,updateSelection:a}=e,l=e.tokens.map(v.Y_F);if(l.length){const r=n.getValue()||[];if(M.FX(n)){const t=(0,_.TO)((0,j.sQ)(n)),r=(0,_.TO)(t.getTextSliceTree()),a=new s.W3(v.eeV(n.getValue())).getStringStartIndex(o),{operations:c,invertedOperations:d}=r.getOperationsForInsertTextValue(a,l);ne.F({transaction:i,store:t,crdtOperations:c,invertedOperations:d}),Ae(e)}else{Pe({environment:t,store:n,value:v.P$X(r,l,o),transaction:i})}const a=n.getRecordStoreAtRootPath();if(a instanceof J.G){const e=u.zu(v.llS(l),...v.llS(r));for(const t of e){const e=F.x8(a);_e.applyOperation({transaction:i,store:e,operation:{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:t,after:void 0}}})}}}if(a){const e=v.eeV(l).length;be.Z5({store:n,selection:{startIndex:r?o:o+e,endIndex:o+e}})}}function Me(e){const{environment:t,store:n,value:o,transaction:i}=e;M.FX(n)?(ke({environment:t,store:n,selection:{startIndex:0,endIndex:1/0},transaction:i,updateSelection:!1,removeInlineRecords:!0}),o&&v.VrM(o)&&Te({environment:t,store:n,tokens:o,index:0,transaction:i,updateSelection:!1}),Ae(e)):Pe(e)}function Pe(e){const{store:t,value:n,transaction:o}=e;ue.sO({store:t,transaction:o,value:v.Zxt(n)}),Ae(e)}function Ae(e){const{environment:t,store:n}=e;if(!n.isTable("block"))return;const o=n.getRecordStoreAtRootPath();if(!o.inMemoryRecordCache.isMockTextStore){const e=o.getValue();e&&oe.ctm(t,{block_id:e.id,type:e.type,is_toggleable:(0,N._A)(e.type,e.format)})}}function Re(e){const{environment:t,multiSelection:n,annotation:o,transaction:i}=e,r=v.J7s(o),a=(0,B.L5)(n),s=!v.xw5(o)&&Boolean((0,O.a6)(r,n,{}));a.forEach((e=>{let{store:n,selection:a}=e;s?Ue({environment:t,store:n,annotationTypeOrKey:r,selection:a,transaction:i,updateSelection:!1}):Ve({environment:t,store:n,annotation:o,selection:a,transaction:i})}))}function De(e){const{environment:t,multiSelection:n,annotation:o,transaction:i}=e;(0,B.L5)(n).forEach((e=>{let{store:n,selection:r}=e;Ve({environment:t,store:n,annotation:o,selection:r,transaction:i})}))}function Be(e){const{environment:t,multiSelection:n,annotationTypeOrKey:o,transaction:i}=e;(0,B.L5)(n).forEach((e=>{let{store:n,selection:r}=e;Ue({environment:t,store:n,annotationTypeOrKey:o,selection:r,transaction:i,updateSelection:!1})}))}function Ee(e){const{environment:t,store:n,selection:o,annotation:i,transaction:r}=e;Re({environment:t,annotation:i,transaction:r,multiSelection:(0,D.TD)({store:n,selection:o})})}function Fe(e){const{environment:t,blocks:n,annotation:o,transaction:i}=e,r=v.J7s(o),a=u.oA(n.map((e=>{const t=e.getTitleStore();if(!t)return;const n=t.getValue();return n?{block:e,titleStore:t,titleValue:n}:void 0}))),s=a.every((e=>{let{titleValue:t}=e;return t.every((e=>v.hDy(e).some((e=>v.J7s(e)===r))))}));for(const{titleStore:l}of a)Ze({environment:t,annotation:o,textStore:l,action:s?"removeAnnotationType":"annotate",transaction:i})}function Ze(e){const{environment:t,annotation:n,transaction:o,textStore:i,action:r}=e;"annotate"===r?Ve({environment:t,store:i,annotation:n,selection:{startIndex:0,endIndex:1/0},transaction:o}):Ue({environment:t,store:i,annotationTypeOrKey:v.J7s(n),selection:{startIndex:0,endIndex:1/0},transaction:o,updateSelection:!1})}function Ve(e){const{environment:t,store:n,annotation:o,selection:i,transaction:r}=e,a=n.getValue();if(a)if(M.FX(n)){!function(e){const{blockStore:t,selection:n,annotation:o,transaction:i}=e;(0,_.T)(t.useCrdt());const r=t.getBlockTitleStore().getValue(),a=v.Ulv(r,n);if((0,O.wd)(a))return;const l=(0,_.TO)(t.getTextSliceTree()),c=new s.W3(v.eeV(r)),{startIndex:d,endIndex:u}=c.getInclusiveStringRangeForSelection(a),{operations:p,invertedOperations:m}=l.getOperationsForAddAnnotation(d,u,o);ne.F({transaction:i,store:t,crdtOperations:p,invertedOperations:m})}({blockStore:(0,_.TO)((0,j.sQ)(n)),selection:i,annotation:o,transaction:r})}else{Pe({environment:t,store:n,value:v.aSf({textValue:a,selection:i,annotation:o}),transaction:r})}}function je(e){Ue({...e,annotationTypeOrKey:e.type,updateSelection:!0})}function Ue(e){const{environment:t,store:n,selection:o,annotationTypeOrKey:i,transaction:r,updateSelection:a}=e,l=n.getValue();if(!l)return;let c;const d=n.isTable(m.iU)&&(0,j.sQ)(n)||n.getRecordStoreAtRootPath();d instanceof J.G&&M.Ls({store:n,blockStore:d})?(!function(e){const{blockStore:t,selection:n,annotationTypeOrKey:o,transaction:i}=e;(0,_.T)(t.useCrdt());const r=t.getBlockTitleStore().getValue(),a=v.Ulv(r,n);if((0,O.wd)(a))return;const l=(0,_.TO)(t.getTextSliceTree()),c=new s.W3(v.eeV(r));if("string"==typeof o&&v.WU4(o)){const e=o,n=[],s=[],d=v.fWo({textValue:r,startIndex:a.startIndex,endIndex:a.endIndex,annotationType:e});for(const{startIndex:t,endIndex:o,annotationKey:i}of d){const{startIndex:e,endIndex:r}=c.getInclusiveStringRangeForSelection({startIndex:t,endIndex:o}),{operations:a,invertedOperations:d}=l.getOperationsForRemoveAnnotation(e,r,i);n.push(...a),s.push(...d)}n.length>0&&ne.F({transaction:i,store:t,crdtOperations:n,invertedOperations:s})}else{const{startIndex:e,endIndex:n}=c.getInclusiveStringRangeForSelection(a),{operations:r,invertedOperations:s}=l.getOperationsForRemoveAnnotation(e,n,o);ne.F({transaction:i,store:t,crdtOperations:r,invertedOperations:s})}}({blockStore:d,selection:o,annotationTypeOrKey:i,transaction:r}),c=(0,_.TO)(n.getValue())):(c=v.STJ({textValue:l,selection:o,annotationTypeOrKey:i}),Me({environment:t,store:n,value:c,transaction:r})),a&&be.Z5({store:n,selection:o}),nt({environment:t,store:n,oldTextValue:l,newTextValue:c,transaction:r,rootStore:d,removeInlineRecords:!0})}function Le(e){const{environment:t,sourceStore:n,sourceIndex:o,targetStore:i,targetIndex:r,transaction:a}=e,s=v.lzi(n.getValue()),l=v.QaF(s).length,{tokensInsideRange:c}=v.xrQ(s,o,l);c.length>0&&(ke({environment:t,store:n,selection:{startIndex:o,endIndex:l},transaction:a,updateSelection:!0,removeInlineRecords:!1}),Ce({environment:t,store:i,tokens:c,index:r,transaction:a}))}function Oe(e){const{environment:t,closestSelectable:n,shiftKey:i,transaction:r}=e;if((0,B.Aw)(t))return void function(e){const{transaction:t}=e,n=ee.default.state;if("editing"!==n.mode)return;const{multiSelection:i}=n,r=(0,B.Nj)({multiSelection:i,includeNonSelectable:!0});if(!r)return;const{tree:a,treeRange:s}=r,l=a.value.store,c=b.o.getIndentOperationsFromTreeRange(s,e.direction);for(const o of c){const{target:e,operation:n}=o,i=(0,V.kC)({rootStore:l,root:a,target:e});if(void 0===i)throw new Error("Cannot find node to indent");let r=!1;switch(n){case"indentSelf":case"indentSelfAndSubtree":if(i.length>=2){const e=i[i.length-2],o=i[i.length-1];if(o){let i="indentSelf"===n?"self":"subtree";(0,N.BX)(o)&&!te.Z.isOpen(o.id)&&(i="subtree");void 0!==le.dD({block:o,parentStore:e,transaction:t,type:i})&&(r=!0)}}break;case"unindentSelfAndUpdateSiblings":if(i.length>=3){const e=i[i.length-3],n=i[i.length-2],o=i[i.length-1];if(n&&o){void 0!==le.uv({block:o,parentStore:n,grandparentStore:e,transaction:t})&&(r=!0)}}}r&&b.F.applyMutable(a,o)}o.default.afterNextFlush((()=>{const e=(0,V.kC)({rootStore:l,root:a,target:s.start}),t=(0,V.kC)({rootStore:l,root:a,target:s.end}),n=e&&(0,j.mh)(e[e.length-1]),o=t&&(0,j.mh)(t[t.length-1]);if(n&&o){const e={start:{store:n,index:i.start.index},end:{store:o,index:i.end.index}};be.NA({multiSelection:e})}}))}({environment:t,transaction:r,direction:e.shiftKey?"unindent":"indent"});const a=i?le.rB({environment:t,blocks:[n],transaction:r}):le.WY({environment:t,blocks:[n],transaction:r});if(!a)return;const s=ee.default.state;if("editing"===s.mode){var l;const e=null===(l=(0,B.xI)("textActions",s.multiSelection))||void 0===l?void 0:l.selection;if(!e)return;o.default.afterNextFlush((()=>{const o=W.C.findSelectableFromStore(a[0]);if(ge.wI({store:n,replace:a[0]}),o){const n=(0,j.mh)(o.props.store);n?be.Z5({store:n,selection:e}):ge.$Y({environment:t,phase:X.SelectionPhase.Selected})}}))}}function Ne(e){const{transaction:t,direction:n}=e,i=ee.default.state;if("editing"!==i.mode)return;const{multiSelection:r}=i,a=(0,B.tp)({multiSelection:r,filterCommonAncestors:!0,focus:void 0});if(!a)return;const s=a.stores;("up"===n?le.A1({transaction:t,blocks:s}):le.vi({transaction:t,blocks:s}))&&o.default.afterNextFlush((()=>{const[e,t]=W.C.findSelectablesFromIds([r.start.store.id,r.end.store.id]),n=(null==e?void 0:e.props.store)&&(0,j.mh)(null==e?void 0:e.props.store),o=(null==t?void 0:t.props.store)&&(0,j.mh)(null==t?void 0:t.props.store);n&&o&&(be.NA({multiSelection:{start:{store:n,index:r.start.index},end:{store:o,index:r.end.index}},forceEmit:!0}),fe.Zv())}))}function ze(e){const{transaction:t,environment:n,multiSelection:o}=e;o&&!(0,D.qS)(o)&&Se({environment:n,transaction:t,multiSelection:o}),We({...e,usingMultiSelection:!0})}function We(e){const{environment:t,store:n,newValue:o,disableMentions:i,disableDateMentions:r,disableSlashCommands:a,disableEmojiCommands:l,disableDateReminderMentions:c,disableFilters:d,disableTemplateVariableMentions:u,transaction:p,usingMultiSelection:m}=e,f=n.getValue(),g=v.QaF(f),h=U.UZ(g,o),b=ee.default.state;if("editing"!==b.mode)return;const y=b.multiSelection.start.index;let _=0;for(let v=0;v<h.length;v++){const e=h[v];if(_+s.p4(e[1]).length>y){if(e[0]===U.JZ){const t=h[v-1],n=h[v+1];let o=h[v-2],i=h[v+2];if(n&&n[0]===U.D$)for(i||(i=[U.JZ,""],h.push(i));_+s.p4(e[1]).length>y&&e[1].endsWith(n[1]);)e[1]=e[1].slice(0,e[1].length-n[1].length),i[1]=n[1]+i[1];else if(t&&t[0]===U.D$)for(o||(o=[U.JZ,""],h.unshift(o));_+s.p4(e[1]).length>y&&e[1].startsWith(t[1]);)e[1]=e[1].slice(t[1].length),o[1]=o[1]+t[1],_-=s.p4(t[1]).length}break}_+=s.p4(e[1]).length}let S=!1,w=!1,k=0;for(const[I,x]of h)if(I===U.D$)S=!0,xe({environment:t,store:n,selection:{startIndex:k,endIndex:k},string:x,disableMentions:i,disableDateMentions:r,disableDateReminderMentions:c,disableSlashCommands:a,disableEmojiCommands:l,disableFilters:d,disableTemplateVariableMentions:u,transaction:p}),k+=s.p4(x).length;else if(I===U.NL){S=!0,w=x===v.qyI;we({environment:t,store:n,selection:{startIndex:k,endIndex:k+s.p4(x).length},transaction:p})}else I===U.JZ&&(k+=s.p4(x).length);!S||w||t.TextSelectionCompositionStore.state.isComposing||qe({environment:t,store:n,usingMultiSelection:m})}function qe(e){const{environment:t,usingMultiSelection:n,store:o}=e;if(n){const e=L.get(),t=(0,B.fx)({range:e,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0});t&&be.NA(t)}else{const e=P.Ut(t);e&&(be.Z5({store:o,selection:e.selection}),e.forceEmitSelectionStore&&ee.default.emit())}}function He(e){const{environment:t,store:n,selection:o,annotation:i,analyticsFrom:r,transaction:a}=e;we({environment:t,store:n,selection:o,transaction:a});const s=(0,O.yj)(o,n),l=[v.YCD(i,s),v.V3y(" ",s)];if(Ce({environment:t,store:n,tokens:l,index:o.startIndex,transaction:a}),be.Z5({store:n,selection:{startIndex:o.startIndex+l.length,endIndex:o.startIndex+l.length}}),v.IWo(i)&&(n.isTable("block")||n.isTable("comment"))){const e=t.currentUser.id,o=v.zEN(i),a=n.getRecordStoreAtRootPath();e&&oe.TIz(t,{is_current_user:o===e,user_id:o,from:r,block_type:a instanceof J.G?a.getType():void 0})}else if(v._bk(i)&&(n.isTable("block")||n.isTable("comment"))){var c;const e=null===(c=v.kxk(i))||void 0===c?void 0:c.groupId,o=n.getRecordStoreAtRootPath();e&&oe.Z0d(t,{group_id:e,from:r,block_type:o instanceof J.G?o.getType():void 0})}else if(v.fpG(i)&&(n.isTable("block")||n.isTable("comment"))){const e=v.zyO(i),o=n.getRecordStoreAtRootPath();oe.VN$(t,{date:e,from:r,block_type:o instanceof J.G?o.getType():void 0})}else if(v.STW(i)&&(n.isTable("block")||n.isTable("comment"))){const e=v.TOT(i),o=n.getRecordStoreAtRootPath();oe.Qqh(t,{page_id:e,from:r,block_type:o instanceof J.G?o.getType():void 0})}}function Ke(e){const{environment:t,store:n,selection:o,emoji:i,transaction:r}=e;we({environment:t,store:n,selection:o,transaction:r});const a=[v.V3y(i)];Ce({environment:t,store:n,tokens:a,index:o.startIndex,transaction:r}),be.Z5({store:n,selection:{startIndex:o.startIndex+a.length,endIndex:o.startIndex+a.length}})}function Ge(e){const{environment:t,shouldStripTokens:n,disableFilters:o,store:i,selection:r,transaction:a}=e,l=(0,O.fM)(i,r,n),c=n?v.Jcv(i.getValue()):v.QaF(i.getValue());let d=s.p4(c),p=0;for(const s of l)if(p++,0===s)d.unshift("\t");else{const e=s+p;d=[...u.tP(d,0,e),"\t",...u.tP(d,e)]}We({environment:t,store:i,newValue:v.vJ3(d.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:o,transaction:a}),be.Z5({store:i,selection:{startIndex:r.startIndex+1,endIndex:r.endIndex+p}})}function $e(e){const{environment:t,shouldStripTokens:n,disableFilters:o,store:i,selection:r,transaction:a}=e,l=(0,O.fM)(i,r,n),c=n?v.Jcv(i.getValue()):v.QaF(i.getValue());let d=s.p4(c),p=0,m=0;for(const s of l){const e=s-p;0===e?"\t"===d[0]?(d=u.tP(d,1),p+=1):" "===d[0]&&" "===d[1]?(d=u.tP(d,2),p+=2):" "===d[0]&&(d=u.tP(d,1),p+=1):"\t"===d[e+1]?(d=[...u.tP(d,0,e+1),...u.tP(d,e+2)],p+=1):" "===d[e+1]&&" "===d[e+2]?(d=[...u.tP(d,0,e+1),...u.tP(d,e+3)],p+=2):" "===d[e+1]&&(d=[...u.tP(d,0,e+1),...u.tP(d,e+2)],p+=1),s<=r.startIndex&&(m=p)}We({environment:t,store:i,newValue:v.vJ3(d.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:o,transaction:a}),be.Z5({store:i,selection:{startIndex:r.startIndex-m,endIndex:r.endIndex-p}})}function Qe(e){const{token:t,store:n,readOnly:o}=e;let i=0,r=0;if(t.textValue){let e=0;for(;e<t.tokenIndex;)i+=v.J1x(t.textValue[e]),e++;r=i+v.J1x(t.textValue[e])}be.Z5({store:n,selection:{startIndex:i,endIndex:r},readOnly:o})}function Ye(e){const{environment:t,event:n,interactiveToken:o,store:s,parentStore:l,canEdit:c}=e,d=v.hDy(o.textToken),u=v.rlz(d),b=v.wPk(d),_=v.V8Y(d),x=v.jC0(d),T=v.zrg(d).map((e=>v.h19(e))),M=t.RouterStore.state.route,P=Boolean("chat"===M.name);if(v.YrK(o.textToken)&&!n.shiftKey&&!n.altKey){if(n.preventDefault(),!K.Z.state.open){const e=o.textToken,n=document.createRange(),i=o.node.parentNode,r=o.tokenIndex+1;if(n.setStart(i,o.tokenIndex),n.setEnd(i,r),L.set(n,t.device),qe({environment:t,store:s,usingMultiSelection:!0}),"editing"!==ee.default.state.mode)return;const a=(0,D.QY)(ee.default.state.multiSelection);if(!a)return;return void se.qn({environment:t,selectedToken:{token:e,position:a.selection},selectionRect:o.node.getBoundingClientRect(),analyticsFrom:"click_token"})}se.Wj()}const B=T.map((e=>{const t=l||s;return J.t1.createChildStore(t,{table:g.qF,id:e,spaceId:(0,h.C)(t.pointer.spaceId)})})),{unresolved:V}=F.bB(B);if(V.length>0){const e=Boolean(u||_),o=H.Z.state.open||t.device.isMobile,i=(0,j.sQ)(s);if(e&&o)S.LZ();else if(i){const r=n.target&&n.target.getBoundingClientRect();if(S.Ib({environment:t,blockStore:i,analyticsFrom:"existing_comment",discussionIds:V.map((e=>e.id)),rect:r,shouldFocusDiscussion:!1,recursivelyLoadAllDiscussions:!1}),e&&!o)return void n.preventDefault()}}else{F.dv(s)||z.Z.find((e=>e.isEditing()))||S.LZ()}let U,O;u&&(U=y.Nm({str:v.zW$(u),allowNoProtocol:!0}));let N=!1;if(_){O=v.TOT(_);const e=J.G.createChildStore(l||s,{table:m.iU,id:O});N=e.isNavigableBlock();const o=(n.altKey||Q.default.isSidePeekOpen())&&!n.metaKey;U=(0,R.ZP)({store:e,openInSidePeek:o,preferPublicLink:(0,Z.Sr)(),getSpaceDomain:()=>{var n;return null===(n=Y.Z.getPublicSpaceData(t,e.getSpaceId()))||void 0===n?void 0:n.domain},pageVisitSource:i.tY.LinkInPage})}if(x){const{blockId:e}=v.Vv0(x);if(e){const o=J.G.createChildStore(l||s,{table:m.iU,id:e});N=o.isNavigableBlock(),U=P&&!n.metaKey?(0,r.t)({blockId:o.id,pageVisitSource:i.tY.LinkInPage}):(0,R.ZP)({store:o,openInSidePeek:!1,preferPublicLink:(0,Z.Sr)(),getSpaceDomain:()=>{var e;return null===(e=Y.Z.getPublicSpaceData(t,o.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:i.tY.LinkInPage})}}if(U){n.preventDefault(),be.ZH(t),ye.lY();const{device:e}=t;if(e.isIOS&&be.sD(),n.shiftKey&&!n.altKey)return;const o=(0,p.Wj)({url:U,baseUrl:C.default.domainBaseUrl,publicDomainName:C.default.publicDomainName,isMobile:t.device.isMobile,protocol:C.default.protocol,currentUrl:window.location.href});if("page"===o.name||"chat"===o.name){const e=A.DJ(n);if(me.c4({environment:t,url:U,openInNew:e}),_&&O&&oe.SK1(t,{page_visit_id:$.$g.getCurrentPageVisitId(),mentioned_page_id:O,source_type:"inline_page_mention_token",hover_preview_enabled:G.default.checkGate("first_party_links"),is_navigable_block:N}),s.inMemoryRecordCache.isSyntheticAssistantData){const e=q.Z.getActiveAssistantConfigurationState(),n="page"===o.name?o.blockId:o.peekViewBlockId;e&&n&&I.trackQnaResultClicked(t,{configurationState:e,clickedPageId:n,source:"chat"})}}else{if("aiGtmFavoriteImport"===o.name&&t.currentUser.isLoggedIn())return void(0,k.importGtmFavorite)({environment:t,importArgs:o});pe.D({environment:t,url:U})}}else{if(c){const{textToken:e,node:i,tokenIndex:r}=o,a=v.hDy(e);if(v.K9C(a))return ye.lY(),w.b(t,{originRect:i.getBoundingClientRect(),textStore:s,tokenIndex:r,allowReminders:"comment"!==s.table}),void n.preventDefault()}if(b){const e=J.T5.createChildStore(s,{table:f.x_,id:b[1],spaceId:b[2]}),o=e.getModel();if(!o)return;const r=E.Dg(e);if(!r)return;const l=J.jQ.createChildStore(r,o.getParentPointer()).getModel();if(!l)return;const c=J.G.createChildStore(r,l.getParentPointer()).getModel(),d=c&&"table_row"===c.getType()?c.getParentId():l.getParentId(),u=(0,a.Z)({pageId:r.id,scrollToBlockId:d,pageModel:r.getModel(),baseUrl:void 0,discussionId:l.id,pageVisitSource:i.tY.MentionInPage});n.preventDefault(),me.c4({environment:t,url:u})}}}function Je(e){const{environment:t,event:n,interactiveToken:o,store:i,parentStore:r}=e;if(!r)return;const a=v.hDy(o.textToken),s=v.V8Y(a);if(s){const e=v.yrl(s);if(!e)return;const o=J.G.createChildStore(r||i,e);n.preventDefault(),ie.Qn({environment:t,stores:[o],left:n.clientX,top:n.clientY,showInput:!1,actionSectionGroupKey:"page_mention",analyticsFrom:"page_mention_block_menu",pageAnnotationToken:{parentStore:r,pageAnnotation:s}})}}function Xe(e){ye.HM({token:e.interactiveToken,store:e.store})}function et(e){ye.lY()}function tt(e){const{blockStore:t,discussionIds:n,transaction:o}=e;if(t)for(const i of n){const e=J.t1.createChildStore(t,{table:g.qF,id:i,spaceId:(0,h.C)(t.pointer.spaceId)});x.Gu({discussionStore:e,blockStore:t,transaction:o})}}function nt(e){const{store:t,environment:n,oldTextValue:o,newTextValue:i,transaction:r,rootStore:a,removeInlineRecords:s}=e;if(a instanceof J.G){const e=new Set(u.zu(v.llS(o),...v.llS(i)));if(tt({blockStore:a,discussionIds:e,transaction:r}),a.isType("table_row")){tt({blockStore:a.getParentBlockStore(),discussionIds:e,transaction:r})}}if(s){if(a instanceof J.G){const e=a.getValue();if(e){const s=(0,d.m3)({parentBlock:e,oldTextValue:o,newTextValue:i,getRecordValue:t.getRecordValue,baseUrl:C.default.domainBaseUrl,publicDomainName:C.default.publicDomainName});ce.lP({environment:n,transaction:r,parentStore:a,inlinePageIds:s})}}const e=u.zu(v.zUo(o),...v.zUo(i));for(const t of e){const e=J.G.createChildStore(a,{table:m.iU,id:t,spaceId:(0,h.C)(a.pointer.spaceId)});ue.sW({store:e,data:{alive:!1},transaction:r})}}}function ot(e){const{block:t,transaction:n,tokenIndex:o}=e,i=t.getBlockTitleStore();if(!t.getTitleStore()||!i.isDefined()||!i.getValue()||i.getValue().length<o)return!1;const r=i.getValue(),a=v.VrM(r.slice(0,o)),s=v.VrM(r.slice(0,o+1));return ke({environment:t.environment,store:i,selection:{startIndex:a,endIndex:s},transaction:n,updateSelection:!1,removeInlineRecords:!0}),!0}function it(e){var t;const{store:n,transaction:o}=e,i=re.tk();if(!i)return;if(!("editing"===ee.default.state.mode&&(null===(t=(0,D.QY)(ee.default.state.multiSelection))||void 0===t?void 0:t.selection)))return;const r=n.getValue();if(!r)return;const a=(0,l.UQ)(r,i.parentCollection,n.getRecordModel);Me({environment:n.environment,store:n,value:a,transaction:o})}},98724:(e,t,n)=>{n.d(t,{QE:()=>h,aS:()=>f,bt:()=>v,mX:()=>g});var o=n(72126),i=n(70203),r=n(63143),a=n(45162),s=n(65598),l=n(89086),c=n(24666),d=n(9953),u=n(993),p=n(98104),m=n(82530);function f(e){const{environment:t,annotation:n}=e,o=c.default.state;if("editing"!==o.mode)return;if(c.default.isEmptySelection())return void p.Km({annotation:n});const{multiSelection:i}=o;(0,a.L5)(i).length>0&&(m.createAndCommit({userAction:"textAnnotationActions.annotateSelection",environment:t,perform:e=>{u.MY({environment:t,annotation:n,multiSelection:i,transaction:e})}}),p.NA({multiSelection:i}))}function g(e){const{environment:t,annotationType:n}=e,o=c.default.state;if("editing"!==o.mode)return;if(c.default.isEmptySelection())return;const{multiSelection:i}=o,r=(0,a.L5)(i);r.length>0&&(m.createAndCommit({userAction:"textAnnotationActions.unannotateSelection",environment:t,perform:e=>{for(const{selection:o,store:i}of r)u.Be({environment:t,store:i,type:n,selection:o,transaction:e})}}),p.NA({multiSelection:i}))}function h(e){const{environment:t,annotationType:n,blocks:o,transaction:i}=e;for(const r of(0,s.Sd)({blockStores:o,traverseTransclusionReferences:!1})){const e=r.getBlockTitleStore(),o=(0,l.P2)(e);o&&u.Be({environment:t,store:e,type:n,selection:o,transaction:i})}}function v(e){const{store:t,context:n,transaction:a}=e;if(!t.canEdit())return;const s=(0,r.m8)(o.oA(Object.entries(t.getProperties()).map((e=>{let[t,r]=e;if(!r)return;const a=r.map((e=>i.sBO(e,n)));return o.Xy(r,a)?void 0:[t,a]}))));o.xb(s)||d.sW({store:t.getPropertiesStore(),data:s,transaction:a})}},56971:(e,t,n)=>{n.d(t,{YV:()=>M,as:()=>T,ew:()=>C});n(67635);var o=n(1302),i=n(41432),r=n(72126),a=n(78791),s=n(65273),l=n(68056),c=n(73959),d=n(89086),u=n(35328),p=n(28685),m=n(95802),f=n(77080),g=n(24666),h=n(96802),v=n(44886),b=n(94419),y=n(42858),_=n(24677),S=n(993),w=n(98104),k=n(68422);function I(e){const{transaction:t,store:n,block:o,targetStore:i,targetBlock:r}=e;o&&(0,s.Ls)({store:n,blockStore:o})&&r&&(0,s.Ls)({store:i,blockStore:r})?a.tE({transaction:t,targetStore:i,block:o}):x(e)}function x(e){const{environment:t,transaction:n,store:o,targetStore:i}=e,r=(0,d.x0)(i);r?S.gc({environment:t,sourceStore:o,sourceIndex:0,targetStore:i,targetIndex:r.endIndex,transaction:n}):S.pe({environment:t,transaction:n,store:o,selection:{startIndex:0,endIndex:1/0}})}function C(e){const{environment:t,store:n,transaction:r}=e;r.annotateWithUserAction("textBackspaceActions.annotatedContentBlockBackspaceAtBeginning");const a=(0,c.sQ)(n);if(a){"callout"===a.getType()&&h.FH({stores:[a],update:{block_color:void 0},transaction:r});let e=a,n=i.Ti.text;if(u.fn(a)){const e=a.getType();e&&(n=e)}e=k.vs({environment:t,block:a,blockType:n,transaction:r}),o.default.afterNextFlush((()=>{const n=m.C.findEditableStoreWithin(e);n&&(w.N_({store:n}),_.eP({environment:t,store:e}))}))}return n}function T(e){const{environment:t,multiSelection:n,transaction:a,deleteForwards:s,event:k}=e,T=t.device.isApple&&k.metaKey,M=!(t.device.isIOS&&(0,l.iG)(n));w.aJ();const P=(0,l.QY)(n);if(P&&0===P.selection.startIndex&&0===P.selection.endIndex&&!s){const{store:e}=P;k.preventDefault();const n=(0,c.sQ)(e);if(n){const s=n.getModel();if(s){const n=s.isType(i.q7);n&&!T?C({environment:t,store:e,transaction:a}):s.isType(i.Q3)||n&&T?function(e){const{store:t,transaction:n,environment:i}=e;n.annotateWithUserAction("textBackspaceActions.textBackspaceAtBeginning");const a=(0,c.sQ)(t);if(!a)return;const s=(0,c.sQ)(a),l=s&&(0,c.sQ)(s);if(s&&l){const e=s.getRenderableContentIds()??[];if(!(r.Z$(e)!==a.id||s.isTransclusionType()||u.BX(s)&&r.Ps(e)===a.id||"tab"===l.getType())){const e=v.uv({block:a,parentStore:s,grandparentStore:l,transaction:n});if(e)return void o.default.afterNextFlush((()=>{if(e){const t=m.C.findEditableStoreWithin(e);t&&(_.eP({environment:i,store:e}),w.N_({store:t}))}}))}}if(f.default.checkGate("text_align")){if("center"===a.getFormat().block_alignment)return void h.hc({environment:i,store:a,alignment:"left",transaction:n});if("right"===a.getFormat().block_alignment)return void h.hc({environment:i,store:a,alignment:"center",transaction:n})}const g=p.E.getMembersByDOMOrder({filter:e=>!e.props.store.inMemoryRecordCache.isMockTextStore}),S=r.cx(g,(e=>e.props.store===t)),k=r.dF(g,((e,t)=>t<S&&e.props.canInsertText));let x;if(k&&(x=k.props.store),x&&a){const e=(0,d.x0)(x),o=(0,c.sQ)(x);if(I({environment:i,transaction:n,store:t,block:a,targetStore:x,targetBlock:o}),w.Z5({store:x,selection:e}),_.eP({environment:i,store:o}),!u.BX(a)&&s){const e=a.getContentStores();for(const i of e)b.Vt({parent:s.getContentStore(),before:a,insert:i,transaction:n});const t=a.getContentStore(),o=a.getContentStores();for(const i of o)b.Od({parent:t,childToRemove:i,transaction:n})}y.Od({store:a,transaction:n})}}({environment:t,store:e,transaction:a}):s.isType(i.oe)&&function(e){const{environment:t,store:n,transaction:o}=e;o.annotateWithUserAction("textBackspaceActions.captionBackspaceAtBeginning");const i=p.E.getMembersByDOMOrder({filter:()=>!0}),r=i.findIndex((e=>e.props.store===n)),a=i.findLast(((e,t)=>t<r&&e.props.canInsertText)),s=null==a?void 0:a.props.store;if(!s)return;if(!(0,c.sQ)(n))return;const l=(0,d.x0)(s);x({environment:t,store:n,targetStore:s,transaction:o}),w.Z5({store:s,selection:l});const u=(0,c.sQ)(s);_.eP({environment:t,store:u})}({environment:t,store:e,transaction:a})}}}else P&&(0,d.J_)(P.store,P.selection)&&s?(k.preventDefault(),function(e){const{environment:t,store:n,transaction:o}=e;o.annotateWithUserAction("textBackspaceActions.textDeleteAtEnd");const i=p.E.getMembersByDOMOrder({filter:()=>!0}),a=r.cx(i,(e=>e.props.store===n)),s=i.find(((e,t)=>Boolean(t>a&&e.props.canInsertText)));let l;s&&(l=s.props.store);const d=(0,c.sQ)(n);if(d&&l){const e="readOnly"===g.default.state.mode,i="empty"!==g.default.state.mode&&g.default.state.multiSelection,r=(0,c.sQ)(l);if(I({environment:t,transaction:o,store:l,block:r,targetStore:n,targetBlock:d}),r){const t=(0,c.sQ)(r);if(t){const e=r.getContentStore(),n=r.getContentStores();for(const i of n)b.Od({parent:e,childToRemove:i,transaction:o}),b.Vt({parent:t.getContentStore(),before:r,insert:i,transaction:o})}y.Od({store:r,transaction:o}),i&&w.NA({multiSelection:i,readOnly:e})}}}({environment:t,store:P.store,transaction:a})):M&&(k.preventDefault(),function(e){const{environment:t,multiSelection:n,transaction:o,deleteForwards:i}=e;let r;o.annotateWithUserAction("textBackspaceActions.textBackspaceWithinContent"),r=(0,l.iG)(n)?i?{start:n.start,end:{store:n.start.store,index:n.start.index+1}}:{start:{store:n.start.store,index:n.start.index-1},end:n.start}:n,S.pz({environment:t,multiSelection:r,transaction:o})}({environment:t,multiSelection:n,deleteForwards:s,transaction:a}));const A=g.default.state;"editing"===A.mode&&(0,d.ST)(A.multiSelection.start.store.getValue(),A.multiSelection.start.index-1,"c")&&w.aR({annotation:["c"],extend:!0})}function M(e){const{event:t,multiSelection:n,device:o}=e;return(o.isApple&&t.metaKey||!o.isApple&&t.ctrlKey||o.isApple&&t.altKey)&&!(0,d.dQ)(n)}},74284:(e,t,n)=>{n.d(t,{IO:()=>P,PF:()=>D});n(52262),n(24506);var o=n(1302),i=n(41432),r=n(72126),a=n(21202),s=n(70203),l=n(82798),c=n(78791),d=n(68056),u=n(73959),p=n(35328),m=n(77080),f=n(26136),g=n(24666),h=n(45131),v=n(34583),b=n(50906),y=n(44886),_=n(94419),S=n(9953),w=n(61045),k=n(24677),I=n(993),x=n(56971),C=n(98104),T=n(29373);function M(e){const t=(0,u.sQ)(e.store);if(t&&function(e){var t;const n=e.getType();return!!n&&(!!(0,i.he)(n)&&!(e.id!==(null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getRenderableContentIds().at(-1))))}(t)){const n=y.rB({environment:e.environment,blocks:[t],transaction:e.transaction});if(n)return void o.default.afterNextFlush((()=>{const e=n[0].getTitleStore();e&&C.NA({multiSelection:{start:{store:e,index:0},end:{store:e,index:0}}})}))}x.ew(e)}function P(e){const{environment:t,transaction:n,multiSelection:a}=e;v.M_(t)&&((0,u.x7)(a.start.store)?function(e){const{environment:t,transaction:n}=e;let r=e.multiSelection;const a=(0,u.sQ)(r.start.store);if(!a||a.isCollectionView())return;I.pz({environment:t,multiSelection:r,transaction:n});const s=g.default.state;r="editing"===s.mode&&s.multiSelection||r;const l=r.start.store,c=S.j4({environment:t,type:i.Ti.text,inMemoryRecordCache:l.inMemoryRecordCache,transaction:n,spaceId:a.pointer.spaceId,useCrdt:a.useCrdt()}),d=_.Ce({parent:a.getContentStore(),prepend:c,transaction:n}).child;D({environment:t,block:a,store:l,targetBlock:d,splitAtIndex:r.start.index,transaction:n}),o.default.afterNextFlush((()=>{C.N_({store:d.getBlockTitleStore()})})),b.W2j(t,{from:"text_enter",type:i.Ti.text,creating_block_id:c.id})}(e):(0,d.iG)(a)&&function(e){const t=e.getRecordStoreUIParent();return t instanceof f.G&&e&&t.isType(i.q7)&&0===s.QaF(t.getTitleValue()).length}(a.start.store)?M({environment:t,transaction:n,store:a.start.store}):(0,d.ko)(a)&&A(a.start.store)&&R(a.start.store)?function(e){var t;const{environment:n,transaction:a,multiSelection:l}=e,c=l.start.store,d=(0,u.sQ)(c);if(!d)return;const m=d.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(d)})),f=(0,u.sQ)(d);if(!m||!f)return;const g=S.j4({environment:n,type:m.type,inMemoryRecordCache:c.inMemoryRecordCache,transaction:a,spaceId:f.pointer.spaceId,properties:m.properties?B(m.properties):void 0,format:m.format?E(m.format):void 0,permissions:m.permissions,useCrdt:Boolean(null===(t=m.format)||void 0===t?void 0:t.use_crdt)}),{id:v,space_id:y,properties:k,format:I,permissions:x,discussions:C,...M}=m,P=r.zu(C,...s.llS(c.getValue()));S.sW({store:g,data:{...M,discussions:P},transaction:a});const R=_.BE({parent:f.getContentStore(),after:d,insert:g,transaction:a}).child;if(A(c)&&d){const e=d.getContentStores(),t=d.getContentStore(),n=g.getContentStore();for(const o of e)_.Od({parent:t,childToRemove:o,transaction:a}),_.R3({parent:n,append:o,transaction:a})}(0,p.BX)(d)&&T.rd({blockId:g.id,state:h.Z.isOpen(d.id),currentUserId:n.currentUser.id}),(0,i.he)(m.type)||S.sW({store:d,transaction:a,data:{type:i.Ti.text}}),S.sO({store:d.getDiscussionsStore(),transaction:a,value:[]}),D({environment:n,block:d,store:c,targetBlock:R,splitAtIndex:l.start.index,transaction:a}),b.W2j(n,{from:"text_enter",type:i.Ti.text,creating_block_id:g.id}),n.device.isMobile&&o.default.afterNextFlush((()=>w.hQ(n)))}(e):function(e){var t;const{environment:n,transaction:o}=e;let r=e.multiSelection;const a=(0,u.sQ)(r.start.store);if(!a)return;const s=(0,u.sQ)(a);if(!s)return;I.pz(e);const l=g.default.state;r="editing"===l.mode&&l.multiSelection||r;const c=r.start.store,d=a.getType(),f=a.getContentLength(),v=a.getModel();let y;if((0,p.BX)(a)&&h.Z.isOpen(a.id))y=i.Ti.text;else if(v&&f>0&&v.isType(i.nH)){y=i.Ti.text;const e=a.getContentStores()[0];if(e){const t=e.getType();e.isDefined()&&t&&i.kC[t]&&(y=t)}}else y=!(d&&v&&!v.isType(i.Q2)&&A(c)&&R(c)&&"code"!==d)||v.isType("ai_block")&&v.isSkillBlock()?i.Ti.text:d;const w=S.j4({environment:n,type:y,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:s.pointer.spaceId,format:{block_alignment:m.default.checkGate("text_align")?null===(t=a.getFormat())||void 0===t?void 0:t.block_alignment:void 0},useCrdt:a.useCrdt()}),k=s.getRenderableContentIds()||[];let x,C=!1;if((0,p.BX)(a)&&h.Z.isOpen(a.id)){const e=a.getContentStore();C=!0,x=_.Ce({parent:e,prepend:w,transaction:o})}else if(v&&f&&v.isType(i.nH)){const e=a.getContentStore();C=!0,x=_.Ce({parent:e,prepend:w,transaction:o})}else if(null!=v&&v.isType("ai_block")&&v.isSkillBlock()){const e=a.getContentStore();C=!0,x=_.Ce({parent:e,prepend:w,transaction:o})}else x=k.indexOf(a.id)>=0?_.BE({parent:s.getContentStore(),after:a,insert:w,transaction:o}):_.Ce({parent:s.getContentStore(),prepend:w,transaction:o});const T=x.child;if(A(c)&&d&&!C&&!(0,p.BX)(a)){const e=a.getContentStores(),t=a.getContentStore(),n=T.getContentStore();for(const i of e)_.Od({parent:t,childToRemove:i,transaction:o}),_.R3({parent:n,append:i,transaction:o})}D({environment:n,block:a,store:r.start.store,targetBlock:T,splitAtIndex:r.start.index,transaction:o}),b.W2j(n,{from:"text_enter",type:y,creating_block_id:w.id,is_toggleable:(0,p._A)(y,w.getFormat())})}(e),t.device.isMobile||o.default.afterNextFlush((()=>{w.Zv()})))}function A(e){if(e.table===a.iU){const t=f.G.createChildStore(e,{table:a.iU,id:e.id}).getType();return t&&!(0,i.S9)(t)}return!1}function R(e){if(e.table===a.iU){const t=f.G.createChildStore(e,{table:a.iU,id:e.id}).getModel();return t&&!t.isType(i.oe)&&!t.isType(i.Ok)}return!1}function D(e){const{environment:t,block:n,store:o,targetBlock:i,splitAtIndex:r,transaction:a}=e,s={store:o,index:r},u={start:s,end:s};if(n.useCrdt()&&n.getBlockTitleStore()===o){(0,l.T)(i.useCrdt(),"Calling splitText() with a non-CRDT target block is not currently supported");(0,d.NV)(u)||c.Wc({sourceBlockStore:n,targetBlockStore:i,splitAtGraphemeIndex:r,transaction:a,moveIntoNewBlock:!0})}else I.gc({environment:t,sourceStore:u.end.store,sourceIndex:u.end.index,targetStore:i.getBlockTitleStore(),targetIndex:0,transaction:a});k.eP({environment:t,store:i}),C.N_({store:i.getBlockTitleStore()})}function B(e){const{title:t,...n}=e;return n}function E(e){const{text_slice_tree:t,text_clocks:n,...o}=e;return o}},17269:(e,t,n)=>{n.d(t,{G:()=>q,f:()=>H});n(97391),n(57658);var o=n(41432),i=n(15095),r=n(72126),a=n(38737),s=n(21202),l=n(70203),c=n(82798),d=n(11342),u=n(40959),p=n(83631);function m(e,t){return i.p4(e.substring(0,t)).length}var f=n(68056),g=n(99445),h=n(73959),v=n(35328),b=n(26136),y=n(27724),_=n(24666),S=n(50906),w=n(47839),k=n(96802),I=n(42858),x=n(24677),C=n(993),T=n(74284),M=n(98104),P=n(82530),A=n(68422);function R(e){var t;const{environment:n,store:r,toBlockType:a,matchRegex:s,insertTextAfter:d,transaction:p,postTransformAction:m}=e,g="editing"===_.default.state.mode&&(null===(t=(0,f.QY)(_.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!g)return;const w=i.p4(l.QaF(r.getValue())).slice(0,g.endIndex).join(""),k=s.exec(w);if(!k)return;const P=r.getRecordStoreUIParent();if(!(P&&P instanceof b.G))return;const R=P.getType();if(!R)return;if(R!==o.Ti.text&&!o.q7[R])return;const D=a(k);if(void 0===D||D===R)return;let B=D;P instanceof b.G&&("toggle"===D&&(0,o.zp)(P.getType())?B=v.m1(R):"toggle"===R&&v.JO(D)&&(B=v.m1(D)),A.vs({environment:n,block:P,blockType:B,transaction:p}));const E={startIndex:0,endIndex:k&&i.p4(k[0]).length||0};if(C.pe({environment:n,store:r,selection:E,transaction:p}),d){const e=I.aO({environment:n,selection:y.default.state.stores,createBlockItem:u.Hc[o.Ti.text],analyticsFrom:"divider"===D?"divider_block_transform":"text_filter_actions",transaction:p});e&&(T.PF({environment:n,block:(0,c.TO)((0,h.sQ)(r)),store:r,targetBlock:e,splitAtIndex:0,transaction:p}),x.eP({environment:n,store:e}),M.N_({store:e.getBlockTitleStore()}))}m&&m(k),S.g_k(n,{type:D})}function D(e){var t,n;const{environment:o,store:r,transaction:a,regex:s,length:c,analyticsType:d,replace:u}=e,p="editing"===_.default.state.mode&&(null===(t=(0,f.QY)(_.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!p)return;const g=r.getValue()||[],h=l.QaF(g),v=i.p4(h).slice(0,p.endIndex).join(""),b=s.exec(v);if(!b)return;const y=m(h,b.index),w={startIndex:y,endIndex:y+c},k=r.getValue()||[];if(l.oP(k,w.startIndex,w.endIndex,"c"))return;const I="function"==typeof u?u({match:b,matchIndex:y,textValue:g}):u;if(void 0===I)return;if(C.pe({environment:o,store:r,selection:w,transaction:a}),"editing"!==_.default.state.mode)return;const x=null===(n=(0,f.QY)(_.default.state.multiSelection))||void 0===n?void 0:n.selection;x&&(C.hJ({environment:o,store:r,selection:x,string:I,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:a}),S.Af_(o,{type:d}))}function B(e){var t;const{environment:n,store:o,delimiter:r,annotation:a,transaction:s}=e,c="editing"===_.default.state.mode&&(null===(t=(0,f.QY)(_.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!c)return;const d=o.getValue(),u=E({delimiter:r,storeValue:d,selectionEndIndex:c.endIndex});if(!u)return;if(!F({delimiter:r,storeValue:d,...u}))return;if(l.p9b(d,u.startIndex,u.endIndex,l.GKr.Code))return;const{textValue:p,startIndex:g,endIndex:h}=u,v=m(p,g),b=p.slice(g,h),y=i.p4(b).length,w={startIndex:v,endIndex:v+r.length};C.pe({environment:n,store:o,selection:w,transaction:s});const k={startIndex:v+y-r.length-r.length,endIndex:v+y-r.length};C.pe({environment:n,store:o,selection:k,transaction:s});const I={startIndex:w.startIndex,endIndex:k.startIndex};C.i8({environment:n,store:o,selection:I,annotation:a,transaction:s});const x=I.endIndex;M.Z5({store:o,selection:{startIndex:x,endIndex:x}}),M.aR({annotation:a,extend:!1}),S.tn$(n,{type:l.J7s(a)})}function E(e){const{delimiter:t,storeValue:n,selectionEndIndex:o}=e,a=i.p4(l.QaF(n)).slice(0,o).join("");if(0===a.length||!a.endsWith(t))return;const s=a.split(t);if(s.length<=2)return;s.reverse();const[c,...d]=s.slice(1),u=r.Sm(d.map((e=>e.length+t.length)))-t.length;return{textValue:a,matchString:c,startIndex:u,endIndex:u+c.length+2*t.length}}function F(e){const{delimiter:t,matchString:n,startIndex:o,endIndex:i,textValue:r}=e;return n.length>0&&!/\s/g.test(n[0])&&!/\s/g.test(n[n.length-1])&&!n.startsWith(t)&&!n.endsWith(t)&&(!r[o-1]||/[\s(]/g.test(r[o-1]))&&(!r[i]||/[\s)]/g.test(r[i]))}function Z(e){var t;const{environment:n,delimiter:o,store:r,transaction:a}=e,s="editing"===_.default.state.mode&&(null===(t=(0,f.QY)(_.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!s)return;const c=r.getValue(),d=E({delimiter:o,storeValue:c,selectionEndIndex:s.endIndex});if(!d)return;if(!function(e){const{storeValue:t,startIndex:n,endIndex:o,delimiter:i}=e;if(!F(e))return!1;const r={[l.GKr.User]:l.GKr.User,[l.GKr.Page]:l.GKr.Page,[l.GKr.Comment]:l.GKr.Comment,[l.GKr.Bot]:l.GKr.Bot,[l.GKr.ExternalObjectInstance]:l.GKr.ExternalObjectInstance,[l.GKr.Date]:l.GKr.Date,[l.GKr.TemporaryPage]:l.GKr.TemporaryPage,[l.GKr.TemplateVariable]:l.GKr.TemplateVariable,[l.GKr.FormulaPageProperty]:l.GKr.FormulaPageProperty,[l.GKr.FormulaContextValue]:l.GKr.FormulaContextValue,[l.GKr.Group]:l.GKr.Group,[l.GKr.Citation]:l.GKr.Citation};for(const a of Object.values(r))if(l.oP(t,n,o,a))return!1;if(l.oP(t,n,n+i.length,l.GKr.Code)&&l.oP(t,o-i.length,o,l.GKr.Code))return!1;return!0}({delimiter:o,storeValue:c,...d}))return;const{textValue:u,matchString:g,startIndex:h,endIndex:v}=d,b=m(u,h),y=u.slice(h,v);C.pe({environment:n,store:r,selection:{startIndex:b,endIndex:b+i.p4(y).length},transaction:a});const w=l.qZ6(g);C.mM({environment:n,store:r,tokens:[w],index:b,transaction:a});const k=b+i.p4(l.WiV(w)).length;M.Z5({store:r,selection:{startIndex:k,endIndex:k}}),S.tn$(n,{type:l.GKr.Equation}),p.ND({environment:n,equation:g,from:{type:"create",source:"text_filter",selection:!0}})}const V=["\\.",",",";","\\?","!","\\)","\\]"," "].join("|"),j=new RegExp(` (${V})$`);function U(e){const t=l.xrQ(e.textValue,e.matchIndex-1,e.matchIndex),n=r.Z$(t.tokensInsideRange);if(n&&l.km_(n))return e.match[1]}const L=[{delimiter:"**",type:l.GKr.Bold},{delimiter:"ï¼Šï¼Š",type:l.GKr.Bold},{delimiter:"*",type:l.GKr.Italic},{delimiter:"ï¼Š",type:l.GKr.Italic},{delimiter:"__",type:l.GKr.Bold},{delimiter:"ï¼¿ï¼¿",type:l.GKr.Bold},{delimiter:"_",type:l.GKr.Italic},{delimiter:"ï¼¿",type:l.GKr.Italic},{delimiter:"~",type:l.GKr.Strike},{delimiter:"ã€œ",type:l.GKr.Strike},{delimiter:"ï½ž",type:l.GKr.Strike}],O=[{toBlockType:()=>o.Ti.toDo,matchRegex:/^(\[\] |\ã€Œ\ã€ã€€)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subSubHeader,matchRegex:/^(### |ï¼ƒï¼ƒï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subHeader,matchRegex:/^(## |ï¼ƒï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.header,matchRegex:/^(# |ï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.toggle,matchRegex:/^(> |ï¼ž)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.quote,matchRegex:/^(\| |\" |\â€œ |\â€)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.bulletedList,matchRegex:/^(\* |\- |\+ |\ï¼Š|\ãƒ¼|\ï¼‹|\ãƒ»)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.divider,matchRegex:/^â€”-$/,insertTextAfter:!0}],N=[{annotationDelimiter:"`",blockMatchRegex:/^```$/},{annotationDelimiter:"Â´",blockMatchRegex:/^Â´Â´Â´$/},{annotationDelimiter:"ï½€",blockMatchRegex:/^ï½€ï½€ï½€$/}],z=[{regex:/^'$/,length:1,replace:"â€˜",analyticsType:"sentence_start_single_quote"},{regex:/ '$/,length:2,replace:" â€˜",analyticsType:"start_single_quote"},{regex:/'$/,length:1,replace:"â€™",analyticsType:"middle_single_quote"}],W=[{regex:/^"$/,length:1,replace:"â€œ",analyticsType:"sentence_start_double_quote"},{regex:/ "$/,length:2,replace:" â€œ",analyticsType:"start_double_quote"},{regex:/"$/,length:1,replace:"â€",analyticsType:"end_double_quote"},{regex:/--$/,length:2,replace:"â€”",analyticsType:"em_dash"},{regex:/->$/,length:2,replace:"â†’",analyticsType:"right_arrow"},{regex:/<->$/,length:3,replace:"â†”",analyticsType:"right_left_arrow"},{regex:/â†>$/,length:2,replace:"â†”",analyticsType:"right_left_arrow"},{regex:/=>$/,length:2,replace:"â‡’",analyticsType:"right_arrow_double"},{regex:/<-$/,length:2,replace:"â†",analyticsType:"left_arrow"},{regex:/>=$/,length:2,replace:"â‰¥",analyticsType:"greater_than_or_equal_to"},{regex:/<=$/,length:2,replace:"â‰¤",analyticsType:"less_than_or_equal_to"},{regex:/!=$/,length:2,replace:"â‰ ",analyticsType:"not_equal"},{regex:/\.\.\.$/,length:3,replace:"â€¦",analyticsType:"ellipsis"}];function q(e){const{environment:t,store:n,transaction:c}=e,u=n.getRecordStoreAtRootPath(),p=u instanceof b.G?u.getType():void 0;if("code"!==p||_.default.isEditingCaption()){if("callout"!==p){for(const e of O)R({environment:t,store:n,toBlockType:e.toBlockType,matchRegex:e.matchRegex,insertTextAfter:e.insertTextAfter,transaction:c});R({environment:t,store:n,matchRegex:/^(\d+|[\uff10-\uff19]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{var n;const o=t[1],i=(0,a.DA)(o);return null===(n=K(e,parseInt(i)))||void 0===n?void 0:n.type},postTransformAction:t=>{var o;const i=t[1],r=(0,a.DA)(i),l=null===(o=K(e,parseInt(r)))||void 0===o?void 0:o.number;if(n.table!==s.iU)return;const d=n.getRecordStoreAtRootPath();if(!(d instanceof b.G))return;const u=l&&l>1?l:void 0;k.FH({stores:[d],update:{list_start_index:u},transaction:c})}}),R({environment:t,store:n,matchRegex:/^([a-z]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{const n=(0,g.UF)(t[1]),o=K(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{if(!(n instanceof b.G))return;const e=n.getRecordStoreAtRootPath();k.FH({stores:[e],update:{list_format:"roman"},transaction:c})}}),R({environment:t,store:n,matchRegex:/^([a-z]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{const n=(0,g.yk)(t[1]),o=K(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{if(!(n instanceof b.G))return;const e=n.getRecordStoreAtRootPath();k.FH({stores:[e],update:{list_format:"letters"},transaction:c})}});for(const{blockMatchRegex:e}of N)R({environment:t,store:n,toBlockType:()=>o.Ti.code,matchRegex:e,insertTextAfter:!1,transaction:c})}if(!function(e){var t;const n="editing"===_.default.state.mode&&(null===(t=(0,f.QY)(_.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!n)return!1;const o=e.getValue()||[],i=l.xrQ(o,0,n.endIndex),a=r.qr(i.tokensInsideRange,(e=>l.hDy(e).some((e=>l.fTS(e))))),s=i.tokensInsideRange.slice(-1===a?0:a,i.tokensInsideRange.length),c=l.QaF(s);return Boolean(c.match(/(^| )`[^ ]/))}(n)){const e=w.getSubstitutions();for(const i of e)D({environment:t,store:n,transaction:c,regex:i.replace,length:i.length,replace:i.with,analyticsType:"custom_substitution"});for(const i of W)D({environment:t,store:n,transaction:c,regex:i.regex,length:i.length,replace:i.replace,analyticsType:i.analyticsType});const o=t.device.browserVersion.split(".").map((e=>parseInt(e,10)));if(!t.device.isSafari||(0,d.isGreaterThanOrEqualToVersion)(o,[16,4]))for(const i of z)D({environment:t,store:n,transaction:c,regex:i.regex,length:i.length,replace:i.replace,analyticsType:i.analyticsType});!function(e){D({environment:e.environment,store:e.store,transaction:e.transaction,regex:j,length:2,replace:U,analyticsType:"mention_punctuation"})}({environment:t,store:n,transaction:c})}for(const{annotationDelimiter:e}of N)B({environment:t,delimiter:e,annotation:[l.GKr.Code],store:n,transaction:c});for(const{delimiter:e,type:o}of L)B({environment:t,delimiter:e,annotation:[o],store:n,transaction:c});Z({environment:t,delimiter:"$$",store:n,transaction:c}),Z({environment:t,delimiter:"ï¼„ï¼„",store:n,transaction:c}),function(e){var t;const{environment:n,store:o,transaction:r}=e,a="editing"===_.default.state.mode&&(null===(t=(0,f.QY)(_.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!a)return;const s=o.getValue(),c=i.p4(l.QaF(s)).slice(0,a.endIndex).join("");if(l.oP(s,a.startIndex,a.endIndex,"c"))return;const d=/([^ ]+) $/.exec(c);if(!d)return;const u=d[1],p=l.rOz(u);if(!p)return;const{value:g,href:h}=p,v=m(c,c.indexOf(g)),b=v+i.p4(g).length,y={startIndex:v,endIndex:b};l.oP(s,v,b,"a")||(C.i8({environment:n,store:o,annotation:["a",h],selection:y,transaction:r}),M.Z5({store:o,selection:a}),S.Hcc(n,{href:h}))}({environment:t,store:n,transaction:c})}}function H(e){const{store:t,transaction:n,environment:o}=e;n.postEnqueueActions.push((()=>{P.createAndCommit({userAction:"textFilterActions.runAllFiltersAfterTransaction",environment:o,undoCheckpoint:!0,perform:e=>{q({environment:o,store:t,transaction:e})}})}))}function K(e,t){const{store:n}=e;if(n.table!==s.iU)return;const i=n.getRecordStoreAtRootPath();if(!(i instanceof b.G))return;const r=i.getType();if(r===o.Ti.header||r===o.Ti.subHeader||r===o.Ti.subSubHeader)return;const a=i.getParentBlockStore();if(!a)return;const l=a.getContentStores(),c=l.findIndex((e=>e.id===i.id));if(-1===c)return;const d=l.slice(0,c);let u=-1,p=1;for(let s=0;s<d.length;s++){const e=d[s];if(e.getType()!==o.Ti.numberedList)p=1,u=s;else{var m;const t=null===(m=e.getFormat())||void 0===m?void 0:m.list_start_index;t?p=t+1:p++}}return p===t?{type:o.Ti.numberedList,number:void 0}:c===u+1?{type:o.Ti.numberedList,number:t}:void 0}},98104:(e,t,n)=>{n.d(t,{AL:()=>K,D1:()=>$,DI:()=>H,FC:()=>Q,FG:()=>q,J9:()=>Y,Km:()=>M,LG:()=>X,N3:()=>z,NA:()=>x,NX:()=>D,N_:()=>R,UV:()=>B,Z5:()=>T,ZH:()=>U,Zk:()=>oe,aJ:()=>A,aR:()=>P,bc:()=>te,e2:()=>G,jh:()=>J,ls:()=>Z,mT:()=>E,o9:()=>L,sD:()=>j,z9:()=>C,zJ:()=>W});var o=n(1302),i=n(72126),r=n(70203),a=n(4827),s=n(14976),l=n(46150),c=n(28314),d=n(68056),u=n(45162),p=n(73959),m=n(89224),f=n(89086),g=n(28685),h=n(95802),v=n(41662),b=n(27724),y=n(24666),_=n(36280),S=n(45990),w=n(13084),k=n(24677),I=n(82530);function x(e){const{multiSelection:t,readOnly:n,forceEmit:o}=e,i=y.default.state,r="empty"!==i.mode&&i.savedSelectionXPosition||void 0,a="editing"===i.mode&&(0,d.e6)(i.multiSelection,t)?i.forceExtendAnnotations:{},s=n?{mode:"readOnly",multiSelection:t,savedSelectionXPosition:r}:{mode:"editing",multiSelection:t,savedSelectionXPosition:r,forceExtendAnnotations:a};if(s.mode!==i.mode||!(0,d._v)(i.multiSelection,t))return y.default.setState(s),void v.HM.updateCellSelectionFromTextSelection();o&&y.default.emit()}function C(e,t){if(!("always"===(0,u.Aw)(e)))return;const{TextSelectionCompositionStore:n}=e;n.setState({isComposing:t})}function T(e){const{store:t,selection:n,readOnly:o}=e;if(t&&n){x({multiSelection:(0,d.TD)({store:t,selection:n}),readOnly:o})}else if(t&&!n){const e={store:t,index:0},n={start:e,end:e};o?y.default.setState({mode:"readOnly",multiSelection:n,savedSelectionXPosition:0}):y.default.setState({mode:"editing",multiSelection:n,forceExtendAnnotations:{},savedSelectionXPosition:0})}else"empty"!==y.default.state.mode&&y.default.setState({mode:"empty"})}function M(e){const{annotation:t}=e;if(r.k87[t[0]])return;const n=r.J7s(t),o=(0,f.bj)().find((e=>r.J7s(e)===n));P(o?{annotation:o,extend:!1}:{annotation:t,extend:!0})}function P(e){const{annotation:t,extend:n}=e,o=y.default.state,i=r.J7s(t);"editing"===o.mode&&y.default.setState({...o,forceExtendAnnotations:{...o.forceExtendAnnotations,[i]:{annotation:t,extend:n}}})}function A(){const e=y.default.state;"editing"===e.mode&&y.default.setState({...e,forceExtendAnnotations:{}})}function R(e){const{store:t}=e;T({store:t,selection:{startIndex:0,endIndex:0}})}function D(e){const{store:t}=e;T({store:t,selection:(0,f.x0)(t)})}function B(e){var t;A();const{environment:n,store:o,canSelectAllBlocks:i,contentEditableContextId:r}=e,a=y.default.state;let s;s="empty"===a.mode?{start:{store:o,index:0},end:{store:o,index:0}}:a.multiSelection;const l={start:{store:s.start.store,index:0},end:{store:s.end.store,index:(null===(t=(0,f.x0)(s.end.store))||void 0===t?void 0:t.endIndex)||0}};if((0,d._v)(l,s)){if(r){const e=(0,f.Ov)(),t=e=>{var t;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===r},n=e.find(t),o=e.reverse().find(t);if(n&&o){const e=n.props.store,t=o.props.store;if(e&&t){var c;return void x({multiSelection:{start:{store:e,index:0},end:{store:t,index:(null===(c=(0,f.x0)(t))||void 0===c?void 0:c.endIndex)||0}}})}}}i&&(0,p.Mn)(n.device)&&k.td(n)}else x({multiSelection:l})}function E(e){var t;A();const{environment:n,store:o,canSelectAllBlocks:i}=e,r=(0,f.x0)(o),a={startIndex:0,endIndex:r?r.endIndex:0};i&&"empty"!==y.default.state.mode&&(0,f.fu)(null===(t=(0,u.xI)("textSelectionActions",y.default.state.multiSelection))||void 0===t?void 0:t.selection,a)?k.td(n):T({store:o,selection:a})}function F(e){const t=y.default.state;"empty"===t.mode||t.savedSelectionXPosition||y.default.setState({...t,savedSelectionXPosition:e.savedSelectionXPosition})}function Z(){"empty"!==y.default.state.mode&&y.default.setState({...y.default.state,savedSelectionXPosition:void 0})}function V(e){const{store:t,contentEditableLeafRegistry:n}=e;o.default.afterNextFlush((()=>{const e=m.get(),o=(0,u.fx)({contentEditableLeafRegistry:n,range:e,allowInvisibleEndSelection:(0,c.yA)().shift});o?x(o):T({store:t})}))}function j(){const e=document.activeElement;e instanceof HTMLElement&&e.blur()}function U(e){m.clear(e),L()}function L(){T({store:void 0,selection:void 0})}function O(e){const{currentEditableTopBottomPadding:t,targetEdge:n,targetEditable:o,selectionXPosition:r}=e,s=o.getNode();if(!(s&&s instanceof Element))return;const l=s.getBoundingClientRect(),c=Math.min(Math.max(r,l.left),l.right),d=Math.min(t,o.props.topBottomPadding),u="top"===n?l.top:l.bottom;return function(e,t,n){const o=new Map,r={visibility:"hidden"},s=Object.keys(r);let l;try{for(;l=m.rangeFromPoint(e,t);){if(n.contains(l.commonAncestorContainer))return l;const e=a.Z.getParentOverlayNode(l.commonAncestorContainer);if(!e)return;if(o.has(e))return;const t=i.ei(e.style,s);o.set(e,t),Object.assign(e.style,r)}}finally{for(const[e,t]of o)Object.assign(e.style,t)}}(c,"top"===n?u+d:u-d,s)}function N(e){const{focusContainerOffset:t,focusStore:n,edge:o,topBottomPadding:i}=e,r=g.E.findNodeFromStore(n);if(!(r&&r instanceof Element))return;const a=m.getRect(m.rangeFromContainerOffsets({start:t,end:t})),s=r.getBoundingClientRect();if(!a||!s)return;const[l,c]="top"===o?[a.top,s.top]:[a.bottom,s.bottom];return{focusIsAtEdge:Math.abs(l-c)<=i,focusSelectionRect:a,renderedNode:r,renderedNodeRect:s}}function z(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:i}=e,r=m.get();if(!r)return;A();const a=y.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:p}=(0,u.uZ)(s),h=N({focusContainerOffset:m.rangeToContainerOffsets(r).focus,focusStore:c.store,topBottomPadding:o,edge:"top"});if(!h)return;const{focusIsAtEdge:b,focusSelectionRect:_}=h,S=v.g$.getSimpleTableCellFromTextSelection(),w=S?v.g$.getPreviousEditableStoreForSimpleTable(S):(0,f.mK)(c.store),I=w&&g.E.findEditableWithStore(w);if(b&&I){var x;const e=Math.max(a.savedSelectionXPosition||0,_.left),i=O({targetEditable:I,targetEdge:"bottom",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(x=(0,u.fx)({range:i,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===x?void 0:x.multiSelection)||(0,d.TD)({store:I.props.store,selection:(0,f.x0)(I.props.store)});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(I.getNode(),r.commonAncestorContainer))return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,multiSelection:(0,u.$r)(s.start,p),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,forceEmit:!1,multiSelection:s,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(c,s.start.store)){if(ne(t))return void v.HM.handleUpDownKey({environment:t,direction:"up",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}V({store:c.store,contentEditableLeafRegistry:i})}function W(e){const{environment:t,store:n,event:o,topBottomPadding:i}=e,r=m.get();if(!r)return;A();const a=m.getRect(r),l=g.E.findNodeFromStore(n),c=y.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect(),b=v.g$.getSimpleTableCellFromTextSelection(),_=b?v.g$.getPreviousEditableStoreForSimpleTable(b):(0,f.mK)(n);if(a&&h){const e=Math.abs(a.top-h.top),l={startIndex:d.selection.startIndex,endIndex:d.selection.startIndex},u=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.Rw)(l)&&(m.selectionIsBackwards()||r.collapsed)&&u)k.Z5({environment:t,stores:[u]});else if(!o.altKey&&!o.shiftKey&&e<=i&&_){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);F({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(_);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),r=Math.min(Math.max(e,o.left),o.right),a=o.bottom-i,l=m.rangeFromPoint(r,a),c=s.Ut(t,l);c&&(ee({environment:t,store:_,selection:c.selection}),c.forceEmitSelectionStore&&y.default.emit())}}else V({store:n})}}function q(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:i}=e,r=m.get();if(!r)return;A();const a=y.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:h}=(0,u.uZ)(s),b=N({focusContainerOffset:m.rangeToContainerOffsets(r).focus,focusStore:c.store,topBottomPadding:o,edge:"bottom"});if(!b)return;const{focusIsAtEdge:_,focusSelectionRect:S}=b,w=v.g$.getSimpleTableCellFromTextSelection(),I=w?v.g$.getNextEditableStoreForSimpleTable(w):(0,f.hn)(c.store),x=I&&g.E.findEditableWithStore(I);if(_&&x){var C;const e=Math.max(a.savedSelectionXPosition||0,S.left),i=O({targetEditable:x,targetEdge:"top",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(C=(0,u.fx)({range:i,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===C?void 0:C.multiSelection)||(0,d.TD)({store:x.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(x.getNode(),r.commonAncestorContainer))return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,multiSelection:(0,u.$r)(s.start,h),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,forceEmit:!1,multiSelection:s,focus:"end"})}const T=(0,p.sQ)(s.start.store);if(n.shiftKey&&!n.altKey&&(0,f.iB)(c,s.end.store)&&T){if(ne(t))return void v.HM.handleUpDownKey({environment:t,direction:"down",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}V({store:c.store,contentEditableLeafRegistry:i})}function H(e){const{environment:t,store:n,event:o,topBottomPadding:i}=e,r=m.get();if(!r)return;A();const a=m.getRect(r),l=g.E.findNodeFromStore(n),c=y.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect();if(a&&h){const e=v.g$.getSimpleTableCellFromTextSelection(),l=e?v.g$.getNextEditableStoreForSimpleTable(e):(0,f.hn)(n),u=Math.abs(a.bottom-h.bottom),b={startIndex:d.selection.endIndex,endIndex:d.selection.endIndex},_=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.J_)(n,b)&&(!m.selectionIsBackwards()||r.collapsed)&&_)k.Z5({environment:t,stores:[_]});else if(!o.altKey&&!o.shiftKey&&u<=i&&l){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);F({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(l);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),r=Math.min(Math.max(e,o.left),o.right),a=o.top+i,c=m.rangeFromPoint(r,a),d=s.Ut(t,c);d&&(ee({environment:t,store:l,selection:d.selection}),d.forceEmitSelectionStore&&y.default.emit())}}else V({store:n})}}function K(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,event:n,contentEditableLeafRegistry:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:p,anchor:h}=(0,u.uZ)(c),b=(0,f.mK)(p.store),w=b&&g.E.findEditableWithStore(b);if((0,f.e7)(p,p.store)&&w){const e=(0,d.TD)({store:w.props.store,selection:(0,f.x0)(w.props.store)});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(w.getNode(),null==a?void 0:a.commonAncestorContainer))return n.preventDefault(),void te({environment:t,multiSelection:(0,u.$r)(e.start,h),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(c))return n.preventDefault(),void te({environment:t,forceEmit:!1,multiSelection:e,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(p,c.start.store)){if(ne(t))return void v.HM.handleLeftRightKey({environment:t,direction:"left",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:c,focus:p,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!a||!a.collapsed)V({store:p.store,contentEditableLeafRegistry:i});else{const e=p.index-1,i=r.b1T(c.start.store.getValue(),e);if(i&&r.tk7(i)){n.preventDefault(),x({multiSelection:{start:{...p,index:e},end:p}});const a={startIndex:e,endIndex:p.index};r.YrK(i)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:i,position:a},analyticsFrom:"arrow_keys"})}))}const a=r.hpT(p.store.getValue(),e,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));a&&S.dz({type:"selectionFocus",store:p.store,focus:!1,selection:a})}}function G(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,store:n,event:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.startIndex,endIndex:l.selection.startIndex},d=(0,p.sQ)(n);if(!i.altKey&&i.shiftKey&&a&&(0,f.Rw)(c)&&(m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(i.altKey||i.shiftKey||l.store!==n||!(0,f.Rw)(l.selection))if(i.altKey||i.shiftKey||i.ctrlKey||i.metaKey||!a||!a.collapsed)V({store:n});else{const e=r.b1T(n.getValue(),c.startIndex-1);if(e&&r.tk7(e)){i.preventDefault();const a={startIndex:c.startIndex-1,endIndex:c.startIndex};T({store:n,selection:a}),r.YrK(e)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=r.hpT(n.getValue(),c.startIndex-1,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));a&&S.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{i.preventDefault();const e=(0,f.mK)(n);if(e){const n=(0,f.x0)(e);n&&ee({environment:t,store:e,selection:n})}}}function $(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,event:n,contentEditableLeafRegistry:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:p,anchor:h}=(0,u.uZ)(c),b=(0,f.hn)(p.store),w=b&&g.E.findEditableWithStore(b);if((0,f.iB)(p,p.store)&&w){const e=(0,d.TD)({store:w.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(w.getNode(),null==a?void 0:a.commonAncestorContainer))return n.preventDefault(),void te({environment:t,multiSelection:(0,u.$r)(e.start,h),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(c))return n.preventDefault(),void te({environment:t,forceEmit:!1,multiSelection:e,focus:"end"})}if(n.shiftKey&&!n.altKey&&(0,f.iB)(p,c.end.store)){if(ne(t))return void v.HM.handleLeftRightKey({environment:t,direction:"right",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:c,focus:p,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!a||!a.collapsed)V({store:p.store,contentEditableLeafRegistry:i});else{const e=p.index,i=p.index+1,a=r.b1T(c.start.store.getValue(),e);if(a&&r.tk7(a)){n.preventDefault(),x({multiSelection:{start:p,end:{...p,index:i}}});const s={startIndex:e,endIndex:i};r.YrK(a)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:a,position:s},analyticsFrom:"arrow_keys"})}))}const s=r.hpT(p.store.getValue(),e,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));s&&S.dz({type:"selectionFocus",store:p.store,focus:!1,selection:s})}}function Q(e){o.default.afterNextFlush((()=>{Z()})),A();const{environment:t,store:n,event:i}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.endIndex,endIndex:l.selection.endIndex},d=(0,p.sQ)(n);if(!i.altKey&&i.shiftKey&&a&&(0,f.J_)(n,c)&&(!m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(i.altKey||i.shiftKey||l.store!==n||!(0,f.J_)(n,l.selection))if(i.altKey||i.shiftKey||i.ctrlKey||i.metaKey||!a||!a.collapsed)V({store:n});else{const e=r.b1T(n.getValue(),c.startIndex);if(e&&r.tk7(e)){i.preventDefault();const a={startIndex:c.startIndex,endIndex:c.startIndex+1};T({store:n,selection:a}),r.YrK(e)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=r.hpT(n.getValue(),c.startIndex+1,((e,t)=>{const n=r.Hze(e);return t?Boolean(n&&r.Hze(t)===n):Boolean(n)}));a&&S.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{i.preventDefault();const e=(0,f.hn)(n);e&&ee({environment:t,store:e,selection:{startIndex:0,endIndex:0}})}}function Y(e,t){const{x:n,y:o,target:i}=t,r=(0,f.fx)(n,o,i);r&&r.selectable.props.onEditText&&I.createAndCommit({userAction:"textSelectionActions.editNearestBlock",environment:e,perform:e=>{r.selectable.props.onEditText&&r.selectable.props.onEditText({isAtStartOfLine:n<=r.rect.left,isClick:!0,transaction:e})}})}function J(e,t,n){const{x:o,y:i,target:r}=t,a=r?b.default.getDefaultContainerFromTarget(r):void 0;if(a&&(0,f.Q3)(i,a)&&w.HO({environment:e,container:a,transaction:n}))return;const s=(0,f.fx)(o,i,r);if(s&&s.selectable.props.onEditText){const e=i<=s.rect.top;s.selectable.props.onEditText({isAtStartOfLine:o<=s.rect.left,isAtStartOfContainer:e,isClick:!0,transaction:n})}}function X(e,t,n,o){const{y:i,target:r}=t,a=r?b.default.getDefaultContainerFromTarget(r):void 0,s=h.C.findSelectableFromStore(n);a&&s&&(0,f.qh)(i,s)&&w.UG({environment:e,container:a,store:n,transaction:o})}function ee(e){const{environment:t,store:n,selection:o}=e;T({store:n,selection:o});const i=(0,p.sQ)(n);i&&k.eP({environment:t,store:i})}function te(e){const{environment:t,multiSelection:n,forceEmit:o,readOnly:i,focus:r}=e;x({multiSelection:n,forceEmit:o,readOnly:"infer"===i?(0,u.L5)(n).some((e=>{let{editable:t}=e;return!t.props.store.canEdit()})):i});const a=(0,u.tp)({multiSelection:n,filterCommonAncestors:!1,focus:r});a&&k.Z5({environment:t,phase:b.SelectionPhase.Editing,...a})}function ne(e){const t=v.g$.getSimpleTableCellFromTextSelection();if(t){const{rowIndex:n,columnIndex:o,simpleTableStore:i}=t.getProps();return v.HM.selectCell({environment:e,rowIndex:n,columnIndex:o,simpleTableStore:i}),U(e),!0}return!1}function oe(e){var t;if(!(0,u.Aw)(e))return;const n=m.get(),o=null===(t=(0,u.fx)({range:n,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection;if(o){x({readOnly:(0,u.L5)(o).some((e=>{let{editable:t}=e;return t.props.disabled})),multiSelection:o})}}},29373:(e,t,n)=>{n.d(t,{LO:()=>_,X_:()=>w,ls:()=>v,nz:()=>y,rd:()=>b});n(57658);var o=n(41432),i=n(15157),r=n(72126),a=n(23867),s=n(35328),l=n(58202),c=n(45131),d=n(54642),u=n(49865),p=n(94419),m=n(9953),f=n(24677),g=n(98104);function h(e){return`ToggleBlock-${e}`}function v(e){const{environment:t,store:n,transaction:i}=e,r=m.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:i,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()});p.R3({parent:n.getContentStore(),append:r,transaction:i});const a=n.getContentStores()[0];f.eP({environment:t,store:a});const s=a.getBlockTitleStore();g.N_({store:s})}function b(e){let{blockId:t,state:n,currentUserId:o}=e;c.Z.setOpen(t,n),i.Z.set({userId:o,key:h(t),value:n})}function y(e){let{blockId:t,currentUserId:n}=e;const o=i.Z.get({userId:n,key:h(t)});c.Z.setOpen(t,o)}function _(e,t){d.loadCachedPageChunkBatched(e,{page:{id:t.id,spaceId:(0,a.C)(t.spaceId)},limit:25,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1})}function S(e,t){const n=(null==t?void 0:t.toggleBlockIds)||[],i=(null==t?void 0:t.collectionBlockIds)||[],r=e.getType();if((0,s.BX)(e)&&n.push(e.id),"collection_view"!==r&&"collection_view_page"!==r||i.push(e.id),r===o.Ti.transclusionReference){const t=e.getTransclusionReferenceTargetStore();t&&S(t,{toggleBlockIds:n,collectionBlockIds:i})}else{const t=e.getContentStores();for(const e of t)e.isNavigableBlock()||S(e,{toggleBlockIds:n,collectionBlockIds:i}),"collection_view"===e.getType()&&i.push(e.id)}return{toggleBlockIds:n,collectionIds:i}}function w(e,t){const{toggleBlockIds:n,collectionIds:o}=S(t),i=t.environment.currentUser.id;n.forEach((e=>y({blockId:e,currentUserId:i})));const a=r.oA(o.map((e=>function(e){const t=l.R.findCollectionViewBlockFromId(e);if(t)return t.collectionContextStore}(e)))),s=a.flatMap((e=>e.groupsStore.getAllGroupStates())),d=n.every((e=>c.Z.isOpen(e))),p=s.every((e=>e.toggleStateStore.state)),m=!(d&&p);n.forEach((e=>b({blockId:e,state:m,currentUserId:i}))),function(e,t,n){for(const o of t)for(const t of o.groupsStore.getAllGroupStates())u.uo({environment:e,collectionContextStore:o,groupFormat:t.groupsPointer[0],toggleStateStore:t.toggleStateStore,newValue:n})}(e,a,m)}},32741:(e,t,n)=>{n.d(t,{lY:()=>m,qA:()=>f,HM:()=>p});var o=n(70203),i=n(44805),r=n(97880),a=n(92120);var s=n(4708),l=n(80444),c=n(77080),d=n(96049),u=n(48588);function p(e){var t;if(d.Z.state)return;const n=c.default.checkGate("first_party_links"),p=(0,s.En)(),{token:f,store:g}=e,h=o.hDy(f.textToken),v=null===(t=l.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId(),b=v?o.zrg(h).filter((e=>!(0,i.vz)({annotation:e,spaceId:v,getRecordModel:g.getRecordModel}))):[],y=[o.rlz(h),o.K9C(h),o.QGY(h),o.frE(h),o.xat(h),n&&o.V8Y(h)||void 0,p&&o.hH9(h)||void 0,...b,o.jC0(h)].filter(r.$K);y.length>0?(u.Z.setState({token:f,store:g,annotations:y}),b.length>0&&function(e){let{source:t,discussionAnnotations:n}=e;a.Z.setState({source:t,discussionIds:n.map(o.h19)})}({discussionAnnotations:b,source:"editor"})):m()}function m(){var e,t;u.Z.state&&u.Z.setState(void 0),e="editor",(null===(t=a.Z.state)||void 0===t?void 0:t.source)===e&&a.Z.setState(void 0)}function f(e){e&&u.Z.state&&u.Z.state.store===e&&m()}},82530:(e,t,n)=>{n.r(t),n.d(t,{MetadataUpdateManager:()=>_e,applyCrdtTextOperation:()=>Ie,applyCrdtTextOperations:()=>xe,applyOperation:()=>ke,createAndCommit:()=>Re,createAndCommitAsync:()=>De,updateConnectionState:()=>be,updateMetadataForTransaction:()=>ye});n(57658),n(21703);var o=n(18466),i=n(45060),r=n(63144),a=n(68626),s=n(38297),l=n(5773),c=n(43593);var d=n(79317),u=n(59730),p=n(72126),m=n(91155),f=n(59753),g=n(482),h=n(77337),v=n(606),b=n(98963),y=n(21202),_=n(6287),S=n(13493),w=n(70279),k=n(15047),I=n(19889),x=n(67175),C=n(12139),T=n(97880),M=n(63143),P=n(82798),A=n(9291),R=n(95477),D=n(21830),B=n(33929),E=n(98165),F=n(3932),Z=n(16861),V=n(99341),j=n(88632),U=n(37598),L=n(53730),O=n(26136),N=n(27724),z=n(24666),W=n(34583),q=n(68955),H=n(70203);n(67266),n(19056),n(47247),n(4615);function K(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:o}=e,i=p.e5(H.llS(o),H.llS(n));return i.length>0?p.G0(t??[],i):t}function G(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:o}=e,i=p.e5(H.llS(n),H.llS(o));return i.length>0?p.zu(t??[],...i):t}var $=n(77282);function Q(e){const{transaction:t,inMemoryRecordCache:n,store:o,operation:i}=e,r=i.command;switch(r){case"insertText":case"deleteText":case"addAnnotation":case"removeAnnotation":case"splitText":const e=(0,P.TO)(o.getTextSliceTree());return a=o,s=new ne(t,i),$.Z.getPageStoreForBlockStore(a)||oe("source",a,s),Y({inMemoryRecordCache:n,textSliceTreeToMutate:e,store:o,operation:i});case"splitTextIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i}=e;(0,P.T)(i.args.targetBlockId!==i.pointer.id,"Target block should be different from source block.");const r=(0,P.TO)(o.getTextSliceTree()),[{newValue:a,role:s}]=Y({inMemoryRecordCache:n,store:o,textSliceTreeToMutate:r,operation:{command:"splitText",pointer:i.pointer,path:[],args:i.args}}),l=new O.G(o.environment,{table:y.iU,id:i.args.targetBlockId});return ie(o,l,new ne(t,i)),X({transaction:t,inMemoryRecordCache:n,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:r,targetStore:l,operation:{command:"moveTextSlice",pointer:{table:y.iU,id:i.args.targetBlockId},path:[],args:{textInstanceId:i.args.textInstanceId,textSliceStartItemId:i.args.id,targetBlockId:i.args.targetBlockId,targetTextInstanceId:i.args.targetBlockId,targetTextSliceEndItemId:"end"}}})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});case"moveTextSlice":return J({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});case"moveTextSliceIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i}=e;return(0,P.T)(i.args.targetBlockId!==i.pointer.id,"Target block should be different from source block."),J({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:{...i,command:"moveTextSlice",args:{...i.args,targetTextInstanceId:i.args.targetBlockId,targetTextSliceEndItemId:"end"}},debugInfo:new ne(t,i)})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i});default:(0,T.t1)(r)}var a,s}function Y(e){const{inMemoryRecordCache:t,store:n,operation:o,textSliceTreeToMutate:i}=e,r=i.getTextValue(),a=o.command;switch(a){case"insertText":i.applyInsertTextOperation({type:a,...o.args});break;case"deleteText":i.applyDeleteOperation({type:a,...o.args});break;case"addAnnotation":case"removeAnnotation":i.applyAnnotationOperation({type:a,...o.args});break;case"splitText":i.applySplitOperation({type:a,...o.args});break;default:(0,T.t1)(a)}const s=ee((0,P.TO)(n.getValue()),i);"addAnnotation"===o.command&&H.J7s(o.args.annotation)===H.GKr.Discussion&&(s.discussions=K({existingDiscussions:s.discussions,oldTextValue:r,newTextValue:i.getTextValue()})),"removeAnnotation"===o.command&&H.JA7(o.args.annotationKey)===H.GKr.Discussion&&(s.discussions=G({existingDiscussions:s.discussions,oldTextValue:r,newTextValue:i.getTextValue()}));const l=te(t,n);return[{pointer:n.pointer,newValue:s,role:l,updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}]}function J(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:i,debugInfo:r}=e,a=(0,P.TO)(o.getValue()),s=te(n,o),l=(0,P.TO)(o.getTextSliceTree()),c=i.args.targetBlockId===o.id?o:new O.G(o.environment,{table:y.iU,id:i.args.targetBlockId});return ie(o,c,r??new ne(t,i)),X({transaction:t,inMemoryRecordCache:n,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:l,targetStore:c,operation:i})}function X(e){const{transaction:t,inMemoryRecordCache:n,sourceRole:o,sourceValue:i,sourceRootTextSliceTree:r,targetStore:a,operation:s}=e,l=(0,P.TO)(r.findTextSliceTreeContainingItemWithId(s.args.textInstanceId,s.args.textSliceStartItemId));(0,P.T)(l!==r,"Can not move root node of text slice tree.");const c=r.getTextValue();!function(e,t){const n=t.getRecordStoreAtRootPath().getValue(),o=t.getRecordStoreAtRootPath().getRole();e.initialRecordMap.getRole(t.pointer)||(o?e.initialRecordMap.setValueAndRole(t.pointer,n,o):e.initialRecordMap.delete(t.pointer))}(t,a);const d=s.args.targetBlockId===i.id,u=d?r:(0,P.TO)(a.getTextSliceTree()),p=(0,P.TO)(u.findTextSliceTreeContainingItemWithId(s.args.targetTextInstanceId,s.args.targetTextSliceEndItemId,{type:"end"})),m=d?c:u.getTextValue();l.detachFromParent(),p.appendChild(l);const f=ee(i,r);f.discussions=d?f.discussions:f.discussions=G({existingDiscussions:f.discussions,oldTextValue:c,newTextValue:r.getTextValue()});const g=[{pointer:{table:y.iU,id:i.id,spaceId:i.space_id},newValue:f,role:o,updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}];if(!d){const e=u.getTextValue(),t=ee((0,P.TO)(a.getValue()),u);t.discussions=K({existingDiscussions:t.discussions,oldTextValue:m,newTextValue:e}),g.push({pointer:a.pointer,newValue:t,role:te(n,a),updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]})}return g}function ee(e,t){const n=p.Xh(e),o=(0,P.TO)(n.format);return(0,P.T)(o.use_crdt),t?(o.text_slice_tree=q.Z.serialize(t),o.text_clocks=q.Z.serializeClocks(t)):(o.text_slice_tree=void 0,o.text_clocks=void 0),n.version++,n}function te(e,t){return e.getRole({pointer:t.pointer,userId:t.userId})??"editor"}class ne{constructor(e,t){this.transaction=e,this.operation=t}get(){return{transactionName:this.transaction.getUserActionForAnalyticsPurposesOnly(),operationName:this.operation.command}}}function oe(e,t,n){const{transactionName:o,operationName:r}=n.get();(0,i.XY)(`The ${e} block store for CRDT text operation "${r}" in transaction "${o}" is not on the page. Undoing the transaction may not work!`,[["block id =",t.id]])}function ie(e,t,n){const o=$.Z.getPageStoreForBlockStore(e);if(!o)return void oe("source",e,n);(0,P.TO)($.Z.getPageBlockTrackerForPage(o.pointer)).getPathToBlock(t.pointer.id)||oe("target",t,n)}var re=n(50906),ae=n(90287),se=n(36576),le=n(74446),ce=n(45953),de=n(33361);var ue=n(47307),pe=n(4408),me=n(52423);const fe=new Set;let ge=0;const he=(0,A.defineMessages)({invalidBlockOperation:{defaultMessage:"Hey there! Blocks cannot be moved inside of themselves.",id:"saveChanges.errorDialog.blocksCannotBeMovedInsideSelf.message"},saveEditsError:{id:"saveEditsError.message",defaultMessage:"There was an issue persisting your edits. Please message us for help."}}),ve=25*M.C0;function be(e){j.Z.state.online&&e.currentUser.id&&L.transactionQueue.unpause()}function ye(e){const{environment:t,transaction:n,skipUpdatingEditedMetadata:o}=e,i=t.currentUser.adminUserId?I.el.id:t.currentUser.id,a=new _e({transaction:n,userId:i,skipUpdatingEditedMetadata:o,timeMs:Date.now()}),s=p.mN(n.stores,(e=>e.id));for(const l of s)if(l.table===y.iU){const e=O.G.createChildStore(l,l.pointer);if(e.canEdit()&&a.addStore(e),!e.isNavigableBlock()){const t=E.Dg(e);t&&t.canEdit()&&a.addStoreWithLargeSubtree(t)}}else if(l.table===w.x_){if(l.path.length)continue;const e=l.pointer,t=n.initialRecordMap.getValue(e),o=l.getValue();(void 0===t||r.P(f.kk.fromValue(w.x_,t),f.kk.fromValue(w.x_,o)))&&a.addStore(O.T5.createChildStore(l,l.pointer))}else if(l.table===k.bx)a.addStoreWithLargeSubtree(O.H2.createChildStore(l,l.pointer));else if(l.table===_.v){const e=O.NW.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStore(e)}else if(l.table===S.n){const e=O.Xr.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStoreWithLargeSubtree(e)}else if(l.table===b.cv&&l.canEdit()){const e=O.Mz.createChildStore(l,l.pointer);a.addStore(e);const t=e.getParentBlockStore();t&&t.canEdit()&&a.addStore(t)}a.getAllOperations().forEach((e=>{let[t,o]=e;return ke({transaction:n,store:t,operation:o})}))}class _e{constructor(e){this.transaction=void 0,this.timeMs=void 0,this.userId=void 0,this.skipUpdatingEditedMetadata=void 0,this.seenStoreIds=void 0,this.operations=void 0,this.transaction=e.transaction,this.timeMs=e.timeMs,this.userId=e.userId,this.skipUpdatingEditedMetadata=e.skipUpdatingEditedMetadata,this.seenStoreIds=new Set,this.operations=new Map}addStoreWithLargeSubtree(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!0})}addStore(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!1})}getAllOperations(){return Array.from(this.operations.entries())}addStoreInternal(e,t){if(e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:this.transaction.userId}))return;if(this.seenStoreIds.has(e.id))return;this.seenStoreIds.add(e.id);const n={};p.TS(n,this.collectCreationMetadata(e),this.skipUpdatingEditedMetadata?{}:this.collectEditionMetadata(e,t.shouldDebounceEditedTime)),Object.keys(n).length>0&&this.operations.set(e,{pointer:e.pointer,path:[],command:"update",args:n})}collectCreationMetadata(e){const t={};(e.isDefined()?e.getCreatedById():void 0)||(t.created_by_id=this.userId,t.created_by_table=I.KJ);return(e.isDefined()?e.getCreatedTime():void 0)||(t.created_time=this.timeMs),t}collectEditionMetadata(e,t){const n={},o=e.isDefined()?e.getLastEditedTime():-1;if((t?this.hasDebounceEnded(o,this.timeMs):o!==this.timeMs)&&(n.last_edited_time=this.timeMs),e instanceof O.G||e instanceof O.H2||e instanceof O.Mz){const t=n;(e.isDefined()?e.getLastEditedById():void 0)!==this.userId&&(t.last_edited_by_id=this.userId,t.last_edited_by_table=I.KJ)}return n}hasDebounceEnded(e,t){return M.ud(e)!==M.ud(t)}}const Se=function(e){p.mN(e.stores,(e=>e.id)).forEach((t=>{if(!t.inMemoryRecordCache.recordHasOverride({pointer:t.pointer,userId:e.userId}))if(t.table===y.iU){const n=O.G.fromRecordStore(t),o=n.getProperties(),i=n.getFormat();if(n.isDefined()){const t=(0,l.xN)({properties:o,format:i},R.default.secureFileS3.url,R.default.secureFileS3V2.url,R.default.secureFileConfig.rootPath,R.default.secureFileConfig.hostname,n.pointer),r=t.files,a=t.operations,s=n.getFileIds();for(const o of r)s.indexOf(o.id)<0&&ke({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:o.id}}});for(const o of a)ke({transaction:e,store:n,operation:o})}}else if(t.table===_.v){const n=O.NW.fromRecordStore(t),o=n.getFileIds(),i=n.getIconStore().getValue(),r=n.getCoverStore().getValue();if(n.isDefined()){const t=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(n&&!e.file_ids)return[];const r=[],{cover:a,icon:s}=e;if(a){const e=(0,c.mV)(a,t,o,i);e&&r.push(e)}if(s){const e=(0,c.mV)(s,t,o,i);e&&r.push(e)}return r}({cover:r,icon:i,file_ids:o},[R.default.secureFileS3.url,R.default.secureFileS3V2.url],!1,R.default.secureFileConfig.rootPath,R.default.secureFileConfig.hostname),a=o;for(const o of t)a.indexOf(o.id)<0&&ke({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:o.id}}})}}}))};const we=function(e){var t;const{environment:n,userId:o,userAction:r}=e,s=ae.Bs(),l=new Error("Potential transaction deadlock"),c=new F.Y({spaceId:s,userId:o||n.currentUser.id,deadlockTimeoutMs:ve,onDeadlockWarning:()=>{fe.delete(c);const e=c.getUserActionForAnalyticsPurposesOnly();(0,i.XY)(`A ${e} transaction hasn't been committed in ${ve} ms.`,[["stack =",l.stack]]),C.IE(l,{extra:{operations_count:c.operations.length},tags:{userAction:e}}),re.y9R(n,{operations_count:c.operations.length,user_action:e});const t=c.operations.map((e=>({command:e.command,stringifiedArgs:(0,m.LK)({path:e.path,pointer:e.pointer})})));a.log({level:"warning",from:"transactionActions",type:"transactionDeadlockWarning",data:{userAction:e,operations:t}})}});return c.beforeSelection=N.default.cloneState(),c.beforeTextSelection=z.default.cloneState(),c.annotateWithUserAction(r),fe.add(c),null===(t=Z.Z.provider)||void 0===t||t.onTransactionEvent("create",c),c};function ke(e){const{store:t,operation:n,transaction:o}=e,{inMemoryRecordCache:r}=t;if((0,x.Qf)(n)&&(0,i.XY)(`In ${o.getUserActionForAnalyticsPurposesOnly()}, use applyCrdtTextOperations() for text operations!`),(0,g.S)(n)){const i=(0,d.rb)(n,r.makeGetRecordValueFn(o.userId)),a=(0,d.T1)(n,r.makeGetRecordValueFn(o.userId));for(const o of a)n.additionalUpdatedPointers||(n.additionalUpdatedPointers=[]),n.additionalUpdatedPointers.push(o.pointer),Ce({...e,operation:o,isInvertible:!1,store:(0,O.Kv)(t,o.pointer)});return o.operations.push(n),void o.invertedOperations.push(...i)}Ce({store:t,operation:n,transaction:o,isInvertible:!0})}function Ie(e){const{store:t,operation:n,invertedOperation:o,transaction:i}=e;xe({store:t,operations:[n],invertedOperations:o?[o]:[],transaction:i})}function xe(e){var t;const{store:n,operations:o,transaction:i}=e;i.invertedOperations.push(...e.invertedOperations),null===(t=Z.Z.provider)||void 0===t||t.rememberStackTrace(e.invertedOperations);for(const r of o)Ce({store:n,operation:r,transaction:i,isInvertible:!0})}function Ce(e){var t;const{store:n,operation:o,transaction:i}=e,{inMemoryRecordCache:r,environment:a,pointer:l,userId:c}=n;if(null===(t=Z.Z.provider)||void 0===t||t.onApplyOperation(e),i.committed)throw new Error("Transaction has already been committed.");const d=n.getRecordStoreAtRootPath().getValue(),u=n.getRecordStoreAtRootPath().getRole(),p=(0,x.Qf)(o)?[]:e.isInvertible?[h.bv(o,d)].filter(T.$K):[];let m;if(i.initialRecordMap.getRole(l)||(u?i.initialRecordMap.setValueAndRole(l,d,u):i.initialRecordMap.delete(l)),(0,x.Qf)(o))m=Q({transaction:i,inMemoryRecordCache:r,store:(0,P.R9)(n,O.G),operation:o});else{m=[{pointer:l,newValue:h.lK(o,d),role:r.getRole({pointer:l,userId:c})??"editor",updatePaths:"update"===o.command?Object.keys(o.args).map((e=>o.path.concat([e]))):[o.path]}]}for(const g of m){const{pointer:e,newValue:t,role:o,updatePaths:l}=g;if(pe.Wl({environment:a,inMemoryRecordCache:r,pointer:e,userId:c,force:!0,model:f.kk.fromValue(n.pointer.table,t),role:o,updatePaths:l,debugSource:i.getUserActionForAnalyticsPurposesOnly()??"applyOperation"}),"block"===n.table){const e=t;if(e){const t=(0,s.ky)({block:e,getRecordValue:r.makeGetRecordValueFn(i.userId)});t&&U.Z.setEditedBlock(t.id,e.id)}0}}i.isLocal=!n.shouldCacheSaveTransactions(),e.isInvertible&&(i.operations.push(o),i.invertedOperations.push(...p)),i.stores.push(n),r.appliedTransaction=!0}const Te=[{type:"userAction",allowedUserAction:"revisionActions.undoRevision"},{type:"userAction",allowedUserAction:"revisionActions.redoRevision"}];function Me(e){var t;null===(t=Z.Z.provider)||void 0===t||t.onTransactionEvent("cancel",e),e.cancelDeadlockWarning(),fe.delete(e);const n=p.mN(e.stores,(e=>e.id));for(const o of n){pe.uo({inMemoryRecordCache:o.inMemoryRecordCache,persistedRecordCache:o.environment.defaultRecordCache.persistedRecordCache,pointer:o.pointer,userId:o.userId,environment:o.environment});const t=e.initialRecordMap.getValue(o.pointer),n=e.initialRecordMap.getRole(o.pointer);n&&pe.Wl({environment:o.environment,inMemoryRecordCache:o.inMemoryRecordCache,pointer:o.pointer,userId:o.userId,updatePaths:[[]],model:f.kk.fromValue(o.pointer.table,t),role:n,debugSource:"cancelTransaction"})}for(const o of e.postCancelCallbacks)o()}const Pe=p.P2(((e,t)=>{re.Y_F(e,{errorType:t.type||t.name}),t.type===D.vZ?ue.showThrottledErrorMessage(t.message):ue.showThrottledErrorMessage(B.default.formatMessage(he.saveEditsError))}),3e4);function Ae(e){return new Promise(((t,n)=>{var o;fe.delete(e.transaction);const i=Array.from(fe).filter((e=>e.operations.length>0));var r,s;if(i.length>0&&re.iBN(e.environment,{committed_transaction_user_action:e.transaction.getUserActionForAnalyticsPurposesOnly(),first_uncommitted_transaction_user_action:i[0].getUserActionForAnalyticsPurposesOnly(),uncommitted_transaction_count:i.length}),0===e.transaction.operations.length)return null===(r=L.transactionQueue.logEmptyTaskForDebugging)||void 0===r||r.call(L.transactionQueue,e.transaction.getUserActionForAnalyticsPurposesOnly()),e.transaction.committed=!0,e.transaction.done(),null===(s=Z.Z.provider)||void 0===s||s.onTransactionEvent("commitEmpty",e.transaction),t();void 0===e.canUndo&&(e.canUndo=!0);const{transaction:l,canUndo:c}=e,d=function(e){for(const t of e.stores)if("block"===t.table){const e=E.Om(t);if(e&&E.qA(e).find((e=>e.table===t.table&&e.id===t.id)))return B.default.formatMessage(he.invalidBlockOperation)}}(l);if(d)return Me(l),ue.showErrorMessage(d),void t();l.cancelDeadlockWarning();for(const e of l.preEnqueueActions)e();if(ye({environment:e.environment,transaction:l,skipUpdatingEditedMetadata:e.skipUpdatingEditedMetadata}),Se(l),function(e,t){const n=t.operations.filter((e=>e.pointer.table===S.n));n.length>0&&v.dr.uniq(n.map((e=>e.pointer))).map((e=>t.initialRecordMap.getRole(e))).includes(void 0)&&t.postSubmitCallbacks.push((()=>{W.bi(e)}))}(e.environment,l),l.afterSelection=N.default.cloneState(),l.afterTextSelection=z.default.cloneState(),c&&me.K9({transaction:l,undoCheckpoint:e.undoCheckpoint}),null===(o=Z.Z.provider)||void 0===o||o.onTransactionEvent("commit",l),l.isLocal){for(const e of l.postEnqueueActions)e();l.done(),t()}else{const o=e=>{l.done(e),e?n(e):t()},{LocalBacklinkStore:i,currentUser:r}=e.environment;i&&async function(e,t){const{LocalBacklinkStore:n,currentUser:o}=e;if(0===t.stores.length)return;const i=t.stores[0].inMemoryRecordCache,r=[],a=ce.Ak.create(),s=new Set;for(const p of t.stores)s.has(p.id)||(s.add(p.id),r.push(p.pointer),a.setValue(p.pointer,p.getRecordStoreAtRootPath().getValue()));const l=de.DI(t.initialRecordMap),{createdBacklinks:c,deletedBacklinks:d}=await(0,se.xU)({loadRecordValue:le.zF.fromGetRecordValueFn(i.makeGetRecordValueFn(o.id)),operationPointers:r,getInitialRecordModel:f.om.fromRecordMap(l),getFinalRecordModel:f.om.fromRecordMap(a)}),u=n.updateBacklinks({createdBacklinks:c,deletedBacklinks:d,currentUserId:o.id});t.postSubmitCallbacks.push((e=>{e&&n.resetBacklinkState({blockIds:u,currentUserId:o.id})}))}({LocalBacklinkStore:i,currentUser:r},l);const s=Date.now();s<ge&&re.vtR(e.environment,{regression_amount:ge-s}),ge=s,L.transactionQueue.enqueueTask((0,V.JG)({transaction:l,timestamp:s,callback:o})).catch((t=>{a.log({level:"error",from:"transactionActions",type:"enqueueTask",error:(0,m.Ui)(t)}),e.environment.device.isMobileNative&&"SqliteOutOfSpace"===t.name||Pe(e.environment,t),Me(l),o(t)}));for(const e of l.postEnqueueActions)e()}l.committed=!0}))}function Re(e){const{userAction:t,environment:n,userId:i,perform:r,canUndo:s,undoCheckpoint:l,transactionTooBigFallback:c,skipUpdatingEditedMetadata:d,useSudoMode:p}=e;return o.Z.withListenerIgnored((()=>{const o=we({environment:n,userId:i,userAction:t});let f;p&&(o.useSudoMode=!0);try{f=r(o),function(e){if(e.isLocal)return;for(const t of e.stores){const n=t.inMemoryRecordCache.checkRecordForTemporaryData(t);if(n)throw new u.p8(`Transaction "${e.getUserActionForAnalyticsPurposesOnly()}" is manipulating a store with temporary local changes from an in-memory record cache named "${n.name}"!`)}}(o);for(const e of o.postPerformAssertions)e()}catch(g){Me(o);const e=o.getUserActionForAnalyticsPurposesOnly(),t=o.getUserFlowForAnalyticsPurposesOnly();throw C.IE(g,{tags:{userAction:e,userFlow:t}}),a.log({level:"error",from:"transactionActions",type:"createAndCommit",error:(0,m.Ui)(g),data:{userAction:e,userFlow:t,spaceId:o.spaceId}}),g}finally{0}if(c&&(0,V.jQ)(o))return Me(o),Re({...e,perform:c,transactionTooBigFallback:void 0,userAction:`${t} transactionTooBigFallback`});return{performResult:f,serverCommitResult:Ae({environment:n,transaction:o,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:d})}}))}async function De(e){const{environment:t,perform:n,waitForServerCommit:o,userAction:i,userId:r,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c,useSudoMode:d}=e,u=we({environment:t,userId:r,userAction:i});let p;d&&(u.useSudoMode=!0);try{p=await n(u);for(const e of u.postPerformAssertions)e()}catch(g){const t=u.getUserActionForAnalyticsPurposesOnly();fe.delete(u);const n=u.operations.length>0;throw n&&re.kY8(e.environment,{user_action:t,operation_count:u.operations.length}),C.IE(g,{tags:{userAction:t,transactionOperationCount:u.operations.length}}),a.log({level:"error",from:"transactionActions",type:"createAndCommitAsync",error:(0,m.Ui)(g),data:{message:n?`POSSIBLE DATA LOSS: asynchronous transaction had ${u.operations.length} operations`:void 0,userAction:t}}),g}const f=Ae({environment:t,transaction:u,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c});return o&&await f,{performResult:p,serverCommitResult:f}}},68422:(e,t,n)=>{n.d(t,{_w:()=>R,vs:()=>M,Cj:()=>P});var o=n(1302),i=n(41432),r=n(72126),a=n(72141),s=n(4615),l=n(70203),c=n(42274),d=n(65598),u=n(35328),p=n(26664),m=n(34583),f=n(41433),g=n(94419),h=n(76464),v=n(9953),b=n(42858),y=n(24677),_=n(98104),S=n(29373),w=n(73959),k=n(55367),I=n(96802),x=n(13084);function C(e,t){const{store:n,transaction:o,disableAutoChildrenMove:i}=e;return i||function(e){const{environment:t,store:n,transaction:o}=e,i=(0,w.sQ)(n),r=(null==i?void 0:i.getContentStores())||[];let a=!1;const s=r.filter((e=>{return a?(t=e.getType(),o=n.getType(),!(!t||!o||t===o||"divider"===t||"collection_view"===t||"sub_header"===o&&"header"===t||"sub_sub_header"===o&&("header"===t||"sub_header"===t))||(a=!1,!1)):(e===n&&(a=!0),!1);var t,o}));x.LQ({environment:t,targetParentStore:n.getContentStore(),droppedDirection:k.vh.Below,droppedStores:s,duplicate:!1,transaction:o})}(e),I.FH({stores:[n],update:{toggleable:t},transaction:o})}var T=n(82530);function M(e){const{environment:t,block:n,blockType:o,transaction:s,isMultiBlockTransformation:d}=e,p=n.getType(),b=n.getFormat(),y=n.recordStoreUIParentStore;if(m.M_(t)&&p&&!function(e,t){const n=e.type,o=e.format;if(u.ih(t)){var r;return"mermaid_code_block"===t?e.type===i.Ti.code&&"Mermaid"===l.QaF(null===(r=e.properties)||void 0===r?void 0:r.language):(0,i.Fx)(t)?u.tZ(t)===e.type&&(0,i.eJ)(n,o):u.tZ(t)===e.type}return e.type===t&&!(0,i.eJ)(n,o)}({type:p,format:b,properties:n.getProperties()},o)){const e=p,l=u.ih(o)?u.tZ(o):o;if(v.sW({store:n,data:{type:l},transaction:s}),(0,i.Fx)(o)&&!u.fn(n)?function(e){C(e,!0)}({environment:t,store:n,transaction:s,disableAutoChildrenMove:Boolean(d)}):!(0,i.Fx)(o)&&u.fn(n)&&function(e){const{store:t}=e;t.recordStoreUIParentStore&&C(e,!1)}({environment:t,store:n,transaction:s,disableAutoChildrenMove:Boolean(d)}),"mermaid_code_block"===o&&c.E5({blocks:[n],language:"Mermaid",transaction:s}),i.Z7[e]&&!i.Z7[o]){n.getPermissionItems().some(a.Le)&&h.MX({environment:t,store:n,transaction:s})}u.BX(n)&&S.rd({blockId:n.id,state:!0,currentUserId:t.currentUser.id});const m=n.getType();m&&y&&p&&(0,i.Um)(p,b)&&!(0,i.Um)(m,n.getFormat())&&function(e){let{environment:t,block:n,parentStore:o}=e;(async()=>{const e=n.getContentStores();await Promise.all(e.map((e=>e.load()))),T.createAndCommit({userAction:"transformActions.runAsync",environment:t,perform:t=>{const i=r.d9(e).reverse();for(const e of i)g.Od({parent:n.getContentStore(),childToRemove:e,transaction:t}),g.BE({parent:o,insert:e,after:n,transaction:t})}})})()}({environment:t,parentStore:y,block:n}),f.jf({store:n,transaction:s})}return n}function P(e){const{environment:t,blocks:n,blockType:a,transaction:l}=e;if(a!==i.Ti.transclusionContainer)if(a!==i.Ti.columnList)if((0,i.sX)(a)){const e=parseInt(a.replace("column","").replace("block","")),i=r.oA(r.DZ(e-1,(()=>b.ZJ({environment:t,blocks:n,transaction:l})))),s=[...n,...i],c=A({environment:t,blocks:s,transaction:l});o.default.afterNextFlush((()=>{_.N_({store:c[0].getBlockTitleStore()})}))}else for(const o of n)M({environment:t,block:o,blockType:a,transaction:l,isMultiBlockTransformation:n.length>1});else A({environment:t,blocks:n,transaction:l});else!function(e){const{environment:t,blocks:n,transaction:o}=e,r=n[0];if(!r)return;const a=r.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;const l=a.getRecordStoreUIParent();if(!l||!(0,d.OY)(l))return;if(!l.isDefined())return;const c=(0,s.ZP)(),u=v.j4({environment:t,id:c,type:i.Ti.transclusionContainer,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId(),useCrdt:l.useCrdt()});g.BE({parent:a,insert:u,after:r,transaction:o});(function(e){const{newParent:t,blocks:n,transaction:o}=e;for(const i of n){const e=i.getRecordStoreUIParent();null!=e&&e.valueIs(p.i)&&(g.Od({parent:e,childToRemove:i,transaction:o}),g.R3({parent:t,append:i,transaction:o}))}})({newParent:u.getContentStore(),blocks:n,transaction:o}),_.ZH(t),y.ZH(t),y.Z5({environment:t,stores:[u]})}({environment:t,blocks:n,transaction:l})}function A(e){const{environment:t,blocks:n,transaction:o}=e,r=n[0];if(!r)return[];const a=r.recordStoreUIParentStore;if(null==a||!a.valueIs(p.i))return[];const l=(0,s.ZP)(),c=v.j4({environment:t,id:l,type:i.Ti.columnList,inMemoryRecordCache:r.inMemoryRecordCache,transaction:o,spaceId:r.getSpaceId(),useCrdt:r.useCrdt()}),{child:d}=g.Vt({parent:a,insert:c,before:r,transaction:o});return n.map((e=>{const n=(0,s.ZP)(),l=v.j4({environment:t,id:n,type:i.Ti.column,inMemoryRecordCache:r.inMemoryRecordCache,transaction:o,spaceId:r.getSpaceId(),useCrdt:r.useCrdt()}),{child:c}=g.Od({parent:a,childToRemove:e,transaction:o}),{child:u}=g.BE({parent:d.getContentStore(),insert:l,transaction:o}),{child:p}=g.BE({parent:u.getContentStore(),insert:c,transaction:o});return p}))}function R(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&P({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}},39865:(e,t,n)=>{n.d(t,{DV:()=>w,Rn:()=>I,Tq:()=>x,y8:()=>k});n(57658);var o=n(15145),i=n(59730),r=n(21202),a=n(23867),s=n(9291),l=n(75754),c=n(33929),d=n(74948),u=n(44604),p=n(80444),m=n(1310),f=n(50906),g=n(54642),h=n(47307),v=n(19785),b=n(8055),y=n(64964),_=n(65452);const S=(0,s.defineMessages)({deletePageConfirmationMessage:{id:"trashActions.deletePagePermanentlyDialog.prompt",defaultMessage:"Are you sure you want to delete this page permanently?"},deletePageConfirmationButton:{id:"trashActions.deletePagePermanentlyDialog.confirmDeleteButton.label",defaultMessage:"Yes. Delete this page"},permanentlyDeleteFailedToast:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.toast",defaultMessage:"Failed to delete, please try again later."},permanentlyDeletePermissionsFailure:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.permissions",defaultMessage:"You do not have sufficient permissions to permanently delete this page."}});async function w(e){const{environment:t,block:n,spaceId:i}=e;u.Z.state.excludePages.add(n.id),u.Z.emit(),await g.restoreBlock(t,{pointer:{table:r.iU,id:n.id,spaceId:i}}),l._({environment:t,store:n,pageVisitSource:o.tY.Restore}),t.device.isMobile&&d.close(),f.Y35(t)}function k(e){const{environment:t,blocks:n,transaction:o,permanentlyDelete:i=!1}=e;for(const r of n)v.zo({block:r,transaction:o});o.postSubmitCallbacks.push((async e=>{e||await g.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:i})}))}function I(e){h.showDialog({message:c.default.formatMessage(S.deletePageConfirmationMessage),showCancel:!0,keepFocus:!1,items:[{label:c.default.formatMessage(S.deletePageConfirmationButton),color:"red",onAccept:()=>x(e)}]})}async function x(e){const{blocks:t,environment:n}=e,{currentSpaceStore:o}=p.default.state,r=e.environment.currentUser.id;if(o&&r){await g.deleteBlocks(e.environment,{blocks:t.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:!0}).then((e=>{if("failed"===e.type)throw function(e){let t=S.permanentlyDeleteFailedToast;(0,i.QW)(e)&&(t=S.permanentlyDeletePermissionsFailure);y.oV({label:c.default.formatMessage(t),durationMs:m.JY})}(e.body),e.error}));for(const e of t)u.Z.state.excludePages.add(e.id),u.Z.emit();await _.l({environment:n,spaceId:o.id,userId:r}),b.CZ({environment:e.environment,blocks:t}),f.tZo(n)}}},27370:(e,t,n)=>{n.r(t),n.d(t,{dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>m,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c});var o=n(9163),i=n(82530),r=n(37181),a=n(64856),s=n(80444);function l(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{r.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,a.ox)(o,t)}}})},userId:o.id})}function c(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const i=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{r.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...i,[t]:(0,a.IJ)(o,t)}}})},userId:o.id})}function d(e,t){var n;const{currentUserSettingsStore:i}=s.default.state;if(!i)return;const a=null===(n=i.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{r.d2({userSettingsStore:i,transaction:e,data:{tutorials:{...a,[t]:o.lR}}})},userId:i.id})}function u(e){const{currentUserSettingsStore:t}=s.default.state;t&&f({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{r.d2({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var i;const{currentUserSettingsStore:l}=s.default.state;if(!l||(0,a.W$)(l,t))return;const c=(0,a.wF)(l,t);o.eU[t].steps.findIndex((e=>e.id===c))>=o.eU[t].steps.findIndex((e=>e.id===n))||r.d2({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(i=l.getSettings())||void 0===i?void 0:i.tutorials,[t]:n}}})}function m(e,t,n){if((0,a.AK)(n))return;const o=(0,a.Xv)(t,n);o&&p(e,t,o)}function f(e){return i.createAndCommit({...e,canUndo:!1})}},12170:(e,t,n)=>{n.d(t,{KT:()=>he,FD:()=>ye,xv:()=>ve,jh:()=>xe,pt:()=>me,os:()=>Re,dY:()=>Ie,pJ:()=>ge,hJ:()=>be,UY:()=>we,yp:()=>Se,sz:()=>Ee,aV:()=>Fe,qK:()=>Ze});n(21703),n(57658);var o=n(26263),i=n(1302),r=n(41432),a=n(99036),s=n(80951),l=n(95538),c=n(77657),d=n(2864),u=n(68626),p=n(20270),m=n(72126),f=n(59753),g=n(4615),h=n(45953),v=n(21202),b=n(77420),y=n(6287),_=n(13493),S=n(32161),w=n(9844),k=n(23867),I=n(90965),x=n(70203),C=n(97880),T=n(44876),M=n(64002),P=n(63143),A=n(9291),R=n(893),D=n(94419),B=n(9953),E=n(24677),F=n(993),Z=n(98104),V=n(82530),j=(n(95477),n(69783)),U=n(65454),L=n(77080);var O=n(70764),N=n(41232),z=n(28415),W=n(33929),q=n(65598),H=n(89224),K=n(58202),G=n(80444),$=n(30874),Q=n(79167),Y=n(19111),J=n(26136),X=n(1634),ee=n(80064),te=n(40671),ne=n(34583),oe=n(57549),ie=n(54642),re=n(90287),ae=n(5149),se=n(47307),le=n(89475),ce=n(27153),de=n(4408),ue=n(64964);const pe=(0,A.defineMessages)({browse:{id:"externalBlock.mediaPicker.browseTab.title",defaultMessage:"Browse {appName}"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"externalActions.dialogError.openFilePicker.errorMessage"},copyDebuggingInformation:{id:"externalActions.dialogItem.openFilePicker.copyDebugData",defaultMessage:"Copy debugging information"},copiedDebuggingInfo:{id:"externalActions.dialogError.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."},userReAuth:{id:"externalActions.dialogError.userReAuth",defaultMessage:"Authentication Expired. Please Re-Authenticate to continue."}});async function me(e){const{environment:t,spaceId:n,force:o}=e;await G.default.waitUntilRendered();const i=$.Z.state,r=t.currentUser.id;if(!i.loaded&&!i.loading||i.loaded&&n!==i.spaceId||i.loaded&&r!==i.userId||o){$.Z.setState({...$.Z.state,loading:!0});const[e,o]=await Promise.all([ie.getExternalIntegrations(t,{spaceId:n}),fe({environment:t,spaceId:n})]);if("success"!==e.type||"success"!==o.type)throw new Error("Request failed.");const i=h.PF.create(e.data.recordMap),r=h.PF.create(o.data.recordMap);$.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:t.currentUser.id,integrations:m.MR(m.oA(e.data.integrationIds.map((e=>i.getValue({table:w.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),externalAuthentications:m.MR(m.oA(o.data.externalAuthenticationIds.map((e=>r.getValue({table:S.P,id:e})))),(e=>{let{created_at:t}=e;return t})),bots:m.Xo(m.oA(o.data.botIds.map((e=>r.getValue({table:b.cZ,id:e})))),(e=>{let{last_edited_at:t,created_at:n}=e;return t||n}),"desc"),completeSlackAuthentications:m.MR(m.oA(o.data.completeSlackAuthenticationIds.map((e=>r.getValue({table:S.P,id:e})))),(e=>{let{created_at:t}=e;return t}))})}}async function fe(e){const{environment:t,spaceId:n}=e;return t.currentUser.isLoggedIn()?await ie.getUserSpaceExternalBots(t,{spaceId:n}):{type:"success",status:200,headers:{},data:{botIds:[],externalAuthenticationIds:[],recordMap:{},completeSlackAuthenticationIds:[]}}}async function ge(e){const{environment:t}=e,{currentSpaceStore:n}=G.default.state;n&&await me({environment:t,spaceId:n.id,force:!0})}function he(e){const{environment:t,blockStore:n,textStore:a,url:s,textValueBeforePaste:d,urlSelection:p}=e,f=H.get();if(!n||j.Z.state.open||Y.Z.state.open||ee.Z.state.open||!f)return!1;const{currentSpaceStore:h}=G.default.state,b=(0,l.x$)(s),S=(0,M.Qc)(b);if(!S.host)return!1;const w=t.currentUser.id;if(null==h||!h.isDefined()||!w)return!1;const C=$.Z.integrations.state.filter((e=>e.id!==c.U9)),P=(0,T.ny)({url:b,integrations:C,currentSpaceId:h.id});if("partial"===P.type)return function(e){const{environment:t,parsedUrl:n,urlDomain:o,integrationId:i}=e;oe.pp(t,{integrationId:i,urlDomain:o}),u.log({level:"debug",from:"activateFromLinkCreation",type:"linkPreviewUrlMiss",data:{miscDataToConvertToString:{integrationId:i,urlDomain:o,path:n.path}}})}({...P,integrationId:P.integration.id,environment:t}),!1;if("failure"===P.type)return!1;const{integration:A,pattern:R}=P;if(!(0,I.wv)({permissions:h.getPermissionItems()},w)&&!(0,I.hU)({spaceBotSettings:h.getBotSettingsStore().getValue(),integrationId:A.id,env:"production"}))return!1;const D=(0,O.NP)(A.id),B=function(e){var t;const{integration:n,pattern:o,blockStore:i,textValueBeforePaste:a}=e,s=i&&i.getType()===r.Ti.text&&0===(0,x.QaF)(a).trim().length,l=Boolean(null===(t=o.additional_types)||void 0===t?void 0:t.collection);return s?m.oA(["preview","mention","link",l&&"collection"]):m.oA(["mention","preview","link",l&&"collection"])}({blockStore:n,integration:A,pattern:R,textValueBeforePaste:d}),E=H.getRect(f);if(!E)return!1;const F=n.getRecordStoreUIParent();if(!F||!(0,q.dz)(F))return!1;const Z=new o.Z({name:"unfurlingActions.activateFromLinkCreation",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(Z);const U=F.clone(Z),L=n.clone(Z),N=a.clone(Z),z=new J.G(t,{table:v.iU,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}),K=z.clone(Z),Q=m.w6(T.wh).map((()=>new J.G(t,{table:v.iU,id:(0,g.ZP)(),spaceId:(0,k.C)(n.pointer.spaceId)}))),X=Q.map((e=>e.clone(Z))),te=new J.NW(t,{table:y.v,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}),ne=te.clone(Z);let ie;ie=R.defaultViews?R.defaultViews.map((e=>new J.Xr(t,{table:_.n,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}))):[new J.Xr(t,{table:_.n,id:(0,g.ZP)(),spaceId:n.pointer.spaceId})];const re=ie.map((e=>e.clone(Z))),ae=m.w6(T.wh).map((()=>new J.NW(t,{table:y.v,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}))),se=ae.map((e=>e.clone(Z))),le=m.w6(T.wh).map((()=>new J.Xr(t,{table:_.n,id:(0,g.ZP)(),spaceId:n.pointer.spaceId}))),ce=le.map((e=>e.clone(Z)));return ee.Z.setState({open:!0,url:b,textValueBeforePaste:d,textValueAfterPaste:a.getValue(),urlSelection:p,renderRect:E,integration:A,pattern:R,currentOption:{type:"link"},allOptionTypes:B,temporaryRecordCache:Z,stores:{blockStore:n,blockParentStore:F,textStore:a,externalObjectInstanceBlockStore:z,subExternalObjectInstanceBlockStores:Q,externalCollectionStore:te,externalCollectionViewStores:ie,subExternalCollectionStores:ae,subExternalCollectionViewStores:le},temporaryStores:{blockParentStore:U,blockStore:L,textStore:N,externalObjectInstanceBlockStore:K,subExternalObjectInstanceBlockStores:X,externalCollectionStore:ne,externalCollectionViewStores:re,subExternalCollectionStores:se,subExternalCollectionViewStores:ce},unfurlResponse:void 0}),D.length>0&&_e({environment:t,url:s,botIds:D.map((e=>{let{id:t}=e;return t})),integrationId:A.id,externalObjectInstanceBlockStore:z}),oe._x(t,{integrationId:A.id,entity:R.name,domain:S.host,from:"link_paste"}),i.default.afterNextFlush((()=>{V.createAndCommit({userAction:"unfurlingActions.activateFromLinkCreation",environment:t,perform:e=>{be({environment:t,type:B[0],useTemporaryRecordCache:!0,transaction:e,intl:W.default.getIntl()})}})})),!0}function ve(e){const{environment:t,setType:n,transaction:o}=e,{currentUserSettingsStore:i}=G.default.state,r=ee.Z.state;if(!r.open)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(r.temporaryRecordCache);const a=(0,O.NP)(r.integration.id).length>0;if(be({environment:t,type:n||r.currentOption.type,useTemporaryRecordCache:!1,transaction:o,intl:W.default.getIntl()}),"preview"===r.currentOption.type&&E.Z5({environment:t,stores:[r.currentOption.externalObjectInstanceBlockStore]}),r.integration&&!a){(null==i?void 0:i.hasDismissedIntegrationPopup({integrationId:r.integration.id}))||X.Z.setState({open:!0,integration:r.integration,externalObjectInstanceBlockId:r.stores.externalObjectInstanceBlockStore.id,unfurlUrl:r.url})}ee.Z.setState({open:!1})}function be(e){const{environment:t,type:n,transaction:o,useTemporaryRecordCache:a}=e,s=ee.Z.state;if(!s.open)return;const c=t.currentUser.id;if(!c)return;const u=a?s.temporaryStores:s.stores;if(a){s.temporaryRecordCache.clearCache();for(const e in s.temporaryStores){const n=s.temporaryStores[e],o=Array.isArray(n)?n:[n];for(const e of o){const n={userId:c,pointer:e.pointer},o=t.defaultRecordCache.inMemoryRecordCache.getRecord(n);o?de.Wl({environment:t,inMemoryRecordCache:s.temporaryRecordCache,pointer:e.pointer,model:f.kk.fromValue(e.pointer.table,o.value),role:o.role,updatePaths:[[]],userId:c,force:!0,debugSource:"setUnfurlingOptionType"}):de.uo({environment:t,inMemoryRecordCache:s.temporaryRecordCache,persistedRecordCache:void 0,pointer:e.pointer,userId:c})}}}const p=(0,l.x$)(s.url),{host:g}=(0,M.Qc)(p);if(g){if("preview"===n||"mention"===n){const{unfurlResponse:e}=s,t=Ve({externalObjectInstanceBlockStore:u.externalObjectInstanceBlockStore,parentId:u.blockParentStore.id}),n={original_url:p,domain:g};let i;if(e){const a=(0,P.m8)(m.oA(e.relations.map(((e,t)=>{if(e.external_schema)return;const n=u.subExternalObjectInstanceBlockStores[t];if(!n)return;const i=e,a={id:n.id,type:r.Ti.externalObjectInstance,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,format:i};return B.sW({store:n,data:a,transaction:o}),[e.uri,n.id]})))),{external_object_id:s,uri:l,bot_id:c}=e.root;if(s&&l&&c){let o,r;const u=(0,d.o)(e.root.attributes,(0,N.o$)());u&&(o=u.block_width,r=u.block_height);const p={...n,...{...e.root,block_width:o,block_height:r,external_schema:void 0},related_external_object_uris_to_instance_ids:a,external_object_id:s,uri:l,bot_id:c};i={...t,format:p}}else{var h;const o={...n,attributes:e.root.attributes,error:e.root.error,auth_refresh_in_progress:439===(null===(h=e.root.error)||void 0===h?void 0:h.status_code)||null};i={...t,format:o}}}else{const e=n;i={...t,format:e}}B.sW({store:u.externalObjectInstanceBlockStore,data:i,transaction:o})}else if("collection"===n){const{unfurlResponse:e}=s,t={id:u.externalObjectInstanceBlockStore.id,version:0,type:r.Ti.collectionView,format:{collection_pointer:u.externalCollectionStore.pointer},collection_id:u.externalCollectionStore.pointer.id,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.blockParentStore.id,alive:!0,view_ids:u.externalCollectionViewStores.map((e=>e.id))},n=u.externalCollectionViewStores.map(((e,t)=>{var n,o,i;return{id:e.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),type:(null===(n=s.pattern.defaultViews)||void 0===n?void 0:n[t].type)||"table",format:null===(o=s.pattern.defaultViews)||void 0===o?void 0:o[t].format,query2:null===(i=s.pattern.defaultViews)||void 0===i?void 0:i[t].query2,parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0}}));let a;if(e){const{external_object_id:n,uri:i,bot_id:r}=e.root;if(n&&i&&r)if("collectionId"in e&&e.collectionId){a={id:e.collectionId,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,schema:{}},t.format=void 0,t.collection_id=e.collectionId}else{const t={};e.relations.forEach(((e,n)=>{const i=u.subExternalCollectionStores[n],r=e,a={id:i.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:y.v,parent_id:u.externalCollectionStore.id,alive:!0,format:r,schema:{}};t[e.uri]=i.id,B.sW({store:i,data:a,transaction:o})}));a={id:u.externalCollectionStore.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:g,...e.root,related_external_object_uris_to_instance_ids:{...t}},schema:{}}}else{a={id:u.externalCollectionStore.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:g,error:e.root.error},schema:{}}}}else{a={id:u.externalCollectionStore.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:g},schema:{}}}B.sW({store:u.externalObjectInstanceBlockStore,data:t,transaction:o});const l=Ae();u.externalCollectionViewStores.forEach(((t,i)=>{e&&"collectionId"in e&&e.collectionId&&n[i].format&&(n[i].format={collection_pointer:{id:e.collectionId,table:y.v}}),l&&e&&"table"===n[i].type&&(n[i].format={...n[i].format,table_properties:Be(e.root.external_schema)}),B.sW({store:t,data:n[i],transaction:o})})),B.sW({store:u.externalCollectionStore,data:a,transaction:o});const c=s.integration;i.default.afterNextFlush((()=>{const e=K.R.findCollectionViewBlockFromId(u.externalObjectInstanceBlockStore.id);if(e){const t=e.collectionContextStore.settingsStore;ae.wl({collectionSettingsStore:t,item:{type:"shareSyncedView",integrationName:c.name,integrationIcon:c.info.icon}})}}))}if("preview"===n){F.sO({environment:t,store:u.textStore,value:s.textValueBeforePaste,transaction:o});const e=J.G.createChildStore(u.blockParentStore,u.externalObjectInstanceBlockStore.pointer);if(D.BE({parent:u.blockParentStore,insert:e,after:u.blockStore,transaction:o}),0===(0,x.QaF)(s.textValueBeforePaste).trim().length){const e=J.G.createChildStore(u.blockParentStore,s.stores.blockStore.pointer);D.Od({parent:u.blockParentStore,childToRemove:e,transaction:o})}const i=J.G.createChildStore(s.stores.blockParentStore,s.stores.externalObjectInstanceBlockStore.pointer);E.ZH(t),ee.Z.setState({...s,currentOption:{type:n,externalObjectInstanceBlockStore:i}})}else if("mention"===n){const e=(0,x.x36)(u.externalObjectInstanceBlockStore.id),n=(0,x.YCD)(e),i=(0,x.P$X)(s.textValueBeforePaste,[n],s.urlSelection.startIndex),r={startIndex:s.urlSelection.startIndex+1,endIndex:s.urlSelection.startIndex+1};F.sO({environment:t,store:u.textStore,value:i,transaction:o}),B.sW({store:u.externalObjectInstanceBlockStore,data:{parent_id:u.textStore.id,parent_table:v.iU,alive:!0},transaction:o}),E.eP({environment:t,store:s.stores.blockStore}),Z.Z5({store:s.stores.textStore,selection:r}),ee.Z.setState({...s,currentOption:{type:"mention",mentionTokenSelection:r}})}else if("link"===n)ee.Z.setState({...s,currentOption:{type:"link"}}),E.eP({environment:t,store:s.stores.blockStore}),Z.Z5({store:s.stores.textStore,selection:{startIndex:s.urlSelection.endIndex,endIndex:s.urlSelection.endIndex}});else if("collection"===n){F.sO({environment:t,store:u.textStore,value:s.textValueBeforePaste,transaction:o});const e=J.G.createChildStore(u.blockParentStore,u.externalObjectInstanceBlockStore.pointer);if(D.BE({parent:u.blockParentStore,insert:e,after:u.blockStore,transaction:o}),0===(0,x.QaF)(s.textValueBeforePaste).trim().length){const e=J.G.createChildStore(u.blockParentStore,s.stores.blockStore.pointer);D.Od({parent:u.blockParentStore,childToRemove:e,transaction:o})}E.ZH(t),ee.Z.setState({...s,currentOption:{type:n}})}else(0,C.t1)(n);if(!a){const{unfurlResponse:e}=s;oe.Mp(t,{integrationId:s.integration.id,type:n,entity:s.pattern.name,domain:g,from:"unfurl_menu",...e&&{status:null!=e&&e.root.error?"failure":"success"},collection_id:"collection"===n?u.externalCollectionStore.pointer.id:void 0,collection_view_block_id:"collection"===n&&u.blockStore.isCollectionView()?u.blockStore.id:void 0})}}}async function ye(e){const{environment:t,notionState:n}=e,{externalObjectInstanceBlockId:o,spaceId:i}=n;if(o){const e=new J.G(t,{table:v.iU,id:o,spaceId:i});let n;if(await Promise.all([e.load(),$.Z.waitUntil((()=>$.Z.state.loaded))]),e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())n=e.getFormat();else if(e.isCollectionView()){var r;n=null===(r=e.getCollectionViewSourceCollectionStore())||void 0===r?void 0:r.getFormat()}if(!n)throw new Error("External object instance has no value.");const a=n.original_url||n.uri;if(!a)throw new Error("External object instance has no original_url.");const s=(0,T.ny)({url:a,integrations:$.Z.integrations.state,currentSpaceId:i});if("success"!==s.type)throw new Error("Could not find integration.");const{integration:l}=s,c=(0,O.NP)(l.id);if(0===c.length)throw new Error("Could not find bot.");if(e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())await _e({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),integrationId:l.id,externalObjectInstanceBlockStore:e});else{if(!e.isCollectionView())throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${e.getType()}`);{const n=e.getCollectionViewSourceCollectionStore();if(!n)throw new Error("Could not find collection store.");await we({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),externalCollectionViewBlockStore:e,externalCollectionStore:n})}}}}async function _e(e){const{environment:t,url:n,botIds:o,integrationId:i,externalObjectInstanceBlockStore:a}=e;te.Z.add(n);const s=await ie.unfurlUrl(t,{url:n,botIds:o,integrationId:i,spaceId:re.Bs()});te.Z.delete(n);const c=ee.Z.state,u="success"===s.type?s.data:{root:{error:{status_code:s.status}},relations:[]};if(c.open&&c.stores.externalObjectInstanceBlockStore===a)ee.Z.setState({...c,unfurlResponse:u}),V.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:e=>{be({environment:t,type:c.currentOption.type,useTemporaryRecordCache:!0,transaction:e,intl:W.default.getIntl()})}});else if(a.isExternalObjectInstanceBlockStore())!function(e){const{environment:t,unfurlResponse:n,url:o,externalObjectInstanceBlockStore:i}=e,a=i.pointer.spaceId;if(!t.currentUser.id)return;const s=(0,l.x$)(o),{host:c}=(0,M.Qc)(s);if(!c)return;if("collectionId"in n)return;const u=i.getFormat().related_external_object_uris_to_instance_ids,p=(0,P.m8)(Object.entries(u||{}).map((e=>{let[t,n]=e;return[t,J.G.createChildStore(i,{id:n,table:v.iU,spaceId:i.getSpaceId()})]})));V.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstanceFromInitialUnfurl",environment:t,perform:e=>{const s=(0,P.m8)(m.oA(n.relations.map((n=>{var o;if(n.external_schema)return;const s=(null===(o=p[n.uri])||void 0===o?void 0:o.id)||(0,g.ZP)(),l=new J.G(t,{table:v.iU,id:s,spaceId:a}),c=n,d={id:l.id,type:r.Ti.externalObjectInstance,space_id:a,parent_table:v.iU,parent_id:i.id,alive:!0,format:c};return B.sW({store:l,data:d,transaction:e}),[n.uri,l.id]})))),l=i.getFormatStore().getValue();let c,u;if(l&&(c=l.block_width,u=l.block_height),!c&&!u){const e=(0,d.o)(n.root.attributes,(0,N.o$)());e&&(c=e.block_width,u=e.block_height)}B.sW({store:i.getFormatStore(),data:{...{...n.root,block_width:c,block_height:u,external_schema:void 0,integration_id:null,original_url:o,is_placeholder:null,error:n.root.error??null},related_external_object_uris_to_instance_ids:s},transaction:e})}})}({environment:t,unfurlResponse:u,url:n,externalObjectInstanceBlockStore:a}),function(e){const{environment:t,url:n,spaceId:o,status:i}=e,r=(0,N.GQ)(n,o),a=(0,l.x$)(n),s=(0,M.Qc)(a);r&&s.host&&oe.Mp(t,{integrationId:r.integration.id,type:"preview",entity:r.pattern.name,domain:s.host,from:"link_preview_placeholder",...i&&{status:i}})}({environment:t,url:n,spaceId:a.getSpaceId(),...u&&{status:u.root.error?"failure":"success"}});else{if(!a.isCollectionView()){if(a.isExternalObjectInstancePageBlockStore())return;throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${a.getType()}`)}{const e=a.getCollectionViewSourceCollectionStore();if(!e)throw new Error("Could not find collection store.");V.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:o=>{ke({environment:t,unfurlResponse:u,url:n,externalCollectionStore:e,externalCollectionViewBlockStore:a,transaction:o})}})}}}async function Se(e){const{environment:t,url:n,botIds:o,userDefinedExternalCollectionStore:i,relatedPageId:a}=e,s=i.getFormat();if(!s.uri||void 0!==s.external_object_id)return;te.Z.add(n);const c=await ie.unfurlUrl(t,{url:n,botIds:o,spaceId:i.getSpaceId(),targetCollectionId:i.id,relatedPageId:a});if("failed"===c.type)return void se.showError(c);te.Z.delete(n);const d=c.data;let u;return"pageId"in d&&d.pageId?u=new J.G(t,{table:v.iU,id:d.pageId,spaceId:i.getSpaceId()}):(u=new J.G(t,{table:v.iU,id:(0,g.ZP)(),spaceId:i.getSpaceId()}),function(e){const{environment:t,unfurlResponse:n,url:o,rootUserDefinedExternalCollectionStore:i,rootExternalObjectInstancePageStore:a}=e,s=i.pointer.spaceId;if(!t.currentUser.id)return;const c=(0,l.x$)(o),{host:d}=(0,M.Qc)(c);if(!d)return;if(!n.root.external_object_id)return;const u=n.root;V.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstancePageFromInitialUnfurl",environment:t,perform:e=>{const t={id:a.id,type:r.Ti.externalObjectInstancePage,space_id:s,parent_table:y.v,parent_id:i.id,alive:!0,format:u};B.sW({store:a,data:t,transaction:e})}})}({environment:t,unfurlResponse:d,url:n,rootUserDefinedExternalCollectionStore:i,rootExternalObjectInstancePageStore:u})),u}async function we(e){const{environment:t,url:n,botIds:o,externalCollectionStore:i,externalCollectionViewBlockStore:r}=e;te.Z.add(n);const a=await ie.unfurlUrl(t,{url:n,botIds:o,spaceId:re.Bs()});te.Z.delete(n);const s="success"===a.type?a.data:{root:{error:{status_code:a.status}},relations:[]};V.createAndCommit({userAction:"unfurlingActions.startUnfurlRequestForCollection",environment:t,perform:e=>{ke({environment:t,unfurlResponse:s,url:n,externalCollectionStore:i,externalCollectionViewBlockStore:r,transaction:e})}})}function ke(e){const{environment:t,unfurlResponse:n,url:o,externalCollectionStore:i,externalCollectionViewBlockStore:r,transaction:c}=e,d=(0,l.x$)(o),{host:u}=(0,M.Qc)(d);if(!u)return;const{external_object_id:p,uri:f,bot_id:h}=n.root;if(!p||!f||!h)return;const b=m.w6(T.wh).map((()=>new J.NW(t,{table:y.v,id:(0,g.ZP)(),spaceId:r.pointer.spaceId}))),S={};n.relations.forEach(((e,t)=>{const n=b[t],o=e,a={id:n.id,version:0,space_id:(0,k.C)(r.pointer.spaceId),parent_table:y.v,parent_id:i.id,alive:!0,format:o,schema:{}};S[e.uri]=n.id,B.sW({store:n,data:a,transaction:c})}));const w={id:i.id,version:0,space_id:(0,k.C)(r.pointer.spaceId),parent_table:v.iU,parent_id:r.id,alive:!0,format:{original_url:d,domain:u,...n.root,property_visibility:(I=n.root.external_schema,I&&Object.keys(I).flatMap((e=>(0,a.HF)(e)?[]:{property:`${s.UU}${e}`,visibility:"hide_if_empty"}))),related_external_object_uris_to_instance_ids:{...S},is_placeholder:void 0,integration_id:void 0},schema:{}};var I;B.sW({store:i,data:w,transaction:c});if(Ae()&&n){const e=r.getCollectionViewIds();null==e||e.forEach((e=>{const t=J.Xr.createChildStore(r,{table:_.n,id:e,spaceId:r.getSpaceId()});if("table"===t.getType()){const e={...t.getFormat(),table_properties:Be(n.root.external_schema)};B.sW({store:t,data:{format:e},transaction:c})}}))}}async function Ie(e){const{environment:t}=e,{externalObjectInstanceBlockPointersMap:n,externalCollectionInstancePointersMap:o}=Q.Z.state;await ie.refetchExternalObjectInstanceBlocks(t,{recordPointers:[...Object.values(n),...Object.values(o)]}),Q.Z.reset()}async function xe(e){const{environment:t,externalAuthenticationValue:n}=e;let o=await ie.getExternalIntegrationAccessToken(t,{botId:n.id,integrationId:n.integration_id,spaceId:n.space_id});if("failed"===o.type){const e=$.Z.integrations.state.find((e=>e.id===n.integration_id));if(!e)return;ue.oV({label:W.default.formatMessage(pe.userReAuth)}),await le.hM({environment:t,integration:e,spaceId:n.space_id,from:"integration_file_picker"});const i=$.Z.bots.state.filter((e=>e.integration_id===n.integration_id))[0];if(!i)return;o=await ie.getExternalIntegrationAccessToken(t,{botId:i.id,integrationId:i.integration_id,spaceId:i.space_id})}return o}function Ce(e){const{integration:t}=e;return t.id===c.YM&&"on"===L.default.getEligibleGroup({experimentId:"box_file_picker",defaultGroup:"control"})?Te({integrationType:"box",...e}):t.id===c.f3&&(0,z.qH)()?Te({integrationType:"drive",...e}):void 0}function Te(e){const{integrationType:t,integration:n}=e;return"box"===t?{type:t,title:W.default.formatMessage(pe.browse,{appName:n.name}),accounts:$.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:Me(e)}:"drive"===t?{type:t,title:W.default.formatMessage(pe.browse,{appName:n.name}),accounts:$.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:Me(e)}:void 0}function Me(e){const{integration:t,environment:n,externalObjectTokenStore:o,externalObjectInstanceBlockStore:i}=e;return async e=>{let r=e?e.id:void 0;if(!e){const{currentSpaceStore:e}=G.default.state,o=$.Z.integrations.state.find((e=>{let{id:n}=e;return n===t.id}));if(o&&e){const i=$.Z.bots.state;await le.hM({environment:n,integration:o,spaceId:e.id,from:"integration_file_picker"});const a=function(e,t){const n=$.Z.bots.state;var o;if(e.length!==n.length)return null===(o=n.filter((e=>e.integration_id===t))[0])||void 0===o?void 0:o.id}(i,t.id);a&&(r=a)}}const a=$.Z.externalAuthentications.state.find((e=>e.id===r));if(a){const e=await async function(e,t,n,o,i){if(!$.Z.state.loaded)return;i.setState({error:!1,loading:!0});const r=await xe({environment:e,externalAuthenticationValue:o});if(i.setState({error:!r||"success"!==r.type,loading:!1}),r&&"failed"!==r.type)return r.data;se.showDialog({message:W.default.formatMessage(pe.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:W.default.formatMessage(pe.copyDebuggingInformation),color:void 0,onAccept:()=>{const t={statusCode:null==r?void 0:r.status,integrationId:n.id,botId:o.id};R.RD({environment:e,stringValue:JSON.stringify(t,null,2),copiedMessage:pe.copiedDebuggingInfo})}}]})}(n,0,t,a,o);e&&(ce.Z(),await function(e){const{integration:t,tokenDetails:n,environment:o,externalObjectInstanceBlockStore:i,botId:r}=e;if(t.id===c.YM)return async function(e,t){const{access_token:n}=e;try{await(0,U.ZP)("https://cdn01.boxcdn.net/polyfills/core-js/2.5.3/core.min.js",{resourceType:U._g.Javascript});const e=[{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.js",resourcetype:U._g.Javascript},{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.css",resourcetype:U._g.Stylesheet}];await Promise.all(e.map((e=>{let{url:t,resourcetype:n}=e;return(0,U.ZP)(t,{resourceType:n})})))}catch(a){return void t(!0,"")}const o=document.createElement("div");o.setAttribute("id","box-app-container"),document.body.appendChild(o);const i=new Box.FilePicker;i.show("0",n,{size:"small",container:"#box-app-container",maxSelectable:1,logoUrl:"box"});const r=()=>{i.hide(),o.remove()};i.addListener("choose",(function(e){var n;const o=null==e||null===(n=e[0])||void 0===n?void 0:n.id;o&&t(!1,`https://app.box.com/file/${o}`),r()})),i.addListener("cancel",r)}(n,Pe({environment:o,externalObjectInstanceBlockStore:i,botId:r}));if(t.id===c.f3)return(0,z.vE)({environment:o,accessToken:n.access_token,callback:Pe({environment:o,externalObjectInstanceBlockStore:i,botId:r}),integration:t,from:"link_preview_placeholder"});return void t.id}({integration:t,environment:n,externalObjectInstanceBlockStore:i,externalObjectTokenStore:o,botId:a.id,tokenDetails:e}))}}}function Pe(e){const{environment:t,externalObjectInstanceBlockStore:n,botId:o}=e;return(e,i)=>{if(e)return se.showDialog({message:W.default.formatMessage(pe.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:W.default.formatMessage(pe.copyDebuggingInformation),color:void 0,onAccept:()=>{const n={err:e,botId:o};R.RD({environment:t,stringValue:JSON.stringify(n,null,2),copiedMessage:pe.copiedDebuggingInfo})}}]});De({environment:t,externalObjectInstanceBlockStore:n,url:i,botId:o})}}function Ae(){return L.default.checkGate("is_visibility_enabled_for_db_sync")}function Re(e){const{environment:t,originRect:n,externalObjectInstanceBlockStore:o,integration:i}=e,r=[{type:"embed",onChange:n=>{De({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),ce.Z()}}];if(L.default.checkGate("ai_source_picker")&&((null==i?void 0:i.id)===c.Gw||(null==i?void 0:i.id)===c.mC)){const n=(null==i?void 0:i.id)===c.Gw?"/images/external_integrations/github-icon.png":"/images/external_integrations/jira-icon.png";r.push({type:"aiSourcePicker",integration:null==i?void 0:i.id,defaultAvatar:n,onChange:n=>{De({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),ce.Z()},getResults:async(e,n)=>await async function(e){const{environment:t,query:n,integrationId:o,botId:i}=e,r=i?[i]:$.Z.bots.state.filter((e=>e.integration_id===o)).map((e=>{let{id:t}=e;return t}));if(0===r.length)return{root:{error:{status_code:500,messages:["No bot found for this integration"]}},relations:[]};return await async function(e){const{environment:t,query:n,botIds:o}=e,i=await ie.aiSourcePicker(t,{query:n,botIds:o,spaceId:re.Bs()}),r="success"===i.type?i.data:{root:{error:{status_code:i.status}},relations:[]};return"failed"===i.type&&se.showError(i),r}({environment:t,query:n,botIds:r})}({environment:t,query:e,integrationId:n})})}if(i&&!t.device.isMobile){const n=Ce({integration:i,environment:t,externalObjectInstanceBlockStore:o,externalObjectTokenStore:e.externalObjectTokenStore});n&&r.push(n)}ce.$(t,{originGap:0,originRect:n,title:"Embed Link Preview",currentTab:"embed",tabs:r})}function De(e){const{environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:i,botId:r}=e,a=(0,T.ny)({url:n,integrations:$.Z.integrations.state,currentSpaceId:o.getSpaceId()});if("success"===a.type){const{integration:e,pattern:i}=a,s=r?[r]:$.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t}));if(s.length>0){const r=o.getParentId(),a=(0,l.x$)(n),{host:c}=(0,M.Qc)(a);if(c&&r){const a={...Ve({externalObjectInstanceBlockStore:o,parentId:r}),format:{original_url:n,domain:c}};V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o,data:a,transaction:e})}}),oe._x(t,{integrationId:e.id,entity:i.name,domain:c,from:"placeholder"})}_e({environment:t,url:n,botIds:s,integrationId:e.id,externalObjectInstanceBlockStore:o})}else V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o.getFormatStore(),data:{integration_id:null,original_url:n,is_placeholder:null},transaction:e})}})}else if("partial"===a.type){const{integration:e}=a;V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:t=>{B.sW({store:o.getFormatStore(),data:{is_placeholder:null,integration_id:e.id,original_url:n,error:{status_code:p.Rl.UNPROCESSABLE_ENTITY}},transaction:t})}})}else"failure"===a.type?V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o.getFormatStore(),data:{is_placeholder:null,original_url:n,integration_id:i,error:{status_code:p.Rl.UNPROCESSABLE_ENTITY}},transaction:e})}}):(0,C.t1)(a)}function Be(e){return e&&Object.entries(e).flatMap((e=>{let[t,n]=e;return(0,a.HF)(t)?[]:"hidden"===(null==n?void 0:n.visibility)?{property:`${s.UU}${t}`,visible:!1}:{property:`${s.UU}${t}`,visible:!0}}))}function Ee(e){const{environment:t,block:n,transaction:o}=e;if(!n.isDefined()||!ne.M_(t)||!n.isType(r.Ti.externalObjectInstance))return;const i=(0,g.ZP)(),a={id:i,type:r.Ti.externalObjectInstance,parent_id:n.id,parent_table:n.table,space_id:n.getSpaceId(),alive:!0,format:n.getFormat()};B.ae({environment:t,table:v.iU,value:a,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o});const s=n.getFormatStore().getKeyStore("related_external_object_uris_to_instance_ids").getValue();if(s)for(const r of Object.values(s)){const e={table:v.iU,id:r,spaceId:n.getSpaceId()};V.applyOperation({store:(0,J.Kv)(n,e),operation:{pointer:e,path:[],command:"update",args:{parent_table:v.iU,parent_id:i}},transaction:o})}const l=[(0,x.YCD)((0,x.x36)(i))];B.sO({store:n,value:{type:r.Ti.text,properties:{title:l},format:null},transaction:o})}function Fe(e){var t;const{block:n,transaction:o,token:i,parentStore:r}=e,{tokenIndex:a}=i;if(!n.isDefined())return;const s=null===(t=r.getParentBlockStore())||void 0===t?void 0:t.getContentStore();if(!s)return;F.gy({block:r,transaction:o,tokenIndex:a})&&D.BE({parent:s,insert:n,after:r,transaction:o})}function Ze(e){const{environment:t,spaceId:n,from:o,store:i,bypassCache:r}=e,a=(0,N.y6)(i),s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);if(!s)return;const l=(0,N.GQ)(s,n),d=(0,N.Ue)(s,n);if(!l||0===d.length)return;const u=i.getCollectionViewCollectionStore(),{integration:p,pattern:m}=l;i.isCollectionView()&&u?ie.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...u.pointer,spaceId:n}],bypassCache:r}):i.isExternalObjectInstancePageBlockStore()?c.tO.includes(p.id)?_e({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:i}):ie.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...i.pointer,spaceId:n}],bypassCache:r}):i.isExternalObjectInstanceBlockStore()&&_e({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:i}),oe.B3(t,{integrationId:p.id,entity:m.name,from:o})}function Ve(e){const{externalObjectInstanceBlockStore:t,parentId:n}=e;return{id:t.id,version:0,type:r.Ti.externalObjectInstance,space_id:(0,k.C)(t.pointer.spaceId),parent_table:v.iU,parent_id:n,alive:!0}}},53471:(e,t,n)=>{n.d(t,{A3:()=>O,IL:()=>E,K_:()=>z,Q7:()=>F,W8:()=>N,Xo:()=>D,cR:()=>U,cT:()=>V,dm:()=>G,nQ:()=>R,y:()=>L});n(21703),n(57658);var o=n(15095),i=n(7406),r=n(68626),a=n(72126),s=n(29477),l=n(4615),c=n(149),d=n(53770),u=n(23867),p=n(70203),m=n(63143),f=n(9291),g=n(91754),h=n(33954),v=n(33929),b=n(52533),y=n(2414),_=n(77080),S=n(73329),w=n(53730),k=n(91551),I=n(88923),x=n(88893),C=n(88280),T=n(57549),M=n(54642),P=n(35253);const A=(0,f.defineMessages)({uploadFileFailed:{defaultMessage:"Upload failed.",id:"uploadActions.uploadFailedError.message"}});function R(e){return e.filter((e=>e.getAlive())).map((e=>{const{source:t,title:n,size:o}=e.getProperties()||{};return{type:"remote",id:e.id,source:p.QaF(t),name:p.QaF(n),size:p.QaF(o),store:e}}))}function D(e){return{...B(e),id:(0,l.ZP)(),dataURL:URL.createObjectURL(e),type:"local"}}function B(e){return{file:e,name:e.name,size:`${(e.size/1024).toFixed(1)}KB`}}function E(e){var t;const n=e.files.map(B);null===(t=e.onBatchStart)||void 0===t||t.call(e,n);const o={};let r=0;s.dC(e.files,q,(t=>Promise.all(t.map((t=>{const n=(0,l.ZP)();return new Promise(((s,l)=>{const u={environment:e.environment,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},file:t,onStart:t=>{var o;null===(o=e.onSingleFileStart)||void 0===o||o.call(e,t,n)},onProgress:t=>{var o,i;let{progressPercent:a,uploadedFiles:s}=t;null===(o=e.onBatchProgress)||void 0===o||o.call(e,{progressPercent:a,uploadedFiles:r}),null===(i=e.onSingleFileProgress)||void 0===i||i.call(e,{progressPercent:a,uploadedFiles:s},n)},onComplete:i=>{var a;r++,o[t.name]=i,null===(a=e.onSingleFileComplete)||void 0===a||a.call(e,i,n),s()},onError:t=>{var o;const i=new Error(t.message);null===(o=e.onSingleFileError)||void 0===o||o.call(e,i,n),l(i)},preventLimitFreeFileSize:e.preventLimitFreeFileSize};"confluence"===e.uploadType?async function(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,r=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){var s;null===(s=e.onStart)||void 0===s||s.call(e,B(n));const o=Math.floor(n.size/Z)+1,f={bucket:e.bucket,name:n.name,contentType:r,supportExtraHeaders:!0,contentLength:n.size,numberOfFileChunks:o},g=await M.initiateMultipartUpload(t,f);var l;if("failed"===g.type)return void(null===(l=e.onError)||void 0===l||l.call(e,{message:g.error.message,offline:g.offline}));const h=await async function(e){const{file:t,signedUrlsForChunks:n}=e,o=[];let r,s,l,c=[];const u=[];for(let i=0;i<n.length;i++){r=i*Z,s=(i+1)*Z,l=i+1<n.length?t.slice(r,s):t.slice(r);const e=n[i],a=fetch(e,{method:"PUT",body:new Blob([l],{type:t.type})});o.push(a)}const p=a.yo(o,3);for(const[a,g]of p.entries()){var m;try{const e=await(0,d.Yb)((()=>Promise.all(g)),[100,1e3,3e3]);c=[...c,...e]}catch(f){return{error:(0,i.tg)(f)}}null===(m=e.onProgress)||void 0===m||m.call(e,{progressPercent:Math.floor(a/p.length*100),uploadedFiles:0})}return c.forEach(((e,t)=>{const n=e.headers.get("etag");n&&u.push({ETag:n,PartNumber:t+1})})),{value:u}}({file:n,signedUrlsForChunks:g.data.signedUrlsForChunks,onProgress:e.onProgress});var u;if(c.x.isFail(h))return void(null===(u=e.onError)||void 0===u||u.call(e,{message:h.error.message,offline:void 0}));const v={...f,multipartUploadEtags:h.value,fileKey:g.data.key,uploadId:g.data.uploadId},b=await M.completeMultipartUpload(t,v);var p,m;if("success"===b.type)null===(p=e.onComplete)||void 0===p||p.call(e,g.data.url);else null===(m=e.onError)||void 0===m||m.call(e,{message:b.error.message,offline:b.offline})}else O(e.environment)}(u):j(u)}))}))))).then((()=>{var t;const n=e.files.map((e=>o[e.name]));null===(t=e.onBatchComplete)||void 0===t||t.call(e,n)})).catch((t=>{var n;"confluence"===e.uploadType&&T.a1(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:t,fileSize:e.files[0].size},flowId:e.flowId}),null===(n=e.onBatchError)||void 0===n||n.call(e,t)}))}function F(e){const{preventLimitFreeFileSize:t,environment:n,file:o}=e,i=C.subscriptionDataStoreInstance.state;let r=!1;if(n.device.isMobileNative){const e="personal"===x.M9(n);r=!((0,b.S$)({environment:n})&&e)}return!(!t&&i&&x.Bu(i)&&!r&&o.size>W)}const Z=20971520;function V(e){const{retryWhenOffline:t,backoffController:n=new y.h(void 0)}=e;j({...e,onComplete:t=>{var o;n.getFailures()>0&&_.default.logEvent("upload_offline_success_after_retries",n.getFailures()),null===(o=e.onComplete)||void 0===o||o.call(e,t)},onError:o=>{var i;if(t&&o.offline){if(_.default.checkGate("autoretry_file_uploads"))return void n.backOffOnFailure(10*m.C0).then((()=>{V({...e,backoffController:n})}));_.default.logEvent("upload_offline_failure")}null===(i=e.onError)||void 0===i||i.call(e,o)}})}async function j(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,i=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){e.onStart&&e.onStart(B(n));const o="secure"===e.bucket?{bucket:e.bucket,name:n.name,contentType:i,record:{table:e.record.table,id:e.record.id,spaceId:(0,u.C)(e.record.spaceId)},supportExtraHeaders:!0,contentLength:n.size}:{bucket:e.bucket,name:n.name,contentType:i,supportExtraHeaders:!0,contentLength:n.size};"secure"===e.bucket&&await w.transactionQueue.awaitRecordTransaction(e.record);const a=await M.getUploadFileUrl(t,o);if("success"===a.type){const{url:t,signedPutUrl:o,putHeaders:l}=a.data,c=s.UZ(),d=new XMLHttpRequest;d.open("PUT",o),d.setRequestHeader("Content-type",i);for(const e of l)d.setRequestHeader(e.name,e.value);d.upload.addEventListener("progress",(t=>{if(t.lengthComputable){const n=Math.round(100*t.loaded/t.total);e.onProgress&&e.onProgress({progressPercent:n,uploadedFiles:0})}})),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c.resolve({value:t}):(r.log({level:"error",from:"uploadActions",type:"ClientUploadError",data:{miscDataToConvertToString:{status:d.status,responseText:d.responseText}}}),c.resolve({error:{message:v.default.formatMessage(A.uploadFileFailed),offline:0===d.status}})))},d.send(n);const u=await c.promise;u.error?e.onError&&e.onError(u.error):e.onComplete&&(e.onComplete(t),r.log({level:"info",from:"uploadActions",type:"ClientUploadSuccess",data:{miscDataToConvertToString:{url:t}}}))}else if(e.onError){const t=(0,h.wf)(v.default.getIntl(),a);e.onError({message:t,offline:a.offline})}}else O(e.environment)}function U(e){K({...e,onChange:t=>{if(!t.files||0===t.files.length)return;const n=Array.from(t.files);E({environment:e.environment,files:n,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},onBatchStart:e.onStart,onBatchProgress:e.onProgress,onBatchComplete:e.onComplete,onBatchError:e.onError,preventLimitFreeFileSize:e.preventLimitFreeFileSize})}})}async function L(e){const t=s.UZ();return K({...e,onChange:e=>{const n=o.p4(e.files);t.resolve(n)}}),t.promise}function O(e){P.Bw({bannerStore:I.default.state.open?k.Z:S.Z,id:"SubscriptionEditingBlocker",styleKey:g.v.Red,contentKey:"upload_limit_exceeded"})}function N(){P.qL({bannerStore:S.Z,id:"SubscriptionEditingBlocker"}),P.qL({bannerStore:k.Z,id:"SubscriptionEditingBlocker"})}const z=5,W=1e6*z,q=5;let H;const K=function(e){H&&H.remove(),H=document.createElement("input"),H.type="file",H.style.opacity="0",H.style.pointerEvents="none",H.style.position="fixed",H.style.left="-1000px",H.style.top="-1000px",H.ariaHidden="true",document.body.appendChild(H),e.multiple?H.setAttribute("multiple",""):H.removeAttribute("multiple"),e.accept&&H.setAttribute("accept",e.accept),H.addEventListener("change",(()=>{e.onChange&&e.onChange(H)})),H.addEventListener("blur",(()=>{e.onBlur&&e.onBlur(H)})),H.addEventListener("click",(e=>{e.stopPropagation()})),H.click(),H.focus({preventScroll:!0})};function G(e){return e.filter($).map((e=>e.file))}function $(e){return"local"===e.type}},70782:(e,t,n)=>{n.d(t,{f:()=>y,x:()=>b});var o=n(87997),i=n(15145),r=n(9852),a=n(54153),s=n(75754),l=n(12955),c=n(87381),d=n(32223),u=n(55081),p=n(75538),m=n(80444),f=n(77080),g=n(26136),h=n(90287),v=n(97977);async function b(e){const{newCurrentUserId:t,loggedOutUserId:n,environment:i}=e;await v.setLocalStorageUserId(i,t),(0,r.setSessionUserId)(t),await l.setCookie(i,{name:"notion_user_id",value:t});const s=i.currentUser.loggedInUserIds.filter((e=>e!==n)),m=await l.getGhostAdminUserId(i),g={...i,currentUser:new o.CurrentUser({id:t,loggedInUserIds:s,adminUserId:m})};if(i.updateCurrentUserId){const e={environment:i,currentUserId:t,userIds:s};"on"!==f.default.getGroup("await-update-user-id")?await i.updateCurrentUserId(e):i.updateCurrentUserId(e)}a.Z.set(c.currentUserIdKey,t),d.resetRecordSubscriptions(),p.default.reset();return await u.zJ(i)&&u.yH(g),await h.KJ(g,t),g}async function y(e){const{newCurrentUserId:t,environment:n,store:o}=e,{mainEditorCurrentBlockStore:r}=m.default.state,a=await b({environment:n,newCurrentUserId:t});if(r){const e=new g.G(a,o.pointer);m.default.setState({...m.default.state,mainEditorCurrentBlockStore:void 0}),s._({environment:a,store:e,pageVisitSource:i.tY.SwitchSpace})}}},12321:(e,t,n)=>{n.d(t,{j:()=>g,w:()=>h});n(21703),n(57658);var o=n(45953),i=n(21202),r=n(15047),a=n(77858),s=n(66079),l=n(45950),c=n(5659),d=n(88310),u=n(88632),p=n(29226),m=n(54642),f=n(4408);function g(e,t){!function(){v&&u.Z.removeListener(v);p.Z.reset()}(),async function(e,t){try{const n=await c.A.measure("loadUserContent","(current user)",(()=>async function(e){const{defaultRecordCache:t,currentUser:n}=e;if(!t.persistedRecordCache)throw new Error("No local database found.");const o=n.id;if(!o)throw new Error("User is not logged in.");const i=[],c=await l.yY({environment:e,recordPointers:[{table:s.dx,id:o}],recurFn:e=>{const t=[],n=e=>{e&&(e.table!==a.zU&&e.table!==s.dx||i.push(e),t.push(e))};return e.table===s.dx?(n(e.getUserPointer()),e.getSpaceViewPointers().forEach(n)):e.table===a.zU?(e.getBookmarkedPagePointers().forEach(n),e.getSharedPagePointers().forEach(n),n(e.getSpacePointer())):e.table===r.bx&&e.getPagePointers().forEach(n),t},recordIsRequired:e=>e.table===s.dx||e.table===a.zU});for(const r of i){const e=c.getModel(r);if(c.getRole(r)&&!e)throw new Error(`Not defined: ${r.table}, ${r.id}`)}return{recordMap:c.toJson({allowVersionDowngrade:!1})}}(e))),i=o.PF.create(n.recordMap);f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:i,debugSource:"fetchLocalUserContent"}),p.Z.setState({...p.Z.state,localSpaceInaccessiblePages:y(i,t)}),p.Z.state.readyPromise.resolve()}catch(n){}}(e,t),b(e);let n=u.Z.state.online;v=()=>{const t=u.Z.state.online;!t||n||p.Z.state.remoteSpaceInaccessiblePages||b(e),n=t},u.Z.addListener(v)}async function h(){await p.Z.state.readyPromise.promise}let v;async function b(e){d.$L("await_get_spaces_start");const t=await m.getSpaces(e,{},void 0,void 0,void 0,"getSpaces");d.$L("await_get_spaces_end");const n=e.currentUser.id;if("success"===t.type)for(const[i,r]of Object.entries(t.data)){const t=o.PF.create(r);f.fL({environment:e,userId:i,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:t,debugSource:"fetchAllUserSpaces"}),i===n&&(p.Z.setState({...p.Z.state,remoteSpaceInaccessiblePages:y(t,i)}),p.Z.state.readyPromise.resolve())}}function y(e,t){const n={};for(const{pointer:o}of e.getByTable(r.bx)){const a=o.id,s=e.getValue({table:r.bx,id:a});if(s){const o=new Set;if(s.pages){for(const t of s.pages){e.getValue({table:i.iU,id:t})||o.add(t)}n[t]||(n[t]={}),n[t][a]=o}}}return n}},39634:(e,t,n)=>{n.d(t,{j:()=>_,z:()=>S});var o=n(13991),i=n(24211),r=n(7250),a=n(7928),s=n(88642),l=n(77472),c=n(28020),d=n(79897),u=n(33929),p=n(58455),m=n(80444),f=n(77080),g=n(88280),h=n(25888),v=n(54642),b=n(98958),y=n(12714);function _(e){const{environment:t,from:n,prepopulatedContent:i}=e;h.Ot(t,{from:n});const a=(0,c.Fv)(),u=p.default.state;if(t.device.isMobileNative){const e=(0,c.B7)(t),n=`${t.device.os} v${t.device.mobileAppVersion}(${t.device.version})`,o="team@makenotion.com",i=`Help with my account ${null==e?void 0:e.getEmail()} on ${n}`,r=()=>{const e=encodeURIComponent(i);y.D({environment:t,url:`mailto:${o}?subject=${e}`})},a=t.mobileNative;a&&a.api.submitUserFeedback?a.submitUserFeedback({sendToEmailAddress:o,subject:i},r):r()}else if(u.isZendeskEnabled&&(0,l.Ug)()){const{userHighestPlanType:e,isSalesAssistedPlan:n}=(0,d.rf)(t);(0,s.g)({locale:o.SP,analyticsSettings:u,isForethoughtEnabled:f.default.checkGate("forethought"),forethoughtInitializeArgs:S(t),userHighestPlanType:e,isSalesAssistedPlan:n,cookieService:t.cookieService}),h.LS(t)}else if(u.isIntercomEnabled){function e(){if(a&&a.id)return v.annotateRecentIntercomConversation(t,{page:a})}let n=0;const o=3,s=60;async function l(){n++;const t=await e();t&&"success"===t.type&&"not_found"===t.data.status&&n<o&&setTimeout(l,s)}r.Nv({prepopulatedContent:i,waitForCssInsets:()=>b.waitForCssInsets(t)}),setTimeout(l,1e3*s)}}function S(e){var t,n,o;const r=u.default.getIntl(),s=null===(t=m.default.state.currentUserStore)||void 0===t?void 0:t.getValue(),l=s?(0,a.Nz)(r,s,!0):void 0,c=null===(n=g.subscriptionDataStoreInstance.state)||void 0===n?void 0:n.subscriptionTier,d=(null===(o=m.default.state.currentUserSettingsStore)||void 0===o||null===(o=o.getSettings())||void 0===o?void 0:o.preferred_locale)||i.al;return{fullName:l,email:null==s?void 0:s.email,planType:c,locale:d,cookieService:e.cookieService}}},1742:(e,t,n)=>{n.d(t,{BW:()=>f,GD:()=>m,sA:()=>g,uO:()=>v});n(57658);var o=n(68626),i=n(77897),r=n(63143),a=n(68056),s=n(77080),l=n(24666),c=n(10910);const d=15*r.C0,u={user_flow_edit_block:.005,user_flow_edit_page_title:.01,user_flow_create_block:.01,user_flow_delete_block:.01};function p(e){const t=u[e];if(void 0!==t)return(0,i.aw)(t);const n=s.default.getConfigKey("event_trail_events",e);if("object"==typeof n&&"number"==typeof n.sampleRate)return(0,i.aw)(n.sampleRate);const o=s.default.getConfigKey("event_trail_events","defaultSampleRateUserFlows");return"number"==typeof o&&(0,i.aw)(o)}class m{constructor(e){this.stage=void 0,this.timeout=void 0,this.error=void 0,this.logDataInCaseOfFailure=void 0,this.postFinishCallbacks=[],this.environment=void 0,this.userFlow=void 0,this.entryPointName=void 0,this.handleTimeout=()=>{this.fail("timeout")};const{environment:t,userFlow:n,entryPointName:o,timeoutMs:i}=e;this.environment=t,this.userFlow=n,this.entryPointName=o;e.isEnabled??p(n)?(this.stage="inProgress",this.timeout=window.setTimeout(this.handleTimeout,i??d),this.debugLog("constructed")):this.stage="disable"}isDisabled(){return"disable"===this.stage}updateLogDataInCaseOfFailure(e){this.logDataInCaseOfFailure={...this.logDataInCaseOfFailure,...e}}succeed(){"inProgress"===this.stage&&this.finish("success")}fail(e){"inProgress"===this.stage&&(this.error=e,this.finish("fail"))}finish(e){this.stage=e,this.debugLog("finish"),"number"==typeof this.timeout&&window.clearTimeout(this.timeout),this.timeout=void 0,c.rT(this.environment,this.userFlow,{status:e,error:this.error,entryPointName:this.entryPointName}),"fail"===e&&o.log({level:"error",from:"userFlowActions",type:"userFlowFailed",data:{userFlow:this.userFlow,userFlowEntrypointName:this.entryPointName,userFlowError:this.error,...this.logDataInCaseOfFailure}});for(const t of this.postFinishCallbacks)t()}debugLog(){}}class f extends m{constructor(e){super(e),this.pointer=void 0,this.succeedOnEnqueue=void 0,this.trackCallbacks=[];const{succeedOnEnqueue:t}=e;this.succeedOnEnqueue=t}track(e,t){if("inProgress"===this.stage&&void 0===this.pointer){this.pointer=e,h({tracker:this,transaction:t,succeedOnEnqueue:this.succeedOnEnqueue});for(const e of this.trackCallbacks)e();this.debugLog("track",e.id)}}}class g extends f{constructor(e,t){super({environment:e,userFlow:"user_flow_create_page",entryPointName:t,succeedOnEnqueue:!1}),this.handleTextSelectionChange=e=>{"inProgress"===this.stage&&this.pointer&&"editing"===e.state.mode&&(0,a.qS)(e.state.multiSelection)&&e.state.multiSelection.start.store.pointer.id===this.pointer.id&&this.succeed()},"inProgress"===this.stage&&this.trackCallbacks.push((()=>{l.default.addListener(this.handleTextSelectionChange),this.postFinishCallbacks.push((()=>{l.default.removeListener(this.handleTextSelectionChange)}))}))}}function h(e){const{tracker:t,transaction:n,succeedOnEnqueue:o}=e;"inProgress"===t.stage&&(t.updateLogDataInCaseOfFailure({transactionId:n.id,transactionUserAction:n.getUserActionForAnalyticsPurposesOnly()}),n.annotateWithUserFlow(t.userFlow),n.postCancelCallbacks.push((()=>{t.fail("cancelled_transaction")})),n.postEnqueueActions.push((()=>{n.isEmpty()?t.fail("empty_transaction"):o&&t.succeed()})))}function v(e,t,n,o){if(!p(t))return;h({tracker:new m({environment:e,userFlow:t,isEnabled:!0,entryPointName:o}),transaction:n,succeedOnEnqueue:!0})}},37181:(e,t,n)=>{n.d(t,{$n:()=>k,GK:()=>_,Kq:()=>I,Nb:()=>b,Qm:()=>w,Zf:()=>h,d2:()=>g,dM:()=>S,fG:()=>f,rx:()=>v,zq:()=>y});n(57658);var o=n(79946),i=n(42875),r=n(95477),a=n(15010),s=n(95697),l=n(80444),c=n(26136),d=n(75769),u=n(50906),p=n(9953),m=n(82530);async function f(e){if(!r.default.isAdminMode)return;const{currentUserSettingsStore:t}=l.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const{device:o}=e,a={};(0,i.r)()!==n.time_zone&&(a.time_zone=(0,i.r)()),o.isDesktopBrowser&&!n.used_desktop_web_app&&(a.used_desktop_web_app=!0),o.isMobileBrowser&&!n.used_mobile_web_app&&(a.used_mobile_web_app=!0),o.isElectron&&o.isMac&&!n.used_mac_app&&(a.used_mac_app=!0),o.isElectron&&o.isWindows&&!n.used_windows_app&&(a.used_windows_app=!0),o.isMobileNative&&o.isIOS&&!n.used_ios_app&&(a.used_ios_app=!0),o.isMobileNative&&o.isAndroid&&!n.used_android_app&&(a.used_android_app=!0),Object.keys(a).length>0&&m.createAndCommit({userAction:"userSettingsActions.updateUserSettingsOnReset",environment:e,perform:e=>{g({userSettingsStore:t,data:a,transaction:e})}})}const g=function(e){const{userSettingsStore:t,data:n,transaction:o}=e;p.sW({store:t.getSettingsStore(),data:n,transaction:o})};function h(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToMonday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:1},transaction:e})}})}function v(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToSunday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:0},transaction:e})}})}function b(e){const{transaction:t,userSettingsStore:n,spaceId:o,type:i}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","sidebar_outliner_settings",o,i,"has_pinned"]),value:!0,transaction:t})}function y(e){var t;const n=null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=l.default.state.currentUserSettingsStore,{collectionId:i,dbType:r,transaction:a}=e;if(n&&o){var s;const e=(null===(s=o.getSettings())||void 0===s?void 0:s.lastUsedTypedCollections)||{},t=e[n]||{},l=t[r]||[],c=[i,...l.filter((e=>e!==i))].slice(0,1);g({userSettingsStore:o,transaction:a,data:{lastUsedTypedCollections:{...e,[n]:{...t,[r]:c}}}})}}function _(e){const{transaction:t,userSettingsStore:n,integrationId:o}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","dismissed_link_preview_integration_popup",o]),value:!0,transaction:t})}function S(e,t){const n=(0,o.SY)(),i=(0,o.Q3)();if(!n||!i)return;const r={};i&&(r.fbp=i),n&&(r.click_ids=n),m.createAndCommit({userAction:"userSettingsActions.persistAdClick",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{e||((0,o.iI)(),(0,o.HR)())})),g({userSettingsStore:t,data:r,transaction:e})}})}function w(e){const t=l.default.state.currentUserSettingsStore;if(!t)return;const n=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();Boolean(n)||m.createAndCommit({userAction:"dismissShareButtonTooltip",environment:e,userId:t.id,perform:e=>{g({userSettingsStore:t,data:{seen_share_button_tooltip_at:Date.now()},transaction:e})}})}function k(e){let{environment:t,teamId:n}=e;if(!d.Z.hasShownTootlip(n))return;if((0,s.wP)(t))return;const o=(0,a.WD)(t);if(!o)return!1;m.createAndCommit({userAction:"userSettingsActions.dismissTeamAddAppTemplateTooltip",environment:t,userId:o.id,perform:e=>{g({userSettingsStore:o,data:{seen_team_add_app_template_tooltip_at:Date.now()},transaction:e})}}),u.yeF(t,{from:"team_add_app_template"})}function I(e,t){const{phase:n,transactionUserAction:o,userSettingsStore:i}=t;m.createAndCommit({environment:e,userAction:o,perform:e=>{g({userSettingsStore:i,transaction:e,data:{enterprise_launch_modal_phase:n}})}})}},65452:(e,t,n)=>{n.d(t,{h:()=>g,l:()=>h});n(21703);var o=n(15157),i=n(72126),r=n(44615),a=n(29477),s=n(45953),l=n(21202),c=n(45950),d=n(5659),u=n(2688),p=n(92425),m=n(54642),f=n(4408);async function g(e){const{environment:t,userId:n,spaceId:o}=e,a=(0,r.NP)({userId:n,spaceId:o});if(!y||y!==a){let n;!function(e){b&&u.Z.removeListener(b,e)}(t);const o=(t,o)=>{void 0!==n&&n!==o&&h(e),n=o},r=i.P2(o,5e3);b=u.Z.addListener(a,r,void 0,t),y=a;if(!p.Z.getSharedPagesState(e))return h(e)}}async function h(e){const{environment:t,userId:n,spaceId:i}=e,r=p.Z.getSharedPagesState(e);if(r&&r.loadingDone)return r.loadingDone;const u=(0,a.UZ)();p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:null==r?void 0:r.currentPageIds,loadingDone:u.promise}});try{const r=async function*(e,t,n){try{const n=await d.A.measure("loadUserSharedPages","(current user)",(()=>async function(e,t){const{id:n}=e.currentUser;if(!n)throw new Error("Must be logged in.");if(!e.defaultRecordCache.persistedRecordCache)throw new Error("No local database found.");const i=o.Z.get({userId:n,key:v({userId:n,spaceId:t.spaceId})})||void 0;if(!i)throw new Error("No local shared pages found.");const r=await c.yY({environment:e,recordPointers:i.map((e=>({table:l.iU,id:e}))),recurFn:()=>[],recordIsRequired:()=>!1});return{pages:i,recordMap:r.toJson({allowVersionDowngrade:!1})}}(e,{spaceId:t})));f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:s.PF.create(n.recordMap),debugSource:"loadUserSharedPagesInSpace"}),yield n}catch(r){}const i=await m.getUserSharedPagesInSpace(e,{spaceId:t,includeDeleted:!0},n);"success"===i.type&&(e.defaultRecordCache.persistedRecordCache&&o.Z.set({userId:e.currentUser.id,key:v({userId:n,spaceId:t}),value:i.data.pages}),yield i.data)}(t,i,n);for await(const e of r)p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:e.pages,loadingDone:u.promise}});const a=p.Z.getSharedPagesState(e);a&&a.currentPageIds?p.Z.setSharedPagesState({spaceId:i,userId:n,state:{currentPageIds:a.currentPageIds,loadingDone:void 0}}):p.Z.setSharedPagesState({spaceId:i,userId:n,state:void 0})}catch(g){p.Z.setSharedPagesState({spaceId:i,userId:n,state:void 0})}}function v(e){return`UserSharedPagesInSpace:${e.userId}:${e.spaceId}`}let b,y},9377:(e,t,n)=>{n.d(t,{E:()=>S,j:()=>w});var o=n(74487);const i=["2021-05-11","2021-05-13","2021-08-16","2022-02-22","2022-06-28"],r=i[i.length-1];o.literals(...i);var a=n(4615),s=n(77420),l=n(19889),c=n(35794),d=n(9291),u=n(57549),p=n(33929),m=n(80444),f=n(77080),g=n(26136),h=n(54642),v=n(47307),b=n(9953),y=n(82530);const _=(0,d.defineMessages)({webhookUrlError:{id:"webhookActions.webhookUrlError",defaultMessage:"Connection failed. Please wait and try again or try another URL."}});async function S(e){const{environment:t,integration:n,webhookUrl:o,webhookSecret:i,webhookSubscriptionId:d,onError:f,onSuccess:S=(()=>{})}=e,{currentUserRootStore:w,currentSpaceStore:k}=m.default.state;if(!w||!k)return{error:{success:!1}};if("failed"===(await h.testWebhookConnection(t,{integrationId:n.id,webhookUrl:o,webhookSecret:i||void 0})).type)return v.showErrorMessage(p.default.formatMessage(_.webhookUrlError)),{error:{success:!1}};const{serverCommitResult:I}=y.createAndCommit({userAction:"webhookActions.createWebhookSubscription",environment:t,perform:p=>{p.postSubmitCallbacks=[f];const h=Date.now(),v=k.id;if(e.webhookSubscriptionId){const e=m.default.state.currentSpaceStore,r=d&&e?g.n4.createChildStore(e,{id:d,table:c.b,spaceId:e.id}):void 0;if(r){const e=r.getWebhookUrl()!==o,a=r.getWebhookSecret()!==i;(e||a)&&(u.AS(t,{integration_id:n.id,has_updated_webhook_url:e||void 0,has_updated_webhook_secret:a||void 0}),b.sW({transaction:p,data:{webhook_url:o,webhook_secret:i},store:r}))}}else{const e=a.ZP();b.ae({environment:t,table:s.cZ,value:{id:e,space_id:v,parent_id:k.id,parent_table:"space",type:"external",alive:!0,name:n.getName(),icon:n.getInfo().icon,integration_id:n.id,capabilities:n.getCapabilities(),created_at:h,last_edited_at:h,last_edited_by_id:w.id,created_by_id:w.id,created_by_table:l.KJ,last_edited_by_table:l.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),b.ae({environment:t,table:c.b,value:{id:a.ZP(),bot_id:e,space_id:v,parent_id:k.id,api_version:r,webhook_url:o,webhook_secret:i,parent_table:"space",last_edited_time:h,last_edited_by_id:w.id,created_by_id:w.id,created_time:h,created_by_table:l.KJ,last_edited_by_table:l.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),u.eR(t,{integration_id:n.id,configuration_type:"manual",bot_id:e})}}});return await I,S(),{value:{success:!0}}}async function w(e){const t=f.default.checkGate("webhooks_beta"),{environment:n,spaceId:o}=e;if(!n.currentUser.isLoggedIn()||!t)return{webhookSubscriptionIds:[],recordMap:{}};const i=await h.getWebhookSubscriptions(n,{spaceId:o});if("failed"===i.type)throw v.showError(i),i;return i.data}},29919:(e,t,n)=>{n.d(t,{Cq:()=>M,Y:()=>T,Zi:()=>C});var o=n(92996),i=n(46283),r=n(41432),a=n(4615),s=n(71644),l=n(21202),c=n(6287),d=n(13493),u=n(70203),p=n(9291),m=n(52821),f=n(33929),g=n(45010),h=n(26136),v=n(1310),b=n(50906),y=n(14900),_=n(47307),S=n(9953),w=n(64964),k=n(82530),I=n(68422),x=n(73060);const C=(0,p.defineMessages)({home:{id:"wikiActions.collectionView.home",defaultMessage:"Home"},allPages:{id:"wikiActions.collectionView.allPages",defaultMessage:"All pages"},pagesIOwn:{id:"wikiActions.collectionView.pagesIOwn",defaultMessage:"Pages I own"},pagePropertyName:{id:"wikiActions.collectionView.pagePropertyName",defaultMessage:"Page"},ownerPropertyName:{id:"wikiActions.collectionView.ownerPropertyName",defaultMessage:"Owner"},tagsPropertyName:{id:"wikiActions.collectionView.tagsPropertyName",defaultMessage:"Tags"},tagsDesignValue:{id:"wikiActions.collectionView.tagsDesignValue",defaultMessage:"Design"},tagsOnboardingValue:{id:"wikiActions.collectionView.tagsOnboardingValue",defaultMessage:"Onboarding"},verificationPropertyName:{id:"wikiActions.collectionView.verificationPropertyName",defaultMessage:"Verification"},undoToast:{id:"wikiActions.convertToWiki.undo.toastMessage",defaultMessage:"Turned {pageName} into a wiki"}});function T(e){const{blocks:t,transaction:n,environment:p,source:y}=e,_=(0,a.ZP)(),I=t[0];if(!I||!I.isPageBlock())return;const T=I.getSpaceId(),P=(0,a.ZP)(),A=I.getFormat().page_icon,R=(0,s.ZP)(),D=i.k.Owner,B=(0,s.ZP)(),E=(0,s.ZP)(),F={title:{name:f.default.formatMessage(C.pagePropertyName),type:"title"},[D]:{name:f.default.formatMessage(C.ownerPropertyName),type:"person",default:"created_by"},[E]:{name:f.default.formatMessage(C.tagsPropertyName),type:"multi_select",options:[{id:(0,a.ZP)(),value:f.default.formatMessage(C.tagsOnboardingValue),color:"blue"},{id:(0,a.ZP)(),value:f.default.formatMessage(C.tagsDesignValue),color:"green"}]},[R]:{name:m.SO.last_edited_time,type:"last_edited_time",date_format:"relative"}},Z=[{visible:!0,property:"title",width:300},{visible:!0,property:D,width:150},{visible:!0,property:B,width:150},{visible:!0,property:E,width:150},{visible:!0,property:R,width:250}];F[B]={name:f.default.formatMessage(C.verificationPropertyName),type:"verification",verifier_property:D};const V={table:c.v,id:P,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,V),operation:{pointer:V,command:"set",path:[],args:{id:P,version:0,parent_table:l.iU,parent_id:I.id,space_id:T,name:I.getTitleValue(),schema:F,cover:I.getFormat().page_cover,format:{...I.getFormat(),collection_mode:{type:"page_tree",root_page_pointer:{table:l.iU,id:I.id,spaceId:T}},app_config_uri:o.GZ,property_visibility:[{property:R,visibility:"hide"},{property:E,visibility:"show"},{property:D,visibility:"show"},{property:B,visibility:"show"}],collection_page_properties:Z,collection_cover_position:I.getFormat().page_cover_position},icon:A,alive:!0}},transaction:n});const j=(0,a.ZP)(),U=(0,a.ZP)(),L=(0,a.ZP)();S.sW({store:I,data:{type:r.Ti.collectionViewPage,collection_id:P,format:{...I.getFormat(),collection_pointer:V,app_config_uri:o.jh,app_uri_map:{[o.GZ]:P},app_id:_},view_ids:[j,U,L]},transaction:n});const O={table:d.n,id:j,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,O),operation:{pointer:O,command:"set",path:[],args:{id:j,version:0,type:"page",name:f.default.formatMessage(C.home),parent_id:I.id,parent_table:"block",space_id:T,format:{page_pointer:{id:(0,a.Mt)(I.id),spaceId:T,table:"block"}},alive:!0}},transaction:n});const N={table:d.n,id:U,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,N),operation:{pointer:N,command:"set",path:[],args:{id:U,version:0,type:"table",name:f.default.formatMessage(C.allPages),parent_id:I.id,parent_table:"block",space_id:T,format:{table_properties:Z},query2:{sort:[{property:R,direction:"descending"}]},alive:!0}},transaction:n});const z={table:d.n,id:L,spaceId:T};k.applyOperation({store:(0,h.Kv)(I,z),operation:{pointer:z,command:"set",path:[],args:{id:L,version:0,type:"table",name:f.default.formatMessage(C.pagesIOwn),parent_id:I.id,parent_table:"block",space_id:T,format:{table_properties:Z,property_filters:[{id:(0,a.ZP)(),filter:{filter:{value:{type:"relative",value:"me"},operator:"person_contains"},property:D}}]},query2:{sort:[{property:R,direction:"descending"}]},alive:!0}},transaction:n});const W=g.Z.PageScroller;W&&W.scrollToTop({animate:!0}),x.rm(n),b.wtf(p,{source:y,root_page_id:I.id,collection_id:P}),function(e){const{environment:t,blocks:n}=e,o=n[0];if(!o||!o.isCollectionViewPageWithContent())return;const i=(0,u.QaF)(o.getTitleValue());v.ZP.setState({...v.ZP.state,shouldReset:!1}),w.d4({item:{label:f.default.formatMessage(C.undoToast,{pageName:i}),durationMs:v.JY},undoFunc:()=>{k.createAndCommit({userAction:"wikiActions.wikiConversionToast.undo",environment:t,perform:e=>{M({environment:t,blocks:n,transaction:e,source:"snackbar"})}})}})}({environment:p,blocks:t})}function M(e){var t;const{environment:n,blocks:o,transaction:i,source:a}=e,s=o[0];if(!s||!s.isCollectionView())return void _.deprecatedShowErrorMessage("Something went wrong");const l=s.getFormat().collection_pointer;if(!l)return void _.deprecatedShowErrorMessage("Something went wrong");const c=h.NW.createChildStore(s,l),d=null===(t=s.getCover())||void 0===t?void 0:t.cover,u=c.getFormat().collection_cover_position,p=c.getName();I.vs({environment:n,block:s,blockType:r.Ti.page,transaction:i}),S.sW({store:s,data:{format:{...s.getFormat(),app_config_uri:void 0,app_uri_map:void 0,app_id:void 0,page_cover:d,page_cover_position:u},properties:{...s.getProperties(),title:p}},transaction:i}),y.A9({collectionViewBlockStore:s,collectionStore:c,transaction:i}),b.qA6(n,{source:a,root_page_id:s.id,collection_id:l.id})}},73060:(e,t,n)=>{n.d(t,{B1:()=>s,FO:()=>c,Rg:()=>l,nX:()=>u,rm:()=>d});var o=n(28182),i=n(80444),r=n(82530),a=n(37181);function s(){const{currentUserSettingsStore:e}=i.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.wiki_onboarding_phase??"unseen":void 0}function l(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n<o.dF.length-1){const{currentUserSettingsStore:t}=i.default.state;if(!t)return;r.createAndCommit({userAction:"wikiOnboardingActions.advanceOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n+1]}})}})}}function c(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n>1){const{currentUserSettingsStore:t}=i.default.state;if(!t)return;r.createAndCommit({userAction:"wikiOnboardingActions.previousOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n-1]}})}})}}function d(e){const{currentUserSettingsStore:t}=i.default.state;t&&"unseen"===s()&&a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"home"}})}function u(e){if("complete"===s())return;const{currentUserSettingsStore:t}=i.default.state;t&&r.createAndCommit({userAction:"wikiOnboardingActions.completeOnboarding",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"complete"}})},userId:t.id})}},89626:(e,t,n)=>{n.d(t,{ON:()=>m,__:()=>u,h1:()=>f,lZ:()=>h,sy:()=>p,w9:()=>g});n(21703);var o=n(67294),i=n(480),r=n(49085),a=n(66673),s=n(28182),l=n(82530),c=n(37181),d=n(80444);const u=r.default.createValue(void 0);function p(){const{currentUserSettingsStore:e}=d.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.ai_onboarding_phase??"space_for_ai":void 0}function m(e){"space_for_ai"===p()&&f(e)}function f(e){const t=p();if(void 0===t)throw new Error("Assertion failure, AI onboarding state is undefined!");const n=s.AQ.indexOf(t);if(-1===n)throw new Error(`Assertion failure, ${t} is not a valid AI onboarding state!`);if(n<s.AQ.length-1){const{currentUserSettingsStore:t}=d.default.state;if(!t)return;l.createAndCommit({userAction:"AiOnboardingActions.advanceAIOnboardingStage",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:s.AQ[n+1]}})},userId:t.id})}}function g(e){const t=(0,i.O7)(),n="completionPopup"===e.type&&"results"===e.stage&&!e.loading,r=(0,a.D9)(n);(0,o.useEffect)((()=>{r&&!n&&"refine_ai_response"===p()&&f(t)}),[n,r,t])}function h(e){const t=(0,i.O7)(),n="results"===e.stage&&e.loading,r=(0,a.D9)(n);(0,o.useEffect)((()=>{n&&!r&&"ask_ai_anything"===p()&&f(t)}),[n,r,t])}},63594:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(!0)},92022:(e,t,n)=>{n.r(t),n.d(t,{closeInitialPromptAndEndSession:()=>_,closeInitialPromptButContinueSession:()=>S,openHelpMeWriteGenericPopup:()=>I,retryInitialPrompt:()=>y,showInitialPromptForAIBlock:()=>w,toggleInitialPrompt:()=>k});var o=n(4615),i=n(10910),r=n(54642),a=n(84084),s=n(98104),l=n(78663),c=n(19124),d=n(68056),u=n(77907),p=n(80444),m=n(21273),f=n(16772),g=n(27724),h=n(24666),v=n(89626);function b(e){"completionPopup"!==e.type||"initialPrompt"!==e.stage||"textSelection"!==e.context.type&&"cursor"!==e.context.type||s.NA({multiSelection:e.context.textSelection})}function y(e){f.default.invalidateLastUpdater();const{environment:t}=e,{state:n}=f.default;if("completionPopup"!==n.type||"results"!==n.stage)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache);const o={type:"completionPopup",stage:"initialPrompt",prefilledValue:"",context:n.context,sessionId:n.sessionId,from:n.from,futureRevisions:[...n.revisions,...n.futureRevisions]};f.default.setState(o)}function _(){b(f.default.state),f.default.setState({type:"closed"})}function S(){const{state:e}=f.default;b(e),"completionPopup"===e.type&&"initialPrompt"===e.stage&&f.default.setState({type:"closedWithContext",context:e.context,sessionId:e.sessionId,futureRevisions:e.futureRevisions}),setTimeout((()=>{"closedWithContext"===f.default.state.type&&f.default.reset()}),1)}function w(e){f.default.setState({...e,type:"completionPopup",stage:"initialPromptForAIBlock",from:"ai_block",prefilledValue:"",sessionId:(0,o.ZP)()}),x({environment:e.environment,promptForAnalytics:e.clientPrompt})}async function k(e){const{environment:t,from:n}=e;let{context:i,prefilledValue:a,sessionId:s}=e,c={type:"closed"};if("closed"===f.default.state.type){if(!i&&g.default.state.stores.length>0){const e=h.default.state;i="empty"===e.mode?(0,l.Xc)():(0,d.iG)(e.multiSelection)?(0,l.FD)():(0,l.Fu)()}i&&(a||(a=""),s||(s=(0,o.ZP)()),c={type:"completionPopup",stage:"initialPrompt",context:i,from:n,prefilledValue:a,sessionId:s,futureRevisions:[]},p.default.state.currentSpaceStore&&r.publishAiSession(t,{inference_type:"writer",spaceId:p.default.state.currentSpaceStore.id,id:c.sessionId,metadata:{from:n}}),"spacebar"===n&&(0,v.ON)(t))}if(f.default.setState(c),x(e),m.Z.isAssistantInWriterEnabled()){const{assistantActions:e}=await u.deps.assistant.loader();e.clearActiveAssistantSession({environment:t})}}function I(e){const{title:t,environment:n}=e,i=(0,l.FD)();if(!i)return;const r=t?(0,c.qB)({customPrompt:t,isPageEmpty:!0}):c.eL;k({environment:n,from:"page_menu",prefilledValue:(0,l.$W)(r),promptForAnalytics:r,sessionId:(0,o.ZP)(),context:i})}function x(e){const{environment:t,promptForAnalytics:n}=e,{state:o}=f.default;"completionPopup"===o.type&&"results"!==o.stage&&("initialPromptForAIBlock"!==o.stage&&s.ZH(t),i.Tl(t,{session_id:o.sessionId,prompt_key:(null==n?void 0:n.key)??(o.prefilledValue?"unknown":"alternative_ui_empty_input"),from:o.from}),a.xv())}},71184:(e,t,n)=>{n.d(t,{Gl:()=>l,JS:()=>c,QC:()=>d,gC:()=>s,kg:()=>u});n(30541);var o=n(4615),i=n(37181),r=n(30793);function a(e,t){return e.id===t.id}function s(e,t,n){const o=c(t).slice(),s=o.findIndex((t=>a(e,t)));-1===s?o.unshift(e):o.splice(s,1,e),(0,r.lG)(e.action,t,n),i.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function l(e,t){for(const n of c(e))if((0,r.YK)(n.action,t))return n}function c(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.favorite_ai_actions)??[]}function d(e,t,n){const o=c(t).filter((t=>!a(t,e)));i.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function u(e){return{id:(0,o.ZP)(),name:e.promptTitle??"",action:{...e,promptTitle:void 0}}}},62878:(e,t,n)=>{n.r(t),n.d(t,{importGtmFavorite:()=>f});n(67294);var o=n(9291),i=n(10910),r=n(47307),a=n(64964),s=n(82530),l=n(80444),c=n(71184),d=n(24405),u=n(85893);function p(e){window.__c={n:"FavoriteImportContent"};const{favorite:t,isReplacingFavorite:n}=e,i=(0,d.yK)((e=>({title:{fontWeight:700,marginBottom:"1em"},prompt:{color:e.lightTextColor,maxHeight:"5em",overflowY:"scroll",whiteSpace:"pre-wrap"}})),[]),r=n?(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite â€œ{favoriteName}â€ AI action?",id:"ai.favoriteActions.importFavorite.overwriteMessage",values:{favoriteName:t.name}}):(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add â€œ{favoriteName}â€ AI action?",id:"ai.favoriteActions.importFavorite.addMessage",values:{favoriteName:t.name}}),a=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoritePrompt}â€",id:"ai.favoriteActions.importFavorite.prompt",values:{favoritePrompt:t.action.prompt}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:i.title,children:r}),(0,u.jsx)("div",{style:i.prompt,children:a})]})}var m=n(13555);async function f(e){const{environment:t}=e,n=await(0,m.cx)({environment:t,blockId:e.importArgs.blockId});"error"!==n.type?await async function(e){const{environment:t,newFavorite:n}=e,{currentUserSettingsStore:d}=l.default.state;if(!d)return;const m=(0,c.JS)(d);let f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add AI action",id:"ai.favoriteActions.importFavorite.addAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Cancel",id:"ai.favoriteActions.importFavorite.cancelAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action added to your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteAdded",values:{favoriteName:n.name}}),v=!1;for(const i of m)if(i.name===n.name){if(i.action.type===n.action.type&&i.action.prompt===n.action.prompt)return void a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action is already in your Favorites.",id:"ai.favoriteActions.importFavorite.alreadyInFavorites",values:{favoriteName:n.name}})});n.id=i.id,v=!0,f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite existing AI action",id:"ai.favoriteActions.importFavorite.overwriteAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Keep existing AI action",id:"ai.favoriteActions.importFavorite.keepExistingAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action updated in your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteUpdated",values:{favoriteName:n.name}});break}if(!(await r.confirmUserAction({message:(0,u.jsx)(p,{favorite:n,isReplacingFavorite:v}),acceptLabel:f,cancelLabel:g})))return;s.createAndCommit({userAction:"favoriteActions.handleFavoriteImport",environment:t,perform(e){(0,c.gC)(n,d,e)}}),a.oV({label:h}),i.Vo(t,{type:"create_from_url",session_id:void 0,gtm_favorite_id:n.gtmFavoriteId})}({environment:t,newFavorite:n.favorite}):a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"An error occurred when loading the AI action. ({errorCode})",id:"ai.favoriteActions.importFavorite.favoriteFailedToLoad",values:{errorCode:n.code}})})}},13555:(e,t,n)=>{n.d(t,{OF:()=>c,cx:()=>p});var o=n(4615),i=n(45953),r=n(70203),a=n(54642),s=(n(95477),n(77080));let l=function(e){return e[e.NoConfig=100]="NoConfig",e[e.LoadPageChunkFailed=101]="LoadPageChunkFailed",e[e.MissingPageRecord=103]="MissingPageRecord",e[e.InvalidPageParent=104]="InvalidPageParent",e[e.MissingTitle=105]="MissingTitle",e[e.MissingPromptText=106]="MissingPromptText",e[e.MissingCollectionSchema=107]="MissingCollectionSchema",e[e.MissingPromptType=108]="MissingPromptType",e[e.InvalidPromptType=109]="InvalidPromptType",e[e.FavoritesDisabled=110]="FavoritesDisabled",e}({});function c(){{const e=s.default.getConfigKey("gtm_ai_favorites","space_id"),t=s.default.getConfigKey("gtm_ai_favorites","collection_id");if(e&&t)return{spaceId:e,collectionId:t}}}function d(e,t,n){const o=function(e,t,n){for(const i in e){const r=e[i];var o;if(r&&r.name===n)return null===(o=t.properties)||void 0===o?void 0:o[i]}}(e,t,n);if(o)return(0,r.Jcv)(o)}function u(e){return{type:"error",code:e}}async function p(e){var t;const{environment:n,blockId:p}=e;if(await s.default.waitUntilStatsigReady(),!s.default.checkGate("ai_favorites"))return u(l.FavoritesDisabled);const m=c();if(!m)return u(l.NoConfig);const{spaceId:f,collectionId:g}=m,h=await a.loadCachedPageChunk(n,{page:{spaceId:f,id:p},limit:0,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1});if("success"!==h.type)return u(l.LoadPageChunkFailed);const v=i.PF.create(h.data.recordMap),b=v.getValue({table:"block",id:p,spaceId:f});if(!b)return u(l.MissingPageRecord);if(b.parent_id!==g)return u(l.InvalidPageParent);const y=(0,r.Jcv)(null===(t=b.properties)||void 0===t?void 0:t.title);if(!y)return u(l.MissingTitle);const _=await async function(e){const{environment:t,recordMap:n,blockId:o,spaceId:i,collectionId:r}=e,s=n.getValue({table:"collection",id:r,spaceId:i});if(null!=s&&s.schema)return s.schema;const l=await a.getPublicPageData(t,{type:"block-space",blockId:o,spaceId:i});return"failed"!==l.type?l.data.collectionSchema:void 0}({environment:n,recordMap:v,blockId:p,spaceId:f,collectionId:g});if(!_)return u(l.MissingCollectionSchema);const S=d(_,b,"Prompt text");if(!S)return u(l.MissingPromptText);const w=d(_,b,"Prompt type");if(!w)return u(l.MissingPromptType);const k="Help me edit"===(I=w)?"helpMeEdit":"Help me write"===I?"helpMeWrite":void 0;var I;if(!k)return u(l.InvalidPromptType);const x=function(e,t,n){return"Yes"===d(e,t,n)}(_,b,"Run immediately");return{type:"success",favorite:{id:(0,o.ZP)(),name:y,executeImmediately:x,gtmFavoriteId:p,action:{type:k,prompt:S,promptTitle:void 0}}}}},57819:(e,t,n)=>{n.d(t,{$b:()=>I,Dj:()=>C,RR:()=>_,Tq:()=>k,VZ:()=>S,bJ:()=>y,jq:()=>x,rR:()=>w,yR:()=>T});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(42875),l=n(66673),c=n(82883),d=n(97880),u=n(893),p=n(56518),m=n(43455),f=n(33929),g=n(89224),h=n(80444),v=n(17903),b=n(42057);function y(){const e=(0,i.O7)(),t=(0,r.VK)((()=>e.device.isPhone),[e]);return(0,a.yK)((e=>{const n="dark"===e.mode?e.accentColors.purple[900]:e.accentColors.purple[400];return{purpleButton:{padding:4,fontWeight:600,color:n},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.lightTextColor,display:t?"none":void 0},lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.mediumTextColor,height:32,marginTop:2},returnIndicatorIconStyles:{width:14,height:14,paddingLeft:4,fill:e.lightIconColor},keyboardShortcutInverted:{color:e.mediumInvertedTextColor,paddingLeft:4},writingLabel:{flex:1,color:n,fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center"},inputActions:{height:36,display:"flex",alignSelf:"flex-end",alignItems:"center"},loadingDots:{backgroundColor:n}}}),[t])}function _(e){if("completionPopup"===e.type)return e}function S(e){return"initialPromptForAIBlock"===e.stage?"aiBlock":e.context.type}function w(e){return"initialPromptForAIBlock"===e.stage?"write":function(e){switch(e.type){case"cursor":return"write";case"blockSelection":case"textSelection":return"edit"}}(e.context)}function k(e){g.clear(e)}function I(e){if("initialPromptForAIBlock"===e.stage){const t=e.originRef.current;if(!t)return;return{origin:t.getBoundingClientRect(),scrollerStore:C(e.store.getRecordStoreUIRoot())}}return e.context}function x(e){const{areWeLoading:t,scrollerStore:n,resetWhenScrolledToBottom:i}=e,a=(0,l.D9)(t);(0,o.useEffect)((()=>{t!==a&&c(!1)}),[t,a]);const[s,c]=(0,o.useState)(!1),d=(0,r.VK)((()=>null==n?void 0:n.state.scrollTop),[n]),u=(0,l.D9)(d),p=(0,r.VK)((()=>{const e=null==n?void 0:n.state.clientRect;if(e)return n.state.scrollHeight-e.height}),[n]);return(0,o.useEffect)((()=>{void 0!==u&&void 0!==d&&u-d>1&&c(!0)}),[d,u]),(0,o.useEffect)((()=>{i&&void 0!==d&&void 0!==p&&Math.abs(d-p)<1&&c(!1)}),[p,d,i]),s}function C(e){return e===h.default.state.mainEditorCurrentBlockStore?v.Z:b.Z}function T(e,t){const n=f.default.getIntl(),o=(0,c.X)({intl:n,textValue:t.getBlockTitleStore().getValue(),getRecordModel:t.getRecordModel,userTimeZone:(0,s.r)()}),i=t.getRenderableContentStores().map((e=>e.getValue())).filter(d.$K);return{title:o,content:[u.jm({rootBlock:{...t.pointer,spaceId:t.getSpaceId()},getRecordValue:t.getRecordValue}),(0,p.X4)({rootBlock:{...t.pointer,spaceId:t.getSpaceId()},getRecordValue:t.getRecordValue,blockValues:i,isWindows:e.device.isWindows,markdownSerializationOptions:(0,m.KF)(),markdownLinkifyIt:void 0}).markdown].filter(d.$K).join("\n\n")}}},72899:(e,t,n)=>{n.d(t,{E0:()=>i,GC:()=>r,oF:()=>a});var o=n(77907);const i=o.deps.ai,r=(0,o.lazyComponent)(i,(e=>e.CompletionPopup)),a=(0,o.lazyComponent)(i,(e=>e.AiEligibilityUpdater))},30793:(e,t,n)=>{n.d(t,{BG:()=>l,Nv:()=>r,TE:()=>d,YK:()=>i,lG:()=>s,pz:()=>a});var o=n(37181);function i(e,t){return e.prompt===t.prompt&&e.type===t.type}function r(e,t,n){const r=a(t).filter((t=>!i(t,e)));o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:[e,...r].slice(0,100)}})}function a(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.recent_ai_actions)??[]}function s(e,t,n){const r=a(t),s=r.filter((t=>!i(t,e)));r.length!==s.length&&o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:s}})}function l(e){const{clientPrompt:t,additionalContext:n,promptTitle:o}=e,i=null==n?void 0:n.prompt;if(("helpMeWrite"===t.key||"helpMeEdit"===t.key||"helpMeDraft"===t.key)&&i)return{type:"helpMeDraft"===t.key?"helpMeWrite":t.key,prompt:i,promptTitle:o};const r=function(e,t){if(!d(e.key))return;return null==t?void 0:t.topic}(t,n);return r?{type:"helpMeWrite",prompt:r,promptTitle:o}:void 0}const c={brainstormIdeas:!0,blogPost:!0,outline:!0,socialMediaPost:!0,pressRelease:!0,creativeStory:!0,essay:!0,poem:!0,todoList:!0,meetingAgenda:!0,prosConsList:!0,jobDescription:!0,salesEmail:!0,recruitingEmail:!0};function d(e){return c[e]}},24502:(e,t,n)=>{n.d(t,{M:()=>l,Z:()=>s});var o=n(67294),i=n(72126),r=n(24990),a=n(77907);function s(){(0,o.useEffect)((()=>{l()}),[])}const l=i.IH((async function(){const e=await a.deps.emojiData.loader();r.Z.setState(e)}))},4993:(e,t,n)=>{n.d(t,{M:()=>r,Z:()=>s});var o=n(67294),i=n(480);const r=new Set;function a(){for(const e of r)e()}function s(){const e=(0,i.Fy)();(0,o.useEffect)((()=>{if(e.isMobile)return document.addEventListener("scroll",a,!0),()=>{document.removeEventListener("scroll",a,!0)}}),[e.isMobile])}},30583:(e,t,n)=>{n.d(t,{IL:()=>s,ZP:()=>l});var o=n(67294),i=n(480),r=n(25898),a=n(39500);let s={x:0,y:0,moved:!1,device:"mouse"};function l(){const e=(0,i.O7)();(0,o.useEffect)((()=>(e.device.isMobile?(window.addEventListener("touchstart",c),window.addEventListener("touchmove",d),window.addEventListener("mousedown",u),window.addEventListener("mousemove",p)):(window.addEventListener("mousedown",u),window.addEventListener("mousemove",p)),()=>{e.device.isMobile?(window.removeEventListener("touchstart",c),window.removeEventListener("touchmove",d),window.removeEventListener("mousedown",u),window.removeEventListener("mousemove",p)):(window.removeEventListener("mousedown",u),window.removeEventListener("mousemove",p))})),[e.device.isMobile])}function c(e){const t=e.touches[0];s={moved:!1,x:t.clientX,y:t.clientY,device:(0,a.Nf)(t)}}function d(e){const{x:t,y:n}=s,o=e.touches[0];(0,r.Z)(t,n,o.clientX,o.clientY)>a.Vc[(0,a.Nf)(o)]&&(s={...s,moved:!0})}function u(e){s={moved:!1,x:e.clientX,y:e.clientY,device:"mouse"}}function p(e){const{x:t,y:n}=s;(0,r.Z)(t,n,e.clientX,e.clientY)>a.Vc.mouse&&(s={...s,moved:!0})}},91851:(e,t,n)=>{n.d(t,{JN:()=>G,NN:()=>$,vD:()=>q,Xi:()=>W,w0:()=>Q,RQ:()=>H,uR:()=>Y});n(21703),n(57658);var o=n(67294),i=n(92996),r=n(41892),a=n(8848),s=n(39068),l=n(33907),c=n(88437),d=n(37612),u=n(72126),p=n(4615),m=n(89101),f=n(21202),g=n(15047),h=n(29369),v=n(97880),b=n(82990),y=n(64002),_=n(9291),S=n(8406),w=n(54642),k=n(16956),I=n(47307),x=n(96802),C=n(8055),T=n(82530),M=n(37181),P=n(86628),A=n(24405),R=n(1136),D=n(40235),B=n(85893);function E(e){window.__c={n:"AppTemplateRelatedDependenciesDelete"};const{relatedDependencies:t}=e,n=(0,A.Fg)(),i=(0,P.VK)((()=>{const e=null==t?void 0:t.viewDeps;return e?e.map((e=>({name:e.getName(),icon:e.getFormat().collection_view_icon,type:e.getType()}))):[]}),[t.viewDeps]),r=o.useCallback((e=>(0,B.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,B.jsx)(R.F,{color:"light",viewIcon:e.icon,viewType:e.type,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},size:13}),e.name]},e.name)),[]),a=[{key:"entity_type",header:void 0},{key:"entities",header:void 0}];return(0,B.jsx)(D.Z,{columns:a,rows:(()=>{const e=[],o=null==t?void 0:t.propertyDeps;if(o.length>0){const t=o.map((e=>(0,B.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,B.jsx)(s.ZP,{icon:e.icon,type:e.type,size:13,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},theme:n}),e.name]},e.name))),i=(0,B.jsx)(_.FormattedMessage,{id:"appTemplates.featureBundleDelete.properties",defaultMessage:"{count, plural, one {1 property} other {{count} properties}}",values:{count:t.length}});e.push({key:"bundledProperties",columns:[[i],t]})}if(i.length>0){const t=i.map((e=>r(e))),n=(0,B.jsx)(_.FormattedMessage,{id:"appTemplates.featureBundleDelete.views",defaultMessage:"{count, plural, one {1 view} other {{count} views}}",values:{count:t.length}});e.push({key:"bundledViews",columns:[[n],t]})}return e})(),hideHeader:!0,cellStyle:{width:"40%"}})}var F=n(76798),Z=n(27383),V=n(33929),j=n(77907),U=n(95802),L=n(80444),O=n(26136),N=n(40663);const z=(0,_.defineMessages)({multiDBNameConnector:{id:"appTemplateHelpers.multiDBNameConnector",defaultMessage:"and"}});function W(e,t){const{spaceViewStore:n}=t,o=n.getSpaceId();if(!o)return;const i=y.bf({url:m._j.workspaceSetup,query:{spaceId:p.cj(o)}});L.default.setState({...L.default.state,mainEditorCurrentBlockStore:void 0}),C.c4({environment:e,url:i})}function q(e){const{environment:t,collectionViewBlockStore:n,collectionStore:o,databaseType:r,propertyMapping:a,typedPropertySchemas:s,transaction:l}=e;if(o.isTypedCollection())throw new Error("Collection is already typed");const c=i.LI[r].blockUri,d=r,u={};Object.entries(a).forEach((e=>{let[n,r]=e;if(!r||r===i.bK)return;const a=s[n],c=o.getSchema()[r];if(!c)throw new Error("Mapped property does not exist");a&&a.type!==c.type&&(k.LC({environment:t,collectionStore:o,property:r,type:a.type,transaction:l}),u[r]=c.type)}));const m=Object.entries(a).filter((e=>{let[t,n]=e;return n===i.bK})).map((e=>{let[t,n]=e;return t})),f={};m.forEach((e=>{const t=s[e];t&&(f[e]=t)})),Object.entries(f).forEach((e=>{let[n,i]=e;const r=k.G3({environment:t,collectionStore:o,collectionViewArgs:void 0,propertyName:i.name,propertyType:i.type,transaction:l});a[n]=r})),x.FH({stores:[n],update:{app_id:(0,p.ZP)(),app_config_uri:c,app_uri_map:{[c]:n.id,[d]:o.id}},transaction:l}),x.FH({stores:[o],update:{app_config_uri:d,app_uri_map:a,mapped_property_types:u},transaction:l})}function H(e){var t;const{environment:n,collectionContextStore:o,transaction:i}=e,r=o.collectionStore(),a=o.collectionViewBlockStore();if(!r||!a)return;const s=(null===(t=r.getFormat())||void 0===t?void 0:t.mapped_property_types)??{};Object.entries(s).forEach((e=>{let[t,o]=e;k.LC({environment:n,collectionStore:r,property:t,type:o,transaction:i})})),x.FH({stores:[a],update:{app_id:void 0,app_config_uri:void 0,app_uri_map:void 0},transaction:i}),x.FH({stores:[r],update:{app_config_uri:void 0,app_uri_map:void 0,mapped_property_types:void 0},transaction:i}),S.g2({environment:n,database_type:void 0,collectionContextStore:o})}async function K(e){const{environment:t,blockStore:n}=e,o=n.getFormat().app_id;if(!o)return[n];const i=await w.getCollectionViewBlocksByAppId(t,{spaceId:n.getSpaceId(),appId:o}),r=n.getParentStore();return"success"!==i.type||void 0===r?[n]:i.data.result.map((e=>O.G.createChildStore(r,{table:f.iU,id:e.blockId,spaceId:n.getSpaceId()})))}async function G(e){const{environment:t,collectionViewBlockStore:n,databaseUri:o}=e,i=await K({environment:t,blockStore:n});for(const a of i){var r;if(a.isCollectionView()&&(null===(r=a.getCollectionStore())||void 0===r?void 0:r.getFormat().app_config_uri)===o)return a}}async function $(e){const{environment:t,block:n,action:o}=e,s=n.getFormat().app_config_uri||"";if(s===i.NB&&(Z.y.locallyMutatedTasksDatabase=!0),N.rC.includes(s)){const e=await async function(e){const{environment:t,blockStore:n}=e,o=n.getParentStore();if(!o)return[n];const i=await K({environment:t,blockStore:n}),r=o.id;return i.filter((e=>{var t;return(null===(t=e.getParentStore())||void 0===t?void 0:t.id)===r}))}({environment:t,blockStore:n});if(e.length<=1)return[n];const i=function(e,t,n){if("delete"===e)return{message:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.message",defaultMessage:"Are you sure you want to delete {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.description",defaultMessage:"{appName} work closely together. You can delete them together, or you might encounter issues after deletion.",values:{appName:n}}),allLabel:(0,B.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.allLabel",defaultMessage:"Delete {appName}",values:{appName:n}})}),cancelLabel:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,B.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.oneLabel",defaultMessage:"Delete {dbName} only",values:{dbName:t.getTitleValue()}})}),actionIcon:d.y};if("move"===e)return{message:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.message",defaultMessage:"Are you sure you want to move {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.description",defaultMessage:"{appName} work closely together. You can move them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.allLabel",defaultMessage:"Move together"}),cancelLabel:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.oneLabel",defaultMessage:"Only move {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:l.n};if("duplicate"===e)return{message:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.message",defaultMessage:"Are you sure you want to duplicate {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.description",defaultMessage:"{appName} work closely together. You can duplicate them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.allLabel",defaultMessage:"Duplicate together"}),cancelLabel:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.oneLabel",defaultMessage:"Only duplicate {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:c.a};throw(0,v.t1)(e)}(o,n,function(e){if(1===e.length)return e[0].getTitleValue().toString();let t="";for(let n=0;n<e.length-1;n++)t+=e[n].getTitleValue(),e.length>2?t+=", ":t+=" ";return t+=`${V.default.formatMessage(z.multiDBNameConnector)} ${e[e.length-1].getTitleValue()}`,t}(e)),s=await function(e,t){const{message:n,description:o,allLabel:i,cancelLabel:s,oneLabel:l,actionIcon:c}=e;return new Promise((e=>{I.showDialog({showCancel:!1,keepFocus:!1,message:(0,B.jsxs)("div",{style:{textAlign:"center"},children:[(0,B.jsxs)("span",{style:{display:"inline-block",verticalAlign:"-0.15em",position:"relative"},children:[(0,B.jsx)("img",{src:r.Z.images.appPackages.projectsIconSvg,style:{width:"1.4em",height:"1.4em"}}),c({width:"0.9em",height:"0.9em",position:"absolute",fill:a.O9.red,right:"-0.3em",bottom:"0.05em"})]}),(0,B.jsx)("div",{style:{fontWeight:b.Z.fontWeight.semibold,margin:"0.7em"},children:n}),(0,B.jsx)("div",{style:{fontSize:14},children:o})]}),items:"delete"===t?[{label:l,color:"red",onAccept:()=>{e("one")}},{label:i,onAccept:()=>{e("all")}},{label:s,onAccept:()=>{e("cancel")}}]:[{label:i,color:"blue",onAccept:()=>{e("all")}},{label:l,onAccept:()=>{e("one")}},{label:s,onAccept:()=>{e("cancel")}}],handleCancel:()=>{e("cancel")}})}))}(i,o);if("cancel"===s)return"user_canceled";const u=[n];if("all"===s)for(const t of e)if(t.id!==n.id){const e=U.C.findSelectablesFromIds([t.id]);e.length>0?u.push(e[0].props.store):u.push(t)}return u}return[n]}async function Q(e){var t;let{environment:n,property:o,collectionContextStore:i,theme:r,from:a}=e;const{appTemplatesSetupActions:l,appConfigs:c}=await j.deps.AppTemplates.loader(),d=i.collectionStore(),p=i.collectionViewBlockStore(),m=null==p?void 0:p.getCollectionViewStores();if(!(d&&p&&m&&p.getFormat().app_config_uri))return!1;const v=d.getSchema()[o],y=d.getFormat().app_config_uri;if(!v||!y)return!1;const S=(0,N.YB)(c(),y);if(!S)return!1;const k=u.oA([...Object.keys(d.getPropertyMapping()||{}),...Object.keys((null===(t=p.getFormat())||void 0===t?void 0:t.app_uri_map)||{})]),x=(0,N.TD)(k,S),C=u.oA([x.find((e=>e.uri===o))]),T=(0,N.K8)({validDependencies:C,dependencies:x,collectionStore:d,collectionViewBlockStore:p,viewStores:m}),{validDependencies:M}=T;if(0===M.length)return!1;const P=null==p?void 0:p.getParentStore();if(!d||!p||!P||P.table!==g.bx&&P.table!==f.iU&&P.table!==h.e0)return!1;const A=p.getFormat().app_id,R=A?await w.getCollectionViewBlocksByAppId(n,{spaceId:p.getSpaceId(),appId:A}):void 0,D="success"===(null==R?void 0:R.type)?R.data.result.map((e=>O.G.createChildStore(P,{table:f.iU,id:e.blockId,spaceId:p.getSpaceId()}))):[p],Z=[{label:(0,B.jsx)(_.FormattedMessage,{id:"appTemplatesHelpers.bundledPropertyDelete.deleteMessage",defaultMessage:"{count, plural, one {Delete} other {Delete all}}",values:{count:M.length}}),color:"red",onAccept:()=>l.removeDependencies({environment:n,dependencies:M,appCollectionViewBlockStores:D,from:a})}],V=M.length>1&&(0,B.jsx)(E,{relatedDependencies:T,collectionContextStore:i});return I.showDialog({message:(0,B.jsxs)("div",{style:{textAlign:"center"},children:[(0,B.jsx)("span",{style:{fontWeight:b.Z.fontWeight.medium},children:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.message",defaultMessage:"Delete {property} property for everyone on {databaseName}?",values:{databaseName:(0,B.jsx)(F.Z,{style:{display:"inline",fontWeight:b.Z.fontWeight.medium},shouldWrap:!0,store:d}),property:(0,B.jsxs)("span",{children:[(0,B.jsx)(s.ZP,{icon:v.icon,type:v.type,size:18,style:{verticalAlign:"middle",display:"inline-block",marginRight:3,marginBottom:2},theme:r}),v.name]})}})}),M.length>1&&(0,B.jsx)("div",{style:{margin:"0.17em"},children:(0,B.jsx)("span",{style:{fontSize:13,fontWeight:b.Z.fontWeight.light},children:(0,B.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.description",defaultMessage:"These related entities will also be deleted since they work together."})})})]}),description:V,showCancel:!0,keepFocus:!0,innerStyle:{width:480},items:Z}),!0}function Y(e){const{environment:t,requiredCurrPhase:n,nextPhase:o,currentUserSettingsStore:i,currentSpaceStore:r}=e,a=(0,N.jH)(i,r);n&&n!==a||T.createAndCommit({userAction:"ProjManagementIntroModal.updateProjManagementTooltipTourPhase",environment:t,perform:e=>{var t;M.d2({userSettingsStore:i,transaction:e,data:{proj_management_tooltip_tour_v1_phase_per_space:{...(null===(t=i.getSettings())||void 0===t?void 0:t.proj_management_tooltip_tour_v1_phase_per_space)??{},[r.id]:o}}})},userId:i.id})}},40663:(e,t,n)=>{n.d(t,{$4:()=>ee,$Q:()=>N,$j:()=>oe,AG:()=>F,Au:()=>E,EE:()=>L,FQ:()=>G,FW:()=>x,Hw:()=>U,K8:()=>Y,KC:()=>I,Mi:()=>A,RN:()=>q,Ru:()=>J,TD:()=>Z,Th:()=>te,VL:()=>y,Wo:()=>_,YB:()=>k,YC:()=>ie,Z0:()=>X,Zu:()=>R,_3:()=>P,cR:()=>j,ck:()=>M,fm:()=>B,h7:()=>V,hZ:()=>$,iX:()=>S,jH:()=>ne,kY:()=>w,oX:()=>C,rC:()=>Q,xB:()=>O});n(57658),n(21703);var o=n(92996),i=n(46283),r=n(76205),a=n(35011),s=n(10070),l=n(53877),c=n(77657),d=n(42875),u=n(72126),p=n(96367),m=n(9844),f=n(97880),g=n(26991),h=n(80444),v=n(77080),b=n(30874);const y=16803324e5;function _(e,t){return e.find((e=>e.uri===t))}function S(e,t){return e.find((e=>e.presets.some((e=>e.uri===t))))}function w(e,t){return e.flatMap((e=>e.presets)).find((e=>e.uri===t))}function k(e,t){if(!t)return;return e.find((e=>e.allFeatures.find((e=>{if(C(e))for(const n of e.dependencies)if("collection"===n.type&&n.uri===t)return!0}))))}function I(e,t){const n=S(e,t.uri);if(!n)return[];return[...t.requiredFeatures,...t.defaultOnFeatures].filter((e=>{const t=n.allFeatures.find((t=>t.uri===e.featureUri));if(!t)return!1;const{type:o}=e;return"simple"===o?"dependencies"in t:"with_variant"===o?"variants"in t:void(0,f.t1)(o)}))}function x(e){return"variants"in e}function C(e){return"dependencies"in e}const T=[i.k.Owner];function M(e,t){const n=k(e,t);if(n)for(const o of n.allFeatures)if(C(o)){const e=o.dependencies.find((e=>"collection"===e.type&&e.uri===t));if(e)return e.value.schema??{}}}function P(e){let{featurePointers:t,appConfig:n}=e;const o=u.oA(t.map((e=>{const{type:t}=e;return"simple"===t?e.featureUri:"with_variant"===t?e.defaultVariantUri:void(0,f.t1)(t)}))),i={};for(const s of n.allFeatures)i[s.uri]=s;const r=o.map((e=>i[e])),a={};for(const s of r)for(const e of s.dependencies)a[e.uri]=e;return Object.values(a)}function A(e){return e.endsWith(o.WN)}function R(e,t){return e.presets.find((e=>e.uri===`${t}${o.WN}`))}const D={[o.Es.Status]:["status","checkbox","select"]};function B(e,t,n){const o=t.type,i=e in D?D[e]:[o];return Object.entries(n).filter((e=>{let[t,n]=e;if(n)return i.includes(n.type)}))}function E(e,t){const n={};for(const[o,i]of Object.entries(e)){if(!o.startsWith("notion://"))continue;if(null==i?void 0:i.type){const e=B(o,i,t);1===e.length&&(n[o]=e[0][0])}}return n}function F(e,t,n){const i=e.allFeatures.filter((e=>(e=>{var i,a,l,c,d,u,p,m;if(!C(e)||1!==e.dependencies.length||"collection_view"!==e.dependencies[0].type)return!1;const h=e.dependencies[0],v=n.getFormat().app_config_uri,b=t.getFormat().app_config_uri,y=(null===(i=n.getFormat())||void 0===i?void 0:i.app_uri_map)??{};if(!v||!b)return!1;if(h.blockUri!==v||h.collectionUri!==b)return!1;if(h.uri in y)return!1;const _=s.aQ.deriveTypeUris((null==t?void 0:t.getSchema())??{},null==t?void 0:t.getPropertyMapping()),S=h.value;switch(S.type){case"table":case"list":case"gallery":case"timeline":if(null!==(a=S.format)&&void 0!==a&&a.collection_group_by){const e=S.format.collection_group_by.property;if(!(0,o.jP)(e)||!_.has(e))return!1}if(null!==(l=S.query2)&&void 0!==l&&l.timeline_by){const e=S.query2.timeline_by;if(!(0,o.jP)(e)||!_.has(e))return!1}break;case"board":if(null!==(c=S.format)&&void 0!==c&&c.board_columns_by){const e=S.format.board_columns_by.property;if(!(0,o.jP)(e)||!_.has(e))return!1}if(null!==(d=S.format)&&void 0!==d&&d.collection_group_by){const e=S.format.collection_group_by.property;if(!(0,o.jP)(e)||!_.has(e))return!1}break;case"calendar":if(null!==(u=S.query2)&&void 0!==u&&u.calendar_by){const e=S.query2.calendar_by;if(!(0,o.jP)(e)||!_.has(e))return!1}break;case"page":return!1;default:(0,f.t1)(S.type)}const w=e=>!!(0,r.Oo)(e)||(0,o.jP)(e.property)&&_.has(e.property);if(null!==(p=S.format)&&void 0!==p&&p.property_filters)for(const n of S.format.property_filters){if(!z(n.filter,w))return!1;if(!(0,g.qf)(n.filter,t))return!1}if(null!==(m=S.query2)&&void 0!==m&&m.filter){const e=S.query2.filter;if(e.filters)for(const t of e.filters)if(!W(t,w))return!1}return!0})(e)));return u.mN(i,"uri")}function Z(e,t){const n=u.xH(u.oA(t.allFeatures.map((e=>{if(C(e))return e.dependencies}))));return u.mN(n.filter((t=>e.includes(t.uri))),(e=>e.uri))}function V(e){return"app_container"===e.getFormatStore().getKeyStore("collection_view_sub_type").getValue()}function j(e,t,n,r){if(t===o.GZ&&n===i.k.Owner)return!0;const a=s.aQ.deriveTypeUri(n,r.getPropertyMapping());if(!a)return!1;const l=function(e,t){if(t===o.GZ)return T;const n=M(e,t);return n?Object.keys(n):void 0}(e,t);return!!l&&l.includes(a)}function U(e,t,n){return(0,p.un)(e,t,n)}function L(e){return e===o.Kk||e===o.tD||e===o._1}function O(e){return e===o.g3}function N(e,t){const n=[];for(const i of t)"property"===i.type||"database_template"===i.type?e.has(i.collectionUri)&&n.push(i):"block"===i.type?e.has(i.parentUri)&&n.push(i):"blockUri"in i&&e.has(i.blockUri)&&n.push(i);let o=[];return n.length>0&&(o=N(new Set(n.map((e=>e.uri))),t)),[...n,...o]}function z(e,t){return!!t(e)}function W(e,t){if((0,r.aN)(e)){if(!z(e,t))return!1}else{if((0,r.Mm)(e))return!0;if(e.filters)for(const n of e.filters){if(!W(n,t))return!1}}return!0}function q(e,t){const n=[];if(e.filters)for(const o of e.filters){const e=H(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{...e,filters:n}}function H(e,t){if((0,r.aN)(e))return null!=t&&t[e.property]?{...e,property:t[e.property]}:e;if((0,r.Mm)(e))return e;if((0,r.vA)(e)){if(e.filters){const n=[];for(const o of e.filters){const e=H(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{operator:e.operator,filters:n}}}else(0,f.t1)(e)}function K(e,t,n){const o=t.getQuery(n.getSchema()),i=t.getFormat(),a=null==o?void 0:o.sort;if(a){if(a.some((t=>e.uri===t.property)))return!0}const s=t.getFormat().property_filters;if(s){const t=t=>!(0,r.Oo)(t)&&t.property===e.uri;if(s.some((e=>z(e.filter,t))))return!0}const l=null==o?void 0:o.filter;if(void 0!==l&&l.filters){const t=t=>!!(0,r.Oo)(t)||t.property!==e.uri;for(const e of l.filters){if(!W(e,t))return!0}}switch(t.getType()){case"table":case"list":case"gallery":case"timeline":if(i.collection_group_by){if(i.collection_group_by.property===e.uri)return!0}if(null!=o&&o.timeline_by){if(o.timeline_by===e.uri)return!0}break;case"board":if(i.board_columns_by){if(i.board_columns_by.property===e.uri)return!0}if(i.collection_group_by){if(i.collection_group_by.property===e.uri)return!0}break;case"calendar":if(null!=o&&o.calendar_by){if(o.calendar_by===e.uri)return!0}}return!1}function G(e,t){const n=(0,d.r)(),o=(0,l.em)(e,1,n);return(0,l.fZ)(o.valueOf(),o.plus({weeks:t}).minus({days:1}).valueOf(),n)}function $(e,t){const n=(0,l.DF)(e,(0,d.r)()).plus({days:t});return(0,l.ME)(n)}const Q=[o.NB,o.Aw,o.J1];function Y(e){var t;const{dependencies:n,collectionStore:o,collectionViewBlockStore:i,viewStores:r,validDependencies:l}=e,c=n.filter((e=>"property"===e.type)),d=[...c.filter((e=>"rollup"===e.propertySchema.type)),...c.filter((e=>"formula"===e.propertySchema.type))],u=n.filter((e=>"collection_view"===e.type)),p=s.aQ.deriveTypeUris(o.getSchema(),o.getPropertyMapping()),m=null===(t=i.getFormat())||void 0===t?void 0:t.app_uri_map,f={validDependencies:l,propertyDeps:[],viewDeps:[]};if(!p||!m)return f;for(const s of d){if(!p.has(s.uri))continue;const e=o.getSchema()[s.uri];if(e){if("rollup"===e.type){l.some((t=>t.uri===e.relation_property))&&(l.push(s),f.propertyDeps.push(e))}if("formula"===e.type){(0,a.pV)(e).some((e=>{for(const t of l)if(t.uri===e)return!0}))&&(l.push(s),f.propertyDeps.push(e))}}}for(const a of u){if(!m[a.uri])continue;const e=r.find((e=>e.id===m[a.uri]));if(!e)continue;l.some((t=>"property"===t.type&&K(t,e,o)))&&(l.push(a),f.viewDeps.push(e))}return f.validDependencies=l,f}function J(){return v.default.checkGate("proj_management_sprints_upgrade")}function X(){const{currentSpaceStore:e}=h.default.state;return!Boolean(e&&!e.canEdit())&&v.default.checkGate("proj_management_tooltip_tour")}function ee(){return v.default.checkGate("proj_management_tooltip_tour")}function te(){return b.Z.getIntegrationsAsRecordMap().getModel({table:m.K2,id:c.Dv})&&v.default.checkGate("cron_connected_relation")}function ne(e,t){var n;if(t&&e)return null===(n=e.getSettings())||void 0===n||null===(n=n.proj_management_tooltip_tour_v1_phase_per_space)||void 0===n?void 0:n[t.id]}function oe(e,t){return{create_a_task:"assign_to_someone",assign_to_someone:"change_task_status",change_task_status:t?"select_a_project":"click_view_settings",select_a_project:"complete",click_view_settings:"complete"}[e]}function ie(e,t){const n=w(e,t);if(!n)throw new Error(`Preset not found for URI: ${t}`);const{name:o,icon:i}=n;return{name:o,icon:i}}},51592:(e,t,n)=>{n.d(t,{A7:()=>S,Mn:()=>h,Q_:()=>b,sN:()=>v,tV:()=>_,x1:()=>y});n(67294);var o=n(92996),i=n(54855),r=n(86793),a=n(59960),s=n(97880),l=n(9291),c=n(33929),d=n(98165),u=n(67669),p=n(80444),m=n(26136),f=n(85893);i.a,a.w,r.D;const g=(0,l.defineMessages)({page:{defaultMessage:"Page",id:"dbTypesHelpers.singlePage.displayName"},tasks:{defaultMessage:"Task",id:"dbTypesHelpers.singleTask.displayName"},projects:{defaultMessage:"Project",id:"dbTypesHelpers.singleProject.displayName"}});g.page,g.tasks,g.projects;function h(e){return c.default.formatMessage((0,o.J2)(e))}function v(e,t){return c.default.formatMessage((0,o.tq)(e,t))}function b(e,t){return c.default.formatMessage((0,o.Xj)(e,t))}function y(e){var t;let{typedCollections:n,spaceStore:o,environment:i}=e;const r={},a={},l={},c={},f={},g=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id;for(const p of n){if(g){if("none"===(0,u.Dt)({userId:g,store:p}).role){a[p.id]=p;continue}}const e=(0,d.u3)(p);if(!e)continue;const t=_({environment:i,spaceStore:o,collectionStore:p});switch(t){case"team":c[e.id]=[...c[e.id]||[],p],e instanceof m.zX&&(f[e.id]=e);break;case"private":r[p.id]=p;break;case"shared":l[p.id]=p;break;default:(0,s.t1)(t)}}return{privateDatabases:r,restrictedDatabases:a,sharedDatabases:l,teamDatabases:c,teamStores:f}}function _(e){let{environment:t,spaceStore:n,collectionStore:o}=e;const i=(0,d.u3)(o);return i&&i.canRead()?i instanceof m.zX?"team":i.isTopLevelPrivatePage({spaceStore:n,environment:t})?"private":"shared":"shared"}function S(e,t){return(0,f.jsx)(l.FormattedMessage,{...t,defaultMessage:"This property is required for {databaseType}.",id:"database.requiredPropertyExplanation",description:"Educate the users on why this property cannot be deleted.",values:{databaseType:h(e)}})}},23924:(e,t,n)=>{n.d(t,{gD:()=>u,mL:()=>l,qJ:()=>d});n(57658);var o=n(10070),i=n(21202),r=n(44499),a=n(98165),s=n(51592);function l(e){let{environment:t,typedDatabases:n,spaceStore:o,joinedTeamIds:i,blocksToFilterParents:r}=e;return d({typedDatabases:function(e){let{environment:t,typedDatabases:n,spaceStore:o,joinedTeamIds:i}=e;const{sharedDatabases:r,privateDatabases:a,restrictedDatabases:l,teamDatabases:d}=(0,s.x1)({environment:t,typedCollections:n,spaceStore:o}),u=Object.values(l),p=Object.values(a),m=Object.values(r);return[...c({teamDatabases:d,joinedTeamIds:i}),...m,...p,...u]}({environment:t,spaceStore:o,typedDatabases:n.filter((e=>{const t=(0,a.VP)(e);return!t||!t.isArchived()})),joinedTeamIds:i}),blocksToFilterParents:r})}function c(e){let{teamDatabases:t,joinedTeamIds:n}=e;const o=[];for(const[a,s]of Object.entries(t))for(const e of s)o.push([a,e]);if(0===o.length)return[];const i=Object.keys(t).filter((e=>!n.includes(e))),r=[...n,...i];return o.sort(((e,t)=>{let[n,o]=e,[i,a]=t;return r.indexOf(n)-r.indexOf(i)||String(o.getName()).localeCompare(String(a.getName()))})).map((e=>{let[t,n]=e;return n}))}function d(e){let{typedDatabases:t,blocksToFilterParents:n}=e;const o=n?new Set((0,r.qB)(n)):void 0;return t.filter((e=>{if(!e.canEdit())return!1;if(!o)return!0;const t=e.getParentPointer();return!t||t.table!==i.iU||!o.has(t.id)}))}function u(e){const t=e.getPropertyMapping(),n=e.getSchema();return o.aQ.toViewSchema(n,t)}},28344:(e,t,n)=>{n.r(t),n.d(t,{trackQnACopyClick:()=>g,trackQnAOpened:()=>r,trackQnaBackToSearch:()=>p,trackQnaCitationsSeeMoreClick:()=>f,trackQnaCitationsToggle:()=>m,trackQnaClear:()=>u,trackQnaClosed:()=>a,trackQnaFeedbackGiven:()=>c,trackQnaInferenceEnd:()=>l,trackQnaInferenceStart:()=>s,trackQnaIntroModalClose:()=>h,trackQnaIntroModalContinue:()=>S,trackQnaIntroModalImportClick:()=>_,trackQnaIntroModalOpen:()=>v,trackQnaIntroModalShowImportRecommendation:()=>b,trackQnaIntroModalSkipImportClick:()=>y,trackQnaReminderShown:()=>C,trackQnaResultClicked:()=>d,trackQnaWaitlistModalClose:()=>w,trackQnaWaitlistModalOpen:()=>k,trackQnaWaitlistModalRequestAccess:()=>I,trackQnaWaitlistModalSkip:()=>x});var o=n(49902),i=n(77472);function r(e,t){const{configurationState:n,runtimeState:r,hasQuery:a,searchSessionId:s,from:l}=t;i.j(e,"qna_open",{qna_session_id:n.sessionId,has_query:a,search_session_id:s,from:l}),o.j({name:"qna_open",args:{qna_session_id:n.sessionId,from:l,duration:Date.now()-n.startTimestamp,questions_asked_in_session:(null==r?void 0:r.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}})}function a(e,t){const{configurationState:n,runtimeState:r,from:a}=t;i.j(e,"qna_close",{qna_session_id:n.sessionId,qna_session_length:Date.now()-n.startTimestamp,from:a}),o.j({name:"qna_close",args:{qna_session_id:n.sessionId,from:a,duration:Date.now()-n.startTimestamp,questions_asked_in_session:(null==r?void 0:r.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}})}function s(e,t,n,o,r){t&&i.j(e,"qna_inference_start",{qna_session_id:t.sessionId,qna_inference_id:n,is_retry:o,is_suggested_question:"suggested_question"===r})}function l(e,t){const{configurationState:n,inferenceId:o,timeTook:r,numCitationsShown:a,numSearchResults:s}=t;n&&i.j(e,"qna_inference_end",{qna_session_id:n.sessionId,qna_inference_id:o,time_took:r,num_citations_shown:a,num_search_results:s})}function c(e,t,n,o){t&&i.j(e,"qna_feedback_given",{qna_session_id:t.sessionId,qna_inference_id:n,feedback:o})}function d(e,t){const{configurationState:n,clickedPageId:o,source:r}=t;n&&i.j(e,"qna_result_clicked",{qna_session_id:n.sessionId,clicked_page_id:o,source:r})}function u(e,t,n){t&&(i.j(e,"qna_clear",{qna_session_id:t.sessionId}),o.j({name:"qna_clear",args:{qna_session_id:t.sessionId,duration:Date.now()-t.startTimestamp,questions_asked_in_session:(null==n?void 0:n.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}}))}function p(e,t){i.j(e,"qna_back_to_search",{qna_session_id:t.sessionId})}function m(e,t){i.j(e,"qna_citations_toggle",{qna_session_id:t.sessionId,shown:t.shown})}function f(e,t){i.j(e,"qna_citations_see_more_click",{qna_session_id:t.sessionId})}function g(e,t){i.j(e,"qna_copy_click",{qna_session_id:t.sessionId})}function h(e,t){i.j(e,"qna_intro_modal_close",t)}function v(e){i.j(e,"qna_intro_modal_open")}function b(e){i.j(e,"qna_intro_modal_show_import_recommendation")}function y(e){i.j(e,"qna_intro_modal_skip_import_click")}function _(e){i.j(e,"qna_intro_modal_import_click")}function S(e){i.j(e,"qna_intro_modal_continue")}function w(e){i.j(e,"qna_waitlist_modal_close")}function k(e){i.j(e,"qna_waitlist_modal_open")}function I(e,t){i.j(e,"qna_waitlist_modal_request_access",{is_space_admin:t.isSpaceAdmin,is_sales_assisted:t.isSalesAssisted})}function x(e){i.j(e,"qna_waitlist_modal_skip")}function C(e,t){i.j(e,"qna_reminder_shown",{number:t.number})}},81598:(e,t,n)=>{n.d(t,{GL:()=>a,L6:()=>i,PS:()=>l,Q:()=>c,Sv:()=>r,Zl:()=>s,eC:()=>d,yX:()=>u});var o=n(77907);const i=o.deps.assistant,r=(0,o.lazyComponent)(i,(e=>e.AssistantWriterPopupRenderer)),a=(0,o.lazyComponent)(i,(e=>e.AssistantWriterInProgressContent)),s=(0,o.lazyComponent)(i,(e=>e.AssistantLabelerBar)),l=(0,o.lazyComponent)(i,(e=>e.AssistantFullPageChat)),c=(0,o.lazyComponent)(i,(e=>e.AssistantOriginElement)),d=(0,o.lazyComponent)(i,(e=>e.AssistantMenuPopup)),u=(0,o.lazyComponent)(i,(e=>e.SearchAssistantPane))},56206:(e,t,n)=>{n.d(t,{d:()=>a});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{open:!1,currentView:"chat"}}}const a=new r;(0,i.exposeDebugValue)("AssistantMenuStore",a)},2553:(e,t,n)=>{n.d(t,{zY:()=>pe,Hj:()=>ue,AN:()=>me,oS:()=>ve,Nj:()=>be,sl:()=>ge,kM:()=>fe});n(57658),n(21703),n(67294);var o=n(1302),i=n(15145),r=n(63362),a=n(28751),s=n(81730);async function l(e){const{action:t,values:n,context:o}=e,i=(0,a.z)(t.getType());return await i.execute({...o,values:n},t)}var c=n(94412),d=n(10450),u=n(41432),p=n(84116),m=n(78106),f=n(76218),g=n(68626),h=n(42875),v=n(72126),b=n(4615),y=n(149),_=n(98963),S=n(18844),w=n(21202),k=n(23867),I=n(70203),x=n(97880),C=n(9291),T=n(50906),M=n(98834),P=n(54532),A=n(94419),R=n(13084),D=n(19785),B=n(68305),E=n(9953),F=n(52423),Z=n(8055),V=n(24677),j=n(64964),U=n(98104),L=n(82530),O=n(6854),N=n(95477),z=n(77472),W=n(49117),q=n(84210),H=n(33929),K=n(73959),G=n(77907),$=n(95802),Q=n(80444),Y=n(98180),J=n(58454),X=n(77080),ee=n(88923),te=n(26136),ne=n(35057),oe=n(92996);const ie=(0,C.defineMessages)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),re=["sprint","task","project","page"],ae={[oe.wW]:"project",[oe.iS]:"task",[oe.zU]:"page",[oe.Fi]:"page",[oe.p$]:"sprint",[oe.GZ]:"page",[oe.nG]:"page",[oe.Be]:"page"};function se(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:n,intl:o}=e,i=function(e){const{typedAutomationExecutionSummary:t,intl:n}=e,o=[];for(const r of re){const e=t[r];if(e){const{numPagesCreated:t,numPagesEdited:n}=e;t>0&&o.push({pageType:r,modificationType:"created",numPagesModified:t}),n>0&&o.push({pageType:r,modificationType:"updated",numPagesModified:n})}}const i=o.slice(0,3).map(((e,t)=>{let{pageType:o,modificationType:i,numPagesModified:r}=e;const a=le[o][i],s=0===t?a.start:a.append;return n.formatMessage(s,{numPagesModified:r})}));if(i.length>0)return n.formatList(i,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:o});return i||(n>0?o.formatMessage(ie.createdBlocks,{numBlocksDuplicated:n}):o.formatMessage(ie.genericSuccessMessage))}const le={sprint:{created:{start:ie.createdSprintsUppercase,append:ie.createdSprintsLowercase},updated:{start:ie.updatedSprintsUppercase,append:ie.updatedSprintsLowercase}},task:{created:{start:ie.createdTasksUppercase,append:ie.createdTasksLowercase},updated:{start:ie.updatedTasksUppercase,append:ie.updatedTasksLowercase}},project:{created:{start:ie.createdProjectsUppercase,append:ie.createdProjectsLowercase},updated:{start:ie.updatedProjectsUppercase,append:ie.updatedProjectsLowercase}},page:{created:{start:ie.createdPagesUppercase,append:ie.createdPagesLowercase},updated:{start:ie.updatedPagesUppercase,append:ie.updatedPagesLowercase}}};var ce=n(85893);const de=(0,C.defineMessages)({genericErrorMessage:{id:"automations.buttonTrigger.genericErrorMessage",defaultMessage:"Button failed to execute"},open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"},defaultConfirmationWorkflowText:{defaultMessage:"Are you sure you want to continue?",id:"automations.buttonTrigger.defaultConfirmationWorkflowText"},defaultContinueWorkflowMessage:{defaultMessage:"Continue",id:"automations.buttonTrigger.defaultContinueWorkflowMessage"},defaultStopWorkflowMessage:{defaultMessage:"Cancel",id:"automations.buttonTrigger.defaultStopWorkflowMessage"},errorQueryCollectionTooManyPages:{defaultMessage:"Button impacts too many pages",id:"automations.buttonTrigger.errorQueryCollectionTooManyPages"},errorUserCancelled:{defaultMessage:"Button was cancelled",id:"automations.buttonTrigger.errorUserCancelled"}});function ue(e){const{environment:t,collectionStore:n,property:o,transaction:i}=e,r=(0,b.ZP)(),a=n.getSchema()[o];a&&"button"===a.type&&(E.ae({environment:t,table:_.cv,inMemoryRecordCache:n.inMemoryRecordCache,value:{id:r,parent_id:n.id,parent_table:n.table,alive:!0,space_id:n.getSpaceId(),status:"active",trigger:{id:(0,b.ZP)(),type:"button"}},transaction:i}),E.sW({store:n.getSchemaStore(),data:{[o]:{...a,automation_id:r}},transaction:i}))}function pe(e){const{actionId:t,environment:n,intl:o,automationStore:i,actionType:r,transaction:a,insertionPoint:s,config:l,createDuplicateBlocksContainer:c=!0}=e,d=i.getSpaceId();if(!d)return;let u;"duplicate_blocks"===r&&c&&(u=E.j4({environment:n,inMemoryRecordCache:i.inMemoryRecordCache,transaction:a,type:"text",useCrdt:!1}));const p=l??function(e){const{actionType:t,intl:n}=e;if("modal_confirmation"===t)return{continue_button:{text:n.formatMessage(de.defaultContinueWorkflowMessage)},cancel_button:{text:n.formatMessage(de.defaultStopWorkflowMessage)},text:{type:"simple",value:(0,I.TPx)(n.formatMessage(de.defaultConfirmationWorkflowText))}};if("assistant"===t)return{type:"prompt"}}({actionType:r,intl:o})??{},m=E.ae({environment:n,inMemoryRecordCache:i.inMemoryRecordCache,table:S.Xj,transaction:a,value:{id:t,type:r,parent_id:i.id,parent_table:_.cv,alive:!0,space_id:d,config:p,blocks:u?[u.id]:[]}});return u&&A.R3({transaction:a,parent:m.getKeyStore("blocks"),append:u}),!s||"afterActionId"in s?A.R3({transaction:a,parent:i.getActionIdsStore(),append:m,after:null==s?void 0:s.afterActionId}):"beforeActionId"in s?A.Ce({transaction:a,parent:i.getActionIdsStore(),prepend:m,before:s.beforeActionId}):(0,x.t1)(s),m}function me(e){const{actionStore:t,automationStore:n,environment:o,insertionPoint:i,intl:r,transaction:a}=e,s=(0,b.ZP)(),l=t.getType(),c=t.getConfig();if(!l)return{onComplete:Promise.resolve([])};const d=pe({actionId:s,actionType:l,automationStore:n,config:c,environment:o,insertionPoint:i??{afterActionId:t.id},intl:r,transaction:a,createDuplicateBlocksContainer:!1});if(!d)return{onComplete:Promise.resolve([])};const u=t.getBlockStores().map((e=>{const[t,n]=P.Qi({environment:o,stores:[e],transaction:a,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,targetSpaceId:(0,k.C)(e.pointer.spaceId),baseUrl:N.default.domainBaseUrl,publicDomainName:N.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1}),i=t[0];return D.jG({transaction:a,parentStore:d,childStore:i}),n}));return{onComplete:Promise.all(u)}}function fe(e){const{clientContext:t,transaction:n,newActionIds:o}=e,{automationStore:i}=t,r=i.getValue();if(!r)return;E.sW({store:i,transaction:n,data:{action_ids:o}});he({clientContext:t,transaction:n,automationValue:{...r,action_ids:o}})}function ge(e){var t;const{clientContext:n,actionStore:o,transaction:i}=e,r=n.automationStore.getValue();if(!r)return;D.hr({parentStore:n.automationStore,childStore:o,transaction:i});he({clientContext:n,transaction:i,automationValue:{...r,action_ids:null===(t=r.action_ids)||void 0===t?void 0:t.filter((e=>e!==o.id))}})}function he(e){const{clientContext:t,automationValue:n,transaction:o}=e,i=t.automationStore.getSpaceId();if(!i)return;const r=(0,W.pt)({context:t,automationValue:n});if(!y.x.isFail(r))for(const s of n.action_ids??[]){const e=t.automationStore.getRecordStore(t.automationStore,{table:S.Xj,id:s,spaceId:i});if(!e.isDefined())continue;const n=e.getModel(),l=new Set(r.value.actionInputValueTypes[s].map((e=>{if(e.kind===p.yp.Binding||e.kind===p.yp.ContextValue)return e.id;e.kind!==p.yp.ThisRow&&(0,x.t1)(e)})).filter(x.$K)),c=(0,a.z)(n.getType()).acceptFormulaVisitor({action:n,visitor:{visitVariableOutsideOfFormula:e=>l.has(e)?{type:"keep"}:{type:"replace",value:void 0},visitFormula:e=>e.value&&(0,f.UB)(e).some((e=>!l.has(e)))?{type:"replace",value:void 0}:{type:"keep"}}});for(const t of c)L.applyOperation({store:e,operation:t,transaction:o})}}async function ve(e){const{clientContext:t,environment:n,onUndo:o,store:i}=e;let a,s;const u=await G.deps.formulas.loader();if(t.persisted){await t.automationStore.load();const e=t.automationStore.getModel();if(!e)return;a=e,s=t.automationStore.getActionStores().map((e=>e.getModel())).filter(x.$K)}else a=new c.X({triggerType:"button",actions:t.actions,parentPointer:t.parentPointer,spaceId:t.parentPointer.spaceId}),s=t.actions.map((e=>new c.e(e,t.parentPointer.spaceId)));const p=a.getTriggerType();if("event"===p)return;const f=(0,z.mc)(n),v=(0,ne.zt)();(0,r.rg)(f,{actions:s.map((e=>e.getType())),automation_id:a.id,block_id:i.id,space_id:a.getSpaceId(),subscription_tier:v,trigger:p});const b=new ye({automationModel:a,clientContext:t,environment:n}),y=(0,m.yf)(t.parentRecordStore.getRecordModel,t.parentRecordStore.loadRecordModel);if(!n.currentUser.id)return;let _;"button_property"===t.type?_=(0,d.dG)({blockPointer:i.getSpaceShardedPointer(),currentUserId:n.currentUser.id,userTimeZone:(0,h.r)()}):"button_block"===t.type?_=(0,d.io)({currentUserId:n.currentUser.id,userTimeZone:(0,h.r)(),pagePointer:t.pageStore.pointer}):"structured_automation"===t.type?_=(0,d.rj)():"event"===t.type?_=(0,d.R4)({blockPointer:i.getSpaceShardedPointer(),currentUserId:n.currentUser.id,userTimeZone:(0,h.r)()}):"recurrence"===t.type?"completeSprint"===t.recurrence.type?_=(0,d.NG)({completeSprintActionType:t.recurrence.completeSprintActionType,nextSprintDateRange:t.recurrence.nextSprintDateRange}):"default"===t.recurrence.type?_=(0,d.W7)():(0,x.t1)(t.recurrence):(0,x.t1)(t);const S={automationModel:a,actionModels:s,values:_.values,executeEffectMap:b,executeContextualFormula:async(e,n)=>{if(!n)return{value:{type:"undefined"}};return await u.executeFormulaAsync(n,{values:e.values,handleDataRequest:y,userTimeZone:(0,h.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map})},handleDataRequest:y,loadRecordModel:t.parentRecordStore.loadRecordModel,userTimeZone:(0,h.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map},k=performance.now(),I=await async function(e){const{context:t,executeAutomationActionFn:n}=e,{actionModels:o}=t;let i=t.values;const r=n??l;for(const a of o){const e=await r({action:a,values:i,context:t});if(e.error)return e.error;i=i.concat(e.value.values)}}({context:S}),C=Math.trunc(performance.now()-k);if(await b.cleanupAssistantSession(),I){0,g.log({level:"error",from:"automationActions",type:"AutomationExecutionError",error:{miscDataString:JSON.stringify({error:I,automationId:a.id})}}),(0,r.By)(f,{automation_id:a.id,block_id:i.id,error_type:I.type,execution_duration_ms:C,subscription_tier:v,trigger:p});const e=function(e){if("user_cancelled"===e.type)return de.errorUserCancelled;if("query_collection_too_many_items"===e.type)return de.errorQueryCollectionTooManyPages;return de.genericErrorMessage}(I),t=H.default.formatMessage(e);j.oV({label:t})}else(0,r.Cz)(f,{automation_id:a.id,block_id:i.id,execution_duration_ms:C,subscription_tier:v,trigger:p}),await async function(e){const{environment:t,saveTransactionInfos:n,clientContext:o,undoCheckpointName:i,numBlocksDuplicated:r,onUndo:a}=e,s=function(e){const{saveTransactionInfos:t,parentRecordStore:n}=e,o={};for(const l of t)if("create_page"===l.type){var i,r;const e=te.NW.createChildStore(n,l.collection).getDatabaseType(),t=(e&&ae[e])??"page",a=(null===(i=o[t])||void 0===i?void 0:i.numPagesEdited)??0,s=(null===(r=o[t])||void 0===r?void 0:r.numPagesCreated)??0;o[t]={numPagesCreated:s+1,numPagesEdited:a}}else if("update_pages"===l.type){var a,s;const e=te.NW.createChildStore(n,l.collection).getDatabaseType(),t=(e&&ae[e])??"page",i=(null===(a=o[t])||void 0===a?void 0:a.numPagesEdited)??0,r=(null===(s=o[t])||void 0===s?void 0:s.numPagesCreated)??0;o[t]={numPagesCreated:r,numPagesEdited:i+l.pageIds.length}}else(0,x.t1)(l);return o}({saveTransactionInfos:n,parentRecordStore:o.parentRecordStore});let l;for(const f of n.slice().reverse()){if("create_page"===f.type){var c;l=te.G.createChildStore(o.parentRecordStore,{table:w.iU,id:f.pageId,spaceId:null===(c=f.collection)||void 0===c?void 0:c.spaceId});break}if("update_pages"===f.type){if(1===f.pageIds.length){var d;l=te.G.createChildStore(o.parentRecordStore,{table:w.iU,id:f.pageIds[0],spaceId:null===(d=f.collection)||void 0===d?void 0:d.spaceId})}else{const e=te.NW.createChildStore(o.parentRecordStore,f.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;l=t}break}(0,x.t1)(f)}const u=se({typedAutomationExecutionSummary:s,numBlocksDuplicated:r,intl:o.intl}),p=()=>{F.qB({environment:t,namedRevisionId:i}),j.rN(),a&&a(i)},m=F.hv(i);j.oV({label:u,right:(0,ce.jsx)(O.wr,{blockStoreToOpen:l,...m?{performUndo:p}:{}})})}({environment:n,saveTransactionInfos:b.saveTransactionInfos,clientContext:t,undoCheckpointName:b.undoCheckpointName,numBlocksDuplicated:b.getNumBlocksDuplicated(),onUndo:o})}function be(e){var t;const{environment:n,parentStore:o,transaction:i}=e,r=E.j4({environment:n,type:"text",inMemoryRecordCache:o.inMemoryRecordCache,transaction:i,spaceId:o.pointer.spaceId,useCrdt:(null===(t=(0,K.sQ)(o))||void 0===t?void 0:t.useCrdt())??!1}),a=A.R3({parent:o,append:r,transaction:i}).child;V.eP({environment:n,store:a});const s=a.getBlockTitleStore();U.N_({store:s})}class ye{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new s.Do({actionId:e.actionId,pointer:e.pointer})}},this.queryCollection=async e=>{const t=await B.tA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return y.x.isFail(t)?{error:new s.Pn({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{const t=X.default.getConfigKey("automation_update_pages","max_operations_per_transaction"),n=X.default.checkGate("update_pages_action_batching")&&void 0!==t&&"structured_automation"===this.clientContext.type&&this.clientContext.shouldBatch?v.yo(e.operations,t):[e.operations];for(const o of n)this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:e=>{for(const t of o){const n=(0,te.Kv)(this.clientContext.parentRecordStore,t.pointer);L.applyOperation({store:n,operation:t,transaction:e})}}});if(this.saveTransactionInfos.push(e.info),"create_page"===e.info.type)T.W2j(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:e.info.pageId,creating_block_id:e.info.pageId});else if("update_pages"===e.info.type){const{editedProperties:t,pageIds:n}=e.info;for(const e of n)for(const{id:n,type:o}of t)T.rvl(this.environment,{block_id:e,property:n,property_type:o,from:"button_automation",automation_id:this.automationModel.id},!1)}else(0,x.t1)(e.info);return{value:{}}},this.navigateToPage=e=>{const t=Q.default.state.mainEditorCurrentBlockStore;if(!t)return;const n=te.G.createChildStore(t,e.page),o="full_page"===e.openIn?(0,q.ZP)({store:n,fullyQualified:!1,pageVisitSource:i.tY.ButtonAutomation}):(0,q.ZP)({store:t,peekViewBlockId:n.id,peekMode:(0,ee.getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:i.tY.ButtonAutomation});Z.c4({environment:this.environment,url:o})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new s.iR({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,n=t.getRecordStoreUIParent();if(!n)return{value:{}};let i;"before"===e.insertionPoint?i=!0:"after"===e.insertionPoint?i=!1:(0,x.t1)(e.insertionPoint);const r=te.G.createChildStore(n,e.blockPointer);await r.load();const a=r.getContentStores();i||a.reverse();const l=$.C.findSelectableFromStore(t),c=[],d=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>a.map((n=>{const[o,r]=P.Qi({environment:this.environment,stores:[n],transaction:e,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0,targetSpaceId:(0,k.C)(n.pointer.spaceId),baseUrl:N.default.domainBaseUrl,publicDomainName:N.default.publicDomainName,preferDuplicateLocation:"local",analyticsFrom:"button_automation",useCrdt:t.useCrdt()}),a=o[0];return l&&(i?l.props.onInsertAbove&&c.push(l.props.onInsertAbove({insertStores:[a],transaction:e})[0]):l.props.onInsertBelow&&c.push(l.props.onInsertBelow({insertStores:[a],transaction:e})[0])),{copy:a,onComplete:r}}))}).performResult;return i||c.reverse(),V.Z5({environment:this.environment,stores:c}),await Promise.all(d.map((e=>e.onComplete))),o.default.afterNextFlush((()=>{for(const e of c){if(R.dM({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=c.length,{value:{}}},this.displayModal=async e=>{J.Z.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await J.Z.waitUntil((()=>!J.Z.state.open));const t=J.Z.state;let n;return t.open||(n=t.result),n=n??"continue",n},this.initializeTemplateInDatabase=async e=>{const t=(0,b.ZP)(),n=this.clientContext.parentRecordStore,o=te.G.createChildStore(n,{table:w.iU,id:e.templateId});await o.load();const i=te.NW.createChildStore(n,e.collection);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:r=>{const a=E.j4({environment:this.environment,transaction:r,inMemoryRecordCache:n.inMemoryRecordCache,type:u.Ti.page,id:t,useCrdt:!1});D.zw({parentStore:i,childStore:a,transaction:r}),M.ob({environment:this.environment,store:a,transaction:r,templateStore:o,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),E.sW({transaction:r,store:a.getPropertiesStore(),data:e.propertyUpdates})}}),this.saveTransactionInfos.push({type:"create_page",pageId:t,collection:e.collection}),{value:{pageId:t}}},this.commitCode=async e=>{const t=await this.lazySetupAssistantSession(),{assistantRuntimeStore:n}=Y.Z.getSessionContextOrThrow(t),o=n.state;if(!o)return{error:new s.fH("assistant_error","Assistant runtime state not found")};const i=o.evaluator,{assistantActions:r}=await G.deps.assistant.loader(),a=(await r.simulateOrCommitStep({environment:this.environment,step:i.createAssistantStep(e.code),commit:!0,isStreaming:!1,sessionId:t})).find((e=>"error"===e.observationType));return a?{error:new s.fH("assistant_error",a.value)}:{value:{}}},this.commitPrompt=async e=>{const t=await this.lazySetupAssistantSession(),{assistantRuntimeStore:n}=Y.Z.getSessionContextOrThrow(t),{assistantActions:o}=await G.deps.assistant.loader();await o.commitHumanStep({environment:this.environment,text:(0,I.TPx)(e.prompt),sessionId:t});let i=0;do{var r;await o.commitPreviewAssistantStep({environment:this.environment,sessionId:t}),i++}while(i<3&&null!==(r=n.state)&&void 0!==r&&r.previewingStep);const a=n.state;if(!a)return{error:new s.fH("assistant_error","Assistant runtime state not found")};const l=v.Z$(a.evaluator.getTranscript());return"observation"===(null==l?void 0:l.type)&&"error"===l.observationType?{error:new s.fH("assistant_error",l.value)}:{value:{}}},this.assistantSessionId=void 0,this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${(0,b.ZP)()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){return L.createAndCommit({...e,undoCheckpoint:this.undoCheckpointName})}async cleanupAssistantSession(){if(!this.assistantSessionId)return;const e=await this.lazySetupAssistantSession(),{assistantRuntimeStore:t}=Y.Z.getSessionContextOrThrow(e),n=t.state;if(!n)throw new Error("No runtime state");const o=n.evaluator.getTranscript(),i=o[o.length-1],r="observation"===i.type&&"error"===i.observationType?i.value:void 0,{assistantActions:a}=await G.deps.assistant.loader();r||await a.applyUncommittedOperations({environment:this.environment,sessionId:e}),a.clearActiveAssistantSession({environment:this.environment,sessionId:e})}async lazySetupAssistantSession(){if(this.assistantSessionId)return this.assistantSessionId;const{assistantActions:e}=await G.deps.assistant.loader(),{sessionId:t}=await e.resetAndInitializeAssistantSession({environment:this.environment,makeActiveSession:!1});return this.assistantSessionId=t,t}}},41301:(e,t,n)=>{n.d(t,{Fp:()=>d,Mm:()=>c,So:()=>p,TU:()=>u});n(67294);var o=n(86628),i=n(24405),r=n(72126),a=n(97880),s=n(9291),l=n(85893);const c=(0,s.defineMessages)({missingTargetDatabase:{id:"clientAutomationHelpers.errorMessages.missingTargetDatabase",defaultMessage:"Missing a target database"},missingTargetPage:{id:"clientAutomationHelpers.errorMessages.missingTargetPage",defaultMessage:"Missing a target page"},invalidTemplatePage:{id:"clientAutomationHelpers.errorMessages.invalidTemplatePage",defaultMessage:"Invalid template."},noActions:{id:"clientAutomationHelpers.errorMessages.noActions",defaultMessage:"This button has no actions"},createPageButtonError:{id:"clientAutomationHelpers.errorMessages.createPageButtonError",defaultMessage:"Add page is missing a target database"},createPageButtonTemplateError:{id:"clientAutomationHelpers.errorMessages.createPageWithTemplateError",defaultMessage:"Add page has an invalid template"},openPageButtonError:{id:"clientAutomationHelpers.errorMessages.openPageButtonError",defaultMessage:"Open page is missing a target page"},updatePagesButtonError:{id:"clientAutomationHelpers.errorMessages.editPagesButtonError",defaultMessage:"Edit pages is missing a target database"},slackNotificationAuthenticationError:{id:"clientAutomationHelpers.errorMessages.slackNotificationError",defaultMessage:"Slack notification is missing an authentication."},slackNotificationTargetError:{id:"clientAutomationHelpers.errorMessages.slackNotificationTargetError",defaultMessage:"Slack notification is missing a target channel."}});function d(e){if("create_page"===e.actionType)if("missing_required_config"===e.type){if("collection"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.createPageButtonError};(0,a.t1)(e)}else{if("invalid_optional_config"===e.type)return{forAction:c.invalidTemplatePage,forButtonTooltip:c.createPageButtonTemplateError};(0,a.t1)(e)}else if("update_pages"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.updatePagesButtonError};(0,a.t1)(e)}else(0,a.t1)(e);else if("open_page"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetPage,forButtonTooltip:c.openPageButtonError};(0,a.t1)(e)}else(0,a.t1)(e);else if("slack_notification"===e.actionType)if("missing_required_config"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};if("target"===e.key)return{forAction:c.slackNotificationTargetError,forButtonTooltip:c.slackNotificationTargetError};(0,a.t1)(e)}else if("missing_required_value"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};(0,a.t1)(e)}else(0,a.t1)(e);else(0,a.t1)(e)}function u(e){const{contextStore:t,actionId:n,shouldShow:i,errorKey:a}=e;return(0,o.VK)((()=>{if(!i||!t)return;let e=t.getValidationErrorsForAction(n);a&&(e=e.filter((e=>e.key===a)));const o=(0,r.Ps)(e);if(!o)return;const c=d(o);return(0,l.jsx)(p,{content:(0,l.jsx)(s.FormattedMessage,{...c.forAction})})}),[i,t,n,a])}function p(e){window.__c={n:"TooltipWithSubtitle"};const{content:t,subtitle:n}=e,o=(0,i.yK)((e=>({wrap:{display:"flex",flexDirection:"column",alignItems:"center"},subtitle:{color:e.mediumInvertedTextColor}})),[]);return(0,l.jsxs)("div",{style:o.wrap,children:[(0,l.jsx)("div",{children:t}),n&&(0,l.jsx)("div",{style:o.subtitle,children:n})]})}},93174:(e,t,n)=>{n.d(t,{C:()=>o.LazyAutomationButtonActionList,O:()=>o.LazyPlacedButtonBlockEditor});var o=n(77907)},87686:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(24405),i=n(85893);function r(){window.__c={n:"BreadcrumbDivider"};const e=(0,o.yK)((e=>({span:{marginLeft:2,marginRight:2,color:e.lightTextColor}})),[]);return(0,i.jsx)("span",{style:e.span,children:"/"})}},25238:(e,t,n)=>{n.d(t,{Z:()=>p});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(82990),s=n(31278),l=n(76798),c=n(26136),d=n(74016),u=n(85893);function p(e){window.__c={n:"BreadcrumbIconTitle"};const{store:t,ignoreMaxLength:n,maxWidth:p,iconSize:m,emojiSize:f,titleStyle:g,iconStyle:h,highlighter:v}=e,{device:b}=(0,o.O7)(),y=m??(b.isMobile?24:20),_=f??y,{hasIcon:S,pageIcon:w,isEmptyPage:k}=(0,i.VK)((()=>({hasIcon:t.hasIcon(),pageIcon:t.getIcon(),isEmptyPage:t instanceof c.G&&t.isEmptyPage()})),[t]),I=(0,r.yK)((()=>({containerStyle:{display:"flex",alignItems:"center",minWidth:0},teamRecordTitle:{maxWidth:p,...g},pageRecordTitle:{maxWidth:n?"none":p,...g},recordIconStyle:{marginRight:6,fontWeight:a.Z.fontWeight.medium,...h}})),[n,p,g,h]);return t instanceof c.zX?(0,u.jsxs)("div",{style:I.containerStyle,children:[(0,u.jsx)(d.p,{disabled:!0,store:t,size:y,style:I.recordIconStyle}),(0,u.jsx)(l.Z,{store:t,style:I.teamRecordTitle,highlighter:v,enableHover:!0})]}):(0,u.jsxs)("div",{style:I.containerStyle,children:[S&&(0,u.jsx)(s.Z,{disabled:!0,icon:w,isEmptyPage:k,size:y,emojiSize:_,style:I.recordIconStyle,largeIcon:!0}),(0,u.jsx)(l.Z,{store:t,style:I.pageRecordTitle,highlighter:v,enableHover:!0})]},`breadcrumb-recordtitle-${t.id}`)}},7692:(e,t,n)=>{n.d(t,{Z:()=>b});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(15145),l=n(13084),c=n(82530),d=n(31945),u=n(89728),p=n(79954),m=n(84210),f=n(46837),g=n(87686),h=n(25238),v=n(85893);function b(e){window.__c={n:"BreadcrumbPageButton"};const t=(0,i.O7)(),{device:n}=t,{store:b,showDivider:y,maxWidth:_,popupRenderer:S,iconSize:w,emojiSize:k,titleStyle:I,iconStyle:x,highlighter:C,onClick:T}=e,M=(0,a.yK)((()=>({selectable:{display:"flex",alignItems:"center",minWidth:0},button:{display:"flex",minWidth:0,fontSize:"inherit",paddingTop:2,paddingBottom:2,paddingLeft:6,paddingRight:6}})),[]),{url:P,canEdit:A,isPersonalHome:R}=(0,r.VK)((()=>({url:(0,m.ZP)({store:b,fullyQualified:!1,pageVisitSource:s.tY.Breadcrumb}),canEdit:b.canEdit(),isPersonalHome:"personal_home_page"===b.getType()})),[b]),D=(0,o.useCallback)((e=>{const{droppedDirection:n,droppedStores:o,duplicate:i}=e;c.createAndCommit({userAction:"SearchPathBreadcrumb.onDrop",environment:t,perform:e=>l.LQ({environment:t,targetParentStore:b.getContentStore(),targetStore:b,droppedDirection:n,droppedStores:o,duplicate:i,transaction:e})})}),[t,b]),B=R?(0,v.jsx)(f.Z,{style:I}):(0,v.jsx)(h.Z,{store:b,maxWidth:_,iconSize:w,emojiSize:k,titleStyle:I,iconStyle:x,highlighter:C});return(0,v.jsxs)(o.Fragment,{children:[(0,v.jsx)(p.Z,{store:b,canDropOnto:A,onSelectableDrop:D,style:M.selectable,analyticsName:"breadcrumb",shouldShowDropZone:!0,children:S?(0,v.jsx)(d.ZP,{originGap:4,popupType:n.isMobile?d.Z4.SlideUp:d.Z4.Popup,render:S,renderOrigin:e=>(0,v.jsx)(u.Z,{...e,style:M.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,children:B})}):(0,v.jsx)(u.Z,{href:P,external:!1,style:M.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,onClick:T,children:B})}),y&&(0,v.jsx)(g.f,{})]},b.id)}},24946:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(31945),l=n(68785),c=n(89728),d=n(95697),u=n(77907),p=n(87686),m=n(25238),f=n(85893);function g(e){window.__c={n:"BreadcrumbTeamButton"};const{device:t}=(0,i.O7)(),{store:n,showDivider:g,popupRenderer:h,iconSize:v,iconStyle:b,highlighter:y}=e,_=(0,a.yK)((()=>({button:{fontSize:"inherit",padding:2},loadingPopupBackground:{width:280,paddingTop:8,paddingBottom:8,display:"flex",justifyContent:"center"}})),[]),{teamsEnabled:S,storeIsDefined:w}=(0,r.VK)((()=>({teamsEnabled:(0,d.bq)(),storeIsDefined:n.isDefined()})),[n]);if(!w||!S)return null;return(0,f.jsxs)(o.Fragment,{children:[(0,f.jsx)(s.ZP,{originGap:4,popupType:t.isMobile?s.Z4.SlideUp:s.Z4.Popup,render:h??(e=>(0,f.jsx)(u.LazyTeamBreadcrumbPopup,{renderLoading:e=>(0,f.jsx)("div",{style:_.loadingPopupBackground,children:e&&(0,f.jsx)(l.Z,{})}),teamStore:n,parent:e})),renderOrigin:o=>(0,f.jsx)(c.Z,{style:_.button,isSmall:!0,shouldShrink:!0,mobileFeedback:t.isMobile,...o,children:(0,f.jsx)(m.Z,{store:n,maxWidth:e.maxWidth,iconSize:v,titleStyle:e.titleStyle,iconStyle:b,highlighter:y})})}),g&&(0,f.jsx)(p.f,{})]},n.id)}},3043:(e,t,n)=>{n.d(t,{Qe:()=>r.Z,Yo:()=>i.Z,fY:()=>o.f,l2:()=>s});var o=n(87686),i=n(24946),r=n(7692),a=n(77907);const s=(0,a.lazyComponent)(a.deps.Breadcrumb,(e=>e.Breadcrumb))},17707:(e,t,n)=>{n.d(t,{AM:()=>H,DF:()=>A,DX:()=>B,Gu:()=>D,Ri:()=>W,T4:()=>V,Xi:()=>F,Y0:()=>q,YF:()=>R,Zo:()=>O,bh:()=>E,cj:()=>U,tR:()=>j});n(57658);var o=n(1302),i=n(22491),r=n(72126),a=n(4615),s=n(70279),l=n(23867),c=n(70203),d=n(63143),u=n(85344),p=n(54564),m=n(31781),f=n(94419),g=n(9953),h=n(61045),v=n(3898),b=n(82530),y=n(53471),_=n(28020),S=n(65598),w=n(77546),k=n(89224),I=n(46351),x=n(95802),C=n(24229),T=n(56681),M=n(26136),P=n(92120);function A(e){var t;const{environment:n,store:o,text:i,files:r,transaction:a,discussionLocation:s}=e,{filesToCreate:l,fileStoresToDelete:c}=function(e,t){const n=[],o=new Set;t.forEach((e=>{"local"===e.type?n.push(e.file):o.add(e.id)}));const i=S.le(e).filter((e=>e.getAlive()&&!o.has(e.id)));return{filesToCreate:n,fileStoresToDelete:i}}(o,r);O({commentStore:o,fileBlocks:c,transaction:a}),z({commentStore:o,files:l,environment:n,transaction:a});const d=S.zP(o);g.sO({store:d,value:i,transaction:a}),N(o,a),u.zd(n,{from:s,comment_id:o.id,discussion_id:o.getParentId(),parent_block_id:null===(t=o.getParentStore())||void 0===t?void 0:t.getParentId()})}function R(e){const{environment:t,commentStore:n,transaction:o}=e,i=S.GP(n);if(!i)return;const r=S.ak(i),a=r.getValue();if(!a)return;O({commentStore:n,fileBlocks:S.le(n),transaction:o}),g.sW({store:n,transaction:o,data:{alive:!1}}),b.applyOperation({store:r,operation:{pointer:r.pointer,path:r.path,command:"listRemove",args:{id:n.id}},transaction:o}),(0===a.length||1===a.length&&a[0]===n.id)&&function(e){const{discussionStore:t,transaction:n}=e,o=S.HK(t);o&&D({discussionStore:t,transaction:n,blockStore:o});const i=_.RM();if(i){const e=S.MI({blockStore:i,traverseTransclusionReferences:!0});for(const i of e){if(o&&i.table===o.table&&i.id===o.id)continue;const e=S.x8(i).getValue();null!=e&&e.includes(t.id)&&D({discussionStore:t,transaction:n,blockStore:i})}}}({discussionStore:i,transaction:o}),N(n,o),u.k$(t,{from:e.discussionLocation,discussion_id:i.id,comment_id:n.id,parent_block_id:i.getParentId()})}function D(e){const{discussionStore:t,blockStore:n,transaction:o}=e,i=S.x8(n);b.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:t.id}},transaction:o}),Z({store:n,discussionId:t.id,transaction:o})}function B(e){var t;const{environment:n,commentStore:o,discussionStore:i,transaction:r}=e;if(C.Z.state.open){var a;const e=null===(a=C.Z.state.discussionIds)||void 0===a?void 0:a.filter((e=>e!==i.id));C.Z.setState({...C.Z.state,discussionIds:e,open:((null==e?void 0:e.length)||0)>0})}g.sW({store:i,data:{resolved:!0},transaction:r}),P.Z.setState({...P.Z.state,discussionIds:(null===(t=P.Z.state)||void 0===t||null===(t=t.discussionIds)||void 0===t?void 0:t.filter((e=>e!==i.id)))||[]}),u.hJ(n,{comment_id:o.id,discussion_id:i.id,parent_block_id:i.getParentId(),from:e.discussionLocation})}function E(e){const{environment:t,commentStore:n,discussionStore:o,transaction:i}=e;g.sW({store:o,data:{resolved:!1},transaction:i}),u.SU(t,{comment_id:n.id,discussion_id:o.id,from:e.discussionLocation,parent_block_id:o.getParentId()})}function F(e){const{environment:t,discussionStore:n,textValue:o,transaction:i,files:a}=e,{id:s}=t.currentUser;if(!s)return;const l=y.dm(a);if(r.Xy(o,[])&&0===l.length)return;const c=L({discussionStore:n,text:o,files:l,environment:t,transaction:i});u.d2(t,{from:e.discussionLocation,comment_id:c.id,discussion_id:n.id,parent_block_id:n.getParentId()})}const Z=e=>{const{store:t,transaction:n,discussionId:o}=e,i=S.p9(t),r=i.getValue()||{},a=c.xcl({properties:r,discussionId:o});for(const[s,l]of Object.entries(a))g.sW({store:i,data:{[s]:l},transaction:n})};function V(e){const t=I.Z.find((t=>t.getStore().id===e&&!t.isSidebarFormat()&&!t.isMarginFormat()));if(t){const e=t.getNode();if(e&&e.parentElement){const t=Array.from(e.parentElement.children).indexOf(e);w.Wr(e,{edgeDist:0===t?0:-1,animate:!1})}}}function j(e){const{transaction:t,blockStore:n,discussionId:o}=e,i=S.x8(n);b.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listAfter",args:{id:o}},transaction:t})}function U(e){const{context:t,blockStore:n,environment:o,transaction:i,commentTextValue:r,files:s,discussionId:c=(0,a.ZP)()}=e,d=g.ae({environment:o,table:"discussion",value:{id:c,parent_id:n.id,parent_table:n.table,resolved:!1,context:t,space_id:(0,l.C)(n.pointer.spaceId)},inMemoryRecordCache:n.inMemoryRecordCache,transaction:i});j({transaction:i,blockStore:n,discussionId:d.id});return{discussionStore:d,commentStore:L({discussionStore:d,text:r,files:s,environment:o,transaction:i})}}function L(e){const{discussionStore:t,files:n,text:o,environment:i,transaction:r}=e,a=g.Ue({environment:i,table:s.x_,args:{parent:t.pointer},inMemoryRecordCache:t.inMemoryRecordCache,transaction:r}),l=S.ak(t);f.R3({parent:l,append:a,transaction:r});const c=S.zP(a);return g.sO({store:c,value:o,transaction:r}),z({commentStore:a,files:n,environment:i,transaction:r}),N(a,r),a}function O(e){const{commentStore:t,fileBlocks:n,transaction:o}=e,i=S.ig(t);n.forEach((e=>{g.sW({store:e,data:{alive:!1},transaction:o}),f.Od({parent:i,childToRemove:e,transaction:o})}))}function N(e,t){const n=S.bQ(e);g.sO({store:n,value:(0,d.ud)(Date.now()),transaction:t})}function z(e){const{environment:t,files:n,commentStore:o,transaction:i}=e,r=_.qQ(t),a=S.ig(o);m.z({files:n,environment:t,inMemoryRecordCache:o.inMemoryRecordCache,transaction:i,pageWidth:r,ignoreOversizedFiles:!0,spaceId:a.pointer.spaceId,useCrdt:!1}).forEach((e=>{f.R3({parent:a,append:e,transaction:i})}))}async function W(e){var t;let{discussionStore:n,currentBlockStore:r,environment:a,analyticsFrom:s,currentEl:l}=e;if(!r)return null;if(!n.isDefined())return;function c(e){const t=function(e){var t;let n,{discussionId:o,blockId:r}=e;const a=null===(t=document.getElementsByClassName(`${(0,i.dk)({discussionId:o})}`))||void 0===t?void 0:t[0];a&&(n=x.C.findSelectableFromChildNode(a)),n||(n=x.C.findScrollToSelectablesFromIds([r])[0]);return n}({discussionId:n.id,blockId:e});if(!t)return;const o=document.getElementsByClassName(`discussion-id-${n.id}`)[0];return o?h.bx({element:o,scrollers:{verticalScroller:t.getContextVerticalScroller(),horizontalScroller:t.getContextHorizontalScroller()},vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}):h.NQ({component:t,vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}),t.displaySelectionHalo(750),t}const d=(null===(t=n.getRecordStoreUIParent())||void 0===t?void 0:t.id)??n.getParentId();c(d)||(await v.Nz(r,[d]),await o.default.afterNextFlush(),c(d));const u=M.G.createChildStore(r,n.getParentPointer()),m=k.get(),f=null==m?void 0:m.commonAncestorContainer,g=!(null!=m&&m.collapsed)&&f&&(l===f||(null==l?void 0:l.contains(f)));p.Ib({environment:a,blockStore:u||r,analyticsFrom:s,discussionIds:[n.id],shouldFocusDiscussion:!g,recursivelyLoadAllDiscussions:!1})}function q(e){e!==T.Z.state.pageId&&T.Z.reset()}function H(e){const t={};e.forEach((e=>{t[e]=Date.now()})),T.Z.setState({...T.Z.state,lastInteractionTimes:t})}},18821:(e,t,n)=>{n.d(t,{Cd:()=>A,WD:()=>M,ZL:()=>D,i8:()=>R,uK:()=>E,yw:()=>P});n(57658);var o=n(1302),i=n(41432),r=n(4615),a=n(21202),s=n(23867),l=n(70203),c=n(9291),d=n(85344),u=n(47307),p=n(56863),m=n(24677),f=n(993),g=n(98104),h=n(82530),v=n(53471),b=n(33929),y=n(45162),_=n(89224),S=n(58202),w=n(26136),k=n(34047),I=n(82994),x=n(48514),C=n(17707);const T=(0,c.defineMessages)({discardCommentConfirmationPrompt:{id:"newDiscussionMenu.discardCommentConfirmationDialog.prompt",defaultMessage:"Do you want to discard the comment?"},discardCommentButtonLabel:{id:"newDiscussionMenu.discardCommentConfirmationDialog.discardButton.label",defaultMessage:"Discard"}});async function M(e){const{environment:t,blockStore:n,multiSelection:o,rect:i}=e;let r=i;if(!r){const e=_.get();if(!e)return;r=_.getRect(e)}if(!r)return;const a=r.width,l=r.height,c=r.right-a,u=new I.Z(t,(0,s.C)(n.pointer.spaceId));x.Z.setState({open:!0,rect:new DOMRect(c,r.top,a,l),type:"inline",blockStore:n,multiSelection:o,discussionInputStore:u}),p.w(),await B(u,t),d.$5(t)}async function P(e){const{environment:t,blockStore:n}=e,o=S.R.getRect(n);if(!o)return;const i=new I.Z(t,(0,s.C)(n.pointer.spaceId)),r=o.width,a=o.height,l=o.right-r;x.Z.setState({open:!0,rect:new DOMRect(l,o.top,r,a),type:"block",blockStore:n,discussionInputStore:i}),await B(i,t),d.yr(t)}function A(e){const t=x.Z.state;t.open&&x.Z.setState({open:!1,rect:t.rect})}function R(e){const{environment:t,blockStore:n,commentTextValue:o,transaction:r,files:a}=e,{id:s}=t.currentUser;if(!s)return;let c;const u=n.getType();if(u&&(0,i.XD)(u)&&!(0,i.S9)(u)){const e=n.getTitleValue();c=l.O1u(l.OAI(e))}const{discussionStore:p,commentStore:m}=C.cj({context:c,blockStore:n,environment:t,transaction:r,commentTextValue:o,files:v.dm(a)});return d.bR(t,{discussion_id:p.id,comment_id:m.id,parent_block_id:p.getParentId()}),p}function D(e){const t=x.Z.state;if(t.open){const n=t.discussionInputStore.state.textStore.getValue(),o=t.discussionInputStore.state.files;(n&&n.length>0||o.length>0)&&("inline"===t.type?h.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:s=>{!function(e){const{environment:t,multiSelection:n,commentTextValue:o,transaction:s,files:c}=e,{id:u}=t.currentUser;if(!u)return;const p=(0,r.ZP)(),m=(0,y.L5)(n).filter((e=>{let{store:t}=e;return t.table===a.iU}));if(0===m.length)return;const g=m[0].store.getRecordStoreAtRootPath(),h=[],b=new Set;m.forEach(((e,n)=>{let{store:o,selection:r}=e;b.add(o.id);const a=o.getRecordStoreAtRootPath();if(!(a instanceof w.G))return;const c=a.getType(),d=a.getFormat();if(c&&(0,i._T)(c,d))return;let u=o.getValue();const m=l.Ulv(u,r);f.i8({environment:t,store:o,selection:m,annotation:[l.GKr.Discussion,p],transaction:s}),u=o.getValue();const g=l.KU1(u,m.startIndex,m.endIndex),v=0===n?[]:[l.V3y("\n")];h.push(...v,...g),n>0&&C.tR({blockStore:a,discussionId:p,transaction:s})}));const _=(0,y.tp)({multiSelection:n,filterCommonAncestors:!1,focus:void 0});if(_)for(const r of _.stores){if(b.has(r.id))continue;const e=r.getType(),t=r.getFormat();e&&(0,i._T)(e,t)||C.tR({blockStore:r,discussionId:p,transaction:s})}const{discussionStore:S,commentStore:k}=C.cj({context:h,blockStore:g,environment:t,transaction:s,commentTextValue:o,files:v.dm(c),discussionId:p});d.x6(t,{discussion_id:S.id,comment_id:k.id,parent_block_id:S.getParentId()})}({environment:e,multiSelection:t.multiSelection,commentTextValue:n||[],files:o,transaction:s})},skipUpdatingEditedMetadata:!0}):"block"===t.type&&h.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:i=>{R({environment:e,blockStore:t.blockStore,commentTextValue:n||[],files:o,transaction:i})},skipUpdatingEditedMetadata:!0})),A()}}async function B(e,t){await o.default.afterNextFlush(),m.ZH(t),g.N_({store:e.state.textStore})}function E(e,t){(0,k.hu)(e)?(d.lL(t),u.showDialog({message:b.default.formatMessage(T.discardCommentConfirmationPrompt),showCancel:!0,handleCancel:()=>d.jX(t),keepFocus:!0,items:[{label:b.default.formatMessage(T.discardCommentButtonLabel),color:"red",onAccept:()=>{d.Yz(t),A()}}]})):A()}},95306:(e,t,n)=>{n.d(t,{Cd:()=>m,UZ:()=>p,oK:()=>u});var o=n(1302),i=n(29477),r=n(23867),a=n(85344),s=n(24677),l=n(98104),c=n(82994),d=n(9080);async function u(e){const{environment:t,discussionStore:n,rect:u,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}=e,h=new c.Z(t,(0,r.C)(p.pointer.spaceId));d.Z.setState({open:!0,rect:u,discussionStore:n,discussionInputStore:h,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}),s.ZH(t),await o.default.afterNextFlush(),await(0,i.Vs)(10),l.NX({store:h.state.textStore}),a.Je({environment:t,from:m,activityId:f,notificationId:g})}function p(e){const t=d.Z.state;if(t.open){const{discussionLocation:n,activityId:o,notificationId:i}=t;d.Z.setState({open:!1,rect:t.rect}),s.ZH(e),a.Rn({environment:e,from:n,activityId:o,notificationId:i})}}function m(e){const t=d.Z.state;if(t.open){0===t.discussionStore.getComments().length&&p(e)}}},25487:(e,t,n)=>{n.r(t),n.d(t,{DiscussionIndicatorFormat:()=>b,default:()=>_});n(67294);var o=n(60177),i=n(64338),r=n(480),a=n(86628),s=n(24405),l=n(95855),c=n(82990),d=n(54564),u=n(24677),p=n(68709),m=n(73063),f=n(28020),g=n(65598),h=n(24229),v=n(85893);let b=function(e){return e[e.PushContent=0]="PushContent",e[e.FloatRight=1]="FloatRight",e}({});function y(e){return e.format===b.FloatRight?(0,v.jsx)(p.p,{allowSelectionWithin:!1,style:{width:0,height:0},children:e.children}):(0,v.jsx)(v.Fragment,{children:e.children})}const _=function(e){window.__c={n:"DiscussionIndicator"};const t=(0,r.O7)(),n=(0,o.Dl)();(0,i.q7)(null==n?void 0:n.domLock);const{store:p,recursivelyLoadAllDiscussions:b,onlyCountBlockLevelDiscussions:_}=e,S=(0,a.VK)((()=>{const e=g.vV(p,{recursivelyLoadAllDiscussions:b,onlyIncludeBlockLevelDiscussions:_});if(0===e.length)return{numberOfComments:0,discussionIsSelected:!1};const t=new Set(e.map((e=>e.id))),n=h.Z.getFramePageFirstSelectedDiscussionId(),o=n&&t.has(n),i=f.RM();if(i){const e=g.MI({blockStore:i,traverseTransclusionReferences:!0}),n=e.indexOf(p),o=new Set(t);for(let i=n-1;i>=0;i--){const n=e[i],r=g.vV(n,{recursivelyLoadAllDiscussions:!1,excludeSelf:!1,onlyIncludeBlockLevelDiscussions:!1,includeLoadingDiscussions:!0}).map((e=>e.id));for(const e of o)r.includes(e)?t.delete(e):o.delete(e);if(0===t.size)return{numberOfComments:0,discussionIsSelected:!1};if(0===o.size)break}}return{numberOfComments:g.Xp(p,{recursivelyLoadAllDiscussions:b,onlyIncludeBlockLevelDiscussions:_}),discussionIsSelected:o}}),[_,b,p]),{numberOfComments:w,discussionIsSelected:k}=S,I=(0,s.yK)((e=>({speechBubble:{position:"relative",alignSelf:"flex-start",marginLeft:4,marginTop:3,background:k?e.selectLightGray[100]:void 0},commentCount:{marginLeft:2,color:e.lightTextColor,fontWeight:c.Z.fontWeight.semibold}})),[k]);return 0===w?null:(0,v.jsx)(y,{format:e.getFormat(),children:(0,v.jsx)(m.Z,{icon:l.z,style:I.speechBubble,onClick:()=>{u.ZH(t),d.Ib({environment:t,blockStore:e.store,analyticsFrom:"discussion_indicator",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:e.recursivelyLoadAllDiscussions})},caption:(0,v.jsx)("span",{style:I.commentCount,children:w>9?"9+":w})})})}},34047:(e,t,n)=>{n.d(t,{DF:()=>m,De:()=>f,Je:()=>C,KL:()=>k,NI:()=>h,O2:()=>d,QT:()=>p,Qg:()=>u,W5:()=>w,ad:()=>I,hu:()=>S,n9:()=>_,p9:()=>x,uC:()=>y});var o=n(72126),i=n(70279),r=n(70203),a=n(97880),s=n(65598),l=n(26136);const c=n(60809);let d=function(e){return e[e.Menu=0]="Menu",e[e.Page=1]="Page",e[e.Sidebar=2]="Sidebar",e[e.Margin=3]="Margin",e[e.Unfurl=4]="Unfurl",e}({});function u(e){let{recordStore:t,currentUserId:n}=e;return b({recordStore:t,currentUserId:n})||h(t)[0]}function p(e){return e>1?3:6}function m(e){let{blockStore:t,ignoreAfterTime:n,currentUserId:o}=e;if(!t)return[];return s.al(t,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0}).sort(((e,t)=>{const n=u({recordStore:e,currentUserId:o}),i=u({recordStore:t,currentUserId:o});return null!=n&&n.isDefined()?null!=i&&i.isDefined()?-(n.getCreatedTime()-i.getCreatedTime()):1:-1}))}function f(e){if(!e.isDefined())return!1;const t=e.getContext();if(!t)return!0;return(e=>0===r.llS(e).length)(r.VP_(t,(t=>!r.xw5(t)||r.h19(t)===e.id)))}function g(e,t){return e&&e.isDefined()?t&&t.isDefined()?e.getCreatedTime()-t.getCreatedTime():1:-1}function h(e){return s.D4(e).sort(((e,t)=>g(e,t)))}function v(e){return b({recordStore:e,currentUserId:void 0})}function b(e){let{recordStore:t,currentUserId:n}=e;const o=s.D4(t).filter((e=>e.isDefined()&&e.getCreatedById()!==n)).sort(((e,t)=>g(e,t)));return o[o.length-1]}function y(e){return e.sort(((e,t)=>g(v(e),v(t))))}function _(e){const t=e.state.textStore.getValue(),n=(e.state.files??[]).length>0,o=t&&t.length>0;return!n&&!o}function S(e,t){const n=e.state.textStore.getValue(),i=e.state.files;if(!t)return n&&0!==n.length||i&&i.length>0;const r=s.zP(t).getValue();return!o.Xy(r,n)||function(e,t){const n=e.state.files,o=s.le(t);if(o.length!==n.length)return!0;return o.some(((e,t)=>e.id!==n[t].id))}(e,t)}function w(e){if(e.some((e=>!e.isReady())))return!0;return!!e.map((e=>s.D4(e))).flat().some((e=>!e.isReady()||!e.getCreatedTime()))}function k(e){const t=s.ak(e),n=t.getValue()||[];if(0===n.length)return;const o=n[0];return l.t1.createChildStore(t,{table:i.x_,id:o,spaceId:t.pointer.spaceId}).getCreatedTime()}function I(e){switch(e){case"block_menu":return d.Menu;case"page_discussion":return d.Page;case"reply_menu_mentions_comments":case"reply_menu_all_updates":case"reply_menu_archive":case"reply_menu_updates_sidebar":case"updates_menu_mentions_comments":case"updates_menu_all_updates":case"updates_menu_archive":return d.Menu;case"updates_sidebar":return d.Sidebar;case"margin_comments":return d.Margin;case"comment_unfurl":return d.Unfurl;default:(0,a.t1)(e)}}function x(e){var t;if(e.length>1)return!1;const n=e[0];if(!n.length)return!1;const o=n[0].trim(),i=c();return(null===(t=o.match(i))||void 0===t?void 0:t.join(""))===o}const C={updates_menu_all_updates:28,updates_menu_mentions_comments:28,updates_menu_archive:28,block_menu:20,reply_menu_all_updates:20,reply_menu_mentions_comments:20,reply_menu_archive:20,reply_menu_updates_sidebar:20,page_discussion:20,updates_sidebar:23,margin_comments:20,comment_unfurl:32}},92650:(e,t,n)=>{n.d(t,{fS:()=>V,QB:()=>Z,Z:()=>j,Vs:()=>B,wo:()=>R,az:()=>z,oS:()=>O,H0:()=>H,ui:()=>L,gC:()=>U,fg:()=>W,EM:()=>N});n(57658);var o=n(18466),i=n(14577),r=n(41432),a=n(22491),s=n(72126),l=n(21202),c=n(97880),d=n(43250),u=n(78316),p=n(11599),m=n(65598),f=n(41549),g=n(58202),h=n(49427),v=n(95802),b=n(24646),y=n(15723),_=n(80444),S=n(17903),w=n(88923),k=n(26136),I=n(49085),x=n(92595);class C extends I.default{getInitialState(){return{visible:!0}}}const T=new C;(0,x.exposeDebugValue)("MarginCommentsStore",T);const M=T;var P=n(48514),A=n(34047);const R=10,D="temp-margin-comment-discussion",B=50,E=`.${d.x9t} .notion-collection_view-block`,F=`.${d.OE$}`,Z=372,V=16,j=Z-4*V;function U(e,t,n){const o=L(e,t);return o>=1500||n&&!w.default.isSidePeekClosing.state||t?0:(1500-o)/2}function L(e,t){return t&&w.default.isSidePeekOpen()?(0,b.vJ)(e):e.WindowSizeStore.state.width-(0,b.Wk)(e)-(0,b.vJ)(e)-f.VV()}function O(e,t,n){return(L(e,t)-1600)/2+2*V+U(e,t,n)}const N=new i.Z((()=>{var e;let t=_.default.state.mainEditorCurrentBlockStore;return null!==(e=t)&&void 0!==e&&e.isCollectionView()&&(t=(0,u.SY)(t)||t),t?(0,m.vV)(t,{recursivelyLoadAllDiscussions:!0,excludeSelf:!0}):[]}),{debugName:"mainEditorBlockUnresolvedDiscussionStore"});function z(e,t){const n=M.state.visible;return Boolean(!e.device.isMobile&&L(e,(0,u.en)(t))>=1150&&n&&!(0,b.Sx)(e)&&!w.default.isSidePeekOpen()&&h.Z.isBlockInFrame(t)&&(0,p.A$)("margin_comments","inline"))}function W(e,t){const n=N.state.length>0,o=P.Z.state.open&&P.Z.state.rect;return Boolean(z(e,t)&&(n||o))}function q(e,t){return e.offsetTop!==t.offsetTop?e.offsetTop<t.offsetTop?-1:1:e.createdTimeMs&&t.createdTimeMs&&e.createdTimeMs!==t.createdTimeMs?e.createdTimeMs<t.createdTimeMs?-1:1:e.id<t.id?-1:1}const H=(0,s.Ds)((function(e){let{discussionStores:t,pageContentStores:n,marginDiscussionItemRefs:i,selectedDiscussionId:s,newMarginDiscussionArgs:u,marginContainerElement:p,pageViewBlockElement:m,onComputeComplete:f,computedOnce:h,prevSelectedDiscussionId:b,isFullWidth:_,topbarHeight:w,windowHeight:I,previousDiscussionElements:x}=e;const C=new Map;let T=0,M=0;if(!p||!m)return;if(0===t.length&&!u)return;const P=o.Z.withListenerIgnored((()=>S.Z.state.scrollTop)),R=p.getBoundingClientRect(),B=K({currentScrollTop:P,rect:R});let Z=function(e){const t=new Map,n=[];return e.forEach((e=>{if(e.shouldGroup){const n=t.get(e.parentBlockStore.id)||[];n.push(e),t.set(e.parentBlockStore.id,n)}else n.push(e)})),t.forEach((e=>{n.push({offsetTop:e[0].offsetTop,groupedDiscussionsData:e,parentBlockStore:e[0].parentBlockStore,type:"grouped",id:e[0].id,createdTimeMs:e[0].createdTimeMs})})),n}(t.map((e=>function(e){let{discussionStore:t,currentScrollTop:n,topbarHeight:o,windowHeight:i,pageViewBlockElement:r,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}=e;const u=t.id,p=function(e){const{topbarHeight:t,windowHeight:n,pageViewBlockElement:o,discussionId:i,previousDiscussionElements:r,currentDiscussionElements:s,selectedDiscussionId:l}=e,c=o.getElementsByClassName((0,a.dk)({discussionId:i})),d=e=>(s.set(i,e),e);if(c.length>0){if(l===i){let e;for(let o=0;o<c.length;o++){const i=c[o];if(i instanceof HTMLElement){const o=i.getBoundingClientRect();if(o.bottom<t||o.top>n){if(e)return d(e)}else{if(o.top>t)return d(i);e=i}}}}const e=r.get(i);return e&&Array.from(c).includes(e)?d(e):d(c[0])}}({topbarHeight:o,windowHeight:i,pageViewBlockElement:r,discussionId:u,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}),m=t.recordStoreUIParentStore;if(!(m&&m.id&&m.table===l.iU&&m instanceof k.G))return;if(!m.isReady())return;const f={offsetTop:0,discussionStore:t,parentBlockStore:m,type:"existing",id:t.id,createdTimeMs:(0,A.KL)(t)};if(p instanceof HTMLElement)return f.offsetTop=K({rect:p.getBoundingClientRect(),currentScrollTop:n}),f;const g=v.C.findNodeFromStore(m);if(g instanceof HTMLElement)return f.offsetTop=K({rect:g.getBoundingClientRect(),currentScrollTop:n}),f;const{node:h,blockStore:b}=function(e){let t=e.getParentBlockStore();for(;t;){const e=t.getParentBlockStore();if(!e)return{};const n=v.C.findNodeFromBlockId(t.id);if(n)return{node:n,blockStore:t};t=e}return{}}(m);if(h instanceof HTMLElement&&b)return f.offsetTop=K({rect:h.getBoundingClientRect(),currentScrollTop:n})+10,f.parentBlockStore=b,f.shouldGroup=!0,f.closestVisibleParentId=b.id,f}({discussionStore:e,currentScrollTop:P,topbarHeight:w,windowHeight:I,pageViewBlockElement:m,previousDiscussionElements:x,currentDiscussionElements:C,selectedDiscussionId:s}))).filter(c.$K));const V=u&&function(e){var t;let n,{blockStore:o,discussionInputStore:i,currentScrollTop:r,pageViewBlockElement:a}=e;const s=null===(t=a.getElementsByClassName(d.dXl))||void 0===t?void 0:t[0];n=s instanceof HTMLElement?s.getBoundingClientRect():g.R.getRect(o);if(!n)return;return{offsetTop:K({rect:n,currentScrollTop:r}),parentBlockStore:o,discussionInputStore:i,type:"new",id:D,createdTimeMs:Date.now()}}({...u,currentScrollTop:P,pageViewBlockElement:m}),j=V?V.id:s;let U;V&&Z.push(V);const L=j||b?void 0:function(e){let{pageContentStores:t,currentScrollTop:n,marginContainerRect:o,isFullWidth:i}=e;return t.map((e=>{const t=e.getType();if(!t)return;let n;var a;if((0,c.qg)(r.Ok,t)||"column_list"===t)n=null===(a=v.C.findSelectableFromStore(e))||void 0===a||null===(a=a.getNode())||void 0===a?void 0:a.getBoundingClientRect();else if(t===r.Ti.table){var s,l;const t=null===(s=v.C.findSelectableFromStore(e))||void 0===s?void 0:s.getNode(),o=null==t?void 0:t.getBoundingClientRect(),r=null==t||null===(l=t.querySelector(F))||void 0===l?void 0:l.getBoundingClientRect();n=i?o:o&&r?o.width<r.width?o:r:o||r}else if(e.isInlineCollectionView()){var d,u;const t=null===(d=v.C.findSelectableFromStore(e))||void 0===d?void 0:d.getNode();n=i?null==t?void 0:t.getBoundingClientRect():null==t||null===(u=t.querySelector(E))||void 0===u?void 0:u.getBoundingClientRect()}return n&&n.right>o.left?n:void 0})).filter(c.$K).map((e=>{const t=K({rect:e,currentScrollTop:n});return new DOMRect(e.left,t,e.width,e.height)}))}({pageContentStores:n,currentScrollTop:P,marginContainerRect:R,isFullWidth:_}).sort((e=>-e.top));Z=Z.sort(q).map(((e,t)=>{e.offsetTop-B>=18&&(e.offsetTop-=18);const n=e.id,o=i.get(e.id);if(!o)return"new"===e.type||h||(e.offsetTop=-9999,e.hide=!0),e;const r=o.getBoundingClientRect(),a=r.height;let s=e.offsetTop;return s<=T&&(s=T),L&&(s=function(e,t){const n={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,left:e.left,bottom:e.bottom,right:e.right};let o=t[t.length-1];for(;o;)if((0,y.dQ)(n,o))n.top=o.bottom+10,n.bottom=n.top+n.height,t.pop(),o=t[t.length-1];else{if(n.bottom<o.top)return n.top;t.pop(),o=t[t.length-1]}return n.top}(new DOMRect(r.left,s,r.width,r.height),L)),n===j&&0===M&&(M+=s-e.offsetTop,e.selected=!0,U=t),e.offsetTop=s,e.height=a,T=e.offsetTop+a,e}));const O=Z.map((e=>(e.offsetTop=e.offsetTop-B,e)));let N;if(M>0&&void 0!==U)for(let o=U;o>=0;o--){const e=O[o];if(e.height){if(e.id===j)e.offsetTop-=M;else{if(!(N&&N.offsetTop<=e.offsetTop+e.height))break;e.offsetTop-=M}N=e}}f({data:O,hasNewDiscussion:Boolean(V),selectedDiscussion:s},C)}),100);function K(e){let{rect:t,currentScrollTop:n}=e;return t.top+n}},92120:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){}getFirstSelectedDiscussionId(){var e;return null===(e=this.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0]}}const a=new r;(0,i.exposeDebugValue)("DiscussionHoverStore",a);const s=a},82994:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(26263),i=n(49085),r=n(4615),a=n(70279),s=n(26136);class l extends i.default{constructor(e,t){super(),this.environment=void 0,this.spaceId=void 0,this.environment=e,this.spaceId=t,this.reset()}getInitialState(){if(!this.environment)return;const e=new o.Z({name:"DiscussionInputStore"});return{textStore:new s.ST({environment:this.environment,pointer:{table:a.x_,id:(0,r.ZP)(),spaceId:this.spaceId},path:["text"],inMemoryRecordCache:e}),localRecordCache:e,files:[],showAttachFileIntro:!1,renderFileAttachIntro:!1}}isEmpty(){const e=this.state.textStore.getValue();return!e||0===e.length}}const c=l},48514:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),i=n(92595),r=n(15723);class a extends o.default{getInitialState(){return{open:!1,rect:r.bM}}}const s=new a;(0,i.exposeDebugValue)("NewDiscussionMenuStore",s);const l=s},9080:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(15723);class r extends o.default{getInitialState(){return{open:!1,rect:i.bM}}}const a=new r},24736:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),i=n(56666),r=n(64921),a=n(85893);function s(e){let{onClick:t,className:n,isMobile:s,style:l,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m}=e;window.__c={n:"ActionMenuButton"};const{buttonStyle:f,iconStyle:g}=(0,o.yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:4,width:s?45:24,height:s?45:24,marginRight:s?-8:-6,...l},iconStyle:{width:s?18:14,height:s?18:14,fill:e.mediumIconColor}})),[s,l]);return(0,a.jsx)(r.Z,{onClick:t,style:f,className:n,mobileFeedback:s,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m,children:(0,i.o)(g)})}},1292:(e,t,n)=>{n.d(t,{Z:()=>L});var o=n(67294),i=n(73935),r=n(83355),a=n(24405),s=n(15145),l=n(70037),c=n(21202),d=n(33709),u=n(23867),p=n(82990),m=n(9291),f=n(50906),g=n(75754),h=n(993),v=n(32741),b=n(95477),y=n(66213),_=n(95645),S=n(14976),w=n(35683),k=n(84210),I=n(98165),x=n(77907),C=n(77080),T=n(46735),M=n(72014),P=n(31194),A=n(26136),R=n(24736),D=n(68709),B=n(31945),E=n(84076),F=n(31278),Z=n(76798),V=n(24813),j=n(85893);class U extends _.Z{constructor(){super(...arguments),this.nodeRef=o.createRef(),this.state={isHovered:!1},this.origin=o.createRef(),this.handlePageMouseOver=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&h.Nh({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handlePageMouseOut=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&h.Zl({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}activate(){const{store:e}=this.props;this.navigate(e)}willUnmount(){super.willUnmount(),v.qA(this.props.store.getTitleStore())}navigate(e){if(this.context.overrideLinkClick){const t=(0,k.ZP)({store:e,pageVisitSource:s.tY.LinkInPage});this.context.overrideLinkClick(t)}else g._({environment:this.environment,store:e,visitType:w.vu.Link,pageVisitSource:s.tY.LinkInPage})}renderPersisted(){const{disabled:e,store:t}=this.props,n=t.getAliasTargetStore();if(!n)return;if(n instanceof A.G)return(0,j.jsx)(D.p,{allowSelectionWithin:!1,onMouseOver:this.handlePageMouseOver,onMouseOut:this.handlePageMouseOut,children:(0,j.jsx)(V.Z,{ref:this.nodeRef,store:n,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:!0,aliasStore:t,disabled:e,onClick:()=>function(e,t){f.Se(t),T.Z.recordVisit({id:e.id,systemBlockType:e.getSystemBlockTypeStore().getValue(),type:w.vu.Link,currentUserId:t.currentUser.id}),f.SK1(t,{page_visit_id:M.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"alias_block",hover_preview_enabled:C.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()})}(this.props.store,this.environment)})});const o=I.Dg(n);if("none"===n.getRole())return(0,j.jsx)(D.p,{allowSelectionWithin:!1,children:(0,j.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4},children:(0,j.jsx)(E.Z,{ref:this.origin,style:{width:"100%"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:(0,j.jsxs)("div",{style:{display:"flex",padding:9},children:[(0,l.h)({width:30,height:30,marginRight:10,marginLeft:5}),(0,j.jsxs)("div",{style:{fontSize:14},children:[(0,j.jsx)("div",{style:{fontWeight:p.Z.fontWeight.medium},children:(0,j.jsx)(m.FormattedMessage,{defaultMessage:"No access to page comments",id:"aliasBlock.comment.noAccess.title"})}),(0,j.jsx)(m.FormattedMessage,{defaultMessage:"You don't have permission to view this page and its comments",id:"aliasBlock.comment.noAccess.subtitle"})]})]})})})});if(!o||!n.isDefined())return(0,j.jsx)(N,{});const i=A.t1.createChildStore(o,{table:d.qF,id:n.getParentId(),spaceId:(0,u.C)(o.pointer.spaceId)});if(null==i||!i.isDefined())return;const r=i.getModel(),a=A.G.createChildStore(o,r.getParentPointer()).getModel(),g=a&&"table_row"===a.getType()?a.getParentId():r.getParentId(),h=A.t1.createChildStore(o,{table:c.iU,id:g,spaceId:(0,u.C)(o.pointer.spaceId)});if(!h.isDefined())return;const v=o.isDefined()?h.getModel().getRenderUrl({getRecordModel:t.getRecordModel,baseUrl:b.default.domainBaseUrl,discussionId:i.id,pageVisitSource:s.tY.LinkInPage}):void 0,{isMobile:y}=this.environment.device;return(0,j.jsx)(D.p,{allowSelectionWithin:!1,children:(0,j.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,cursor:"pointer",borderRadius:4},children:(0,j.jsxs)(E.Z,{ref:this.origin,style:{display:"flex",flexDirection:"column"},href:v,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,j.jsxs)("div",{style:{display:"flex",pointerEvents:"none"},children:[(0,j.jsx)(x.LazyComment,{store:n,discussionStore:i,showResolveButtonByDefaultIfPossible:!1,blockStore:t,hoveringDiscussion:!1,discussionLocation:"comment_unfurl",collapsed:!0,maxLines:2},n.id),(0,j.jsx)(B.ZP,{popupType:y?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,j.jsx)(R.Z,{...e,isMobile:y,style:{margin:8,opacity:y||this.state.isHovered?1:0}}),placementToOrigin:P.Iw.Top,render:e=>(0,j.jsx)(x.LazyAliasBlockPopupMenu,{onAccept:e.close,block:t})})]}),o&&(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:"50px",marginBottom:"10px"},children:[(0,j.jsx)(F.Z,{disabled:!0,icon:o.getIcon(),isEmptyPage:o.isEmptyPage(),size:14,style:{marginLeft:2,marginRight:2}}),(0,j.jsx)(Z.Z,{store:o,style:{color:"gray",fontSize:"smaller"}})]})]})})})}getInteractiveToken(){const e=this.props.store.getAliasTargetStore();if(!(this.nodeRef&&this.nodeRef.current&&e instanceof A.G))return;const t=i.findDOMNode(this.nodeRef.current);return(0,S.We)(e,t)}}U.contextTypes={...y.wK,...r.w};const L=U;function O(e){let{style:t}=e;window.__c={n:"ShimmerboxComponent"};const n=(0,a.Fg)();return(0,j.jsx)("div",{style:{overflow:"hidden",position:"relative",background:n.selectLightGray[30],...t},children:(0,j.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${n.selectLightGray[30]} 0%, ${n.selectLightGray[50]} 20%, ${n.selectLightGray[30]} 40%, ${n.selectLightGray[30]} 100%)`}})})}function N(){return(0,j.jsxs)(E.Z,{external:!0,style:{flexGrow:1,minWidth:0},children:[(0,j.jsx)(O,{style:{width:38,height:38}}),(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,j.jsx)(O,{style:{width:"50%",height:14,margin:4}}),(0,j.jsx)(O,{style:{width:"40%",height:12,margin:4}})]})]})}},77933:(e,t,n)=>{n.d(t,{Z:()=>E});n(67294);var o=n(83355),i=n(49085),r=n(56666),a=n(9291),s=n(80365),l=n(86628),c=n(24405),d=n(15145),u=n(9999),p=n(82990),m=n(84210),f=n(67669),g=n(18514),h=n(80444),v=n(81236),b=n(84076),y=n(31278),_=n(76798),S=n(94096),w=n(78454),k=n(32469),I=n(85893);class x extends o.Z{constructor(){super(...arguments),this.isPrivate=this.createComputedStore((()=>!(0,f.yi)(this.environment,this.props.currentBlockStore)&&(0,f.yi)(this.environment,this.props.backlinkStore)))}renderComponent(){const{backlinkStore:e,scrollToBlockId:t,discussionId:n}=this.props,{mainEditorCurrentBlockStore:o}=h.default.state,i=o&&o.id===e.id,r=(0,m.ZP)({store:e,scrollToBlockId:t,discussionId:n,fullyQualified:!0,preferPublicLink:(0,g.Sr)(),getSpaceDomain:()=>{var t;return null===(t=v.Z.getPublicSpaceData(this.environment,e.getSpaceId()))||void 0===t?void 0:t.domain},pageVisitSource:d.tY.LinkInPage});return(0,I.jsx)(b.Z,{href:r,external:!1,innerStyle:{paddingLeft:8,paddingRight:16},children:(0,I.jsx)(w.ZP,{childrenStyle:{padding:"4px 2px"},alignment:w.v2.Center,style:{marginBottom:2,marginRight:4},right:(0,I.jsxs)(I.Fragment,{children:[this.props.showOriginalToken&&(0,I.jsx)("div",{style:M(this.environment,this.theme),children:(0,I.jsx)(a.FormattedMessage,{defaultMessage:"Original",id:"backlink.originalTokenLabel"})}),i&&!this.props.disableCurrentPageToken&&(0,I.jsx)("div",{style:M(this.environment,this.theme),children:(0,I.jsx)(a.FormattedMessage,{defaultMessage:"This page",id:"backlink.currentPageTokenLabel"})})]}),children:(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[!this.props.disableArrow&&(0,I.jsx)(P,{}),(0,I.jsx)(T,{backlinkStore:this.props.backlinkStore}),(0,I.jsx)(_.Z,{store:e,style:(s=this.theme,{fontWeight:p.Z.fontWeight.medium,fontSize:p.Z.fontSize.UIRegular.desktop,lineHeight:1.3,borderBottom:`1px solid ${s.darkDividerColor}`,flexShrink:1})}),(0,I.jsxs)("div",{style:{marginTop:-2,minWidth:0,display:"flex",alignItems:"baseline",flex:"2 0 40%",paddingTop:"0.1em"},children:[(0,I.jsx)(S.Z,{store:e,style:{paddingLeft:8}}),this.renderPrivate()]})]})})});var s}renderPrivate(){if(this.isPrivate.state)return(0,I.jsx)(k.Z,{style:{paddingRight:4,marginLeft:12}})}}x.displayName="Backlink";const C=(0,a.injectIntl)(x);function T(e){let{backlinkStore:t}=e;window.__c={n:"Icon"};const n=(0,l.VK)((()=>t.getIcon()),[t]),o=(0,l.VK)((()=>t.isEmptyPage()),[t]);return(0,I.jsx)(y.Z,{disabled:!0,icon:n,isEmptyPage:o,size:20,style:{marginLeft:4,marginRight:4}})}function M(e,t){const{device:n}=e;return{padding:"2px 6px",borderRadius:4,color:t.mediumTextColor,background:t.legacyDefaultSelectColor,fontSize:n.isMobile?11:9,lineHeight:n.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap",marginLeft:4}}function P(){window.__c={n:"ArrowIconComponent"};const e=(0,c.Fg)();return(0,I.jsx)("div",{style:{marginLeft:4,transform:"rotate(180deg)",fill:e.regularIconColor},children:(0,u.J)({width:15,height:15})})}var A=n(89728),R=n(26388),D=n(64369);class B extends o.Z{constructor(){super(...arguments),this.storeTypes={showMore:i.default.createClass(10),hovered:i.default.createClass(!1)},this.handleMouseMove=()=>{this.stores.hovered.setState(!0)},this.handleMouseLeave=()=>{this.stores.hovered.setState(!1)},this.handleShowMore=()=>{this.stores.showMore.setState(this.stores.showMore.state+10)},this.backlinksState=this.createComputedStore((()=>(0,s.L)(this.props.store,this.environment)),!0)}renderComponent(){const{originalTransclusionStore:e,disableInaccessiblePages:t}=this.props,n=this.backlinksState.state,o=this.stores.showMore.state,i=e?e.getNavigableBlockStore():void 0;if(0===n.backlinks.length&&!e)return;const s=n.backlinks.length>o,l=n.inaccessibleBacklinkCount>0&&!t;return(0,I.jsxs)("div",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[this.props.headerText&&(0,I.jsx)(F,{headerText:this.props.headerText}),e&&i&&(0,I.jsx)(C,{currentBlockStore:this.props.store,disableArrow:this.props.disableArrow,disableCurrentPageToken:this.props.disableCurrentPageToken,backlinkStore:i,scrollToBlockId:e.id,showOriginalToken:!0}),n.backlinks.slice(0,o).map((e=>(0,I.jsx)(C,{currentBlockStore:this.props.store,disableArrow:this.props.disableArrow,disableCurrentPageToken:this.props.disableCurrentPageToken,...e},e.backlinkStore.id))),(s||l)&&(0,I.jsx)(R.ZP,{disableTooltip:s,renderTooltip:()=>(0,I.jsx)(a.FormattedMessage,{defaultMessage:"Synced in pages that you don't have access to.",id:"page.backlinks.privatePagesTooltip"}),render:e=>(0,I.jsx)(A.Z,{icon:r.o,isGray:!0,onClick:this.handleShowMore,style:{padding:`2px ${this.props.disableArrow?17:14}px`,width:"100%"},disabled:!s,...e,children:s?(0,I.jsx)(a.FormattedMessage,{defaultMessage:"{count} more",id:"page.backlinks.more",values:{count:n.backlinks.length-o}}):(0,I.jsx)(a.FormattedMessage,{id:"page.backlinks.privatePages",defaultMessage:"{count, plural, one {{count} private page} other {{count} private pages}}",values:{count:n.inaccessibleBacklinkCount}})})})]})}}B.displayName="Backlinks";const E=B;function F(e){let{headerText:t}=e;return(0,I.jsx)("div",{style:{display:"flex"},children:(0,I.jsx)(D.Z,{isSmall:!0,style:{marginTop:12,marginBottom:8,marginLeft:4,flex:1,paddingLeft:8},children:t})})}},4350:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(83355),i=n(23867),r=n(80444);class a extends o.Z{UNSAFE_willMount(){l()||this.environment.LocalBacklinkStore.initializeBacklinks({block:{id:this.props.store.pointer.id,spaceId:(0,i.C)(this.props.store.pointer.spaceId)},currentUserId:this.environment.currentUser.id,environment:this.environment})}willUnmount(){l()||this.environment.LocalBacklinkStore.destroyBacklinks(this.props.store.id,this.environment)}}a.displayName="BacklinksListener";const s=a;function l(){const{mainEditorCurrentBlockStore:e}=r.default.state;return Boolean(e&&"15776535-3f2c-4705-bd45-474e5ba8b46c"===e.id)}},13966:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(480),i=n(24405),r=n(56666),a=n(6404),s=n(24677),l=n(43250),c=n(98742),d=n(27724),u=n(64921),p=n(26388),m=n(85893);const f=function(e){let{tooltipContent:t,fadeIn:n,style:o,hoveredStyle:i,store:r,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f}=e;return t?(0,m.jsx)(p.ZP,{renderTooltip:()=>t,delayThreshold:300,render:e=>(0,m.jsx)(h,{tooltipEvents:e,fadeIn:n,style:o,hoveredStyle:i,store:r,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f})}):(0,m.jsx)(h,{fadeIn:n,style:o,hoveredStyle:i,store:r,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f,tooltipEvents:{}})};function g(e,t,n){const{device:o}=e;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:24,height:24,borderRadius:4,fill:o.isMobile?t.lightIconColor:t.mediumIconColor,transition:"opacity 200ms ease-in",...n}}function h(e){let{tooltipEvents:t,fadeIn:n,style:p,hoveredStyle:f,store:h,onClick:v,extraAnalyticsData:b,hideFilterActionsInput:y,actionSectionGroupKey:_,onFocus:S,onBlur:w,iconStyle:k}=e;window.__c={n:"ButtonComponent"};const I=(0,i.Fg)(),x=(0,o.O7)();return(0,m.jsx)(u.Z,{className:n?l.JiD:void 0,style:g(x,I,p),hoveredStyle:f,onClick:e=>function(e,t,n,o,i,r,l){s.Ys({environment:n,store:t}),a.Qn({environment:n,stores:d.default.state.stores,left:e.clientX,top:e.clientY,showInput:!r,actionSectionGroupKey:l||"default",analyticsFrom:"block_more_menu",optionalAnalyticsProperties:{isFromBulkActionsToolbar:i?i.isFromBulkActionsToolbar:void 0}}),null==o||o()}(e,h,x,v,b,y,_),...(0,c.Z)(t,{onFocus:S,onBlur:w}),children:(0,r.o)({width:14,height:14,...k})})}},91893:(e,t,n)=>{n.d(t,{Z:()=>g});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(49271),s=n(9291),l=n(92650),c=n(68056),d=n(24646),u=n(24666),p=n(65187),m=n(85893);const f=(0,s.defineMessages)({imageCaption:{defaultMessage:"Write a captionâ€¦",id:"block.imageCaption.placeholder"}});function g(e){let{captionAriaId:t,disabled:n,store:g}=e;window.__c={n:"BlockCaption"};const h=(0,o.O7)(),v=(0,o.Fy)(),b=(0,s.useIntl)(),y=(0,i.VK)((()=>g.getPropertyStore("caption")),[g]),_=(0,i.VK)((()=>{var e;const t=y.getValue(),n=!t||0===t.length,o="editing"===u.default.state.mode&&(null===(e=(0,c.QY)(u.default.state.multiSelection))||void 0===e?void 0:e.store)===y;return!n||o}),[y]),S=(0,i.VK)((()=>{const{block_full_width:e,block_width:t,block_page_width:n}=g.getFormat();if(v.isMobile)return!1;if(n)return!1;if(e)return!0;const o=(0,l.fg)(h,g);return(t||0)>=h.WindowSizeStore.state.width-(0,d.Wk)(h)-(o&&g.isFullWidth()?l.QB:0)}),[v.isMobile,h,g]),w=(0,r.yK)((e=>({root:{fontSize:14,lineHeight:1.4,color:e.mediumTextColor,paddingTop:6,paddingBottom:6,paddingLeft:a.ZD.paddingLeft,...S&&{paddingLeft:26,paddingRight:26}}})),[S]);return _?(0,m.jsx)(p.Z,{id:t,disabled:n,style:w.root,placeholderStyle:w.root,placeholder:b.formatMessage(f.imageCaption),disableSlashCommands:!0,disableEmbedMenu:!0,store:y,pasteBehavior:"block"}):null}},23864:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),i=n(480),r=n(86628),a=n(41432),s=n(25487),l=n(92650),c=n(78175),d=n(98165),u=n(77907),p=n(24646),m=n(26136),f=n(85893);function g(e){let{disableCommentMenu:t,hideContent:n,hideIfSidebarOrMarginCommentsVisible:g,recursivelyLoadAllDiscussions:h,store:v}=e;window.__c={n:"BlockDiscussionIndicator"};const b=(0,i.O7)(),y=(0,i.Fy)(),_=(0,r.VK)((()=>{const e=v.getModel();return Boolean(null==e?void 0:e.isType(a.eh))}),[v]),S=(0,r.VK)((()=>{const e=(0,d.qA)(v);let t,n,o,i;for(const r of e){if(r instanceof m.G&&t){const e=r.getType();if(e&&(0,a.S9)(e)&&r.id!==v.id)break;if("column_list"===e){const e=r.getContentStore().getValue()||[];n=e.indexOf(t.id),o=e.length,i=(0,c.Po)(r,b)}}t=r}return{columnListIndex:n,columnListColumnCount:o,columnListResizable:i}}),[b,v]),w=(0,o.useCallback)((()=>{if(!y.isMobile){if(void 0===S.columnListIndex)return s.DiscussionIndicatorFormat.FloatRight;if(!S.columnListResizable&&S.columnListColumnCount&&S.columnListIndex===S.columnListColumnCount-1)return s.DiscussionIndicatorFormat.FloatRight}return s.DiscussionIndicatorFormat.PushContent}),[S.columnListColumnCount,S.columnListIndex,S.columnListResizable,y.isMobile]),k=(0,r.VK)((()=>(0,p.Sx)(b)),[b]),I=(0,r.VK)((()=>(0,l.fg)(b,v)),[b,v]);return t||n||(_||g)&&(k||I)?null:(0,f.jsx)(u.LazyDiscussionIndicator,{store:v,getFormat:w,recursivelyLoadAllDiscussions:Boolean(h),onlyCountBlockLevelDiscussions:k},"DiscussionIndicator")}},70518:(e,t,n)=>{n.d(t,{IS:()=>C,ZP:()=>P,bZ:()=>T});n(21703),n(67294);var o=n(73935),i=n(83355),r=n(41432),a=n(95538),s=n(72126),l=n(50906),c=n(96802),d=n(24677),u=n(82530),p=n(28020),m=n(43250),f=n(77546),g=n(58202),h=n(49427),v=n(68859),b=n(26136),y=n(91681),_=n(27724),S=n(6685),w=n(85893);const k={[r.Ti.image]:36,[r.Ti.audio]:24,[r.Ti.video]:96,[r.Ti.embed]:96,[r.Ti.drive]:96,[r.Ti.tweet]:96,[r.Ti.framer]:96,[r.Ti.maps]:96,[r.Ti.gist]:96,[r.Ti.invision]:96,[r.Ti.pdf]:96,[r.Ti.drawing]:200},I={[r.Ti.image]:36,[r.Ti.video]:96,[r.Ti.embed]:246,[r.Ti.maps]:96,[r.Ti.framer]:96,[r.Ti.tweet]:250,[r.Ti.gist]:96,[r.Ti.audio]:96,[r.Ti.drive]:300,[r.Ti.invision]:96,[r.Ti.pdf]:96,[r.Ti.columnList]:"page_width",[r.Ti.drawing]:300},x={display:"contents"};let C=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Corner=2]="Corner",e}({}),T=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class M extends i.Z{constructor(){super(...arguments),this.dragState=void 0,this.domElm=null,this.storeTypes={blockResizerStore:v.Z},this.handleRef=e=>{this.domElm=e},this.handleDragStart=e=>{e.preventDefault();const t=o.findDOMNode(this.props.resizeComponent);if(!(t&&t instanceof Element))return;let n=0;if(this.domElm){const e=(0,f.VW)(this.domElm);e&&(n=e.getBoundingClientRect().width)}let i=0;const a=this.props.store.getRecordStoreUIParent(),l=a&&a.findRecordStoreUIAncestor((e=>e instanceof b.G)).ancestor;if(l){const e=g.R.getRect(l);e&&(i=e.width);const t=l.getRecordStoreUIParent(),n=t&&t.findRecordStoreUIAncestor((e=>e instanceof b.G)).ancestor;if("tab"===(null==n?void 0:n.getType())){const e=g.R.getRect(n);e&&(i=e.width)}}const c=function(e){const t=e.getRecordStoreUIRoot(),n=h.Z.find((e=>e.props.store===t));if(n)return n.getContentInnerWidth()}(this.props.store)||0,u=_.default.state.stores.filter((e=>function(e){const t=e&&e.getType();return t&&r.Ok[t]}(e)));let p;p=s.q9(u,this.props.store)?u:[this.props.store];const{block_width:m,block_height:v,block_full_width:S,block_page_width:w}=this.props.store.getFormat();this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!0,temporaryHeight:v,temporaryWidth:m,temporaryFullWidth:S,temporaryPageWidth:w}),y.Z.setState({...y.Z.state,isResizing:!0}),d.ZH(this.environment);const k=t.getBoundingClientRect();this.dragState={resizingBlocks:p,startWidth:k.width,startHeight:k.height,parentWidth:i,pageWidth:c,isRootChild:this.props.store.isChildOfRecordStoreUIRoot(),startScrollerWidth:n,didDragMove:!1}},this.handleHorizontalDragMove=e=>{let{diffX:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{temporaryHeight:n}=this.stores.blockResizerStore.state,{width:o,isFullWidth:i,isPageWidth:r}=this.getNewWidthStyleValue(t);if(this.props.preserveScale){const e=i?n||a.QA:n;this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryFullWidth:i,temporaryPageWidth:r,temporaryHeight:e})}else this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryFullWidth:i,temporaryPageWidth:r})},this.handleVerticalDragMove=e=>{let{diffY:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{height:n}=this.getNewHeightStyleValue(t);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryHeight:n})},this.handleCornerDragMove=e=>{let{diffX:t,diffY:n}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{width:o,isFullWidth:i,isPageWidth:r}=this.getNewWidthStyleValue(t),{height:a}=this.getNewHeightStyleValue(n);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryHeight:a,temporaryFullWidth:i,temporaryPageWidth:r})},this.handleDragMove=e=>this.props.resizerType===C.Horizontal?this.handleHorizontalDragMove(e):this.props.resizerType===C.Vertical?this.handleVerticalDragMove(e):this.props.resizerType===C.Corner?this.handleCornerDragMove(e):void 0,this.handleDragEnd=e=>{if(!this.dragState)return;const t=this.stores.blockResizerStore.state;if(this.dragState.didDragMove&&t.dragging){const{temporaryPageWidth:e,temporaryFullWidth:t,temporaryWidth:n,temporaryHeight:o}=this.stores.blockResizerStore.state;u.createAndCommit({userAction:"BlockResizer.handleDragEnd",environment:this.environment,perform:i=>{this.dragState&&c.FH({stores:this.dragState.resizingBlocks,update:{block_height:o,block_width:n,block_full_width:t,block_page_width:e},transaction:i})}});const i=this.props.store.getType();i&&l.Wlu(this.environment,{block_type:i,block_height:o,block_width:n,block_full_width:t,block_page_width:e})}this.endDrag()},this.handleDragCancel=e=>this.endDrag()}renderComponent(){return(0,w.jsx)(S.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,preventSidebar:!0,render:e=>(0,w.jsx)("div",{ref:this.handleRef,style:x,className:m.Ep8,...e,children:this.props.children})})}endDrag(){this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!1,temporaryPageWidth:void 0,temporaryFullWidth:void 0,temporaryWidth:void 0,temporaryHeight:void 0}),d.ZH(this.environment),y.Z.setState({...y.Z.state,isResizing:!1}),this.dragState=void 0}getNewHeightStyleValue(e){const t=this.getNewPixelHeight(e);return{height:Math.min(t,a.Kz)}}getNewPixelHeight(e){if(this.dragState){if(this.props.resizeVertically){const t=this.props.store.getType(),n=t&&k[t]||96;return Math.max(this.dragState.startHeight+e,n)}return this.dragState.startHeight}return 0}getNewWidthStyleValue(e){const t=this.getNewPixelWidth(e),n=t<144?12:48;const o=Math.round(t/n)*n,i=this.isPageWidth(t,n);return{width:o,isFullWidth:this.isFullWidth(t,n)&&!i,isPageWidth:i}}isPageWidth(e,t){return!!this.dragState&&(this.dragState.isRootChild?this.dragState.pageWidth<e+t&&this.dragState.pageWidth>e-t:this.dragState.parentWidth<e+t)}isFullWidth(e,t){if(this.dragState&&this.dragState.isRootChild){let n=this.dragState.startScrollerWidth;const o=this.props.store.getModel();return o&&!o.isType(r.GP)&&(n-=2*(0,p.ui)(this.environment)),n<e+t}return!1}getNewPixelWidth(e){if(!this.dragState)throw new Error("No start rect.");(function(e){const t=e.getModel();return e.isChildOfRecordStoreUIRoot()&&(null==t?void 0:t.isType(r.ib))})(this.props.store)&&(e*=2);let t=this.dragState.startWidth;this.props.resizeHorizontally&&(this.props.resizerAlignment===T.Left?t-=e:this.props.resizerAlignment===T.Right&&(t+=e));const n=this.props.store.getType(),o=n&&I[n]||96,i="page_width"===o?Math.min(this.dragState.parentWidth,this.dragState.pageWidth):o;return i&&t<i&&(t=i),t}}M.displayName="BlockResizer";const P=M},7825:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(22491),l=n(62965),c=n(9291),d=n(33929),u=n(73819),p=n(23864),m=n(55217),f=n(78454),g=n(65187),h=n(85893);const v=(0,c.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"bulletedListBlock.placeholder.label"}});function b(e,t){window.__c={n:"BulletedListBlock"};const n=(0,o.useRef)(null),l=(0,i.VK)((()=>{var t;const n=null===(t=e.bulletedListFormatStore)||void 0===t?void 0:t.getState();return function(e,t){switch(e){case"disc":return'"â€¢"';case"circle":return'"â—¦"';case"square":return'"â–ª"';default:return t%3==0?'"â€¢"':t%3==1?'"â—¦"':'"â–ª"'}}(null==n?void 0:n.blockIdFormats.get(e.store.id),(null==n?void 0:n.depth)||0)}),[e.bulletedListFormatStore,e.store.id]),c=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),b=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),y=(0,u.rv)(e.store),_=(0,r.yK)((()=>({root:{...{paddingLeft:a.ZD.paddingLeft},...y,...e.style}})),[y,e.style]),S=(0,h.jsxs)(f.ZP,{style:_.root,left:(0,h.jsx)("div",{...(0,s.iv)({fontSize:"1.5em",lineHeight:1,marginBottom:0,pseudoBefore:{fontFamily:"Arial",content:l}})}),childrenStyle:{display:"flex",flexDirection:"column"},ref:n,children:[(0,h.jsxs)("div",{style:{display:"flex"},children:[(0,h.jsx)(g.Z,{style:f.R8,disabled:e.disabled,store:c,placeholder:d.default.formatMessage(v.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,h.jsx)(p.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,h.jsx)(m.Z,{disabled:e.disabled,store:b,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,bulletedListFormatStore:e.bulletedListFormatStore})]});return(0,u.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"bulleted_list",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),S)}const y=o.memo(o.forwardRef(b),l.Z)},27755:(e,t,n)=>{n.d(t,{y:()=>W,Z:()=>K});n(57658);var o=n(67294),i=n(1302),r=n(480),a=n(86628),s=n(24405),l=n(63362),c=n(18442),d=n(54497),u=n(72126),p=n(97880),m=n(82990),f=n(9291),g=n(24677),h=n(98104),v=n(93174),b=n(2553),y=n(41301),_=n(95645),S=n(28651),w=n(49117),k=n(33929),I=n(98742),x=n(52315),C=n(63474),T=n(49085);class M extends T.default{getInitialState(){return{editing:!1,suppressErrorsForActionIds:[]}}startEditing(e){this.setState({editing:!0,suppressErrorsForActionIds:[],placement:e.placement})}stopEditing(){this.setState({editing:!1,suppressErrorsForActionIds:[]})}suppressErrorsForAction(e){this.setState({...this.state,suppressErrorsForActionIds:u.jj([...this.state.suppressErrorsForActionIds,e])})}}const P=M;var A=n(26136),R=n(77794),D=n(13966),B=n(23864),E=n(68709),F=n(73063),Z=n(68785),V=n(63296),j=n(31278),U=n(26388),L=n(59557),O=n(33831),N=n(85893);const z=function(){window.__c={n:"SettingsIconWithNotificationBadge"};const e=(0,s.yK)((e=>({settingsIcon:{fill:e.mediumIconColor},notificationBadge:{fill:e.blueColor,stroke:e.buttonBackground}})),[]);return(0,N.jsxs)(O.Z,{className:"settingsIconWithNotificationBadge",viewBox:"0 0 16 16",style:{width:16,height:16},children:[(0,N.jsx)("path",{d:"M6.406 15.36c-.492 0-.867-.299-.978-.762l-.24-1.037-.159-.059-.902.557c-.404.258-.885.193-1.23-.152l-.82-.82c-.347-.346-.411-.827-.153-1.231l.562-.896-.058-.147-1.032-.24a.981.981 0 01-.761-.979V8.44c0-.48.293-.861.761-.979l1.02-.246.064-.152-.562-.897c-.258-.404-.193-.878.152-1.236l.82-.82a.972.972 0 011.231-.153l.902.551.165-.064.24-1.037c.111-.463.486-.762.978-.762H7.59c.486 0 .867.299.978.762l.24 1.037.165.064.902-.55c.404-.252.885-.188 1.225.152l.82.82c.346.358.41.832.152 1.236l-.556.897.058.152 1.026.246a.981.981 0 01.761.979v1.154c0 .48-.304.862-.761.979l-1.037.24-.053.146.556.897c.258.404.2.885-.152 1.23l-.82.82c-.34.346-.82.41-1.23.153l-.903-.557-.152.059-.24 1.037a.972.972 0 01-.98.762H6.407zm.14-1.06h.903c.1 0 .147-.042.158-.136l.352-1.44c.387-.089.72-.235 1.008-.417l1.265.78c.07.046.141.04.217-.03l.621-.627c.065-.058.065-.129.018-.205l-.773-1.265a3.85 3.85 0 00.404-.997l1.447-.345c.088-.018.135-.065.135-.164v-.88c0-.105-.041-.146-.135-.17l-1.441-.34a3.878 3.878 0 00-.405-1.007l.774-1.26c.053-.082.053-.152-.018-.216l-.627-.616c-.07-.07-.129-.076-.217-.029l-1.26.768a3.782 3.782 0 00-1.013-.41L7.607 3.84c-.011-.093-.058-.134-.158-.134h-.902c-.1 0-.147.046-.164.134l-.346 1.442a4.07 4.07 0 00-1.02.416l-1.26-.768c-.087-.047-.146-.035-.222.03l-.62.615c-.071.07-.071.14-.019.222l.774 1.26a3.94 3.94 0 00-.399 1.008l-1.447.34c-.088.023-.129.064-.129.17v.879c0 .1.041.146.13.164l1.446.345c.088.37.247.721.41.997l-.779 1.265c-.052.076-.047.147.018.211l.621.621c.076.07.147.076.217.03l1.265-.78a3.35 3.35 0 001.014.416l.346 1.441c.017.088.064.135.164.135zm.452-3.071a2.233 2.233 0 01-2.227-2.227c0-1.212 1.008-2.214 2.227-2.214a2.23 2.23 0 012.22 2.214 2.232 2.232 0 01-2.22 2.227zm0-1.002c.656 0 1.201-.557 1.201-1.225 0-.662-.545-1.207-1.2-1.207a1.22 1.22 0 00-1.22 1.207c0 .674.551 1.225 1.22 1.225z",...e.settingsIcon}),(0,N.jsx)("circle",{cx:"12",cy:"4",r:"3.5",...e.notificationBadge})]})},W=(0,f.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You donâ€™t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});class q extends _.Z{constructor(){super(...arguments),this.sizeObserver=new R.E,this.buttonRef=o.createRef(),this.storeTypes={mouseStore:S.Z,buttonBlockStore:P},this.handleContainerMount=e=>{e&&this.sizeObserver.observe(e)},this.configureButtonBlock=e=>{const{buttonBlockStore:t}=this.stores;h.ZH(this.environment),g.ZH(this.environment);this.sizeObserver.rect.state.width<300&&!this.environment.device.isPhone&&e?t.startEditing({placement:{type:"popup",originRect:e}}):t.startEditing({placement:{type:"inline"}})},this.allActionDependenciesLoaded=this.createComputedStore((()=>{var e;const t=(null===(e=this.props.store.getAutomationStore())||void 0===e?void 0:e.getActionStores())??[];for(const n of t){const e=n.getBlockStores();for(const t of e)x.b(t)}}))}handleCreated(){i.default.afterNextFlush((()=>{var e;this.configureButtonBlock(null===(e=this.buttonRef.current)||void 0===e?void 0:e.getBoundingClientRect())}))}willUnmount(){this.sizeObserver.destroy()}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e),this.allActionDependenciesLoaded.state}activate(){var e;null===(e=this.buttonRef.current)||void 0===e||e.activate()}renderPersisted(){const{disabled:e,store:t}=this.props,{mouseStore:n,buttonBlockStore:o}=this.stores;return(0,N.jsxs)(E.p,{allowSelectionWithin:!0,style:{display:"flex"},ref:this.handleContainerMount,children:[(0,N.jsxs)("div",{style:{flexGrow:1,flexShrink:1,minWidth:0},children:[(0,N.jsx)(H,{store:t,mouseStore:n,buttonBlockStore:o,onConfigure:this.configureButtonBlock,ref:this.buttonRef,disabledFromEditing:e}),(0,N.jsx)(v.O,{store:t,disabled:e,buttonBlockStore:o})]}),(0,N.jsx)(B.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!0})]})}}const H=o.forwardRef(((e,t)=>{window.__c={n:"ButtonBlockButton"};const{store:n,mouseStore:i,buttonBlockStore:v,onConfigure:_,disabledFromEditing:S}=e,x=(0,f.useIntl)(),T=(0,r.O7)(),{isMobile:M}=(0,r.Fy)(),[P,R]=(0,o.useState)(!1),B=(0,a.VK)((()=>i.state.mouseEntered),[i]),E=(0,a.VK)((()=>n.getAutomationStore()),[n]),O=(0,a.VK)((()=>(null==E?void 0:E.getNameStore().getValue())??""),[E]),q=(0,a.VK)((()=>null==E?void 0:E.getIconStore().getValue()),[E]),H=function(e){const{store:t,automationStore:n,buttonBlockStore:o}=e,i=function(e){const{store:t,automationStore:n}=e,o=(0,r.O7)().currentUser.id;return(0,a.VK)((()=>{const e=t.getRecordStoreUIRoot();if(n&&e instanceof A.G)return(0,w.Gb)({type:"button_block",persisted:!0,automationStore:n,blockStore:t,pageStore:e,intl:k.default.getIntl(),parentRecordStore:n,currentUserId:o})}),[n,t,o])}({store:t,automationStore:n});return(0,a.VK)((()=>{const e=null==i?void 0:i.state;if(!e)return{type:"disabled"};if("insufficient"===e.executionPermissionStatus||"unknown"===e.executionPermissionStatus)return{type:"disabled",tooltip:W.buttonInsufficientPermissions};if("sufficient"===e.executionPermissionStatus){if(0===((null==n?void 0:n.getActionIds())??[]).length)return{type:"error",tooltip:y.Mm.noActions,hideErrorIconWhenEditorIsOpen:!0};const t=e.typecheckResult.value.actionValidationFailures,i=Object.entries(t).filter((e=>{let[t]=e;return!o.state.suppressErrorsForActionIds.includes(t)})).flatMap((e=>{let[,t]=e;return t})),r=u.Ps(i);return r?{type:"error",tooltip:(0,y.Fp)(r).forButtonTooltip}:{type:"enabled"}}(0,p.t1)(e)}),[i,n,o])}({store:n,automationStore:E,buttonBlockStore:v}),K="disabled"===H.type||P||"error"===H.type&&S,G=(0,a.VK)((()=>"error"===H.type&&!(H.hideErrorIconWhenEditorIsOpen&&v.state.editing)),[H,v]),{showFactoryButtonDeprecationBadge:$,setHasSeenFactoryButtonDeprecationBadge:Q}=(0,L.N)({blockStore:n}),Y=(0,s.yK)((e=>{const t=M?"52px":"28px";return{wrap:{display:"flex",alignItems:"center",padding:"2px 0"},configureWrap:{display:"flex",alignItems:"center",marginLeft:4},label:{pointerEvents:"none",...m.Z.textOverflowStyle},button:{display:"flex",gap:6,minWidth:50,maxWidth:`calc(100% - ${t})`,padding:"8px 12px",fontWeight:500,...K?{cursor:"not-allowed"}:{}},labelPlaceholder:{color:e.lightTextColor},warningIcon:{width:16,height:16,fill:e.errorText,color:e.errorText},spinnerWrap:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-4}}}),[K,M]),J=(0,C.D)(),X=(0,o.useRef)(null),ee=(0,o.useCallback)((()=>{i.setState({...i.state,mouseEntered:!0})}),[i]),te=(0,o.useCallback)((()=>{i.setState({...i.state,mouseEntered:!1})}),[i]),ne=(0,o.useCallback)((()=>{var e;_(null===(e=X.current)||void 0===e?void 0:e.getBoundingClientRect())}),[_,X]),oe=(0,o.useCallback)((()=>{v.state.editing?(v.stopEditing(),(0,l.lN)(J,{block_id:n.id,automation_id:null==E?void 0:E.id})):(ne(),Q(),(0,l.yK)(J,{block_id:n.id,automation_id:null==E?void 0:E.id}))}),[v,J,n.id,null==E?void 0:E.id,ne,Q]),ie=(0,o.useCallback)((async()=>{const e=n.getRecordStoreUIRoot();if(E&&e instanceof A.G)if(h.ZH(T),g.ZH(T),"error"===H.type)S||ne();else if("enabled"===H.type)try{R(!0),await b.oS({environment:T,store:n,clientContext:{type:"button_block",persisted:!0,automationStore:E,blockStore:n,pageStore:e,intl:k.default.getIntl(),parentRecordStore:E,currentUserId:T.currentUser.id}})}finally{R(!1)}else"disabled"===H.type||(0,p.t1)(H)}),[n,E,T,H,S,ne]);(0,o.useImperativeHandle)(t,(()=>({activate:()=>{ie()},getBoundingClientRect:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.getBoundingClientRect()}})),[ie]);const re=()=>(0,N.jsx)("div",{style:Y.spinnerWrap,children:(0,N.jsx)(Z.Z,{})}),ae=[];var se;q&&(P?ae.push({key:"left",comp:re()}):ae.push({key:"left",comp:(se=q,(0,N.jsx)(j.Z,{largeIcon:!0,disabled:!0,isEmptyPage:!1,size:20,icon:{icon:se,pointer:n.pointer},style:{marginLeft:O?-4:0}}))})),O?ae.push({key:"name",comp:(0,N.jsx)("div",{style:Y.label,children:O})}):q||ae.push({key:"placeholder",comp:(0,N.jsx)("div",{style:Y.labelPlaceholder,children:(0,N.jsx)(f.FormattedMessage,{...W.buttonPlaceholder})})}),!q&&P&&ae.push({key:"right",comp:re()}),G&&ae.push({key:"error",comp:(0,N.jsx)("div",{children:(0,d.t)(Y.warningIcon)})});const le=e=>(0,N.jsx)(V.Z,{disabled:K,disabledFeedback:!0,style:Y.button,ref:X,...(0,I.Z)(e??{},{onClick:ie}),children:ae.map((e=>{let{key:t,comp:n}=e;return(0,N.jsx)(o.Fragment,{children:n},t)}))});return(0,N.jsxs)("div",{style:Y.wrap,onMouseMove:ee,onMouseLeave:te,children:[H.tooltip?(0,N.jsx)(U.ZP,{renderTooltip:()=>(0,N.jsx)(y.So,{content:(0,N.jsx)(f.FormattedMessage,{...H.tooltip}),subtitle:"error"!==H.type||S?null:(0,N.jsx)(f.FormattedMessage,{...W.clickToEdit})}),delayThreshold:0,render:le,placement:U.ug.Bottom}):le(),!S&&(T.device.isMobile||B)&&(0,N.jsxs)("div",{style:Y.configureWrap,children:[(0,N.jsx)(U.ZP,{renderTooltip:()=>(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Edit button",id:"buttonBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,N.jsx)(F.Z,{ariaLabel:x.formatMessage(W.editButtonAriaLabel),icon:$?()=>(0,N.jsx)(z,{}):c.H,onClick:oe,...e})}),T.device.isMobile&&(0,N.jsx)(D.Z,{tooltipContent:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"buttonBlock.moreActions.button.label"}),store:n,fadeIn:!1})]})]})}));const K=q},38376:(e,t,n)=>{n.d(t,{Z:()=>k});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(8848),c=n(15157),d=n(62965),u=n(9291),p=n(41433),m=n(9953),f=n(82530),g=n(73819),h=n(23864),v=n(31278),b=n(55217),y=n(65187),_=n(85893);const S=(0,u.defineMessages)({inputPlaceholder:{defaultMessage:"Type somethingâ€¦",id:"calloutBlock.inputPlaceholder"},changeIconLabel:{defaultMessage:"Change callout icon",id:"calloutBlock.changeIconLabel"},disabledIconLabel:{defaultMessage:"Callout icon",id:"calloutBlock.disabledIconLabel"}});function w(e,t){window.__c={n:"CalloutBlock"};const n=(0,i.O7)(),d=(0,u.useIntl)(),w=(0,o.useRef)(null),k=(0,g.PE)(e.store,e.disabled),I=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),x=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),C=(0,r.VK)((()=>e.store.getFormat().block_color||"default"),[e.store]),T=(0,r.VK)((()=>e.store.getIcon()),[e.store]),M=(0,o.useCallback)((async t=>{const o=e.store.getIconStore();if(o){const{serverCommitResult:e}=f.createAndCommit({userAction:"CalloutBlock.handleEmojiChange",environment:n,perform:e=>{m.sO({store:o,value:t,transaction:e}),c.Z.set({userId:n.currentUser.id,key:p.nF,value:t})}});await e}}),[n,e.store]),P=(0,a.yK)((e=>({root:{display:"flex",width:"100%",borderRadius:4,border:(0,l.jS)(C)?void 0:`1px solid ${e.darkDividerColor}`,backgroundColor:"transparent",paddingLeft:12,paddingTop:16,paddingBottom:16,paddingRight:16,...(0,l.x7)(C,e)}})),[C]),A=(0,_.jsxs)("div",{role:"note",style:{display:"flex"},ref:w,children:[(0,_.jsxs)("div",{style:{...e.style,...P.root},children:[(0,_.jsx)("div",{children:k?(0,_.jsx)(v.Z,{bucket:"secure",store:e.store,isEmptyPage:!1,onChange:M,disableRemoveIcon:!0,isCallout:!0,icon:T,size:24,disabled:!1,label:d.formatMessage(S.changeIconLabel)}):(0,_.jsx)(v.Z,{icon:T,isEmptyPage:!1,size:24,disabled:!0,label:d.formatMessage(S.disabledIconLabel)})}),(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,marginLeft:8,width:"100%"},children:[(0,_.jsx)(y.Z,{style:{paddingLeft:s.ZD.paddingLeft,paddingRight:s.ZD.paddingRight},disabled:e.disabled,store:I,placeholder:d.formatMessage(S.inputPlaceholder),pasteBehavior:"block"}),!e.hideContent&&(0,_.jsx)(b.Z,{disabled:e.disabled,store:x,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})]})]}),(0,_.jsx)(h.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]});return(0,g.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"callout",getNode:()=>w.current,getBlockStore:()=>e.store})),[e.store]),A)}const k=o.memo(o.forwardRef(w),d.Z)},28385:(e,t,n)=>{n.d(t,{Z:()=>Z});var o=n(67294),i=n(83355),r=n(1302),a=n(13991),s=n(15095),l=n(72126),c=n(62193),d=n(20852),u=n(6746),p=n(70203),m=n(44805),f=n(82990),g=n(893),h=n(993),v=n(98724),b=n(56971),y=n(74284),_=n(82530),S=n(48514),w=n(14976),k=n(62619),I=n(68056),x=n(67669),C=n(55227),T=n(89086),M=n(66638),P=n(77907),A=n(52689),R=n(24666),D=n(29595),B=n(93262),E=n(85893);class F extends i.Z{constructor(){super(...arguments),this.editor=null,this.mergeEditorRefs=(0,c.sH)(),this.renderContentContainer=(e,t,n)=>{let{leafRef:o,wrapperRef:i,...r}=e;return(0,E.jsx)("div",{ref:i,style:{display:"flex",...!this.props.codeWrap&&{overflowX:"auto",WebkitOverflowScrolling:"touch"}},className:"line-numbers notion-code-block",...r,children:(0,E.jsx)(D.Z,{ref:this.mergeEditorRefs(this.editorRef,o),style:{...(s=this.theme,l=this.props.style,{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:f.Z.getCompositeFontFamily(a.SP).githubMono,fontSize:"85%",tabSize:2,padding:"34px 16px 32px 32px",minHeight:"1em",color:s.regularTextColor,...l}),...this.props.isQuickFind&&{paddingTop:12},...this.props.codeWrap?{whiteSpace:"pre-wrap",wordBreak:"break-all",minWidth:0}:{whiteSpace:"pre"}},getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:e=>function(e,t,n,o){const{newValue:i}=e;j("typing_lag",t,n,o),_.createAndCommit({userAction:"CodeBlockValue.handleMutation",environment:o,perform:e=>{h.aS({environment:o,store:n,newValue:i,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e})}})}(e,this.props.blockStore,this.props.store,this.environment),spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!1,placeholder:" ",disableContentEditableWhenNotEditingTextOnMobile:!0})});var s,l},this.handleClick=e=>{w.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.handleDelete=e=>{if(!this.canEdit())return;j("typing_delete",this.props.blockStore,this.props.store,this.environment);const{store:t}=this.props,n=R.default.state;"editing"===n.mode&&n.multiSelection.start.store===t&&_.createAndCommit({userAction:"CodeBlockValue.handleDelete",environment:this.environment,perform:t=>{b.as({environment:this.environment,multiSelection:n.multiSelection,deleteForwards:!0,transaction:t,event:e})}})},this.handleBackspace=e=>{if(!this.canEdit())return;j("typing_backspace",this.props.blockStore,this.props.store,this.environment);const{store:t}=this.props,n=R.default.state;if("editing"===n.mode&&n.multiSelection.start.store===t){if(b.YV({device:this.environment.device,event:e,multiSelection:n.multiSelection}))return;_.createAndCommit({userAction:"CodeBlockValue.handleBackspace",environment:this.environment,perform:t=>{b.as({environment:this.environment,multiSelection:n.multiSelection,deleteForwards:!1,transaction:t,event:e})}})}},this.handleEnter=e=>{var t;if(!this.canEdit())return;if(j("typing_enter",this.props.blockStore,this.props.store,this.environment),null===(t=e.preventDefault)||void 0===t||t.call(e),this.editor&&this.editor.isComposing)return;const n=R.default.state,o="editing"===n.mode&&(0,I.QY)(n.multiSelection);o&&_.createAndCommit({userAction:"CodeBlockValue.handleEnter",environment:this.environment,perform:e=>{h.hJ({environment:this.environment,store:this.props.store,string:"\n",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})},this.handleShiftEnter=e=>{var t;if(!this.canEdit())return;j("typing_enter",this.props.blockStore,this.props.store,this.environment),null===(t=e.preventDefault)||void 0===t||t.call(e);const n=R.default.state;"editing"===n.mode&&(_.createAndCommit({userAction:"CodeBlockValue.handleShiftEnter",environment:this.environment,perform:e=>{y.IO({environment:this.environment,multiSelection:n.multiSelection,transaction:e})}}),V())},this.handleTab=e=>{if(!this.canEdit())return;j("typing_tab",this.props.blockStore,this.props.store,this.environment),e.preventDefault();const t=R.default.state,n="editing"===t.mode&&(0,I.QY)(t.multiSelection);n&&_.createAndCommit({userAction:"CodeBlockValue.handleTab",environment:this.environment,perform:e=>{h.wA({environment:this.environment,store:this.props.store,selection:n.selection,transaction:e,shouldStripTokens:!0})}})},this.handleUntab=e=>{if(!this.canEdit())return;j("typing_untab",this.props.blockStore,this.props.store,this.environment),e.preventDefault();const t=R.default.state,n="editing"===t.mode&&(0,I.QY)(t.multiSelection);n&&_.createAndCommit({userAction:"CodeBlockValue.handleUntab",environment:this.environment,perform:e=>{h.O5({environment:this.environment,store:this.props.store,selection:n.selection,transaction:e,shouldStripTokens:!0})}})},this.handleAnnotation=(e,t)=>{this.canEdit()&&(t.preventDefault(),v.aS({environment:this.environment,annotation:e}),V())},this.handleCut=e=>{const{markdownLinkifyIt:t}=this.props;this.canEdit()?g.by({environment:this.environment,event:e,markdownLinkifyIt:t}):e.preventDefault()},this.handlePaste=e=>{const{markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:n}=this.props;this.canEdit()?_.createAndCommit({userAction:"CodeBlockValue.handlePaste",environment:this.environment,perform:o=>{g.v({environment:this.environment,event:e,disableEmbedMenu:!0,transaction:o,onPasteFiles:g.AL,markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:n})}}):e.preventDefault()},this.handleMouseOver=e=>{w.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.handleMouseOut=e=>{w.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.getDisabled=()=>!this.canEdit(),this.getHtml=()=>{const{store:e,Prism:t}=this.props,n=this.getTextValue(),i=p.QaF(n),r=t.languages[this.props.language];if(this.props.language!==d.PrismLanguages.html&&this.props.language!==d.PrismLanguages.markup||(t.languages.markup.tag.addInlined("style","css"),t.languages.markup.tag.addInlined("script","javascript")),i&&r&&i.length<1e4){const a=document.createElement("div"),s=t.highlight(i,r,this.props.language);a.innerHTML=C.g7(s);const c=Array.from(a.childNodes).map(U),d=function(e){let{syntaxTokens:t,textValue:n,parentSpaceId:o,store:i,theme:r}=e;const a=m.Mw(n&&{value:n,spaceId:o},i.getRecordModel),s=C.kF(a,t),l=a.map(p.hDy).map((e=>m.fn({annotations:e,theme:r,spaceId:o,getRecordModel:i.getRecordModel})));return s.map(((e,t)=>(0,E.jsx)("span",{className:[e.classNames||"",...l[e.textTokenIndex].classNames].join(" "),style:l[e.textTokenIndex].style,"data-token-index":e.textTokenIndex,children:e.value},t)))}({parentSpaceId:this.props.parentSpaceId,store:e,syntaxTokens:l.oA(c),textValue:n,theme:this.theme}),f=(0,E.jsxs)(o.Fragment,{children:[d,(0,E.jsx)("span",{children:"\n"})]});return u.Z.renderToStaticMarkup(f)}{const t=w.IY({environment:this.environment,textValue:n&&{value:n,spaceId:this.props.parentSpaceId},parentStore:e,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!0,disabled:!this.canEdit(),theme:this.theme,emojiType:"raw",katex:void 0,formulaValueTypes:[]});return u.Z.renderToStaticMarkup((0,E.jsx)(E.Fragment,{children:t}))}},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.isEditing=this.createComputedStore((()=>{var e;const t=R.default.state;return"editing"===t.mode&&(null===(e=(0,I.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{var e;const t=S.Z.state;return t.open&&"inline"===t.type&&(null===(e=(0,I.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.getContainerSelection=()=>{if(this.isEditing.state)return(0,T.HE)(this.props.store)},this.getEndSelection=()=>{const e=s.p4(p.QaF(this.getTextValue()));return{startIndex:e.length,endIndex:e.length}},this.editorRef=e=>{this.editor=e}}renderComponent(){const{disabled:e}=this.props;return(0,E.jsx)(B.Z,{store:this.props.store,disabled:e,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,onClick:this.handleClick,onDelete:this.handleDelete,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:l.yR,onCommandShiftEnter:l.yR,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:e=>this.handleAnnotation(["h",A.Z.state.color],e),onToggleBold:e=>this.handleAnnotation(["b"],e),onToggleItalics:e=>this.handleAnnotation(["i"],e),onToggleUnderline:e=>this.handleAnnotation(["_"],e),onToggleStrike:e=>this.handleAnnotation(["s"],e),onToggleCode:l.yR,onCopy:e=>function(e,t,n){g.JG({environment:n,event:e,markdownLinkifyIt:t})}(e,this.props.markdownLinkifyIt,this.environment),onCut:this.handleCut,onPaste:this.handlePaste,onMoveUp:e=>{return t=this.environment,void _.createAndCommit({userAction:"CodeBlockValue.handleMoveUp",environment:t,perform:e=>{h.fs({environment:t,transaction:e,direction:"up"})}});var t},onMoveDown:e=>{return t=this.environment,void _.createAndCommit({userAction:"CodeBlockValue.handleMoveDown",environment:t,perform:e=>{h.fs({environment:t,transaction:e,direction:"down"})}});var t},render:this.renderContentContainer,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!0,canInsertText:!0,canSelectionDrag:!0,topBottomPadding:40,pasteBehavior:"inline"})}canEdit(){const{disabled:e,store:t}=this.props,n=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,x.YF)(n)&&Boolean(!e&&t.canEdit())}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}getTextValue(){return this.isNewDiscussionMenuTarget.state?w.Gj({store:this.props.store}):this.props.store.getValue()}}function Z(e){window.__c={n:"CodeBlockValueWithDeps"};const{value:t}=(0,P.useDependency)(P.deps.prismjs),{value:n}=(0,P.useDependency)(P.deps.markdownLinkifyIt),{value:o}=(0,P.useDependency)(P.deps.tinyMceMicrosoftWordPasteFilter);return t?(0,E.jsx)(F,{...e,Prism:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}function V(){r.default.flush()}function j(e,t,n,o){(0,M.u)({type:e,environment:o,blockStore:t,store:n,isInCollectionView:!1})}function U(e){return k.Gs(e)?[e.data]:k.kK(e)?[e.textContent||"",e.className]:void 0}F.displayName="CodeBlockValue"},53223:(e,t,n)=>{n.d(t,{DZ:()=>o.LazyCollectionViewBlock,kE:()=>o.LazyCollectionViewSettingsButton,wA:()=>i});var o=n(77907);function i(e){return"isCollectionViewBlock"in e&&"boolean"==typeof e.isCollectionViewBlock&&e.isCollectionViewBlock}},1136:(e,t,n)=>{n.d(t,{F:()=>c});n(67294);var o=n(480),i=n(24405),r=n(62760),a=n(79362),s=n(52821),l=n(85893);function c(e){window.__c={n:"CollectionViewIcon"};const{device:t}=(0,o.O7)(),n=(0,i.Fg)(),{color:c,viewIcon:d,viewType:u,size:p,style:m}=e,f=(e=>({regular:e.regularTextColor,light:e.mediumTextColor,gray:a.Lr[e.mode].gray,lightGray:e.lightTextColor}))(n)[c];return u?d?(0,l.jsx)(r.Z,{style:{fill:f,backfaceVisibility:void 0,...m},size:p??(t.isMobile?18:16),theme:n,icon:d}):s.aW[u]({width:p??(t.isMobile?18:16),height:p??(t.isMobile?18:16),backfaceVisibility:void 0,fill:f,...m}):null}},27627:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(67294),i=n(73935),r=n(480),a=n(86628),s=n(15145),l=n(62965),c=n(35683),d=n(50906),u=n(75754),p=n(993),m=n(32741),f=n(66213),g=n(14976),h=n(84210),v=n(73819),b=n(77080),y=n(46735),_=n(22294),S=n(72014),w=n(68709),k=n(24813),I=n(85893);function x(e,t){window.__c={n:"CollectionViewPageBlock"};const n=(0,r.O7)(),l=(0,o.useContext)(f.ZO),x=(0,o.useRef)(null),C=(0,o.useRef)(null),T=(0,v.PE)(e.store,e.disabled),M=(0,v.rv)(e.store),P=(0,o.useCallback)((()=>{y.Z.recordVisit({id:e.store.id,systemBlockType:e.store.getSystemBlockTypeStore().getValue(),type:c.vu.Link,currentUserId:n.currentUser.id}),d.SK1(n,{page_visit_id:S.$g.getCurrentPageVisitId(),mentioned_page_id:e.store.id,source_type:"collection_view_page_block",hover_preview_enabled:b.default.checkGate("first_party_links"),is_navigable_block:e.store.isNavigableBlock()})}),[n,e.store]),A=(0,o.useCallback)((()=>{if(!C||!C.current)return;const t=i.findDOMNode(C.current);return(0,g.We)(e.store,t)}),[e.store]),R=(0,o.useCallback)((t=>{const o=A(),i=e.store.getTitleStore();i&&o&&p.Nh({environment:n,event:t,interactiveToken:o,store:i,canEdit:T})}),[T,n,A,e.store]),D=(0,o.useCallback)((t=>{const o=A(),i=e.store.getTitleStore();i&&o&&p.Zl({environment:n,event:t,interactiveToken:o,store:i,canEdit:T})}),[T,n,A,e.store]),B=(0,o.useCallback)((()=>{if(l){const t=(0,h.ZP)({store:e.store,pageVisitSource:s.tY.Create});l(t)}else u._({environment:n,store:e.store,visitType:c.vu.Link,pageVisitSource:s.tY.Create})}),[n,l,e.store]);(0,o.useEffect)((()=>()=>{m.qA(e.store.getTitleStore())}),[e.store]);const E=(0,a.VK)((()=>{const t=e.store.getCollectionViewSourceCollectionStore();return null==t?void 0:t.isSyncedCollection()}),[e.store]),F=(0,a.VK)((()=>e.store.isCollectionViewAlias()||e.store.recordStoreParentDiffersFromPersistedParent()),[e.store]);return(0,v.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"collection_view_page",getNode:()=>x.current,getBlockStore:()=>e.store,activate:B,handleCreated(){B(),_.Z.setKeyboardMode(!1)}})),[B,e.store]),(0,I.jsx)(w.p,{allowSelectionWithin:!1,onMouseOver:R,onMouseOut:D,children:(0,I.jsx)(k.Z,{ref:C,store:e.store,style:{...M,...e.style},isAlias:F,disabled:Boolean(e.disabled||E),onClick:P})}))}const C=o.memo(o.forwardRef(x),l.Z)},69015:(e,t,n)=>{n.d(t,{b:()=>c,Z:()=>w});n(67294);var o=n(73935),i=n(83355),r=n(1302),a=n(72126),s=n(14976),l=n(97880);let c=function(e){return e.Inline="Inline",e.InlineWrap="InlineWrap",e.Textarea="Textarea",e}({}),d=function(e){return e.Submit="Submit",e.Newline="Newline",e}({});function u(e){const{device:t,e:n,action:o,onSubmit:i}=e;if(o===d.Submit)i&&i(n);else if(o===d.Newline){if(!t.isIOS)return;n.preventDefault&&n.preventDefault(),document.execCommand("insertLineBreak")}else(0,l.t1)(o)}var p=n(73744),m=n(89224),f=n(49085);class g extends f.default{getInitialState(){return{}}}const h=g;var v=n(24666),b=n(29595),y=n(3386),_=n(85893);class S extends i.Z{constructor(){super(...arguments),this.storeTypes={store:h},this.handleWindowMouseDown=e=>{const t=o.findDOMNode(this);t&&!t.contains(e.target)&&this.props.onBlur&&this.props.onBlur()},this.handleEsc=e=>{this.handleKeyEvent(),this.props.onCancel&&this.props.onCancel(e)},this.handleShiftEnter=e=>{const{device:t}=this.environment;t.isIOS&&!("shiftKey"in e)?u({device:t,e,action:d.Newline}):this.handleEnter(e)},this.handleEnter=e=>{const{type:t,onSubmit:n}=this.props,{device:o}=this.environment;if(this.getDisabled())return;u({device:o,e,action:function(e){const{device:t,type:n,e:o}=e;return n===c.Inline?d.Submit:n===c.InlineWrap?t.isPhone?d.Submit:"altKey"in o&&o.altKey||"shiftKey"in o&&o.shiftKey?d.Newline:d.Submit:n===c.Textarea?d.Newline:void(0,l.t1)(n)}({device:o,type:t,e}),onSubmit:n})},this.handleLeft=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onLeft&&this.props.onLeft(e))},this.handleRight=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onRight&&this.props.onRight(e))},this.handleKeyEvent=()=>{r.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.getDisabled=()=>!!this.props.disabled||!this.props.focus,this.getHtml=()=>{const e=a.YU(this.props.value+(this.props.value.length>0?"\n":""));return this.props.getHtml?this.props.getHtml(e):e},this.getSelection=()=>{const e=this.stores.store.state.selection;return e&&{type:"contain",selection:e}},this.handleMutation=e=>{let{newValue:t}=e;this.saveSerializedTextSelection(),this.props.onChange(t)},this.saveSerializedTextSelection=()=>{const{store:e}=this.stores,t=s.Ut(this.environment,m.get());t&&(a.Xy(t.selection,e.state.selection)||this.stores.store.setState({selection:t.selection}),t.forceEmitSelectionStore&&v.default.emit())}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),p.lj(window,"mousedown",this.handleWindowMouseDown)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{store:t}=this.stores;e.focus&&!t.state.selection&&(e.selectAll?t.setState({selection:{startIndex:0,endIndex:e.value.length}}):t.setState({selection:{startIndex:e.value.length,endIndex:e.value.length}}))}willUnmount(){super.willUnmount(),p.ZV(window,"mousedown",this.handleWindowMouseDown)}renderComponent(){const{type:e}=this.props;return(0,_.jsx)(y.Z,{capture:!this.getDisabled(),onDelete:this.handleKeyEvent,onBackspace:this.handleKeyEvent,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:this.handleKeyEvent,onCommandShiftEnter:this.handleKeyEvent,onUp:this.handleKeyEvent,onDown:this.handleKeyEvent,onLeft:this.handleLeft,onRight:this.handleRight,onTab:this.handleKeyEvent,onUntab:this.handleKeyEvent,onSelectAll:this.handleKeyEvent,onToggleBold:this.handleKeyEvent,onToggleItalics:this.handleKeyEvent,onToggleStrike:this.handleKeyEvent,onToggleCode:this.handleKeyEvent,onUndo:this.handleKeyEvent,onRedo:this.handleKeyEvent,onEsc:this.handleEsc,onCut:this.handleKeyEvent,onCopy:this.handleKeyEvent,onPaste:this.handleKeyEvent,onKeypress:this.handleKeyEvent,onHome:this.handleKeyEvent,onEnd:this.handleKeyEvent,onGoToBeginningOfLine:this.handleKeyEvent,onGoToEndOfLine:this.handleKeyEvent,onGoForwardOneChar:this.handleKeyEvent,onGoBackwardOneChar:this.handleKeyEvent,children:(0,_.jsx)(b.Z,{style:{...this.props.style,whiteSpace:"pre-wrap"},placeholder:this.props.placeholder,placeholderStyle:this.props.placeholderStyle,spellCheck:!1,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getSelection,onMutation:this.handleMutation,suppressNewlineEvents:e===c.Inline})})}}S.displayName="ContentEditableInput";const w=S},29595:(e,t,n)=>{n.d(t,{Z:()=>v});n(21703),n(67294);var o=n(83355),i=n(18466),r=n(1302),a=n(22491),s=n(97880),l=n(14976),c=n(46150),d=n(62619),u=n(45162),p=(n(60846),n(89224)),m=n(24666),f=n(85893);let g=!1;class h extends o.Z{constructor(e){super(e),this.root=null,this.ownNodeIsComposing=!1,this.testDiv=document.createElement("div"),this.shouldDisableContentEditableForMobile=!1,this.handleRootMount=e=>{this.root=e},this.handleTextSelectionEditingStoreForMobile=()=>{this.shouldDisableContentEditableForMobile=!m.default.isEditingStore.state,this.root&&this.updateContentEditableAttribute(this.root)},this.handleCompositionStart=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!0,this.props.onCompositionStart&&this.props.onCompositionStart())},this.handleCompositionEnd=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!1,this.handleInput(),this.props.onCompositionEnd&&this.props.onCompositionEnd())},this.handleBeforeInput=e=>{const{suppressNewlineEvents:t}=this.props;if(!d.kA(e))throw new Error("Invalid event");var n;if(t&&("insertLineBreak"!==e.inputType&&"insertParagraph"!==e.inputType||e.preventDefault(),this.environment.device.isAndroid&&"insertCompositionText"===e.inputType&&null!==(n=e.data)&&void 0!==n&&n.endsWith("\n")&&e.target===this.root)){var o;g;const e=()=>{var t;this.delegateMutation({insertedLine:!0,deletedLine:!1,newValue:this.getText(),multiSelection:void 0,isComposing:this.isComposing}),null===(t=this.root)||void 0===t||t.removeEventListener("input",e)};null===(o=this.root)||void 0===o||o.addEventListener("input",e)}},this.handleSelect=e=>{this.delegateSelection("contain")},this.handleClick=e=>{var t,n;3===e.nativeEvent.detail&&(l.TQ(this.environment.device),this.delegateSelection("contain")),null===(t=(n=this.props).onClick)||void 0===t||t.call(n,e)},this.handleInput=this.handleInput.bind(this)}get isComposing(){var e;return Boolean(this.ownNodeIsComposing||(null===(e=this.contentEditableContext)||void 0===e?void 0:e.isComposing()))}get registries(){var e;return[null===(e=this.contentEditableContext)||void 0===e?void 0:e.contentEditableLeafRegistry]}getText(){return l.n$(this.environment,this.root)}delegateSelection(e){var t,n;this.isComposing||(null===(t=(n=this.props).onSelect)||void 0===t||t.call(n,{endpoint:e,component:this}))}delegateMutation(e){this.handleMutation(e)}delegateBeforeInput(e){this.handleBeforeInput(e)}delegateKeyDown(e){var t,n;null===(t=(n=this.props).onKeyDown)||void 0===t||t.call(n,e)}delegateCompositionEnd(e){var t,n;null===(t=(n=this.props).onCompositionEnd)||void 0===t||t.call(n)}getNode(){return this.root}UNSAFE_willMount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&(this.shouldDisableContentEditableForMobile=i.Z.withListenerIgnored((()=>!m.default.isEditingStore.state)),m.default.isEditingStore.addListener(this.handleTextSelectionEditingStoreForMobile))}UNSAFE_willMountOrUpdate(e){this.selection=e.getSelection(),this.disabled=e.getDisabled(),this.html=e.getHtml()}didMount(){this.updateContainer(!0),this.root&&d.OW&&this.root.addEventListener("beforeinput",this.handleBeforeInput)}didUpdate(){this.updateContainer(!1)}willUnmount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&m.default.isEditingStore.removeListener(this.handleTextSelectionEditingStoreForMobile),this.root&&d.OW&&this.root.removeEventListener("beforeinput",this.handleBeforeInput)}updateContentEditableAttribute(e){const t=e.getAttribute("contenteditable");this.disabled||this.shouldDisableContentEditableForMobile?"false"!==t&&this.mutateDOM((function(){e.contentEditable="false"})):"true"!==t&&this.mutateDOM((function(){e.contentEditable="true"}))}updateContainer(e){var t;const{device:n}=this.environment;if(null===(t=this.contentEditableContext)||void 0===t||t.contentEditableLeafRegistry.register(this),this.root&&(this.updateContentEditableAttribute(this.root),!this.isComposing)){if(e)this.root.innerHTML=this.html;else{this.previousHtml!==this.html&&(this.previousHtml=this.html,this.testDiv.innerHTML=this.html);const e=this.root.innerHTML,t=this.testDiv.innerHTML;e!==t&&(this.root.innerHTML=this.html)}if(this.disabled)return;if(p.isMouseSelecting())return;if(p.isMouseRightClicking())return void p.resetMouseRightClicking();if(this.selection)switch(this.selection.type){case"start":case"end":{var o;null===(o=this.contentEditableContext)||void 0===o||o.tryEnableMultiSelection();const e=l.bD(this.root,this.selection.index),t={endpoint:this.selection.type,onlyIfEqual:this.contentEditableContext,position:e};p.setDOMEndpoint(t,this.environment.device),this.updateSelectionEndpoint(t);break}case"contain":{const e=l.lw(this.root,this.selection.selection.startIndex,this.selection.selection.endIndex),t=p.get();l.Dn(t,e)||(n.isAndroid&&document.activeElement!==this.root&&this.root.focus(),p.set(e,n));break}default:(0,s.t1)(this.selection)}else if(!e){const e=p.get(),t=!n.isAndroid||i.Z.withListenerIgnored((()=>"empty"===m.default.state.mode));e&&e.commonAncestorContainer&&d.UG(e.commonAncestorContainer)&&this.root.contains(e.commonAncestorContainer)&&t&&p.clear(this.environment)}}}updateSelectionEndpoint(e){const t=p.get(),n=p.getIncompleteDOMEndpoint();if(t&&n===e)switch(e.endpoint){case"start":return void p.setDOMEndpoint({endpoint:"end",onlyIfEqual:this.contentEditableContext,position:{container:t.endContainer,offset:t.endOffset}},this.environment.device);case"end":return void p.setDOMEndpoint({endpoint:"start",onlyIfEqual:this.contentEditableContext,position:{container:t.startContainer,offset:t.startOffset}},this.environment.device);default:(0,s.t1)(e.endpoint)}}renderComponent(){const{onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:i,placeholder:r,onBlur:s,onFocus:l,onMouseOver:d,onMouseOut:p}=this.props,m=Boolean(!this.html),g=(!(0,u.ri)(this.environment.device)||!(0,u.Aw)(this.environment))&&this.props.spellCheck,h=this.props.tagName??"div";return(0,f.jsx)(h,{id:this.props.id,ref:this.handleRootMount,...(0,a.iv)(this.props.className,m&&this.props.placeholderStyle?this.props.placeholderStyle:this.props.style,!this.disabled&&"notranslate"),onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onInput:this.handleInput,spellCheck:g,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,onSelect:this.handleSelect,onClick:this.handleClick,onBlur:s,onFocus:l,onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:i,onMouseOver:d,onMouseOut:p,placeholder:r,...c.GF})}handleMutation(e){this.props.onMutation&&this.props.onMutation(e),r.default.flush()}handleInput(){this.handleMutation({newValue:this.getText(),insertedLine:!1,isComposing:this.isComposing})}}h.displayName="ContentEditableLeaf";const v=h},15201:(e,t,n)=>{n.d(t,{O:()=>O});n(57658),n(21703);var o=n(27537),i=n.n(o),r=n(67294),a=n(60177),s=n(64338),l=n(480),c=n(86628),d=n(24405),u=n(41432),p=n(22491),m=n(72126),f=n(44805),g=n(97880),h=n(62134),v=n(98104),b=n(95477),y=n(14976),_=n(46150),S=n(62619),w=n(89224);const k=["initial","keyDown","compositionStart","beforeInput","compositionUpdate","domMutations","input","compositionEnd","keyUp"],I={keyDown:"keyUp",beforeInput:"input",input:"domMutations",domMutations:"input",compositionStart:"compositionEnd"},x={compositionUpdate:"beforeInput"};class C{constructor(){this.flowData=new Map,this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.listeners=new Set,this.handleSelectionChange=()=>{this.nextFlow.beforeRange=w.toStaticRange(w.get())},this.handleKeyDown=e=>{this.advanceToPhase("keyDown").keyDown=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionStart=e=>{this.advanceToPhase("compositionStart").compositionStart=e,this.emitUpdate(),this.endIfComplete()},this.handleBeforeInput=e=>{var t;if(!(0,S.kA)(e))return;const n=(null===(t=e.getTargetRanges)||void 0===t?void 0:t.call(e))||[];this.advanceToPhase("beforeInput").beforeInput={event:e,targetRanges:n},this.emitUpdate(),this.endIfComplete()},this.handleCompositionUpdate=e=>{this.advanceToPhase("compositionUpdate").compositionUpdate=e,this.emitUpdate()},this.handleInput=e=>{this.advanceToPhase("input").input=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionEnd=e=>{this.advanceToPhase("compositionEnd").compositionEnd=e,this.emitUpdate(),this.endIfComplete()},this.handleKeyUp=e=>{this.advanceToPhase("keyUp").keyUp=e,this.emitUpdate(),this.endFlow()},this.handleMutations=e=>{let{currentFlow:t}=this;t&&!t.domMutations||(t=this.advanceToPhase("initial")),t.domMutations={afterPhase:t.phase,mutations:e},this.emitUpdate(),this.endIfComplete()}}attachEventListeners(e){const{div:t,document:n}=e;return n.addEventListener("selectionchange",this.handleSelectionChange),t.addEventListener("input",this.handleInput),t.addEventListener("keydown",this.handleKeyDown),t.addEventListener("keyup",this.handleKeyUp),t.addEventListener("beforeinput",this.handleBeforeInput),t.addEventListener("compositionstart",this.handleCompositionStart),t.addEventListener("compositionupdate",this.handleCompositionUpdate),t.addEventListener("compositionend",this.handleCompositionEnd),()=>{n.removeEventListener("selectionchange",this.handleSelectionChange),t.removeEventListener("input",this.handleInput),t.removeEventListener("keydown",this.handleKeyDown),t.removeEventListener("keyup",this.handleKeyUp),t.removeEventListener("beforeinput",this.handleBeforeInput),t.removeEventListener("compositionstart",this.handleCompositionStart),t.removeEventListener("compositionupdate",this.handleCompositionUpdate),t.removeEventListener("compositionend",this.handleCompositionEnd)}}onInputFlowChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}isComposing(){var e;return this.currentFlow&&!this.currentFlow.isPhase("initial")?this.currentFlow.isComposing():(null===(e=this.previousFlow)||void 0===e?void 0:e.isComposing())||!1}reset(){this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.flowData=new Map}getCurrentFlow(){const e=this.currentFlow;if(!e)return;return{flow:e,data:this.getData(e)}}getData(e){const t=this.flowData.get(e);if(t)return t;const n={};return this.flowData.set(e,n),n}endIfComplete(){const{currentFlow:e}=this;e&&e.isComplete()&&this.endFlow()}emitUpdate(){const{currentFlow:e}=this;if(e){const t={type:"update",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(t)))}}endFlow(){const{currentFlow:e}=this;if(e){const t=this.previousFlow;this.previousFlow=e,this.currentFlow=void 0;const n={type:"end",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(n))),t&&this.flowData.delete(t)}}advanceToPhase(e){return this.currentFlow&&this.currentFlow.canTransitionToPhase(e)||(this.endFlow(),this.currentFlow=this.nextFlow,this.nextFlow=new T),this.currentFlow.phase=e,this.currentFlow}}class T{constructor(){this.phase="initial",this.beforeRange=w.toStaticRange(w.get()),this.initial=void 0,this.keyDown=void 0,this.compositionStart=void 0,this.beforeInput=void 0,this.compositionUpdate=void 0,this.input=void 0,this.compositionEnd=void 0,this.domMutations=void 0,this.keyUp=void 0}isPhase(e){return this.phase===e}hasEvents(){return Boolean(this.compositionStart||this.compositionEnd||this.compositionUpdate||this.keyDown||this.keyUp||this.beforeInput||this.input)}isComposing(){var e,t;switch(this.phase){case"compositionStart":case"compositionUpdate":return!0;case"compositionEnd":return!1;case"beforeInput":return Boolean(null===(e=this.beforeInput)||void 0===e?void 0:e.event.isComposing);case"input":case"keyDown":case"keyUp":return Boolean(null===(t=this[this.phase])||void 0===t?void 0:t.isComposing);case"initial":return!1;default:(0,g.t1)(this.phase)}}transitionToPhase(e,t){return!!this.canTransitionToPhase(e)&&(this.phase=e,this[e]=t,!0)}canTransitionToPhase(e){return!this[e]&&(x[this.phase]===e||1===function(e,t){const n=k.indexOf(e),o=k.indexOf(t),i=n-o;if(i<0)return-1;if(i>0)return 1;return 0}(e,this.phase))}isComplete(){for(const[e,t]of(0,g.qP)(I))if(this[e]&&!this[t])return!1;return!0}getTargetRanges(){var e;const t=null===(e=this.beforeInput)||void 0===e?void 0:e.targetRanges;return null!=t&&t.length?t:this.beforeRange?[this.beforeRange]:[]}}var M=n(68056),P=n(45162),A=n(55010),R=n(35431),D=n(59730);let B,E;B=Symbol.iterator;class F{constructor(e){if(this.leftToRight=new Map,this.rightToLeft=new Map,e)for(const[t,n]of e)this.assoc(t,n)}assoc(e,t){const n=[];if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);n.push((()=>this.rightToLeft.delete(t)))}if(this.rightToLeft.has(t)){const e=this.rightToLeft.get(t);n.push((()=>this.leftToRight.delete(e)))}for(const o of n)o();return this.leftToRight.set(e,t),this.rightToLeft.set(t,e),this}getLeft(e){return this.leftToRight.get(e)}getRight(e){return this.rightToLeft.get(e)}hasLeft(e){return this.leftToRight.has(e)}hasRight(e){return this.rightToLeft.has(e)}deleteLeft(e){if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);return this.leftToRight.delete(e),this.rightToLeft.delete(t),!0}return!1}deleteRight(e){if(this.rightToLeft.has(e)){const t=this.rightToLeft.get(e);return this.leftToRight.delete(t),this.rightToLeft.delete(e),!0}return!1}*[B](){for(const[e,t]of this.leftToRight)yield[e,t]}}E=Symbol.iterator;class Z{constructor(e,t,n){if(this.leftName=void 0,this.rightName=void 0,this.biMap=void 0,e===t)throw new D.D3("NamedBiMap left and right names are equal",{data:{name:e}});if(this.leftName=e,this.rightName=t,this.biMap=new F,n)for(const[o,i]of n)this.biMap.assoc(o,i)}assoc(e){const t=e[this.leftName],n=e[this.rightName];return this.biMap.assoc(t,n),this}get(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.getLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.getRight(t)}throw new D.D3("NamedBiMap.get fallthrough should never occur",{data:e})}delete(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.deleteLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.deleteRight(t)}throw new D.D3("NamedBiMap.delete fallthrough should never occur",{data:e})}has(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.hasLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.hasRight(t)}throw new D.D3("NamedBiMap.has fallthrough should never occur",{data:e})}[E](){return this.biMap[Symbol.iterator]()}}class V extends R.Z{constructor(){super(...arguments),this.nodeMap=new Z("node","component",new F)}register(e){const t=super.register(e),n=e.getNode();return n?this.nodeMap.assoc({node:n,component:e}):this.nodeMap.delete({component:e}),t}unregister(e){super.unregister(e),this.nodeMap.delete({component:e})}getByDOMOrder(){const e=Array.from(this.nodeMap.biMap.rightToLeft.entries());return e.sort(((e,t)=>{const n=e[1],o=t[1];return(0,A.Z)(n,o)})),e.map((e=>{let[t,n]=e;return{node:n,leaf:t}}))}getParentContentEditableLeaf(e){const t=(0,_.X1)(e),n=t&&this.nodeMap.get({node:t});if(t&&n)return{node:t,leaf:n}}}var j=n(26136),U=n(24666),L=n(85893);function O(e){window.__c={n:"ContentEditableRoot"};const{children:t,style:n,displayName:o,shouldSelectOnEnter:S}=e,k=!e.disabled,I=(0,r.useRef)(null),x=(0,r.useRef)(0),[T,A]=(0,r.useState)(null),R=(0,r.useRef)(!1),D=(0,r.useRef)(!1),[B]=(0,r.useState)((()=>function(e){return`${e}-${q++}`}(o))),E=(0,r.useRef)(void 0),F=(0,r.useRef)({displayName:B}),[Z]=(0,r.useState)((()=>new C)),[O]=(0,r.useState)((()=>new V)),[H]=(0,r.useState)((()=>new s.T7({onMutations(e){Z.handleMutations(e)},enableLogging:!1}))),K=(0,r.useRef)(!1),G=(0,r.useCallback)((e=>{K.current!==e&&(K.current=e,H.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(_.HM,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(_.HM)})))}),[H]),$=(0,r.useRef)(!1),Q=(0,r.useCallback)((e=>{$.current!==e&&($.current=e,H.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(_._F,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(_._F)})))}),[H]),Y=(0,r.useCallback)((e=>{I.current=e,H.setNode(e),A(e)}),[H]),J=(0,l.O7)(),X=(0,c.VK)((()=>(0,P.Aw)(J)),[J]);(0,r.useEffect)((()=>{if(T&&X)return Z.attachEventListeners({div:T,document:window.document})}),[Z,X,T]);const{isFirefox:ee,isAndroid:te}=J.device;(0,r.useEffect)((()=>{const e=e=>{var t;const n=w.get(),o=(0,P.Zb)({range:n,contentEditableLeafRegistry:O,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:I.current||void 0}),i=U.default.state,r="editing"===i.mode?i.multiSelection:void 0;return{leafs:o,multiSelection:te&&e.isPhase("beforeInput")&&(!r||(0,M.iG)(r))&&w.isExpanded(n)?null===(t=(0,P.fx)({range:n,contentEditableLeafRegistry:O,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection:r,range:w.toStaticRange(n)}};return Z.onInputFlowChange((t=>{Q(Z.isComposing());const{flow:n,type:o,data:r}=t;if("end"!==o){if("update"!==o||!n.isPhase("beforeInput")&&r.target||(r.target=e(n)),"update"===o&&n.domMutations&&!r.handledMutations){var a,l;r.handledMutations=!0;const t=n.domMutations.mutations,o=r.target||e(n),m=!ee||o.multiSelection&&(0,M.iG)(o.multiSelection)?null===(a=o.leafs)||void 0===a?void 0:a.start:N(O,I.current),f=null===(l=o.leafs)||void 0===l?void 0:l.start,h=null==m?void 0:m.leaf.getText();z("onMutations",r,h,n,m);const v=n.hasEvents(),y=b.default.isLocalhost||!v;let S=!1,w=!1,k=!1;for(let e=t.length-1;e>=0;e--){const n=t[e];W(n,m);const o=(0,_.xp)(n.target),i=(0,_.X1)(n.target);if(o===I.current){if((v||"attributes"!==n.type||"style"!==n.attributeName)&&("attributes"!==n.type||"dir"!==n.attributeName))if(m){if("childList"===n.type){const e=Array.from(n.removedNodes);w||=e.some(_.eD)||e.some(_.C7);const t=Array.from(n.addedNodes);k||=t.some(_.eD)}if(i&&i===m.node){switch(n.type){case"attributes":(0,s.AJ)(n,y);continue;case"characterData":case"childList":break;default:(0,g.t1)(n.type)}S=!0}else(0,s.AJ)(n,y)}else(0,s.AJ)(n,y)}else z("allowed mutation on interior region",o,n)}if(f&&(S||w)){var c,d,u,p;if("string"!=typeof h)throw new Error("focusedLeafText must be string");const e=null===(c=n.beforeInput)||void 0===c?void 0:c.event,t=null===(d=n.keyDown)||void 0===d?void 0:d.keyCode,o="enter"!==(void 0!==t&&i()(t))&&("insertLineBreak"===(null==e?void 0:e.inputType)||"insertParagraph"===(null==e?void 0:e.inputType)||"insertCompositionText"===(null==e?void 0:e.inputType)&&(null==e||null===(u=e.data)||void 0===u?void 0:u.endsWith("\n"))||k),a={multiSelection:null===(p=r.target)||void 0===p?void 0:p.multiSelection,newValue:h,deletedLine:w,insertedLine:o,isComposing:Z.isComposing()};z("delegateMutation",a),f.leaf.delegateMutation(a)}}}else z("flow ended",r,n)}))}),[O,Z,te,ee,Q]),(0,r.useEffect)((()=>{const e=I.current;e&&X&&R.current&&H.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable")}))}),[k,X,H]);const ne=(0,r.useCallback)((()=>{const e=I.current;return!(!e||!X)&&(R.current?("always"===X&&G(!0),!1):(H.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable"),(0,P.ri)(J.device)&&(e.spellcheck=!1)})),H.lock(F.current),R.current=!0,G("gesture"===X),z("enableMultiSelection"),!0))}),[H,X,G,J.device,k]),oe=(0,r.useCallback)((()=>{const e=I.current;return!(!R.current||!e)&&("always"===X?(G(!1),!1):!Z.isComposing()&&(H.unlock(F.current),e.removeAttribute("contenteditable"),G(!1),z("disableMultiSelection"),R.current=!1,!0))}),[H,X,G,Z]);(0,r.useEffect)((()=>{let e=w.get();function t(){var t;const n=null===(t=w.get())||void 0===t?void 0:t.cloneRange(),o=e;e=n;const i=I.current;i&&w.isExpanded(n)&&!w.isExpanded(o)&&(0,_.xp)(n.commonAncestorContainer)===i&&(0,_.X1)(n.commonAncestorContainer)&&ne()&&(i.focus(),w.isExpanded(w.get())||w.set(n,J.device))}return document.addEventListener("selectionchange",t),()=>document.removeEventListener("selectionchange",t)}),[ne,J.device]);const ie=(0,r.useCallback)((function(){const e=w.get();if(!w.isExpanded(e)&&oe()&&e){const t=N(O,I.current,e);t&&t.node&&t.node instanceof HTMLElement&&t.node.focus(),w.set(e,J.device)}}),[O,oe,J.device]),re=(0,r.useMemo)((()=>m.Ds(ie,50)),[ie]),{KeyboardShortcutStackStore:ae}=J,se=(0,r.useRef)(),le=(0,r.useCallback)((function(e){const t=I.current;if(!t)return;if(!R.current)return;const n=w.get();if(z("onSelect (react selection)",w.toStaticRange(n)),!se.current&&n&&he.current&&n.commonAncestorContainer===he.current)w.clear(J);else if(!(se.current&&n&&w.areRangesEqual(n,se.current))){if(se.current=w.toStaticRange(n),n){const o=n.startContainer===t&&0===n.startOffset&&n.endContainer===t&&0===n.endOffset,i=he.current&&n.startContainer===he.current&&be.current&&n.endContainer===be.current,r=J.device.isIOS&&J.device.isMobileNative&&e.timeStamp-x.current>500&&function(e,t,n){if(!e.collapsed||0!==e.startOffset)return!1;const o=(0,P.Zb)({range:e,contentEditableLeafRegistry:t,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:n}),i=t.getByDOMOrder()[0];return Boolean(i&&o&&o.start.leaf===i.leaf)}(n,O,t);if(o||i||r)return z("onSelect: propagateShortcut selectAll"),void h.dJ({KeyboardShortcutStackStore:ae},new KeyboardEvent("keydown"),"selectAll")}if("contextmenu"!==e.nativeEvent.type){if(n&&(w.isExpanded(n)||"always"===X)&&(0,_.xp)(n.commonAncestorContainer)===t){if(D.current)return void(E.current=e);const t=N(O,I.current,n);t&&(z("onSelect: delegateSelection",t),t.leaf.delegateSelection("start"))}w.isExpanded(n)||re()}}}),[X,O,re,ae,J]);(0,r.useEffect)((()=>{if(X&&!k){function e(){const e=w.get(),t=I.current;if(!t||!e)return;const n=(0,P.fx)({contentEditableLeafRegistry:O,range:e,allowInvisibleEndSelection:!0});n&&(0,_.xp)(e.commonAncestorContainer)===t&&v.bc({...n,environment:J,focus:"start",readOnly:!0})}return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)}}),[J,X,k,O]);const ce=(0,r.useCallback)((()=>{D.current=!0,E.current=void 0}),[]),de=(0,r.useCallback)((e=>{const t=E.current;if(D.current=!1,E.current=void 0,x.current=e.timeStamp,t){const e=N(O,I.current);z("handleTouchEnd: delegateSelection",e),null==e||e.leaf.delegateSelection("start")}}),[O]),ue=(0,r.useCallback)((e=>{if(x.current=e.timeStamp,!R.current)return;e.target!==I.current||"Enter"!==e.key||!1!==e.ctrlKey||!1!==e.metaKey||!1!==e.altKey||!1!==e.shiftKey||S&&!S()||void 0!==w.get()||!he.current||w.setOnNode(he.current,J.device);const t=N(O,I.current);z("handleKeyDown: delegateKeyDown",t),null==t||t.leaf.delegateKeyDown(e)}),[O,J.device,S]);(0,r.useEffect)((()=>{const e=I.current;if(e)return e.addEventListener("beforeinput",t),()=>e.removeEventListener("beforeinput",t);function t(e){if(!R.current)return;const t=N(O,I.current);null==t||t.leaf.delegateBeforeInput(e)}}),[O]);const pe=(0,r.useCallback)((()=>{const e=I.current;if(!e)return;const t=function(){document.removeEventListener("selectionchange",t);const n=w.get();if(null!=n&&n.collapsed&&(0,_.xp)(n.commonAncestorContainer)===e){const e=(0,_.X1)(n.commonAncestorContainer),t=n.startContainer,o=n.startOffset;if(e&&t&&(0,y.x9)(e,t,o)){const i=e.getElementsByClassName(f.$A)[0];i&&(z("Move collapsed selection before EOL marker",{parentLeafNode:e,caretContainer:t,caretOffset:o}),n.setStartBefore(i),n.setEndBefore(i),w.set(n,J.device))}}};document.addEventListener("selectionchange",t)}),[J.device]);(0,r.useEffect)((()=>{"always"!==X||R.current||ne()}),[ne,X]);const me=(0,r.useCallback)((()=>{const e=w.get();return!w.isExpanded(e)&&oe()}),[oe]),fe=(0,r.useCallback)((()=>!te&&Boolean(Z.isComposing())),[Z,te]),ge=(0,d.yK)((e=>({div:{caretColor:e.regularTextColor,...n},whenContentEditable:{WebkitUserModify:"read-write-plaintext-only"},selectionTrap:{height:"1px",width:"1px",caretColor:"transparent"}})),[n]),he=(0,r.useRef)(null),ve=(0,L.jsx)("span",{style:ge.selectionTrap,ref:he}),be=(0,r.useRef)(null),ye=(0,L.jsx)("span",{style:ge.selectionTrap,ref:be}),_e=(0,r.useCallback)((()=>{if(!w.get()&&"editing"===U.default.state.mode){const e=U.default.state.multiSelection.start.store;if(e instanceof j.G){const t=e.getType();if(t===u.Ti.linkToPage||t===u.Ti.linkToCollection)return}v.ZH(J)}}),[J]),Se=(0,r.useCallback)((()=>{!I.current||w.get()&&"empty"!==U.default.state.mode||I.current.blur()}),[]);return(0,L.jsx)("div",{onBlur:J.device.isIOS?_e:void 0,onFocus:J.device.isIOS?Se:void 0,onTouchStart:X?ce:void 0,onTouchEnd:X?de:void 0,onTouchCancel:X?de:void 0,onKeyDown:X?ue:void 0,onCompositionEnd:X?function(e){if(!R.current)return;const t=N(O,I.current);null==t||t.leaf.delegateCompositionEnd(e)}:void 0,ref:Y,...(0,p.iv)(ge.div,{whenContentEditable:ge.whenContentEditable}),onMouseDown:pe,onSelect:le,..._.GZ,children:(0,L.jsxs)(a.c1,{id:B,tryEnableMultiSelection:ne,tryDisableMultiSelection:me,isComposing:fe,domLock:H,contentEditableLeafRegistry:O,children:[ve,t,ye]})})}function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.get();const o=(0,P.Zb)({range:n,contentEditableLeafRegistry:e,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:t||void 0});if(o)return o.start}function z(){}function W(e){const t={};if(t.type=e.type,t.target=e.target,t.targetIsText=e.target.nodeType===Node.TEXT_NODE,t.targetIsLeaf=(0,_.eD)(e.target),e.addedNodes.length){const n=Array.from(e.addedNodes);t.added=n,t.addedALeaf=n.some(_.eD),t.addedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}if(e.removedNodes.length){const n=Array.from(e.removedNodes);t.removed=n,t.removedALeaf=n.some(_.eD),t.removedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}"characterData"===e.type&&(t.newChars=e.target.textContent,t.oldChars=e.oldValue),t.mutation=e;for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i]}let q=0},68709:(e,t,n)=>{n.d(t,{p:()=>c});var o=n(67294),i=n(60177),r=n(22491),a=n(46150),s=n(85893);const l={WebkitUserSelect:"none",userSelect:"none",pseudoSelection:{background:"transparent"}},c=o.forwardRef(((e,t)=>{window.__c={n:"ContentEditableVoid"};const{allowSelectionWithin:n,style:o,className:c,...d}=e,u=(0,i.Dl)(),p=(0,s.jsx)("div",{ref:t,contentEditable:!1,...(0,r.iv)(c,!n&&l,o),...a.G0,...d});return u?(0,s.jsx)(i.c1,{void:!0,children:p}):p}));c.displayName="ContentEditableVoid"},10182:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(86658),l=n(53028),c=n(9291),d=n(50950),u=n(43250),p=n(87279),m=n(61893),f=n(31194),g=n(52275),h=n(31945),v=n(78140),b=n(32163),y=n(89728),_=n(72495),S=n(24006),w=n(64369),k=n(85893);function I(e){let{hasDismissButton:t,onDismiss:n}=e;window.__c={n:"CookieConsentMenu"};const r=(0,i.O7)(),f=(0,a.Fg)(),g=(0,c.useIntl)(),[h,S]=(0,o.useState)(!1);(0,o.useEffect)((()=>()=>{t||h&&d.qo()}),[g,h,t]);const I=[{key:"trackingTypes",render:e=>(0,k.jsx)(_.Z,{...e,topBorder:0!==e.index}),items:l.m4.map((e=>({key:e,render:t=>(0,k.jsx)(x,{menuListItemProps:t,trackingType:e,setShowReloadOnMenuClose:S,isNativeiOSApp:r.device.isMobileNative&&r.device.isIOS}),action:()=>d.Nh(r,e)})))}];return(0,k.jsxs)(v.Z,{className:u.N7t,menuType:p.og.Popup,width:260,children:[(0,k.jsx)("div",{style:{display:"flex",alignItems:"center",paddingTop:t?4:0},children:t&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(w.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",paddingLeft:14},children:(0,k.jsx)("b",{children:(0,k.jsx)(c.FormattedMessage,{...s.ze.customizeCookiesHeader})})}),(0,k.jsx)(y.Z,{style:{float:"right",marginLeft:-8,paddingLeft:8,paddingRight:8,color:f.blueColor},onClick:()=>{d.OM(r,m.Z.getPermission()),n&&n()},children:(0,k.jsx)(c.FormattedMessage,{...s.ze.cookieDismissButtonLabel})})]})}),(0,k.jsx)(b.Z,{type:b.i.Vertical,initialFocus:void 0,sections:I})]})}function x(e){window.__c={n:"TrackingTypeToggle"};const{menuListItemProps:t,trackingType:n,setShowReloadOnMenuClose:o,isNativeiOSApp:l}=e,{title:u,caption:p,subtitle:f}=(0,s.G_)(n,l),[{permission:h}]=(0,r.AF)(m.Z),v=(0,a.Fg)(),b=(0,i.O7)();return(0,k.jsx)(g.Z,{...t,title:(0,k.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,k.jsx)("div",{style:{marginRight:0},children:(0,k.jsx)(c.FormattedMessage,{...u})})}),caption:(0,k.jsxs)("div",{children:[f&&(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.errorText},children:(0,k.jsx)(c.FormattedMessage,{...f})})}),(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.mediumTextColor},children:(0,k.jsx)(c.FormattedMessage,{...p})})})]}),shouldWrapCaption:!0,right:(0,k.jsx)("div",{style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"},children:(0,k.jsx)(S.Z,{on:h[n],disabled:"necessary"===n,onClick:()=>{o(!0),d.Nh(b,n)}})})})}const C=function(e){let{renderOrigin:t,hasDismissButton:n,onDismiss:o}=e;return(0,k.jsx)(h.ZP,{popupType:h.Z4.Popup,placementToOrigin:f.Iw.Bottom,alignmentToOrigin:f.lU.Start,renderOrigin:t,render:()=>(0,k.jsx)(I,{hasDismissButton:n,onDismiss:o})})}},93262:(e,t,n)=>{n.d(t,{Z:()=>V});var o=n(67294),i=n(83355),r=n(1302),a=n(72126),s=n(70203),l=n(97880),c=n(42239),d=n(99553),u=n(52989),p=n(52423),m=n(24677),f=n(98104),g=n(84064),h=n(14976),v=n(12534),b=n(28314),y=n(98742),_=n(39500),S=n(45162),w=n(89224),k=n(89086),I=n(28685),x=n(95802),C=n(15723),T=n(55367),M=n(22294),P=n(88923),A=n(69784),R=n(27724),D=n(24666),B=n(6685),E=n(3386),F=n(85893);class Z extends i.Z{constructor(){super(...arguments),this.isSelected=!1,this.shouldEditOnClick=!0,this.shouldDisableMultiSelectionOnDragEnd=!1,this.contentEditableLeafRef=o.createRef(),this.wrapperRef=o.createRef(),this.handleDragStart=e=>{const t=this.getContextClosestSelectableStore();e.shiftKey&&!this.isEditing.state&&t?(e.preventDefault(),m.Ys({environment:this.environment,store:t,toggle:m.ji(this.environment),selectBetween:m.OS()}),this.shouldEditOnClick=!1):this.shouldEditOnClick=!0},this.handleDragMove=e=>{if(T.ZP.state.isDragging)c.td(this.environment,{currentX:e.currentX,currentY:e.currentY});else if(e.shiftKey)_.X9()&&c.f$(this.environment,{startX:e.startX,startY:e.startY,stores:R.default.state.stores,isNativeDrag:!1,getGhostElement:void 0});else if(!A.default.state.isActive){if(!this.props.canSelectionDrag)return;const n=this.getNode();if(!n)return;const o=C.jn(n.getBoundingClientRect(),20);if(C.uh(o,e.currentX,e.currentY))return;var t;if((0,S.Aw)(this.environment))return void("mouse"===e.device&&null!==(t=this.contentEditableContext)&&void 0!==t&&t.tryEnableMultiSelection()&&(this.shouldDisableMultiSelectionOnDragEnd=!0));this.shouldEditOnClick=!1,u.AI({environment:this.environment,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!1,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}},this.handleDragEnd=e=>{var t;this.shouldDisableMultiSelectionOnDragEnd&&(null===(t=this.contentEditableContext)||void 0===t||t.tryDisableMultiSelection(),this.shouldDisableMultiSelectionOnDragEnd=!1);T.ZP.state.isDragging?c.fX({environment:this.environment,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:"page_content"}):f.aJ()},this.handleClick=e=>{const{device:t}=this.environment;(0,v.ZP)({event:e,context:v.Af.EditorClick,callback:()=>{if(this.props.onClick&&this.props.onClick(e),e.defaultPrevented)return;const n=R.default.getDefaultContainerFromTarget(e.target);if(!P.default.isSidePeekOpen()||null!=n&&n.isPeekRenderer()||d.E5(this.environment),this.shouldEditOnClick){const n=this.getContextClosestSelectableStore();if(n?m.eP({environment:this.environment,store:n}):(m.Af({stores:[]}),m.$Y({environment:this.environment,phase:R.SelectionPhase.Selected,preventClearEditingText:!0})),t.isMobile&&!this.isEditing.state&&!this.isPartOfSelection.state){const t=this.getNode();if(t){let n;if(this.mutateDOM((()=>{t.classList.add("editor-force-select"),n=w.rangeFromPoint(e.clientX,e.clientY),t.classList.remove("editor-force-select")})),n){const e=j(n,this.environment);e&&(f.Z5({store:this.props.store,selection:e.selection}),e.forceEmitSelectionStore&&D.default.emit())}}}this.saveSerializedTextSelectionAfterFlush()}else this.shouldEditOnClick=!0}})},this.handleContextMenu=e=>{this.props.onContextMenu&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{var t,n;if(null===(t=(n=this.props).onContextMenu)||void 0===t||t.call(n,e),!e.defaultPrevented)return"unhandled"}}),this.isEditing.state&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{this.saveSerializedTextSelectionAfterFlush()}})},this.handleSelect=e=>{const{device:t}=this.environment;t.isMobile?this.handleMobileSelect(e):this.handleDesktopSelect(e)},this.handleMobileSelect=e=>{if(!this.props.disabled){if(!w.get())return;const t=this.getContextClosestSelectableStore();this.isEditing.state||m.eP({environment:this.environment,store:t}),this.saveSerializedTextSelection(e),r.default.flush()}},this.handleDesktopSelect=e=>{this.props.disabled||!this.isEditing.state&&"contain"===e.endpoint||this.saveSerializedTextSelection(e)},this.defaultShortcutHandlers={onEsc:e=>{if(this.props.disabled)return;if(e.preventDefault(),(0,S.Aw)(this.environment)){const e="empty"!==D.default.state.mode&&D.default.state.multiSelection,t=e&&(0,S.tp)({multiSelection:e,filterCommonAncestors:!0,focus:void 0});if(t)return void m.Z5({environment:this.environment,...t})}const t=this.getContextClosestSelectableStore();if(t){const e=x.C.findSelectableFromStore(t);e&&e.props.canSelect&&m.Z5({environment:this.environment,stores:[t]})}},onUp:e=>{var t;this.props.disabled||((0,S.Aw)(this.environment)?f.N3({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.zJ({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onDown:e=>{var t;this.props.disabled||((0,S.Aw)(this.environment)?f.FG({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.DI({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onLeft:e=>{if(!this.props.disabled){var t;if((0,S.Aw)(this.environment))return f.AL({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});f.e2({environment:this.environment,store:this.props.store,event:e})}},onRight:e=>{if(!this.props.disabled){var t;if((0,S.Aw)(this.environment))return f.D1({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});f.FC({environment:this.environment,store:this.props.store,event:e})}},onSelectAll:e=>{if(!this.props.disabled){var t;if(e.preventDefault(),(0,S.Aw)(this.environment))return f.UV({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks,contentEditableContextId:null===(t=this.contentEditableContext)||void 0===t?void 0:t.id});f.mT({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks})}},onUndo:e=>{e.preventDefault(),p.Yw(this.environment)},onRedo:e=>{e.preventDefault(),p.KX(this.environment)},onGoToBeginningOfLine:e=>{U("start",e.shiftKey)},onGoToEndOfLine:e=>{U("end",e.shiftKey)}},this.saveSerializedTextSelectionAfterFlush=()=>{r.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.isPartOfSelection=this.createComputedStore((()=>(0,k.ZZ)(this.props.store)),!1,"isPartOfSelection"),this.isEditing=this.createComputedStore((()=>(0,k.J5)(this.props.store)),!1,"isEditing")}get registries(){return[I.E]}getContentEditableLeaf(){return this.contentEditableLeafRef.current||void 0}getNode(){return this.wrapperRef.current?this.wrapperRef.current:this.contentEditableLeafRef.current?this.contentEditableLeafRef.current.getNode():super.getNode()}didMountOrUpdate(){this.isEditing.state?this.isSelected||(this.isSelected=!0,this.props.onSelected&&this.props.onSelected()):this.isSelected&&(this.isSelected=!1,function(e){e()}(this.props.clearBrowserSelection),this.props.onDeselected&&this.props.onDeselected())}willUnmount(){if(this.isSelected){this.isSelected=!1,this.props.onDeselected&&this.props.onDeselected();const e=this.isEditing.state;r.default.afterNextFlush((()=>{const t=I.E.findEditableWithStore(this.props.store),n=this.isEditing.state;e&&n&&!this.componentIsMounted&&!t&&f.ZH(this.environment)}))}}shouldComponentUpdate(e){return!0}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextClosestSelectableStore(){var e;return null===(e=this.context.selectable)||void 0===e||null===(e=e.closestSelectable)||void 0===e||null===(e=e.props)||void 0===e?void 0:e.store}renderComponent(){const{disabled:e,disableUpDownArrows:t,disableEnter:n}=this.props,o=this.isEditing.state;return(0,F.jsx)(E.Z,{capture:o&&!e,onDelete:this.getShortcutHandler("onDelete"),onDeleteToEndOfLine:this.getShortcutHandler("onDeleteToEndOfLine"),onDeleteNextWord:this.getShortcutHandler("onDeleteNextWord"),onBackspace:this.getShortcutHandler("onBackspace"),onEnter:n?void 0:this.getShortcutHandler("onEnter"),onShiftEnter:this.getShortcutHandler("onShiftEnter"),onCommandEnter:this.getShortcutHandler("onCommandEnter"),onCommandShiftEnter:this.getShortcutHandler("onCommandShiftEnter"),onUp:t?void 0:this.getShortcutHandler("onUp"),onDown:t?void 0:this.getShortcutHandler("onDown"),onLeft:this.getShortcutHandler("onLeft"),onRight:this.getShortcutHandler("onRight"),onCommandLeft:this.getShortcutHandler("onCommandLeft"),onCommandRight:this.getShortcutHandler("onCommandRight"),onTab:this.getShortcutHandler("onTab"),onUntab:this.getShortcutHandler("onUntab"),onSelectAll:this.getShortcutHandler("onSelectAll"),onToggleUnderline:this.getShortcutHandler("onToggleUnderline"),onToggleHighlight:this.getShortcutHandler("onToggleHighlight"),onToggleBold:this.getShortcutHandler("onToggleBold"),onToggleItalics:this.getShortcutHandler("onToggleItalics"),onToggleStrike:this.getShortcutHandler("onToggleStrike"),onToggleCode:this.getShortcutHandler("onToggleCode"),onUndo:this.getShortcutHandler("onUndo"),onRedo:this.getShortcutHandler("onRedo"),onEsc:this.getShortcutHandler("onEsc"),onCut:this.getShortcutHandler("onCut"),onCopy:this.getShortcutHandler("onCopy"),onPaste:this.getShortcutHandler("onPaste"),onKeypress:this.getShortcutHandler("onKeyPress"),onMoveUp:this.getShortcutHandler("onMoveUp"),onMoveDown:this.getShortcutHandler("onMoveDown"),onHome:this.saveSerializedTextSelectionAfterFlush,onEnd:this.saveSerializedTextSelectionAfterFlush,onGoToBeginningOfLine:this.getShortcutHandler("onGoToBeginningOfLine"),onGoToEndOfLine:this.getShortcutHandler("onGoToEndOfLine"),onGoForwardOneChar:this.saveSerializedTextSelectionAfterFlush,onGoBackwardOneChar:this.saveSerializedTextSelectionAfterFlush,children:this.renderDraggable()})}renderDraggable(){const e=this.isEditing.state;return(0,F.jsx)(B.Z,{disabled:this.props.disableDrag,onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:e=>{return t=this.environment,void(T.ZP.state.isDragging&&(c.cQ(t),m.ZH(t)));var t},cursor:"text",render:t=>this.props.render((0,y.Z)(t,{leafRef:this.contentEditableLeafRef,wrapperRef:this.wrapperRef,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onKeyDown:L,onDoubleClick:O}),this.handleSelect,Boolean(e)),enableAndroidContextMenu:this.props.disabled,disableHorizontalEdgeScroll:this.props.disableHorizontalEdgeScroll})}getShortcutHandler(e){const t=this.props[e],n=this.defaultShortcutHandlers[e];return t??n}saveSerializedTextSelection(e){const t=w.get();if((0,S.Aw)(this.environment)){var n;const e=(0,S.fx)({contentEditableLeafRegistry:null===(n=this.contentEditableContext)||void 0===n?void 0:n.contentEditableLeafRegistry,range:t,allowInvisibleEndSelection:(0,b.yA)().shift});return e?void f.bc({environment:this.environment,...e,readOnly:"infer",focus:void 0}):void 0}const o=j(t,this.environment);if(o){const e="empty"!==D.default.state.mode&&(0,S.xI)("Editable",D.default.state.multiSelection);if(e&&e.store===this.props.store&&a.Xy(e.selection,o.selection)&&!o.forceEmitSelectionStore)return;f.Z5({store:this.props.store,selection:o.selection,readOnly:this.props.disabled}),o.forceEmitSelectionStore&&D.default.emit()}}}Z.displayName="Editable",Z.contextTypes={...g.Tf,...i.w};const V=Z;function j(e,t){return(0,h.Ut)(t,e)}function U(e,t){const n=D.default.state;"empty"!==n.mode&&r.default.afterNextFlush((()=>{const{start:o,end:i}=n.multiSelection;switch(e){case"start":{const e=o.store.getValue();if(!e)return;const n=s.Oqk({textValue:e,substring:"\n",ignoreCase:!1}).reverse().find((e=>{let{endIndex:t}=e;return t<=o.index})),r=(null==n?void 0:n.endIndex)??0,a={store:o.store,index:r};f.NA({multiSelection:{start:a,end:t?i:a}});break}case"end":{const e=(0,k.x0)(i.store);if(!e)return;const n=o.store.getValue();if(!n)return;const r=s.Oqk({textValue:n,substring:"\n",ignoreCase:!1}).find((e=>{let{startIndex:t}=e;return t>=i.index})),a=(null==r?void 0:r.startIndex)??e.endIndex,l={store:i.store,index:a};f.NA({multiSelection:{start:t?o:l,end:l}});break}default:(0,l.t1)(e)}}))}function L(e){e.metaKey||e.ctrlKey||e.altKey||M.Z.setKeyboardMode(!0)}function O(e){(0,v.ZP)({event:e,context:v.Af.EditorDoubleClick,callback:()=>{}})}},97496:(e,t,n)=>{n.d(t,{P9:()=>sn,M1:()=>pn,ZP:()=>un,ar:()=>an});var o=n(67294),i=n(73935),r=n(18466),a=n(13991),s=n(480),l=n(53150),c=n(6740),d=n(24405),u=n(49085),p=n(41432),m=n(8848),f=n(95538),g=n(9999),h=n(82477),v=n(70622),b=n(53376),y=n(49089),_=n(42853),S=n(25654),w=n(64330),k=n(37240),I=n(95855),x=n(30845),C=n(72126),T=n(23210),M=n(70203),P=n(82990),A=n(9291),R=n(50906),D=n(57549),B=n(54564),E=n(47307),F=n(31781),Z=n(96802),V=n(27153),j=n(42858),U=n(24677),L=n(98104),O=n(82530),N=n(18821),z=n(95477),W=n(95645),q=n(28020),H=n(43250),K=n(41232),G=n(33929),$=n(98742),Q=n(17504),Y=n(65598),J=n(18245),X=n(68859),ee=n(61766),te=n(88632),ne=n(80796);class oe extends u.default{getInitialState(){return{hovered:!1,focused:!1,isInFrame:!1}}}const ie=oe;var re=n(27411),ae=n(69784),se=n(83355),le=n(12534),ce=n(96049),de=n(43593),ue=n(80750),pe=n(37250),me=n(59401),fe=n(97880),ge=n(64002),he=n(25888),ve=n(24608),be=n(18514),ye=n(16354),_e=n(64369),Se=n(85893);function we(e){switch(e){case"image":return pe.D;case"audio":case"video":return me.K;default:return ue.l}}function ke(e,t){if(e&&e instanceof ve.Gg){let n=t||e.data.url;return ge.j3(n)&&(n=ge.O_({relativeUrl:n,baseUrl:z.default.domainBaseUrl})),e.data.offline?ge.j3(e.data.url)||e.data.url.startsWith(z.default.domainBaseUrl)?{type:"offline"}:{type:"unknown",source:n}:{type:"http",source:n,statusCode:e.data.status}}}function Ie(e,t){const n=e.error,o=t||e.src;if(n)return n.code===n.MEDIA_ERR_DECODE||n.code===n.MEDIA_ERR_SRC_NOT_SUPPORTED?{type:"unsupported_content_type",extension:o&&(0,de.mD)(o)}:n.code===n.MEDIA_ERR_NETWORK?{type:"offline"}:void 0}function xe(){return(0,Se.jsx)(A.FormattedMessage,{id:"embedError.extension.unknown",defaultMessage:"unknown"})}function Ce(e){const{source:t,statusCode:n}=e,o=ge.Qc(t).hostname;return(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"{hostname} (Error {statusCode})",id:"embedError.hostnameAndStatusCode",values:{hostname:o,statusCode:n}})}function Te(e){switch(e){case"audio":return(0,be.UY)("guides.audioFaqs");case"video":return(0,be.UY)("guides.videosFaqs");case"image":return(0,be.UY)("guides.imagesFaqs");default:return(0,be.UY)("guides.embedsFaqs")}}class Me extends se.Z{didMount(){R.QUd(this.environment,{embedType:this.props.family,embedErrorType:this.props.error.type})}renderComponent(){const{style:e,error:t,family:n,isSmall:o}=this.props,i={background:this.theme.embedPlaceholderBackground,cursor:"default",...e||{},position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignContent:"center",alignItems:"center",justifyContent:o?"flex-start":"center",padding:o?"7px 14px":"0.5em 1em",textAlign:"center",flexDirection:o?"row":"column",overflow:"hidden"},r=o?25:48,a=o?"0px 14px 0 0":"0 0 14px 0",s=function(e,t){return"image"===t?"unsupported_content_type"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This image format ({extension}) can't be played on this device.",id:"embedError.image.unsupportedContentType",values:{extension:e.extension||xe()}}):"offline"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this image",id:"embedError.image.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.unknown"}):404===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be found.",id:"embedError.image.notFound"}):401===e.statusCode||403===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{id:"embedError.image.permissionDenied",defaultMessage:"Permission denied."}):(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.serverError"}):"audio"===t?"unsupported_content_type"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This audio format ({extension}) can't be played on this device.",id:"embedError.audio.unsupportedContentType",values:{extension:e.extension||xe()}}):"offline"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this audio",id:"embedError.audio.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.unknown"}):404===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be found.",id:"embedError.audio.notFound"}):401===e.statusCode||403===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{id:"embedError.audio.permissionDenied",defaultMessage:"Permission denied."}):(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.serverError"}):"video"===t?"unsupported_content_type"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This video format ({extension}) can't be played on this device.",id:"embedError.video.unsupportedContentType",values:{extension:e.extension||xe()}}):"offline"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this video",id:"embedError.video.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.unknown"}):404===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be found.",id:"embedError.video.notFound"}):401===e.statusCode||403===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{id:"embedError.video.permissionDenied",defaultMessage:"Permission denied."}):(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.serverError"}):"file"===t?"unsupported_content_type"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This file format ({extension}) can't be played on this device.",id:"embedError.file.unsupportedContentType",values:{extension:e.extension||xe()}}):"offline"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this file",id:"embedError.file.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.unknown"}):404===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be found.",id:"embedError.file.notFound"}):401===e.statusCode||403===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{id:"embedError.file.permissionDenied",defaultMessage:"Permission denied."}):(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.serverError"}):"embed"===t?"unsupported_content_type"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This embed format ({extension}) can't be played on this device.",id:"embedError.embed.unsupportedContentType",values:{extension:e.extension||xe()}}):"offline"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this embed",id:"embedError.embed.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.unknown"}):404===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be found.",id:"embedError.embed.notFound"}):401===e.statusCode||403===e.statusCode?(0,Se.jsx)(A.FormattedMessage,{id:"embedError.embed.permissionDenied",defaultMessage:"Permission denied."}):(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.serverError"}):void(0,fe.t1)(t)}(t,n);return(0,Se.jsxs)("div",{style:i,children:[we(n)({fill:this.theme.lightTextColor,width:r,height:r,margin:a}),(0,Se.jsxs)(_e.Z,{isSecondaryColor:!0,isMultiline:!o,style:{margin:a},children:[(0,Se.jsx)("div",{style:{display:o?"inline-block":"block",marginRight:o?"14px":void 0},children:s}),"offline"!==t.type&&(0,Se.jsx)(ye.Z,{style:{display:"inline",pointerEvents:"auto",cursor:"auto",borderBottom:`1px solid ${this.theme.lightTextColor}`},href:Te(n),external:!0,onClick:()=>{he.Fs(this.environment,{from:"embed_error"})},children:(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Learn more",id:"embedError.learnMore"})})]}),!o&&"http"===t.type&&(0,Se.jsx)(_e.Z,{isSmall:!0,isSecondaryColor:!0,children:Ce(t)}),!o&&"unknown"===t.type&&t.source&&(0,Se.jsx)(_e.Z,{isSmall:!0,isSecondaryColor:!0,children:ge.Qc(t.source).hostname})]})}}Me.displayName="EmbedErrorBox";const Pe=Me;var Ae=n(35021);let Re=null;class De extends se.Z{constructor(){super(...arguments),this.storeTypes={error:u.default.createClass(void 0)},this.onError=e=>{const t=Ie(e.currentTarget,this.props.source);t&&this.stores.error.setState(t)}}renderComponent(){const{contentWrapStyle:e,source:t,handleEmbedComp:n}=this.props;return(0,Se.jsx)("div",{style:e,onMouseDown:le.$0,onTouchStart:le.$0,children:(0,Se.jsxs)("div",{style:Ee(this.props.contentStyle),children:[(0,Se.jsx)("audio",{ref:e=>n(e),style:Ee(this.props.contentStyle),controls:!0,preload:"none",onError:this.onError,onPlay:Fe,onPause:Ze,src:t}),this.renderError()]})})}renderError(){const e=this.stores.error.state;if(e)return(0,Se.jsx)(Pe,{family:"audio",error:e,isSmall:!0})}}De.displayName="AudioBox";const Be={render:function(e){const{contentStyle:t,contentWrapStyle:n,handleEmbedComp:o}=e;return(0,Se.jsx)(Ae.Z,{url:e.source,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(e,i,r)=>r?i?(0,Se.jsx)(De,{contentStyle:t,contentWrapStyle:n,source:i,handleEmbedComp:o}):void 0:(0,Se.jsx)("div",{})})},resizable:!1,hideActions:!0,rendererType:"audio"};function Ee(e){return{...e,pointerEvents:ce.Z.state?"none":"auto",position:"relative"}}function Fe(e){Re&&Re.pause(),Re=e.currentTarget}function Ze(e){Re===e.currentTarget&&(Re=null)}var Ve=n(13966),je=n(91893),Ue=n(23864),Le=n(70518),Oe=n(68709),Ne=n(64921),ze=n(31945),We=n(89728),qe=n(26388),He=n(86628),Ke=n(24098),Ge=n(73959),$e=n(77907),Qe=n(27724),Ye=n(1743);function Je(e){window.__c={n:"DrawingBox"};const t=(0,s.O7)(),n=(0,He.VK)((()=>(0,Ge.iZ)(e.store)),[e.store]),i=(0,d.yK)((t=>({sizer:{height:e.height,display:"flex",borderRadius:3,paddingTop:2,paddingLeft:10,paddingRight:10,paddingBottom:10},border:{display:"flex",flex:1,margin:2,padding:3,boxShadow:n?t.outlineBlueInputBoxShadow:void 0,outline:`1px solid ${t.regularDividerColor}`,transition:"box-shadow 0.1s ease-in-out",willChange:"box-shadow",borderRadius:3},ignoreClickArea:{flex:1,position:"relative"}})),[n,e.height]),r=(0,o.useCallback)((()=>{L.ZH({device:t.device}),U.Z5({environment:t,stores:[e.store],phase:Qe.SelectionPhase.Editing})}),[t,e.store]),a=(0,o.useCallback)((t=>(0,Se.jsx)("div",{...t,style:i.ignoreClickArea,className:"notion-disable-webkit-user-select",children:(0,Se.jsx)($e.LazyTldrawAdapter,{...e,isEditing:n})})),[i.ignoreClickArea,e,n]);return(0,Se.jsx)("div",{style:i.sizer,onPointerDown:r,children:(0,Se.jsx)("div",{style:i.border,children:(0,Se.jsx)(Ye.Z,{capture:n,allowEsc:!0,children:(0,Se.jsx)(Ke.Z,{capture:!0,render:a})})})})}const Xe={render:e=>(0,Se.jsx)(Je,{...e}),resizable:!0,hideActions:!0,rendererType:"drawing"};var et=n(84939),tt=n(86215);function nt(e){let{store:t,resizerType:n,resizerAlignment:i,resizeComponent:r,preserveScale:a,isHovered:l,blockResizerStore:c}=e;window.__c={n:"EmbedBlockResizer"};const d=(0,s.O7)(),u=(0,s.Fy)(),p=(0,He.qz)(c,X.Z),f=(0,He.VK)((()=>!u.isMobile&&l),[u.isMobile,l]),g=(0,He.VK)((()=>{const e={position:"absolute",pointerEvents:f?"auto":"none",display:"flex",alignItems:"center",justifyContent:"center"};return i===Le.bZ.Right?e.right=0:i===Le.bZ.Left&&(e.left=0),n===Le.IS.Horizontal?(e.top=0,e.zIndex=1,e.height="100%",e.width=ot,e.cursor="col-resize"):n===Le.IS.Vertical?(e.bottom=0,e.zIndex=1,e.width="100%",e.height=ot,e.cursor="row-resize"):n===Le.IS.Corner&&(e.zIndex=2,e.bottom=0,e.width=e.height=rt,i===Le.bZ.Left?e.cursor="nesw-resize":i===Le.bZ.Right&&(e.cursor="nwse-resize")),e}),[i,n,f]),h=(0,o.useMemo)((()=>{const e={position:"absolute"};return n===Le.IS.Vertical||n===Le.IS.Corner?e.bottom=it:n===Le.IS.Horizontal&&(e.top=it),i===Le.bZ.Left?e.left=it:i===Le.bZ.Right&&(e.right=it),{...g,style:e}}),[i,g,n]),v=(0,He.VK)((()=>{const{ThemeStore:e}=d,t=e.state.mode,o={opacity:f?1:0,transition:sn,borderRadius:20,background:(0,et.Fq)(m.se[t].black,.6),border:`1px solid ${m.ZP.whiteWithAlpha(.9)}`};return n===Le.IS.Horizontal?(o.width=6,o.height=48,o.maxHeight="50%"):n===Le.IS.Vertical&&(o.height=6,o.width=48,o.maxWidth="50%"),o}),[d,n,f]),b=(0,o.useMemo)((()=>n===Le.IS.Corner?(0,tt.u)({stroke:m.ZP.whiteWithAlpha(.5),fill:m.ZP.blackWithAlpha(.65),width:rt,height:rt,transition:`opacity ${sn}`,opacity:f?1:0,position:"relative",bottom:3,left:i===Le.bZ.Left?3:-3,transform:i===Le.bZ.Left?"rotate(90deg)":"none"}):(0,Se.jsx)("div",{style:v})),[i,v,n,f]);return(0,Se.jsx)(Le.ZP,{store:t,preserveScale:a,resizerType:n,resizerAlignment:i,resizeComponent:r,blockResizerStore:p,resizeHorizontally:!0,resizeVertically:!0,disabled:!1,children:(0,Se.jsx)("div",{style:h,children:b})})}const ot=15,it=0,rt=20;var at=n(86329),st=n(12457),lt=n(29477);let ct=0;function dt(e){const t=lt.UZ(),n=document.createElement("script");n.type="text/javascript";const o=function(){const e="notion_jsonp_callback_"+ct;return ct++,e}();window[o]=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.resolve(e)};const i=ge.SK(e,{callback:o});return n.src=i,n.onerror=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.reject(e)},document.head&&document.head.appendChild(n),t.promise}class ut extends u.default{getInitialState(){return{loading:!0,error:!1,html:void 0}}}const pt=ut;var mt=n(68785);const ft={userSelect:"none",padding:"6px 10px",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%"};class gt extends se.Z{constructor(){super(...arguments),this.storeTypes={store:pt}}async didMount(){const e=`https://gist.github.com/${function(e){const{pathname:t}=ge.Qc(e);return(t||"").split("/").pop()}(this.props.source)}.json`;try{const n=await dt(e);this.stores.store.setState({loading:!1,error:!1,html:n.div});if(!document.querySelector(`link[href="${n.stylesheet}"]`)){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=n.stylesheet,document.head&&document.head.appendChild(t)}}catch(n){this.stores.store.setState({loading:!1,error:!0,html:void 0})}}renderComponent(){return(0,Se.jsx)("div",{children:(0,Se.jsx)(Ke.Z,{capture:!0,render:e=>(0,Se.jsx)("div",{...e,ref:this.props.handleEmbedComp,style:this.getStyle(),children:this.renderGist()})})})}renderGist(){return(0,Se.jsx)(st.Z,{show:this.stores.store.state.loading,showDelay:1e3,showHold:500,render:e=>e||this.stores.store.state.loading?(0,Se.jsx)("div",{style:{marginBottom:"1em"},children:(0,Se.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",opacity:e?1:0,...ft},children:[(0,Se.jsx)(mt.Z,{}),(0,Se.jsx)("div",{style:{marginLeft:8},children:(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Loading gist",id:"githubGistRenderer.loading.message"})})]})}):this.stores.store.state.error?(0,Se.jsx)("div",{style:{marginBottom:"1em"},children:(0,Se.jsx)("div",{style:ft,children:(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Error loading gist",id:"githubGistRenderer.errorLoading.message"})})}):(0,Se.jsx)("div",{dangerouslySetInnerHTML:{__html:this.stores.store.state.html},className:"notion-gist-block"})})}getStyle(){return this.stores.store.state.html?{width:"100%",marginBottom:"-1em",overflowY:"auto",height:"100%",pointerEvents:ce.Z.state?"none":"auto"}:{width:"100%",marginBottom:"-1em"}}}gt.displayName="GistBox";const ht={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,Se.jsx)(gt,{source:t,handleEmbedComp:n})},renderFullScreen:void 0,resizable:!0,embedGhost:!0,hideActions:!0};var vt=n(63085),bt=n(25777),yt=n(49271),_t=n(69721);const St=function(e){const{signedUrl:t,dataSize:n,dataName:o,contentWrapStyle:i,disabled:r,viewOriginal:a}=e,s={paddingTop:yt.ZD.paddingTop,paddingBottom:yt.ZD.paddingBottom,paddingLeft:yt.ZD.paddingLeft};return(0,Se.jsx)("div",{style:i,onClick:void 0,onMouseDown:le.$0,children:(0,Se.jsx)("div",{style:{position:"relative"},children:t&&(0,Se.jsx)(_t.S,{title:o,url:t,size:n,onClick:r?void 0:a,style:s})})})};var wt=n(84456),kt=n(23586),It=n(87111);const xt=e=>{let{url:t,metadata:n}=e;window.__c={n:"IFramePreviewRenderer"};const o=(0,d.yK)((e=>({previewWrapper:{display:"flex",flexDirection:"column",border:`1px solid ${e.darkDividerColor}`,borderRadius:"3px",height:"100%"},previewImageArea:{flex:1,backgroundColor:e.embedPlaceholderBackground},previewInfoArea:{padding:"0.75em 1em",backgroundColor:e.regularInvertedTextColor,display:"flex",flexDirection:"column",gap:"0.25em"},previewTitle:{fontWeight:P.Z.fontWeight.medium,color:e.darkTextColor},previewUrl:{display:"flex",alignItems:"center",gap:"0.75em"},previewUrlText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.lightTextColor},previewUrlFavicon:{width:"1.25em",height:"1.25em"}})),[]),i=null!=n&&n.images&&n.images.length>0?n.images[0].url:void 0;return(0,Se.jsxs)("div",{style:o.previewWrapper,children:[(0,Se.jsx)("div",{style:o.previewImageArea,children:i?(0,Se.jsx)(Ct,{imageUrl:i}):(0,Se.jsx)(Tt,{})}),(0,Se.jsxs)("div",{style:o.previewInfoArea,children:[(null==n?void 0:n.title)&&(0,Se.jsx)("div",{style:o.previewTitle,children:n.title}),(0,Se.jsxs)("div",{style:o.previewUrl,children:[(null==n?void 0:n.favicon_url)&&(0,Se.jsx)("img",{style:o.previewUrlFavicon,src:n.favicon_url}),(0,Se.jsx)("div",{style:o.previewUrlText,children:t})]})]})]})},Ct=e=>{let{imageUrl:t}=e;window.__c={n:"EmbedPreviewArea"};const n=(0,d.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",height:"100%",backgroundSize:"cover",backgroundImage:`url(${t})`},pill:{backgroundColor:e.accentColors.gray[800],color:e.accentColors.gray[50],borderRadius:"99em",padding:"0.5em 1em",margin:"1em",display:"flex",alignItems:"center",gap:"0.75em",fontWeight:P.Z.fontWeight.medium},playButton:{width:"1em",height:"1em",fill:e.accentColors.gray[50]}})),[t]);return(0,Se.jsx)("div",{style:n.wrapper,children:(0,Se.jsxs)("div",{style:n.pill,children:[(0,It.I)(n.playButton),(0,Se.jsx)("span",{children:(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Load embed",id:"iFramePreview.pillLabel"})})]})})},Tt=()=>{window.__c={n:"ImagelessArea"};const e=(0,d.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:e.mediumTextColor,height:"100%"},message:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"0.75em",fontWeight:P.Z.fontWeight.medium},playButtonWrapper:{backgroundColor:e.mediumTextColor,borderRadius:"2em",width:"2.5em",height:"2.5em",display:"flex",justifyContent:"center",alignItems:"center"},playButton:{marginLeft:"0.1em",width:"1em",height:"1em",fill:e.embedPlaceholderBackground}})),[]);return(0,Se.jsx)("div",{style:e.wrapper,children:(0,Se.jsxs)("div",{style:e.message,children:[(0,Se.jsx)("div",{style:e.playButtonWrapper,children:(0,It.I)(e.playButton)}),(0,Se.jsx)("span",{children:(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Tap to load embed",id:"iFramePreview.imagelessAreaLabel"})})]})})};function Mt(e){let{source:t}=e;window.__c={n:"IFramePreview"};const n=(0,s.O7)(),o={request:t,performRequest:e=>async function(e,t){return(0,vt.W4)(t,e)}(e,n),render:(e,n,o)=>(0,Se.jsx)(Pt,{error:e,result:n,ready:o,source:t})};return(0,Se.jsx)(kt.Z,{...o})}function Pt(e){let{error:t,result:n,ready:o,source:i}=e;return o?(0,Se.jsx)(xt,{url:i,metadata:n}):null}const At={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};function Rt(e){const{render:t,style:n,errorStyle:o,...i}=e,r=(0,vt.NX)(e.url);return(0,Se.jsx)(Ae.Z,{...i,render:(i,a,s)=>{let l=r;return i&&!l&&(l=(0,vt.sj)(i)??{type:"unknown",source:e.url}),(0,Se.jsx)("div",{style:n,children:(0,Se.jsx)(bt.Z,{innerStyle:{height:"100%",width:"100%"},loaded:s,style:At,spinnerSize:"1em",showSpinnerTimeout:500,children:l?(0,Se.jsx)("div",{style:o,children:(0,Se.jsx)(Pe,{family:"embed",error:l})}):t(a)})})}})}function Dt(e){window.__c={n:"FullScreenIFrameRenderer"};const{height:t,source:n,contentStyle:i,dataName:r,dataSize:a,width:s}=e,[l,c]=(0,o.useState)(!1);return(0,Se.jsx)(Rt,{url:n,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,style:{width:"100%",height:"100%"},errorStyle:{height:t,width:s},render:n=>l&&r&&a?(0,Se.jsx)(St,{...e,dataName:r,dataSize:a,signedUrl:n}):n&&(0,Se.jsx)(wt.Z,{source:n,isFullWidth:!0,isFullHeight:!0,height:t,style:i,background:!0,onContentLoadTimeout:()=>c(!0)})})}const Bt={render:function(e){window.__c={n:"IFrameRenderer"};const{disabled:t,contentStyle:n,contentWrapStyle:i,handleFullScreen:r,handleEmbedComp:a,height:s,preserveScale:l,isFullWidth:c,source:d,dataName:u,dataSize:p}=e,[m,f]=(0,o.useState)(!1),g=(0,vt.kl)({height:s,isFullWidth:c,preserveScale:l});return(0,Se.jsx)(Rt,{url:d,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,style:g,errorStyle:{position:"relative",height:s},render:o=>m&&u&&p?(0,Se.jsx)(St,{...e,dataName:u,dataSize:p,signedUrl:o}):(0,Se.jsx)("div",{style:i,onClick:t?r:void 0,onMouseDown:le.$0,children:(0,Se.jsx)("div",{style:{position:"relative"},children:o&&(0,Se.jsx)(wt.Z,{ref:e=>a(e),source:o,height:s,style:n,preserveScale:l,isFullWidth:c,background:!0,renderPreview:()=>(0,Se.jsx)(Mt,{source:(0,vt.cJ)(e)}),onContentLoadTimeout:()=>f(!0)})})})})},embedGhost:!0,renderFullScreen:e=>(0,Se.jsx)(Dt,{...e}),resizable:!0};var Et=n(10517),Ft=n.n(Et),Zt=n(54642),Vt=n(24042),jt=n(12981),Ut=n(32854),Lt=n(81865);class Ot extends se.Z{constructor(){super(...arguments),this.storeTypes={error:u.default.createClass(void 0)},this.previousImageURL=void 0,this.previousSourceURL=void 0,this.signedOriginalURL=void 0,this.getSignedOriginalUrlIfNecessary=(e,t)=>{e&&this.environment.mobileNative&&(this.signedOriginalURL&&e===this.previousSourceURL||(this.previousSourceURL=e,Zt.getSignedFileUrl(this.environment,{url:e,download:!1,downloadName:"image",permissionRecord:t.pointer},Boolean(Vt.Z.state.isNotionProtocolBugFixed)).then((e=>{this.signedOriginalURL=e}))))},this.renderURL=(e,t)=>{const n=t||this.previousImageURL;this.previousImageURL=t;const{isFullScreen:o}=this.props,i=ke(e,void 0)||(0,vt.sj)(e)||this.stores.error.state;return o?this.renderFullScreen(i,n):this.renderInline(i,n)},this.onImageError=async(e,t)=>{const n=de.E$(this.props.source,[z.default.secureFileS3.url,z.default.secureFileS3V2.url])?t:this.props.source;if(t){const e=await(0,ve.ZP)({url:t,environment:this.environment,method:"HEAD",format:"text"});if("failed"===e.type){const t=ke(e.error,n);if(t)return void this.stores.error.setState(t)}}this.stores.error.setState({type:"unknown",source:n})},this.onImageLoad=()=>{this.stores.error.setState(void 0)}}renderComponent(){const{store:e,dataURL:t,source:n,isFullWidth:o,dragging:i,blockWidth:r,isFullScreen:a}=this.props;if(t)return this.renderURL(void 0,t);this.getSignedOriginalUrlIfNecessary(n,e);const s=o&&!i?void 0:r,l=window.innerWidth,c=s?Math.min(s,window.innerWidth):window.innerWidth;return(0,Se.jsx)(Lt.Z,{url:n,width:a?l:c,render:this.renderURL,isAuthenticated:!0,permissionRecord:e.pointer},`width-${this.props.contentStyle.width}`)}renderInline(e,t){const{progressPercent:n,disabled:o,isLoading:i,contentStyle:r,contentWrapStyle:a,handleFullScreen:s,handleEmbedComp:l,isFullWidth:c,isRootChild:d,height:u,inlineContentStyle:p,blockLocation:m,imageBoxRef:f}=this.props,g=F.qC(m),h=()=>{var e;if(R.QIc(this.environment,{from:"embedded_block_click",type:"image"}),!t)return;const n=0===t.indexOf("https:")?t:`${z.default.domainBaseUrl}${t}`;null===(e=this.environment.mobileNative)||void 0===e||e.showLightBox({items:[{type:"image",previewUrl:Ft()(n),originalUrl:Ft()(this.signedOriginalURL??n)}],startingIndex:0,from:"embedded_block_click"}),U.ZH(this.environment),L.sD()},v=this.environment.mobileNative&&!1===(null==t?void 0:t.startsWith("data:")),b=v?h:g?void 0:s,y=v?h:g?e=>Wt(e,this.props.handleFullScreen):void 0,_=g?e=>Wt(e,this.props.handleFullScreen):s;return(0,Se.jsx)("div",{ref:e=>l(e),style:a,onClick:o&&!v?_:void 0,children:(0,Se.jsxs)("div",{children:[(0,Se.jsx)(jt.Z,{ref:f,src:t,loading:"lazy",isFullScreen:!1,style:{...r,...p},placeholderStyle:zt(this.props.isFullWidth,this.props.isRootChild,this.props.aspectRatio,this.props.height),onDoubleClick:b,onClick:y,height:c&&d?u:void 0,capMaxHeight:c&&d,onError:this.onImageError,onLoad:this.onImageLoad}),e&&(0,Se.jsx)(Pe,{error:e,family:"image"}),i&&(0,Se.jsxs)("div",{style:jt.I,children:[(0,Se.jsx)(mt.Z,{style:{width:16,height:16,marginRight:4}}),(0,Se.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,Se.jsx)(Ut.Z,{percentage:n})})]})]})})}renderFullScreen(e,t){const{contentStyle:n}=this.props,o=Math.min(500,window.innerWidth-50);return(0,Se.jsx)("div",{style:{alignSelf:"center",margin:0,position:"relative",minWidth:e?o:void 0},children:(0,Se.jsxs)("div",{children:[(0,Se.jsx)(jt.Z,{src:t,isFullScreen:!0,style:{...n,background:this.theme.contentBackground},placeholderStyle:zt(this.props.isFullWidth,this.props.isRootChild,this.props.aspectRatio,this.props.height),capMaxHeight:!1,onError:this.onImageError,onLoad:this.onImageLoad}),e&&(0,Se.jsx)(Pe,{error:e,family:"image"})]})})}}Ot.displayName="EmbedImageRenderer";const Nt={render:e=>(0,Se.jsx)(Ot,{...e,isFullScreen:!1}),renderFullScreen:e=>(0,Se.jsx)(Ot,{...e,isFullScreen:!0}),resizable:!0};function zt(e,t,n,o){const i={};return e&&t||!n?o&&(i.height=o,i.background=m.ZP.contentGrayBackground):(i.height=0,i.paddingBottom=100*n+"%",i.background=m.ZP.contentGrayBackground),i}function Wt(e,t){e.stopPropagation(),t()}const qt={render:function(e){const{disabled:t,contentStyle:n,contentWrapStyle:o,handleFullScreen:i,source:r,handleEmbedComp:a,height:s}=e;return(0,Se.jsx)("div",{style:o,onClick:t?i:void 0,children:(0,Se.jsx)("div",{style:{position:"relative"},children:(0,Se.jsx)(wt.Z,{ref:e=>a(e),source:r,height:s,style:n,background:!1,renderPreview:()=>(0,Se.jsx)(Mt,{source:(0,vt.cJ)(e)})})})})},renderFullScreen:function(e){const{source:t,height:n,contentStyle:o}=e;return(0,Se.jsx)(wt.Z,{source:t,isFullWidth:!0,height:n,style:o,background:!0})},resizable:!0};var Ht=n(53238),Kt=n(83785);function Gt(e){window.__c={n:"TweetBox"};const{handleEmbedComp:t,source:r,fullScreen:a}=e,s=(0,d.Fg)(),l=(0,d.yK)((e=>({main:{width:a?520:"100%",minWidth:"100%",pointerEvents:"auto",margin:a?"-10px auto":"-10px 0"},loading:{userSelect:"none",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%",padding:"6px 10px"}})),[a]),c=(0,o.useCallback)((async e=>{if(!e)return;const{pathname:t}=ge.Qc(r),n=(t||"").split("/")[3],o={dnt:!0,lang:"en",width:"100%",theme:"dark"===s.mode?"dark":"light"};if(n&&window.twttr){e.innerHTML="";if(await window.twttr.widgets.createTweetEmbed(n,e,o))return}i.render((0,Se.jsx)("div",{style:l.loading,children:"Error loading tweet"}),e)}),[r,l.loading,s.mode]);return(0,Se.jsx)("div",{style:{display:"flex"},children:(0,Se.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:420,minWidth:0,width:"100%"},children:(0,Se.jsx)(Ke.Z,{capture:!0,render:e=>(0,Se.jsx)("div",{...e,ref:e=>e&&t(e),style:l.main,children:(0,Se.jsx)(Kt.Z,{fetch:()=>n.e(898).then(n.bind(n,22062)),loading:e=>e&&(0,Se.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",...l.loading},children:[(0,Se.jsx)(mt.Z,{}),(0,Se.jsx)("div",{style:{marginLeft:8},children:(0,Se.jsx)(A.FormattedMessage,{id:"tweetRenderer.loadingTweet.message",defaultMessage:"Loading Tweet"})})]}),render:()=>(0,Se.jsx)("div",{ref:c})})})})})})}const $t={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,Se.jsx)(Gt,{source:t,handleEmbedComp:n,fullScreen:!1})},renderFullScreen:function(e){const{source:t,handleEmbedComp:n}=e;return(0,Se.jsx)(Gt,{source:t,handleEmbedComp:n,fullScreen:!0})},resizable:!1,embedGhost:!0,hideActions:!0},Qt={position:"absolute",left:"50%",top:"50%",transform:"translate(-30%, -50%)",height:0,width:0,borderStyle:"solid",borderColor:m.ZP.uiBlack,borderRightWidth:0,borderLeftWidth:24.5,borderTopWidth:16.1,borderBottomWidth:16.1,borderTopColor:m.ZP.transparent,borderBottomColor:m.ZP.transparent},Yt={position:"relative",height:70,width:70,borderWidth:3,borderStyle:"solid",borderColor:m.ZP.uiBlack,borderRadius:70},Jt={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"};class Xt extends se.Z{constructor(){super(...arguments),this.storeTypes={played:u.default.createClass(!1),error:u.default.createClass(void 0)},this.handlePlay=e=>{this.stores.played.setState(!0)},this.handlePause=e=>{const{device:t}=this.environment;t.isMobile&&this.stores.played.setState(!1)},this.handleLoadStart=e=>{const{device:t}=this.environment;t.isIOS&&this.video&&this.video.pause()},this.handleError=e=>{const t=Ie(e.currentTarget,this.props.source);t&&this.stores.error.setState(t)},this.handleRef=e=>{this.props.handleEmbedComp(e),this.video=e},this.handlePlayVideo=e=>{this.video&&(0,le.ZP)({event:e,context:le.Af.EditorClick,callback:()=>{this.video.play()}})}}renderComponent(){const{store:e,source:t,contentWrapStyle:n,handleFullScreen:o,aspectRatio:i,height:r,handleEmbedComp:a,isFullWidth:s,preserveScale:l,mediaType:c,useS3Url:d}=this.props;return(0,Se.jsx)(Ae.Z,{url:t,permissionRecord:e.pointer,useS3Url:d,render:(e,d,u)=>{if(!u)return(0,Se.jsx)("div",{});const p=ke(e,void 0)||this.stores.error.state;return d?"video"===c||(0,f.xL)({url:t})?(0,Se.jsx)("div",{style:n,onMouseDown:le.$0,children:(0,Se.jsxs)("div",{style:{position:"relative"},onDoubleClick:o,children:[this.renderVideo(d),p&&(0,Se.jsx)(nn,{error:p}),this.renderOverlay()]})}):(0,Se.jsx)("div",{style:n,onDoubleClick:o,children:(0,Se.jsx)("div",{style:{position:"relative"},children:(0,Se.jsx)(wt.Z,{ref:e=>a(e),source:d,height:r,style:this.getContentStyle("embed_url"),isFullWidth:s,preserveScale:l,aspectRatio:i,background:!0})})}):void 0}})}getContentStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"embed_url";const{isFullWidth:t,isRootChild:n,preserveScale:o,height:i}=this.props,r={...this.props.contentStyle};return t&&n&&o&&(r.height=i),"video_file"!==e||this.stores.played.state||(r.pointerEvents="none"),F.qC(this.props.blockLocation)&&(r.maxHeight=240),r.backgroundColor=this.theme.embedPlaceholderBackground,r}renderVideo(e){return(0,Se.jsx)("video",{ref:this.handleRef,style:this.getContentStyle("video_file"),autoPlay:this.environment.device.isIOS,playsInline:!0,controls:!0,preload:"metadata",onPause:this.handlePause,onPlay:this.handlePlay,onEnded:e=>function(e,t){const{device:n}=t;n.isAndroid&&document.fullscreenElement&&document.exitFullscreen()}(0,this.environment),onLoadStart:this.handleLoadStart,onError:this.handleError,src:e})}renderOverlay(){return this.stores.played.state||this.stores.error.state?null:(0,Se.jsx)("div",{onClick:this.handlePlayVideo,style:Jt,children:(0,Se.jsx)(on,{})})}}function en(e){return(0,Se.jsx)("div",{style:{...Yt,...e.style},children:(0,Se.jsx)("div",{style:Qt})})}Xt.displayName="VideoRenderer";const tn={render:e=>(0,Se.jsx)(Xt,{...e}),resizable:!0,embedGhost:!0};function nn(e){let{error:t}=e;return(0,Se.jsx)(Pe,{family:"video",error:t})}function on(){window.__c={n:"PlayButtonWrapper"};const e=(0,s.O7)(),{device:t}=e;return t.isFirefox||t.isMobile?null:(0,Se.jsx)(en,{})}const rn={background:"rgba(255, 255, 255, 0.055)"},an={display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 6px",borderRight:`1px solid ${m.ZP.whiteWithAlpha(.2)}`},sn="opacity 300ms ease-in",ln=(0,A.defineMessages)({embedButtonText:{defaultMessage:"Embed link",id:"embedBlock.embedButton.label"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePenâ€¦",id:"embedBlock.linkPrompt.caption"},pastePrompt:{defaultMessage:"Paste in https://â€¦",id:"embedBlock.pastePrompt"},validLink:{defaultMessage:"Please enter a valid link.",id:"embedBlock.invalidLinkError.message"},embedTitle:{defaultMessage:"Embed",id:"embedBlock.embedTab.title"}}),cn={tweet:$t,gist:ht,video:tn,image:Nt,audio:Be,invision:qt,mixpanel:Bt,maps:Bt,drive:Bt,framer:Bt,figma:Bt,loom:Bt,typeform:Bt,codepen:Bt,embed:Bt,pdf:Ht.Z,whimsical:Bt,miro:Bt,abstract:Bt,sketch:Bt,excalidraw:Bt,replit:Bt,hex:Bt,deepnote:Bt,drawing:Xe};class dn extends W.Z{constructor(){super(...arguments),this.embedComp=null,this.embedContainerWidth=u.default.createValue(0),this.didHaveNonZeroWidth=u.default.createValue(!1),this.imageBoxRef=o.createRef(),this.isStoreNavigableAncestorLocked=this.createComputedStore((()=>this.props.store.isNavigableAncestorLocked())),this.captionAriaId=(0,l.Z)(),this.getImageDimensions=()=>{var e;return null===(e=this.imageBoxRef.current)||void 0===e?void 0:e.getImageDimensions()},this.openMenu=()=>{const{device:e}=this.environment;if(!this.props.disableMediaMenu&&this.canEdit()){const{popupWidth:t,maxHeight:n}=this.props,o=this.props.mediaMenuCurrentTab||"embed",r=(this.props.mediaMenuTabs||[{type:"embed"},{type:"file",fileUpload:!0,imageUpload:e.isAndroid,videoUpload:e.isAndroid}]).map((e=>function(e,t,n,o,i,r){switch(e.type){case"embed":const a=n||G.default.formatMessage(ln.embedButtonText);return{type:"embed",caption:o||G.default.formatMessage(ln.embedCaption),buttonText:a,inputPlaceholder:i||G.default.formatMessage(ln.pastePrompt),onChange:e=>{const n=(0,T.D)(e);x.B(n,"url")?(V.Z(),vn(n,r,t)):E.showErrorMessage(G.default.formatMessage(ln.validLink))}};case"file":return{type:"file",fileUpload:Boolean(e.fileUpload),imageUpload:Boolean(e.imageUpload),videoUpload:Boolean(e.videoUpload),onUpload:e=>function(e,t,n){const o=gn(t);if(o){const t=q.qQ(n);F.cT({environment:n,store:o,file:e,pageWidth:t,preferredType:o.getType()})}}(e,r,t)};case"unsplash":return{type:"unsplash",onChange:e=>{let{url:n}=e;V.Z(),vn(n,r,t)}};case"giphy":return{type:"giphy",onChange:e=>{let{url:n}=e;V.Z(),vn(n,r,t)}}}}(e,this.environment,this.props.embedButtonText,this.props.mediaMenuEmbedCaption,this.props.urlInputPlaceholder,this.props.store))),a=i.findDOMNode(this);if(a&&a instanceof Element){const e=a.getBoundingClientRect();V.$(this.environment,{originRect:e,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:o,tabs:r,title:G.default.formatMessage(ln.embedTitle),...t?{popupWidth:t}:{},...n?{maxHeight:n}:{}})}}},this.replace=()=>{this.openMenu();const e=this.props.store.getType();e&&R.Fn4(this.environment,{type:"replace",block_type:e,block_id:this.props.store.id})},this.caption=()=>{_n(this.props.store,this.environment)},this.getFullScreenNodeRect=()=>{const{isFullWidth:e,aspectRatio:t}=this.getDimensions();if(this.embedComp){const n=i.findDOMNode(this.embedComp);if(n&&n instanceof Element){const o=n.getBoundingClientRect();return e&&t?{...C.Go(o),width:o.width,height:o.width*t}:o}}},this.renderFullScreenNode=()=>{const e=fn(this.props.source,this.props.store),t=this.getRendererBySource(fn(this.props.source,this.props.store));if(!e)return;const n=this.getRenderArgs({source:e});return t&&t.renderFullScreen?t.renderFullScreen(n):void 0},this.storeTypes={embedBlockStore:ie,blockResizerStore:X.Z,alignmentPopupStore:ee.Z},this.renderAlignmentButtons=()=>(0,Se.jsxs)(Se.Fragment,{children:[(0,Se.jsx)(Ne.Z,{style:{...an,...this.getAlignmentButtonStyle("left"),borderRight:"none"},hoveredStyle:{...rn,opacity:1},onClick:()=>this.handleAlignment("left"),children:mn("left")}),(0,Se.jsx)("span",{style:{borderRight:`1px solid ${m.ZP.whiteWithAlpha(.2)}`}}),(0,Se.jsx)(Ne.Z,{style:{...an,...this.getAlignmentButtonStyle("center"),borderRight:"none"},hoveredStyle:{...rn,opacity:1},onClick:()=>this.handleAlignment("center"),children:mn("center")}),(0,Se.jsx)("span",{style:{borderRight:`1px solid ${m.ZP.whiteWithAlpha(.2)}`}}),(0,Se.jsx)(Ne.Z,{style:{...an,...this.getAlignmentButtonStyle("right"),borderRight:"none"},hoveredStyle:{...rn,opacity:1},onClick:()=>this.handleAlignment("right"),children:mn("right")})]}),this.handleMouseEnter=e=>{ne.Z.state.isDragging||ae.default.state.isActive||this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,hovered:!0})},this.handleMouseLeave=e=>{ne.Z.state.isDragging||ae.default.state.isActive||this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,hovered:!1})},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,c.E)(t)&&this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,focused:!0})},this.handleBlur=e=>{this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,focused:!1})},this.handleAlignment=e=>{const t=gn(this.props.store),{alignmentPopupStore:n}=this.stores;n.reset(),t&&O.createAndCommit({userAction:"EmbedBlock.handleAlignment",environment:this.environment,perform:n=>{Z.hc({environment:this.environment,store:t,alignment:e,transaction:n})}});const o=this.props.store.getType(),i=this.props.store.getFormat(),r=i.block_alignment,a=i.block_width,s=i.block_height,l=this.props.store.isRootOrDirectChild()?"center":"left";o&&R.Fn4(this.environment,{type:"alignment",block_type:o,block_id:this.props.store.id,block_alignment:e,block_height:s,block_width:a,previous_alignment:r,default_alignment:l}),U.Jy()},this.fileUploadStore=this.createComputedStore((()=>re.default.getKeyState(re.default.getBlockKey(this.props.store.id))))}handleCreated(){this.openMenu()}edit(){this.openMenu()}embed(e){vn(e,this.props.store,this.environment)}async handleRemoveBlockFromComment(){return!!this.props.onRemoveBlockFromComment&&(await this.props.onRemoveBlockFromComment(this.props.store),!0)}activate(){this.getRendererBySource(fn(this.props.source,this.props.store))?Sn(this.props.store,this.props.blockLocation,this.environment):this.replace()}canRenderFullScreen(){const e=this.getRendererBySource(fn(this.props.source,this.props.store));return!(!e||!e.renderFullScreen)}renderPersisted(){const e=fn(this.props.source,this.props.store),t=this.fileUploadStore.state;return t&&t.dataURL?this.renderSource(t.dataURL):e?this.renderSource(e):this.renderPlaceholder()}renderSource(e){const{device:t}=this.environment,n=this.canEdit(),{preserveScale:o,isFullWidth:i}=this.getDimensions(),r=this.isRootOrDirectChild(),a=this.getRendererBySource(e);if(a){const{resizable:s}=a,l=n&&s&&!this.props.disableResizers,c=l&&(!o||i&&r),d=l&&r,u=c&&!i,p=u&&r;return(0,Q.Z)((n=>(0,Se.jsxs)(Oe.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,ref:t=>{if(t){this.attachGhost(t,e);const{width:n}=t.getBoundingClientRect();this.embedContainerWidth.setState(n),this.didHaveNonZeroWidth.update((e=>e||n>0))}},...n,children:[this.didHaveNonZeroWidth?(0,Se.jsxs)("div",{style:bn(a,this.props.blockLocation),children:[(0,Se.jsxs)("div",{className:H.QSt,style:{position:"relative",overflow:s?"hidden":"visible",flexGrow:1,paddingRight:10},onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[this.renderEmbed(e),d&&(0,Se.jsx)(nt,{store:this.props.store,resizerType:Le.IS.Horizontal,resizerAlignment:Le.bZ.Left,resizeComponent:this,preserveScale:o,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"LeftResizer"),l&&(0,Se.jsx)(nt,{store:this.props.store,resizerType:Le.IS.Horizontal,resizerAlignment:Le.bZ.Right,resizeComponent:this,preserveScale:o,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"RightResizer"),u&&(0,Se.jsx)(nt,{store:this.props.store,resizerType:Le.IS.Corner,resizerAlignment:Le.bZ.Right,resizeComponent:this,preserveScale:o,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"RightCornerResizer"),p&&(0,Se.jsx)(nt,{store:this.props.store,resizerType:Le.IS.Corner,resizerAlignment:Le.bZ.Left,resizeComponent:this,preserveScale:o,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"LeftCornerResizer"),c&&(0,Se.jsx)(nt,{store:this.props.store,resizerType:Le.IS.Vertical,resizeComponent:this,preserveScale:o,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"BottomResizer"),!this.props.disableActions&&this.renderActions(e),this.props.disableActions&&this.props.showExpandButton&&a.renderFullScreen&&(0,Se.jsx)(kn,{store:this.props.store,blockLocation:this.props.blockLocation}),this.props.contentBelowSource]}),!i&&!t.isMobile&&(0,Se.jsx)(Ue.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}):null,(0,Se.jsx)(je.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})))}}renderPlaceholder(){const{device:e}=this.environment,t=!te.Z.state.online,n=e.isMobile||this.stores.embedBlockStore.state.hovered,o=this.fileUploadStore.state;return(0,Se.jsxs)("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:yn(this.props.blockLocation,this.theme),children:[(0,Se.jsx)(at.Z,{style:this.getContentWrapStyle(),disabled:!this.canEdit()||t,iconSvg:void 0!==this.props.iconSvg?this.props.iconSvg:S.m,shouldHideRight:!n,right:this.canEdit()&&(0,Se.jsx)(hn,{blockLocation:this.props.blockLocation,store:this.props.store,isPlaceholder:!0}),onClick:this.openMenu,isLoading:Boolean(o),progressPercent:o?o.progressPercent:0,file:o?o.file:void 0,name:o?o.name:void 0,size:o?o.size:void 0,children:this.props.children||(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Embed anything (PDFs, Google Docs, Google Maps, Spotifyâ€¦)",id:"embedBlock.embedAnything.placeholder"})}),(0,Se.jsx)(Ue.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}renderEmbed(e){const t=this.getRendererBySource(e);if(t){const n=this.getRenderArgs({source:e}),o=t.render;return(0,Se.jsx)(o,{...n})}}renderActions(e){const{device:t}=this.environment,{blockLocation:n}=this.props,{isFullWidth:o,width:i,isPageWidth:r}=this.getDimensions(),a=this.props.store.canEdit(),s=this.props.store.canComment(),l=this.props.store.isExternalObjectInstanceBlockStore(),c=this.getRendererBySource(e),d=this.shouldHideActions(),u=this.fileUploadStore.state,f=this.stores.blockResizerStore.state.dragging,h=F.qC(n),v=!t.isMobile&&!h&&!l,b=i&&!r&&!o&&!t.isPhone&&!h,S=!t.isMobile&&(null==c?void 0:c.renderFullScreen)&&l;if(!(u||f||c&&c.hideActions)){const e=Y.Xp(this.props.store,{recursivelyLoadAllDiscussions:!1});if(this.isStoreNavigableAncestorLocked.state)return(0,Se.jsx)("div",{style:this.getActionsStyle(),children:(0,Se.jsx)(Ne.Z,{style:an,hoveredStyle:rn,onClick:()=>wn(this.props.store,this.environment),children:(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"View original",id:"embedBlock.viewOriginalLink.button.label"})})});if(d)return(0,Se.jsx)("div",{style:this.getActionsStyle(),children:(0,Se.jsx)(hn,{blockLocation:this.props.blockLocation,store:this.props.store})});{const n=300,o=qe.ug.Top;let i;const r=this.props.store.getType();return i=(0,p.VB)(r)?(0,Se.jsx)(qe.ZP,{renderTooltip:()=>(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Download",id:"embedBlock.actionButton.tooltip.download"}),placement:o,delayThreshold:n,render:e=>(0,Se.jsx)(Ne.Z,{...e,style:an,hoveredStyle:rn,onClick:()=>function(e,t){const n=gn(e);if(n){F.TH({environment:t,store:n});const o=n.getType();o&&R.Fn4(t,{type:"download",block_type:o,block_id:e.id})}}(this.props.store,this.environment),children:(0,w.a)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}):(0,Se.jsx)(qe.ZP,{renderTooltip:()=>(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Original",id:"embedBlock.actionButton.tooltip.original"}),placement:o,delayThreshold:n,render:e=>(0,Se.jsx)(Ne.Z,{...e,style:an,hoveredStyle:rn,onClick:()=>wn(this.props.store,this.environment),children:(0,g.J)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}),(0,Se.jsxs)("div",{style:this.getActionsStyle(),children:[!h&&!l&&s&&(0,Se.jsx)(qe.ZP,{renderTooltip:()=>(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Comment",id:"embedBlock.actionButton.tooltip.comment"}),placement:o,delayThreshold:n,render:n=>(0,Se.jsxs)(Ne.Z,{...n,style:{...an,...t.isMobile&&{paddingLeft:8,paddingRight:8}},hoveredStyle:rn,onClick:()=>{U.ZH(this.environment),e>0?B.Ib({environment:this.environment,blockStore:this.props.store,analyticsFrom:"embed_menu",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):N.yw({environment:this.environment,blockStore:this.props.store})},children:[(0,I.z)({width:14,height:14,marginRight:e>0?4:0,fill:m.ZP.white}),e>0&&e]})}),a&&b&&(0,Se.jsx)(qe.ZP,{renderTooltip:()=>(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Align",id:"embedBlock.actionButton.tooltip.align"}),placement:o,delayThreshold:n,render:e=>(0,Se.jsx)(ze.ZP,{popupType:ze.Z4.Popup,buttonPopupStore:this.stores.alignmentPopupStore,originGap:1,renderOrigin:t=>(0,Se.jsxs)(Ne.Z,{style:an,hoveredStyle:rn,...(0,$.Z)(t,e),children:[mn(this.getBlockAlignment()),(0,_.i)({width:8,fill:m.ZP.white,marginLeft:4})]}),borderRadius:6,render:this.renderAlignmentButtons,popupWrapStyle:{background:pn(this.environment),display:"flex"}})}),a&&v&&(0,Se.jsx)(qe.ZP,{renderTooltip:()=>(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Caption",id:"embedBlock.actionButton.tooltip.caption"}),placement:o,delayThreshold:n,render:e=>(0,Se.jsx)(Ne.Z,{...e,style:an,hoveredStyle:rn,onClick:()=>_n(this.props.store,this.environment),children:(0,y.o)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}),S&&(0,Se.jsx)(qe.ZP,{renderTooltip:()=>(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"Expand",id:"embedBlock.actionButton.tooltip.expand"}),placement:o,delayThreshold:n,render:e=>(0,Se.jsx)(Ne.Z,{...e,style:an,hoveredStyle:rn,onClick:()=>Sn(this.props.store,this.props.blockLocation,this.environment),children:(0,k.s)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}),!t.isMobile&&i,(0,Se.jsx)(hn,{blockLocation:this.props.blockLocation,store:this.props.store})]})}}}attachGhost(e,t){const n=this.getRendererBySource(t);e&&n&&n.embedGhost&&this.mutateDOM((()=>e.setAttribute("embed-ghost","")))}shouldHideActions(){const{block_width:e}=this.props.store.getFormat(),{temporaryWidth:t}=this.stores.blockResizerStore.state;return void 0!==t?t<=230:void 0!==e&&e<=230}getDimensions(){const{block_height:e,block_width:t,block_preserve_scale:n,block_full_width:o,block_page_width:i,block_aspect_ratio:r}=this.props.store.getFormat(),{dragging:a,temporaryHeight:s,temporaryWidth:l,temporaryFullWidth:c,temporaryPageWidth:d}=this.stores.blockResizerStore.state,u=a?l:t??this.embedContainerWidth.state,p=a?s:e,m=Boolean(a?c:o),g=Boolean(a?d:i),h=Boolean(this.props.preserveScale||n);return{blockWidth:t,blockHeight:e,width:u,height:this.props.store.isExternalObjectInstanceBlockStore()&&"image"!==this.props.mediaType?p||f.QA:p,dragging:a,preserveScale:h,isFullWidth:m,isPageWidth:g,aspectRatio:r}}static getEmbedSourceFromBlockStore(e){const t=e.getProperties(),n=null==t?void 0:t.source,o=M.QaF(n),{display_source:i}=e.getFormat();return(0,f.Z8)(i||o)}getRenderArgs(e){const{source:t}=e,n=this.props.store.getProperties(),o=M.Jcv(n&&n.title),i=M.Jcv(n&&n.size),r=this.fileUploadStore.state,{blockWidth:a,blockHeight:s,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,aspectRatio:f}=this.getDimensions(),g=this.isRootOrDirectChild(),{device:h}=this.environment;return{store:this.props.store,source:t,blockWidth:a,blockHeight:s,aspectRatio:f,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,isRootChild:g,dataURL:r?r.dataURL:void 0,dataName:o,dataSize:i,disabled:!this.canEdit(),contentStyle:this.getContentStyle(),contentWrapStyle:this.getContentWrapStyle(),isLoading:Boolean(r),progressPercent:r?r.progressPercent:0,handleFullScreen:()=>Sn(this.props.store,this.props.blockLocation,this.environment),handleEmbedComp:e=>this.embedComp=e,viewOriginal:()=>wn(this.props.store,this.environment),inlineContentStyle:this.props.inlineContentStyle,blockLocation:this.props.blockLocation,mediaType:this.props.mediaType,imageBoxRef:this.imageBoxRef,useS3Url:h.isIOS&&h.isMobileNative}}getRendererBySource(e){var t,n;return dn.getRenderer(e,null===(t=this.fileUploadStore.state)||void 0===t?void 0:t.dataURL,this.props.mediaType??(null===(n=gn(this.props.store))||void 0===n?void 0:n.getType()))}static hasRendererForStore(e){return r.Z.withListenerIgnored((()=>Boolean(dn.getRenderer(dn.getEmbedSourceFromBlockStore(e),void 0,e.getType()))))}static getRenderer(e,t,n){if(t)return cn.image;if(e){if(e.startsWith("data:")||e.startsWith("<img"))return;const t=(0,f.Dz)({url:e,baseUrl:z.default.domainBaseUrl,publicDomainName:z.default.publicDomainName,preferredType:n});if("embed"!==t)return cn[t]}return n&&e?cn[n]:Bt}getContentWrapStyle(){const e={position:"relative"};return this.canEdit()&&(e.cursor="pointer"),this.props.centerWrappedContent&&(e.display="flex",e.justifyContent="center",e.alignItems="center",e.minHeight=220),e}getContentStyle(){const{dragging:e}=this.stores.blockResizerStore.state;return{display:"block",pointerEvents:e?"none":"auto",width:"100%"}}getActionsStyle(){const{device:e}=this.environment,{focused:t,hovered:n}=this.stores.embedBlockStore.state,{isMobile:o}=e;return{position:"absolute",top:4,right:4,borderRadius:4,color:m.ZP.white,fill:m.ZP.white,fontSize:11.5,background:pn(this.environment),display:"flex",whiteSpace:"nowrap",height:26,maxWidth:"calc(100% - 16px)",overflow:"hidden",pointerEvents:t||n||o?"auto":"none",opacity:t||n||o?1:0,transition:e.isSafari?void 0:sn,fontFamily:P.Z.getCompositeFontFamily(a.SP).sans,zIndex:2}}getBlockAlignment(){const{block_alignment:e}=this.props.store.getFormat(),t=this.isRootOrDirectChild();return e||(t?"center":"left")}getAlignmentButtonStyle(e){let t=.6;return this.getBlockAlignment()===e&&(t=1),{width:26,height:26,opacity:t}}}const un=dn;function pn(e){const{device:t}=e;return t.isMobile?m.ZP.blackWithAlpha(.3):m.ZP.blackWithAlpha(.6)}function mn(e){const t={left:v.$,center:h.L,right:b.g},n={width:14,height:14,marginRight:0,fill:m.ZP.white};return t[e](n)}function fn(e,t){return e||dn.getEmbedSourceFromBlockStore(t)}function gn(e){if("external_object_instance"!==e.getType()||(0,K.Xg)())return e}function hn(e){let{isPlaceholder:t,blockLocation:n,store:o}=e;const i=F.qC(n),r=i?"comment_media":"default";return(0,Se.jsx)(Ve.Z,{store:o,fadeIn:!1,iconStyle:t?void 0:{fill:m.ZP.white},actionSectionGroupKey:r,hideFilterActionsInput:i,hoveredStyle:rn,tooltipContent:(0,Se.jsx)(A.FormattedMessage,{defaultMessage:"More actions",id:"embedBlock.actionButton.tooltip.blockActionMenu"})})}function vn(e,t,n){const o=gn(t);if(!o)return;const i=q.qQ(n);D.bO(n,{pastedText:e,source:"embed_block_menu"});const r=J.default.mark("embed_render_complete");F.I(n,{source:e,isDataURL:!1,store:o,pageWidth:i,preferredType:t.getType(),metric:r})}function bn(e,t){const n={display:"flex"};return F.qC(t)&&(n.display="inline-flex",n.maxHeight=240),"audio"===e.rendererType&&(n.display="flex"),n}function yn(e,t){const n={display:"flex"};return F.qC(e)&&(n.borderWidth=1,n.borderColor=t.regularDividerColor,n.marginBottom=10,n.borderRadius=3),n}function _n(e,t){const n=e.getPropertyStore("caption");U.eP({environment:t,store:e}),L.NX({store:n});const o=e.getType();o&&R.Fn4(t,{type:"caption",block_type:o,block_id:e.id})}function Sn(e,t,n){j.dK({blocks:[e],blockLocationOfTargetBlock:t});const o=e.getType();o&&R.Fn4(n,{type:"full_screen",block_type:o,block_id:e.id})}function wn(e,t){const n=gn(e);if(n){F.qL(t,{store:n,from:"view_original"});const o=n.getType();o&&R.Fn4(t,{type:"original",block_type:o,block_id:e.id})}}function kn(e){let{store:t,blockLocation:n}=e;window.__c={n:"ExpandButtonComponent"};const o=(0,d.Fg)(),i=(0,s.O7)();return(0,Se.jsx)(We.Z,{style:{position:"absolute",right:12,top:12,background:o.buttonBackground},icon:e=>(0,k.s)({...e,width:16,height:16}),hoveredStyle:{background:o.buttonHoveredBackground},pressedStyle:{background:o.buttonPressedBackground},onClick:()=>Sn(t,n,i),children:(0,Se.jsx)(A.FormattedMessage,{id:"embedBlock.expandFullScreen.button.label",defaultMessage:"Expand"})})}},86329:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(24405),i=n(68709),r=n(64921),a=n(68785),s=n(32854),l=n(40148),c=n(85893);const d=function(e){let{isLoading:t,file:n,name:a,size:s,progressPercent:d,style:m,iconSvg:f,onClick:g,disabled:h,right:v,shouldHideRight:b,children:y}=e;window.__c={n:"EmbedPlaceholder"};const _=(0,o.Fg)();return t?(0,c.jsx)(u,{file:n,name:a,size:s,progressPercent:d,style:m,iconSvg:f}):(0,c.jsx)(i.p,{allowSelectionWithin:!1,style:p(_),children:(0,c.jsx)(r.Z,{onClick:g,disabled:h,children:(0,c.jsx)(l.ZP,{style:{background:void 0,...m},iconSvg:f,right:v,shouldHideRight:b,children:y})})})};function u(e){let t,{file:n,name:o,size:i,progressPercent:r,style:d,iconSvg:u}=e;return t=n?(0,c.jsxs)("div",{children:[o,(0,c.jsx)("div",{style:l.Lw,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("div",{children:[i," ","â€“"," "]}),(0,c.jsx)(a.Z,{style:{marginLeft:3,marginRight:3}}),(0,c.jsx)(s.Z,{percentage:r})]})})]},"FileLoadingSpinner"):(0,c.jsx)("div",{children:(0,c.jsx)(a.Z,{style:{marginLeft:3,marginRight:3}})},"LoadingSpinner"),(0,c.jsx)(l.ZP,{style:d,iconSvg:u,children:t})}function p(e){return{background:e.embedPlaceholderBackground,width:"100%",borderRadius:4}}},3702:(e,t,n)=>{n.d(t,{Z:()=>T});var o=n(67294),i=n(83355),r=n(13991),a=n(480),s=n(24405),l=n(8848),c=n(75e3),d=n(72126),u=n(20852),p=n(70203),m=n(82990),f=n(9291),g=n(25888),h=n(83631),v=n(18514),b=n(69015),y=n(42922),_=n(36488),S=n(16354),w=n(53437),k=n(22492),I=n(85893);const x={popup:{width:400,display:"flex",flexDirection:"column"},popupInputForm:{display:"flex",alignItems:"center",padding:"8px 10px",width:"100%"},mobilePreview:{padding:"4px 8px",height:80,display:"flex",alignItems:"center",justifyContent:"center"},mobilePreviewValue:{overflow:"auto"},equationInput:{fontFamily:m.Z.getCompositeFontFamily(r.SP).mono,fontSize:14,marginRight:8,flex:1,wordBreak:"break-word",maxHeight:"50vh",overflow:"auto"},equationInputBlock:{minHeight:60},equationInputSlideUp:{height:100},submitButton:{alignSelf:"flex-start"},enterIcon:{height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2},errorContainer:{color:l.ZP.redWithAlpha(.8),fontSize:12,padding:"8px 10px"},errorLabel:{fontWeight:600},learnMoreLink:{display:"inline",textDecoration:"underline"}};class C extends i.Z{constructor(){super(...arguments),this.input=o.createRef(),this.renderPopup=()=>{const{isOpen:e}=this.props,t=A(this.theme),n={...x.popupInputForm,...t.popupInputForm},i=(0,I.jsxs)("div",{style:n,children:[this.renderInput(),(0,I.jsx)(D,{error:this.props.error,disabled:this.props.disabled,isOpen:this.props.isOpen,onSubmit:this.props.onSubmit,onDismiss:this.props.onDismiss})]});return(0,I.jsx)(_.Z,{capture:e,allowEsc:!0,render:()=>P(this.environment)===w.ZP.PopupType.SlideUp?(0,I.jsxs)(o.Fragment,{children:[(0,I.jsx)(E,{equationValue:this.props.equationValue,error:this.props.error,displayMode:this.props.displayMode,isOpen:this.props.isOpen}),i]}):(0,I.jsxs)(o.Fragment,{children:[i,(0,I.jsx)(B,{isOpen:this.props.isOpen,error:this.props.error})]})})}}didMount(){this.environment.KatexStore.loadIfNeeded((()=>[(0,p.qZ6)("")]))}getSelection(){if(!this.input)return;if(!this.input.current)return;const e=this.input.current.getSelection();return"contain"===(null==e?void 0:e.type)?e.selection:void 0}renderComponent(){const{isOpen:e,onDismiss:t,origin:n,originRect:o,originGap:i,popupStyle:r}=this.props,a=P(this.environment);return(0,I.jsx)(w.ZP,{popupType:a,open:e,origin:n,originRect:o,originGap:i,keepFocus:a===w.ZP.PopupType.SlideUp,onDismiss:t,style:{...x.popup,...r},render:()=>this.renderPopup()})}renderInput(){const{disabled:e,isOpen:t,equationValue:n,onLeft:o,onRight:i,onDismiss:r,displayMode:a}=this.props,s=A(this.theme),l=P(this.environment)===w.ZP.PopupType.SlideUp,c=!e&&!l,p=l?{type:b.b.Textarea}:{type:b.b.InlineWrap,onSubmit:e=>R(e,this.props.isOpen,this.props.disabled,this.props.error,this.props.onSubmit,this.props.onDismiss)},m={...x.equationInput,..."block"===a&&x.equationInputBlock,...l&&x.equationInputSlideUp},f={...m,...s.equationInputPlaceholder};return(0,I.jsx)(b.Z,{ref:this.input,...p,disabled:e,focus:t,selectAll:c,value:n||"",placeholder:M(this.props.displayMode),getHtml:e=>function(e,t){return t.highlight(d.AK(e),t.languages[u.PrismLanguages.latex],u.PrismLanguages.latex)}(e,this.props.Prism),onChange:e=>function(e,t,n,o,i){if(!t)return;n(e,h.by({environment:i,equation:e,displayMode:o}))}(e,this.props.isOpen,this.props.onChange,this.props.displayMode,this.environment),onCancel:r,onLeft:o,onRight:i,placeholderStyle:f,style:m,autoCorrect:"off",autoCapitalize:"off"})}}C.displayName="EquationInputPopup";const T=C;function M(e){return"block"===e?"|x| = \\begin{cases}Â Â Â Â Â Â Â Â Â Â Â Â Â \nÂ Â x, &\\quad x \\geq 0 \\\\Â Â Â Â Â Â Â Â Â Â Â \nÂ -x, &\\quad x < 0Â Â Â Â Â Â Â Â Â Â Â Â Â \n\\end{cases}":"E = mc^2"}function P(e){const{device:t}=e,n=t.isPhone&&t.isIOS&&t.isMobileBrowser;return t.isPhone&&!n?w.ZP.PopupType.SlideUp:w.ZP.PopupType.Popup}function A(e){return{popupInputForm:{background:e.inputBackground},errorContainerDesktop:{boxShadow:`0 -1px ${e.lightDividerColor}`},equationInputPlaceholder:{color:e.lightTextColor}}}function R(e,t,n,o,i,r){e.preventDefault&&e.preventDefault(),n||t&&(o||(i(),r()))}function D(e){let{error:t,disabled:n,isOpen:o,onSubmit:i,onDismiss:r}=e;return n?null:(0,I.jsxs)(y.Z,{onClick:e=>R(e,o,n,t,i,r),disabled:n||Boolean(t),style:x.submitButton,children:[(0,I.jsx)(f.FormattedMessage,{defaultMessage:"Done",id:"equationInput.submitButton.label"}),(0,c.U)(x.enterIcon)]})}function B(e){let{isOpen:t,error:n}=e;window.__c={n:"EquationErrorComponent"};const o=(0,s.Fg)(),i=(0,a.O7)();if(!t)return null;const r=P(i)===w.ZP.PopupType.Popup;if(!n)return null;const l=n.message.replace("KaTeX parse error: ",""),c={...x.errorContainer,...r&&A(o).errorContainerDesktop};return(0,I.jsxs)("div",{role:"alert",style:c,children:[(0,I.jsx)("span",{style:x.errorLabel,children:(0,I.jsx)(f.FormattedMessage,{defaultMessage:"Invalid equation:",id:"equationInput.inputError.label"})})," ",l,". ",(0,I.jsx)(S.Z,{href:(0,v.UY)("guides.equations"),external:!0,onClick:()=>{g.Fs(i,{from:"equation_input"})},style:x.learnMoreLink,children:(0,I.jsx)(f.FormattedMessage,{defaultMessage:"Learn more",id:"equationInput.inputError.learnMore"})})]})}function E(e){let{equationValue:t,error:n,displayMode:o,isOpen:i}=e;window.__c={n:"MobilePreviewComponent"};const r=(0,s.Fg)();return t?(0,I.jsx)("div",{style:x.mobilePreview,children:n?(0,I.jsx)(B,{isOpen:i,error:n}):"block"===o?(0,I.jsx)(k.Z,{display:o,equation:t,style:x.mobilePreviewValue,theme:r}):(0,I.jsx)(k.Z,{display:o,equation:t,style:x.mobilePreviewValue,theme:r,index:0,isTemporary:!1})}):null}},22492:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(83355),i=n(98923),r=n(9291),a=n(83631),s=n(77907),l=n(85893);class c extends o.Z{didMount(){super.didMount(),a.bc()}renderComponent(){return(0,l.jsx)(s.DependencyConsumer,{dependency:s.deps.katex,children:e=>(0,l.jsx)(i.MW,{katex:e,...this.props})})}}c.displayName="EquationValue";const d=(0,r.injectIntl)(c)},42782:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),i=n(73935),r=n(480),a=n(98742),s=n(3386),l=n(53437);const c=()=>{const[e,t]=o.useState({x:0,y:0});return o.useEffect((()=>{const e=e=>{t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),e};var d=n(85893);const u=e=>{let{x:t,mouseX:n}=e;return n>t?void 0:-Math.max(t-n,10)+"px"},p=e=>{let{x:t,width:n,mouseX:o}=e;return o>t?-Math.max(o-(t+n),10)+"px":void 0},m=e=>{let{x:t,width:n,mouseX:o}=e;return o>t?`${Math.max(o-(t+n),10)}px`:`${Math.max(t-o,10)}px`},f=e=>{let{x:t,y:n,height:o,mouseX:i,mouseY:r}=e;return i>t?`polygon(0% 0%, 0% 100%, 100% ${100*(r-n)/o}%)`:`polygon(100% 0%, 0% ${100*(r-n)/o}%, 100% 100%)`};function g(e){window.__c={n:"ExtensionMenuSafeArea"};const{x:t=0,y:n=0,height:o=0,width:i=0}=e.el.getBoundingClientRect()||{},{x:r,y:a}=c(),s={x:t,y:n,height:o,width:i,mouseX:r,mouseY:a},l={right:p(s),left:u(s),height:o,width:m(s),clipPath:f(s)};return(0,d.jsx)("div",{style:{cursor:"pointer",position:"absolute",top:0,...l}})}function h(e,t){let{onClick:n,renderOrigin:c,renderExtension:u,allowOptionalExtensionMenu:p,...m}=e;window.__c={n:"ExtensionMenuItem"};const{disableDefaultClick:f,onFocus:h,focused:v,openOnFocus:b}=m,y=(0,r.Fy)(),[_,S]=(0,o.useState)(!1),w=(0,o.useRef)(null),k=(0,o.useRef)(null),I=(0,o.useRef)(null),x=(0,o.useRef)(null),C=(0,o.useCallback)((()=>{I.current&&window.clearTimeout(I.current),x.current&&window.clearTimeout(x.current),I.current=null,x.current=null}),[]),T=(0,o.useCallback)((()=>{C(),_||S(!0)}),[_,C]),M=(0,o.useCallback)((()=>{C(),_&&S(!1)}),[_,C]),P=(0,o.useCallback)((e=>{C(),_||(e&&e.preventDefault&&e.preventDefault(),I.current=window.setTimeout(T,120))}),[_,C,T]),A=(0,o.useCallback)((()=>{C(),_&&(x.current=window.setTimeout(M,100))}),[_,M,C]),R=(0,o.useCallback)((e=>{h(),T(),p&&(null==n||n(e),M())}),[h,T,p,n,M]),D=(0,o.useCallback)((()=>{P()}),[P]),B=(0,o.useCallback)((()=>{h(),P()}),[h,P]),E=(0,o.useCallback)((e=>{if(y.isPhone)return;const t=i.findDOMNode(w.current);_&&t&&!t.contains(e.target)&&M()}),[_,M,y.isPhone]),F=(0,o.useCallback)((e=>{13===e.keyCode&&_&&M()}),[_,M]);(0,o.useEffect)((()=>{if(!Boolean(f))return window.addEventListener("click",E),()=>{window.removeEventListener("click",E)}}),[f,E]),(0,o.useEffect)((()=>(window.addEventListener("keydown",F),()=>{window.removeEventListener("keydown",F)})),[F]);const Z=(0,o.useRef)(v);(0,o.useEffect)((()=>{b&&!Z.current&&v?P():!v&&Z.current&&A(),Z.current=v}),[v,b,P,A,y.isMobile]);const V={...(0,a.Z)({onMouseEnter:D,onClick:R},m),showExtensionArrow:!0};return(0,d.jsx)(s.Z,{capture:v,onEnter:_?void 0:P,onRight:P,onLeft:_?A:void 0,onEsc:_?A:void 0,children:(0,d.jsx)(l.ZP,{popupType:y.isPhone?l.ZP.PopupType.SlideUp:l.ZP.PopupType.Popup,open:_,origin:c(V,t),placementToOrigin:l.ZP.Placement.Right,alignmentToOrigin:l.ZP.Alignment.Center,originGap:0,disableMouseCapture:!0,preventBlockRenderQueueOnEnter:!0,preventScaleTransition:!y.isPhone,preventCaptureEsc:!0,ref:w,render:()=>(0,d.jsxs)(d.Fragment,{children:[k.current&&(0,d.jsx)(g,{el:k.current}),(0,d.jsx)("div",{ref:k,children:u({onMouseEnter:B},{close:A})})]}),style:{overflow:"visible"},trapFocus:!0})})}const v=o.forwardRef(h)},19987:(e,t,n)=>{n.d(t,{Z:()=>ee});var o=n(67294),i=n(83355),r=n(480),a=n(86628),s=n(24405),l=n(84939),c=n(8848),d=n(77657),u=n(42853),p=n(56666),m=n(44495),f=n(60291),g=n(54497),h=n(90965),v=n(82990),b=n(9291),y=n(57549),_=n(89475),S=n(42858),w=n(82530),k=n(12170),I=(n(95477),n(70764)),x=n(41232),C=n(33929),T=n(77907),M=n(80444),P=n(30874),A=n(31194),R=n(1634),D=n(64921),B=n(31945),E=n(51077),F=n(89728),Z=(n(57658),n(74155)),V=n(37612),j=n(893),U=n(47307),L=n(12714),O=n(87279),N=n(18514),z=n(52275),W=n(78140),q=n(32163),H=n(72495),K=n(85893);const G=(0,b.defineMessages)({copiedDebuggingInfo:{id:"externalObjectBlock.errorDropdown.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."}});function $(e){window.__c={n:"ExternalObjectInstanceErrorMenu"};const{state:t,store:n,onUpdate:o,onReplace:i,onAuthenticate:l,onRemove:u,description:p,statusCode:m,errorDescription:g,isInlineMenu:h}=e,{userHasBotForIntegration:v,pattern:_,integration:S,botIds:w,originalUrl:k}=t,I=(0,r.Fy)(),x=(0,r.O7)(),C=(0,s.yK)((e=>({menuIcon:{fill:e.regularIconColor,width:16},redThemeColor:(0,c.fi)("red",e)})),[]),T=(0,a.VK)((()=>{var e;return Boolean(null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())}),[]),P=(0,a.VK)((()=>n.isExternalObjectInstanceBlockStore()),[n]),A=(0,a.VK)((()=>n.isExternalObjectInstancePageBlockStore()),[n]);let R;R=I.isMobile?{menuType:O.og.ActionSheet}:{menuType:O.og.Popup,minWidth:220};const D={key:"remove",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Remove",id:"unfurling.errorOptions.removeAction.title"}),style:{color:C.redThemeColor.color},icon:(0,V.y)({fill:C.redThemeColor.fill,width:16}),...e}),action:()=>{null==u||u()}},B={key:"replace",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Change URL",id:"unfurling.errorOptions.replace.title"}),icon:(0,f.b)(C.menuIcon),...e}),action:()=>{i()}},F={key:"update",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Try again",id:"unfurling.errorOptions.tryAgainAction.title"}),icon:(0,f.b)(C.menuIcon),...e}),action:()=>{null==o||o()}},$={key:"authenticate",render:e=>(0,K.jsx)(z.Z,{title:v?401===m?(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Re-authenticate account",id:"unfurling.errorOptions.authenticateAction.reAuthenticate.title"}):h?(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect a different account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticatedCompact.title"}):(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect a different {integration} account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticated.title",values:{integration:S.name}}):(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect {integration} account",id:"unfurling.errorOptions.authenticateAction.notAuthenticated.title",values:{integration:S.name}}),icon:(0,K.jsx)(E.Z,{type:"image_url",imageURL:S.icon,size:16}),...e}),action:()=>{null==l||l()}},Q=[{key:"learn",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Learn more about this error",id:"unfurling.errorOptions.learnMore.title"}),icon:(0,Z.u)(C.menuIcon),...e}),action:()=>{U.showDialog({items:[{label:(0,K.jsx)(b.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.reviewGuide",defaultMessage:"View guide"}),color:"blue",onAccept:()=>{L.D({environment:x,url:(0,N.UY)("guides.unfurling")}),y.SC(x,{integrationId:S.id,entity:null==_?void 0:_.name,statusCode:m})}},{label:(0,K.jsx)(b.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.copyDebugData",defaultMessage:"Copy debugging information"}),color:void 0,onAccept:()=>{const e={statusCode:m,integrationId:S.id,botIds:w,url:k,debugMessage:g};j.RD({environment:x,stringValue:JSON.stringify(e,null,2),copiedMessage:G.copiedDebuggingInfo})}}],showCancel:!0,keepFocus:!1,message:p})}}];return T&&("error"===t.type?Q.push(B):("placeholder"===t.type?Q.push(B):Q.push(F),(P||A&&[d.f3,d.mQ].includes(S.id))&&Q.push($))),u&&Q.push(D),(0,K.jsx)(W.Z,{...R,children:(0,K.jsx)(q.Z,{type:q.i.Vertical,initialFocus:h?void 0:0,sections:[{key:0,render:e=>(0,K.jsx)(H.Z,{...e,disableDesktopPadding:h,title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Try these options",id:"unfurling.errorOptions.menuTitle"})}),items:Q}]})})}class Q extends i.Z{constructor(){super(...arguments),this.renderComponent=()=>{var e,t;const n=this.stateStore.state;if(!n)return;const{integration:o,action:i}=n,{r,g:a,b:s}=o.accentColor,c=`rgba(${r},${a},${s},${te(this.environment)?.6:1})`,d=Boolean(null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()),u=M.default.state.currentSpaceStore&&this.environment.currentUser.id&&(0,h.wv)({permissions:M.default.state.currentSpaceStore.getPermissionItems()},this.environment.currentUser.id)||(0,h.hU)({spaceBotSettings:null===(t=M.default.state.currentSpaceStore)||void 0===t?void 0:t.getBotSettingsStore().getValue(),integrationId:o.id,env:"production"}),p={state:n,store:this.props.store,onUpdate:()=>{ie({from:"external_object_instance_block_error_dropdown"},this.props.store,this.environment,this.props.postActionCallback)},onAuthenticate:()=>{this.handleAuthenticateClick({from:"external_object_instance_block_error_dropdown"})},onReplace:()=>{var e,t;null===(e=(t=this.props).openPlaceholderMenu)||void 0===e||e.call(t)}},m={...p,onRemove:()=>{this.handleRemove()}};return(0,K.jsxs)(K.Fragment,{children:["authenticate"===i&&(0,I.sw)(this.environment)&&d&&u&&(0,K.jsx)(F.Z,{icon:e=>(0,K.jsx)(E.Z,{type:"image_url",imageURL:o.accentIcon,size:20,style:{...e,width:16,height:16,marginRight:8,marginLeft:2}}),onClick:()=>this.handleAuthenticateClick({from:"external_object_instance_block"}),style:{...ne(this.theme,this.props.buttonStyle),background:c,fontSize:14,height:32,paddingRight:12,color:te(this.environment)?this.theme.regularTextColor:this.theme.regularInvertedTextColor},hoveredStyle:{background:(0,l._j)(c,.4)},pressedStyle:{background:(0,l._j)(c,.9)},children:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect to {integration} to update",id:"unfurling.authenticateButton.title",values:{integration:n.integration.name}})}),"update"===i&&(0,K.jsx)(re,{store:this.props.store,postActionCallback:this.props.postActionCallback,buttonStyle:this.props.buttonStyle,isHoverPreview:this.props.isHoverPreview}),"error"===i&&(this.props.isHoverPreview?(0,K.jsx)(X,{...p}):(0,K.jsx)(J,{...m,style:ne(this.theme,this.props.buttonStyle)})),!i&&this.props.renderDefaultAction?(0,K.jsx)(oe,{renderDefaultAction:this.props.renderDefaultAction,buttonStyle:this.props.buttonStyle,store:this.props.store}):null]})},this.handleAuthenticateClick=e=>{var t,n,o,i;let{from:r}=e;const a=null===(t=this.stateStore.state)||void 0===t?void 0:t.originalUrl,{currentSpaceStore:s}=M.default.state;if(!s)return;const l=null===(n=(0,x.GQ)(a,s.id))||void 0===n?void 0:n.integration;l&&a&&(_.hM({environment:this.environment,integration:l,spaceId:s.id,unfurlUrl:a,externalObjectInstanceBlockId:this.props.store.id,from:r}),R.Z.reset(),null===(o=(i=this.props).postActionCallback)||void 0===o||o.call(i))},this.stateStore=this.createComputedStore((()=>(0,x._l)({store:this.props.store,isInDarkMode:te(this.environment),canEdit:this.props.canEdit,currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc})),!0)}handleRemove(){var e,t;w.createAndCommit({userAction:"ExternalObjectInstanceAction.handleRemove",environment:this.environment,perform:e=>{S.Cl({environment:this.environment,blocks:[this.props.store],transaction:e})}});const n=this.stateStore.state;var o;n&&y.oQ(this.environment,{integrationId:n.integration.id,entity:null===(o=n.pattern)||void 0===o?void 0:o.name});null===(e=(t=this.props).postActionCallback)||void 0===e||e.call(t)}}function Y(e){const t=(0,a.VK)((()=>{var t;return e.isCollectionView()?null===(t=e.getCollectionViewCollectionStore())||void 0===t||null===(t=t.getFormat().error)||void 0===t?void 0:t.status_code:e.getFormatStore().getKeyStore("error").getKeyStore("status_code").getValue()}),[e]),n=(0,a.VK)((()=>{let t;var n;e.isCollectionView()?t=null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat().bot_id:t=e.getFormat().bot_id;const o=P.Z.bots.state.find((e=>e.id===t));if(o)return(0,d.s9)(o.integration_id)}),[e]),{message:i,description:r}=o.useMemo((()=>(0,I.xt)(t,n)),[t,n]);return{statusCode:t,message:i,description:r}}function J(e){window.__c={n:"ErrorPopupButton"};const{onAuthenticate:t,onReplace:n,onUpdate:o,state:i,store:r,onRemove:a,style:l}=e,d=(0,s.yK)((e=>({orangeThemeColor:(0,c.fi)("orange",e),dropdownIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),{statusCode:p,message:m,description:f}=Y(r);return(0,K.jsx)(B.ZP,{popupType:B.Z4.Popup,originGap:4,renderOrigin:e=>(0,K.jsxs)(F.Z,{style:l,icon:e=>(0,g.t)({...e,fill:d.orangeThemeColor.fill}),...e,children:[(0,K.jsx)("span",{children:C.default.formatMessage(m)}),(0,u.i)(d.dropdownIcon)]}),render:e=>(0,K.jsx)($,{state:i,store:r,onUpdate:o?()=>{o(),e.close()}:void 0,onAuthenticate:t?()=>{t(),e.close()}:void 0,onReplace:()=>{n(),e.close()},onRemove:a?()=>{a(),e.close()}:void 0,statusCode:p,errorDescription:f.description,description:C.default.formatMessage(f,{integrationName:i.integration.name,statusCode:p})})})}function X(e){window.__c={n:"ErrorInlineMenu"};const{onAuthenticate:t,onReplace:n,onUpdate:o,state:i,store:r,onRemove:a}=e,l=(0,s.yK)((e=>({orangeThemeColor:(0,c.fi)("orange",e)})),[]),{statusCode:d,message:u,description:p}=Y(r);return(0,K.jsxs)("div",{style:{alignSelf:"stretch"},children:[(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,fontWeight:v.Z.fontWeight.medium,marginBottom:4},children:[(0,g.t)({width:18,height:18,marginRight:6,fill:l.orangeThemeColor.fill}),(0,K.jsx)("span",{children:C.default.formatMessage(u)})]}),(0,K.jsx)("div",{style:{margin:"0 -14px"},children:(0,K.jsx)($,{state:i,store:r,onUpdate:o,onAuthenticate:t,onReplace:n,onRemove:a,statusCode:d,errorDescription:p.description,description:C.default.formatMessage(p,{integrationName:i.integration.name,statusCode:d}),isInlineMenu:!0})})]})}Q.displayName="ExternalObjectInstanceAction";const ee=Q;function te(e){return"dark"===e.ThemeStore.state.mode}function ne(e,t){return{marginRight:4,color:e.mediumTextColor,...t}}function oe(e){let{renderDefaultAction:t,buttonStyle:n,store:o}=e;window.__c={n:"DefaultActionComponent"};const i=(0,s.Fg)(),a=(0,r.O7)(),{isMobile:l}=a.device;return(0,K.jsx)(B.ZP,{popupType:l?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,K.jsx)(D.Z,{...e,mobileFeedback:l,style:{display:"flex",alignItems:"center",justifyContent:"center",width:l?36:28,height:l?36:28,borderRadius:4,flexShrink:0,opacity:"shown"===t?1:0,...ne(i,n)},children:(0,p.o)({width:l?18:14,color:i.mediumIconColor})}),placementToOrigin:A.Iw.Bottom,render:e=>(0,K.jsx)(T.LazyExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,K.jsx)(b.FormattedMessage,{id:"linkPreview.reload",defaultMessage:"Reload preview"}),store:o,onAccept:()=>e.close(),extraSecondaryItemKey:"preview_to_mention"})})}function ie(e,t,n,o){var i;const{from:r}=e,a=null===(i=M.default.state.currentSpaceStore)||void 0===i?void 0:i.id;a&&(k.qK({environment:n,from:r,store:t,spaceId:a,bypassCache:"external_object_instance_block_error_dropdown"===r}),null==o||o())}function re(e){let{store:t,postActionCallback:n,buttonStyle:o,isHoverPreview:i}=e;window.__c={n:"UpdateActionComponent"};const a=(0,s.Fg)(),l=(0,r.O7)(),c=(0,K.jsx)(F.Z,{onClick:()=>ie({from:"external_object_instance_block"},t,l,n),style:ne(a,o),icon:e=>(0,f.b)({...e}),children:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Update",id:"unfurling.updateButton.title"})});return i?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,marginBottom:4},children:[(0,m.D)({width:18,height:18,marginRight:6}),(0,K.jsx)("span",{children:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"This link preview is out-of-date.",id:"unfurling.updateButton.header"})})]}),c]}):c}},14562:(e,t,n)=>{n.d(t,{Z:()=>P});var o=n(67294),i=n(24405),r=n(8848),a=n(76725),s=n(72126),l=n(97880),c=n(82990),d=n(44876),u=n(12170),p=n(95645),m=n(41232),f=n(6398),g=n(68859),h=n(49085);class v extends h.default{getInitialState(){return{error:!1,loading:!1}}}const b=v;var y=n(68709),_=n(51077),S=n(12981),w=n(84076),k=n(68785),I=n(81865),x=n(97496),C=n(19987),T=n(85893);class M extends p.Z{constructor(){super(...arguments),this.origin=o.createRef(),this.storeTypes={externalObjectTokenStore:b,blockResizerStore:g.Z},this.state={isHovered:!1},this.stateStore=this.createComputedStore((()=>{return(0,m._l)({store:this.props.store,isInDarkMode:(e=this.environment,"dark"===e.ThemeStore.state.mode),canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc});var e}),!0),this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}renderPersisted(){const e=this.stateStore.state;if(!e)return this.renderShimmerState();const t=(0,m.y6)(this.props.store);if("error"===e.type&&(null==t||!t.integration_id))return this.renderShimmerState();const{renderConfig:n}=e;return(0,T.jsx)(y.p,{allowSelectionWithin:!0,children:n.previewAttributes&&(0,l.Of)(n.previewAttributes)?this.renderEmbedPreview({attributes:n.previewAttributes,state:e}):this.renderLinkBox(e)})}renderLinkBox(e){var t;const{originalUrl:n,renderConfig:o,integration:i,updating:r}=e,{store:s}=this.props,d="placeholder"===e.type,u="error"===e.type,p=this.state.isHovered||this.environment.device.isMobile,g=n&&(0,m.pI)(n,s.pointer.spaceId);return(0,T.jsxs)(w.Z,{ref:this.origin,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{flexGrow:1,minWidth:0,...(d||u)&&{background:this.theme.embedPlaceholderBackground}},innerStyle:this.getStyle({hasPreview:!(!Boolean(o.previewAttributes)||!o.previewAttributes)&&(0,l.Of)(o.previewAttributes)}),...d||u?{onClick:()=>{const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}}:{href:g,external:!0},children:[(0,T.jsx)("div",{style:{display:"flex",alignSelf:"start",height:32,width:32,marginRight:12,marginLeft:4,marginTop:3,marginBottom:3,position:"relative"},children:(0,T.jsx)(D,{renderConfig:o,integrationIcon:i.icon})}),(0,T.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,flexShrink:1,overflow:"hidden"},children:[(0,T.jsxs)("div",{style:{display:"flex",alignItems:"baseline",fontSize:14},children:[(0,a.Z)((null===(t=o.headerAttributes)||void 0===t?void 0:t.map(((e,t)=>{return(0,T.jsx)(f.ox,{...e,store:this.props.store,style:0===t?(n=this.theme,{fontWeight:c.Z.fontWeight.medium,...c.Z.textOverflowStyle,color:n.regularTextColor}):{}},`attribute-${t}`);var n})))||[],(e=>(0,T.jsx)("span",{style:{marginRight:6}},`spacer-${e}`))),(r||this.stores.externalObjectTokenStore.state.loading)&&(0,T.jsx)(k.Z,{style:{marginLeft:6}})]}),o.bodyAttribute&&(0,T.jsx)(f.hx,{attribute:o.bodyAttribute}),(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.mediumTextColor,fontSize:12},children:[o.subheaderIcon&&(0,T.jsx)(E,{attribute:o.subheaderIcon}),o.subheaderAttributes&&(0,a.Z)(o.subheaderAttributes.map((e=>(0,T.jsx)(A,{attributeConfig:e,store:this.props.store},e.attribute.id))),(e=>(0,T.jsx)("span",{style:{marginLeft:3,marginRight:3},children:"â€¢"},e)))]})]}),(0,T.jsx)(C.Z,{canEdit:this.canEdit(),forceActionForUIDoc:this.props.forceActionForUIDoc,store:this.props.store,renderDefaultAction:p?"shown":"invisible",buttonStyle:o.bodyAttribute?{alignSelf:"flex-start",marginTop:4}:{},openPlaceholderMenu:()=>{const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}})]})}renderShimmerState(){var e;return(0,T.jsxs)(w.Z,{href:null===(e=this.stateStore.state)||void 0===e?void 0:e.originalUrl,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getStyle(),children:[(0,T.jsx)(B,{style:{width:38,height:38}}),(0,T.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,T.jsx)(B,{style:{width:"50%",height:14,margin:4}}),(0,T.jsx)(B,{style:{width:"40%",height:12,margin:4}})]})]})}renderEmbedPreview(e){const{attributes:t}=e,n=t[0],{values:o,mimeType:i}=n,r=o[0];let a;"image/*"===i?a="image":"audio/*"===i?a="audio":"video/*"===i?a="video":"application/pdf"===i?a="pdf":"text/html"===i?a="embed":(0,l.t1)(i);const s="image"===a||"pdf"===a||"embed"===a,c=this.props.store;return c.isExternalObjectInstanceBlockStore()?(0,T.jsx)("div",{style:{overflow:"hidden",borderRadius:6,border:`1px solid ${this.theme.tableDividerColor}`,borderBottom:void 0,position:"relative"},children:(0,T.jsx)(x.ZP,{store:c,source:r,showExpandButton:s,mediaType:a,...(0,m.Xg)()?{disabled:!1,preserveScale:"image"===a,blockResizerStore:this.stores.blockResizerStore}:{disabled:!0,preserveScale:!0,disableActions:!0,..."image"===a&&{centerWrappedContent:!0}},contentBelowSource:this.renderLinkBox(e.state)})}):void 0}handleCreated(){const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}getPlaceholderNode(){var e,t;if("placeholder"===(null===(e=this.stateStore.state)||void 0===e?void 0:e.type)||"error"===(null===(t=this.stateStore.state)||void 0===t?void 0:t.type)){const e=this.origin.current;if(e&&e instanceof Element)return e}}openLinkEmbedMenu(e){var t;const n=(0,m.y6)(this.props.store);u.os({originRect:e.getBoundingClientRect(),environment:this.environment,externalObjectInstanceBlockStore:this.props.store,placeholderIntegrationId:null==n?void 0:n.integration_id,integration:null===(t=this.stateStore.state)||void 0===t?void 0:t.integration,externalObjectTokenStore:this.stores.externalObjectTokenStore})}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hasPreview:t}=e;return{display:"flex",alignItems:"center",border:`1px solid ${this.theme.tableDividerColor}`,borderRadius:t?"0px 0px 4px 4px":4,borderLeft:t?"none":`1px solid ${this.theme.tableDividerColor}`,borderRight:t?"none":`1px solid ${this.theme.tableDividerColor}`,padding:"8px 12px",...this.getBlockColorStyle(),...this.props.style}}}const P=M;function A(e){let{attributeConfig:t,store:n}=e;return(0,T.jsx)(f.ox,{...t,store:n})}function R(e){return{filter:`\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n        `}}function D(e){let{renderConfig:t,integrationIcon:n}=e;window.__c={n:"BlockIconComponent"};const o=(0,i.Fg)(),r=s.mN(t.icons||[],(e=>`${e.type}:${e.values[0].toString()}`));return r.length>=2?(0,T.jsxs)("div",{style:{width:32,height:32},children:[(0,T.jsx)(f.lf,{attribute:r[0],isSmall:!0}),(0,T.jsx)(f.lf,{attribute:r[1],isSmall:!0,style:{position:"absolute",bottom:0,right:2}}),(0,T.jsx)(_.Z,{type:"image_url",imageURL:n,size:16,style:{position:"absolute",bottom:-3,right:-3},imageStyle:R(o)})]}):1===r.length?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(f.lf,{attribute:r[0],isSmall:!1}),(0,T.jsx)(_.Z,{type:"image_url",imageURL:n,size:16,style:{position:"absolute",bottom:-2,right:-2},imageStyle:R(o)})]}):(0,T.jsx)(_.Z,{type:"image_url",imageURL:n,size:38})}function B(e){let{style:t}=e;window.__c={n:"ShimmerboxComponent"};const n=(0,i.Fg)();return(0,T.jsx)("div",{style:{overflow:"hidden",position:"relative",background:n.selectLightGray[30],...t},children:(0,T.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${n.selectLightGray[30]} 0%, ${n.selectLightGray[50]} 20%, ${n.selectLightGray[30]} 40%, ${n.selectLightGray[30]} 100%)`}})})}function E(e){let{attribute:t}=e;window.__c={n:"SubheaderIconAttributeComponent"};const n=(0,i.Fg)();if((0,d.li)(t)){const e=t.values[0];return(0,T.jsx)(I.Z,{isAuthenticated:!1,url:e,width:32,render:(e,t)=>(0,T.jsx)(S.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})})}if((0,d.hW)(t)){const e=t.values[0],o=e?`rgb(${e.r},${e.g},${e.b})`:"gray",{colorName:i,shade:a}=(0,r.lL)(o);return(0,T.jsx)("div",{style:{width:12,height:12,marginRight:4,background:n.accentColors[i][a],borderRadius:4,flexShrink:0}})}return null}},69721:(e,t,n)=>{n.d(t,{S:()=>B,Z:()=>E});var o=n(67294),i=n(480),r=n(86628),a=n(49271),s=n(43593),l=n(50066),c=n(72126),d=n(62965),u=n(70203),p=n(82990),m=n(9291),f=n(57549),g=n(31781),h=n(62365),v=n(27153),b=n(24677),y=n(98104),_=n(82530),S=n(73819),w=n(27411),k=n(13966),I=n(91893),x=n(23864),C=n(64921),T=n(64369),M=n(86329),P=n(78454),A=n(85893);const R=(0,m.defineMessages)({fileTitle:{defaultMessage:"File",id:"fileBlock.fileTab.title"},embedButtonText:{defaultMessage:"Embed link",id:"fileBlock.embedButton.label"},embedFilePrompt:{defaultMessage:"Paste a file linkâ€¦",id:"fileBlock.linkPrompt.placeholder"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePenâ€¦",id:"fileBlock.linkPrompt.caption"}});function D(e,t){window.__c={n:"FileBlock"};const n=(0,m.useIntl)(),a=(0,i.O7)(),s=(0,i.Fy)(),d=(0,o.useRef)(null),p=(0,o.useId)(),[C,T]=(0,o.useState)(!1),P=(0,S.PE)(e.store,e.disabled),D=(0,S.rv)(e.store),E=(0,r.VK)((()=>{const t=e.store.getProperties(),n=t&&t.source,o=u.QaF(n),{display_source:i}=e.store.getFormat();return i||o}),[e.store]),F=(0,r.VK)((()=>w.default.getKeyState(w.default.getBlockKey(e.store.id))),[e.store.id]),Z=s.isMobile||C,V=(0,r.VK)((()=>e.store.getProperties()),[e.store]),j=(0,o.useMemo)((()=>u.Jcv(V&&V.title)),[V]),U=(0,o.useMemo)((()=>u.Jcv(V&&V.size)),[V]),L=Z&&P&&(0,A.jsx)(k.Z,{style:{marginRight:4},store:e.store,fadeIn:!0}),O=(0,o.useCallback)((()=>{const t=e.store.getPropertyStore("caption");b.eP({environment:a,store:e.store}),y.NX({store:t})}),[a,e.store]),N=(0,o.useCallback)((t=>{_.createAndCommit({userAction:"FileBlock.handleUpload",environment:a,perform:t=>{h.v({environment:a,store:e.store,source:void 0,name:void 0,size:void 0,transaction:t})}}),h.c({environment:a,store:e.store,file:t})}),[a,e.store]),z=(0,o.useCallback)((()=>{const t=d.current;if(P&&t){const o=t.getBoundingClientRect();v.$(a,{originRect:o,originGap:0,isSmallWidth:!0,showArrow:!0,title:n.formatMessage(R.fileTitle),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:s.isAndroid,videoUpload:s.isAndroid,onUpload:N},{type:"embed",buttonText:n.formatMessage(R.embedButtonText),inputPlaceholder:n.formatMessage(R.embedFilePrompt),caption:n.formatMessage(R.embedCaption),onChange:t=>{v.Z(),_.createAndCommit({userAction:"FileBlock.handleOpenMenu",environment:a,perform:n=>{h.v({environment:a,store:e.store,source:t,name:void 0,size:void 0,transaction:n})}}),f.bO(a,{pastedText:t,source:"file_block_menu"})}}]})}}),[P,s.isAndroid,a,N,n,e.store]),W=(0,o.useCallback)((()=>{g.qL(a,{store:e.store,from:"embedded_block_click"})}),[a,e.store]),q=(0,o.useMemo)((()=>({flexGrow:1,minWidth:0,borderRadius:4,...c.CE(D,["fontSize","lineHeight"])})),[D]),H=(0,A.jsxs)("div",{role:"figure","aria-labelledby":p,ref:d,children:[(0,A.jsxs)("div",{onMouseMove:()=>T(!0),onMouseLeave:()=>T(!1),style:{display:"flex"},children:[(0,A.jsx)(B,{title:j,url:E,size:U,onClick:W,right:L,style:q}),(0,A.jsx)(x.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),(0,A.jsx)(I.Z,{store:e.store,captionAriaId:p,disabled:e.disabled})]}),K=(0,A.jsxs)("div",{onMouseMove:()=>T(!0),onMouseLeave:()=>T(!1),style:{display:"flex"},ref:d,children:[(0,A.jsx)(M.Z,{disabled:e.disabled,iconSvg:l.R,shouldHideRight:!Z,right:P&&(0,A.jsx)(k.Z,{store:e.store,fadeIn:!1}),isLoading:Boolean(F),progressPercent:F?F.progressPercent:0,file:F?F.file:void 0,name:F?F.name:void 0,size:F?F.size:void 0,onClick:z,children:(0,A.jsx)(m.FormattedMessage,{defaultMessage:"Upload or embed a file",id:"fileBlock.uploadOrEmbed.placeholder"})}),(0,A.jsx)(x.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),G=E?H:K;return(0,S.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"file",getNode:()=>d.current,getBlockStore:()=>e.store,caption:O,handleCreated:z,edit:z,activate:z,replace:z})),[O,z,e.store]),G)}function B(e){const{style:t,right:n,title:o,url:i,size:r,onClick:c}=e,d={paddingTop:a.ZD.paddingTop,paddingBottom:a.ZD.paddingBottom,paddingLeft:a.ZD.paddingLeft};return(0,A.jsx)(C.Z,{style:t,onClick:c,children:(0,A.jsx)(P.ZP,{style:d,left:(0,l.R)(),leftStyle:{width:"1.35em",height:"1.35em"},alignment:P.v2.Center,right:n,children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[(0,A.jsx)("div",{style:{...p.Z.textOverflowStyle},children:s.rF({title:o,source:i})}),r&&(0,A.jsx)(T.Z,{isSmall:!0,style:{marginLeft:6,whiteSpace:"nowrap"},children:r})]})})})}const E=o.memo(o.forwardRef(D),d.Z)},65453:(e,t,n)=>{n.d(t,{Z:()=>_});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(62965),d=n(9291),u=n(35328),p=n(73819),m=n(45131),f=n(23864),g=n(65187),h=n(17377),v=n(85893);const b=(0,d.defineMessages)({placeholder:{defaultMessage:"Heading 1",id:"header1Block.placeholder"}});function y(e,t){window.__c={n:"HeaderBlock"};const n=(0,d.useIntl)(),c=(0,i.O7)(),y=(0,i.Fy)(),_=(0,o.useRef)(null),S=(0,p.rv)(e.store),w=(0,p.Iy)(e.store),k=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),I=(0,r.VK)((()=>m.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),x=(0,a.yK)((e=>{const t=(y.isMobile?1.5:l.eV)*l.u9,n=y.isMobile?1.5:l.eV;return{root:{display:"flex",width:"100%",...S},toggle:{height:`${t}em`,marginTop:3},headerText:{...s.ZD,...(0,l.DK)({fontSizeValue:n,fontFamily:w})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[S,y.isMobile,w]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"header",getNode:()=>_.current,getBlockStore:()=>e.store,activate(){u.th(c,e.store,e.hideContent)}})),[c,e.hideContent,e.store]),(0,v.jsx)("div",{ref:_,style:{...x.root,...e.style},children:(0,v.jsxs)(h.Z,{store:e.store,toggleStyle:x.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,v.jsx)(g.Z,{tagName:"h2",disabled:e.disabled,store:k,placeholder:n.formatMessage(b.placeholder),placeholderStyle:x.headerTextPlaceholder,style:x.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,v.jsx)(f.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,recursivelyLoadAllDiscussions:!I})]})}))}const _=o.memo(o.forwardRef(y),c.Z)},83182:(e,t,n)=>{n.d(t,{Z:()=>u});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(84169),s=n(25888),l=n(52275),c=n(16354),d=n(85893);function u(e){window.__c={n:"HelpButtonMenu"};const t=(0,o.O7)();return(0,d.jsx)(c.Z,{href:e.href,external:!0,onClick:()=>s.Fs(t,{from:e.analyticsFrom}),children:(0,d.jsx)(l.Z,{icon:!e.left&&(0,d.jsx)(m,{left:e.left}),title:(0,d.jsx)(p,{title:e.title,left:e.left}),focused:!1})})}function p(e){window.__c={n:"Title"};const t=(0,o.O7)(),n=(0,i.VK)((()=>t.device.isPhone),[t]),a=(0,r.yK)((e=>({title:{fontSize:n?14:12,verticalAlign:1,color:e.lightTextColor}})),[n]);return e.left?(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("span",{style:{...a.title,marginRight:"auto"},children:e.left}),(0,d.jsx)(m,{left:e.left}),(0,d.jsx)("span",{style:a.title,children:e.title})]}):(0,d.jsx)("span",{style:a.title,children:e.title})}function m(e){let{left:t}=e;window.__c={n:"IconComponent"};const n=(0,r.Fg)(),i=(0,o.MO)();return(0,a.m)({width:i?16:14,fill:n.lightIconColor,marginRight:t?6:0})}},74523:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(24405),a=n(84169),s=n(25888),l=n(73063),c=n(16354),d=n(89728),u=n(85893);function p(e){let{title:t,href:n,analyticsFrom:p,shouldShrink:m,style:f,buttonStyle:g,isBlue:h,onClick:v,onFocus:b,onBlur:y,onMouseDown:_,onMouseEnter:S,onMouseLeave:w}=e;window.__c={n:"HelpButtonSettingsCaption"};const k=(0,i.O7)(),I={onFocus:b,onBlur:y,onMouseDown:_,onMouseEnter:S,onMouseLeave:w},x=(0,o.useCallback)((()=>{void 0!==v&&v(),s.Fs(k,{from:p})}),[p,k,v]),C=(0,r.yK)((()=>({link:{display:"flex",marginLeft:-6,...f}})),[f]);return(0,u.jsx)(c.Z,{style:C.link,className:"notion-print-ignore",href:n,external:!0,onClick:x,...I,children:t?(0,u.jsx)(d.Z,{icon:a.m,isSmall:!0,isBlue:h,isLightGray:!h,shouldShrink:m,style:g,children:t}):(0,u.jsx)(l.Z,{icon:a.m,isBlue:h,style:g,...I})})}const m=o.memo(p)},84456:(e,t,n)=>{n.d(t,{Z:()=>w});n(82801);var o=n(67294),i=n(83355),r=n(480),a=n(88464),s=n(26198),l=n(63085),c=n(12534),d=n(55367),u=n(80796),p=n(77080),m=n(49085);class f extends m.default{getInitialState(){return{disabled:!1,loaded:!1,hasPreviewBeenDismissed:!1,isVisible:!1}}}const g=f;var h=n(69784),v=n(25777),b=n(85893);const y={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};class _ extends i.Z{constructor(){super(...arguments),this.iframe=null,this.storeTypes={iframeStore:g},this.handleMouseMove=e=>{const t=d.ZP.state.isDragging,n=u.Z.state.isDragging,o=h.default.state.isActive,i=t||n||o;this.stores.iframeStore.setState({...this.stores.iframeStore.state,disabled:i})},this.releaseFocus=()=>{document.activeElement&&document.activeElement===this.iframe&&document.activeElement.blur()},this.handlePreviewMouseDown=e=>{e.preventDefault(),(0,c.ZP)({event:e,context:c.Af.EditorClick,callback:()=>{this.stores.iframeStore.setState({...this.stores.iframeStore.state,hasPreviewBeenDismissed:!0})}})}}didMountOrUpdate(){super.didMountOrUpdate(),this.releaseFocus()}renderComponent(){return(0,b.jsx)("div",{style:this.props.style,onMouseMove:this.handleMouseMove,onMouseEnter:this.handleMouseMove,onMouseLeave:this.releaseFocus,children:(0,b.jsx)("div",{style:(0,l.kl)(this.props),children:this.renderInnerContent()})})}renderInnerContent(){if(this.shouldRenderPreview())return this.renderPreview();const e=(0,l.I$)(this.props.source),t=this.getIframeStyle();return(0,b.jsx)(v.Z,{innerStyle:{height:"100%",width:"100%"},loaded:this.stores.iframeStore.state.loaded,style:y,spinnerSize:"1em",showSpinnerTimeout:500,children:e&&(0,b.jsx)(S,{ref:e=>{this.iframe=e},sourceUrl:e,wrapperStyle:{...t,backgroundColor:"none"},style:this.getIframeStyle(),allow:this.props.allow,iframeStore:this.stores.iframeStore,onContentLoadTimeout:this.props.onContentLoadTimeout})})}renderPreview(){var e,t;return(0,b.jsx)("div",{style:{...this.getIframeStyle(),backgroundColor:"none"},onMouseDown:this.handlePreviewMouseDown,children:null===(e=(t=this.props).renderPreview)||void 0===e?void 0:e.call(t)})}willUnmount(){super.willUnmount()}shouldRenderPreview(){return!(!window.__webViewTerminatedWhileAppActive&&"on"!==p.default.getGroup("embed-previews"))&&(!this.stores.iframeStore.state.hasPreviewBeenDismissed&&Boolean(this.props.renderPreview))}getIframeStyle(){return{...y,pointerEvents:this.stores.iframeStore.state.disabled?"none":"auto",backgroundColor:this.props.background?this.theme.contentBackground:"none"}}}_.displayName="IFrameBox";const S=o.forwardRef((function(e,t){window.__c={n:"ManagedIFrame"};const{sourceUrl:n,style:i,allow:l,iframeStore:c,onContentLoadTimeout:d,wrapperStyle:u}=e,m=(0,r.O7)(),[f,g]=(0,s.jo)(),h=(0,o.useRef)(void 0),v=(0,a.Z)(t,h),y=(0,o.useRef)(void 0),_=m.device.isElectron?"allow-scripts allow-popups allow-forms allow-same-origin":"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin allow-storage-access-by-user-activation",S=(0,o.useCallback)((()=>{if(p.default.checkGate("embed_block_fallback")){let t;try{t=Boolean(h.current&&h.current.contentWindow&&"about:blank"!==h.current.contentWindow.location.href)}catch(e){if(e instanceof DOMException)return;throw e}t||null==d||d()}}),[d]),w=(0,o.useCallback)((()=>{c.setState({...c.state,loaded:!0}),S()}),[S,c]);return(0,o.useEffect)((()=>(y.current=setTimeout(S,7e3),()=>{clearTimeout(y.current)})),[S]),(0,b.jsx)("div",{ref:f,style:u,children:g&&(0,b.jsx)("iframe",{ref:v,style:i,src:n,frameBorder:"0",onLoad:()=>{clearTimeout(y.current),w()},sandbox:_,allowFullScreen:!0,allow:l})})})),w=_},42402:(e,t,n)=>{n.d(t,{Z:()=>a});n(67294);var o=n(8848),i=n(16354),r=n(85893);const a=function(e){const t={display:"inline",textDecoration:"underline",color:o.ZP.inherit};return(0,r.jsx)(i.Z,{href:e.href,external:e.external,style:{...t,...e.style,...e.disableUnderline&&{textDecoration:"none"}},onClick:e.onClick,className:e.disableHover?void 0:e.showAIVersion?"notion-link-ai-version":"notion-link",onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,children:e.children})}},83785:(e,t,n)=>{n.d(t,{Z:()=>g});n(67294);var o=n(83355),i=n(68626),r=n(91155),a=n(29477),s=n(12457),l=n(88632),c=n(49085);class d extends c.default{getInitialState(){return{loaded:!1}}}const u=d;var p=n(68785),m=n(85893);class f extends o.Z{constructor(){super(...arguments),this.storeTypes={store:u}}didMount(){this.fetch()}renderComponent(){return(0,m.jsx)(s.Z,{show:!this.stores.store.state.loaded,showDelay:300,showHold:0,render:e=>this.stores.store.state.loaded?(this.props.willRender&&this.props.willRender(),this.props.render(this.stores.store.state.result)):this.props.loading?this.props.loading(e):e?(0,m.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,m.jsx)(p.Z,{})}):void 0})}async fetch(){let e=1e3;for(;;)try{const e=await this.props.fetch();this.stores.store.setState({loaded:!0,result:e});break}catch(t){i.log({level:"warning",from:"LazyLoader",type:"fetchError",error:(0,r.Ui)(t),data:{miscDataToConvertToString:{waitMs:e}}}),await a.Vs(e),await l.Z.waitUntil((()=>l.Z.state.online)),e=Math.min(2*e,3e4)}}}f.displayName="LazyLoader";const g=f},55217:(e,t,n)=>{n.d(t,{Z:()=>fe});n(57658);var o=n(67294),i=n(83355),r=n(27531),a=n(41432),s=n(72126),l=n(4615),c=n(21202),d=n(13084),u=n(82530),p=n(98165),m=n(67669),f=n(23883),g=n(26136),h=n(99757),v=n(45697),b=n.n(v),y=n(45060),_=n(95538),S=n(606),w=n(18844),k=n(15047),I=n(50906),x=n(94419),C=n(1742),T=n(92650),M=n(19037),P=n(28020),A=n(78316),R=n(78175),D=n(41232),B=n(78429),E=n(50627),F=n(17504),Z=n(65598),V=n(73959),j=n(35328),U=n(49427),L=n(24646),O=n(41662),N=n(68859),z=n(4926),W=n(77080),q=n(88923),H=n(26664),K=n(27724),G=n(45131),$=n(51247),Q=n(40971),Y=n(53223),J=n(23063),X=n(45952),ee=n(79954),te=n(5595),ne=n(85893);const oe=4,ie=4,re={quote:ie,code:ie,header:ie,bookmark:ie,external_object_instance:ie,file:void 0,video:ie,embed:ie,tweet:ie,drive:ie,audio:ie,gist:ie,maps:ie,framer:ie,invision:ie,figma:ie,loom:ie,typeform:ie,mixpanel:ie,codepen:ie,equation:ie,pdf:ie,image:ie,sub_header:void 0,sub_sub_header:void 0,page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,personal_home_page:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:ie,table_of_contents:ie,whimsical:ie,miro:ie,abstract:ie,sketch:ie,excalidraw:ie,replit:ie,hex:ie,deepnote:ie,table:1,table_row:void 0,tab:ie,external_object_instance_page:ie,button:void 0,ai_block:1,drawing:ie},ae={quote:oe,code:oe,bookmark:oe,external_object_instance:oe,file:void 0,video:oe,embed:oe,tweet:oe,audio:oe,drive:oe,gist:oe,maps:oe,framer:oe,invision:oe,figma:oe,loom:oe,typeform:oe,codepen:oe,equation:oe,pdf:oe,header:"2em",sub_header:"1.4em",sub_sub_header:"1em",image:oe,page:void 0,personal_home_page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:oe,table_of_contents:oe,whimsical:oe,miro:oe,abstract:oe,mixpanel:oe,sketch:oe,excalidraw:oe,replit:oe,table:1,table_row:void 0,tab:oe,hex:oe,deepnote:oe,external_object_instance_page:oe,button:void 0,ai_block:1,drawing:oe},se={left:"flex-start",center:"center",right:"flex-end"};class le extends i.Z{constructor(){super(...arguments),this.blockRef=o.createRef(),this.storeTypes={blockResizerStore:N.Z},this.renderPreventSidebar=()=>{const{isInlineCollectionView:e}=this.renderStateStore.state;return e?this.renderSelectable():(0,F.Z)(this.renderSelectable)},this.renderSelectable=e=>{const{store:t,canEditList:n,isFirstItem:o}=this.props,{canDropOnto:i,canDropLeftRight:r,shouldShowParentHalo:a,showHoverMenu:s,canDrag:l,canSelect:c,shouldShowSelectionHalo:d,isSimpleTable:u,showCommentMenu:p,preventBackgroundDrag:m,shouldDisableHoverMenuDrag:f,disableForceTouch:g,canTriggerContextMenu:h}=this.renderStateStore.state;return(0,ne.jsx)(ee.Z,{style:this.getStyle.state,store:t,canSelect:c,canEditText:this.canEdit(),shouldShowHalo:d,shouldShowParentHalo:a,canDrag:l,canDropAbove:n&&o,canDropBelow:n,canDropLeft:r,canDropRight:r,canDropOnto:n&&i,canNativeDropAbove:n&&o,canNativeDropBelow:n,canNativeDropLeft:r,canNativeDropRight:r,onSelectableDrop:this.handleDrop,onNativeDrop:this.handleNativeDrop,canTriggerContextMenu:h,onInsertBelow:this.handleInsertBelow,onInsertAbove:this.handleInsertAbove,canInsertAbove:n,canInsertBelow:n,onEditText:this.handleEditText,onEnter:this.handleEnter,onRemove:this.handleRemove,showBlockMenuInput:!0,shouldShowHoverMenu:s,shouldDisableHoverMenuDrag:f,disableForceTouch:g,shouldShowCommentMenu:p,shouldShowDropZone:!u,isListContainer:!0,preventBackgroundDrag:m,analyticsName:"page_content",...e,children:this.renderBlock()})},this.handleEnter=e=>{this.blockRef.current&&this.blockRef.current.edit?this.blockRef.current.edit():d.Bm({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.listStore,isAtStartOfLine:!1,isClick:!1,transaction:e.transaction})},this.handleDrop=e=>{!function(e,t,n,o){const{droppedDirection:i,droppedStores:r,duplicate:a}=e;u.createAndCommit({userAction:"ListItemBlock.handleDrop",environment:o,perform:e=>{d.LQ({environment:o,targetParentStore:t,targetStore:n,droppedDirection:i,droppedStores:r,duplicate:a,transaction:e})}})}(e,this.props.listStore,this.props.store,this.environment)},this.handleNativeDrop=e=>{!function(e,t,n,o){const{files:i,droppedDirection:r}=e;u.createAndCommit({userAction:"ListItemBlock.handleNativeDrop",environment:o,perform:e=>d.uQ({environment:o,files:i,targetParentStore:t,targetStore:n,droppedDirection:r,transaction:e})})}(e,this.props.listStore,this.props.store,this.environment)},this.handleInsertBelow=e=>function(e,t,n){const{insertStores:o,transaction:i}=e;return s.d9(o).reverse().map((e=>x.BE({parent:t,insert:e,after:n,transaction:i}).child))}(e,this.props.listStore,this.props.store),this.handleInsertAbove=e=>function(e,t,n){const{insertStores:o,transaction:i}=e;return s.d9(o).reverse().map((e=>x.Vt({parent:t,insert:e,before:n,transaction:i}).child))}(e,this.props.listStore,this.props.store),this.handleEditText=e=>{!function(e,t,n,o){d.DC({environment:o,targetStore:t,targetParentStore:n,isAtStartOfLine:e.isAtStartOfLine,isAtStartOfContainer:e.isAtStartOfContainer,isClick:e.isClick,transaction:e.transaction})}(e,this.props.store,this.props.listStore,this.environment)},this.handleRemove=e=>{!function(e,t,n){const{transaction:o}=e,i=t.getRecordStoreUIParent();i&&(i.table!==c.iU&&i.table!==k.bx&&i.table!==w.Xj||!i.valueIs(H.i)||(C.uO(n,"user_flow_delete_block",o,"ListItemBlock.handleRemove"),x.Od({parent:i,childToRemove:t,transaction:o})))}(e,this.props.store,this.environment)},this.legacyTransclusionParentStore=this.createComputedStore((()=>{if(!this.isLegacyTransclusionStore.state)return;const e=this.props.listStore.getRecordStoreAtRootPath();return(0,Z.OY)(e)?e:void 0})),this.isPageFullWidth=this.createComputedStore((()=>{var e;return null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.isFullWidth()})),this.canEditStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!this.props.disabled&&(!(0,m.YF)(e)&&this.props.store.canEdit())})),this.isLegacyTransclusionStore=this.createComputedStore((()=>{const e=this.props.store.getParentId();return Boolean(e&&this.props.listStore.id!==e)})),this.isReadOnlyBlockInReadWritePageStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return this.props.canEditList&&!M.OO({environment:this.environment,blocks:[this.props.store],publicEditMode:e})})),this.renderStateStore=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t,canEditList:n,disableSelection:o,disableHoverMenu:i,disableCommentMenu:r}=this.props,s=t.getFormat(),l=t.getType(),{dragging:d,temporaryFullWidth:u}=this.stores.blockResizerStore.state,p=(0,Q.h)(this.props.store),f=d?u:s.block_full_width,g=l===a.Ti.page||l===a.Ti.collectionViewPage||s.alias_pointer&&(0,S.$O)(s.alias_pointer,c.iU)||l&&(0,j._A)(l,s)&&!G.Z.isOpen(t.id),h=Boolean(l&&(0,a.dM)(l)),v=l===a.Ti.table,b=l===a.Ti.columnList,y=p===Y.DZ,_=y,w=de(this.props.store)&&!b&&!v&&n&&!e.isPhone,k=this.pageContext&&this.pageContext.publicEditModeStore.state,I=(0,m.BZ)(k),x=y&&t.getCollectionStore();let C=y;if(x){void 0===x.getKeyStore("version").getValue()&&(C=!1)}const T=!o&&t.canRead()&&!v&&!this.isReadOnlyBlockInReadWritePageStore.state&&!C,M=!I&&T&&!y&&!v,P=M,A=!(I||i||b||y||v||(l===a.Ti.transclusionContainer||l===a.Ti.transclusionReference||l===a.Ti.aiBlock)&&function(e){return K.default.state.stores.some((t=>t!==e&&e.uiContains(t)))}(this.props.store)),R=!r&&("comment_only"===t.getRole()||"comment"===(null==k?void 0:k.permission))&&!n&&!b&&!h&&this.environment.currentUser.isLoggedIn()&&!v,D=v?O.g$.getNumberOfUnresolvedComments({simpleTableStore:t,environment:this.environment,includeInline:!this.marginCommentsVisible.state}):0,B=n&&!b&&!this.props.disableDrag,E=Boolean(this.props.store.findRecordStoreUIAncestor((e=>e===q.default.peekTarget.state)).ancestor),F=l&&(0,a.OY)(l)&&!t.getProperties().source,Z="drawing"===l&&(0,V.iZ)(t),U=s.block_alignment,L=n&&!b&&!t.inMemoryRecordCache.isSyntheticAssistantData;return{type:l,isFullWidth:f,canDropOnto:g,canDropLeftRight:w,shouldShowParentHalo:P,showHoverMenu:A,canDrag:B,canSelect:T,shouldShowSelectionHalo:M,showCommentMenu:R,numSimpleTableComments:D,isInlineCollectionView:y,isSimpleTable:v,isInPeekRenderer:E,isMediaWithoutSource:F,preventBackgroundDrag:_,disableForceTouch:Z,shouldDisableHoverMenuDrag:this.isReadOnlyBlockInReadWritePageStore.state,alignStyle:U,canTriggerContextMenu:L}}),!0,"renderStateStore"),this.blockRendererStore=this.createComputedStore((()=>(0,Q.h)(this.props.store))),this.appRenderState=this.createComputedStore((()=>P.h1(this.environment))),this.getStyle=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t}=this.props,{type:n,isInPeekRenderer:o,isFullWidth:i,isInlineCollectionView:r,isSimpleTable:s,numSimpleTableComments:l,isMediaWithoutSource:c,alignStyle:d}=this.renderStateStore.state,u={};if(this.externalObjectStateStore.state){const e=this.externalObjectStateStore.state;u.minWidth=_.B9,"image/*"!==e&&(u.width="100%")}else u.width="100%";if(u.maxWidth=this.getFullWidth(),(e.isMobile&&!i||this.isInColumnList()||!de(this.props.store))&&(u.maxWidth="100%"),d&&!i&&!e.isPhone&&se[d]?u.alignSelf=se[d]:de(this.props.store)&&n&&a.ib[n]?u.alignSelf="center":n&&a.Ok[n]&&(u.alignSelf="flex-start"),u.marginTop=this.props.isFirstItem?2:1,u.marginBottom=this.props.isLastItem?0:1,c?u.marginTop=oe:n&&ae[n]&&(u.marginTop=ae[n]),c&&!this.props.isLastItem?u.marginBottom=ie:!this.props.isLastItem&&n&&re[n]&&(u.marginBottom=re[n]),(r||s&&0===l)&&(de(this.props.store)||e.isPhone)){const e=this.getFullWidth();u.maxWidth=o?`calc(100vw - ${2*q.PeekModeOuterPadding-z.Z.state}px)`:(0,A.Ks)(t)&&!this.isPageFullWidth.state?E.zL:e,u.width=(0,A.Ks)(t)&&!this.isPageFullWidth.state?E.zL:e,u.alignSelf="center"}return de(this.props.store)&&this.marginCommentsVisible.state&&r&&(u.zIndex=1),(0,B.H)()&&this.isLegacyTransclusionStore.state&&(u.border="3px dashed deeppink"),u})),this.externalObjectStateStore=this.createComputedStore((()=>{if((0,D.Xg)()&&this.props.store.isExternalObjectInstanceBlockStore()){var e;const t=(0,D._l)({store:this.props.store,canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,isInDarkMode:"dark"===this.environment.ThemeStore.state.mode,showAction:void 0});return(null==t?void 0:t.renderConfig.previewAttributes)&&(null===(e=t.renderConfig.previewAttributes[0])||void 0===e?void 0:e.mimeType)}}),!0),this.marginCommentsVisible=this.createComputedStore((()=>(0,T.fg)(this.environment,this.props.store))),this.sidePeekWidth=this.createComputedStore((()=>(0,L.vJ)(this.environment)))}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.isCopyIndicatorWithoutPendingTransaction=(0,P.hq)(e.store)}didMount(){this.isLegacyTransclusionStore.state&&(I.vkP(this.environment,{block_type:this.props.store.getType()}),(0,y.XY)("Found a potential legacy transclusion--a block's parent is not its rendered parent!",[["block",this.props.store],["block parent id = ",this.props.store.getParentId()],["rendered parent id = ",this.props.listStore.id]]))}renderComponent(){if(!this.isCopyIndicatorWithoutPendingTransaction||this.renderStateStore.state.type!==a.Ti.copyIndicator)return this.isResizableType()?(0,ne.jsx)(J.Z,{isVisible:!0,animationStyle:this.getResizeAnimationStyle(),render:()=>this.renderPreventSidebar()}):this.renderPreventSidebar()}renderBlock(){const{renderItem:e,disabled:t,store:n,disableHoverMenu:o,disableDrag:i,disableCommentMenu:r,numberedListCounterStore:a,bulletedListFormatStore:s}=this.props,l=this.blockRendererStore.state;return!p.Pj(n)&&W.default.checkGate("hide_orphan_blocks")?null:e?e(n):l?(0,ne.jsx)(l,{ref:this.blockRef,store:this.props.store,disabled:t,isFirstItem:this.props.isFirstItem,isLastItem:this.props.isLastItem,blockResizerStore:this.stores.blockResizerStore,disableCommentMenu:r,numberedListCounterStore:a,bulletedListFormatStore:s,disableHoverMenu:o,disableDrag:i,legacyTransclusionParent:this.legacyTransclusionParentStore.state}):void 0}isResizableType(){const e=this.renderStateStore.state.type;return!!e&&(Boolean(a.Ok[e])||this.props.store.isType("column_list")&&(0,R.Po)(this.props.store,this.environment)||this.props.store.isType("external_object_instance")&&(0,D.Xg)())}isOverflowEdgeBlockType(){const e=this.renderStateStore.state.type;return!!e&&(a.GP[e]||this.props.store.isType("column_list")&&(0,R.Po)(this.props.store,this.environment)&&this.props.store.getFormat().block_full_width)}isInColumnList(){return this.context.isInColumnList}canEdit(){return this.canEditStore.state}getResizeAnimationStyle(){const{type:e}=this.renderStateStore.state;if(e&&(0,X.x)({environment:this.environment,type:e}))return{width:"100%"};const{dragging:t,temporaryWidth:n,temporaryFullWidth:o,temporaryPageWidth:i}=this.stores.blockResizerStore.state,{block_width:r,block_full_width:a,block_page_width:s}=this.props.store.getFormat(),l=t?n:r,c=t?i:s;return{width:(t?o:a)?this.getFullWidth():c?"100%":l}}getFullWidth(){const{device:e}=this.environment,{isInPeekRenderer:t}=this.renderStateStore.state,n=this.environment.WindowSizeStore.state.width,o=(0,L.ll)(this.environment,t)-this.sidePeekWidth.state,i=n-z.Z.state-o;if(r=this.props.store,Boolean(r.inMemoryRecordCache.snapshotData)&&!e.isPhone)return n*(te.rp/100)-te.mD-z.Z.state;if(U.Z.isBlockInTemplate(this.props.store))return n*($.E2/100)-$.dm-z.Z.state;if(this.isInColumnList()||!de(this.props.store))return"100%";if(t)return q.default.getPeekModeWidth(n)-z.Z.state;if((0,L.Jr)(this.environment)){let n=i;const{state:{shouldShowSidebar:o}}=this.appRenderState;return e.isMobile&&!e.isTablet||!o||(n-=(0,L.Wk)(this.environment)),!this.renderStateStore.state.isInlineCollectionView&&this.marginCommentsVisible.state&&(this.isPageFullWidth.state?n-=T.QB:n-=2*(0,T.gC)(this.environment,t,(0,A.Ks)(this.props.store))),this.isOverflowEdgeBlockType()||(n-=2*(0,P.ui)(this.environment)),n}return i;var r}}le.displayName="ListItemBlock",le.contextTypes={...i.w,isInColumnList:b().any};const ce=le;function de(e){return e.isRootOrDirectChild()}const ue="emptyDroppableKey",pe="placeholder";class me extends i.Z{constructor(){super(...arguments),this.renderItem=(e,t,n)=>e===ue?(0,ne.jsx)(o.Fragment,{children:this.renderEmptyDroppable()},e):e===pe?(0,ne.jsx)(o.Fragment,{children:this.props.emptyPlaceholder},e):(0,ne.jsx)(o.Fragment,{children:this.renderChild(e,t,n)},e),this.bulletedListFormatStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=null===(e=this.props.bulletedListFormatStore)||void 0===e?void 0:e.getState().depth,o="number"==typeof n?n+1:0,i=new Map;let r;for(const s of t){const e=ge(s,this.props.store);r=e.getType()===a.Ti.bulletedList?e.getFormat().bullet_list_format||r:void 0,r&&i.set(s,r)}return{depth:o,blockIdFormats:i}})),this.numberedListCounterStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=[],o=t.length?t[0]:void 0,i=o?ge(o,this.props.store):void 0,r=null==i?void 0:i.getParentId(),s=null===(e=this.props.numberedListCounterStore)||void 0===e?void 0:e.state.numberedListBlockIdsWithFormat.find((e=>e.id===r)),l=null==s?void 0:s.format;let c=void 0===(null==s?void 0:s.depth)?0:(null==s?void 0:s.depth)+1,d=l,u=0;for(const p of t)if(p!==ue&&p!==pe){const e=ge(p,this.props.store),t=e.getType(),o=e.getFormat();if(d=(null==o?void 0:o.list_format)??d,t===a.Ti.numberedList){let e=o.list_start_index;e&&0!==u&&(e=void 0),u=e||u+1,n.push({id:p,format:d,depth:c||0,index:u})}else d=void 0,n.push({id:void 0,format:d,depth:0,index:u}),c=0,u=0}return{depth:c||0,numberedListBlockIdsWithFormat:n}})),this.canEditStore=this.createComputedStore((()=>{const e=(0,p.n3)(this.props.store)&&this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,m.YF)(e)&&this.props.store.canEdit()})),this.itemKeysStore=this.createComputedStore((()=>{const e=this.props.store.getValue()||[];let t=e;const n=function(e){const{limitParents:t}=f.Z.state,n=e.id;let o;return e.findRecordStoreUIAncestor((e=>{const i=t.get(e);return!(!i||!i.hasOwnProperty(n))&&(o=i[n],!0)})),o}(this.props.store),o=this.canEdit(),i=0===e.length;return void 0!==n&&(t=s.tP(t,0,n)),o&&i&&t.push(ue),o&&i&&this.props.emptyPlaceholder&&t.push(pe),t}))}renderComponent(){if(!this.props.disableContent){var e;const t=null===(e=this.context.restrictedContentContext)||void 0===e?void 0:e.state;return t?this.itemKeysStore.state.reduce(((e,n,o,i)=>(t.indexOf(n)>=0&&e.push(this.renderItem(n,o,i)),e)),[]):this.itemKeysStore.state.map(this.renderItem)}}renderChild(e,t,n){const{disabled:o}=this.props,i=ge(e,this.props.store),r=s.qr(n,(e=>(0,l.e)(e)));return(0,ne.jsx)(ce,{store:i,renderItem:this.props.renderItem,listStore:this.props.store,isFirstItem:0===t,isLastItem:t===r,disabled:o,disableLayout:this.props.disableLayout,canEditList:this.canEdit(),disableSelection:this.props.disableSelection,disableHoverMenu:this.props.disableHoverMenu,disableCommentMenu:this.props.disableCommentMenu,disableDrag:this.props.disableDrag,numberedListCounterStore:this.numberedListCounterStore,bulletedListFormatStore:this.bulletedListFormatStore})}renderEmptyDroppable(){const e=g.G.createChildStore(this.props.store,{table:c.iU,id:this.props.store.id}),t=this.canEdit();return(0,ne.jsx)(ee.Z,{store:e,canDropBelow:t,canNativeDropBelow:t,onSelectableDrop:e=>function(e,t,n){const{droppedDirection:o,droppedStores:i,duplicate:r}=e;u.createAndCommit({userAction:"List.handleEmptyDrop",environment:n,perform:e=>{d.LQ({environment:n,targetParentStore:t,targetStore:void 0,droppedDirection:o,droppedStores:i,duplicate:r,transaction:e})}})}(e,this.props.store,this.environment),onNativeDrop:e=>function(e,t,n){const{files:o,droppedDirection:i}=e;u.createAndCommit({userAction:"List.handleEmptyNativeDrop",environment:n,perform:e=>{d.uQ({environment:n,files:o,targetParentStore:t,targetStore:void 0,droppedDirection:i,transaction:e})}})}(e,this.props.store,this.environment),style:this.props.emptyDroppableStyle,analyticsName:"page_content",shouldShowDropZone:!0})}canEdit(){return!this.props.disabled&&(!h.n.state&&this.canEditStore.state)}}me.displayName="List",me.contextTypes={...r.J,...i.w};const fe=me;function ge(e,t){return g.G.createChildStore(t,{table:c.iU,id:e})}},78454:(e,t,n)=>{n.d(t,{LK:()=>h,R8:()=>v,ZP:()=>I,v2:()=>c});var o=n(67294),i=n(49271),r=n(63143),a=n(89086),s=n(68709),l=n(85893);let c=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({});const{Start:d,Center:u,End:p}=c,m=o.forwardRef((function(e,t){return(0,l.jsxs)("div",{onClick:e.onClick,onMouseMove:e.onMouseMove,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseDown:e.onMouseDown,style:y(e),ref:t,children:[e.left&&f(e),e.children&&(0,l.jsx)("div",{style:k(e),children:e.children}),e.right&&g(e)]})})),f=function(e){return(0,l.jsx)(s.p,{...(0,a.td)("start"),allowSelectionWithin:!1,style:S(e),children:e.left})},g=function(e){return(0,l.jsx)(s.p,{...(0,a.td)("end"),allowSelectionWithin:!1,style:w(e),children:e.right})},h=24,v={...i.ZD,textAlign:"left"},b={[d]:"flex-start",[u]:"center",[p]:"flex-end"},y=function(e){return{display:"flex",alignItems:r.z4(e.alignment)?b[c.Start]:b[e.alignment],width:"100%",...e.style}},_=function(e){const t={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0};return(e.leftRightMinHeight||r.z4(e.leftRightMinHeight))&&(t.minHeight=`calc(1.5em + ${i.ZD.paddingTop}px + ${i.ZD.paddingTop}px)`),t},S=e=>({marginRight:2,width:h,..._(e),...e.leftStyle}),w=e=>({marginLeft:4,..._(e),...e.rightStyle}),k=e=>({flexGrow:1,flexShrink:1,flexBasis:0,minWidth:1,...e.childrenStyle}),I=m},40148:(e,t,n)=>{n.d(t,{Lw:()=>c,ZP:()=>d});var o=n(67294),i=n(13991),r=n(6740),a=n(24405),s=n(82990),l=n(85893);const c={fontSize:12,paddingTop:2,paddingBottom:2};function d(e){window.__c={n:"MediaPlaceholder"};const[t,n]=(0,o.useState)(!1),c=(0,a.yK)((n=>({root:{width:"100%",fontSize:14,fontFamily:s.Z.getCompositeFontFamily(i.SP).sans,color:n.mediumTextColor,borderRadius:4,background:n.embedPlaceholderBackground,position:"relative",...e.style},right:{position:"absolute",top:4,right:4,transition:"opacity 200ms ease-in",opacity:e.shouldHideRight&&!t?0:1},inner:{padding:12,paddingRight:36,display:"flex",alignItems:"center",textAlign:"left",width:"100%",overflow:"hidden"},icon:{width:25,height:25,flexShrink:0,marginRight:12,fill:n.mediumIconColor,...e.iconStyle}})),[e.style,e.shouldHideRight,e.iconStyle,t]);return(0,l.jsxs)("div",{style:c.root,onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,r.E)(t)&&n(!0)},onBlur:()=>n(!1),children:[(0,l.jsxs)("div",{style:c.inner,children:[e.iconSvg(c.icon),(0,l.jsx)("div",{style:{...s.Z.textOverflowStyle},children:e.children})]}),e.right&&(0,l.jsx)("div",{style:c.right,children:e.right})]})}},65085:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(67294),i=n(24405),r=n(42402),a=n(85893);function s(e){window.__c={n:"MultiLineTextOverflow"};const{children:t,maxLines:n,onMore:r,onLess:s}=e,c=(0,o.useRef)(null),d=(0,o.useRef)(null),u=(0,o.useRef)(null),[p,m]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!n),[h,v]=(0,o.useState)(0),[b,y]=(0,o.useState)(0);(0,o.useEffect)((()=>{if(p){var e;const t=null===(e=d.current)||void 0===e?void 0:e.getClientRects()[0];v((null==t?void 0:t.height)??0),y((null==t?void 0:t.width)??0)}}),[p]);const _=(0,o.useCallback)((()=>{c.current&&m(c.current.scrollHeight>c.current.clientHeight)}),[]);(0,o.useEffect)((()=>{!f&&n&&_()}),[f,n,_]),(0,o.useEffect)((()=>{if(u.current){const e=new MutationObserver((()=>{f||_()})),t=new ResizeObserver((()=>{f||_()}));return t.observe(u.current),e.observe(u.current,{childList:!0,subtree:!0}),()=>{t.disconnect(),e.disconnect()}}}),[f,_]);const S=(0,o.useCallback)((e=>{r?r(e):(e.preventDefault(),e.stopPropagation(),g(!0))}),[r]),w=(0,o.useCallback)((e=>{s?s(e):(e.preventDefault(),e.stopPropagation(),g(!1))}),[s]),k=(0,o.useMemo)((()=>(0,a.jsx)(l,{style:{position:"absolute",right:0,bottom:0},onClick:S,children:(0,a.jsx)("div",{ref:d,children:e.moreElement})})),[e.moreElement,S]),I=(0,o.useMemo)((()=>(0,a.jsx)(l,{onClick:w,children:e.lessElement})),[e.lessElement,w]),x=(0,i.yK)((e=>({base:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:f?void 0:n},clamped:{WebkitMaskPosition:"right bottom",WebkitMask:`linear-gradient(0deg,transparent 0,transparent ${h}px,#000 ${h}px),\n\t\t\t\t\t\t\t linear-gradient(270deg,transparent 0,transparent ${b}px,#000 ${2*b}px)`}})),[n,f,h,b]);return(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsxs)("div",{ref:c,style:{...x.base,...p&&!f&&x.clamped,...e.style},children:[(0,a.jsx)("div",{ref:u,children:t}),p&&f&&I]}),p&&!f&&k]})}function l(e){let{onClick:t,style:n,children:o}=e;return(0,a.jsx)(r.Z,{disableUnderline:!0,style:n,onClick:e=>{t(e)},children:o})}},54321:(e,t,n)=>{n.d(t,{Z:()=>S});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(62965),l=n(9291),c=n(73819),d=n(23864),u=n(55217),p=n(78454),m=n(22491),f=n(99445),g=n(85893);function h(e){const{rank:t,index:n,listFormat:o}=e;if("numbers"===o)return{index:n,listFormat:o};if("letters"===o)return{index:(0,f.yt)(n),listFormat:o};if("roman"===o)return{index:(0,f.bW)(n),listFormat:o};{const e=t%3;return 0===e?{index:n,listFormat:"numbers"}:1===e?{index:(0,f.yt)(n),listFormat:"letters"}:{index:(0,f.bW)(n),listFormat:"roman"}}}const v=function(e){window.__c={n:"NumberedListCounter"};const t=(0,i.VK)((()=>{if(!e.numberedListCounterStore)return h({rank:0,index:1,listFormat:void 0});const t=e.numberedListCounterStore.state.numberedListBlockIdsWithFormat.find((t=>t.id===e.store.id));return h({rank:(null==t?void 0:t.depth)||0,index:(null==t?void 0:t.index)||0,listFormat:null==t?void 0:t.format})}),[e.numberedListCounterStore,e.store.id]),n=t.index.toString().length;let o=24;return"roman"===t.listFormat?o=56:3===n?o=32:4===n?o=42:n>4&&(o="unset"),(0,g.jsx)("span",{...(0,m.iv)({pseudoBefore:{content:`"${t.index}."`},textAlign:"center",whiteSpace:"nowrap",width:o})})};var b=n(65187);const y=(0,l.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"numberedListBlock.placeholder.label"}});function _(e,t){window.__c={n:"NumberedListBlock"};const n=(0,l.useIntl)(),s=o.useRef(null),m=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),f=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),h=(0,c.rv)(e.store),_=(0,r.yK)((()=>({root:{paddingLeft:a.ZD.paddingLeft,...h,...e.style}})),[h,e.style]),S=(0,g.jsxs)(p.ZP,{style:_.root,left:(0,g.jsx)(v,{store:e.store,numberedListCounterStore:e.numberedListCounterStore}),leftStyle:{width:"unset"},childrenStyle:{display:"flex",flexDirection:"column"},ref:s,children:[(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)(b.Z,{style:p.R8,disabled:e.disabled,store:m,placeholder:n.formatMessage(y.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,g.jsx)(d.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,g.jsx)(u.Z,{disabled:e.disabled,store:f,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,numberedListCounterStore:e.numberedListCounterStore})]});return(0,c.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"numbered_list",getNode:()=>s.current,getBlockStore:()=>e.store})),[e.store]),S)}const S=o.memo(o.forwardRef(_),s.Z)},45952:(e,t,n)=>{n.d(t,{Z:()=>v,x:()=>g});var o=n(67294),i=n(480),r=n(86628),a=n(87292),s=n(62965),l=n(9291),c=n(73819),d=n(68859),u=n(97496),p=n(69721),m=n(85893);const f=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed PDF",id:"pdfBlock.embeds.button.label"}});function g(e){const{type:t,environment:n}=e;return"pdf"===t&&n.device.isMobile}function h(e,t){window.__c={n:"PDFBlock"};const n=(0,i.O7)(),s=(0,l.useIntl)(),h=(0,o.useRef)(null),v=(0,r.qz)(e.blockResizerStore,d.Z),b=(0,r.VK)((()=>{const t=e.store.getType();return t&&g({environment:n,type:t})}),[n,e.store])?(0,m.jsx)(p.Z,{store:e.store,disabled:e.disabled}):(0,m.jsx)(u.ZP,{...e,blockResizerStore:v,ref:h,store:e.store,iconSvg:a.B,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Embed a PDF file",id:"pdfBlock.embeds.caption"}),embedButtonText:s.formatMessage(f.embedButtonText),urlInputPlaceholder:"https://...",children:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Embed a PDF",id:"pdfBlock.placeholder"})});return(0,c.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"pdf",getNode:()=>{const e=h.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),b)}const v=o.memo(o.forwardRef(h),s.Z)},53238:(e,t,n)=>{n.d(t,{Z:()=>D});n(67294);var o=n(83355),i=n(480),r=n(8848),a=n(43593),s=n(17755),l=n(59054),c=n(72126),d=n(54642),u=n(31781),p=n(24677),m=n(95477),f=n(24098),g=n(98742),h=n(18514),v=n(77907),b=n(34859),y=n(4926),_=n(24042),S=n(53730),w=n(49085);class k extends w.default{getInitialState(){return{ready:!1,pages:0,renderWidth:0,showPages:0}}}const I=k;var x=n(68785),C=n(53336),T=n(43145),M=n(85893);const P={position:"absolute",top:"calc(50% - 9px)",left:"calc(50% - 9px)",width:18,height:18};class A extends o.Z{constructor(){super(...arguments),this.ReactPDF=void 0,this.storeTypes={store:I},this.handleDocumentLoadSuccess=e=>{e&&e._pdfInfo&&this.stores.store.setState({...this.stores.store.state,pages:e._pdfInfo.numPages,showPages:1})},this.handlePageRenderSuccess=()=>{this.stores.store.setState({...this.stores.store.state,ready:!0})},this.handleScrollOffsetChange=e=>{e<200&&this.stores.store.state.ready&&this.renderNextPage()},this.updateRenderWidth=()=>{this.stores.store.setState({...this.stores.store.state,renderWidth:this.props.width})},this.updateRenderWidthDebounced=c.Ds(this.updateRenderWidth,1e3)}async UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.stores.store.setState({...this.stores.store.state,renderWidth:e.width}),this.ReactPDF=await v.deps.reactPDF.loader(),this.enqueueForceUpdate()}UNSAFE_willUpdate(e){super.UNSAFE_willUpdate(e),this.updateRenderWidthDebounced()}renderComponent(){if(!this.ReactPDF)return;const{source:e}=this.props,t=this.stores.store.state,{Document:n,Page:o}=this.ReactPDF,i=(0,a.x$)(e)&&!(0,h.Sr)();return(0,M.jsx)(f.Z,{capture:!0,render:r=>(0,M.jsxs)(C.Z,{type:b.Z.All,style:B(this.props.height,this.environment),...(0,g.Z)(r,{onMouseDown:()=>{return e=this.environment,void p.ZH(e);var e}}),children:[e&&(0,M.jsx)(n,{file:e,loading:(0,M.jsx)(x.Z,{style:P}),onLoadSuccess:this.handleDocumentLoadSuccess,options:{cMapUrl:"/notion-assets/cmaps/",cMapPacked:!0,withCredentials:i},children:c.w6(t.showPages).map((e=>(0,M.jsx)(o,{pageNumber:e+1,width:this.getPageWidth(),loading:"",renderAnnotationLayer:!1,renderInteractiveForms:!1,onRenderSuccess:this.handlePageRenderSuccess},e+1)))}),(0,M.jsx)(T.Z,{onChange:this.handleScrollOffsetChange})]})})}getPageWidth(){const e=this.stores.store.state;return Math.min(window.innerWidth,e.renderWidth)-32-y.Z.state}renderNextPage(){const{showPages:e,pages:t}=this.stores.store.state;e<t&&this.stores.store.setState({...this.stores.store.state,ready:!1,showPages:e+1})}}A.displayName="PDFRenderer";function R(e){window.__c={n:"ProxiedPDFRendererWrapper"};const{contentWrapStyle:t,width:n,height:o,blockLocation:r,source:c}=e,p=e.store.pointer,f=(0,i.O7)(),[{value:g}]=(0,l.r5)((async()=>{if(await S.transactionQueue.awaitRecordTransaction(p),(0,a.E$)(c,[m.default.secureFileS3.url,m.default.secureFileS3V2.url])){const e=f.device;return await d.getSignedFileUrl(f,{url:c,permissionRecord:p,useS3Url:e.isIOS&&e.isMobileNative},Boolean(_.Z.state.isNotionProtocolBugFixed))}return(0,s.EK)({url:c,permissionRecord:p,baseUrl:m.default.domainBaseUrl,fullyQualified:!1,userId:f.currentUser.id})}),[f,p,c]);return(0,M.jsx)("div",{style:t,children:(0,M.jsx)(A,{source:g,width:n||500,height:o||(u.qC(r)?240:500)})})}const D={render:e=>(0,M.jsx)(R,{...e}),embedGhost:!0,resizable:!0};function B(e,t){const{device:n}=t;return{position:"relative",height:e,maxHeight:n.isMobile?"75vh":void 0,background:r.ZP.uiExtraLightGray,paddingTop:8,paddingBottom:8,paddingLeft:16,paddingRight:16,overflow:"visible"}}},24813:(e,t,n)=>{n.d(t,{Z:()=>P});n(67294);var o=n(83355),i=n(15145),r=n(49271),a=n(39567),s=n(44805),l=n(82990),c=n(9291),d=n(3297),u=n(9953),p=n(82530),m=n(28651),f=n(84210),g=n(98165),h=n(67669),v=n(4023),b=n(77080),y=n(88923),_=n(13966),S=n(84076),w=n(31278),k=n(76798),I=n(26388),x=n(78454),C=n(85893);const T={paddingTop:r.ZD.paddingTop,paddingBottom:r.ZD.paddingBottom,paddingLeft:r.ZD.paddingLeft};class M extends o.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:m.Z},this.onMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.onMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}}didMount(){const{RouterStore:e,currentUser:t}=this.environment,{route:n}=e.state;"page"===n.name&&n.shouldDuplicate&&d.nM({currentUserId:null==t?void 0:t.id,blockId:n.blockId})}renderComponent(){const{store:e,onClick:t}=this.props,n=(0,f.Hu)({store:e,fullyQualified:!1,pageVisitSource:i.tY.LinkInPage}),o=(0,f.Hu)({store:this.props.store,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:i.tY.PeekOpen}),r=b.default.checkGate("enable_deleted_page_indicator"),a=g.wf(e),s=r&&a;return(0,C.jsx)(S.Z,{href:n,altHref:o,forceAltHref:y.default.isSidePeekOpen(),external:!1,onClick:t,style:{borderRadius:4,...this.props.style},children:(0,C.jsx)(x.ZP,{childrenStyle:T,alignment:v.v.Center,right:this.renderActionButton(),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[this.renderIconWithArrow(s),(0,C.jsx)(k.Z,{store:e,style:R(this.theme,s,this.props.disableUnderline)})]})})})}renderIconWithArrow(e){if(e){const e=this.environment.device.isSafari||this.environment.device.isIOS;return(0,s.tr)({isSafariOrIOS:e,theme:this.theme})}return(0,C.jsxs)("div",{style:{position:"relative",width:24,height:24,marginRight:4},children:[this.renderIcon(),(0,C.jsx)(A,{isAlias:this.props.isAlias})]})}renderIcon(){const{store:e,disabled:t}=this.props;return(0,C.jsx)(I.ZP,{renderTooltip:()=>(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Change icon",id:"page.changeIcon.tooltip"}),placement:v.u.Top,disableTooltip:t||!this.canEdit(),render:n=>t||!this.canEdit()?(0,C.jsx)(w.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),role:e.getRole(),size:22,style:{width:"100%",height:"100%"},...n,largeIcon:!0}):(0,C.jsx)(w.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),role:e.getRole(),isEmptyPage:e.isEmptyPage(),size:22,style:{width:"100%",height:"100%"},iconLoggingData:{recordTable:e.table,source:"subpage",block_type:e.getType()},onChange:e=>function(e,t,n){const o=t.getIconStore();o&&p.createAndCommit({userAction:"Page.handleRecordIconChange",environment:n,perform:t=>{u.sO({store:o,value:e,transaction:t})}})}(e,this.props.store,this.environment),...n,largeIcon:!0})})}renderActionButton(){const{device:e}=this.environment;return this.canEdit()&&(this.stores.mouseStore.state.mouseEntered||e.isMobile)?(0,C.jsx)(_.Z,{store:this.props.aliasStore??this.props.store,tooltipContent:(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Rename, delete, and moreâ€¦",id:"page.blockActionMenu.tooltip"}),style:{marginRight:4},fadeIn:!0}):(0,C.jsx)("div",{style:{width:28}})}canEdit(){const{store:e}=this.props,t=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,h.YF)(t)&&(e.canEdit()&&!this.props.disabled)}}M.displayName="Page";const P=M;function A(e){let{isAlias:t}=e;return t?(0,C.jsx)("div",{children:(0,a.Y)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})}):null}function R(e,t,n){return{fontWeight:l.Z.fontWeight.medium,lineHeight:1.3,borderBottom:n?"none":`1px solid ${e.darkDividerColor}`,...t&&{color:e.mediumTextColor}}}},4382:(e,t,n)=>{n.d(t,{Z:()=>T});var o=n(67294),i=n(73935),r=n(480),a=n(86628),s=n(15145),l=n(62965),c=n(50906),d=n(75754),u=n(993),p=n(32741),m=n(66213),f=n(14976),g=n(35683),h=n(84210),v=n(73819),b=n(77080),y=n(46735),_=n(22294),S=n(72014),w=n(88923),k=n(68709),I=n(24813),x=n(85893);function C(e,t){window.__c={n:"PageBlock"};const n=(0,r.O7)(),l=(0,o.useContext)(m.ZO),C=(0,o.useRef)(null),T=(0,o.useRef)(null),M=(0,v.PE)(e.store,e.disabled),P=(0,v.rv)(e.store),A=(0,o.useCallback)((()=>{c.Se(n),c.SK1(n,{page_visit_id:S.$g.getCurrentPageVisitId(),mentioned_page_id:e.store.id,source_type:"page_block",hover_preview_enabled:b.default.checkGate("first_party_links"),is_navigable_block:e.store.isNavigableBlock()}),y.Z.recordVisit({id:e.store.id,systemBlockType:e.store.getSystemBlockTypeStore().getValue(),type:g.vu.Link,currentUserId:n.currentUser.id})}),[n,e.store]),R=(0,o.useCallback)((()=>{if(!T||!T.current)return;const t=i.findDOMNode(T.current);return(0,f.We)(e.store,t)}),[e.store]),D=(0,o.useCallback)((t=>{const o=R(),i=e.store.getTitleStore();i&&o&&u.Nh({environment:n,event:t,interactiveToken:o,store:i,canEdit:M})}),[M,n,R,e.store]),B=(0,o.useCallback)((t=>{const o=R(),i=e.store.getTitleStore();i&&o&&u.Zl({environment:n,event:t,interactiveToken:o,store:i,canEdit:M})}),[M,n,R,e.store]),E=(0,o.useCallback)((()=>{if(l){const t=(0,h.ZP)({store:e.store,pageVisitSource:s.tY.Create});l(t)}else d._({environment:n,store:e.store,visitType:g.vu.Link,openInSidePeek:w.default.isSidePeekOpen(),pageVisitSource:s.tY.Create})}),[n,l,e.store]);(0,o.useEffect)((()=>()=>{p.qA(e.store.getTitleStore())}),[e.store]);const F=(0,a.VK)((()=>e.store.recordStoreParentDiffersFromPersistedParent()),[e.store]);return(0,v.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"page",getNode:()=>C.current,getBlockStore:()=>e.store,activate:E,handleCreated(){E(),_.Z.setKeyboardMode(!1)}})),[E,e.store]),(0,x.jsx)(k.p,{allowSelectionWithin:!1,onMouseOver:D,onMouseOut:B,ref:C,children:(0,x.jsx)(I.Z,{ref:T,store:e.store,style:{...P,...e.style},isAlias:F,disabled:e.disabled,onClick:A})}))}const T=o.memo(o.forwardRef(C),l.Z)},35541:(e,t,n)=>{n.d(t,{u:()=>P});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(41892),s=n(70203),l=n(97880),c=n(1292),d=n(7825),u=n(38376),p=n(27627),m=n(51077),f=n(12981),g=n(36596),h=n(65453),v=n(54321),b=n(4382),y=n(16472),_=n(99571),S=n(51704),w=n(17970),k=n(11620),I=n(4859),x=n(91791),C=n(91497),T=n(85893);let M;function P(e){const t=e.getType();if(t){if(!M){const e={text:w.Z,page:b.Z,collection_view_page:p.Z,bulleted_list:d.Z,numbered_list:v.Z,toggle:I.ZP,quote:y.ZP,to_do:k.Z,header:h.Z,sub_header:_.Z,sub_sub_header:S.Z,callout:u.Z,transclusion_container:x.Z,transclusion_reference:C.Z,alias:c.Z},t=(0,l.QS)({abstract:!0,audio:!0,code:!0,codepen:!0,deepnote:!0,drive:!0,equation:!0,excalidraw:!0,figma:!0,file:!0,framer:!0,gist:!0,hex:!0,invision:!0,loom:!0,maps:!0,miro:!0,mixpanel:!0,pdf:!0,replit:!0,sketch:!0,tweet:!0,typeform:!0,video:!0,whimsical:!0}),n=Object.keys(t).reduce(((e,t)=>(e[t]=A,e)),{});M={...e,...n,...{collection_view:R,table:R},copy_indicator:void 0,personal_home_page:void 0,button:void 0,image:void 0,link_to_page:void 0,link_to_collection:void 0,table_row:void 0,external_object_instance_page:void 0,external_object_instance:void 0,bookmark:void 0,table_of_contents:void 0,tab:void 0,column_list:void 0,column:void 0,embed:void 0,drawing:void 0,divider:void 0,breadcrumb:void 0,factory:void 0,ai_block:void 0}}return M[t]}}const A=e=>{let{store:t}=e;window.__c={n:"MultiMediaAndIntegrationPreview"};const[n,o]=(0,i.VK)((()=>{var e;const n=t.getType(),o=null===(e=t.getTitleStore())||void 0===e?void 0:e.getValue();return[n,s.QaF(o)]}),[t]),l=(0,r.yK)((e=>({card:{display:"flex",padding:10,borderRadius:6,boxShadow:e.inputBoxShadow,marginBottom:6,gap:10},shimmer:{backgroundColor:e.largeShimmerColor,width:150,borderRadius:6}})),[]),c=function(e){const t=e&&D[e];if("string"==typeof t)return t;return a.Z.images.icons.unknownTypePng}(n);return(0,T.jsxs)("div",{style:l.card,children:[(0,T.jsx)(m.Z,{type:"image_url",imageURL:c,size:25,imageStyle:{marginLeft:4,marginRight:4}}),o.length>0?(0,T.jsx)("span",{children:o}):(0,T.jsx)(g.Z,{emphasized:!0,style:l.shimmer})]})},R=e=>{let{store:t}=e;window.__c={n:"InlineCollectionOrTable"};const n=(0,o.O7)(),s="collection_view"===(0,i.VK)((()=>t.getType()),[t]),l=(0,r.yK)((e=>({image:{width:"100%",borderRadius:4,border:`1px solid ${e.lightDividerColor}`},container:{marginBottom:6}})),[]),c=(0,i.VK)((()=>"dark"===n.ThemeStore.state.mode),[n.ThemeStore]),d=c?a.Z.images.blockRendererCovers.collectionTableDarkPng:a.Z.images.blockRendererCovers.collectionTableLightPng,u=c?a.Z.images.blockRendererCovers.plainTableDarkPng:a.Z.images.blockRendererCovers.plainTableLightPng;return(0,T.jsx)("div",{style:l.container,children:(0,T.jsx)(f.Z,{src:s?d:u,style:l.image})})};const D={equation:a.Z.images.blocks.texPng,audio:a.Z.images.blocks.audioPng,file:a.Z.images.blocks.filePng,pdf:a.Z.images.blocks.pdfPng,code:a.Z.images.blocks.codePng,video:a.Z.images.blocks.videoPng,abstract:a.Z.images.blocks.abstractPng,codepen:a.Z.images.blocks.codepenPng,deepnote:a.Z.images.blocks.deepnotePng,drive:a.Z.images.blocks.drivePng,excalidraw:a.Z.images.blocks.excalidrawPng,figma:a.Z.images.externalIntegrations.figmaIconPng,framer:a.Z.images.blocks.framerPng,gist:a.Z.images.blocks.githubPng,hex:a.Z.images.blocks.hexPng,invision:a.Z.images.blocks.invisionPng,loom:a.Z.images.blocks.loomPng,maps:a.Z.images.blocks.mapsPng,miro:a.Z.images.blocks.miroPng,mixpanel:a.Z.images.blocks.mixpanelPng,replit:a.Z.images.blocks.replitPng,sketch:a.Z.images.blocks.sketchPng,typeform:a.Z.images.blocks.typeformPng,tweet:a.Z.images.blocks.twitterPng,whimsical:a.Z.images.blocks.whimsicalPng}},32469:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(8848),i=n(90199),r=n(82990),a=n(9291),s=n(26388),l=n(85893);const c=function(e){let{style:t}=e;return(0,l.jsx)(s.ZP,{renderTooltip:()=>(0,l.jsx)(a.FormattedMessage,{defaultMessage:"Only you can see this page",id:"privatePageBadge.tooltip"}),render:e=>(0,l.jsx)("div",{style:{display:"flex",alignItems:"flex-start",...t||{}},...e,children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)("div",{style:{flexShrink:0,marginTop:-1,marginRight:4,fill:o.ZP.red},children:(0,i.b)({width:12})}),(0,l.jsx)("span",{style:{fontSize:12,fontWeight:r.Z.fontWeight.semibold,color:o.ZP.red},children:(0,l.jsx)(a.FormattedMessage,{defaultMessage:"Private",id:"privatePageBadge.label"})})]})})})}},16472:(e,t,n)=>{n.d(t,{NE:()=>h,ZP:()=>y,nr:()=>v});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(62965),l=n(9291),c=n(33929),d=n(73819),u=n(23864),p=n(55217),m=n(65187),f=n(85893);const g=(0,l.defineMessages)({emptyPlaceholder:{defaultMessage:"Empty quote",id:"quoteBlock.emptyQuote.placeholder"}}),h=3,v=14;function b(e,t){let{disabled:n,disableCommentMenu:s,disableDrag:l,disableHoverMenu:b,hideContent:y,store:_,style:S}=e;window.__c={n:"QuoteBlock"};const w=(0,o.useRef)(null),k=(0,d.rv)(_),I=(0,i.VK)((()=>{var e;return null===(e=_.getFormat())||void 0===e?void 0:e.quote_size}),[_]),x=(0,i.VK)((()=>_.getBlockTitleStore()),[_]),C=(0,i.VK)((()=>_.getContentStore()),[_]),T=(0,r.yK)((()=>({root:{margin:0,fontSize:"large"===I?"1.2em":"1em",...a.ZD,...k,display:"flex",...S},padding:{paddingLeft:a.ZD.paddingLeft,paddingRight:a.ZD.paddingRight},innerStyle:{borderLeft:`${h}px solid currentColor`,paddingLeft:v,paddingRight:v,width:"100%"}})),[k,I,S]),M=(0,f.jsxs)("blockquote",{style:T.root,ref:w,children:[(0,f.jsxs)("div",{style:T.innerStyle,children:[(0,f.jsx)(m.Z,{style:T.padding,placeholderStyle:{left:v,width:"auto",right:v},disabled:n,store:x,placeholder:c.default.formatMessage(g.emptyPlaceholder),pasteBehavior:"block"}),!y&&(0,f.jsx)(p.Z,{disabled:n,store:C,disableCommentMenu:s,disableHoverMenu:b,disableDrag:l})]}),(0,f.jsx)(u.Z,{disableCommentMenu:s,hideContent:y,store:_})]});return(0,d.ez)(_,t,(0,o.useMemo)((()=>({renderedType:"quote",getNode:()=>w.current,getBlockStore:()=>_})),[_]),M)}const y=o.memo(o.forwardRef(b),s.Z)},79954:(e,t,n)=>{n.d(t,{Z:()=>z,z:()=>O});var o=n(67294),i=n(83355),r=n(480),a=n(24405),s=n(8848),l=n(63143),c=n(51454),d=n(6404),u=n(42239),p=n(99553),m=n(52989),f=n(24677),g=n(82530),h=n(11368),v=n(84064),b=n(43250),y=n(78316),_=n(12534),S=n(98742),w=n(39500),k=n(45162),I=n(73959),x=n(89224),C=n(89086),T=n(95802),M=n(55367),P=n(10084),A=n(80796),R=n(20144),D=n(69784),B=n(49085);class E extends B.default{getInitialState(){return{shouldShowSelectionHalo:!1,shouldShowDropParentHalo:!1,shouldShowDropZone:!1,shouldShowDropZoneHint:!1,forceRenderSelectionHalo:!1,showActionIsInFlight:!1}}}const F=E;var Z=n(27724),V=n(24666),j=n(23063),U=n(6685),L=n(85893);const O={stiffness:70,damping:10,precision:.001};class N extends i.Z{constructor(){super(...arguments),this.lastDropZoneHintIndex=void 0,this.selectableDivRef=o.createRef(),this.storeTypes={draggableStore:P.Z,selectableStore:F},this.computedStore=this.createComputedStore((()=>{const e=function(e){const t=M.ZP.state;if(!t.isDragging)return;const{currentHintDropZones:n}=t;if(n)return n.findIndex((t=>t.type===M.Dl.Selectable&&t.store===e))}(this.props.store);!l.z4(e)&&e>=0&&(this.lastDropZoneHintIndex=e);const t=function(e,t,n){const{device:o}=t;if(!n||!(0,I.Mn)(o))return!1;const{stores:i,phase:r}=Z.default.state;if(r===Z.SelectionPhase.Selected&&i.indexOf(e)>=0&&!M.ZP.state.isDragging)return!0;return!1}(this.props.store,this.environment,this.props.shouldShowHalo),n=function(e,t){if(!t)return!1;const n=M.ZP.state;if(!n.isDragging)return!1;const{currentParentStore:o,currentHintDropZones:i,currentDropZone:r}=n;if(r&&r.type===M.Dl.DropTarget)return!1;return i.some((e=>e.direction===M.vh.Left||e.direction===M.vh.Right))?Boolean(r&&r.store===e):o===e}(this.props.store,this.props.shouldShowHalo),o=function(e,t){const n=M.ZP.state;if(!n.isDragging)return;const{currentDropZone:o}=n;if(o&&o.type===M.Dl.Selectable&&o.store===e&&t)return o.direction}(this.props.store,this.props.shouldShowDropZone),i=function(e,t){const n=M.ZP.state;if(!n.isDragging)return;const{currentHintDropZones:o}=n;if(o&&t){const t=o.find((t=>t.type===M.Dl.Selectable&&t.store===e));if(t)return t.direction}}(this.props.store,this.props.shouldShowDropZone),r=this.lastDropZoneHintIndex,a=this.stores.draggableStore.state.dragging,s=this.stores.draggableStore.hasDragged(),c=this.stores.draggableStore.state.initiator,d=this.stores.selectableStore.state,u=this.props.store.getType()||"unknown";return{isDragging:a,initiator:c,hasDragged:s,shouldShowSelectionHalo:t||d.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldShowDropParentHalo:n,currentDropZone:o,dropZoneHint:i,dropZoneHintIndex:r,shouldRenderSelectionHalo:t||d.shouldShowSelectionHalo||d.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldRenderDropParentHalo:n||d.shouldShowDropParentHalo,shouldRenderDropZoneHint:!l.z4(i)||d.shouldShowDropZoneHint,shouldRenderDropZone:!l.z4(o)||d.shouldShowDropZone,propStoreType:u,showActionIsInFlight:d.showActionIsInFlight}}))}get registries(){return[T.C]}getNode(){return this.props.nodeRef?this.props.nodeRef.current:this.selectableDivRef.current}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextSelectableContainer(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer}getContextVerticalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.verticalScroller}getContextHorizontalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.horizontalScroller}renderComponent(){var e;const{isDragging:t,initiator:n,hasDragged:o,shouldShowDropParentHalo:i,shouldShowSelectionHalo:r,currentDropZone:a,dropZoneHint:s,dropZoneHintIndex:l,shouldRenderSelectionHalo:c,shouldRenderDropParentHalo:u,shouldRenderDropZoneHint:m,shouldRenderDropZone:h,propStoreType:T,showActionIsInFlight:M}=this.computedStore.state,P=c||u||m||h,A=`${b.euV} notion-${T}-block`,D=this.renderDraggable((e=>(0,L.jsxs)("div",{ref:this.selectableDivRef,style:Q({isPositionRelative:P,isDragging:t,hasDragged:o,initiator:n,showActionIsInFlight:M},this.theme,this.props.canDrag,this.props.style),"data-block-id":this.props.store.id,className:this.props.className?`${A} ${this.props.className}`:A,...(0,S.Z)(e||{},{onDoubleClick:e=>function(e,t,n){t||(0,_.ZP)({event:e,context:_.Af.EditorDoubleClick,callback:()=>{n&&n(e)}})}(e,this.props.canSelect,this.props.onDoubleClick),onContextMenu:e=>function(e,t,n,o,i,r,a,s){const{device:l}=n;if(l.isAndroid){const n=V.default.state,o=(0,I.mh)(t),i=o&&"empty"!==n.mode&&(0,k.r)(n.multiSelection,o);if("editing"!==n.mode||!i)return x.isExpanded(x.get())||e.preventDefault(),e.stopPropagation(),!1}if(o){const o=(0,y.fm)(t);(0,_.ZP)({event:e,context:_.Af.EditorContextMenu,callback:()=>{e.preventDefault(),f.Ys({environment:n,store:t}),d.Qn({environment:n,stores:i||Z.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:r||"default",showInput:Boolean(a),analyticsFrom:s??"content_block_menu",optionalAnalyticsProperties:{collectionContextStore:o}})}})}}(e,this.props.store,this.environment,this.props.canTriggerContextMenu,this.props.contextMenuAndDragStores,this.props.actionSectionGroupKey,this.props.showBlockMenuInput,this.props.analyticsFromOverride),onMouseOver:e=>function(e,t,n){n&&(0,_.ZP)({event:e,context:_.Af.EditorMouseOver,callback:()=>{R.Z.setState({...R.Z.state,hoveredStore:t,lastHoveredStore:t})}})}(e,this.props.store,this.props.canSelect),onMouseOut:()=>{return e=this.props.store,void(R.Z.state.hoveredStore===e&&R.Z.setState({...R.Z.state,hoveredStore:void 0}));var e},onClick:e=>function(e,t,n,o,i,r){(0,_.ZP)({event:e,context:_.Af.EditorClick,callback:()=>{var a;if(null!==(a=Z.default.getDefaultContainerFromTarget(e.target))&&void 0!==a&&a.isPeekRenderer()||p.E5(n),(0,I.Mn)(n.device))w.X9()||!o||t.isInlineCollectionView()||f.Ys({environment:n,store:t,toggle:f.ji(n),selectBetween:f.OS()});else if(i){const t=(0,C.Rb)(e.target);t&&g.createAndCommit({userAction:"Selectable.handleClick",environment:n,perform:e=>{i({isAtStartOfLine:"start"===t,isClick:!0,transaction:e})}})}r&&r(e)}})}(e,this.props.store,this.environment,this.props.canSelect,this.props.onEditText,this.props.onClick),onMouseMove:this.props.onMouseMove,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave}),children:[this.props.children,c&&(0,L.jsx)(W,{selectableStore:this.stores.selectableStore,style:this.props.haloStyle,isVisible:r}),u&&(0,L.jsx)(q,{selectableStore:this.stores.selectableStore,isVisible:i}),m&&(0,L.jsx)($,{selectableStore:this.stores.selectableStore,direction:s,index:l,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap}),h&&(0,L.jsx)(G,{selectableStore:this.stores.selectableStore,direction:a,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap})]})));return(0,L.jsx)(v.ld,{value:{selectableContainer:null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer,closestSelectable:this},children:D})}displaySelectionHalo(e){this.stores.selectableStore.state.forceRenderSelectionHalo||(this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!0}))),window.setTimeout((()=>{this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!1})))}),e))}renderDraggable(e){const{device:t}=this.environment;return this.props.canDrag?(0,L.jsx)(U.Z,{draggableStore:this.stores.draggableStore,forceTouch:t.isMobile&&!this.props.disableForceTouch,touchDragOnly:this.props.touchDragOnly,onDraggableDragStart:e=>function(e,t,n,o){const{mobileNative:i}=t;n&&(e.preventDefault(),i&&i.buzz());o&&o(e)}(e,this.environment,this.props.canDrag,this.props.onDraggableDragStart),onDraggableDragMove:e=>function(e,t,n,o,i,r,a,s,l){const{device:c}=n;o&&!i?M.ZP.state.isDragging?u.td(n,{currentX:e.currentX,currentY:e.currentY}):w.X9()&&(f.Ys({environment:n,store:t,toggle:f.ji(n),selectBetween:f.OS()}),u.f$(n,{startX:e.startX,startY:e.startY,stores:r||Z.default.state.stores,isNativeDrag:!1,getGhostElement:a})):D.default.state.isActive||c.isPhone||m.AI({environment:n,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!s});l&&l(e)}(e,this.props.store,this.environment,this.props.canDrag,this.props.preventBackgroundDrag,this.props.contextMenuAndDragStores,this.props.getGhostElement,this.props.disableScrollToRevealHorizontal,this.props.onDraggableDragMove),onDraggableDragEnd:e=>function(e,t,n,o,i){const{device:r}=n;r.isMobile&&A.Z.state.isDragging&&e.preventDefault();o&&M.ZP.state.isDragging&&u.fX({environment:n,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:t});i&&i(e)}(e,this.props.analyticsName,this.environment,this.props.canDrag,this.props.onDraggableDragEnd),onDraggableDragCancel:e=>function(e,t,n,o){n&&M.ZP.state.isDragging&&(u.cQ(t),f.ZH(t));o&&o(e)}(e,this.environment,this.props.canDrag,this.props.onDraggableDragCancel),disableHorizontalEdgeScroll:this.props.disableHorizontalDragEdgeScroll,render:e}):e(void 0)}}N.displayName="Selectable",N.contextTypes={...h.I3,...v.Tf,...i.w};const z=N;function W(e){return(0,L.jsx)(j.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:O},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!1})},render:()=>(0,L.jsx)("div",{className:b.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:s.ZP.blueWithAlpha(.14),zIndex:c.py,borderRadius:4,...e.style}})},"halo")}function q(e){return(0,L.jsx)(j.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:O},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!1})},render:()=>(0,L.jsx)("div",{className:b.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:s.ZP.blueWithAlpha(.07),borderRadius:4}})},"parent")}function H(e,t,n){if(void 0===n)return{};const o=e.isMobile?3:2;return n===M.vh.Above||n===M.vh.Below?{position:"relative",left:-o,width:o,height:4,background:t.contentBackground,transform:"translateZ(100px)"}:{position:"relative",top:-o,width:4,height:o,background:t.contentBackground,transform:"translateZ(100px)"}}function K(e,t,n,o,i){const r={position:"absolute",pointerEvents:"none",background:s.ZP.blueWithAlpha(.43),zIndex:c.S1-t};if(e===M.vh.Onto)r.left=0,r.top=0,r.right=0,r.bottom=0,r.background=s.ZP.blueWithAlpha(.14);else if(e===M.vh.Above||e===M.vh.Below){const t=4;r.left=0,r.right=0,e===M.vh.Above?(r.top=-t,n&&(r.top-=n)):(r.bottom=-t,o&&(r.bottom-=o)),r.height=4}else{const t=8;r.top=0,r.bottom=0,e===M.vh.Left?r.left=i?-i:-t:r.right=i?-i:-t,r.width=4}return r}function G(e){window.__c={n:"SelectableCurrentDropZone"};const t=(0,r.Fy)(),n=(0,a.Fg)(),o=void 0!==e.direction;return(0,L.jsx)(j.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:O},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!0})},onAnimationEnd:()=>{o||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!1})},render:()=>(0,L.jsx)("div",{style:K(e.direction,0,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:e.direction!==M.vh.Onto&&(0,L.jsx)("div",{style:H(t,n,e.direction)})})},"dropZone")}function $(e){window.__c={n:"SelectableDropZoneHint"};const t=(0,r.Fy)(),n=(0,a.Fg)(),o=!l.z4(e.direction);return(0,L.jsx)(j.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:O},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!0})},onAnimationEnd:()=>{o||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!1})},render:()=>(0,L.jsx)("div",{style:K(e.direction,(e.index||0)+1,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:(0,L.jsx)("div",{style:H(t,n,e.direction)})})},"hint")}function Q(e,t,n,o){const{isPositionRelative:i,isDragging:r,hasDragged:a,showActionIsInFlight:s,initiator:l}=e,c={};return"touch"===l&&(c.transition="transform 200ms ease-out",n&&r&&!a&&(c.boxShadow=t.mediumBoxShadow,c.transform="scale(1.05)",c.borderRadius=3)),i&&(c.position="relative"),s&&(c.opacity=.5),{...c,...o}}},23189:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),i=n(8848),r=n(82990),a=n(85893);const s=function(e){window.__c={n:"SettingHeader"};const t=(0,o.Fg)(),{divider:n,large:s,block:l,children:c,hasMarginTop:d,small:u,style:p,smallMarginBottom:m,isCritical:f}=e,g="full"===n;return(0,a.jsx)("div",{style:{borderBottom:g?`1px solid ${t.regularDividerColor}`:0,marginBottom:g?16:m?2:8,marginTop:d?16:0,paddingBottom:g?12:0,fontSize:g?16:s?14:u?12:14,fontWeight:g?r.Z.fontWeight.medium:400,width:l?"100%":"auto",color:f?i.ZP.red:t.regularTextColor,...p},children:c})}},13490:(e,t,n)=>{n.d(t,{Z:()=>r});n(67294);var o=n(24405),i=n(85893);const r=function(e){window.__c={n:"SettingLabel"};const t=(0,o.yK)((t=>{const{hasMarginTop:n}=e,o={display:"block",marginBottom:4,fontSize:12,color:t.mediumTextColor};return n&&(o.marginTop=14),{style:o}}),[e]),{forId:n,children:r,style:a}=e;return(0,i.jsx)("label",{style:{...t.style,...a},htmlFor:n,children:r})}},35021:(e,t,n)=>{n.d(t,{Z:()=>p});var o=n(67294),i=n(480),r=n(43593),a=n(54642),s=n(95477),l=n(23586),c=n(24042),d=n(53730),u=n(85893);function p(e){window.__c={n:"SignedUrl"};const t=(0,i.O7)(),n=(0,o.useCallback)((async e=>r.E$(e.url,[s.default.secureFileS3.url,s.default.secureFileS3V2.url])?(e.permissionRecord&&await d.transactionQueue.awaitRecordTransaction(e.permissionRecord),a.getSignedFileUrl(t,e,Boolean(c.Z.state.isNotionProtocolBugFixed))):e.url),[t]);return(0,u.jsx)(l.Z,{request:{url:e.url,permissionRecord:e.permissionRecord,useS3Url:e.useS3Url},performRequest:n,render:e.render})}},6854:(e,t,n)=>{n.d(t,{Pn:()=>b,ow:()=>y,wr:()=>_});var o=n(67294),i=n(480),r=n(24405),a=n(15145),s=n(1436),l=n(55863),c=n(9291),d=n(52423),u=n(75754),p=n(64964),m=(n(84076),n(89728)),f=n(73744),g=n(35683),h=n(85893);const v=(0,c.defineMessages)({open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"}});function b(e){window.__c={n:"SnackbarButton"};const t=(0,r.Fg)();return(0,h.jsx)(m.Z,{...e,style:{color:t.regularInvertedTextColor,fontWeight:500,height:void 0,marginLeft:0,...e.style}})}function y(e){window.__c={n:"SnackbarUndoButton"};const{onUndo:t}=e,n=(0,i.O7)();return(0,h.jsx)(b,{onClick:()=>{d.Yw(n,!0),p.rN(),null==t||t()},children:(0,h.jsx)(c.FormattedMessage,{defaultMessage:"Undo",id:"snackbar.undo.title"})})}function _(e){window.__c={n:"SuccessSnackbarButtons"};const{blockStoreToOpen:t,performUndo:n}=e,d=(0,i.O7)(),p=(0,r.yK)((e=>({icon:{fill:e.regularInvertedTextColor},wrap:{display:"flex",columnGap:8}})),[]),m=(0,o.useMemo)((()=>t?e=>{u._({environment:d,openInNew:(0,f.DJ)(e),store:t,visitType:g.vu.Link,pageVisitSource:a.tY.ButtonAutomation})}:void 0),[t,d]);return(0,h.jsxs)("div",{style:p.wrap,children:[m&&(0,h.jsx)(b,{onClick:m,icon:e=>(0,s.g)({...e,...p.icon,width:16,height:16}),style:{paddingRight:0},children:(0,h.jsx)(c.FormattedMessage,{...v.open})}),n&&(0,h.jsx)(b,{onClick:n,icon:e=>(0,l.s)({...e,...p.icon,marginTop:-2,width:16,height:16}),children:(0,h.jsx)(c.FormattedMessage,{...v.undo})})]})}},99571:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(62965),d=n(9291),u=n(35328),p=n(73819),m=n(23864),f=n(65187),g=n(17377),h=n(85893);const v=(0,d.defineMessages)({placeholder:{defaultMessage:"Heading 2",id:"subheaderBlock.placeholder"}});function b(e,t){window.__c={n:"SubHeaderBlock"};const n=(0,d.useIntl)(),c=(0,i.O7)(),b=(0,i.Fy)(),y=(0,o.useRef)(null),_=(0,p.rv)(e.store),S=(0,p.Iy)(e.store),w=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),k=(0,a.yK)((e=>{const t=(b.isMobile?1.25:l.Lh)*l.u9,n=b.isMobile?1.25:l.Lh;return{root:{display:"flex",width:"100%",..._},toggle:{height:`${t}em`,marginTop:b.isMobile?1:s.ZD.paddingTop,marginBottom:s.ZD.paddingBottom},headerText:{...s.ZD,...(0,l.HV)({fontSizeValue:n,fontFamily:S})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[_,b.isMobile,S]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"sub_header",getNode:()=>y.current,getBlockStore:()=>e.store,activate(){u.th(c,e.store,e.hideContent)}})),[c,e.hideContent,e.store]),(0,h.jsx)("div",{ref:y,style:{...k.root,...e.style},children:(0,h.jsxs)(g.Z,{store:e.store,toggleStyle:k.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,h.jsx)(f.Z,{tagName:"h3",disabled:e.disabled,store:w,placeholder:n.formatMessage(v.placeholder),placeholderStyle:k.headerTextPlaceholder,style:k.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,h.jsx)(m.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]})}))}const y=o.memo(o.forwardRef(b),c.Z)},51704:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(62965),d=n(9291),u=n(35328),p=n(73819),m=n(23864),f=n(65187),g=n(17377),h=n(85893);const v=(0,d.defineMessages)({placeholder:{defaultMessage:"Heading 3",id:"subsubheaderBlock.placeholder"}});function b(e,t){window.__c={n:"SubSubHeaderBlock"};const n=(0,d.useIntl)(),c=(0,i.O7)(),b=(0,i.Fy)(),y=(0,o.useRef)(null),_=(0,p.rv)(e.store),S=(0,p.Iy)(e.store),w=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),k=(0,a.yK)((e=>{const t=(b.isMobile?1.17:l.C)*l.u9,n=b.isMobile?1.17:l.C;return{root:{display:"flex",width:"100%",..._},toggle:{height:`${t}em`,marginTop:b.isMobile?1:s.ZD.paddingTop,marginBottom:s.ZD.paddingBottom},headerText:{...s.ZD,...(0,l.Jr)({fontSizeValue:n,fontFamily:S})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[_,b.isMobile,S]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"sub_sub_header",getNode:()=>y.current,getBlockStore:()=>e.store,activate(){u.th(c,e.store,e.hideContent)}})),[c,e.hideContent,e.store]),(0,h.jsx)("div",{ref:y,style:{...k.root,...e.style},children:(0,h.jsxs)(g.Z,{store:e.store,toggleStyle:k.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,h.jsx)(f.Z,{tagName:"h4",disabled:e.disabled,store:w,placeholder:n.formatMessage(v.placeholder),placeholderStyle:k.headerTextPlaceholder,style:k.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,h.jsx)(m.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]})}))}const y=o.memo(o.forwardRef(b),c.Z)},40235:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(24405),i=n(82990),r=n(64369),a=n(85893);const s={height:32,width:"100%"},l={paddingTop:8,paddingBottom:8},c={fontWeight:i.Z.fontWeight.regular,textAlign:"left",paddingTop:8,paddingBottom:8};const d=function(e){let{columns:t,rows:n,cellStyle:i,tableStyle:d,hideHeader:m}=e;window.__c={n:"TableBox"};const f=(0,o.Fg)();return(0,a.jsxs)("table",{style:{...u(f),...d},children:[!m&&(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{style:s,children:t.map((e=>(0,a.jsx)("th",{style:{...c,...e.style},children:(0,a.jsx)(r.Z,{isSmall:!0,children:e.header})},e.key)))})}),(0,a.jsx)("tbody",{children:n.map((e=>(0,a.jsx)("tr",{style:p(f),children:e.columns.map(((e,n)=>{const o=t[n];return(0,a.jsx)("td",{style:{...l,...i},children:e},o.key)}))},e.key)))})]})};function u(e){return{width:"100%",fontSize:13,borderTop:`1px solid ${e.regularDividerColor}`,borderBottom:`1px solid ${e.regularDividerColor}`}}function p(e){return{width:"100%",borderTop:`1px solid ${e.regularDividerColor}`}}},65187:(e,t,n)=>{n.d(t,{Z:()=>de});var o=n(67294),i=n(83355),r=n(1302),a=n(41432),s=n(8848),l=n(22491),c=n(53877),d=n(42875),u=n(72126),p=n(62193),m=n(6746),f=n(21202),g=n(23867),h=n(70203),v=n(63143),b=n(9291),y=n(50906),_=n(893),S=n(65770),w=n(993),k=n(98724),I=n(56971),x=n(74284),C=n(17269),T=n(98104),M=n(32741),P=n(82530),A=n(1742),R=n(92022),D=n(48514),B=n(60682),E=n(49117),F=n(14976),Z=n(19124),V=n(62619),j=n(33929),U=n(68056),L=n(45162),O=n(73959),N=n(89086),z=n(66638),W=n(77907),q=n(21273),H=n(8949),K=n(16772),G=n(66949),$=n(77080),Q=n(69316),Y=n(52689),J=n(23178),X=n(19111),ee=n(26136),te=n(10743),ne=n(99757),oe=n(24666),ie=n(29595),re=n(93262),ae=n(42402),se=n(85893);const le=(0,b.defineMessages)({typeTextPlaceholder:{defaultMessage:"Press â€˜/â€™ for commandsâ€¦",id:"text.commandsMenuNotOpen.placeholder"},typeAiTextPlaceholder:{defaultMessage:"Press â€˜spaceâ€™ for AI, â€˜/â€™ for commandsâ€¦",id:"text.commandsMenuNotOpen.placeholder.ai"},typeTextAiPlaceholder:{defaultMessage:"Press â€˜/â€™ for commands, â€˜spaceâ€™ for AIâ€¦",id:"text.commandsMenuNotOpen.placeholder.textAi"},filterPlaceholder:{defaultMessage:"Type to filterâ€¦",id:"text.commandsMenuOpen.placeholder"}});class ce extends i.Z{constructor(e){super(e),this.editor=null,this.mergeEditorRefs=(0,p.sH)(),this.triggeredAnalytics=!1,this.reminderTimers={},this.renderContentContainer=(e,t)=>(0,se.jsx)(ie.Z,{...this.classNameAndStyleStore.state,onBlur:this.props.onBlur,onFocus:this.props.onFocus,getDisabled:this.getDisabled,spellCheck:!this.canExclusivelyComment(),getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:this.handleMutation,onCompositionStart:()=>{return e=this.props.onChange,t=this.environment,T.z9(t,!0),void(e&&e());var e,t},onCompositionEnd:this.handleCompositionEnd,onSelect:t,placeholder:this.getCurrentPlaceholder(),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!0,disableContentEditableWhenNotEditingTextOnMobile:!0,id:this.props.id,tagName:this.props.tagName,...e,ref:this.mergeEditorRefs(this.handleEditorRef,e.leafRef)}),this.handleEditorRef=e=>{this.editor=e},this.isSpaceComposition=()=>{if(!this.shouldRenderInteractiveAiPlaceholder.state)return!1;const e=h.eeV(this.getTextValue());return 1===e.length&&("ã€€"===e[0]||" "===e[0])},this.handleCompositionEnd=()=>{T.z9(this.environment,!1),(0,L.Aw)(this.environment)&&w.g2({environment:this.environment,store:this.props.store,usingMultiSelection:!0}),this.props.onChange&&this.props.onChange(),this.isSpaceComposition()?(0,R.toggleInitialPrompt)({from:"spacebar",environment:this.environment}):P.createAndCommit({userAction:"Text.runAllFiltersAfterCompositionEnd",environment:this.environment,perform:e=>{C.G({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleDelete=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_delete");const{store:t}=this.props,n=oe.default.state;if("editing"===n.mode){const o=n.multiSelection;o.start.store===t&&P.createAndCommit({userAction:"Text.handleDelete",environment:this.environment,perform:t=>{I.as({environment:this.environment,multiSelection:o,deleteForwards:!0,transaction:t,event:e})}})}pe(),this.props.onChange&&this.props.onChange()},this.handleForwardDeleteAtEndOfLine=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const{store:t}=this.props,n=oe.default.state;if("editing"!==n.mode)return;const o=n.multiSelection;(0,U.iG)(o)&&(0,N.J_)(t,{startIndex:o.start.index,endIndex:o.end.index})&&this.handleDelete(e)},this.handleBackspace=e=>{if(!this.canEditStore.state||this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_backspace");const{store:t}=this.props,n=oe.default.state;if("editing"===n.mode){const o=n.multiSelection;if(o.start.store===t){if(I.YV({device:this.environment.device,event:e,multiSelection:o}))return;P.createAndCommit({userAction:"Text.handleBackspace",environment:this.environment,perform:t=>{I.as({environment:this.environment,multiSelection:o,deleteForwards:!1,transaction:t,event:e})}})}}pe(),this.props.onChange&&this.props.onChange(e)},this.handleEnter=e=>{if(!this.canEditStore.state)return;if(this.logTypingLag("typing_enter"),V.IL(e),this.editor&&this.editor.isComposing)return;const t=oe.default.state;if("editing"===t.mode)if(this.props.onEnter)this.props.onEnter(e);else{const{multiSelection:e}=t;P.createAndCommit({userAction:"Text.handleEnter",environment:this.environment,perform:t=>{x.IO({environment:this.environment,multiSelection:e,transaction:t})}}),pe()}this.props.onChange&&this.props.onChange(e)},this.handleShiftEnter=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const t=oe.default.state;if("editing"===t.mode){const{device:n}=this.environment;if(!("shiftKey"in e)||e.shiftKey&&!n.isIOS){if(this.props.disableShiftEnter)return;P.createAndCommit({userAction:"Text.handleShiftEnter",environment:this.environment,perform:e=>{w.hJ({environment:this.environment,string:"\n",multiSelection:t.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}}),this.props.onChange&&this.props.onChange(e)}else this.handleEnter(e)}},this.handleTab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_tab"),this.props.onTab){this.props.onTab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,O.sQ)(this.props.store);t&&(P.createAndCommit({userAction:"Text.handleTab",environment:this.environment,perform:e=>{w.n2({environment:this.environment,closestSelectable:t,shiftKey:!1,transaction:e})}}),pe())}this.props.onChange&&this.props.onChange()}},this.handleUntab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_untab"),this.props.onUntab){this.props.onUntab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,O.sQ)(this.props.store);t&&(P.createAndCommit({userAction:"Text.handleUntab",environment:this.environment,perform:e=>{w.n2({environment:this.environment,closestSelectable:t,shiftKey:!0,transaction:e})}}),pe())}this.props.onChange&&this.props.onChange()}},this.handleAnnotation=(e,t)=>{this.canEditStore.state&&(t.preventDefault(),k.aS({environment:this.environment,annotation:e}),pe(),this.props.onChange&&this.props.onChange(),y.duO(this.environment,{type:h.J7s(e)}))},this.handleToggleHighlight=e=>this.handleAnnotation(["h",Y.Z.state.color],e),this.handleToggleBold=e=>this.handleAnnotation(["b"],e),this.handleToggleItalics=e=>this.handleAnnotation(["i"],e),this.handleToggleStrike=e=>this.handleAnnotation(["s"],e),this.handleToggleUnderline=e=>this.handleAnnotation(["_"],e),this.handleToggleCode=e=>this.handleAnnotation(["c"],e),this.handleClick=e=>{this.handleClickActions(e),this.props.onClick&&this.props.onClick(e)},this.handleContextMenu=e=>{const t=this.parentBlockStore.state;t&&F.li({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:t,canEdit:this.canEditStore.state})},this.handleMouseOver=e=>{F.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleMouseOut=e=>{F.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleCut=e=>{if(this.canEditStore.state){if(this.props.onCut)return this.props.onCut(e),void pe();_.by({environment:this.environment,event:e,markdownLinkifyIt:this.props.markdownLinkifyIt}),pe(),this.props.onChange&&this.props.onChange()}else e.preventDefault()},this.handlePaste=e=>{this.canEditStore.state&&(P.createAndCommit({userAction:"Text.handlePaste",environment:this.environment,perform:t=>{_.v({environment:this.environment,event:e,disableEmbedMenu:Boolean(this.props.disableEmbedMenu),transaction:t,onPasteFiles:this.props.onPasteFiles||_.AL,markdownLinkifyIt:this.props.markdownLinkifyIt,tinyMceMicrosoftWordPasteFilter:this.props.tinyMceMicrosoftWordPasteFilter})}}),pe(),this.props.onChange&&this.props.onChange())},this.handleKeyPress=e=>{if(" "===e.key&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&this.isEmpty()&&this.shouldRenderInteractiveAiPlaceholder.state)return e.preventDefault(),void(0,R.toggleInitialPrompt)({from:"spacebar",environment:this.environment});this.canEditStore.state||e.metaKey&&"c"===e.key||e.preventDefault()},this.handleCopy=e=>{!function(e,t,n,o){if(t)return void t(e);_.JG({environment:o,event:e,markdownLinkifyIt:n})}(e,this.props.onCopy,this.props.markdownLinkifyIt,this.environment)},this.handleMoveUp=e=>{!function(e,t){e.preventDefault(),P.createAndCommit({userAction:"Text.handleMoveUp",environment:t,perform:e=>{w.fs({environment:t,transaction:e,direction:"up"})}})}(e,this.environment)},this.handleMoveDown=e=>{var t;t=this.environment,P.createAndCommit({userAction:"Text.handleMoveDown",environment:t,perform:e=>{w.fs({environment:t,transaction:e,direction:"down"})}})},this.aiTextPlaceholderMessage=this.createComputedStore((()=>"on"===$.default.getEligibleGroup({experimentId:"prioritize_slash_menu_block_placeholder",defaultGroup:"control"})?j.default.formatMessage(le.typeTextAiPlaceholder):j.default.formatMessage(le.typeAiTextPlaceholder)),!1,"aiTextPlaceholderMessageStore"),this.canEditStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(ne.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return(!this.props.isDiscussionInput||null==e||!e.hasPublicPermission||"view"!==e.permission)&&(!(!this.props.isDiscussionInput&&null!=e&&e.hasPublicPermission&&"edit"!==e.permission)&&this.props.store.canEdit())}),!1,"canEditStore"),this.getDisabled=()=>!this.canEditStore.state,this.getHtml=()=>{var e;let t=this.getTextValue(),n=!1;if(this.props.canTruncate&&void 0!==this.props.maxChars){h.eeV(t).length>this.props.maxChars&&(t=h.KU1(this.getTextValue(),0,this.props.maxChars),n=!0)}const i=F.IY({environment:this.environment,textValue:t&&{value:t,spaceId:(0,g.C)(this.props.store.pointer.spaceId)},parentStore:this.props.parentStore||this.props.store,disableHover:!1,disableStyleAnnotations:Boolean(this.props.disableStyleAnnotations),disableInsertedDeletedAnnotations:Boolean(this.props.disableInsertedDeletedAnnotations),disableDateStyleAnnotations:Boolean(this.props.disableDateMentions),disabled:!this.canEditStore.state,theme:this.theme,emojiType:(0,B.e_)(this.environment),katex:this.environment.KatexStore.getKatex(),parentBlockId:me(this.props.store),renderedPageBlockId:null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.id,formulaValueTypes:[]}),r=(0,se.jsxs)(o.Fragment,{children:[i,n&&(a=this.theme,(0,se.jsxs)(ae.Z,{disableUnderline:!0,style:{color:a.mediumTextColor},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["â€¦",(0,se.jsx)("span",{children:(0,se.jsx)(b.FormattedMessage,{id:"text.truncated.showMoreLabel",defaultMessage:"more"})})]}))]});var a;return m.Z.renderToStaticMarkup(r)},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.getTextValue=()=>F.Rl({store:this.props.store,textValue:this.getTextValueHelper()}),this.getTextValueHelper=()=>{if(this.isNewDiscussionMenuTarget.state)return F.Gj({store:this.props.store});if(this.isInlineEquationOverlayTarget.state)return F.PY({store:this.props.store,equationStore:G.Z});if(this.isMentionMenuTarget.state)return F.Ob({store:this.props.store,mentionMenuState:this.isMentionMenuTarget.state});if(this.linkingMenuSelectionStore.state)return F.So({store:this.props.store,selection:this.linkingMenuSelectionStore.state});if(this.findAndReplaceStore.state){const e=this.findAndReplaceStore.state;return F.cD({store:this.props.store,find:e})}if(this.isCompletionPopupTarget.state)return F.fm({store:this.props.store,temporaryAnnotation:h.GKr.TemporarySelection,multiSelection:ue()});const e=this.pageAnnotationBlockMenuStore.state;if(e)return e;if(this.isEditing.state){const e=oe.default.state;if("editing"===e.mode){const t=(0,U.QY)(e.multiSelection);if(t)return F.xX({store:this.props.store,selection:t.selection})}}return this.props.store.getValue()},this.parentBlockStore=this.createComputedStore((()=>{const{store:e}=this.props;if(e.pointer.table===f.iU)return ee.G.createChildStore(e,e.pointer)}),!1,"parentBlockStore"),this.isEditing=this.createComputedStore((()=>(0,N.J5)(this.props.store)),!1,"isEditing"),this.isSelectionEndpoint=this.createComputedStore((()=>(0,N.Gq)(this.props.store)),!1,"isSelectionEndpoint"),this.isCompletionsEnabledStore=this.createComputedStore((()=>{var e;const t=null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state;return(0,Z.GD)(t)}),!1,"isCompletionsEnabledStore"),this.shouldRenderInteractiveAiPlaceholder=this.createComputedStore((()=>{if(this.environment.device.isMobile||this.environment.device.isMobileNative)return!1;if(this.props.disabled)return!1;if(!this.isCompletionsEnabledStore.state)return!1;const e=this.parentBlockStore.state,t=e&&e.getType();return Boolean(t&&(0,a.hD)(t))&&"contains-selection"===this.isEditing.state&&!(e&&(0,E.td)(e))}),!1,"shouldRenderInteractiveAiPlaceholder"),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{const e=D.Z.state;return e.open&&"inline"===e.type&&Boolean((0,L.r)(e.multiSelection,this.props.store))}),!1,"isNewDiscussionMenuTarget"),this.isCompletionPopupTarget=this.createComputedStore((()=>{if(q.Z.isAssistantInWriterEnabled())return!1;const e=ue();return e&&Boolean((0,L.r)(e,this.props.store))}),!1,"isCompletionPopupTarget"),this.isInlineEquationOverlayTarget=this.createComputedStore((()=>{var e;return G.Z.isOpen()&&(null===(e=(0,U.QY)(G.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store)===this.props.store}),!1,"isInlineEquationOverlayTarget"),this.isMentionMenuTarget=this.createComputedStore((()=>{const e=X.Z.state;return!!e.open&&(e.textStore===this.props.store&&e)}),!1,"isMentionMenuTarget"),this.linkingMenuSelectionStore=this.createComputedStore((()=>{const e=J.Z.state;if(!e.open)return!1;if(!e.focusLinkInput&&!e.focusTitleInput)return!1;if(!this.isEditing.state)return!1;const t=(0,U.QY)(e.savedTextSelectionState.multiSelection);return!!t&&t.selection}),!1,"linkingMenuSelectionStore"),this.findAndReplaceStore=this.createComputedStore((()=>{const e=Q.Z.state;return e.open&&e.findQuery.length>0?e.findQuery:void 0})),this.pageAnnotationBlockMenuStore=this.createComputedStore((()=>{const e=H.Z.state;if(!e.isActive)return;const{clickedPageAnnotation:t}=e;if(!t)return;const{parentStore:n,pageAnnotation:o}=t;if(n!==this.parentBlockStore.state)return;const i=this.props.store.getValue();return i?null==i?void 0:i.map((e=>h.km_(e)?[e[0],e[1].flatMap((e=>h.STW(e)&&e===o?[o,h.EPB()]:[e]))]:e)):void 0}),!1,"pageAnnotationBlockMenuStore"),this.getContainerSelection=()=>{const e=Boolean(this.linkingMenuSelectionStore.state);if((0,L.Aw)(this.environment)&&this.isSelectionEndpoint.state){if(e)return;return(0,N.HE)(this.props.store)}if(this.isEditing.state&&!e){const{store:e}=this.props,t=oe.default.state;if("editing"===t.mode){const n=(0,L.xI)("Text",t.multiSelection);if(n){const{selection:t}=n,o=e.getValue(),i=h.eeV(o).length;return{type:"contain",selection:{startIndex:Math.min(t.startIndex,i),endIndex:Math.min(t.endIndex,i)}}}}}},this.getEndSelection=()=>{const e=h.eeV(this.getTextValue());return{startIndex:e.length,endIndex:e.length}},this.classNameAndStyleStore=this.createComputedStore((()=>(0,l.iv)(this.getStyle(),this.props.className)),!1,"classNameAndStyleStore"),this.handleMutation=this.handleMutation.bind(this)}UNSAFE_willMountOrUpdate(){this.createReminderTimers(),this.environment.KatexStore.loadIfNeeded(this.getTextValue)}willUnmount(){this.clearReminderTimers(),M.qA(this.props.store)}isComposing(){return this.editor&&this.editor.isComposing}createReminderTimers(){const e=this.getTextValue(),t=h.nai(e),n=u.oA(t.map((e=>{const t=(0,c.KR)(e,(0,d.r)());return null==t?void 0:t.toMillis()}))),o=Date.now();for(const i of n){const e=i-o;e>0&&e<v.A0&&(i in this.reminderTimers||(this.reminderTimers[i]=setTimeout(this.enqueueForceUpdate,e)))}for(const i in this.reminderTimers)n.includes(parseInt(i))||(clearTimeout(this.reminderTimers[i]),delete this.reminderTimers[i])}clearReminderTimers(){for(const e in this.reminderTimers)clearTimeout(this.reminderTimers[e]),delete this.reminderTimers[e]}renderComponent(){const{disableInsertText:e,disableStyleAnnotations:t,disableSelectAllBlocks:n,disableSelectionDrag:o,disableDrag:i,disabled:r}=this.props;return(0,se.jsx)(re.Z,{...this.props,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,canInsertText:!r&&!e,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onDelete:this.handleDelete,onDeleteToEndOfLine:this.handleForwardDeleteAtEndOfLine,onDeleteNextWord:this.handleForwardDeleteAtEndOfLine,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:this.handleToggleHighlight,onToggleBold:this.handleToggleBold,onToggleItalics:this.handleToggleItalics,onToggleStrike:this.handleToggleStrike,onToggleUnderline:this.handleToggleUnderline,onToggleCode:this.handleToggleCode,onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onKeyPress:this.handleKeyPress,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,render:this.renderContentContainer,disableStyleAnnotations:t,canSelectAllBlocks:!n,canSelectionDrag:!o,disableDrag:i,topBottomPadding:9})}getCurrentPlaceholder(){const{device:e}=this.environment;if(this.shouldRenderInteractiveAiPlaceholder.state)return this.aiTextPlaceholderMessage.state;if(this.props.placeholder)return this.props.placeholder;if(!this.props.disabled){if(!this.props.disableSlashCommands&&"contains-selection"===this.isEditing.state&&this.canEditStore.state){if(te.Z.state.open)return j.default.formatMessage(le.filterPlaceholder);if(!e.isMobile)return j.default.formatMessage(le.typeTextPlaceholder)}return" "}}handleMutation(e){if(this.logTypingLag("typing_lag"),!this.canEditStore.state)return;(0,L.Aw)(this.environment)?P.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{let n=this.props.store;const{multiSelection:o}=e;if(o&&!(0,U.qS)(o))n=o.start.store;else if(this.props.legacyTransclusionParent&&!e.insertedLine&&!e.isComposing&&!e.deletedLine){const e=S.Z2({environment:this.environment,store:n,parentStore:this.props.legacyTransclusionParent,transaction:t});e&&(n=e)}if(w.YV({environment:this.environment,store:n,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableFilters:e.isComposing,disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),transaction:t,multiSelection:o}),e.insertedLine){const e="editing"===oe.default.state.mode&&oe.default.state.multiSelection;e&&x.IO({environment:this.environment,multiSelection:e,transaction:t})}this.props.trackEditsToUserFlow&&!t.isEmpty()&&A.uO(this.environment,this.props.trackEditsToUserFlow,t)}}):P.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{w.aS({environment:this.environment,store:this.props.store,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),disableFilters:e.isComposing,transaction:t})}});const{store:t}=this.props,n=this.parentBlockStore.state;if(n){if(n.getType()){const e=n.getSchema()||{};if("properties"===t.path[0]&&t.path[1]){e[t.path[1]]&&!this.triggeredAnalytics&&(this.triggeredAnalytics=!0)}}}this.props.onChange&&this.props.onChange()}handleClickActions(e){F.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state,disableEquationInteraction:this.props.disableEquationInteraction})}canExclusivelyComment(){return e=this.props.disabled,t=this.props.store,!e&&t.canComment()&&!this.canEditStore.state;var e,t}focus(){this.isEditing.state||T.NX({store:this.props.store})}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}isEmpty(){return 0===h.lzi(this.getTextValue()).length}logTypingLag(e){const t=!this.props.disabled&&"inline"===this.props.pasteBehavior;(0,z.u)({type:e,environment:this.environment,blockStore:this.parentBlockStore.state,store:this.props.store,isInCollectionView:t})}getStyle(){const{device:e}=this.environment;let t={maxWidth:"100%",width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",caretColor:this.canExclusivelyComment()?s.ZP.transparent:this.theme.regularTextColor,...this.props.style};return this.isEmpty()&&(t.minHeight="1em",t={...t,color:this.theme.regularTextColor,WebkitTextFillColor:this.theme.lightTextColor,...this.props.placeholderStyle}),e.isMobile&&this.canEditStore.state&&(this.isEditing.state?t.WebkitUserModify="read-write-plaintext-only":(t.userSelect="none",t.WebkitUserSelect="none",t.whenFocusedEditable={userSelect:"text",WebkitUserSelect:"text",WebkitUserModify:"read-write-plaintext-only"})),t}}ce.displayName="Text";const de=o.forwardRef((function(e,t){const{value:n}=(0,W.useDependency)(W.deps.markdownLinkifyIt),{value:o}=(0,W.useDependency)(W.deps.tinyMceMicrosoftWordPasteFilter);return(0,se.jsx)(ce,{...e,ref:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}));function ue(){const e=K.default.state;return("closedWithContext"===e.type||"completionPopup"===e.type&&"initialPromptForAIBlock"!==e.stage)&&"textSelection"===e.context.type?e.context.textSelection:void 0}function pe(){r.default.flush()}function me(e){if(e.table===f.iU)return e.id;const{ancestor:t}=e.findRecordStoreUIAncestor((e=>{let{table:t}=e;return t===f.iU}));return t?t.id:void 0}},17970:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),i=n(86628),r=n(24405),a=n(49271),s=n(62965),l=n(73819),c=n(77080),d=n(23864),u=n(55217),p=n(65187),m=n(85893);function f(e,t){let{disabled:n,disableCommentMenu:s,disableHoverMenu:f,disableDrag:g,hideContent:v,legacyTransclusionParent:b,store:y,style:_}=e;window.__c={n:"TextBlock"};const S=(0,i.VK)((()=>y.getBlockTitleStore()),[y]),w=(0,i.VK)((()=>y.getContentStore()),[y]),k=(0,o.useRef)(null),I=(0,i.VK)((()=>w.getValue()||[]),[w]),x=(0,i.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=y.getFormat();switch(e){case"right":case"center":return{textAlign:y.getFormat().block_alignment};default:return{textAlign:"left"}}}),[y]),C=(0,i.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=y.getFormat();switch(e){case"center":return{textAlign:"left",paddingLeft:"50%"};case"right":return{textAlign:"right"};default:return{textAlign:"left"}}}),[y]),T=(0,l.rv)(y),M=(0,r.yK)((()=>({root:{...x,...T,..._}})),[x,T,_]),P=I.length>0?(0,m.jsx)("div",{style:h,children:(0,m.jsx)(u.Z,{disabled:n,store:w,disableCommentMenu:s,disableHoverMenu:f,disableDrag:g})}):(0,m.jsx)(u.Z,{disabled:!0,store:w}),A=(0,m.jsxs)("div",{style:M.root,ref:k,children:[(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)(p.Z,{style:a.ZD,placeholderStyle:C,disabled:n,store:S,pasteBehavior:"block",legacyTransclusionParent:b,trackEditsToUserFlow:"user_flow_edit_block"}),(0,m.jsx)(d.Z,{disableCommentMenu:s,hideContent:v,store:y})]}),!v&&P]});return(0,l.ez)(y,t,(0,o.useMemo)((()=>({renderedType:"text",getBlockStore:()=>y,getNode:()=>k.current})),[y]),A)}const g=o.memo(o.forwardRef(f),s.Z),h={paddingLeft:"1.5em",display:"flex",flexDirection:"column"}},11620:(e,t,n)=>{n.d(t,{Z:()=>x});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(80951),c=n(72126),d=n(62965),u=n(9291),p=n(50906),m=n(9953);var f=n(82530),g=n(73819),h=n(27724),v=n(23864),b=n(60458),y=n(55217),_=n(78454),S=n(65187),w=n(85893);const k=(0,u.defineMessages)({placeholder:{defaultMessage:"To-do",id:"todoBlock.placeholder"}});function I(e,t){window.__c={n:"TodoBlock"};const n=(0,u.useIntl)(),d=(0,i.Fy)(),I=(0,i.O7)(),x=(0,o.useRef)(null),C=(0,o.useId)(),T=(0,g.PE)(e.store,e.disabled),M=(0,g.rv)(e.store),P=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),A=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),R=(0,r.VK)((()=>{const t=e.store.getProperties();return!!t&&l.Ml(t.checked)}),[e.store]),D=(0,o.useCallback)((()=>{if(T){let t;t=c.q9(h.default.state.stores,e.store)?h.default.state.stores:[e.store],R?f.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:I,perform:e=>{!function(e){const{environment:t,blocks:n,transaction:o}=e;for(const i of n)m.sW({store:i.getPropertiesStore(),data:{checked:l._I(!1)},transaction:o});p.JrP(t,{is_checked:!1})}({environment:I,blocks:t,transaction:e})}}):f.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:I,perform:e=>{!function(e){const{blocks:t,transaction:n,environment:o}=e;for(const i of t)m.sW({store:i.getPropertiesStore(),data:{checked:l._I(!0)},transaction:n});p.JrP(o,{is_checked:!0})}({environment:I,blocks:t,transaction:e})}})}}),[T,I,R,e.store]),B=(0,a.yK)((e=>({root:{paddingLeft:s.ZD.paddingLeft,...M},title:{..._.R8,width:void 0,flexGrow:1,...R&&{textDecoration:"line-through",textDecorationColor:e.strikethroughLineColor,opacity:1,color:e.mediumTextColor}}})),[M,R]),E=(0,w.jsxs)(_.ZP,{style:{...B.root,...e.style},left:(0,w.jsx)(b.Z,{"aria-labelledby":C,checked:R,onClick:D,disabled:!T,size:16,fill:M.color,tapArea:d.isMobile?{size:30}:void 0}),childrenStyle:{display:"flex",flexDirection:"column"},ref:x,children:[(0,w.jsxs)("div",{style:{display:"flex"},children:[(0,w.jsx)(S.Z,{id:C,style:B.title,disabled:e.disabled,store:P,placeholder:n.formatMessage(k.placeholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,w.jsx)(v.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,w.jsx)(y.Z,{disabled:e.disabled,store:A,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})]});return(0,g.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"to_do",getNode:()=>x.current,getBlockStore:()=>e.store,activate:D})),[e.store,D]),E)}const x=o.memo(o.forwardRef(I),d.Z)},4859:(e,t,n)=>{n.d(t,{J9:()=>A,ZP:()=>P,kA:()=>R});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(72126),c=n(62965),d=n(9291),u=n(50906),p=n(29373),m=n(82530),f=n(28020),g=n(52315),h=n(73819),v=n(27724),b=n(45131),y=n(23864),_=n(64921),S=n(25777),w=n(55217),k=n(78454),I=n(65187),x=n(5210),C=n(85893);const T=(0,d.defineMessages)({placeholder:{defaultMessage:"Toggle",id:"toggleBlock.placeholder"}});function M(e,t){window.__c={n:"ToggleBlock"};const n=(0,i.O7)(),c=(0,d.useIntl)(),M=(0,o.useRef)(!0);(0,o.useLayoutEffect)((()=>{M.current&&(M.current=!1,p.nz({blockId:e.store.id,currentUserId:n.currentUser.id}),e.store.isDefaultRecordCache()&&p.LO(n,e.store.pointer))}));const P=(0,o.useRef)(null),A=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),R=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),D=(0,r.VK)((()=>b.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),B=(0,r.VK)((()=>!e.store.hasContent()),[e.store]),E=(0,o.useId)(),F=(0,o.useId)(),Z=(0,r.VK)((()=>g.b(e.store)||!e.store.isDefaultRecordCache()),[e.store]),V=(0,o.useCallback)((()=>{let t;t=l.q9(v.default.state.stores,e.store)?v.default.state.stores:[e.store];const o=!D;for(const e of t)p.rd({blockId:e.id,state:o,currentUserId:n.currentUser.id});u.jRT(n,{is_toggled:o})}),[n,D,e.store]),j=(0,o.useCallback)((()=>{m.createAndCommit({userAction:"ToggleBlock.handlePlaceholderClick",environment:n,perform:t=>{p.ls({environment:n,store:e.store,transaction:t})}})}),[n,e.store]),U=(0,o.useCallback)((e=>{if(e.shiftKey){const e=f.np();e&&p.X_(n,e)}else V()}),[n,V]),L=(0,h.rv)(e.store),O=(0,a.yK)((t=>({root:{paddingLeft:s.ZD.paddingLeft,...L,...e.style},placeholderButton:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...s.ZD,marginTop:2},placeholderText:{color:t.lightTextColor}})),[L,e.style]),N=(0,C.jsx)(_.Z,{style:O.placeholderButton,onClick:j,disabled:e.disabled,children:(0,C.jsx)("span",{style:O.placeholderText,children:(0,C.jsx)(d.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlock.emptyBlock.placeholderText"})})}),z=(0,C.jsxs)(k.ZP,{style:O.root,left:(0,C.jsx)(x.Z,{"aria-describedby":E,"aria-controls":F,isSidebar:!1,open:D,fill:!B,onClick:U,tapArea:n.device.isMobile?{size:30}:void 0}),leftStyle:{paddingRight:2},ref:P,children:[(0,C.jsxs)("div",{style:{display:"flex"},children:[(0,C.jsx)(I.Z,{id:E,style:k.R8,disabled:e.disabled,store:A,placeholder:c.formatMessage(T.placeholder),pasteBehavior:"block"}),(0,C.jsx)(y.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,recursivelyLoadAllDiscussions:!D})]}),D?(0,C.jsx)(S.Z,{id:F,loaded:Z,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column",width:"100%"},style:{display:"flex"},children:(0,C.jsx)(w.Z,{store:R,emptyPlaceholder:N,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})}):(0,C.jsx)(w.Z,{store:R,disabled:e.disabled,disableContent:!0})]});return(0,h.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"toggle",getNode:()=>P.current,getBlockStore:()=>e.store,activate(){V()}})),[e.store,V]),z)}const P=o.memo(o.forwardRef(M),c.Z);function A(){return{display:"flex"}}function R(){return{display:"flex",flexDirection:"column",width:"100%"}}},5210:(e,t,n)=>{n.d(t,{Z:()=>m,q:()=>u});var o=n(67294),i=n(480),r=n(24405),a=n(17693),s=n(91),l=n(9291),c=n(64921),d=n(85893);function u(e){let{isSidebar:t,isMobile:n}=e;return t&&!n?20:24}const p=(0,l.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}});function m(e){window.__c={n:"ToggleButton"};const t=(0,i.Fy)(),n=(0,l.useIntl)(),m=(0,o.useMemo)((()=>u({isSidebar:e.isSidebar,isMobile:t.isMobile})),[t.isMobile,e.isSidebar]),f=(0,r.yK)((()=>{const n=e.color||"inherit",o="chevron"===e.icon?`rotateZ(${e.open?0:-90}deg)`:`rotateZ(${e.open?180:90}deg)`,i="chevron"===e.icon,r=i&&t.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:m,height:m,borderRadius:4,...e.style},arrow:{width:r?14:i?12:"0.6875em",height:r?14:i?12:"0.6875em",transition:"transform 200ms ease-out",transform:o,fill:n,opacity:e.fill?1:.5}}}),[t.isMobile,e.color,e.fill,e.icon,e.open,e.style,m]),g=(0,o.useMemo)((()=>{switch(e.icon){case"chevron":return(0,a.A)(f.arrow);case"triangle":default:return(0,s.L)(f.arrow)}}),[e.icon,f.arrow]);return(0,d.jsxs)(c.Z,{ariaLabel:e.open?n.formatMessage(p.close):n.formatMessage(p.open),"aria-describedby":e["aria-describedby"],"aria-expanded":e.open,"aria-controls":e.open?e["aria-controls"]:void 0,style:f.button,onClick:e.onClick,onMouseDown:e.onMouseDown,disabled:e.disabled,allowShiftClick:!0,children:[e.tapArea&&(0,d.jsx)("div",{style:{position:"absolute",opacity:0,width:e.tapArea.size,height:e.tapArea.size,top:-(e.tapArea.size-m)/2,left:-(e.tapArea.size-m)/2}}),g]})}},85567:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),i=n(83355),r=n(24405),a=n(84939),s=n(8848),l=n(84619),c=n(19525),d=n(82990),u=n(43224),p=n(4023),m=n(64921),f=n(26388),g=n(85893);class h extends i.Z{constructor(){super(...arguments),this.tokenTextRef=o.createRef(),this.shouldShowFullValueTooltip=()=>Boolean(this.props.showFullValueTooltip&&this.tokenTextRef.current&&this.tokenTextRef.current.offsetWidth<this.tokenTextRef.current.scrollWidth)}renderComponent(){const e=this.theme;if(this.props.showFullValueTooltip||void 0!==this.props.tooltip)return(0,g.jsx)(f.ZP,{placement:this.props.tooltipPlacement??p.u.Right,renderTooltip:t=>(0,g.jsxs)("div",{...t,style:u.F6,children:[this.props.showFullValueTooltip&&(0,g.jsx)("div",{children:this.props.value}),void 0!==this.props.tooltip&&(0,g.jsx)("div",{style:{color:this.props.showFullValueTooltip?e.mediumInvertedTextColor:void 0},children:this.props.tooltip})]}),originGap:20,textWrap:!0,render:e=>(0,g.jsx)("div",{style:y(this.props.format,this.props.isSingle,this.props.shouldShrink,this.props.isRound,this.props.showRemoveButton,this.props.disabled,this.props.disabledFeedback,this.props.color,this.props.backgroundColor,this.props.style,this.environment,this.theme,this.props.shouldWrap),...e,onMouseEnter:t=>{(this.shouldShowFullValueTooltip()||void 0!==this.props.tooltip)&&e.onMouseEnter&&e.onMouseEnter(t)},children:this.renderTokenContent()})});if(this.props.onClick){const e=this.props.backgroundColor?{background:(0,a._j)(this.props.backgroundColor,1)}:void 0,t=this.props.backgroundColor?{background:(0,a._j)(this.props.backgroundColor,2)}:void 0;return(0,g.jsx)(m.Z,{style:y(this.props.format,this.props.isSingle,this.props.shouldShrink,this.props.isRound,this.props.showRemoveButton,this.props.disabled,this.props.disabledFeedback,this.props.color,this.props.backgroundColor,this.props.style,this.environment,this.theme,this.props.shouldWrap),hoveredStyle:e,pressedStyle:t,onClick:this.props.onClick,children:this.renderTokenContent()})}return(0,g.jsx)("div",{style:y(this.props.format,this.props.isSingle,this.props.shouldShrink,this.props.isRound,this.props.showRemoveButton,this.props.disabled,this.props.disabledFeedback,this.props.color,this.props.backgroundColor,this.props.style,this.environment,this.theme,this.props.shouldWrap),children:this.renderTokenContent()})}renderTokenContent(){const{height:e}=(0,l.e1)(this.props.format);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{style:{...this.props.shouldWrap?{overflowWrap:"anywhere"}:d.Z.textOverflowStyle,textDecoration:this.props.isStrikedThrough?"line-through":void 0,display:"inline-flex",alignItems:"center",height:e,lineHeight:`${e}px`},children:[(0,g.jsx)(S,{showColoredDot:this.props.showColoredDot,format:this.props.format}),(0,g.jsx)("span",{style:{...d.Z.textOverflowStyle},ref:this.tokenTextRef,children:this.props.value})]}),(0,g.jsx)(b,{format:this.props.format,showRemoveButton:this.props.showRemoveButton,onClickRemove:this.props.onClickRemove,disabled:this.props.disabled})]})}}h.displayName="Token";const v=h;function b(e){let{format:t,showRemoveButton:n,onClickRemove:o,disabled:i}=e;const r=function(e){switch(e){case l.lo.Large:return 10;case l.lo.ExtraSmall:case l.lo.Small:case l.lo.Medium:case l.lo.Inline:default:return 8}}(t),{height:a}=(0,l.e1)(t),s={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,marginLeft:2,marginRight:2};return n?(0,g.jsx)(m.Z,{onClick:o,style:{...s,width:a,height:a},disabled:i,disabledFeedback:!1,mobileFeedback:!0,className:"notion-token-remove-button",children:(0,c.b)({width:r,height:r,opacity:.5})}):null}function y(e,t,n,o,i,r,a,c,d,u,p,m,f){const{height:g,fontSize:h,paddingLeft:v,margin:b}=(0,l.e1)(e),{ThemeStore:y}=p,_=o?v+1:v;return{display:t?"inline-flex":"flex",alignItems:"center",flexShrink:t||n?1:0,minWidth:0,maxWidth:"100%",height:g,borderRadius:o?g/2:3,paddingLeft:_,paddingRight:i?0:o?_+2:_,fontSize:h,lineHeight:"120%",opacity:r&&a?.4:void 0,color:c||("light"===y.state.mode?m.regularTextColor:s.ZP.whiteWithAlpha(.7)),background:d||m.legacyDefaultSelectColor,margin:t?0:b,...f&&{height:void 0,paddingTop:4,paddingBottom:4},...u}}function _(e,t,n){const o=(0,l.Nv)(t),i="default"===e?"gray":e;return void 0===i?{}:{marginRight:5,borderRadius:99,height:o,width:o,backgroundColor:"light"===n.mode?n.accentColors[i][400]:n.accentColors[i][700],display:"inline-flex",flexShrink:0}}function S(e){let{showColoredDot:t,format:n}=e;window.__c={n:"ColoredDotComponent"};const o=(0,r.Fg)();return t?(0,g.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,g.jsx)("div",{style:_(t,n,o)})}):null}},91791:(e,t,n)=>{n.d(t,{Z:()=>me});var o=n(67294),i=n(13991),r=n(86628),a=n(24405),s=n(49085),l=n(15145),c=n(41432),d=n(8848),u=n(9999),p=n(42853),m=n(61061),f=n(44495),g=n(54497),h=n(86517),v=n(72141),b=n(82990),y=n(51454),_=n(9291),S=n(50906),w=n(893),k=n(47307),I=n(24677),x=n(64964),C=n(98104),T=n(29373),M=n(82530),P=n(95477),A=n(95645),R=n(80365),D=n(84210),B=n(12534),E=n(87290),F=n(33929),Z=n(87279),V=n(39500),j=n(67669),U=n(18514),L=n(89224),O=n(61766),N=n(88632),z=n(55367),W=n(80796),q=n(22294),H=n(88923),K=n(26136),G=n(69784),$=n(49557),Q=n(77933),Y=n(4350),J=n(13966),X=n(23063),ee=n(64921),te=n(31945),ne=n(84076),oe=n(78140),ie=n(76798),re=n(72495),ae=n(83182),se=n(29551),le=n(55217),ce=n(79954),de=n(85893);const ue=(0,_.defineMessages)({copySuccessMessage:{defaultMessage:"Copied! Now paste in any page to sync content.",id:"transclusionContainerBlock.actions.copySuccessMessage"}});class pe extends A.Z{constructor(){super(...arguments),this.storeTypes={hovered:s.default.createClass(!1),haloShouldBeVisible:s.default.createClass(!1),actionBarShouldBeVisible:s.default.createClass(!1),backlinksIndicatorButtonPopupStore:O.Z},this.fakeSelectionTrapRef=o.createRef(),this.renderActionBarContent=()=>{const e=this.numberOfBacklinks.state,t=N.Z.state.online,n=this.hasDifferingReadPermissionsFromSource.state,{isDesktop:o}=this.environment.device;return(0,de.jsxs)("div",{style:(r=this.theme,{position:"absolute",zIndex:y.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:b.Z.getCompositeFontFamily(i.SP).sans,background:r.popoverBackground,boxShadow:r.mediumBoxShadow}),children:[t&&(0,de.jsx)(te.ZP,{popupType:te.Z4.Popup,onClick:()=>{return e=this.props.store,t=this.environment,n=this.props.referenceStore,I.Z5({environment:t,stores:[ve(e,n)]}),void S.llH(t,{from:"action_bar"});var e,t,n},originGap:4,renderOrigin:t=>(0,de.jsxs)(ee.Z,{style:be(this.theme),...t,children:[e>0?(0,de.jsx)(_.FormattedMessage,{defaultMessage:"Editing in {icon} {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}",id:"transclusionContainerBlock.editingMultiple",values:{icon:(0,u.J)({width:14,transform:"rotate(180deg)",marginLeft:4,marginRight:4}),numberOfBacklinks:e}}):(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.editingOriginal",defaultMessage:"Editing original"}),n&&(0,g.t)({width:14,fill:(0,d.fi)("orange",this.theme).fill,marginLeft:6}),(0,p.i)({width:10,fill:this.theme.mediumIconColor,marginLeft:4})]}),render:this.renderBacklinksMenu}),o&&(0,de.jsx)(ee.Z,{style:be(this.theme),onClick:this.handleCopyClick,children:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.copy",defaultMessage:"Copy and sync"})}),(0,de.jsx)(J.Z,{store:ve(this.props.store,this.props.referenceStore),fadeIn:!1,style:{width:30,height:void 0},iconStyle:{marginTop:1,fill:this.theme.regularTextColor}})]});var r},this.renderBacklinksMenu=()=>{const{store:e}=this.props,t={menuType:Z.og.Popup,width:400},n=this.hasDifferingReadPermissionsFromSource.state,o=e.getNavigableBlockStore(),i=n&&o?(0,de.jsx)(ne.Z,{underline:!0,inline:!0,href:(0,D.ZP)({store:o,fullyQualified:!1,pageVisitSource:l.tY.Breadcrumb}),style:{color:this.theme.mediumTextColor},children:(0,de.jsx)(ie.Z,{store:o,style:{display:"inline"}})}):void 0;return(0,de.jsxs)(oe.Z,{...t,children:[n&&o&&(0,de.jsx)(re.Z,{style:{background:this.theme.sidebarSecondaryBackground},children:(0,de.jsxs)("div",{style:{display:"flex",fontSize:12,padding:"6px 16px"},children:[(0,m.B)({width:16,marginTop:6,marginRight:8,color:this.theme.regularIconColor}),(0,de.jsx)("div",{children:(0,de.jsx)(_.FormattedMessage,{defaultMessage:"Viewership permissions on this page are different from the original page <page></page>. Some members might not have access.",id:"transclusionContainerBlock.differingPermissionsWarning",values:{page:()=>i}})})]})}),(0,de.jsx)(re.Z,{topBorder:n,children:(0,de.jsx)(Q.Z,{type:"transclusion_container",store:this.props.store,originalTransclusionStore:this.props.store,disableArrow:!0})}),(0,de.jsx)(he,{})]})},this.handleCopyClick=()=>{I.Z5({environment:this.environment,stores:[ve(this.props.store,this.props.referenceStore)]});const e=this.fakeSelectionTrapRef.current;e&&this.environment.device.isSafari?(L.setOnNode(e,this.environment.device),w.f4(),L.clear(this.environment)):w.f4(),S.EVQ(this.environment),x.oV({label:F.default.formatMessage(ue.copySuccessMessage),helpUrl:(0,U.UY)("guides.transclusions")})},this.handleMouseEnter=()=>{W.Z.state.isDragging||G.default.state.isActive||this.disableTransclusionUI.state||this.stores.hovered.setState(!0)},this.handleMouseLeave=()=>{W.Z.state.isDragging||G.default.state.isActive||this.disableTransclusionUI.state||this.stores.hovered.setState(!1)},this.currentState=this.createComputedStore((()=>{const e=ve(this.props.store,this.props.referenceStore);return(0,E.B)(e,this.stores.hovered.state)})),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state;return!(e!==E.x.Selected&&e!==E.x.SelectedDescendant||$.Z.state.isActive||z.ZP.state.isDragging||G.default.state.isActive||q.Z.state.isKeyboardMode)})),this.numberOfBacklinks=this.createComputedStore((()=>{const e=(0,R.L)(this.props.store,this.environment);return e.backlinks.length+e.inaccessibleBacklinkCount})),this.disableTransclusionUI=this.createComputedStore((()=>{if(P.default.isAdminMode)return!1;const{disabled:e}=this.props;if(e)return!0;const t=ve(this.props.store,this.props.referenceStore);if(!t.canEdit())return!0;const n=t.findRecordStoreUIAncestor((e=>e!==t&&e instanceof K.G&&e.getType()===c.Ti.transclusionContainer));return Boolean(n.ancestor)})),this.hasDifferingReadPermissionsFromSource=this.createComputedStore((()=>{const{store:e,referenceStore:t}=this.props;if(!t||!e.canEdit()||!t.canEdit())return!1;const n=(0,j.YO)(e).map((e=>{let{permissionItem:t}=e;return t})),o=(0,j.YO)(t).map((e=>{let{permissionItem:t}=e;return t})),i=(0,h.L2)(n,o).created.find((e=>!(0,v.FB)(e)));return Boolean(i)}))}handleCreated(){this.stores.hovered.setState(!1),I.ZH({device:this.environment.device});const{store:e}=this.props,t=e.getContentStores()[0];t&&t.getType()===c.Ti.text&&(I.eP({environment:this.environment,store:t}),C.N_({store:t.getBlockTitleStore()}))}async canRemoveBlock(){const e=this.numberOfBacklinks.state;if(0===e)return{canRemove:!0,canUndo:!0};const t=await fe({header:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.header",defaultMessage:"Delete original?"}),text:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.text",defaultMessage:"These blocks are synced in {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}. If you delete the original, the blocks will no longer be synced.",values:{numberOfBacklinks:e}}),acceptLabel:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.confirm",defaultMessage:"Delete and unsync copies"})});return{canRemove:t,canUndo:t}}async confirmUnsyncTransclusionReference(){return 0===this.numberOfBacklinks.state||fe({header:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.header",defaultMessage:"Unsync this?"}),text:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.text",defaultMessage:"The selected blocks will no longer be synced with the original."}),acceptLabel:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.confirm",defaultMessage:"Unsync"})})}async confirmUnsyncTransclusionContainer(){const e=this.numberOfBacklinks.state;return 0===e||fe({header:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.header",defaultMessage:"Unsync all?"}),text:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.text",defaultMessage:"{numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}} will no longer sync with these blocks.",values:{numberOfBacklinks:e}}),acceptLabel:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.confirm",defaultMessage:"Unsync all"})})}renderPersisted(){const{store:e}=this.props,{device:t}=this.environment,n=this.disableTransclusionUI.state,o=Boolean(this.props.referenceStore);if(e.pathIsDead()&&o)return(0,de.jsx)(ye,{store:this.props.store});if(n)return(0,de.jsx)(le.Z,{disabled:this.props.disabled,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,store:this.props.store.getContentStore()});{const n=this.currentState.state,o=n!==E.x.Default||this.stores.haloShouldBeVisible.state||this.stores.actionBarShouldBeVisible.state,i=this.showActionBar.state,r=!e.hasContent();return this.hasDifferingReadPermissionsFromSource.state,(0,de.jsxs)("div",{style:{display:"flex"},children:[(0,de.jsx)("span",{ref:this.fakeSelectionTrapRef,style:{height:"1px",width:"1px"}}),(0,de.jsxs)("div",{style:{position:o?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%"},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,onClick:r?e=>function(e,t,n){(0,B.ZP)({event:e,context:B.Af.EditorClick,callback:()=>{(0,V.uG)(e)||M.createAndCommit({userAction:"TransclusionContainerBlock.handleEmptyClick",environment:n,perform:e=>{T.ls({environment:n,store:t,transaction:e})}})}})}(e,this.props.store,this.environment):void 0,children:[(0,de.jsx)(le.Z,{disabled:!1,store:this.props.store.getContentStore(),emptyPlaceholder:(0,de.jsx)(_e,{}),disableHoverMenu:this.props.disableHoverMenu||n!==E.x.SelectedDescendant,disableDrag:t.isMobile}),(0,de.jsx)(Y.Z,{store:e},e.id),o&&this.renderHalo(n),o&&this.renderActionBar(i)]})]})}}renderHalo(e){const t=e!==E.x.Default;return(0,de.jsx)(X.Z,{isVisible:t,enterAnimationStyle:{opacity:0},animationStyle:{opacity:e===E.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:ce.z},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{t||this.stores.haloShouldBeVisible.setState(!1)},render:()=>(0,de.jsx)(Se,{})})}renderActionBar(e){return(0,de.jsx)(X.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:ce.z},onAnimationStart:()=>{this.stores.actionBarShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisible.setState(!1)},render:this.renderActionBarContent})}}const me=pe;function fe(e){const{header:t,text:n,acceptLabel:o}=e;return new Promise((e=>{k.showDialog({showCancel:!0,keepFocus:!1,message:(0,de.jsxs)("div",{children:[(0,de.jsx)("div",{style:{fontWeight:b.Z.fontWeight.semibold},children:t}),n]}),items:[{label:o,color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))}function ge(){return(0,de.jsx)(_.FormattedMessage,{defaultMessage:"Learn more about Synced blocks",id:"transclusionContainerBlock.learnMoreLabel"})}function he(){return(0,de.jsx)(re.Z,{topBorder:!0,children:(0,de.jsx)(ae.Z,{title:(0,de.jsx)(ge,{}),href:(0,U.UY)("guides.transclusions"),analyticsFrom:"transclusion_container_block"})})}function ve(e,t){return t||e}function be(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${d.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1}}function ye(e){let{store:t}=e;window.__c={n:"DeletedContainerBannerComponent"};const n=(0,a.Fg)(),o=(0,r.VK)((()=>(0,D.ZP)({store:t,fullyQualified:!1,pageVisitSource:l.tY.LinkInPage})),[t]),i=(0,r.VK)((()=>(0,D.ZP)({store:t,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:l.tY.PeekOpen})),[t]),s=(0,r.VK)((()=>H.default.isSidePeekOpen()),[]),c=(0,de.jsx)(ne.Z,{href:o,altHref:i,forceAltHref:s,external:!1,inline:!0,underline:!0,children:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.viewDeletedPage",defaultMessage:"View deleted page"})});return(0,de.jsxs)(se.gq,{style:{color:n.text.secondary,background:n.accentColors.gray[30],padding:"16px 16px 16px 12px",borderRadius:4},alignItems:"center",children:[(0,f.D)({width:24,height:24,flexShrink:0,marginRight:10,padding:2}),(0,de.jsx)("div",{style:{fontSize:14},children:(0,de.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.syncedContentPageDeleted",defaultMessage:"The page with the original synced block has been deleted. {pageLink}",values:{pageLink:c}})})]})}function _e(){window.__c={n:"EmptyEditingPlaceholderComponent"};const e=(0,a.Fg)();return(0,de.jsx)("div",{style:{caretColor:e.lightTextColor,color:e.lightTextColor,paddingTop:4,paddingBottom:4},children:(0,de.jsx)(_.FormattedMessage,{defaultMessage:"Click or drag blocks here, then paste in another page to sync content.",id:"transclusionContainerBlock.emptyEditingPlaceholder"})})}function Se(){window.__c={n:"HaloContentComponent"};const e=(0,a.Fg)();return(0,de.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${e.transclusionBorderColor}`}})}},91497:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(67294),i=n(86628),r=n(62965),a=n(9291),s=n(73819),l=n(91791),c=n(85893);function d(e,t){window.__c={n:"TransclusionReferenceBlock"};const n=(0,a.useIntl)(),r=(0,o.useRef)(null),d=(0,i.VK)((()=>e.store.getTransclusionReferenceTargetStore()),[e.store]),u=(0,i.VK)((()=>d&&d.canRead()),[d]);return(0,s.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"transclusion_reference",getNode:()=>{const e=r.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),void 0!==d&&u?(0,c.jsx)(l.Z,{store:d,disabled:e.disabled,intl:n,referenceStore:e.store,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,ref:r}):null)}const u=o.memo(o.forwardRef(d),r.Z)},40971:(e,t,n)=>{n.d(t,{h:()=>cs});var o=n(41662),i=n(67294),r=n(86628),a=n(45208),s=n(62965),l=n(9291),c=n(73819),d=n(68859),u=n(97496),p=n(85893);const m=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Abstract",id:"abstractBlock.embeds.button.label"}});function f(e,t){window.__c={n:"AbstractBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),s=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"abstract",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:s,ref:o,store:e.store,iconSvg:a.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Abstract links with public access enabled",id:"abstractBlock.embeds.caption"}),embedButtonText:n.formatMessage(m.embedButtonText),urlInputPlaceholder:"https://abstract.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Abstract",id:"abstractBlock.placeholder"})}))}const g=i.memo(i.forwardRef(f),s.Z);var h=n(13991),v=n(480),b=n(97511),y=n(24405),_=n(8848),S=n(42853),w=n(11751),k=n(82990),I=n(51454),x=n(10910),C=n(72899),T=n(43250),M=n(14976),P=n(19124),A=n(87290),R=n(33929),D=n(16402),B=n(77907),E=n(28267),F=n(16772),Z=n(55367),V=n(80796),j=n(22294),U=n(69784),L=n(49557),O=n(49085),N=n(49271),z=n(41432),W=n(76490),q=n(33676),H=n(97022),K=n(39986),G=n(10498),$=n(97880),Q=n(94419),Y=n(9953),J=n(24677),X=n(98104),ee=n(82530),te=n(81598),ne=n(95645),oe=n(12534),ie=n(68056),re=n(51214),ae=n(77794),se=n(23864),le=n(23063),ce=n(64921),de=n(73420),ue=n(55217),pe=n(79954),me=n(65187);const fe=(0,l.defineMessages)({headingPlaceholder:{id:"aiSection.heading.placeholder",defaultMessage:"Heading"},thumbsUp:{id:"aiSection.actionBar.thumbsUp",defaultMessage:"Submit positive feedback"},thumbsDown:{id:"aiSection.actionBar.thumbsDown",defaultMessage:"Submit negative feedback"}});class ge extends ne.Z{constructor(){super(...arguments),this.sizeObserver=new ae.E,this.storeTypes={isHovering:O.default.createClass(!1),haloShouldBeVisible:O.default.createClass(!1),actionBarShouldBeVisible:O.default.createClass(!1),selectedAiFeedbackType:O.default.createClass(void 0)},this.renderActionBarContent=()=>{const e=this.lastEditedTime.state;return(0,p.jsxs)("div",{style:(t=this.theme,{position:"absolute",zIndex:I.t8,top:-40,right:-2,borderRadius:4,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:k.Z.getCompositeFontFamily(h.SP).sans,background:t.popoverBackground,boxShadow:t.mediumBoxShadow}),children:[(0,p.jsxs)("span",{style:be(this.theme),children:[(0,w.t)({width:16,height:16,fill:this.theme.accentColors.purple[400]}),(0,p.jsx)(l.FormattedMessage,{id:"aiSection.generated",defaultMessage:"Updated by AI"}),e?(0,p.jsx)("span",{style:{color:this.theme.accentColors.purple[300]},children:(0,D.IS)(e,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0})}):null]}),(0,p.jsx)(ce.Z,{style:ye(this.theme),onClick:this.handleThumbUpClick,ariaLabel:R.default.formatMessage(fe.thumbsUp),children:"ai_section_thumbs_up"===this.stores.selectedAiFeedbackType.state?(0,G.w)({width:16,height:16}):(0,K.P)({width:16,height:16})}),(0,p.jsx)(ce.Z,{style:ye(this.theme),onClick:this.handleThumbDownClick,ariaLabel:R.default.formatMessage(fe.thumbsDown),children:"ai_section_thumbs_down"===this.stores.selectedAiFeedbackType.state?(0,H.E)({width:16,height:16}):(0,q.A)({width:16,height:16})})]});var t},this.handleMouseEnter=()=>{V.Z.state.isDragging||U.default.state.isActive||this.stores.isHovering.setState(!0)},this.handleMouseLeave=()=>{V.Z.state.isDragging||U.default.state.isActive||this.stores.isHovering.setState(!1)},this.handleThumbUpClick=()=>{this.submitFeedback("ai_section_thumbs_up")},this.handleThumbDownClick=()=>{this.submitFeedback("ai_section_thumbs_down")},this.submitFeedback=async e=>{var t;const n=this.props.store.getFormat().ai_inference_id,o=null===(t=this.props.store.getFormat().ai_skill)||void 0===t?void 0:t.ai_skill_type;this.stores.selectedAiFeedbackType.setState(e);const{assistantActions:i}=await te.L6.loader();n&&o&&i.saveAiSectionFeedback({environment:this.environment,inferenceId:n,feedbackType:e,skillType:o})},this.currentState=this.createComputedStore((()=>(0,A.B)(this.props.store,this.stores.isHovering.state))),this.isCompact=this.createComputedStore((()=>this.sizeObserver.rect.state.width<400)),this.lastEditedTime=this.createComputedStore((()=>this.props.store.getFormat().ai_last_edited)),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state,t=this.props.store.getFormat().ai_inference_id;return(e===A.x.Selected||e===A.x.SelectedDescendant)&&!L.Z.state.isActive&&!Z.ZP.state.isDragging&&!U.default.state.isActive&&!j.Z.state.isKeyboardMode&&Boolean(t)})),this.isHaloVisible=this.createComputedStore((()=>{if(re.Z.isGeneratingFor(this.props.store.id))return!0;const e=this.currentState.state;if(e===A.x.Default)return!1;if(e===A.x.Hovered){var t;const e=Z.ZP.state;return!!(e&&e.isDragging&&e.currentDropZone&&e.currentDropZone.type===Z.Dl.Selectable&&null!==(t=e.currentDropZone)&&void 0!==t&&t.store&&this.props.store.uiContains(e.currentDropZone.store))}return e===A.x.Selected||e===A.x.SelectedDescendant||(0,$.t1)(e)})),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,n=e.isMobile?1.17:W.C;return(0,W.Jr)({fontSizeValue:n,fontFamily:t})}}renderPersisted(){const e=this.currentState.state,t=e!==A.x.Default||this.stores.haloShouldBeVisible.state;return this.props.store.isSkillBlock()?(0,p.jsx)("div",{className:T.zov,style:{display:"flex"},children:(0,p.jsxs)("div",{style:{position:t?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[(0,p.jsxs)(de.X2,{gap:void 0,wrap:this.isCompact.state?"wrap":"initial",children:[(0,p.jsx)(me.Z,{tagName:"h4",disabled:!this.canEdit(),store:this.props.store.getBlockTitleStore(),placeholder:R.default.formatMessage(fe.headingPlaceholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...N.ZD,...this.getHeaderTextStyle(),width:void 0},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),(0,p.jsx)("div",{style:{paddingLeft:8,flexGrow:1},onClick:e=>function(e,t,n){e.stopPropagation();const o=(0,ie.TD)({store:t.getTitleStore()});o&&X.bc({environment:n,multiSelection:o,forceEmit:!1,focus:"end",readOnly:"infer"})}(e,this.props.store,this.environment),children:(0,p.jsx)(B.LazyBlockSkillButton,{blockStore:this.props.store})}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,p.jsx)("div",{onClick:e=>function(e,t,n){(0,oe.ZP)({event:e,context:oe.Af.EditorClick,callback:()=>{const e=t.getContentStore();if(!e)return;(e.getValue()||[]).length>0||ee.createAndCommit({userAction:"aiSection.handlePlaceholderClick",environment:n,perform:o=>{const i=Y.j4({environment:n,type:z.Ti.text,inMemoryRecordCache:e.inMemoryRecordCache,transaction:o,spaceId:t.getSpaceId(),useCrdt:t.useCrdt()}),r=Q.R3({parent:e,append:i,transaction:o}).child;J.eP({environment:n,store:r});const a=r.getBlockTitleStore();X.N_({store:a})}})}})}(e,this.props.store,this.environment),children:(0,p.jsx)(ue.Z,{disabled:this.props.disabled,store:this.props.store.getContentStore(),disableHoverMenu:this.props.disableHoverMenu||e!==A.x.SelectedDescendant,disableDrag:this.environment.device.isMobile,emptyPlaceholder:(0,p.jsx)(_e,{store:this.props.store})})}),this.renderHalo(),this.renderActionBar(this.showActionBar.state)]})}):(0,p.jsx)(Ce,{...this.props})}renderHalo(){const e=this.isHaloVisible.getState();return(0,p.jsx)(le.Z,{isVisible:e,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:.45,scale:1},exitAnimationStyle:{opacity:0,scale:.995},springConfig:{opacity:pe.z},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.haloShouldBeVisible.setState(!1)},render:()=>(0,p.jsx)(Se,{})})}renderActionBar(e){return(0,p.jsx)(le.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:pe.z},onAnimationStart:()=>{this.stores.actionBarShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisible.setState(!1)},render:this.renderActionBarContent})}didMount(){const e=this.getNode();e instanceof Element&&this.sizeObserver.observe(e)}willUnmount(){this.sizeObserver.destroy()}}const he=ge;function ve(e){let{store:t}=e;window.__c={n:"PlaceholderMessageComponent"};const n=(0,r.VK)((()=>t.getCurrentSkillType()),[t]);return"meeting_action_items"===n?(0,p.jsx)(l.FormattedMessage,{id:"aiSection.meetingActionItems.textPlaceholder",defaultMessage:"Add action items or fill with AI"}):"meeting_summary"===n?(0,p.jsx)(l.FormattedMessage,{id:"aiSection.meetingSummary.textPlaceholder",defaultMessage:"Add summary or fill with AI"}):(0,p.jsx)(l.FormattedMessage,{id:"aiSection.noSkill.emptyCannotDropPlaceholder",defaultMessage:"Add blocks or fill with AI"})}function be(e){return{display:"flex",alignItems:"center",gap:4,height:"100%",padding:"0 8px",borderRight:`1px solid ${_.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,color:e.accentColors.purple[500],fontWeight:500}}function ye(e){return{display:"flex",alignItems:"center",height:"100%",padding:"0 8px",color:e.accentColors.gray[500]}}function _e(e){let{store:t}=e;window.__c={n:"EmptyPlaceholderComponent"};const n=(0,y.Fg)();return(0,p.jsx)("div",{style:{marginTop:2,padding:"3px 2px",display:"inline-block",color:n.lightTextColor},children:(0,p.jsx)(ve,{store:t})})}function Se(){window.__c={n:"HaloContentComponent"};const e=(0,y.Fg)(),t="light"===e.mode?e.aiBlockBorderColor:e.aiPurpleColor;return(0,p.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:6,border:`2px solid ${t}`}})}var we=n(68709),ke=n(63296);const Ie=(0,l.defineMessages)({summarize:{id:"aiBlock.summarize",defaultMessage:"Summarize this page with AI"},findActionItems:{id:"aiBlock.findActionItems",defaultMessage:"Find action items on this page with AI"},helpMeWrite:{id:"aiBlock.helpMeWrite",defaultMessage:"Tell the AI what to writeâ€¦"},summarizeMeetingTranscript:{id:"aiBlock.summarizeMeetingTranscript",defaultMessage:"Summarize this meeting with any action items and decisions taken"}}),xe=i.forwardRef((function(e,t){window.__c={n:"AiBlock"};const{store:n,disabled:o,disableHoverMenu:a,ai:{completionActions:s,completionInitialPromptActions:d}}=e,u=(0,v.O7)(),m=(0,v.Fy)(),f=(0,c.PE)(n,o),g=(0,b.l)(),[C,B]=(0,i.useState)(!1),[O,N]=(0,i.useState)(!1),[z,W]=(0,i.useState)(!1),[q,H]=(0,i.useState)(!1),K=(0,i.useRef)(null),G=(0,y.yK)((e=>({actionBar:{position:"absolute",zIndex:I.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:k.Z.getCompositeFontFamily(h.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow},actionButton:{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${_.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1},icon:{fill:e.accentColors.purple[300],width:21,height:21,position:"relative",top:5},haloContent:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${e.aiBlockBorderColor}`}})),[]),$=(0,y.Fg)(),Q=(0,E.X)(K),Y=!Q||Q.width<400,J=(0,r.VK)((()=>!n.hasContent()),[n]),X=(0,r.VK)((()=>J?A.x.Hovered:(0,A.B)(n,O)),[J,O,n]),ee=X!==A.x.Default||z||q,te=(0,r.VK)((()=>"completionPopup"===F.default.state.type&&"results"===F.default.state.stage&&F.default.state.loading),[]),ne=(0,r.VK)((()=>{const e=(0,P.z1)(),t=e.summarize,o=n.getFormat().ai_prompt_key;if(!o)return t;const i=e[o];return i||t}),[n]),oe=(0,r.VK)((()=>n.getBlockTitleStore().getValue()),[n]),ie=(0,r.VK)((()=>{const e=oe;if(e)return{prompt:(0,M.Xh)(e,n)}}),[oe,n]),re=(0,r.VK)((()=>n.getFormat().ai_last_edited),[n]),ae=(0,r.VK)((()=>{const e=g&&g.publicEditModeStore.state;return!(0,P.GD)(e)||(!!C||(!(n.canEdit()&&!n.isLocked())||"helpMeWrite"===ne.key&&(null==ie||!ie.prompt)))}),[C,n,ne.key,null==ie?void 0:ie.prompt,g]),se=(0,r.VK)((()=>!(X!==A.x.Selected&&X!==A.x.SelectedDescendant||L.Z.state.isActive||Z.ZP.state.isDragging||U.default.state.isActive||j.Z.state.isKeyboardMode)),[X]),fe=(0,r.VK)((()=>n.isSkillBlock()),[n]),ge=(0,i.useCallback)((()=>{V.Z.state.isDragging||U.default.state.isActive||N(!0)}),[]),ve=(0,i.useCallback)((()=>{V.Z.state.isDragging||U.default.state.isActive||N(!1)}),[]),be=(0,i.useCallback)((()=>{x.RL(u,{type:"generate",prompt_key:ne.key}),B(!0),s.triggerCompletionForAiBlock({environment:u,store:n,prompt:ne,additionalContext:ie}).then((()=>{B(!1)}))}),[s,u,n,ne,ie]),ye=(0,i.useCallback)((()=>{x.RL(u,{type:"edit_prompt"}),d.showInitialPromptForAIBlock({environment:u,store:n,originRef:K,prompt:null==ie?void 0:ie.prompt,clientPrompt:ne})}),[d,u,n,ne,null==ie?void 0:ie.prompt]),_e=(0,i.useCallback)((()=>{d.showInitialPromptForAIBlock({environment:u,store:n,originRef:K,prompt:null==ie?void 0:ie.prompt,clientPrompt:ne})}),[d,u,n,ne,null==ie?void 0:ie.prompt]),Se=()=>(0,p.jsx)("div",{style:G.haloContent}),xe=()=>{const e=X!==A.x.Default;return(0,p.jsx)(le.Z,{isVisible:e,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:X===A.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0,scale:.995},springConfig:{opacity:pe.z},onAnimationStart:()=>{W(!0)},onAnimationEnd:()=>{e||W(!1)},render:Se})},Ce=()=>(0,p.jsxs)("div",{style:G.actionBar,children:[(0,p.jsxs)(ce.Z,{style:{...G.actionButton,display:"flex",gap:4},onClick:ye,disabled:ae,children:[(0,w.t)({width:16,height:16,fill:$.accentColors.purple[400]}),(0,p.jsx)("span",{style:{color:$.accentColors.purple[500],fontWeight:500},children:(0,p.jsx)(l.FormattedMessage,{id:"aiBlock.generated",defaultMessage:"Generated by AI"})}),re?(0,p.jsx)("span",{style:{color:$.accentColors.purple[300]},children:(0,D.IS)(re,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0})}):null,ae?null:(0,S.i)({width:10,marginLeft:4,fill:$.lightIconColor})]}),(0,p.jsx)(ce.Z,{onClick:be,disabled:ae,style:{...G.actionButton,opacity:ae?.5:1,cursor:ae?"not-allowed":"pointer"},children:C?(0,p.jsx)(l.FormattedMessage,{id:"aiBlockBlock.update.loading",defaultMessage:"Updatingâ€¦"}):(0,p.jsx)(l.FormattedMessage,{id:"aiBlockBlock.update",defaultMessage:"Update"})})]}),Te=fe?(0,p.jsx)(he,{...e,ref:e=>{const t=null==e?void 0:e.getNode();t instanceof HTMLDivElement?K.current=t:K.current=null}}):(0,p.jsx)("div",{className:T.zov,style:{display:"flex"},ref:K,children:(0,p.jsx)("div",{style:{position:ee?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:ve,onMouseEnter:ge,children:J?(0,p.jsxs)(we.p,{allowSelectionWithin:!0,children:[(0,p.jsxs)(de.X2,{justifyContent:"space-between",padding:8,gap:8,wrap:Y?"wrap":"initial",children:[(0,p.jsxs)(de.X2,{gap:12,alignItems:"baseline",grow:1,children:[(null===(Me=ne.svg)||void 0===Me?void 0:Me.call(ne,G.icon))??(0,w.t)(G.icon),"helpMeWrite"===ne.key?(0,p.jsx)(me.Z,{onFocus:_e,disabled:!f,store:n.getBlockTitleStore(),placeholder:R.default.formatMessage(Ie.helpMeWrite),pasteBehavior:"block",style:{flexGrow:1,flexBasis:0},onEnter:be}):"helpMeWrite"===ne.key?(null==ie?void 0:ie.prompt)||R.default.formatMessage(Ie.helpMeWrite):Ie[ne.key]?R.default.formatMessage(Ie[ne.key]):void 0]}),(0,p.jsx)(ke.Z,{disabled:ae,onClick:be,style:{fontWeight:500,color:$.accentColors.purple[500],opacity:ae?.5:1,cursor:ae?"not-allowed":"pointer"},children:C?(0,p.jsx)(l.FormattedMessage,{id:"aiBlock.generate.loading.label",defaultMessage:"Generatingâ€¦"}):(0,p.jsx)(l.FormattedMessage,{id:"aiBlock.generate.label",defaultMessage:"Generate"})})]}),xe()]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(ue.Z,{disabled:o,store:n.getContentStore(),disableHoverMenu:a||X!==A.x.SelectedDescendant,disableDrag:m.isMobile}),ee&&xe(),!te&&ee&&(0,p.jsx)(le.Z,{isVisible:se,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:pe.z},onAnimationStart:()=>{H(!0)},onAnimationEnd:()=>{se||H(!1)},render:Ce})]})})});var Me;return(0,c.ez)(n,t,(0,i.useMemo)((()=>({renderedType:"ai_block",getBlockStore:()=>n,getNode:()=>K.current})),[n]),Te)}));const Ce=i.memo(i.forwardRef((function(e,t){const{value:n}=(0,B.useDependency)(C.E0);return n?(0,p.jsx)(xe,{...e,ai:n,ref:t}):null})),s.Z);var Te=n(1292),Me=n(12436);const Pe=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed audio",id:"audioBlock.embedAudio.button.label"}});function Ae(e,t){window.__c={n:"AudioBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"audio",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Me.l,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with .MP3s, .WAVs, and .OGGs",id:"audioBlock.embed.caption"}),embedButtonText:n.formatMessage(Pe.embedButtonText),urlInputPlaceholder:"https://â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Add an audio file",id:"audioBlock.placeholder"})}))}const Re=i.memo(i.forwardRef(Ae),s.Z);var De=n(73935),Be=n(53150),Ee=n(83096),Fe=n(30845),Ze=n(23210),Ve=n(70203),je=n(64002),Ue=n(63143),Le=n(57549),Oe=n(48948),Ne=n(47307),ze=n(27153),We=n(12714),qe=n(28651),He=n(61766),Ke=n(13966),Ge=n(91893),$e=n(12981),Qe=n(84076),Ye=n(68785),Je=n(81865),Xe=n(64369),et=n(86329),tt=n(35021);const nt={width:16,height:16,minWidth:16,marginRight:6},ot={flexGrow:4,flexShrink:1,flexBasis:180,padding:14,paddingTop:12,overflow:"hidden",textAlign:"left"},it=2*Ue.hM,rt=(0,l.defineMessages)({linkPlaceholder:{defaultMessage:"Paste in https://â€¦",id:"bookmarkBlock.editBookmark.linkPlaceholder"},bookmarkTitle:{defaultMessage:"Bookmark",id:"bookmarkBlock.bookmark.title"},errorMessage:{defaultMessage:"Please enter a valid link",id:"bookmarkBlock.invalidLinkError.message"}});class at extends ne.Z{constructor(){super(...arguments),this.captionAriaId=(0,Be.Z)(),this.caption=()=>{const e=this.props.store.getPropertyStore("caption");J.eP({environment:this.environment,store:this.props.store}),X.NX({store:e})},this.storeTypes={stringInputButtonPopupStore:He.Z,mouseStore:qe.Z},this.handleEmbedConfirm=e=>this.embed(e),this.handleOpenMenu=()=>{if(this.canEdit()){const e=De.findDOMNode(this);if(!e)return;if(!(e instanceof Element))return;const t=e.getBoundingClientRect();ze.$(this.environment,{originRect:t,originGap:0,isSmallWidth:!0,showArrow:!0,title:R.default.formatMessage(rt.bookmarkTitle),currentTab:"embed",tabs:[{type:"embed",caption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Create a visual bookmark from a link.",id:"bookmarkBlock.visualBookmark.prompt"}),buttonText:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Create bookmark",id:"bookmarkBlock.visualBookmark.create"}),inputPlaceholder:R.default.formatMessage(rt.linkPlaceholder),onChange:e=>{const t=Ze.D(e);Fe.B(t,"url")?(ze.Z(),this.handleEmbedConfirm(t)):Ne.showErrorMessage(R.default.formatMessage(rt.errorMessage))}}]})}},this.handleMouseMove=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),this.handleMouseLeave=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}handleCreated(){this.edit()}edit(){this.handleOpenMenu()}embed(e){return Le.bO(this.environment,{pastedText:e,source:"bookmark_block_menu"}),Oe.K({environment:this.environment,store:this.props.store,url:e})}activate(){const e=this.props.store.getProperties(),t=Ve.QaF(e&&e.link||[]);t&&We.D({environment:this.environment,url:t})}didMount(){const e=this.props.store.getFormat().bookmark_loading_ttl;if(e){const t=e-Date.now()-it;t>0&&setTimeout(this.enqueueForceUpdate,t+1e3)}}renderPersisted(){const e=this.props.store.getProperties();return e&&e.link?this.renderContent():this.renderPlaceholder()}renderContent(){const{store:e}=this.props,t=e.getProperties(),n=Ve.Jcv(t&&t.link);let o=Ve.Jcv(t&&t.title);if(n===o||!o){const e=je.Qc(n);e.hostname&&(o=e.hostname)}const i=Ve.Jcv(t&&t.description),r=e.getFormat(),a=r.bookmark_cover,s=r.bookmark_icon,c=r.bookmark_loading_ttl,d=c&&c>Date.now()-it;return(0,p.jsxs)(we.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,children:[(0,p.jsxs)("div",{style:{display:"flex"},children:[(0,p.jsx)(tt.Z,{permissionRecord:e.pointer,url:n,render:(e,t)=>(0,p.jsxs)(Qe.Z,{href:t,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getContentStyle(),onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[(0,p.jsxs)("div",{style:ot,children:[d?(0,p.jsxs)(Xe.Z,{style:{minHeight:24,marginBottom:2,display:"inline-flex",alignItems:"center",color:this.theme.mediumTextColor},children:[(0,p.jsx)(Ye.Z,{style:{marginRight:8}})," ",(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Fetching preview",id:"bookmarkBlock.loadWhileFetching.message"})]}):(0,p.jsx)(Xe.Z,{style:{minHeight:24,marginBottom:2},children:o}),i&&(0,p.jsx)(Xe.Z,{isSmall:!0,isMultiline:!0,style:{height:32,overflow:"hidden"},children:i}),(0,p.jsxs)("div",{style:{display:"flex",marginTop:6},children:[s&&s.length>0&&(0,p.jsx)(Je.Z,{url:s,isAuthenticated:!0,permissionRecord:this.props.store.pointer,render:(e,t)=>t&&(0,p.jsx)("img",{src:t,style:nt})}),(0,p.jsx)(Xe.Z,{style:{color:this.theme.regularTextColor},isSmall:!0,children:n})]})]}),a&&(0,p.jsx)(lt,{store:this.props.store,imageURL:a}),this.shouldShowActionButton()&&this.canEdit()&&(0,p.jsx)(Ke.Z,{store:this.props.store,style:{position:"absolute",top:4,right:4,background:(0,u.M1)(this.environment)},iconStyle:{fill:_.ZP.white},fadeIn:!0})]})}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,p.jsx)(Ge.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderPlaceholder(){const{disabled:e}=this.props;return(0,p.jsxs)(we.p,{allowSelectionWithin:!1,onMouseEnter:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{display:"flex"},children:[(0,p.jsx)(et.Z,{iconSvg:Ee.Q,disabled:e,shouldHideRight:!this.shouldShowActionButton(),right:this.canEdit()&&(0,p.jsx)(Ke.Z,{store:this.props.store,fadeIn:!1}),onClick:this.handleOpenMenu,isLoading:!1,progressPercent:0,children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Add a web bookmark",id:"bookmarkBlock.addWebBookmark.placeholder"})}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}shouldShowActionButton(){const{device:e}=this.environment;return e.isMobile||this.stores.mouseStore.state.mouseEntered}getContentStyle(){return{display:"flex",flexWrap:"wrap-reverse",alignItems:"stretch",textAlign:"left",overflow:"hidden",border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4,position:"relative",...this.getBlockColorStyle()}}}const st=at;function lt(e){let{imageURL:t,store:n}=e;const o={display:"block",width:"100%",height:"100%",objectFit:"cover"};return(0,p.jsx)("div",{style:{flexGrow:1,flexShrink:1,flexBasis:180,display:"block",position:"relative"},children:(0,p.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:(0,p.jsx)(Je.Z,{url:t,isAuthenticated:!0,permissionRecord:n.pointer,width:250,render:(e,t)=>t&&(0,p.jsx)($e.Z,{style:o,src:t})})})})}var ct=n(3043);function dt(e,t){window.__c={n:"BreadcrumbBlock"};const n=(0,i.useRef)(null),o=(0,v.Fy)(),a=(0,c.PE)(e.store,e.disabled),s=(0,r.VK)((()=>e.store.getNavigableBlockStore()),[e.store]),l=s?(0,p.jsxs)(we.p,{allowSelectionWithin:!0,style:{display:"flex",paddingTop:N.ZD.paddingTop,paddingBottom:N.ZD.paddingBottom},ref:n,children:[(0,p.jsx)(ct.l2,{showCurrentPageControls:!1,ancestorMaxWidth:200,currentPageMaxWidth:300,store:s,maxAncestorCount:3,isMobile:o.isMobile,style:{flexGrow:1,minWidth:0,fontSize:"inherit"}}),o.isMobile&&a&&(0,p.jsx)(Ke.Z,{store:e.store,fadeIn:!0,style:{marginTop:2,marginRight:4}}),(0,p.jsx)(se.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}):null;return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"breadcrumb",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),l)}const ut=i.memo(i.forwardRef(dt),s.Z);var pt=n(7825),mt=n(27755),ft=n(38376),gt=n(6740),ht=n(17397),vt=n(99036),bt=n(80951),yt=n(19233),_t=n(23867),St=n(83960),wt=n(75553),kt=n(893),It=n(62385);function xt(e){window.__c={n:"CodeBlockActionButtons"};const t=(0,v.O7)(),n=(0,v.Fy)(),o=(0,y.Fg)(),r=(0,c.PE)(e.store,e.disabled),a=(0,i.useCallback)((()=>{const n=Ve.Jcv(e.store.getBlockTitleStore().getValue());kt.RD({environment:t,stringValue:n,copiedMessage:kt.tq.copiedCodeToClipboard})}),[t,e.store]),s={height:25,background:o.codeBlockButtonBackground,color:o.regularTextColor,fontWeight:k.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,p.jsxs)("div",{style:{color:o.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,marginTop:4,marginRight:4},children:[!n.isMobile&&(0,p.jsxs)(It.Z,{onClick:a,style:{...s,borderTopRightRadius:0,borderBottomRightRadius:0},children:[(0,wt.U)({height:16,width:16,paddingRight:4}),(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]}),!n.isMobile&&r&&(0,p.jsx)(It.Z,{onClick:e.handleEditCaption,style:{...s,marginLeft:1,marginRight:1,borderRadius:0},children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Caption",id:"codeBlock.caption.button"})}),r&&(0,p.jsx)(Ke.Z,{style:{height:25,background:o.codeBlockButtonBackground,borderTopLeftRadius:n.isMobile?3:0,borderBottomLeftRadius:n.isMobile?3:0,paddingLeft:8,paddingRight:8},store:e.store,fadeIn:!1})]})}var Ct=n(3124),Tt=n(5049),Mt=n(87784),Pt=n(42274),At=n(72495),Rt=n(62967);const Dt=(0,l.defineMessages)({showCodePreviewSection:{id:"action.codePreviewSection.name",defaultMessage:"Show in block"}}),Bt=(0,Rt.cN)({key:"show code",displayName:Rt.RE.showOnlyCodeFormat,analyticsName:Rt.RE.showOnlyCodeFormat.defaultMessage,svg:Ct._,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;Pt.pZ({environment:n,blocks:t,previewFormat:"code"})}}),Et=(0,Rt.cN)({key:"show preview on code block",displayName:Rt.RE.showCodePreviewFormat,analyticsName:Rt.RE.showCodePreviewFormat.defaultMessage,svg:Tt.s,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;Pt.pZ({environment:n,blocks:t,previewFormat:"preview"})}}),Ft=(0,Rt.cN)({key:"show code and preview",displayName:Rt.RE.showSplitViewFormat,analyticsName:Rt.RE.showSplitViewFormat.defaultMessage,svg:Mt.s,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;Pt.pZ({environment:n,blocks:t,previewFormat:"split_view"})}}),Zt=[{key:"code preview actions block",render:e=>(0,p.jsx)(At.Z,{isTitleUppercase:!1,...e}),title:R.default.formatMessage(Dt.showCodePreviewSection),actions:[Bt,Et,Ft]}];var Vt=n(87279),jt=n(31194),Ut=n(95477),Lt=n(77080),Ot=n(7406),Nt=n(66673),zt=n(4615);const Wt="\n---\n";var qt=n(42402),Ht=n(29551);function Kt(e){window.__c={n:"MermaidDOMRenderer"};const{mermaidAPI:t,source:n}=e,o=(0,i.useRef)(null),r=(0,i.useRef)(`mermaid-${(0,zt.ZP)()}`),[a,s]=(0,i.useState)(),l=(0,y.yK)((e=>({diagram:(0,Ht.xk)({alignContent:"center",justifyContent:"center"})})),[]),c=function(e){switch(e){case"dark":return"dark";case"light":return"neutral";default:(0,$.t1)(e)}}((0,y.Fg)().mode),d=(0,i.useMemo)((()=>function(e){const{source:t,theme:n}=e,o=`%%{init: {'theme':'${n}'}}%%\n`;return t.startsWith("---\n")&&t.includes(Wt)?t.replace(Wt,`\n---\n${o}`):`${o}${t}`}({source:n,theme:c})),[n,c]);return(0,i.useLayoutEffect)((()=>{if(!t)return;let e=!1;try{t.render(r.current,d).then((t=>{const n=t.svg,i=t.bindFunctions;if(e)return;if(!o.current)return;o.current.innerHTML=n;const r=o.current.firstChild;r&&r instanceof SVGSVGElement&&r.removeAttribute("height");try{i&&i(o.current),s(void 0)}catch(a){s((0,Ot.tg)(a))}}),(e=>{s((0,Ot.tg)(e))}))}catch(n){s((0,Ot.tg)(n))}return()=>{e=!0}}),[d,t]),(0,p.jsxs)(p.Fragment,{children:[a&&(0,p.jsx)(Gt,{error:a}),(0,p.jsx)("div",{style:l.diagram,ref:o})]})}function Gt(e){window.__c={n:"MermaidError"};const{error:t}=e,n=(0,y.yK)((e=>({label:{color:e.errorText,marginBottom:4,whiteSpace:"pre-wrap"}})),[]);return"str"in t?(0,p.jsx)("div",{children:(0,p.jsxs)(Xe.Z,{isMultiline:!0,style:n.label,children:[t.str,(0,p.jsx)("div",{children:(0,p.jsx)(qt.Z,{external:!0,href:"https://mermaid-js.github.io/mermaid/#/examples",children:(0,p.jsx)(l.FormattedMessage,{id:"mermaidRenderer.error.seeMermaidExamples",defaultMessage:"See Mermaid examples"})})})]})}):(0,p.jsx)(Xe.Z,{isMultiline:!0,style:n.label,children:(0,p.jsx)(l.FormattedMessage,{id:"mermaidRenderer.error.unknownError",defaultMessage:"Syntax error in Mermaid diagram: {error}",values:{error:`${t.name}: ${t.message}`}})})}function $t(e){window.__c={n:"CodeBlockCustomCodePreview"};const t=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),n="code"===e.currentCodePreviewFormat,o=(0,i.useMemo)((()=>Yt(e.currentLanguage)),[e.currentLanguage]),a=(0,r.VK)((()=>t.getValue()),[t]);if(n||!a||!o)return null;const s=o.component;return(0,p.jsx)("div",{style:Xt(e.currentCodePreviewFormat),children:(0,p.jsx)(s,{source:M.Xh(a,t)})})}const Qt={Mermaid:{component:function(e){window.__c={n:"MermaidRenderer"};const{source:t}=e,n=(0,Nt.Kt)(t,300,Object.is),o=(0,B.useDependency)(B.deps.mermaidAPI);return(0,p.jsx)("div",{children:o.error?(0,p.jsx)(Gt,{error:o.error}):(0,p.jsx)(Kt,{mermaidAPI:o.value,source:n})})},gate:()=>"on"===Lt.default.getGroup("mermaid")}};function Yt(e){const t=Qt[e];if(t&&t.gate())return t}function Jt(e){return Boolean(Yt(e))}function Xt(e){switch(e){case"split_view":return{padding:16,flexGrow:1,flexShrink:0};case"preview":return{padding:16,paddingTop:40,alignSelf:"center",flexGrow:1,flexShrink:0};case"code":return{};default:(0,$.t1)(e)}}var en=n(48019),tn=n(31945),nn=n(78140);function on(e){window.__c={n:"CodeBlockCodePreviewSelector"};const t=(0,v.O7)(),n=(0,v.Fy)(),o=(0,y.Fg)(),a=(0,c.PE)(e.store,e.disabled),s=(0,r.qz)(void 0,He.Z),l=(0,i.useCallback)((o=>{const i=(0,p.jsx)(en.Z,{context:{blocks:[e.store],environment:t,publicEditMode:void 0},sections:Zt,initialFocus:["code","preview","split_view"].findIndex((t=>t===e.currentCodePreviewFormat)),onAccept:o.close});let r;return r=n.isMobile?{menuType:Vt.og.ActionSheet}:{menuType:Vt.og.Popup,width:167,maxHeight:"50vh"},(0,p.jsx)(nn.Z,{...r,children:i})}),[n.isMobile,t,e.currentCodePreviewFormat,e.store]);return Jt(e.currentLanguage)?(0,p.jsx)(tn.ZP,{popupType:n.isMobile?tn.Z4.SlideUp:tn.Z4.Popup,renderOrigin:t=>(0,p.jsxs)(It.Z,{disabled:!a,style:{marginRight:5},...t,children:[rn(e.currentCodePreviewFormat),a&&(0,S.i)({width:10,marginLeft:4,fill:o.lightIconColor})]}),buttonPopupStore:s,placementToOrigin:jt.Iw.Bottom,render:l}):null}function rn(e){let t;switch(e){case"split_view":t=Rt.RE.showSplitViewFormat;break;case"preview":t=Rt.RE.showCodePreviewFormat;break;case"code":t=Rt.RE.showOnlyCodeFormat;break;default:(0,$.t1)(e)}return(0,p.jsx)(l.FormattedMessage,{...t})}var an=n(15157),sn=n(52275),ln=n(68894);function cn(e){window.__c={n:"CodeBlockLanguageSelector"};const t=(0,l.useIntl)(),n=(0,v.O7)(),o=(0,v.Fy)(),a=(0,y.Fg)(),s=(0,c.PE)(e.store,e.disabled),[d,u]=(0,i.useState)(""),m=(0,r.qz)(void 0,He.Z),f=(0,i.useCallback)((e=>{u(e.target.value)}),[]),g=(0,i.useCallback)((()=>{u("")}),[]),h=(0,i.useCallback)((t=>{ee.createAndCommit({userAction:"CodeBlock.setPersistedLanguage",environment:n,perform:n=>{Pt.E5({blocks:[e.store],language:t,transaction:n})}}),an.Z.set({userId:n.currentUser.id,key:St.T.localLanguagePreferenceKey,value:t})}),[n,e.store]),b=(0,i.useCallback)((i=>{const r=ht.X0.filter((e=>"Java/C/C++/C#"!==e)),a=[{key:0,render:e=>(0,p.jsx)(At.Z,{...e}),actions:r.map((e=>({key:e,displayName:e,analyticsName:e,searchName:e,render:t=>(0,p.jsx)(sn.Z,{title:e,...t}),action:()=>{h(e),i.close()},closeParentMenu:!0})))}],s=(0,p.jsx)(en.Z,{filter:d,context:{blocks:[],environment:n,publicEditMode:void 0},sections:a,initialFocus:d?0:r.findIndex((t=>t===e.currentLanguage))}),c=(0,p.jsx)(At.Z,{isInput:!0,children:(0,p.jsx)(ln.ZP,{value:d,onChange:f,focus:!o.isMobile||void 0,placeholder:t.formatMessage(Rt.RE.searchPlaceholder),focusAfterAnimation:!0})});let u;return u=o.isMobile?{menuType:Vt.og.Modal,title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Language",id:"codeBlock.mobileLanguageMenu.title"}),right:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Done",id:"codeBlock.mobileLanguageMenu.doneButton.label"}),onClickRight:i.close,header:c}:{menuType:Vt.og.Popup,width:240,maxHeight:"50vh",header:c},(0,p.jsx)(nn.Z,{...u,children:s})}),[e.currentLanguage,o.isMobile,n,f,t,d,h]);return(0,p.jsx)(tn.ZP,{popupType:o.isMobile?tn.Z4.SlideUp:tn.Z4.Popup,renderOrigin:t=>(0,p.jsxs)(It.Z,{disabled:!s,style:{marginRight:5},...t,children:[e.currentLanguage,s&&(0,S.i)({width:10,marginLeft:4,fill:a.lightIconColor})]}),buttonPopupStore:m,placementToOrigin:jt.Iw.Bottom,render:b,onClose:g})}var dn=n(28385);const un="opacity 300ms ease-in";class pn extends ne.Z{constructor(){super(...arguments),this.captionAriaId=(0,Be.Z)(),this.storeTypes={focusStore:O.default.createClass(!1),mouseStore:qe.Z},this.caption=()=>{hn(this.props.store,this.environment)},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,gt.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)}}renderPersisted(){const{store:e,disabled:t}=this.props,n=function(e){const t=function(e){const t=e.getProperties()||{};return bt.Sj(t.language,vt.fG)}(e);if(t&&(0,ht.L9)(t))return t;return St.T.defaultLanguage}(this.props.store),o=yt.W[n],i=function(e,t){return Jt(e)?t.getFormat().code_preview_format??"split_view":St.T.defaultCodePreviewFormat}(n,this.props.store),r=e.getFormat().code_wrap;return(0,p.jsxs)("div",{style:{display:"flex"},children:[(0,p.jsxs)(we.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,style:(a=this.theme,s=this.props.style,{flexGrow:1,borderRadius:4,textAlign:"left",position:"relative",background:a.codeBlockBackground,minWidth:0,width:"100%",...s}),onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},children:[(0,p.jsxs)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,style:this.getLanguageSelectorStyle(),children:[(0,p.jsx)(cn,{disabled:this.props.disabled,store:this.props.store,currentLanguage:n}),(0,p.jsx)(on,{disabled:this.props.disabled,store:this.props.store,currentLanguage:n,currentCodePreviewFormat:i})]}),(0,p.jsx)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,style:this.getHeaderStyle(),children:(0,p.jsx)(xt,{store:this.props.store,disabled:this.props.disabled,handleEditCaption:()=>hn(this.props.store,this.environment)})}),(0,p.jsxs)("div",{children:[fn(n,i)&&(0,p.jsx)(dn.Z,{store:e.getBlockTitleStore(),blockStore:e,language:o,disabled:t,codeWrap:Boolean(r),isQuickFind:Boolean(this.props.isQuickFind),parentSpaceId:(0,_t.C)(e.pointer.spaceId)}),(0,p.jsx)($t,{store:e,disabled:t,currentCodePreviewFormat:i,currentLanguage:n})]}),(0,p.jsx)("div",{style:gn(this.theme),children:(0,p.jsx)(Ge.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})})]}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store}),"â€‹"]});var a,s}getHeaderStyle(){const{mouseEntered:e}=this.stores.mouseStore.state,t=this.stores.focusStore.state,{isMobile:n}=this.environment.device,o=j.Z.state.isKeyboardMode,i=n||t||!o&&e;return{position:"absolute",top:3,right:1,zIndex:1,color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",height:25,fontSize:11.5,opacity:i?1:0,transition:un}}getLanguageSelectorStyle(){const{mouseEntered:e}=this.stores.mouseStore.state,t=this.stores.focusStore.state,{isMobile:n}=this.environment.device,o=e||t||n;return{position:"absolute",top:8,left:8,zIndex:1,color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",opacity:o?1:0,transition:un}}}const mn=pn;function fn(e,t){return!Jt(e)||"preview"!==t}function gn(e){return{background:e.contentBackground,paddingRight:105}}function hn(e,t){const n=e.getPropertyStore("caption");J.eP({environment:t,store:e}),X.NX({store:n})}var vn=n(43661);function bn(e,t){window.__c={n:"CodepenBlock"};const n=(0,i.useRef)(null),o=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"codepen",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:vn.O,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with any public CodePen linkâ€¦",id:"codepenBlock.embed.caption"}),children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed CodePen",id:"codepenBlock.placeholder"})}))}const yn=i.memo(i.forwardRef(bn),s.Z);var _n=n(53223),Sn=n(27627),wn=n(1302),kn=n(72126),In=n(13084),xn=n(52989),Cn=n(78175),Tn=n(39500),Mn=n(50628),Pn=n(96049);const An=46,Rn=4;function Dn(e){window.__c={n:"ColumnDivider"};const t=(0,r.qz)(e.mouseStore,qe.Z),{showHandle:n,onMouseDown:o,onTouchStart:a,onContextMenu:s,onDoubleClick:l}=e,c=(0,v.O7)(),d=(0,r.VK)((()=>n&&(t.state.mouseEntered||c.device.isMobile&&Pn.Z.state)),[n,t,c.device]),u=(0,i.useCallback)((()=>{t.setState({...t.state,mouseEntered:!1}),Pn.Z.removeListener(u)}),[t]),m=(0,i.useCallback)((()=>{Pn.Z.removeListener(u),Pn.Z.state||t.setState({...t.state,mouseEntered:!0})}),[u,t]),f=(0,i.useCallback)((()=>{Pn.Z.state?Pn.Z.addListener(u):t.setState({...t.state,mouseEntered:!1})}),[u,t]),g=(0,y.yK)((e=>{const t={position:"relative",width:An,flexGrow:0,flexShrink:0,transition:"opacity 200ms ease-out",opacity:0};return{base:t,hovered:{...t,opacity:1,cursor:"col-resize"},handle:{position:"absolute",top:0,bottom:0,left:An/2-Rn/2,width:Rn,height:"100%",background:e.darkDividerColor}}}),[]),h=d?g.hovered:g.base;return(0,p.jsx)("div",{style:h,onDoubleClick:l,onMouseDown:o,onTouchStart:a,onContextMenu:s,onMouseEnter:m,onMouseLeave:f,children:n&&(0,p.jsx)("div",{style:g.handle})})}const Bn=i.memo(Dn);class En extends ne.Z{constructor(){super(...arguments),this.handleMouseDown=e=>{(0,Cn.zE)(this.props.store,this.environment)&&(0,oe.ZP)({event:e,context:oe.Af.EditorMouseDown,callback:()=>{this.capturedMouseDown=!0,e.preventDefault(),xn.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}})},this.handleMouseUp=e=>{if(this.capturedMouseDown&&!Tn.uG(e)){const{clientX:t,clientY:n,target:o}=e;wn.default.afterNextFlush((()=>{X.J9(this.environment,{x:t,y:n,target:o instanceof Element?o:void 0}),this.capturedMouseDown=!1}))}}}renderComponent(){const{ratio:e,store:t,isLastItem:n,disabled:o}=this.props,i=1===t.getContentLength(),r=this.canEdit();return(0,p.jsx)(le.Z,{isVisible:!0,animationStyle:Vn({ratio:e},this.props.numColumns,this.props.store,this.environment),render:()=>(0,p.jsx)("div",{style:Zn(this.props.store,this.environment),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:e=>function(e,t,n){if(Mn.Z.hasBeenUpdatedSince(e.timeStamp))return;if(t.canEdit()){const{clientX:o,clientY:i,target:r}=e;wn.default.afterNextFlush((()=>{ee.createAndCommit({userAction:"Column.handleClick",environment:n,perform:e=>{X.LG(n,{x:o,y:i,target:r instanceof Element?r:void 0},t,e)}})}))}}(e,this.props.store,this.environment),children:(0,p.jsx)(pe.Z,{store:t,canDropLeft:r&&(0,Cn.zE)(this.props.store,this.environment),canDropRight:n&&r&&(0,Cn.zE)(this.props.store,this.environment),onSelectableDrop:e=>function(e,t,n,o){const{droppedDirection:i,droppedStores:r,duplicate:a}=e;ee.createAndCommit({userAction:"Column.handleDrop",environment:o,perform:e=>{In.LQ({environment:o,droppedDirection:i,droppedStores:r,targetParentStore:t.getContentStore(),targetStore:n,duplicate:a,transaction:e})}})}(e,this.props.columnListStore,this.props.store,this.environment),analyticsName:"column",style:{display:"flex",flexDirection:"column"},shouldShowDropZone:!0,isListContainer:!0,children:(0,p.jsx)(ue.Z,{store:t.getContentStore(),disabled:o,disableLayout:i,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})})})}}const Fn=En;function Zn(e,t){const n={paddingTop:12,paddingBottom:12};return(0,Cn.zE)(e,t)&&kn.f0(n,{flexGrow:0,flexShrink:0}),n}function Vn(e,t,n,o){let{ratio:i}=e;const r={width:"100%"};return t>1&&(r.width=`calc((100% - ${An*(t-1)}px) * ${i})`),(0,Cn.zE)(n,o)||(r.width="100%"),r}n(57658);var jn=n(45697),Un=n.n(jn),Ln=n(83355),On=n(96802);class Nn extends O.default{getInitialState(){return{dragging:!1}}}const zn=Nn;var Wn=n(23883),qn=n(70518),Hn=n(12137),Kn=n(58202),Gn=n(50906);const $n=function(e){const{columnListStore:t}=e;t.setState({dragging:!1})},Qn=function(e){const{columnListBlockStore:t,diffX:n,columnListStore:o,leftColumn:i,rightColumn:r}=e;if(o.state.dragging){const{leftColumnStartWidth:e}=o.state,a=(0,Hn.Z)(o.state.leftColumnStartRatio,0,1),{rightColumnStartWidth:s}=o.state,l=(0,Hn.Z)(o.state.rightColumnStartRatio,0,1),c=e+s,d=a+l,u=(0,Hn.Z)(e+n,0,c),p=(0,Hn.Z)(s-n,0,c),m=d*(u/c),f=d*(p/c);if(0===u&&0===p)return o.setState({...o.state,temporaryRatios:{}}),{leftColumnNewRatio:a,rightColumnNewRatio:l};{const e=1/(8*t.getContentLength());let n=Math.round(m/e)*e,s=f+(m-n);return n<e&&(n=e,s=a+l-e),s<e&&(s=e,n=l+a-e),o.setState({...o.state,temporaryRatios:{[i.id]:n,[r.id]:s}}),{leftColumnNewRatio:n,rightColumnNewRatio:s}}}};var Yn=n(6685);function Jn(e){window.__c={n:"ColumnDraggableDivider"};const t=(0,r.qz)(e.mouseStore,qe.Z),{canDrag:n,columnList:o,leftColumn:a,rightColumn:s,columnListStore:l}=e,c=(0,v.O7)(),d=(0,i.useCallback)((e=>{n&&(e.preventDefault(),function(e){const{environment:t,columnListStore:n,leftColumn:o,rightColumn:i}=e,r=Kn.R.getRect(o),a=Kn.R.getRect(i);r&&a&&(n.setState({dragging:!0,temporaryRatios:{},leftColumnStartWidth:r.width,leftColumnStartRatio:o.getColumnRatio(),rightColumnStartWidth:a.width,rightColumnStartRatio:i.getColumnRatio()}),J.ZH(t),X.ZH(t))}({environment:c,columnListStore:l,leftColumn:a,rightColumn:s}),J.ZH(c),X.sD())}),[n,c,a,l,s]),u=(0,i.useCallback)((e=>{n&&Qn({columnListBlockStore:o,columnListStore:l,leftColumn:a,rightColumn:s,diffX:e.diffX})}),[n,o,l,a,s]),m=(0,i.useCallback)((e=>{ee.createAndCommit({userAction:"ColumnDivider.handleDragEnd",environment:c,perform:t=>{n&&function(e){const{environment:t,columnListStore:n,transaction:o,leftColumn:i,rightColumn:r}=e,a=Qn(e);if(a){const{leftColumnNewRatio:e,rightColumnNewRatio:s}=a;On.FH({stores:[i],update:{column_ratio:e},transaction:o}),On.FH({stores:[r],update:{column_ratio:s},transaction:o}),n.state.dragging&&n.setState({...n.state,temporaryRatios:{}}),Gn.wy9(t)}}({environment:c,columnListBlockStore:o,columnListStore:l,leftColumn:a,rightColumn:s,diffX:e.diffX,transaction:t})}}),$n({columnListStore:l})}),[n,o,l,c,a,s]),f=(0,i.useCallback)((()=>{$n({columnListStore:l})}),[l]),g=(0,i.useCallback)((()=>{ee.createAndCommit({userAction:"ColumnDivider.handleDoubleClick",environment:c,perform:e=>{n&&function(e){const{columnListBlockStore:t,transaction:n,environment:o}=e,i=1/t.getContentLength();On.FH({stores:t.getContentStores(),update:{column_ratio:i},transaction:n}),Gn.UJm(o)}({environment:c,columnListBlockStore:o,transaction:e})}})}),[n,o,c]);return n?(0,p.jsx)(Yn.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:d,onDraggableDragMove:u,onDraggableDragEnd:m,onDraggableDragCancel:f,disableHorizontalEdgeScroll:!0,disableVerticalEdgeScroll:!0,render:e=>(0,p.jsx)(Bn,{showHandle:!0,mouseStore:t,onDoubleClick:g,...e})}):(0,p.jsx)(Bn,{mouseStore:t,showHandle:!1})}const Xn=i.memo(Jn),eo={display:"flex",position:"relative",flexGrow:1};class to extends ne.Z{constructor(){super(...arguments),this.storeTypes={columnListStore:zn,blockResizerStore:d.Z},this.getChildrenLimit=this.createComputedStore((()=>{const{limitParents:e}=Wn.Z.state;let t;return this.props.store.findRecordStoreUIAncestor((n=>{const o=e.get(n);return!!o&&(t=o[this.props.store.id],!0)})),t})),this.isColumnListResizableStore=this.createComputedStore((()=>this.props.store.canEdit()&&(0,Cn.Po)(this.props.store,this.environment)))}getChildContext(){return{...this.context,isInColumnList:!0}}renderPersisted(){const{disabled:e}=this.props,t=this.stores.columnListStore.state,n=this.getChildrenLimit.state;let o=this.props.store.getContentStores();kn.hj(n)&&(o=kn.tP(o,0,n));let i=o.map(((e,n)=>{let o;return o=t.dragging&&t.temporaryRatios.hasOwnProperty(e.id)?t.temporaryRatios[e.id]:e.getColumnRatio(),o}));const r=kn.Sm(i);i=kn.UI(i,(e=>e/r));const a=[];return o.forEach(((t,n)=>{const r=0===n,s=n===o.length-1;a.push((0,p.jsx)(Fn,{store:t,isFirstItem:r,isLastItem:s,numColumns:o.length,ratio:i[n],disabled:e,columnListStore:this.props.store},t.id)),s||a.push((0,p.jsx)(Xn,{canDrag:this.canEdit(),columnList:this.props.store,leftColumn:t,rightColumn:o[n+1],columnListStore:this.stores.columnListStore},`divider${t.id}`))})),this.renderContainer(a)}renderContainer(e){return this.isColumnListResizableStore.state?(0,p.jsx)("div",{style:this.getResizableWrapperStyle(),children:(0,p.jsxs)("div",{style:eo,children:[(0,p.jsx)(qn.ZP,{disabled:!this.canEdit(),blockResizerStore:this.stores.blockResizerStore,resizeComponent:this,resizerType:qn.IS.Horizontal,resizerAlignment:qn.bZ.Left,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,children:(0,p.jsx)("div",{style:oo("left"),children:(0,p.jsx)(Bn,{onDoubleClick:()=>ro(this.props.store,this.environment),showHandle:this.canEdit()})})},"divider-left-edge"),e,(0,p.jsx)(qn.ZP,{disabled:!this.canEdit(),resizeComponent:this,resizerType:qn.IS.Horizontal,resizerAlignment:qn.bZ.Right,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,blockResizerStore:this.stores.blockResizerStore,children:(0,p.jsx)("div",{style:oo("right"),children:(0,p.jsx)(Bn,{onDoubleClick:()=>ro(this.props.store,this.environment),showHandle:this.canEdit()})})},"divider-right-edge")]})}):(0,p.jsx)("div",{style:io(this.props.store,this.environment),children:e})}handleCreated(){const{store:e}=this.props,t=e.getContentStores()[0];if(t&&t.getType()===z.Ti.column){const e=t.getContentStores()[0];e&&e.getType()===z.Ti.text&&(J.eP({environment:this.environment,store:e}),X.N_({store:e.getBlockTitleStore()}))}}getResizableWrapperStyle(){const e={position:"relative",transition:"padding 0.2s linear"},t=Boolean(this.props.store.getFormat().block_full_width);return(t&&this.stores.blockResizerStore.state.dragging?this.stores.blockResizerStore.state.temporaryFullWidth:t)&&(e.paddingLeft=An,e.paddingRight=An),e}}to.contextTypes=Ln.w,to.childContextTypes={isInColumnList:Un().any,...Ln.w};const no=to;function oo(e){return{display:"flex",position:"absolute",top:0,bottom:0,right:"left"===e?"100%":"auto",left:"right"===e?"100%":"auto"}}function io(e,t){const n={display:"flex"};return(0,Cn.zE)(e,t)||(n.display="block"),n}function ro(e,t){ee.createAndCommit({userAction:"ColumnList.handleResizeDoubleClick",environment:t,perform:t=>{if(e.canEdit()){const n=!e.getFormat().block_full_width;On.FH({stores:[e],transaction:t,update:{block_full_width:n}})}}})}var ao=n(91948);function so(e,t){window.__c={n:"CopyIndicator"};const n=i.useRef(null),o=(0,y.yK)((()=>({root:{minHeight:"1.5em",display:"flex",alignItems:"center"},wrapper:{...N.ZD},progressBar:{flex:1,margin:"0 8px"}})),[]);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"copy_indicator",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(we.p,{allowSelectionWithin:!1,style:o.wrapper,ref:n,children:(0,p.jsxs)("div",{style:o.root,children:[(0,p.jsx)(Ye.Z,{}),(0,p.jsx)("div",{style:o.progressBar,children:(0,p.jsx)(ao.Z,{targetRecordId:e.store.id})})]})}))}const lo=i.memo(i.forwardRef(so),s.Z);var co=n(90827);const uo=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.embeds.button.label"}});function po(e,t){window.__c={n:"DeepnoteBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"deepnote",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:co.N,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Deepnote blocks with public links",id:"deepnoteBlock.embeds.caption"}),embedButtonText:n.formatMessage(uo.embedButtonText),urlInputPlaceholder:"https://deepnote.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.placeholder"})}))}const mo=i.memo(i.forwardRef(po),s.Z);var fo=n(6404),go=n(27724),ho=n(61519);function vo(e,t){let{store:n}=e;window.__c={n:"DividerBlock"};const o=(0,v.Fy)(),r=(0,v.O7)(),a=(0,i.useRef)(null),s=(0,y.yK)((e=>({root:{color:e.darkDividerColor,pointerEvents:"auto"}})),[]),l=(0,i.useCallback)((e=>{o.isMobile&&(J.Ys({environment:r,store:n}),fo.Qn({environment:r,stores:go.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:"default",showInput:!0,analyticsFrom:"content_block_menu"}))}),[o.isMobile,r,n]);return(0,c.ez)(n,t,(0,i.useMemo)((()=>({renderedType:"divider",getNode:()=>a.current,getBlockStore:()=>n,handleCreated(){ee.createAndCommit({userAction:"DividerBlock.handleCreated",environment:r,perform:e=>In.Bm({environment:r,targetStore:n,targetParentStore:n.getRecordStoreUIParent(),isAtStartOfLine:!1,isClick:!1,transaction:e})})}})),[r,n]),(0,p.jsx)(ho.Z,{className:T.QSt,size:13,style:s.root,onClick:l,ref:a}))}const bo=i.memo(i.forwardRef(vo),s.Z);var yo=n(4708);function _o(e,t){window.__c={n:"DrawingBlock"};const n=(0,i.useRef)(null),o=(0,v.Fy)(),r=(0,v.O7)(),a=(0,yo.A3)()?{source:"https://www.notion.so/product/drawing"}:{};return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"drawing",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store,handleCreated(){X.ZH({device:o}),J.Z5({environment:r,stores:[e.store],phase:go.SelectionPhase.Editing})}})),[o,r,e.store]),(0,p.jsx)(u.ZP,{...e,...a,ref:n,mediaMenuTabs:[],disableMediaMenu:!0,preserveScale:!1,showURLInput:!1}))}const So=i.memo(i.forwardRef(_o),s.Z);var wo=n(7057),ko=n(84869),Io=n(91584),xo=n(68422),Co=n(63085),To=n(28415);class Mo extends O.default{getInitialState(){return{error:!1,loading:!1}}}const Po=Mo,Ao={display:"block",width:"100%",height:"100%",objectFit:"cover",objectPosition:"top"},Ro={position:"absolute",top:0,left:0,right:0,bottom:0},Do={display:"block",position:"relative",width:"100%",paddingBottom:"55%"},Bo=(0,l.defineMessages)({menuTitle:{defaultMessage:"Embed",id:"googleDriveBlock.mediaMenuActions.embedTab.title"}});class Eo extends ne.Z{constructor(){super(...arguments),this.captionAriaId=(0,Be.Z)(),this.storeTypes={mouseStore:qe.Z,driveStore:Po},this.openGoogleDriveFilePicker=e=>{To.vE({environment:this.environment,accessToken:e.accessToken,callback:t=>{this.loadAndInitializeGoogleDrive(t,e)}})},this.handleMouseEnter=e=>{V.Z.state.isDragging||U.default.state.isActive||this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{V.Z.state.isDragging||U.default.state.isActive||this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.openMenu=()=>{const{device:e}=this.environment;if(this.canEdit()){const t=De.findDOMNode(this);if(t&&t instanceof Element){const n=t.getBoundingClientRect();ze.$(this.environment,{originRect:n,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:e.isMobile?"embed":"drive",tabs:this.mediaPickerTabs(),title:R.default.formatMessage(Bo.menuTitle),popupWidth:320,maxHeight:420})}}}}handleCreated(){this.openMenu()}didMount(){super.didMount();const e=this.props.store.getFormat();e&&e.drive_properties&&e.drive_properties.file_id&&e.drive_status&&e.drive_status.last_fetched+5*Ue.hM<Date.now()&&Io.WO(this.environment,{id:this.props.store.id,spaceId:(0,_t.C)(this.props.store.pointer.spaceId)})}renderPersisted(){const e=this.props.store.getProperties(),t=this.props.store.getFormat();return t&&t.drive_properties&&t.drive_status?this.renderBlock(t.drive_properties):e&&e.source?this.renderLegacy():this.renderPlaceholder()}renderBlock(e){const t=e.url;return(0,p.jsxs)("div",{role:"figure","aria-labelledby":this.captionAriaId,children:[(0,p.jsxs)("div",{style:{display:"flex"},children:[(0,p.jsxs)(Qe.Z,{href:t,external:!0,style:(n=this.theme,{display:"flex",flexDirection:"column",width:"100%",border:`1px solid ${n.darkDividerColor}`,borderRadius:4,position:"relative"}),onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[this.renderThumbnail(e),(0,p.jsx)(No,{fileData:e}),this.shouldShowActionButton()&&this.canEdit()&&(0,p.jsx)(jo,{store:this.props.store})]}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,p.jsx)(Ge.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]});var n}renderThumbnail(e){const t=e.thumbnail,n=this.stores.driveStore.state.error;return t&&!n?(0,p.jsx)("div",{style:Do,children:(0,p.jsx)("div",{style:Ro,children:(0,p.jsx)(Je.Z,{url:t,width:1e3,isAuthenticated:!0,permissionRecord:this.props.store.pointer,render:(t,n)=>{if(n){const t=je.SK(n,{v:e.version});return(0,p.jsx)("img",{src:t,style:Ao,onError:e=>{this.stores.driveStore.setState({error:!0,loading:!1})}})}t&&this.stores.driveStore.setState({error:!0,loading:!1})}})})}):(0,p.jsx)("div",{style:(o=this.theme,{...Do,paddingBottom:"20%",minHeight:80,background:o.embedPlaceholderBackground})});var o}renderLegacy(){return(0,p.jsx)(u.ZP,{...this.props,...this.stores,store:this.props.store,iconSvg:ko.c,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Google Docs, Google Sheetsâ€¦",id:"googleDriveBlock.legacyLinkInput.caption"}),children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed a file from Google Drive",id:"googleDriveBlock.legacy.placeholder"})})}renderPlaceholder(){const{disabled:e}=this.props,t=this.props.store.getFormat().drive_status,n=!(!t||!t.authed);return(0,p.jsxs)("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{display:"flex"},children:[(0,p.jsx)(et.Z,{iconSvg:ko.c,disabled:e,shouldHideRight:!this.shouldShowActionButton(),right:this.canEdit()&&(0,p.jsx)(Ke.Z,{store:this.props.store,fadeIn:!1}),onClick:this.openMenu,isLoading:this.stores.driveStore.state.loading,progressPercent:0,children:n?(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Choose a file to embed from Google Drive",id:"googleDriveBlock.placeholder.authenticated"}):(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Connect Google Drive to Notion to embed a file",id:"googleDriveBlock.placeholder.notAuthenticated"})}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}shouldShowActionButton(){const{device:e}=this.environment;return e.isMobile||this.stores.mouseStore.state.mouseEntered}async loadAndInitializeGoogleDrive(e,t){this.stores.driveStore.setState({loading:!0,error:!1});const n=await Io.Ui({environment:this.environment,store:this.props.store,fileId:e,token:t});this.stores.driveStore.setState({loading:!1,error:!n||!!n.auth_error})}async initializeGoogleDriveBlockFromUrl(e){const t=Co.id(e);if(!t)return void Zo(e,this.props.store,this.environment);const n=await Io.Ui({environment:this.environment,store:this.props.store,fileId:t});n&&n.auth_error&&(Io.cR(this.environment,{onSuccess:e=>{this.loadAndInitializeGoogleDrive(t,e)},onFailure:()=>{Zo(e,this.props.store,this.environment)}}),Vo("url_embed",this.environment))}mediaPickerTabs(){const{device:e}=this.environment,t=[];return t.push({type:"embed",caption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with any file in your Google Drive",id:"googleDriveBlock.embedTab.caption"}),buttonText:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Google Drive file",id:"googleDriveBlock.embedTab.embedButton.label"}),onChange:e=>{ze.Z(),this.initializeGoogleDriveBlockFromUrl(e)}}),e.isMobile||t.push({type:"drive",title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>{if(ze.Z(),e&&e.token)this.openGoogleDriveFilePicker(e.token),Le.uu(this.environment);else{const e=await Io.qN(this.environment);e&&e.token&&this.openGoogleDriveFilePicker(e.token),Vo("drive_file_picker",this.environment)}}}),t}}const Fo=Eo;function Zo(e,t,n){ee.createAndCommit({userAction:"DriveBlock.convertToTextBlock",environment:n,perform:o=>{Y.sW({store:t.getPropertiesStore(),data:{title:[Ve.V3y(e,[Ve.edl(e)])]},transaction:o}),xo.Cj({environment:n,blocks:[t],blockType:"text",transaction:o})}})}function Vo(e,t){Le.SO(t,{integration_name:"google",from:e})}function jo(e){let{store:t}=e;window.__c={n:"ActionMenuButton"};const n=(0,v.O7)();return(0,p.jsx)(Ke.Z,{store:t,style:{position:"absolute",top:4,right:4,background:(0,u.M1)(n)},iconStyle:{fill:_.ZP.white},fadeIn:!0})}function Uo(e){return{width:"100%",minHeight:60,padding:14,paddingTop:12,overflow:"hidden",borderTop:`1px solid ${e.darkDividerColor}`}}function Lo(e){return{fontSize:12,lineHeight:1.3,color:e.mediumTextColor,maxHeight:32,overflow:"hidden"}}function Oo(e){let{fileData:t}=e;window.__c={n:"DescriptionComponent"};const n=(0,y.Fg)(),o=t.user_name||t.modified_time?(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Last modified {hasUserName, select, true {by {userName}} other {}} {hasLastModifiedTime, select, true {{lastModifiedTime}} other {}}",id:"googleDriveBlock.pageDescription",values:{hasUserName:Boolean(t.user_name),userName:t.user_name,hasLastModifiedTime:Boolean(t.modified_time),lastModifiedTime:t.modified_time&&(0,wo.tv)(t.modified_time,h.SP)}}):void 0;return(0,p.jsxs)("div",{style:Lo(n),children:[t.trashed&&(0,p.jsx)(l.FormattedMessage,{defaultMessage:"This file is in trash.",id:"googleDriveBlock.pageDeleted.caption"}),o]})}function No(e){let{fileData:t}=e;window.__c={n:"FileComponent"};const n=(0,y.Fg)(),o=t.title,i=t.url,r=je.Qc(i).hostname;return(0,p.jsxs)("div",{style:Uo(n),children:[o&&(0,p.jsx)(Xe.Z,{style:{marginBottom:2},children:o}),(0,p.jsx)(Oo,{fileData:t}),(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:6},children:[t.icon&&(0,p.jsx)("div",{style:(a=t.icon,{flexShrink:0,backgroundImage:`url(${a})`,backgroundSize:"cover",width:16,height:16,marginRight:6})}),(0,p.jsx)(Xe.Z,{style:{color:n.regularTextColor},isSmall:!0,children:r})]})]});var a}var zo=n(63003),Wo=n(993),qo=n(83631),Ho=n(3702),Ko=n(22492),Go=n(40148);class $o extends ne.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:qe.Z,focusStore:O.default.createClass(!1),buttonPopupStore:He.Z},this.renderOrigin=()=>{const{device:e}=this.environment,{store:t}=this.props,n=Yo(this.props.store);let o,i={};n?o=(0,p.jsx)(Ko.Z,{display:"block",equation:n,style:this.getContainerStyle(!1),errorStyle:this.getContainerStyle(!0),theme:this.theme}):(o=(0,p.jsx)(Go.ZP,{iconSvg:zo.f,iconStyle:{width:28,height:28,marginRight:8},style:{background:void 0},children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Add a TeX equation",id:"equationBlock.empty.placeholder"})},"button"),i={background:this.theme.sidebarBackground});const r=e.isMobile||this.stores.mouseStore.state.mouseEntered||this.stores.focusStore.state;return(0,p.jsxs)(ce.Z,{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onClick:this.handleOpen,style:{position:"relative",width:"100%",borderRadius:4,...i},children:[o,this.canEdit()&&(0,p.jsx)(Ke.Z,{onFocus:this.handleFocus,onBlur:this.handleBlur,store:t,tooltipContent:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Rename, delete, and moreâ€¦",id:"equationBlock.actions.tooltip"}),style:{position:"absolute",top:4,right:4,color:this.theme.mediumTextColor,opacity:r?1:0},fadeIn:!1})]})},this.handleOpen=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})},this.handleClose=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),J.Ys({environment:this.environment,store:this.props.store})},this.handleMouseMove=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,gt.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)}}handleCreated(){this.handleOpen()}edit(){this.handleOpen()}activate(){this.stores.buttonPopupStore.state.open?this.handleClose():this.handleOpen()}renderPersisted(){const e=Yo(this.props.store),t=this.stores.buttonPopupStore.state.open?{isOpen:!0,equationValue:e,error:qo.by({environment:this.environment,equation:e,displayMode:"block"})}:{isOpen:!1,equationValue:void 0,error:void 0},n=!this.canEdit(),o=this.renderOrigin();return(0,p.jsxs)(we.p,{allowSelectionWithin:!0,style:{display:"flex",position:"relative"},children:[(0,p.jsx)(B.DependencyConsumer,{dependency:B.deps.prismjs,children:e=>(0,p.jsx)(Ho.Z,{...t,Prism:e,displayMode:"block",disabled:n,origin:o,onDismiss:this.handleClose,onChange:e=>function(e,t,n){ee.createAndCommit({userAction:"EquationBlock.handleChange",environment:n,perform:o=>{Wo.sO({environment:n,store:t.getBlockTitleStore(),value:Ve.TPx(e),transaction:o})}})}(e,this.props.store,this.environment),onSubmit:()=>{return e=this.props.store,t=this.environment,void Gn.PyM(t,{equation:Yo(e)});var e,t}})}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}getContainerStyle(e){const t={display:"flex",padding:"4px 8px",width:"100%"};return Yo(this.props.store)?(t.flexDirection="column",t.overflow="auto"):t.color=_.ZP.contentPlaceholder,e&&(t.background=this.theme.equationErrorPlaceholderBackground),{...t,...this.getBlockColorStyle()}}}const Qo=$o;function Yo(e){const t=e.getBlockTitleStore().getValue();return Ve.Jcv(t)}var Jo=n(56185);const Xo=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.embeds.button.label"}});function ei(e,t){window.__c={n:"ExcalidrawBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"excalidraw",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Jo.F,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Excalidraw whiteboards.",id:"excalidrawBlock.embeds.caption"}),embedButtonText:n.formatMessage(Xo.embedButtonText),urlInputPlaceholder:"https://excalidraw.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.placeholder"})}))}const ti=i.memo(i.forwardRef(ei),s.Z);var ni=n(14562),oi=n(13797),ii=n(47453),ri=n(81193),ai=n(95802),si=n(26664),li=n(54532),ci=n(42858);var di=n(52315);class ui extends O.default{getInitialState(){return{open:!1}}}const pi=ui;var mi=n(26136),fi=n(34583),gi=n(42922),hi=n(23189),vi=n(13490);class bi extends Ln.Z{constructor(){super(...arguments),this.storeTypes={store:pi},this.handleCloseClick=()=>{this.stores.store.setState({...this.stores.store.state,open:!1})}}renderComponent(){return this.stores.store.state.open?(0,p.jsxs)("div",{style:{flexGrow:1,minWidth:0},children:[this.props.origin,(0,p.jsxs)("div",{style:{position:"relative",boxShadow:`inset 0 0 0 1px ${this.theme.regularDividerColor}`,padding:12,borderRadius:4,overflow:"hidden"},children:[(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,p.jsx)(hi.Z,{style:{flex:1,marginRight:16,marginBottom:0},children:this.props.title}),(0,p.jsx)(gi.Z,{onClick:this.handleCloseClick,children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Close",id:"factoryBlock.configureMenu.closeButton.label"})})]}),this.props.properties.map(((e,t)=>(0,p.jsx)(_i,{args:e,index:t},t)))]})]}):this.props.origin}}bi.displayName="Configurable";const yi=bi;function _i(e){let{args:t,index:n}=e;window.__c={n:"PropertyComponent"};const{title:o,subtitle:i,value:r}=t,a=(0,y.Fg)();return(0,p.jsxs)("div",{children:[(0,p.jsx)(ho.Z,{size:36}),(0,p.jsx)(vi.Z,{children:o}),(0,p.jsx)(Xe.Z,{isSmall:!0,children:i}),(0,p.jsx)("div",{style:{marginTop:8,padding:6,background:a.sidebarBackground,borderRadius:4},children:r})]})}var Si=n(15201),wi=n(73063),ki=n(89728),Ii=n(26388);const xi={pointerEvents:"none",...k.Z.textOverflowStyle},Ci=(0,l.defineMessages)({addNewItem:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.label"},buttonPlaceholder:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.placeholder"}});class Ti extends ne.Z{constructor(){super(...arguments),this.storeTypes={configurableStore:pi,mouseStore:qe.Z},this.handleMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleButtonClick=()=>{this.canEdit()&&fi.M_(this.environment)&&ee.createAndCommit({userAction:"FactoryBlock.handleButtonClick",environment:this.environment,perform:e=>{!function(e){const{store:t,transaction:n,environment:o}=e,i=t.getRecordStoreUIParent();let r=!1;i&&i.valueIs(si.i)&&kn.YM(i.getValue())!==t.id&&kn.Z$(i.getValue())===t.id&&(r=!0);const a=t.getContentStores().filter((e=>e.isDefined()));r||a.reverse();const s=ai.C.findSelectableFromStore(t),l=[],c=Promise.all(a.map((e=>new Promise((i=>{const a=e.getModel(),c=!a||!a.isTemplateVariableContainerBlock(),[d,u]=li.Qi({environment:o,stores:[e],transaction:n,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:c,targetSpaceId:(0,_t.C)(e.pointer.spaceId),baseUrl:Ut.default.domainBaseUrl,publicDomainName:Ut.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:t.useCrdt()}),p=d[0];u.then((e=>{e&&Ne.showErrorMessage(e),i()})),s&&(r?s.props.onInsertAbove&&s.props.canInsertAbove&&l.push(s.props.onInsertAbove({insertStores:[p],transaction:n})[0]):s.props.onInsertBelow&&s.props.canInsertBelow&&l.push(s.props.onInsertBelow({insertStores:[p],transaction:n})[0]))})))));r||l.reverse(),J.Z5({environment:o,stores:l}),c.then((()=>{wn.default.afterNextFlush((()=>{ci.DV({environment:o,insertedStores:l,isCreated:!0})}))}))}({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleToggleConfigure=()=>{this.stores.configurableStore.state.open?this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!1}):(ri.PE(this.environment,{from:"gear_button"}),this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0}))}}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e),di.b(e.store)}handleCreated(){this.configure()}activate(){this.handleButtonClick()}configure(){this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0})}renderPersisted(){const e=this.getDisabled();return(0,p.jsxs)(we.p,{allowSelectionWithin:!0,style:{display:"flex"},children:[(0,p.jsx)(yi,{title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Configure template button",id:"factoryBlock.configureButton.label"}),origin:this.renderFactory(),store:this.stores.configurableStore,properties:[{title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Button name",id:"factoryBlock.buttonName.title"}),subtitle:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"What should this button be called?",id:"factoryBlock.buttonName.subtitle"}),value:(0,p.jsx)(me.Z,{disabled:e,store:(t=this.props.store,mi.G.createChildStore(t,t.pointer).getBlockTitleStore()),placeholder:R.default.formatMessage(Ci.addNewItem),onEnter:kn.yR,pasteBehavior:"inline"})},{title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Template",id:"factoryBlock.templateArea.title"}),subtitle:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Drop blocks here that you want to duplicate whenever the button is clicked.",id:"factoryBlock.templateArea.subtitle."}),value:(0,p.jsx)(Si.O,{displayName:"FactoryBlockContent",disabled:e,children:(0,p.jsx)(ue.Z,{disabled:e,store:this.props.store.getContentStore(),emptyPlaceholder:(0,p.jsx)("div",{style:{caretColor:this.theme.regularTextColor,color:this.theme.regularTextColor},children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Empty. Drop blocks hereâ€¦",id:"factoryBlock.emptyTemplate.placeholder"})}),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})}]}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]});var t}renderFactory(){const{device:e}=this.environment,t=this.getDisabled();return(0,p.jsxs)(ki.Z,{icon:ii.R,isGray:!0,isLarge:!0,style:{fontSize:"inherit",width:"100%"},shouldShrink:!0,onClick:this.handleButtonClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,disabled:t,children:[(0,p.jsx)(me.Z,{disabled:!0,store:this.props.store.getBlockTitleStore(),placeholder:R.default.formatMessage(Ci.buttonPlaceholder),style:xi,placeholderStyle:(n=this.theme,{width:"100%",display:"block",caretColor:n.regularTextColor,color:n.regularTextColor,...k.Z.textOverflowStyle})}),!t&&(e.isMobile||this.stores.mouseStore.state.mouseEntered)&&(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center"},className:T.JiD,children:[!e.isMobile&&this.renderConfigureButton(),(0,p.jsx)(Ke.Z,{tooltipContent:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"factoryBlock.moreActions.button.label"}),store:this.props.store,fadeIn:!0})]})]});var n}renderConfigureButton(){return(0,p.jsx)(Ii.ZP,{renderTooltip:()=>(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Configure template",id:"factoryBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,p.jsx)(wi.Z,{icon:oi.F,onClick:this.handleToggleConfigure,...e})})}getDisabled(){return this.props.disabled||!this.canEdit()}}const Mi=Ti;var Pi=n(71441);function Ai(e,t){window.__c={n:"FigmaBlock"};const n=(0,i.useRef)(null),o=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"figma",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,ref:n,blockResizerStore:o,store:e.store,iconSvg:Pi.O,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with any public Figma shareable link",id:"figmaBlock.caption"}),children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Figma",id:"figmaBlock.placeholder"})}))}const Ri=i.memo(i.forwardRef(Ai),s.Z);var Di=n(69721),Bi=n(60997);const Ei=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Framer",id:"framerBlock.embedFramer.button.label"}});function Fi(e,t){window.__c={n:"FramerBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"framer",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Bi.B,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Framer prototypes",id:"framerBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Ei.embedButtonText),urlInputPlaceholder:"https://framer.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Framer prototype",id:"framerBlock.placeholder"})}))}const Zi=i.memo(i.forwardRef(Fi),s.Z);var Vi=n(69578);const ji=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Gist",id:"gistBlock.embedButton.label"}});function Ui(e,t){window.__c={n:"GistBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"gist",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Vi.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with links to Gists on GitHub",id:"gistBlock.linkInput.caption"}),embedButtonText:n.formatMessage(ji.embedButtonText),urlInputPlaceholder:"https://gist.github.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Gist",id:"gistBlock.placeholder"})}))}const Li=i.memo(i.forwardRef(Ui),s.Z);var Oi=n(65453),Ni=n(64258);const zi=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Hex",id:"hexBlock.embeds.button.label"}});function Wi(e,t){window.__c={n:"HexBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"hex",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Ni.p,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Hex cell links with public access.",id:"hexBlock.embeds.caption"}),embedButtonText:n.formatMessage(zi.embedButtonText),urlInputPlaceholder:"https://hex.tech/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Hex",id:"hexBlock.placeholder"})}))}const qi=i.memo(i.forwardRef(Wi),s.Z);var Hi=n(44597);const Ki=(0,l.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the image linkâ€¦",id:"imageBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed image",id:"imageBlock.embedImage.button.label"}});function Gi(e,t){window.__c={n:"ImageBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z),s=(0,r.VK)((()=>{const e=[{type:"file",imageUpload:!0},{type:"embed"},{type:"unsplash"}];return Lt.default.checkGate("enable_giphy_feature_gate")&&e.push({type:"giphy"}),e}),[]);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"image",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,urlInputPlaceholder:n.formatMessage(Ki.urlPlaceholder),iconSvg:Hi.U,preserveScale:!0,mediaMenuCurrentTab:"file",mediaMenuTabs:s,mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with any image from the web",id:"imageBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Ki.embedButtonText),popupWidth:540,maxHeight:420,children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Add an image",id:"imageBlock.placeholder"})}))}const $i=i.memo(i.forwardRef(Gi),s.Z);var Qi=n(48964);const Yi=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Invision",id:"invisionBlock.embeds.button.label"}});function Ji(e,t){window.__c={n:"InvisionBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"invision",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Qi.v,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Invision projects",id:"invisionBlock.embeds.caption"}),embedButtonText:n.formatMessage(Yi.embedButtonText),urlInputPlaceholder:"https://invis.io/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed an Invision project",id:"invisionBlock.placeholder"})}))}const Xi=i.memo(i.forwardRef(Ji),s.Z);var er=n(23586),tr=n(75822),nr=n(80444);class or extends O.default{getInitialState(){return{query:""}}}const ir=or;var rr=n(24666),ar=n(3386),sr=n(6287),lr=n(72711),cr=n(69454),dr=n(32163),ur=n(43765),pr=n(11470),mr=n(75987),fr=n(36488),gr=n(74194),hr=n(53437);class vr extends Ln.Z{constructor(){super(...arguments),this.storeTypes={store:ir},this.handleQueryUpdateDebounced=void 0,this.handleInputChange=e=>{const t=e.target.value;this.stores.store.setState({...this.stores.store.state,query:t}),this.handleQueryUpdateDebounced(t)},this.handleQueryUpdate=e=>{this.props.onQueryUpdate&&this.props.onQueryUpdate({query:e,autocompleteStore:this.stores.store})}}get registries(){return[mr.Z]}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.handleQueryUpdateDebounced=kn.Ds(this.handleQueryUpdate,this.props.queryUpdateDebounce)}renderComponent(){const{device:e}=this.environment;return(0,p.jsx)(hr.ZP,{popupType:e.isPhone?hr.ZP.PopupType.SlideUp:hr.ZP.PopupType.Popup,open:this.props.isOpen,origin:this.renderInput(),placementToOrigin:hr.ZP.Placement.Bottom,alignmentToOrigin:hr.ZP.Alignment.Start,originGap:4,disableDarkOverlayBackground:e.isPhone,onDismiss:this.props.onBgClick,render:this.props.renderPopup,preventCaptureEsc:this.props.preventCaptureEsc,disableMouseCapture:this.props.disableMouseCapture,style:this.props.popupStyle})}renderInput(){const e=this.props.isOpen;return(0,p.jsx)(fr.Z,{capture:e,allowMenuList:!0,render:e=>(0,p.jsx)(we.p,{allowSelectionWithin:!0,...e,children:(0,p.jsx)(gr.Z,{style:this.props.inputStyle,format:void 0!==this.props.format?this.props.format:gr.B.Transparent,value:this.stores.store.state.query,onClick:this.props.onInputClick,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,onChange:this.handleInputChange,placeholder:this.props.inputPlaceholder,focus:this.props.focus})})})}}vr.displayName="InlineAutocomplete";const br=vr,yr=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a databaseâ€¦",id:"linkToCollectionBlock.input.placeholder"}});function _r(e){window.__c={n:"LinkToCollectionBlockPopup"};const t=(0,l.useIntl)(),n=(0,v.O7)(),o=(0,v.Fy)(),r=(0,i.useRef)(!1),a=(0,i.useCallback)((()=>{const t=(e.results||[]).map((t=>{const o=mi.NW.createChildStore(e.store,{table:sr.v,id:t});return{key:t,render:e=>(0,p.jsx)(pr.Z,{...e,store:o}),action:()=>{r.current||(r.current=!0,ee.createAndCommit({userAction:"LinkToCollectionBlock.menuListItem",environment:n,perform:t=>{const i=lr.Y_({environment:n,store:e.store,collectionStore:o,collectionViewStore:void 0,transaction:t});i&&J.Z5({environment:n,stores:[i]})}}))}}}));let i,a;return i=e.results&&0===t.length?(0,p.jsx)(At.Z,{title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.noResults.title"}),loading:!e.ready,children:(0,p.jsx)(ur.Z,{title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"linkToCollectionBlock.menuItem.noResults.label"})})}):(0,p.jsx)(dr.Z,{type:dr.i.Vertical,initialFocus:0,sections:[{key:0,render:t=>(0,p.jsx)(At.Z,{...t,title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.showResults.title"}),loading:!e.ready}),items:t}]}),a=o.isPhone?{menuType:Vt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${cr.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:Vt.og.Popup,width:460,maxHeight:o.isPhone?"30vh":"40vh"},(0,p.jsx)(nn.Z,{...a,children:i})}),[o.isPhone,n,e.ready,e.results,e.store]),s=(0,i.useCallback)((()=>{X.ZH(n),r.current||(r.current=!0,ee.createAndCommit({userAction:"LinkToCollectionBlock.handleBlur",environment:n,perform:t=>{ci.Od({store:e.store,transaction:t})}}))}),[n,e.store]);return(0,p.jsx)(br,{loading:!e.ready,isOpen:!0,store:e.autocompleteStore,queryUpdateDebounce:tr.vp,inputPlaceholder:t.formatMessage(yr.inputPlaceholder),focus:!0,inputStyle:{...Sr(),borderBottom:void 0},onBgClick:s,renderPopup:a})}function Sr(){return{lineHeight:1.3}}function wr(e,t){window.__c={n:"LinkToCollectionBlock"};const n=(0,v.O7)(),o=(0,i.useRef)(null),a=(0,r.qz)(void 0,ir),{query:s}=(0,r.VK)((()=>a.state),[a]),l=(0,r.VK)((()=>{const t=rr.default.state;return Boolean("editing"===t.mode&&(0,ie.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.store.id)}),[e.store.id]);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"link_to_collection",getNode:()=>o.current,getBlockStore:()=>e.store,handleCreated(){J.$Y({environment:n,phase:go.SelectionPhase.Editing}),X.Z5({store:e.store,selection:void 0})}})),[n,e.store]),l?(0,p.jsx)(er.Z,{request:s,performRequest:t=>async function(e,t,n){if(t.isDefaultRecordCache()){const t=await B.deps.searchActions.loader(),{currentSpaceStore:o}=nr.default.state;return(await t.searchCollections(n,{query:e,limit:20,source:"link_to_collection_block",spaceStore:o})).results}return[]}(t,e.store,n),debounce:tr.vp,render:(t,n,o)=>(0,p.jsx)(ar.Z,{capture:l,children:(0,p.jsx)(_r,{store:e.store,results:n,ready:o,autocompleteStore:a})})}):null)}const kr=i.memo(i.forwardRef(wr),s.Z);var Ir=n(72141),xr=n(21202),Cr=n(61045),Tr=n(28020),Mr=n(67669);const Pr=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a pageâ€¦",id:"linkToPageBlock.searchPlaceholder"}});function Ar(e){window.__c={n:"LinkToPageBlockPopup"};const t=(0,l.useIntl)(),n=(0,v.O7)(),o=(0,v.Fy)(),a=(0,r.VK)((()=>cr.Z.estimatedNativeWebBottomOverlap()),[]),s=(0,i.useRef)(!1),c=(0,i.useCallback)((()=>{const t=(e.results||[]).map((t=>{const o=mi.G.createChildStore(e.store,{table:xr.iU,id:t});return{key:t,render:e=>(0,p.jsx)(pr.Z,{...e,store:o}),action:()=>{s.current||(s.current=!0,ee.createAndCommit({userAction:"LinkToPageBlock.menuListItem",environment:n,perform:t=>{const i=lr.hc({environment:n,store:e.store,targetStore:o,transaction:t});i&&J.Z5({environment:n,stores:[i]})}}))}}}));let i,r;return i=e.results&&0===t.length?(0,p.jsx)(At.Z,{title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt"}),loading:!e.ready,children:(0,p.jsx)(ur.Z,{title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"linkToPageBlock.noSearchResults"})})}):(0,p.jsx)(dr.Z,{type:dr.i.Vertical,initialFocus:0,sections:[{key:0,render:t=>(0,p.jsx)(At.Z,{...t,title:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt.withContents"}),loading:!e.ready}),items:t}]}),r=o.isPhone?{menuType:Vt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${a}px)`}:{menuType:Vt.og.Popup,width:460,maxHeight:o.isMobile?"30vh":"40vh"},(0,p.jsx)(nn.Z,{...r,children:i})}),[o.isMobile,o.isPhone,n,a,e.ready,e.results,e.store]),d=(0,i.useCallback)((()=>{X.ZH(n),s.current||(s.current=!0,ee.createAndCommit({userAction:"LinkToPageBlock.handleBlur",environment:n,perform:t=>{ci.Od({store:e.store,transaction:t})}}))}),[n,e.store]);return(0,p.jsx)(br,{loading:!e.ready,isOpen:!0,store:e.autocompleteStore,queryUpdateDebounce:tr.vp,inputPlaceholder:t.formatMessage(Pr.inputPlaceholder),focus:!0,inputStyle:{...Rr(),borderBottom:void 0},onBgClick:d,renderPopup:c})}function Rr(){return{lineHeight:1.3}}function Dr(e,t){window.__c={n:"LinkToPageBlock"};const n=(0,v.Fy)(),o=(0,v.O7)(),a=(0,i.useRef)(null),s=(0,r.qz)(void 0,ir),{query:l}=(0,r.VK)((()=>s.state),[s]),d=(0,r.VK)((()=>{const t=rr.default.state;return Boolean("editing"===t.mode&&(0,ie.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.store.id)}),[e.store]);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"link_to_page",getNode:()=>a.current,getBlockStore:()=>e.store,handleCreated(){J.$Y({environment:o,phase:go.SelectionPhase.Editing}),X.Z5({store:e.store,selection:void 0}),n.isMobile&&cr.Z.onShow((()=>Cr.hQ(o)))}})),[n.isMobile,o,e.store]),d?(0,p.jsx)(er.Z,{request:l,performRequest:t=>async function(e,t,n){const{currentSpaceStore:o,mainEditorCurrentBlockStore:i}=nr.default.state,r=(0,Mr.YO)(t).find((e=>{let{permissionItem:t}=e;return(0,Ir.$D)(t)}));if(t.isDefaultRecordCache()&&(o||r)){if(!e)return r&&!o&&i?[i.id]:Tr._u(n).map((e=>e.id));{const t=await B.deps.searchActions.loader();if(o){return(await t.searchPageIds({environment:n,query:e,limit:20,spaceId:o.id,requireEditPermissions:!1,excludeTemplates:!1,source:"link_to_page_block",boostRecentlyViewedPages:!0})).results}if(r&&r.from.table===xr.iU){return(await t.searchPageIdsInAncestor({environment:n,query:e,limit:20,ancestorId:r.from.blockId,excludeTemplates:!1,source:"link_to_page_block"})).results}}}return[]}(t,e.store,o),debounce:tr.vp,render:(t,n,o)=>(0,p.jsx)(ar.Z,{capture:d,children:(0,p.jsx)(Ar,{store:e.store,results:n,ready:o,autocompleteStore:s})})}):null)}const Br=i.memo(i.forwardRef(Dr),s.Z);var Er=n(97485);function Fr(e,t){window.__c={n:"LoomBlock"};const n=(0,i.useRef)(null),o=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"loom",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Er.p,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with any Loom shareable link",id:"loomBlock.embed.caption"}),children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Loom",id:"loomBlock.placeholder"})}))}const Zr=i.memo(i.forwardRef(Fr),s.Z);var Vr=n(81822);const jr=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Map",id:"googleMapsBlock.embedButton.label"}});function Ur(e,t){window.__c={n:"MapsBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"maps",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Vr.h,urlInputPlaceholder:"https://www.google.com/mapsâ€¦",embedButtonText:n.formatMessage(jr.embedButtonText),mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with places on Google Maps",id:"googleMapsBlock.embed.caption"}),children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Google Map",id:"googleMapsBlock.placeholder"})}))}const Lr=i.memo(i.forwardRef(Ur),s.Z);var Or=n(15289);const Nr=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Miro",id:"miroBlock.embeds.button.label"}});function zr(e,t){window.__c={n:"MiroBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"miro",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Or.M,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Miro links with public access enabled",id:"miroBlock.embeds.caption"}),embedButtonText:n.formatMessage(Nr.embedButtonText),urlInputPlaceholder:"https://miro.com/app/board/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Miro",id:"miroBlock.placeholder"})}))}const Wr=i.memo(i.forwardRef(zr),s.Z);var qr=n(78810);const Hr=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Mixpanel",id:"mixpanelBlock.embeds.button.label"}});function Kr(e,t){window.__c={n:"MixpanelBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"mixpanel",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:qr.n,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Mixpanel projects",id:"mixpanelBlock.embeds.caption"}),embedButtonText:n.formatMessage(Hr.embedButtonText),urlInputPlaceholder:"https://mixpanel.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Mixpanel project",id:"mixpanelBlock.placeholder"})}))}const Gr=i.memo(i.forwardRef(Kr),s.Z);var $r=n(54321),Qr=n(4382),Yr=n(45952),Jr=n(16472),Xr=n(36067);const ea=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed a repl",id:"replitBlock.embeds.button.label"}});function ta(e,t){window.__c={n:"ReplitBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"replit",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Xr.J,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Replit.",id:"replitBlock.embeds.caption"}),embedButtonText:n.formatMessage(ea.embedButtonText),urlInputPlaceholder:"https://replit.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed a repl",id:"replitBlock.placeholder"})}))}const na=i.memo(i.forwardRef(ta),s.Z);var oa=n(31317);const ia=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Sketch",id:"sketchBlock.embeds.button.label"}});function ra(e,t){window.__c={n:"SketchBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"sketch",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:oa.j,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Sketch links with Public Link Access enabled",id:"sketchBlock.embeds.caption"}),embedButtonText:n.formatMessage(ia.embedButtonText),urlInputPlaceholder:"https://sketch.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Sketch",id:"sketchBlock.placeholder"})}))}const aa=i.memo(i.forwardRef(ra),s.Z);var sa=n(99571),la=n(51704),ca=n(15690),da=n(25777),ua=n(33709),pa=n(52771),ma=n(92120),fa=n(98165),ga=n(34859),ha=n(79131),va=n(31278),ba=n(76798),ya=n(53336);function _a(e){window.__c={n:"TabBlockMenu"};const t=(0,l.useIntl)(),n=(0,v.O7)(),o=(0,y.Fg)(),r=(0,y.yK)((e=>({baseStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},mobileStyle:xa(e),desktopStyle:Ia(e),scrollerOverlayStyle:Ca(e)})),[]),a=(0,i.useRef)(null);return(0,p.jsxs)(we.p,{allowSelectionWithin:!0,style:{...n.device.isMobile?r.mobileStyle:r.desktopStyle,...r.baseStyle},children:[(0,p.jsx)(ya.Z,{role:"tablist","aria-label":t.formatMessage(ka.tabListLabel),type:ga.Z.X,ref:a,showLeftRightOverlay:!0,rightOverlayStyle:r.scrollerOverlayStyle,children:(0,p.jsx)(ha.ZP,{disabled:e.disabled,direction:"horizontal",keys:e.tabs.map((e=>e.id)),renderKey:(t,n)=>(0,p.jsx)(Sa,{index:n,...e}),onDrop:(t,o)=>function(e){const{environment:t,parentStore:n,onDropArgs:o,newTabs:i}=e;ee.createAndCommit({userAction:"TabBlockMenu.handleTabReorder",environment:t,perform:e=>{const{key:t,endPosition:r}=o,a=n.getContentStores().find((e=>e.id===t)),s=i[r-1],l=n.getContentStores().find((e=>e.id===s));if(a){const t=n;Q.HP({parent:t.getContentStore(),after:l,current:a,transaction:e})}}})}({environment:n,newTabs:t,parentStore:e.parentStore,onDropArgs:o}),disableHorizontalEdgeScroll:!1})}),!e.disabled&&(0,p.jsx)(ki.Z,{"aria-label":t.formatMessage(ka.addTab),style:{height:28,width:28,marginTop:6,display:"flex",justifyContent:"center"},onClick:()=>{!function(e,t,n){const{performResult:o}=ee.createAndCommit({userAction:"TabBlockMenu.newTab",environment:e,perform:n=>ca.gG({environment:e,store:t,transaction:n})}),i=()=>{const e=t.getContentStores(),n=e[e.length-1];pa.$({blockStore:o,renderDelete:!0,originRect:n?ai.C.getRectFromStore(n):void 0})};n.current?n.current.scrollToRight({animate:!0,animationCallback:()=>{i()}}):i()}(n,e.parentStore,a)},children:(0,ii.R)({fill:o.mediumIconColor,width:16,height:16})})]})}function Sa(e){window.__c={n:"TabItem"};const t=(0,v.O7)(),n=(0,l.useIntl)(),{index:o,parentStore:i,selectedIndex:a,tabs:s}=e,c=s[o],d=(0,y.yK)((e=>({selectedTab:{...{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},position:"relative"},tab:{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},border:Ta(e)})),[]),u=(0,r.VK)((()=>{const e=ma.Z.getFirstSelectedDiscussionId();if(!e)return!1;const t=mi.jQ.createChildStore(c,{table:ua.qF,id:e,spaceId:c.getSpaceId()});return(0,fa.qA)(t).map((e=>e.id)).includes(c.id)}),[c]),{device:m}=t,f=a===o,g=o===s.length-1,h=0===o,b=s.length;return(0,p.jsx)(pe.Z,{store:c,analyticsName:"tab",canSelect:!0,canDrag:!1,canDropBelow:!1,canDropLeft:!h,canDropAbove:!1,canNativeDropBelow:!1,canNativeDropLeft:!h,canNativeDropRight:!g,canDropOnto:!0,dropzoneShouldNeverUseOrigin:!0,dropzoneMustBeWithinHorizontalBound:!0,canInsertAbove:!h,canDropRight:!g,canInsertBelow:!g,shouldShowHalo:!0,shouldShowDropZone:!0,shouldShowParentHalo:!0,dropzoneGap:10,onSelectableDrop:e=>{const{droppedDirection:n,droppedStores:o,duplicate:i}=e;ee.createAndCommit({userAction:"TabBlockMenu.dropOntoTab",environment:t,perform:e=>{In.LQ({environment:t,targetParentStore:c.getContentStore(),targetStore:c,droppedDirection:n,droppedStores:o,duplicate:i,transaction:e})}})},onRemove:()=>{!function(e){const{environment:t,parentStore:n,tabStore:o,index:i}=e;ee.createAndCommit({userAction:"TabBlockMenu.handleRemoveTab",environment:t,perform:e=>{const r=n.getContentStores();if(1===r.length){const t=n.getRecordStoreUIParent();"block"!==(null==t?void 0:t.table)&&"space"!==(null==t?void 0:t.table)||null==t||!t.valueIs(si.i)||Q.Od({parent:t,childToRemove:n,transaction:e})}else{const e=i<r.length-1?r[i+1]:r[i-1];ca.x2({store:n,id:e.id,currentUserId:t.currentUser.id})}Q.Od({parent:n.getContentStore(),childToRemove:o,transaction:e})}})}({environment:t,parentStore:i,tabStore:c,index:o})},children:(0,p.jsxs)("div",{style:{...f?d.selectedTab:d.tab},children:[(0,p.jsxs)(ki.Z,{role:"tab","aria-selected":f,"aria-controls":f?e.contentAriaId:void 0,"aria-posinset":o+1,"aria-setsize":b,id:f?e.selectedTabAriaId:void 0,style:{fontSize:16},onClick:()=>function(e,t,n){if(e.onChange(t),n&&!e.disabled){const n=e.parentStore.getContentStores()[t];pa.$({blockStore:n,renderDelete:!0})}}(e,o,f),disabled:e.readOnly,mobileFeedback:m.isMobile,hovered:u,isGray:!f,children:[(0,p.jsx)(wa,{store:c}),(0,p.jsx)(ba.Z,{store:c,placeholder:n.formatMessage(ka.untitledTab)})]}),f&&(0,p.jsx)("div",{style:d.border})]},o)},o)}function wa(e){window.__c={n:"TabIcon"};const{store:t}=e,{icon:n,isEmptyPage:o}=(0,r.VK)((()=>({icon:t.hasIcon()&&t.getIcon(),isEmptyPage:t.isEmptyPage()})),[t]);return n?(0,p.jsx)(va.Z,{disabled:!0,icon:n,isEmptyPage:o,size:20,style:{marginRight:6}}):null}const ka=(0,l.defineMessages)({untitledTab:{id:"tabMenuBlock.title.placeholder",defaultMessage:"Untitled"},addTab:{id:"tabMenuBlock.addTab",defaultMessage:"Add tab"},tabListLabel:{defaultMessage:"Tab block",id:"tabBlockMenu.tabListLabel"}});function Ia(e){return{display:"flex",fontSize:14,width:"100%",paddingLeft:8,paddingRight:8,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:1}}function xa(e){return{display:"flex",fontSize:16,width:"100%",paddingTop:2,paddingLeft:16,paddingRight:16,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:2,height:44,background:e.popoverBackground}}function Ca(e){return{background:e.regularDividerColor,right:28,opacity:1,marginTop:6,marginBottom:12,width:1}}function Ta(e){return{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:0,right:0}}class Ma extends ne.Z{constructor(){super(...arguments),this.contentAriaId=(0,Be.Z)(),this.selectedTabAriaId=(0,Be.Z)(),this.storeTypes={shouldShowBottomBorder:O.default.createClass(!1)},this.handleMouseMove=e=>{const t=e.currentTarget.getBoundingClientRect();this.stores.shouldShowBottomBorder.setState(Aa(t,e.clientY,this.props.disabled))},this.handleMouseEnter=e=>{const t=e.currentTarget.getBoundingClientRect();this.stores.shouldShowBottomBorder.setState(Aa(t,e.clientY,this.props.disabled))},this.handleMouseLeave=()=>{this.stores.shouldShowBottomBorder.setState(!1)}}handleCreated(){this.stores.shouldShowBottomBorder.setState(!1)}UNSAFE_willMount(e){const t=this.environment.currentUser.id;ca.nz({blockId:this.props.store.id,currentUserId:t})}renderPersisted(){return(0,p.jsxs)("div",{style:this.getStyle(),children:[(0,p.jsxs)("div",{onMouseMove:this.handleMouseMove,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,p.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:this.renderTabs()}),this.renderCurrentTab()]}),(0,p.jsx)(se.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,hideIfSidebarOrMarginCommentsVisible:!0})]})}renderCurrentTab(){const e=di.b(this.props.store);return(0,p.jsx)("div",{role:"tabpanel",id:this.contentAriaId,"aria-labelledby":this.selectedTabAriaId,style:{position:"relative"},children:(0,p.jsx)(da.Z,{loaded:e,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column"},children:this.renderLoadedContent()})})}renderLoadedContent(){const e=function(e){const t=ca.jL(e),n=e.getContentStores();return n.length>t?n[t]:n[0]}(this.props.store);return e?(0,p.jsx)(pe.Z,{store:e,analyticsName:"page_content",canSelect:!1,canDrag:!1,isListContainer:!0,style:{display:"flex",flexDirection:"column"},children:(0,p.jsx)(ue.Z,{store:e.getContentStore(),disabled:this.props.disabled,disableContent:!1,emptyPlaceholder:this.renderPlaceHolder(e)})},e.id):null}renderPlaceHolder(e){return(0,p.jsx)(ce.Z,{style:(t=this.theme,{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...N.ZD,marginTop:2}),onClick:()=>function(e,t){ee.createAndCommit({userAction:"TabBlock.handlePlaceholderClick",environment:t,perform:n=>{ca.ls({environment:t,store:e,transaction:n})}})}(e,this.environment),disabled:!this.canEdit(),children:(0,p.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Empty tab. Click or drop blocks inside.",id:"tabBlock.emptyBlock.placeholderText"})})});var t}renderTabs(){return(0,p.jsx)(_a,{contentAriaId:this.contentAriaId,selectedTabAriaId:this.selectedTabAriaId,disabled:!this.canEdit(),parentStore:this.props.store,tabs:this.props.store.getContentStores(),selectedIndex:ca.jL(this.props.store),onChange:e=>function(e,t,n){ca.a({store:t,index:e,currentUserId:n.currentUser.id})}(e,this.props.store,this.environment)})}getStyle(){return{paddingLeft:N.ZD.paddingLeft,flex:1,...this.getBottomBorderStyle(),...this.getBlockColorStyle(),...this.props.style}}getBottomBorderStyle(){return this.stores.shouldShowBottomBorder.state?{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`}:{}}}const Pa=Ma;function Aa(e,t,n){return!n&&(!!V.Z.state.isDragging||(!!U.default.state.isActive||t<=e.bottom+20&&t>=e.bottom-20))}var Ra=n(15145),Da=n(85031),Ba=n(25888),Ea=n(84210),Fa=n(18514),Za=n(88923),Va=n(78454);function ja(e,t){window.__c={n:"TableOfContentsBlock"};const n=(0,v.O7)(),o=(0,v.Fy)(),a=(0,i.useRef)(null),s=(0,c.PE)(e.store,e.disabled),d=e.disabled||!s,u=(0,r.VK)((()=>{const t=e.store.getRecordStoreUIRoot(),{mainEditorCurrentBlockStore:n}=nr.default.state;return t===n?n:Za.default.peekTarget.state===t?Za.default.peekTarget.state:void 0}),[e.store]),m=(0,r.VK)((()=>Lt.default.checkGate("toc_nested_headings")),[]),f=(0,r.VK)((()=>u?Da.Q(u.id,e.store.getRecordModel,m):[]),[u,e.store.getRecordModel,m]),g=(0,i.useMemo)((()=>f.map((t=>mi.G.createChildStore(e.store,{table:xr.iU,id:t})))),[f,e.store]),h=(0,y.yK)((e=>({root:{position:"relative"},placeholder:{...Oa,paddingTop:N.ZD.paddingTop,paddingBottom:N.ZD.paddingBottom,color:e.lightTextColor,...!d&&o.isMobile&&{marginRight:36}},actionMenuButton:{position:"absolute",top:3,right:6}})),[o.isMobile,d]),b=(0,p.jsx)("div",{style:h.placeholder,children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Add headings to create a table of contents. <linktohelpbutton>Learn more</linktohelpbutton>.",id:"tableOfContentsBlock.placeholder",values:{linktohelpbutton:e=>(0,p.jsx)(qt.Z,{href:(0,Fa.UY)("guides.tableOfContents"),external:!0,onClick:()=>Ba.Fs(n,{from:"table_of_contents_placeholder"}),children:e})}})}),_=(0,p.jsxs)(we.p,{allowSelectionWithin:!0,style:h.root,ref:a,children:[g.map((t=>(0,p.jsx)(La,{headerStore:t,index:g.indexOf(t),headerStores:g,store:e.store,navigableAncestor:u,style:e.style},t.id))),0===g.length&&b,!d&&o.isMobile&&(0,p.jsx)(Ke.Z,{style:h.actionMenuButton,tooltipContent:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"tableOfContentsBlock.mobileActionMenu.button.label"}),store:e.store,fadeIn:!1})]});return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"table_of_contents",getNode:()=>a.current,getBlockStore:()=>e.store})),[e.store]),_)}const Ua=i.memo(i.forwardRef(ja),s.Z);function La(e){window.__c={n:"TableOfContentsBlockHeader"};const t=(0,r.VK)((()=>{if(void 0!==e.navigableAncestor)return(0,Ea.ZP)({store:e.navigableAncestor,scrollToBlockId:e.headerStore.id,fullyQualified:!1,pageVisitSource:Ra.tY.LinkInPage})}),[e.headerStore.id,e.navigableAncestor]),n=(0,r.VK)((()=>Da.y({headerBlockId:e.headerStore.id,headerBlockIds:e.headerStores.map((e=>e.id)),index:e.index,getRecordModel:e.store.getRecordModel})),[e.headerStore.id,e.headerStores,e.index,e.store.getRecordModel]),o=(0,c.rv)(e.store),i=(0,y.yK)((()=>({container:o,innerHeader:{...Oa,display:"flex",alignItems:"center",marginLeft:Va.LK*n,paddingTop:2*N.ZD.paddingTop,paddingBottom:2*N.ZD.paddingBottom}})),[o,n]);return e.navigableAncestor?(0,p.jsx)("div",{style:{...i.container,...e.style},children:(0,p.jsx)(Qe.Z,{href:t,external:!1,children:(0,p.jsx)("div",{style:i.innerHeader,children:(0,p.jsx)(ba.Z,{store:e.headerStore,shouldWrap:!1,underline:!0})})})}):null}const Oa={paddingRight:N.ZD.paddingRight,paddingLeft:N.ZD.paddingLeft,fontSize:14,lineHeight:1.3};var Na=n(17970),za=n(11620),Wa=n(4859),qa=n(91791),Ha=n(91497),Ka=n(77926);const Ga=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Tweet",id:"tweetBlock.embedTweet.button.label"}});function $a(e,t){window.__c={n:"TweetBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"tweet",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:Ka.l,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with links to Tweets",id:"tweetBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Ga.embedButtonText),urlInputPlaceholder:"https://twitter.com/â€¦",children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Tweet",id:"tweetBlock.placeholder"})}))}const Qa=i.memo(i.forwardRef($a),s.Z);var Ya=n(51929);function Ja(e,t){window.__c={n:"TypeformBlock"};const n=(0,i.useRef)(null),o=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"typeform",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Ya.G,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with any public Typeform link",id:"typeformBlock.embed.caption"}),children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Typeform",id:"typeformBlock.placeholder"})}))}const Xa=i.memo(i.forwardRef(Ja),s.Z);var es=n(95097);const ts=(0,l.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the video linkâ€¦",id:"videoBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed video",id:"videoBlock.embedVideo.button.label"}});function ns(e,t){window.__c={n:"VideoBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"video",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,blockResizerStore:a,ref:o,store:e.store,iconSvg:es.H,preserveScale:!0,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"},{type:"file",videoUpload:!0}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with YouTube, Vimeo, and more",id:"videoBlock.linkInput.caption"}),embedButtonText:n.formatMessage(ts.embedButtonText),urlInputPlaceholder:n.formatMessage(ts.urlPlaceholder),children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed or upload a video",id:"videoBlock.placeholder"})}))}const os=i.memo(i.forwardRef(ns),s.Z);var is=n(98616);const rs=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.embeds.button.label"}});function as(e,t){window.__c={n:"WhimsicalBlock"};const n=(0,l.useIntl)(),o=(0,i.useRef)(null),a=(0,r.qz)(e.blockResizerStore,d.Z);return(0,c.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"whimsical",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,p.jsx)(u.ZP,{...e,ref:o,store:e.store,iconSvg:is.A,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Works with Whimsical links with Public Link Access enabled",id:"whimsicalBlock.embeds.caption"}),embedButtonText:n.formatMessage(rs.embedButtonText),urlInputPlaceholder:"https://whimsical.com/â€¦",blockResizerStore:a,children:(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.placeholder"})}))}const ss=i.memo(i.forwardRef(as),s.Z);let ls;function cs(e){const t=e.getType();if(t)return"collection_view"===t&&e.recordStoreParentDiffersFromPersistedParent()?Sn.Z:(ls||(ls={text:Na.Z,image:$i,video:os,bookmark:st,drive:Fo,audio:Re,tweet:Qa,gist:Li,maps:Lr,framer:Zi,invision:Xi,file:Di.Z,page:Qr.Z,to_do:za.Z,toggle:Wa.ZP,bulleted_list:pt.Z,numbered_list:$r.Z,code:mn,factory:Mi,button:mt.Z,divider:bo,column_list:no,copy_indicator:lo,embed:u.ZP,breadcrumb:ut,equation:Qo,header:Oi.Z,sub_header:sa.Z,sub_sub_header:la.Z,quote:Jr.ZP,collection_view:_n.DZ,collection_view_page:Sn.Z,link_to_page:Br,link_to_collection:kr,figma:Ri,loom:Zr,codepen:yn,typeform:Xa,column:Fn,pdf:Yr.Z,callout:ft.Z,table_of_contents:Ua,whimsical:ss,miro:Wr,abstract:g,sketch:aa,excalidraw:ti,alias:Te.Z,transclusion_container:qa.Z,transclusion_reference:Ha.Z,replit:na,external_object_instance:ni.Z,table:o.Wv,table_row:o.fZ,tab:Pa,hex:qi,deepnote:mo,mixpanel:Gr,external_object_instance_page:ni.Z,ai_block:Ce,drawing:So,personal_home_page:void 0}),ls[t])}},59557:(e,t,n)=>{n.d(t,{N:()=>d});var o=n(67294),i=n(480),r=n(86628),a=n(97880),s=n(82530),l=n(37181),c=n(80444);function d(e){const{blockStore:t}=e,n=(0,i.O7)(),d=(0,r.VK)((()=>c.default.state.currentUserSettingsStore),[]),u=(0,r.VK)((()=>{var e;return(0,a.$K)(null===(e=t.getModel())||void 0===e?void 0:e.getProperty("title"))}),[t]),p=(0,o.useCallback)((()=>{d&&s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{dismissed_factory_button_deprecation_banner:!0}})}})}),[d,n]),m=(0,o.useCallback)((()=>{if(!d)return;d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue()||s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{seen_factory_button_deprecation_badge:!0}})}})}),[d,n]);return{showFactoryButtonDeprecationBadge:(0,r.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue())),[d,u]),showFactoryButtonDeprecationBanner:(0,r.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("dismissed_factory_button_deprecation_banner").getValue())),[d,u]),handleDismissFactoryButtonMigrationBanner:p,setHasSeenFactoryButtonDeprecationBadge:m}}},29551:(e,t,n)=>{n.d(t,{Ht:()=>c,Vg:()=>d,gq:()=>l,xk:()=>a});n(67294);var o=n(26136),i=n(85893);function r(e){const{style:t,row:n,column:o,reverse:i,inline:r,...a}=e,s={display:r?"inline-flex":"flex"};return o?s.flexDirection=i?"column-reverse":"column":n?s.flexDirection=i?"row-reverse":"row":i&&(s.flexDirection="row-reverse"),Object.assign(s,a,t)}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r({...e,row:!0})}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r({...e,column:!0})}function l(e){const{children:t,className:n,...o}=e;return(0,i.jsx)("div",{className:n,style:a(o),children:t})}function c(e){const{children:t,className:n,...o}=e;return(0,i.jsx)("div",{className:n,style:s(o),children:t})}function d(e){let{environment:t,pageBlockStore:n,pathToBlockId:i}=e;const r=new o.ST({environment:t,pointer:n.pointer,path:i}).getValue();return new o.G(t,{table:"block",spaceId:n.getSpaceId(),id:r})}},5595:(e,t,n)=>{n.d(t,{_Y:()=>i,mD:()=>o,rp:()=>r});const o=240,i=80,r=80},17377:(e,t,n)=>{n.d(t,{Z:()=>S});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(49271),l=n(9291),c=n(29373),d=n(82530),u=n(52315),p=n(35328),m=n(45131),f=n(64921),g=n(25777),h=n(55217),v=n(78454),b=n(4859),y=n(5210),_=n(85893);function S(e){window.__c={n:"FormatToggleable"};const t=(0,i.O7)(),n=(0,a.Fg)(),S=(0,o.useRef)(!0);(0,o.useLayoutEffect)((()=>{S.current&&(S.current=!1,c.nz({blockId:e.store.id,currentUserId:t.currentUser.id}),e.store.isDefaultRecordCache()&&c.LO(t,e.store.pointer))}));const w=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),k=(0,r.VK)((()=>m.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),I=(0,r.VK)((()=>!e.store.hasContent()),[e.store]),x=(0,o.useId)(),C=(0,o.useId)(),T=(0,r.VK)((()=>u.b(e.store)||!e.store.isDefaultRecordCache()),[e.store]),M=(0,o.useCallback)((()=>{p.th(t,e.store,e.hideContent)}),[t,e.hideContent,e.store]),P=(0,r.VK)((()=>p.fn(e.store)),[e.store]),A=(0,r.VK)((()=>{var t;return null===(t=e.store.getFormat())||void 0===t?void 0:t.toggleable}),[e.store]),R=(0,o.useCallback)((()=>{d.createAndCommit({userAction:"FormatToggleable.handlePlaceholderClick",environment:t,perform:n=>{c.ls({environment:t,store:e.store,transaction:n})}})}),[t,e.store]),D=(0,_.jsx)(f.Z,{style:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:n.lightTextColor,...s.ZD,marginTop:2},onClick:R,disabled:e.disabled,children:(0,_.jsx)("span",{style:{color:n.lightTextColor},children:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlockFormat.emptyBlock.placeholderText"})})}),B=(0,_.jsx)(y.Z,{"aria-describedby":x,"aria-controls":C,isSidebar:!1,open:k,fill:!I,onClick:M,tapArea:t.device.isMobile?{size:30}:void 0}),E=k?(0,_.jsx)(g.Z,{id:C,loaded:T,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:(0,b.kA)(),style:(0,b.J9)(),children:(0,_.jsx)(h.Z,{store:w,emptyPlaceholder:P?D:void 0,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})}):(0,_.jsx)(h.Z,{store:w,disabled:e.disabled,disableContent:!0});return P?(0,_.jsxs)(v.ZP,{style:{paddingLeft:s.ZD.paddingLeft},left:B,leftStyle:{paddingRight:2,...e.toggleStyle},children:[(0,_.jsx)("div",{id:x,style:e.childrenStyleWhenToggleable,children:e.children}),E]}):A?(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,_.jsx)("div",{style:e.childrenStyleWhenToggleable,children:e.children}),E]}):(0,_.jsx)(_.Fragment,{children:e.children})}},26198:(e,t,n)=>{n.d(t,{Lr:()=>a,jo:()=>l,uf:()=>r});var o=n(67294),i=n(67381);const r={track(e,t){t(!0)},untrack(e){}},a=(0,i.Q)({modernContextDefaultValue:r,displayName:"IFrameManagerContext",legacyContextKey:"iFrameManagerContext"}),s=(a.legacyPropTypes,a.context);function l(){const e=(0,o.useContext)(s),[t,n]=(0,o.useState)(!1),i=(0,o.useRef)(null);return[(0,o.useCallback)((t=>{i.current&&(e.untrack(i.current),i.current=null),t&&(i.current=t,e.track(t,n))}),[e]),t]}},66213:(e,t,n)=>{n.d(t,{LF:()=>i,ZO:()=>a,wK:()=>r});const o=(0,n(67381).Q)({modernContextDefaultValue:void 0,displayName:"OverrideLinkClickContext",legacyContextKey:"overrideLinkClick"}),i=o.Provider,r=o.legacyPropTypes,a=o.context},11368:(e,t,n)=>{n.d(t,{I3:()=>r,Ue:()=>a,zR:()=>i});const o=(0,n(67381).Q)({displayName:"ScrollerContext",legacyContextKey:"scrollerContext",modernContextDefaultValue:void 0}),i=o.Provider,r=o.legacyPropTypes,a=o.context},84064:(e,t,n)=>{n.d(t,{Tf:()=>s,aT:()=>a,ld:()=>l});const o={selectableContainer:void 0,closestSelectable:void 0},i="selectable",r=(0,n(67381).Q)({modernContextDefaultValue:o,displayName:i,legacyContextKey:i}),a=r.context,s=r.legacyPropTypes,l=r.Provider},78791:(e,t,n)=>{n.d(t,{Cf:()=>f,Wc:()=>g,tE:()=>m});var o=n(41432),i=n(15095),r=n(59730),a=n(70203),s=n(82798),l=n(993),c=n(82530),d=n(65598),u=n(73959),p=n(65273);function m(e){const{transaction:t,targetStore:n,block:o}=e,i=(0,s.TO)(o.getTextSliceTree()),a=(0,u.sQ)(n);if(!a||!p.Ls({store:n,blockStore:a}))throw new r.p8("Previous block should exist and use CRDT");const l=(0,s.TO)(a.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal(),d=i.getOperationsForSplitForMerge();(0,s.T)(0===d.textSliceTreesToMove.length,"Root nodes should have no siblings to move"),c.applyCrdtTextOperation({transaction:t,store:o,operation:{command:"splitText",pointer:o.pointer,path:[],args:d.splitOp},invertedOperation:void 0});const m=d.splitOp.textInstanceId,f=d.splitOp.id;c.applyCrdtTextOperation({transaction:t,store:o,operation:{command:"moveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:m,textSliceStartItemId:f,targetBlockId:a.id,targetTextInstanceId:l.getTextSlice().textInstanceId,targetTextSliceEndItemId:l.getTextSlice().getEndItem().id,isMerge:!0}},invertedOperation:{command:"invertedMoveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:m,textSliceStartItemId:f,targetTextInstanceId:m,targetTextSliceEndItemId:d.splitOp.id}}})}function f(e){const{environment:t,transaction:n,multiSelection:i,removedBlocks:r,movedBlocks:a}=e,c=i.start.store;function u(e){if(a.has(e))return;const r=e.getModel();if(null==r||!r.isType(o.wL))return;const d=e.getBlockTitleStore();(0,s.T)(p.FX(d)),d!==i.end.store&&(l.pe({environment:t,transaction:n,selection:{startIndex:0,endIndex:1/0},store:d}),m({transaction:n,block:e,targetStore:c}))}(0,s.T)(p.FX(c));for(const o of r){u(o);for(const e of(0,d.MI)({blockStore:o,traverseTransclusionReferences:!1}))u(e)}}function g(e){const{sourceBlockStore:t,targetBlockStore:n,splitAtGraphemeIndex:o,transaction:r,moveIntoNewBlock:l}=e;(0,s.T)(t.useCrdt()&&n.useCrdt());const d=t.getBlockTitleStore().getValue(),u=new i.W3(a.eeV(d)).getStringStartIndex(o),p=(0,s.TO)(t.getTextSliceTree()).getOperationsForSplitAtIndex(u);!function(e){const{blockStore:t,splitInfo:n,transaction:o}=e,i=n.textSliceTreesToMove,r="splitWithinNode"===n.type?n.textSliceTreeToSplit:n.newTextSliceTree;for(const a of i){const e=t.id,n=r.getTextSlice().textInstanceId,i=r.getTextSlice().getEndItem().id;c.applyCrdtTextOperation({transaction:o,store:t,operation:{command:"moveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:a.getTextSlice().textInstanceId,textSliceStartItemId:a.getTextSlice().getStartItem().id,targetBlockId:e,targetTextInstanceId:n,targetTextSliceEndItemId:i}},invertedOperation:void 0})}}({blockStore:t,splitInfo:p,transaction:r}),l?function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:i}=e;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree,r=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id,s=o.previousTextSliceTree.getTextSlice();c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"moveTextSliceIntoBlock",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetBlockId:n.id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetTextInstanceId:s.textInstanceId,targetTextSliceEndItemId:s.getEndItem().id}}})}else{const e=o.splitOp,{textInstanceId:r}=e;c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"splitTextIntoBlock",pointer:t.pointer,path:[],args:{...e,targetBlockId:n.id}},invertedOperation:{command:"invertedMoveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:r,textSliceStartItemId:e.id,targetTextInstanceId:r,targetTextSliceEndItemId:e.id}}})}}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:r}):function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:i}=e;let r,a,l,d;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree;r=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id;const t=o.previousTextSliceTree.getTextSlice();l=t.textInstanceId,d=t.getEndItem().id}else c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"splitText",pointer:t.pointer,path:[],args:o.splitOp},invertedOperation:void 0}),r=o.splitOp.textInstanceId,a=o.splitOp.id,l=o.splitOp.textInstanceId,d=o.splitOp.id;const u=(0,s.TO)(n.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal();c.applyCrdtTextOperation({transaction:i,store:t,operation:{command:"moveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetBlockId:n.id,targetTextInstanceId:u.getTextSlice().textInstanceId,targetTextSliceEndItemId:u.getTextSlice().getEndItem().id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:r,textSliceStartItemId:a,targetTextInstanceId:l,targetTextSliceEndItemId:d}}})}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:r})}},65273:(e,t,n)=>{n.d(t,{PR:()=>g,SL:()=>h,FX:()=>u,Ls:()=>p,iG:()=>m,be:()=>f});var o=n(19056),i=n(59730),r=n(21202),a=n(73959),s=n(77080),l=n(26136),c=n(82798);class d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.value=e,this.textInstanceId=t;const n=d.overrides.get(t);n&&e>n&&this.updateOverride()}get(){return d.overrides.get(this.textInstanceId)??this.value}set(e){const t=this.get();(0,c.T)(e>=t),this.value=e,this.updateOverride()}updateOverride(){d.overrides.set(this.textInstanceId,this.value)}static TEST_ONLY__clearOverrides(){this.overrides.clear()}}function u(e){if(!e.isTable(r.iU))return!1;const t=(0,a.sQ)(e);return!!t&&(t.useCrdt()&&t.getBlockTitleStore()===e)}function p(e){const{store:t,blockStore:n}=e;return n.useCrdt()&&n.getBlockTitleStore()===t}function m(e,t){const n=e.useCrdt(),o=t.some((e=>e.useCrdt()));return n&&!o||!n&&o}function f(e){const{parentStore:t,childStore:n}=e,o=t.getRecordStoreAtRootPath(),r=n.getRecordStoreAtRootPath();if(o instanceof l.G&&r instanceof l.G&&m(o,[r]))throw new i.p8("A CRDT block cannot be parented to a non-CRDT block or vice versa!")}function g(e){const t={};for(const[n,i]of Object.entries(e))t[n]=new o.Z(new d(i,n));return t}function h(e,t){if("click"!==e.type)return!1;if(!s.default.checkGate("enable_text_crdt_client"))return!1;const n=s.default.checkGate("enable_default_create_crdt_page")&&s.default.getConfigKey("default_create_crdt_page_config",t);return n&&!e.altKey||!n&&e.altKey}d.overrides=new Map},95645:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(83355),i=n(13991),r=n(8848),a=n(82990),s=n(92650),l=n(67669),c=n(65598),d=n(58202),u=n(26136),p=n(99757);class m extends o.Z{constructor(){super(...arguments),this.renderedType="block",this.getBlockStore=()=>this.props.store,this.canEditComputedStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(p.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEdit()})),this.marginCommentsVisible=this.createComputedStore((()=>(0,s.fg)(this.environment,this.props.store))),this.rootStorePageFont=this.createComputedStore((()=>{const e=this.props.store.getRecordStoreUIRoot();if(!(e instanceof u.G))return;const t=e.getFormatStore().getKeyStore("page_font").getValue();return a.Z.getHeaderFontFamily({pageFont:t,locale:i.SP})}))}get registries(){return[d.R]}canEdit(){return this.canEditComputedStore.state}canEditCollection(){if(this.props.disabled)return!1;if(p.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEditCollection()}canComment(){return!this.props.disabled&&(!p.n.state&&this.props.store.canComment())}canAdmin(){return!this.props.disabled&&(!p.n.state&&this.props.store.canAdmin())}canView(){const{store:e}=this.props;return e.canRead()}isRootOrDirectChild(){return this.props.store.isRootOrDirectChild()}renderComponent(){const{store:e}=this.props;if(e)return e?(0,c.SJ)(e)?void 0:this.renderPersisted():void 0}renderPersisted(){}getBlockColorStyle(){const e=this.props.store.getFormat().block_color||"default";return(0,r.fi)(e,this.theme)}}m.displayName="Block";const f=m},24098:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(86628),i=n(26344);function r(e){let{capture:t,render:n}=e;window.__c={n:"IgnoreClickArea"};const r=(0,i.Z)(t);return(0,o.VK)((()=>n(r)),[r,n])}},24039:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(67294),i=n(1302),r=n(65686);function a(e){let{children:t,...n}=e;return window.__c={n:"IgnoreContentScrollArea"},function(e){let{capture:t,preventType:n}=e;(0,o.useEffect)((()=>{if(t){const e={preventType:n};return i.default.afterNextFlush((()=>{r.Z.state.capturingAreas.add(e),r.Z.emit()})),()=>{i.default.afterNextFlush((()=>{r.Z.state.capturingAreas.delete(e),r.Z.emit()}))}}}),[t,n])}(n),t}},75179:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(86628),i=n(67294);function r(e){return e instanceof HTMLElement&&("true"===e.contentEditable||"input"===e.tagName.toLowerCase())}function a(e){let{capture:t,render:n}=e;window.__c={n:"KeepFocusArea"};const a=function(e){return(0,i.useMemo)((()=>({onMouseDown:t=>{if(e){if(r(t.target))return;r(document.activeElement)&&t.preventDefault()}}})),[e])}(t);return(0,o.VK)((()=>n(a)),[a,n])}},23586:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(83355),i=n(72126),r=n(85844),a=n(72087);class s extends o.Z{constructor(){super(...arguments),this.debounce=void 0,this.throttle=void 0,this.interval=void 0,this.browserInterval=void 0,this.requestCounter=0,this.storeTypes={requestStore:a.Z},this.handlePageVisibilityChange=()=>{r.Z.state.isVisible?this.interval||this.setRequestInterval():this.clearRequestInterval()},this.performRequest=async()=>new Promise(((e,t)=>{const{requestStore:n}=this.stores,{performRequest:o}=this.props,{request:i}=n.state;this.requestCounter++;const r=this.requestCounter;this.stores.requestStore.setState({...this.stores.requestStore.state,ready:!1,loading:!0}),o(i).then((t=>{this.requestCounter===r&&n.setState({...n.state,error:void 0,result:t,ready:!0,loading:!1}),e()})).catch((e=>{console.error(e),this.requestCounter===r&&n.setState({...n.state,error:e,result:void 0,ready:!0,loading:!1}),t(e)}))})),this.performRequestDebouncedWrapped=()=>{this.stores.requestStore.setState({...this.stores.requestStore.state,ready:!1,loading:!0}),this.performRequestDebounced()},this.performRequestDebounced=this.performRequest}async fetch(){return this.performRequest()}UNSAFE_willMount(e){super.UNSAFE_willMount(e),r.Z.addListener(this.handlePageVisibilityChange)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{requestStore:t}=this.stores,{request:n,debounce:o,throttle:r,interval:a}=e;o!==this.debounce&&(this.debounce=o,this.performRequestDebounced=o?i.Ds(this.performRequest,o):this.performRequest),r!==this.throttle&&(this.throttle=r,this.performRequestDebounced=r?i.P2(this.performRequest,r):this.performRequest),a!==this.interval&&(this.interval=a,this.clearRequestInterval(),this.setRequestInterval()),i.Xy(n,t.state.request)||(t.setState({...t.state,request:n}),0!==this.requestCounter||e.performFirstRequestAsync?this.performRequestDebouncedWrapped():this.performRequest()),t.refresh=this.performRequest}willUnmount(){super.willUnmount(),r.Z.removeListener(this.handlePageVisibilityChange),this.clearRequestInterval()}shouldComponentUpdate(e){return!0}renderComponent(){const{requestStore:e}=this.stores,{render:t}=this.props,{error:n,result:o,ready:i}=e.state;return this.handlePageVisibilityChange(),t(n,o,i)}clearRequestInterval(){this.browserInterval&&(clearInterval(this.browserInterval),this.browserInterval=null)}setRequestInterval(){this.props.interval&&(this.browserInterval=setInterval(this.performRequest,this.props.interval))}}s.displayName="Request";const l=s},12457:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(83355),i=n(49085);class r extends o.Z{constructor(){super(...arguments),this.storeTypes={shown:i.default.createClass(!1)},this.showTimerId=void 0,this.hideTimerId=void 0}didMountOrUpdate(){this.props.show?(this.hideTimerId&&clearTimeout(this.hideTimerId),this.hideTimerId=void 0):(this.showTimerId&&clearTimeout(this.showTimerId),this.showTimerId=void 0),!this.props.show||this.stores.shown.state||this.showTimerId?this.props.show||!this.stores.shown.state||this.hideTimerId||(0===this.props.showHold?this.stores.shown.setState(!1):this.setupHideTimer()):0===this.props.showDelay?(this.stores.shown.setState(!0),0!==this.props.showHold&&this.setupHideTimer()):this.showTimerId=window.setTimeout((()=>{this.showTimerId=void 0,this.stores.shown.setState(!0),0!==this.props.showHold&&this.setupHideTimer()}),this.props.showDelay)}renderComponent(){return this.props.render(this.stores.shown.state)}setupHideTimer(){this.hideTimerId=window.setTimeout((()=>{this.hideTimerId=void 0,!this.props.show&&this.stores.shown.state&&this.stores.shown.setState(!1)}),this.props.showHold)}}r.displayName="Throttled";const a=r},28651:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{mouseEntered:!1,mousePressed:!1}}enter(){this.setState({...this.state,mouseEntered:!0})}exit(){this.setState({...this.state,mouseEntered:!1})}}const r=i},11059:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(480),i=n(86628),r=n(22377),a=n(60682),s=n(24990),l=n(85893);const c=function(e){let{char:t,size:n,sprite:c}=e;window.__c={n:"Emoji"};const d=(0,o.O7)(),u=(0,i.VK)((()=>c||(0,a.e_)(d)),[d,c]),p=(0,i.VK)((()=>s.Z.state),[]);return(0,l.jsx)(r.Z,{char:t,size:n,type:u,emojiData:p})}},72187:(e,t,n)=>{n.d(t,{$P:()=>b,FZ:()=>f,II:()=>a,IQ:()=>o,Nm:()=>r,PS:()=>m,T8:()=>l,VJ:()=>v,WB:()=>c,fG:()=>h,jo:()=>u,kX:()=>p,mz:()=>d,pq:()=>s,qJ:()=>y,tg:()=>i,vP:()=>g});const o=12,i=9,r=2,a=12,s=16,l=32,c=24,d=44,u=32,p=356,m=12,f=l*o+2*m,g=9,h=f,v=270,b=10,y=2},60682:(e,t,n)=>{n.d(t,{e_:()=>a,kw:()=>s,sg:()=>l});var o=n(480),i=n(86628),r=n(80444);function a(e){const{device:t}=e;return t.isAndroid&&t.browserVersion.startsWith("73.")&&t.browserName.startsWith("Chrome")||t.isAndroid?"google":t.isWindows||t.isLinux?"twitter":"raw"}function s(){const e=(0,o.O7)();return(0,i.VK)((()=>a(e)),[e])}function l(){var e;return null===(e=r.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}},24990:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(24502);class r extends o.default{getInitialState(){return{positionalEmojiData:{},emojiByName:{},emojiByCategory:{}}}async waitUntilLoaded(){await(0,i.M)()}}const a=new r},69783:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},21830:(e,t,n)=>{n.d(t,{XH:()=>y,pz:()=>h,qv:()=>g,vZ:()=>p,zp:()=>f});n(21703);var o=n(37599),i=n(92595),r=n(7406),a=n(68626),s=n(91155),l=n(29477),c=n(63143),d=n(9291),u=n(33929);const p="NotionTransactionTimeout",m=(0,d.defineMessages)({ReloadAllTabs:{defaultMessage:"Try closing and re-opening all Notion tabs or windows. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.reloadAllTabs"},ReloadThisTab:{defaultMessage:"Try reloading Notion. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.reloadThisTab"},AppProfileCorrupted:{defaultMessage:"Notion's local storage may be damaged. See (?) > Help & documentation > Reset Notion. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.helpAndSupportPrompt"},FirefoxProfileCorrupted:{defaultMessage:"Your Firefox profile may be damaged. Visit https://firefox-storage-test.glitch.me/ to diagnose. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.firefoxSettingsDamaged"},ChromeProfileCorrupted:{defaultMessage:"Your Chrome profile may be damaged. If you changed any chrome://flags then please reset them, then restart your browser. If issues persist, try making a new Chrome user. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.chromeSettingsDamaged"},ChromeIndexedDBBucketError:{defaultMessage:"Your Chrome profile may be damaged. For a more consistent experience download the Notion desktop app: https://notion.so/desktop",id:"localDatabase.errorFixes.chromeUpgradeCorruptedSettings"},noDiskSpace:{defaultMessage:"No disk space remaining. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemaining"},noDiskSpaceBrowserLimit:{defaultMessage:"No disk space remaining. Your browser settings may restrict the storage Notion can use. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemainingBrowserLimit"}});function f(e){return e}function g(e){return Promise.all(e)}class h{constructor(e,t,n,o){this.databaseName=void 0,this.databaseVersion=void 0,this.debugLogger=new a.BatchedLogger({from:"IndexedDBWrapper",type:"BulkDebug",level:"info",maxLength:100,logToConsole:false}),this.latestTransactionId=0,this.openDbCallbacks=void 0,this.db=void 0,this.getDBPromise=void 0,this.environment=e,this.databaseName=t,this.databaseVersion=n,this.openDbCallbacks=o}async reset(){try{return await(0,o.Lj)(this.databaseName),{value:void 0}}catch(e){return{error:v({environment:this.environment,error:(0,r.tg)(e),details:`Failed to reset database ${this.databaseName}`,closed:!1,aborted:!1})}}finally{this.teardown()}}async startTransaction(e,t){const n="startTransaction";let o,i=0;const r=`${e.name}.${this.latestTransactionId++}`;do{try{const s=`${r} attempt #${i+1}`;if(this.debugLogInfo(n,`${s} starting`),o=await this.startTransactionAttempt({...e,name:r},t),!o.error){this.debugLogInfo(n,`${s} succeeded`);break}const c=`${s} errored, type=${o.error.type}`;if(!o.error.closed){this.debugLogInfo(n,`${c}, closed=false`);break}if(this.debugLogInfo(n,`${c}, closed=true`),this.db)try{this.db.close()}catch(a){this.debugLogInfo(n,`db.close() threw ${a}`)}if(this.teardown(),4===i)break;await l.Vs(250)}catch(a){return{error:a}}i++}while(i<5);return o}async startTransactionAttempt(e,t){const{storeNames:n,name:o,mode:i,timeoutMs:l}=e,c=`${o} failed`,d="startTransactionAttempt",u=await this.getDB();if(u.error)return u;const p=u.value,m=[];let f;try{f=p.transaction(n,i);const e=Date.now(),t=window.setTimeout((()=>{const t=Date.now()-e,n=`${o} has not completed after ${t} ms, which may prevent other transactions from running.`;this.debugLogInfo(d,n),a.log({from:"IndexedDBWrapper",type:"LongRunningTransactionWarning",level:"warning",data:{message:n,miscDataToConvertToString:{transactionLog:m}}})}),h.longRunningTimeoutMs);f.addEventListener("complete",(function(){window.clearTimeout(t)}));const r=e=>{e.stopPropagation(),window.clearTimeout(t)};f.addEventListener("error",r),f.addEventListener("abort",r)}catch(b){const e=(0,r.tg)(b);return{error:v({environment:this.environment,details:`Failed to create ${i} transaction on ${this.databaseName}.${n}`,error:e,aborted:!0,closed:"InvalidStateError"===e.name})}}const g=await this.runTransaction(f,t,o,l,(e=>{a.pushWithMaxLength(m,e,100)}));if("error"in g||g.abort){this.debugLogInfo(d,`${o} command returned failed/aborted status`);try{f.abort()}catch(y){this.debugLogInfo(d,`transaction.abort() threw ${y}`)}return f.done.catch((e=>{e&&a.log({from:"IndexedDBWrapper",type:"TransactionFailure",level:"error",error:(0,s.Ui)(v({environment:this.environment,details:c,error:e,aborted:!0,closed:!1}))})})),g}if(this.debugLogInfo(d,`${o} command returned successful status`),"readwrite"===i)try{await f.done}catch(y){return{error:v({environment:this.environment,error:(0,r.tg)(y),details:`In await transaction.done: ${c}`,aborted:null===y,closed:!1})}}else f.done.catch((e=>{a.log({from:"IndexedDBWrapper",type:"ReadOnlyTransactonFailureIgnored",level:"error",error:(0,s.Ui)(v({environment:this.environment,error:e,details:c,aborted:null===e,closed:!1}))})}));return{value:g.value}}freezeListener(){Boolean(this.db)&&(this.debugLogInfo("freezeListener"),a.log({level:"warning",from:"IndexedDBWrapper",type:"document.freeze",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}))}teardown(){this.debugLogInfo("teardown"),this.db=void 0,this.getDBPromise=void 0,document.removeEventListener("freeze",this.freezeListener)}debugLogInfo(e,t){this.debugLogger.log({from:"IndexedDBWrapper",level:"info",type:e,data:{message:t}})}async initDB(){try{this.debugLogInfo("initDB","Starting openDB()");const e=await(0,o.X3)(this.databaseName,this.databaseVersion,this.openDbCallbacks);return this.debugLogInfo("initDB","Completed openDB()"),document.addEventListener("freeze",this.freezeListener),e.addEventListener("close",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onclose",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(b(e))}),this.teardown()})),e.addEventListener("abort",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onabort",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}})})),e.addEventListener("error",(e=>{a.log({level:"error",from:"IndexedDBWrapper",type:"db.onerror",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(b(e))})})),e.addEventListener("versionchange",(()=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onversionchange",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}),e.close(),this.teardown()})),{value:e}}catch(e){return{error:v({environment:this.environment,details:"Unable to initialize database",error:(0,r.tg)(e),aborted:!1,closed:!1})}}}async getDB(){let e=this.db;if(!e){this.getDBPromise||(this.getDBPromise=this.initDB().then((e=>(e.error?this.teardown():(this.db=e.value,this.getDBPromise=void 0),e)),(e=>(this.teardown(),{error:{type:"InitDBException",message:"An unexpected error occurred trying to create the database.",details:"Exception in initDB",error:e,closed:!1,aborted:!1}}))));const t=await this.getDBPromise;if(t&&t.error)return t;e=t.value}return{value:e}}async runTransaction(e,t,n,o,i){try{const r=Date.now(),a=t(e,(e=>{this.debugLogInfo("runTransaction",`${n} command: ${e}`),i(e)}));if(void 0!==o&&o>=0){const e=await l.aM(a,o);if(e.timeout){const e=Date.now()-r,t=new Error(`Timeout after ${e}ms: exceeded limit ${o}ms by ${e-o}ms`);throw t.name=p,this.debugLogInfo("runTransaction",`${n} ${t.name}: ${t.message}`),this.debugLogger.flush(),t}return e.result}i("Awaiting commandResultPromise.");const s=await a;return i("Done awaiting commandResultPromise."),s}catch(a){return{error:v({environment:this.environment,error:(0,r.tg)(a),details:`In runTransaction catch: ${n} failed`,closed:!1,aborted:!1})}}}}function v(e){const{environment:t,error:n,details:o,closed:i,aborted:r}=e;if(n){if(n.name===p)return{type:p,details:o,message:`Storage operation did not complete. ${u.default.formatMessage(m.ReloadAllTabs)}`,error:n,closed:!1,aborted:!1};if("TimeoutError"===n.name&&"Transaction timed out due to inactivity."===n.message)return{type:"TransactionTimeout",details:o,message:`IndexedDB access attempt timed out. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("VersionError"===n.name)return{type:"OutdatedSchemaVersion",details:o,message:`This tab is running an outdated version of Notion. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("UnknownError"===n.name&&"Internal error opening backing store for indexedDB.open."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:`Cannot open IndexedDB. ${t.device.isNative?u.default.formatMessage(m.AppProfileCorrupted):u.default.formatMessage(m.ChromeProfileCorrupted)}`,error:n,closed:i,aborted:r};if(t.device.isBrowser&&"UnknownError"===n.name&&"Internal error retrieving bucket data directory."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:u.default.formatMessage(m.ChromeIndexedDBBucketError),error:n,closed:i,aborted:r};if("SecurityError"===n.name&&"IDBFactory.open() called in an invalid security context"===n.message)return{type:"SafariIframeSecurityError",details:o,message:"Cannot access IndexedDB in an iframe in your browser. Try opening Notion in a new window or use a different browser.",error:n,closed:i,aborted:r};if("UnknownError"===n.name&&"Connection to Indexed Database server lost. Refresh the page to try again"===n.message)return{type:"SafariIndexedDatabaseServerLost",details:o,message:`Cannot access IndexedDB due to a bug in Safari/WebKit. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:i,aborted:r};if("InvalidStateError"===n.name&&"A mutation operation was attempted on a database that did not allow mutations."===n.message)return{type:"FirefoxPrivateBrowsing",details:o,message:"Firefox does not allow IndexedDB in Private Browsing. Try opening Notion in a normal window.",error:n,closed:i,aborted:r};if("NotFoundError"===n.name&&"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened."===n.message)return{type:"FirefoxObjectStoreNotFound",details:o,message:`An IndexedDB object store does not exist. ${u.default.formatMessage(m.ReloadAllTabs)} ${u.default.formatMessage(m.FirefoxProfileCorrupted)}`,error:n,closed:!0,aborted:r};if("QuotaExceededError"===n.name){let e=u.default.formatMessage(m.noDiskSpace);return t.device.isBrowser&&(e=u.default.formatMessage(m.noDiskSpaceBrowserLimit)),{type:"QuotaFull",details:o,message:e,error:n,closed:i,aborted:r}}if(window.navigator.userAgent.includes("WindowsWechat")&&"AbortError"===n.name&&"Version change transaction was aborted in upgradeneeded event handler."===n.message)return{type:"UnsupportedWechat",details:o,message:"This device or application is unsupported.",error:n,closed:i,aborted:r}}return{type:"UnknownIndexedDBError",details:o,message:`An unknown IndexedDB error occurred. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n||new Error("createIndexedDBError: error was falsy"),closed:i,aborted:r}}function b(e){if(e&&e.target&&"error"in e.target){const t=e.target.error;if(!t)return;return`${t.name}: ${t.message}`}}function y(e,t){if(e.stack)return e;try{const n=new Error(`${e.message} (${t})`);throw n.name=e.name,n}catch(n){return e.stack=(0,r.tg)(n).stack,e}}h.longRunningTimeoutMs=5*c.hM,(0,i.exposeDebugValue)("idbUnwrap",o.Wg)},3932:(e,t,n)=>{n.d(t,{Y:()=>r});var o=n(4615),i=n(45953);class r{constructor(e){this.id=(0,o.ZP)(),this.spaceId=void 0,this.userId=void 0,this.committed=!1,this.isLocal=!1,this.useSudoMode=void 0,this.deadlockWarningTimeout=void 0,this.operations=[],this.stores=[],this.initialRecordMap=i.PF.create(),this.invertedOperations=[],this.postPerformAssertions=[],this.preEnqueueActions=[],this.postEnqueueActions=[],this.postSubmitCallbacks=[],this.postCancelCallbacks=[],this.userAction=void 0,this.userFlow=void 0;const{spaceId:t,userId:n,deadlockTimeoutMs:r,onDeadlockWarning:a}=e;t&&n&&(this.spaceId=t,this.userId=n),a&&(this.deadlockWarningTimeout=window.setTimeout(a,r))}isEmpty(){return 0===this.operations.length}annotateWithUserAction(e){this.userAction=e}getUserActionForAnalyticsPurposesOnly(){return this.userAction}annotateWithUserFlow(e){this.userFlow=e}getUserFlowForAnalyticsPurposesOnly(){return this.userFlow}cancelDeadlockWarning(){void 0!==this.deadlockWarningTimeout&&(window.clearTimeout(this.deadlockWarningTimeout),this.deadlockWarningTimeout=void 0)}done(e){this.cancelDeadlockWarning();for(const t of this.postSubmitCallbacks)t(e)}}},2414:(e,t,n)=>{n.d(t,{h:()=>i});var o=n(29477);class i{constructor(e){this.SCALE=1.5,this.MAX=15,this.waitable=new o.a6,this.failures=0,this.observer=e}getDelay(e){return Math.min(this.MAX,Math.pow(this.SCALE,e))}reset(){var e;this.waitable.trigger(),this.waitable=new o.a6,this.failures=0,null===(e=this.observer)||void 0===e||e.onReset()}async backOffOnFailure(e,t){var n;const i=this.failures;this.failures++;const r=e*this.getDelay(i)-e;null===(n=this.observer)||void 0===n||n.onBackoff(r,t),await this.waitable.wait(e,r),this.waitable=new o.a6}getFailures(){return this.failures}}},63037:(e,t,n)=>{n.d(t,{CE:()=>s,Os:()=>i,Ud:()=>r,V_:()=>a,xd:()=>l});var o=n(63143);function i(e,t){t.startsWith("offline -")?t="offline":t.startsWith("mobileNativeError -")&&(t="mobileNativeError");const n=e[t]||0;e[t]=n+1,e._total+=1}const r=1*o.C0,a=.5*o.C0,s=10*o.C0,l=5*o.C0},68204:(e,t,n)=>{n.d(t,{E$:()=>a,L1:()=>l,RP:()=>s,sG:()=>r,vG:()=>c});n(57658);var o=n(58573),i=n(72126);function r(e){const{sections:t,context:n,query:r}=e;let a=r.trim().toLowerCase();if(a.startsWith("/")&&(a=a.slice(1)),!a)return l(t,n);const s=function(e){return e.map((e=>({...e,actions:e.actions.map((t=>{const n=t.searchName||t.displayName||"",o=[n,e.searchTitle||e.title||"",n].join(" ");return{...t,searchName:o}}))})))}(l(function(e,t){const n=[];for(const o of e){const e={...o,actions:[]};for(const i of o.actions)if(i.subActions){if(i.collapseSubActionsIntoParent){for(const n of i.subActions(t))for(const t of n.actions)e.actions.push(t);continue}const r=i.subActions(t).map((e=>({...e,key:`${o.key} ${i.key} ${e.key}`,title:e.title||i.displayName,searchTitle:[i.searchName||i.displayName,e.searchTitle||e.title].filter(Boolean).join(" ")})));for(const e of r)n.push(e)}else e.actions.push(i);e.actions.length&&n.push(e)}return n}(t,n),n)),c=[],d=new Map;for(const o of s)for(const e of o.actions)d.set(e,o),c.push(e);const u=(0,o.ZP)(a,c,(e=>e.searchName||""),{minThreshold:25,getSortScore:e=>-e.score*(e.original.sortScoreMultiplier??1)}),p=new Set(u),m=c.filter((e=>Boolean(e.alwaysShowInSearch)&&!p.has(e))),f=m.filter((e=>"start"===e.alwaysShowInSearch)),g=m.filter((e=>"end"===e.alwaysShowInSearch)),h=i.vM([...f,...u,...g],(e=>{const t=d.get(e);if(t)return t.title})),v=[];for(const o of Object.keys(h)){const e=h[o],t=d.get(e[0]);t&&v.push({...t,actions:e})}return v}function a(e,t){if(!t)return e;let n=0;const o=[];for(const i of e){if(n>=t)break;const e=i.actions.slice(0,t-n);e.length>0&&(n+=e.length,o.push({...i,actions:e}))}return o}function s(e,t){const n=[];for(const o of e){const e=o.actions.filter(t);e.length>0&&n.push({...o,actions:e})}return n}function l(e,t){return s(e,(e=>c(e,t)))}function c(e,t){if(e.validators){return e.validators.every((e=>e(t)))}return!0}},19037:(e,t,n)=>{n.d(t,{S4:()=>tn,xD:()=>pe,AK:()=>un,j2:()=>fn,XQ:()=>it,Eo:()=>ot,v_:()=>mn,wF:()=>Qe,ro:()=>Je,sR:()=>Wt,O4:()=>zt,_J:()=>Yt,cW:()=>qt,nW:()=>Te,zz:()=>xe,RF:()=>Ce,U4:()=>Lt,U_:()=>_e,eo:()=>we,OO:()=>wn,J5:()=>ye,k5:()=>Se,KE:()=>be,M:()=>ve,NW:()=>Dt,vy:()=>Bt,Zk:()=>_n,IT:()=>rt,FS:()=>Ve,YB:()=>nt,iJ:()=>Rt,TK:()=>At,IC:()=>Qn,xk:()=>Re,ry:()=>Ae,Kb:()=>vn,Jl:()=>yn,Kh:()=>Et,T2:()=>Ft,lr:()=>Xn,OT:()=>Zn,W3:()=>Un,p4:()=>jn,zO:()=>On,l$:()=>He,KJ:()=>Ne,z2:()=>Vn,EJ:()=>Ln,W5:()=>En,y9:()=>pn,iK:()=>en,_T:()=>vt,lA:()=>Ue,b4:()=>Le,Dt:()=>ut,k6:()=>Cn,Vw:()=>Ht,UI:()=>Jt,W2:()=>qe,fy:()=>zn,xw:()=>St,YG:()=>Ct,f7:()=>kt,dM:()=>Pt,p5:()=>$n,zX:()=>Ge,YO:()=>cn,oY:()=>Xt,Vf:()=>je,VB:()=>We,P5:()=>Kn,FY:()=>$e,D:()=>jt,RO:()=>hn,d:()=>at,ar:()=>st,Vc:()=>Yn,Rr:()=>Ke,QL:()=>et,K5:()=>ke,LH:()=>Ie,$H:()=>Oe,J8:()=>tt,Mg:()=>Mt,nJ:()=>Nt,gn:()=>dt,US:()=>Fn,IZ:()=>It,mq:()=>ln,Nn:()=>on,Z8:()=>oo,vj:()=>Tt,OX:()=>Jn,JF:()=>Ze,fI:()=>Fe,wT:()=>In,Gz:()=>Xe,sz:()=>he,HB:()=>Gn,p1:()=>Be,b1:()=>Kt,jl:()=>bt,V5:()=>ct,Cj:()=>ze,I:()=>gn,tq:()=>mt,Fx:()=>pt,_z:()=>Ee,EC:()=>ge,q4:()=>sn,tY:()=>gt,DF:()=>an,F6:()=>dn,KH:()=>Ot,vd:()=>Gt,YZ:()=>ht,Id:()=>Dn,$I:()=>_t,lv:()=>nn,vM:()=>Nn,Gg:()=>yt,Mn:()=>ft,AT:()=>eo,lP:()=>no,X:()=>Me,FO:()=>to,_n:()=>Bn,U7:()=>fe,pl:()=>Wn,c2:()=>Pe,$c:()=>xn,P9:()=>Ye,Rg:()=>wt,ED:()=>lt,OF:()=>Pn,YP:()=>Mn,ur:()=>An,Rd:()=>Rn,tJ:()=>Tn,DU:()=>Zt,ff:()=>me,or:()=>ue,Tx:()=>rn,eM:()=>Sn,uq:()=>kn,jp:()=>Hn,KS:()=>qn,QY:()=>Vt,KL:()=>Ut,zl:()=>Qt});var o=n(41432),i=n(80951),r=n(42509),a=n(43593),s=n(74181),l=n(72126),c=n(86517),d=n(72141);const u=["TypeScript","JavaScript","GraphQL","HTML","CSS","Scss","JSON","XML","Rust"];var p=n(21202),m=n(6287),f=n(70279),g=n(63921),h=n(29369),v=n(90965),b=n(64684),y=n(70203),_=n(95477),S=n(69783),w=n(28020),k=n(78429),I=n(75770),x=n(85957),C=n(67669),T=n(18514),M=n(95697),P=n(11540),A=n(58202),R=n(81844),D=n(40134),B=n(41662),E=n(63208),F=n(80444),Z=n(16772),V=n(88632),j=n(24042),U=n(64233),L=n(77080),O=n(19111),N=n(88923),z=n(83212),W=n(81236),q=n(26136),H=(n(49557),n(55320)),K=n(27724),G=n(10743),$=n(99757),Q=n(24666),Y=n(35057),J=n(49117),X=n(78316),ee=n(77181),te=n(11599),ne=n(92783),oe=n(68056),ie=n(35026),re=n(98165),ae=n(59139),se=n(28187),le=n(38755),ce=n(89086),de=n(85644);const ue=function(e){return t=>e.some((e=>e(t)))},pe=function(e){return t=>e.every((e=>e(t)))},me=function(e){return t=>!e(t)},fe=e=>e.blocks&&1===e.blocks.length,ge=e=>e.blocks&&e.blocks.length>1,he=e=>!!(0,k.H)()&&e.blocks.every((e=>{const t=e.getParentId(),n=e.recordStoreUIParentStore,o=null==n?void 0:n.id;return t&&o&&t!==o})),ve=e=>e.blocks.every((t=>{const n=t.recordStoreUIParentStore;if(!n)return!1;const o=e.publicEditMode?e.publicEditMode:(0,re.n3)(n)&&z.Z.getMode(e.environment,n);return!C.YF(o)&&n.canEdit()})),be=e=>{const{environment:t}=e;return e.blocks.every((e=>C.KE({environment:t,block:e})))},ye=e=>!$.n.state&&e.blocks.every((t=>!C.YF(e.publicEditMode)&&t.canEdit())),_e=e=>!$.n.state&&e.blocks.every((t=>{if(C.YF(e.publicEditMode))return!1;const n=te.$0();return n?n.canEditCollection():t.canEdit()})),Se=e=>!$.n.state&&e.blocks.every((t=>!C.YF(e.publicEditMode)&&(t.isCollectionView()?t.canEditCollection():t.canEdit()))),we=e=>{let{environment:t,publicEditMode:n,blocks:o}=e;if($.n.state)return!1;const{id:i}=t.currentUser;return!!i&&(!C.YF(n)&&o.every((e=>(0,C.WE)({userId:i,store:e}).filter((t=>{let{type:n,role:o}=t;if(!o)return!1;const i=e.isCollectionView()||e.isTemplate()?d.D7(o):d.J5(o);return"public_permission"!==n&&i})).length>0&&C.KE({environment:t,block:e}))))},ke=e=>{if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,r.Gq)(e)||(0,r.Ev)(e)||(0,r.OY)(e)}}return!1},Ie=e=>{if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,r.Ev)(e)}}return!1},xe=e=>!$.n.state&&e.blocks.every((e=>e.canAdmin())),Ce=e=>!$.n.state&&e.blocks.every((e=>e.canComment())),Te=e=>e.blocks.some((e=>Boolean(A.R.findBlockFromStoreWithMethod(e,"activate")))),Me=e=>e.blocks.every((e=>e.isRestricted())),Pe=e=>{const{currentSpaceStore:t}=F.default.state,{currentUser:n}=e.environment;return(t?t.getPermissionItems():[]).some((e=>d.jg(e)&&e.user_id===n.id&&d.zz(e.role)))},Ae=function(){const e=w.np();return!e||!e.isLocked()},Re=()=>{const e=w.np();return De(e)},De=e=>{if(!e)return!1;return!!e.getParentCollectionStore()},Be=e=>e.blocks.length>0&&e.blocks.some((e=>e.isLocked())),Ee=e=>e.blocks.length>0,Fe=e=>e.blocks.some((e=>{const t=w.np();return!!(t&&t.isPageBlock()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Ze=e=>e.blocks.some((e=>{const{mainEditorCurrentBlockStore:t}=F.default.state;return Boolean(t&&t.isCollectionView()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Ve=e=>e.blocks.every((e=>{const t=e.getType();return Boolean(t&&(0,o.XD)(t)&&!(0,o.S9)(t))})),je=e=>{var t;const n=null===(t=F.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id;if(e.blocks[0]){const t=e.blocks[0].getType(),i=e.blocks[0].id;return Boolean(t&&i===n&&(0,o.XD)(t))}return!1},Ue=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&e.isDefined()&&e.getParentId()!==t.id)})),Le=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&t.canEdit()&&e.isDefined()&&e.getParentId()!==t.id)})),Oe=e=>{if(e.blocks){const t=e.blocks[0];return Boolean(t&&t.isDefined()&&t.getType()===o.Ti.file&&t.getProperties().source)}return!1},Ne=e=>{if(!e.blocks)return!1;const t=e.blocks[0],n=t&&t.getProperties().source;if(!n)return!1;const o=i.zB(n);return!!o&&a.E$(o,[_.default.secureFileS3.url,_.default.secureFileS3V2.url])},ze=e=>{if(e.blocks){const t=e.blocks[0];if(t.isType(o.Ok))return Boolean(t.getProperties())}return!1},We=e=>{if(e.blocks){const t=e.blocks[0],n=t&&t.getType();return Boolean(n&&(0,o.VB)(n))}return!1},qe=e=>{if(e.blocks){const t=e.blocks[0].getModel();return Boolean(null==t?void 0:t.isType(o.oe))}return!1},He=e=>t=>{if(t.blocks){const n=t.blocks[0];return Boolean(n&&n.getProperties()[e])}return!1},Ke=(He("source"),e=>{if(!fe(e))return!1;const t=e.blocks&&e.blocks[0];if(t){const e=t.getType();return Boolean(e&&(0,o.XD)(e)&&t.isEmptyTitle())}return!1}),Ge=e=>{if(e.blocks){const t=e.blocks[0],n=null==t?void 0:t.getModel();return Boolean(null==n?void 0:n.isType(o.f4))}return!1},$e=e=>{if(e.blocks){const t=e.blocks[0];if(t&&t.getType()===o.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();return Boolean(e&&e.canEdit())}return!1}return!1},Qe=e=>e.blocks.every((e=>{const t=e.getModel(),n=e.getRecordStoreUIParent();return Boolean(t&&t.isType(o.Zi)&&t.getType()!==o.Ti.transclusionContainer&&e.getParentTable()!==m.v&&n&&n.id===e.getParentId())})),Ye=e=>t=>t.blocks&&t.blocks[0]&&l.mf(t.blocks[0].getType)&&t.blocks[0].getType()===e,Je=e=>t=>l.yW(t.blocks,(t=>t&&l.mf(t.getType)&&t.getType()===e)),Xe=e=>{const t=e.blocks[0],{language:n}=t.getProperties(),o=(0,y.QaF)(n);return u.includes(o)},et=e=>()=>L.default.checkGate(e),tt=e=>t=>{if(1!==t.blocks.length)return!1;const n=t.blocks[0],o=n.getParentBlockStore(),i=null==o?void 0:o.getContentStores(),r=null==i?void 0:i.map((t=>t.getType()===e));if(!r||0===(null==r?void 0:r.length))return!1;const a=null==i?void 0:i.map((e=>e.id)).indexOf(n.id);return void 0!==a&&(0===a||!r[a-1])},nt=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return Boolean((null==t?void 0:t.isType(o.Zj))&&e.getParentTable()!==m.v)})),ot=e=>{const t=w.RM();return!!t&&e.blocks.every((e=>t.uiContains(e)&&t.id!==e.id))},it=e=>{const t=e.blocks[0],n=null==t?void 0:t.getRecordStoreUIRoot();return!!n&&e.blocks.every((e=>n.uiContains(e)&&n.id!==e.id))},rt=e=>e.blocks.every((e=>{const t=A.R.findBlockFromStoreWithMethod(e,"canRenderFullScreen");return Boolean(t&&t.canRenderFullScreen())})),at=function(e){let{environment:{device:t}}=e;return t.isElectron},st=function(){return Boolean(j.Z.state.isElectronHandlingZoom)},lt=function(e){let{environment:{device:t}}=e;return t.isWindows},ct=function(e){let{environment:{device:t}}=e;return t.isMac},dt=function(e){let{environment:{device:t}}=e;return t.isIOS},ut=function(e){let{environment:{device:t}}=e;return t.isAndroid},pt=function(e){let{environment:{device:t}}=e;return t.isMobileNative},mt=function(e){let{environment:{device:t}}=e;return t.isMobile},ft=function(e){let{environment:{device:t}}=e;return t.isPhone},gt=function(e){let{environment:{device:t}}=e;return t.isNative},ht=function(e){let{environment:{device:t}}=e;return!t.isMobile},vt=()=>_.default.isAdminMode,bt=e=>{let{environment:t}=e;return Boolean(t.currentUser.isLoggedIn()||t.publicDomainUserId)},yt=function(){return V.Z.state.online},_t=e=>!e.blocks.every((t=>{const n=t.inMemoryRecordCache===e.environment.defaultRecordCache.inMemoryRecordCache,o=t.inMemoryRecordCache.cacheFallbacks.has(e.environment.defaultRecordCache.inMemoryRecordCache);return n||o})),St=e=>e.blocks.some((e=>e.isTemplate())),wt=e=>e.blocks.some((e=>e.isTypedCollectionViewBlock())),kt=e=>e.blocks.some((e=>e.isCollectionViewPageWithContent())),It=e=>e.blocks.every((()=>!xt()||fn("page",!1)(e))),xt=()=>{const e=w.np();return null==e?void 0:e.isCollectionViewPageWithContent()},Ct=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isCollectionView()}return!1},Tt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionView)}return!1},Mt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionViewPage)}return!1},Pt=function(e){return t=>{if(t.blocks&&1===t.blocks.length){const[n]=t.blocks,o=A.R.findCollectionViewBlockFromStore(n);return!!o&&o.collectionContextStore.getViewType()===e}return!1}},At=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return 1===t.getCollectionViewStores().length}return!1},Rt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks,n=t.getCollectionViewCollectionStore();if(!n)return!1;const o=n.getSchema();return Object.values(o).map((e=>null==e?void 0:e.type)).every((e=>e&&B.g$.isPropertyTypeConvertableToSimpleTable[e]))}return!0},Dt=e=>T.NW(e.environment),Bt=e=>T.vy(e.environment),Et=function(){return U.Z.state.open},Ft=function(){return S.Z.state.open},Zt=function(){return O.Z.state.open},Vt=function(){return G.Z.state.open},jt=function(){return"editing"===Q.default.state.mode},Ut=function(){return"empty"!==Q.default.state.mode&&!(0,oe.iG)(Q.default.state.multiSelection)},Lt=function(){return!((0,ce.J6)(y.GKr.User)||(0,ce.J6)(y.GKr.Bot)||(0,ce.J6)(y.GKr.Date)||(0,ce.J6)(y.GKr.Page))},Ot=function(){return K.default.state.stores.length>0},Nt=e=>{const t=F.default.state.currentSpaceStore;return(0,le.Cx)(t)},zt=e=>e.blocks.every((e=>Boolean(R.Z.findOutlinerItemFromStore(e)))),Wt=e=>e.blocks.every((e=>{const t=R.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"bookmarks"===t.type)})),qt=e=>e.blocks.every((e=>{const t=R.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"shared"===t.type)})),Ht=e=>{const t=e.blocks[0];if(!t)return!1;const n=t.getParentBlockStore();return!!n&&n.isLocked()},Kt=e=>!Gt(e),Gt=e=>{if(!(0,M.bq)())return!0;const t=e.blocks[0];if(t){if(t.getParentTable()===h.e0){const n=(0,re.VP)(t);if(!n||!(0,ie.si)({teamStore:n,environment:e.environment}))return!1}}return!0};function $t(e){if(!e)return;const t=e.getParentPointer(),n=e.getRecordStoreUIParent();return(null==t?void 0:t.table)===h.e0&&n?q.zX.createChildStore(n,t):$t(e.getParentBlockStore())}const Qt=e=>{const{id:t}=e.environment.currentUser;return!!t&&e.blocks.every((e=>{const n=e.getPermissionItems();return(0,c.ws)(n,t)}))},Yt=e=>e.blocks.every((e=>{const t=R.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem)})),Jt=e=>{const{currentSpaceViewStore:t}=F.default.state,n=e.blocks[0];return Boolean(t&&n&&(0,ne.Z)({spaceViewStore:t,pageId:n.id}))},Xt=e=>{const t=w.np();return e.blocks[0]&&e.blocks[0]===t},en=e=>e.blocks.every((t=>Boolean(C.IJ(e.environment,t)))),tn=e=>e.blocks.every((e=>C.S4(e))),nn=e=>Boolean(F.default.state.mainEditorCurrentBlockStore),on=e=>x.Tx()&&e.blocks[0]&&e.blocks[0]===N.default.peekTarget.state,rn=e=>x.Tx(),an=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getType();return Boolean(t&&(0,o.S9)(t))})),sn=e=>1===e.blocks.length&&(0,w.qG)(e.blocks[0].id),ln=e=>{var t;if(1!==e.blocks.length)return!1;const n=e.blocks[0],o=X.fm(n),i=null==o||null===(t=o.collectionViewBlockStore())||void 0===t?void 0:t.id;return!(!o||!i)&&Boolean(w.qG(i)&&o.isCompactView.state)},cn=e=>e.blocks.some((e=>{e.useCrdt()})),dn=e=>e.blocks.every((e=>{const t=e.getType(),n=e.getFormat();return Boolean(t&&(0,o._T)(t,n))})),un=e=>e.blocks.every((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof q.Xr||e instanceof q.G&&e.isCollectionView())).ancestor))),pn=e=>{let{blocks:t}=e;return t.length>0&&(0,ee.bX)(t[0])},mn=e=>{let{blocks:t}=e;return X.v_(t)};function fn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=n=>n.blocks.every((n=>{const o=X.fm(n,t),i=null==o?void 0:o.collectionViewStore();return(null==i?void 0:i.getType())===e}));return n}const gn=function(){const{currentSpaceStore:e}=F.default.state;return Boolean(e&&e.canRead())},hn=function(){const{currentSpaceStore:e}=F.default.state;return Boolean(e&&e.canEdit())},vn=e=>{if(_.default.isAdminMode)return!0;if(e.blocks.some((e=>{const t=(0,D.B)({blockId:e.id,setting:"disableExport"});return Boolean(null==t?void 0:t.disabled)})))return!1;if(Nt(e)&&!xe(e))return!1;const t=bn(e),{environment:n,blocks:o}=e;return o.every((e=>{const o=(0,re.VP)(e);return o?(!n.currentUser.id||!(0,b.s8)({team:{membership:o.getRawMembership()},userId:n.currentUser.id}))&&!o.getDisableExport():t}))},bn=function(e){let{environment:t}=e;const{currentSpaceStore:n}=F.default.state;if(!n)return!1;const o=W.Z.getPublicSpaceData(t,n.id);return n.isDefined()?!n.getDisableExport():o?!o.disableExport:vt()},yn=()=>{const{currentSpaceStore:e}=F.default.state;return!!e&&!e.getDisableMoveToSpace()},_n=e=>!$.n.state&&(!!e.blocks.every((e=>e.canEdit()))&&!!en(e)),Sn=e=>e.blocks.every((t=>{var n;return"edit"===(null===(n=z.Z.getMode(e.environment,t))||void 0===n?void 0:n.permission)})),wn=e=>{if(!ve(e))return!1;const t=e.blocks.filter((e=>{const t=e.recordStoreUIParentStore,n=e.getParentStore();return t&&n&&t.id===n.id}));return 0===t.length||ye({...e,blocks:t})},kn=e=>{let{environment:t}=e;const n=(0,w.k_)(t).state;return Boolean(n&&n.showSharedOverflowButton)},In=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof q.G&&e.isTransclusionType())).ancestor)))},xn=e=>{let{environment:t}=e;return"on"===L.default.getGroup("lucy-in-the-sky-with-tab-blocks")},Cn=e=>{let{blocks:t}=e;if(!t||0===t.length)return!1;const n=t[0].getType(),i=t[0].getFormat();return Boolean(i.block_width)&&!Boolean(i.block_page_width)&&!Boolean(i.block_full_width)&&Boolean(n&&(0,o._7)(n))},Tn=function(e){var t;let{blocks:n}=e;return Boolean(null===(t=(0,se.Jk)(n[0]))||void 0===t||null===(t=t.slackIntegrationStore)||void 0===t?void 0:t.isReady())},Mn=function(){var e;const{currentSpaceStore:t}=F.default.state,n=null==t||null===(e=t.getBotSettingsStore())||void 0===e?void 0:e.getValue();return!(0,v.CJ)(n)||Boolean((null==n?void 0:n.integration_approval_statuses)&&n.integration_approval_statuses[s.T0])},Pn=function(e){var t;let{blocks:n}=e;const{slackIntegrationStore:o}=(0,se.Jk)(n[0]);return Boolean(o.isReady()&&!(null!=o&&null!==(t=o.getKeyStore("enabled"))&&void 0!==t&&t.getValue()))},An=function(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:i}=(0,se.Jk)(n[0]);return Boolean(i.isReady()&&(null==i||null===(t=i.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id!==n[0].id)},Rn=function(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:i}=(0,se.Jk)(n[0]);return Boolean(i.isReady()&&(null==i||null===(t=i.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id===n[0].id)},Dn=function(e){var t;let{blocks:n}=e;return(null===(t=n[0])||void 0===t?void 0:t.getSpaceId())!==g.N3},Bn=e=>1===e.blocks.length&&e.blocks[0].getType()===o.Ti.table,En=e=>{const t=E.Z.state;return t.isActive&&1===e.blocks.length&&e.blocks[0]===t.simpleTableStore},Fn=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.isImmediateColumnChild())))},Zn=e=>{const t=E.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return B.g$.getNumberOfColumns(n)>1},Vn=e=>{const t=E.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.row&&o.end.row===B.g$.getNumberOfRows(n)-1,r=0<=o.start.col&&o.start.col<=o.end.col&&o.start.col<=B.g$.getNumberOfColumns(n)-1;return"column"===o.type&&r&&i},jn=e=>{const t=E.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.row&&o.end.row===B.g$.getNumberOfRows(n)-1,r=0===o.start.col&&0===o.end.col;return"column"===o.type&&r&&i},Un=e=>{const t=E.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return B.g$.getNumberOfRows(n)>1},Ln=e=>{const t=E.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.col&&o.end.col===B.g$.getNumberOfColumns(n)-1,r=0<=o.start.row&&o.start.row<=o.end.row&&o.start.row<=B.g$.getNumberOfRows(n)-1;return"row"===o.type&&r&&i},On=e=>{const t=E.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,i=0===o.start.col&&o.end.col===B.g$.getNumberOfColumns(n)-1,r=0===o.start.row&&0===o.end.row;return"row"===o.type&&r&&i},Nn=e=>{let{environment:t}=e;return(0,Y.QM)()},zn=e=>{if(1!==e.blocks.length)return!1;const t=e.blocks[0].getParentStore();return!(!t||t.table!==p.iU)&&t.isType(o.Ti.tab)},Wn=e=>{const t=e.blocks[0];return Boolean(t&&t.isCollectionView()&&t.getCollectionViewSourceCollectionStore())},qn=e=>{if(!fe(e))return!1;const t=e.blocks[0];return(0,de.z)(t)},Hn=e=>(e=>{let{environment:t,blocks:n}=e;if(!(0,M.bq)())return!1;if(!I.lQ({environment:t,blocks:n}))return!1;const o=t.currentUser.id,{currentSpaceStore:i}=F.default.state;if(!o||null==i||!i.isDefined())return!1;if(!M.Xq({environment:t,spaceStore:i}))return!1;for(const s of n){var r,a;if(!s.isPageBlock())return!1;if("team"!==(null===(r=R.Z.findOutlinerItemFromStore(s))||void 0===r?void 0:r.type))return!1;const e=null===(a=$t(s))||void 0===a?void 0:a.getMembers();if(!e||!(0,b.pd)({membership:e},o))return!1}return!0})(e)&&ht(e);function Kn(){const{currentSpaceStore:e}=F.default.state,t=null==e?void 0:e.getBotSettingsStore().getValue();return!(0,v.CJ)(t)||Boolean((null==t?void 0:t.integration_approval_statuses)&&t.integration_approval_statuses[s._o])}const Gn=e=>Boolean(e.blocks[0].getFormat().is_placeholder),$n=e=>{var t;return Boolean((null===(t=e.blocks[0].getFormat().alias_pointer)||void 0===t?void 0:t.table)===f.x_)},Qn=()=>{const e=w.np();if(!e||!e.hasContent())return!1;if(1===e.getContentLength()){const t=e.getContentStores()[0].getTitleStore();if(G.Z.state.open&&G.Z.state.textStore===t)return!1;if(Z.default.isEditingEmptyBlock())return!1}return!0};function Yn(){return Boolean(j.Z.state.isElectronUsingCommandNumber)}const Jn=e=>e.blocks.some(J.td),Xn=e=>e.blocks.every((e=>e.isType("page")||e.isType("callout")));function eo(){return H.default.state.open}const to=e=>(0,ae.rd)(e.environment),no=e=>{const{environment:t}=e,{device:n}=t,o="quickSearch"===t.RouterStore.state.route.name;return n.isElectron&&o},oo=e=>(0,P.R)().startsWith("on")},77472:(e,t,n)=>{n.d(t,{NM:()=>ue,ls:()=>Ae,mc:()=>he,Cd:()=>je,of:()=>_e,Ts:()=>ke,eR:()=>Ie,cG:()=>Be,TA:()=>ye,nZ:()=>Pe,nB:()=>Ve,oT:()=>Re,fK:()=>ce,$A:()=>de,Jq:()=>pe,pH:()=>Ce,Ug:()=>Ze,ci:()=>Ue,j:()=>ge,lu:()=>be,oP:()=>fe,Zf:()=>me});var o=n(1302),i=n(82496),r=n(65680),a=n(97880);function s(e){let t=[];if(e.length>0){if(t=e.filter((e=>{let{code:t}=e;return(0,r.Qh)(t)})),0===t.length)return"en-US";const n=t[0].quality,o=t.filter((e=>{let{quality:t}=e;return t===n}));let i=o.find((e=>"en"===e.code));return i||(i=o[0]),function(e){let t=(0,a.qg)(r.vi,e.code)?r.vi[e.code]:r.vi.en;return"es"===e.code?t="ES"===e.region?"es-ES":"es-LA":"zh"===e.code&&(t="TW"===e.region||"HK"===e.region?"zh-TW":"zh-CN"),t}(i)}return"en-US"}function l(e){return`v2/${function(e){return s(i.parse(e))}(e)}`}var c=n(15145),d=n(53504),u=n(33728),p=n(55632),m=n(68626),f=n(15157),g=n(72126),h=n(77897),v=n(4615),b=n(9852),y=n(47425),_=n(64684),S=n(7250),w=n(64002),k=n(54642),I=(n(95477),n(28020)),x=n(33929),C=n(58455),T=n(80444),M=n(77080),P=n(88893),A=n(88280),R=(n(57658),n(93214)),D=n(72141),B=n(29477),E=n(62992),F=n(73123),Z=n(98165),V=n(85957),j=n(75538),U=n(12252),L=n(51),O=n(88923),N=n(81236),z=n(26136),W=n(87956),q=n(35057),H=n(99334),K=n(12955),G=n(74503),$=n(57491);var Q=n(67669),Y=n(38755);const J="not_defined";async function X(e,t,n){const o=await _e(e),{preboot:i,dontWait:r}=n||{};r||i||await async function(e){e.currentUser.isLoggedIn()&&T.default.state.mainEditorCurrentBlockStore&&(await T.default.waitUntil((()=>Boolean(T.default.state.mainEditorCurrentBlockStore&&T.default.state.mainEditorCurrentBlockStore.isReady))),T.default.state.currentSpaceStore&&await A.subscriptionDataStoreInstance.waitUntilLoaded());C.default.shouldRefresh(e.currentUser.id)&&await Ce(e)}(e);const a=r?void 0:await re(e),s=Ie(),{currentUserRootStore:l,currentUserStore:c,currentSpaceStore:d}=T.default.state,u=l&&l.isReady()?g.jj(l.getSpaceViewStores().map((e=>e.getSpaceId()))).length:null;let p;M.default.state.isLoaded&&(p=M.default.getStatsigExperimentsMap());const{width:m,height:f}=e.WindowSizeStore.state,h=(0,$.getMobileNativeDeviceInfo)(),y=window.__mobileNativeSessionInfo??{},_=await(0,G.getDesktopDeviceInfo)(),S=(null==a?void 0:a.space_id)||void 0,w=(0,R.LC)(),k=await(0,K.hasPermissionForThirdPartyService)("amplitude",e);return{data:{...oe(),...o,...a,...ne(),...ke(),...ie(),...te(),...ee({userId:null==c?void 0:c.id,spaceId:null==d?void 0:d.id}),..._,...h,...y,...s,experiments:p,experimentStoreLoaded:M.default.state.isLoaded,current_space_view_count:u,appSource:"client",windowWidth:m,windowHeight:f,unique_event_marker:se({spaceId:S,userId:Re(),deviceId:o.device_id,eventName:t}),isActive:U.Z.state.active,fired_during_onboarding:j.default.state.isOnboarding,tab_id:(0,b.getSessionTabId)(),tab_count:(0,H.K)(),is_foreground:document.hasFocus(),is_user_consent_to_track:k,tid:w&&(0,v.F9)(w)},spaceId:null==a?void 0:a.space_id}}function ee(e){const{userId:t,spaceId:n}=e;if(!t||!n)return;const o=je({userId:t,spaceId:n});return o?{notion_session_id:o.id,notion_session_start_ts:o.sessionStartTime}:void 0}function te(){const e=W.Z.state;if(e)return{queryId:e.queryId}}const ne=function(){const e=O.default.state,t=V.mH(),n=I.np();if(n){const o=Q.YO(n).map((e=>{let{permissionItem:t}=e;return t})),i=o.find((e=>"public_permission"===e.type)),r=o.find((e=>"space_permission"===e.type)),a=o.filter((e=>"user_permission"===e.type&&(0,D.rz)(e.role))),s=o.filter((e=>"user_permission"===e.type&&(0,D.J5)(e.role))),l=function(e){const t=Z.uJ(e),n=[];return g.xH(t.map((e=>{if(e instanceof z.zX)return;const t=e.getCopiedFromPointer();return t&&E.J(t)&&n.push(t.id),n})))}(n),c=Boolean(l)&&l.length>0,d=e.open?void 0:T.default.state.currentCollectionViewStore,{publicPageData:u}=L.Z.state,p=n.getCopiedFromPointer();return{page_id:n.id,page_public_role:i?i.role:J,page_space_role:r?r.role:J,page_all_collaborator_count:s.length+a.length,page_editor_collaborator_count:s.length,page_read_only_collaborator_count:a.length,page_content_count:n.getContentLength(),page_current_user_role:n.getRole(),page_is_peek:t,page_copied_from:p?(0,v.F9)(p.id):void 0,page_is_notion_template:!!p&&E.J(p),page_is_template:n.isTemplate(),page_is_prepopulated:c,page_prepopulated_template_ids:l,page_is_database:n.isCollectionView(),page_view_type:d?d.getType():void 0,page_user_has_explicit_access:u?u.userHasExplicitAccess:J}}};function oe(){const{currentSpaceViewStore:e}=T.default.state;return e&&e.isDefined()?{notify_desktop:e.getNotifyDesktop(),notify_email:e.getNotifyEmail(),notify_mobile:e.getNotifyMobile(),notify_email_digest:e.getNotifyEmailDigest()}:{}}const ie=function(){const{mainEditorCurrentBlockStore:e}=T.default.state;if(e){const t=Z.VP(e);if(t)return{team_id:(0,v.cj)(t.id)}}return{}};async function re(e){var t;await(0,B.OI)(2e3,[Promise.all([A.subscriptionDataStoreInstance.waitUntilLoaded(),L.Z.waitUntilLoaded()])]);const n=A.subscriptionDataStoreInstance.state,{currentUserStore:o,currentSpaceStore:i}=T.default.state,{publicPageData:r}=L.Z.state,a=(0,I.zj)(),s=a?(0,v.F9)(a):void 0,{mainEditorCurrentBlockStore:l}=T.default.state,c=null!=i&&i.isDefined()?{id:null==i?void 0:i.id,settings:null==i?void 0:i.getSettings(),email_domains:null==i?void 0:i.getEmailDomains(),plan_type:null==i?void 0:i.getPlanType(),initial_use_cases:null==i?void 0:i.getInitialUseCases(),invite_link_enabled:null==i?void 0:i.getInviteLinkEnabled(),created_by_id:null==i?void 0:i.getCreatedById(),created_time:i.getCreatedTime()}:void 0,d=(null==i?void 0:i.id)||(null==r?void 0:r.spaceId)||(null==l?void 0:l.getSpaceId()),u=Boolean(null==c||null===(t=c.settings)||void 0===t?void 0:t.is_teams_enabled);if(d&&o&&i&&n){const t=N.Z.getPublicSpaceData(e,d),o=P.YK(n),r=P.CM(n).length||0,a=P.su(n),l=P.lk(n),p=n.hasPaidNonzero,m=t?t.domain:void 0,f=c&&c.email_domains?c.email_domains:void 0,h=P.zl(e,n),b=(0,Y.Ib)(t),y=(0,Y.ww)(t),_=g.hj(h)&&!Number.isNaN(h)&&h!==1/0?h:0;return{space_analytics_data_type:"space_member_data",subscription_tier:(0,q.zt)(),page_id:s,space_id:(0,v.F9)(d),space_is_subscribed:o,space_visible_total:r,space_visible_members:a,space_visible_guests:l,space_visible_members_bucketized:(0,F.aT)(a),space_block_usage:P.Lz(e,n),space_block_usage_over_limit:P.Ln(e,n),space_role:i.getRole(),space_block_usage_percent:_,space_timeline_view_usage:P._9(n)?n.timelineViewUsage:void 0,space_created_time:b,available_credit:0,space_domain:m,space_email_domains:f,space_has_paid_nonzero:p,space_plan_type:y,space_initial_use_cases:c?c.initial_use_cases:void 0,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,v.F9)(c.created_by_id):void 0,teams_is_enabled:u}}if(r){const t=r.spaceId?N.Z.getPublicSpaceData(e,r.spaceId):void 0,n=(0,Y.Ib)(t),o=(0,Y.ww)(t);return{space_analytics_data_type:"space_nonmember_data",space_id:d?(0,v.F9)(d):void 0,space_domain:r.spaceDomain,page_id:s,subscription_tier:(0,q.zt)(),space_created_time:n,space_plan_type:o,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,v.F9)(c.created_by_id):void 0,teams_is_enabled:u}}return c?{space_analytics_data_type:"base_space_data",space_id:(0,v.F9)(c.id),space_created_time:c.created_time,space_plan_type:c.plan_type,space_invite_link_enabled:c.invite_link_enabled,space_created_by:c.created_by_id?(0,v.F9)(c.created_by_id):void 0,teams_is_enabled:u}:{space_analytics_data_type:"space_data_not_loaded",space_id:null!=i&&i.id?(0,v.F9)(null==i?void 0:i.id):void 0}}const ae={};function se(e){const{spaceId:t,userId:n,deviceId:o,eventName:i}=e,r=(0,v.Ul)(`${t}:${n}:${o}:${i}`),a=ae[r],s=Date.now();if(!a)return ae[r]=s,!0;const l=new Date(a),c=new Date(s);return l.getUTCDate()!==c.getUTCDate()?(ae[r]=s,!0):void 0}var le=n(36867);async function ce(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=C.default.verboseAnalytics;if(await p.fK({traits:e}),t)for(const n of e)console.log("track:%c identify","font-weight: bold;",n)}async function de(e){const{environment:t,userId:n,traits:o,skipIntercom:i}=e,r=C.default.shouldRefresh(n)?await Ce(t):C.default.state,a=function(e){const t=Ie();if(!t.user_id)return;const{user_id:n,email:o,name:i,...r}=e;return{...r,user_id:t.user_id,email:t.email,name:t.name}}(o);if(!a)return void m.rateLimitedLog({level:"warning",from:"analyticsHelpers",type:"noCleanAnalyticsUser"});const s=(0,v.F9)(a.user_id);if(!i){var l;const e=x.default.getIntl(),t=null===(l=T.default.state.currentUserStore)||void 0===l?void 0:l.getFullName(e);S.$A({userId:s,userName:t,traits:a,settings:r})}if(null!=r&&r.isLoggingEnabled){const e=I.VU().map(v.F9),n=await re(t),o=await _e(t),i=await async function(e){if(await(0,K.hasPermissionForThirdPartyService)("mutiny",e)){const t="mutiny.user.token",n=await(0,K.getCookie)(e,t)||window.localStorage.getItem(t);if(n)return{mutinyVisitorId:n}}return{}}(t),{accept_language_raw:r,accept_language_preference:l}=o,c=(0,d.Z)({accept_language_raw:r,accept_language_preference:l},"ignore-class-instances"),u={...o,...i,space_has_paid_nonzero:!(!n||!("space_has_paid_nonzero"in n))&&n.space_has_paid_nonzero,integrations:{All:!0}},m={...a,user_email:a.email,...c,...u};p.$A({userId:s,traits:m,spaceIds:e})}C.default.verboseAnalytics&&console.log("identify:",JSON.stringify(o))}const ue=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.default.verboseAnalytics;await p.HX(),e&&console.log("deidentify user")};async function pe(e){const t=await re(e);if(C.default.state.isIntercomEnabled){const e=await async function(e){const{currentUserRootStore:t,currentUserStore:n}=T.default.state;if(n&&t&&e){await Promise.all([t.load(),n.load()]);const o=t.getSpaceViewStores();await Promise.all(o.map((e=>e.load())));const i=g.oA(o.map((e=>e.getSpaceStore())));return await Promise.all(i.map((e=>e.load()))),g.oA(i.map((t=>{const o=t.isDefined()?{id:t.id,plan_type:t.getPlanType(),beta_enabled:t.getBetaEnabled()}:void 0;if(o){const i=(0,v.F9)(o.id);if(i===e.space_id){const i=A.subscriptionDataStoreInstance.state,r=P.XX(i),a={id:e.space_id,name:Me(n,o.plan_type),size:(0,Y.jv)(t).length,is_subscribed:"space_is_subscribed"in e&&e.space_is_subscribed,is_beta:Boolean(o.beta_enabled)};return r&&(a.plan=r.plan),"space_data_not_loaded"!==e.space_analytics_data_type&&e.space_created_time&&(a.company_created_at=e.space_created_time),a}return{id:i,name:Me(n,o.plan_type),size:(0,Y.jv)(t).length}}})))}return[]}(t);S.Jq({companiesData:e})}t&&C.default.state.isLoggingEnabled&&p.Jq({spaceId:t.space_id,spaceData:t})}async function me(e,t){if(!e.currentUser.id)return;const n=(0,v.F9)(e.currentUser.id);return de({environment:e,userId:n,traits:{...t,user_id:n},skipIntercom:!0})}async function fe(e,t,n){const{eventName:o,eventProperties:i}=t;await ge(e,o,i,n)}async function ge(e,t,n,o){try{const r=C.default.verboseAnalytics;0;const{data:a,spaceId:s}=await X(e,t,o);!function(e,t,n){if(!n)return;for(const[o,i]of Object.entries(n))t[o]!==i&&m.log({level:"info",from:"analyticsHelpers",type:"forceOverrideMismatch",data:{eventName:e,miscDataToConvertToString:{forceOverrideKey:o,forceOverrideValue:i,autoTrackedValue:t[o]}}})}(t,a,null==o?void 0:o.forceOverrideAutomaticEventData);const l=(0,d.Z)(g.Xh({...n,...a,...null==o?void 0:o.forceOverrideAutomaticEventData}),"ignore-class-instances");S.j({eventName:t,eventData:l});const u={eventName:t,eventData:{...c.ni(l),__context:{locale:a.preferred_locale,page:{referrer:window.document.referrer,search:window.location.search}},sharedUUID:(0,v.ZP)()},spaceId:s};var i;if(p.j(u),r&&console.log(`track:%c ${t}`,"font-weight: bold;",n),e.device.isMobileNative&&M.default.checkGate("debug_analytics"))null===(i=e.mobileNative)||void 0===i||i.debugLog(`ðŸ¦ analytic event: ${t} | ${JSON.stringify(n)}`)}catch(r){m.log({level:"error",from:"analyticsHelpers",type:"track",data:{eventName:t,miscDataToConvertToString:{e:r}}})}}function he(e){return{trackEvent:t=>{ge(e,t.eventName,t.properties)}}}const ve={};function be(e,t,n,o,i,r){const a=ve[n],s=Date.now();return(!a||s-a>1e3*o)&&(ve[n]=s,ge(e,t,i,r),!0)}async function ye(e,t){await o.default.afterNextFlush();const n=M.default.getConfigKey("event_trail_events",e);if("object"==typeof n&&"number"==typeof n.sampleRate)return(0,h.aw)(n.sampleRate);const i=M.default.getConfigKey("event_trail_events","defaultSampleRate");return"number"==typeof i?(0,h.aw)(i):!(null==t||!t.shouldSendIfStatsigNotInitialized)}async function _e(e){var t,n,o,i;const{device:r,RouterStore:a}=e,s=null===(t=a.getState())||void 0===t||null===(t=t.route)||void 0===t?void 0:t.name,l=await Be(e),{pathname:c,...d}=(0,w.nx)(null===(n=document.location)||void 0===n?void 0:n.href,(0,b.getUrlAnalyticsFromSessionStorage)())||{},u={app_version:r.version,desktop_app_version:r.desktopAppVersion,mobile_app_version:r.mobileAppVersion,is_desktop_app_or_browser:!r.isMobile,is_desktop:r.isElectron,is_mobile:r.isMobile,is_tablet:r.isTablet,is_react_native:r.isMobileNative,is_ios:r.isIOS,is_logged_in:De(e),deviceType:r.os,device_type:r.deviceType,device_os:r.os,platform:r.platform,browser:r.browserName,browser_version:r.browserVersion,browser_version_bucketized:we(r.browserVersion,r.browserName),dnt:r.doNotTrackEnabled,device_id:l&&(0,v.F9)(l),tags:(0,b.getSessionAnalyticsTags)(),host:null===(o=document.location)||void 0===o?void 0:o.host,route_name:s,notion_top_level_domain:null===(i=document.location)||void 0===i||null===(i=i.host)||void 0===i||null===(i=i.split(".notion."))||void 0===i?void 0:i[1],referrer:document.referrer||"none",accept_language_raw:Ee(),accept_language_preference:Fe(),...d};return g.GM(u,g.o8)}const Se=new Set(["Safari","Mobile Safari"]);function we(e,t){const n=e.split(".");return Se.has(t)?n.slice(0,2).join("."):n[0]}const ke=function(){const{currentUserSettingsStore:e}=T.default.state;if(e&&e.isDefined()){let n={};const o=e.getSettings();return o&&(n={user_persona:o.persona,user_source:o.source,user_use_case:o.use_case,time_zone:o.time_zone,time_zone_region:"string"==typeof o.time_zone?(t=o.time_zone,"N/A"===t?t:t.split("/")[0]):void 0,locale:o.locale,preferred_locale:o.preferred_locale,signup_time:o.signup_time,used_desktop_web_app:o.used_desktop_web_app,used_mobile_web_app:o.used_mobile_web_app,used_mac_app:o.used_mac_app,used_windows_app:o.used_windows_app,used_ios_app:o.used_ios_app,used_android_app:o.used_android_app,user_session_count:(0,le.g)(e.id)}),g.GM(n,g.o8)}var t},Ie=function(){const e={user_id:Re(),user_email:C.default.state.user_email,email:C.default.state.user_email,name:C.default.state.user_name};return g.GM(e,g.o8)};const xe=new Map;async function Ce(e){const t=e.currentUser.id;if(t){if(!xe.has(t)){const n=Te(e,{loggedIn:!0});xe.set(t,n),n.then((()=>{xe.delete(t)})).catch((e=>{throw xe.delete(t),e}))}return xe.get(t)}return Te(e,{loggedIn:!1})}async function Te(e,t){t.loggedIn&&await T.default.waitUntilRendered();const n=await k.getUserAnalyticsSettings(e,{});if("success"!==n.type)return void m.log({level:"warning",from:"analyticsHelpers",type:"fetchAnalyticsSettings",data:{miscDataToConvertToString:{response:n}}});const o=n.data;return C.default.setState(o),o}const Me=function(e,t){const n=e.getEmail();return n&&"team"===t?(0,u.Gd)(n):n||void 0};function Pe(e){return e.map((e=>(0,Y.cD)(e))).filter(a.lm).some((e=>y.QM(e)))}function Ae(e){const t=e.map((e=>(0,Y.cD)(e))),n=new Set(g.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("personal")?"personal_pro":n.has("team_free")?"team_free":n.has("personal_free")?"personal_free":n.has("free")?"free":"none"}function Re(){const e=C.default.state.user_id;return e?(0,v.F9)(e):void 0}function De(e){const t=function(e){var t;return(null==e||null===(t=e.currentUser)||void 0===t?void 0:t.id)||e.publicDomainUserId}(e);return Boolean(t)}async function Be(e){const t=await(0,K.getBrowserId)(e);return t&&(0,v.F9)(t)}function Ee(){return M.default.getAcceptLanguageHeader()}function Fe(){return l(Ee()||"")}function Ze(){return"on"===M.default.getEligibleGroup({experimentId:"zendesk",defaultGroup:"unassigned"})}function Ve(e){var t;const n=e.id,o=e.isDefined()?{membership:e.getMembers(),settings:e.getSettingsStore().getValue(),is_default:e.isDefault(),description:e.getDescription(),icon:e.getIcon(),team_pages:e.getTeamPagesStore().getValue()}:void 0;if(!o||!o.settings)return{team_id:(0,v.cj)(n),no_team_value:!0};const i=o.membership||[];return{team_id:(0,v.cj)(n),team_current_size:i.length,team_current_num_users:i.filter((e=>"user"===e.entity_type)).length,team_current_num_groups:i.filter((e=>"group"===e.entity_type)).length,team_access_level:(0,_.B5)(o.settings),team_is_default:o.is_default,team_has_description:Boolean(o.description),team_has_icon:Boolean(o.icon),team_top_pages:(null===(t=o.team_pages)||void 0===t?void 0:t.length)??0}}function je(e){const t=f.Z.get({userId:e.userId,key:`${e.spaceId}:analytics_session`});if(!(t&&Date.now()-t.lastFocusedTime>18e5))return t}function Ue(e){f.Z.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}},28020:(e,t,n)=>{n.d(t,{AK:()=>Ie,B7:()=>ne,CP:()=>ve,Fv:()=>J,JE:()=>ye,RF:()=>ie,RM:()=>oe,VU:()=>Se,VV:()=>_e,Xb:()=>de,Zy:()=>xe,_H:()=>te,_u:()=>ue,aT:()=>re,h1:()=>le,hq:()=>pe,k_:()=>me,kw:()=>fe,np:()=>X,o:()=>we,p5:()=>Ce,qG:()=>ae,qQ:()=>be,rq:()=>Te,tu:()=>ce,ui:()=>he,wU:()=>ke,yn:()=>ge,zj:()=>ee});var o=n(14577),i=n(41432),r=n(53877),a=n(72126),s=n(72141),l=n(99405),c=(n(21202),n(23867)),d=n(19889),u=n(95477),p=n(53323),m=n(50627),f=n(94841),g=n(49427),h=n(34859),v=n(51),b=n(80444),y=n(80641),_=n(33784),S=n(55367),w=n(64233),k=n(69316),I=n(73329),x=n(3418),C=n(42653),T=n(94416),M=n(48863),P=n(22294),A=n(19111),R=n(53730),D=n(19671),B=n(13023),E=n(88923),F=n(26136),Z=n(69784),V=n(13105),j=n(82187),U=n(55320),L=n(27724),O=n(10743),N=n(24666),z=n(16194),W=n(78316),q=n(93827),H=n(85957),K=n(67669),G=n(65598),$=n(77546),Q=n(38755),Y=n(95697);function J(){if(b.default.state.mainEditorCurrentBlockStore)return{id:b.default.state.mainEditorCurrentBlockStore.id,spaceId:(0,c.C)(b.default.state.mainEditorCurrentBlockStore.pointer.spaceId)}}function X(){const e=E.default.state,t=H.mH();return e.open&&t?e.target:b.default.state.mainEditorCurrentBlockStore}function ee(){if(b.default.state.mainEditorCurrentBlockStore)return b.default.state.mainEditorCurrentBlockStore.id}function te(){return H.Tx()?B.Z:D.Z}function ne(e){let t;return b.default.state.currentUserStore?t=b.default.state.currentUserStore:e.currentUser.id&&(t=new F.U6(e,{table:d.KJ,id:e.currentUser.id})),t}function oe(){const e=L.default.getCurrentRootStore();if(e&&e instanceof F.G)return e}function ie(){const e=L.default.getCurrentRootStore();if(e&&e instanceof F.G)return e;const{currentSpaceStore:t}=b.default.state;return t||void 0}function re(e,t){return!t&&(0,f.WE)(b.default.state.mainEditorCurrentBlockStore)&&(0,f.Kj)(e)}function ae(e){return"myTasks"===(0,f.G)({blockOrCollectionId:e})}const se=new V.P({debugName:"getAppRenderState",memoizeRecursion:!0,deepEquals:!1,compute:function(e){var t;const{mainEditorCurrentBlockStore:n,initialized:o}=b.default.state,i=e.currentUser.isLoggedIn(),r=e.RouterStore.state.route,a=Boolean(n&&n.canRead()&&n.isDefined()),c=Boolean(n&&n.canEdit()&&n.isDefined()),d=Boolean(n&&(0,G.Oh)(n)),u=n&&a&&(0,K.IJ)(e,n),p=Boolean(u),m=u&&(0,s.J5)(u.permissionItem.role),f=c&&!m,g=(null==n||null===(t=n.getModel())||void 0===t?void 0:t.isNonverifiedContentClassification())&&!(n&&y.Z.bypassedPage(n.id))&&!f,{publicPageData:h}=v.Z.state,_=!o||!d,S=Boolean((0,l.HK)(r)&&(!(0,l.wO)(r)&&!n||n&&n.isReady()&&!a||g||(null==h?void 0:h.requireInterstitial)||(null==h?void 0:h.requireLogin)&&!i));return{shouldShowSidebar:function(){if((0,q.C)())return Boolean(null==h?void 0:h.template);const e="quickSearch"===r.name;return Boolean(!e&&!S&&i&&(_||(0,l.wO)(r)||a&&(c&&!p||d&&!p)&&!g&&!(null!=h&&h.requireInterstitial)))}(),shouldShowFrame:!S,shouldShowError:S}}}),le=e=>se.getStateFor(e),ce=new o.Z((()=>{const{mainEditorCurrentBlockStore:e}=b.default.state,t=e&&e.isCollectionView();return P.Z.state.isKeyboardMode&&!z.Z.state&&!j.Z.isActive()&&!t&&!U.default.state.open&&!T.Z.state.open&&!k.Z.state.open&&!(0,p.n)()&&0===I.Z.state.banners.length}),{debugName:"appHelpers.shouldHideTopbarStore"});function de(e){const{currentSpaceViewStore:t}=b.default.state;if(t){return a.G0(t.getWorkspacePages(),(0,Q.KA)(e,t),t.getPrivatePages(e)).filter((e=>e.isNavigableBlock()))}return[]}function ue(e){const{currentSpaceViewStore:t}=b.default.state;return t?a.mN([...t.getBookmarkedPages(),...t.getWorkspacePages(),...(0,Q.KA)(e,t),...t.getPrivatePages(e)],"id"):[]}function pe(e){return e.getType()===i.Ti.copyIndicator&&!R.transactionQueue.isPendingTransactionForRecord(e.pointer)}const me=a.HP((e=>new o.Z((()=>function(e){const{currentSpaceStore:t,currentSpaceViewStore:n,currentUserRootStore:o,currentUserSettingsStore:i}=b.default.state;if(!(n&&o&&t&&i))return;const r=(0,Q.jv)(t),a=n.getBookmarkedPages(),s=n.getWorkspacePages(),l=n.getTeamsStores(),{allSharedPagesStores:c,visibleSharedPagesStores:d}=(0,Q.MC)({environment:e,spaceViewStore:n,userSettingsStore:i}).state,u=n.getPrivatePages(e),p=(0,Q.Cx)(t),m=1===r.length&&0===s.length&&"personal"===t.getPlanType(),f=a.length>0,g=!p&&!(0,Y.bq)()&&s.length>0,h=c.length>0,v=i.hasUserPinnedToOutliner({spaceId:t.id,type:"shared"}),y=(0,Y.bq)();return{isGuest:p,isPersonalSpace:m,showBookmarksSection:f,showWorkspaceSection:g,showSharedSection:h,showPrivateSection:!p,showOnlyPrivateSection:!(f||g||h||y),showSharedOverflowButton:c.length>Q.G$||v,stickTemplateItemsToBottom:a.length+c.length+s.length+u.length>=8,allSharedPagesStores:c,visibleSharedPagesStores:d,showTeamSection:y,userJoinedTeamsStores:l}}(e)),{useDeepEqual:!0,debugName:"sidebarStateStore"}))),fe=new o.Z((()=>P.Z.state.isKeyboardMode||Z.default.state.isActive||S.ZP.state.isDragging||O.Z.state.open||A.Z.state.open||w.Z.state.open||M.Z.state.open||x.Z.hasOpenMouseCapturePopup()||D.Z.state.isOpen&&!E.default.isCenterPeekOpen()||B.Z.state.isOpen||_.Z.state.open||C.Z.state.isPinned),{debugName:"menuIsOpenStore"}),ge=new o.Z((()=>{const{currentSpaceViewStore:e,currentUserStore:t}=b.default.state,n=new Set;if(!e||!t)return n;for(const o of e.getTeamsStores()){o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===t.id))&&n.add(o.id)}return n}),{useDeepEqual:!0,debugName:"userTeamsInCurrentSpace"});function he(e){return e.device.isPhone?24:96}function ve(e){return he(e)}function be(e){const t=L.default.getCurrentDefaultContainer(),n=m.zL-2*he(e);if(t){const e=g.Z.find((e=>e.props.store===t.props.store));if(e){const t=e.getContentInnerWidth();if(t)return Math.min(n,t)}}return n}function ye(){const e=X(),t=N.default.state;if("editing"!==t.mode)return!1;const n=t.multiSelection.start.store;return e&&e.id===n.id&&n.path.includes("title")||!1}function _e(){const e=N.default.state;if("editing"!==e.mode)return!1;const t=e.multiSelection.start.store,n="collection"===t.table;return t.path.includes("name")&&n||!1}function Se(){const{currentUserRootStore:e}=b.default.state;if(e){const t=e.getSpaceViewStores();return a.oA(t.map((e=>e.getSpaceId())))}return[]}function we(e){return a.mN(e.getSpaceViewStores(),(e=>e.getSpaceId())).filter((e=>{const t=e.getSpaceStore();return e.isDefined()&&t&&t.canEdit()}))}async function ke(e){await e.load();const t=e.getSpaceViewStores();await Promise.all(t.map((async e=>{await e.load();const t=e.getSpaceStore();t&&await t.load()})))}const Ie=new o.Z((function(){const{currentUserSettingsStore:e}=b.default.state,t=(0,r.aN)();if(e){const n=e.getSettings();return void 0===(null==n?void 0:n.start_day_of_week)?t:null==n?void 0:n.start_day_of_week}return t}),{debugName:"userSettingsStartOfWeek"});function xe(e){const{environment:t,store:n}=e;return n.isCollectionView()?(0,$.eA)(t)?h.Z.All:h.Z.Y:!(0,W.en)(n)&&E.default.isSidePeekOpen()?h.Z.All:h.Z.Y}function Ce(e){const{isFullScreen:t,environment:n}=e;return t&&(0,$.eA)(n)?h.Z.None:h.Z.X}function Te(){u.default.isAdminMode||console.log("%c\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnn                         nnnn\n\tnnnnnnn                          nnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnn                           nnn\n\tnnnnnnnn    nnnnnnnn     nnnnnnn   nnn\n\tnnnnnnnn      nnnnnnn      nnn     nnn\n\tnnnnnnnn      nnnnnnnn     nnn     nnn\n\tnnnnnnnn      nnnnnnnnnn   nnn     nnn\n\tnnnnnnnn      nnn nnnnnnn  nnn     nnn\n\tnnnnnnnn      nnn  nnnnnnnnnnn     nnn\n\tnnnnnnnn      nnn   nnnnnnnnnn     nnn\n\tnnnnnnnn      nnn     nnnnnnnn     nnn\n\tnnnnnnnn      nnn      nnnnnnn     nnn\n\tnnnnnnnn    nnnnnnnn    nnnnnn     nnn\n\t  nnnnnn                           nnn\n\t\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tWe're hiring!\n\t\t  nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tnotion.so/careers\n\t\t\t\t ","font-family: monospace")}},91924:(e,t,n)=>{n.d(t,{HU:()=>u,IJ:()=>c,Q7:()=>l,eC:()=>d,k2:()=>p});var o=n(6495),i=n(32739),r=n(95477),a=n(77080),s=n(18514);function l(e){return!!e.device.isMobileNative&&(e.device.isIOS&&"on"===a.default.getEligibleGroup({experimentId:"ios_3rd_party_login_with_external_browser",defaultGroup:"control"})||e.device.isAndroid&&"on"===a.default.getEligibleGroup({experimentId:"android_3rd_party_login_with_external_browser",defaultGroup:"control"}))}function c(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}return{redirectToAuth:!0,callbackType:"redirect"}}function d(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}if(t.isMobileBrowser||(0,s.Sr)()){return{redirectToAuth:!0,callbackType:"redirect"}}return{redirectToAuth:!0,callbackType:"popup"}}async function u(e,t,n){if(e.device.isHttpApp){const e=await fetch(t);return(await e.json()).url}{const e=await fetch(i.NV({httpUrl:t,protocol:r.default.protocol,includePort:n}));return(await e.json()).url}}function p(e){return i.jP({url:o.tu[e],isLocalHost:"local"===e})}},80365:(e,t,n)=>{n.d(t,{L:()=>m});var o=n(66897),i=n(36576),r=n(72126),a=n(21202),s=n(70279),l=n(23867),c=n(19889),d=n(97880),u=n(26136);function p(e,t){const n=r.oA(e.map((e=>function(e,t){if("comment_mention"===e.mentioned_from.type){const n=u.t1.createChildStore(t,{table:s.x_,id:e.mentioned_from.comment_id,spaceId:(0,l.C)(void 0)});if(!n.isDefined())return;const o=u.t1.createChildStore(t,n.getParentPointer());if(!o.isDefined())return;const i=u.G.createChildStore(t,{table:a.iU,id:o.getParentId()}),r=i.getNavigableBlockStore();if(!r)return;return i.id===r.id?{backlinkStore:r,timestamp:n.getLastEditedTime()}:{backlinkStore:r,scrollToBlockId:i.id,discussionId:o.id,timestamp:n.getLastEditedTime()}}if("reference"===e.mentioned_from.type){const n=u.G.createChildStore(t,{table:a.iU,id:e.mentioned_from.parent_block_id}).getNavigableBlockStore();if(!n)return;const o=n.getLastEditedTime();return{backlinkStore:n,scrollToBlockId:e.block_id,timestamp:o||0}}if("property_mention"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=u.G.createChildStore(t,{table:a.iU,id:n});if(!o.isDefined())return;const i=o.getNavigableBlockStore();if(!i)return;return i.id===o.id?{backlinkStore:i,timestamp:o.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("collection_reference"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=u.G.createChildStore(t,{table:a.iU,id:n});if(!o.isDefined())return;const i=o.getNavigableBlockStore();if(!i)return;return i.id===o.id?{backlinkStore:i,timestamp:o.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type){const n=u.G.createChildStore(t,{table:a.iU,id:e.mentioned_from.pointer.id}),o=n.getNavigableBlockStore();if(!o)return;return{backlinkStore:o,scrollToBlockId:n.id,timestamp:o.getLastEditedTime()}}(0,d.t1)(e.mentioned_from)}(e,t)))),o=r.vM(n,(e=>{let{backlinkStore:t}=e;return t.id})),i=Object.values(o).map((e=>r.MR(e,(e=>e.discussionId?2:e.scrollToBlockId?1:0))[0]));return i.sort(((e,t)=>t.timestamp-e.timestamp)),i}function m(e,t){const{id:n}=t.currentUser;let r;if(n){const t=e.getRecordValue({table:c.KJ,id:n});t&&(r=(0,o.dp)(t))}const a=t.LocalBacklinkStore.getBacklinkState({blockId:e.id,currentUserId:t.currentUser.id}),s=(0,i.sU)({actor:r,blockId:e.id,backlinks:a.backlinks,getRecordModel:e.getRecordModel});return 0===s.length?{backlinks:[],inaccessibleBacklinkCount:a.inaccessibleBacklinkCount}:{backlinks:p(s,e),inaccessibleBacklinkCount:a.inaccessibleBacklinkCount}}},42:(e,t,n)=>{n.d(t,{Fr:()=>U,Jy:()=>D,S7:()=>E,UG:()=>V,W_:()=>w,Yu:()=>M,ZW:()=>Z,_Z:()=>R,ax:()=>_,d6:()=>L,iC:()=>P,iD:()=>j,n_:()=>B,sU:()=>A,sw:()=>y});var o=n(30120),i=n(99036),r=n(80951),a=n(53877),s=n(42875),l=n(72126),c=n(4615),d=n(71644),u=n(45953),p=n(21202),m=n(6287),f=n(70203),g=n(97880),h=n(9291),v=n(33929);const b=(0,h.defineMessages)({addNewTodoTitle:{defaultMessage:"Add a new to-do",id:"blockTemplates.templateButton.addNewTodoTitle"}});function y(){return u.Ao.create({block:{root:{id:"root",version:27,type:"factory",properties:{title:[[v.default.formatMessage(b.addNewTodoTitle)]]},content:["to_do"]},to_do:{id:"to_do",version:4,type:"to_do",parent_table:"block",parent_id:"root",alive:!0}}})}function _(){return u.Ao.create({block:{root:{id:"root",version:0,type:"button",format:{automation_id:"automation"}}},automation:{automation:{id:"automation",parent_id:"root",parent_table:p.iU,alive:!0,status:"active",trigger:{id:(0,c.ZP)(),type:"button"},action_ids:[],properties:{name:""}}}})}const S=(0,h.defineMessages)({namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.table.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.table.tagsPropertyTitle"}});function w(e){const{isInline:t,name:n}=e,o=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0}},collection_view:{view:{id:"view",version:0,type:"table",format:{collection_pointer:{table:m.v,id:"collection"},table_properties:[{property:"title",visible:!0,width:276},{property:o,visible:!0}],table_wrap:!0},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(S.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(S.tagsPropertyTitle),type:"multi_select"}},format:{collection_page_properties:[{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}const k=(0,h.defineMessages)({viewTitle:{defaultMessage:"Board view",id:"blockTemplates.board.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.board.namePropertyTitle"},assignPropertyTitle:{defaultMessage:"Assign",id:"blockTemplates.board.assignPropertyTitle"},statusPropertyTitle:{defaultMessage:"Status",id:"blockTemplates.board.statusPropertyTitle"},statusPropertyRedOptionTitle:{defaultMessage:"Not started",id:"blockTemplates.board.statusPropertyRedOptionTitle"},statusPropertyYellowOptionTitle:{defaultMessage:"In progress",id:"blockTemplates.board.statusPropertyYellowOptionTitle"},statusPropertyGreenOptionTitle:{defaultMessage:"Completed",id:"blockTemplates.board.statusPropertyGreenOptionTitle"},card1Title:{defaultMessage:"Card 1",id:"blockTemplates.board.card1Title"},card2Title:{defaultMessage:"Card 2",id:"blockTemplates.board.card2Title"},card3Title:{defaultMessage:"Card 3",id:"blockTemplates.board.card3Title"}});const I=(0,h.defineMessages)({viewTitle:{defaultMessage:"Calendar view",id:"blockTemplates.calendar.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.calendar.namePropertyTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.calendar.datePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.calendar.tagsPropertyTitle"}});const x=(0,h.defineMessages)({viewTitle:{defaultMessage:"Timeline view",id:"blockTemplates.timeline.viewTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.timeline.datePropertyTitle"}});const C=(0,h.defineMessages)({viewTitle:{defaultMessage:"Gallery view",id:"blockTemplates.gallery.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.gallery.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.gallery.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.gallery.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.gallery.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.gallery.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.gallery.page3Title"},page1TodoTitle:{defaultMessage:"To-do",id:"blockTemplates.gallery.page1TodoTitle"},page1CompletedTodoTitle:{defaultMessage:"Completed To-do",id:"blockTemplates.gallery.page1CompletedTodoTitle"}});const T=(0,h.defineMessages)({viewTitle:{defaultMessage:"List view",id:"blockTemplates.list.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.list.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.list.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.list.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.list.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.list.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.list.page3Title"}});function M(e){const{environment:t,isInline:n,viewType:l,name:c}=e;return"table"===l?w({environment:t,isInline:n,name:c}):"board"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),r=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(k.card1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(k.card2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(k.card3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"board",name:v.default.formatMessage(k.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},board_columns_by:{property:o,type:"status",groupBy:"group",sort:{type:"ascending"}},board_columns:[{property:o,value:{type:"status",value:{type:"by_group",group:"To-do"}}},{property:o,value:{type:"status",value:{type:"by_group",group:"In progress"}}},{property:o,value:{type:"status",value:{type:"by_group",group:"Complete"}}}],board_properties:[{property:o,visible:!1},{property:r,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(k.namePropertyTitle),type:"title"},[r]:{name:v.default.formatMessage(k.assignPropertyTitle),type:"person"},[o]:(0,i.I4)(v.default.formatMessage(k.statusPropertyTitle),v.default.getIntl())},format:{collection_page_properties:[{property:o,visible:!0},{property:r,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"calendar"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),i=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:"calendar",name:v.default.formatMessage(I.viewTitle),format:{collection_pointer:{table:m.v,id:"collection"}},query2:{calendar_by:o},parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(I.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(I.datePropertyTitle),type:"date"},[i]:{name:v.default.formatMessage(I.tagsPropertyTitle),type:"multi_select"}},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"list"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),i=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(T.page1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(T.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(T.page3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"list",name:v.default.formatMessage(T.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},list_properties:[{property:o,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(T.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(T.tagsPropertyTitle),type:"multi_select",options:[]},[i]:{name:v.default.formatMessage(T.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:i,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"gallery"===l?function(e){const{isInline:t,name:n}=e,o=(0,d.ZP)(),i=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(C.page1Title)]]},content:["to_do_1","to_do_2"]},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(C.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[v.default.formatMessage(C.page3Title)]]}},to_do_1:{id:"to_do_1",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[v.default.formatMessage(C.page1TodoTitle)]]}},to_do_2:{id:"to_do_2",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[v.default.formatMessage(C.page1CompletedTodoTitle)]],checked:[["Yes"]]}}},collection_view:{view:{id:"view",version:0,type:"gallery",name:v.default.formatMessage(C.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},gallery_cover:{type:"page_content"}},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(C.namePropertyTitle),type:"title"},[o]:{name:v.default.formatMessage(C.tagsPropertyTitle),type:"multi_select",options:[]},[i]:{name:v.default.formatMessage(C.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:i,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):"timeline"===l?function(e){const{isInline:t,name:n}=e,i=(0,d.ZP)(),l=(0,d.ZP)(),c=(0,d.ZP)();return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[v.default.formatMessage(k.card1Title)]],[i]:(0,r.d7)((0,a.fZ)(o.ou.now().minus({days:5}).startOf("day").valueOf(),o.ou.now().minus({days:2}).startOf("day").valueOf(),(0,s.r)()))},alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[v.default.formatMessage(k.card2Title)]],[i]:(0,r.d7)((0,a.fZ)(o.ou.now().minus({days:3}).startOf("day").valueOf(),o.ou.now().startOf("day").valueOf(),(0,s.r)()))},alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[v.default.formatMessage(k.card3Title)]],[i]:(0,r.d7)((0,a.fZ)(o.ou.now().minus({days:1}).startOf("day").valueOf(),o.ou.now().plus({days:2}).startOf("day").valueOf(),(0,s.r)()))},alive:!0}},collection_view:{view:{id:"view",version:0,type:"timeline",name:v.default.formatMessage(x.viewTitle),format:{collection_pointer:{table:m.v,id:"collection"},timeline_show_table:!t,timeline_properties:[{property:"title",visible:!0}],timeline_table_properties:[{property:"title",visible:!0,width:280},{property:i,visible:!1,width:180},{property:l,visible:!1,width:180},{property:c,visible:!1,width:180}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,f.TPx)(n):void 0,schema:{title:{name:v.default.formatMessage(k.namePropertyTitle),type:"title"},[i]:{name:v.default.formatMessage(x.datePropertyTitle),type:"date"},[l]:{name:v.default.formatMessage(k.assignPropertyTitle),type:"person"},[c]:{name:v.default.formatMessage(k.statusPropertyTitle),type:"select",options:[{id:"1",value:v.default.formatMessage(k.statusPropertyRedOptionTitle),color:"red"},{id:"2",value:v.default.formatMessage(k.statusPropertyYellowOptionTitle),color:"yellow"},{id:"3",value:v.default.formatMessage(k.statusPropertyGreenOptionTitle),color:"green"}]}},format:{collection_page_properties:[{property:i,visible:!0},{property:l,visible:!0},{property:c,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:c}):void("page"!==l&&(0,g.t1)(l))}function P(e){const{isInline:t,viewType:n}=e;return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:n,parent_id:"root",parent_table:"block",alive:!0}}})}function A(e){const{isInline:t,viewType:n,integrationId:o}=e;return u.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0}},collection:{collection:{id:"collection",name:void 0,schema:{},format:{is_placeholder:!0,integration_id:o},parent_id:"root",parent_table:"block",alive:!0}},collection_view:{view:{id:"view",version:0,type:n,format:{collection_pointer:{table:m.v,id:"collection"}},parent_id:"root",parent_table:"block",alive:!0}}})}function R(){return u.Ao.create({block:{root:{id:"root",type:"transclusion_container",content:["empty_text"],alive:!0},empty_text:{id:"empty_text",type:"text",parent_id:"root",parent_table:"block",alive:!0}}})}function D(e){return u.Ao.create({block:{root:{id:"root",type:"ai_block",content:[],alive:!0,format:{ai_prompt_key:e}}}})}function B(e){const t=l.DZ(e,(e=>`column${e+1}`));return u.Ao.create({block:{root:{id:"root",type:"column_list",content:t,alive:!0},...Object.assign({},...t.map((t=>{const n=`${t}_text`;return{[t]:{id:t,type:"column",parent_id:"root",parent_table:"block",content:[n],alive:!0,format:{column_ratio:1/e}},[n]:{id:n,type:"text",parent_id:t,parent_table:"block",alive:!0}}})))}})}function E(){const e=[(0,d.ZP)(),(0,d.ZP)()];return u.Ao.create({block:{root:{id:"root",type:"table",content:["row_1","row_2","row_3"],alive:!0,format:{table_block_column_order:e}},row_1:{id:"row_1",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_2:{id:"row_2",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_3:{id:"row_3",type:"table_row",parent_id:"root",parent_table:"block",alive:!0}}})}const F=(0,h.defineMessages)({tab1Title:{defaultMessage:"Tab 1",id:"blockTemplates.list.tab1Title"},tab2Title:{defaultMessage:"Tab 2",id:"blockTemplates.list.tab2Title"},tab3Title:{defaultMessage:"Tab 3",id:"blockTemplates.list.tab3Title"}});function Z(){return u.Ao.create({block:{root:{id:"root",type:"tab",alive:!0,content:["tab1","tab2","tab3"]},tab1:{id:"tab1",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[v.default.formatMessage(F.tab1Title)]]}},tab2:{id:"tab2",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[v.default.formatMessage(F.tab2Title)]]}},tab3:{id:"tab3",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[v.default.formatMessage(F.tab3Title)]]}}}})}function V(e){return u.Ao.create({[p.iU]:{root:{id:"root",type:e,format:{toggleable:!0}}}})}function j(e,t){return u.Ao.create({[p.iU]:{root:{id:"root",type:"code",properties:{title:f.TPx(t),language:f.TPx(e)}}}})}function U(){return u.Ao.create({[p.iU]:{root:{id:"root",type:"drawing",format:{drawing_value:void 0,block_page_width:!0,block_height:480}}}})}function L(){return u.Ao.create({[p.iU]:{root:{id:"root",type:"ai_block",format:{ai_skill:{ai_show_skill_picker:!0,ai_skill_type:"meeting_summary"}}}}})}},43250:(e,t,n)=>{n.d(t,{$ji:()=>Yt,A_D:()=>R,Apy:()=>ln,Aur:()=>St,B8p:()=>D,BEs:()=>Ie,BKn:()=>We,BaY:()=>He,C18:()=>Ne,CBT:()=>Qe,CZG:()=>ge,C_N:()=>Jt,Cjq:()=>mt,D$4:()=>it,Dkf:()=>Ht,EGJ:()=>Et,Ep8:()=>v,F4o:()=>Pe,FJA:()=>W,FLq:()=>vt,FoE:()=>me,G6g:()=>re,GNl:()=>H,GZn:()=>yn,GbT:()=>j,Gcz:()=>Rt,GfL:()=>K,HKr:()=>te,HwD:()=>Xt,I2F:()=>X,I9j:()=>Xe,IAq:()=>yt,Iiy:()=>dn,IpQ:()=>de,J2F:()=>wt,JR_:()=>Dt,JUE:()=>Le,JiD:()=>r,JkF:()=>xe,K3y:()=>V,K4T:()=>jt,KA2:()=>J,KLh:()=>Z,LoZ:()=>ie,MD7:()=>F,MU2:()=>Re,MV2:()=>bt,M_0:()=>cn,Mdu:()=>Oe,Mfh:()=>_e,Mpz:()=>_t,MsS:()=>u,N7t:()=>pe,NFf:()=>fe,Nn$:()=>h,No6:()=>I,OE$:()=>mn,OK_:()=>m,Oau:()=>L,PBs:()=>g,QS0:()=>C,QSt:()=>o,Qcf:()=>w,Qgj:()=>dt,Quo:()=>c,RG3:()=>Fe,RIA:()=>Qt,S94:()=>q,S9A:()=>hn,TAd:()=>qe,TFu:()=>on,TYv:()=>ze,UBk:()=>B,Uhm:()=>pt,Uwd:()=>Ze,V6y:()=>xt,VMO:()=>Mt,Voi:()=>ht,Wh_:()=>x,Wiy:()=>T,Wy1:()=>ut,Xgx:()=>at,Xj_:()=>p,Xjk:()=>bn,Xsh:()=>et,Y6l:()=>je,Y7r:()=>Je,YHn:()=>$,YOJ:()=>_n,YPt:()=>y,Z87:()=>ft,ZHw:()=>P,ZmO:()=>Q,Zp2:()=>nn,_so:()=>It,a6i:()=>ce,aL4:()=>De,afv:()=>G,aiP:()=>a,alX:()=>i,b_f:()=>N,blN:()=>Te,c7X:()=>Ft,cFM:()=>nt,dXl:()=>gn,euV:()=>k,exn:()=>ye,f0e:()=>sn,f8P:()=>ae,fHd:()=>_,fOh:()=>fn,fe0:()=>ke,gGc:()=>Y,gec:()=>lt,gjL:()=>ee,gug:()=>l,hEP:()=>rn,hKO:()=>ue,hzx:()=>ne,i25:()=>kt,irE:()=>Ut,j35:()=>Ae,jWx:()=>Ve,kDE:()=>Ot,kUP:()=>Tt,l24:()=>Me,lIT:()=>M,lmr:()=>Sn,mJW:()=>b,mSZ:()=>A,mWS:()=>At,myM:()=>rt,nM$:()=>Zt,nU_:()=>he,o4s:()=>zt,oc0:()=>Ye,ovr:()=>Nt,p0b:()=>U,p1Q:()=>S,p4m:()=>se,pg$:()=>tn,q1J:()=>Ce,qnV:()=>un,qr0:()=>Ke,qxR:()=>Ue,rG8:()=>$e,rIE:()=>Ee,rIj:()=>ot,rIs:()=>en,rKl:()=>s,rTm:()=>Gt,rVO:()=>$t,rcG:()=>ve,rli:()=>Se,s$o:()=>tt,sbt:()=>Vt,sqL:()=>Lt,srZ:()=>O,tQh:()=>z,tfM:()=>Ct,ulv:()=>vn,vvn:()=>gt,wFE:()=>oe,wG0:()=>an,wKH:()=>f,wXs:()=>Bt,wlU:()=>E,wnm:()=>st,x2W:()=>ct,x4y:()=>d,x9t:()=>qt,xvU:()=>Kt,y4j:()=>pn,yNE:()=>Be,ykc:()=>be,zYS:()=>we,z_z:()=>Wt,zar:()=>Ge,zov:()=>le,zwY:()=>Pt});const o="notion-cursor-default",i="hidden",r="notion-fadein",a="notion-mobile",s="notion-fadein-fast",l="notion-front-page",c="analytics-scroll-point",d="notion-login",u="notion-light-theme",p="notion-dark-theme",m="notion-scroller",f="vertical",g="horizontal",h="notion-history-modal",v="notion-block-resizer",b="notion-overlay-container",y="notion-default-overlay-container",_="notion-page-template-modal",S="notion-peek-renderer",w="notion-text-action-menu",k="notion-selectable",I="notion-selectable-halo",x="notion-focusable-within",C="notion-page-content",T="notion-frame",M="notion-topbar",P="notion-topbar-mobile",A="notion-topbar-more-button",R="notion-topbar-action-buttons",D="notion-share-menu",B="notion-share-menu-publish-tab",E="notion-share-menu-publish-button",F="notion-topbar-share-menu",Z="notion-updates-menu",V="notion-topbar-updates-button",j="notion-topbar-favorite-button",U="notion-topbar-comments-button",L="notion-search-menu",O="notion-embed-menu",N="notion-unfurling-menu",z="notion-media-menu",W="notion-invite",q="notion-record-icon",H="notion-calendar-header-days",K="notion-board-group",G="notion-block-permission-settings-workspace-access",$="notion-block-permission-settings-team-access",Q="notion-block-permission-settings-team-access",Y="notion-block-permission-settings-group-access",J="notion-page-view-discussion",X="notion-updates-button-mentions",ee="notion-updates-button-all-updates",te="notion-updates-button-archive",ne="notion-discussion-input-edit-existing-comment",oe="notion-discussion-input",ie="notion-discussion-reply-menu",re="notion-comment-overflow-menu",ae="notion-shimmer",se="notion-link",le="ai-block",ce="notion-sharing-permission-role-select",de="notion-sharing-permission-expiration-timestamp",ue="notion-language-picker",pe="notion-cookie-selector",me="notion-activity-section-icon",fe="notion-activity-section-header",ge="notion-activity-section-time",he="notion-activity-section-children",ve="notion-sidebar",be="notion-sidebar-mobile",ye="notion-open-sidebar",_e="notion-close-sidebar",Se="notion-sidebar-switcher",we="notion-space-settings",ke="notion-outliner-bookmarks",Ie="notion-outliner-workspace",xe="notion-outliner-shared",Ce="notion-outliner-private",Te="notion-outliner-offline",Me="notion-outliner-team",Pe="notion-outliner-bookmarks-header",Ae="notion-outliner-workspace-header",Re="notion-outliner-shared-header",De="notion-outliner-private-header",Be="notion-outliner-offline-header",Ee="notion-outliner-team-header",Fe="notion-outliner-joined-team-header",Ze="notion-outliner-unjoined-team-header",Ve="notion-outliner-search-team-header",je="notion-outliner-public-page-template-includes-header",Ue="notion-outliner-team-context-menu-button",Le="notion-outliner-team-heading-context-menu-button",Oe="notion-outliner-team-context-menu",Ne="notion-updates-menu",ze="notion-sidebar-trash-menu",We="notion-password-modal",qe="notion-scim-table-revoke-button",He="notion-subscription-checkout-title",Ke="notion-subscription-checkout-description",Ge="notion-update-sidebar",$e="notion-update-sidebar-tab-comments-segmented-control",Qe="notion-update-sidebar-tab-comments-dropdown-control",Ye="notion-update-sidebar-tab-comments-dropdown-button-open",Je="notion-update-sidebar-tab-comments-dropdown-button-resolved",Xe="notion-update-sidebar-tab-comments-header",et="notion-update-sidebar-tab-comments-comments-scroller",tt="notion-update-sidebar-tab-comments-discussion-item",nt="notion-update-sidebar-tab-updates-header",ot="notion-team-settings-modal",it="notion-add-members-modal",rt="notion-new-team",at="notion-use-case-onboarding-profile",st="notion-use-case-onboarding-persona-survey",lt="notion-workspace-choose",ct="notion-workspace-plan-choose",dt="notion-workspace-create",ut="notion-workspace-invite",pt="notion-onboarding-error",mt="notion-onboarding-popup",ft="notion-onboarding-button",gt="notion-onboarding-plan-type-personal",ht="notion-onboarding-plan-type-team",vt="notion-onboarding-plan-type-school",bt="notion-onboarding-app-download",yt="notion-onboarding-persona-survey-persona",_t="notion-onboarding-persona-survey-role",St="notion-onboarding-persona-survey-companysize",wt="notion-onboarding-persona-survey-usecases",kt="notion-onboarding-timed-trial-upsell",It="notion-table-view",xt="notion-table-view-add-column",Ct="notion-table-view-add-row",Tt="notion-table-view-header-row",Mt="notion-table-view-header-cell",Pt="notion-table-view-row",At="notion-table-view-cell",Rt="notion-table-view-empty-placeholder",Dt="notion-table-view-drag-and-fill-handle",Bt="notion-table-view-frozen-column-repositioner",Et="notion-board-view",Ft="notion-calendar-view",Zt="notion-list-view",Vt="notion-gallery-view",jt="notion-collection-item",Ut="notion-calendar-view-day",Lt="notion-collection-view-item-add",Ot="notion-timeline-view",Nt="notion-timeline-item",zt="notion-timeline-item-row",Wt="notion-timeline-item-properties",qt="notion-collection-view-body",Ht="notion-view-settings-sidebar",Kt="notion-collection-edit-view",Gt="notion-collection-view-tab-button",$t="notion-collection-add-view",Qt="notion-collection-automation-edit-view",Yt="notion-template-picker-item",Jt="notion-template-picker-item-action-menu",Xt="draggable-ghost-section",en="developer-integrations-container",tn="developer-integrations-list",nn="developer-integration-create",on="developer-integration-view",rn="developer-integration-lab",an="developer-integration-not-found",sn="notion-table-row-selector",ln="notion-table-column-selector",cn="notion-table-row",dn="notion-table-cell",un="notion-table-cell-text",pn="notion-table-selection-overlay",mn="notion-table-tbody-selectable",fn="notion-table-content",gn="notion-temporary-comment",hn="notion-margin-discussion-item",vn="search-query-result-item",bn="search-result-body-section-title",yn="search-result-mobile-body-scroller",_n="notion-completions-feedback-popup",Sn="notion-help-button"},47853:(e,t,n)=>{n.d(t,{D:()=>r});var o=n(13991),i=n(25666);function r(e){return i.D(e,o.SP)}},49117:(e,t,n)=>{n.d(t,{$5:()=>T,Gb:()=>I,PN:()=>S,Rr:()=>M,pZ:()=>_,pt:()=>w,td:()=>x,uV:()=>C});var o=n(14577),i=n(28751),r=n(81730),a=n(94412),s=n(61202),l=n(86433),c=n(1274),d=n(78106),u=n(42875),p=n(59753),m=n(86517),f=n(149),g=n(98963),h=n(97880),v=n(77080),b=n(26136),y=n(35057);const _=30;function S(){return v.default.checkGate("button_property")}function w(e){const{context:t}=e;let n,o;if(t.persisted){const{automationStore:i}=t,a=e.automationValue??i.getValue();if(!a)return{error:new r.MO("Missing automation record")};n=p.kk.fromValue(g.cv,a),o=i.getActionStores().map((e=>e.getModel())).filter(h.$K)}else n=new a.X({triggerType:"button",actions:t.actions,parentPointer:t.parentPointer,spaceId:t.parentPointer.spaceId}),o=t.actions.map((e=>new a.e(e,t.parentPointer.spaceId)));const i=t.parentRecordStore.getRecordModel,s=t.parentRecordStore.loadRecordModel,c={automationModel:n,actionModels:o,handleDataRequest:(0,d.yf)(i,s),intl:t.intl,getRecordModel:i,loadRecordModel:s,userTimeZone:(0,u.r)()};let m;if("button_property"===t.type){const e=t.collectionContextStore.collectionStore();if(!e)return{error:new r.MO("Missing collectionContextStore")};m={...c,collectionPointer:e.getSpaceShardedPointer(),contextType:t.type}}else if("button_block"===t.type){const e=t.pageStore.getAssociatedCollectionStore();m={...c,collectionPointer:null==e?void 0:e.getSpaceShardedPointer(),contextType:t.type}}else"event"===t.type?m={...c,collectionPointer:t.parentPointer,contextType:t.type}:"structured_automation"===t.type||"recurrence"===t.type?m={...c,contextType:t.type}:(0,h.t1)(t);return(0,l.rS)(m)}const k=new WeakMap;function I(e){const t=k.get(e.automationStore);if(t)return t;{const t=new o.Z((()=>function(e){if(("button_block"===e.type||"button_property"===e.type)&&!e.currentUserId)return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const t=e.automationStore.getModel();if(!t)return{executionPermissionStatus:"unknown",typecheckResult:void 0};const n=e.automationStore.getActionStores().map((e=>e.getModel()));if(!n.every((0,h.AO)((e=>(0,h.$K)(e)?{true:e}:{false:e}))))return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const o=w({context:e});if(f.x.isFail(o))return{executionPermissionStatus:"unknown",typecheckResult:o};const r={automationModel:t};for(const a of n){const t=(0,i.z)(a.getType()).getExecutionDependencies(r,a),n=(0,s.TD)({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:o.value.valueTypes});for(const i of n){const t=(0,b.Kv)(e.parentRecordStore,i.pointer).getRole();if(!t||(0,m.gr)(t,i.minimumRole))return{executionPermissionStatus:"insufficient",typecheckResult:o}}}return{executionPermissionStatus:"sufficient",typecheckResult:o}}(e)),{debugName:"buttonAutomationAnalysisCachedStore"});return k.set(e.automationStore,t),t}}function x(e){return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof b.zq&&e.isType("duplicate_blocks"))).ancestor)}function C(e,t){const n=e.getModel(),o=e.getActionStores(),i=o.filter((e=>e.isDefined())).map((e=>e.getModel())).filter(h.$K);if(n&&i.length===o.length)return{checkExperimentGate:e=>Promise.resolve(v.default.checkGate(e)),checkExperimentGroup:e=>Promise.resolve(v.default.getGroup(e)),checkSubscribed:()=>Promise.resolve((0,y.sX)()),automation:n,automationActions:i,contextType:t,checkType:"canAddAction"}}function T(e){if(!e)return{editPermissionStatus:"unknown",reason:"missing_automation_context"};const{automationStore:t}=e,n=t.getValue(),o=t.getModel();if(!o||!n)return{editPermissionStatus:"unknown",reason:"missing_automation_model"};const r=t.getActionStores().map((e=>e.getModel()));if(!r.every((0,h.AO)((e=>(0,h.$K)(e)?{true:e}:{false:e}))))return{editPermissionStatus:"unknown",reason:"missing_automation_action_model"};const a=w({context:e});if(f.x.isFail(a))return{editPermissionStatus:"unknown",reason:"typecheck_error"};const l=r.length>0&&r.some((e=>!e.isType("slack_notification")));if(o.isType("event")&&l&&!(0,y.sX)())return{editPermissionStatus:"insufficient",reason:"free_workspace"};const d={automationModel:o},u=r.filter((e=>e.isType("slack_notification")));for(const c of u){const t=(0,i.z)(c.getType()).getExecutionDependencies(d,c),n=(0,s.TD)({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:a.value.valueTypes});for(const o of n){const t=(0,b.Kv)(e.parentRecordStore,o.pointer).getRole();if(!t||(0,m.gr)(t,o.minimumRole))return{actionId:c.id,editPermissionStatus:"insufficient",reason:"missing_permissions"}}}const p=(0,c.fz)({automationValue:n,actionValues:t.getActionStores().map((e=>({config:e.getConfig(),type:e.getType()})))});for(const i of p){const e=t.getRecordRole(i.pointer);if(!e||(0,m.gr)(e,i.minimumRequiredRole))return{editPermissionStatus:"insufficient",reason:"missing_permissions"}}return{editPermissionStatus:"sufficient"}}function M(e){const{device:t}=e.environment;return!(t.isIOS&&t.isMobileNative)}},97004:(e,t,n)=>{n.d(t,{CN:()=>T,Gz:()=>C,H_:()=>b,IX:()=>M,Me:()=>I,Mj:()=>k,Nq:()=>S,Pi:()=>x,RL:()=>y,Zh:()=>_,m1:()=>P,qd:()=>v,tJ:()=>A,yU:()=>w,ze:()=>R});n(57658);var o=n(76205),i=n(99036),r=n(43690),a=n(10070),s=n(53504),l=n(93824),c=n(42875),d=n(72126),u=n(97880),p=n(40663),m=n(28020),f=n(17335),g=n(77181),h=n(33929);function v(e){const{schema:t,filters:n,getRecordModel:i}=e,r=[];for(const o of Object.keys(t)){const e=b({property:o,schema:t,getRecordModel:i});e&&r.push(e)}const a=r.filter((e=>!n.find((t=>(0,o.aN)(t.filter)&&t.filter.property===e.property))));return d.MR(a,(e=>{const n=t[e.property];return(null==n?void 0:n.name)||""}))}function b(e){const{property:t,schema:n,getRecordModel:i}=e,r=(0,f.zZ)({property:t,schema:n,getRecordModel:i});if((0,o.a_)(r)?!(0,o.mv)(r.subfilter):!(0,o.mv)(r))return{property:t,filter:r}}function y(e){var t;const{collectionContextStore:n,applySubitemFilter:r}=e,a=n.currentPropertyFiltersStore.state,s=n.currentCombinatorFilterStore.state,l=r&&n.currentSubitemFormatStore.state,c=n.normalizedSchemaStore.state,u=l&&c[l.property],p=u&&"relation"===u.type&&(0,i.F0)(u)===(null===(t=n.collectionStore())||void 0===t?void 0:t.id)&&u.property,m=p?{property:p,filter:{operator:"is_empty"}}:void 0,f=(0,o.OH)({propertyFilters:a,combinatorFilter:s,schema:c});return d.oA([m,...f])}function _(e,t){var n,i;const a=e.collectionViewStore();if(!a)return{combinatorFilter:void 0,filters:{moveOps:[],removed:[],updated:[],moved:[],added:[]},sorts:void 0};const c="persisted"===t?a.getQueryStore().getKeyStore("sort").getValue()||[]:(null===(n=e.normalizedQueryStore.state)||void 0===n?void 0:n.sort)||[],u=e.currentSortsStore.state,p="persisted"===t?a.getQueryStore().getKeyStore("filter").getValue():null===(i=e.normalizedQueryStore.state)||void 0===i?void 0:i.filter,m=e.currentCombinatorFilterStore.state,f="persisted"===t?a.getPropertyFiltersStore().getValue()||[]:function(e){const t=e.normalizedSchemaStore.state,n=e.normalizedFormatStore.state.property_filters||[];return d.oA(n.filter((n=>{const i=(0,r.dN)(n.filter,t),a=e.collectionViewBlockStore();if(t[n.filter.property]&&i&&(0,o.J5)(t,n.filter.property,i.filter,null==a?void 0:a.getRecordModel))return i&&{id:n.id,filter:i}})))}(e),g=e.currentPropertyFiltersStore.state,h=f.map((e=>e.id)),v=g.map((e=>e.id)),{beforeOps:b,removeOps:y}=(0,l.q)(h,v),_=Array.from(y).filter((e=>!v.includes(e))),S=Object.keys(b).map((e=>({id:e,beforeId:b[e]}))),w=S.filter((e=>{let{id:t}=e;return h.includes(t)})).map((e=>{let{id:t}=e;return t})),k=S.filter((e=>{let{id:t}=e;return!h.includes(t)})).map((e=>{let{id:t}=e;return t})),I=g.filter((e=>f.find((t=>{if(e.id!==t.id)return!1;const n=d.Xh(t),o=d.Xh(e);return!d.Xy((0,s.Z)(o,"ignore-class-instances"),(0,s.Z)(n,"ignore-class-instances"))})))).map((e=>e.id));return{combinatorFilter:d.Xy(p,m)?void 0:{value:m},filters:{moveOps:S,removed:_,updated:I,moved:w,added:k},sorts:d.Xy(c,u)?void 0:{value:u}}}function S(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter||void 0!==t.sorts)}function w(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function k(e){const t=e.localStateDiffStore.state;return Boolean(void 0!==t.sorts)}function I(e){return{property:(0,i.uS)(e),filter:{operator:"string_contains",value:{type:"exact",value:void 0}}}}function x(e){const t=e.currentCombinatorFilterStore.state,n=e.currentPropertyFiltersStore.state.filter((e=>!(0,p.EE)(e.id))).map((e=>e.filter)),o=[...(null==t?void 0:t.filters)||[],...n];return{...t,filters:o,operator:"and"}}function C(e,t){const n=e.currentCombinatorFilterStore.state,o=e.currentPropertyFiltersStore.state.filter((e=>e.id!==t.id)),i=[...(null==n?void 0:n.filters)||[],t.filter];return{combinatorFilter:{operator:"and",...n,filters:i},propertyFilters:o}}function T(e,t,n,o){let i=n.filter((e=>"is_group"===e.type)).map((t=>e.find((e=>e.name===t.value)))).filter(u.$K),r=n.filter((e=>"is_option"===e.type)).map((e=>t.find((t=>t.value===e.value)))).filter(u.$K);for(const a of e){const e=a.optionIds??[];if(i.some((e=>e.id===a.id)))r=r.filter((t=>!e.includes(t.id)));else if(e.length>0){const t=r.filter((t=>!e.includes(t.id)));t.length+e.length===r.length&&(r=t,i=[...i,a])}}if("is_option"===o.type){const n=t.find((e=>e.value===o.value));if(!n)return;const a=r.filter((e=>e.id!==n.id));if(a.length<r.length)r=a;else{const o=e.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n.id)})),a=i.find((e=>e.id===(null==o?void 0:o.id)));if(a){const e=t.filter((e=>{var t;return(null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id))&&e.id!==n.id}));i=i.filter((e=>e.id!==a.id)),r=[...r,...e]}else{r=[...r,n];const e=(null==o?void 0:o.optionIds)??[];if(o&&e.length>0){const t=r.filter((t=>!e.includes(t.id)));t.length+e.length===r.length&&(r=t,i=[...i,o])}}}}else if("is_group"===o.type){const t=e.find((e=>e.name===o.value));if(!t)return;const n=i.filter((e=>e.id!==t.id));if(n.length<i.length)i=n;else{const e=t.optionIds??[];i=[...i,t],r=r.filter((t=>!e.includes(t.id)))}}else(0,u.t1)(o.type);return[...i.map((e=>({type:"is_group",value:e.name}))),...r.map((e=>({type:"is_option",value:e.value})))]}function M(e){const{group:t,options:n,filterValues:o}=e,i=o.some((e=>"is_group"===e.type&&e.value===t.name)),r=n.filter((e=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)})),a=new Map;for(const d of r){const e=o.some((e=>"is_option"===e.type&&e.value===d.value))||i;a.set(d.id,e)}const s=Array.from(a.values()),l=s.some((e=>e)),c=s.every((e=>e))&&s.length>0;return{groupCheckState:!(!i&&!c)||!!l&&"partial",optionCheckedInfo:a}}function P(e){var t;const{collectionStore:n,collectionContextStore:i,environment:r}=e,s=i.relativeVariableStore.state,l=i.currentPropertyFiltersStore.state,d=i.currentCombinatorFilterStore.state,u=l.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter));if(0===u.length&&!d)return;const p=null==n?void 0:n.getModel(),f=null===(t=i.collectionViewStore())||void 0===t?void 0:t.getCollectionSource(),g=i.normalizedSchemaStore.state,v={schema:p&&f?(0,a.Hs)(f.type,g,p):g,userId:r.currentUser.id,userTimeZone:(0,c.r)(),userStartOfWeek:m.AK.state,intl:h.default.getIntl(),relativeVariableResult:s};return{filter:{filters:d?[...u,d]:u,operator:"and"},context:v}}function A(e,t,n){const{property:o}=t,r=e[o];if(!(r&&"rollup"===r.type&&r.relation_property&&r.target_property))return r;{const t=e[r.relation_property];if(t&&(0,i.p_)(t)){const e=(0,i.j0)(t);if(e){const t=n.getRecordModel(e);if(!t)return;const o=t.getNormalizedSchema();if(o){const e=o[r.target_property];if(e&&"rollup"!==e.type)return e}}}}}function R(e){const t=e.collectionViewStore(),n=e.currentSubitemFormatStore.state,i=null==t?void 0:t.getType(),r=y({collectionContextStore:e,applySubitemFilter:Boolean(n)&&!(i&&(0,g.Av)(i))});return(0,o.kk)(r)}},4708:(e,t,n)=>{n.d(t,{$d:()=>C,A3:()=>y,B9:()=>_,En:()=>I,F$:()=>g,H1:()=>M,Or:()=>u,Rv:()=>p,T2:()=>x,Ye:()=>d,_6:()=>l,dk:()=>T,fJ:()=>w,gp:()=>m,kG:()=>k,m7:()=>A,p1:()=>c,s$:()=>b,u3:()=>v,uD:()=>S,wE:()=>h,wd:()=>P,zq:()=>f});n(13991),n(95477);var o=n(77080),i=n(88893),r=n(35057),a=n(38755),s=n(95697);function l(e){return!e.device.isMobile&&"on"===o.default.getEligibleGroup({experimentId:"contextual-invite-on-select-focus",defaultGroup:"control"})}function c(){return i.ye()&&"on"===o.default.getEligibleGroup({experimentId:"request_membership",defaultGroup:"control"})}function d(e){return i.ye()&&!(0,r.wP)()&&"on"===o.default.getEligibleGroup({experimentId:"guest_membership_request",defaultGroup:"control"})}function u(){return b()}function p(){return(0,r.Mk)()}function m(e){let{currentSpaceStore:t}=e;return!!(0,a.Q9)(t)&&"on"===o.default.getEligibleGroup({experimentId:"share_modal_placeholder",defaultGroup:"control"})}function f(e){return!e.device.isMobile}function g(){return(0,s.bq)()&&"on"===o.default.getEligibleGroup({experimentId:"teamspace_guests",defaultGroup:"control"})}function h(e){return!e.device.isMobile&&o.default.checkGate("space_settings_people_section")}function v(){return(0,s.bq)()&&"on"===o.default.getEligibleGroup({experimentId:"teams_invite_link",defaultGroup:"control"})}function b(){return(0,s.bq)()&&"on"===o.default.getEligibleGroup({experimentId:"team_invite_link_ms2",defaultGroup:"control"})}function y(){return o.default.checkGate("drawing_block")}function _(){return o.default.checkGate("team_add_app_template_tooltip")}function S(){return o.default.getEligibleGroup({experimentId:"share_modal_autofill_email",defaultGroup:"control"})}function w(){return"on"===o.default.getEligibleGroup({experimentId:"share_modal_pending_invite_status_ui",defaultGroup:"control"})}function k(e){if(!(0,a.Fn)(e))return"control";return(0,s.$)(e)?"control":o.default.getEligibleGroup({experimentId:"share_modal_guest_member_confirmation",defaultGroup:"control"})??"control"}function I(){return!1}function x(){return o.default.checkGate("sites_published_settings")}function C(){return o.default.checkGate("sites_multiple_domains")}function T(){return o.default.checkGate("sites_banner")}function M(){return o.default.checkGate("sites_search_engine_index_for_all")}function P(){return o.default.checkGate("guest_invite_requests")}function A(){return"on"===o.default.getEligibleGroup({experimentId:"blue_signup_buttons",defaultGroup:"control"})}},14976:(e,t,n)=>{n.d(t,{Dn:()=>ne,Gj:()=>le,IY:()=>W,Ob:()=>me,PY:()=>ue,Qb:()=>J,Rl:()=>ge,SD:()=>oe,So:()=>fe,TQ:()=>ve,Ut:()=>X,We:()=>be,Xh:()=>q,bD:()=>z,cD:()=>ce,fm:()=>de,kV:()=>ae,li:()=>ie,lw:()=>ee,n$:()=>Q,vO:()=>re,x9:()=>Y,xX:()=>pe});var o=n(22377),i=n(15095),r=n(42875),a=n(72126),s=n(82883),l=n(21202),c=n(70203),d=n(44805),u=n(63143),p=n(993),m=n(32741),f=n(48514),g=n(95477),h=n(24990),v=n(33929),b=n(68056),y=n(77080),_=n(30874),S=n(26136),w=n(24666),k=n(46150),I=n(41056),x=n(62619),C=n(83631),T=n(45162),M=n(70219),P=n(65598),A=n(31352),R=n(89224);function D(e){return x.kK(e)&&e.classList.contains(d.Eu)}function B(e){return x.kK(e)&&e.classList.contains(d.tL)}function E(e){return function(e){const t=x.sh(e,(e=>(0,C.Xu)(e)||(0,k.eD)(e)));if(t&&D(t))return t}(e)||Z(e)||function(e){const t=x.sh(e,(e=>B(e)||(0,k.eD)(e)));if(t&&B(t))return t}(e)}function F(e){return x.kK(e)&&e.classList.contains(o.P)}function Z(e){const t=x.sh(e,(e=>(0,C.Xu)(e)||(0,k.eD)(e)));if(t&&(0,C.Xu)(t))return t}const V=function(e){return x.kK(e)&&e.classList.contains(d.mb)},j=function(e){if(V(e))return!0;try{return V(e.parentNode)}catch(t){return!1}},U=function(e){try{const t=x.sh(e,(e=>Boolean(e.getAttribute&&e.getAttribute("contenteditable"))||(0,k.eD)(e)));return t&&t.isContentEditable}catch(t){return!1}};function L(e){return x.kK(e)&&e.classList.contains(d.$A)}function O(e,t){if(e===t.container){if(x.Gs(e)){const n=e.textContent||"";return(0,i.p4)(n.substring(0,t.offset)).length}{const n=Array.from(e.childNodes).slice(0,t.offset).map((e=>G(H(e)))).join("");return(0,i.p4)(n).length}}let n=0;for(const o of Array.from(e.childNodes)){if(o.contains(t.container))return n+O(o,t);n+=(0,i.p4)(G(H(o))).length}return n}function N(e,t){const n=(0,k.X1)(e);if(!n)return 0;return O(n,function(e,t){const n=E(e);if(n){const e=n.parentNode,o=Array.from(e.childNodes).indexOf(n);return{container:e,offset:0===t?o:o+1}}if(V(e)||V(e.parentNode))return{container:e,offset:(e.textContent||" ").length-1};return{container:e,offset:t}}(e,t))}function z(e,t){if(0===t)return!(e.childNodes.length>0)||D(e.childNodes[0])||F(e.childNodes[0])||(0,C.Xu)(e.childNodes[0])||B(e.childNodes[0])||L(e.childNodes[0])?{container:e,offset:0}:{container:e.childNodes[0],offset:0};const n=a.cx(e.childNodes,L),o=n>=0?n-1:e.childNodes.length-1;let r=t;for(let s=0;s<=o;s++){const t=e.childNodes[s],n=G(H(t)),l=(0,i.p4)(n).length;if(s===o?r-l<=0:r-l<0){if(D(t)||(0,C.Xu)(t)||F(t)||V(t)||B(t)){const e=x.oG(t.parentNode,t);return{container:t.parentNode,offset:e}}if(t.nodeType===Node.TEXT_NODE){return{container:t,offset:a.tP((0,i.p4)(n),0,r).join("").length}}return z(t,r)}r-=l}return{container:e,offset:0}}function W(e){const{environment:t,textValue:n,parentStore:o,disableHover:i,disableStyleAnnotations:a,disableInsertedDeletedAnnotations:s,disableDateStyleAnnotations:l,disabled:c,emojiType:u,highlightDiscussionId:p,renderedPageBlockId:m,parentBlockId:f,theme:b,katex:S,disableLinks:w,formulaValueTypes:k,stopLinkPropagation:x,linkTargetBlank:C}=e,{device:T,currentUser:P}=t,A=y.default.checkGate("enable_deleted_page_indicator");return d.IY({textValue:n,getRecordModel:o.getRecordModel,getRecordRole:o.getRecordRole,disableHover:i,disableStyleAnnotations:a,disableInsertedDeletedAnnotations:s,disableDateStyleAnnotations:l,disableLinks:w||!1,userTimeZone:(0,r.r)(),disabled:c,isAndroid:T.isAndroid,isSafariOrIOS:T.isSafari||T.isIOS,isWindows:T.isWindows,showEmojiInline:T.isWindows,emojiType:u,highlightDiscussionId:p,theme:b,intl:v.default.getIntl(),renderedPageBlockId:m,parentBlockId:f,katex:S,isClient:!0,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,currentUserId:P.id,overwriteBaseUrlFromSpaceId:(0,M.b)(t),externalIntegrations:_.Z.integrations.state,formulaValueTypes:k,enableDeletedPageIndicator:A,stopLinkPropagation:x,linkTargetBlank:C,emojiData:h.Z.state,getToday:I.H,isMobileNative:T.isMobileNative,isMobileNativeExternalLinkFixEnabled:y.default.checkGate("mobile_native_external_link_fix"),displayInUserTimezone:y.default.checkGate("display_date_in_user_timezone")})}const q=function(e,t){return(0,s.X)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:(0,r.r)(),intl:v.default.getIntl()})};function H(e){let t="";if(D(e))t+=c.qyI;else if((0,C.Xu)(e))t=c.fuX;else if(F(e))t+=e.alt;else if(function(e){return x.kK(e)&&"br"===e.tagName.toLowerCase()}(e))t+="\n";else if(x.Gs(e))t+=e.textContent;else if(B(e));else for(const n of Array.from(e.childNodes))t+=H(n);return t}const K=new RegExp(d.U3,"g");function G(e){return e.replace(K,"")}const $={[c.qyI]:{deleteEndToken:new RegExp(`${c.qyI}$`,"g"),deleteToken:new RegExp(`(${c.qyI})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.qyI}${d.U3}`,"g")},[c.fuX]:{deleteEndToken:new RegExp(`${c.fuX}$`,"g"),deleteToken:new RegExp(`(${c.fuX})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.fuX}${d.U3}`,"g")}};function Q(e,t){if(!t)return"";let n=H(t);if(e.device.isAndroid)for(const[o,i]of Object.entries($))n=n.replace(i.deleteEndToken,"").replace(i.deleteToken,"$2").replace(i.existingToken,o);return"\n"===n[n.length-1]&&(n=n.substring(0,n.length-1)),n}function Y(e,t,n){if(!e)return!1;let o=n,i=t;for(;i!==e&&!L(i);){const{parentNode:e}=i;if(!e)break;o=x.oG(e,i),i=e}if(L(i))return o>0;const r=a.cx(e.childNodes,L);return!(r<0)&&(i===e&&o>r)}function J(e,t){const n=(0,k.X1)(e);if(!n)return;const o=N(e,t),i=E(e);return{index:o,forceEmit:Boolean(i),afterEndOfLine:Y(n,e,t)}}function X(e,t){if(t||(t=R.get()),t){const e=N(t.startContainer,t.startOffset),n=N(t.endContainer,t.endOffset),o=E(t.startContainer)||E(t.endContainer);return{selection:{startIndex:e,endIndex:n},forceEmitSelectionStore:Boolean(o)}}}function ee(e,t,n){const o=z(e,t),i=z(e,n);return R.rangeFromContainerOffsets({start:o,end:i})}function te(e,t,n,o){if(e===n&&t===o)return!0;if(j(e)!==j(n))return!1;if(Z(e)!==Z(n))return!1;const i=(0,k.X1)(e),r=(0,k.X1)(n);if(i!==r)return!1;if(N(e,t)!==N(n,o))return!1;return Y(i,e,t)===Y(r,n,o)}function ne(e,t){return!e&&!t||!(!e||!t)&&(e.startOffset===t.startOffset&&e.endOffset===t.endOffset&&e.startContainer===t.startContainer&&e.endContainer===t.endContainer||U(e.startContainer)&&U(t.startContainer)&&te(e.startContainer,e.startOffset,t.startContainer,t.startOffset)&&te(e.endContainer,e.endOffset,t.endContainer,t.endOffset))}function oe(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a,disableEquationInteraction:s}=e,l=se({event:n,textValue:o,editorNode:i});(t.device.isFirefox||"editing"!==w.default.state.mode||w.default.isEmptySelection()||l&&(0,C.Xu)(l.node))&&l&&(s&&(0,C.Xu)(l.node)||p.VO({environment:t,event:n,interactiveToken:l,store:r,canEdit:a}))}function ie(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,parentStore:a,canEdit:s}=e,l=se({event:n,textValue:o,editorNode:i});l&&p.ON({environment:t,event:n,interactiveToken:l,store:r,parentStore:a,canEdit:s})}function re(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a}=e,s=se({event:n,textValue:o,editorNode:i});s&&p.Nh({environment:t,event:n,interactiveToken:s,store:r,canEdit:a})}function ae(e){const{environment:t,event:n,textValue:o,editorNode:i,store:r,canEdit:a}=e;if(n.target===i)return void m.lY();const s=se({event:n,textValue:o,editorNode:i});s&&p.Zl({environment:t,event:n,interactiveToken:s,store:r,canEdit:a})}function se(e){const{event:t,textValue:n,editorNode:o}=e,i=x.sh(t.target,(e=>Boolean(e.getAttribute&&e.getAttribute("data-token-index"))));if(i&&null!=o&&o.contains(i)){const e=i.getAttribute("data-token-index");if(e){const t=parseInt(e,10);if(n){const e=n[t];if(e)return{textValue:n,tokenIndex:t,textToken:e,node:i}}}}}const le=e=>de({store:e.store,temporaryAnnotation:c.GKr.TemporaryComment,multiSelection:f.Z.state.open&&"inline"===f.Z.state.type?f.Z.state.multiSelection:void 0}),ce=e=>{const{store:t,find:n}=e;let o=t.getValue();if(!o)return;return c.Oqk({textValue:o,substring:n,ignoreCase:!0}).forEach(((e,t)=>{o=c.aSf({textValue:o,selection:e,annotation:[c.GKr.TemporaryFindHighlight]})})),o},de=e=>{const{store:t,temporaryAnnotation:n,multiSelection:o}=e,i=t.getValue();if(o){const e=(0,T.L5)(o).find((e=>{let{store:n}=e;return n===t}));if(e){const{selection:t}=e;return c.aSf({textValue:i,selection:t,annotation:[n]})}}return i};function ue(e){const{store:t,equationStore:n}=e;if(!n.isOpen())return;const o=(0,b.QY)(n.state.savedTextSelectionState.multiSelection);if(!o)return;const{store:i,selection:r}=o;if(t!==i)return;const a=i.getValue(),s=r.startIndex===r.endIndex?a:c._QS(a,r.startIndex,r.endIndex),l=C.qZ({equationState:n.state,isTemporary:!0});return l?c.P$X(s,[l],r.startIndex):void 0}function pe(e){const{store:t,selection:n}=e,o=t.getValue();if(n.startIndex+1!==n.endIndex)return o;const i=c.b1T(o,n.startIndex);if(!i||!c.eOb(i))return o;const r=n.startIndex===n.endIndex?o:c._QS(o,n.startIndex,n.endIndex),a=(0,u.uh)(i[1],c.rIb),s=[i[0],[...a,c.EPB()]];return c.P$X(r,[s],n.startIndex)}function me(e){const{store:t,mentionMenuState:n}=e,o=t.getValue();if(n.textStore!==t)return o;const i=n.temporaryInputData.state;if(!i)return o;const r=(0,A.O2)(t,n.oldTextValue,i.prefix);if(r&&r.prefix){const{tokensBeforeRange:e,tokensInsideRange:t,tokensAfterRange:n}=c.xrQ(o,r.prefix.startIndex,r.filter.endIndex),a=c.QaF(t);return[...e,c.V3y(a,[c.mF$(i)]),...n]}return o}function fe(e){const{store:t,selection:n}=e,o=t.getValue(),{tokensBeforeRange:i,tokensInsideRange:r,tokensAfterRange:a}=c.xrQ(o,n.startIndex,n.endIndex),s=c.QaF(r);return[...i,c.V3y(s,[[c.GKr.TemporarySelection]]),...a]}const ge=e=>{let{store:t,textValue:n}=e;if(!n)return n;if(t.table!==l.iU)return n;const o=S.G.createChildStore(t,{table:t.table,id:t.id});if(o.isInsideCollection()||o.isType("callout")||o.isType("code"))return n;let i=n;return(0,P.bB)((0,P.yJ)(o)).unresolved.forEach((e=>{const t=["m",e.id];i=c.aSf({textValue:i,annotation:t,selection:{startIndex:0,endIndex:1/0}})})),i};function he(e){if(e.nodeType===Node.TEXT_NODE)return e;if(x.kK(e)&&"false"===e.getAttribute("contentEditable"))return e;let t;const n=x.kd(e);return n.forEach((e=>{null!==e.textContent&&e.textContent.indexOf("\n")>=0&&(t=e)})),t||(n.length>0?n[n.length-1]:e)}function ve(e){const t=R.get();if(!t)return;const n=t.startContainer,o=(0,k.X1)(n),i=null==o?void 0:o.childNodes,r=!R.isExpanded(t);if(i&&(i.length>1||r)){const r=(0,k.g4)(n,o),g=a.cx(i,(e=>e===r));let h,v,b=!0,y=n,_=t.startOffset;if(0===_)for(let e=g-1;b&&e>=0;e--){const t=he(i[e]);if(t.nodeType===Node.TEXT_NODE){var s;const e=null===(s=t.textContent)||void 0===s?void 0:s.lastIndexOf("\n");var l,c;if(void 0!==e&&e>=0)null!==(l=t.textContent)&&void 0!==l&&l.length&&e+1<(null===(c=t.textContent)||void 0===c?void 0:c.length)&&(y=t,_=e+1),b=!1;else y=t,_=0}else y=t,_=0}b=!0;for(let e=g;b&&e<i.length;e++){const t=he(i[e]);if(t.nodeType===Node.TEXT_NODE){let e;var d,u,p,m;if(y===t)e=null===(d=t.textContent)||void 0===d?void 0:d.indexOf("\n",_);else e=null===(u=t.textContent)||void 0===u?void 0:u.indexOf("\n");if(void 0!==e&&e>=0)h=t,v=e+1===(null===(p=t.textContent)||void 0===p?void 0:p.length)?e:e+1,b=!1;else h=t,v=(null===(m=t.textContent)||void 0===m?void 0:m.length)||0}else{var f;h=t,v=(null===(f=t.textContent)||void 0===f?void 0:f.length)||0}}if(y&&h){const t=R.rangeFromContainerOffsets({start:{container:y,offset:_},end:{container:h,offset:v||0}});R.set(t,e)}}}function be(e,t){const n=c.$0A(e.id,e.getSpaceId()),o=c.YCD(n);return{textValue:[o],tokenIndex:0,textToken:o,node:t}}},70764:(e,t,n)=>{n.d(t,{NP:()=>s,QS:()=>f,mO:()=>c,sw:()=>m,xt:()=>p});var o=n(20270),i=n(9291),r=(n(95477),n(77080)),a=n(30874);function s(e){const t=a.Z.state;return t.loaded?t.bots.filter((t=>t.integration_id===e)):[]}const l=(0,i.defineMessages)({invalidRequest:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidRequest",defaultMessage:"The authentication request is invalid. Please contact support if issue persists."},unauthorizedClient:{id:"unfurlingHelpers.unauthorizedClient.",defaultMessage:"The client is not authorized to request an authorization code using this method. Please contact support if issue persists."},accessDenied:{id:"unfurlingHelpers.authenticatedErrorDescription.accessDenied",defaultMessage:"The resource owner or authorization server denied the request. Check with your organization or resource owner to ensure OAuth installation is enabled."},unsupportedResponseType:{id:"unfurlingHelpers.authenticatedErrorDescription.unsupportedResponseType",defaultMessage:"The authorization server does not support obtaining an authorization code using this method. Please contact support if issue persists."},invalidScope:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidScope",defaultMessage:"The requested scope is invalid. Please contact support if issue persists."},serverError:{id:"unfurlingHelpers.authenticatedErrorDescription.serverError",defaultMessage:"The authorization server encountered an unexpected condition that prevented it from fulfilling the request. Please contact support if issue persists."},temporarilyUnavailable:{id:"unfurlingHelpers.authenticatedErrorDescription.temporarilyUnavailable",defaultMessage:"The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server. Please contact support if issue persists."},githubAppRequestAccessUnsupported:{id:"unfurlingHelpers.authenticatedErrorDescription.githubAppRequestAccessUnsupported",defaultMessage:"Request Access is not supported. You must be both a Github Admin and Notion Workspace Admin to connect the two apps."},unknownError:{id:"unfurlingHelpers.authenticatedErrorDescription.unknownError",defaultMessage:"The authorization server responded with an unknown error (`{value}`). Please contact support if issue persists."}});function c(e){return"invalid_request"===e?l.invalidRequest:"unauthorized_client"===e?l.unauthorizedClient:"access_denied"===e?l.accessDenied:"unsupported_response_type"===e?l.unsupportedResponseType:"invalid_scope"===e?l.invalidScope:"server_error"===e?l.serverError:"temporarily_unavailable"===e?l.temporarilyUnavailable:"github_app_request_access_unsupported"===e?l.githubAppRequestAccessUnsupported:l.unknownError}const d=(0,i.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseError.unknownError",defaultMessage:"Can't load preview"},accessDenied:{id:"unfurlingHelpers.unfurlResponseError.accessDenied",defaultMessage:"Access denied"},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseError.reAuthenticate",defaultMessage:"Re-authentication necessary"},notFound:{id:"unfurlingHelpers.unfurlResponseError.notFound",defaultMessage:"Content not found"},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseError.unprocessableEntity",defaultMessage:"Unrecognized URL"},rateLimited:{id:"unfurlingHelpers.unfurlResponseError.rateLimited",defaultMessage:"Too many requests"},serverError:{id:"unfurlingHelpers.unfurlResponseError.serverError",defaultMessage:"Can't load preview"},invalidRequest:{id:"unfurlingHelpers.unfurlResponseError.invalidRequest",defaultMessage:"Can't load preview"},authRefresh:{id:"unfurlingHelpers.unfurlResponseError.authRefresh",defaultMessage:"Fetching Preview"},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.githubNotAcceptable",defaultMessage:"Need owner role"},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.jiraNotAcceptable",defaultMessage:"Synced in another workspace"},notAcceptable:{id:"unfurlingHelpers.unfurlResponseError.notAcceptable",defaultMessage:"Not Acceptable"},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseError.databaseSyncLimit",defaultMessage:"Synced Database limit reached"}}),u=(0,i.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unknownError",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},accessDenied:{id:"unfurlingHelpers.unfurlResponseErrorDescription.accessDenied",defaultMessage:"You do not have appropriate permission to access this resource."},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseErrorDescription.reAuthenticate",defaultMessage:"You need to re-authenticate your account to access this resource."},notFound:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notFound",defaultMessage:"The resource information for this link could not be found. It may no longer exist or you may not have appropriate permission to access it."},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unprocessableEntity",defaultMessage:"This url is not currently embedable by this integration."},rateLimited:{id:"unfurlingHelpers.unfurlResponseErrorDescription.rateLimited",defaultMessage:'"{integrationName}" received too many requests for you or your organization. Please wait a few minutes and try again.'},serverError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.serverError",defaultMessage:'Oh no! Seems like there was a "{integrationName}" server error. Received error code "{statusCode}".'},invalidRequest:{id:"unfurlingHelpers.unfurlResponseErrorDescription.invalidRequest",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},authRefresh:{id:"unfurlingHelpers.unfurlResponseErrorDescription.authRefresh",defaultMessage:"Fetching Preview via Login Update, please wait."},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.githubNotAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.jiraNotAcceptable",defaultMessage:"You have synced this resource in another workspace."},notAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseErrorDescription.databaseSyncLimit",defaultMessage:"Your workspace has hit the Synced Database limit."}});function p(e,t){return void 0===e?{message:d.unknownError,description:u.unknownError}:401===e?{message:d.reAuthenticate,description:u.reAuthenticate}:439===e?{message:d.authRefresh,description:u.authRefresh}:403===e?{message:d.accessDenied,description:u.accessDenied}:404===e?{message:d.notFound,description:u.notFound}:422===e?{message:d.unprocessableEntity,description:u.unprocessableEntity}:429===e?{message:d.rateLimited,description:u.rateLimited}:406===e?"jira"===t?{message:d.jiraNotAcceptable,description:u.jiraNotAcceptable}:"github"===t?{message:d.githubNotAcceptable,description:u.githubNotAcceptable}:{message:d.notAcceptable,description:u.notAcceptable}:417===e?{message:d.databaseSyncLimit,description:u.databaseSyncLimit}:(0,o.Ms)(e)?{message:d.serverError,description:u.serverError}:{message:d.invalidRequest,description:u.invalidRequest}}function m(e){return!e.device.isMobileBrowser}function f(){return"on"===r.default.getGroup("beta-developers-external")}},15010:(e,t,n)=>{n.d(t,{JF:()=>a,QZ:()=>r,WD:()=>l,e2:()=>s});n(92996);var o=n(44317),i=(n(40663),n(80444));function r(){const{currentUserSettingsStore:e,currentSpaceStore:t}=i.default.state,n=(null==e?void 0:e.getSettings())||{},o=null==t?void 0:t.getPlanType();return"professional"===n.domain_type&&"team"===o}function a(){const{currentUserSettingsStore:e}=i.default.state;return((null==e?void 0:e.getSettings())||{}).domain_type}function s(e){const t=e.getSettings(),n=null==t?void 0:t.signup_time;return n?(0,o.O5)(n):null}function l(e){const{currentUserSettingsStore:t}=i.default.state;if(t&&t.id===e.currentUser.id)return t}},56518:(e,t,n)=>{n.d(t,{Ef:()=>x,FQ:()=>C,Gp:()=>y,IU:()=>h,Li:()=>v,X4:()=>S,ZI:()=>k,ax:()=>I,nZ:()=>_,tt:()=>b,xF:()=>g});var o=n(15145),i=n(97531),r=n(1800),a=n(42875),s=n(25718),l=n(482),c=n(74446),d=n(21202),u=n(97880),p=n(95477),m=n(26136),f=n(33929);const g="paste";function h(e){let t,n;const o=new Set,i=new Set;for(const r of e){const e=r.getParentBlockStore();if(e&&"column"===e.getType()){o.add(e.id),i.add(r.id);const a=e.getParentBlockStore();if(a&&"column_list"===a.getType()){n=a.getSpaceId();const e=a.id;if(void 0===t&&(t=e),t!==e)return}}}if(t&&o.size>1&&n)return{columnListId:t,columnIds:o,blockIds:i,spaceId:n}}function v(e,t){if(!e.clipboardData)return;const n=e.clipboardData.getData("text/html");e.clipboardData.setData("text/html",`${n}${y(t)}`)}function b(e){if(!e.clipboardData)return;return _(e.clipboardData.getData("text/html"))}function y(e){return`\x3c!-- notionvc: ${e} --\x3e`}function _(e){const t=e.match(/\<\!-- notionvc\: ([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}) --\>$/i);return t?t[1]:void 0}function S(e){const{blockValues:t,rootBlock:n,getRecordValue:o,isWindows:i,markdownSerializationOptions:r,markdownLinkifyIt:a}=e;let l=s.on(t,{...I({rootBlock:n,getRecordValue:o}),transformAnnotation:null==r?void 0:r.transformAnnotation,transformBlockMapping:null==r?void 0:r.transformBlockMapping});const c={markdown:void 0,html:void 0};if(l){l=l.replaceAll(w,"$1"),c.markdown=k(i,l);const e=a&&s.c8({...a,markdown:l});e&&(c.html=k(i,e))}return c}const w=/\[(https?:\/\/[^\])]+)\]\(\1\)/g;function k(e,t){return e?t.split("\r\n").reduce(((e,t)=>[...e,...t.split("\n")]),[]).join("\r\n"):t}function I(e){const{rootBlock:t,getRecordValue:n}=e;return{root:t,navigableBlockId:t.id,renderParentBlockId:void 0,blockId:t.id,userTimeZone:(0,a.r)(),intl:f.default.getIntl(),getRecordValue:n,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,r.Z)({pageId:t,pageValue:n({table:d.iU,id:t}),baseUrl:p.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,resultCache:new Map}}function x(e){const{rootBlock:t,clipboardData:n,isWindows:o,fallbackGetRecordValue:i,markdownSerializationOptions:r,markdownLinkifyIt:a}=e,{tree:s,blockSelection:l}=n,d=c.mF.tryUntilFound(...l.blocks.map((e=>e.blockSubtree&&c.mF.fromRecordMap(e.blockSubtree))).filter(u.$K),i),p=s.value,m=l.blocks.map((e=>d({...p,id:e.blockId}))).filter(u.$K);return S({rootBlock:t,getRecordValue:d,blockValues:m,isWindows:o,markdownSerializationOptions:r,markdownLinkifyIt:a})}function C(e){const t=e.pointerPath[e.pointerPath.length-1];return m.G.isTextSliceTreeTextValuePath(e.attributePath)?[l.op.set({pointer:t,path:["properties","title"],args:e.copiedText}),l.op.update({pointer:t,path:["format"],args:(0,i.K$)(t.id,e.copiedText)})]:[l.op.set({pointer:t,path:e.attributePath,args:e.copiedText})]}},75079:(e,t,n)=>{n.d(t,{Pn:()=>a,Pp:()=>p,Y5:()=>d,ZO:()=>l,vS:()=>s,yr:()=>u});var o=n(43690),i=n(58421),r=n(77144);function a(e,t){const n=null==e?void 0:e.collectionViewBlockStore(),o=null==e?void 0:e.collectionStore(),r=null==e?void 0:e.collectionViewStore(),a=null==e?void 0:e.filtersBarOpenStore.state,s=null==r?void 0:r.getType(),l=(null==e?void 0:e.settingsStore)&&(0,i.n)(null==e?void 0:e.settingsStore),c=null==n?void 0:n.id;return{view_type:s,settings_menu:null!=e&&e.settingsStore.state.open&&l?l.type:void 0,collection_id:t||(null==o?void 0:o.id),collection_view_id:null==r?void 0:r.id,collection_view_block_id:c,filters_bar_open:a,is_in_wiki:null==n?void 0:n.isCollectionViewPageWithContent()}}function s(e,t){var n,o,i,r,a,s;if(!e)return{view_type:"missing_context_store",row_count_category:"missing_context_store",column_count_category:"missing_context_store",has_relation_column:"missing_context_store",has_rollup_column:"missing_context_store",has_formula_column:"missing_context_store",is_client_mode_enabled:"missing_context_store",tracking_source:void 0,collection_view_block_id:"missing_context_store",collection_view_id:"missing_context_store",collection_id:"missing_context_store",collection_type:"missing_context_store"};const d=e.isClientModeEnabled.state,u=(null===(n=e.collectionViewBlockStore())||void 0===n?void 0:n.id)||"missing",p=(null===(o=e.collectionViewStore())||void 0===o?void 0:o.id)||"missing",m=(null===(i=e.collectionStore())||void 0===i?void 0:i.id)||"missing",f=null===(r=e.collectionViewStore())||void 0===r?void 0:r.getCollectionSource(),g=null===(a=e.collectionStore())||void 0===a?void 0:a.getSchema();if(!g)return{view_type:"missing_schema",row_count_category:"missing_schema",column_count_category:"missing_schema",has_relation_column:"missing_schema",has_rollup_column:"missing_schema",has_formula_column:"missing_schema",is_client_mode_enabled:d,tracking_source:t,collection_view_block_id:u,collection_view_id:p,collection_id:m,collection_type:(null==f?void 0:f.type)||"missing"};const{has_relation_column:h,has_rollup_column:v,has_formula_column:b}=function(e){const t="missing_schema";if(void 0===e)return{has_relation_column:t,has_rollup_column:t,has_formula_column:t};let n=!1,o=!1,i=!1;for(const r of Object.values(e))if("relation"===(null==r?void 0:r.type)&&(n=!0),"rollup"===(null==r?void 0:r.type)&&(o=!0),"formula"===(null==r?void 0:r.type)&&(i=!0),n&&o&&i)break;return{has_relation_column:n,has_rollup_column:o,has_formula_column:i}}(g);return{view_type:e.getViewType()||"unknown",row_count_category:l(null===(s=e.remoteResult.state)||void 0===s?void 0:s.sizeHint),column_count_category:c(g),has_relation_column:h,has_rollup_column:v,has_formula_column:b,is_client_mode_enabled:d,tracking_source:t,collection_view_block_id:u,collection_view_id:p,collection_id:m,collection_type:(null==f?void 0:f.type)||"missing"}}function l(e){return void 0===e?"unknown":e<=100?"0-100":e<=200?"100-200":e<=300?"200-300":e<=400?"300-400":e<=500?"400-500":e<=600?"500-600":e<=700?"600-700":e<=800?"700-800":e<=900?"800-900":e<=1e3?"900-1000":"1001_or_more"}function c(e){const t=Object.keys(e).length;return t<=10?"0-10":t<=20?"10-20":t<=50?"20-50":"51_or_more"}function d(e){const{from:t,collectionContextStore:n,sizeHintAtStart:o}=e,i=s(n),{row_count_category:r,...a}=i;return{...a,from:t,property_type:"property_type"in e?e.property_type:void 0,did_trigger_fetch:n?n.isLoading.state:"missing_context_store",row_count_category:l(o)}}function u(e){const{collectionContextStore:t,is_native_drop:n,is_empty:o}=e;return{...s(t),is_native_drop:n,is_empty:o}}function p(e){const{collectionContextStore:t,visibleItemsCount:n}=e,i=s(t),a=t.remoteResult.state?o.aW({result:t.remoteResult.state}).length:0,l=0===a?void 0:n/a;return{...i,percentage_of_remote_result_visible:void 0===l?"empty_remote_result":0===l?"0":l<=.25?"0-25":l<=.5?"25-50":l<=.75?"50-75":l<1?"75-100":1===l?"100":"greater_than_100",wasm_sqlite_initialized:r.Z.state.metricData.state.wasm_sqlite_initialized}}},17335:(e,t,n)=>{n.d(t,{$7:()=>_,D0:()=>k,Fc:()=>S,HL:()=>C,IF:()=>A,KV:()=>G,Qz:()=>$,SW:()=>Y,Sb:()=>w,Sj:()=>y,WC:()=>v,_T:()=>R,cq:()=>E,ip:()=>T,li:()=>q,qh:()=>z,rn:()=>m,x:()=>x,xe:()=>J,zZ:()=>g});var o=n(2032),i=n(76205),r=n(34299),a=n(78106),s=n(72126),l=n(97880),c=n(4308),d=n(9291),u=n(33929);const p={text:{operator:"string_contains",value:{type:"exact",value:void 0}},relation:{operator:"relation_contains",value:{type:"exact",value:void 0}},url:{operator:"string_contains",value:{type:"exact",value:void 0}},checkbox:{operator:"checkbox_is",value:{type:"exact",value:void 0}},created_by:{operator:"person_contains",value:{type:"exact",value:void 0}},last_edited_by:{operator:"person_contains",value:{type:"exact",value:void 0}},select:{operator:"enum_is",value:{type:"exact",value:void 0}},multi_select:{operator:"enum_contains",value:{type:"exact",value:void 0}},status:{operator:"status_is",value:{type:"is_group",value:void 0}},person:{operator:"person_contains",value:{type:"exact",value:void 0}},number:{operator:"number_equals",value:{type:"exact",value:void 0}},auto_increment_id:{operator:"number_equals",value:{type:"exact",value:void 0}},date:{operator:"date_is_relative_to",value:{type:"relative",value:"surrounding",unit:"week"}},created_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_edited_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_visited_time:{operator:"date_is",value:{type:"exact",value:void 0}},email:{operator:"string_contains",value:{type:"exact",value:void 0}},phone_number:{operator:"string_contains",value:{type:"exact",value:void 0}},title:{operator:"string_contains",value:{type:"exact",value:void 0}},file:{operator:"is_empty"},location:{operator:"location_is",value:{type:"exact",value:void 0}},verification:{operator:"verification_is",value:{type:"exact",value:void 0}}};function m(e){return p[e]}function f(e){return"v2"===e.version?function(e){if(!e.formula2)return{operator:"is_empty"};const t=e.formula2.result_type;if("array"===t.type){const e=(0,a.B8)(t.of);return"array"===e.type||"function"===e.type?{operator:"is_empty"}:"block"===e.type||"unknown"===e.type?{operator:"any",subfilter:m("text")}:{operator:"any",subfilter:m(e.type)}}if("unknown"===t.type||"block"===t.type)return m("text");return m(t.type)}(e):function(e){return e.formula&&e.formula.result_type?m(e.formula.result_type):{operator:"is_empty"}}(e)}function g(e){const{property:t,schema:n}=e,a=n[t];if(!a||"button"===a.type)return{operator:"is_empty"};if("formula"===a.type)return f(a);if("rollup"===a.type){if(a.aggregation&&"show_unique"!==a.aggregation){return m((0,o.W6)((0,o.gu)(a.aggregation)))}{const t=(0,r.gT)(e);if(!t){return{operator:"any",subfilter:{operator:"is_empty"}}}if("rollup"===t.targetPropertySchema.type){return{operator:"any",subfilter:{operator:"is_empty"}}}if("formula"===t.targetPropertySchema.type){const e=f(t.targetPropertySchema);if((0,i.a_)(e))return e;return{operator:"any",subfilter:e}}if("button"===t.targetPropertySchema.type)return{operator:"is_empty"};return{operator:"any",subfilter:m(t.targetPropertySchema.type)}}}return m(a.type)}const h=(0,d.defineMessages)({date_is_within:{defaultMessage:"Is between",id:"collectionFilterMenuHelpers.operator.dateIsWithin"},date_is_relative_to:{defaultMessage:"Is relative to today",id:"collectionFilterMenuHelpers.operator.dateIsRelativeTo"},is_empty:{defaultMessage:"Is empty",id:"collectionFilterMenuHelpers.operator.isEmpty"},is_not_empty:{defaultMessage:"Is not empty",id:"collectionFilterMenuHelpers.operator.isNotEmpty"},string_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.stringIs"},string_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.stringIsNot"},string_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.stringContains"},string_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.stringDoesNotContain"},string_starts_with:{defaultMessage:"Starts with",id:"collectionFilterMenuHelpers.operator.stringStartsWith"},string_ends_with:{defaultMessage:"Ends with",id:"collectionFilterMenuHelpers.operator.stringEndsWith"},checkbox_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.checkboxIs"},checkbox_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.checkboxIsNot"},enum_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.enumIs"},enum_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.enumIsNot"},enum_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.enumContains"},enum_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.enumDoesNotContain"},status_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.statusIs"},status_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.statusIsNot"},person_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.personContains"},person_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.personDoesNotContain"},relation_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.relationContains"},relation_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.relationDoesNotContain"},location_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.locationIs"},location_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.locationIsNot"},number_equals:{defaultMessage:"=",id:"collectionFilterMenuHelpers.operator.numberEquals"},number_does_not_equal:{defaultMessage:"â‰ ",id:"collectionFilterMenuHelpers.operator.numberDoesNotEqual"},number_greater_than:{defaultMessage:">",id:"collectionFilterMenuHelpers.operator.numberGreaterThan"},number_less_than:{defaultMessage:"<",id:"collectionFilterMenuHelpers.operator.numberLessThan"},number_greater_than_or_equal_to:{defaultMessage:"â‰¥",id:"collectionFilterMenuHelpers.operator.numberGreaterThanOrEqualTo"},number_less_than_or_equal_to:{defaultMessage:"â‰¤",id:"collectionFilterMenuHelpers.operator.numberLessThanOrEqualTo"},date_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.dateIs"},date_is_before:{defaultMessage:"Is before",id:"collectionFilterMenuHelpers.operator.dateIsBefore"},date_is_after:{defaultMessage:"Is after",id:"collectionFilterMenuHelpers.operator.dateIsAfter"},date_is_on_or_before:{defaultMessage:"Is on or before",id:"collectionFilterMenuHelpers.operator.dateIsOnOrBefore"},date_is_on_or_after:{defaultMessage:"Is on or after",id:"collectionFilterMenuHelpers.operator.dateIsOnOrAfter"},any:{defaultMessage:"Any",id:"collectionFilterMenuHelpers.operator.any"},none:{defaultMessage:"None",id:"collectionFilterMenuHelpers.operator.none"},every:{defaultMessage:"Every",id:"collectionFilterMenuHelpers.operator.every"},string_has_no_alphabet_prefix:{defaultMessage:"(Not used)",id:"collectionFilterMenuHelpers.operator.stringHasNoAlphabetPrefix"},verification_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.verificationStateIs"},verification_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.verificationStateIsNot"}});function v(e){return u.default.formatMessage(h[e])}const b=(0,d.defineMessages)({today:{defaultMessage:"Today",id:"collectionFilterMenuHelpers.relativeDates.today"},tomorrow:{defaultMessage:"Tomorrow",id:"collectionFilterMenuHelpers.relativeDates.tomorrow"},yesterday:{defaultMessage:"Yesterday",id:"collectionFilterMenuHelpers.relativeDates.yesterday"},one_week_ago:{defaultMessage:"One week ago",id:"collectionFilterMenuHelpers.relativeDates.oneWeekAgo"},one_week_from_now:{defaultMessage:"One week from now",id:"collectionFilterMenuHelpers.relativeDates.oneWeekFromNow"},one_month_ago:{defaultMessage:"One month ago",id:"collectionFilterMenuHelpers.relativeDates.oneMonthAgo"},one_month_from_now:{defaultMessage:"One month from now",id:"collectionFilterMenuHelpers.relativeDates.oneMonthFromNow"}}),y=(0,d.defineMessages)({past:{defaultMessage:"Past",id:"collectionFilterMenuHelpers.relativeDates.past"},future:{defaultMessage:"Next",id:"collectionFilterMenuHelpers.relativeDates.next"}}),_=(0,d.defineMessages)({direction:{defaultMessage:"Direction",id:"collectionFilterMenuHelpers.relativeDates.direction"},unit:{defaultMessage:"Unit",id:"collectionFilterMenuHelpers.relativeDates.unit"}}),S=(0,d.defineMessages)({this:{defaultMessage:"This",id:"collectionFilterMenuHelpers.relativedates.this"}}),w=(0,d.defineMessages)({day:{defaultMessage:"day",id:"collectionFilterMenuHelpers.relativeDates.day"},week:{defaultMessage:"week",id:"collectionFilterMenuHelpers.relativeDates.week"},month:{defaultMessage:"month",id:"collectionFilterMenuHelpers.relativeDates.month"},year:{defaultMessage:"year",id:"collectionFilterMenuHelpers.relativeDates.year"}}),k=(0,d.defineMessages)({day:{defaultMessage:"days",id:"collectionFilterMenuHelpers.relativeDates.days"},week:{defaultMessage:"weeks",id:"collectionFilterMenuHelpers.relativeDates.weeks"},month:{defaultMessage:"months",id:"collectionFilterMenuHelpers.relativeDates.months"},year:{defaultMessage:"years",id:"collectionFilterMenuHelpers.relativeDates.years"}}),I=(0,d.defineMessages)({exactDate:{defaultMessage:"Custom date",id:"collectionFilterMenuHelpers.relativeDates.exactDate"},exactDateRange:{defaultMessage:"Exact dates",id:"collectionFilterMenuHelpers.relativeDates.exactDateRange"}});function x(e){return"exact"===e.type?u.default.formatMessage(I.exactDate):u.default.formatMessage(b[e.value])}const C=(0,d.defineMessages)({custom:{defaultMessage:"Relative range",id:"collectionFilterMenuHelpers.relativeDates.range"},surrounding:{defaultMessage:"Surrounding range",id:"collectionFilterMenuHelpers.relativeDates.customRange"},this_week:{defaultMessage:"This week",id:"collectionFilterMenuHelpers.relativeDates.thisWeek"},the_past_week:{defaultMessage:"The past week",id:"collectionFilterMenuHelpers.relativeDates.thePastWeek"},the_past_month:{defaultMessage:"The past month",id:"collectionFilterMenuHelpers.relativeDates.thePastMonth"},the_past_year:{defaultMessage:"The past year",id:"collectionFilterMenuHelpers.relativeDates.thePastYear"},the_next_week:{defaultMessage:"The next week",id:"collectionFilterMenuHelpers.relativeDates.theNextWeek"},the_next_month:{defaultMessage:"The next month",id:"collectionFilterMenuHelpers.relativeDates.theNextMonth"},the_next_year:{defaultMessage:"The next year",id:"collectionFilterMenuHelpers.relativeDates.theNextYear"}});function T(e){return"custom"===e.value?function(e){const t=u.default.formatMessage(y[e.direction]),n=1===e.count?u.default.formatMessage(w[e.unit]):u.default.formatMessage(k[e.unit]);return 1===e.count?`${t} ${n}`:`${t} ${e.count} ${n}`}(e):"surrounding"===e.value?function(e){const t=u.default.formatMessage(w[e.unit]);return`${u.default.formatMessage(S.this)} ${t}`}(e):"exact"===e.type?u.default.formatMessage(I.exactDateRange):"relative"===e.type?u.default.formatMessage(C[e.value]):void(0,l.t1)(e)}const M=(0,d.defineMessages)({start_date:{defaultMessage:"Start date",id:"collectionFilterMenuHelpers.dateFilterModes.start_date"},end_date:{defaultMessage:"End date",id:"collectionFilterMenuHelpers.dateFilterModes.end_date"}}),P=(0,d.defineMessages)({start_date:{defaultMessage:"For date ranges, filters on the start date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.start_date"},end_date:{defaultMessage:"For date ranges, filters on the end date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.end_date"}});function A(e){return u.default.formatMessage(M[e])}function R(e){return u.default.formatMessage(P[e])}const D=(0,d.defineMessages)({and:{defaultMessage:"And",id:"collectionFilterMenuHelpers.combinatorOperators.and"},or:{defaultMessage:"Or",id:"collectionFilterMenuHelpers.combinatorOperators.or"}}),B=(0,d.defineMessages)({checked:{defaultMessage:"Checked",id:"collectionFilterMenuHelpers.checkbox.checked"},unchecked:{defaultMessage:"Unchecked",id:"collectionFilterMenuHelpers.checkbox.unchecked"}});function E(e){return e.value?u.default.formatMessage(c.A3(e.value)):""}const F=e=>{let{filter:t,schema:n}=e;return N({filter:t.subfilter,schema:n})},Z=e=>{let{filter:t}=e;return x(t.value)},V=e=>{let{filter:t}=e;return T(t.value)},j=e=>{let{filter:t}=e;return`"${t.value.value||""}"`},U=e=>{let{filter:t}=e;return void 0===t.value.value?void 0:t.value.value.toString()},L=e=>{let{filter:t}=e;return function(e){const t=e.value?B.checked:B.unchecked;return u.default.formatMessage(t)}(t.value)},O={is_empty:()=>{},is_not_empty:()=>{},string_is:j,string_is_not:j,string_contains:j,string_does_not_contain:j,string_starts_with:j,string_ends_with:j,checkbox_is:L,checkbox_is_not:L,enum_is:j,enum_is_not:j,enum_contains:j,enum_does_not_contain:j,status_is:j,status_is_not:j,relation_contains:()=>{},relation_does_not_contain:()=>{},person_contains:()=>{},person_does_not_contain:()=>{},location_is:()=>{},location_is_not:()=>{},number_equals:U,number_does_not_equal:U,number_greater_than:U,number_less_than:U,number_greater_than_or_equal_to:U,number_less_than_or_equal_to:U,date_is:Z,date_is_before:Z,date_is_after:Z,date_is_on_or_before:Z,date_is_on_or_after:Z,date_is_within:V,date_is_relative_to:V,any:F,none:F,every:F,string_has_no_alphabet_prefix:()=>{},verification_is:j,verification_is_not:j};function N(e){const{filter:t}=e,n=v(t.operator),o=O[t.operator](e);return s.oA([n,o]).join(" ")}function z(e){const{filter:t,schema:n}=e;if((0,i.vA)(t)){const e=t.filters||[],o=s.oA(e.map((e=>{const t=z({filter:e,schema:n});if(t)return(0,i.vA)(e)?`(${t})`:t}))),r=u.default.formatMessage(D[t.operator]);return o.join(` ${r} `)}if((0,i.aN)(t)){const e=n[t.property];if(!e)return;const o=t.filter,i=e.name,r=N({filter:o,schema:n});return s.oA([i,r]).join(" ")}}const W={text:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:"string_has_no_alphabet_prefix"===e.operator?{operator:t}:{operator:t,value:e.value}},number:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},checkbox:function(e,t){return{operator:t,value:e.value}},select:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},multi_select:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},status:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"is_option",value:void 0}}:{operator:t,value:e.value}},relation:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},person:function(e,t){return(0,i._N)(t)?{operator:t}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},date:function(e,t,n){if((0,i._N)(t))return{operator:t};const o=(0,i.mv)(e)?void 0:e.use_end;return"date_is_within"===t?"date_is_within"!==e.operator?{operator:t,value:{type:"exact",value:void 0},use_end:o}:e:"date_is_relative_to"===t?"date_is_relative_to"!==e.operator?{operator:t,value:{type:"relative",value:"surrounding",unit:"week"},use_end:o}:e:(0,i.TQ)(e)?"combinator"===n?{operator:t,value:{type:"relative",value:"today"},use_end:o}:{operator:t,value:{type:"exact",value:void 0},use_end:o}:(0,i.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value,use_end:o}},file:function(e,t){return{operator:t}},location:function(e,t){return{operator:t,value:e.value}},verification:function(e,t){return{operator:t,value:e.value}}};function q(e,t,n,o){return(0,W[e])(t,n,o)}const H=(0,d.defineMessages)({and:{defaultMessage:"And",id:"database.filterOperators.and"},or:{defaultMessage:"Or",id:"database.filterOperators.or"}}),K=(0,d.defineMessages)({and:{defaultMessage:"All filters must match",id:"database.filterOperators.andCaption"},or:{defaultMessage:"At least one filter must match",id:"database.filterOperators.orCaption"}});function G(e,t){return"and"===e?t.formatMessage(H.and):t.formatMessage(H.or)}function $(e,t){return"and"===e?t.formatMessage(K.and):t.formatMessage(K.or)}const Q=(0,d.defineMessages)({any:{defaultMessage:"Any",id:"database.filterOperators.any"},every:{defaultMessage:"Every",id:"database.filterOperators.every"},none:{defaultMessage:"None",id:"database.filterOperators.none"}});function Y(e,t){return"any"===e?t.formatMessage(Q.any):"every"===e?t.formatMessage(Q.every):t.formatMessage(Q.none)}const J=(0,d.defineMessages)({number:{id:"collectionFilterMenuFilter.filterOperators.number.order",defaultMessage:"{operator}{operatorValue}"},text:{id:"collectionFilterMenuFilter.filterOperators.text.order",defaultMessage:"{operator}{operatorValue}"},checkbox:{id:"collectionFilterMenuFilter.filterOperators.checkbox.order",defaultMessage:"{operator}{operatorValue}"},select:{id:"collectionFilterMenuFilter.filterOperators.select.order",defaultMessage:"{operator}{operatorValue}"},multi_select:{id:"collectionFilterMenuFilter.filterOperators.multi_select.order",defaultMessage:"{operator}{operatorValue}"},status:{id:"collectionFilterMenuFilter.filterOperators.status.order",defaultMessage:"{operator}{operatorValue}"},relation:{id:"collectionFilterMenuFilter.filterOperators.relation.order",defaultMessage:"{operator}{operatorValue}"},location:{id:"collectionFilterMenuFilter.filterOperators.location.order",defaultMessage:"{operator}{operatorValue}"},person:{id:"collectionFilterMenuFilter.filterOperators.person.order",defaultMessage:"{operator}{operatorValue}"},date:{id:"collectionFilterMenuFilter.filterOperators.date.order",defaultMessage:"{operator}{operatorValue}"},file:{id:"collectionFilterMenuFilter.filterOperators.file.order",defaultMessage:"{operator}{operatorValue}"},verification:{id:"collectionFilterMenuFilter.filterOperators.verification.order",defaultMessage:"{operator}{operatorValue}"}})},92918:(e,t,n)=>{n.d(t,{Cz:()=>w,II:()=>x,XD:()=>g,_1:()=>C,ar:()=>_,ej:()=>b,ew:()=>v,h6:()=>I,kW:()=>h,nr:()=>y,qW:()=>S});n(57658);var o=n(92996),i=n(35011),r=n(14714),a=n(99036),s=n(97058),l=n(8848),c=n(38297),d=n(72126),u=n(97880),p=n(52821),m=n(26991),f=n(29376);const g=10,h=10,v=50;function b(e){const{groupBy:t,schema:n,format:o,filter:i,groupsFormatKey:a,limit:s}=e,l=n[t.property];if(!l||!(0,r.LG)(l))return;const c=o[a]||[],d=c.reduce(((e,t)=>(0,r.eF)(t)?e+1:e),0);return{type:"groups",groupBy:t,filter:i,groupSortPreference:c.map((e=>e.value)),limit:s+d}}function y(e,t,n){const o=e.filter((e=>!(0,r.ZH)(e,t))),i=o.filter((e=>!(0,r.eF)(e))),a=o.filter((e=>(0,r.eF)(e)));return[...i.slice(0,n-1),t,...i.slice(n-1),...a]}function _(e,t){const n=e.filter((e=>!(0,r.ZH)(e,t))),o=n.filter((e=>!(0,r.eF)(e))),i=n.filter((e=>(0,r.eF)(e)));return[...o,t,...i]}function S(e){return!e.device.isPhone&&(e.isFullScreen||e.isRootChild)}function w(e){const{schema:t,groupBy:n,schemaGroups:a,reducerResults:l,relativeVariableResult:c,getRecordModel:u,viewAppConfigUri:m}=e;if(!n)return[];const f=t[n.property];if(!f||!(0,r.LG)(f))return[];const g=[...e.formatGroups,...a&&!l?a.map((e=>({property:n.property,value:e}))):[]];let h;if("manual"===(0,r.mu)(n).type){if(h=g,l)for(const{value:e}of l){const t={property:n.property,value:e};h.push(t)}m===o.sV&&(h=(0,s.gd)(h,e.formatGroups.map((e=>e.value))))}else{const e=new Map;for(const t of g)e.set((0,r.mD)(t),t);h=l?l.map((t=>{let{value:o}=t;return e.get((0,r.Hd)(o))||{property:n.property,value:o}})):[];for(const t of g)h.push(t)}if(l){if(n.hideEmptyGroups){const e=new Set,t=new Set;for(const n of l){const o=(0,r.Hd)(n.value);0===n.total?t.add(o):e.add(o)}h=h.map((n=>{const o=(0,r.mD)(n);if(t.has(o))return{...n,emptyHidden:!0};if(e.has(o)){const e={...n};return delete e.emptyHidden,e}return n}))}else h=h.map((e=>{if(e.emptyHidden){const t={...e};return delete t.emptyHidden,t}return e}));h=m===o.sV&&n.property===o.Es.TaskToSprintRelation?h.map((e=>"relation"===e.value.type&&(0,r.t2)(e.value.value)||void 0===e.value||void 0===e.value.value?e:{...e,hiddenByDefault:!0})):h.map((e=>{if(e.hiddenByDefault){const t={...e};return delete t.hiddenByDefault,t}return e}))}const v=h.filter((e=>{if(e.property!==n.property)return!1;const t=e.value;if(t.type!==f.type)return!1;if(void 0===t.value)return!(0,p.Dt)(f);if("formula"===f.type){const t=(0,i.mm)(f);if(!f.formula&&!f.formula2||"unknown"===t)return!1;if("formula"!==e.value.type||"formula"!==n.type)return!1;const o=e.value.value;if(!o)return!0;if("block"===t&&"text"===o.type)return!0;if(o.type!==t)return!1;const a=n.groupBy;return"relation"===a.type?function(e,t,n){if(!e||!e.value)return!0;if("relation"!==t.type||"relation"!==e.type)return!1;if((0,r.t2)(e.value))return!1;const o=n(e.value);return null==o?void 0:o.alive}(o,{...a,property:n.property},u):k({groupValue:o,groupBy:{property:n.property,...a},getRecordModel:u,relativeVariableResult:c})}return k({groupValue:t,groupBy:n,getRecordModel:u,relativeVariableResult:c,propertySchema:f})}));return d.mN(v,(e=>(0,r.mD)(e)))}function k(e){const{groupValue:t,groupBy:n,getRecordModel:o,relativeVariableResult:i,propertySchema:a}=e;if(!t.value)return!0;const s=n.type;if("formula"===s)return!1;if("select"===s){if("select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("multi_select"===s){if("multi_select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("status"===s){if("status"!==(null==a?void 0:a.type))return!1;const e=a.options??[],o=a.groups??[];if("status"!==t.type)return!1;const{value:i}=t;return"by_group"===i.type?("status"!==s||"group"===n.groupBy)&&o.some((e=>e.name===i.group)):"by_option"===i.type&&(("status"!==s||"option"===n.groupBy)&&e.some((e=>e.value===i.option)))}return(0,r.A1)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,r.ib)(t)||!(0,r.Mc)(e)||!t.groupBy)return!1;const n=e.value.type;if("relative"===t.groupBy)return"today"===n||"yesterday"===n||"last_7_days"===n||"last_30_days"===n||"tomorrow"===n||"next_7_days"===n||"next_30_days"===n||"month"===n;if("day"===t.groupBy)return"day"===n;if("week"===t.groupBy)return"week"===n;if("month"===t.groupBy)return"month"===n;if("year"===t.groupBy)return"year"===n;(0,u.t1)(t.groupBy)}(t,n):(0,r.HB)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,r.aB)(t)||!(0,r.R7)(e)||!t.groupBy)return!1;const n=e.value.type;if("alphabet_prefix"===t.groupBy)return"alphabet_prefix"===n||"other"===n;if("exact"===t.groupBy)return"exact"===n;(0,u.t1)(t.groupBy)}(t,n):"number"===s?function(e,t){if(!e||!e.value)return!0;if("number"!==t.type||"number"!==e.type)return!1;const n=e.value;if("out_of_range"===n.type)return n.start===t.start&&n.end===t.end;if("range"===n.type){const e=(0,r.n6)(n.start,t.start,t.end,t.size);return e&&"range"===e.type&&e.start===n.start}(0,u.t1)(n)}(t,n):"relation"===s?"relation"===(null==a?void 0:a.type)&&function(e,t,n,o,i){var a;if(!t||!t.value)return!0;if("relation"!==n.type||"relation"!==t.type)return!1;if((0,r.t2)(t.value)){var s,l;const n=e.collection_pointer&&o(e.collection_pointer);if(!i||!n)return!1;const r=null==n||null===(s=n.getFormat())||void 0===s?void 0:s.app_config_uri,a=null===(l=i[n.id])||void 0===l?void 0:l[t.value.value.variable],c=null==n?void 0:n.getSchema();return(0,m.Sh)(c,r)&&a}const d=o(t.value);if(!d)return!1;const u=(0,c.ky)({block:d,getRecordModel:o});if(i&&u){if((0,r.qQ)({relativeVariableValues:i[null==u?void 0:u.id],pointer:d.pointer}).length>0)return!1}return Boolean(d.alive&&((null==u?void 0:u.id)===e.collection_id||(null==u?void 0:u.id)===(null===(a=e.collection_pointer)||void 0===a?void 0:a.id)))}(a,t,n,o,i):"location"===s?function(e,t,n){if(!e||!e.value)return!0;if("location"!==t.type||"location"!==e.type)return!1;const o=n(e.value);return Boolean(o)}(t,n,o):!(!(0,r.pd)(s)&&"checkbox"!==s)||void(0,u.t1)(s)}function I(e,t){var n;const o=t.collectionViewStore(),i=null==o||null===(n=o.getFormat().board_columns_by)||void 0===n?void 0:n.disableBoardColorColumns;return void 0===i||i}function x(e){const{environment:t,groupFormat:n,schema:i,format:s,collectionContextStore:c,theme:d}=e,u=I(0,c);if(s.collection_group_by||!u){if(n){const e=i[n.property];if(e&&!u){const t=n.value;if((0,a.cu)(e)){const n=(e.options||[]).find((e=>e.value===t.value));return(0,l.bw)(d,null==n?void 0:n.color)}if("status"===e.type&&"status"===t.type){var p,m;let n;if("by_group"===(null===(p=t.value)||void 0===p?void 0:p.type)){var g;const o=t.value.group;n=null===(g=e.groups)||void 0===g||null===(g=g.find((e=>e.name===o)))||void 0===g?void 0:g.color}else if("by_option"===(null===(m=t.value)||void 0===m?void 0:m.type)){var h;const o=t.value.option;n=null===(h=e.options)||void 0===h||null===(h=h.find((e=>e.value===o)))||void 0===h?void 0:h.color}return(0,l.bw)(d,n)}if("relation"===e.type&&"relation"===t.type&&(0,r.t2)(t.value)){const n=c.collectionStore();if(!n)return(0,l.bw)(d,"default");const i=(0,f.gO)(e,n),r=(0,f.uJ)(e,n),a=null==i?void 0:i.getPropertyMapping(),s=null==a?void 0:a[o.b0.StatusV2],u=r&&s&&r[s];if(u&&"status"===u.type){var v;const e=t.value.value.variable,n=null===(v=u.options)||void 0===v||null===(v=v.find((t=>t.id===e)))||void 0===v?void 0:v.color;if(n)return(0,l.bw)(d,n)}}}}return(0,l.bw)(d,"default")}}function C(e){return!("board"===e.viewType&&"board_columns_by"===e.groupByKey)}},52821:(e,t,n)=>{n.d(t,{Bh:()=>B,Cg:()=>J,DL:()=>V,Dt:()=>X,JI:()=>O,K8:()=>N,Km:()=>L,Rb:()=>R,SO:()=>M,Sb:()=>H,TP:()=>q,Tr:()=>P,_W:()=>K,_Y:()=>U,aW:()=>Z,dN:()=>G,k4:()=>Q,oy:()=>j,r_:()=>$,sN:()=>F,to:()=>W});var o=n(41892),i=n(41432),r=n(99036),a=n(80951),s=n(35013),l=n(21321),c=n(69628),d=n(17948),u=n(42696),p=n(10405),m=n(72126),f=n(19889),g=n(3791),h=n(97880),v=n(9291),b=n(33929),y=n(80444),_=n(77080),S=n(83212),w=n(26136),k=n(88280),I=n(19124),x=n(37034),C=n(95697);const T=(0,v.defineMessages)({title:{defaultMessage:"Title",id:"database.propertyTypeName.title"},text:{defaultMessage:"Text",id:"database.propertyTypeName.text"},number:{defaultMessage:"Number",id:"database.propertyTypeName.number"},url:{defaultMessage:"URL",id:"database.propertyTypeName.url"},select:{defaultMessage:"Select",id:"database.propertyTypeName.select"},multi_select:{defaultMessage:"Multi-select",id:"database.propertyTypeName.multi_select"},status:{defaultMessage:"Status",id:"database.propertyTypeName.status"},person:{defaultMessage:"Person",id:"database.propertyTypeName.person"},email:{defaultMessage:"Email",id:"database.propertyTypeName.email"},phone_number:{defaultMessage:"Phone",id:"database.propertyTypeName.phone_number"},date:{defaultMessage:"Date",id:"database.propertyTypeName.date"},file:{defaultMessage:"Files & media",id:"database.propertyTypeName.file"},checkbox:{defaultMessage:"Checkbox",id:"database.propertyTypeName.checkbox"},formula:{defaultMessage:"Formula",id:"database.propertyTypeName.formula"},relation:{defaultMessage:"Relation",id:"database.propertyTypeName.relation"},rollup:{defaultMessage:"Rollup",id:"database.propertyTypeName.rollup"},created_time:{defaultMessage:"Created time",id:"database.propertyTypeName.created_time"},created_by:{defaultMessage:"Created by",id:"database.propertyTypeName.created_by"},last_edited_time:{defaultMessage:"Last edited time",id:"database.propertyTypeName.last_edited_time"},last_edited_by:{defaultMessage:"Last edited by",id:"database.propertyTypeName.last_edited_by"},last_visited_time:{defaultMessage:"Last visited time",id:"database.propertyTypeName.last_visited_time"},button:{defaultMessage:"Button",id:"database.propertyTypeName.button"},auto_increment_id:{defaultMessage:"ID",id:"database.propertyTypeName.auto_increment_id"},location:{defaultMessage:"Location",id:"database.propertyTypeName.location"},verification:{defaultMessage:"Verification",id:"database.propertyTypeName.verification"},ai_summary:{defaultMessage:"AI summary",id:"database.propertyTypeName.text.summarizeWithAi"},ai_custom_prompt:{defaultMessage:"AI custom autofill",id:"database.propertyTypeName.text.customPromptWithAI"},ai_extract:{defaultMessage:"AI key info",id:"database.propertyTypeName.text.extractInfoWithAI"},ai_translate:{defaultMessage:"AI translation",id:"database.propertyTypeName.text.translateWithAI"}}),M={title:b.default.formatMessage(T.title),text:b.default.formatMessage(T.text),number:b.default.formatMessage(T.number),url:b.default.formatMessage(T.url),select:b.default.formatMessage(T.select),multi_select:b.default.formatMessage(T.multi_select),status:b.default.formatMessage(T.status),person:b.default.formatMessage(T.person),email:b.default.formatMessage(T.email),phone_number:b.default.formatMessage(T.phone_number),date:b.default.formatMessage(T.date),file:b.default.formatMessage(T.file),checkbox:b.default.formatMessage(T.checkbox),formula:b.default.formatMessage(T.formula),relation:b.default.formatMessage(T.relation),rollup:b.default.formatMessage(T.rollup),created_time:b.default.formatMessage(T.created_time),created_by:b.default.formatMessage(T.created_by),last_edited_time:b.default.formatMessage(T.last_edited_time),last_edited_by:b.default.formatMessage(T.last_edited_by),last_visited_time:b.default.formatMessage(T.last_visited_time),button:b.default.formatMessage(T.button),auto_increment_id:b.default.formatMessage(T.auto_increment_id),location:b.default.formatMessage(T.location),verification:b.default.formatMessage(T.verification),ai_summary:b.default.formatMessage(T.ai_summary),ai_custom_prompt:b.default.formatMessage(T.ai_custom_prompt),ai_extract:b.default.formatMessage(T.ai_extract),ai_translate:b.default.formatMessage(T.ai_translate)};(0,v.defineMessages)({text:{defaultMessage:"A single line of text.",id:"database.propertyTypeDescription.text"},number:{defaultMessage:"A number, with options to format as currency, percent, and more.",id:"database.propertyTypeDescription.number"},url:{defaultMessage:"A link to a page on the web.",id:"database.propertyTypeDescription.url"},select:{defaultMessage:"Select from a list of options.",id:"database.propertyTypeDescription.select"},multi_select:{defaultMessage:"Tag with values from a list of options.",id:"database.propertyTypeDescription.multi_select"},status:{defaultMessage:"Tag with a list of custom options with groups",id:"database.propertyTypeDescription.status"},person:{defaultMessage:"Reference a person on your team.",id:"database.propertyTypeDescription.person"},email:{defaultMessage:"Reference an email address.",id:"database.propertyTypeDescription.email"},phone_number:{defaultMessage:"Reference a phone number.",id:"database.propertyTypeDescription.phone_number"},date:{defaultMessage:"A date, with options to format and include time.",id:"database.propertyTypeDescription.date"},file:{defaultMessage:"Upload files and images.",id:"database.propertyTypeDescription.file"},checkbox:{defaultMessage:"Track status with a single checkbox.",id:"database.propertyTypeDescription.checkbox"},formula:{defaultMessage:"Compute a formula using other properties of a page.",id:"database.propertyTypeDescription.formula"},relation:{defaultMessage:"Allow pages in this database to reference pages in another.",id:"database.propertyTypeDescription.relation"},rollup:{defaultMessage:"Display and summarize data from a relation.",id:"database.propertyTypeDescription.rollup"},created_time:{defaultMessage:"Reference the date and time a page was created.",id:"database.propertyTypeDescription.created_time"},created_by:{defaultMessage:"Reference the person that created a page.",id:"database.propertyTypeDescription.created_by"},last_edited_time:{defaultMessage:"Reference the date and time a page was last edited.",id:"database.propertyTypeDescription.last_edited_time"},last_edited_by:{defaultMessage:"Reference the person that last edited a page.",id:"database.propertyTypeDescription.last_edited_by"},last_visited_time:{defaultMessage:"Reference the date and time a page was last visited by you.",id:"database.propertyTypeDescription.last_visited_time"},button:{defaultMessage:"A clickable button that can be configured to perform any action.",id:"database.propertyTypeDescription.button"},auto_increment_id:{defaultMessage:"An auto-increment ID.",id:"database.propertyTypeDescription.auto_increment_id"},location:{defaultMessage:"A location.",id:"database.propertyTypeDescription.location"},verification:{defaultMessage:"Verified status.",id:"database.propertyTypeDescription.verification"}});const P=["text","number","select","multi_select","status","date","person","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","verification"],A=["select","multi_select","status","person","date","created_time","created_by","last_edited_time","last_edited_by"],R=function(e){return A.includes(e.type)},D=(0,v.defineMessages)({tableDisplayName:{defaultMessage:"Table",id:"collectionHelpers.table.displayName"},boardDisplayName:{defaultMessage:"Board",id:"collectionHelpers.board.displayName"},calendarDisplayName:{defaultMessage:"Calendar",id:"collectionHelpers.calendar.displayName"},listDisplayName:{defaultMessage:"List",id:"collectionHelpers.list.displayName"},galleryDisplayName:{defaultMessage:"Gallery",id:"collectionHelpers.gallery.displayName"},timelineDisplayName:{defaultMessage:"Timeline",id:"collectionHelpers.timline.displayName"},pageDisplayName:{defaultMessage:"Page",id:"collectionHelpers.page.displayName"}}),B={table:b.default.formatMessage(D.tableDisplayName),board:b.default.formatMessage(D.boardDisplayName),calendar:b.default.formatMessage(D.calendarDisplayName),list:b.default.formatMessage(D.listDisplayName),gallery:b.default.formatMessage(D.galleryDisplayName),timeline:b.default.formatMessage(D.timelineDisplayName),page:b.default.formatMessage(D.pageDisplayName)},E=(0,v.defineMessages)({table:{defaultMessage:"Table with types to store and view any kind of structured data",id:"collectionHelpers.table.caption"},board:{defaultMessage:"Kanban board, great for project planning and bug tracking",id:"collectionHelpers.board.caption"},calendar:{defaultMessage:"Month view, for event planning and scheduling",id:"collectionHelpers.calendar.caption"},list:{defaultMessage:"A simplified page view, great for bookmarks and notes",id:"collectionHelpers.list.caption"},gallery:{defaultMessage:"Grid of cards, use for mood boards, index cards, and recipes",id:"collectionHelpers.gallery.caption"},timeline:{defaultMessage:"A timeline view, great for project scheduling and planning",id:"collectionHelpers.timeline.caption"},page:{defaultMessage:"A page view for organizing pages hierarchically, great for documents and wikis",id:"collectionHelpers.page.caption"}}),F={table:b.default.formatMessage(E.table),board:b.default.formatMessage(E.board),calendar:b.default.formatMessage(E.calendar),list:b.default.formatMessage(E.list),gallery:b.default.formatMessage(E.gallery),timeline:b.default.formatMessage(E.timeline),page:b.default.formatMessage(E.page)},Z={table:u.t,board:s.i,calendar:l.N,list:d.O,gallery:c.n,timeline:p._,page:d.O},V=(o.Z.images.tooltips.views.tablePng,o.Z.images.tooltips.views.boardPng,o.Z.images.tooltips.views.calendarPng,o.Z.images.tooltips.views.listPng,o.Z.images.tooltips.views.galleryPng,o.Z.images.tooltips.views.timelinePng,o.Z.images.tooltips.views.listPng,{table:void 0,board:"board_cover",calendar:void 0,list:void 0,gallery:"gallery_cover",timeline:void 0,page:void 0}),j={table:void 0,board:"board_cover_size",calendar:void 0,list:void 0,gallery:"gallery_cover_size",timeline:void 0,page:void 0},U={table:void 0,board:"board_cover_aspect",calendar:void 0,list:void 0,gallery:"gallery_cover_aspect",timeline:void 0,page:void 0},L={table:!0,board:!1,calendar:!1,list:!0,gallery:!0,timeline:!0,page:!1};function O(e){const t=e.getType(),n=e.getTitleStore();return t&&(0,i.dM)(t)&&n?n:e.getBlockTitleStore()}function N(e,t){let n=[];switch(t){case"gallery":e&&e.gallery_properties&&(n=e.gallery_properties);break;case"board":e&&e.board_properties&&(n=e.board_properties)}const o=n.find((e=>{let{property:t}=e;return"title"===t}));return!!o&&Boolean(o.visible)}const z=["text","number","select","multi_select","status","date","person","ai_summary","ai_extract","ai_custom_prompt","ai_translate","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","location","verification"];function W(e){if((0,r.XU)(e))switch(e){case"ai_custom_prompt":case"ai_extract":case"ai_summary":case"ai_translate":return"suggested";default:throw(0,h.t1)(e)}return"standard"}function q(e){let{isSyncedCollection:t,collectionContextStore:n,environment:o}=e;const i=_.default.checkGate("database_sync_ugc");return z.filter((e=>{if((0,r.XU)(e)){const t=n.collectionStore();if(!t)return!1;const i=S.Z.getMode(o,t);return t.isTypedCollection()?"suggested"!==W(e)&&(0,I.mX)(o,i,t):(0,I.mX)(o,i,t)}return!(!i&&t&&!(0,r.Of)(e))&&!!((0,C.QI)("dev_or_beta")&&"collectionTypedView"===n.contextType||"location"!==e)}))}function H(e){let{propertySchema:t,property:n,blockStores:o,collectionSchema:i}=e;return 0!==o.length&&((0,r.iE)(t)?o.every((e=>K(t,e,i))):!(0,r.ZY)(t.type)&&!(0,a.wl)(n))}function K(e,t,n){const o=e.verifier_property;if(!o)return!1;const i=t.getPropertyValue(o),r=(0,a.DW)({textValue:i,propertySchema:n[o],blockCreatorPointer:t.getCreatedByPointer()}),s=y.default.state.currentUserRootStore;return!!s&&r.some((e=>e.id===s.id&&e.table===f.KJ))}function G(e){let{targetCollectionStore:t,propertySchema:n,pointer:o}=e;if(!(Boolean(n.property)&&_.default.checkGate("collections_relation_picker_require_edit_perms")))return!0;return w.G.createChildStore(t,o).canEdit()}function $(e){const{collectionStore:t,environment:n,intl:o,queryForFilter:i}=e;if(""===i)return!0;return(0,x.vU)({environment:n,intl:o,store:t}).toUpperCase().includes(i.toUpperCase())}function Q(){var e;const t=(null===(e=k.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,g.de)(t)}function Y(e,t){for(const n of t)void 0===e[n]&&delete e[n]}function J(e){const t=m.Xh(e.loader);if(Y(t,["sort","reducerDependencies","searchQuery","upwardTraversalRelation","vectorSearch","filter"]),t.reducers)for(const n of Object.values(t.reducers))switch(n.type){case"results":Y(n,["filter","searchQuery","loadContentCover"]);break;case"groups":Y(n,["filter"]);break;case"aggregation":Y(n,["filter"]),void 0===n.aggregation.property&&Y(n.aggregation,["property"])}return{collectionView:e.collectionView,source:e.source,loader:t,aggregationStatus:e.aggregationStatus}}function X(e){return"status"===e.type&&void 0!==e.defaultOption||"person"===e.type&&void 0!==e.default}},48543:(e,t,n)=>{n.d(t,{LQ:()=>u,Ls:()=>l,RI:()=>p,RO:()=>m});var o=n(17683),i=n(31490),r=n(32240),a=n(9291),s=n(33929);const l={table:"side_peek",board:"side_peek",calendar:"center_peek",list:"side_peek",gallery:"center_peek",timeline:"side_peek",page:"side_peek"},c=(0,a.defineMessages)({side_peek:{defaultMessage:"Side peek",id:"database.viewPropertiesMenu.peekMode.sidePeek"},center_peek:{defaultMessage:"Center peek",id:"database.viewPropertiesMenu.peekMode.centerPeek"},full_page:{defaultMessage:"Full page",id:"database.viewPropertiesMenu.peekMode.fullPage"}}),d=(0,a.defineMessages)({side_peek:{defaultMessage:"Open pages on the side. Keeps the view behind interactive.",id:"database.viewPropertiesMenu.peekMode.description.sidePeek"},center_peek:{defaultMessage:"Open pages in a focused, centered modal.",id:"database.viewPropertiesMenu.peekMode.description.centerPeek"},full_page:{defaultMessage:"Open pages in full page.",id:"database.viewPropertiesMenu.peekMode.description.fullPage"}}),u=e=>{switch(e){case"side_peek":return s.default.formatMessage(c.side_peek);case"center_peek":return s.default.formatMessage(c.center_peek);case"full_page":return s.default.formatMessage(c.full_page)}},p=e=>{switch(e){case"side_peek":return s.default.formatMessage(d.side_peek);case"center_peek":return s.default.formatMessage(d.center_peek);case"full_page":return s.default.formatMessage(d.full_page)}},m=e=>{switch(e){case"side_peek":return r.y;case"center_peek":return o.Q;case"full_page":return i.M}}},65742:(e,t,n)=>{n.d(t,{AZ:()=>q,B8:()=>V,BJ:()=>C,C1:()=>G,DS:()=>N,EW:()=>J,GK:()=>L,Ge:()=>k,Gz:()=>A,H5:()=>M,HZ:()=>_e,Ii:()=>ce,Ip:()=>W,Ne:()=>ue,PF:()=>O,Qw:()=>ge,S7:()=>b,ST:()=>B,TW:()=>F,Tp:()=>re,WD:()=>be,Wk:()=>y,XO:()=>Z,YE:()=>ve,YP:()=>le,Zn:()=>me,_Q:()=>ne,_e:()=>P,al:()=>j,bK:()=>U,bk:()=>E,cK:()=>z,d$:()=>K,e$:()=>R,fc:()=>te,fj:()=>$,i2:()=>S,lf:()=>_,lx:()=>I,pQ:()=>ae,pe:()=>de,ph:()=>ye,px:()=>w,qG:()=>X,rr:()=>ie,vX:()=>he,x2:()=>D,xI:()=>Q,xJ:()=>Y,xP:()=>oe,xd:()=>fe,y1:()=>pe,yk:()=>ee});var o=n(30120),i=n(13991),r=n(49085),a=n(30823),s=n(99036),l=n(80951),c=n(40506),d=n(7057),u=n(53877),p=n(6695),m=n(42875),f=n(15157),g=n(97880),h=n(77794),v=n(77181);const b=5,y=3,_=2,S=21;let w=function(e){return e[e.LeftResizer=0]="LeftResizer",e[e.RightResizer=1]="RightResizer",e[e.ItemDrag=2]="ItemDrag",e}({});const k=4e3,I=k/4,x=864e5,C={hours:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"fifteen_minutes",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:x/7e3,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"fifteen_minutes",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:9,getDateRangePlaceholderDuration:e=>e.plus({hour:1})},day:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"hour",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:69120,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"hour",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:2,getDateRangePlaceholderDuration:e=>e.plus({hour:3})},week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:48e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:"day",showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:1})},bi_week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:108e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:3})},month:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:216e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:5})},quarter:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:72e5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:35,getDateRangePlaceholderDuration:e=>e.plus({week:2})},year:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:x/5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:6,getDateRangePlaceholderDuration:e=>e.plus({week:4})}},T="month";function M(e){var t;return null===(t=P(e))||void 0===t?void 0:t.property}function P(e){const t=e.normalizedFormatStore.state.timeline_arrows_by;if(null==t||!t.property)return;const n=e.normalizedSchemaStore.state[t.property],o=e.collectionStore();return n&&"relation"===n.type&&n.property&&o&&(0,s.F0)(n)===o.id?{property:t.property,inverse:n.property}:void 0}function A(e){return{zoomLevel:r.default.createValue(T),currentRange:r.default.createValue({startTimestamp:0,endTimestamp:0}),dragState:r.default.createValue(void 0),drawState:r.default.createValue(void 0),hoveredItem:r.default.createValue(void 0),dateRangePlaceholder:r.default.createValue({active:!1}),scrollLeft:r.default.createValue(void 0),outerSizeObserver:new h.E,timelineSizeObserver:new h.E,horizontalScroller:void 0,savePreference:void 0,isFullScreen:e.isFullScreen,isRootChild:e.isRootChild,destroyed:!1}}function R(e,t){return t/C[e].msPerPixel}function D(e,t){return t*C[e].msPerPixel}function B(e){return"fifteen_minutes"===e||"hour"===e}function E(e){const{store:t,query:n,schema:o,userId:i,intl:r}=e,l=t.getModel();if(!l)return;const c=t.getAssociatedCollectionStore(),{timeline_by:d,timeline_by_end:p}=n;if(!d)return;const f=o[d];if(!f||!(0,s.Lt)(f))return;const g=(0,a.FT)({property:d,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:null==c?void 0:c.getPropertyMapping(),collectionRequestContext:{userId:i,userTimeZone:(0,m.r)(),depth:0,intl:r,visitedProperties:new Set,resultCache:new Map}}).next().value;if("date"!==(null==g?void 0:g.type))return;const h=g.value;if(!p||d===p)return h;{const e=o[p];if(!e||!(0,s.Lt)(e))return;const n=(0,a.FT)({property:p,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:void 0,collectionRequestContext:{userId:i,userTimeZone:(0,m.r)(),depth:0,intl:r,visitedProperties:new Set,resultCache:new Map}}).next().value;if(n&&"date"===n.type){const e=n.value,t=u.rH(h,e);if(t)return u.Qq(t)}}}function F(e){const{store:t,dateValue:n,query:o,schema:i}=e,{timeline_by:r,timeline_by_end:a}=o;if(!r)return;const d=i[r];if(d&&(0,s.Lt)(d)){if(!a||r===a)return{[r]:(0,l.d7)(n)};{const e=i[a];if(!e||!(0,s.Lt)(e))return;const o=(0,l.Gl)(t.getPropertyValue(r)),d=(0,l.Gl)(t.getPropertyValue(a));if("date"===n.type)return{[r]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[a]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(d)})};if("daterange"===n.type)return{[r]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[a]:(0,l.d7)({type:"date",start_date:n.end_date,reminder:c.V3(d)})};if("datetime"===n.type)return{[r]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[a]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(d)})};if("datetimerange"===n.type)return{[r]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[a]:(0,l.d7)({type:"datetime",start_date:n.end_date,start_time:n.end_time,time_zone:n.time_zone,reminder:c._3(d)})};(0,g.t1)(n)}}}function Z(e,t){const n=B(t),o=u.NK(n?e:c.Dy(e),(0,m.r)()),i=N(o.start,t),r=n&&"date"===e.type?o.start.plus({days:1}).startOf("day"):o.end||i;return{start:i,end:n?N(r,t):W(r,t)}}function V(e){return`timeline:${e}`}function j(e){const{horizontalScroller:t,outerSizeObserver:n}=e,o=e.zoomLevel.state,{startTimestamp:i}=e.currentRange.state;return i+D(o,(t?t.scrollLeft:0)+n.rect.state.width/2)}function U(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:i,format:r}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:i,format:r,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})/2)}function L(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:i,format:r}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:i,format:r,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})-o.outerSizeObserver.rect.state.width/2)}function O(e){const{timestamp:t,timelineState:n}=e;return t+D(n.zoomLevel.state,-n.outerSizeObserver.rect.state.width/2)}function N(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15);return e.set({minute:t}).startOf("minute")}return e.startOf(t)}function z(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)-15;return e.set({minute:t}).startOf("minute")}return e.startOf(t).minus({[t]:1}).startOf(t)}function W(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)+15;return e.set({minute:t}).startOf("minute")}return e.plus({[t]:1}).startOf(t)}function q(e){const{startValue:t,snapUnit:n,desiredStart:o,desiredEnd:i}=e;let r=t;const a=c.Ze(t)||(0,m.r)();if(o){const e=H(o,n,"start",a);if("datetime"===e.type)if("date"===r.type){const e={type:"daterange",start_date:r.start_date,end_date:r.start_date};r=u.bD(e,(0,m.r)())}else"daterange"===r.type&&(r=u.bD(r,(0,m.r)()));"date"===r.type?r={...r,type:"daterange",start_date:e.start_date,end_date:r.start_date}:"daterange"===r.type?r={...r,type:"daterange",start_date:e.start_date,end_date:r.end_date}:"datetime"===r.type?r={...r,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:r.start_time,end_date:r.start_date,end_time:r.start_time}:"datetimerange"===r.type&&(r={...r,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:r.start_time})}if(i){const e=H(i,n,"end",a);if("datetime"===e.type)if("date"===r.type){const e={type:"daterange",start_date:r.start_date,end_date:r.start_date};r=u.bD(e,(0,m.r)())}else"daterange"===r.type&&(r=u.bD(r,(0,m.r)()));"date"===r.type||"daterange"===r.type?r={...r,type:"daterange",end_date:e.start_date}:"datetime"!==r.type&&"datetimerange"!==r.type||(r={...r,type:"datetimerange",end_date:e.start_date,end_time:"datetime"===e.type?e.start_time:"datetimerange"===r.type?r.end_time:r.start_time})}return c.qW(r)}function H(e,t,n,o){const i=z(e,t),r=N(e,t),a=W(e,t),s=B(t);let l;return l="start"===n?e.valueOf()>=r.valueOf()+(r.valueOf()-i.valueOf())/2?a:r:e.valueOf()>=r.valueOf()+(r.valueOf()-i.valueOf())/2?s?a:r:s?r:i,function(e,t,n){return B(t)?u.CQ(e.valueOf(),n):u.hT(e.valueOf(),n)}(l,t,o)}function K(e){const{environment:t,isFullScreen:n,isRootChild:o}=e;return(t.device.isDesktop||t.device.isTablet)&&(n||o)}function G(e){const{environment:t,format:n,isFullScreen:o,isRootChild:i}=e;return K({environment:t,isFullScreen:o,isRootChild:i})&&Boolean(n.timeline_show_table)}function $(e){const{isFullScreen:t,isRootChild:n}=e;return!t&&n&&G(e)}function Q(e){const{environment:t,paddingLeft:n,format:o,isFullScreen:i,isRootChild:r}=e;if(!G({environment:t,format:o,isFullScreen:i,isRootChild:r}))return 0;return n+(o.timeline_table_properties||[]).reduce(((e,t)=>(t.width&&t.visible?t.width:0)+e),0)}function Y(){const e=o.ou.now().setLocale(i.SP);return e.toLocaleString(o.ou.TIME_SIMPLE)===e.toLocaleString(o.ou.TIME_24_SIMPLE)}function J(e,t,n){return"day"===n?(0,d.Yx)(t,"month_day_long",e):"month"===n?(0,d.Yx)(t,"month_long",e):void(0,g.t1)(n)}function X(e,t){return"day"===t?(0,d.Yx)(e,"long",i.SP):"month"===t?(0,d.Yx)(e,"month_year_long",i.SP):void(0,g.t1)(t)}function ee(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=C[t],r="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(n.start.valueOf(),r,i.SP)}function te(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=C[t],r=(n.end||n.start).valueOf(),a="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(r,a,i.SP)}function ne(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),i.SP),{primaryDisplayUnit:o}=C[t],r="fifteen_minutes"===o||"hour"===o?"medium_with_time":"medium",a=(0,d.Yx)(n.start.valueOf(),r,i.SP);return n.end?`${a} â†’ ${(0,d.Yx)(n.end.valueOf(),r,i.SP)}`:a}function oe(e,t){return N(e,t)<e?W(e,t):e}function ie(e){return e.device.nativeScrollbarWidth>0||e.device.isFirefox||e.device.isPhone}function re(e){return!(e.device.isFirefox||e.device.isMobile)}function ae(e,t){const n=t.currentUser.id,o=e.getFormat().timeline_preference,i=V(e.id),r=f.Z.get({userId:n,key:i}),a={zoomLevel:T,centerTimestamp:Date.now()};return se(r)||se(o)||a}function se(e){if(e&&"number"==typeof e.centerTimestamp&&p.H.includes(e.zoomLevel))return e}function le(e,t){let n=e.timeline_table_properties||[];if(t){n.find((e=>{let{visible:t}=e;return Boolean(t)}))||(n=(0,p.Rt)(n,"title",!0))}return{timeline_show_table:t,timeline_table_properties:n}}function ce(e){const{environment:t,collectionContextStore:n,timelineState:o,isFullScreen:i,isRootChild:r}=e,a=o.zoomLevel.state,s=n.normalizedFormatStore.state,l=G({environment:t,format:s,isFullScreen:i,isRootChild:r}),c=l&&s.timeline_table_properties?s.timeline_table_properties.length:0,d=s.timeline_properties||[],u=d.filter((e=>"title"!==e.property));return{zoom_level:a,show_table:l,show_table_properties_count:c,show_timeline_title:d.length!==u.length,show_timeline_properties_count:u.length}}const de=33,ue=66,pe=22,me=33,fe=4,ge=96;function he(e){return e?de:ue}function ve(e,t,n){if(!t)return[];const o=M(e);if(!o)return[];const i=t.getPropertyValue(o),r=n[o];return i&&r&&"relation"===r.type?(0,l.j$)({relationValue:(0,l.rq)(i),propertySchema:r,getRecordModel:t.getRecordModel}):[]}function be(e,t,n){var o;if(!t)return[];const i=null===(o=(0,v.T6)(e))||void 0===o?void 0:o.property;if(!i)return[];const r=t.getPropertyValue(i),a=n[i];return r&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(r),propertySchema:a,getRecordModel:t.getRecordModel}):[]}function ye(e,t,n){var o;if(!t)return[];const i=null===(o=(0,v.wf)(e))||void 0===o?void 0:o.property;if(!i)return[];const r=t.getPropertyValue(i),a=n[i];return r&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(r),propertySchema:a,getRecordModel:t.getRecordModel}):[]}function _e(e){const{timelineState:t,placeholderDate:n,subitemPlaceholderDate:o}=e,i=o??e.dateValue;if(!i)return;const r=t.zoomLevel.state,{snapUnit:a}=C[r],{startTimestamp:s,endTimestamp:l}=t.currentRange.state,{start:c,end:d}=Z(i,a),u=d.valueOf()>s&&c.valueOf()<l,p=R(r,c.valueOf()-s)+2,m=o?Math.max(p+40,0):Math.max(p,0),f=R(r,d.valueOf()-s)-2,g=R(r,l-s),h=Math.min(f,g),v=h/R(r,l-s);return{visible:u,isPlaceholder:Boolean(n),isExistingSubitemPlaceholder:Boolean(o),left:m,right:h,maskPercent:v}}},78316:(e,t,n)=>{n.d(t,{Bm:()=>Ue,Bs:()=>fe,Cc:()=>he,Ch:()=>we,D:()=>ye,D2:()=>ce,D8:()=>X,HI:()=>Y,Ks:()=>pe,L5:()=>Se,Mq:()=>q,NG:()=>ae,NU:()=>ie,PD:()=>Q,PI:()=>G,Ql:()=>Ze,SY:()=>Ae,Sc:()=>Te,Se:()=>$,VM:()=>le,Vv:()=>ve,XO:()=>ke,YG:()=>xe,YL:()=>_e,_5:()=>me,az:()=>se,b1:()=>je,bW:()=>Ve,bd:()=>re,bu:()=>H,eD:()=>be,en:()=>ue,fk:()=>Ee,fm:()=>Be,kr:()=>Ce,mb:()=>Pe,p1:()=>de,pB:()=>Me,rD:()=>ge,v_:()=>Fe,w0:()=>Ie,wK:()=>oe,xy:()=>ee,zm:()=>J});n(21703),n(30541),n(57658);var o=n(15145),i=n(41892),r=n(41432),a=(n(14714),n(99036)),s=n(80951),l=n(43690),c=n(8848),d=n(93824),u=n(76837),p=n(95538),m=n(6695),f=n(72126),g=n(4615),h=n(71644),v=n(98963),b=n(21202),y=n(6287),_=n(13493),S=n(19889),w=n(70203),k=n(97880),I=n(9291),x=n(51592),C=n(35541),T=n(95477),M=n(50627),P=n(58202),A=n(49427),R=n(24646),D=n(80444),B=n(88923),E=n(26136),F=n(27724),Z=n(51247),V=n(28020),j=n(4708),U=(n(52821),n(48543)),L=n(84210),O=n(33929),N=n(85957),z=n(17311),W=n(35328);(0,I.defineMessages)({status:{id:"database.viewHelpers.selectProperty.defaultName",defaultMessage:"Status"},date:{id:"database.viewHelpers.dateProperty.defaultName",defaultMessage:"Date"}});const q={showDelay:500,showHold:100},H=new Set(["gallery","list","calendar"]),K=(0,I.defineMessages)({addTypedItemTitle:{id:"collectionViewBlock.action.newItem.typedDatabaseTitle",defaultMessage:"New {singleItemName}"},addItemTitle:{id:"collectionViewBlock.action.newItem.nonTypedDatabaseTitle",defaultMessage:"New"}});function G(e){return"collectionTypedView"===e.contextType?O.default.formatMessage(K.addTypedItemTitle,{singleItemName:(0,x.sN)(e.databaseType)}):O.default.formatMessage(K.addItemTitle)}function $(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"status"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"person"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"multi_select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"relation"===n.type)}))}function Q(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"created_time"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"last_edited_time"===n.type)}))}function Y(e){return Object.keys(e).find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))}function J(e){const{collectionId:t,schema:n,property:o,targetCollectionStore:i}=e,r=n[o];if(!r)return;const l={newSchema:{...n,[o]:void 0},deletedSchema:{[o]:n[o]}};if("relation"===r.type&&a.F0(r)&&r.property&&!(0,s.Kp)(r))if(a.F0(r)===t&&r.property!==o){const e={...l.newSchema,[r.property]:void 0},t={...l.deletedSchema,[r.property]:n[r.property]};l.newSchema=e,l.deletedSchema=t}else if(a.F0(r)!==t&&null!=i&&i.canEditCollection()&&i.isDefined()){const e=a.oC({id:i.id,schema:i.getSchema(),format:i.getFormat(),space_id:i.getSpaceId()}),t={...e,[r.property]:void 0},n={[r.property]:e[r.property]};l.otherCollectionId=i.id,l.otherCollectionSchema=t,l.otherCollectionDeletedSchema=n}return l}function X(e){const{deletedSchema:t,property:n}=e;if(t[n])return{updateSchema:{[n]:t[n]},updateDeletedSchema:{[n]:null}}}async function ee(e){const{environment:t,schema:n,properties:o,property:i,parentStore:r,spaceId:s}=e,l=n[i];if(!l)return;if(a.dx(l))return;const c=(0,h.ZP)(),d={...l,name:(0,u.nM)(l.name)},p=o.findIndex((e=>e.property===i)),m=o[p],f={property:c,visible:!0,width:m&&m.width},b=[...o];let y;if(b.splice(p+1,0,f),"button"===d.type&&d.automation_id){const e=E.Mz.createChildStore(r,{table:v.cv,id:d.automation_id,spaceId:s});await e.load();const n=e.getActionStores();await Promise.all(n.map((e=>e.load())));const o=e.getValue(),i=n.map((e=>e.getValue()));if(!o||!i.every(k.$K))throw new Error("Automation or AutomationActions were not defined.");const a={...o,id:(0,g.ZP)()},l=i.map((e=>{const n={...e,id:(0,g.ZP)()};return(0,u.t1)({original:e,duplicate:n,newParentId:a.id,getRecordRole:r.inMemoryRecordCache.makeGetRecordRoleFn(t.currentUser.id)}),n})),c=t.currentUser.id,p=c?{id:c,table:S.KJ}:void 0;(0,u.tV)({duplicate:a,newParentId:a.parent_id,newActionIds:l.map((e=>e.id)),originOptions:{baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName},options:{},actor:p}),d.automation_id=a.id,y={newAutomationValue:a,newAutomationActionValues:l}}return{newProperty:c,newPropertySchema:d,newProperties:b,automationUpdate:y}}function*te(e){const{rootStore:t,depth:n=0}=e;if(t.getType()===r.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();e&&(yield*te({rootStore:e,depth:n}))}else{const e=t.getContentStores();for(const t of e)yield{blockStore:t,depth:n},t.isNavigableBlock()||(0,W.BX)(t)||(yield*te({rootStore:t,depth:t.getType()===r.Ti.columnList||t.getType()===r.Ti.column||t.getType()===r.Ti.transclusionContainer||t.getType()===r.Ti.transclusionReference?n:n+1}))}}function ne(e,t){const n={image:void 0,blocks:[],isDefined:!0},o=te({rootStore:e});let i=0,a=0;for(const{blockStore:s,depth:c}of o){if(i++,i>l.C7)return n;s.isDefined()||(n.isDefined=!1);const e=s.getType(),o=s.getModel();if(!e||!o)continue;const d=s.getProperties();if(o.isType(r.Ok)&&!n.image&&d){const t=(0,w.QaF)(d.source);if(t&&((0,p.SR)({url:t})||e===r.Ti.image))return n.image={pointer:{table:"block",id:s.id},url:t},n}const u=(0,r.nq)(e),m=o.isType(r.MV)&&(!s.isEmptyTitle()||u),f=t&&void 0!==(0,C.u)(s);(m||f)&&a<l.Uo&&(n.blocks.push({blockStore:s,depth:c}),u||a++)}return n}function oe(e,t){const{image:n,blocks:o,isDefined:i}=ne(e,t);return n?{image:n,blockIds:[],isDefined:i}:{image:void 0,blockIds:o.map((e=>e.blockStore.id)),isDefined:i}}function ie(e){const{rootStore:t,renderAdditionalBlocks:n,theme:o}=e;if(n&&t.isCollectionView())return{image:{url:"dark"===o?i.Z.images.blockRendererCovers.collectionTableDarkPng:i.Z.images.blockRendererCovers.collectionTableLightPng,pointer:{id:t.id,table:t.table,spaceId:t.getSpaceId()}},blockIds:[],isDefined:!0};const{image:a,blocks:s,isDefined:l}=ne(t,n);if(a)return{image:a,blockIds:[],isDefined:l};return{image:void 0,blockIds:s.filter((e=>{const{blockStore:t,depth:n}=e;return 0===n&&t.getType()!==r.Ti.transclusionReference&&t.getType()!==r.Ti.transclusionContainer})).map((e=>e.blockStore.id)),isDefined:l}}function re(e){const t=e.isFullScreen.state,n=e.collectionViewStore();if(!n)throw new Error("Collection view store not defined.");const o=e.normalizedFormatStore.state,i=n.isDefined()&&"board"===n.getType(),r=o.collection_group_by;if(!t||r){const e=m.rx(o.inline_collection_first_load_limit,Boolean(r));if("load_limit"===e.type)return e.limit}return i?20:t?50:20}function ae(e){const{collectionViewStore:t,isFullScreen:n,currentResultCount:o}=e;return t.isDefined()&&"board"===t.getType()?20:n||o<=50?50:100}function se(e,t){const n=e.collectionViewStore();if(!n)return!1;if("collectionVirtualView"===e.contextType)return!1;const o=n.getFormat();return!t||Boolean(o.collection_group_by)}function le(e){const{collectionContextStore:t,isFullScreen:n,reducerResult:o}=e;return o&&o.blockIds.length>0&&!((i=o)&&!i.hasMore)&&se(t,n);var i}function ce(e){const{query:t,schema:n}=e,{timeline_by:o,timeline_by_end:i}=t;if(o){const e=n[o];if(e&&"date"!==e.type)return!1}if(i){const e=n[i];if(e&&"date"!==e.type)return!1}return!0}function de(e){const t=e.getParentBlockStore();return Boolean(t&&t.isLocked())}function ue(e){return(0,N.wq)(e)}function pe(e){return B.default.isSidePeekOpen()&&!ue(e)&&!e.isImmediateColumnChild()&&(e.isRootOrDirectChild()||"page"===e.getType())}function me(e){const t=e.getRecordStoreUIRoot();return!!(t&&t instanceof E.G)&&t.isFullWidth()}function fe(e){const{environment:t,isFullScreen:n,store:o,sizeObserver:i,viewType:r}=e,{device:a,WindowSizeStore:s}=t,l=o.isRootOrDirectChild(),c=!n&&!l,d=A.Z.isBlockInTemplate(o);if(c&&"gallery"===r)return{paddingLeft:1,paddingRight:1};if(l){if(ue(o))return{paddingLeft:B.PeekModePadding.horizontal[B.default.state.mode],paddingRight:B.PeekModePadding.horizontal[B.default.state.mode]};if(a.isPhone)return{paddingLeft:s.getSafePaddingLeftPx((0,V.ui)(t)),paddingRight:s.getSafePaddingRightPx((0,V.ui)(t))};if(n)return{paddingLeft:96,paddingRight:96};if(!d&&!A.Z.isBlockInPageSnapshot(o)||A.Z.isBlockInWiki(o)){if(me(o)||function(e,t){const{WindowSizeStore:n}=e;return n.state.width-((0,R.Wk)(e)+(0,R.ll)(e,t)-(0,R.vJ)(e))<M.zL}(t,ue(o))||pe(o)&&!B.default.isSidePeekClosing.state){const e=(0,V.ui)(t);return{paddingLeft:e,paddingRight:e}}{const e=i.rect.state.width;if(0===e)return;const n=(e-(M.zL-2*(0,V.ui)(t)))/2;return{paddingLeft:n,paddingRight:n}}}{const e=i.rect.state.width;if(0===e)return;const t=me(o)&&d?20+Z.wN:20,n=Math.max((e-M.zL)/2,t);return{paddingLeft:n,paddingRight:n}}}return{paddingLeft:0,paddingRight:0}}function ge(e){switch(e){case"large":return z.Z.card.desktop.large.width;case"small":return z.Z.card.desktop.small.width;case"medium":default:return z.Z.card.desktop.medium.width}}function he(e){let{collectionViewName:t,collectionViewType:n}=e;return t||O.default.formatMessage(je[n])}function ve(e){var t;return((null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewsStore().getValue())||[]).map((t=>E.Xr.createChildStore(e,{table:_.n,id:t}))).find((e=>"table"===e.getType()))}function be(e){const{collectionStore:t,collectionViewBlockStore:n,checkNavigableAncestorLocked:o}=e;if(!n)return!1;if(o&&n.isNavigableAncestorLocked())return!1;const i=null==t?void 0:t.canEditCollection(),r=null==t?void 0:t.getParentBlockStore(),a=null==r?void 0:r.isLocked();return Boolean(i&&!a)}function ye(e,t){const n=e.getType();if(!n)return!1;if(""===t)return!0;return-1!==he({collectionViewName:e.getName(),collectionViewType:n}).toUpperCase().indexOf(t.toUpperCase())}function _e(e){const{newOptions:t,collectionId:n,property:o,schema:i}=e,r=i[o];if(!r)return;if(!a.cu(r)&&"status"!==r.type)return;const s=r.options||[],l=[],c=f.xH(t),u=s.map((e=>e.value)),{beforeOps:p}=(0,d.q)(u,c);for(const[a,d]of Object.entries(p)){const e=s.find((e=>e.value===a));if(e)if(d){const t=s.find((e=>e.value===d));if(t){const i={pointer:{table:y.v,id:n},command:"keyedObjectListBefore",path:["schema",o,"options"],args:{value:e,before:{id:t.id}}};l.push(i)}}else{const t={pointer:{table:y.v,id:n},command:"keyedObjectListAfter",path:["schema",o,"options"],args:{value:e}};l.push(t)}}if("status"===r.type){const e=r.groups??[];for(const[i]of e.entries()){const e=t[i];if(!Array.isArray(e))return;const r=s.filter((t=>e.includes(t.value))).map((e=>e.id)),a={pointer:{table:y.v,id:n},command:"set",path:["schema",o,"groups",i,"optionIds"],args:r};l.push(a)}}return l.length>0?l:void 0}function Se(e){const{collectionId:t,property:n,propertySchema:o,schema:i,isAscending:r}=e;return _e({newOptions:[...o.options||[]].map((e=>e.value)).sort(((e,t)=>e.localeCompare(t,void 0,{sensitivity:"base"})*(r?1:-1))),collectionId:t,property:n,schema:i})}function we(e){const{collectionId:t,property:n,propertySchema:o,newOption:i,isAscending:r}=e,a=o.options||[],s=f.cx(a,(e=>e.value.localeCompare(i.value,void 0,{sensitivity:"base"})*(r?1:-1)>=0));return-1!==s?{pointer:{table:y.v,id:t},command:"keyedObjectListBefore",path:["schema",n,"options"],args:{value:i,before:a[s]}}:{pointer:{table:y.v,id:t},command:"keyedObjectListAfter",path:["schema",n,"options"],args:{value:i}}}function ke(e){const{viewType:t,format:n}=e;return"board"===t?m.Lw(n.board_cover):"gallery"===t?m.Lw(n.gallery_cover):"timeline"===t&&m.vP(Boolean(n.timeline_show_table),n.timeline_table_properties||[])}function Ie(e){const{viewType:t}=e;return"table"===t||("board"===t||("gallery"===t||void 0))}function xe(e){const t=null==e?void 0:e.getType();if(!e||!t)return!1;return"full_page"===(e.getFormat().collection_peek_mode||U.Ls[t])}function Ce(e){const t=null==e?void 0:e.getType();return(null==e?void 0:e.getFormat().collection_peek_mode)??(t?U.Ls[t]:"side_peek")}function Te(e){const{stores:t,phase:n}=F.default.state;return!(n===F.SelectionPhase.Selected&&t.indexOf(e)>=0)&&(B.default.state.open&&B.default.isSidePeekOpen()&&B.default.state.target.id===e.id)}function Me(e,t){return e?{background:c.ZP.blueWithAlpha(.025),boxShadow:t.outlineUltraThinBlueInputBoxShadow,borderRadius:4}:{}}function Pe(e){const{store:t,mainEditorCurrentBlockStore:n,collectionContextStore:i,fullyQualified:r,overridePeekMode:a,showMoveTo:s}=e,l=null==i?void 0:i.collectionViewStore();if(!a&&xe(l))return(0,L.ZP)({store:t,fullyQualified:r,pageVisitSource:(null==i?void 0:i.getPageVisitSourceOverride())??o.tY.Expand,showMoveTo:s});if(n){const e=null==i?void 0:i.getViewType(),c=(null==i?void 0:i.normalizedFormatStore.state.collection_peek_mode)??(e?U.Ls[e]:void 0),d=a??(0,B.getPeekModeFromCollectionPeekModeFormat)(c);return(0,L.ZP)({store:n,collectionViewId:null!=i&&i.isFullScreen.state?null==l?void 0:l.id:void 0,fullyQualified:r,peekViewBlockId:t.id,peekMode:(0,B.getUrlParamFromPeekMode)(d),pageVisitSource:(null==i?void 0:i.getPageVisitSourceOverride())??o.tY.PeekOpen,showMoveTo:s})}}function Ae(e){var t;const n=null===(t=e.getCollectionViewStores().find((e=>"page"===e.getType())))||void 0===t?void 0:t.getFormat().page_pointer;if(n)return E.G.createChildStore(e,{table:b.iU,id:null==n?void 0:n.id,spaceId:e.getSpaceId()})}function Re(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null==e?void 0:e.findRecordStoreUIAncestor((n=>n instanceof E.G&&n.isCollectionView()&&(t||n.id!==e.id))).ancestor}function De(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=Re(e,t);if(n)return P.R.findCollectionViewBlockFromId(n.id)}function Be(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=De(e,t);if(null!=n&&n.collectionContextStore)return n.collectionContextStore}function Ee(e){var t,n;let{environment:o,collectionContextStore:i}=e;const r=(0,j.zq)(o),{currentUserStore:a}=D.default.state,s=Boolean(i.permissionScopes.state.canEditContent||"collectionTypedView"===i.contextType&&(null===(t=i.collectionViewBlockStore())||void 0===t?void 0:t.canEdit()));return!!a&&r&&s&&"table"===(null===(n=i.collectionViewStore())||void 0===n?void 0:n.getType())&&!i.isCompactView.state}function Fe(e,t){let n=t;return e.every((e=>{if(e.getType()===r.Ti.page||e.getType()===r.Ti.collectionViewPage){var t;const o=null===(t=De(e,!1))||void 0===t?void 0:t.props.store.id;return!!o&&(void 0===n&&(n=o),o===n)}return!1}))}function Ze(e){return void 0!==e&&e>=0}function Ve(e){return void 0!==e?e+1:0}const je=(0,I.defineMessages)({board:{id:"database.collectionView.untitledName.board",defaultMessage:"Board"},gallery:{id:"database.collectionView.untitledName.gallery",defaultMessage:"Gallery"},timeline:{id:"database.collectionView.untitledName.timeline",defaultMessage:"Timeline"},calendar:{id:"database.collectionView.untitledName.calendar",defaultMessage:"Calendar"},list:{id:"database.collectionView.untitledName.list",defaultMessage:"List"},table:{id:"database.collectionView.untitledName.table",defaultMessage:"Table"},page:{id:"database.collectionView.untitledName.page",defaultMessage:"Page"}});function Ue(e){let{store:t,collectionContextStore:n}=e;return"collectionVirtualView"===n.contextType?n.collectionStore():t.getAssociatedCollectionStore()}},77181:(e,t,n)=>{n.d(t,{A7:()=>T,Af:()=>A,Av:()=>_,CJ:()=>w,F0:()=>v,Hw:()=>h,JR:()=>Z,Kg:()=>z,Ns:()=>M,SM:()=>P,T2:()=>L,T6:()=>b,bX:()=>S,dI:()=>k,fd:()=>F,g0:()=>V,gY:()=>g,kC:()=>x,ko:()=>j,nK:()=>O,qb:()=>N,uU:()=>B,wP:()=>U,wf:()=>y,xb:()=>I,yU:()=>D,yr:()=>C,zV:()=>R});n(57658);var o=n(76205),i=n(99036),r=n(80951),a=n(60246),s=n(42875),l=n(72126),c=n(95371),d=n(95802),u=n(26136),p=n(28020),m=n(78316),f=n(33929);const g=4,h=24,v=10;function b(e){const t=e.normalizedFormatStore.state.collection_view_subitem,n=e.collectionStore();if(!n||!n.getSchema()||!t)return;const o=n.getSchema()[t.property];if(!o||"relation"!==o.type||i.F0(o)!==n.id)return;const r=o.property;if(!r)return;const a=n.getSchema()[r];return a&&"relation"===a.type?{...t,inverse:r}:void 0}function y(e){var t;const n=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat().subitem_property,o=e.collectionStore();if(!o||!o.getSchema()||!n)return;const r=o.getSchema()[n];if(!r||"relation"!==r.type||i.F0(r)!==o.id)return;const a=r.property;if(!a)return;const s=o.getSchema()[a];return s&&"relation"===s.type?{property:n,inverse:a}:void 0}function _(e){return"table"===e||"timeline"===e||"list"===e}function S(e){var t;const n=(0,m.fm)(e),o=null==n||null===(t=n.collectionViewStore())||void 0===t?void 0:t.getType();return Boolean((null==n?void 0:n.currentSubitemFormatStore.state)&&o&&_(o))}function w(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.property),a=(0,r.rq)(i),s=t.getRecordModel;return r.j$({relationValue:a,propertySchema:o,getRecordModel:s})}function k(e){const{store:t,subitemFormat:n,propertySchema:o,relationPropertyCollectionId:i,originAction:a}=e,s=t.getPropertyValue(n.property),l=(0,r.rq)(s),c=t.getRecordModel;return r.kc({relationValue:l,propertySchema:o,getRecordModel:c,relationPropertyCollectionId:i,originAction:a})}function I(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.inverse),a=(0,r.rq)(i),s=t.getRecordModel;return r.j$({relationValue:a,propertySchema:o,getRecordModel:s})}function x(e){const{store:t,collectionStore:n,collectionContextStore:i,subitemFormat:r,subitemPathKey:a,propertyFilters:l,combinatorFilter:c,currentUserId:d}=e,m=n.getSchema()[r.property];if(!m||"relation"!==m.type)return[];const g=w({store:t,subitemFormat:r,propertySchema:m});if(0===g.length)return[];let h=g.filter((e=>!a.includes(e.id))).map((e=>u.G.createChildStore(t,e)));const v=i.relativeVariableStore.state,b={schema:i.normalizedSchemaStore.state,userId:d,userTimeZone:(0,s.r)(),userStartOfWeek:p.AK.state,intl:f.default.getIntl(),relativeVariableResult:v},y=new Map;if(l&&l.length>0||c){const e=(0,o.q)({filter:{filters:c?[...l.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter)),c]:l.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter)),operator:"and"},context:b});h=h.filter((t=>E({blockStore:t,compiledFilter:e,subitemFormat:r,propertySchema:m,visitedIds:new Set,resultCache:y})))}return h}function C(e,t){var n,o;const r=e.currentSubitemFormatStore.state;if(!r)return new c.DG([]);const d=e.collectionStore();if(!d)return new c.DG([]);const u=e.currentSortsStore.state,p=d.getRecordModel,m=a.$m({userTimeZone:(0,s.r)(),intl:f.default.getIntl(),userSorts:u,userId:e.getCurrentUserId(),apiSorts:[]}),g=e.normalizedSchemaStore.state[r.property],h=g&&"relation"===g.type&&i.F0(g)===(null===(n=e.collectionStore())||void 0===n?void 0:n.id)&&g.property,v=null===(o=e.collectionViewStore())||void 0===o?void 0:o.getType(),b=!h||v&&_(v)?void 0:{property:h,filter:{operator:"is_empty"}},y=[...b&&h?[{id:h,filter:b}]:[],...e.currentPropertyFiltersStore.state],S=e.currentCombinatorFilterStore.state,w=e.subitemExpandedStore.state,k=l.xH(e.groupsStore.getAllGroupStates().map((e=>e.resultsStore.state)));return new c.DG(k.map((n=>{const o=P(n);return(0,c.MW)(o,(n=>{let{store:o,pathKey:i}=n;const s=w.get(i);if(!s)return{value:{store:o,pathKey:i},children:[]};const c=function(e){const{store:t,collectionStore:n,collectionContextStore:o,subitemFormat:i,querySorts:r,limit:s,subitemPathKey:c,propertyFilters:d,combinatorFilter:u,currentUserId:p,getRecordModel:m}=e,f=x({store:t,collectionStore:n,collectionContextStore:o,subitemFormat:i,subitemPathKey:c,propertyFilters:d,combinatorFilter:u,currentUserId:p});if(!f)return[];const g=new a.EO([...r,...a.Xm(f.map((e=>e.id))??[])]),h=new Map;f.forEach((e=>{g.updateBlock({block:e.getModel(),schema:n.getSchema(),propertyMapping:void 0,getRecordModel:m,resultCache:h})}));const v=f.map((e=>e.id))??[],b=a.Qx(v,g),y={};return b.forEach(((e,t)=>{y[e]=t})),l.MR(f,(e=>y[e.id])).slice(0,s)}({store:o,collectionStore:d,collectionContextStore:e,subitemFormat:r,querySorts:m,limit:s.limit,subitemPathKey:i,propertyFilters:y,combinatorFilter:S,currentUserId:t,getRecordModel:p}).map((e=>({store:e,pathKey:R(i,e)})));return{value:{store:o,pathKey:i},children:c}}))})))}function T(e,t){const n=e?[e]:[],o=t.groupsStore.getGroupState(n);if(!o)return[];const i=o.resultsStore.state;if(!t.currentSubitemFormatStore.state)return i;const r=[],a=t.subitemTreeStore.state;for(const s of a.children)D({results:r,tree:s});return r}function M(e){return(0,c.CY)(e.children[e.children.length-1])}function P(e){return{store:e,pathKey:A([e.pointer])}}function A(e){return e.map((e=>e.id)).join(",")}function R(e,t){return e?`${e},${t.id}`:t.id}function D(e){const{results:t,tree:n}=e;t.push(n.value.store);for(const o of n.children)D({results:t,tree:o})}function B(e){var t,n;const{block:o,collectionContextStore:a}=e,s=null==a||null===(t=a.currentSubitemFormatStore.state)||void 0===t?void 0:t.inverse;if(!s)return!1;const l=a.normalizedSchemaStore.state[s];if(!l||!(0,i.p_)(l))return!1;const c=null===(n=a.collectionViewBlockStore())||void 0===n?void 0:n.getRecordModel;if(!c)return!1;return(0,r.Ds)({block:o,propertySchema:l,getRecordModel:c}).length>0}function E(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:i,visitedIds:r,resultCache:a}=e;r.add(t.id);const s=t.getModel();if(!s)return!1;if(n({block:s,getRecordModel:t.getRecordModel,propertyMapping:void 0,resultCache:a}))return!0;const l=w({store:t,subitemFormat:o,propertySchema:i});return 0!==l.length&&l.map((e=>u.G.createChildStore(t,e))).filter((e=>!r.has(e.id))).some((e=>E({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:i,visitedIds:r,resultCache:a})))}async function F(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:i,subitemExpandedStore:a,pathKey:s,forceStoresToLoad:l,visitedIds:c}=e;if(await t.load(),c.has(t.id))return;c.add(t.id);const d=l?await async function(e){const{store:t,subitemFormat:n,propertySchema:o}=e,i=t.getPropertyValue(n.property),a=(0,r.rq)(i);await Promise.all(a.map((e=>u.G.createChildStore(t,e).load())));const s=t.getRecordModel;return r.j$({relationValue:a,propertySchema:o,getRecordModel:s})}({store:t,subitemFormat:o,propertySchema:i}):w({store:t,subitemFormat:o,propertySchema:i});if(0===d.length)return;a.state.set(s,{isExpanded:!0,limit:20});const p=new Map;for(const r of d){const e=u.G.createChildStore(t,r),d=e.getModel();if(!d)continue;n({block:d,getRecordModel:e.getRecordModel,propertyMapping:void 0,resultCache:p})||await F({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:i,subitemExpandedStore:a,pathKey:R(s,e),forceStoresToLoad:l,visitedIds:c})}}function Z(e){if(!e.collectionStore())return;const t=e.currentSubitemFormatStore.state,n=e.normalizedSchemaStore.state,o=(null==t?void 0:t.inverse)&&n[t.inverse],r=(null==t?void 0:t.property)&&n[t.property];if(!(r&&(0,i.p_)(r)&&o&&(0,i.p_)(o)))return;const a=o.property,s=r.property;return a&&s?{childRelationProperty:a,parentRelationProperty:s,childRelationSchema:o,parentRelationSchema:r,subitemFormat:t}:void 0}function V(e){const t=(0,m.fm)(e);if(t)return Z(t)}function j(e){const t=e.getFormat().collection_default_subitem;if(!t)return;const n=e.getSchema()[t];if(!n||"relation"!==n.type)return;const o=n.property;return o?{property:t,inverse:o}:void 0}function U(e,t){if(!e.isType("page"))return!1;if(!t)return!1;return!!t.collectionStore()&&Boolean(t.currentSubitemFormatStore.state)}function L(e){let{blocks:t,parentRelationProperty:n,parentRelationSchema:o,collectionViewBlockStore:i}=e;const a=new Set;for(const r of t)a.add(r.id);return l.xH(t.map((e=>{const t=(e=>{const t=e.getPropertyValue(n);return r.j$({relationValue:r.rq(t),propertySchema:o,getRecordModel:e.getRecordModel})})(e),s=t.map((e=>e.id));if(0===t.length)return[u.G.createChildStore(i,e.pointer)];return d.C.findAllSelectablesFromIds(s.filter((e=>!a.has(e)))).map((e=>e.props.store)).map((t=>u.G.createChildStore(t,e.pointer)))})))}function O(e,t){const n=e.subitemTreeStore,o=(0,c.DY)(n.state.children,(e=>e.value.store===t)),i=o?A(o.map((e=>e.value.store))):"";return e.subitemExpandedStore.state.get(i)}function N(e,t){const n=z(e,t);return e.filter(((e,t)=>n.includes(t)))}function z(e,t){const n=new Set;e.forEach((e=>{n.add(e.pointer.id)}));const o=[];return e.forEach(((e,i)=>{const a=e.getPropertyValue(t.inverse);r.rq(a).some((e=>n.has(e.id)))||o.push(i)})),o}},43224:(e,t,n)=>{n.d(t,{F6:()=>o,pT:()=>i});const o={maxWidth:280,width:"max-content",overflowWrap:"break-word",textWrap:"wrap",whiteSpace:"pre-line"},i=280},26991:(e,t,n)=>{n.d(t,{As:()=>p,Sh:()=>u,iL:()=>m,ki:()=>g,qf:()=>f});var o=n(76205),i=n(30823),r=n(99036),a=n(96367),s=n(21202),l=n(6287),c=n(26136),d=n(29376);function u(e,t){return(0,a.oN)(e,t)}function p(e,t,n,o){const i=e.relativeVariableStore.state;if(i){const e=i[n.id],r=null==e?void 0:e[t];if(r){return c.G.createChildStore(o,{table:s.iU,id:r,spaceId:n.spaceId})}}}function m(e){var t;const{blockStore:n,collectionId:r,appConfigUri:s,variable:l,schema:c}=e;if((null===(t=n.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==r)return!1;const d=a.qB[s][l].reducer,u=d.getProperty(),p=c[u],m=n.getPropertyValue(u),f=d.getPropertyFilter(c,l);return!!(0,o.CA)({filter:f,filterType:"status",relativeVariableValues:void 0})((0,i.yK)({propertySchema:p,propertyValue:m}))}function f(e,t){if((0,o.e)(e.filter)){if(((0,o.vR)(e.filter)?(0,o.YO)(e.filter):[]).some((e=>"relative"===e.type)))return function(e,t){const n=t.getSchema()[e];return!(!n||!(0,r.p_)(n))&&(0,a.oN)((0,d.uJ)(n,t),(0,d.ke)(n,t))}(e.property,t)}return!0}function g(e,t,n){return!!e&&Object.values(e).some((e=>{if("groups"===e.type&&"relation"===e.groupBy.type){const o=e.groupBy.property,i=t[o];if(i.collection_pointer){const e=c.NW.createChildStore(n,{table:l.v,id:i.collection_pointer.id}),t=e.getFormat().app_config_uri;return t&&a.qB[t]&&e.isDefined()&&(0,a.oN)(e.getSchema(),t)}}return!1}))}},78175:(e,t,n)=>{n.d(t,{Po:()=>l,hF:()=>a,zE:()=>s});n(95477);var o=n(78316),i=n(77080),r=n(88923);function a(e){let t=e;for(;t&&(!t||!t.isNavigableBlock());){if("column"===t.getType())return!0;t=t.getParentBlockStore()}return!1}function s(e,t){const{device:n}=t;if(n.isPhone)return!1;if((0,o.en)(e)){return r.default.getSidePeekWidth(t.WindowSizeStore.state.width)>=r.sidePeekNoColumnWidth}return!0}function l(e,t){return!t.device.isMobile&&("on"===i.default.getGroup("columns-full-width")&&(e.isType("column_list")&&e.isChildOfRecordStoreUIRoot()&&s(e,t)&&!(null!==(n=e.getParentBlockStore())&&void 0!==n&&n.isFullWidth())&&!(0,o.en)(e)));var n}},78663:(e,t,n)=>{n.d(t,{$W:()=>m,FD:()=>g,Fu:()=>h,Xc:()=>f});var o=n(72126),i=n(97880),r=n(57819),a=n(30793),s=n(28685),l=n(26136),c=n(27724),d=n(24666),u=n(33929),p=n(73959);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.getIntl();if("helpMeEdit"===e.key||"helpMeDraft"===e.key||"helpMeWrite"===e.key){var n;const o=null===(n=e.steps)||void 0===n?void 0:n[0],i="text"===(null==o?void 0:o.type)&&o.prefilledValue;return i?t.formatMessage({id:"completionPopup.prefilledValue",defaultMessage:"Write about {prefilledValue} "},{prefilledValue:i}):""}if(!(0,a.TE)(e.key))return"";switch(e.key){case"brainstormIdeas":return t.formatMessage({id:"completionPopup.brainStorm.prefilledValue",defaultMessage:"Brainstorm ideas on "});case"blogPost":return t.formatMessage({id:"completionPopup.blogPost.prefilledValue",defaultMessage:"Write a blog post about "});case"outline":return t.formatMessage({id:"completionPopup.outline.prefilledValue",defaultMessage:"Write an outline about "});case"socialMediaPost":return t.formatMessage({id:"completionPopup.socialMediaPost.prefilledValue",defaultMessage:"Write a social media post about "});case"pressRelease":return t.formatMessage({id:"completionPopup.pressRelease.prefilledValue",defaultMessage:"Write a press release about "});case"creativeStory":return t.formatMessage({id:"completionPopup.creativeStory.prefilledValue",defaultMessage:"Write a creative story about "});case"essay":return t.formatMessage({id:"completionPopup.essay.prefilledValue",defaultMessage:"Write an essay about "});case"poem":return t.formatMessage({id:"completionPopup.poem.prefilledValue",defaultMessage:"Write a poem about "});case"todoList":return t.formatMessage({id:"completionPopup.todoList.prefilledValue",defaultMessage:"Write a todo list about "});case"meetingAgenda":return t.formatMessage({id:"completionPopup.meetingAgenda.prefilledValue",defaultMessage:"Write a meeting agenda about "});case"prosConsList":return t.formatMessage({id:"completionPopup.prosConsList.prefilledValue",defaultMessage:"Write a pros and cons list about "});case"jobDescription":return t.formatMessage({id:"completionPopup.jobDescription.prefilledValue",defaultMessage:"Write a job description about "});case"salesEmail":return t.formatMessage({id:"completionPopup.salesEmail.prefilledValue",defaultMessage:"Write a sales email about "});case"recruitingEmail":return t.formatMessage({id:"completionPopup.recruitingEmail.prefilledValue",defaultMessage:"Write a recruiting email about "});default:(0,i.t1)(e.key)}}function f(){const{stores:e}=c.default.state,t=e[0],n=o.Z$(e),i=t?t.getRecordStoreUIRoot():void 0;if(i&&i instanceof l.G&&n){return{type:"blockSelection",stores:e,currentPage:i,origin:n,scrollerStore:(0,r.Dj)(i)}}}function g(){const e=d.default.state;if("editing"!==e.mode)return;const t=e.multiSelection,n=t.start.store,o=n.getRecordStoreUIRoot(),i=s.E.findNodeFromStore(n),a=(0,p.sQ)(n),c=null==a?void 0:a.getRecordStoreUIParent(),u=(0,r.Dj)(o),m=a&&a instanceof l.G&&a!==o?a:void 0,f=m??i;if(!(o&&o instanceof l.G&&f))return;return{type:"cursor",textSelection:t,currentPage:o,currentBlock:m,origin:f,currentParent:c,scrollerStore:u,isPageTitle:o.id===n.id}}function h(){const{stores:e}=c.default.state,t=d.default.state,n="empty"!==t.mode?t.multiSelection:void 0,o="empty"!==t.mode?t.multiSelection.start.store:void 0,i=o?o.getRecordStoreUIRoot():void 0;if(n&&i&&i instanceof l.G){const t=(0,p.sQ)(n.end.store),o=null==t?void 0:t.getRecordStoreUIParent(),a=(0,r.Dj)(i);if(t&&o){return{type:"textSelection",stores:e,textSelection:n,currentPage:i,origin:t,endBlock:t,endBlockParent:o,scrollerStore:a}}}}},43455:(e,t,n)=>{n.d(t,{$A:()=>b,Ie:()=>k,KF:()=>h,N9:()=>w});n(57658);var o=n(40591),i=n.n(o),r=n(41432),a=n(19531),s=n(22808),l=n(25718),c=n(19889),d=n(70203),u=n(7928),p=n(33929),m=n(83089);function f(e,t){return(0,u.Nz)(e,t).replace(/ /g,"")}const g=(e,t)=>{const{getRecordValue:n,intl:o}=t;let i;if(d.IWo(e)){const t=d.zEN(e);i=`@${f(o,n({table:c.KJ,id:t}))}`}else if(d.fpG(e)){i=d.zyO(e).start_date}return i};function h(){let e=0,t=0;function n(n){e+=1,e>t&&(t=e);try{return l.Lk(n)}finally{e-=1}}function o(){return":".repeat(t-e+2)}return{transformAnnotation:g,transformBlockMapping:{callout(e){var t;const{block:i,exportArgs:r}=e,a=l.WB({block:i,exportArgs:r}),c=null===(t=i.format)||void 0===t?void 0:t.page_icon,d=(0,s.Z)(c)?c:"",u=n(e),p=o();return{text:`${p} aside ${d}\n\n${a}`.trim(),breakLines:!0,children:u,suffix:p}},toggle(e){const{block:t,exportArgs:i}=e,r=l.WB({block:t,exportArgs:i}),a=n(e),s=o();return{text:`${s} â–¶ ${r}\n\n`.trim(),breakLines:!0,children:a,suffix:s}}}}}const v=(0,m.V9)({unicode:()=>/@\p{Letter}+/gu,fallback:/@[A-Za-z]+/g});async function b(e,t,n){const o=e.matchAll(v),i=[];for(const r of o){const e=r[0].slice(1);if(void 0===n.get(e)){const o=async()=>{const o=await y(t,e);o?(o.email,n.set(e,o)):n.set(e,null)};i.push(o())}}await Promise.all(i)}async function y(e,t){const n=await e(t),o=p.default.getIntl();let i;for(const r of n){if(f(o,r)===t){if(i)return;i=r}}return i}function _(e){const{md:t,name:n,regex:o,createTokens:i}=e,{arrayReplaceAt:r}=t.utils;function a(e,t,r){let a=0;const s=[];if(e.replace(o,(function(o){const l=Array.from(arguments);let c=l.length-1;"string"!=typeof l[c]&&(c-=1);const d=l[c],u=l[c-1];if(u>0&&(0,m.D_)(d[u-1]))return"";if(u+o.length<d.length&&(0,m.D_)(d[u+o.length]))return"";const p=i(o,t);if(!p)return"";if(u>a){const t=new r("text","",0);t.content=e.slice(a,u),s.push(t)}for(const{type:e,attrs:t,tag:i,level:a,content:m}of p){const o=new r(e,"",0);if(t)for(const[e,n]of Object.entries(t))o.attrPush([e,n]);i&&(o.tag=i,o.markup=n),void 0!==a&&(o.level=a),m&&(o.content=m),s.push(o)}return a=u+o.length,""})),a<e.length){const t=new r("text","",0);t.content=e.slice(a),s.push(t)}return s}t.core.ruler.after("linkify",n,(e=>{let t=0;const n=e.tokens;for(let i=0;i<n.length;i++){const s=n[i].children;if("inline"===n[i].type&&s)for(let l=s.length-1;l>=0;l--){const c=s[l];"link_open"!==c.type&&"link_close"!==c.type||"auto"===c.info&&(t-=c.nesting),"text"===c.type&&0===t&&o.test(c.content)&&(n[i].children=r(s,l,a(c.content,c.level,e.Token)))}}return!0}))}function S(e){return t=>{!function(e){_({md:e,name:"date_mentions",regex:/20\d\d-\d\d-\d\d/g,createTokens:(e,t)=>[{type:"date_mention_open",tag:"time",attrs:{datetime:e,[a.KD.dateFormat]:"relative"},level:t+1},{type:"text",content:e},{type:"date_mention_close",tag:"/time",level:t}]})}(t),function(e,t){_({md:e,name:"user_mentions",regex:v,createTokens(e,n){const o=e.slice(1),i=t.get(o);if(i)return[{type:"user_mention_open",tag:"a",level:n+1,attrs:{[a.KD[d.GKr.User]]:i.id}},{type:"text",content:e},{type:"user_mention_close",tag:"/a",level:n}]}})}(t,e),function(e){const t=/^aside\s+(.*)$/,n={validate:e=>Boolean(e.trim().match(t)),render(n,o){if(1===n[o].nesting){const i=n[o].info.trim().match(t);let l=(null==i?void 0:i[1])??"";(0,s.Z)(l)||(l="");const c="gray_background";return`<div ${function(e,t){const n=[];for(const[o,i]of t)n.push(`${o}="${e.utils.escapeHtml(i)}"`);return n.join(" ")}(e,[[a.KD[r.Ti.callout],""],[a.KD.calloutBackground,c],[a.KD.calloutIcon,l]])}>`}return"</div>"}};e.use(i(),"callout_block",n)}(t),function(e){const t=/^â–¶\s+(.*)$/,n={validate:e=>Boolean(e.trim().match(t)),render(n,o){if(1===n[o].nesting){const i=n[o].info.trim().match(t),r=(null==i?void 0:i[1])??"";return`<details><summary>${e.utils.escapeHtml(r)}</summary>`}return"</details>"}};e.use(i(),"toggle_block",n)}(t)}}function w(e){return{plugin:S(e)}}function k(e){return/\[.+\]\([^)]*$/.test(e)}},19124:(e,t,n)=>{n.d(t,{AC:()=>R,G9:()=>S,GD:()=>I,Gw:()=>D,It:()=>b,KZ:()=>M,RT:()=>C,Zt:()=>x,eL:()=>y,hu:()=>P,mX:()=>A,q:()=>T,qB:()=>_,z1:()=>w});var o=n(94568),i=n(38823),r=n(8848),a=n(52897),s=n(12970),l=n(91856),c=n(11751),d=n(72126),u=n(9291),p=(n(95477),n(80444)),m=n(21273),f=n(77080),g=n(83212),h=n(38755);const v=(0,u.defineMessages)({helpMeWrite:{defaultMessage:"Ask AI to write...",id:"id.completions.helpMeWrite"},helpMeWritePlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "5 reasons why we should hire a dedicated designer"',id:"id.completions.helpMeWritePlaceholder"},helpMeDraftPlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "article about the benefits of learning a new language"',id:"id.completions.helpMeDraftPlaceholder"},summarize:{defaultMessage:"Summarize",id:"id.completions.summarize"},findActionItems:{defaultMessage:"Find action items",id:"id.completions.findActionItems"},summarizeMeetingTranscript:{id:"id.completions.summarizeMeetingTranscript",defaultMessage:"Summarize meeting"}}),b={key:"helpMeWrite",category:"writeWithAI",name:v.helpMeWrite,svg:c.t,svgFill:r.FN.light.purple[400],requiresContent:!0,steps:[{key:"prompt",name:v.helpMeWritePlaceholder,placeholder:v.helpMeWritePlaceholder,type:"text"}]},y={key:"helpMeDraft",category:"draftWithAI",name:v.helpMeWrite,svg:c.t,svgFill:r.FN.light.purple[400],requiresNoContent:!0,steps:[{key:"prompt",name:v.helpMeDraftPlaceholder,placeholder:v.helpMeDraftPlaceholder,type:"text"}]};function _(e){const{customPrompt:t,isPageEmpty:n}=e;return{key:n?"helpMeDraft":"helpMeWrite",category:"writeWithAI",name:v.helpMeWrite,svg:a.d,svgFill:r.FN.light.purple[400],steps:[{key:"prompt",name:v.helpMeWritePlaceholder,placeholder:v.helpMeWritePlaceholder,type:"text",prefilledValue:t}]}}function S(){return[{key:"summarize",category:"extractFromContent",name:v.summarize,svg:l.Y,svgFill:r.FN.light.purple[400]},{key:"findActionItems",category:"extractFromContent",name:v.findActionItems,svg:s.O,svgFill:r.FN.light.purple[400]},b]}function w(){return d.KX(S(),"key")}function k(){const e=p.default.state.currentSpaceStore;return!!e&&e.isAiEnabledOnSpace()}function I(e){if(f.default.checkGate("disable_ai_big_red_button"))return!1;const t=p.default.state.currentSpaceStore;if((0,h.Cx)(t))return!1;const n=null==t?void 0:t.canRead();return!(e&&e.hasPublicPermission&&!n)&&k()}function x(e){return k()}function C(e,t){return I(e)&&t.canEdit()}function T(){return f.default.checkGate("autotag_ambient_trigger")&&f.default.checkGate("autotag_ambient_trigger_space")}function M(){return f.default.checkGate("autofill_tags")}function P(){return f.default.checkGate("autofill_translate")}function A(e,t,n){return I(t)&&n.canEditCollection()}function R(e){m.Z.setState(new i.m({getEligibleGroup:e=>f.default.getEligibleGroup({experimentId:e}),isAiEnabled:()=>{const t=p.default.state.mainEditorCurrentBlockStore;return I(t&&g.Z.getMode(e,t))},getIsWorkspaceVectorEmbeddingsComplete:()=>{var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.embedding_index_is_live)??!1},checkGate:e=>f.default.checkGate(e)}))}function D(){var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e?void 0:e.id)===o.vj}},53323:(e,t,n)=>{n.d(t,{L:()=>s,n:()=>l});var o=n(63143),i=n(88632),r=n(99757);const a=1*o.hM;function s(){var e;if(i.Z.state.online){if(null!==(e=r.Z.state.connectionError)&&void 0!==e&&e.startTime){var t;if(Date.now()-(null===(t=r.Z.state.connectionError)||void 0===t?void 0:t.startTime)<a)return}return r.Z.state.connectionError}}function l(){return Boolean(s())}},46150:(e,t,n)=>{n.d(t,{C7:()=>m,D1:()=>v,G0:()=>u,GF:()=>r,GZ:()=>s,HM:()=>l,X1:()=>g,_F:()=>c,eD:()=>p,g4:()=>h,xp:()=>b});var o=n(62619);const i="data-content-editable-leaf",r={[i]:!0},a="data-content-editable-root",s={[a]:!0},l="data-content-editable-selecting",c="data-content-editable-composing",d="data-content-editable-void",u={[d]:!0};function p(e){return o.kK(e)&&e.hasAttribute(i)}function m(e){return Boolean(o.kK(e)&&e.querySelector("[data-content-editable-leaf]"))}function f(e){return o.kK(e)&&e.hasAttribute(a)}function g(e){return o.sh(e,p)}function h(e,t){return e.parentElement===t?e:o.sh(e,(e=>e.parentElement===t))||e}function v(e,t){if(!e||!t)return!1;const n=b(e),o=b(t);return Boolean(n&&n===o)}function b(e){const t=o.sh(e,(e=>f(e)||function(e){return o.kK(e)&&e.hasAttribute(d)}(e)));if(t&&f(t))return t}},40959:(e,t,n)=>{n.d(t,{Hc:()=>k,MU:()=>w,O5:()=>I});var o=n(1302),i=n(41892),r=n(41432),a=n(45953),s=n(21202),l=n(9291),c=n(98104),d=n(33929),u=n(95802),p=n(21273),m=n(19037),f=n(42),g=n(4708),h=n(78175),v=n(19124),b=n(68056),y=n(73959),_=n(89086);const S=(0,l.defineMessages)({textTitle:{id:"newBlock.text.title",defaultMessage:"Text"},textDescription:{id:"newBlock.text.description",defaultMessage:"Just start writing with plain text."},textKeywords:{id:"newBlock.text.fuzzySearchKeywords",defaultMessage:"Plain Text"},pageTitle:{id:"newBlock.page.title",defaultMessage:"Page"},pageDescription:{id:"newBlock.page.description",defaultMessage:"Embed a sub-page inside this page."},pageKeywords:{id:"newBlock.page.fuzzySearchKeywords",defaultMessage:"Page"},linkToPageTitle:{id:"newBlock.linkToPage.title",defaultMessage:"Link to page"},linkToPageDescription:{id:"newBlock.linkToPage.description",defaultMessage:"Link to an existing page."},linkToPageKeywords:{id:"newBlock.linkToPage.fuzzySearchKeywords",defaultMessage:"Link to page ltp"},linkedDatabaseDescription:{id:"newBlock.linkToCollection.description",defaultMessage:"Add an existing database to this page."},transclusionContainerTitle:{id:"newBlock.transclusionContainer.title",defaultMessage:"Synced block"},transclusionContainerDescription:{id:"newBlock.transclusionContainer.description",defaultMessage:"Sync content across pages."},transclusionContainerKeywords:{id:"newBlock.transclusionContainer.fuzzySearchKeywords",defaultMessage:"Create synced block reference transclusion portal block embed group"},toDoTitle:{id:"newBlock.toDo.title",defaultMessage:"To-do list"},toDoDescription:{id:"newBlock.toDo.description",defaultMessage:"Track tasks with a to-do list."},toDoKeywords:{id:"newBlock.toDo.fuzzySearchKeywords",defaultMessage:"Todo To-Do Checkbox List"},headerTitle:{id:"newBlock.header.title",defaultMessage:"Heading 1"},headerDescription:{id:"newBlock.header.description",defaultMessage:"Big section heading."},headerKeywords:{id:"newBlock.header.fuzzySearchKeywords",defaultMessage:"Heading 1 # h1"},subHeaderTitle:{id:"newBlock.subHeader.title",defaultMessage:"Heading 2"},subHeaderDescription:{id:"newBlock.subHeader.description",defaultMessage:"Medium section heading."},subHeaderKeywords:{id:"newBlock.subHeader.fuzzySearchKeywords",defaultMessage:"sub heading 2 ## h2 two"},subSubHeaderTitle:{id:"newBlock.subSubHeader.title",defaultMessage:"Heading 3"},subSubHeaderDescription:{id:"newBlock.subSubHeader.description",defaultMessage:"Small section heading."},subSubHeaderKeywords:{id:"newBlock.subSubHeader.fuzzySearchKeywords",defaultMessage:"subsub heading 3 ### h3 three"},imageTitle:{id:"newBlock.image.title",defaultMessage:"Image"},imageDescription:{id:"newBlock.image.description",defaultMessage:"Upload or embed with a link."},imageKeywords:{id:"newBlock.image.fuzzySearchKeywords",defaultMessage:"Image Picture Gif Giphy"},bookmarkTitle:{id:"newBlock.bookmark.title",defaultMessage:"Web bookmark"},bookmarkDescription:{id:"newBlock.bookmark.description",defaultMessage:"Save a link as a visual bookmark."},bookmarkKeywords:{id:"newBlock.bookmark.fuzzySearchKeywords",defaultMessage:"Web Link Bookmark"},dividerTitle:{id:"newBlock.divider.title",defaultMessage:"Divider"},dividerDescription:{id:"newBlock.divider.description",defaultMessage:"Visually divide blocks."},dividerKeywords:{id:"newBlock.divider.fuzzySearchKeywords",defaultMessage:"Horizontal Rule Divider --- â€”-"},codeTitle:{id:"newBlock.code.title",defaultMessage:"Code"},codeDescription:{id:"newBlock.code.description",defaultMessage:"Capture a code snippet."},codeKeywords:{id:"newBlock.code.fuzzySearchKeywords",defaultMessage:"Code ```"},quoteTitle:{id:"newBlock.quote.title",defaultMessage:"Quote"},quoteDescription:{id:"newBlock.quote.description",defaultMessage:"Capture a quote."},quoteKeywords:{id:"newBlock.quote.fuzzySearchKeywords",defaultMessage:"Quote"},bulletedListTitle:{id:"newBlock.bulletedList.title",defaultMessage:"Bulleted list"},bulletedListDescription:{id:"newBlock.bulletedList.description",defaultMessage:"Create a simple bulleted list."},bulletedListKeywords:{id:"newBlock.bulletedList.fuzzySearchKeywords",defaultMessage:"Bulleted Unordered List"},numberedListTitle:{id:"newBlock.numberedList.title",defaultMessage:"Numbered list"},numberedListDescription:{id:"newBlock.numberedList.description",defaultMessage:"Create a list with numbering."},numberedListKeywords:{id:"newBlock.numberedList.fuzzySearchKeywords",defaultMessage:"Numbered Ordered List"},toggleTitle:{id:"newBlock.toggle.title",defaultMessage:"Toggle list"},toggleDescription:{id:"newBlock.toggle.description",defaultMessage:"Toggles can hide and show content inside."},toggleKeywords:{id:"newBlock.toggle.fuzzySearchKeywords",defaultMessage:"Toggle list expand"},fileTitle:{id:"newBlock.file.title",defaultMessage:"File"},fileDescription:{id:"newBlock.file.description",defaultMessage:"Upload or embed with a link."},fileKeywords:{id:"newBlock.file.fuzzySearchKeywords",defaultMessage:"File upload attach"},videoTitle:{id:"newBlock.video.title",defaultMessage:"Video"},videoDescription:{id:"newBlock.video.description",defaultMessage:"Embed from YouTube, Vimeo..."},videoKeywords:{id:"newBlock.video.fuzzySearchKeywords",defaultMessage:"Video"},audioTitle:{id:"newBlock.audio.title",defaultMessage:"Audio"},audioDescription:{id:"newBlock.audio.description",defaultMessage:"Embed from SoundCloud, Spotify..."},audioKeywords:{id:"newBlock.audio.fuzzySearchKeywords",defaultMessage:"Audio Sound Music"},embedTitle:{id:"newBlock.embed.title",defaultMessage:"Embed"},embedDescription:{id:"newBlock.embed.description",defaultMessage:"For PDFs, Google Maps, and more."},embedKeywords:{id:"newBlock.embed.fuzzySearchKeywords",defaultMessage:"Embed iFrame"},driveTitle:{id:"newBlock.drive.title",defaultMessage:"Google Drive"},driveDescription:{id:"newBlock.drive.description",defaultMessage:"Embed a Google Doc, Google Sheet..."},driveKeywords:{id:"newBlock.drive.fuzzySearchKeywords",defaultMessage:"Google Drive"},figmaTitle:{id:"newBlock.figma.title",defaultMessage:"Figma"},figmaDescription:{id:"newBlock.figma.description",defaultMessage:"Embed a Figma file."},figmaKeywords:{id:"newBlock.figma.fuzzySearchKeywords",defaultMessage:"Figma"},loomTitle:{id:"newBlock.loom.title",defaultMessage:"Loom"},loomDescription:{id:"newBlock.loom.description",defaultMessage:"Embed a Loom recording."},loomKeywords:{id:"newBlock.loom.fuzzySearchKeywords",defaultMessage:"Loom"},typeformTitle:{id:"newBlock.typeform.title",defaultMessage:"Typeform"},typeformDescription:{id:"newBlock.typeform.description",defaultMessage:"Embed a Typeform."},typeformKeywords:{id:"newBlock.typeform.fuzzySearchKeywords",defaultMessage:"Typeform"},codepenTitle:{id:"newBlock.codepen.title",defaultMessage:"CodePen"},codepenDescription:{id:"newBlock.codepen.description",defaultMessage:"Embed a CodePen."},codepenKeywords:{id:"newBlock.codepen.fuzzySearchKeywords",defaultMessage:"CodePen"},tweetTitle:{id:"newBlock.tweet.title",defaultMessage:"Tweet"},tweetDescription:{id:"newBlock.tweet.description",defaultMessage:"Embed a Tweet."},tweetKeywords:{id:"newBlock.tweet.fuzzySearchKeywords",defaultMessage:"Tweet"},gistTitle:{id:"newBlock.gist.title",defaultMessage:"GitHub Gist"},gistDescription:{id:"newBlock.gist.description",defaultMessage:"Embed a Gist from GitHub."},gistKeywords:{id:"newBlock.gist.fuzzySearchKeywords",defaultMessage:"GitHub Gist"},mapsTitle:{id:"newBlock.maps.title",defaultMessage:"Google Maps"},mapsDescription:{id:"newBlock.maps.description",defaultMessage:"Embed a Google Map."},mapsKeywords:{id:"newBlock.maps.fuzzySearchKeywords",defaultMessage:"Google Maps"},framerTitle:{id:"newBlock.framer.title",defaultMessage:"Framer"},framerDescription:{id:"newBlock.framer.description",defaultMessage:"Embed a Framer prototype."},framerKeywords:{id:"newBlock.framer.fuzzySearchKeywords",defaultMessage:"Framer"},invisionTitle:{id:"newBlock.invision.title",defaultMessage:"Invision"},invisionDescription:{id:"newBlock.invision.description",defaultMessage:"Embed an Invision project."},invisionKeywords:{id:"newBlock.invision.fuzzySearchKeywords",defaultMessage:"Invision"},mixpanelTitle:{id:"newBlock.mixpanel.title",defaultMessage:"Mixpanel"},mixpanelDescription:{id:"newBlock.mixpanel.description",defaultMessage:"Embed a Mixpanel project."},mixpanelKeywords:{id:"newBlock.mixpanel.fuzzySearchKeywords",defaultMessage:"Mixpanel"},equationTitle:{id:"newBlock.equation.title",defaultMessage:"Block equation"},equationDescription:{id:"newBlock.equation.description",defaultMessage:"Display a standalone math equation."},equationKeywords:{id:"newBlock.equation.fuzzySearchKeywords",defaultMessage:"LaTeX Math Block Equation $$ Formula"},pdfTitle:{id:"newBlock.pdf.title",defaultMessage:"PDF"},pdfDescription:{id:"newBlock.pdf.description",defaultMessage:"Embed a PDF."},pdfKeywords:{id:"newBlock.pdf.fuzzySearchKeywords",defaultMessage:"PDF"},factoryTitle:{id:"newBlock.factory.title",defaultMessage:"Template button"},factoryDescription:{id:"newBlock.factory.description",defaultMessage:"Duplicate blocks with a click."},factoryKeywords:{id:"newBlock.factory.fuzzySearchKeywords",defaultMessage:"Template Duplicate Button"},buttonTitle:{id:"newBlock.button.title",defaultMessage:"Button"},buttonDescription:{id:"newBlock.button.description",defaultMessage:"Run custom automations with a click."},buttonKeywords:{id:"newBlock.button.fuzzySearchKeywords",defaultMessage:"Button automation template duplicate"},breadcrumbTitle:{id:"newBlock.breadcrumb.title",defaultMessage:"Breadcrumb"},breadcrumbDescription:{id:"newBlock.breadcrumb.description",defaultMessage:"Show the current page location."},breadcrumbKeywords:{id:"newBlock.breadcrumb.fuzzySearchKeywords",defaultMessage:"Breadcrumb"},calloutTitle:{id:"newBlock.callout.title",defaultMessage:"Callout"},calloutDescription:{id:"newBlock.callout.description",defaultMessage:"Make writing stand out."},calloutKeywords:{id:"newBlock.callout.fuzzySearchKeywords",defaultMessage:"Callout"},table_of_contentsTitle:{id:"newBlock.tableOfContents.title",defaultMessage:"Table of contents"},table_of_contentsDescription:{id:"newBlock.tableOfContents.description",defaultMessage:"Show an outline of your page."},table_of_contentsKeywords:{id:"newBlock.tableOfContents.fuzzySearchKeywords",defaultMessage:"TOC Table of Contents"},whimsicalTitle:{id:"newBlock.whimsical.title",defaultMessage:"Whimsical"},whimsicalDescription:{id:"newBlock.whimsical.description",defaultMessage:"Embed a Whimsical board."},whimsicalKeywords:{id:"newBlock.whimsical.fuzzySearchKeywords",defaultMessage:"Whimsical"},hexTitle:{id:"newBlock.hex.title",defaultMessage:"Hex"},hexDescription:{id:"newBlock.hex.description",defaultMessage:"Embed a Hex cell."},hexKeywords:{id:"newBlock.hex.fuzzySearchKeywords",defaultMessage:"Hex"},deepnoteTitle:{id:"newBlock.deepnote.title",defaultMessage:"Deepnote"},deepnoteDescription:{id:"newBlock.deepnote.description",defaultMessage:"Embed a Deepnote block."},deepnoteKeywords:{id:"newBlock.deepnote.fuzzySearchKeywords",defaultMessage:"Deepnote"},miroTitle:{id:"newBlock.miro.title",defaultMessage:"Miro"},miroDescription:{id:"newBlock.miro.description",defaultMessage:"Embed a Miro board."},miroKeywords:{id:"newBlock.miro.fuzzySearchKeywords",defaultMessage:"Miro"},abstractTitle:{id:"newBlock.abstract.title",defaultMessage:"Abstract"},abstractDescription:{id:"newBlock.abstract.description",defaultMessage:"Embed an Abstract project."},abstractKeywords:{id:"newBlock.abstract.fuzzySearchKeywords",defaultMessage:"Abstract"},sketchTitle:{id:"newBlock.sketch.title",defaultMessage:"Sketch"},sketchDescription:{id:"newBlock.sketch.description",defaultMessage:"Embed a Sketch document."},sketchKeywords:{id:"newBlock.sketch.fuzzySearchKeywords",defaultMessage:"Sketch"},excalidrawTitle:{id:"newBlock.excalidraw.title",defaultMessage:"Excalidraw"},excalidrawDescription:{id:"newBlock.excalidraw.description",defaultMessage:"Embed an Excalidraw whiteboard."},excalidrawKeywords:{id:"newBlock.excalidraw.fuzzySearchKeywords",defaultMessage:"Excalidraw"},replitTitle:{id:"newBlock.replit.title",defaultMessage:"Replit"},replitDescription:{id:"newBlock.replit.description",defaultMessage:"Embed a repl."},replitKeywords:{id:"newBlock.replit.fuzzySearchKeywords",defaultMessage:"Replit"},databaseTitle:{id:"newBlock.database.title",defaultMessage:"Database"},databaseDescription:{id:"newBlock.database.description",defaultMessage:"Create a new database."},inlineTimelineDatabaseTitle:{id:"newBlock.inlineTimelineDatabase.title",defaultMessage:"Timeline database - Inline"},inlineTimelineDatabaseDescription:{id:"newBlock.inlineTimelineDatabase.description",defaultMessage:"Add a Timeline database to this page."},inlineTimelineDatabaseKeywords:{id:"newBlock.inlineTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Inline"},fullPageTableDatabaseTitle:{id:"newBlock.fullPageTableDatabase.title",defaultMessage:"Table database - Full page"},fullPageTableDatabaseDescription:{id:"newBlock.fullPageTableDatabase.description",defaultMessage:"Add a Table database as a sub-page."},fullPageTableDatabaseKeywords:{id:"newBlock.fullPageTableDatabase.fuzzySearchKeywords",defaultMessage:"Table database - Full page"},fullPageBoardDatabaseTitle:{id:"newBlock.fullPageBoardDatabase.title",defaultMessage:"Board database - Full page"},fullPageBoardDatabaseDescription:{id:"newBlock.fullPageBoardDatabase.description",defaultMessage:"Add a Board database as a sub-page."},fullPageBoardDatabaseKeywords:{id:"newBlock.fullPageBoardDatabase.fuzzySearchKeywords",defaultMessage:"Board database - Full page"},fullPageGalleryDatabaseTitle:{id:"newBlock.fullPageGalleryDatabase.title",defaultMessage:"Gallery database - Full page"},fullPageGalleryDatabaseDescription:{id:"newBlock.fullPageGalleryDatabase.description",defaultMessage:"Add a Gallery database as a sub-page."},fullPageGalleryDatabaseKeywords:{id:"newBlock.fullPageGalleryDatabase.fuzzySearchKeywords",defaultMessage:"Gallery database - Full page"},fullPageListDatabaseTitle:{id:"newBlock.fullPageListDatabase.title",defaultMessage:"List database - Full page"},fullPageListDatabaseDescription:{id:"newBlock.fullPageListDatabase.description",defaultMessage:"Add a List database as a sub-page."},fullPageListDatabaseKeywords:{id:"newBlock.fullPageListDatabase.fuzzySearchKeywords",defaultMessage:"List database - Full page"},fullPageCalendarDatabaseTitle:{id:"newBlock.fullPageCalendarDatabase.title",defaultMessage:"Calendar database - Full page"},fullPageCalendarDatabaseDescription:{id:"newBlock.fullPageCalendarDatabase.description",defaultMessage:"Add a Calendar database as a sub-page."},fullPageCalendarDatabaseKeywords:{id:"newBlock.fullPageCalendarDatabase.fuzzySearchKeywords",defaultMessage:"Calendar database - Full page"},fullPageTimelineDatabaseTitle:{id:"newBlock.fullPageTimelineDatabase.title",defaultMessage:"Timeline database - Full page"},fullPageTimelineDatabaseDescription:{id:"newBlock.fullPageTimelineDatabase.description",defaultMessage:"Add a Timeline database as a sub-page."},fullPageTimelineDatabaseKeywords:{id:"newBlock.fullPageTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Full page"},simpleTableTitle:{id:"newBlock.simple_table.title",defaultMessage:"Table"},simpleTableDescription:{id:"newBlock.simple_table.description",defaultMessage:"Add simple tabular content to your page."},simpleTableKeywords:{id:"newBlock.simple_table.fuzzySearchKeywords",defaultMessage:"Table"},tabTitle:{id:"newBlock.tab.title",defaultMessage:"Tabs"},tabDescription:{id:"newBlock.tab.description",defaultMessage:"Organize content in tabs."},tabKeywords:{id:"newBlock.tab.keywords",defaultMessage:"tab tabs tabbed switch toggle"},toggleFormatHeaderTitle:{id:"newBlock.toggleFormatHeader.title",defaultMessage:"Toggle heading 1"},toggleFormatHeaderDescription:{id:"newBlock.toggleFormatHeader.description",defaultMessage:"Hide content inside a large heading."},toggleFormatHeaderKeywords:{id:"newBlock.toggleFormatHeader.fuzzySearchKeywords",defaultMessage:"toggle heading expand 1 # h1"},toggleFormatSubHeaderTitle:{id:"newBlock.toggleFormatSubHeader.title",defaultMessage:"Toggle heading 2"},toggleFormatSubHeaderDescription:{id:"newBlock.toggleFormatSubHeader.description",defaultMessage:"Hide content inside a medium heading."},toggleFormatSubHeaderKeywords:{id:"newBlock.toggleFormatSubHeader.fuzzySearchKeywords",defaultMessage:"toggle sub heading expand 2 ## h2 two"},toggleFormatSubSubHeaderTitle:{id:"newBlock.toggleFormatSubSubHeader.title",defaultMessage:"Toggle heading 3"},toggleFormatSubSubHeaderDescription:{id:"newBlock.toggleFormatSubSubHeader.description",defaultMessage:"Hide content inside a small heading."},toggleFormatSubSubHeaderKeywords:{id:"newBlock.toggleFormatSubSubHeader.fuzzySearchKeywords",defaultMessage:"toggle subsub heading expand 3 ### h3 three"},columnListTitle:{id:"newBlock.columnList.title",defaultMessage:"Columns"},columnListDescription:{id:"newBlock.columnList.description",defaultMessage:"Create columns of blocks."},columnListKeywords:{id:"newBlock.columnList.fuzzySearchKeywords",defaultMessage:"Create col column columns block vertical"},column2Title:{id:"newBlock.column2.title",defaultMessage:"2 columns"},column2Description:{id:"newBlock.column2.description",defaultMessage:"Create 2 columns of blocks."},column2Keywords:{id:"newBlock.column2.fuzzySearchKeywords",defaultMessage:"Create col c2 col2 columns block vertical 2col two"},column3Title:{id:"newBlock.column3.title",defaultMessage:"3 columns"},column3Description:{id:"newBlock.column3.description",defaultMessage:"Create 3 columns of blocks."},column3Keywords:{id:"newBlock.column3.fuzzySearchKeywords",defaultMessage:"c3 col3 column3 columns 3col three"},column4Title:{id:"newBlock.column4.title",defaultMessage:"4 columns"},column4Description:{id:"newBlock.column4.description",defaultMessage:"Create 4 columns of blocks."},column4Keywords:{id:"newBlock.column4.fuzzySearchKeywords",defaultMessage:"c4 col4 column4 columns 4col four"},column5Title:{id:"newBlock.column5.title",defaultMessage:"5 columns"},column5Description:{id:"newBlock.column5.description",defaultMessage:"Create 5 columns of blocks."},column5Keywords:{id:"newBlock.column5.fuzzySearchKeywords",defaultMessage:"c5 col5 column5 columns 5col five"},mermaidCodeTitle:{id:"newBlock.mermaidCode.title",defaultMessage:"Code - Mermaid"},mermaidCodeDescription:{id:"newBlock.mermaidCode.description",defaultMessage:"Create a diagram by writing code."},mermaidCodeKeywords:{id:"newBlock.mermaidCode.fuzzySearchKeywords",defaultMessage:"mermaid diagram graphviz flowchart code"},aiSummaryBlockTitle:{id:"newBlock.aiSummaryBlock.title",defaultMessage:"Summary"},aiSummaryBlockDescription:{id:"newBlock.aiSummaryBlock.description",defaultMessage:"Generate a summary for the current page."},aiSummaryKeywords:{id:"newBlock.aiSummaryBlock.fuzzySearchKeywords",defaultMessage:"summary ai"},aiActionItemsBlockTitle:{id:"newBlock.aiActionItemsBlock.title",defaultMessage:"Action items"},aiActionItemsDescription:{id:"newBlock.aiActionItemsBlock.description",defaultMessage:"Extract action items from current page."},aiActionItemsKeywords:{id:"newBlock.aiActionItemsBlock.fuzzySearchKeywords",defaultMessage:"find action items ai"},aiFreePromptBlockTitle:{id:"newBlock.aiFreePromptBlock.title",defaultMessage:"Custom AI Block"},aiFreePromptDescription:{id:"newBlock.aiFreePromptBlock.description",defaultMessage:"Generate content from any instruction."},aiFreePromptKeywords:{id:"newBlock.aiFreePromptBlock.fuzzySearchKeywords",defaultMessage:"ask help question prompt ai custom block content"},drawingTitle:{id:"newBlock.drawing.title",defaultMessage:"Drawing"},drawingDescription:{id:"newBlock.drawing.description",defaultMessage:"Draw and diagram on an infinite canvas."},drawingKeywords:{id:"newBlock.drawing.fuzzySearchKeywords",defaultMessage:"drawing diagram canvas illustration draw sketch tldraw doodle mindmap architecture paint pen"},aiSectionBlockTitle:{id:"newBlock.aiSection.title",defaultMessage:"AI Section"},aiSectionKeywords:{id:"newBlock.aiSection.fuzzySearchKeywords",defaultMessage:"ai section heading meeting note summary action items"}});function w(e){const{key:t,displayName:n,fuzzySearchKeywords:o,blockType:i,thumbnail:r,tooltipPhoto:l,description:c,createTemplate:u,shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}=e,v=d.default.formatMessage(o),b=v!==o.defaultMessage?`${v} ${o.defaultMessage}`:v;return{key:t,displayName:d.default.formatMessage(n),analyticsName:n.defaultMessage,searchName:b,thumbnail:r,tooltipPhoto:l,description:c?d.default.formatMessage(c):void 0,templateRootBlockId:"root",blockType:i,createTemplate:u||(()=>a.Ao.create({[s.iU]:{root:{id:"root",type:i}}})),shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}}const k={[r.Ti.text]:w({key:r.Ti.text,blockType:r.Ti.text,displayName:S.textTitle,fuzzySearchKeywords:S.textKeywords,thumbnail:i.Z.images.blocks.textPng,description:S.textDescription,tooltipPhoto:i.Z.images.tooltips.blocks.textPng}),[r.Ti.page]:w({key:r.Ti.page,blockType:r.Ti.page,displayName:S.pageTitle,fuzzySearchKeywords:S.pageKeywords,thumbnail:i.Z.images.blocks.pagePng,description:S.pageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.pagePng}),[r.Ti.linkToPage]:w({key:r.Ti.linkToPage,blockType:r.Ti.linkToPage,displayName:S.linkToPageTitle,fuzzySearchKeywords:S.linkToPageKeywords,thumbnail:i.Z.images.blocks.linkPng,description:S.linkToPageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.linkToPagePng}),[r.Ti.transclusionContainer]:w({key:r.Ti.transclusionContainer,blockType:r.Ti.transclusionContainer,displayName:S.transclusionContainerTitle,fuzzySearchKeywords:S.transclusionContainerKeywords,thumbnail:i.Z.images.blocks.transclusionPng,description:S.transclusionContainerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.transclusionPng,shouldShow:e=>!(0,m.wT)(e),createTemplate:e=>f._Z()}),[r.Ti.toDo]:w({key:r.Ti.toDo,blockType:r.Ti.toDo,displayName:S.toDoTitle,fuzzySearchKeywords:S.toDoKeywords,thumbnail:i.Z.images.blocks.toDoPng,description:S.toDoDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toDoListPng}),[r.Ti.header]:w({key:r.Ti.header,blockType:r.Ti.header,displayName:S.headerTitle,fuzzySearchKeywords:S.headerKeywords,thumbnail:i.Z.images.blocks.headerPng,description:S.headerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.headerPng}),[r.Ti.subHeader]:w({key:r.Ti.subHeader,blockType:r.Ti.subHeader,displayName:S.subHeaderTitle,fuzzySearchKeywords:S.subHeaderKeywords,thumbnail:i.Z.images.blocks.subheaderPng,description:S.subHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.subHeaderPng}),[r.Ti.subSubHeader]:w({key:r.Ti.subSubHeader,blockType:r.Ti.subSubHeader,displayName:S.subSubHeaderTitle,fuzzySearchKeywords:S.subSubHeaderKeywords,thumbnail:i.Z.images.blocks.subsubheaderPng,description:S.subSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.subsubheaderPng}),[r.Ti.image]:w({key:r.Ti.image,blockType:r.Ti.image,displayName:S.imageTitle,fuzzySearchKeywords:S.imageKeywords,description:S.imageDescription,tooltipPhoto:i.Z.images.tooltips.blocks.imagePng,thumbnail:i.Z.images.blocks.imagePng}),[r.Ti.bookmark]:w({key:r.Ti.bookmark,blockType:r.Ti.bookmark,displayName:S.bookmarkTitle,fuzzySearchKeywords:S.bookmarkKeywords,thumbnail:i.Z.images.blocks.webBookmarkPng,description:S.bookmarkDescription,tooltipPhoto:i.Z.images.tooltips.blocks.webBookmarkPng}),[r.Ti.divider]:w({key:r.Ti.divider,blockType:r.Ti.divider,displayName:S.dividerTitle,fuzzySearchKeywords:S.dividerKeywords,thumbnail:i.Z.images.blocks.dividerPng,description:S.dividerDescription,tooltipPhoto:i.Z.images.tooltips.blocks.dividerPng}),[r.Ti.code]:w({key:r.Ti.code,blockType:r.Ti.code,displayName:S.codeTitle,fuzzySearchKeywords:S.codeKeywords,thumbnail:i.Z.images.blocks.codePng,description:S.codeDescription,tooltipPhoto:i.Z.images.tooltips.blocks.codePng}),[r.Ti.quote]:w({key:r.Ti.quote,blockType:r.Ti.quote,displayName:S.quoteTitle,fuzzySearchKeywords:S.quoteKeywords,thumbnail:i.Z.images.blocks.quotePng,description:S.quoteDescription,tooltipPhoto:i.Z.images.tooltips.blocks.quotePng}),[r.Ti.bulletedList]:w({key:r.Ti.bulletedList,blockType:r.Ti.bulletedList,displayName:S.bulletedListTitle,fuzzySearchKeywords:S.bulletedListKeywords,thumbnail:i.Z.images.blocks.bulletedListPng,description:S.bulletedListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.bulletedListPng}),[r.Ti.numberedList]:w({key:r.Ti.numberedList,blockType:r.Ti.numberedList,displayName:S.numberedListTitle,fuzzySearchKeywords:S.numberedListKeywords,thumbnail:i.Z.images.blocks.numberedListPng,description:S.numberedListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.numberedListPng}),[r.Ti.toggle]:w({key:r.Ti.toggle,blockType:r.Ti.toggle,displayName:S.toggleTitle,fuzzySearchKeywords:S.toggleKeywords,thumbnail:i.Z.images.blocks.togglePng,description:S.toggleDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleListPng,isToggleable:!0}),[r.Ti.file]:w({key:r.Ti.file,blockType:r.Ti.file,displayName:S.fileTitle,fuzzySearchKeywords:S.fileKeywords,thumbnail:i.Z.images.blocks.filePng,tooltipPhoto:i.Z.images.tooltips.blocks.filePng,description:S.fileDescription}),[r.Ti.video]:w({key:r.Ti.video,blockType:r.Ti.video,displayName:S.videoTitle,fuzzySearchKeywords:S.videoKeywords,thumbnail:i.Z.images.blocks.videoPng,tooltipPhoto:i.Z.images.tooltips.blocks.videoPng,description:S.videoDescription}),[r.Ti.audio]:w({key:r.Ti.audio,blockType:r.Ti.audio,displayName:S.audioTitle,fuzzySearchKeywords:S.audioKeywords,thumbnail:i.Z.images.blocks.audioPng,description:S.audioDescription}),[r.Ti.embed]:w({key:r.Ti.embed,blockType:r.Ti.embed,displayName:S.embedTitle,fuzzySearchKeywords:S.embedKeywords,thumbnail:i.Z.images.blocks.embedPng,description:S.embedDescription}),[r.Ti.drive]:w({key:r.Ti.drive,blockType:r.Ti.drive,displayName:S.driveTitle,fuzzySearchKeywords:S.driveKeywords,thumbnail:i.Z.images.blocks.drivePng,description:S.driveDescription,shouldShow:e=>(0,m.P5)()}),[r.Ti.figma]:w({key:r.Ti.figma,blockType:r.Ti.figma,displayName:S.figmaTitle,fuzzySearchKeywords:S.figmaKeywords,thumbnail:i.Z.images.blocks.figmaPng,description:S.figmaDescription}),[r.Ti.loom]:w({key:r.Ti.loom,blockType:r.Ti.loom,displayName:S.loomTitle,fuzzySearchKeywords:S.loomKeywords,thumbnail:i.Z.images.blocks.loomPng,description:S.loomDescription}),[r.Ti.typeform]:w({key:r.Ti.typeform,blockType:r.Ti.typeform,displayName:S.typeformTitle,fuzzySearchKeywords:S.typeformKeywords,thumbnail:i.Z.images.blocks.typeformPng,description:S.typeformDescription}),[r.Ti.codepen]:w({key:r.Ti.codepen,blockType:r.Ti.codepen,displayName:S.codepenTitle,fuzzySearchKeywords:S.codepenKeywords,thumbnail:i.Z.images.blocks.codepenPng,description:S.codepenDescription}),[r.Ti.tweet]:w({key:r.Ti.tweet,blockType:r.Ti.tweet,displayName:S.tweetTitle,fuzzySearchKeywords:S.tweetKeywords,thumbnail:i.Z.images.blocks.twitterPng,description:S.tweetDescription}),[r.Ti.gist]:w({key:r.Ti.gist,blockType:r.Ti.gist,displayName:S.gistTitle,fuzzySearchKeywords:S.gistKeywords,thumbnail:i.Z.images.blocks.githubPng,description:S.gistDescription}),[r.Ti.maps]:w({key:r.Ti.maps,blockType:r.Ti.maps,displayName:S.mapsTitle,fuzzySearchKeywords:S.mapsKeywords,thumbnail:i.Z.images.blocks.mapsPng,description:S.mapsDescription}),[r.Ti.framer]:w({key:r.Ti.framer,blockType:r.Ti.framer,displayName:S.framerTitle,fuzzySearchKeywords:S.framerKeywords,thumbnail:i.Z.images.blocks.framerPng,description:S.framerDescription}),[r.Ti.invision]:w({key:r.Ti.invision,blockType:r.Ti.invision,displayName:S.invisionTitle,fuzzySearchKeywords:S.invisionKeywords,thumbnail:i.Z.images.blocks.invisionPng,description:S.invisionDescription}),[r.Ti.equation]:w({key:r.Ti.equation,blockType:r.Ti.equation,displayName:S.equationTitle,fuzzySearchKeywords:S.equationKeywords,thumbnail:i.Z.images.blocks.texPng,tooltipPhoto:i.Z.images.tooltips.blocks.mathPng,description:S.equationDescription}),[r.Ti.pdf]:w({key:r.Ti.pdf,blockType:r.Ti.pdf,displayName:S.pdfTitle,fuzzySearchKeywords:S.pdfKeywords,thumbnail:i.Z.images.blocks.pdfPng,description:S.pdfDescription}),[r.Ti.factory]:w({displayName:S.factoryTitle,fuzzySearchKeywords:S.factoryKeywords,thumbnail:i.Z.images.blocks.templateButtonPng,key:r.Ti.factory,blockType:r.Ti.factory,description:S.factoryDescription,tooltipPhoto:i.Z.images.tooltips.blocks.templateButtonPng,createTemplate:f.sw,shouldShow:()=>!1}),[r.Ti.button]:w({displayName:S.buttonTitle,fuzzySearchKeywords:S.buttonKeywords,thumbnail:i.Z.images.blocks.templateButtonPng,key:r.Ti.button,blockType:r.Ti.button,description:S.buttonDescription,tooltipPhoto:i.Z.images.tooltips.blocks.templateButtonPng,createTemplate:f.ax,badge:"new"}),[r.Ti.breadcrumb]:w({displayName:S.breadcrumbTitle,thumbnail:i.Z.images.blocks.breadcrumbPng,tooltipPhoto:i.Z.images.tooltips.blocks.breadcrumbPng,description:S.breadcrumbDescription,fuzzySearchKeywords:S.breadcrumbKeywords,key:r.Ti.breadcrumb,blockType:r.Ti.breadcrumb}),[r.Ti.callout]:w({key:r.Ti.callout,blockType:r.Ti.callout,displayName:S.calloutTitle,thumbnail:i.Z.images.blocks.calloutPng,description:S.calloutDescription,fuzzySearchKeywords:S.calloutKeywords,tooltipPhoto:i.Z.images.tooltips.blocks.calloutPng}),[r.Ti.tableOfContents]:w({displayName:S.table_of_contentsTitle,fuzzySearchKeywords:S.table_of_contentsKeywords,thumbnail:i.Z.images.blocks.tableOfContentsPng,tooltipPhoto:i.Z.images.tooltips.blocks.tableOfContentsPng,description:S.table_of_contentsDescription,key:r.Ti.tableOfContents,blockType:r.Ti.tableOfContents}),[r.Ti.whimsical]:w({key:r.Ti.whimsical,blockType:r.Ti.whimsical,displayName:S.whimsicalTitle,fuzzySearchKeywords:S.whimsicalKeywords,thumbnail:i.Z.images.blocks.whimsicalPng,description:S.whimsicalDescription}),[r.Ti.mixpanel]:w({key:r.Ti.mixpanel,blockType:r.Ti.mixpanel,displayName:S.mixpanelTitle,fuzzySearchKeywords:S.mixpanelKeywords,thumbnail:i.Z.images.blocks.mixpanelPng,description:S.mixpanelDescription}),[r.Ti.miro]:w({key:r.Ti.miro,blockType:r.Ti.miro,displayName:S.miroTitle,fuzzySearchKeywords:S.miroKeywords,thumbnail:i.Z.images.blocks.miroPng,description:S.miroDescription}),[r.Ti.abstract]:w({key:r.Ti.abstract,blockType:r.Ti.abstract,displayName:S.abstractTitle,thumbnail:i.Z.images.blocks.abstractPng,description:S.abstractDescription,fuzzySearchKeywords:S.abstractKeywords}),[r.Ti.sketch]:w({key:r.Ti.sketch,blockType:r.Ti.sketch,displayName:S.sketchTitle,thumbnail:i.Z.images.blocks.sketchPng,description:S.sketchDescription,fuzzySearchKeywords:S.sketchKeywords}),[r.Ti.excalidraw]:w({key:r.Ti.excalidraw,blockType:r.Ti.excalidraw,displayName:S.excalidrawTitle,thumbnail:i.Z.images.blocks.excalidrawPng,description:S.excalidrawDescription,fuzzySearchKeywords:S.excalidrawKeywords}),[r.Ti.replit]:w({key:r.Ti.replit,blockType:r.Ti.replit,displayName:S.replitTitle,thumbnail:i.Z.images.blocks.replitPng,description:S.replitDescription,fuzzySearchKeywords:S.replitKeywords}),[r.Ti.table]:w({key:r.Ti.table,blockType:r.Ti.table,displayName:S.simpleTableTitle,thumbnail:i.Z.images.blocks.simpleTablePng,description:S.simpleTableDescription,fuzzySearchKeywords:S.simpleTableKeywords,tooltipPhoto:i.Z.images.tooltips.blocks.simpleTablePng,createTemplate:()=>f.S7()}),[r.Ti.tab]:w({key:r.Ti.tab,blockType:r.Ti.tab,displayName:S.tabTitle,thumbnail:i.Z.images.blocks.tabsPng,tooltipPhoto:i.Z.images.tooltips.blocks.tabsPng,description:S.tabDescription,fuzzySearchKeywords:S.tabKeywords,createTemplate:()=>f.ZW(),shouldShow:e=>(0,m.$c)(e)}),[r.Ti.hex]:w({key:r.Ti.hex,blockType:r.Ti.hex,displayName:S.hexTitle,thumbnail:i.Z.images.blocks.hexPng,description:S.hexDescription,fuzzySearchKeywords:S.hexKeywords}),[r.Ti.deepnote]:w({key:r.Ti.deepnote,blockType:r.Ti.deepnote,displayName:S.deepnoteTitle,thumbnail:i.Z.images.blocks.deepnotePng,description:S.deepnoteDescription,fuzzySearchKeywords:S.deepnoteKeywords}),[r.MF.toggleFormatHeaderBlock]:w({key:r.MF.toggleFormatHeaderBlock,blockType:r.Ti.header,displayName:S.toggleFormatHeaderTitle,fuzzySearchKeywords:S.toggleFormatHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading1Png,description:S.toggleFormatHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH1Png,createTemplate:()=>f.UG(r.Ti.header),isToggleable:!0}),[r.MF.toggleFormatSubHeaderBlock]:w({key:r.MF.toggleFormatSubHeaderBlock,blockType:r.Ti.subHeader,displayName:S.toggleFormatSubHeaderTitle,fuzzySearchKeywords:S.toggleFormatSubHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading2Png,description:S.toggleFormatSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH2Png,createTemplate:()=>f.UG(r.Ti.subHeader),isToggleable:!0}),[r.MF.toggleFormatSubSubHeaderBlock]:w({key:r.MF.toggleFormatSubSubHeaderBlock,blockType:r.Ti.subSubHeader,displayName:S.toggleFormatSubSubHeaderTitle,fuzzySearchKeywords:S.toggleFormatSubSubHeaderKeywords,thumbnail:i.Z.images.blocks.toggleHeading3Png,description:S.toggleFormatSubSubHeaderDescription,tooltipPhoto:i.Z.images.tooltips.blocks.toggleH3Png,createTemplate:()=>f.UG(r.Ti.subSubHeader),isToggleable:!0}),[r.Ti.columnList]:w({key:r.Ti.columnList,blockType:r.Ti.columnList,displayName:S.columnListTitle,fuzzySearchKeywords:S.columnListKeywords,thumbnail:i.Z.images.blocks.columnListPng,description:S.columnListDescription,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(2),shouldShow:e=>!e.environment.device.isPhone}),[r.MF.column2Block]:w({key:r.MF.column2Block,blockType:r.Ti.columnList,displayName:S.column2Title,fuzzySearchKeywords:S.column2Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:S.column2Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(2),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.column3Block]:w({key:r.MF.column3Block,blockType:r.Ti.columnList,displayName:S.column3Title,fuzzySearchKeywords:S.column3Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:S.column3Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(3),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.column4Block]:w({key:r.MF.column4Block,blockType:r.Ti.columnList,displayName:S.column4Title,fuzzySearchKeywords:S.column4Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:S.column4Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(4),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.column5Block]:w({key:r.MF.column5Block,blockType:r.Ti.columnList,displayName:S.column5Title,fuzzySearchKeywords:S.column5Keywords,thumbnail:i.Z.images.blocks.columnListPng,description:S.column5Description,tooltipPhoto:i.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>f.n_(5),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(h.hF)}),[r.MF.mermaidCodeBlock]:w({key:r.MF.mermaidCodeBlock,blockType:r.Ti.code,displayName:S.mermaidCodeTitle,fuzzySearchKeywords:S.mermaidCodeKeywords,thumbnail:i.Z.images.blocks.codePng,description:S.mermaidCodeDescription,tooltipPhoto:i.Z.images.tooltips.blocks.codePng,createTemplate:()=>f.iD("Mermaid","graph TD\n  Mermaid --\x3e Diagram"),postCreateCallback:e=>{o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{const t=u.C.find((t=>t.props.store.id===e.id)),n=null==t?void 0:t.props.store,o=n&&(0,y.mh)(n);if(o){var i;const e=(0,b.TD)({store:o,selection:{startIndex:0,endIndex:(null===(i=(0,_.x0)(o))||void 0===i?void 0:i.endIndex)??0}});c.NA({multiSelection:e})}}))}))}}),[r.MF.aiSummaryBlock]:w({key:r.MF.aiSummaryBlock,blockType:r.Ti.aiBlock,displayName:S.aiSummaryBlockTitle,fuzzySearchKeywords:S.aiSummaryKeywords,thumbnail:i.Z.images.blocks.tableOfContentsPng,description:S.aiSummaryBlockDescription,badge:"ai",createTemplate:()=>f.Jy("summarize"),shouldShow:e=>!e.environment.device.isPhone&&x(e)}),[r.MF.aiActionItemsBlock]:w({key:r.MF.aiActionItemsBlock,blockType:r.Ti.aiBlock,displayName:S.aiActionItemsBlockTitle,fuzzySearchKeywords:S.aiActionItemsKeywords,thumbnail:i.Z.images.blocks.bulletedListPng,description:S.aiActionItemsDescription,badge:"ai",createTemplate:()=>f.Jy("findActionItems"),shouldShow:e=>!e.environment.device.isPhone&&x(e)}),[r.MF.aiFreePromptBlock]:w({key:r.MF.aiFreePromptBlock,blockType:r.Ti.aiBlock,displayName:S.aiFreePromptBlockTitle,fuzzySearchKeywords:S.aiFreePromptKeywords,thumbnail:i.Z.images.blocks.calloutPng,description:S.aiFreePromptDescription,badge:"ai",createTemplate:()=>f.Jy("helpMeWrite"),shouldShow:e=>!e.environment.device.isPhone&&x(e)}),[r.Ti.drawing]:w({key:r.Ti.drawing,blockType:r.Ti.drawing,displayName:S.drawingTitle,fuzzySearchKeywords:S.drawingKeywords,thumbnail:i.Z.images.externalIntegrations.acmeIconPng,description:S.drawingDescription,shouldShow:e=>(0,g.A3)(),createTemplate:()=>f.Fr()}),[r.MF.aiSectionBlock]:w({key:r.MF.aiSectionBlock,blockType:r.Ti.aiBlock,displayName:S.aiSectionBlockTitle,fuzzySearchKeywords:S.aiSectionBlockTitle,thumbnail:i.Z.images.blocks.calloutPng,badge:"ai",createTemplate:()=>f.d6(),shouldShow:e=>!e.environment.device.isPhone&&x(e)&&p.Z.shouldShowAISections()})},I=(k[r.Ti.callout],k[r.Ti.toggle],[r.MF.aiSummaryBlock,r.MF.aiActionItemsBlock,r.MF.aiFreePromptBlock,r.MF.aiSectionBlock]),x=e=>{let{publicEditMode:t}=e;return(0,v.GD)(t)}},11599:(e,t,n)=>{n.d(t,{$0:()=>d,A$:()=>l,ab:()=>s,dy:()=>c,kq:()=>p,p1:()=>u});var o=n(80951),i=n(80444),r=n(88923);function a(){const e=d(),{mainEditorCurrentBlockStore:t}=i.default.state,n=r.default.state.open&&r.default.state.target||t;return e||n}function s(e,t){const n=a(),o=null==n?void 0:n.getFormat(),i=e&&e[t],r=(null==o?void 0:o.collection_page_sections)||[];if(!i){if("backlinks"===t)return"section_collapsed";if("comments"===t)return"section_show";if("margin_comments"===t)return"inline";if(r&&r.filter((e=>e.section===t))){const e=r.find((e=>e.section===t));if(e)return e.visibility}return"inline"}return i}function l(e,t){const n=a();if(!n)return!1;return s(n.getFormat().page_section_visibility,e)===t}function c(e,t){const n=a();if(!n)return!0;return"section_show"===s(n.getFormat().page_section_visibility,t)}function d(){const{mainEditorCurrentBlockStore:e}=i.default.state,t=r.default.state.open&&r.default.state.target||e;return null==t?void 0:t.getAssociatedCollectionStore()}function u(){const e=d();if(!e)return!1;const t=e.getParentBlockStore();return Boolean(t&&(t.isLocked()||t.isNavigableAncestorLocked()))}function p(e){const{propertySchema:t}=e,{type:n}=t,i=(0,o.eb)(t);return!(["created_time","created_by","last_edited_time","last_edited_by"].includes(n)||i)}},41056:(e,t,n)=>{n.d(t,{H:()=>a,u:()=>s});var o=n(49085),i=n(53877);const r=new Map;function a(e){if(!r.has(e)){const t=o.default.createValue((()=>(0,i.Uu)(e)));r.set(e,t)}return r.get(e).state}function s(){for(const[e,t]of r){const n=(0,i.Uu)(e);t.state.equals(n)||t.setState(n)}}},21969:(e,t,n)=>{n.d(t,{H:()=>a,W:()=>r});var o=n(80310),i=n(64002);function r(e){const t=(0,i.Qc)(e);return t.query[o.JF]="true",(0,i.bf)({url:(0,i.WU)(t),query:t.query,hash:t.hash||void 0})}function a(e){const t=(0,i.Qc)((0,i.T1)(e));return t.query[o.f6]="true",(0,i.bf)({url:(0,i.WU)(t),query:t.query,hash:t.hash||void 0})}},74503:(e,t,n)=>{async function o(){const e={};if(!window.__isElectron)return{};const t=window.__desktopDeviceInfo;if(t)e.desktopOsVersion=t.os,e.desktopKernelVersion=t.kernel,e.desktopElectronVersion=t.electron,e.desktopChromiumVersion=t.chromium,e.desktopArch=t.arch,e.desktopPlatform=t.platform;else{const t=["architecture","fullVersionList","platformVersion"],o=await navigator.userAgentData.getHighEntropyValues(t);e.desktopArch="arm"===(n=o.architecture)?"arm64":n,e.desktopOsVersion=o.platformVersion,e.desktopPlatform=window.__platform;const i=navigator.userAgent.match(/Chrome\/([\d.]+)/);e.desktopChromiumVersion=i?i[1]:"Unknown";const r=navigator.userAgent.match(/Electron\/([\d.]+)/);e.desktopElectronVersion=r?r[1]:"Unknown"}var n;return e}n.r(t),n.d(t,{getDesktopDeviceInfo:()=>o})},71776:(e,t,n)=>{n.d(t,{$Z:()=>s,GU:()=>r,OS:()=>l,cr:()=>a});n(57658);var o=n(77420),i=n(9844);function r(e){const{ids:t,table:n,userStore:o}=e,i=[];for(const r of t){const e=o.getRecordModel({id:r,table:n});e&&i.push(e)}return a(i)}function a(e){return e.slice().sort(((e,t)=>t.created_at-e.created_at))}const s=["all","internal","public"],l={[o.cZ]:"internal",[i.K2]:"public"}},25898:(e,t,n)=>{function o(e,t,n,o){return Math.sqrt((e-n)*(e-n)+(t-o)*(t-o))}n.d(t,{Z:()=>o})},62619:(e,t,n)=>{n.d(t,{Gs:()=>a,IL:()=>p,OW:()=>u,UG:()=>r,kA:()=>m,kK:()=>s,kd:()=>c,oG:()=>d,r3:()=>f,sh:()=>l});n(57658);var o=n(15095),i=n(72126);function r(e){try{return Boolean(e&&void 0!==e.nodeType)}catch(t){return!1}}function a(e){return r(e)&&e.nodeType===Node.TEXT_NODE}function s(e){return r(e)&&e.nodeType===Node.ELEMENT_NODE}function l(e,t){for(;r(e)&&!t(e);)e=e.parentNode;return e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(r(e)){for(const n of o.p4(e.childNodes))a(n)?t.push(n):n.childNodes&&c(n,t);return t}return[]}const d=function(e,t){return r(e)&&r(t)?i.cx(e.childNodes,(e=>e===t)):-1},u=(()=>{if("undefined"==typeof window)return!0;if(window.InputEvent&&"function"==typeof window.InputEvent.prototype.getTargetRanges)return!0;const e=window.document.createElement("div");e.contentEditable="true";return"onbeforeinput"in e})(),p=e=>{!u&&e.preventDefault&&e.preventDefault()};function m(e){return"inputType"in e}function f(e,t){return e!==t&&e.contains(t)}},43045:(e,t,n)=>{let o;n.d(t,{N:()=>a});let i=!1;function r(){i||(i=!0,window.requestAnimationFrame((()=>{i=!1,(o||(o=document.createElement("div"),o.style.position="fixed",o.style.top="-9999px",o.style.left="-9999px",o.style.zIndex="-9999",document.body.appendChild(o)),o).style.height=`${Math.random()}px`})))}function a(){const e=window.getSelection();e&&e.anchorNode&&r()}},63085:(e,t,n)=>{n.d(t,{bf:()=>_,kl:()=>w,NX:()=>y,sj:()=>b,W4:()=>p,id:()=>f,cJ:()=>g,I$:()=>S,YG:()=>v});n(21703);var o=n(80951),i=n(68626);n(57658);var r=n(29477),a=n(64002),s=n(95477),l=n(77080),c=n(24608);const d=1e4;async function u(e){const{environment:t,sourceURL:n}=e;let o;o=`https://embed.notion.co/api/iframely?key=${s.default.iframely_prod.key}&url=${n}`;const a={environment:t,method:"GET",url:o,format:"json"},{result:l}=await r.vW(3,1e4,(()=>(0,c.ZP)(a)));if(l&&"success"===l.type)return function(e){const t=e;return Object.keys(e).forEach((n=>{if("meta"===n&&(e[n].title&&(t.title=e[n].title),e[n].description&&(t.description=e[n].description),e[n].site&&(t.provider_name=e[n].site)),"url"===n&&(t.url=e[n]),"links"===n){if(e[n].thumbnail&&e[n].thumbnail.length>0){t.images=[];const o={width:Number,height:Number,url:String};o.width=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.width?e[n].thumbnail[0].media.width:480,o.height=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.height?e[n].thumbnail[0].media.height:1080,o.url=e[n].thumbnail[0]&&e[n].thumbnail[0].href?e[n].thumbnail[0].href:"",t.images.push(o)}e[n].icon&&e[n].icon.length>0&&(t.favicon_url=e[n].icon[0].href)}})),t}(l.data);i.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==l?void 0:l.error,data:{miscDataToConvertToString:{provider:"iframely"}}})}async function p(e,t){const n=encodeURIComponent(t.trim());return"on"===l.default.getEligibleGroup({experimentId:"iframely_switch",defaultGroup:"control"})?await u({environment:e,sourceURL:n}):await async function(e,t){const n={environment:e,method:"GET",url:`https://api.embed.ly/1/extract?key=${s.default.embedly.key}&url=${t}`,format:"json"},{result:o}=await r.vW(3,d,(()=>(0,c.ZP)(n)));if(o&&"success"===o.type)return o.data;i.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==o?void 0:o.error,data:{miscDataToConvertToString:{provider:"embedly"}}})}(e,n)}const m=/(\/d\/|id=)([-\w]{25,})/;function f(e){const t=e.match(m);if(t&&!(t.length<3))return t[2]}function g(e){return o.zB(e.store.getProperties().source)||e.source}const h=new Set(["http:","https:","blob:","data:"]),v=function(e){const t=new URL(e,s.default.domainBaseUrl).protocol;return h.has(t)};function b(e){if(e&&e instanceof _)return{type:"invalid_protocol",protocol:e.protocol}}function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.protocol;const n=S(e);if(!n)return{type:"invalid_url",source:e};const o=new URL(n).protocol;return"https:"===t&&"http:"===o?{type:"invalid_protocol",protocol:o}:void 0}class _ extends Error{constructor(e){const t=new URL(e,s.default.domainBaseUrl).protocol;super(`Invalid URL protocol: "${t}"`),this.name=void 0,this.protocol=void 0,this.protocol=t,this.name="InvalidUrlProtocolError"}}function S(e){let t=a.yn(e);if(t||e.includes(":")||(t=a.yn(`https:${e}`)),t&&new URL(t).origin!==location.origin)return t}function w(e){const{aspectRatio:t,isFullWidth:n,isFullHeight:o,preserveScale:i,height:r}=e,a={position:"relative",display:"flex",justifyContent:"center",width:"100%",minHeight:100};return o?(a.height="100%",a.position=void 0):n||!i?a.height=r:(a.height=0,a.paddingBottom=100*(t||.75)+"%"),a}},83631:(e,t,n)=>{n.d(t,{D9:()=>b,JT:()=>k,Jf:()=>I,ND:()=>y,TJ:()=>S,Xu:()=>_,bc:()=>v,by:()=>w,nk:()=>x,qZ:()=>C});var o=n(41892),i=n(98923),r=n(15095),a=n(65454),s=n(72126),l=n(70203),c=n(44805),d=n(97880),u=n(63143),p=n(50906),m=n(62619),f=n(68056),g=n(89224),h=n(89086);function v(){return(0,a.ZP)(o.Z.katex.katexMinCss,{resourceType:a._g.Stylesheet})}function b(e){const{source:t,currentEquationToken:n,selectedText:o}=e;return"rich_text_menu"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:!0}:"input_keyboard_shortcut"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:Boolean(o)}:"slash_menu"===t?{type:"create",source:t,selection:!1}:"click_token"===t||"arrow_keys"===t?{type:"edit",source:t}:"text_filter"===t?{type:"create",source:t,selection:!0}:void(0,d.t1)(t)}function y(e){const{environment:t,equation:n,from:o}=e;p.iA$(t,{equation:n,equationNewlineCount:n.split("\n").length-1,equationBackslashCount:n.split("\\").length-1,equationLength:r.p4(n).length,from:o})}function _(e){return m.kK(e)&&e.classList.contains(c.et)}function S(e){const{selection:t,environment:n}=e,o=g.getRect(t);if(!o){return m.sh(t.startContainer,m.kK).getBoundingClientRect()}if(n.device.isChrome){const e=t.startContainer.childNodes[t.startOffset];return e&&_(e)?e.getBoundingClientRect():m.kK(t.startContainer)?new DOMRect(o.left,o.top,o.width,t.startContainer.getBoundingClientRect().height):new DOMRect(o.left,o.top,o.width,22)}return o}function w(e){const{environment:t,equation:n,displayMode:o}=e,r=t.KatexStore.getKatex();return r&&(0,i.CY)({katex:r,equation:n,options:{displayMode:"block"===o}}).error}function k(e){if("editing"!==e.mode)return;const t=(0,f.QY)(e.multiSelection);if(!t)return;const{store:n,selection:o}=t,{tokensBeforeRange:i,tokensInsideRange:r}=l.xrQ(n.getValue(),o.startIndex,o.endIndex);let a=s.Sm(i.map(l.J1x));for(const s of r){const e=l.J1x(s),t={startIndex:a,endIndex:a+e};if(l.YrK(s))return{token:s,position:t};a+=e}}function I(e){let t=e;for(let n=0;n<2;n+=1){const e=/^\$(.*)\$$/m.exec(t);if(!e||!e[1])break;t=e[1]}return t}function x(e){const t=(0,f.QY)(e.multiSelection);if(!t)return[];const{selection:n,store:o}=t,i=o.getValue();if(!i)return[];const r=h.wd(n)&&n.startIndex>0?[n.startIndex-1]:[n.startIndex];return h.oc(r,i)[0]||[]}function C(e){const{equationState:t,isTemporary:n}=e,o=t.editingToken?u.uh(l.hDy(t.editingToken),(e=>l.kuv(e)||l.QVC(e))):u.uh(t.annotations,(e=>l.kuv(e)||l.QVC(e)||l.ZAl(e))),i=s.oA([n&&l.W9d(),...o]);return l.qZ6(t.value,i)}},73744:(e,t,n)=>{n.d(t,{DJ:()=>a,ZV:()=>r,lj:()=>i});let o=!1;try{const e=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("test",(()=>{}),e)}catch(s){}const i=function(e,t,n,i){o?e.addEventListener(t,n,{passive:!0,capture:Boolean(i)}):e.addEventListener(t,n,Boolean(i))},r=function(e,t,n,o){e.removeEventListener(t,n,Boolean(o))};function a(e){if(void 0!==e)return"shiftKey"in e&&"altKey"in e&&e.shiftKey&&e.altKey?"window":"metaKey"in e&&e.metaKey||"ctrlKey"in e&&e.ctrlKey?"tab":void 0}},41232:(e,t,n)=>{n.d(t,{GQ:()=>f,Ue:()=>m,Xg:()=>b,_F:()=>h,_l:()=>g,o$:()=>y,pI:()=>v,y6:()=>p});var o=n(17215),i=n(78601),r=n(2864),a=n(97880),s=n(44876),l=n(80444),c=n(77080),d=n(30874),u=n(40671);function p(e){if(e.isCollectionView()){var t,n;if(null===(t=e.getCollectionViewCollectionStore())||void 0===t||!t.isSyncedCollection())return;return null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat()}return e.getFormat()}function m(e,t){const n=d.Z.state;if(!e||!n.loaded)return[];const o=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"!==o.type?[]:n.bots.filter((e=>e.integration_id===o.integration.id))}function f(e,t){if(!e)return;const n=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"===n.type?n:void 0}function g(e){const{store:t,isInDarkMode:n}=e,i=p(t);if(null!=i&&i.is_placeholder||null!=i&&i.error){const e=d.Z.integrations.state.find((e=>{let{id:t}=e;return i.integration_id===t}));if(e){const t=d.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t})),{icon:a,dark_icon:c,accent_color:u,accent_icon:p}=e.info,m=n&&c?c:a;if(!m||!u||!p)return;const f=i.original_url;let g;if(f){var r;const t=(0,s.ny)({url:f,integrations:[e],currentSpaceId:null===(r=l.default.state.currentSpaceStore)||void 0===r?void 0:r.id});"success"===t.type&&(g=t.pattern)}return{type:null!=i&&i.is_placeholder?"placeholder":"error",userHasBotForIntegration:t.length>0,renderConfig:{headerAttributes:[{formatter:o.V1.placeholder,attribute:{id:"title",name:"Title",type:"inline",values:[e.name],format:{type:"title"}}}]},action:f&&!g?"error":void 0,updating:!1,originalUrl:f,pattern:g,integration:{id:e.id,icon:m,name:e.name,accentColor:u,accentIcon:p},botIds:t}}}return h({...e,getRenderFn:e=>e.block})}function h(e){var t;const{store:n,isInDarkMode:o,canEdit:r,currentUserId:c,showAction:d,getRenderFn:g}=e,h=p(n);if(!h||h.is_placeholder)return;if(void 0===h.external_object_id&&void 0!==h.uri)return;const v=h.original_url||h.uri;if(!n.isDefined())return;const b=f(v,n.getSpaceId()??(null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id));if(!v||!b)return;const y=m(v,n.getSpaceId()),_=y.length>0,S=n.getExternalObjectSubInstanceStores(),w=S.map((e=>e.getFormat())).filter(a.$K);if(w.length!==S.length)return;const{integration:k,pattern:I}=b,{icon:x,dark_icon:C,accent_color:T,accent_icon:M}=k.info,P=o&&C?C:x;if(!P||!T||!M)return;const A=(0,i.U)(I.name),R=(0,s.Tf)({url:v,integration:k}),D=g(A)({integrationIcon:P,root:h,relations:w,parsedAttributes:R});if(!D)return;const B=u.Z.state.updatingUrls.has(v),E=Date.now(),F=Boolean(n.getCreatedById()!==c&&n.getCreatedTime()&&E-n.getCreatedTime()<6e4);let Z;return!B&&r&&c&&(d?Z=d:h.error?Z="error":(null==h||!h.stale)&&h.attributes||F||(Z=_?"update":"authenticate")),{type:"active",renderConfig:D,action:Z,updating:B,originalUrl:v,integration:{id:k.id,icon:P,name:k.name,accentColor:T,accentIcon:M},pattern:I,userHasBotForIntegration:_,botIds:y.map((e=>{let{id:t}=e;return t}))}}function v(e,t){if(!t)return e;const n=f(e,t);return"success"!==(null==n?void 0:n.type)?e:(0,r.l)({url:e,integration:n.integration,pattern:n.pattern})}function b(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing",defaultGroup:"control"})}function y(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing_api",defaultGroup:"control"})}},6398:(e,t,n)=>{n.d(t,{hx:()=>A,lf:()=>P,ox:()=>T,r4:()=>M});n(67294);var o=n(13991),i=n(86628),r=n(24405),a=n(6906),s=n(8848),l=n(84619),c=n(7057),d=n(53877),u=n(42875),p=n(97880),m=n(82990),f=n(44876),g=n(9291),h=n(62896),v=n(51077),b=n(56496),y=n(12981),_=n(81865),S=n(65085),w=n(85567),k=n(33929),I=n(85893);function x(e){window.__c={n:"ExternalObjectInstanceAttributeToken"};const{title:t,color:n,icon:o}=e,i=(0,r.Fg)(),c=n?(0,s.MJ)(`rgb(${n.r},${n.g},${n.b})`):void 0,d=(0,s.KR)(i,c);return(0,I.jsx)(w.Z,{format:l.lo.Medium,value:o?(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(_.Z,{isAuthenticated:!1,url:o,width:32,render:(e,t)=>(0,I.jsx)(y.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})}),(0,I.jsx)(h.Z,{children:(0,a.Z)(t)})]}):(0,I.jsx)(h.Z,{children:(0,a.Z)(t)}),showRemoveButton:!1,color:d.textColor,backgroundColor:d.backgroundColor,isSingle:!0,style:{display:"flex",whiteSpace:"break-spaces",flex:"0 0 auto"}})}function C(e){var t,n,o;window.__c={n:"ExternalObjectInstanceRelation"};const{uri:r,store:a,...s}=e,l=(0,i.VK)((()=>{const e=a.getExternalObjectSubInstanceStores().find((e=>{const t=e.getKeyStore("format").getKeyStore("uri").getValue();return t&&t===r}));if(e)return e.getFormat()}),[a,r]);if(!l)return null;const c=null===(t=l.attributes)||void 0===t?void 0:t.find(f.Id),d=null===(n=l.attributes)||void 0===n?void 0:n.find(f.li),u=null===(o=l.attributes)||void 0===o?void 0:o.find(f.hW);return c?u?(0,I.jsx)(x,{title:c.values[0],color:u.values[0],icon:null==d?void 0:d.values[0]}):c?(0,I.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[d&&(0,I.jsx)(v.Z,{type:"image_url",imageURL:d.values[0],size:16,style:{marginRight:4},imageStyle:s.avatarStyle}),(0,I.jsx)(T,{attribute:c,store:a,...s})]},r):null:null}function T(e){window.__c={n:"ExternalObjectInstanceAttribute"};const{attribute:t,formatter:n,store:o,style:i,avatarStyle:a}=e,s=(0,r.Fg)();if((0,f.Id)(t)){var l;const e=t.values[0];if("enum"===(null===(l=t.format)||void 0===l?void 0:l.type)){const{color:n}=t.format;return(0,I.jsx)(x,{title:e,color:n})}{const t=e.replace(/[\r\n]/g,"").trim(),o=n?k.default.formatMessage(n,{value:t}):t;return(0,I.jsx)("div",{spellCheck:!1,style:{whiteSpace:"nowrap",color:s.mediumTextColor,...i},children:o})}}if((0,f.OM)(t))return(0,I.jsx)(C,{uri:t.values[0],store:o,style:i,avatarStyle:a});if((0,f.Gc)(t))return(0,I.jsx)(M,{attribute:t,formatter:e.formatter,style:e.style,dateStyle:"relative"});if((0,f.An)(t)){const e=t.values[0];return(0,I.jsx)("div",{style:{color:s.mediumTextColor,fontSize:12,...i},children:n?k.default.formatMessage(n,{value:e}):String(e)})}return null}function M(e){window.__c={n:"ExternalObjectInstanceDateAttribute"};const{attribute:t,formatter:n,style:i,dateStyle:a}=e,s=(0,g.useIntl)(),l=(0,r.Fg)(),m=t.values[0];let f;if("datetimerange"===m.type)f=(0,c.ZV)({allowRelativeDates:!1,displayInUserTimezone:!0,intl:s,value:m});else{const e=(0,d.uO)(m,(0,u.r)());a&&"relative"!==a?"exact_time"===a?f=(0,c.Yx)(e,"medium_with_time",o.SP):"exact_date"===a?f=(0,c.Yx)(e,"medium",o.SP):(0,p.t1)(a):f=(0,c.tv)(e,o.SP)}const h=n?k.default.formatMessage(n,{value:f}):f;return(0,I.jsx)("div",{style:{color:l.mediumTextColor,fontSize:12,whiteSpace:"nowrap",...i},children:h})}function P(e){window.__c={n:"ExternalObjectInstanceIconAttribute"};const t=(0,r.Fg)(),{attribute:n,isSmall:o}=e,i=o?22:34,a={...e.style,borderRadius:i,boxShadow:t.avatarBoxShadow};return(0,f.li)(n)?(0,I.jsx)(v.Z,{type:"image_url",imageURL:n.values[0],size:i,imageStyle:a}):(0,f.Id)(n)?(0,I.jsx)("div",{style:{...a,borderRadius:i,overflow:"hidden",boxShadow:t.avatarBoxShadow,height:30,width:30},children:(0,I.jsx)(b.Z,{size:i,title:n.values[0]})}):null}function A(e){window.__c={n:"ExternalObjectInstanceStringBodyAttribute"};const{attribute:t}=e,n=(0,r.yK)((e=>({text:{color:e.regularTextColor,fontSize:12,lineHeight:1.45},buttons:{fontWeight:m.Z.fontWeight.medium}})),[]);return(0,I.jsx)("div",{style:{marginRight:4,marginBottom:4,width:"100%"},children:(0,I.jsx)(S.Z,{moreElement:(0,I.jsxs)(I.Fragment,{children:["â€¦","Â ",(0,I.jsx)("span",{style:{...n.text,...n.buttons},children:(0,I.jsx)(g.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.moreLabel",defaultMessage:"more"})})]}),lessElement:(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("span",{style:{...n.text,...n.buttons},children:(0,I.jsx)(g.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.showLessLabel",defaultMessage:"show less"})})}),maxLines:3,children:(0,I.jsx)("div",{spellCheck:!1,style:n.text,children:t.values[0]})})})}},69988:(e,t,n)=>{n.d(t,{LX:()=>c,Vu:()=>d,XT:()=>p,ZP:()=>m,fe:()=>u,il:()=>l});n(57658);var o=n(72126),i=n(92338),r=n(63143);function a(e){const t=[];let n=!1,o=e;for(;""!==o;){const e=n?i.dK:i.Um,r=o.indexOf(e);if(-1===r)return t.push(s(o,!1)),t;const a=o.substring(0,r),l=o.slice(r+e.length);""!==a&&t.push(s(a,n)),o=l,n=!n}return t}function s(e,t){return t?[e,"highlight"]:[e]}function l(e){return 2===e.length&&"highlight"===e[1]}function c(e){return e[0]}function d(e){return e.reduce(((e,t)=>{if(0===e.length)return[t];const n=e[e.length-1];return l(n)===l(t)?[...e.slice(0,e.length-1),s(c(n)+c(t),l(t))]:[...e,t]}),[])}function u(e){if(!e)return[];let t=a(e);t.some((e=>l(e)&&1===c(e).length))&&(t=d(t));const n=t.filter(l).map(c);return o.jj(n)}function p(e){const{text:t,patterns:n,uniqueTokenHighlighterContext:i}=e,a=o.jj(n.filter((e=>e.length>0)));if(0===a.length)return[s(t,!1)];const l=o.MR(a,(e=>-e.length)).map(o.hr);return function(e,t,n){const o=(0,r.uO)(t,e);if(0===o.length)return[s(e,!1)];let i=0;const a=[];for(let r=0;r<o.length;r++){const t=o[r];if(!t)continue;let l;void 0===n||!n.has(t[0].toLowerCase())?(void 0!==n&&n.add(t[0].toLowerCase()),i!==t.index&&a.push(s(e.slice(i,t.index),!1)),a.push(s(t[0],!0)),l=t.index+t[0].length):l=i;o[r+1]||l===e.length||a.push(s(e.slice(l),!1)),i=l}return a}(t,new RegExp(l.join("|"),"ig"),i)}const m=a},44486:(e,t,n)=>{n.d(t,{W:()=>r});var o=n(41432),i=n(26136);function r(e){return e.findRecordStoreUIAncestor((e=>e instanceof i.G&&e.getType()===o.Ti.factory)).ancestor}},79897:(e,t,n)=>{n.d(t,{A3:()=>c,rf:()=>l});var o=n(67294),i=n(72126),r=n(80444),a=n(81236),s=n(38755);function l(e){const{currentUserRootStore:t}=r.default.state,n=null==t?void 0:t.getSpaceViewStores(),o=i.oA(null==n?void 0:n.map((e=>e.getSpaceId()))).map((t=>a.Z.getPublicSpaceData(e,t))),l=function(e){const t=e.map((e=>(0,s.cD)(e))),n=new Set(i.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("team_free")?"team_free":n.has("student")?"student":n.has("personal")?"personal":n.has("personal_free")?"personal_free":(n.has("free"),"free")}(o);return{userHighestPlanType:l,isSalesAssistedPlan:i.hX(o,{subscriptionTier:l}).some((e=>{if("none"!==(null==e?void 0:e.role)&&!0===(null==e?void 0:e.is_sales_assisted))return!0}))}}function c(){const[e,t]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{function e(e){var n,o;"forethoughtWidgetOpened"===(null==e||null===(n=e.data)||void 0===n?void 0:n.event)?t(!0):"forethoughtWidgetClosed"===(null==e||null===(o=e.data)||void 0===o?void 0:o.event)&&t(!1)}return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}})),e}},19306:(e,t,n)=>{n.d(t,{W:()=>a});var o=n(9291),i=n(33929);const r=(0,o.defineMessages)({twoItems:{id:"formatSettings.twoItems",defaultMessage:"{item1} and {item2}"},threeOrMoreItems:{id:"formatSettings.threeOrMoreItems",defaultMessage:"{item1}, and {numberOfOther} others"},twoItemsWithAmpersand:{id:"formatSettings.twoItems.withAmpersand",defaultMessage:"{item1} & {item2}"},threeOrMoreItemsWithRemoveComma:{id:"formatSettings.threeOrMoreItems.withRemoveComma",defaultMessage:"{item1} and {numberOfOther} others"},threeOrMoreItemsWithAmpersand:{id:"formatSettings.threeOrMoreItems.withAmpersand",defaultMessage:"{item1}, & {numberOfOther} others"},threeOrMoreItemsWithAmpersandAndRemoveComma:{id:"formatSettings.threeOrMoreItems.withAmpersandAndRemoveComma",defaultMessage:"{item1} & {numberOfOther} others"}});function a(e,t){const{removeComma:n,useAmpersand:o}=t||{};if(0===e.length)return"";const a=e[0];if(1===e.length)return a;const s=e[1];if(2===e.length)return o?i.default.formatMessage(r.twoItemsWithAmpersand,{item1:a,item2:s}):i.default.formatMessage(r.twoItems,{item1:a,item2:s});const l=e.length-1;return o?n?i.default.formatMessage(r.threeOrMoreItemsWithAmpersandAndRemoveComma,{item1:a,numberOfOther:l}):i.default.formatMessage(r.threeOrMoreItemsWithAmpersand,{item1:a,numberOfOther:l}):i.default.formatMessage(r.threeOrMoreItems,{item1:a,numberOfOther:l})}},17809:(e,t,n)=>{n.d(t,{Cl:()=>p,NY:()=>f,V1:()=>m});var o=n(67294),i=n(480),r=n(86628),a=n(72126),s=n(4615),l=n(21202),c=(n(70203),n(84398)),d=n(77080),u=n(26136);function p(e){const{initialValue:t,onChange:n,source:d="title",parentCollection:p}=e,m=(0,i.O7)(),f=(0,c.$)("formulaPrototypeHelpers.useMockTextStore",{isMockTextStore:!0,overrideDefaultRecordCache:!0}),g=function(e){const{initialValue:t,inMemoryRecordCache:n,source:r,parentCollection:a}=e,c=(0,i.O7)(),d=(0,o.useMemo)((()=>t),[]);return(0,o.useMemo)((()=>{const e={id:(0,s.ZP)(),table:l.iU};n.setRecord({pointer:e,userId:c.currentUser.id},{value:{alive:!0,id:e.id,parent_id:(null==a?void 0:a.id)??s._6,parent_table:"block",properties:{[r]:d},space_id:(null==a?void 0:a.getSpaceId())??s._6,type:"page",version:0},role:"editor"});const t=new u.ST({environment:c,inMemoryRecordCache:n,path:["properties",r],pointer:e,userId:c.currentUser.id});return n.emitRecord(e,[]),t}),[c,n,d,a,r])}({initialValue:t,inMemoryRecordCache:f,source:d,parentCollection:p}),h=(0,o.useRef)(t),v=(0,o.useCallback)((e=>{const t=m.currentUser.id,n=g.getRecordStoreAtRootPath();if(n instanceof u.G){const o=n.getValue();o&&(f.setRecord({pointer:g.pointer,userId:t},{role:"editor",value:{...o,properties:{...null==o?void 0:o.properties,[d]:e}}}),f.emitRecord(g.pointer,[]))}}),[m.currentUser.id,g,f,d]);return(0,r.VK)((()=>{const e=g.getValue();a.Xy(h.current,e)||(h.current=e,null==n||n(e))}),[g,n]),{store:g,setValue:v}}function m(){return d.default.checkGate("formulas_prototype")}function f(){return d.default.checkGate("formula_buttons")}},35683:(e,t,n)=>{n.d(t,{uP:()=>c,_R:()=>m,vu:()=>l});n(57658);var o=n(30120),i=(n(21703),n(30541),n(7406));const r=class{constructor(e){let{maxSize:t,prefix:n,store:o,version:i}=e;this.prefix=void 0,this.maxSize=void 0,this.store=void 0,this.version=void 0,this.serializedKeys=void 0,this.namespace=void 0,this.lastVersion=void 0,this.createInternalKey=e=>`${this.namespace}${e}`,this.maxSize=t,this.prefix=n,this.store=o,this.version=i.toString(),this.namespace=`${n}:${i}::`,this.serializedKeys=`${n}:${i}:keys`,this.lastVersion=`${n}:version`}set(e,t){try{this.setInternal(e,t),this.promote(e)}catch(n){return{error:(0,i.tg)(n)}}return{value:void 0}}get(e){try{const t=this.getInternal(e);if(null!==t)return{value:t}}catch(t){return{error:(0,i.tg)(t)}}return{value:void 0}}remove(e){try{this.getKeys().indexOf(e)>-1&&(this.removeInternal(e),this.evict(e))}catch(t){return{error:(0,i.tg)(t)}}return{value:void 0}}clear(){try{const e=this.getKeys();for(const t of e)this.removeInternal(t);this.setKeys([])}catch(e){return{error:(0,i.tg)(e)}}return{value:void 0}}scan(e){try{const t=this.getKeys();for(const n of t){const t=this.getInternal(n);if(null===t)throw new Error(`Item not found: ${n}`);e(n,t)}}catch(t){return{error:(0,i.tg)(t)}}return{value:void 0}}entries(){const e=[],t=this.scan(((t,n)=>{e.push([t,n])}));return t.error?{error:t.error}:{value:e}}keys(){try{return{value:this.getKeys()}}catch(e){return{error:(0,i.tg)(e)}}}slowGC(){const e=[],t=e=>e!==this.serializedKeys&&(!!e.endsWith("keys")&&this.isOldKey(e));for(let n=0;n<this.store.length;n+=1){const o=this.store.key(n);null!==o&&((this.isOldKey(o)||t(o))&&e.push(o))}for(const n of e)this.store.removeItem(n)}updateVersionAndGC(){const e=this.store.getItem(this.lastVersion);if(null!==e){const t=parseInt(e,10),n=parseInt(this.version,10),o=!Number.isNaN(t),i=!Number.isNaN(n);o&&i&&t<n&&this.slowGC()}this.store.setItem(this.lastVersion,this.version)}isOldKey(e){if(!e.startsWith(`${this.prefix}:`))return!1;const t=e.substring(`${this.prefix}:`.length),n=parseInt(t,10);if(Number.isNaN(n))return!1;return n<parseInt(this.version,10)}getKeys(){const e=this.store.getItem(this.serializedKeys);if(null===e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}setKeys(e){const t=JSON.stringify(e);this.store.setItem(this.serializedKeys,t)}promote(e){const t=this.getKeys(),n=t.indexOf(e);if(n>-1)t.splice(n,1),t.unshift(e);else if(t.unshift(e),t.length>this.maxSize){const e=t.splice(this.maxSize);for(const t of e)this.removeInternal(t)}this.setKeys(t)}evict(e){const t=this.getKeys(),n=t.indexOf(e);n>-1&&t.splice(n,1),this.setKeys(t)}setInternal(e,t){this.store.setItem(this.createInternalKey(e),JSON.stringify(t))}getInternal(e){const t=this.store.getItem(this.createInternalKey(e));return null===t?null:JSON.parse(t)}removeInternal(e){this.store.removeItem(this.createInternalKey(e))}};var a=n(72126),s=n(97880);let l=function(e){return e.Default="Default",e.Link="Link",e.Favorite="Favorite",e.Search="Search",e}({});const c=3,d={BONUS:{DEFAULT:100,LINK:120,SEARCH:200,FAVORITE:140},BONUS_NORMALIZER:100,TIME_BUCKETS:[{days:4,weight:100},{days:14,weight:70},{days:31,weight:50},{days:90,weight:30}],DEFAULT_BUCKET_WEIGHT:10};function u(e){const{BONUS:t}=d;switch(e){case l.Default:return t.DEFAULT;case l.Link:return t.LINK;case l.Favorite:return t.FAVORITE;case l.Search:return t.SEARCH;default:(0,s.t1)(e)}}function p(e,t){const{TIME_BUCKETS:n,DEFAULT_BUCKET_WEIGHT:i}=d,r=o.ou.fromMillis(e).diff(o.ou.fromMillis(t),"days").get("days");return r<=n[0].days?n[0].weight:r<=n[1].days?n[1].weight:r<=n[2].days?n[2].weight:r<=n[3].days?n[3].weight:i}class m{constructor(e){var t=this;this.maxStoredVisits=void 0,this.visits=void 0,this.recordVisit=e=>{const{id:t,type:n,timestampForTestingOnly:o}=e,i=this.createVisit(n,o),r=this.visits.get(t);if(r.error)return;const s=r.value||this.createVisitCacheEntry();var l,c,d;s.totalVisits+=1,s.recentVisits=(l=s.recentVisits,c=i,d=this.maxStoredVisits,[...(0,a.pm)(l,d-1),c]),this.visits.set(t,s)},this.getVisits=e=>{const t=this.visits.get(e);if(!t.error)return t.value},this.getVisitedIds=()=>{const e=this.visits.keys();return e.error?[]:e.value},this.getFrecencyScore=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();const o=t.getVisits(e);if(!o)return m.UNVISITED_FRECENCY_SCORE;const{totalVisits:i,recentVisits:r}=o;if(0===i||0===r.length)return m.UNVISITED_FRECENCY_SCORE;const s=r.map((e=>{const{type:t,timestamp:o}=e,i=u(t);return p(n,o)*(i/d.BONUS_NORMALIZER)})),l=(0,a.Sm)(s)/s.length,c=Math.ceil(i*l);return c};const{maxBlocks:n,maxStoredVisits:o,store:i,version:s}=e;this.maxStoredVisits=o,this.visits=new r({prefix:e.prefix||"FrecencyStore",maxSize:n,store:i,version:s})}initialize(){this.visits.updateVersionAndGC()}sortFrecencyHighToLow(e){const{items:t,now:n,recordFrecency:o}=e;return(0,a.MR)(t,(e=>{const t="number"==typeof e.score?e.score:1,i=this.getFrecencyScore(e.id,n);o&&(e.frecencyScore=i);const r=e.personalizationBoost??1;return-1*t*Math.max(i,r)}))}createVisitCacheEntry(){return{totalVisits:0,recentVisits:[]}}createVisit(e,t){return{type:e,timestamp:"number"==typeof t?t:Date.now()}}clear(){const e=[];this.visits.scan((t=>e.push(t)));for(const t of e)this.visits.remove(t)}}m.UNVISITED_FRECENCY_SCORE=1},84210:(e,t,n)=>{n.d(t,{Hu:()=>u,ZP:()=>p});var o=n(1800),i=n(15157),r=n(63306),a=(n(64002),n(95477)),s=n(80444),l=n(77556),c=n(88923),d=n(98165);function u(e){e={fullyQualified:!0,...e};const{store:t,collectionViewId:n,showMoveTo:u,saveParent:p,preferPublicLink:m,duplicate:f,getSpaceDomain:g,pageVisitSource:h,queryId:v}=e;let b;if(n)b=n;else if(t&&t.isCollectionView()){const e=i.Z.get({userId:t.environment.currentUser.id,key:l.Z.getLocalViewPreferenceKey(t.id)});if(e)b=e;else{const e=t.getCollectionViewsStore().getValue();e&&(b=e[0])}}const y=t.getParentSpaceStore(),{currentSpaceStore:_}=s.default.state,S=y||_,w=(0,d.fJ)(t),k=(0,r.$t)(w),I=m&&k?(null==S?void 0:S.getPublicContentDomain())||(null==g?void 0:g()):null==S?void 0:S.getEditDomain();let x=a.default.domainBaseUrl;const C=m&&k&&I;if(C){let e="https:";try{e=new URL(a.default.domainBaseUrl||"").protocol||e}catch{}x=`${e}//${I}.${a.default.publicDomainName}`}let T=t,M=e.scrollToBlockId;if(t.isReady()&&!t.isNavigableBlock()){const e=(0,d.Dg)(t);e&&(T=e,M=t.id)}const P=s.default.state.mainEditorCurrentBlockStore;let A,R,D;return P&&e.openInSidePeek?(A=P,R=T.id,D=(0,c.getUrlParamFromPeekMode)(c.PeekModeSide)):(A=T,R=e.peekViewBlockId,D=e.peekMode),(0,o.Z)({pageId:A.id,pageModel:A.getModel(),pageVisitSource:h,queryId:v,scrollToBlockId:M,peekViewBlockId:R,peekMode:D,collectionViewId:b,discussionId:e.discussionId,spaceDomain:C?void 0:I,baseUrl:e.fullyQualified||m?x:void 0,showMoveTo:u,saveParent:p,duplicate:f,templateGalleryItem:e.templateGalleryItem,projectManagementLaunch:e.projectManagementLaunch})}const p=u},87078:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(15723);const i=function(){const e=document.documentElement;return new o.iL(0,0,e.clientWidth,e.clientHeight)}},28415:(e,t,n)=>{n.d(t,{qH:()=>u,vE:()=>c});var o=n(65454),i=n(99405),r=n(57549),a=n(47839),s=n(95477),l=n(77080);async function c(e){const{environment:t,accessToken:n}=e;if(r.D6(t,{from:e.from}),t.device.isElectron){const t=await a.openGoogleDrivePickerPopup({url:(0,i.zN)(s.default.domainBaseUrl,{token:n})});if(!t)return;"integration"in e?e.callback(!1,t.url):e.callback(t.id)}else await(0,o.ZP)("https://apis.google.com/js/api.js"),"integration"in e?window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback,integration:e.integration}))):window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback})))}function d(e){const{environment:t,accessToken:n}=e,o=`${window.location.protocol}//${window.location.host}`;(new window.google.picker.PickerBuilder).enableFeature(window.google.picker.Feature.SUPPORT_DRIVES).setOAuthToken(n).hideTitleBar().setOrigin(o).addView(new window.google.picker.DocsView).setCallback((n=>{if(n.action===window.google.picker.Action.PICKED&&n.docs&&n.docs.length>0){const o=n.docs[0];"integration"in e?e.callback(!1,o.url):e.callback(o.id),r.D6(t,{from:"link_preview_placeholder"})}})).build().setVisible(!0)}function u(){return"on"===l.default.getEligibleGroup({experimentId:"google_external_integration_file_picker",defaultGroup:"control"})}},12534:(e,t,n)=>{n.d(t,{$0:()=>a,Af:()=>o,Wi:()=>s,ZP:()=>l});let o=function(e){return e[e.ButtonMouseDown=0]="ButtonMouseDown",e[e.EditorMouseDown=1]="EditorMouseDown",e[e.EditorMouseUp=2]="EditorMouseUp",e[e.EditorClick=3]="EditorClick",e[e.MenuListClick=4]="MenuListClick",e[e.EditorContextMenu=5]="EditorContextMenu",e[e.EditorMouseOver=6]="EditorMouseOver",e[e.EditorHoverMouseMove=7]="EditorHoverMouseMove",e[e.EditorDropMouseMove=8]="EditorDropMouseMove",e[e.EditorDoubleClick=9]="EditorDoubleClick",e[e.SidebarMouseMove=10]="SidebarMouseMove",e[e.ManageTeamsRowClick=11]="ManageTeamsRowClick",e[e.MobileTap=12]="MobileTap",e[e.CollectionSettingsClick=13]="CollectionSettingsClick",e[e.BaseTableRowClick=14]="BaseTableRowClick",e[e.NotificationClick=15]="NotificationClick",e[e.CollectionAutomationSettingsClick=16]="CollectionAutomationSettingsClick",e}({});const i={};function r(e){const t=i[e.context],n=e.event.nativeEvent||e.event;if(t!==n){var o;i[e.context]=n;"unhandled"===(null===(o=e.callback)||void 0===o?void 0:o.call(e))&&(i[e.context]=t)}}function a(e){r({event:e,context:o.EditorMouseDown,callback:()=>{}})}function s(e){r({event:e,context:o.EditorClick,callback:()=>{}})}const l=r},87290:(e,t,n)=>{n.d(t,{B:()=>l,x:()=>s});var o=n(55367),i=n(22294),r=n(86486),a=n(27724);let s=function(e){return e[e.Default=0]="Default",e[e.Hovered=1]="Hovered",e[e.Selected=2]="Selected",e[e.SelectedDescendant=3]="SelectedDescendant",e}({});function l(e,t){var n;const l=a.default.state.stores,c=r.default.state;if(1===l.length&&l.includes(e))return s.Selected;if(l.length>0&&l.every((t=>e.uiContains(t))))return s.SelectedDescendant;const d=o.ZP.state;return d&&d.isDragging&&d.currentParentStore&&e.uiContains(d.currentParentStore)||d&&d.isDragging&&d.currentDropZone&&d.currentDropZone.type===o.Dl.Selectable&&null!==(n=d.currentDropZone)&&void 0!==n&&n.store&&e.uiContains(d.currentDropZone.store)||c.isOpen&&c.currentStore===e||t&&!i.Z.state.isKeyboardMode?s.Hovered:s.Default}},45023:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(27537),i=n.n(o),r=n(72126);const a=function e(t,n,o){if(Array.isArray(o))return o.some((o=>e(t,n,o)));{const e=o.toLowerCase().split("+");if(t.device.isWindows||t.device.isLinux){if((r.q9(e,"command")||r.q9(e,"ctrl"))!==n.ctrlKey)return!1}else{if(r.q9(e,"command")!==n.metaKey)return!1;if(r.q9(e,"ctrl")!==n.ctrlKey)return!1}return r.q9(e,"shift")===n.shiftKey&&(r.q9(e,"alt")===n.altKey&&r.yW(e,(e=>{if("command"===e||"shift"===e||"ctrl"===e||"alt"===e)return!0;const t="code:";if(e.startsWith(t)&&n.code){const o=e.substr(t.length);return n.code.toLowerCase()===o}return i()(n.keyCode)===e})))}}},92783:(e,t,n)=>{n.d(t,{Z:()=>o});const o=e=>{const{spaceViewStore:t,pageId:n}=e;if(!t||!n)return!1;return-1!==t.getBookmarkedPageIds().indexOf(n)}},28314:(e,t,n)=>{n.d(t,{lF:()=>a,yA:()=>i});var o=n(49085);const i=function(){return r},r={shift:!1,option:!1,control:!1,command:!1},a=o.default.createValue(r),s=function(e){r.shift=Boolean(e.shiftKey),r.option=Boolean(e.altKey),r.control=Boolean(e.ctrlKey),r.command=Boolean(e.metaKey),a.emit()};window.addEventListener("keydown",s),window.addEventListener("keyup",s),window.addEventListener("focus",(function(e){r.shift=!1,r.option=!1,r.control=!1,r.command=!1,a.emit()}))},78429:(e,t,n)=>{n.d(t,{H:()=>r});var o=n(95477),i=n(77080);function r(){return o.default.isAdminMode||"on"===i.default.getEligibleGroup({experimentId:"highlight_legacy_transclusions",defaultGroup:"control"})}},48709:(e,t,n)=>{n.d(t,{FV:()=>c,Fs:()=>m,Ts:()=>f,ZG:()=>p,cX:()=>d,dY:()=>h,hy:()=>u,uP:()=>g});var o=n(99405),i=n(70203),r=n(64002),a=n(95477),s=n(23178);function l(e,t){const n=s.Z.state;n.open&&n.focusLinkInput!==e&&s.Z.setState({...n,focusLinkInput:e,url:t?"":n.url})}function c(){l(!0),p(!1)}function d(){l(!1)}function u(){l(!1,!0)}function p(e){const t=s.Z.state;t.open&&t.focusTitleInput!==e&&s.Z.setState({...t,focusTitleInput:e})}function m(e){const{editingToken:t}=e;if(!t)return;const n=i.hDy(t),o=i.rlz(n);return o?i.zW$(o):void 0}function f(e){if(!e)return;const t=i.hDy(e);return i.rlz(t)?i.WiV(e):void 0}function g(e){return e.url||""}function h(e){const t=i.rOz(e);if(t&&"url"===t.type){const e=(0,o.Wj)({url:t.href,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,isMobile:!1,protocol:void 0,currentUrl:void 0});return"page"===e.name?{type:"notion",url:t.href,notionPage:e}:{type:"web",url:t.href}}const n=(0,r.yn)(e);if(n)return{type:"other",url:n}}},27383:(e,t,n)=>{n.d(t,{y:()=>i});function o(e){return e.teamId?`${e.collectionViewId}-${e.teamId}`:e.collectionViewId}const i=new class{constructor(){this.cache=new Map,this._locallyMutatedTasksDatabase=!1}get locallyMutatedTasksDatabase(){return this._locallyMutatedTasksDatabase}set locallyMutatedTasksDatabase(e){this._locallyMutatedTasksDatabase=e}get(e){const t=o(e);return this.cache.get(t)}set(e,t){const n=o(e);for(this.cache.delete(n),this.cache.set(n,t);this.cache.size>25;){const e=this.cache.keys().next().value;this.cache.delete(e)}}}},28125:(e,t,n)=>{n.d(t,{S:()=>s,k:()=>a});var o=n(13991),i=n(77080),r=n(12955);function a(e){const{mobileNative:t}=e;if(t){const n=Boolean(t.sqliteConnection),o=r.canSetCookie(e);return n&&o}return!0}function s(e){return"en-US"===o.SP&&(e.device.isElectron&&i.default.checkGate("desktop_app_signup_hide_passcode")||e.device.isMobileNative&&e.device.isIOS&&i.default.checkGate("ios_app_signup_hide_passcode"))}},87279:(e,t,n)=>{n.d(t,{Xp:()=>s,mw:()=>l,og:()=>i,qW:()=>c});var o=n(67381);let i=function(e){return e[e.Modal=0]="Modal",e[e.ActionSheet=1]="ActionSheet",e[e.Popup=2]="Popup",e}({});const r="menu",a=(0,o.Q)({modernContextDefaultValue:{menuType:void 0},displayName:r,legacyContextKey:r}),s=a.context,l=a.legacyPropTypes,c=a.Provider},85818:(e,t,n)=>{n.d(t,{$6:()=>a,Ds:()=>i,_K:()=>r,tM:()=>s});var o=n(72126);function i(e,t){let n=0;for(let o=0;o<t.length;o+=1){const i=t[o];if(e>n+i.items.length-1){n+=i.items.length;continue}const r=e-n,a=i.items[r];if(!a)return;return{item:a,index:{section:o,indexLocal:r}}}}function r(e,t){const n=t[e.section];if(!n)return;const o=n.items[e.indexLocal];return o||void 0}function a(e,t){return o.Sm(t.slice(0,e.section).map((e=>e.items.length)))+e.indexLocal}function s(e){return e.reduce(((e,t)=>e+t.items.length),0)}},98742:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(72126),i=n(77744);function r(e,t){const n={...e};return Object.keys(t).forEach((r=>{const a=t[r],s=e[r];s&&r.startsWith("on")&&o.mf(a)?n[r]=function(){s(...arguments),a(...arguments)}:s&&("ref"===r||r.endsWith("Ref"))&&a?n[r]=(0,i.lq)(s,a):s||(n[r]=a||s)})),n}},64496:(e,t,n)=>{n.d(t,{_3:()=>a,fP:()=>r,qE:()=>i});var o=n(5162);function i(){return window.__mobileExperimentCache}function r(e,t,n){if(n)return t&&n.userExperiments?n.userExperiments[t]:{experimentsBySpace:{},experimentsWithoutSpace:n.deviceExperiments,isLoaded:!0,userId:void 0,deviceId:e,test:!1}}function a(e){return(0,o.Y)("supportsMobileExperimentCache")}},52533:(e,t,n)=>{n.d(t,{S$:()=>a,Y2:()=>r,nd:()=>i});n(97880);var o=n(11342);n(95477);let i=function(e){return e[e.Bottom=0]="Bottom",e[e.Floating=1]="Floating",e}({});function r(e){const{environment:t}=e;return!t.device.isIOS&&!t.device.isAndroid}function a(e){const{environment:t}=e;if(!t.device.isIOS)return!1;if(!t.mobileNative||!t.mobileNative.api.openUpgradeModal)return!1;{if(!t.device.mobileAppVersion)return!1;const e=o.parseVersion(t.device.mobileAppVersion),n=o.parseVersion("0.4.165");if(!e||!n)return!1;return!o.isLessThanVersion(e,n)}}},39500:(e,t,n)=>{n.d(t,{N9:()=>r,Nf:()=>a,Vc:()=>i,X9:()=>s,uG:()=>l});var o=n(30583);const i={mouse:6,finger:0,stylus:6};function r(e){return 3===e.button||4===e.button}function a(e){return e&&"stylus"===e.touchType?"stylus":"finger"}const s=function(){return o.IL.moved};function l(e){return!!e.isTrusted&&s()}},75770:(e,t,n)=>{n.d(t,{lQ:()=>E,hD:()=>B,cJ:()=>Z,HE:()=>R,uw:()=>F,EC:()=>M,ah:()=>P,vz:()=>D,ru:()=>V,ed:()=>j});n(21703),n(67294);var o=n(53877),i=n(69246),r=n(21202),a=n(6287),s=n(15047),l=n(29369),c=n(97880),d=n(9291),u=n(47307),p=n(74523),m=n(80444),f=n(55367),g=n(26136),h=n(99757),v=n(33929),b=n(35026),y=n(98165),_=n(67669),S=n(18514),w=n(38755),k=n(85644),I=n(82990),x=n(85893);async function C(){return u.confirmUserAction({message:(0,x.jsx)("span",{children:(0,x.jsx)(d.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <boldtext>Only you will be able to access it.</boldtext>",id:"confirmDialog.movePageToPrivate.message",values:{boldtext:e=>(0,x.jsx)("span",{style:{fontWeight:I.Z.fontWeight.semibold},children:e})}})}),acceptLabel:(0,x.jsx)(d.FormattedMessage,{defaultMessage:"Move to private",id:"confirmDialog.movePageToPrivate.confirmButton.label"})})}const T=(0,d.defineMessages)({privateDestinationName:{id:"moveToHelpers.destinationName.private",defaultMessage:"Private"},numPagesDescriptorString:{id:"moveToHelpers.movePageDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}}"},numPagesWithSubitemsDescriptorString:{id:"moveToHelpers.movePagesWithSubitemsDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}} and {numSubitemsMoved, plural, one {# sub-item} other {# sub-items}}"},numBlocksDescriptorString:{id:"moveToHelpers.moveBlocksDescriptorString",defaultMessage:"{numBlocksMoved, plural, one {# block} other {# blocks}}"},bookmarksDestinationName:{id:"moveToHelpers.destinationName.favorites",defaultMessage:"Favorites"},movedMessagesWithDestinationToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessageWithDestination",defaultMessage:"Moved {pageDescriptor} to {destinationName}"},movedToDestinationShortToast:{id:"moveToHelpers.afterMoveCompleteOnMobileToastMessageWithDestination",defaultMessage:"Moved to {destinationName}"},movedMessagesToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessage",defaultMessage:"Moved {pageDescriptor}"}});function M(e){const{movedItems:t,numSubitems:n}=e;if(!(t.filter((e=>e.isNavigableBlock())).length===t.length))return v.default.formatMessage(T.numBlocksDescriptorString,{numBlocksMoved:t.length});if(1===t.length){const e=A(t[0]);if(e)return e}return n?v.default.formatMessage(T.numPagesWithSubitemsDescriptorString,{numPagesMoved:t.length-n,numSubitemsMoved:n}):v.default.formatMessage(T.numPagesDescriptorString,{numPagesMoved:t.length})}const P=e=>{const{environment:t,movedItems:n,moveToLocation:o,numSubitems:i}=e,r=M({movedItems:n,numSubitems:i}),a=function(e){const{environment:t,moveToLocation:n}=e,{currentSpaceStore:o}=m.default.getState();if(void 0===n||void 0===o)return;switch(n.type){case"moveToBlock":return A(n.blockStore);case"moveToCollection":return A(n.collectionStore);case"moveToCurrentWorkspace":return(0,w.rn)(t,o);case"moveToPrivatePages":return v.default.formatMessage(T.privateDestinationName);case"moveToTeam":return A(n.teamStore);case"moveToOtherWorkspace":return(0,w.rn)(t,n.spaceStore);case"moveToBookmarks":case"moveToShared":return;default:(0,c.t1)(n)}}({environment:t,moveToLocation:o});return a?t.device.isPhone?v.default.formatMessage(T.movedToDestinationShortToast,{destinationName:a}):v.default.formatMessage(T.movedMessagesWithDestinationToast,{pageDescriptor:r,destinationName:a}):v.default.formatMessage(T.movedMessagesToast,{pageDescriptor:r})};const A=e=>{var t;const n=v.default.getIntl();if(e)return null===(t=e.getModel())||void 0===t?void 0:t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:o.x7,intl:n})},R=(e,t)=>{const{currentSpaceStore:n}=m.default.getState(),o=("space"===e.type?e.id:e.spaceId)??(null==n?void 0:n.id);if(void 0===n||void 0===o)return;const i=(e=>{var t;const{currentUserRootStore:n,currentSpaceStore:o}=m.default.state;return(null==o?void 0:o.id)===e?o:null==n||null===(t=n.getSpaceViewStores())||void 0===t||null===(t=t.find((t=>{var n;return(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id)===e})))||void 0===t?void 0:t.getSpaceStore()})(o);if(i){if(i.id!==n.id)return{type:"moveToOtherWorkspace",spaceStore:i,targetParentId:"space-private-pages"!==e.type?e.id:i.id};switch(e.type){case"page":{const t=m.default.state.mainEditorCurrentBlockStore;if(!t)return;return{type:"moveToBlock",blockStore:g.G.createChildStore(t,{table:r.iU,id:e.id})}}case"collection":return{type:"moveToCollection",collectionStore:g.NW.createChildStore(i,{table:a.v,id:e.id})};case"space":return{type:"moveToCurrentWorkspace"};case"space-private-pages":return{type:"moveToPrivatePages"};case"team":return{type:"moveToTeam",teamStore:g.zX.createChildStore(i,{table:l.e0,id:e.id})};default:(0,c.t1)(e)}}},D=e=>{const{droppedDirection:t,targetStore:n,outlinerSectionType:o}=e,{currentSpaceStore:r}=m.default.getState();if(!r||!o)return;let a=n;if("block"===(null==n?void 0:n.table)&&t!==f.vh.Onto){if("bookmarks"===o)return{type:"moveToBookmarks"};if("shared"===o)return{type:"moveToShared"};a=null==n?void 0:n.getParentStore()}if(void 0===a)return;if(r.id===a.id)return(e=>{switch(e){case"workspace":return{type:"moveToCurrentWorkspace"};case"bookmarks":return{type:"moveToBookmarks"};case"private":return{type:"moveToPrivatePages"};case"shared":return{type:"moveToShared"};case"team":case i.kg:case i.PT:case i.cz:case i.mu:case i.g$:return;default:(0,c.t1)(e)}})(o);switch(a.table){case"block":return{type:"moveToBlock",blockStore:a};case"team":return{type:"moveToTeam",teamStore:a}}};function B(e){let{environment:t,blocks:n}=e;if(h.n.state)return{canMoveBlocks:!1,reason:{key:"unknown"}};for(const o of n){if(o.getParentTable()===l.e0){const e=(0,y.VP)(o);if(!e||!(0,b.si)({teamStore:e,environment:t}))return{canMoveBlocks:!1,reason:{key:"lockedTopLevelTeamPage"}}}if(!o.canAdmin())return{canMoveBlocks:!1,reason:{key:"needsFullAccess"}};if(!_.KE({environment:t,block:o})){const e=o.getParentStore();return{canMoveBlocks:!1,reason:{key:"needsEditAccessOnParent",parentStore:e instanceof g.G?e:void 0}}}}return{canMoveBlocks:!0}}function E(e){let{environment:t,blocks:n}=e;return B({environment:t,blocks:n}).canMoveBlocks}function F(e){const{type:t}=e,{mainEditorCurrentBlockStore:n,currentSpaceStore:o}=m.default.state;if(!o)throw new Error("currentSpaceStore not found");const i=n||o;if("space"!==t&&e.spaceId&&e.spaceId!==o.id)return g.H2.createChildStore(i,{table:s.bx,id:e.spaceId});switch(t){case"space-private-pages":return g.H2.createChildStore(i,{table:s.bx,id:o.id});case"space":return g.H2.createChildStore(i,{table:s.bx,id:e.id});case"page":return g.G.createChildStore(i,{table:r.iU,id:e.id});case"collection":return g.NW.createChildStore(i,{table:a.v,id:e.id});case"team":return g.zX.createChildStore(o,{table:l.e0,id:e.id,spaceId:o.id});default:(0,c.t1)(t)}}async function Z(){return await u.confirmUserAction({message:(0,x.jsx)("b",{children:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmTitle",defaultMessage:"Some content and settings may be broken on the duplicated page."})}),description:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{marginBottom:8},children:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription1",defaultMessage:"This may include: links, relations, permissions, page history, and more."})}),(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription2",defaultMessage:"This page will remain unchanged in the current workspace, and a duplicate version will be created in the workspace you have chosen."}),(0,x.jsx)(p.Z,{title:(0,x.jsx)("div",{children:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmHelpLink",defaultMessage:"Learn more"})}),href:(0,S.UY)("guides.duplicateToSpace"),analyticsFrom:"move_to_confirm_duplicate_to_space",style:{marginTop:12}})]}),acceptLabel:(0,x.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmAcceptLabel",defaultMessage:"I understand, duplicate"})})}function V(e){let{targets:t,destination:n,direction:o,draggingOutlinerType:i}=e;if(o===f.vh.Onto&&t.some((e=>e.id===n.id)))return!0;const r=void 0!==(0,y._A)(n);return!(!t.some((e=>(0,k.A)(e)))||!r)||!("bookmarks"===i||!function(e){let{targets:t,destination:n,direction:o}=e;if(!t.some((e=>e.isCollectionView())))return!1;if(n.isCollectionView()&&!(0,k.A)(n)){if(o===f.vh.Onto)return!0;if(!n.getRecordStoreUIParent())return!0}const i=n.getAssociatedCollectionStore();if(o!==f.vh.Onto&&i&&!i.isPageTreeCollection())return!0;return!1}({targets:t,destination:n,direction:o}))}async function j(e){const t=function(e){const{from:t,environment:n}=e;if("moveTo"===t){const{moveToValue:t}=e.moveToArgs;return R(t,n)}if("dragAndDrop"===t){const{destination:t,direction:o,destinationOutlinerType:i}=e.dropArgs;return D({targetStore:t,droppedDirection:o,outlinerSectionType:i,environment:n})}}(e),n=await async function(e){const{blocks:t,environment:n,moveToLocation:o,from:i}=e;if(!o||"moveToOtherWorkspace"===o.type||"moveToBookmarks"===o.type)return{confirmed:!0,shouldClearPagePermissions:!1};const r="moveToPrivatePages"===o.type,a="moveTo"===i?e.moveToArgs.destination:e.dropArgs.destination,s=a&&U({stores:[a],environment:n});if(!r&&!s)return{confirmed:!0,shouldClearPagePermissions:!1};if(!U({stores:t,environment:n})){return await C()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}if(!r)return{confirmed:!0,shouldClearPagePermissions:!1};const l=n.currentUser.id;if(t.some((e=>{const t=e.getPermissionItems();return 0!==t.length&&(1!==t.length||"user_permission"!==t[0].type||t[0].user_id!==l)}))){return await C()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}return{confirmed:!0,shouldClearPagePermissions:!1}}({...e,moveToLocation:t});if(!n.confirmed)return{confirmed:!1};const{shouldClearPagePermissions:o}=n;return{confirmed:!0,shouldClearPagePermissions:o}}function U(e){const{stores:t,environment:n}=e,{currentSpaceStore:o}=m.default.state;if(!o)return!1;for(const i of t){const e=(0,y.u3)(i);if(!((null==e?void 0:e.table)===r.iU&&e.isTopLevelPrivatePage({spaceStore:o,environment:n})))return!1}return!0}},44499:(e,t,n)=>{n.d(t,{Hn:()=>f,XQ:()=>p,Xk:()=>u,qB:()=>m});n(57658);var o=n(92996),i=n(41432),r=n(21202),a=n(6287),s=n(55367),l=n(42330),c=n(26136),d=n(75770);function u(e,t){return!(!e.isNavigableBlock()&&e.getType()!==i.Ti.alias)&&(!e.isLinkedCollectionView()&&(!e.getMovedStore().getValue()&&!(0,d.ru)({targets:t,destination:e,direction:s.vh.Onto})))}function p(e){let{recentPageResults:t,blockResults:n,suggestedPages:o}=e;const i=new Set;for(const r of o){const e=r instanceof c.NW?r.getParentId():r.id;e&&i.add(e)}return[...t.filter((e=>!i.has(e.blockId))),...n.filter((e=>!i.has(e.blockId)))]}function m(e){const t=[];for(const o of e){const e=o.getParentPointer();if(e)if(e.table===r.iU)t.push(e.id);else if(e.table===a.v){var n;const e=null===(n=o.getAssociatedCollectionStore())||void 0===n?void 0:n.getParentPointer();e&&e.table===r.iU&&t.push(e.id)}}return t}function f(){const e=l.ZP.getTargetsDatabaseType(),t=l.ZP.getVariant();return("typedInitialized"===t||"typedUninitialized"===t)&&e&&e!==o.GZ}},68056:(e,t,n)=>{n.d(t,{NV:()=>u,QY:()=>m,TD:()=>f,_v:()=>a,e6:()=>p,iG:()=>c,k_:()=>s,ko:()=>d,qS:()=>l,yt:()=>h});var o=n(97880),i=n(89086);function r(e,t){return e.store===t.store&&e.index===t.index}function a(e,t){return!e&&!t||!(!e||!t)&&(r(e.start,t.start)&&r(e.end,t.end))}function s(e){return{start:{...e.start},end:{...e.end}}}function l(e){return!e||e.start.store===e.end.store}function c(e){return l(e)&&e.start.index===e.end.index}function d(e){return 0===e.start.index&&c(e)}function u(e){return c(e)&&(0,i.J_)(e.start.store,{startIndex:e.start.index,endIndex:e.end.index})}function p(e,t){const n=[e.start.store,e.end.store];return n.includes(t.start.store)||n.includes(t.end.store)}function m(e){if(e)return l(e)?{store:e.start.store,selection:{startIndex:e.start.index,endIndex:e.end.index}}:void 0}function f(e){const{store:t,selection:n}=e;if(t&&n)return{start:{store:t,index:n.startIndex},end:{store:t,index:n.endIndex}}}const g=(0,o.AO)((e=>e&&"object"==typeof e&&"store"in e&&"index"in e?{true:e}:{false:e})),h=(0,o.AO)((e=>{if("object"==typeof e&&e&&"start"in e&&"end"in e){const{start:t,end:n}=e;if(g(t)&&g(n))return{true:e}}return{false:e}}))},45162:(e,t,n)=>{n.d(t,{$r:()=>B,Aw:()=>F,L5:()=>w,Nj:()=>P,W9:()=>T,Zb:()=>I,fx:()=>R,r:()=>S,ri:()=>Z,tp:()=>M,uZ:()=>E,xI:()=>y});n(21703);var o=n(55010),i=n(45060),r=n(41432),a=n(92595),s=n(68626),l=n(73597),c=n(70842),d=n(28685),u=n(26842),p=n(14976),m=n(46150),f=n(68056),g=n(69645),h=n(73959),v=n(89224),b=n(89086);function y(e,t){const n=(0,f.QY)(t);return n||s.rateLimitedLog({from:"multiTextSelectionHelpers",type:"TODO",level:"warning",data:{name:e,message:e}}),n}const _={startIndex:0,endIndex:1/0};function S(e,t){const{start:n,end:i}=e;if((0,f.qS)(e))return n.store===t?"contained-within":void 0;if(n.store===t)return"starts-at";if(i.store===t)return"ends-at";const r=d.E.findNodeFromStore(n.store),a=d.E.findNodeFromStore(i.store),s=d.E.findNodeFromStore(t);return r&&a&&s&&1===(0,o.Z)(s,r)&&-1===(0,o.Z)(s,a)?"covers":void 0}function w(e){const{start:t,end:n}=e,o=(0,f.QY)(e);if(o){const e=d.E.findEditableWithStore(o.store);if(e){return[{editable:e,...o}]}return[]}const i=k(t),r=k(n);if(!i||!r){const e=i||r;if(!e)return[];return[{editable:e.editable,store:e.position.store,selection:{startIndex:e.position.index,endIndex:e.position.index}}]}const a=(0,b.yR)(i.editable).filter((e=>{var t,n,o;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===(null===(n=i.editable.contentEditableContext)||void 0===n?void 0:n.id)&&(null===(o=e.getNode())||void 0===o?void 0:o.isConnected)})),s=a.findIndex((e=>e.props.store.id===i.editable.props.store.id)),l=a.findIndex((e=>e.props.store.id===r.editable.props.store.id));if(-1===s){throw Object.assign(new Error("Start editable not found in DOM order array"),i)}if(-1===l){throw Object.assign(new Error("End editable not found in DOM order array"),r)}if(!(s<=l))throw new Error(`Start (index ${s}) must be before end (index ${l}) in DOM`);const c=a.slice(s,l+1);return c.map(((e,t)=>{if(0===t){const{position:t}=i;return{editable:e,store:e.props.store,selection:{startIndex:t.index,endIndex:1/0}}}if(t===c.length-1){const{position:t}=r;return{editable:e,store:e.props.store,selection:{startIndex:0,endIndex:t.index}}}return{editable:e,store:e.props.store,selection:_}}))}function k(e){const t=d.E.findEditableWithStore(e.store);if(t)return{editable:t,position:e}}function I(e){var t;const{range:n,contentEditableLeafRegistry:o,allowInvisibleEndSelection:i,constraintToContentEditableRootNode:r}=e;if(!n)return;if(r&&r!==(0,m.xp)(n.commonAncestorContainer))return;let a,s=!1,l=o.getParentContentEditableLeaf(n.startContainer);l||(a??=o.getByDOMOrder(),l=(0,v.snapContainerOffsetToNode)({nodesInDomOrder:a,containerOffset:{container:n.startContainer,offset:n.startOffset},snapTowards:"end"}),s=!0,n.startContainer,n.startOffset);let c=o.getParentContentEditableLeaf(n.endContainer);if(!c||!i&&c&&0===n.endOffset&&n.endContainer===c.node&&c.node!==(null===(t=l)||void 0===t?void 0:t.node)){a??=o.getByDOMOrder();const e=a.findIndex((e=>{var t;let{node:n}=e;return n===(null===(t=l)||void 0===t?void 0:t.node)})),t=-1!==e?a.slice(e):a,r=c&&!i?t.filter((e=>{var t;let{node:n}=e;return n!==(null===(t=c)||void 0===t?void 0:t.node)})):t;c=(0,v.snapContainerOffsetToNode)({nodesInDomOrder:r,containerOffset:{container:n.endContainer,offset:n.endOffset},snapTowards:"start"}),s=!0,n.endContainer,n.endOffset}if(!l||!c){const e=l??c;if(!e)return;return{start:e,end:e,forceEmit:!0}}return{start:l,end:c,forceEmit:s}}function x(e){const t=e.getTitleStore();if(t){if(d.E.findNodeFromStore(t))return t}}function C(e){for(const t of e){const e=x(t);if(e)return{blockStore:t,titleStore:e}}}function T(e){const t=C(e);if(!t)return;const n=function(e){return C([...e].reverse())}(e);if(!n)return;const o=(0,g.dq)({includeNonSelectableListContainer:!1,root:t.blockStore.getHighestContentBlockUIAncestor()});if(!o)return;const i=(0,g.Ib)(n.blockStore,o);if(!i)return;let r;for(const a of(0,l.JK)(i)){const e=a.value.store.getTitleStore();if(e){const t=(0,b.x0)(e);t&&(r={store:e,index:t.endIndex})}}if(!r)return;return{start:{store:t.titleStore,index:0},end:r}}function M(e){var t;const{multiSelection:n,filterCommonAncestors:o,focus:i}=e;if((0,f.qS)(n)){var a;let e=(0,h.sQ)(n.start.store);if((null===(a=e)||void 0===a?void 0:a.getType())===r.Ti.tableRow){var s;const t=null===(s=e.getRecordStoreUIParent())||void 0===s?void 0:s.recordStoreUIParentStore;t&&t instanceof u.G&&(e=t)}if(!e)return;return{stores:[e]}}const c=P({multiSelection:n,includeNonSelectable:!1});if(!c)return;const d=o?(0,l.tL)(c.treeRange):(0,l.bu)(c.treeRange),p=Array.from(d),m=p[0],g=null==m||null===(t=m.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id,b=p.filter((e=>{var t;return(null===(t=e.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id)===g||e.value.store.getType()===r.Ti.table})).map((e=>e.value.store));return{stores:b,pivot:"end"===i||i===n.end||void 0===i&&!(0,v.selectionIsBackwards)()?b[b.length-1]:b[0]}}function P(e){const{multiSelection:t,includeNonSelectable:n}=e,o=(0,h.sQ)(t.start.store),i=(0,h.sQ)(t.end.store);if(!o||!i)return;const r=o.getHighestContentBlockUIAncestor(),a=(0,g.dq)({includeNonSelectableListContainer:n,root:r});if(!a)return;const s=(0,g.v5)(o,[a]),l=(0,g.v5)(i,[a]);if(!s||!l)return;const d=c.T.fromNearestCommonAncestor(s,l);return d?{tree:a,treeRange:d}:void 0}function A(e){const{leafNode:t,rangeContainer:n,defaultEndIndex:i}=e,r=(0,o.Z)(t,n);let a=0;if(-1===r)a=i;else{if(1!==r)throw new Error("Invalid relativeStartPosition. index should not be inside leaf");a=0}return{index:a,forceEmit:!0,afterEndOfLine:!1}}function R(e){var t,n,o,i;const{range:r,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s}=e;if(!r)return;let l,c,u=!1;if(a&&a.hasMembers()){const e=I({range:r,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s,constraintToContentEditableRootNode:void 0});e&&(l=e.start.node,c=e.end.node,u||=e.forceEmit)}else l=(0,m.X1)(r.startContainer),c=(0,m.X1)(r.endContainer);const f=l?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===l})):void 0,g=c?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===c})):void 0;if(!f||!g)return;const h=!r.collapsed,v=f.props.store;let y=g.props.store;const{startContainer:_,endContainer:S}=r,w=(null===(t=(n=g.props).getEndSelection)||void 0===t?void 0:t.call(n).endIndex)??0,k=(null===(o=l)||void 0===o?void 0:o.contains(r.startContainer))&&(0,p.Qb)(r.startContainer,r.startOffset)||A({leafNode:l,rangeContainer:_,defaultEndIndex:w});let x=(null===(i=c)||void 0===i?void 0:i.contains(r.endContainer))&&(0,p.Qb)(r.endContainer,r.endOffset)||A({leafNode:c,rangeContainer:S,defaultEndIndex:w});if(h&&x.afterEndOfLine){const e=(0,b.hn)(y);e&&(r.endContainer,r.endOffset,y=e,x={index:0,forceEmit:!0,afterEndOfLine:!1})}return{multiSelection:{start:{store:v,index:k.index},end:{store:y,index:x.index}},forceEmit:u||k.forceEmit||x.forceEmit}}function D(e,t){if(!e&&!t)return 0;if(!t)return-1;if(!e)return 1;if(e.store===t.store)return e.index-t.index;const n=d.E.findNodeFromStore(e.store),i=d.E.findNodeFromStore(t.store);return(0,o.Z)(n,i)}function B(e,t){const[n,o]=[e,t].sort(D);return{start:n,end:o}}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,v.selectionIsBackwards)();return t?{focus:e.start,anchor:e.end}:{focus:e.end,anchor:e.start}}function F(e){return e.device.isAndroid?"gesture":e.device.isAndroid||e.device.isIOS||e.device.isElectron||e.device.isSafari||e.device.isChrome?"always":void 0}function Z(e){return e.isChrome&&96===parseInt(e.browserVersion,10)}(0,a.exposeDebugValue)("multiTextSelectionToBlockSelection",M),(0,i.Rw)({canFormat:e=>(0,f.yt)(e),header(e){const{table:t,tr:n,td:o,object:r,CONTAINER_STYLE:a}=i.TI,s=d.E.findNodeFromStore(e.start.store),l=d.E.findNodeFromStore(e.end.store);return t(a,n({},o({},"start:"),o({},r(e.start.index)," in"),o({},r(e.start.store)),o({},r(s))),n({},o({},"end:"),o({},r(e.end.index)," in"),o({},r(e.end.store)),o({},r(l))))},hasBody:e=>!1,body:e=>null})},99445:(e,t,n)=>{n.d(t,{UF:()=>l,bW:()=>s,yk:()=>r,yt:()=>i});var o=n(15095);function i(e){let t=0,n=0,o="";for(;e>0;)t=(e-1)/26,n=(e-1)%26,e=Math.floor(t),o=String.fromCharCode(97+n)+o;return o}function r(e){let t=0,n=0;const o=e.split("").reverse();for(const i of o){t+=(i.charCodeAt(0)-96)*26**n,n+=1}return t}const a={"mÌ„":1e6,"dÌ„":5e5,"cÌ„":1e5,"lÌ„":5e4,"xÌ„":1e4,"vÌ„":5e3,m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};function s(e){let t="";for(const n in a){const o=Math.floor(e/a[n]);if(o>=0)for(let e=0;e<o;e++)t+=n;e%=a[n]}return t}function l(e){const t=o.p4(e);let n,i,r,s,l=0;for(let o=0;o<t.length;o++){if(n=t[o],i=n?a[n]:void 0,r=t[o+1],s=r?a[r]:void 0,!i)return-1;s&&i<s?l-=i:l+=i}return l}},45950:(e,t,n)=>{n.d(t,{Dx:()=>p,Ye:()=>u,ne:()=>m,yY:()=>d});n(21703),n(57658);var o=n(72126),i=n(59753),r=n(45953),a=n(33361),s=n(21202),l=n(18245),c=n(77080);async function d(e){const{environment:t,recordPointers:n,recurFn:o,recordIsRequired:s}=e,l=r.PF.create();return await a.uf({recordPointers:n,recordMap:l,recurFn:(e,t)=>o(e,t),loadRecordModel:async e=>{const n=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e,userId:t.currentUser.id});if(n)return n;const o=t.defaultRecordCache.persistedRecordCache;if(o){const n=await o.get(e,t.currentUser.id);if(n)return{model:i.kk.fromValue(e.table,n.value),role:n.role}}if(s(e))throw new Error(`Failed to load a required record: ${e.table}, ${e.id}, ${e.spaceId}.`)}}),l}async function u(e){const{environment:t}=e,n=e.environment.currentUser.id;if(e.inMemoryRecordCache)return e.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});let o=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});if(void 0!==o)return o;if(e.useInMemoryCacheOnly)return;if(e.prefetchPromise&&"pending"===e.prefetchPromise.state.status&&(await e.prefetchPromise.wrappedPromise,o=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n}),void 0!==o))return o;const{persistedRecordCache:r}=e.environment.defaultRecordCache;if(r){const t=await r.get(e.pointer,n);if(t)return{model:i.kk.fromValue(e.pointer.table,t.value),role:t.role}}}async function p(e){const{parent:t,inMemoryRecordCache:n,environment:o}=e,r=[],a=e.environment.currentUser.id,l=e.environment.defaultRecordCache.persistedRecordCache;if(l&&n===o.defaultRecordCache.inMemoryRecordCache){return(await l.getBlocksWithParent({parent:t,userId:a})).map((e=>({model:i.kk.fromValue(s.iU,e.value),role:e.role})))}return n.forEachRecord(a,(e=>{let{model:n,role:o}=e;n.table===s.iU&&n.parent_table===t.table&&n.parent_id===t.id&&r.push({model:n,role:o})})),r}async function m(e){const{environment:t,inMemoryRecordCache:n}=e,r=i.kk.fromCollection(e.collection);if(!r)return[];const a=r.pointer;if(!r.isPageTreeCollection()){const e=l.default.mark("collections.get_local_pages_in_collection"),o=p({environment:t,parent:a,inMemoryRecordCache:n});return l.default.measure(e,{environment:t}),o}const u=r.getRootPagePointer(),m=c.default.checkGate("wiki_perf_improvement_local_enabled"),f=l.default.mark("collections.get_local_pages_in_collection_wiki"),g=m?await async function(e){const{rootPagePointer:t,environment:n}=e,o=[],i=(e,n)=>e.table!==s.iU?[]:(e.pointer.id===t.id||"page"!==e.type&&"collection_view_page"!==e.type||o.push({model:e,role:n}),e.getContentIds().map((t=>({table:s.iU,id:t,spaceId:e.spaceId}))));return await d({environment:n,recordPointers:[t],recurFn:i,recordIsRequired:()=>!1}),o}({environment:t,rootPagePointer:u}):await async function(e){const{rootPagePointer:t,environment:n,inMemoryRecordCache:i}=e;let r=[t];const a=[];for(;r.length>0;){const e=r.map((e=>p({environment:n,parent:e,inMemoryRecordCache:i}))),t=(await Promise.all(e)).flat();for(const n of t){var s;const e=null==n||null===(s=n.model)||void 0===s?void 0:s.type;"page"!==e&&"collection_view_page"!==e||a.push(n)}r=o.oA(t.map((e=>{var t;return null===(t=e.model)||void 0===t?void 0:t.pointer})))}return a}({environment:t,rootPagePointer:u,inMemoryRecordCache:n});return l.default.measure(f,{environment:t,data:{status:m?"v2":"v1"}}),g}},35026:(e,t,n)=>{n.d(t,{EE:()=>T,N:()=>P,P4:()=>M,Pl:()=>x,Ps:()=>R,Q2:()=>w,Yz:()=>A,l6:()=>_,si:()=>C,vs:()=>S});n(57658),n(30541);var o=n(15145),i=n(41432),r=n(42875),a=n(15157),s=n(72126),l=n(69246),c=n(21202),d=n(70279),u=n(29369),p=n(64684),m=n(70203),f=n(97880),g=n(26136),h=n(13105),v=n(75770);const b=new Set([i.Ti.page,i.Ti.collectionView,i.Ti.collectionViewPage,i.Ti.alias]),y=new Set([i.Ti.factory]);function _(e){const{allSharedPages:t,state:n,intl:o,teamStore:i}=e,{query:a,filter:s}=n;return t.map((e=>{if(!e.isDefined())return;const t=e.getLastEditedTime()||e.getCreatedTime();if(!t)return;const n=e.getLastEditedByPointer()??e.getCreatedByPointer(),c=e.getParentId();if(i){if("owned"===s&&c!==i.id)return;if("shared"===s&&c===i.id)return}return(0,l.fY)({block:e.getModel(),query:a,getRecordModel:e.getRecordModel,userTimeZone:(0,r.r)(),intl:o})?{blockId:e.id,timestamp:t,authorPointer:n}:void 0})).filter(f.$K)}function S(e){const{sharedPageItems:t}=e;return s.MR(t,(e=>{let{timestamp:t}=e;return t})).reverse()}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b;const o=[],i=new Set,r=[e];for(;r.length>0;){const a=r.shift();if(i.has(a.id))continue;i.add(a.id);const s=I(a,e,t,n);o.push(...s.outlinerItems),r.unshift(...s.subtree)}return o}const k=new h.P({debugName:"getOutlinerItemsStoresInSubtreePageMentions",memoizeRecursion:!1,deepEquals:!1,compute(e){var t;const n=null===(t=e.getTitleStore())||void 0===t?void 0:t.getValue(),o=m.cCA(n);return e.getRecordStoreArray(e,o).filter((t=>t.getParentId()===e.id)).concat(e.getContentStores())}});function I(e,t,n,o){var r;const a=e.getType();if(a&&n.has(a)||(null===(r=e.getModel())||void 0===r||null===(r=r.getAliasTargetPointer())||void 0===r?void 0:r.table)===d.x_)return{outlinerItems:[],subtree:[]};if(a&&e!==t&&o.has(a))return{outlinerItems:[e],subtree:[]};const s=e.getType()===i.Ti.transclusionReference?e.getTransclusionReferenceTargetStore():e;if(!s)return{outlinerItems:[],subtree:[]};return{outlinerItems:[],subtree:k.getStateFor(s)}}function x(e){let{environment:t,draggingStores:n,parentStore:o,currentSpaceStore:i}=e;if(!t.currentUser.id)return!1;if(!n.every((e=>e.isNavigableBlock())))return!1;if(!(0,v.lQ)({environment:t,blocks:n}))return!1;if((null==o?void 0:o.table)===u.e0){return C({environment:t,teamStore:g.zX.createChildStore(i,{table:u.e0,id:o.id,spaceId:i.id})})}return!0}function C(e){let{environment:t,teamStore:n}=e;const o=t.currentUser.id;if(!n.isDefined())return!1;return!(n.getDisableTeamPageEdits()&&o&&!(0,p.pd)({membership:n.getMembers()},o))&&n.canAddOrRemoveTopLevelPages()}function T(e){let{typeWithTeam:t,sidebarState:n,currentSpaceViewStore:o,environment:i}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStores();case"bookmarks":return o.getBookmarkedPages();case"workspace":return o.getWorkspacePages();case"shared":return n.visibleSharedPagesStores;case"private":return o.getPrivatePages(i);default:(0,f.t1)(t)}}function M(e){let{typeWithTeam:t,currentSpaceStore:n,currentSpaceViewStore:o}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStore();case"bookmarks":return o.getBookmarkedPagesStore();case"workspace":return n.getPagesStore();case"shared":return o.getSharedPagesStore();case"private":return o.getPrivatePagesStore();default:(0,f.t1)(t)}}function P(e){switch(e){case"bookmarks":return o.tY.SidebarBookmark;case"workspace":return o.tY.SidebarWorkspace;case"shared":return o.tY.SidebarShared;case"private":return o.tY.SidebarPrivate;case"team":return o.tY.SidebarTeam;case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":return o.tY.SidebarTeamBrowser;case l.g$:return o.tY.SidebarPublicPageTemplateIncludes;default:(0,f.t1)(e)}}function A(e){return w(g.G.createChildStore(e,{table:c.iU,id:e.id}),y,b)}function R(e){const{store:t,toOpen:n,environment:o,isTopLevelItem:i}=e;i&&a.Z.set({userId:o.currentUser.id,key:`Outliner-${t.id}`,value:n})}},50627:(e,t,n)=>{n.d(t,{CX:()=>d,OZ:()=>f,a_:()=>c,du:()=>p,kC:()=>u,mO:()=>m,y6:()=>l,zL:()=>s});var o=n(41432),i=n(6695),r=n(77546),a=n(82136);const s=900;function l(e){const t=e.getAssociatedCollectionStore();if(!t)return;const n=e.getSchema(),o=t.getFormat();return i.iB(o,n,void 0,i.j5.Collection)}function c(e){if(e.isCollectionView()){const t=e.getCollectionViewSourceCollectionStore();return!!t&&t.isSyncedCollection()}return e.isType(o.Ti.externalObjectInstancePage)}function d(e){return!e.hasContent()&&(!e.isCollectionView()||e.isType("collection_view_page")&&e.isCollectionViewPageWithContent())}function u(e,t){const n={width:"100%",display:"flex",flexDirection:"column",alignItems:"center",flexShrink:0,flexGrow:0};return e.isCollectionView()&&(e.isLocked()&&(n.cursor="default"),r.eA(t)&&(n.position="sticky",n.left=0)),n}function p(e,t,n){return m(e,t,n)?"100%":s}function m(e,t,n){if(t===a.S.CollectionPageView)return!0;const{device:o}=n,{isPhone:i}=o,r=e.isFullWidth(),s=e.isCollectionView(),l=f(t);return r&&!i||s||l||i}function f(e){return e===a.S.PeekView}},78873:(e,t,n)=>{n.d(t,{E:()=>s,c:()=>l});var o=n(54642),i=n(97799),r=n(69503),a=n(92083);function s(e){const{environment:t,onSubmit:n,onCancel:o}=e;t.device.isMobile?i.Z.setState({open:!0}):a.Z.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0}),r.Z.setState({open:!0,setNewPassword:!0,password:"",repeatPassword:"",isSet:!1,onSubmit:n,onCancel:o})}async function l(e){const{environment:t,userEmail:n}=e,i=await o.getLoginOptions(t,{email:n});if("failed"===i.type)return{error:i.error};const r=i.data;return{value:{isSamlEnforced:"required"===r.samlSignIn,didLogInWithSaml:"available"===r.samlSignIn&&r.hasAccount&&"saml"===r.lastLoginMethod,hasPassword:"required"!==r.samlSignIn&&r.hasAccount&&r.passwordSignIn}}}},98165:(e,t,n)=>{n.d(t,{D0:()=>K,Dg:()=>Z,Eb:()=>R,KU:()=>O,Om:()=>B,Pj:()=>j,RC:()=>$,VP:()=>U,_A:()=>N,e3:()=>q,fJ:()=>A,fl:()=>z,n3:()=>H,oZ:()=>G,qA:()=>P,s:()=>D,u3:()=>V,uJ:()=>E,wf:()=>F,yI:()=>W});n(57658);var o=n(41432),i=n(72126),r=n(63306),a=n(72141),s=n(73360),l=n(74446),c=n(45953),d=n(606),u=n(98963),p=n(18844),m=n(21202),f=n(6287),g=n(70279),h=n(33709),v=n(91644),b=n(15047),y=n(29369),_=n(97880),S=n(80444),w=n(26136),k=n(13105),I=n(65598);function x(e,t){const{table:n,id:o,spaceId:i}=t,r=i||e.pointer.spaceId;if(n===f.v)return w.NW.createChildStore(e,{table:f.v,id:o});if(n===b.bx)return w.H2.createChildStore(e,{table:b.bx,id:o});if(n===m.iU)return w.G.createChildStore(e,{table:m.iU,id:o});if(n===g.x_){if(r)return w.T5.createChildStore(e,{table:g.x_,id:o,spaceId:r})}else if(n===h.qF){if(r)return w.jQ.createChildStore(e,{table:h.qF,id:o,spaceId:r})}else if(n===y.e0){if(r)return w.zX.createChildStore(e,{table:y.e0,id:o,spaceId:r})}else if(n===p.Xj){if(r)return w.zq.createChildStore(e,{table:p.Xj,id:o,spaceId:r})}else if(n===u.cv&&r)return w.Mz.createChildStore(e,{table:u.cv,id:o,spaceId:r})}function C(e){const t=S.default.state.mainEditorCurrentBlockStore;return t?t.inMemoryRecordCache!==e.inMemoryRecordCache?e:t:e}function T(e){const t=C(e);return((n=e)instanceof w.G||n instanceof w.H2||n instanceof w.NW||n instanceof w.T5||n instanceof w.jQ||n instanceof w.zX||n instanceof w.zq||n instanceof w.Mz)&&e.getRecordStoreUIParent()===t?e:x(t,e.pointer);var n}const M=new k.P({debugName:"getPathStores",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){const n=e.getValue();if(!n||!(0,s.oK)(n))return[e];const o=d.dr.getParentPointerFromRecordWithParent(n),i=x(C(e),o);return i?[e].concat(t(i)):[e]}}),P=function(e){const t=T(e);return t?M.getStateFor(t):[]};function A(e){return i.oA(P(e).map((e=>{if("space"===e.table){if(!(0,I.Mm)(e))return;return function(e){const{pointer:t}=e,n=(0,w.Vh)(e,t,"permissions").getValue(),o=(0,w.Vh)(e,t,"permission_groups").getValue();return{table:t.table,value:{id:t.id,permissions:n,permission_groups:o}}}(e)}if("block"===e.table){const{pointer:t}=e,n=(0,w.Vh)(e,t,"permissions").getValue(),o=(0,w.Vh)(e,t,"alive").getValue(),i=(0,w.Vh)(e,t,"parent_id").getValue(),r=(0,w.Vh)(e,t,"type").getValue();if(void 0!==o&&void 0!==i&&void 0!==r)return{table:t.table,value:{id:t.id,permissions:n,alive:o,parent_id:i,type:r}}}else if(e.table===y.e0){const{pointer:t}=e,n=(0,w.Vh)(e,t,"permissions").getValue(),o=(0,w.Vh)(e,t,"membership").getValue(),i=(0,w.Vh)(e,t,"settings").getValue();if(!i)return;return{table:t.table,value:{id:t.id,permissions:n||[],membership:o||[],settings:i,is_default:e.isDefault()}}}})))}function R(e){const{store:t,teamPermissionItems:n}=e,o=c.Ao.create(),i=j(t)||S.default.state.currentSpaceStore;return i&&n.forEach((e=>{const t=w.zX.createChildStore(i,{table:y.e0,id:e.team_id,spaceId:i.id}),n=(0,w.Vh)(t,t.pointer,"membership").getValue();o.set({id:t.id,table:y.e0,spaceId:i.id},{membership:n,is_default:t.isDefault()})})),o}async function D(e){const t=[];return await r.ne(e.pointer,l.zF.fromMonomorphicFunctionUnsafe((async n=>{let o;if(n.table===f.v?o=w.NW.createChildStore(e,n):n.table===b.bx?o=w.H2.createChildStore(e,n):n.table===m.iU?o=w.G.createChildStore(e,n):n.table===g.x_?o=w.T5.createChildStore(e,n):n.table===h.qF&&(o=w.jQ.createChildStore(e,n)),o)return t.push(o),await o.load(),o.getValue()}))),t}const B=function(e){const t=w.t1.fromV1(e);if(t instanceof w.G||t instanceof w.NW){const e=t.getParentTable(),n=t.getParentId();if(e&&n){if(e===f.v)return w.NW.createChildStore(t,{table:f.v,id:n});if(e===b.bx)return w.H2.createChildStore(t,{table:b.bx,id:n});if(e===m.iU)return w.G.createChildStore(t,{table:m.iU,id:n});if(e===g.x_)return w.T5.createChildStore(t,{table:g.x_,id:n,spaceId:t.getSpaceId()});if(e===y.e0)return w.zX.createChildStore(t,{table:y.e0,id:n});if(e===p.Xj)return w.zq.createChildStore(t,{table:p.Xj,id:n,spaceId:t.getSpaceId()});if(e===v.AT)return w.Vf.createChildStore(t,{table:v.AT,id:n,spaceId:t.getSpaceId()});(0,_.t1)(e)}}},E=function(e){return P(e).filter((e=>{if(!e.canRead())return!1;if(e instanceof w.G){const t=e.getType();return t&&(0,o.S9)(t)}return e instanceof w.zX}))},F=function(e){const t=P(e).find((e=>{let t;return(e instanceof w.G||e instanceof w.NW)&&(t=e.getAlive()),!1===t}));return Boolean(t)},Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=E(e)[t];return n instanceof w.zX?Z(n,t+1):n},V=function(e){const t=E(e);return t[t.length-1]},j=function(e){return P(e).find((e=>e.table===b.bx))},U=function(e){const t=P(e);return L(t)},L=function(e){return e.find((e=>e.table===y.e0))},O=e=>e.find((e=>e.table===y.e0)),N=function(e){return P(e).find((e=>{var t;return e.table===m.iU&&(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))},z=function(e){for(const t of e)if((t instanceof w.G||t instanceof w.NW)&&(!t.isDefined()||!t.getAlive()))return!1;return!0},W=function(e){for(const t of e)if(t instanceof w.G||t instanceof w.NW){if(!t.isDefined())continue;if(!t.getAlive())return!0}return!1};function q(e){for(const t of e)if(t instanceof w.G){if(!t.isDefined())continue;const e=t.getMovedStore().getValue();if(void 0!==e)return{store:t,moved:e}}}function H(e){return"block"===e.table||"space"===e.table||"collection"===e.table||"comment"===e.table||"discussion"===e.table}const K=function(e){const t=P(e).find((e=>{if(e.table===y.e0)return Boolean(e.getArchivedBy())}));return Boolean(t)};function G(e){const t=P(e);for(const n of t)if(n.table===b.bx)return n.getSettings().space_request}function $(e){const{environment:t,store:n}=e,o=t.currentUser.id;if(!o)return!1;const i=P(n);if(!i.every((e=>Boolean(e.isReady()))))return;if(!!i.some((e=>Boolean(e instanceof w.G&&!e.isDefined()))))return!1;return!i.some((e=>{if(e instanceof w.G){const t=(e.getPermissionItemsStore().getValue()||[]).find((e=>(0,a.$D)(e)||(0,a.hV)(e)||(0,a.ix)(e)||(0,a.RI)(e)||(0,a.ZQ)(e)||(0,a.FB)(e)||(0,a.jg)(e)&&e.user_id!==o));return Boolean(t)}return e instanceof w.zX}))}},85957:(e,t,n)=>{n.d(t,{PQ:()=>d,Tx:()=>s,mH:()=>l,wq:()=>c});var o=n(24646),i=n(4926),r=n(88923),a=n(27724);function s(){return r.default.isCenterPeekOpen()||a.default.isInPeekRenderer()}function l(){const e=r.default.state;return e.open&&(s()||e.isOpening)}function c(e){return Boolean(e.findRecordStoreUIAncestor((e=>e===r.default.peekTarget.state)).ancestor)}function d(e){const t=i.Z.state;return r.default.isSidePeekOpen()?(0,o.vJ)(e):r.default.isCenterPeekOpen()?Math.min(e.WindowSizeStore.state.width-2*r.PeekModeOuterPadding,r.CenterPeekModeOuterWidth+t):0}},67669:(e,t,n)=>{n.d(t,{BZ:()=>V,Dt:()=>N,IJ:()=>C,JI:()=>A,KE:()=>j,Kz:()=>E,Oc:()=>M,S4:()=>T,U7:()=>L,UK:()=>P,WE:()=>z,YF:()=>Z,YO:()=>x,Z9:()=>B,dA:()=>D,mU:()=>O,r_:()=>F,su:()=>U,uY:()=>W,yi:()=>R,zT:()=>H});n(67635),n(57658);var o=n(66897),i=n(72126),r=n(63306),a=n(86517),s=n(72141),l=n(8637),c=n(4615),d=n(21202),u=n(29369),p=n(19889),m=n(47425),f=n(64684),g=n(97880),h=n(80444),v=n(83212),b=n(26136),y=n(88893),_=n(88280),S=n(98165),w=n(65598),k=n(38755),I=n(95697);function x(e){const t=S.fJ(e),n=a.KJ(t);return a.YO(n)}function C(e,t){const{id:n}=e.currentUser;if((0,k.C)()&&(0,k.Fn)(e))return;let i;if(n){const e=t.getRecordValue({table:p.KJ,id:n});e&&(i=(0,o.dp)(e))}const r=S.qA(t).map((e=>e.getModel())).filter(g.$K);return a.IJ({actor:i,ancestors:r})}function T(e){return x(e).map((e=>{let{permissionItem:t}=e;return t})).some((t=>s.$D(t)&&s.YX(t.role)&&(void 0===t.allow_duplicate||!0===t.allow_duplicate)&&(!e.isTypedCollectionViewBlock()||e.isCollectionViewPageWithContent())))}function M(e){return x(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>s.$D(e)))}function P(e){return x(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>s.ix(e)))}async function A(e){const{currentUserRootStore:t}=h.default.state;if(!t)return!1;if(!(0,c.e)(e))return!1;const n=b.G.createChildStore(t,{table:d.iU,id:e});return await n.load(),M(n)}function R(e,t){let n;if(n=t instanceof b.H2?(0,k.jv)(t):x(t).map((e=>{let{permissionItem:t}=e;return t})),1===n.length){const[t]=n;return"user_permission"===t.type&&s.zz(t.role)&&t.user_id===e.currentUser.id}return!1}function D(e,t){const n=_.subscriptionDataStoreInstance.state;if(!n)return!1;if(Boolean(n&&y.YK(n)))return!1;const o=y.ND(n).map((e=>e.userId)),i=y.hn(n).map((e=>e.userId)),r=new Set([...o,...t].filter((e=>!i.includes(e)))),a=(0,m.tP)("free");return r.size>Math.max(a,o.length)}function B(){const e=_.subscriptionDataStoreInstance.state;if(!e)return!1;if(Boolean(e&&y.YK(e)))return!0;const t=y.ND(e).map((e=>e.userId)),n=(0,m.tP)("free");return t.length<n}function E(e){const{environment:t,store:n,permissionItems:o}=e;if(n instanceof b.H2)return!1;if(!_.subscriptionDataStoreInstance.state)return!1;return D(0,o.filter(s.jg).filter((e=>"none"!==e.role)).map((e=>e.user_id)))}function F(e){return{editor:"Full access",read_and_write:"Can edit",comment_only:"Can comment",reader:"Can read",none:"No access"}[e]}function Z(e){return!!e&&(e.hasPublicPermission&&"edit"!==e.permission)}function V(e){return!!e&&(e.hasPublicPermission&&"view"===e.permission)}function j(e){let{environment:t,block:n}=e;const o=n.getParentStore();if(!o)return!1;return!Z(S.n3(o)&&v.Z.getMode(t,o))&&o.canEdit()}function U(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const n=e.find((e=>"user_permission"===e.type&&e.user_id===t));return n&&n.role||"none"}function L(){const{currentSpaceStore:e}=h.default.state;return"enterprise"===(null==e?void 0:e.getSubscriptionTier())}function O(e,t){const n=new Set;var o;(0,w.Y)(e)?null===(o=e.getPermissionItems())||void 0===o||o.forEach((e=>{s.jg(e)&&n.add(e.user_id)})):e.getPermissionItems().forEach((e=>{s.jg(e)&&n.add(e.user_id)}));return t.filter((e=>"existingUser"!==e.type||!n.has(e.value.id)))}function N(e){let{userId:t,store:n}=e;return z({userId:t,store:n})[0]}function z(e){let{userId:t,store:n}=e;const o=r.DW(n.pointer,n.getRecordModel),c=S.Pj(n)||h.default.state.currentSpaceStore,d=c&&c.isDefined()&&!o.findLast(a.zX)?[...o,c.getModel()]:o,u=x(n),m=S.VP(n),f=u.filter((e=>{let{permissionItem:t}=e;return(s.zU(t)||s.LW(t))&&t.team_id!==(null==m?void 0:m.id)})).map((e=>e.permissionItem)),g=S.Eb({store:n,teamPermissionItems:f}),v={table:p.KJ,id:t},b=(0,l.J3)({actorPointers:[v],explicitTeamsRecordMap:g}),y=a.qY({actorPointer:v,ancestors:d,permissionsContext:b}).map((e=>e.permissionItem));if(0===y.length)return[{type:"user_permission",role:"none",user_id:t}];const _=i.oA(y.map((e=>e.role))),w=a.nl(..._);return y.filter((e=>e.role===w)).sort(q)}function W(e){let{userId:t,store:n}=e;const o=r.DW(n.pointer,n.getRecordModel),i=S.Pj(n)||h.default.state.currentSpaceStore,c=i&&i.isDefined()&&!o.findLast(a.zX)?[...o,i.getModel()]:o,m=x(n),g=S.VP(n),v=m.filter((e=>{let{permissionItem:t}=e;return(s.zU(t)||s.LW(t))&&t.team_id!==(null==g?void 0:g.id)})).map((e=>e.permissionItem)),b=S.Eb({store:n,teamPermissionItems:v}),w={table:p.KJ,id:t},k=(0,l.J3)({actorPointers:[w],explicitTeamsRecordMap:b}),C=a.qY({actorPointer:w,ancestors:c,permissionsContext:k}),T=[...C];C.find((e=>"user_permission"===e.permissionItem.type))||T.push({permissionItem:{type:"user_permission",role:"none",user_id:t},from:{table:d.iU,blockId:n.id}});const M=_.subscriptionDataStoreInstance.state,P=new Set(M?y.ND(M).map((e=>e.userId)):[]);if(null!=P&&P.has(t))return T.sort(((e,t)=>q(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>s.xm[t.permissionItem.role??"none"]-s.xm[e.permissionItem.role??"none"]));!C.find((e=>"explicit_team_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==g?void 0:g.id)))&&g&&(0,I.AL)({teamStore:g,spaceStore:i,userId:t})&&T.push({permissionItem:{type:"explicit_team_permission",role:"none",team_id:g.id},from:{table:u.e0,teamId:g.id}});!C.find((e=>"explicit_team_owner_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==g?void 0:g.id)))&&g&&(0,f.pd)({membership:g.getMembers()},t)&&T.push({permissionItem:{type:"explicit_team_owner_permission",role:"none",team_id:g.id},from:{table:u.e0,teamId:g.id}});return C.find((e=>"space_permission"===e.permissionItem.type))||T.push({permissionItem:{type:"space_permission",role:"none"},from:{table:d.iU,blockId:n.id}}),T.sort(((e,t)=>q(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>s.xm[t.permissionItem.role??"none"]-s.xm[e.permissionItem.role??"none"]))}function q(e,t){const n=s.jg(e),o=s.jg(t);if(n||o)return n&&o?0:n?-1:1;const i=s.hV(e),r=s.hV(t);if(i||r)return i&&r?0:i?-1:1;const a=s.Lq(e),l=s.Lq(t);return a||l?a&&l?0:a?-1:1:0}function H(e){const{botStore:t,addPermission:n}=e,o=n?a.uH(t.getCapabilities()):"none",i=t.getParentId(),r=t.getParentTable();let s={type:"bot_permission",bot_id:t.id,role:o};return i&&r&&(s={type:"bot_permission",bot_id:t.id,role:o,parent_id:i,parent_table:r}),s}},45101:(e,t,n)=>{n.d(t,{Aw:()=>x,Bu:()=>P,DF:()=>A,Ji:()=>j,NN:()=>M,Nd:()=>C,OA:()=>F,ZK:()=>V,Zp:()=>R,a_:()=>E,cm:()=>T,fR:()=>O,gQ:()=>U,t0:()=>L,xT:()=>B,z5:()=>D});n(57658),n(67294);var o=n(15070),i=n(8848),r=n(72141),a=n(4615),s=n(21202),l=n(15047),c=n(97880),d=n(82990),u=n(7928),p=n(9291),m=n(91219),f=n(47307),g=n(80444),h=n(29677),v=n(88893),b=n(35057),y=n(88280),_=n(28020),S=n(33929),w=n(65598),k=n(16639),I=n(85893);async function x(e){let{environment:t,permissionsInviteStoreState:n,from:o}=e;const i=(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),r=(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),a=(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(n.inviteTargets.length>0){const e=await f.confirmUserAction({message:i,acceptLabel:r,cancelLabel:a});return m.q_(t,{...E(t,n),from:o,discard_changes:e}),!e}return!1}const C=e=>{const{target:t,permissionsInviteStore:n}=e;return n.state.inviteTargets.find((e=>"newUser"===t.type?"newUser"===e.type&&t.value.email===e.value.email:e.type===t.type&&e.value.id===t.value.id))},T=e=>{const{targetStore:t,permissionsInviteStore:n,userTarget:o}=e;return!!C({permissionsInviteStore:n,target:o})||"existingUser"===o.type&&R({target:o,store:t})},M=e=>{const{targetStore:t,permissionsInviteStore:n,currentInviteActors:i}=e;if(!i)return{inviteUsers:[],inviteGroups:[],inviteBots:[]};const r=i.inviteUsers.filter((e=>!T({targetStore:t,permissionsInviteStore:n,userTarget:e})));return{inviteBots:i.inviteBots.filter((e=>!(!e.value.alive||C({permissionsInviteStore:n,target:e})||!(0,o.oA)(e.value)&&!(0,o.c9)(e.value))&&!R({target:e,store:t}))),inviteGroups:i.inviteGroups.filter((e=>!C({permissionsInviteStore:n,target:e})&&!R({target:e,store:t}))),inviteUsers:r,importedContacts:i.importedContacts}},P=(e,t)=>{if(!e||!t||0===e.length||0===t.length)return t;const n=new Set(e.map((e=>e.value.email.toLowerCase())));return t.filter((e=>!n.has(e.value.email.toLowerCase())))},A=e=>{const{intl:t,target:n}=e;switch(n.type){case"newUser":return n.value.email;case"existingUser":return(0,u.Nz)(t,n.value);case"bot":return(0,o.Mh)(n.value);case"group":return(0,k.kF)({intl:t,group:n.value});default:(0,c.t1)(n)}},R=e=>{const{target:t,store:n}=e;return!!n.isDefined()&&((0,w.Y)(n)?n.getMembers().filter((e=>{switch(t.type){case"existingUser":return"user"===e.entity_type&&t.value.id===e.user_id;case"group":return"group"===e.entity_type&&t.value.id===e.group_id}})).length>0:n.getPermissionItems().some((e=>{switch(t.type){case"existingUser":return(0,r.jg)(e)&&e.user_id===t.value.id;case"bot":return(0,r.FB)(e)&&e.bot_id===t.value.id;case"group":return(0,r.hV)(e)&&e.group_id===t.value.id;case"newUser":return!1;default:return(0,c.t1)(t)}})))};function D(e){const{environment:t,permissionsInviteStore:n,store:o,renderInShareModal:i}=e;n.setState({modalOpen:!i,tokenQuery:"",inviteTargets:[],inviteRole:B(e),isInviteTargetsEmpty:!0,table:(0,w.Mm)(o)?l.bx:s.iU,flowId:(0,a.ZP)(),inputFocus:"invitee",emailMessage:""}),(0,w.Mm)(o)?m.$z(t):m.Mq(t,{...E(t,e.permissionsInviteStore.state)})}function B(e){const{store:t,isSubscribed:n}=e;return(0,w.Mm)(t)?n?"read_and_write":"editor":(0,b.Mk)()?"editor":"read_and_write"}function E(e,t){var n;const{isInviteTargetsEmpty:o,inviteRole:i,flowId:r}=t,a=(0,_.np)(),s=null==a?void 0:a.getRole(),l=null===(n=g.default.state.currentSpaceStore)||void 0===n?void 0:n.getRole(),{inviteTargets:c,emailMessage:d}=t,u=(0,b.zt)(),p={invite_flow_id:r,user_count:0,is_bot:!1,invite_message_length:(null==d?void 0:d.length)??0,...s&&{page_current_user_role:s},...l&&{space_role:l},...u&&{subscription_tier:u}};if(o)return p;if(0===c.length)return p;if(function(e){return e.length>0&&"bot"===e[0].type}(c))return{...p,is_bot:!0};const m=c.filter(h.cl).length,f=c.filter(h.fZ).length+m;return{...p,role:i,user_count:f,new_user_count:m}}function F(e){return"newUser"===e.type||"existingUser"===e.type&&("none"===e.spaceRole||"not_in_space"===e.spaceRole)}const Z=(0,p.defineMessages)({workspaceOwnerTooltip:{id:"inviteUserModal.userRole.workspaceOwnerBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a workspace owner in this workspace"},workspaceOwnerBadge:{id:"inviteUserModal.userRole.workspaceOwnerBadge.label",defaultMessage:"Workspace Owner"},adminTooltip:{id:"inviteUserModal.userRole.adminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is an admin in this workspace"},adminBadge:{id:"inviteUserModal.userRole.adminBadge.label",defaultMessage:"Admin"},membershipAdminTooltip:{id:"inviteUserModal.userRole.membershipAdminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a membership admin in this workspace"},membershipAdminBadge:{id:"inviteUserModal.userRole.membershipAdminBadge.label",defaultMessage:"Membership admin"},memberTooltip:{id:"inviteUserModal.userRole.memberBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a member in this workspace"},memberBadge:{id:"inviteUserModal.userRole.memberBadge.label",defaultMessage:"Member"},guestTooltip:{id:"inviteUserModal.userRole.guest.tooltip",defaultMessage:"{ userNameAndEmail} is a guest in this workspace"},guestBadge:{id:"inviteUserModal.userRole.guestBadge.label",defaultMessage:"Guest"}});function V(e){const{environment:t,customStyle:n}=e,{device:o}=t;return{display:"inline-flex",height:18,textTransform:"uppercase",fontSize:10,marginBottom:2,fontWeight:d.Z.fontWeight.medium,letterSpacing:1,color:i.ZP.uiLightGray,border:`1px solid ${i.ZP.uiLightGray}`,minWidth:70,alignItems:"center",justifyContent:"center",paddingTop:o.isAndroid?2:1,paddingBottom:1,paddingLeft:3,paddingRight:3,borderRadius:4,...n}}function j(e){const{role:t,intl:n,nameOrEmail:o}=e,i=o||n.formatMessage({id:"userTypeTooltip.generalPerson",defaultMessage:"This person"});switch(t){case"editor":return{tooltip:n.formatMessage(Z.workspaceOwnerTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.workspaceOwnerBadge)};case"membership_admin":return{tooltip:n.formatMessage(Z.membershipAdminTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.membershipAdminBadge)};case"read_and_write":return{tooltip:n.formatMessage(Z.memberTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.memberBadge)};case"none":return{tooltip:n.formatMessage(Z.guestTooltip,{userNameAndEmail:i}),userRoleBadge:n.formatMessage(Z.guestBadge)};default:(0,c.t1)(t)}}function U(e){return F(e)?"rgba(246, 192, 80, 0.26)":void 0}function L(e){var t;const{inviteTargets:n,recordStore:o,canEditSpaceMembership:i}=e;if(0===n.length)return null;if(!o)return null;const{inviteTargetGuests:r,inviteTargetMembers:a}=function(e){const t=[],n=[];return e.forEach((e=>{F(e)?t.push(e):n.push(e)})),{inviteTargetGuests:t,inviteTargetMembers:n}}(n),s=i?[...a,...r]:a,l=i?[]:r,c=S.default.getIntl(),d=(0,w.OY)(o)?null===(t=o.getBlockTitleStore())||void 0===t?void 0:t.getValue():o.getName();return i||0===l.length?(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.usersAddedMessage",defaultMessage:"{numberOfTargets, plural, one {Added {targetName} to {recordName}} other {Added {numberOfTargets} people to {recordName}}}",values:{numberOfTargets:s.length,targetName:A({intl:c,target:s[0]}),recordName:d}}):0===s.length?(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.inviteRequestedMessage",defaultMessage:"{numberOfTargets, plural, one {Requested {targetName} for approval} other {Requested {numberOfTargets} invites for approval}}",values:{numberOfTargets:l.length,targetName:A({intl:c,target:l[0]})}}):(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.userAddedAndRequestedText",defaultMessage:"{numberOfAddedTargets, plural, one {Added {addedTargetName}} other {Added {numberOfAddedTargets} people}} & {numberOfRequestedTargets, plural, one {requested {requestedTargetName} for approval} other {requested {numberOfRequestedTargets} people for approval}}",values:{numberOfAddedTargets:s.length,addedTargetName:A({intl:c,target:s[0]}),numberOfRequestedTargets:l.length,requestedTargetName:A({intl:c,target:l[0]})}})}function O(e){if("existingUser"!==e.type)return;const t=y.subscriptionDataStoreInstance.state,n=(t?v.CM(t):[]).find((t=>t.userId===e.value.id));return n?n.role:"not_in_space"}},13273:(e,t,n)=>{n.d(t,{Xt:()=>r,al:()=>l,jM:()=>s,yT:()=>a});var o=n(43250),i=n(62619);function r(e){const{menuElement:t,clickedElement:n}=e;return t!==n&&!t.contains(n)&&(!n.classList.contains("notion-link")&&!(n.closest(`.${o.mJW}`)&&!n.closest(`.${o.p1Q}`)&&!n.closest(`.${o.Nn$}`)&&!n.closest(`.${o.fHd}`)))}function a(e){if((0,i.sh)(e,(e=>e.classList&&(e.classList.contains(o.p1Q)||e.classList.contains(o.Nn$)||e.classList.contains(o.fHd)))))return!1;const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.mJW)));return Boolean(t)}function s(e){const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.Dkf)));return Boolean(t)}function l(e){const t=(0,i.sh)(e,(e=>e.classList&&e.classList.contains(o.RIA)));return Boolean(t)}},17504:(e,t,n)=>{n.d(t,{V:()=>r,Z:()=>a});var o=n(74948),i=n(12534);const r=e=>{(0,i.ZP)({event:e,context:i.Af.SidebarMouseMove,callback:()=>{o.close()}})},a=function(e){return e({onMouseMove:r})}},55227:(e,t,n)=>{n.d(t,{g7:()=>a,kF:()=>l});n(57658);var o=n(72126),i=n(70203),r=n(62619);function a(e){let t="";const n=document.createElement("div");n.innerHTML=e;const i=r.kd(n);for(const r of i){const e=o.YU(r.data);if(null!==r.parentElement&&r.parentElement!==n){t+=`<span class="${s({parent:r.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function s(e){const{parent:t,root:n}=e,o=new Set;let i=t;for(;i&&i!==n;)i.classList.forEach((e=>{o.add(e)})),i=i.parentElement??void 0;return Array.from(o)}function l(e,t){const n={text:c(e),syntax:c(t)},o=u(d(n.text,n.syntax)),r={text:0,syntax:0},a={text:0,syntax:0},s=[],l=e.map(i.WiV).join("");for(const[i,c]of o){const e=i+c,o=t[r.syntax],d={value:l.substring(i,e),textTokenIndex:r.text,classNames:(p=o,p&&p[1])};s.push(d);const u=n.text[r.text],m=n.syntax[r.syntax];e>=a.text+u&&(r.text+=1,a.text+=u),e>=a.syntax+m&&(r.syntax+=1,a.syntax+=m)}var p;return s}const c=e=>e.map((e=>e[0].length)),d=(e,t)=>{const n=e.slice(),o=t.slice(),i=[];let r=0,a=0;for(;r<n.length&&a<o.length;){const e=n[r],t=o[a];e===t?(i.push(e),r+=1,a+=1):e<t?(i.push(e),r+=1,o[a]-=e):(i.push(t),n[r]-=t,a+=1)}return i},u=e=>{let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}},70219:(e,t,n)=>{n.d(t,{b:()=>r});var o=n(95477),i=n(81236);function r(e){return t=>{const{RouterStore:n}=e;if("page"!==n.state.route.name||!n.state.route.requestedOnPublicDomain)return;const r=i.Z.getPublicSpaceData(e,t),a=(null==r?void 0:r.domain)||n.state.route;return`${window.location.protocol}//${a}.${o.default.publicDomainName}`}}},58239:(e,t,n)=>{n.d(t,{ZT:()=>c,lX:()=>a,rq:()=>s});var o=n(15157),i=n(21202),r=n(15047);async function a(e){let{currentUserId:t,spaceStore:n}=e;const i=o.Z.get({userId:t,key:l(n.id)});return u(n,n.loadRecordModel,i)}function s(e){let{currentUserId:t,spaceId:n,value:i}=e;o.Z.set({userId:t,key:l(n),value:i})}const l=function(e){return`quickAddParent3:${e}`};function c(e){let{currentUserId:t,spaceId:n,parent:i,databaseType:r}=e;o.Z.set({userId:t,key:d(n,r),value:i})}const d=function(e,t){return`quickAddTypedParent:${e}:${t||"default"}`};async function u(e,t,n){let o;if(n)if("page"===n.type){await t({table:i.iU,id:n.id})&&(o=n)}else if("space"===n.type){await t({table:r.bx,id:n.id})&&(o=n)}return o||{type:"space-private-pages",spaceId:e.id}}},15447:(e,t,n)=>{n.d(t,{Od:()=>f,Wk:()=>v,X4:()=>u,_5:()=>h,_k:()=>g,h_:()=>m,rw:()=>p});n(57658);var o=n(14577),i=n(72126),r=n(54642),a=n(18245),s=n(80444),l=n(77080),c=n(69327),d=n(29026);const u=new o.Z((()=>{const{currentSpaceStore:e}=s.default.state;if(!e)return[];return c.Z.getWithoutSubscribing(e.id).slice(0,1e3).filter((e=>!e.store.pathIsDead()))}),{debugName:"recentAlivePagesStore"});function p(e,t){if("object"==typeof t&&t){const{spaceId:e,blockId:n,visitedAt:o}=t.userPageVisit||{};if(!e||!n||!o)return;!function(e){let{spaceId:t,pageId:n,visitedAt:o}=e;const i=c.Z.getWithoutSubscribing(t),r=function(e){let{newRecentPage:t,currentRecentPages:n}=e;const o=n.filter((e=>e.pageId!==t.pageId)),i=o;let r=0;for(;r<o.length;r++)if(t.visitedAt>=o[r].visitedAt){i.splice(r,0,t);break}r===o.length&&i.push(t);return i}({newRecentPage:{pageId:n,visitedAt:o},currentRecentPages:i});c.Z.set(t,r),u.recompute()}({spaceId:e,pageId:n,visitedAt:o})}}async function m(e){let{environment:t,userId:n,spaceId:o}=e;const s=l.default.getGroup("search-more-recent-pages-in-local"),d="lazy-";let p;s.startsWith(d)&&(p=i.o5(s.slice(d.length))||void 0);const m=s.startsWith(d),f=a.default.mark("load_global_recent_pages_initial_load"),g=a.default.mark("load_global_recent_pages");async function h(e,i){const l=await r.getRecentPageVisits(t,{userId:n,spaceId:o,limit:e},n);"success"===l.type&&(a.default.measure(i,{environment:t,data:{experiment_group:s}}),c.Z.set(o,l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))))),u.recompute()}m?(h(p,g),await h(void 0,f)):await h(p,g)}async function f(e,t){var n,o;let{environment:i,userId:a,spaceId:s}=t;if(c.Z.getWithoutSubscribing(s).length>1e3)return!1;const l=await r.getRecentPageVisits(i,{userId:a,spaceId:s,beforeTimestamp:e,limit:d.Xv},a);if("success"!==l.type||l.data.pages.length<=0)return!1;const p=l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))),m=null===(n=c.Z.get(s))||void 0===n?void 0:n.length;c.Z.mergeRecentPages(p,s);const f=null===(o=c.Z.get(s))||void 0===o?void 0:o.length;return u.recompute(),m!==f}const g=["Today","Yesterday","Past Week","Past 30 Days","Older"];function h(e){const t=Date.now(),n=864e5,o=t-e,i=new Date(e).getDay(),r=new Date(t).getDay(),a=new Date(t);a.setDate(a.getDate()-1);const s=a.getDay();return i===r&&o<=n?"Today":i===s&&o<=1728e5?"Yesterday":o<=6048e5?"Past Week":o<=2592e6?"Past 30 Days":"Older"}function v(e){return null==e?void 0:e.map((e=>({visitedAt:e.visitedAt,pageId:e.pageId}))).sort(((e,t)=>t.visitedAt-e.visitedAt)).slice(0,50)}},44133:(e,t,n)=>{n.r(t),n.d(t,{getDebugSourcesForIdsInOperations:()=>c,setBlockIdDebugSource:()=>s,setupRecordCacheDebugging:()=>a});var o=n(39593);let i=!1;const r=new(n.n(o)())({max:1e4});function a(e){e.isMobile||(i=!0)}function s(e,t){i&&(r.has(e)||r.set(e,t))}const l=/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/g;function c(e,t){const n={blocks:{},isIdSourceCacheFull:r.itemCount===r.max},o=JSON.stringify(t),i=new Set(Array.from(o.matchAll(l)).map((e=>e[0])));for(const s of i){var a;let t=!1;const o={},i=r.get(s);i&&(t=!0,o.debugSource=i);const l=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:{table:"block",id:s},userId:e.currentUser.id});null!=l&&null!==(a=l.value)&&void 0!==a&&a.type&&(t=!0,o.blockType=l.value.type),t&&(n.blocks[s]=o)}return n}},65598:(e,t,n)=>{n.d(t,{D4:()=>j,GP:()=>W,HK:()=>U,M1:()=>Q,MI:()=>C,Mm:()=>K,No:()=>q,OY:()=>_,Oh:()=>$,PF:()=>F,SJ:()=>k,Sd:()=>T,Xp:()=>E,Y:()=>y,ak:()=>V,al:()=>A,bB:()=>B,bQ:()=>N,dv:()=>P,dz:()=>Y,ig:()=>O,le:()=>L,mY:()=>D,p9:()=>Z,sl:()=>H,vV:()=>R,x8:()=>w,yJ:()=>S,zP:()=>z});var o=n(92595),i=n(68626),r=n(72126),a=n(606),s=n(70921),l=n(21202),c=n(70279),d=n(33709),u=n(15047),p=n(29369),m=n(97880),f=n(34047),g=n(26136),h=n(13105),v=n(98165);const b=128;function y(e){return e.table===p.e0}function _(e){return e.table===l.iU}function S(e){return A(e,{recursivelyLoadAllDiscussions:!1}).filter(f.De)}function w(e){return(0,g.Vh)(e,e.pointer,"discussions")}function k(e){let t=0;return e.findRecordStoreUIAncestor((n=>(n!==e&&e.id&&n.id===e.id&&n.table===e.table&&r.Xy(e.path,n.path)&&t++,!1))),t>1}const I=new h.P({debugName:"recursiveChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;case"transclusion_reference":return e.getTransclusionReferenceTargetStore();default:return e}})).filter(m.$K).flatMap((e=>[e,...t(e)]))}}),x=new h.P({debugName:"recursiveWihTransclusionChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;default:return e}})).filter(m.$K).flatMap((e=>[e,...t(e)]))}});function C(e){const{blockStore:t,traverseTransclusionReferences:n}=e;return n?I.getStateFor(t):x.getStateFor(t)}function*T(e){const{blockStores:t,traverseTransclusionReferences:n}=e;for(const o of t){yield o;for(const e of C({blockStore:o,traverseTransclusionReferences:n}))yield e}}const M=new h.P({debugName:"loadedDiscussionStores",memoizeRecursion:!1,deepEquals:!1,compute:function(e){const t=w(e),n=((null==t?void 0:t.getValue())||[]).map((t=>g.t1.createChildStore(e,a.dr.fromPointerLike({table:d.qF,id:t,spaceId:e.pointer.spaceId}))));return n.reverse(),n}});function P(e){return e.table===c.x_}function A(e,t){const n=t.excludeSelf?[]:[e],o=null!=t&&t.recursivelyLoadAllDiscussions?[...n,...I.getStateFor(e)]:n,i=new Set;return o.flatMap(M.getStateFor).filter((e=>!!(null!=t&&t.includeLoadingDiscussions||e.isDefined())&&(!i.has(e.id)&&(i.add(e.id),!0))))}function R(e,t){return B(A(e,t)).unresolved}function D(e,t){return B(A(e,t)).resolved}function B(e){const t=e.filter((e=>e.isDefined())),[n,o]=r.uK(t,(e=>e.getResolved()));return{resolved:n,unresolved:o}}function E(e,t){return(Array.isArray(e)?e:R(e,t)).reduce(((e,n)=>{const o=n.getValue();return o?t.onlyIncludeBlockLevelDiscussions&&!(0,f.De)(n)?e:e+(o.comments||[]).length:e}),0)}function F(e){if("text"!==e.getType())return!1;const t=e.getBlockTitleStore().getValue();return(!t||!t.length)&&(!e.hasContent()&&0===function(e,t){return R(e,t).length}(e,{recursivelyLoadAllDiscussions:!1}))}function Z(e){return(0,g.Vh)(e,e.pointer,"properties")}function V(e){return(0,g.Vh)(e,e.pointer,"comments")}function j(e){if(!e)return[];const t=V(e);return(t.getValue()||[]).map((e=>g.T5.createChildStore(t,{table:c.x_,id:e,spaceId:t.pointer.spaceId})))}function U(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function L(e){const t=O(e);return(t.getValue()||[]).map((n=>g.G.createChildStore(t,a.dr.fromPointerLike({table:l.iU,id:n,spaceId:e.pointer.spaceId}))))}function O(e){return(0,g.Vh)(e,e.pointer,"content")}function N(e){return(0,g.Vh)(e,e.pointer,"last_edited_time")}function z(e){return(0,g.Vh)(e,e.pointer,"text")}function W(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function q(e,t,n){return g.t1.createChildStore(e,{table:s.TY,id:t,spaceId:n})}function H(e){if(e.isDefined())return q(e,e.getActivityId(),e.getSpaceId())}function K(e){return e.table===u.bx}(0,o.exposeDebugValue)("getDiscussionStores",A);const G=r.P2((e=>{i.log(e)}),500),$=function(e){let t=e,n=0;for(;t;){if(!t.isReady())return!1;if(n>=b)return G({level:"error",from:"recordStoreHelpers",type:"areAncestorsLoaded",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}return!0};async function Q(e){let t=e,n=0;for(;t;){if(t.isReady()||await t.load(),n>=b)return G({level:"error",from:"recordStoreHelpers",type:"loadAncestors",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}}function Y(e){return e.table===l.iU&&r.Xy(e.path,["content"])}},37034:(e,t,n)=>{n.d(t,{NO:()=>m,V:()=>f,vU:()=>g});var o=n(17215),i=n(42875),r=n(60310),a=n(82883),s=n(13493),l=n(26136),c=n(28020),d=n(52821),u=n(78316),p=n(38755);function m(e,t){if(e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:t})}function f(e,t,n,s){if((0,c.qG)(e.id))return t.formatMessage(r.CN.myTasks);if(e instanceof l.zX)return e.getName();if(e instanceof l.H2)return(0,p.rn)(n,e);if(e instanceof l.Xr){const t=e.getName();if(t)return t;const n=e.getType();return n?d.Bh[n]:void 0}if("none"===e.getRole())return o.x(t);if(!e.isDefined())return;const u=e instanceof l.G?e.getTitleValue():e.getName();return(0,a.X)({textValue:u,getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:t,disableInsertedAnnotations:s})}function g(e){const{environment:t,intl:n,untitledFallback:i,store:r}=e,a=i?n.formatMessage(i):function(e,t){if(e.table===s.n){const n=e.getType();if(n&&"page"!==n&&u.b1[n])return t.formatMessage(u.b1[n])}return o.Q2(t)}(r,n);return f(r,n,t,!1)||m(r,n)||a}},42937:(e,t,n)=>{n.d(t,{Bq:()=>w,Gt:()=>h,K9:()=>_,OH:()=>b,Tq:()=>f,W3:()=>m,cn:()=>k,dH:()=>u,g3:()=>y,l7:()=>p,nB:()=>g,qi:()=>v,uM:()=>S,vi:()=>I});var o=n(42773),i=n(59341),r=n(41898),a=n(97880),s=n(9291),l=n(51592);const c=(0,s.defineMessages)({dependenciesPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.dependencies.propertySelectPopup.default.caption",defaultMessage:"This property will be used for dependencies in new views, and will set date shifting behavior across all views."},deleteDependenciesAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteDependenciesAcceptModal.title",defaultMessage:"Turn off dependencies?"},dependenciesMenuTitle:{id:"database.viewSettings.dependenciesTab.title",defaultMessage:"Dependencies"},dateShiftingSectionCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.caption",defaultMessage:"Automatic date shifting"},datePropertyPickerTitle:{id:"database.viewSettings.relationFeatures.datePropertyPicker.title",defaultMessage:"Shift using"},startDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.startDate",defaultMessage:"Start date"},endDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.endDate",defaultMessage:"End date"},advancedSettings:{id:"database.viewSettings.dependenciesAdvancedSettingsTab.title",defaultMessage:"Advanced settings"},newDateProperty:{id:"collectionSettings.dependenciesFeature.newDateProperty.name",defaultMessage:"Date"},doNotShiftButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.doNotShift.label",defaultMessage:"Do not automatically shift"},consumeGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.consumeGap.label",defaultMessage:"Shift only when dates overlap"},avoidWeekendsSwitcherTitle:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.title",defaultMessage:"Avoid weekends"},hideDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.hideDependenciesInView",defaultMessage:"Hide dependencies in view"},showDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.showDependenciesInView",defaultMessage:"Show dependencies in view"},turnOnDependenciesButton:{id:"collectionSettings.dependenciesView.turnOnDependenciesButton.label",defaultMessage:"Turn on dependencies"},turnOffDependenciesButton:{id:"database.viewSettings.relationsPropertyTab.removeDependenciesButton.title",defaultMessage:"Turn off dependencies"},dateShiftSuccess:{id:"collectionDateActions.dateShiftSuccess",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}"},dateShiftSomeNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftSomeNotUpdatedDueToPermissions",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}. Others could not be shifted because you do not have permission"},dateShiftAllNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftAllNotUpdatedDueToPermissions",defaultMessage:"The dates of dependent {items} could not be shifted because you do not have permission"},shiftingNotApplicableNoShiftingMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableNoShiftingMessage",defaultMessage:"The dates of dependent {items} in this view will not automatically shift. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicableConsumeGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableConsumeGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift when {item} dates overlap. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicablePreserveGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicablePreserveGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift maintaining the time between {items}. To change the date shifting behavior, update the default relation property in Advanced settings."},preserveGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.preserveGap.label",defaultMessage:"Shift & maintain time between {items}"},avoidWeekendsSwitcherCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.description",defaultMessage:"Prevent shifted {items} from starting or ending on weekends"},dependenciesMenuDescription:{id:"database.viewSettings.relationsPropertyTab.dependencies.description",defaultMessage:"Use dependencies to show {items} that are blocking â€” or blocked by â€” other {items}."},dependenciesPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.dependencies.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the {items} that are blocked. We use â€œBlockingâ€ as our default."}}),d=(0,s.defineMessages)({hideSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.hideSubitemsInView",defaultMessage:"Hide sub-{items} in view"},showSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.showSubitemsInView",defaultMessage:"Show sub-{items} in view"},turnOnSubItemsButton:{id:"collectionSettings.subitemsView.turnOnSubitemsButton.label",defaultMessage:"Turn on sub-{items}"},turnOffSubItemsButton:{id:"database.viewSettings.relationsPropertyTab.removeSubItemsButton.title",defaultMessage:"Turn off sub-{items}"},subItemsMenuTitle:{id:"database.viewSettings.subItemsTab.title",defaultMessage:"Sub-{items}"},subItemsMenuDescription:{id:"database.viewSettings.relationsPropertyTab.subitems.description",defaultMessage:"Use sub-{items} to break large {items} into smaller, more manageable chunks."},deleteSubItemsAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteSubItemsAcceptModal.title",defaultMessage:"Turn off sub-{items}?"},subItemsPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.subitems.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the sub-{items}. We use â€œSub-{item}â€ as our default."},subItemsPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.subitems.propertySelectPopup.default.caption",defaultMessage:"This property will be used for sub-{items} in new views."},toggleNestingOnTitleMenuItemTooltip:{id:"database.viewSettings.relationFeatures.subitems.toggleNestingOnTitleMenuItemTooltip.default.caption",defaultMessage:"Whether nesting and the toggle button should always be on the title column or the left-most column. Only relevant for table views"}}),u=(0,s.defineMessages)({relationFeatureOnMessage:{id:"database.viewSettings.mainTab.feature.on",defaultMessage:"On"},relationFeatureOffMessage:{id:"database.viewSettings.mainTab.feature.off",defaultMessage:"Off"},relationFeatureHiddenMessage:{id:"database.viewSettings.mainTab.relationFeatureHidden",defaultMessage:"Hidden"},turnOffAndDelete:{id:"collectionSettings.relationFeatures.turnOffFeatureAllViewsButton.label",defaultMessage:"Turn off and delete"},turnOffFeature:{id:"collectionSettings.relationFeatures.turnOffFeatureWithoutDeleteButton.label",defaultMessage:"Turn off feature"},turnOffFeatureDeletedProperties:{id:"collectionSettings.relationFeatures.turnOffFeature.deletedProperties.description",defaultMessage:"This will also delete the properties <span>{propertyName}</span> and <span>{inversePropertyName}</span>."},...c,...d});function p(e){return"consume_gap"===e?r.d:"preserve_gap"===e?o.$:i.H}function m(e){let t;return t="consume_gap"===e.dateShiftingMode?u.consumeGapButton:"preserve_gap"===e.dateShiftingMode?u.preserveGapButton:u.doNotShiftButton,{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function f(e){let t;return"timeline_arrows_by"===e.feature?t=u.turnOnDependenciesButton:"subitem"===e.feature?t=u.turnOnSubItemsButton:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function g(e){let t;return"timeline_arrows_by"===e.feature?t=u.turnOffDependenciesButton:"subitem"===e.feature?t=u.turnOffSubItemsButton:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function h(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesMenuTitle:"subitem"===e.feature?t=u.subItemsMenuTitle:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function v(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesMenuDescription:"subitem"===e.feature?t=u.subItemsMenuDescription:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function b(e){let t;return"timeline_arrows_by"===e.feature?t=u.deleteDependenciesAcceptModalTitle:"subitem"===e.feature?t=u.deleteSubItemsAcceptModalTitle:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function y(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesPropertyPickerCaption:"subitem"===e.feature?t=u.subItemsPropertyPickerCaption:(0,a.t1)(e.feature),{...t,values:{item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)}}}function _(e){let t;return"timeline_arrows_by"===e.feature?t=u.dependenciesPropertySelectDefaultOptionCaption:"subitem"===e.feature?t=u.subItemsPropertySelectDefaultOptionCaption:(0,a.t1)(e.feature),{...t,values:{item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)}}}function S(e){let t;return(0,a.$K)(e.currentDateShiftConfig)?"preserve_gap"===e.currentDateShiftConfig.mode?t=u.shiftingNotApplicablePreserveGapMessage:"consume_gap"===e.currentDateShiftConfig.mode?t=u.shiftingNotApplicableConsumeGapMessage:(0,a.t1)(e.currentDateShiftConfig.mode):t=u.shiftingNotApplicableNoShiftingMessage,{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function w(e){return{...u.avoidWeekendsSwitcherCaption,values:{items:(0,l.Q_)(e,!0)}}}function k(e){const{feature:t,isOn:n,databaseType:o}=e;let i;return"timeline_arrows_by"===t?i=n?u.hideDependenciesInView:u.showDependenciesInView:"subitem"===t?i=n?u.hideSubitemsInView:u.showSubitemsInView:(0,a.t1)(t),{...i,values:{items:(0,l.Q_)(o,!0)}}}function I(e){const t={numDependenciesUpdated:e.result.numDependenciesUpdated,item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)};return e.result.numCouldNotUpdateDueToPermissions>0?e.result.numDependenciesUpdated>0?{message:{...u.dateShiftSomeNotUpdatedDueToPermissions,values:t},canUndo:!0}:{message:{...u.dateShiftAllNotUpdatedDueToPermissions,values:{}},canUndo:!1}:e.result.numDependenciesUpdated>0?{message:{...u.dateShiftSuccess,values:t},canUndo:!0}:void 0}},29376:(e,t,n)=>{n.d(t,{BI:()=>y,DB:()=>B,KV:()=>g,Mu:()=>f,NA:()=>M,ND:()=>P,OP:()=>h,Pi:()=>v,U1:()=>C,ZI:()=>x,aI:()=>k,gO:()=>D,gZ:()=>S,ke:()=>A,m8:()=>I,ny:()=>_,pR:()=>b,rj:()=>w,uJ:()=>R});n(57658);var o=n(99036),i=n(95200),r=n(77657),a=n(6695),s=n(42875),l=n(22808),c=n(59753),d=n(97880),u=n(51592),p=n(26136),m=(n(65742),n(78316));const f=32;function g(e,t){return e.normalizedSchemaStore.state[t]}function h(e,t,n){const i=g(e,t);if(!i||"relation"!==i.type||!i.property)return!1;const r=e.collectionStore(),a=n.getSchema();return o.$u({propertySchema:i,sourceCollectionId:null==r?void 0:r.id,property:t,targetCollectionSchema:a})}function v(e){const t=(0,d.qP)(e).find((e=>{let[t,n]=e;if(n&&(0,o.NK)(n))return n.connectedRelation.integration_id===r.U9}));if(t&&t[1]&&(0,o.NK)(t[1]))return t[1]}function b(e){return Boolean(v(e))}function y(e,t){if(!e)return!1;const n=e[t];return Boolean(n&&(0,o.NK)(n)&&n.connectedRelation.integration_id===r.U9)}function _(e,t){if("relation"!==(null==t?void 0:t.type))return;const n=null==t?void 0:t.collection_pointer,o=e.collectionViewBlockStore();return n&&o?p.NW.createChildStore(o,n):void 0}function S(e){return m.eD({collectionStore:e,collectionViewBlockStore:e.getParentBlockStore(),checkNavigableAncestorLocked:!1})}function w(e){const{inverseName:t,collectionStore:n,propertySchema:o,intl:i,targetCollectionStore:r,from:a}=e;return t||(n.isDefined()&&o?k(i,{sourceCollection:n.getModel(),isSelfRelation:n.id===r.id,targetCollectionStore:r,createUnique:!0,from:a}):"")}function k(e,t){var n;const{sourceCollection:o,isSelfRelation:r,targetCollectionStore:a,createUnique:d,from:p}=t,m=c.kk.fromCollection(o),f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=null===(n=m.getRenderIcon({}))||void 0===n?void 0:n.icon,h=m.getRenderTitle({getRecordModel:a.getRecordModel,userTimeZone:(0,s.r)(),intl:e})||f,v=m.getDatabaseType();let b;if(r)if("subitem"===p){const t=(0,u.sN)(v,!0);b=e.formatMessage({defaultMessage:"Parent {item}",id:"relationHelpers.autoSelfRelationInverseToggle.typedName"},{item:t})}else b="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocked by",id:"relationHelpers.autoSelfRelationInverseArrow.name"},{sourceCollectionName:h}):e.formatMessage({defaultMessage:"Related back to {sourceCollectionName}",id:"relationHelpers.autoSelfRelationInverse.name"},{sourceCollectionName:h});else b=g&&(0,l.Z)(g)?e.formatMessage({defaultMessage:"{sourceCollectionIcon} {sourceCollectionName}",id:"relationHelpers.autoInverseRelationWithIcon.name"},{sourceCollectionIcon:g,sourceCollectionName:h}):e.formatMessage({defaultMessage:"{sourceCollectionName}",id:"relationHelpers.autoInverseRelationSimple.name"},{sourceCollectionName:h});const y=a.getSchema();return y&&d?(0,i.Z)(b,(e=>!Object.values(y).find((t=>Boolean(t&&t.name===e))))):b}function I(e,t){var n,o;const{targetCollectionStore:r,isSelfRelation:a,sourceSchema:c,createUnique:d,from:p}=t,m=null===(n=r.getModel())||void 0===n||null===(n=n.getRenderIcon({}))||void 0===n?void 0:n.icon,f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=(null===(o=r.getModel())||void 0===o?void 0:o.getRenderTitle({getRecordModel:r.getRecordModel,userTimeZone:(0,s.r)(),intl:e}))||f,h=r.getDatabaseType();let v;if(a)if("subitem"===p){const t=(0,u.sN)(h,!0);v=e.formatMessage({defaultMessage:"Sub-{item}",id:"relationHelpers.autoSelfRelationNest.typedName"},{item:t})}else v="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocking",id:"relationHelpers.autoSelfRelationTimelineArrow.name"},{targetCollectionName:g}):e.formatMessage({defaultMessage:"Related {targetCollectionName}",id:"relationHelpers.autoSelfRelation.name"},{targetCollectionName:g});else v=m&&(0,l.Z)(m)?e.formatMessage({defaultMessage:"{targetCollectionIcon} {targetCollectionName}",id:"relationHelpers.autoRelationWithIcon.name"},{targetCollectionIcon:m,targetCollectionName:g}):e.formatMessage({defaultMessage:"{targetCollectionName}",id:"relationHelpers.autoRelation.name"},{targetCollectionName:g});const b=Object.values(c);return d?(0,i.Z)(v,(e=>!b.find((t=>Boolean(t&&t.name===e))))):v}function x(e){const t=a.iB(e.getFormat(),e.getSchema(),void 0,a.j5.Relation);return t?t.collection_relation_options??{}:{}}function C(e){var t;const{collectionStore:n,property:o}=e;return(null===(t=x(n)[o])||void 0===t?void 0:t.related_properties)??[]}function T(e,t){return Object.entries(t).map((n=>{let[i,r]=n;if(!r||!(0,o.p_)(r))return;const a=(0,o.j0)(r),s=e.collectionStore();if(!a||a.id!==(null==s?void 0:s.pointer.id)||!s||!h(e,i,s))return;const l=r.property;if(!l)return;const c=t[l];if(!c||"relation"!==c.type)return;const d=(0,o.j0)(c);return d&&d.id===(null==s?void 0:s.pointer.id)?{propertyID:i,inversePropertyID:l}:void 0})).filter(d.$K)}function M(e,t){return T(e,t).map((e=>e.propertyID))}function P(e,t){const n=T(e,t),o=new Set,i=[];for(const{propertyID:r,inversePropertyID:a}of n)o.has(r)||o.has(a)||(i.push([r,a]),o.add(r),o.add(a));return i}function A(e,t){const n=(0,o.j0)(e);if(!n)return;const i=p.NW.createChildStore(t,n);return i?null==i?void 0:i.getFormat().app_config_uri:void 0}function R(e,t){const n=(0,o.j0)(e);if(!n)return;const i=p.NW.createChildStore(t,n);return i?null==i?void 0:i.getSchema():void 0}function D(e,t){const n=(0,o.j0)(e);if(!n)return;const i=p.NW.createChildStore(t,n);return i||void 0}function B(e){var t;if(e.patternName)return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((t=>{var n;return t.name===e.patternName&&(null===(n=t.additional_types)||void 0===n?void 0:n.connectedRelation)})).find((t=>{let{regex:n}=t;return new RegExp(n).test(e.url)}))}},77546:(e,t,n)=>{n.d(t,{Ez:()=>p,Gf:()=>g,Oc:()=>c,SD:()=>r,VW:()=>a,Wr:()=>d,eA:()=>f,hI:()=>l,xH:()=>s});n(57658);var o=n(69454);const i={auto:!0,scroll:!0};function r(e){return e&&e instanceof HTMLElement?e:e&&e.parentElement?e.parentElement:void 0}function a(e){const t=r(e);if(t)return m(t,"vertical")}function s(e){const t=r(e);if(t)return m(t,"horizontal")}function l(e){let t=e;const n=[];do{const e=window.getComputedStyle(t);e&&(e.overflow&&i[e.overflow]||e.overflowY&&i[e.overflowY]||e.overflowX&&i[e.overflowX])&&n.push(t),t=t.parentElement}while(t);return n}function c(e){const{el:t,windowHeight:n}=e,i=e.minEdgeDist??8,r=a(t);if(!r||!r.getBoundingClientRect)return;const s=t.getBoundingClientRect(),l=r.getBoundingClientRect(),c=n-o.Z.estimatedNativeWebBottomOverlap(),d=Math.min(l.bottom,c);s.top<l.top?r.scrollTop=r.scrollTop-(l.top-s.top)-i:s.bottom>d&&(r.scrollTop=r.scrollTop+(s.bottom-d)+i)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{edgeDist:0,animate:!1};const n=a(e),{animate:o,edgeDist:i}=t;if(!n||!n.getBoundingClientRect)return;const r=e.getBoundingClientRect(),s=n.getBoundingClientRect();if(o){const e=500,t=n.scrollTop-(s.top-r.top)-i,o=n.scrollTop,a=t-o,l=16;let c=0;const d=()=>{var t,i,r;c+=l,n.scrollTop=(t=c,i=o,r=a,(t/=e/2)<1?r/2*t*t+i:-r/2*(--t*(t-2)-1)+i),c<e&&requestAnimationFrame(d)};d()}else n.scrollTop=n.scrollTop-(s.top-r.top)-i}function u(e){return e&&e.overflowY&&i[e.overflowY]}function p(e){if(!e)return;let t=e;if(t)do{const e=t.parentElement&&window.getComputedStyle(t.parentElement);if(e&&u(e))return t;t=t.parentElement||void 0}while(t);return document.body}function m(e,t){if(!e)return;let n=e;if(n)do{const e=window.getComputedStyle(n);if(n.classList&&n.classList.contains("notion-scroller")&&n.classList.contains(t)||u(e))return n;n=n.parentElement||void 0}while(n);return document.body}function f(e){return e.device.isDesktop&&!e.device.isSafari}function g(e){return e.device.isDesktop}},45010:(e,t,n)=>{n.d(t,{Z:()=>o});const o={}},59139:(e,t,n)=>{n.d(t,{Qi:()=>l,XP:()=>r,bN:()=>s,rd:()=>a});var o=n(77080),i=n(55320);function r(){return!1}function a(e){return"on"===o.default.getGroup("search-intent-based-grouping-n-side-peek")||s(e)}function s(e){return"quickSearch"===e.RouterStore.state.route.name}function l(e){if(e.device.isMobile)return!1;const t=e.currentUser.id;if(!a(e)||!t)return!1;return!o.default.checkGate("search_toggle_side_peek")||i.default.state.preferSidePeekOpen}},97638:(e,t,n)=>{n.d(t,{AX:()=>z,De:()=>w,FN:()=>k,IV:()=>U,MQ:()=>N,MS:()=>R,Nu:()=>j,VA:()=>I,VD:()=>S,YB:()=>F,_Q:()=>M,b9:()=>E,bC:()=>O,dy:()=>W,g8:()=>L,gC:()=>A,oO:()=>Z,p6:()=>x,pG:()=>V,uL:()=>B,zD:()=>P});n(57658);var o=n(40506),i=n(7057),r=n(53877),a=n(42875),s=n(72126),l=n(21202),c=n(92338),d=n(9291),u=n(54642),p=n(80444),m=n(46735),f=n(43250),g=n(98165),h=n(67669),v=n(15447);function b(e){return Boolean(e&&e.length>0)}function y(e){return Boolean(e.starting||e.ending)}function _(e){return Boolean(e)}const S={requireEditPermissions:_,isDeletedOnly:_,excludeTemplates:_,navigableBlockContentOnly:_,ancestors:b,parentId:function(e){return void 0!==e},createdBy:b,editedBy:b,lastEditedTime:y,createdTime:y,isAdminModeDeletedPageSearch:_,blockTypes:function(e){return Boolean(e&&e.length>0)},inTeams:function(e){return b(c.iY(e))},includePublicPagesWithoutExplicitAccess:_,audience:function(e){return Boolean(e)},dev_excludedPages:b,dev_excludedTeams:b,databaseType:b};function w(e){return e?{requireEditPermissions:S.requireEditPermissions(e.requireEditPermissions),isDeletedOnly:S.isDeletedOnly(e.isDeletedOnly),excludeTemplates:S.excludeTemplates(e.excludeTemplates),navigableBlockContentOnly:S.navigableBlockContentOnly(e.navigableBlockContentOnly),ancestors:S.ancestors(e.ancestors),parentId:S.parentId(e.parentId),createdBy:S.createdBy(e.createdBy),editedBy:S.editedBy(e.editedBy),createdTime:S.createdTime(e.createdTime),lastEditedTime:S.lastEditedTime(e.lastEditedTime),blockTypes:S.blockTypes(e.blockTypes),inTeams:S.inTeams(e.inTeams),dev_excludedPages:S.dev_excludedPages(e.dev_excludedPages),dev_excludedTeams:S.dev_excludedTeams(e.dev_excludedTeams)}:{requireEditPermissions:!1,isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,ancestors:!1,parentId:!1,createdBy:!1,editedBy:!1,createdTime:!1,lastEditedTime:!1,blockTypes:!1,inTeams:!1,dev_excludedPages:!1,dev_excludedTeams:!1}}function k(e){const t=w(e);return Object.values(t).some((e=>Boolean(e)))}function I(e){const t=w(e),{navigableBlockContentOnly:n,...o}=t;return Object.values(o).some((e=>Boolean(e)))}function x(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.sF;const a=r.OQ.notionDateToLuxon(e,{locale:t.locale});return(0,i.Cp)(a,n)}function C(e,t){const n=r.OQ.notionDateTimeToLuxon(e,t.locale);return(0,i.ZW)(n,"medium_with_time")}const T=(0,d.defineMessages)({startAndEnd:{defaultMessage:"{startDate} - {endDate}",id:"searchHelpers.betweenStartAndEndDates"},afterStart:{defaultMessage:"After {startDate}",id:"searchHelpers.afterStartDate"},beforeEnd:{defaultMessage:"Before {endDate}",id:"searchHelpers.beforeEndDate"}});function M(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.sF,i="",r="";return e.starting&&(i="date"===e.starting.type?x(e.starting,t,n):C(e.starting,t)),e.ending&&(r="date"===e.ending.type?x(e.ending,t,n):C(e.ending,t)),i&&r?t.formatMessage(T.startAndEnd,{startDate:i,endDate:r}):i?t.formatMessage(T.afterStart,{startDate:i}):t.formatMessage(T.beforeEnd,{endDate:r})}function P(e){return Boolean(e.target&&e.target instanceof HTMLElement&&e.target.classList.contains("rdp-day"))}function A(e){const{input:t,spaceId:n,publicAccessPermissionAncestorBlockId:o,searchSessionId:i,searchSessionFlowNumber:r,source:a,forcedClusterPattern:s,searchExperimentOverrides:l,recentPagesForBoosting:d,forcedBlockIds:u,excludedBlockIds:p}=e,{query:m,limit:f,debug:g}=t;return n?{type:c.n8.BlocksInSpace,query:m.text.trim(),spaceId:n,limit:f,filters:m.filters,sort:m.sort,source:a||"quick_find",debug:g,searchExperimentOverrides:l,searchSessionId:i,searchSessionFlowNumber:r,forcedClusterPattern:s,recentPagesForBoosting:(0,v.Wk)(d),forcedBlockIds:u,excludedBlockIds:p}:o?{type:c.n8.BlocksInAncestor,query:m.text.trim(),ancestorId:o,filters:m.filters,sort:m.sort,limit:f,source:a||"quick_find_public",debug:g,searchExperimentOverrides:l,searchSessionId:i,searchSessionFlowNumber:r,forcedClusterPattern:s,forcedBlockIds:u,excludedBlockIds:p}:void 0}function R(e){const{environment:t}=e,n=A(e);return!!n&&u.search(t,n)}class D{constructor(e){this.startingTimestamp=void 0,this.endingTimestamp=void 0,this.startingTimestamp=e.starting&&r.uO(e.starting,(0,a.r)()),this.endingTimestamp=e.ending&&r.uO(e.ending,(0,a.r)())}matches(e){return void 0!==e&&(!(void 0!==this.startingTimestamp&&e<this.startingTimestamp)&&!(void 0!==this.endingTimestamp&&e>this.endingTimestamp))}}class B{constructor(e){this.filters=void 0,this.activeFilters=void 0,this.ancestorFilterIds=void 0,this.parentFilterId=void 0,this.createdTimeMatcher=void 0,this.lastEditedTimeMatcher=void 0,this.teamFilterIds=void 0,this.dev_notInTeamFilterIds=void 0,this.dev_notInPagesFilterIds=void 0,this.filters=e,this.activeFilters=w(e),this.ancestorFilterIds=new Set(e.ancestors),this.parentFilterId=e.parentId,this.createdTimeMatcher=new D(e.createdTime),this.lastEditedTimeMatcher=new D(e.lastEditedTime),this.teamFilterIds=new Set(c.iY(e.inTeams)??[]),this.dev_notInTeamFilterIds=new Set(e.dev_excludedTeams),this.dev_notInPagesFilterIds=new Set(e.dev_excludedPages)}matches(e){let{blockModel:t,path:n}=e;if(!Boolean(this.activeFilters.isDeletedOnly)!==t.alive)return!1;if(this.activeFilters.excludeTemplates&&t.is_template)return!1;if(this.activeFilters.editedBy){const e=t.last_edited_by_id||t.last_edited_by;if(!e||!this.filters.editedBy.includes(e))return!1}if(this.activeFilters.createdBy){const e=t.created_by_id||t.created_by;if(!e||!this.filters.createdBy.includes(e))return!1}if(this.activeFilters.ancestors&&!n.some((e=>{let{value:t}=e;return this.ancestorFilterIds.has(t.id)})))return!1;if(this.activeFilters.parentId){if(n.length<2)return!1;const[e,{value:{id:t}}]=n;return this.parentFilterId===t}if(this.activeFilters.lastEditedTime&&!this.lastEditedTimeMatcher.matches(t.last_edited_time))return!1;if(this.activeFilters.createdTime&&!this.createdTimeMatcher.matches(t.created_time))return!1;if(this.activeFilters.inTeams){var o;const e=g.KU(n),t=null==e||null===(o=e.value)||void 0===o?void 0:o.id;if(!t||!this.teamFilterIds.has(t))return!1}return!0}}function E(e){if(e&&!e.error)return e.value}function F(e){let{sort:t,unsorted:n,batchSize:o,currentUserId:i}=e;const r=Date.now();if("relevance"!==t.field)return n;const a=s.yo(n,o).map((e=>m.Z.sortFrecencyHighToLow({items:e,now:r,currentUserId:i,recordFrecency:!0})));return s.xH(a)}function Z(e){const{localResults:t,serverResults:n}=e;if(t||n){if(t&&n){const e=new Set(t.map((e=>e.id)));function o(e){return(null==e?void 0:e.sources)??[]}return t.map((e=>{const t=(i=e.id,null==n?void 0:n.find((e=>e.id===i)));var i;const r=(null==(a=t)?void 0:a.originalPosition)??e.originalPosition;var a;const s=[...new Set([...e.badges??[],...(null==t?void 0:t.badges)??[]])];return{...e,originalPosition:r,serverEventProperties:(null==t?void 0:t.serverEventProperties)??e.serverEventProperties,sources:[...e.sources,...o(t)],badges:s}})).concat(n.filter((t=>!e.has(t.id))))}return t??n}}function V(e){var t,n,o,i;const{focusedIndexStore:r,searchActionsStore:a,searchResultStore:s}=e,l=Z({localResults:null===(t=s.state.localResults)||void 0===t?void 0:t.results,serverResults:null===(n=s.state.serverResults)||void 0===n?void 0:n.results}),c=null===(o=r.state)||void 0===o?void 0:o.global,d=null===(i=r.state)||void 0===i?void 0:i.local;if(void 0===c||void 0===d)return;const u=a.state.length,p=c<u&&a.state[c];if(p&&"assistant"===p.type)return{type:p.type};const m=c-u;if(!l||l.length<=0||m<0)return;const f=l[m];return f?{type:"page_result",value:{index:{global:c,local:d},selectedResult:f,allSearchResults:l}}:void 0}function j(e){const{existingResults:t,newPageResults:n}=e;if(void 0!==t||void 0!==n){if(t&&n){const e=[...t.results],o=new Set(t.results.map((e=>e.id)));return e.push(...n.results.filter((e=>!(e.sources.includes(c.vp.ElasticsearchRandom)&&e.originalPosition<t.results.length)&&!o.has(e.id)))),{...n,results:e,total:n.total}}return t??n}}function U(e){const{intentBasedGrouping:t,localResults:n,serverResults:o}=e,i=Z({localResults:n,serverResults:o})??[],r=i.filter((e=>e.sources.includes(c.vp.ElasticsearchUniqueID))),a=i.filter((e=>!e.sources.includes(c.vp.ElasticsearchUniqueID)));return t?{type:"intent-based-grouping",sections:{uniqueIdSearchResults:r,jumpBackInSearchResults:a.filter((e=>e.sources.includes(c.vp.Local))),serverOnlySearchResults:a.filter((e=>!e.sources.includes(c.vp.Local)))},allSearchResults:i}:r.length>0?{type:"unique-id",sections:{uniqueIdSearchResults:r,nonUniqueIdSearchResults:a},allSearchResults:i}:{type:"all",sections:{allSearchResults:i},allSearchResults:i}}function L(e,t,n){const o=n??(e.device.isMobile?2:3);return t.slice(0,o)}function O(e){const{mainEditorCurrentBlockStore:t}=p.default.state,n=t&&h.IJ(e,t);return{hasPublicAccessPermission:Boolean(n),publicAccessPermissionAncestorBlockId:(null==n?void 0:n.from.table)===l.iU?null==n?void 0:n.from.blockId:void 0}}function N(e){let{environment:t,searchResultsSection:n,modalBodyMenu:o,searchFilterMenu:i,actionItemCount:r}=e;if(!n)return 0;let a=0;if(t.device.isMobile){const e=null==o?void 0:o.getNode(),t=null==i?void 0:i.getNode();if(e instanceof Element&&t instanceof Element){const n=e.getElementsByClassName(f.GZn)[0];n instanceof Element&&(a=n.clientHeight-t.clientHeight+n.scrollTop)}}else a=n.getBoundingClientRect().height+n.scrollTop;let s=0,l=0;const c=n.getElementsByClassName(f.Xjk);for(let u=0;u<c.length;u++){l+=c[u].clientHeight}const d=n.getElementsByClassName(f.ulv);for(let u=0;u<d.length;u++){const e=d[u];if(!(a-l>e.clientHeight/2))break;s+=1,l+=e.clientHeight}return s-r}function z(e){if(void 0===e)return[];return e.map((e=>({id:e.id,score:e.score,sources:e.sources,spaceId:e.spaceId})))}function W(e){var t;if(void 0!==(null==e?void 0:e.highlightBlockId)&&void 0===(null===(t=e.highlight)||void 0===t?void 0:t.title))return e.highlightBlockId}},69645:(e,t,n)=>{n.d(t,{Bj:()=>h,D_:()=>_,Ib:()=>g,XL:()=>y,dq:()=>v,kC:()=>b,v5:()=>f});n(57658);var o=n(55010),i=n(45060),r=n(21202),a=n(95371),s=n(374),l=n(97880),c=n(94419),d=n(95802),u=n(27724),p=n(28020),m=n(62619);function f(e,t){return(0,a.DY)(t,(t=>t.value.store===e))}function g(e,t){const n=f(e,[t]);if(n&&n.length>0)return n[n.length-1]}function h(e){const t=e.container??u.default.getCurrentDefaultContainer();if(!t)return new a.DG([]);const n=[];d.C.forEach((o=>{const i=o.getNode(),r=o.props.store;if(!i)return;if(o.getContextSelectableContainer()!==t)return;(o.props.canSelect||e.includeNonSelectableListContainer&&o.props.isListContainer)&&n.push({node:i,store:r,component:o})}));var i;return(i=n,(0,a.Yc)({values:i,compareOrder:(e,t)=>(0,o.Z)(e.node,t.node),isAncestor:(e,t)=>m.r3(e.node,t.node)}))||new a.DG([])}function v(e){const t=e.root||(0,p.RM)();if(t){const n=h(e);return new a.mp({store:t,node:void 0,component:void 0},n.children)}}function b(e){const{rootStore:t,root:n,target:o}=e,i=(0,a.DY)(n.children,(e=>e===o));if(void 0===i)return;const r=[t];let s=t;for(const a of i){const e=a.value.store;if(!e)return;const t=s.getTransclusionReferenceTargetStore()??s;let n=t.getContentStores();const o=t.getAutomationStore();if(o){const e=o.getActionStores();n=n.concat(e.flatMap((e=>e.getBlockStores())))}const i=n.find((t=>t.id===e.id));if(!i)return;r.push(i),s=i}return r}function y(e){var t;const{treeOperation:n,deleteFrom:o}=e,i=[],a=null===(t=n.deleteFromParent.value.store)||void 0===t?void 0:t.getContentStore(),s=n.deletingChildren.map((e=>e.value.store)).filter(l.$K);for(const l of s){const e=l.getRecordStoreUIParent(),t=e&&e.table===r.iU&&1===e.path.length&&"content"===e.path[0]&&e,n="record-store-parent"===o&&t||a;n&&i.push({parent:n,childToRemove:l})}return i}function _(e){const{transaction:t,treeOperation:n,deleteFrom:o,observer:i}=e;switch(n.operation){case"delete":return void y({treeOperation:n,deleteFrom:o}).forEach((e=>{let{parent:o,childToRemove:r}=e;const a={parent:o,childToRemove:r,transaction:t};c.Od(a),null==i||i.onRemove(n,a)}));case"insert":{var r,a;const e=null===(r=n.insertIntoParent.value.store)||void 0===r?void 0:r.getContentStore(),o=null===(a=n.adjacentSibling)||void 0===a?void 0:a.value.store,i=n.insertChildren.map((e=>e.value.store));("listAfter"===n.direction&&o||"listBefore"===n.direction&&!o)&&i.reverse();for(const r of i)if(e&&r)if("listAfter"===n.direction){const n={insert:r,parent:e,transaction:t,after:o};c.BE(n)}else{const n={insert:r,parent:e,transaction:t,before:o};c.Vt(n)}return}case"move":for(const e of(0,s.Z)(n))_({transaction:t,treeOperation:e,deleteFrom:o,observer:void 0});return void(null==i||i.onMove(n));default:(0,l.t1)(n)}}!function(){const{span:e,object:t,div:n,CONTAINER_STYLE:o}=i.TI;(0,i.Rw)({canFormat:e=>Boolean(e&&e instanceof a.mp),header:(i,r)=>e(o,e({},t(i,{useDefaultFormatter:!0})),n({},t(i.value.store)),i.children.length?n({},t(i.children)):void 0),hasBody:(e,t)=>!1,body:e=>null})}()},73959:(e,t,n)=>{n.d(t,{J2:()=>m,Mn:()=>u,iZ:()=>h,mh:()=>f,sQ:()=>p,sY:()=>v,x7:()=>g});var o=n(41432),i=n(41662),r=n(80444),a=n(55367),s=n(88923),l=n(26136),c=n(27724),d=n(98165);function u(e){return!e.isPhone}function p(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&e instanceof l.G)return e;let n=e;for(;;){if(n=n.getRecordStoreUIParent(),!n)return;if(n&&n instanceof l.G&&n!==e)return n}}function m(e){const t=p(e);if(t)return d.Dg(t)}function f(e){const t=e.getType(),n=e.getModel(),r=e.getProperties();if(t&&n)return t&&(0,o.XD)(t)&&"factory"!==t&&!(0,o.S9)(t)?e.getBlockTitleStore():n.isInlineCollectionView()?e.getTitleStore():n.isType(o.oe)&&r&&r.caption?e.getCaptionStore():t===o.Ti.table?i.g$.getCellTextStore({simpleTableStore:e,rowIndex:0,columnIndex:0}):void 0}function g(e){const t=p(e);if(t)return t&&(t===r.default.state.mainEditorCurrentBlockStore||s.default.state.open&&t===s.default.state.target)}function h(e){const{stores:t,phase:n}=c.default.state;return 1===t.length&&t[0]===e&&n===c.SelectionPhase.Editing}function v(e){const{stores:t,phase:n}=c.default.state,o=new Set(t.map((e=>e.id))),i=d.qA(e),r=o.has(e.id),s=i.some((e=>o.has(e.id))),l=r||s;return!(n!==c.SelectionPhase.Selected||!l||a.ZP.state.isDragging)}},89014:(e,t,n)=>{n.d(t,{u:()=>r,x:()=>i});const o=new Map;function i(e){return o.get(e)}function r(e,t){o.set(e,t)}},41984:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(6287);const i=function(e){return!(e.getParentTable()===o.v)||e.isTemplate()}},28187:(e,t,n)=>{n.d(t,{F6:()=>m,Jk:()=>d,SG:()=>p,kC:()=>f});n(57658);var o=n(77657),i=n(63787),r=n(90965),a=(n(95477),n(80444)),s=n(77080),l=n(26136),c=n(98165);const d=function(e){const t=c.qA(e),n=[];for(const o of t)"block"===o.table&&n.push({blockStore:o,slackIntegrationStore:(0,l.Kv)(e,{table:i.s,id:o.id})});for(const{blockStore:o,slackIntegrationStore:i}of n)if(i.isReady()){if(i.getKeyStore("enabled").getValue())return{blockStore:o,slackIntegrationStore:i}}return{blockStore:e,slackIntegrationStore:(0,l.Kv)(e,{table:i.s,id:e.id})}};function u(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getBotSettingsStore().getValue();return(0,r.hU)({spaceBotSettings:t,integrationId:o.nO,env:"production"})}function p(){return s.default.checkGate("legacy_slack_notifications")}function m(){return!!u()&&"on"===s.default.getGroup("notion-to-slack")}function f(){return!!u()&&"on"===s.default.getGroup("notion-mentions-to-slack")}},38755:(e,t,n)=>{n.d(t,{$U:()=>ge,C:()=>se,CV:()=>ne,Cx:()=>te,Fn:()=>ae,G$:()=>L,Ib:()=>ue,KA:()=>q,MC:()=>N,Q6:()=>fe,Q9:()=>ce,TC:()=>re,Wd:()=>K,XD:()=>Y,cD:()=>pe,cJ:()=>J,di:()=>oe,g4:()=>ee,iX:()=>H,j9:()=>le,jv:()=>$,k0:()=>z,kt:()=>me,lQ:()=>ie,ns:()=>Q,rg:()=>U,rn:()=>G,w3:()=>X,ww:()=>de});n(21703);var o=n(14577),i=n(15145),r=n(44317),a=n(72126),s=n(62193),l=n(21202),c=n(15047),d=n(77858),u=n(19889),p=n(66079),m=n(28182),f=n(9852),g=n(90965),h=n(97880),v=n(3297),b=n(94273),y=n(40277),_=n(12321),S=n(65452),w=n(95477),k=n(94841),I=n(88310),x=n(80444),C=n(92425),T=n(77080),M=n(81236),P=n(26136),A=n(13105),R=n(29226),D=n(88893),B=n(84210),E=n(33929),F=n(98165),Z=n(67669),V=n(65598),j=n(95697);async function U(e,t){return(await async function(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(await t.load(),o&&n){var i;t.hasRemoteSharedPages()||await S.l({environment:e,spaceId:o.id,userId:n});const r=C.Z.getSharedPagesState({spaceId:o.id,userId:n}),a=(r&&r.currentPageIds?r.currentPageIds:[]).map((e=>P.G.createChildStore(o,{table:l.iU,id:e,spaceId:o.id})));await Promise.all([o.load(),Promise.all(t.getBookmarkedPageStores().map((e=>e.load()))),Promise.all(Y(e,o).map((e=>e.load()))),Promise.all(t.getSharedPageStores().map((e=>e.load()))),Promise.all(a.map((e=>e.load())))]);return[...t.getBookmarkedPages(),...t.getWorkspacePages(),...q(e,t),...t.getPrivatePages(e),...(null===(i=t.getTeamsStores())||void 0===i||null===(i=i[0])||void 0===i?void 0:i.getTeamPageStores())||[],...a].filter((t=>!(0,Z.IJ)(e,t)))}}(e,t)??[])[0]}const L=7,O=new s.Uw;function N(e){return O.memo((()=>new o.Z((()=>z(e)),{debugName:"sharedPageContextStore"})),[e.environment,e.spaceViewStore,e.userSettingsStore])}function z(e){const{environment:t,spaceViewStore:n,userSettingsStore:o}=e,i=n.getSpaceId(),r=q(t,n),a=new Set(r.map((e=>{let{id:t}=e;return t})));if(!i)return{allSharedPagesStores:r,visibleSharedPagesStores:r};if(!o.hasUserPinnedToOutliner({type:"shared",spaceId:i}))return{allSharedPagesStores:r,visibleSharedPagesStores:r.slice(0,L)};return{allSharedPagesStores:r,visibleSharedPagesStores:n.getPinnedSharedPages().filter((e=>{let{id:t}=e;return a.has(t)}))}}const W=new s.Uw;function q(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(o&&n){const i=C.Z.getSharedPagesState({spaceId:o.id,userId:n}),r=i&&i.currentPageIds?i.currentPageIds:[],s=W.memo((()=>function(e,t){return new A.P({debugName:"isValidSharedRemotePage",memoizeRecursion:!1,deepEquals:!1,compute:function(n){if(!e.currentUser.id)return!1;const o=(0,F.u3)(n);let i=!1;return o&&((0,V.OY)(o)?i=!(0,j.bq)()&&e.currentUser.id&&t.isDefined()&&n.hasSpacePermission()?(0,g.kC)(t.getPermissionItems(),e.currentUser.id):o.id!==n.id&&o.canRead():(0,V.Y)(o)&&(i=(0,j.zz)({teamStore:o,spaceStore:t,userId:e.currentUser.id})&&o.canRead())),!(!((0,V.Oh)(n)&&n.canRead()&&n.isNavigableBlock()&&n.isSharedPage(t,e))||(0,F.wf)(n)||i)}})}(e,o)),[e,o]),c=a.oA(r.map((e=>{const t=P.G.createChildStore(o.getPagesStore(),{table:l.iU,id:e,spaceId:o.id});if(s.getStateFor(t))return t}))),d=new Set(c.map((e=>e.id)));let u;const p=t.getSharedPageStores(),m=0===p.length;if(m){u=Y(e,o).filter((e=>{d.has(e.id)}))}else u=p.filter((e=>!(0,F.wf)(e)&&d.has(e.id)));(0,I.As)({use_legacy_shared_pages_ordering:m&&u.length>0});const f=[...u,...c];return a.mN(f,(e=>e.id))}return[]}async function H(e){const{disableRedirectUrl:t,environment:n}=e;await _.w();const{id:o}=n.currentUser,{url:r,spaceId:s,route:l}=await b.Ie(n),c=s?X(s):void 0,d=function(e){const{environment:t,lastVisitedUrl:n,lastVisitedSpaceView:o}=e,r=ee(t,o);switch(r){case"last_visited_page":return n?{url:n,isPersonalHomeUrl:!1}:void 0;case"first_page":return;case"personal_home":if(!o)return;const e=k.Al(o);if(!e)return;return{url:(0,B.ZP)({store:e,preferPublicLink:!1,pageVisitSource:i.tY.DefaultHome}),isPersonalHomeUrl:!0};default:(0,h.t1)(r)}}({environment:n,lastVisitedUrl:r,lastVisitedSpaceView:c}),g=null==d?void 0:d.url,S=v.qd(o),w=y.th(o),I=f.getOauthAuthorizationParams();if(!o)throw new Error("User not logged in.");const x=new P.U6(n,{table:u.KJ,id:o}),C=new P.r9(n,{table:p.dx,id:o}),T=new P.vO(n,{table:m.Sr,id:o}),[M,A]=await Promise.all([x.awaitNonNullValue(),C.awaitNonNullValue(),T.awaitNonNullValue()]),R=!!M&&Boolean(M.onboarding_completed),D=!!M&&Boolean(M.mobile_onboarding_completed),E=function(e,t){const n=(0,p.ao)(e);return n&&n.length>0?P.V9.createChildStore(t,n[0]):void 0}(A,C);E&&await E.load();const F=E?E.getSpaceStore():void 0;if(l&&!t){const e=await y.Jv({environment:n,request:{type:"block-space",...l}}).next();if(e.value){const t=e.value,n="page"===l.name?l.blockId:void 0,o=["read_and_write","comment_only","reader"].includes(t.publicAccessRole);if(t&&!a.xb(t)&&(t.canJoinSpace||t.userHasExplicitAccess||!o))return{userStore:x,userSettingsStore:T,userRootStore:C,firstSpace:F,firstSpaceView:E,lastVisitedSpaceView:c,redirectUrl:g,forkPageBlockId:S,publicAccessPageId:w,oauthAuthorizationParams:I,redirectPageId:n,hasExplicitAccessToRedirectPage:t.userHasExplicitAccess,redirectSpaceName:t.spaceName,redirectSpaceId:t.spaceId,canJoinRedirectSpace:t.canJoinSpace,onboardingCompleted:R,mobileOnboardingCompleted:D,isPersonalHomeRedirect:(null==d?void 0:d.isPersonalHomeUrl)??!1}}}return{userStore:x,userSettingsStore:T,userRootStore:C,firstSpace:F,firstSpaceView:E,lastVisitedSpaceView:c,forkPageBlockId:S,publicAccessPageId:w,oauthAuthorizationParams:I,redirectUrl:void 0,redirectPageId:void 0,hasExplicitAccessToRedirectPage:void 0,redirectSpaceId:void 0,canJoinRedirectSpace:void 0,onboardingCompleted:R,mobileOnboardingCompleted:D,redirectSpaceName:void 0,isPersonalHomeRedirect:!1}}function K(e,t){return P.t1.fromV1(t).getIcon()}function G(e,t){const n=t.getName(),o=E.default.getIntl().formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"});if(n)return n||o;{const n=M.Z.getPublicSpaceData(e,t.id);if(n)return n.name||o}return o}function $(e){return function(e){return(0,P.Vh)(e,{table:c.bx,id:e.id},"permissions")}(e).getValue()||[]}function Q(e,t){const n=e.currentUser.id,o=t.getPagesStore().getValue();if(o&&n){const e=R.Z.getSpaceInaccessiblePages(t.id,n);return e?o.filter((t=>!e.has(t))):o}return[]}function Y(e,t){const n=t.getPagesStore();return Q(e,t).map((e=>P.G.createChildStore(n,{table:l.iU,id:e})))}function J(e,t,n){const o=M.Z.getPublicSpaceData(e,t),i=!Boolean(null==o?void 0:o.domainIsAutogenerated),r=a.oA([i&&(null==o?void 0:o.domain),"invite",n]).join("/");return`${w.default.domainBaseUrl}/${r}`}function X(e){const{currentUserRootStore:t}=x.default.state;return null==t?void 0:t.getSpaceViewStores().find((t=>t.getSpaceId()===e))}function ee(e,t){var n,o;return null!==(n=e.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone()?"last_visited_page":(null==t||null===(o=t.getSettings())||void 0===o?void 0:o.on_app_start)||d.DB[0]}function te(e){return!!e&&!e.canRead()}function ne(e){return!!e&&e.getZeroRetentionEnabled()}function oe(e,t){const n=(0,D.CM)(t)||[],o=e.currentUser.id;for(const i of n)if(i.userId===o&&"none"===i.role&&i.isTeamGuest)return!0;return!1}function ie(e){return!!e&&e.canAdmin()}function re(e){let{spaceStore:t,groupId:n}=e;return((null==t?void 0:t.getPermissionGroups())||[]).find((e=>e.id===n))}function ae(e){const t=x.default.state.currentSpaceStore,n=e.currentUser.id;return!(null==t||!t.isDefined()||!n)&&(0,g.wv)({permissions:t.getPermissionItems()},n)}function se(){const e=x.default.state.currentSpaceStore;return!(null==e||!e.isDefined())&&"enterprise"===e.getSubscriptionTier()}function le(e){const t=e.getSubscriptionTier();return"plus"===t||"business"===t||"enterprise"===t}function ce(e){const t=function(e){const t=null==e?void 0:e.getCreatedTime();return t?(0,r.O5)(t):null}(e);return null!==t&&t<=7}function de(e){return(0,h.lm)(e)&&"none"!==e.role?e.planType:void 0}function ue(e){return(0,h.lm)(e)&&"none"!==e.role?e.createdTime:void 0}function pe(e){return(0,h.lm)(e)&&"none"!==e.role?e.subscriptionTier:void 0}function me(e){return T.default.checkGate("guest_invite_requests")&&(null==e?void 0:e.getEnableGuestInviteRequest())}function fe(e){return Boolean(me(e))&&!Boolean(null==e?void 0:e.canAdmin())}function ge(e){return e=(e=e.toLowerCase()).replace(/[^a-z0-9-]/g,"")}},16639:(e,t,n)=>{n.d(t,{N5:()=>p,kF:()=>c,kQ:()=>d,rm:()=>u});var o=n(72126),i=n(72141),r=n(19889),a=n(9291),s=n(20454);const l=(0,a.defineMessages)({untitledGroupName:{defaultMessage:"Untitled",id:"spaceBasicSettings.spacePermissionsSettings.groupsTab.defaultNewGroupName"}});function c(e){const{intl:t,group:n}=e;return n.name||t.formatMessage(l.untitledGroupName)}function d(e){const{group:t,spaceStore:n}=e,o=t.user_ids||[];if(!n)return[];const i=n.getPermissionItems();return o.filter((e=>Boolean(i.find((t=>"user_permission"===t.type&&t.user_id===e)))))}function u(e){const{group:t,spaceStore:n,limit:i}=e,a=d({group:t,spaceStore:n}),l=a.length;if(!n)return{countRemainingUsers:0,totalNumberMembers:l,limitedUserStores:[]};const c=i?a.slice(0,i):a;return{limitedUserStores:o.oA(a.map((e=>s.U.createChildStore(n,{table:r.KJ,id:e})))),countRemainingUsers:a.length-c.length,totalNumberMembers:l}}function p(e){let{userStores:t,spaceStore:n,intl:r}=e;return o.MR(t,(e=>e.getSearchName(r))).sort(((e,t)=>{var o,r;if(!n)return 0;const a=n.getPermissionItems(),s=null===(o=a.find((t=>"user_permission"===t.type&&t.user_id===e.id)))||void 0===o?void 0:o.role,l=null===(r=a.find((e=>"user_permission"===e.type&&e.user_id===t.id)))||void 0===r?void 0:r.role;return s&&l?i.Av.indexOf(l)-i.Av.indexOf(s):0}))}},15517:(e,t,n)=>{n.d(t,{ZL:()=>u,lr:()=>l,mn:()=>d,sK:()=>s});var o=n(68626),i=n(15157),r=n(63143),a=n(46735);async function s(){if("storage"in navigator&&"estimate"in navigator.storage){const{quota:e,usage:t}=await navigator.storage.estimate();if("number"==typeof e&&"number"==typeof t)return{quota:e,usage:t}}if("webkitPersistentStorage"in navigator){const e=navigator.webkitPersistentStorage;if("queryUsageAndQuota"in e)return new Promise((t=>{e.queryUsageAndQuota(((e,n)=>{t("number"==typeof n&&"number"==typeof e?{usage:e,quota:n}:void 0)}),(()=>t(void 0)))}))}}async function l(){if(navigator.storage&&navigator.storage.persist)try{const e=await navigator.storage.persist();return o.clientLogglyEnvironmentData.isPersistent=e,e}catch(e){console.trace("Persistence is disabled",e)}}const c=15*r.js;function d(e){const{quota:t,usage:n}=e;return n/t<=.9&&t>=c}function u(e){e?(a.Z.clearForUser(e),i.Z.clearStorageForUser(e)):localStorage.clear()}},75024:(e,t,n)=>{n.d(t,{Dp:()=>s,jy:()=>d,mK:()=>r,pd:()=>l,wK:()=>c,yv:()=>a});var o=n(97880),i=n(82990);const r={listStyleType:"none",padding:0,margin:0};i.Z.fontWeight.regular;function a(e,t){const n="UIRegular"===t?i.Z.fontSize.UIRegular:"UISmall"===t?i.Z.fontSize.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function s(e,t){const n="UIRegular"===t?i.Z.lineHeight.UIRegular:"UISmall"===t?i.Z.lineHeight.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function l(e){return{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:e}}function c(e){let{topLeft:t,topRight:n,bottomLeft:o,bottomRight:i}=e;return[t,n,i,o].map((e=>e?`${e}px`:"0")).join(" ")}const d={position:"absolute",overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)",whiteSpace:"nowrap",height:1,width:1}},52315:(e,t,n)=>{n.d(t,{b:()=>o,r:()=>i});const o=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.isReady())return!1;if(n[e.id])return!0;if(n[e.id]=!0,r(e,t))return!0;const i=e.getContentStores();let a=!0;for(const r of i)o(r,!1,n)||(a=!1);return a};async function i(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(await e.load(),n[e.id])return;if(n[e.id]=!0,r(e,t))return;const o=e.getContentStores();await Promise.all(o.map((e=>i(e,!1,n))))}function r(e,t){return!(!e.isPageBlock()||t)||!!e.isCollectionView()}},32363:(e,t,n)=>{n.d(t,{ni:()=>u,wY:()=>c});n(67294);var o=n(97880),i=n(44876),r=n(9291),a=n(30874),s=n(33929),l=n(85893);function c(e,t){const n=function(e,t){if(!e)return;const n=(0,i.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;return n.integration.name}(e),s=function(e,t){if(!e)return;const n=(0,i.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;if(!n.pattern.collectionItemType)return;switch(n.pattern.collectionItemType){case"project":return(0,l.jsx)(r.FormattedMessage,{defaultMessage:"Project",id:"syncedCollectionIndicators.project.label"});case"pull_request":return(0,l.jsx)(r.FormattedMessage,{defaultMessage:"Pull Requests",id:"syncedCollectionIndicators.pullRequests.label"});case"issue":return(0,l.jsx)(r.FormattedMessage,{defaultMessage:"Issues",id:"syncedCollectionIndicators.issues.label"});case"calendar":return(0,l.jsx)(r.FormattedMessage,{defaultMessage:"Calendar",id:"syncedCollectionIndicators.calendar.label"});case"release":return(0,l.jsx)(r.FormattedMessage,{defaultMessage:"Releases",id:"syncedCollectionIndicators.releases.label"});default:(0,o.t1)(n.pattern.collectionItemType)}}(e,t);return s?n?(0,l.jsx)(r.FormattedMessage,{id:"syncedCollectionIndicators.originalUrlWithIntegration",defaultMessage:"{collectionType} in {integrationName}",values:{integrationName:n,collectionType:s}}):(0,l.jsx)("span",{children:n}):(0,l.jsx)(r.FormattedMessage,{defaultMessage:"Link to original url",id:"syncedCollectionIndicators.originalUrl"})}const d=(0,r.defineMessages)({github_pull:{defaultMessage:"Oauth Pull Request",id:"syncedCollectionIndicators.oauthGithubPullRequest.label"},github_issue:{defaultMessage:"Oauth Issue",id:"syncedCollectionIndicators.oauthGithubIssue.label"},Event:{defaultMessage:"Event",id:"syncedCollectionIndicators.event.label"},figma_file:{defaultMessage:"File",id:"syncedCollectionIndicators.figmaFile.label"},google_drive_file:{defaultMessage:"File",id:"syncedCollectionIndicators.googleDriveFile.label"},zendesk_ticket:{defaultMessage:"Ticket",id:"syncedCollectionIndicators.zendeskTicket.label"}});function u(e){const{pattern:t,integration:n}=e;return`${n.name} ${function(e){switch(e.name){case"Event":return s.default.formatMessage(d.Event);case"figma_file":return s.default.formatMessage(d.figma_file);case"github_pull":return s.default.formatMessage(d.github_pull);case"github_issue":return s.default.formatMessage(d.github_issue);case"google_drive_file":return s.default.formatMessage(d.google_drive_file);case"zendesk_ticket":return s.default.formatMessage(d.zendesk_ticket);default:return e.name}}(t)}`}},40150:(e,t,n)=>{n.d(t,{AV:()=>p,Xx:()=>g,bp:()=>d,bu:()=>f,f2:()=>h,iZ:()=>S,lO:()=>b,lZ:()=>v,mH:()=>u,oc:()=>_,tA:()=>m,vg:()=>y});var o=n(8848),i=n(51454),r=n(92650),a=n(24646),s=n(27724),l=n(78316),c=n(77181);function d(e,t){return e.col===t.col&&e.row===t.row}const u="text/_notion-table",p=function(e){return{minCol:Math.min(e.start.col,e.end.col),maxCol:Math.max(e.start.col,e.end.col),minRow:Math.min(e.start.row,e.end.row),maxRow:Math.max(e.start.row,e.end.row)}},m=14,f=32,g=f+0,h=e=>{let{columnIndex:t,titleColumnIndex:n,indentLevel:o,shouldShowBulkActionsToolbar:i,isSubitemToggleOnTitleColumn:r}=e;const a=0===t&&i?g:0;return v({columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:r})+a},v=e=>{let{columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:i}=e;return b({columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:i})&&o>0?c.Hw*o+c.gY:0},b=e=>{let{columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:o}=e;return o?t===n:0===t},y=e=>{let{collectionViewBlockId:t}=e;const n=s.default.state.stores;return 0!==n.length&&!(0,l.v_)(n,t)};function _(e){const{environment:t,collectionContextStore:n,isPhone:r,stickyLeft:s,theme:l}=e;if(r)return{};const c=n.collectionViewBlockStore(),d=null==c?void 0:c.getParentBlockStore();let u;const p=n.isInPeekRenderer.state;if("dark"===l.mode&&p&&(u=l.peekModalBackground),d&&!n.isFullScreen.state&&(null==c||!c.isRootOrDirectChild())){var m;const e=null===(m=d.getModel())||void 0===m?void 0:m.getFormat().block_color;e&&(u=(0,o.fi)(e,l).background)}const f=n.frozoneStore.state.scrollerLeftOffset??0,g=(0,a.Wk)(t),h=Math.max(g-f,0),v=S(t,n)?h:0;return{background:u||l.contentBackground,position:"sticky",left:(s||0)+v,zIndex:i.I5}}function S(e,t){const n=t.collectionViewBlockStore();return!!n&&(n.isRootOrDirectChild()&&(0,r.fg)(e,n)&&!(0,l._5)(n)&&!n.isCollectionViewPageWithContent())}},78122:(e,t,n)=>{n.d(t,{A8:()=>u,Bj:()=>b,Bt:()=>S,Fy:()=>g,T0:()=>m,Xg:()=>_,ZH:()=>p,hC:()=>y,hL:()=>v,iT:()=>f,wG:()=>h});n(67294);var o=n(72126),i=n(97880),r=n(9291),a=n(86080),s=n(47307),l=n(64369),c=n(95697),d=n(85893);async function u(e){let{isCurrentUser:t,teamName:n,memberName:o}=e;return await s.confirmUserAction({message:t?(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to leave {teamName}?",id:"teamActions.leaveTeam.confirmDialogMessage.removingYourself",values:{teamName:n}}):(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogMessage.removingSomeoneElse",defaultMessage:"Are you sure you want to remove {memberName} from {teamName}?",values:{memberName:o,teamName:n}}),description:t?(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingYourself",defaultMessage:"You'll no longer see this teamspace in your sidebar and you may lose permissions to the teamspace's pages."}):(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingSomeoneElse",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),acceptLabel:t?(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Leave Teamspace",id:"teamActions.leaveTeam.confirmDialogAcceptLabel.removingYourself"}):(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Remove",id:"teamActions.leaveTeam.confirmDialogAcceptLabel"}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogCancelLabel.removingSomeoneElse",defaultMessage:"Cancel"})})}function p(){s.showMessage({message:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.onlyTeamMemberLeftDialogMessage",defaultMessage:"Invite another teamspace owner to leave this teamspace"})})}function m(e){s.showMessage({message:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.userMembershipFromGroupDialogMessage",defaultMessage:"You can't leave this teamspace because you're a member of {groupNames}.",values:{groupNames:o.oA(e.map((e=>`"${e.name}"`))).join(", ")}})})}function f(e){var t;let{group:n,onAccept:o}=e;s.showDialog({message:n.name?(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title",defaultMessage:"Are you sure you want to remove {groupName}?",values:{groupName:n.name}}):(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title.noGroupName",defaultMessage:"Are you sure you want to remove this group?"}),description:(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.description",defaultMessage:"{numGroupMembers} {numGroupMembers, plural, one {member} other {members}} from this group will be removed from this teamspace.",values:{numGroupMembers:(null===(t=n.user_ids)||void 0===t?void 0:t.length)||0}}),showCancel:!0,keepFocus:!1,handleCancel:s.dismissDialog,items:[{label:(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.confirmationButton",defaultMessage:"Remove group"}),color:"red",onAccept:o}]})}async function g(e,t){return await a.b({message:(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogTitle",defaultMessage:"Are you sure you want to archive this teamspace?"}),(0,d.jsx)(l.Z,{isMultiline:!0,style:{marginTop:8},children:t?(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.transitionToZeroTeams.confirmDialogDescription",defaultMessage:'This is your last default teamspace. Archiving will remove the "Teamspaces" section in your sidebar. Type the teamspace name to confirm.'}):(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogDescription",defaultMessage:"Archiving this teamspace will remove access and hide it in the sidebar for all teamspace members. Type the teamspace name to confirm."})})]}),acceptLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogAcceptLabel",defaultMessage:"Archive teamspace"}),requiredInputValue:e})}async function h(e){return await s.confirmUserAction({message:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogTitle",defaultMessage:'Would you like to move pages under {teamName} to the "Private" and "Shared" sections in your sidebar?',values:{teamName:e}})}),acceptLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogAcceptLabel",defaultMessage:"Move pages"}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogCancelLabel",defaultMessage:"Proceed without moving pages"})})}async function v(e){let{teamName:t,currentIsDefault:n,accessLevel:o,isDefault:a,numberOfTeamGuests:l}=e;const c=(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.confirmTeamAccessDialog.disableDefaultTeamLabel",defaultMessage:"{teamName} will also no longer be a default teamspace and auto-add workspace members.",values:{teamName:t}})});let u,p;return"private"===o?(u=(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} private?",id:"teamActions.confirmTeamAccessChangeDialog.privateTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.privateTeam.description",defaultMessage:"Only members will be able to see the teamspace and its content."}),n&&c]})):a?l>0?(u=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeamWithGuests.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.defaultTeamWithGuests.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace. Additionally, {numberOfTeamGuests} teamspace guests will be removed.",values:{numberOfTeamGuests:l}})):(u=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeam.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.defaultTeam.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace."})):"open"===o?(u=(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} open?",id:"teamActions.confirmTeamAccessChangeDialog.openTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[!n&&(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.openTeam.description",defaultMessage:"Everyone in the workspace will have access to the teamspace and its content."}),n&&c]})):"closed"===o?(u=(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} closed?",id:"teamActions.confirmTeamAccessChangeDialog.closedTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.closedTeam.description",defaultMessage:"The teamspace will still be discoverable, but joining will be invite-only."}),n&&c]})):(0,i.t1)(o),await s.confirmUserAction({message:u,description:p})}async function b(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disableGuests.confirmationTitle",defaultMessage:"Are you sure? All page guests in this teamspace will be removed."});break;case"disable_public_access":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disablePublicPages.confirmationTitle",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this teamspace."});break;case"disable_export":case"disable_team_page_edits":return!0;default:(0,i.t1)(e)}return await s.confirmUserAction({message:t})}async function y(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disableGuestsOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow guests on this teamspace? By default, guests are not allowed on teamspaces in this workspace."});break;case"disable_public_access":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disablePublicPagesOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be made public? By default, pages in this workspace cannot be made public."});break;case"disable_export":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disableExportOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be exported? By default, pages in this workspace cannot be exported."});break;case"disable_team_page_edits":return!0;default:(0,i.t1)(e)}return await s.confirmUserAction({message:t,acceptLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.workspaceSettingOverride.confirmationButtonLabel",defaultMessage:"Override workspace setting"})})}async function _(e){let{environment:t,spaceStore:n,teamName:o}=e;const i=t.currentUser.id;if(!i||!n)return!0;return!(await(0,c.F0)({environment:t,spaceStore:n,currentUserId:i})).some((e=>{var t;return(null===(t=e.getName())||void 0===t?void 0:t.trim())===o.trim()}))||await s.confirmUserAction({message:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.message",defaultMessage:"A teamspace with the same name already exists. Are you sure you want to name this teamspace â€œ{teamName}â€?",values:{teamName:o}}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.cancelLabel",defaultMessage:"Cancel"})})}async function S(){return await s.confirmUserAction({message:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.setTeamPermissions.ClearCustomTeamPermissionsDialogMessage",defaultMessage:"Raising the permission level for all teamspace members will remove some custom permissions. Are you sure you want to proceed?"}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.setTeamPermissions.cancelLabel",defaultMessage:"Cancel"})})}},21115:(e,t,n)=>{n.d(t,{$$:()=>u,CC:()=>g,JB:()=>h,K9:()=>m,Ke:()=>v,_t:()=>d,e6:()=>p,zs:()=>f});var o=n(9291),i=n(64964),r=n(1310),a=n(19306),s=n(33929);const l=(0,o.defineMessages)({leftTeam:{id:"teamPermissionsActions.leftTeam",defaultMessage:"Left {teamName}"},leftTeamNoName:{id:"teamPermissionsActions.leftTeamNoName",defaultMessage:"Left team"},leftYetStillInTeam:{id:"teamPermissionsActions.leftYetStillInTeam",defaultMessage:"You are still in {hasTeamName, select, true {{teamName}} other {the team}} because you are a member of the following groups: {groupsString}"},removedYetStillInTeam:{id:"teamPermissionsActions.removedYetStillInTeam",defaultMessage:"{hasMemberName, select, true {{memberName}} other {The removed user}} is still in {hasTeamName, select, true {{teamName}} other {the team}} because they are a member of the following groups: {groupsString}"},joinedTeam:{id:"teamPermissionsActions.joinedTeam",defaultMessage:"Joined {teamName}"},joinedTeamUsingAdminPrivileges:{id:"teamPermissionsActions.joinedTeamUsingAdminPrivileges",defaultMessage:"Joined {teamName} using admin privileges"},upgradedSelfToOwner:{id:"teamPermissionsActions.upgradedSelfToOwnerUsingAdminPrivileges",defaultMessage:"Became owner of {teamName} using admin privileges"},archivedTeam:{id:"teamPermissionsActions.archivedTeam",defaultMessage:"Archived {teamName}"},restoredTeam:{id:"teamPermissionsActions.restoredTeam",defaultMessage:"Restored {teamName}"},restoredTeamNoName:{id:"teamPermissionsActions.restoredTeamNoName",defaultMessage:"Restored team"},duplicatedTeam:{id:"teamPermissionsActions.duplicatedTeam",defaultMessage:"Duplicated {teamName}"},duplicatedTeamNoName:{id:"teamPermissionsActions.duplicatedTeamNoName",defaultMessage:"Duplicated teamspace"}}),c=(e,t,n)=>{const o=s.default.formatMessage(e,{...t});i.oV({label:o,durationMs:n})},d=e=>c(l.upgradedSelfToOwner,{teamName:e}),u=e=>{let{teamName:t,usingAdminPrivileges:n}=e;return c(n?l.joinedTeamUsingAdminPrivileges:l.joinedTeam,{teamName:t})},p=e=>e?c(l.leftTeam,{teamName:e}):c(l.leftTeamNoName),m=(e,t)=>{const n=(0,a.W)(t.flatMap((e=>e.name||[])));c(l.leftYetStillInTeam,{hasTeamName:void 0!==e,teamName:e,groupsString:n},r.JY)},f=(e,t,n)=>{const o=(0,a.W)(n.flatMap((e=>e.name||[])));c(l.removedYetStillInTeam,{hasMemberName:void 0!==e,hasTeamName:void 0!==t,memberName:e,teamName:t,groupsString:o},r.JY)},g=e=>c(l.archivedTeam,{teamName:e}),h=e=>e?c(l.restoredTeam,{teamName:e}):c(l.restoredTeamNoName),v=e=>e?c(l.duplicatedTeam,{teamName:e}):c(l.duplicatedTeamNoName)},95697:(e,t,n)=>{n.d(t,{q9:()=>le,$r:()=>re,ZN:()=>ae,oI:()=>V,Xq:()=>G,KP:()=>ie,W8:()=>ce,Pr:()=>$,qX:()=>O,F0:()=>q,sj:()=>N,tu:()=>fe,wP:()=>pe,Mf:()=>z,xo:()=>oe,tO:()=>te,xf:()=>ne,ku:()=>Z,AL:()=>X,QI:()=>F,U2:()=>de,zz:()=>ee,bq:()=>L,Hu:()=>K,tV:()=>ue,C2:()=>H,dY:()=>me,$:()=>Y,Gc:()=>U,OX:()=>J});n(57658);var o=n(480),i=n(86628),r=n(14577),a=n(29477);const s=Symbol("unset");class l{constructor(e){this.timeoutMs=void 0,this.fetch=void 0,this.useLastValue=void 0,this.promise=void 0,this.lastFetched=void 0,this.lastValue=void 0,this.changeTrigger=a.UZ();const{timeoutMs:t,fetch:n,useLastValue:o}=e;this.timeoutMs=t,this.fetch=n,this.promise=void 0,this.useLastValue=o,this.lastValue=s}async getWithState(){if(this.isReady()&&this.lastValue!==s)return{value:this.lastValue,state:"cached"};if(this.promise)return{value:await this.promise,state:"cached"};this.promise=this.fetch().catch((e=>{if(this.useLastValue&&this.lastValue!==s)return this.lastValue;throw e}));try{const e=await this.promise;return this.lastFetched=Date.now(),e!==this.lastValue&&(this.changeTrigger.resolve(e),this.changeTrigger=a.UZ()),this.lastValue=e,{value:e,state:"fetched"}}finally{this.promise=void 0}}async get(){const{value:e}=await this.getWithState();return e}isReady(){const e=Date.now();return Boolean(this.lastFetched&&this.lastValue!==s&&this.lastFetched>e-this.timeoutMs)}waitUntilChange(){return this.changeTrigger.promise}}var c=n(68626),d=n(72126),u=n(86517),p=n(72141),m=n(45953),f=n(29369),g=n(19889),h=n(64684),v=n(97880),b=n(9291),y=n(54642),_=n(95477),S=n(38676),w=n(80444),k=n(77080),I=n(45483),x=n(26136),C=n(30397),T=n(88893),M=n(88280),P=n(60396),A=n(28020),R=n(4708),D=n(15010),B=n(67669),E=n(38755);function F(e){const{currentSpaceStore:t,currentUserStore:n}=w.default.state,o=null==t?void 0:t.getModel();if(!n||!o)return!1;if(!o.userIdIsMember(n.id))return!1;switch(e){case"dev_only":return k.default.checkGate("sidebar_home_gate");case"beta_wave_3_only":return k.default.checkGate("sidebar_home_beta_wave_3_gate");case"beta_only":return k.default.checkGate("sidebar_home_beta_gate")||k.default.checkGate("sidebar_home_beta_wave_3_gate");case"dev_or_beta":return k.default.checkGate("sidebar_home_gate")||k.default.checkGate("sidebar_home_beta_gate")||k.default.checkGate("sidebar_home_beta_wave_3_gate");default:(0,v.t1)(e)}}function Z(){return k.default.checkGate("sidebar_pages_hide_toggles")}function V(){return _.default.isAdminMode||!1}const j=d.HP((()=>new r.Z((()=>{const{currentSpaceStore:e}=w.default.state;return!!e&&e.isTeamsEnabled()}),{debugName:"teamsEnabledStore"})));function U(){return(0,i.VK)((()=>j().state),[])}function L(){return j().state}async function O(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:i}=e;const r=await y.getTeams(t,{spaceId:n.id,includeArchived:o},i);return"failed"===r.type?(c.rateLimitedLog({from:"teamsHelpers",level:"error",type:"getTeamsFailed"}),[]):r.data.teamIds.map((e=>x.zX.createChildStore(n,{table:f.e0,id:e})))}async function N(e){let{spaceStore:t,currentUserId:n,includeArchived:o,minRoleOnTeamStores:i,environment:r}=e;if(!t||!n)return[];const a=await y.getAllTeamsInSpaceForAdmin(r,{spaceId:t.id,includeArchived:o},n);if("failed"===a.type)return[];const s=a.data.teamIds.map((e=>x.zX.createChildStore(t,{table:f.e0,id:e}))),l=[],c=[];for(const m of s){const e=m.getRole()??"none";(0,u.gr)(e,i)?c.push(m.id):l.push(m)}const d=m.Ak.create(a.data.recordMap);P.Z.initialize({environment:r,userId:n,spaceId:t.id,teamIds:a.data.teamIds,getRecordWithRole:e=>({role:i,value:d.getValue(e)})});const p=c.map((e=>P.Z.createTeamStoreFromCache({environment:r,teamId:e,spaceId:t.id,userId:n}))).filter(v.$K);return[...l,...p]}function z(e){return C.Z.state.teams.filter((t=>t.getMembers().some((t=>"user"===t.entity_type&&t.user_id===e))))}const W=new Map;async function q(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:i}=e;const r=`${n.id}:${o}`,a=W.get(r);if(a)return a.get();const s=new l({timeoutMs:3e4,fetch:async()=>O({environment:t,spaceStore:n,includeArchived:o,currentUserId:i}),useLastValue:!0});return W.set(r,s),s.get()}function H(e){return!!e&&"private"===(0,h.B5)(e)}function K(e){return e&&(0,h.jI)(e)}function G(e){let{environment:t,spaceStore:n}=e;return!!n&&(!(0,E.Cx)(n)&&((0,E.Fn)(t)||!n.getDisableTeamCreation()))}function $(e){const t=(0,B.YO)(e).map((e=>e.permissionItem)),n=t.find(p.ix),o=(null==n?void 0:n.role)??"none",i=(0,T.Io)().reduce(((e,t)=>(e.add(t.userId),e)),new Set),r=t.filter((e=>!(!(0,p.jg)(e)||!i.has(e.user_id))||!!(0,p.hV)(e))),a=function(e){if(0===e.length)return;return e.reduce(((e,t)=>(0,u.SL)(t,e)?t:e),e[0])}(r.map((e=>e.role)))??"read_and_write";return{accessLevel:"none"===o?"private":"closed",spacePermissionRole:o,teamPermissionRole:(0,u.nl)(a,o),members:r.map((e=>{const{type:t}=e;return"user_permission"===t?{entity_type:"user",type:"member",user_id:e.user_id}:"group_permission"===t?{entity_type:"group",type:"member",group_id:e.group_id}:void(0,v.t1)(t)}))}}function Q(e){let{environment:t,currentSpaceStore:n,subscriptionData:o}=e;return!!n&&(!t.device.isMobile&&!n.isTeamsEnabled()&&!(0,T.wY)(o)&&(0,E.lQ)(n))}function Y(e){const{currentSpaceStore:t}=w.default.state;return Q({environment:e,currentSpaceStore:t,subscriptionData:M.subscriptionDataStoreInstance.state})}function J(){const e=(0,o.O7)();return(0,i.VK)((()=>{const{currentSpaceStore:t}=w.default.state,n=M.subscriptionDataStoreInstance.state;return Q({environment:e,currentSpaceStore:t,subscriptionData:n})}),[e])}function X(e){let{teamStore:t,spaceStore:n,userId:o}=e;return!!(t.isDefined()&&null!=n&&n.isDefined()&&o)&&(0,h.AL)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()},userId:o})}function ee(e){let{teamStore:t,spaceStore:n,userId:o}=e;return!(!t.isDefined()||!o)&&(0,h.zz)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:(null==n?void 0:n.getPermissionItems())||[],permission_groups:(null==n?void 0:n.getPermissionGroups())||[]},userId:o})}function te(e){let{teamStore:t,spaceStore:n}=e;return n?(0,h.tO)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()}}):[]}function ne(e){let{teamStore:t,spaceStore:n}=e;return n?(0,h.xf)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()}}):[]}function oe(){return C.Z.state.teams.flatMap((e=>e.getTeamPages()))}function ie(e,t){return e.isDefault()?-1:t.isDefault()?1:0}const re=["owner","member"],ae=["owner","member","team_level_guest"],se=(0,b.defineMessages)({ownerLabel:{id:"teamPermissionsMenu.ownerItem.label",defaultMessage:"Teamspace owner"},ownerCaption:{id:"teamPermissionsMenu.ownerItem.caption",defaultMessage:"Can edit teamspace settings and full access to teamspace pages."},memberLabel:{id:"teamPermissionsMenu.memberItem.label",defaultMessage:"Teamspace member"},memberCaption:{id:"teamPermissionsMenu.memberItem.caption",defaultMessage:"Cannot edit teamspace settings and can access teamspace pages."},guestLabel:{id:"teamPermissionsMenu.guestItem.label",defaultMessage:"Teamspace guest"},guestCaption:{id:"teamPermissionsMenu.guestItem.caption",defaultMessage:"Only has access to invited teamspaces."}}),le={owner:{label:se.ownerLabel,caption:se.ownerCaption},member:{label:se.memberLabel,caption:se.memberCaption},team_level_guest:{label:se.guestLabel,caption:se.guestCaption}};function ce(e){return`${_.default.domainBaseUrl}/team/${e}/join`}function de(e){var t;return!(null===(t=e.getSettings())||void 0===t||!t.disable_invite_link)}function ue(e){const t=[],n=[];for(const o of e)o.isDefined()&&(void 0===o.getArchivedBy()?n.push(o):t.push(o));return{archivedTeams:t,unarchivedTeams:n}}function pe(e){const t=(0,D.WD)(e);if(!t)return!1;const n=t.getKeyStore("settings").getKeyStore("seen_team_add_app_template_tooltip_at").getValue();return void 0!==n&&n>0}function me(e){let{environment:t,teamId:n}=e;const o=Boolean(S.sidebarExpandedStore.state);return(0,R.B9)()&&w.default.state.inAppCalloutStore.canShow("team_add_app_template_tooltip")&&!pe(t)&&0===I.Z.state.openModals.size&&o&&function(e){var t;let{environment:n,teamId:o}=e;const i=((null===(t=(0,A.k_)(n).getState())||void 0===t?void 0:t.userJoinedTeamsStores)??[]).find((e=>{const t=e.getTeamPagesStores().filter((e=>{var t;return Boolean(null===(t=e.getCollectionStore())||void 0===t?void 0:t.getDatabaseType())}));return e.canAddOrRemoveTopLevelPages()&&t.length<2}));return!!i&&i.id===o}({environment:t,teamId:n})}function fe(e){let{currentUserStore:t,currentSpaceStore:n,teamStore:o,members:i}=e;return d.oA(i.map((e=>{const{entity_type:i}=e;return"user"===i?function(e){let{currentUserStore:t,teamStore:n,member:o}=e;if(!t)return;const i=ge({teamStore:n,member:o}),r=x.U6.createChildStore(t,{table:g.KJ,id:o.user_id});return{type:"user",memberInfo:o,permissionItem:{type:"user_permission",user_id:o.user_id,role:i},userStore:r}}({currentUserStore:t,teamStore:o,member:e}):"group"===i?function(e){let{currentSpaceStore:t,teamStore:n,member:o}=e;const i=(0,E.TC)({spaceStore:t,groupId:o.group_id});if(!i)return;const r=ge({teamStore:n,member:o});return{type:"group",memberInfo:o,permissionItem:{type:"group_permission",group_id:i.id,role:r},permissionGroup:i}}({currentSpaceStore:n,teamStore:o,member:e}):void(0,v.t1)(i)})))}function ge(e){let{teamStore:t,member:n}=e;const o=t.getPermissionItems();if(!o)return"none";const i=function(e){let{permissions:t,member:n}=e;const o=null==t?void 0:t.find((e=>(0,p.hV)(e)&&"group"===n.entity_type&&e.group_id===n.group_id||(0,p.jg)(e)&&"user"===n.entity_type&&n.user_id===e.user_id));return null==o?void 0:o.role}({permissions:o,member:n});return i||(0,h.xC)({id:t.id,permissions:t.getPermissionItems()})}},60846:(e,t,n)=>{n.d(t,{D$:()=>l,JZ:()=>c,NL:()=>s,UZ:()=>d});n(21703);var o=n(52027),i=n.n(o),r=n(15095);const a=new(i()),{DIFF_DELETE:s,DIFF_INSERT:l,DIFF_EQUAL:c}=i(),d=function(e,t){const n=u(e,{count:0,encoding:{},decoding:{}}),o=n.encodedString,i=u(t,n.cypher),r=i.encodedString,s=i.cypher;return function(e,t){return e.map((e=>{let[n,o]=e;return[n,p(o,t)]}))}(a.diff_main(o,r),s).filter((e=>{let[t,n]=e;return""!==n}))};function u(e,t){const n=r.p4(e).map((e=>{const n=t.encoding[e];if(n)return n;{const n=String.fromCharCode(t.count);return t.count++,t.encoding[e]=n,t.decoding[n]=e,n}}));if(t.count>65535)throw new Error("This string has way too many different characters.");const o=n.join("");return{cypher:t,encodedString:o}}function p(e,t){return e.split("").map((e=>t.decoding[e])).join("")}},31352:(e,t,n)=>{n.d(t,{O2:()=>a,Ye:()=>c,ug:()=>s,zK:()=>l});var o=n(15095),i=n(72126),r=n(70203);function a(e,t,n){const a=e.getValue(),s=r.eeV(t),l=r.eeV(a);if(0===s.length&&0===l.length)return""===n?{filter:{startIndex:0,endIndex:0}}:void 0;const c=i.d9(s).reverse(),d=i.d9(l).reverse(),u=l.findIndex(((e,t)=>e!==s[t])),p=d.findIndex(((e,t)=>e!==c[t]));if(-1===u||-1===p)return;const m=o.p4(n),f={filter:{startIndex:u+(m.length>0?1:0),endIndex:u+l.length-s.length}};if(m.length>0){const e=f.filter.startIndex-m.length,t=f.filter.startIndex;l.slice(e,t).join("")===n&&(f.prefix={startIndex:e,endIndex:t})}return f}function s(e,t){if(!t)return;const n=e.getValue();return r.eeV(n).slice(t.filter.startIndex,t.filter.endIndex).join("")}function l(e,t,n){return s(e,a(e,t,n?"@":""))}function c(e,t,n,o,a){if(void 0===e)return!0;if(t&&0===n&&o>3)return!0;if(1===e.length){const t=i.Z$(e);if(t){if(/\s/g.test(t)){const e=a.getValue();if(e&&1===e.length){const t=r.QaF(e);return!(2===t.length&&t.startsWith("/"))}}}}else if(e.length>=2){return e.endsWith("  ")}return!1}},89224:(e,t,n)=>{n.r(t),n.d(t,{areRangesEqual:()=>D,clear:()=>S,containerOffsetIsBetweenNodes:()=>A,get:()=>h,getIncompleteDOMEndpoint:()=>y,getRect:()=>w,getSelectionRect:()=>k,isExpanded:()=>C,isMouseRightClicking:()=>L,isMouseSelecting:()=>U,rangeFromContainerOffsets:()=>T,rangeFromPoint:()=>I,rangeToContainerOffsets:()=>P,resetMouseRightClicking:()=>O,selectionIsBackwards:()=>Z,set:()=>v,setDOMEndpoint:()=>_,setOnNode:()=>x,snapContainerOffsetToNode:()=>R,startListeners:()=>F,toStaticRange:()=>M});n(21703);var o=n(55010),i=n(45060),r=n(1302),a=n(92595),s=n(7406),l=n(68626),c=n(72126),d=n(15723);new WeakMap;let u;const p=c.HP((()=>window.__isElectron?m:()=>window))();function m(){return!u||window.document.hasFocus()?(f("getWindow(): Returning main window because it has focus."),window):u?(f("getWindow(): Returning focused child window."),u):(f("getWindow(): Returning main window because nothing has focus"),window)}function f(){false}var g=n(73744);const h=function(){const e=p().getSelection();if(e&&e.rangeCount>0){return e.getRangeAt(0)}},v=function(e,t){b.reset();const n=window.getSelection();if(n){if(!(t.isFirefox&&parseFloat(t.browserVersion)<92))try{return function(e,t){const{focus:n,anchor:o}=P(t);e.collapse(o.container,o.offset),e.extend(n.container,n.offset)}(n,e)}catch(o){l.log({from:"textSelection",type:"textSelectionSet",level:"error",error:(0,s.tg)(o)})}return function(e,t){const n=document.createRange();n.setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(n)}(n,e)}};const b=new class{constructor(e){this.state=void 0,this.debugName=e,(0,a.exposeDebugInstance)("endpointLatch",this)}complete(e){if(this.state&&this.state.endpoint!==e.endpoint&&this.state.onlyIfEqual===e.onlyIfEqual){const t="start"===this.state.endpoint?this.state:e,n="end"===this.state.endpoint?this.state:e;return this.state=void 0,{start:t,end:n}}if(this.state){let t=`${this.debugName}: cannot complete latch:`;const n=this.state.endpoint===e.endpoint,o=this.state.onlyIfEqual!==e.onlyIfEqual;n&&(t+=` same endpoint ${e.endpoint}`),o&&(t+=" different tokens"),l.log({level:"warning",from:"EndpointLatch",type:"cannotCompleteLatch",data:{name:this.debugName,message:t,miscDataToConvertToString:{sameEndpoint:n,differentTokens:o}}})}this.state=e}reset(){this.state&&(l.log({level:"warning",from:"EndpointLatch",type:"resetPartialLatch",data:{name:this.debugName,message:`reset latch with endpoint ${this.state.endpoint}`}}),this.state=void 0)}}("domSelection");function y(){return b.state}function _(e,t){const n=b.complete(e);if(!n)return;const{start:o,end:i}=n,r=T({start:o.position,end:i.position});v(r,t)}function S(e){b.reset();const t=window.getSelection();t&&(e.device.isMobile&&e.device.isAndroid?t.collapse(null,void 0):t.removeAllRanges())}const w=function(e){if(e){if(e.collapsed&&e.getClientRects){const t=c.Go(e.getClientRects()[0]);if(!c.xb(t))return t}else if(e.getBoundingClientRect){const t=c.Go(e.getBoundingClientRect());if(!c.xb(t))return t}if(e.startContainer.nodeType===Node.ELEMENT_NODE){if(0===e.startOffset){const t=e.startContainer.getBoundingClientRect();return new d.iL(t.left,t.top,0,t.height)}const t=e.startContainer.childNodes[e.startOffset-1];if(t&&t.nodeType===Node.ELEMENT_NODE){const e=t.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}const n=e.startContainer.childNodes[e.startOffset];if(n&&n.nodeType===Node.ELEMENT_NODE){const e=n.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}}}};function k(){const e=h();if(e)return w(e)}const I=function(e,t){if(document.caretRangeFromPoint){return document.caretRangeFromPoint(e,t)??void 0}if(document.caretPositionFromPoint){const n=document.caretPositionFromPoint(e,t),o=document.createRange();return o.setStart(n.offsetNode,n.offset),o.setEnd(n.offsetNode,n.offset),o}throw new Error("Browser does not support method caretRangeFromPoint or caretPositionFromPoint")};function x(e,t){const n=document.createRange();n.selectNode(e),v(n,t)}function C(e){return Boolean(e&&!e.collapsed)}function T(e){const{start:t,end:n}=e,o=document.createRange();if(t.container)try{o.setStart(t.container,t.offset)}catch(i){console.info(i)}if(n.container)try{o.setEnd(n.container,n.offset)}catch(i){console.info(i)}return o}function M(e){if(!e)return;const{startContainer:t,startOffset:n,endContainer:o,endOffset:i,collapsed:r}=e;return{startContainer:t,startOffset:n,endContainer:o,endOffset:i,collapsed:r}}function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z();const n={container:e.startContainer,offset:e.startOffset},o={container:e.endContainer,offset:e.endOffset},[i,r]=t?[n,o]:[o,n];return{start:n,end:o,focus:i,anchor:r}}function A(e,t,n){if(!t&&!n)return!1;if(!t&&n){const t=document.createRange();return t.selectNode(n),-1===t.comparePoint(e.container,e.offset)}if(t&&!n){const n=document.createRange();return n.selectNode(t),1===n.comparePoint(e.container,e.offset)}if(t&&n){const o=document.createRange();return o.setStartAfter(t),o.setEndBefore(n),0===o.comparePoint(e.container,e.offset)}return!1}function R(e){const{nodesInDomOrder:t,containerOffset:n,snapTowards:o}=e;for(let i=0;i<=t.length;i++){const e=t[i-1],r=t[i];if(A(n,null==e?void 0:e.node,null==r?void 0:r.node))return"start"===o?e:r}}function D(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset&&e.collapsed===t.collapsed}const B=new class{constructor(){this.currentHasNonEmptySelection=!1,this.currentIsBackwards=void 0,this.mouseDownSelection=void 0}selectionIsBackwards(){return Boolean(this.currentHasNonEmptySelection&&this.currentIsBackwards)}updateSelectionDirection(e,t){if(!e||!t||t.collapsed)return this.currentHasNonEmptySelection=!1,void(this.currentIsBackwards=void 0);if(this.currentHasNonEmptySelection=!0,void 0===this.currentIsBackwards){const n=1===t.startContainer.childNodes.length&&t.startContainer.childNodes[0].TEXT_NODE&&t.startContainer.childNodes[0]===e.startContainer;if(e.startContainer===t.startContainer||n)this.currentIsBackwards=t.startOffset<e.startOffset;else{const n=(0,o.Z)(t.startContainer,e.startContainer);this.currentIsBackwards=-1===n}}}startListeners(){window.addEventListener("mousedown",(()=>{r.default.afterNextFlush((()=>{this.mouseDownSelection=h()}))})),window.addEventListener("mouseup",(()=>{r.default.afterNextFlush((()=>{const e=h();this.updateSelectionDirection(this.mouseDownSelection,e)}))})),window.addEventListener("keydown",(()=>{const e=h();r.default.afterNextFlush((()=>{const t=h();this.updateSelectionDirection(e,t)}))}))}},E=new class{constructor(){this.mouseDown=!1,this.keysDown=0,this.wasBackwards=!1,this.device=void 0,this.debugDrawRects=()=>{const e=h();if(C(e)){const{focus:t,anchor:n}=P(e,this.wasBackwards),o=T({start:t,end:t}),r=w(o);r&&(0,i.yX)(r,"FOCUS","red");const a=T({start:n,end:n}),s=w(a);s&&(0,i.yX)(s,"ANCHOR","blue")}},this.handleSelectionChange=()=>{var e;(this.mouseDown||this.keysDown||null!==(e=this.device)&&void 0!==e&&e.isAndroid)&&(this.wasBackwards=function(){const e=window.getSelection();if(!e)return!1;const{focusNode:t,focusOffset:n,anchorNode:i,anchorOffset:r}=e;if(t===i)return n<r;return-1===(0,o.Z)(t,i)}())},this.handleKeyDown=()=>{this.keysDown++},this.handleKeyUp=()=>{this.keysDown--},this.handleMouseDown=()=>{this.mouseDown=!0},this.handleMouseUp=()=>{this.mouseDown=!1}}startListeners(e){return this.device=e,document.addEventListener("selectionchange",this.handleSelectionChange),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp),()=>{document.removeEventListener("selectionchange",this.handleSelectionChange),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp)}}};function F(e){B.startListeners(),E.startListeners(e)}function Z(){return B.currentIsBackwards||E.wasBackwards}(0,a.exposeDebugGetter)("selectionIsBackwards",Z);let V=!1,j=!1;function U(){return V}function L(){return j}function O(){return j=!1}(0,g.lj)(window,"mousedown",(e=>{0===e.button?V=!0:2===e.button&&(j=!0)}),!0),(0,g.lj)(window,"mouseup",(e=>{0===e.button?V=!1:2===e.button&&(j=!1)}),!0)},89086:(e,t,n)=>{n.d(t,{Gq:()=>J,HE:()=>X,J5:()=>Y,J6:()=>M,J_:()=>V,Ld:()=>x,Ov:()=>U,P2:()=>D,Q3:()=>H,Rb:()=>S,Rw:()=>E,ST:()=>R,ZZ:()=>Q,a6:()=>C,bj:()=>A,dQ:()=>ee,e7:()=>F,fM:()=>G,fu:()=>Z,fx:()=>q,hn:()=>z,iB:()=>j,k2:()=>T,lV:()=>$,mK:()=>N,oc:()=>I,qK:()=>te,qh:()=>K,td:()=>_,wd:()=>w,x0:()=>B,yR:()=>L,yj:()=>P});n(57658);var o=n(55010),i=n(41432),r=n(15095),a=n(72126),s=n(21202),l=n(70203),c=n(95371),d=n(28685),u=n(95802),p=n(15723),m=n(50628),f=n(27724),g=n(24666),h=n(68056),v=n(45162),b=n(69645);const y="data-text-edit-side";function _(e){return{[y]:e}}function S(e){if(e instanceof HTMLElement){const t=e.closest("[data-text-edit-side]"),n=null==t?void 0:t.getAttribute(y);if("start"===n||"end"===n)return n}}function w(e){return e.startIndex===e.endIndex}function k(e){const{startIndex:t}=e;let n;return n=w(e)&&t>0?[t-1]:function(e){return a.w6(e.startIndex,e.endIndex)}(e),n}function I(e,t){const n=l.lzi(t),o=n.map((e=>r.p4(l.WiV(e))));return e.map((e=>{let t=0;const i=o.findIndex((n=>(t+=n.length,t>e))),r=n[i];return r?l.hDy(r):[]}))}function x(e){if("editing"===g.default.state.mode)return C(e,g.default.state.multiSelection,g.default.state.forceExtendAnnotations)}function C(e,t,n){return T([e],t,n)[e]}function T(e,t,n){const o={};if(0===e.length)return o;if((0,h.iG)(t)){for(const t of e){const e=n[t];if(null!=e&&e.extend){const n=e.annotation;o[t]=n}}return o}const i=new Set(e);let r=!0;const a=(0,v.L5)(t);for(const{store:s,selection:c}of a){const e=s.getValue(),t=l.Ulv(e,c),{tokensInsideRange:n}=l.xrQ(e,t.startIndex,t.endIndex);for(const a of n){const e=l.hDy(a);for(const t of i){const n=e.find((e=>l.J7s(e)===t));if(r&&n)o[t]=n;else if(n);else if(delete o[t],i.delete(t),0===i.size)return o}r=!1}}return o}function M(e){const t=g.default.state;if("editing"!==t.mode)return!1;const{multiSelection:n}=t;if((0,h.iG)(n))return!1;const o=(0,v.L5)(n);for(const{store:i,selection:a}of o){const t=i.getValue();if(!t)continue;const n=l.lzi(t);let o=0;for(const i of n){const t=r.p4(l.WiV(i));if(o>=a.startIndex&&o<a.endIndex||o<a.startIndex&&o+t.length>a.startIndex){if(l.hDy(i).some((t=>l.J7s(t)===e)))return!0}o+=t.length}}return!1}function P(e,t){const n=k(e),o=t.getValue()||[];return function(e,t,n){const o=[],i=e[0]||[];for(const r of i){const e=l.J7s(r);l.aLA[e]||(l.k87[e]||l.S_n[e]?R(t,n.startIndex,e)&&o.push(r):o.push(r))}return o}(I(n,o),o,e)}function A(){const e=g.default.state;if("editing"!==e.mode)return[];const{multiSelection:t,forceExtendAnnotations:n}=e,o=(0,v.L5)(t);if(0===o.length)return[];const{store:i,selection:r}=o[0];let s=P(r,i);return a.M6(n,((e,t)=>{e&&(e.extend?s.push(e.annotation):s=s.filter((e=>l.J7s(e)!==t)))})),s}function R(e,t,n){const o=l.b1T(e,t),i=l.hDy(o);return Boolean(i.find((e=>l.J7s(e)===n)))}function D(e){const t=B(e);if(t)return{startIndex:0,endIndex:t.endIndex}}function B(e){const t=d.E.findEditableWithStore(e);if(t)return t.props.getEndSelection?t.props.getEndSelection():void 0;{const t=l.eeV(e.getValue());return{startIndex:t.length,endIndex:t.length}}}function E(e){return 0===e.startIndex&&0===e.endIndex}function F(e,t){return e.store===t&&0===e.index}function Z(e,t){return!e&&!t||e&&t&&(e.startIndex===t.startIndex||!e.startIndex&&!t.startIndex)&&(e.endIndex===t.endIndex||!e.endIndex&&!t.endIndex)}function V(e,t){return Z(t,B(e))}function j(e,t){var n;return e.store===t&&e.index===(null===(n=B(t))||void 0===n?void 0:n.endIndex)}function U(){const e=f.default.getCurrentDefaultContainer();return d.E.getMembersByDOMOrder({filter:t=>{const n=t.getContextClosestSelectable();if(!n)return!1;const o=n.getContextSelectableContainer();return o&&o===e}})}function L(e){const t=e.getNode(),n=t?f.default.getDefaultContainerFromTarget(t):f.default.getCurrentDefaultContainer();return d.E.getMembersByDOMOrder({filter:e=>{const t=e.getContextClosestSelectable();if(!t)return!1;const o=t.getContextSelectableContainer();return o&&o===n}})}function O(e){return U().filter((e=>!e.props.disabled)).map((e=>e.props.store))}function N(e){const t=O(),n=t.indexOf(e);return-1===n?null:t[n-1]}function z(e){const t=O(),n=t.indexOf(e);return-1===n?null:t[n+1]}function W(e){const t=[];for(const n of e){const e=a.cx(t,(e=>{const t=e[0];return p.Kr(n.rect,t.rect)}));e>=0?t[e].push(n):t.push([n])}return t}function q(e,t,n){const{selectableRectMap:i}=m.Z.state,r=n?f.default.getDefaultContainerFromTarget(n):void 0,s=f.default.getCurrentDefaultContainer(),l=r||s,c=u.C.getMembersByDOMOrder({filter:e=>e.props.canSelect&&e.props.canEditText&&e.getContextSelectableContainer()===l}),d=[];for(const o of c){const e=i.get(o);e&&d.push({selectable:o,rect:e})}const p=d.filter((e=>{let{rect:n}=e;return n.top<=t}));p.reverse();const g=W(p),h=a.UI(g,(e=>e.sort(((e,t)=>-1*(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),v=a.F(h,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));if(v)return v;const b=W(d.filter((e=>e.rect.bottom>=t&&p.indexOf(e)<0))),y=a.UI(b,(e=>e.sort(((e,t)=>(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),_=a.F(y,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));return _||void 0}function H(e,t){const{selectableRectMap:n}=m.Z.state,o=u.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===t});for(let i=o.length-1;i>=0;i--){const t=n.get(o[i]);if(t&&t.bottom>e)return!1}return!0}function K(e,t){const n=(0,b.dq)({includeNonSelectableListContainer:!0});if(!n)return!1;const o=a.Z$((0,c.DY)([n],(e=>e.value.component===t)));if(!o)return!1;const{selectableRectMap:i}=m.Z.state;return!(0,c.Yz)(o,(n=>{const o=n.component&&i.get(n.component);return!!(o&&e<=o.bottom&&n.component!==t)}))}function G(e,t,n){const o=e.getValue(),i=[],s=n?l.Jcv(o):l.QaF(o),{startIndex:c,endIndex:d}=t,u=r.p4(s),p=a.tP(u,0,c),m=a.qr(p,(e=>"\n"===e));m>=0?i.push(m):i.push(0);for(let r=c;r<d;r++){"\n"===u[r]&&i.push(r)}return i}function $(e){const{multiSelection:t}=e;return(0,v.L5)(t).map((e=>{let{store:t,selection:n}=e;const o=l.lzi(t.getValue()),i=l.Ulv(o,n),{tokensInsideRange:r}=l.xrQ(o,i.startIndex,i.endIndex);return l.QaF(r)})).join("\n\n")}function Q(e){const t=g.default.state;return"empty"!==t.mode&&Boolean((0,v.r)(t.multiSelection,e))}function Y(e){const t=g.default.state;return"editing"===t.mode&&(t.multiSelection.start.store===e&&(t.multiSelection.end.store===e?"contains-selection":"contains-selection-start"))}function J(e){const t=g.default.state;if("editing"!==t.mode)return!1;const{start:n,end:o}=t.multiSelection;return n.store===e||o.store===e}function X(e){const t=g.default.state;if("empty"===t.mode)return;const n=(0,h.QY)(t.multiSelection);if(n)return n.store===e?{type:"contain",selection:l.Ulv(e.getValue(),n.selection)}:void 0;const{start:o,end:i}=t.multiSelection;if(o.store===e){const t=l.eeV(e.getValue()).length;return{type:"start",index:Math.min(o.index,t)}}if(i.store===e){const t=l.eeV(e.getValue()).length;return{type:"end",index:Math.min(i.index,t)}}}function ee(e){if(!(0,h.iG)(e))return!1;const{store:t,index:n}=e.start;return 0===n||"\n"===l.eeV(t.getValue())[n-1]}function te(){if("editing"!==g.default.state.mode)return!1;const e=(0,h.QY)(g.default.state.multiSelection);if(!e)return!1;if(!e.store.isTable(s.iU))return!1;if(0===f.default.state.stores.length)return!1;return e.store.getRecordStoreAtRootPath().getType()===i.Ti.code&&(g.default.isEditingCaption()?"caption":"body")}},17311:(e,t,n)=>{n.d(t,{Z:()=>o});const o={unit:8,borderRadius:4,card:{desktop:{small:{width:180,height:100},medium:{width:260,height:148},large:{width:320,height:180}},mobile:{width:"100%"}},vertical:{micro:2,tiny:4,small:8,medium:12,large:24},horizontal:{micro:2,tiny:4,small:8,medium:12,large:24}}},16402:(e,t,n)=>{n.d(t,{IS:()=>d,gs:()=>m,hH:()=>u,uy:()=>p});var o=n(44317),i=n(63143),r=n(9291),a=n(33929);const s=(0,r.defineMessages)({year:{id:"timeUtils.durationDescriptor.year",defaultMessage:"{numYears, plural, one {{numYears} year ago} other {{numYears} years ago}}"},day:{id:"timeUtils.durationDescriptor.day",defaultMessage:"{numDays, plural, one {{numDays} day ago} other {{numDays} days ago}}"},week:{id:"timeUtils.durationDescriptor.week",defaultMessage:"{numWeeks, plural, one {{numWeeks} week ago} other {{numWeeks} weeks ago}}"},hour:{id:"timeUtils.durationDescriptor.hour",defaultMessage:"{numHours, plural, one {{numHours} hour ago} other {{numHours} hours ago}}"},minute:{id:"timeUtils.durationDescriptor.minute",defaultMessage:"{numMinutes, plural, one {{numMinutes} minute ago} other {{numMinutes} minutes ago}}"},second:{id:"timeUtils.durationDescriptor.second",defaultMessage:"Just now"}}),l=(0,r.defineMessages)({year:{id:"timeUtils.durationDescriptor.ultraCompactYear",defaultMessage:"{numYears}y"},day:{id:"timeUtils.durationDescriptor.ultraCompactDay",defaultMessage:"{numDays}d"},week:{id:"timeUtils.durationDescriptor.ultraCompactWeek",defaultMessage:"{numWeeks}w"},hour:{id:"timeUtils.durationDescriptor.ultraCompactHour",defaultMessage:"{numHours}h"},minute:{id:"timeUtils.durationDescriptor.ultraCompactMinute",defaultMessage:"{numMinutes}m"},second:{id:"timeUtils.durationDescriptor.ultraCompactSeconds",defaultMessage:"Just now"}}),c=(0,r.defineMessages)({year:{id:"timeUtils.durationDescriptor.compactYear",defaultMessage:"{numYears}y ago"},day:{id:"timeUtils.durationDescriptor.compactDay",defaultMessage:"{numDays}d ago"},week:{id:"timeUtils.durationDescriptor.compactWeek",defaultMessage:"{numWeeks}w ago"},hour:{id:"timeUtils.durationDescriptor.compactHour",defaultMessage:"{numHours}h ago"},minute:{id:"timeUtils.durationDescriptor.compactMinute",defaultMessage:"{numMinutes}m ago"},second:{id:"timeUtils.durationDescriptor.compactSecond",defaultMessage:"Just now"}});function d(e){let{useCompactFormat:t,useUltraCompactFormat:n,useLowercase:o,roundDownYears:r,useWeeks:d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const u=n?l:t?c:s,p=new Date(e),m=a.default.getIntl().locale,f=new Date,g=+f-e;if(g>=i._I&&r){const e=Math.floor(g/i._I);return a.default.formatMessage(u.year,{numYears:e})}if(p.getFullYear()!==f.getFullYear()){const e={year:"numeric",month:"short",day:"numeric"},t={year:"numeric",month:"2-digit",day:"2-digit"};return p.toLocaleDateString(m,n?t:e)}const h=Math.floor(g/i.A0);if(h<28&&h>7&&d){const e=Math.floor(h/7);return a.default.formatMessage(u.week,{numWeeks:e})}if(h>=3)return p.toLocaleDateString(m,{month:"short",day:"numeric"});if(h>=1)return a.default.formatMessage(u.day,{numDays:h});const v=Math.floor(g/i.U6);if(v>=1)return a.default.formatMessage(u.hour,{numHours:v});const b=Math.floor(g/i.hM);return b>=1?a.default.formatMessage(u.minute,{numMinutes:b}):o?a.default.formatMessage(u.second).toLocaleLowerCase():a.default.formatMessage(u.second)}function u(e,t){const n=t-e,r=Math.floor(n/i._I),s=Math.floor(n/i.A0),l=Math.floor(n/i.U6),c=Math.floor(n/i.hM),d=Math.floor(n/i.C0);return r>=1?a.default.formatMessage(o.eG.year,{numYears:r}):s>=1?a.default.formatMessage(o.eG.day,{numDays:s}):l>=1?a.default.formatMessage(o.eG.hour,{numHours:l}):c>=1?a.default.formatMessage(o.eG.minute,{numMinutes:c}):a.default.formatMessage(o.eG.second,{numSeconds:d})}function p(e,t){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"long",year:"numeric",day:"2-digit",hour:"numeric",minute:"2-digit",second:t?void 0:"2-digit"})}function m(e){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"short",year:"numeric",day:"numeric"})}},35328:(e,t,n)=>{n.d(t,{BX:()=>p,JO:()=>c,_A:()=>l,fn:()=>m,ih:()=>s,m1:()=>u,tZ:()=>d,th:()=>f});var o=n(41432),i=n(29373),r=n(27724),a=n(45131);function s(e){return Boolean(o.ZY[e])}function l(e,t){return Boolean("toggle"===e||o.wZ[e]&&(null==t?void 0:t.toggleable))}function c(e){return Boolean(o.wZ[e])}function d(e){return o.ZY[e]}function u(e){return o.wZ[e]}function p(e){return"toggle"===e.getType()||m(e)}function m(e){const t=e.getType(),n=e.getFormat();return Boolean(void 0!==t&&(0,o.eJ)(t,n))}function f(e,t,n){let o;o=r.default.state.stores.includes(t)?r.default.state.stores:[t];const s=!(a.Z.isOpen(t.id)&&!n);for(const r of o)i.rd({blockId:r.id,state:s,currentUserId:e.currentUser.id})}},11540:(e,t,n)=>{n.d(t,{R:()=>i});var o=n(77080);function i(){return o.default.getEligibleGroup({experimentId:"public_site_topbar_cta",defaultGroup:"control"})}},16861:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(68626);n(95477);const i={provider:void 0,logInvertedTextOperationError(e){const{invertedOperation:t,maybeRemappedInvertedOperation:n,transaction:i,errorCode:r}=e;if(this.provider)return this.provider.logInvertedTextOperationError(e);const a=i.getUserActionForAnalyticsPurposesOnly(),{command:s}=t,l=`Applying inverted text operation "${s}" from transaction "${a}" failed with error "${r}".`;o.log({level:"error",from:"transactionDebugHelpers",type:"crdt:logInvertedTextOperationError",error:{message:l},data:{userAction:a,operation:s,errorName:r}})}}},99341:(e,t,n)=>{n.d(t,{JG:()=>a,Vm:()=>r,_V:()=>l,jQ:()=>s});n(57658);var o=n(72126),i=n(77337);function r(e,t){let{allowSquashing:n}=t;if(0===e.length)return{squashedTasks:[]};const r={squashedTasks:[],userId:e[0].userId};function a(e){var t,a;const s=o.Z$(r.squashedTasks),l=s?s.task:void 0,c=Boolean((null===(t=e.debug)||void 0===t?void 0:t.userFlow)||(null==l||null===(a=l.debug)||void 0===a?void 0:a.userFlow));s&&l&&n&&!c&&function(e,t){function n(e){const t=e.operations.map((e=>e.pointer));return o.sv(t,o.Xy)}const i=n(e),r=n(t);return 1===i.length&&1===r.length&&o.Xy(i,r)}(l,e)?(l.operations=(0,i.Iw)([...l.operations,...e.operations]),s.subTasks.push(e)):r.squashedTasks.push({task:{...e},subTasks:[e]})}for(const i of e){if(r.userId!==i.userId)return r;if(JSON.stringify(o.VS(r.squashedTasks,(e=>e.task.operations))).length>=l)return 0===r.squashedTasks.length&&a(i),r;a(i)}return r}function a(e){const{transaction:t,timestamp:n,callback:o}=e;return{id:t.id,userId:t.userId,spaceId:t.spaceId,debug:{userAction:t.getUserActionForAnalyticsPurposesOnly(),userFlow:t.getUserFlowForAnalyticsPurposesOnly()},timestamp:n,operations:t.operations,callback:o,useSudoMode:t.useSudoMode}}function s(e){const t=a({transaction:e,timestamp:Date.now(),callback:void 0});return JSON.stringify(t).length>l}const l=1e5},64856:(e,t,n)=>{n.d(t,{AK:()=>a,IJ:()=>c,W$:()=>r,Xv:()=>s,ox:()=>l,wF:()=>d});var o=n(72126),i=n(9163);function r(e,t){return a(d(e,t))}function a(e){return void 0!==e&&(e===i.FW||e===i.lR)}function s(e,t){if(a(t))return;const n=i.eU[e],o=n.steps.findIndex((e=>e.id===t));return-1===o?n.steps[0].id:o===n.steps.length-1?i.FW:n.steps[o+1].id}function l(e,t){const n=d(e,t);if(n&&!a(n))return s(t,n)}function c(e,t){const n=d(e,t);if(n)return function(e,t){const n=i.eU[e];var r;if(a(t))return null===(r=(0,o.Z$)(n.steps))||void 0===r?void 0:r.id;const s=n.steps.findIndex((e=>e.id===t));return-1!==s&&0!==s?n.steps[s-1].id:void 0}(t,n)}function d(e,t){var n;if(!e)return;const o=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===o?i.eU[t].steps[0].id:o}},66638:(e,t,n)=>{n.d(t,{u:()=>a});var o=n(18245),i=n(88923),r=n(94134);function a(e){const{environment:t,type:n,blockStore:a,store:s,isInCollectionView:l}=e,c=o.default.mark(n),d=null==a?void 0:a.getType(),u=null==a?void 0:a.useCrdt();o.default.measureAfterNextFlush(c,{environment:t,getData:()=>{const e=null==a?void 0:a.getType(),t=a&&"properties"===s.path[0]&&"title"===s.path[1],n=a&&"properties"===s.path[0]&&"caption"===s.path[1];return{table:s.table,block_property:t?"title":n?"caption":void 0,block_type:e,use_crdt:u,block_type_initial:e!==d?d:void 0,peek_mode:i.default.state.mode,is_in_collection_view:l,profiling_tool:r.getProfilingToolForSession()}}})}},83089:(e,t,n)=>{function o(e){const{unicode:t,fallback:n}=e;try{return t()}catch(o){return n}}n.d(t,{D_:()=>r,Ff:()=>i,V9:()=>o});const i=o({unicode:()=>/\p{L}/u,fallback:/[a-zA-Z]/});function r(e){return i.test(e)}},36867:(e,t,n)=>{n.d(t,{_:()=>a,g:()=>s});var o=n(7057),i=n(15157);const r="userSessionCount";function a(e){const t=c(e);if(!t)return void l({userId:e,count:1});const{count:n,updatedAt:i}=t;(0,o.$6)(i,!0)!==(0,o.$6)(Date.now(),!0)&&l({userId:e,count:n+1})}function s(e){if(!e)return 0;const t=c(e);return(null==t?void 0:t.count)||0}function l(e){let{userId:t,count:n}=e;const o={count:n,updatedAt:Date.now()};i.Z.set({userId:t,key:r,value:o})}function c(e){return i.Z.get({userId:e,key:r})}},85644:(e,t,n)=>{function o(e){return e.isType("page")&&!e.isLocked()&&!e.isCollectionView()&&!e.isInsideCollection()&&!e.isAssociatedCollectionAPageTree()&&e.canEdit()}function i(e){var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())??!1}n.d(t,{A:()=>i,z:()=>o})},73819:(e,t,n)=>{n.d(t,{Iy:()=>S,PE:()=>y,ez:()=>b,rv:()=>_});var o=n(67294),i=n(60177),r=n(64338),a=n(13991),s=(n(480),n(97511)),l=n(33125),c=n(86628),d=n(24405),u=n(8848),p=n(82990),m=(n(92650),n(67669)),f=n(65598),g=n(58202),h=n(26136),v=n(99757);function b(e,t,n,a){const s=(0,i.Dl)();(0,r.q7)(null==s?void 0:s.domLock),(0,o.useImperativeHandle)(t,(()=>n),[n]),(0,l.c)(g.R,(()=>n),[n]);return e&&!(0,f.SJ)(e)?a:null}function y(e,t){const n=(0,s.l)();return(0,c.VK)((()=>{if(t)return!1;if(v.n.state)return!1;const o=n&&n.publicEditModeStore.state;return!(0,m.YF)(o)&&e.canEdit()}),[t,n,e])}function _(e){const t=(0,d.Fg)();return(0,c.VK)((()=>{const n=e.getFormat().block_color||"default";return(0,u.fi)(n,t)}),[e,t])}function S(e){return(0,c.VK)((()=>{const t=e.getRecordStoreUIRoot();if(!(t instanceof h.G))return;const n=t.getFormatStore().getKeyStore("page_font").getValue();return p.Z.getHeaderFontFamily({pageFont:n,locale:a.SP})}),[e])}},28267:(e,t,n)=>{n.d(t,{X:()=>r});var o=n(67294),i=n(77794);function r(e){const[t,n]=(0,o.useState)(void 0);return(0,o.useEffect)((()=>{if(!e.current)return;const t=new i.E;return t.observe(e.current),t.rect.addListener((e=>{n(e.state)})),()=>{t.destroy()}}),[e]),t}},63474:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(67294),i=n(480),r=n(77472);function a(){const e=(0,i.O7)();return(0,o.useMemo)((()=>(0,r.mc)(e)),[e])}},26344:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(67294),i=n(72126),r=n(12534);function a(e){return(0,o.useMemo)((()=>({onMouseDown:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorMouseDown,callback:i.yR})},onClick:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorClick,callback:i.yR})},onDoubleClick:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorDoubleClick,callback:i.yR})},onContextMenu:t=>{e&&(0,r.ZP)({event:t,context:r.Af.EditorContextMenu,callback:i.yR})}})),[e])}},84398:(e,t,n)=>{n.d(t,{$:()=>a});var o=n(67294),i=n(26263),r=n(480);function a(e,t){const{cacheFallback:n,isMockTextStore:a,isTemporaryData:s,overrideDefaultRecordCache:l}=t??{},c=(0,r.O7)(),{inMemoryRecordCache:d}=c.defaultRecordCache,u=(0,o.useMemo)((()=>{const t=new i.Z({isTemporaryData:Boolean(s),name:e});return t.isMockTextStore=Boolean(a),n&&t.addCacheFallback(n),l&&d.addCacheOverride(t),t}),[n,d,a,s,e,l]);return(0,o.useEffect)((()=>function(){n&&u.removeCacheFallback(n),l&&d.removeCacheOverride(u)}),[n,d,u,l]),u}},35630:(e,t,n)=>{n.d(t,{AS:()=>s,iP:()=>l});var o=n(67294),i=n(480),r=n(86628);const a=(0,o.createContext)(void 0);function s(e){const t=(0,r.VK)((()=>e.state.height),[e]),n=(0,o.useContext)(a)||window;return n!==window?n.innerHeight:t}function l(){const{WindowSizeStore:e}=(0,i.O7)();return(0,r.VK)((()=>{const{width:t,height:n}=e.state;return{width:t,height:n}}),[e])}},5659:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(92595),i=n(55652),r=n(4408),a=n(45950);const s=(0,o.exposeDebugValue)("offlineDebugger",new class{constructor(){var e=this;this.enableLogging=!1,this.operationLatency={},this.log=function(t){if(e.enableLogging){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];console.groupCollapsed(t,...o),console.trace(),console.groupEnd()}},this.generateLocalRecordMap=a.yY,this.getLocalRecord=a.Ye,this.getLocalBlocksWithParent=a.Dx}async measure(e,t,n){var o=this;const r=`OFFLINE: ${e}:`;return this.operationLatency[e]||(this.operationLatency[e]=new i.s((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.log(r,...t)}))),this.operationLatency[e].measureErrors(t,"hit","miss",n)}trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}traceMiss(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];this.trace(`missed: record ${e}:${t}`,...o)}clearMemory(){r.LK(window.__console.environment)}})},76856:(e,t,n)=>{function o(e,t,n,o,i){const r="y"===i?"scrollTop":"scrollLeft",a=e[r],s=t-a,l=+new Date;let c=!0,d=null;const u=()=>{if(!c)return;window.requestAnimationFrame(u);const i=+new Date,p=Math.floor(function(e,t,n,o){return(e/=o/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}(i-l,a,s,n));d?d===e[r]?(e[r]=p,d=e[r]):c=!1:(e[r]=p,d=e[r]),i>l+n&&(e[r]=t,c=!1,o&&o())};window.requestAnimationFrame(u)}n.d(t,{Z:()=>o})},75233:(e,t,n)=>{n.d(t,{Z:()=>i});n(21703);var o=n(26263);const i=new class{constructor(){this.pendingEvictions=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.pendingEvictions=new Map}getPendingEvictionCount(){return this.pendingEvictions.size}updateEnvironment(e){this.environmentProvider=()=>e}addToPendingEvictions(e,t){const n=(0,o.R)(e),i={...e,timestamp:t};this.pendingEvictions.set(n,i)}removeFromPendingEvictions(e){this.pendingEvictions.delete((0,o.R)(e))}forEachPendingEviction(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingEvictions.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}}},79420:(e,t,n)=>{n.d(t,{Z:()=>r});n(21703);var o=n(26263),i=n(21202);const r=new class{constructor(){this.subscribedRecords=void 0,this.pendingUnsubscribeRecords=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}getPendingUnsubscribeCount(){return this.pendingUnsubscribeRecords.size}updateEnvironment(e){this.environmentProvider=()=>e}getSubscriptionForRecord(e){return this.subscribedRecords.get((0,o.R)(e))}isSubscribedToRecord(e){const t=this.subscribedRecords.get((0,o.R)(e));return Boolean(t)}addToSubscribedRecords(e){const t=(0,o.R)(e),n={...e};this.subscribedRecords.set(t,n)}removeFromSubscribedRecords(e){const t=(0,o.R)(e);this.subscribedRecords.delete(t)}addToPendingUnsubscribeRecords(e,t){const n=(0,o.R)(e),i={...e,timestamp:t};this.pendingUnsubscribeRecords.set(n,i)}removeFromPendingUnsubscribeRecords(e){this.pendingUnsubscribeRecords.delete((0,o.R)(e))}forEachPendingUnsubscribeRecord(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingUnsubscribeRecords.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}reset(){this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}safelyGetEnvironment(){try{return this.environmentProvider()}catch(e){return}}getSubscribedBlockDebuggingData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.safelyGetEnvironment();if(!t)return;const n={loadedBlockTypes:{},loaded:0,notLoaded:0};for(const[o,r]of this.subscribedRecords.entries())if((e||!this.pendingUnsubscribeRecords.has(o))&&r.pointer.table===i.iU){const e=t.defaultRecordCache.inMemoryRecordCache.getRecord(r);if(e&&e.value){const t=e.value.type;t in n.loadedBlockTypes||(n.loadedBlockTypes[t]=0),n.loadedBlockTypes[t]+=1,n.loaded+=1}else n.notLoaded+=1}return n}}},32223:(e,t,n)=>{n.r(t),n.d(t,{isConnected:()=>r.Mb,isConnecting:()=>r.J9,onMobileNativeReceiveRawMessageStoreMessage:()=>r.tD,onMobileNativeUpdateMessageStoreState:()=>r.Ce,resetRecordSubscriptions:()=>a,updateEnvironment:()=>s});var o=n(75233),i=n(79420),r=n(88536);function a(){i.Z.reset()}function s(e){i.Z.updateEnvironment(e),o.Z.updateEnvironment(e)}},88536:(e,t,n)=>{n.d(t,{vj:()=>Be,mb:()=>V,cO:()=>Ae,C$:()=>j,EM:()=>he,ZN:()=>ve,Tm:()=>ge,gE:()=>be,Mb:()=>ce,J9:()=>de,id:()=>ue,Ap:()=>De,tD:()=>Te,Ce:()=>Ce,eg:()=>Ee,Tg:()=>ke,Ji:()=>Pe,Ld:()=>Ze,hd:()=>Fe,r1:()=>je,L4:()=>Me,g4:()=>pe});n(57658),n(21703);var o=n(40682),i=n(68626),r=n(7406),a=n(29477),s=n(21051);const l=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.maxDelayMs=void 0,this.timeSource=void 0,this.queue=[],this.workerTasks=new Map,this.nextWorkerId=0,this.currentWorkers=0,this.requestsRunning=0,this.awaitingTimeout=!1,this.dequeue=async()=>{if(this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;const e=this.nextWorkerId;this.nextWorkerId++,this.currentWorkers++;const t=this.queue.splice(0,this.batchSize),n=t.map((e=>e[0]));let o,i;this.workerTasks.set(e,t),this.requestsRunning+=t.length;try{o=await this.performRequests(n)}catch(a){i=(0,r.tg)(a)}try{if(i)for(let e=0;e<t.length;e++){t[e][1].reject(i)}else if(o)for(let e=0;e<t.length;e++){const n=t[e],i=o[e];n[1].resolve(i)}}catch(a){}this.currentWorkers--,this.workerTasks.delete(e),this.requestsRunning-=t.length,this.dequeueAfterFilledBatchOrTimeout()};const{performRequests:t,batchSize:n,maxWorkers:o,maxDelayMs:i}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=o,this.maxDelayMs=i,this.timeSource=s.O}getStats(){return{queue:this.queue.length,running:this.requestsRunning,workers:this.currentWorkers}}updateTimeSource(e){this.timeSource=e}updateBatchSize(e){this.batchSize=e}updateMaxDelayMs(e){this.maxDelayMs=e}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterFilledBatchOrTimeout()}enqueue(e){const t=a.UZ();return this.queue.push([e,t]),this.dequeueAfterFilledBatchOrTimeout(),(0,o.m)({promise:t.promise,canCancel:()=>this.queue.some((e=>e[1]===t)),cancel:e=>{const n=this.queue.findIndex((e=>e[1]===t));n>=0&&(this.queue.splice(n,1),t.reject(e))}})}dequeueAfterFilledBatchOrTimeout(){this.queue.length>=this.batchSize?this.dequeue():this.awaitingTimeout||(this.awaitingTimeout=!0,this.timeSource.setTimeout((()=>{this.awaitingTimeout=!1,this.dequeue()}),this.maxDelayMs))}cancel(){const e=this.workerTasks,t=this.queue;this.workerTasks=new Map,this.queue=[];for(const n of e.values())for(const e of n)e[1].reject(new Error("CanceledTask."));for(const n of t)n[1].reject(new Error("CanceledTask."))}};var c=n(72126),d=n(91155),u=n(77897),p=n(75189),m=n(44615),f=n(4615),g=n(12139),h=n(63143),v=n(36054),b=n(95477),y=n(18245),_=n(5162),S=n(88632);const w=window.location.host.endsWith(b.default.publicDomainName);var k=n(1302),I=n(77472),x=n(77080);function C(e,t){k.default.afterNextFlush((()=>{x.default.checkGate("message_store_client_send_request_metric_enabled")&&I.j(e,"message_store.client.send_request",t)}))}const T=async()=>n.e(7168).then(n.bind(n,14854)),M=!1,P=90*h.C0,A=.5*h.C0,R=30*h.C0,D=10*h.C0,B={versions:!0,collection:!0,activity:!0,notification:!0,teams_in_space:!0,user_page_visit:!0,backlinks:!0,user_content:!0,page_visit:!0,user_shared_pages_in_space:!0,presence:!0,user_joined_teams_in_space:!0,teams_migration_completed_in_space:!0,diagnosticPing:!0,_other:!0};function E(e){const t=e.indexOf("/");if(-1===t)return"_other";const n=e.substring(0,t);return n in B?n:"_other"}function F(e,t){var n;const o=E(t),i=null===(n=(0,m.pz)(t))||void 0===n?void 0:n.table,r=e[o];if(r){if(i){const e=r[i];if(!e)return void Ye(`Warning: "${o}.${i}" has no existing counters!`);r[i]=e-1}r._total-=1,e._total-=1}else Ye(`Warning: "${o}" has no existing counters!`)}function Z(e){return{_id:e,charactersSent:0,requestsSent:0,requestsTimedOut:0,responsesReceivedWithoutHandlers:0,successfulResponsesReceived:0,unsuccessfulResponsesReceived:0,invalidMessagesReceived:0,notificationsReceived:0,messagesReceived:0}}function V(){return{...ie}}function j(e){const t=ie;if(e._id===t._id)return{charactersSent:t.charactersSent-e.charactersSent,requestsSent:t.requestsSent-e.requestsSent,requestsTimedOut:t.requestsTimedOut-e.requestsTimedOut,responsesReceivedWithoutHandlers:t.responsesReceivedWithoutHandlers-e.responsesReceivedWithoutHandlers,successfulResponsesReceived:t.successfulResponsesReceived-e.successfulResponsesReceived,unsuccessfulResponsesReceived:t.unsuccessfulResponsesReceived-e.unsuccessfulResponsesReceived,invalidMessagesReceived:t.invalidMessagesReceived-e.invalidMessagesReceived,notificationsReceived:t.notificationsReceived-e.notificationsReceived,messagesReceived:t.messagesReceived-e.messagesReceived}}const U=new Map,L=new Map;class O extends Map{isCancelable(e){return Boolean(this.getCancelable(e))}getCancelable(e){const t=this.get(e);if(null!=t&&t.canCancel())return t}}const N=new O,z=new O,W=new Map,q=new Map,H=Date.now();let K={_total:0};const G="messageStoreInternals",$=new i.BatchedLogger({from:G,type:"BulkDebug",level:"info",maxLength:250,logToConsole:M});let Q,Y,J,X,ee=0,te=0,ne=0,oe=0,ie=Z(0),re=0,ae=s.O,se=!1,le="uninitialized";function ce(){return"open"===le}function de(){return"uninitialized"===le||"opening"===le}const ue=!0;function pe(e,t){let n=q.get(e);n||(n={},q.set(e,n)),Object.assign(n,t)}function me(e){$.log({level:"info",from:G,type:e})}function fe(){Y=function(e){var t;const n=null==e||null===(t=e.socket)||void 0===t||null===(t=t.transport)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.transport;if("websocket"===n||"polling"===n)return n}(this),me(`ping:${Y}`),Q=Date.now(),Ye(`Incoming primus ping received from server via ${Y}.`)}function ge(){return K}function he(){return{...Ue.getStats(),batchSubscribeQueue:Oe.getStats(),batchUnsubscribeQueue:Ne.getStats()}}function ve(e){const{lastOfflineTimestamp:t}=S.Z.getState(),n=he(),{batchSubscribeQueue:o,batchUnsubscribeQueue:i}=n;return{currentConnectionCounters:ie,timeSinceLastIncomingPing:Q&&e-Q,lastIncomingPingTransportType:Y,timeSinceLastResponseReceived:J&&e-J,timeSinceLastReadyStateChange:X&&e-X,timeSinceLastOffline:t&&e-t,largestMessageSize:re||void 0,messageStoreRequestsQueued:n.queue,messageStoreRequestsRunning:n.running,batchSubscribeQueue:o,batchUnsubscribeQueue:i,messageStoreConnectionState:le,uptime:e-H,subscriptionCounters:K,primusEndEventsReceived:te,primusErrorEventsReceived:ne,connectionResetsDueToFailedRequests:oe}}function be(){const e=[];L.forEach(((t,n,o)=>{const i=(0,m.pz)(n);i&&t.value&&e.push({id:i.id,table:i.table,version:t.value})}));const t=c.vM(e,(e=>e.table)),n={};return Object.entries(t).map((e=>{let[t,n]=e;const o={};return n.forEach((e=>{o[e.id]=e.version})),{table:t,value:o}})).forEach((e=>{n[e.table]=e.value})),n}function ye(e){switch($.log({level:"info",from:G,type:"readyStateChange",data:{message:e}}),X=Date.now(),e){case"end":le="closed";break;case"open":le="open";break;case"opening":le="opening"}}const _e=c.HP((e=>async function(e){if(w)return;if($e(e))return void i.log({level:"warning",from:G,type:"CreatePrimusClientCalledForNativeMessageStoreClient"});ee+=1;const{createClient:t}=await T(),n=t({minReconnectDelayMs:4*h.C0,maxReconnectDelayMs:8*h.C0});return n.on("data",Ke),n.on("open",(()=>{me("open"),Se(e)})),n.on("reconnected",(e=>{xe(),$.log({level:"info",from:G,type:"reconnected",data:{message:`Reconnected in ${null==e?void 0:e.duration} ms`}})})),n.on("reconnect",(()=>{me("reconnect")})),n.on("reconnect scheduled",(e=>{$.log({level:"info",from:G,type:"reconnect scheduled",data:{message:`Reconnecting in ${null==e?void 0:e.scheduled} ms, attempt ${null==e?void 0:e.attempt} of ${null==e?void 0:e.retries}`}})})),n.on("reconnect timeout",(()=>{me("reconnect timeout")})),n.on("reconnect failed",(()=>{me("reconnect failed")})),n.on("timeout",(()=>{me("timeout")})),n.on("destroy",(()=>{me("destroy")})),n.on("close",(()=>{me("close")})),n.on("online",(()=>{me("online")})),n.on("offline",(()=>{me("offline")})),n.on("error",(e=>{let t;t="TransportError"===e.type?{level:"info",from:G,type:"primusTransportError",error:(0,d.Ui)(e)}:{level:"error",from:G,type:"unknownPrimusError",error:(0,d.Ui)(e)};(0,u.lB)(1)&&i.rateLimitedLog(t),$.log(t),ne+=1})),n.on("incoming::ping",fe),n.on("readyStateChange",ye),n.on("end",(()=>{me("end"),n.off("readyStateChange",ye),te+=1,async function(e,t){var n,o;i.log({level:"info",from:G,type:"messageStoreEnd",error:{message:`SocketId: ${null==e||null===(n=e.socket)||void 0===n?void 0:n.id} Query:${null==e||null===(o=e.transport)||void 0===o?void 0:o.query}`}}),Ie(),ae.setTimeout((()=>{void 0!==e&&e.destroy()}),0);const r=await _e(t);if(e!==r)return;_e.cache.clear(),ae.setTimeout((()=>{_e(t)}),2*h.C0)}(n,e)})),window.__primusClient=n,n}(e)),(function(){return"primus"}));function Se(e){ie=Z(ie._id+1),U.forEach(((t,n)=>{const o=L.get(n);Re(n,o?o.version:-1,e).catch((e=>{i.log({level:"warning",from:G,type:"ReconnectSubscriptionError",error:(0,d.Ui)(e)})}))}))}let we;function ke(e){if(we)throw new Error("Having more than one onRestartMessageStoreConnectionHandler is not currently supported");we=e}function Ie(){var e;se=!1,Oe.cancel(),Ne.cancel(),function(){for(const e of W.values())window.clearTimeout(e.timeout);W.clear()}(),N.clear(),z.clear(),ze.cancel(),Ue.cancel(),q.clear(),K={_total:0},null===(e=we)||void 0===e||e()}function xe(){Ie()}function Ce(e,t){if(!$e(t))return;Ye("onMobileNativeUpdateMessageStoreState",e);const n=!("open"===le)&&"open"===e;n&&xe(),ye(e),n&&Se(t)}function Te(e,t){if(!$e(t))return;const n=JSON.parse(e);Ye("onMobileNativeReceiveRawMessageStoreMessage",n),ce()||Ce("open",t),Ke(n)}async function Me(e){var t;const{key:n,field:o,updates:i,ttl:r,environment:a}=e;await(null===(t=He({method:"updateField",request:{key:n,field:o,updates:i,ttl:r},environment:a}))||void 0===t?void 0:t.response)}async function Pe(e){var t;const{key:n,field:o,value:i,ttl:r,environment:a}=e;await(null===(t=He({method:"setField",request:{key:n,field:o,value:i,ttl:r},environment:a}))||void 0===t?void 0:t.response)}async function Ae(e){if(w)return{type:"messageStoreDisabled"};const t=(0,f.ZP)(),{environment:n}=e,o=(0,m.JK)(t),i="diagnosticPing",r=a.UZ(),s=e.logToConsole??M,l={};function c(e,t){l[e]=t,s&&console.log(`diagnosticPing ${e}=${t}`)}const d=await a.aM(async function(){var e;const a=performance.now();await Ze(o,((e,t)=>{t&&r.resolve(performance.now())}),i,n);const s=performance.now(),d=s-a;c("registerSubscriptionResponseMs",d);const u=await(null===(e=He({method:"diagnosticPing",request:{id:t},environment:n,onRequestSent:()=>{c("diagnosticPingEnqueuedMs",performance.now()-s)}}))||void 0===e?void 0:e.response);if(!u)return{type:"canceled",key:o,...l};const p=function(e){const t=l[e];if(void 0===t)throw new Error(`Assertion failure, expected timing for "${e}" to be defined`);return t}("diagnosticPingEnqueuedMs"),m=u.setValueTime;c("diagnosticPingServerSideSetValueMs",m);const f=performance.now()-s;c("diagnosticPingResponseMs",f);const g=await r.promise-s;c("diagnosticPingNotificationMs",g);const h=performance.now();await je(o,i,n);const v=performance.now();return{type:"success",key:o,registerSubscriptionResponseMs:d,diagnosticPingEnqueuedMs:p,diagnosticPingServerSideSetValueMs:m,diagnosticPingResponseMs:f,diagnosticPingNotificationMs:g,unregisterSubscriptionResponseMs:v-h,totalMs:v-a}}().catch((e=>(g.rn(e,{from:G,type:"diagnosticPingError",data:{key:o}}),{type:"error",key:o,...l}))),R);return d.timeout?{type:"timeout",key:o,...l}:d.result}async function Re(e,t,n){ue&&pe(e,{latestRegisterSubscriptionRequestTimestamp:Date.now()}),function(e,t){var n;const o=E(t),i=null===(n=(0,m.pz)(t))||void 0===n?void 0:n.table;let r=e[o];if(r||(r={_total:0},e[o]=r),i){const e=r[i]||0;r[i]=e+1}r._total+=1,e._total+=1}(K,e);const o=z.getCancelable(e);if(o)o.cancel(new Error("Cancelled by sendRegisterSubscription()"));else{const o={key:e,version:t},i=Oe.enqueueCancelable({request:o,environment:n});if(i){N.set(e,i.asyncQueuePromise);try{await i.response}finally{N.delete(e)}}}ue&&pe(e,{latestRegisterSubscriptionResponseTimestamp:Date.now()})}function De(e){return N.isCancelable(e)}function Be(e,t){const n=N.getCancelable(e);if(!n)throw new Error(`Assertion failure, subscription request for key ${e} does not exist or is not cancelable`);Ve(e,t)&&(F(K,e),n.cancel(new Error("Cancelled by cancelRegisterSubscription()")),ue&&q.delete(e))}async function Ee(e,t,n){var o;await(null===(o=He({method:"registerOnDisconnect",request:{disconnectId:e,operations:t},environment:n}))||void 0===o?void 0:o.response)}async function Fe(e,t){var n;await(null===(n=He({method:"unregisterOnDisconnect",request:{disconnectId:e},environment:t}))||void 0===n?void 0:n.response)}async function Ze(e,t,n,o){if(w)return;let i=U.get(e);if(!i||0===i.length)return i=[{listener:t,listenerId:n}],U.set(e,i),void(ce()?await Re(e,-1,o):"uninitialized"!==le||$e(o)||await _e(o));if(i.find((e=>e.listenerId===n)))i=[...i.filter((e=>e.listenerId!==n)),{listener:t,listenerId:n}],U.set(e,i);else{i=[...i,{listener:t,listenerId:n}],U.set(e,i);const o=L.get(e);o&&t(e,o.value,o.passThroughData)}}function Ve(e,t){if(w)return!1;const n=U.get(e);if(!n)return!1;const o=n.filter((e=>e.listenerId!==t));return o.length!==n.length&&(0===o.length?(U.delete(e),L.delete(e),!0):(U.set(e,o),!1))}async function je(e,t,n){Ve(e,t)&&ce()&&await async function(e,t){ue&&pe(e,{latestUnregisterSubscriptionRequestTimestamp:Date.now()}),F(K,e);const n=N.getCancelable(e);if(n)n.cancel(new Error("Cancelled by sendUnregisterSubscription()"));else{const n={key:e},o=Ne.enqueueCancelable({request:n,environment:t});if(o){z.set(e,o.asyncQueuePromise);try{await o.response}finally{z.delete(e)}}}ue&&q.delete(e)}(e,n)}const Ue=new o.z(20);class Le{constructor(e,t){this.queue=void 0,this.wrappedPerformRequests=async e=>{const t=e[0].environment;Ye(`Sending a batch of ${e.length} ${this.methodName} requests.`);const n=this.performRequests(t,e.map((e=>e.request)));if(!n)throw new Error("MessageStore is disabled.");const o=await n;if(!o)throw new Error("Request cancelled.");return o},this.methodName=e,this.performRequests=t,this.queue=new l({performRequests:this.wrappedPerformRequests,batchSize:250,maxDelayMs:A,maxWorkers:1})}updateTimeSource(e){this.queue.updateTimeSource(e)}getStats(){return this.queue.getStats()}cancel(){this.queue.cancel()}enqueueCancelable(e){if(w)return;const t=this.queue.enqueue(e),n=t.catch((e=>{Ye(`enqueueCancelable() for ${this.methodName} cancelled (${e.message})`)}));return{asyncQueuePromise:t,response:n}}}const Oe=new Le("registerSubscription",((e,t)=>ze.enqueue((async()=>{var n;const o=He({method:"registerBatchSubscriptions",request:{subscriptions:t},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.responses})))),Ne=new Le("unregisterSubscription",((e,t)=>ze.enqueue((async()=>{var n;const o=He({method:"unregisterBatchSubscriptions",request:{keys:t.map((e=>e.key))},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.keys.map((e=>({key:e})))})))),ze=new o.z(1);let We;function qe(){if(!We)return;const{totalRequests:e,requestCounts:t,startTime:n}=We;Ye("checkRequestThroughputForBurstWarning requestCounts =",t),e>3e3&&i.log({level:"warning",from:G,type:"BurstThroughputExceeded",data:{time:Date.now()-n,totalRequests:e,requestCounts:t}}),We=void 0}function He(e){if(w)return;const{method:t,request:n,environment:o}=e,i=y.default.mark("message_store.client.send_request.in_queue_time");C(o,{status:"enqueued",endpoint:t}),ue&&function(e){We||(We={startTime:Date.now(),totalRequests:0,requestCounts:{}},ae.setTimeout(qe,D)),We.totalRequests+=1,We.requestCounts[e]=(We.requestCounts[e]||0)+1}(t);const r=Ue.enqueue((()=>{var r;const s=(0,f.ZP)();!function(e,t){k.default.afterNextFlush((()=>{x.default.checkGate("message_store_client_send_request_metric_enabled")&&(I.j(e,"message_store.client.send_request.queue_running_size",{value:t.running}),I.j(e,"message_store.client.send_request.queue_backup_size",{value:t.queue}))}))}(o,Ue.getStats());const l=y.default.mark("message_store.client.send_request.round_trip_time");y.default.measure(i,{environment:o,data:{endpoint:t}});const c=a.UZ(),d=Date.now(),u=ue?window.setTimeout((()=>{"open"===le&&(ie.requestsTimedOut+=1,$.log({level:"info",from:G,type:"requestTimeout",data:{requestId:s,time:Date.now()-d}}))}),P):void 0;W.set(s,{resolve:c.resolve,reject:c.reject,timeout:u,sendTime:d}),$.log({level:"info",from:G,type:"requestSent",data:{requestId:s,method:t}});const p={type:`${b.default.messageStore.api}/${t}`,requestId:s,...n};return ie.requestsSent+=1,async function(e){const{message:t,environment:n}=e,o=Ge(n),i=JSON.stringify(t);ie.charactersSent+=i.length,re<i.length&&(re=i.length);if(o)o(i);else{const e=await _e(n);null==e||e.write(t)}}({message:p,environment:o}),null===(r=e.onRequestSent)||void 0===r||r.call(e),c.promise.then((e=>{y.default.measure(l,{environment:o,data:{endpoint:t}}),C(o,{status:"success",endpoint:t})})).catch((e=>{const n=Ue.getStats();C(o,{status:"failure",endpoint:t,queue_running_size:n.running,queue_backup_size:n.queue})})),c.promise}));return{response:r.catch((e=>{e instanceof Qe&&!$e(o)&&!se?(se=!0,oe+=1,me("connectionResetDueToFailedRequest"),_e(o).then((e=>{null==e||e.end()})),Ye(`sendRequest() for ${t} returned server error (${e.message}), resetting connection`,n)):Ye(`sendRequest() cancelled or errored for ${t} (${e.message})`,n)})),asyncQueuePromise:r}}function Ke(e){ie.messagesReceived+=1;const t=(0,v.Gu)(p.yx,e);if(t)return ie.invalidMessagesReceived+=1,void i.rateLimitedLog({level:"warning",from:G,type:"ValidationError",data:{miscDataToConvertToString:e},error:(0,d.Ui)(t)});const n=e;if("response"===n.type){var o;const{requestId:e,status:t,result:i}=n,r=W.get(e);if(W.delete(e),$.log({level:"info",from:G,type:"responseReceived",data:{requestId:e,response:t,time:r&&Date.now()-r.sendTime,internalProcessingTimeMs:null===(o=n.result)||void 0===o?void 0:o.internalProcessingTimeMs}}),!r)return void(ie.responsesReceivedWithoutHandlers+=1);J=Date.now(),window.clearTimeout(r.timeout),"ok"===t?(ie.successfulResponsesReceived+=1,r.resolve(i)):(ie.unsuccessfulResponsesReceived+=1,r.reject(new Qe(i)))}else{ie.notificationsReceived+=1;const{key:e,value:t,version:o,passThroughData:a}=n,s=U.get(e);if(!s)return;L.set(e,{version:o,value:t,passThroughData:a});for(const{listener:n}of s)try{n(e,t,a)}catch(r){i.log({level:"warning",from:G,type:"ListenerError",error:(0,d.Ui)(r)})}}}function Ge(e){var t;if((0,_.Y)("supportsNativeMessageStore"))return e&&(null===(t=e.mobileNative)||void 0===t?void 0:t.api.sendRawMessageStoreMessage)}function $e(e){return Boolean(Ge(e))}class Qe extends Error{constructor(e){super(e),this.name="FailedMessageStoreRequestError"}}function Ye(){}},2688:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(41641),i=n(88536);const r=new class{constructor(){this.subscriptionCount=0}addListener(e,t,n,r){if((0,o.Z)(e))return this.subscriptionCount+=1,n||(n=`subscription:${this.subscriptionCount}`),i.Ld(e,t,n,r),{key:e,subscriptionId:n}}removeListener(e,t){let{key:n,subscriptionId:r}=e;(0,o.Z)(n)&&i.r1(n,r,t)}async updateField(e,t,n,o,r){await i.L4({key:e,field:t,updates:n,ttl:o,environment:r})}async setField(e,t,n,o,r){await i.Ji({key:e,field:t,value:n,ttl:o,environment:r})}async onDisconnect(e,t,n,o){const r=`${n}/${e}`;await i.eg(r,t,o)}async clearOnDisconnect(e,t,n){const o=`${t}/${e}`;await i.hd(o,n)}}},84709:(e,t,n)=>{n.r(t),n.d(t,{subscribe:()=>w,unsubscribe:()=>T,unsubscribeAfterDelay:()=>A,unsubscribeForAllUsers:()=>x});n(21703);var o=n(1302),i=n(92595),r=n(68626),a=n(44615),s=n(63143),l=n(41641),c=n(4408),d=(n(95477),n(53730)),u=(n(57658),n(77897),n(29477),n(4615),n(50906),n(54642),n(79420)),p=n(88536);const m=60*s.C0,f=15*s.C0;s.C0;class g{constructor(e){this.map=new Map,this.timeoutMs=e}set(e){const{key:t,onTimeout:n,onClear:o,value:i}=e;this.clear(t);const r=window.setTimeout((()=>{this.map.delete(t),null==n||n()}),this.timeoutMs);this.map.set(t,{timeout:r,value:i,onClear:o})}get(e){var t;return null===(t=this.map.get(e))||void 0===t?void 0:t.value}clear(e){const t=this.map.get(e);var n;void 0!==t&&(window.clearTimeout(t.timeout),this.map.delete(e),null===(n=t.onClear)||void 0===n||n.call(t))}has(e){return this.map.has(e)}}const h=new g(m),v=new g(f);var b=n(75233),y=n(2688);const _="recordSubscriptionActions";function S(e,t,n){const o=a.pz(t);if(!o)return void r.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{version:n}}});if(null!==n&&"number"!=typeof n)return void r.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{pointer:o,version:n}}});const i=[void 0,...e.currentUser.loggedInUserIds];p.id&&((0,p.g4)(t,{latestUpdateTimestamp:Date.now()}),function(e){const t=h.get(e);t&&(t.latestUpdate=Date.now()),v.clear(e)}(t));for(const r of i){if(u.Z.getSubscriptionForRecord({userId:r,pointer:o})){const t=e.defaultRecordCache.inMemoryRecordCache.getVersion({pointer:o,userId:r}),i=d.transactionQueue.isPendingTransactionForRecord(o);(null===n||n>t)&&!i&&c.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:o,userId:r})}}}function w(e){const{pointer:t,userId:n,environment:i}=e,r={pointer:t,userId:n};k(t)||(u.Z.removeFromPendingUnsubscribeRecords(r),b.Z.removeFromPendingEvictions(r),u.Z.isSubscribedToRecord(r)||(u.Z.addToSubscribedRecords(r),o.default.afterNextFlush((()=>{const o=i.defaultRecordCache.inMemoryRecordCache.getRecord(r);o?I({record:o,...e}):c.bG({environment:i,inMemoryRecordCache:i.defaultRecordCache.inMemoryRecordCache,userId:n,pointer:t}).then((t=>{I({record:t,...e})}))}))))}function k(e){return!e.id||!e.table||("emptyDroppableKey"===e.id||"placeholder"===e.id)}function I(e){const{environment:t,pointer:n,userId:o,record:i}=e,s={pointer:n,userId:o};if(!u.Z.isSubscribedToRecord(s))return;const c=a.ZS(n);(0,l.Z)(c)&&(n.id&&n.table?y.Z.addListener(c,((e,n)=>S(t,e,n)),_,t):r.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:subscribe",type:"KeyValidationError",data:{pointer:n,miscDataToConvertToString:{record:i,key:s,versionsKey:c}}}))}function x(e){for(const t of e.environment.currentUser.loggedInUserIds)T({...e,userId:t})}function C(e){const{pointer:t}=e;if(k(t))return!1;if(!u.Z.isSubscribedToRecord(e))return!1;u.Z.removeFromSubscribedRecords(e);const n=a.ZS(t);return!!(0,l.Z)(n)&&(!(!t.id||!t.table)||(r.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:unsubscribe",type:"KeyValidationError",data:{pointer:t,miscDataToConvertToString:{versionsKey:n}}}),!1))}function T(e){const{environment:t}=e;C(e)&&y.Z.removeListener({key:a.ZS(e.pointer),subscriptionId:_},t)}const M=2*s.hM,P=M;function A(e){const{pointer:t,environment:n,userId:o}=e;if(k(t))return;if(n.defaultRecordCache.inMemoryRecordCache.hasListener(t))return;const i=a.ZS(t);if((0,p.Ap)(i)){const e={pointer:t,userId:o};return b.Z.addToPendingEvictions(e,Date.now()+P),void(C(e)&&(0,p.vj)(i,_))}u.Z.addToPendingUnsubscribeRecords(e,Date.now()+M)}function R(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];u.Z.forEachPendingUnsubscribeRecord((n=>{let{pointer:o,userId:i,timestamp:r,environment:a}=n;if(r<e){u.Z.removeFromPendingUnsubscribeRecords({pointer:o,userId:i});const e={pointer:o,userId:i};t&&console.log("Unsubscribing and evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e),T({pointer:o,userId:i,environment:a})}})),b.Z.forEachPendingEviction((n=>{let{pointer:o,userId:i,timestamp:r,environment:a}=n;if(r<e){b.Z.removeFromPendingEvictions({pointer:o,userId:i});const e={pointer:o,userId:i};t&&console.log("Evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e)}}))}setInterval((()=>{R(Date.now())}),1e4),(0,i.exposeDebugValue)("forceUnsubscribeAndEvictPendingRecords",(()=>{R(1/0,!0)})),setTimeout((()=>{(0,p.Tg)((()=>{u.Z.forEachPendingUnsubscribeRecord((e=>{let{pointer:t,userId:n,timestamp:o,environment:i}=e;u.Z.removeFromPendingUnsubscribeRecords({pointer:t,userId:n});const r={pointer:t,userId:n};b.Z.addToPendingEvictions(r,o),T({pointer:t,userId:n,environment:i})}))}))}),0)},91948:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(86628),i=n(85248),r=n(17294),a=n(85893);function s(e){let{targetRecordId:t,style:n}=e;window.__c={n:"MoveOrDuplicateProgress"};const s=(0,o.VK)((()=>r.Z.state[t]),[t]);if(!s)return null;const{taskStatus:l,completeBlocks:c,totalBlocks:d}=s,u=(()=>{switch(l){case"not_started":case"failure":return;case"success":return 100;case"in_progress":if("number"!=typeof c||"number"!=typeof d)return;if(0===d)return;const e=c/d;return 1===e?99:Math.round(100*e)}})();return"number"!=typeof u?null:(0,a.jsx)(i.k,{percentage:u,style:n})}},98110:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(86628),a=n(15145),s=n(9291),l=n(75754),c=n(6854),d=n(73744),u=n(35683),p=n(85893);function m(e){window.__c={n:"MoveToSnackbarButtons"};const t=(0,i.O7)(),n=(0,r.VK)((()=>!t.device.isPhone),[t]);return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)(f,{...e}),(0,p.jsx)(c.ow,{onUndo:void 0})]})}function f(e){let{moveToLocation:t,movedItems:n}=e;window.__c={n:"MoveToVisitButton"};const r=(0,i.O7)(),m=(0,o.useCallback)((e=>{var o;if(t)switch(t.type){case"moveToBlock":l._({environment:r,openInNew:d.DJ(e),store:t.blockStore,scrollToBlockId:null===(o=n[0])||void 0===o?void 0:o.id,visitType:u.vu.Link,pageVisitSource:a.tY.Move})}}),[r,t,n]);return t&&"moveToBlock"===t.type?(0,p.jsx)(c.Pn,{onClick:m,children:(0,p.jsx)(s.FormattedMessage,{defaultMessage:"Visit",id:"moveToHelpers.afterMoveToast.viewButton"})}):null}},41549:(e,t,n)=>{n.d(t,{Fz:()=>l,H$:()=>a,VV:()=>u,l5:()=>d,pe:()=>c,yJ:()=>s});n(57658);var o=n(63143),i=n(66353),r=n(45325);function a(e,t){const n=o.vM(e,(e=>{let{notification:t}=e;return t.navigable_block_id??t.id}));return n.forEach(((e,o)=>{const i=[],r=new Set;e.forEach((e=>{const{activity:t}=e;"commented"!==t.type&&i.push(e);const n=t.discussion_id;void 0===n||r.has(n)||(i.push(e),r.add(n))}));const a=i.filter((e=>{let{notification:n}=e;return("mentions"!==t||!n.visited)&&!("archive"===t&&!n.visited)}));0!==a.length?n.set(o,a):n.delete(o)})),n}function s(){const e=i.ZP.state||i.Ve;return(e.width<i.fK||e.width>i.Rx)&&(e.width=i.RJ),r.NotificationInboxFilterOptions.includes(e.filter)||(e.filter=i.uZ),e}function l(){return s().filter}function c(){return s().width}function d(){return"closed"===r.default.state.openState?0:c()}function u(){const e=r.default.state.openState;return"closed"===e||"closing"===e?0:c()}},50770:(e,t,n)=>{n.d(t,{H:()=>r});var o=n(5162),i=n(77080);function r(){if((0,o.Y)("supportsMobileWebInbox2"))return!0;return"on"===i.default.getEligibleGroup({experimentId:"inbox_2_0",defaultGroup:"control"})}},55081:(e,t,n)=>{n.d(t,{EV:()=>N,Ex:()=>j,I1:()=>L,Mf:()=>U,Qt:()=>W,VW:()=>z,lp:()=>O,xN:()=>V,yH:()=>Z,zJ:()=>E});n(67294);var o=n(79946),i=n(7406),r=n(68626),a=n(59730),s=n(15157),l=n(89101),c=n(15047),d=n(77858),u=n(19889),p=n(9291),m=n(38208),f=n(47307),g=n(94273),h=n(92625),v=n(97977),b=n(9953),y=n(8055),_=n(1357),S=n(70782),w=n(64369),k=n(33954),I=n(24608),x=n(33929),C=n(38755),T=n(77907),M=n(74948),P=n(80444),A=n(26136),R=n(10929),D=n(75538),B=n(85893);async function E(e,t){if(!e.currentUser.id)return!1;const n=F(e);return!!R.BB(n)||(t||(t=new A.U6(e,{table:u.KJ,id:e.currentUser.id}),await t.awaitNonNullValue()),!t.getOnboardingCompleted())}function F(e){return{...s.Z.get({userId:e.currentUser.id,key:D.onboardingPreferenceKey}),currentUserId:e.currentUser.id}}async function Z(e,t){const{state:n}=D.default;if(n.isLoading||n.isOnboarding||!e.currentUser.id)return;const o=F(e);if(!o.isOnboarding)return;if(R.NT(o)&&t&&(null==t?void 0:t.id)!==o.spaceViewId)return;const{flow:i}=o,a="desktop_join_or_create_space"===i||"mobile_join_or_create_space"===i,s=await R.dD({environment:e,disableRedirects:a});s&&(o.onboardingData=s),D.default.setState(o);const{spaceId:l}=o;if(l&&(e.device.isMobileNative&&r.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.restoreOnboardingState setting space",spaceId:l}}),P.default.setState({...P.default.state,currentSpaceStore:new A.H2(e,{table:c.bx,id:l})})),o.isOnboarding&&"spaceViewId"in o&&o.spaceViewId){const t=new A.V9(e,{table:d.zU,id:o.spaceViewId});P.default.setState({...P.default.state,currentSpaceViewStore:t})}q(e,o)}async function V(e){await L(e,{type:"create-or-join"})}const j=function(e){const{userStore:t,transaction:n}=e;b.sW({store:t,data:{onboarding_completed:!0},transaction:n})},U=function(e){const{userStore:t,transaction:n}=e;b.sW({store:t,data:{mobile_onboarding_completed:!0},transaction:n})};async function L(e,t){try{y.c4({environment:e,url:l._j.onboarding});const n=await R.dD({environment:e,disableRedirects:Boolean(t.disableRedirectUrl)||"create-or-join"===t.type}),i=R.Pn(n),r=await T.deps.onboardingStateActions.loader(),a=await r.getInitialState(e,t,n,i);if(a&&a.isOnboarding){"invalid"===i.type&&(a.stage="error"),D.default.setState(a);const t=R.jn(a);m.NG(e,t),m.y6(e,t),q(e,a),a.isNewUser&&(o.I$(),o.j({device:e.device,event:{facebook:{eventName:"CompleteRegistration"},google:{eventName:"registration"}},cookieService:e.cookieService}))}}catch(n){const t=(0,i.tg)(n);!function(e,t,n){D.default.setState({...D.default.state,isLoading:!1}),m.Gk(e,{...R.jn(D.default.state),errorMessage:t.message}),r.log({level:"error",from:"onboardingActions",type:"handleError",error:{message:`Found onboarding error: ${t.message}`}});const o=n?async()=>await v.actuallyLogoutAndDeleteAllLocalData({environment:e}):void 0;f.showMessage({message:t.message,onAccept:o})}(e,t,"WorkspaceCreationError"===t.name&&(0,a.Zw)(t)&&t.data.newUser)}}async function O(e,t){if(t.isOnboarding)try{const n=await T.deps.onboardingStateActions.loader(),o=await n.updateAndGetNextState(t,e);m.y6(e,R.jn(o)),D.default.setState(o),o.isOnboarding&&q(e,o)}catch(n){N(e,(0,i.tg)(n))}}async function N(e,t){if(D.default.setState({...D.default.state,isLoading:!1}),r.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Found onboarding error: ${t.message}`,stack:String(t.stack)}}),h.x(),t instanceof I.Gg&&(0,a.Rp)(t.data.responseBody)&&"UnauthorizedError"===t.data.responseBody.name)return void m.ho(e,{...R.jn(D.default.state),errorMessage:t.message,debugMessage:"UnauthorizedError"});let n;if(t instanceof I.Gg){var o;const e=null==t||null===(o=t.data)||void 0===o||null===(o=o.responseBody)||void 0===o?void 0:o.clientData;e&&(n=(0,k.XN)(x.default.getIntl(),e))}m.ho(e,{...R.jn(D.default.state),errorMessage:t.message,debugMessage:n||"undefined"});await f.confirmUserAction({message:(0,B.jsxs)("div",{children:[(0,B.jsx)(w.Z,{style:{fontSize:17,fontWeight:500,lineHeight:"24px",paddingBottom:8},children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Oops, something went wrong.",id:"onboardingActions.onboardingErrorDialog.message"})}),(0,B.jsx)("div",{children:n??t.message})]}),acceptLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Start over",id:"onboardingActions.onboardingErrorDialog.startOverButton.label"}),cancelLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Close",id:"onboardingActions.onboardingErrorDialog.closeButton.label"})})&&function(e,t){const n=D.default.state;R.n0(n)?L(e,{type:"new-user",disableRedirectUrl:!0}):R.y7(n)?L(e,{type:"create-or-join",disableRedirectUrl:!0}):e.device.isMobile?L(e,{type:"mobile-onboarding",disableRedirectUrl:!0}):r.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Could not redirect onboarding: ${t.message}`,stack:String(t.stack)}})}(e,t)}async function z(e){const{state:t}=D.default;if(R.n0(t)){if(!(await f.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsx)("div",{style:{fontWeight:600},children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Cancel new account setup?",id:"onboardingActions.closeOnboardingDialog.newUser.title"})}),(0,B.jsx)("div",{children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"You'll be taken back to the Notion home page.",id:"onboardingActions.closeOnboardingDialog.newUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Return to home page",id:"onboardingActions.closeOnboardingDialog.newUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.newUser.continueButton.label"})})))return;m.jw(e,R.jn(t)),await v.actuallyLogoutAndDeleteAllLocalData({environment:e})}else{if(!(await f.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsxs)("div",{style:{fontWeight:600},children:[" ",(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Cancel new workspace setup?",id:"onboardingActions.closeOnboardingDialog.existingUser.title"})]}),(0,B.jsx)("div",{style:{wordBreak:"keep-all"},children:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"You'll be taken back to your previous workspace.",id:"onboardingActions.closeOnboardingDialog.existingUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Back to previous workspace",id:"onboardingActions.closeOnboardingDialog.existingUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(p.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.existingUser.continueButton.label"})})))return;m.jw(e,R.jn(t));const{mainEditorCurrentBlockStore:o}=P.default.state,i=null==o?void 0:o.getSpaceId(),a=i&&(0,C.w3)(i);if(a){const t=a.getSpaceStore();e.device.isMobileNative&&r.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.handleCloseOnboarding set space",spaceId:null==t?void 0:t.id}}),P.default.setState({...P.default.state,currentSpaceStore:t,currentSpaceViewStore:a})}const{url:s,userId:l}=g.Vr(e);let c=e;if(l&&l!==e.currentUser.id&&(c=await S.x({environment:e,newCurrentUserId:l})),s){var n;M.close();const e=()=>{const e={isOnboarding:!1,isLoading:!1,currentUserId:l};D.default.setState(e)};y.c4({environment:c,url:s}),null!==(n=c.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone()?_.d(c,e):e()}}}function W(e){const{state:t}=D.default;m.J7(e,R.jn(t)),D.default.setState({isOnboarding:!1,isLoading:!1,currentUserId:e.currentUser.id})}function q(e,t){if(!t.isOnboarding)return;if(t.isOnboarding){const n=[...t.historicalStages||[],{stageName:t.stage,stageNumber:t.stageNumber,timestamp:Date.now()}];D.default.setState({...t,historicalStages:n.length>20?[{stageName:"truncated",stageNumber:-1,timestamp:Date.now()}]:n}),m.o7(e,"onboarding_stage",{...R.jn(t),historical_stages:n})}}},10929:(e,t,n)=>{n.d(t,{$U:()=>Q,At:()=>G,BB:()=>F,Bu:()=>V,Fz:()=>le,NT:()=>Z,Pn:()=>q,SN:()=>$,Vb:()=>se,WX:()=>Y,Wf:()=>K,YH:()=>ne,_J:()=>H,bM:()=>ae,bN:()=>J,bm:()=>re,dD:()=>U,eW:()=>E,ey:()=>N,fz:()=>D,iF:()=>L,jF:()=>O,jn:()=>W,lr:()=>j,n0:()=>R,og:()=>te,pd:()=>oe,rT:()=>ee,tr:()=>P,uO:()=>ie,vA:()=>X,y7:()=>A});var o=n(8848),i=n(80994),r=n(33728),a=n(68626),s=n(72126),l=n(15047),c=n(60949),d=n(97880),u=n(82990),p=n(9291),m=n(38208),f=n(54642),g=n(97977),h=n(76464),v=n(9953),b=n(29974),y=n(97627),_=n(82530),S=n(37181),w=n(77472),k=n(33929),I=n(38755),x=n(80444),C=n(77080),T=n(26136),M=n(75538);function P(e,t){return`/tutorial/${e}${"dark"===t.state.mode?"-dark":""}.png`}function A(e){return e.isOnboarding&&("desktop_join_or_create_space"===e.flow||"mobile_join_or_create_space"===e.flow)}function R(e){return e.isOnboarding&&("desktop_cold_start"===e.flow||"mobile_cold_start"===e.flow||"desktop_joinable_spaces"===e.flow||"mobile_joinable_spaces"===e.flow||"desktop_redirect"===e.flow||"mobile_redirect"===e.flow)}function D(e){const{state:t}=e;return R(t)}const B=(0,p.defineMessages)({personalWorkspaceName:{defaultMessage:"{userName}'s Notion",id:"onboardingHelpers.personalWorkspaceName"}});function E(e,t){return t.formatMessage(B.personalWorkspaceName,{userName:e.trim()})}function F(e){return e.isOnboarding&&Boolean(M.InAppOnboardingStages.find((t=>t===e.stage)))}function Z(e){return e.isOnboarding&&(Boolean(M.InAppOnboardingStages.find((t=>t===e.stage)))||"invite"===e.stage)}function V(e){return e.isOnboarding&&"template_optout"===e.stage}function j(e){const t=e.userStore.getEmail();if(t&&e.isUserDomainJoinable)return(0,r.Gd)(t)}async function U(e){M.default.setState({...M.default.state,isLoading:!0});const{disableRedirects:t,environment:n}=e;a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"initializeOnboardingDataLoad"}});const[o,r,s,l,c,u,p]=await Promise.all([f.getJoinableSpaces(n,{}),(0,I.iX)({environment:n,disableRedirectUrl:t}),f.isUserDomainJoinable(n,{}),f.isEmailEducation(n,{}),f.validateUserCanCreateWorkspace(n,{}),f.getVerifiedEmailDomain(n,{}),f.getGeoIpLocation(n,{})]);a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"completedOnboardingDataLoad",miscDataToConvertToString:{joinableSpacesResponseType:o.type,joinableSpacesResponseStatus:o.status,userRedirectDataId:r.userRootStore.id,isUserDomainJoinableResponseType:s.type,isUserDomainJoinableResponseStatus:s.status,validateUserCanCreateWorkspaceStatus:c.status}}}),M.default.setState({...M.default.state,isLoading:!1});const m={isUserDomainJoinable:"success"===s.type&&s.data.isJoinable,isEducationPlanEligible:"success"===l.type&&l.data.isEligible,canUserCreateSpace:"success"!==c.type||c.data.canUserCreateSpace,isUserUsingVerifiedDomain:"success"===u.type&&(0,d.$K)(u.data.id),...r,countryCode:"success"===p.type&&(0,i.GC)(p.data.countryCodeFromIp)?p.data.countryCodeFromIp:void 0};return"success"===o.type?{joinableSpaceData:o.data,...m}:{joinableSpaceData:{results:[]},...m}}async function L(e){const t=await f.getGeoIpLocation(e,{});return"success"===t.type&&(0,i.GC)(t.data.countryCodeFromIp)?t.data.countryCodeFromIp:void 0}function O(e){if(A(e)){const{userRootStore:t}=e.onboardingData;if("timed_trial_upsell"===e.stage)return!1;const n=t.getSpaceViewPointers();if(n)return n.length>0}return!1}function N(e){const{onboardingData:t,isNewUserFlow:n}=e,{userRootStore:o}=t,{results:i}=t.joinableSpaceData,r=o.getSpaceViewStores().map((e=>e.getSpaceId()));return n?i:i.filter((e=>r.indexOf(e.id)<0))}function z(e){return e.isOnboarding&&"profile"!==e.stage&&"error"!==e.stage}function W(e){var t,n,o,i,r;const{currentUserSettingsStore:a,currentSpaceStore:s}=x.default.state;return{flow_name:e.isOnboarding?e.flow:"not_defined",flow_id:e.isOnboarding?e.flowId:void 0,stage:e.isOnboarding?e.stage:"not_defined",initial_workspace_type:z(e)?e.spaceJoinOrCreate:void 0,is_new_onboarding:ee(e),is_create_or_join:A(e),stage_number:e.isOnboarding?e.stageNumber:void 0,num_of_joinable_spaces:e.isOnboarding&&"workspace_choose"===e.stage?(null===(t=e.joinableSpaces)||void 0===t?void 0:t.length)||0:void 0,historical_stages:e.isOnboarding?e.historicalStages:void 0,selectedPresets:e.isOnboarding&&"workspace_setup"===e.stage?e.selectedPresets:void 0,user_persona:null==a||null===(n=a.getSettings())||void 0===n?void 0:n.persona,user_team_role:null==a||null===(o=a.getSettings())||void 0===o?void 0:o.team_role,user_use_cases:null==a||null===(i=a.getSettings())||void 0===i?void 0:i.use_cases,user_company_size:null==a||null===(r=a.getSettings())||void 0===r?void 0:r.company_size,plan_type:null==s?void 0:s.getPlanType(),plan_selection:"planSelection"in e?e.planSelection:void 0}}function q(e){const{redirectSpaceId:t,redirectPageId:n,forkPageBlockId:o,hasExplicitAccessToRedirectPage:i,canJoinRedirectSpace:r,publicAccessPageId:a,oauthAuthorizationParams:s}=e;return s?{type:"oauth_authorization_redirect",...s}:o?{type:"fork_page",pageId:o}:!a||i||r?!t||i||r?t&&n&&i&&!r?{type:"guest_redirect",pageId:n,spaceId:t}:t&&n&&r?{type:"redirect_page",pageId:n,spaceId:t}:t&&r?{type:"redirect_space",spaceId:t}:{type:"getting_started_page"}:{type:"invalid"}:{type:"public_access_page_redirect",pageId:a}}async function H(e,t){const{onboardingData:n,name:o,profilePhoto:i,password:r,emailOptIn:a}=e,s=n.userStore;w.Zf(t,{email_optin_product_tips_and_news:a,email_optin_resources_and_events:a,email_optin_notion_for_startups:a}),_.createAndCommit({userAction:"onboardingHelpers.setProfileData",environment:t,perform:e=>{const t={...i&&{profile_photo:i}};t.name=o,v.sW({store:s,data:t,transaction:e})}});const l=await g.shouldCreatePassword(t)&&!X();r&&l&&await f.setPassword(t,{newPassword:r,sendEmail:!1})}function K(e,t){const{userPersona:n,onboardingData:o,userTeamRole:i}=t;_.createAndCommit({userAction:"onboardingHelpers.setUserPersona",environment:e,perform:e=>{const t={persona:n,team_role:i};S.d2({userSettingsStore:o.userSettingsStore,data:t,transaction:e})}})}function G(e){if(!C.default.checkGate("survey_data_writes"))return;const{environment:t,state:n,spaceStore:o,spaceViewStore:i}=e,r=(new Date).getTime();if(i){const e=c.Dh({maybeFunction:n.userPersona,guessedFunctionVersion:4,maybeRole:n.userRole,guessedRoleVersion:2,collectedFrom:"onboarding",collectedAt:r});void 0!==e&&y.Q1(t,e,i)}if(o){const e=c.K0({maybeIntent:n.planSelection,guessedIntentVersion:1,maybeCompanySize:n.companySize,guessedCompanySizeVersion:2,maybeUseCases:n.useCases,guessedUseCasesVersion:3,collectedFrom:"onboarding",collectedAt:r});void 0!==e&&b.wg(t,e,o)}}async function $(e,t){const{spaceId:n,onboardingData:o}=e;if(!n)return;const i=T.H2.createChildStore(o.userRootStore,{table:l.bx,id:n});await async function(e,t,n){t.isChecked&&t.joinableUserEmailDomain&&await b.$F({environment:e,emailDomains:[t.joinableUserEmailDomain],spaceStore:n})}(t,e,i);const{emails:r}=e,a=s.jj(r).map((e=>({type:"newUser",value:{email:e},source:"email"})));r.length>0&&(await h.n_({environment:t,store:i,inviteTargets:a,inviteRole:"editor",isOnboarding:!0,invite:{inviteOrigin:"onboarding_invite"}}),m.qJ(t,{...W(e),emails:e.emails,auto_join_space:e.isChecked,is_bulk_invite:e.isBulkInvite}))}function Q(e){const{userStore:t}=e,n=k.default.getIntl(),o=t.getFullName(n),i=t.getProfilePhoto()||null;if(o)return{name:o,profilePhoto:i,password:null,prefilled:!0,userPersona:"unfilled",userTeamRole:"unfilled"}}const Y="inviteCode";function J(e){return(e.isBulkInvite?e.emailTokens:e.emailInputs.filter((e=>""!==e.sanitizedEmail))).length>0}function X(){var e;const{currentUserSettingsStore:t}=x.default.state;return t&&t.isReady()&&"email-password"===(null===(e=t.getSettings())||void 0===e?void 0:e.mobile_ads_signup_variant)}function ee(e){return e.isOnboarding&&e.isNewUser}function te(e){return e.device.isMobileBrowser}const ne={fontSize:12,color:o.ZP.mediumTextColor,fontWeight:u.Z.fontWeight.medium,lineHeight:"135%",marginTop:20,marginBottom:4},oe={marginTop:14,marginBottom:14},ie={marginTop:8,marginBottom:8};function re(e){return{color:e.mediumTextColor}}const ae={width:60},se={marginTop:14,marginBottom:8,fontSize:16,fontWeight:600},le={boxShadow:`0 0 0 1px ${o.ZP.red}`}},75538:(e,t,n)=>{n.r(t),n.d(t,{InAppOnboardingStages:()=>a,default:()=>c,onboardingPreferenceKey:()=>s});var o=n(14577),i=n(49085),r=n(15157);const a=["template_optout","workspace_setup"],s="lastOnboardingStateKeyV1";class l extends i.default{setState(e){super.setState(e),function(e){if(e.isOnboarding)if("profile"===e.stage){const{onboardingData:t,isLoading:n,password:o,passwordErrorData:i,currentUserId:a,...l}=e;r.Z.set({userId:a,key:s,value:l})}else{const{onboardingData:t,isLoading:n,currentUserId:o,...i}=e;delete i.password,r.Z.set({userId:o,key:s,value:i})}else{const{currentUserId:t,...n}=e;r.Z.set({userId:t,key:s,value:n})}}(e)}constructor(){super(),this.isOnboarding=new o.Z((()=>this.state.isOnboarding),{debugName:"isOnboarding"});const e={isOnboarding:!1,isLoading:!1,currentUserId:void 0};super.setState(e)}}const c=new l},77282:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(16691),i=n(11799),r=n(82798),a=(n(30541),n(21703),n(57658),n(41432)),s=n(33147),l=n(72126),c=n(54843);class d extends s.Z{constructor(e){super(),this.blocks=void 0,this.liveBlocks=void 0,this.rootBlock=void 0,this.detachedRootBlocks=void 0,this.blocks=new Map,this.liveBlocks=new Map,this.rootBlock=this.createBlock(e,"page"),this.detachedRootBlocks=new Map}hasBlock(e){return this.blocks.has(e)}getBlock(e){return(0,r.TO)(this.blocks.get(e))}createBlock(e,t){(0,r.T)(!this.hasBlock(e.id));const n=new u({blockStore:e,tracker:this,reference:t,onCreated:e=>{this.blocks.set(e.getId(),e)}});return n.hasLiveReference()&&this.addLiveBlock(n),n}removeBlock(e){(0,r.T)(this.hasBlock(e)),(0,r.T)(!this.liveBlocks.has(e),"Should not be possible to remove a live block."),this.blocks.delete(e)}getLiveBlocks(){return[...this.liveBlocks.values()]}addLiveBlock(e){(0,r.T)(!this.liveBlocks.has(e.getId())),this.liveBlocks.set(e.getId(),e),this.emit({type:"add_block",blockStore:e.blockStore})}removeLiveBlock(e){this.liveBlocks.delete(e.getId()),this.emit({type:"remove_block",blockId:e.getId()})}destroy(){for(const e of this.blocks.values())e.destroy();this.blocks.clear(),this.liveBlocks.clear(),this.detachedRootBlocks.clear()}getClosestPageAndTransclusionReferenceAncestorIds(e){const t=this.liveBlocks.get(e);return t?t.getClosestPageAndTransclusionReferenceAncestors().map((e=>e.getId())):[]}getPathToBlock(e){const t=this.liveBlocks.get(e);if(!t)return;const n=[];let o=t;for(;o;){n.unshift(o.getId());const e=o.liveReferences.values().next().value;if("page"===e)return n;o=e}throw new Error("Block should have a page ancestor")}}class u{constructor(e){this.tracker=void 0,this.blockStore=void 0,this.liveReferences=void 0,this.detachedReferences=void 0,this.childBlocks=void 0,this.childBlocksList=void 0,this.contentStoreListener=void 0;const{blockStore:t,tracker:n,reference:o,onCreated:i}=e;this.tracker=n,this.blockStore=t,this.liveReferences=new Set,this.detachedReferences=new Set,"page"===o||o.hasLiveReference()?this.liveReferences.add(o):this.detachedReferences.add(o),this.childBlocks=new Map,this.childBlocksList=[],i(this),this.contentStoreListener=()=>this.handleContentStoreChange(),this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().addListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").addListener(this.contentStoreListener),this.handleContentStoreChange()}handleContentStoreChange(){const e=[...this.childBlocks.keys()],t=new Map,n=this.blockStore.getType();if(this.liveReferences.has("page")||n&&!(0,a.S9)(n))for(const r of(0,c.y)(this.blockStore))t.set(r.id,r);const o=[...t.keys()],i=l.e5(o,e),s=l.e5(e,o);for(const a of i)if(this.tracker.hasBlock(a)){const e=this.tracker.getBlock(a);e.addReference(this),this.childBlocks.set(a,e)}else{const e=this.tracker.createBlock((0,r.TO)(t.get(a)),this);this.childBlocks.set(a,e)}for(const a of s){const e=(0,r.TO)(this.childBlocks.get(a));this.childBlocks.delete(a),e.removeReference(this)}this.childBlocksList=[...t.keys()].map((e=>(0,r.TO)(this.childBlocks.get(e))))}getId(){return this.blockStore.id}hasLiveReference(){return this.liveReferences.size>0}addReference(e){e.hasLiveReference()?this.addLiveReference(e):this.addDetachedReference(e)}addLiveReference(e){if((0,r.T)(!this.liveReferences.has(e)),this.liveReferences.add(e),1===this.liveReferences.size){this.tracker.addLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}}addDetachedReference(e){this.detachedReferences.add(e)}removeReference(e){e.hasLiveReference()?this.removeLiveReference(e):this.removeDetachedReference(e)}removeLiveReference(e){if(this.liveReferences.delete(e),this.detachedReferences.add("detached"),this.tracker.detachedRootBlocks.set(this.getId(),this),0===this.liveReferences.size){this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}removeDetachedReference(e){if(this.detachedReferences.delete(e),0===this.liveReferences.size&&0===this.detachedReferences.size){for(const[e,t]of this.childBlocks.entries())this.childBlocks.delete(e),t.removeReference(this);this.tracker.removeBlock(this.getId()),this.destroy()}}updateReference(e){const t=this.hasLiveReference();this.liveReferences.has(e)&&!e.hasLiveReference()?(this.liveReferences.delete(e),this.detachedReferences.add(e)):this.detachedReferences.has(e)&&e.hasLiveReference()&&(this.liveReferences.add(e),this.detachedReferences.delete(e));const n=this.hasLiveReference();if(t!==n){n?this.tracker.addLiveBlock(this):this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}getClosestPageAndTransclusionReferenceAncestors(){if(0===this.liveReferences.size)return[];if(this===this.tracker.rootBlock)return[this];const e=new Set,t=new Set,n=[this];for(;n.length>0;){const o=(0,r.TO)(n.shift());if(t.has(o))continue;const i=o.liveReferences;for(const t of i)"page"===t?e.add(o):"transclusion_reference"===t.blockStore.getType()?e.add(t):n.push(t);t.add(o)}return(0,r.T)(e.size>0),[...e]}destroy(){this.contentStoreListener&&(this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().removeListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").removeListener(this.contentStoreListener),this.contentStoreListener=void 0)}}var p=n(97880);class m{constructor(e){this.blockTextInstanceMap=void 0,this.textInstanceBlockMap=void 0,this.blockTextClocksListenerMap=void 0,this.blockTextInstanceMap=new Map,this.textInstanceBlockMap=new Map,this.blockTextClocksListenerMap=new Map,e.addListener((e=>this.handlePageEvent(e)));for(const{blockStore:t}of e.getLiveBlocks())this.addBlock(t)}handlePageEvent(e){const t=e.type;switch(t){case"add_block":this.addBlock(e.blockStore);break;case"remove_block":this.removeBlock(e.blockId);break;default:(0,p.t1)(t)}}addBlock(e){const t=e.id;if(this.blockTextClocksListenerMap.has(t))return;const n=e=>{this.handleTextClocksChange(t,e.getValue())};e.getSerializedTextClocksStore().addListener(n),this.blockTextClocksListenerMap.set(t,{blockStore:e,textClocksListener:n});const o=e.getSerializedTextClocksStore().getValue();this.handleTextClocksChange(t,o)}removeBlock(e){this.removeMappingForBlock(e);const{blockStore:t,textClocksListener:n}=(0,r.TO)(this.blockTextClocksListenerMap.get(e));t.getSerializedTextClocksStore().removeListener(n),this.blockTextClocksListenerMap.delete(e)}handleTextClocksChange(e,t){this.removeMappingForBlock(e);const n=t?Object.keys(t):[];for(const o of n)this.addBlockTextInstanceMapping(e,o)}removeMappingForBlock(e){const t=this.blockTextInstanceMap.get(e);if(t)for(const n of t)this.removeBlockTextInstanceMapping(e,n)}addBlockTextInstanceMapping(e,t){const n=this.blockTextInstanceMap.get(e)??new Set;n.add(t),this.blockTextInstanceMap.set(e,n);const o=this.textInstanceBlockMap.get(t)??new Set;o.add(e),this.textInstanceBlockMap.set(t,o)}removeBlockTextInstanceMapping(e,t){const n=(0,r.TO)(this.blockTextInstanceMap.get(e));n.delete(t),0===n.size&&this.blockTextInstanceMap.delete(e);const o=(0,r.TO)(this.textInstanceBlockMap.get(t));o.delete(e),0===o.size&&this.textInstanceBlockMap.delete(t)}getTextInstanceIdsForBlock(e){return this.blockTextInstanceMap.has(e)?[...(0,r.TO)(this.blockTextInstanceMap.get(e))]:[]}getBlockIdsForTextInstance(e){return this.textInstanceBlockMap.has(e)?[...(0,r.TO)(this.textInstanceBlockMap.get(e))]:[]}getBlockIdForTextInstanceItemId(e,t,n){const o=this.getBlockIdsForTextInstance(e);for(const i of o){const o=(0,r.TO)(this.blockTextClocksListenerMap.get(i)).blockStore;if((0,r.TO)(o.getTextSliceTree()).findTextSliceTreeContainingItemWithId(e,t,n))return o.id}}destroy(){for(const e of this.blockTextClocksListenerMap.keys())this.removeBlock(e)}}const f=new class{constructor(){this.pageInfoMap=new i.Z({getKey:e=>(0,o.dn)(e)})}trackPage(e){if(this.pageInfoMap.has(e.pointer))return void(0,r.TO)(this.pageInfoMap.get(e.pointer)).pageStores.add(e);const t=new d(e),n=e.useCrdt()?new m(t):void 0,o=new Set([e]);this.pageInfoMap.set(e.pointer,{pageBlockTracker:t,pageTextInstanceTracker:n,pageStores:o})}untrackPage(e){const t=e.pointer,n=(0,r.TO)(this.pageInfoMap.get(t));var o;(n.pageStores.delete(e),0===n.pageStores.size)&&(n.pageBlockTracker.destroy(),null===(o=n.pageTextInstanceTracker)||void 0===o||o.destroy(),this.pageInfoMap.delete(t))}clear(){for(const[t,n]of this.pageInfoMap){var e;n.pageBlockTracker.destroy(),null===(e=n.pageTextInstanceTracker)||void 0===e||e.destroy(),this.pageInfoMap.delete(t)}}getPageStoreForBlockStore(e){for(const[t,n]of this.pageInfoMap)for(const o of n.pageStores)if(o.uiLocation.contains(e.uiLocation))return o;for(const[t,n]of this.pageInfoMap)for(const o of n.pageStores){const t=this.pageInfoMap.get(o.pointer);if(null!=t&&t.pageBlockTracker&&t.pageBlockTracker.hasBlock(e.pointer.id))return o}}getPageBlockTrackerForPage(e){var t;return null===(t=this.pageInfoMap.get(e))||void 0===t?void 0:t.pageBlockTracker}getPageTextInstanceTrackerForPage(e){var t;return null===(t=this.pageInfoMap.get(e))||void 0===t?void 0:t.pageTextInstanceTracker}}},54843:(e,t,n)=>{n.d(t,{y:()=>i});var o=n(97880);function i(e){const t=e.getType();if(!t)return[];const n=e.getRenderableContentStores();if(n.length>0)return n;switch(t){case"transclusion_reference":const n=e.getTransclusionReferenceTargetStore();return n?[n]:[];case"text":case"page":case"personal_home_page":case"bulleted_list":case"numbered_list":case"toggle":case"quote":case"factory":case"button":case"to_do":case"column_list":case"column":case"embed":case"framer":case"tweet":case"gist":case"drive":case"audio":case"maps":case"invision":case"mixpanel":case"image":case"video":case"file":case"bookmark":case"equation":case"code":case"header":case"sub_header":case"sub_sub_header":case"collection_view":case"collection_view_page":case"breadcrumb":case"copy_indicator":case"divider":case"link_to_page":case"link_to_collection":case"figma":case"loom":case"typeform":case"codepen":case"pdf":case"callout":case"table_of_contents":case"whimsical":case"miro":case"abstract":case"sketch":case"excalidraw":case"replit":case"alias":case"transclusion_container":case"external_object_instance":case"table":case"table_row":case"tab":case"external_object_instance_page":case"hex":case"deepnote":case"ai_block":case"drawing":return[];default:(0,o.t1)(t)}}},18245:(e,t,n)=>{n.r(t),n.d(t,{NotionPerformanceClass_TEST_ONLY:()=>_,default:()=>y});n(57658);var o=n(1302),i=n(5809),r=n(68626),a=(n(72126),n(12139)),s=n(97880),l=n(77472),c=n(53410),d=n(94134),u=n(85844),p=n(50112),m=n(77897),f=n(50906),g=n(77080);const h=Object.entries(p.N);const v=new Set(["navigation_page_render","navigation_database_render","typing_lag"]);class b{constructor(){this.startTimesByMetricName={},this.lastVisibilityChange=0,u.Z.addListener((()=>{this.lastVisibilityChange=performance.now()}))}mark(e){var t;const n=null!==(t=performance)&&void 0!==t&&t.mark?performance.mark(e).startTime:performance.now(),o="sentry"===d.getProfilingToolForSession()&&v.has(e)?a.Yr({name:e}):void 0;return this.startTimesByMetricName[e]={startTime:n,sentryTransaction:o},{metricName:e,startTime:n,sentryTransaction:o}}markAllOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===d.getProfilingToolForSession()&&v.has(n)?a.Yr({name:n}):void 0}}markEitherOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===d.getProfilingToolForSession()&&v.has(n)?a.Yr({name:n}):void 0,allMetricNamesMarked:e}}measure(e,t){this._measure(e,t)}measureAfterNextFlush(e,t){o.default.afterNextFlush((()=>{const n="getData"in t?t.getData():void 0;"getData"in t&&void 0===n||this._measure(e,{...t,data:n})}))}measureFromAppStart(e,t){const n="object"==typeof e?e.metricName:e,o=i.$();"number"==typeof o&&this.measure({metricName:n,startTime:o,..."object"==typeof e?{endTime:e.endTime}:{}},t)}measureFromAppStartAfterNextFlush(e,t){const n="object"==typeof e?e.metricName:e;o.default.afterNextFlush((()=>{const o="getData"in t?t.getData():void 0;if("getData"in t&&void 0===o)return;const r=i.$();"number"==typeof r&&this._measure({metricName:n,startTime:r,..."object"==typeof e?{endTime:e.endTime}:{}},{...t,data:o})}))}_measure(e,t){if("object"==typeof e){const{startTime:n,endTime:o,metricName:i,sentryTransaction:r}=e;this.startTimesByMetricName[i]=void 0;const a=this.getDuration({metricName:i,startTime:n,endTime:o});r&&r.finish(o),this.trackDuration({metricName:i,startTime:n,duration:a,options:t})}else if("string"==typeof e){const n=e,o=this.startTimesByMetricName[n];if(!o)return;const{startTime:i,allMetricNamesMarked:r,sentryTransaction:a}=o;if(r)for(const e of r)this.startTimesByMetricName[e]=void 0;else this.startTimesByMetricName[n]=void 0;const s=this.getDuration({metricName:n,startTime:i});a&&a.finish(),this.trackDuration({metricName:n,startTime:i,duration:s,options:t})}else(0,s.t1)(e)}getDuration(e){const{metricName:t,startTime:n,endTime:o}=e;try{return performance.measure(t,{start:n,..."number"==typeof o?{end:o}:{}}).duration}catch(i){return"number"==typeof o?o-n:performance.now()-n}}async trackDuration(e){const{metricName:t,duration:n,startTime:o,options:i}=e,{environment:a,data:s,preboot:d}=i;if(!document.hidden&&!("number"==typeof this.lastVisibilityChange&&o<this.lastVisibilityChange)&&await l.TA(t,i)){if(a.device.isElectron&&c.C&&c.C.windowIsVisible){if(!(await c.C.windowIsVisible()))return}"navigation_database_render"===t&&n>=6e4&&r.log({level:"info",from:"collections",type:"navigationPageRenderSlow",error:{message:`Got a slow navigation page render that took: ${n/1e3}s`},data:{miscDataToConvertToString:s}}),l.j(a,t,{time:n,...s},{preboot:d}),function(e,t,n){if(!("memory"in(window.performance||{})))return;const o=Math.random();h.forEach((i=>{let[r,a]=i;if(!(r in window.performance.memory))return;const s=g.default.getConfigKey("event_trail_events",a),l=s&&"sampleRatesByMetric"in s&&"object"==typeof s.sampleRatesByMetric&&s.sampleRatesByMetric[t]||0;(0,m.aw)(l,(()=>o))&&f.Z41(e,{type:a,bytes:window.performance.memory[r],data:{collected_during:t,...n}})}))}(a,t,s)}}}const y=new b;class _ extends b{}},30806:(e,t,n)=>{n.d(t,{$X:()=>i,Ai:()=>f,Aq:()=>c,Ay:()=>l,BX:()=>s,PQ:()=>u,SJ:()=>d,cY:()=>a,g8:()=>p,lj:()=>r,uD:()=>m});var o=n(77472);function i(e){let{environment:t,from:n}=e;(0,o.j)(t,"open_home",{from:n})}function r(e){let{environment:t}=e;(0,o.j)(t,"open_home_more_menu",{})}function a(e){const{environment:t,show:n,feature:i,from:r}=e;(0,o.j)(t,"toggle_home_feature",{show:n,feature:i,from:r})}function s(e){let{environment:t,oldValue:n,newValue:i,from:r}=e;(0,o.j)(t,"change_start_page",{old_value:n,new_value:i,from:r})}function l(e){let{environment:t,index:n,teamId:i}=e;(0,o.j)(t,"change_home_trending_source",{source_type:i?"team":"space",selected_index:n,selected_team_id:i})}function c(e){let{environment:t,from:n}=e;(0,o.j)(t,"click_empty_my_tasks",{from:n})}function d(e){let{environment:t,from:n}=e;(0,o.j)(t,"close_task_migration_modal",{from:n})}function u(e,t){(0,o.j)(e,"open_home_tip",t)}function p(e,t){(0,o.j)(e,"check_home_tip",t)}function m(e,t){(0,o.j)(e,"show_completed_home_tips",t)}function f(e,t){(0,o.j)(e,"home_tips_modal_error",t)}},46837:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),i=n(480),r=n(86628),a=n(24405),s=n(56996),l=n(9291),c=n(76798),d=n(75024),u=n(85893);function p(e){let{style:t}=e;window.__c={n:"PersonalHomeBreadcrumb"};const n=(0,i.O7)(),o=(0,r.VK)((()=>{var e;return(null===(e=n.mobileNative)||void 0===e?void 0:e.supportsNativeHomeOnPhone())??!1}),[n.mobileNative]),p=(0,a.yK)((()=>({container:{display:"flex",alignItems:"center",lineHeight:1.2,paddingRight:4,fontSize:(0,d.yv)(n,"UIRegular"),width:"100%",maxWidth:o?"100%":void 0,...t},homeIcon:{width:20,height:20,marginRight:4}})),[n,t,o]),m=(0,c.E)({shouldWrap:!1}).root,f=(0,u.jsxs)(u.Fragment,{children:[(0,s.z)(p.homeIcon),(0,u.jsx)("div",{style:m,children:(0,u.jsx)(l.FormattedMessage,{id:"personalHomeBreadcrumb.homeBreadcrumb",defaultMessage:"Home"})})]});return o?(0,u.jsx)("div",{style:p.container,className:"notranslate",children:f}):(0,u.jsx)("div",{style:p.container,className:"notranslate shadow-cursor-breadcrumb",children:f})}const m=o.memo(p)},14654:(e,t,n)=>{n.d(t,{ib:()=>s,t3:()=>l});var o=n(15145),i=n(97880),r=n(80444),a=n(94841);function s(e){let{blockOrCollectionId:t}=e;const n=l({blockOrCollectionId:t});switch(n){case"home":return o.tY.PersonalHomePage;case"home_tile_recents":return o.tY.PersonalHomeTileRecents;case"home_tile_trending":return o.tY.PersonalHomeTileTrending;case"home_tile_tips":return o.tY.PersonalHomeTileTips;case"home_tile_tasks":return o.tY.PersonalHomeTileTasks;case"home_tasks":return o.tY.PersonalHomePageTasks;case"home_tile_similar_users":return o.tY.PersonalHomeTileSimilarUsers;case"home_unknown":return o.tY.PersonalHomeUnknown;case"home_tile_notes":return o.tY.PersonalHomeNotes;case void 0:return;default:(0,i.t1)(n)}}function l(e){let{blockOrCollectionId:t}=e;const n=(0,a.G)({blockOrCollectionId:t}),{mainEditorCurrentBlockStore:o}=r.default.state;if(n)switch(n){case"main":return"home";case"myTasksAssignedToMeCollectionView":case"myTasks":return(0,a.WE)(o)?"home_tile_tasks":"home_tasks";case"trendingCollectionView":return"home_tile_trending";case"similarUsersCollectionView":return"home_tile_similar_users";case"trending":case"trendingCollection":case"myTasks":case"similarUsers":case"similarUsersCollection":return"home_unknown";default:(0,i.t1)(n)}}},94841:(e,t,n)=>{n.d(t,{$1:()=>F,A5:()=>y,Al:()=>P,EP:()=>v,Ep:()=>A,Er:()=>Z,G:()=>C,J2:()=>R,Kj:()=>T,MI:()=>k,Uf:()=>b,Vj:()=>D,WB:()=>S,WE:()=>M,Wx:()=>w,XX:()=>f,_U:()=>V,h5:()=>E,iO:()=>h,jX:()=>_,jq:()=>g,pr:()=>B});var o=n(59308),i=n(60310),r=n(72126),a=n(21202),s=n(6287),l=n(13493),c=n(97880),d=n(95697),u=n(80444),p=n(88923),m=n(26136);const f=80,g=40,h=24,v=20,b=270,y=16,_=44,S=b-_,w="linear-gradient(transparent 0%, black 10px)",k={backdropFilter:"blur(48px)",WebkitBackdropFilter:"blur(48px)"},I=(0,r.HP)(((e,t)=>i.hH({userId:e,spaceId:t})),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify(t)})),x=(0,r.HP)(((e,t,n)=>{if(!e||!t||!n)return;const[o]=(0,c.qP)(I(t,n)).find((t=>{let[n,o]=t;return o===e}))??[];return o}),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify(t)}));function C(e){var t,n;let{blockOrCollectionId:o}=e;const i=null===(t=u.default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=u.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(i&&r&&o)return x(o,i,r)}function T(e){return(0,c.$K)(C({blockOrCollectionId:e}))}function M(e){return!!e&&"main"===C({blockOrCollectionId:e.id})}function P(e){var t,n;const o=null===(t=u.default.state.currentUserStore)||void 0===t?void 0:t.id,i=null===(n=u.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(!o||!i)return;const r=I(o,i).main,s=e.getSpaceStore();return r&&s?m.G.createChildStore(s,{table:a.iU,id:r,spaceId:s.id}):void 0}function A(e){var t,n;const o=null===(t=u.default.state.currentUserStore)||void 0===t?void 0:t.id,i=null===(n=u.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(o&&i)return I(o,i)[e]}function R(e){const t=u.default.state.currentSpaceStore;if(!t)return;const n=t.id;switch(e){case"main":case"myTasks":case"trending":case"similarUsers":const o=A(e);return o?m.G.createChildStore(t,{table:a.iU,id:o,spaceId:n}):void 0;case"myTasksAssignedToMeCollectionView":case"similarUsersCollectionView":case"trendingCollectionView":const i=A(e);return i?m.Xr.createChildStore(t,{table:l.n,id:i,spaceId:n}):void 0;case"trendingCollection":case"similarUsersCollection":const r=A(e);return r?m.NW.createChildStore(t,{table:s.v,id:r,spaceId:n}):void 0;default:(0,c.t1)(e)}}function D(e,t){var n;let i;switch(e){case"table":i=t.table_properties;break;case"board":i=t.board_properties;break;case"calendar":i=t.calendar_properties;break;case"list":i=t.list_properties;break;case"gallery":i=t.gallery_properties;break;case"timeline":i=t.timeline_properties}return{list_properties:(0,d.QI)("dev_only")?null===(n=i)||void 0===n?void 0:n.filter((e=>"title"!==e.property)):[{width:200,visible:!0,property:o.Es.DueDate},{width:200,visible:!0,property:o.Es.Status,statusShowAs:"select"},{width:200,visible:!0,property:o.Es.Location},{visible:!1,property:o.Es.Assign,width:200},{visible:!1,property:o.Es.Reporter,width:200},{visible:!1,property:o.Es.CreatedTime,width:200},{visible:!1,property:o.Es.LastEditedTime,width:200},{visible:!1,property:o.Es.LastEditedBy,width:200}],collection_group_by:void 0,collection_peek_mode:p.PeekModeCenter,inline_collection_first_load_limit:{type:"load_limit",limit:20}}}function B(e){if(!(0,d.QI)("beta_only"))return!1;if(e.device.isMobile)return!1;const{currentUserSettingsStore:t}=u.default.state;if(!t||!t.isReady())return!1;const n=t.getSettings();return!!n&&!0!==n.seen_personal_home}const E="https://www.notion.so/notion/Sidebar-Home-Beta-Program-3819c5f8551141c3952f1031ab4f9034";function F(e){let{theme:t,isPhone:n}=e;return n?t.personalHomeBackgroundPhone:t.personalHomeBackgroundDesktop}function Z(e){let{theme:t,isPhone:n,buttonState:o,hasCover:i}=e,r=t.whiteButtonBackground;switch(o){case"hovered":r=t.whiteButtonHoveredBackground;break;case"pressed":r=t.whiteButtonPressedBackground}return n&&(r=void 0),{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",background:r,...k,boxShadow:i?V({isPhone:n,theme:t}):void 0,width:28,height:28,borderRadius:4}}function V(e){let{isPhone:t,theme:n}=e;if("dark"===n.mode)return"unset";n.mode;const o=t?.5:1,i=n.home.tile.border&&`0 0 0 ${o}px ${n.home.tile.border}`;return t?i:[i,"0 12px 40px rgba(0, 0, 0, 0.025)"].filter(c.$K).join(", ")}},58299:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(76796),i=n(78030);class r extends o.B{findBlockPropertyValue(e,t){return this.find((n=>n.getProps().store===e&&n.getProps().property===t&&n.getProps().format!==i.C.PropertyModule))}findBlockPropertyValueByBlockId(e,t){return this.find((n=>n.getProps().store.id===e&&n.getProps().property===t&&n.getProps().format!==i.C.PropertyModule))}getRect(e,t){const n=this.findBlockPropertyValue(e,t);if(n){const e=n.getNode();if(e&&e instanceof Element)return e.getBoundingClientRect()}}}const a=new r},58202:(e,t,n)=>{n.d(t,{R:()=>s});var o=n(35431),i=n(92595),r=n(53223);class a extends o.Z{findBlockFromStore(e){return this.find((t=>t.getBlockStore()===e))}findAllBlocksFromStore(e){return this.filter((t=>t.getBlockStore()===e))}findBlockFromStoreWithMethod(e,t){return this.find((n=>n.getBlockStore()===e&&"function"==typeof n[t]))}findBlockFromId(e){return this.find((t=>{const n=t.getBlockStore();return n&&n.id===e}))}findNodeFromStore(e){const t=this.findBlockFromStore(e);if(t)return t.getNode()}getRect(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findCollectionViewBlockFromStore(e){return this.find((t=>t.getBlockStore()===e&&(0,r.wA)(t)))}findCollectionViewBlockFromId(e){return this.find((t=>{var n;return Boolean((null===(n=t.getBlockStore())||void 0===n?void 0:n.id)===e&&(0,r.wA)(t))}))}}const s=new a;(0,i.exposeDebugValue)("GlobalBlockRegistry",s)},89574:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},46351:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},47372:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},27406:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),i=n(92595);class r extends o.Z{constructor(){super(...arguments),this.isDropTargetForKey=(e,t)=>e.props.dropTargetKey===t}findDropTargetFromKey(e){return this.find((t=>this.isDropTargetForKey(t,e)))}findDropTargetsFromKey(e){return this.filter((t=>this.isDropTargetForKey(t,e)))}}const a=new r;(0,i.exposeDebugValue)("GlobalDropTargetRegistry",a);const s=a},28685:(e,t,n)=>{n.d(t,{E:()=>r});var o=n(35431);class i extends o.Z{findEditableWithinSelectable(e){return this.find((t=>t.getContextClosestSelectable()===e))}findEditableWithStore(e){return this.find((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findEditableWithStore(e);if(t)return t.getNode()}findStoreFromNode(e){const t=this.find((t=>t.getNode()===e));if(t)return t.props.store}}const r=new i},3994:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(76796);class i extends o.B{shouldPreventMobileAutoScroll(e){const t=this.find((t=>t.capture&&!(t.allowMobileAutoScroll&&e.device.isMobile)));return Boolean(t)}}const r=new i},75987:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{isInlineAutocompleteOpen(){const e=this.find((e=>e.props.isOpen));return Boolean(e)}}const r=new i},81844:(e,t,n)=>{n.d(t,{Z:()=>r});n(57658);var o=n(35431);class i extends o.Z{findOutlinerItemFromStore(e){if(e)return this.find((t=>t.store===e))}findOutlinerItemsFromId(e){const t=[];return this.forEach((n=>{n.store.id===e&&t.push(n)})),t}}const r=new i},49427:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),i=n(85644),r=n(82136);class a extends o.Z{isBlockInFrame(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===r.S.Frame&&e.props.store===t)))}isBlockInTemplate(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===r.S.InAppTemplatePreview&&e.props.store===t)))}isBlockInPageSnapshot(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===r.S.InPageSnapShot&&e.props.store===t)))}isBlockInWiki(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>(0,i.A)(e.props.store)&&e.props.store===t)))}}const s=new a},64815:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},16339:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{}const r=new i},95802:(e,t,n)=>{n.d(t,{C:()=>c});var o=n(35431),i=n(92595),r=n(72126),a=n(28685),s=n(27724);class l extends o.Z{getMembersByDOMOrder(e){let{filter:t}=e;return super.getMembersByDOMOrder({filter:e=>!e.props.isHoverMenu&&t(e)})}findSelectableFromStore(e){return this.find((t=>t.props.store===e))}findScrollToSelectableFromStore(e){return this.find((t=>t.props.store===e&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findScrollToSelectablesFromIds(e){return this.filter((t=>e.includes(t.props.store.id)&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findSelectablesFromStore(e){return this.filter((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findSelectableFromStore(e);if(t)return t.getNode()}getRectFromStore(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findEditableStoreWithin(e){const t=this.findSelectableFromStore(e);if(t){const e=a.E.findEditableWithinSelectable(t);if(e)return e.props.store}}findSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return r.oA(e.map((e=>n.find((n=>{const o=n.props.store,i=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&i===t)})))))}findAllSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return r.xH(e.map((e=>n.filter((n=>{const o=n.props.store,i=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&i===t)})))))}findNodeFromBlockId(e){var t;const n=this.findSelectablesFromIds([e]);return null==n||null===(t=n[0])||void 0===t?void 0:t.getNode()}findSelectableFromChildNode(e){const t=this.getMembersByDOMOrder({filter:t=>{var n;return null===(n=t.getNode())||void 0===n?void 0:n.contains(e)}});return t[t.length-1]}}const c=new l;(0,i.exposeDebugValue)("GlobalSelectableRegistry",c)},75822:(e,t,n)=>{n.d(t,{E5:()=>i,rE:()=>r,vp:()=>o});const o=300,i=75,r=225},85019:(e,t,n)=>{n.d(t,{S:()=>F});n(57658);var o=n(41432),i=n(80951),r=n(59753),a=n(21202),s=n(6287),l=n(70203),c=n(97880);const d={indexTimeMs:!0,title:!0,children_contents:!0,children_ids:!0,children_permissions:!0,children_fractional_index:!0,children_types:!0,alive:!0,created_by_id:!0,created_by_table:!0,created_time:!0,format:!0,id:!0,is_template:!0,last_edited_by_id:!0,last_edited_time:!0,parent_table:!0,permissions:!0,space_id:!0,team_id:!0,team_name:!0,team_is_archived:!0,auto_increment_id:!0,type:!0,version:!0,ancestors:!0,audience:!0,db_schema_source_partition:!0,depth:!0,is_path_alive:!0,is_top_level_page:!0,parent_id:!0,path_text:!0,search_permissions:!0,inherited_permissions:!0,parent_page_id:!0,collection_id:!0,parent_collection_id:!0,page_views:!0,unique_page_views:!0,collection_properties:!0,children_last_edited_times:!0,mentions_dictionary:!0},{audience:u,...p}=((0,c.QS)(d),d);(0,c.QS)(p);function m(e){const{getRecordValue:t,blockValue:n}=e;let c="";const d={user:new Map},u=r.kk.fromBlock(n),p=r.om.fromGetRecordValueFn(t);if(u.isCollectionView()){const e=function(e){const{getRecordModel:t,model:n}=e,o=n.getRenderFormatPointer(t);if(!o)return;const r=t(o);if(!r)return;if(r.table===a.iU)return(0,i.wS)(r,"title")||[];if(r.table===s.v)return r.getNormalizedName()}({model:u,getRecordModel:p});e&&e.length>0&&(c=l.Qh7(e,p,d).text)}else if(u.isType("file")){c=`${l.Qh7(u.getProperty("title"),p,d).text} ${l.Qh7(u.getProperty("caption"),p,d).text}`}else if(u.isType("bookmark")){c=`${l.Qh7(u.getProperty("title"),p,d).text} ${l.Qh7(u.getProperty("description"),p,d).text} ${l.Qh7(u.getProperty("caption"),p,d).text}`}else if(u.isType(o.Ok)){const e=u.getProperty("caption");c=l.Qh7(e,p,d).text}else if(u.isType(o.Ti.tableRow)){const e=function(e){const{blockModel:t,getRecordModel:n}=e,o=n({table:a.iU,id:t.getParentId(),spaceId:t.getSpaceId()});return null==o?void 0:o.getFormatValue("table_block_column_order")}({blockModel:u,getRecordModel:p});if(e){c=e.map((e=>l.Qh7(u.getProperty(e),p,d).text)).join(" ")}}else{const e=(0,i.wS)(n,"title");c=l.Qh7(e,p,d).text}return{text:c.trim()||void 0,mentions:d}}var f=n(72126),g=n(58203),h=n(63306),v=n(73360),b=n(74446),y=n(45953),_=n(33361),S=n(28020),w=n(45950),k=n(98165),I=n(38755),x=n(95697),C=n(77080),T=n(46735),M=n(69327),P=n(26136),A=n(42198),R=n(77907);const D=new Set(["a","an","and","are","as","at","be","but","by","for","if","in","is","it","of","on","or","that","the","to","was","will","with"]),B=(e,t,n)=>e.length>=3,E=(e,t,n)=>e.length>=5&&.2;async function F(e){const{environment:t,currentSpaceStore:n,currentSpaceViewStore:i,excludeCurrentPage:s}=e,{id:l}=n,c=new Map,d=new Set;function u(e,t){var n;c.has(e)?null===(n=c.get(e))||void 0===n||n.add(t):c.set(e,new Set([t]))}const p=new Map,F=(new Date).getTime();if(i)for(const o of i.getBookmarkedPageIds())u(o,"bookmarkedPage");const Z=M.Z.get(l);Z&&Z.forEach(((e,t)=>{let{pageId:n,visitedAt:o}=e;u(n,"recentVisit"),d.add(n),p.set(n,{index:t,timeSinceLastViewed:F-o})}));const V=(0,I.ns)(t,n);for(const o of V)u(o,"spacePage");const j=(0,x.xo)();for(const o of j)u(o,"teamPage");const U=t.currentUser.id;if(i){for(const{id:n}of(0,I.KA)(t,i))u(n,"sharedPage");const e=F-432e5;t.defaultRecordCache.inMemoryRecordCache.forEachRecord(U,(t=>{let{model:i}=t;if(i.table===a.iU&&l===n.id){const{id:t,last_edited_time:n,last_edited_by_id:r,type:a}=i;(0,o.S9)(a)&&r===U&&n&&n>e&&(u(t,"defaultRecordCache"),d.add(t))}}))}const L=T.Z.getVisitedIds(U);for(const o of L)u(o,"frecencyStore"),d.add(o);const O=U?C.default.getEligibleGroup({experimentId:"search-new-local-recall-v2",parameter:"userSignals",defaultGroup:[]})??[]:[],N=A.default.getUserSignals({spaceId:l,userId:U});var z,W,q,H;O.includes("sim_user_visits")&&(null==N||null===(z=N.similarUserRecentPages)||void 0===z||z.pagesMetadata.forEach(((e,t)=>{u(t,"similarUser1dRecentPages"),d.add(t)})));O.includes("popular_pages")&&(null==N||null===(W=N.topPages7dPageView)||void 0===W||W.forEach(((e,t)=>{u(t,"topPages7dPageView"),d.add(t)})));O.includes("user_edits")&&(null==N||null===(q=N.editedPages1d)||void 0===q||q.forEach(((e,t)=>{u(t,"editedPages1d"),d.add(t)})));O.includes("sim_user_edits")&&(null==N||null===(H=N.similarUsersEditedPages1d)||void 0===H||H.forEach(((e,t)=>{u(t,"similarUsersEditedPages1d"),d.add(t)})));if(s){const e=(0,S.np)();e&&c.delete(e.id)}const K=y.PF.create();await(0,_.uf)({recordPointers:Array.from(c.keys()).map((e=>({table:a.iU,id:e}))),recordMap:K,loadRecordModel:e=>(0,w.Ye)({environment:t,pointer:e}),recurFn:e=>f.oA([(0,v.tz)(e)&&e.getParentPointer(),e.table===a.iU&&e.getCollectionPointer()])});const G=b.mF.fromRecordMapWithRole(K),$=r.om.fromGetRecordValueFn(G),Q=new Array;for(const[o,r]of c.entries()){const e={table:a.iU,id:o};let t,i;if(d.has(o)?(t=P.t1.createChildStore(n,e),i=t.getModel()):i=$(e),!i)continue;const s=(0,h.Wq)(e,K);if(0===s.length)continue;if(i.getSpaceId()!==n.id)continue;const l=(0,g.$B)(m({blockValue:i,getRecordValue:G}).text);if(!l)continue;if(!r)continue;const c=(0,k.KU)(s);if(c&&Boolean(c.value.archived_by))continue;const u=l.substring(0,1e3).trim(),f=p.get(o);Q.push({blockModel:i,text:u,path:s,source:r,indexInRecentPages:f?f.index:void 0,timeSinceLastViewedMs:f?f.timeSinceLastViewed:void 0,blockStore:t})}const{index:Y,getAllBlocks:J}=await async function(){const{default:e}=await R.deps.minisearch.loader(),t=new e({fields:["text","id","inits"],storeFields:["block"],searchOptions:{prefix:B,fuzzy:E},tokenize:(e,t)=>e.split(/\s/g),processTerm:(e,t)=>{const n=e.toLowerCase();if(!D.has(e))switch(t){case"text":{const t=n.split(/[^\w]+/g).filter((t=>t.length>3&&!D.has(e)));return(0,f.jj)([n,...t])}case"inits":return[...Array(e.length).keys()].slice(0,e.length-3+1).map(((e,t)=>n.slice(t)));default:return n}}});return{index:t,getAllBlocks:()=>t.search(e.wildcard)}}(),X=Q.map((e=>({id:e.blockModel.id,text:e.text,inits:e.text.split(" ").map((e=>e[0])).join(""),block:e})));return Y.addAll(X),{spaceId:n.id,blocks:Y,getAllBlocks:J,recordMap:K}}},40134:(e,t,n)=>{n.d(t,{B:()=>i});var o=n(51);function i(e){var t;let{blockId:n,setting:i}=e;const{publicPageData:r}=o.Z.state;if((null==r?void 0:r.pageId)!==n)return;return null===(t=r.securitySettings)||void 0===t?void 0:t[i]}},28578:(e,t,n)=>{n.d(t,{Sw:()=>l,T5:()=>s,XF:()=>r,ZP:()=>d,wV:()=>a});var o=n(49085),i=n(4615);let r=function(e){return e.Share="share",e.Publish="publish",e}({}),a=function(e){return e.MainShareMenu="mainShareMenu",e.Invite="invite",e.Publish="publish",e}({}),s=function(e){return e.Notion="notion",e.Slack="slack",e}({}),l=function(e){return e.Search="search",e.Message="message",e}({});class c extends o.default{getInitialState(){return{sessionId:(0,i.ZP)(),display:a.MainShareMenu,tab:r.Share}}}const d=new c},74948:(e,t,n)=>{n.r(t),n.d(t,{OnlyOneSidebarVisibleWidthThreshold:()=>X,SidePeekCloseLeftSidebarFrameWidthThreshold:()=>ee,bookmarkPage:()=>ue,cancelSidebarInitialRenderLog:()=>Te,close:()=>ne,handleSidebarButtonClick:()=>ie,initialize:()=>ke,leaveBlocks:()=>de,newPageMessages:()=>ve,open:()=>te,pinSharedPage:()=>me,quickAddPage:()=>he,setExpand:()=>oe,setPeekWidth:()=>ce,setUpdateExpand:()=>re,setUpdateSidebarCommentsMode:()=>xe,setUpdateSidebarTab:()=>Ie,setUpdateWidth:()=>le,setWidth:()=>se,toggleBothSidebars:()=>Ce,toggleLeftSidebarByWindowSize:()=>ae,unbookmarkPage:()=>pe,unpinSharedPage:()=>fe});var o=n(1302),i=n(15145),r=n(23867),a=n(54153),s=n(9291),l=n(50906),c=n(54642),d=n(54564),u=n(98834),p=n(94419),m=n(11302),f=n(17659),g=n(89858),h=n(99553),v=n(9953),b=n(75754),y=n(26999),_=n(8055),S=n(82530),w=n(1742),k=n(37181),I=n(93827),x=n(75770),C=n(58239),T=n(45010),M=n(38755),P=n(18245),A=n(5162),R=n(80444),D=n(8949),B=n(66949),E=n(77080),F=n(3418),Z=n(475),V=n(42330),j=n(45325),U=n(79689),L=n(88923),O=n(24864),N=n(26136),z=n(69784),W=n(82187),q=n(62820),H=n(34583),K=n(24646),G=n(38676),$=n(97852),Q=n(77999),Y=n(36896),J=n(36391);const X=1024,ee=430;function te(){G.sidebarOpenStore.state||z.default.state.isActive||B.Z.isOpen()||j.default.isOpen()||G.sidebarOpenStore.setState(!0)}function ne(){!G.sidebarOpenStore.state||Z.Z.state.open||q.Z.state.open||Y.Z.state.open||$.Z.state.open||D.Z.state.isActive||W.Z.state.clonedBlockStore||G.sidebarResizingStore.state.isResizing||!(0,U.c)()||F.Z.state.namedOpenPopups.has("team_more_actions")||F.Z.state.namedOpenPopups.has("teams_heading_actions")||(G.sidebarMousePeekXStore.setState(0),G.sidebarOpenStore.setState(!1))}function oe(e){if((0,A.Y)("supportsNativeHome"))return;"inactive"===Q.default.state.type||e.isExpanded||Q.default.setState({type:"inactive"});const t=P.default.mark("sidebar.toggle_expanded_lag");G.sidebarExpandedStore.setState(e.isExpanded),Se(),L.default.setSidebarExpandedStoreState(e.isExpanded),e.isExpanded&&e.environment.WindowSizeStore.state.width<X&&(0,K.Sx)(e.environment)&&re({environment:e.environment,isExpanded:!1,from:"close_for_space"}),e.isExpanded&&(0,K.$3)(e.environment)<ee&&h.xv(e.environment,"sidebar_expand"),e.isExpanded?l.LMg(e.environment):l.QdK(e.environment),P.default.measureAfterNextFlush(t,{environment:e.environment,getData:()=>({is_expanded:e.isExpanded,from:e.from})})}function ie(e,t,n,o){const r=L.default.state.open,{currentTab:a}=J.ZP.state,s=a!==n||a===n&&!(0,K.Sx)(e);J.ZP.setState({...J.ZP.state,currentTab:n}),r?(b._({environment:e,store:t,pageVisitSource:i.tY.Expand}),re({environment:e,isExpanded:!0,from:o})):re({environment:e,isExpanded:s,from:o})}function re(e){var t;const{isExpanded:n,environment:o,from:i}=e;if(n||d.LZ(),n){o.WindowSizeStore.state.width<X&&(0,K.in)(o)&&oe({environment:o,isExpanded:!1,from:`set_update_expand_${e.from}`}),j.default.isOpen()&&f.qQ({open:!1,environment:o});const t=J.ZP.state.currentTab,n={origin:L.default.state.open?"peek_view":"page",from:i};t===J.gY.Comments?l.v$O(o,n):t===J.gY.Updates&&l.phe(o,n)}J.ZP.setState({...J.ZP.state,expanded:n,mouseEntered:!!n||J.ZP.state.mouseEntered,openedOnBlockId:L.default.state.open&&L.default.state.target.id||(null===(t=R.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id),canRender:!0}),we()}function ae(e){L.default.state.savedSidebarExpandedStoreState&&!G.sidebarExpandedStore.state&&function(e){if(G.sidebarExpandedStore.state||!L.default.state.savedSidebarExpandedStoreState)return;L.default.isSidePeekOpen()&&(0,K.$3)(e)-(0,K.qG)(e)>=ee&&G.sidebarExpandedStore.setState(!0)}(e),G.sidebarExpandedStore.state&&function(e){const t=G.sidebarExpandedStore.state&&0===(0,K.Wk)(e)?e.WindowSizeStore.state.width-G.sidebarWidthStore.state-(0,K.ll)(e,!1):(0,K.$3)(e);L.default.isSidePeekOpen()&&L.default.state.savedSidebarExpandedStoreState&&G.sidebarExpandedStore.state&&t<ee&&(G.sidebarExpandedStore.setState(!1),L.default.setSidebarExpandedStoreState(!0))}(e)}function se(e){G.sidebarWidthStore.setState(e.width),(0,K.$3)(e.environment)<ee&&h.xv(e.environment,"sidebar_expand"),Se()}function le(e){J.ZP.setState({...J.ZP.state,width:e.width}),we()}function ce(e){L.default.state.open&&L.default.isSidePeekOpen()&&(L.default.setSidePeekWidth(e.width,e.environment.WindowSizeStore.state.width),function(){const{preferredSidePeekWidth:e}=L.default.state,t={width:e};a.Z.set(_e,t)}(),ae(e.environment))}async function de(e){const{blocks:t,transaction:n,environment:o}=e,{currentSpaceViewStore:i}=R.default.state;if(i)for(const r of t)p.Od({parent:i.getSharedPagesStore(),childToRemove:r,transaction:n});_.CZ({environment:o,blocks:t}),await Promise.all(t.map((e=>c.leaveBlock(o,{block:{id:e.id,spaceId:(0,r.C)(e.pointer.spaceId)}}))))}const ue=function(e){const{store:t,spaceViewStore:n,transaction:o}=e,i=n.getBookmarkedPagesStore(),r=N.G.createChildStore(i,t.pointer);E.default.checkGate("append_favorites")?p.R3({parent:i,append:r,transaction:o}):p.Ce({parent:i,prepend:r,transaction:o})},pe=function(e){const{store:t,spaceViewStore:n,transaction:o}=e,i=n.getBookmarkedPagesStore(),r=N.G.createChildStore(i,t.pointer);p.Od({parent:i,childToRemove:r,transaction:o})},me=function(e){const{store:t,spaceViewStore:n,transaction:o}=e;ge(e);const i=n.getSharedPagesStore(),r=N.G.createChildStore(i,t.pointer);p.Ce({parent:i,prepend:r,transaction:o})},fe=function(e){const{store:t,spaceViewStore:n,transaction:o}=e;ge(e);const i=n.getSharedPagesStore(),r=N.G.createChildStore(i,t.pointer);p.Od({parent:i,childToRemove:r,transaction:o})};function ge(e){const{environment:t,spaceViewStore:n,userSettingsStore:o,transaction:i}=e,r=n.getSpaceId();if(!r||o.hasUserPinnedToOutliner({spaceId:r,type:"shared"}))return;const{visibleSharedPagesStores:a}=(0,M.k0)({environment:t,spaceViewStore:n,userSettingsStore:o}),s=a.map((e=>{let{id:t}=e;return t}));v.sW({store:n,data:{shared_pages:s},transaction:i}),k.Nb({userSettingsStore:o,spaceId:r,type:"shared",transaction:i})}async function he(e){const{from:t,environment:n,redirect:r}=e,{currentSpaceStore:a,currentSpaceViewStore:s}=R.default.state,c=new w.sA(n,"quickAddPage");if(!(H.M_(n)&&a&&a.canEdit()&&s))return void c.fail("invalid_state");V.ZP.setState({...V.ZP.state,lastPageId:R.default.state.mainEditorCurrentBlockStore?R.default.state.mainEditorCurrentBlockStore.id:void 0});const d=await async function(e){const{newPageTracker:t,quickAddParentOverride:n,environment:o}=e,{currentSpaceStore:i}=R.default.state;if(!i)return void t.fail("invalid_state");const r=n||await(0,C.lX)({spaceStore:i,currentUserId:o.currentUser.id}),a=x.uw(r);if("space-private-pages"===r.type||a.canAdmin()){return(await S.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.directMoveToAdd",waitForServerCommit:!1,perform:async e=>{const n=v.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:i.id,tracker:t,useCrdt:!1}),a=await m.Ws({environment:o,targets:[n],value:r,transaction:e});if(a&&"collection"===a.table){const t=a.getDefaultTemplatePageStore();t&&u.ob({title:"template",environment:o,store:n,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"sidebar_actions"})}return{createdPage:n}}})).performResult.createdPage}if(!a.canAdmin()&&a.canEdit()){const{performResult:{createdPage:e}}=await S.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToAdd",waitForServerCommit:!1,perform:async e=>{const n=v.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:i.id,useCrdt:!1});return t.track(n.pointer,e),await m.Ws({environment:o,targets:[n],value:{type:"space-private-pages",spaceId:i.id},transaction:e}),{createdPage:n}}});return await S.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToMove",waitForServerCommit:!1,perform:async t=>{const n=await m.kj({environment:o,targets:[e],value:r,transaction:t});if(n&&"collection"===n.table){const i=n.getDefaultTemplatePageStore();i&&u.ob({title:"template",environment:o,store:e,templateStore:i,isKeyboard:!1,isCreateIn:!1,transaction:t,from:"sidebar_actions"})}}}),e}t.fail("invalid_state")}({...e,newPageTracker:c});return d?(n.device.isMobile?(b._({environment:n,store:d,showMoveTo:!0,saveParent:!0,redirect:r,pageVisitSource:i.tY.SidebarQuickAdd}),ne()):y.CH({environment:n,store:d,showMoveTo:!0,saveParent:!0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:i.tY.SidebarQuickAdd}),g.Eo({environment:n,spaceViewStore:s,type:"private",newIsHidden:!1,outlinerToggleButtonStore:O.Z,shouldPersistToggleState:!0}),l.W2j(n,{from:t,type:"page",new_page_id:d.id,creating_block_id:d.id}),o.default.afterNextFlush((()=>{T.Z.SidebarScroller&&T.Z.SidebarScroller.scrollToBottom()})),d):void 0}const ve=(0,s.defineMessages)({label:{id:"sidebar.newPage.button",defaultMessage:"New page"},tooltip:{id:"sidebar.newPage.tooltip",defaultMessage:"Create a new page"}}),be="sidebar",ye="updateSidebar",_e="sidePeek";function Se(){const e={expanded:G.sidebarExpandedStore.state,width:G.sidebarWidthStore.state};a.Z.set(be,e)}function we(){const{expanded:e,width:t,openedOnBlockId:n,commentsMode:o,currentTab:i,currentSubTab:r}=J.ZP.state,s={expanded:e,width:t,openedOnBlockId:n,commentsMode:o,currentTab:i,currentSubTab:r};a.Z.set(ye,s)}function ke(){const e=a.Z.get(be),t=a.Z.get(ye),n=a.Z.get(_e);if((0,A.Y)("supportsNativeHome")?(G.sidebarExpandedStore.setState(!1),G.sidebarWidthStore.setState(0)):e?(void 0!==e.expanded&&G.sidebarExpandedStore.setState(e.expanded),void 0!==e.width&&e.width>=G.SidebarMinWidth&&G.sidebarWidthStore.setState(e.width)):(0,I.C)()&&G.sidebarExpandedStore.setState(!1),t){const e=t.width&&t.width>=J.AO?t.width:J.AO;J.ZP.setState({...J.ZP.state,...t,width:e}),window.innerWidth<X&&G.sidebarExpandedStore.setState(!1)}n&&L.default.setSidePeekWidth(n.width,window.innerWidth)}function Ie(e){J.ZP.setState({...J.ZP.state,currentTab:e})}function xe(e){J.ZP.setState({...J.ZP.state,commentsMode:e}),we()}function Ce(e){(0,K.Sx)(e)||G.sidebarExpandedStore.state?(oe({environment:e,isExpanded:!1,from:"toggle_both_sidebars"}),re({environment:e,isExpanded:!1,from:"keyboard_default"})):(re({environment:e,isExpanded:!0,from:"keyboard_default"}),oe({environment:e,isExpanded:!0,from:"toggle_both_sidebars"}))}function Te(){G.sidebarShouldLogInitialRenderStore.setState(!1)}},24646:(e,t,n)=>{n.d(t,{$3:()=>S,Bb:()=>P,GD:()=>D,J5:()=>y,Jr:()=>h,Nc:()=>f,Sx:()=>_,U8:()=>A,Wk:()=>k,YR:()=>C,_c:()=>g,em:()=>M,in:()=>v,js:()=>T,ll:()=>I,qG:()=>w,vG:()=>B,vJ:()=>x,vK:()=>b,wE:()=>R});var o=n(9291),i=n(28020),r=n(93827),a=n(38755),s=n(41549),l=n(80444),c=n(45325),d=n(88923),u=n(38676),p=n(36391),m=n(21853);const f=800;function g(e){return!1}function h(e){return!!e.device.isDesktop||!!e.device.isTablet&&e.WindowSizeStore.isLandscape()}function v(e){return((0,r.C)()||e.currentUser.isLoggedIn())&&u.sidebarExpandedStore.state}function b(e){return _(e)&&p.ZP.state.currentTab===p.gY.Comments}function y(e){return _(e)&&p.ZP.state.currentTab===p.gY.Updates}function _(e){var t;return(null===(t=l.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)===p.ZP.state.openedOnBlockId&&(e.currentUser.isLoggedIn()&&!e.device.isMobile&&p.ZP.state.expanded||m.Z.state.open)}function S(e){return e.WindowSizeStore.state.width-k(e)-I(e,!1)}function w(e){const{isDesktop:t,isMobile:n,isTablet:o}=e.device,{WindowSizeStore:i}=e,r=i.isLandscape(),a=n&&!o&&r;return t?u.sidebarWidthStore.state:o||a?Math.min(320,.87*e.WindowSizeStore.state.width):.87*e.WindowSizeStore.state.width}function k(e){const{shouldShowSidebar:t}=(0,i.h1)(e),n=v(e);return t&&n&&h(e)?w(e)+s.VV():t&&!n&&c.default.isOpen()?s.VV():0}function I(e,t){return t&&d.default.state.open?0:function(e){0;if(e.device.isMobile)return 0;if(x(e)>0)return 0;return _(e)?p.ZP.state.width:0}(e)+x(e)}function x(e){return d.default.isSidePeekOpen()?d.default.getSidePeekWidth(e.WindowSizeStore.state.width):0}function C(e){return e.device.isAndroid&&!e.device.isTablet||e.device.isTablet&&e.WindowSizeStore.isPortrait()}const T=(0,o.defineMessages)({createOrJoinWorkspace:{defaultMessage:"Create or join workspace",id:"sidebarSwitcher.createOrJoinWorkspaceButton.prompt"},personalPlan:{defaultMessage:"Personal Plan",id:"sidebarSwitcher.personalPlan.label"},proPlan:{defaultMessage:"Personal Pro Plan",id:"sidebarSwitcher.proPlan.label"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"educationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"sidebarSwitcher.educationPlusPlan.label"},freePlan:{defaultMessage:"Free Plan",id:"sidebarSwitcher.freePlan.label"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"sidebarSwitcher.enterprisePlan.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"sidebarSwitcher.legacyPlan.label"},workspaceSubtitleWithMembers:{id:"sidebarSwitcher.workspaceSubtitleWithMembers.label",defaultMessage:"{planType} Â· {numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}}"},workspaceSubtitleWithoutMembers:{id:"sidebarSwitcher.workspaceSubtitleWithoutMembers.label",defaultMessage:"{planType}"}});function M(e){switch(e){case"team_free":case"personal_free":case"free":return T.freePlan;case"personal":return T.plusPlan;case"student":return T.educationPlusPlan;case"plus":return T.plusPlan;case"business":return T.businessPlan;case"enterprise":return T.enterprisePlan;default:return T.legacyPlan}}function P(e){return e.canRead()&&"copy_indicator"!==e.getType()}function A(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o}=e;return t&&n&&!o}function R(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i}=e;return!i&&A({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o})}function D(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i}=e;return n&&!i&&!R({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:i})}function B(e){var t;let{environment:n}=e;const o=null===(t=(0,i.k_)(n).state)||void 0===t?void 0:t.showTeamSection,r=l.default.state.currentSpaceStore,s=n.device.isMobile;return!(!o||!r||s)&&!(0,a.Cx)(r)}},88310:(e,t,n)=>{n.d(t,{$L:()=>s,As:()=>c,hV:()=>d,ls:()=>u});var o=n(5809),i=n(72126),r=n(83055);const a={};function s(e){void 0===a[e]&&(a[e]=performance.now())}const l={};function c(e){Object.assign(l,e)}function d(){return l}function u(){const{app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s}=(0,r.IN)().sub_metrics,l=(0,o.$)(),c={app_start_to_await_get_spaces_start:p(l,a.await_get_spaces_start),app_start_to_await_get_spaces_end:p(l,a.await_get_spaces_end),app_start_to_browser_repaint_start:p(l,a.browser_repaint_start),app_start_to_browser_repaint_end:p(l,a.browser_repaint_end)},d=i.GM({app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s,...c},i.o8),u=[e,t,n,s];return u.some(i.o8)||(d.app_start_to_render_end=i.Sm(u)),d}function p(e,t){return void 0===e||void 0===t?void 0:t-e}},68418:(e,t,n)=>{n.d(t,{F:()=>r,Z:()=>s});var o=n(49085),i=n(4615);let r=function(e){return e[e.Team=0]="Team",e[e.Members=1]="Members",e}({});class a extends o.default{getInitialState(){return{open:!1,screen:r.Team,description:"",accessLevel:"open",isDefault:!1,name:"",icon:void 0,flowId:(0,i.ZP)(),pageNumber:1,onClose:void 0}}}const s=new a},97799:(e,t,n)=>{n.d(t,{Y:()=>i,Z:()=>r});var o=n(61766);let i=function(e){return e.Updates="updates",e.Home="home",e}({});const r=new o.Z},55521:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{touching:!1,swiping:!1}}}const r=new i},19034:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(80444);class r extends o.default{getInitialState(){return{results:[]}}getUnreadCountForCurrentSpace(){const{currentSpaceStore:e}=i.default.state,{results:t}=this.state;if(e){const n=t.find((t=>t.spaceId===e.id));if(n)return n.unread}return{mentions:0,following:0,highPriority:0}}getUnreadMentionsCountForOtherSpaces(){const{currentSpaceStore:e}=i.default.state,t=e&&e.id,{results:n}=this.state;let o=0;for(const i of n)i.spaceId!==t&&(o+=i.unread.mentions);return o}getTotalUnreadMentionsCount(){const{results:e}=this.state;let t=0;for(const n of e)t+=n.unread.mentions;return t}}const a=new r},38676:(e,t,n)=>{n.r(t),n.d(t,{SidebarMinWidth:()=>f,sidebarExpandedStore:()=>d,sidebarMouseEnterYStore:()=>c,sidebarMouseEnteredStore:()=>u,sidebarMousePeekXStore:()=>l,sidebarOpenStore:()=>a,sidebarResizingStore:()=>p,sidebarShouldLogInitialRenderStore:()=>g,sidebarShowTeamBrowserStore:()=>s,sidebarSizeObserver:()=>m,sidebarWidthStore:()=>r});var o=n(49085),i=n(77794);const r=o.default.createValue(240),a=o.default.createValue(!1),s=o.default.createValue(!1),l=o.default.createValue(0),c=o.default.createValue(0),d=o.default.createValue(!0),u=o.default.createValue(!1),p=o.default.createValue({isResizing:!1,isResizerHovered:!1}),m=new i.E,f=220,g=o.default.createValue(!0)},97852:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},78861:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(49085),i=n(72126),r=n(19889),a=n(66079),s=n(63143),l=n(81236),c=n(26136);class d extends o.default{getInitialState(){return{createType:void 0}}getAllSpaceViewStores(e){return e.currentUser.loggedInUserIds.reduce(((t,n)=>[...t,...this.getSpaceViewStores(e,n)]),[])}hasAtLeastOneTeamPlan(e){return this.getAllSpaceViewStores(e).map((e=>{const t=e.getSpaceStore();if(t)return t.getPlanType()})).some((e=>"team"===e))}getSpaceViewStores(e,t){const n=new c.r9(e,{table:a.dx,id:t},{userId:t}).getSpaceViewStores();return i.mN(n,(e=>e.isDefined()&&e.getSpaceId())).filter((t=>Boolean(t.isDefined())&&Boolean(t.getAlive())&&!this.isSpaceDeleted(e,t)))}isSpaceDeleted(e,t){const n=t.getSpaceId()||"",o=l.Z.getPublicSpaceData(e,n);return(0,s.z4)(o)}getUserEmailAddress(e,t){return new c.U6(e,{table:r.KJ,id:t},{userId:t}).getEmail()}}const u=new d},55838:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>i});var o=n(49085);let i=function(e){return e[e.General=0]="General",e[e.Members=1]="Members",e[e.Security=2]="Security",e}({});class r extends o.default{getInitialState(){return{open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}}getTeamStore(){return this.state.open?this.state.viewingUnjoinedPrivateTeamAsEnterpriseAdmin?this.state.unjoinedPrivateTeamStore:this.state.teamStore:void 0}}const a=new r},77999:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a,orderedTeamSidebarTourSteps:()=>i});var o=n(49085);const i=["welcome","actions","teamspaces","prebuilt_templates","private","explore_templates"];class r extends o.default{getInitialState(){return{type:"inactive"}}}const a=new r},36896:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},44604:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.loadMoreOffset=200,this.startLimit=20,this.limitIncrement=20}getInitialState(){return{filter:"",currentTab:"all_pages",loading:!0,limit:this.startLimit,excludePages:new Set}}}const r=new i},36391:(e,t,n)=>{n.d(t,{AO:()=>l,F7:()=>r,ZP:()=>u,gY:()=>a,uF:()=>s});var o=n(49085),i=n(92595);let r=function(e){return e[e.Resolved=0]="Resolved",e[e.Unresolved=1]="Unresolved",e}({}),a=function(e){return e[e.Comments=0]="Comments",e[e.Updates=1]="Updates",e[e.AiContext=2]="AiContext",e[e.Info=3]="Info",e}({}),s=function(e){return e[e.Updates=0]="Updates",e[e.Analytics=1]="Analytics",e}({});const l=385;class c extends o.default{getInitialState(){return{width:l,expanded:!1,isResizerHovered:!1,isResizing:!1,mouseEntered:!1,currentTab:a.Comments,currentSubTab:s.Updates,commentsMode:r.Unresolved,isAnimating:!1,canRender:!0}}}const d=new c;(0,i.exposeDebugValue)("UpdateSidebarStore",d);const u=d},21853:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},98794:(e,t,n)=>{n.r(t),n.d(t,{annotateSimpleTableSelection:()=>te,appendRow:()=>fe,cancelReorder:()=>Ce,clearHover:()=>re,clearSelectedCell:()=>Fe,clearSelection:()=>G,clearSelectionContents:()=>Ze,completeReorder:()=>Te,continueReorder:()=>xe,contractColumns:()=>Pe,contractRows:()=>De,deleteColumns:()=>Me,deleteRows:()=>Re,duplicateColumns:()=>ge,duplicateRows:()=>he,expandCellSelection:()=>q,extendColumns:()=>se,extendRows:()=>pe,fitToPage:()=>ze,handleDelete:()=>J,handleDuplicate:()=>ee,handleKeypress:()=>X,handleLeftRightKey:()=>$,handleUpDownKey:()=>Y,hoverCell:()=>ne,hoverResizer:()=>ie,hoverRowColumn:()=>oe,insertColumnLeft:()=>ae,insertColumnRight:()=>le,insertRow:()=>me,insertRowAbove:()=>de,insertRowBelow:()=>ue,messages:()=>L,resizeColumn:()=>Se,selectCell:()=>z,selectCellAndSetCursor:()=>H,selectColumn:()=>N,selectMultiCell:()=>W,selectRow:()=>O,setColor:()=>Ne,setResizing:()=>ye,showResizeBar:()=>be,startReorder:()=>Ie,toggleHeaderColumn:()=>Oe,toggleHeaderRow:()=>Le,turnIntoCollection:()=>je,turnIntoSimpleTable:()=>Ue,updateCellSelectionFromTextSelection:()=>K,updateColumnSelectionOnResize:()=>ke,updateRowSelectionOnResize:()=>we});n(57658),n(21703);var o=n(1302),i=n(41432),r=n(90559),a=n(99036),s=n(80951),l=n(4615),c=n(71644),d=n(21202),u=n(6287),p=n(13493),m=n(23867),f=n(70203),g=n(63143),h=n(9291),v=n(50906),b=n(54532),y=n(96802),_=n(94419),S=n(19785),w=n(9953),k=n(24677),I=n(993),x=n(98104),C=n(82530),T=n(95477),M=n(14976),P=n(33929),A=n(65598),R=n(22294),D=n(26136),B=n(27724),E=n(24666),F=n(27534),Z=n(84139),V=n(64359),j=n(5676),U=n(63208);const L=(0,h.defineMessages)({turnIntoCollectionTitle:{defaultMessage:"Title",id:"simpleTableActions.collectionTitle"},turnIntoCollectionColumnTitle:{defaultMessage:"Column {columnIndex}",id:"simpleTableActions.collectionColumnTitle"}});function O(e){const{environment:t,index:n,simpleTableStore:o}=e,i=F.getNumberOfRows(o);if(0===i)return G(),void x.ZH(t);const r=(0,g.uZ)(n,0,i-1);U.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:0,row:r},end:{col:F.getNumberOfColumns(o)-1,row:r},type:"row"}}),k.Z5({environment:t,stores:[o],phase:B.SelectionPhase.Editing}),x.ZH(t)}function N(e){const{environment:t,index:n,simpleTableStore:o}=e,i=F.getNumberOfColumns(o);if(0===i)return G(),void x.ZH(t);const r=(0,g.uZ)(n,0,i-1);U.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:r,row:0},end:{col:r,row:F.getNumberOfRows(o)-1},type:"column"}}),k.Z5({environment:t,stores:[o],phase:B.SelectionPhase.Editing}),x.ZH(t)}function z(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:i}=e;U.Z.setState({isActive:!0,simpleTableStore:i,selection:{start:{col:o,row:n},end:{col:o,row:n},type:"cell"}}),k.Z5({environment:t,stores:[i],phase:B.SelectionPhase.Editing})}function W(e){const{environment:t,start:n,end:o,simpleTableStore:i}=e;U.Z.setState({isActive:!0,simpleTableStore:i,selection:{start:n,end:o,type:"cell"}}),k.Z5({environment:t,stores:[i],phase:B.SelectionPhase.Editing}),x.ZH(t)}function q(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:i}=e;W({environment:t,start:U.Z.state.isActive?U.Z.state.selection.start:{col:o,row:n},end:{col:o,row:n},simpleTableStore:i})}function H(e){z(e);const t=F.getCellTextStore(e);t&&x.NX({store:t})}function K(){if("editing"!==E.default.state.mode)return;const e=F.getSimpleTableCellFromTextSelection();if(!e)return void G();const{columnIndex:t,rowIndex:n,simpleTableStore:o}=e.getProps(),i=U.Z.state;if(i.isActive){const{start:e,end:r}=i.selection;!(e.col===r.col&&e.row===r.row)||e.col===t&&e.row===n&&i.simpleTableStore===o||z({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}else z({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}function G(){U.Z.setState({isActive:!1})}function $(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:i}=e;if(!o&&F.getSimpleTableCellFromTextSelection())return;const r=U.Z.state;if(r.isActive){const{selection:e,simpleTableStore:a}=r;if(i){const{rowIndex:o,columnIndex:i}=Q({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});return void q({environment:t,rowIndex:o,columnIndex:i,simpleTableStore:a})}if(F.isColumnSelected({selection:e,columnIndex:e.start.col,simpleTableStore:a})){const{columnIndex:o}=Q({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});N({environment:t,index:o,simpleTableStore:a})}else{const i="editing"===E.default.state.mode;o&&x.ZH(t);const{rowIndex:r,columnIndex:s}=Q({selection:e,simpleTableStore:a,direction:n,wrapRow:!0});if(i)return void H({environment:t,rowIndex:r,columnIndex:s,simpleTableStore:a});z({environment:t,rowIndex:r,columnIndex:s,simpleTableStore:a})}}R.Z.setKeyboardMode(!0)}function Q(e){const{selection:t,simpleTableStore:n,direction:o,wrapRow:i}=e,r=F.getNumberOfColumns(n)-1,a=F.getNumberOfRows(n)-1,{col:s,row:l}=t.end;return"right"===o?s===r&&l===a?{columnIndex:r,rowIndex:a}:s===r?i?{columnIndex:0,rowIndex:l+1}:{columnIndex:s,rowIndex:l}:{columnIndex:s+1,rowIndex:l}:0===s&&0===l?{columnIndex:0,rowIndex:0}:0===s?i?{columnIndex:r,rowIndex:l-1}:{columnIndex:s,rowIndex:l}:{columnIndex:s-1,rowIndex:l}}function Y(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:i}=e;if(!o&&F.getSimpleTableCellFromTextSelection())return;const r=U.Z.state;if(r.isActive){const{selection:e,simpleTableStore:a}=r,{rowIndex:s,columnIndex:l}=function(e){const{selection:t,simpleTableStore:n,direction:o}=e,i=F.getNumberOfRows(n)-1,{col:r,row:a}=t.end,s="down"===o?Math.min(i,a+1):Math.max(0,a-1);return{columnIndex:r,rowIndex:s}}({selection:e,simpleTableStore:a,direction:n});if(i)return void q({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a});F.isRowSelected({selection:e,rowIndex:e.start.row,simpleTableStore:a})?O({environment:t,index:s,simpleTableStore:a}):(o&&x.ZH(t),z({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a}))}R.Z.setKeyboardMode(!0)}function J(e){if(F.getSimpleTableCellFromTextSelection())return;const t=U.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:i,simpleTableStore:r}=t;if(F.isColumnSelected({selection:i,columnIndex:i.start.col,simpleTableStore:r}))Ze(e),Ae({index:i.start.col,simpleTableStore:r,transaction:o}),N({environment:n,index:i.start.col,simpleTableStore:r});else if(F.isRowSelected({selection:i,rowIndex:i.start.row,simpleTableStore:r})){Be({rowID:r.getRenderableContentIds()[i.start.row],simpleTableStore:r,transaction:o}),O({environment:n,index:i.start.row,simpleTableStore:r})}else F.isSingleCellSelected(i)?Fe({environment:n,transaction:o}):Ze({environment:n,transaction:o})}function X(e){if(F.getSimpleTableCellFromTextSelection())return;const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getContentStores()[n.end.row],r=F.getColumnOrder(o);if(!r)return;const{environment:a,transaction:s,key:l}=e,c=i.getPropertyStore(r[n.end.col]);if(l&&1===l.length){const e=c.getValue(),t=f.TPx(l);I.sO({environment:a,store:c,value:e?e.concat(t):t,transaction:s}),x.NX({store:c})}}function ee(e){if(F.getSimpleTableCellFromTextSelection())return;const t=U.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:i,simpleTableStore:r}=t;F.isColumnSelected({selection:i,columnIndex:i.start.col,simpleTableStore:r})?ge({transaction:o}):F.isRowSelected({selection:i,rowIndex:i.start.row,simpleTableStore:r})&&he({environment:n,transaction:o})}function te(e){const{simpleTableStore:t,annotation:n}=e,o=U.Z.state;if(!o.isActive||o.simpleTableStore!==t)return;const{selection:i}=o,r=[],a=Math.min(i.start.row,i.end.row),s=Math.max(i.start.row,i.end.row),l=Math.min(i.start.col,i.end.col),c=Math.max(i.start.col,i.end.col);for(let p=a;p<=s;p++)for(let e=l;e<=c;e++){const n=F.getCellTextStore({simpleTableStore:t,rowIndex:p,columnIndex:e}),o=null==n?void 0:n.getValue();n&&o&&r.push({textStore:n,textValue:o})}const d=f.J7s(n),u=r.every((e=>{let{textValue:t}=e;return t.every((e=>f.hDy(e).some((e=>f.J7s(e)===d))))}));for(const{textStore:p}of r)I.QT({...e,textStore:p,action:u?"removeAnnotationType":"annotate"})}function ne(e){if(_e())return;const{x:t,y:n,simpleTableStore:o}=e;V.Z.setState({isActive:!0,simpleTableStore:o,hover:{x:t,y:n,showResizer:!1,resizing:!1,type:"cell"}})}function oe(e){if(_e())return;const{type:t,simpleTableStore:n,index:o}=e;V.Z.setState({isActive:!0,simpleTableStore:n,hover:{type:t,index:o}})}function ie(e){const{simpleTableStore:t,resizer:n}=e;V.Z.setState({isActive:!0,simpleTableStore:t,hover:{type:"resizer",resizer:n}})}function re(){_e()||V.Z.setState({isActive:!1})}function ae(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;ce({index:n.start.col,simpleTableStore:o,transaction:r}),H({environment:i,rowIndex:0,columnIndex:n.start.col,simpleTableStore:o})}function se(e){const{count:t,simpleTableStore:n,transaction:o}=e;if(t<1)return;const i=F.getNumberOfColumns(n);for(let r=0;r<t;r++)ce({index:i+r,simpleTableStore:n,transaction:o})}function le(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;ce({index:n.end.col+1,simpleTableStore:o,transaction:r}),H({environment:i,rowIndex:0,columnIndex:n.end.col+1,simpleTableStore:o})}function ce(e){const{index:t,simpleTableStore:n,transaction:o,columnID:i,format:r}=e,a=F.getColumnOrder(n)||[],s=F.getColumnFormat(n),l=i||(0,c.ZP)(),d=[...a.slice(0,t),l,...a.slice(t)],u=r?{...s,[l]:r}:s;y.FH({stores:[n],update:{table_block_column_order:d,table_block_column_format:u},transaction:o})}function de(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;me({environment:i,index:n.start.row,simpleTableStore:o,transaction:r}),H({environment:i,rowIndex:n.start.row,columnIndex:0,simpleTableStore:o})}function ue(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;me({environment:i,index:n.end.row+1,simpleTableStore:o,transaction:r}),H({environment:i,rowIndex:n.end.row+1,columnIndex:0,simpleTableStore:o})}function pe(e){const{environment:t,count:n,simpleTableStore:o,transaction:i,analyticsFrom:r}=e;if(n<1)return;const a=F.getNumberOfRows(o);for(let s=0;s<n;s++)me({environment:t,index:a+s,simpleTableStore:o,transaction:i,analyticsFrom:r})}function me(e){const{environment:t,index:n,simpleTableStore:o,transaction:i,analyticsFrom:r}=e,a=o.getContentStore();if(!(0,A.dz)(a))throw new Error("Block has an invalid parent.");const s=w.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:i,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),l=D.G.createChildStore(a,s.pointer);if(r&&v.W2j(t,{from:r,type:"table_row",creating_block_id:s.id}),n<=0)S.SH({parentStore:a,childStore:l,transaction:i});else{const e=o.getContentStores();S.jG({parentStore:a,childStore:l,transaction:i,after:e[n-1].id})}return l}function fe(e){const{environment:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();if(!(0,A.dz)(i))throw new Error("Block has an invalid parent.");const r=w.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()}),a=D.G.createChildStore(i,r.pointer);return S.jG({parentStore:i,childStore:a,transaction:o}),a}function ge(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=F.getColumnOrder(o),r=F.getColumnFormat(o);if(!i)return;const a=i.slice(n.start.col,n.end.col+1);if(!a)return;const s=[],{transaction:l}=e;for(let d=n.start.col;d<=n.end.col;d++){const e=a[d-n.start.col],t=(0,c.ZP)();s.push(t),ce({index:n.end.col+1,simpleTableStore:o,transaction:l,columnID:t,format:r?r[e]:void 0})}for(const c of o.getContentStores())ve({rowStore:c,columnIDs:a,newColumnIDs:s,transaction:l})}function he(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getRenderableContentIds(),{environment:r,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++){const e=D.G.createChildStore(o,{table:d.iU,id:i[s]}),[t]=b.Qi({environment:r,stores:[e],addCopyName:!1,transaction:a,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,m.C)(e.pointer.spaceId),baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.useCrdt()}),n=t[0];_.BE({parent:o.getContentStore(),insert:n,after:e,transaction:a})}}function ve(e){const{rowStore:t,columnIDs:n,newColumnIDs:o,transaction:i}=e,r=t.getPropertiesStore(),a={...r.getValue(),...(0,g.m8)(o.map(((e,o)=>[e,t.getPropertyValue(n[o])])))};w.sO({store:r,value:a,transaction:i})}function be(e){const t=V.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&V.Z.setState({...t,hover:{...n,showResizer:e}})}function ye(e){const t=V.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&V.Z.setState({...t,hover:{...n,resizing:e}})}function _e(){const e=V.Z.state;return e.isActive&&"resizing"in e.hover&&e.hover.resizing}function Se(e){const{tableBlockColumnFormat:t,simpleTableStore:n,transaction:o}=e;y.FH({stores:[n],update:{table_block_column_format:t},transaction:o})}function we(e){const t=U.Z.state;if(!t.isActive||"row"!==t.selection.type)return;const{selection:n}=t;U.Z.setState({...t,selection:{...n,end:{col:e,row:n.end.row}}})}function ke(e){const t=U.Z.state;if(!t.isActive||"column"!==t.selection.type)return;const{selection:n}=t;U.Z.setState({...t,selection:{...n,end:{col:n.end.col,row:e}}})}function Ie(e){const{environment:t,simpleTableStore:n,id:o,index:i,type:r,rowStore:a,theme:s,selectorStartPx:l,mouseOffsetPx:c}=e;let d=[];"column"===r?(N({environment:t,index:i,simpleTableStore:n}),d=Z.Z.findCellsInColumnFromStore(n,o)):(O({environment:t,index:i,simpleTableStore:n}),d=Z.Z.findCellsInRowFromStore(a));const u=F.cloneCellsForDragOverlay({cells:d,type:r,theme:s});j.Z.setState({isActive:!0,simpleTableStore:n,source:{id:o,type:r,index:i,draggedCells:u,selectorStartPx:l,mouseOffsetPx:c},destIndex:i,selectorDragPx:l,moved:!1})}function xe(e){const{destIndex:t,selectorDragPx:n}=e,o=j.Z.state;o.isActive&&j.Z.setState({...o,destIndex:t,selectorDragPx:n,moved:!0})}function Ce(){j.Z.reset()}function Te(e){const{event:t,environment:n,format:i,simpleTableStore:r,transaction:a,type:s,onNoChange:l}=e,c=j.Z.state;if(!c.isActive)return;const{source:d,destIndex:u}=c;d.type===s&&c.simpleTableStore===r&&("column"===s?function(e){const{environment:t,columnOrder:n,source:i,destIndex:r,simpleTableStore:a,transaction:s}=e;if(!n)return;G();const l=[...n.slice(0,i.index),...n.slice(i.index+1)],c=[...l.slice(0,r),i.id,...l.slice(r)];y.FH({stores:[a],update:{table_block_column_order:c},transaction:s}),o.default.afterNextFlush((()=>{N({environment:t,index:r,simpleTableStore:a})}))}({environment:n,columnOrder:i.table_block_column_order,source:d,destIndex:u,simpleTableStore:r,transaction:a}):function(e){const{environment:t,source:n,destIndex:i,simpleTableStore:r,transaction:a}=e,s=r.getRenderableContentIds(),l=i>n.index?i:i-1;let c=i>0?s[l]:void 0;c===n.id&&(c=s[l+1]);G();const d=r.getContentStores().find((e=>e.id===n.id)),u=r.getContentStores().find((e=>e.id===c));if(d){const e=r;u?S.jG({parentStore:e,after:u.id,childStore:d,transaction:a}):S.SH({parentStore:e,childStore:d,transaction:a}),o.default.afterNextFlush((()=>{O({environment:t,index:i,simpleTableStore:r})}))}}({environment:n,source:d,destIndex:u,simpleTableStore:r,transaction:a}),d.index===u&&(null==l||l(t)))}function Me(e){const t=U.Z.state;if(!t.isActive)return;Ze(e);const{selection:n,simpleTableStore:o}=t,{environment:i,transaction:r}=e;for(let a=n.start.col;a<=n.end.col;a++)Ae({index:a,simpleTableStore:o,transaction:r});N({environment:i,index:n.start.col,simpleTableStore:o})}function Pe(e){const{simpleTableStore:t,columnOrder:n,transaction:o}=e;y.FH({stores:[t],update:{table_block_column_order:n},transaction:o})}function Ae(e){const{index:t,simpleTableStore:n,transaction:o}=e,i=F.getColumnOrder(n);if(!i||1===i.length)return;const r=[...i.slice(0,t),...i.slice(t+1)];y.FH({stores:[n],update:{table_block_column_order:r},transaction:o})}function Re(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=o.getRenderableContentIds(),{environment:r,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++)Be({rowID:i[s],simpleTableStore:o,transaction:a});O({environment:r,index:n.start.row,simpleTableStore:o})}function De(e){const{simpleTableStore:t,numRowsToDelete:n,transaction:o}=e,i=t.getRenderableContentIds();for(let r=i.length-n;r<i.length;r++)Be({rowID:i[r],simpleTableStore:t,transaction:o})}function Be(e){const{rowID:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();if(!(0,A.dz)(i))throw new Error("Block has an invalid parent.");if(F.getNumberOfRows(n)<=1)return;const r={table:d.iU,id:t};Ee({rowStore:D.G.createChildStore(i,r),simpleTableStore:n,transaction:o})}function Ee(e){const{rowStore:t,simpleTableStore:n,transaction:o}=e,i=n.getContentStore();S.hr({parentStore:i,childStore:t,transaction:o})}function Fe(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n}=t;if(!F.isSingleCellSelected(n))return;const{environment:o,transaction:i}=e;Ze({environment:o,transaction:i})}function Ze(e){const t=U.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,i=F.getColumnOrder(o);if(!i)return;const r=o.getContentStores(),{environment:a,transaction:s}=e,l=Math.min(n.start.row,n.end.row),c=Math.max(n.start.row,n.end.row),d=Math.min(n.start.col,n.end.col),u=Math.max(n.start.col,n.end.col);for(let p=l;p<=c;p++)Ve({rowStore:r[p],startIndex:d,endIndex:u,columnOrder:i,transaction:s});x.ZH(a)}function Ve(e){const{rowStore:t,startIndex:n,endIndex:o,columnOrder:i,transaction:r}=e,a=i.slice(n,o+1);if(!a)return;const s=t.getPropertiesStore(),l=(0,g.m8)(Object.entries(s.getValue()||{}).filter((e=>{let[t,n]=e;return!a.includes(t)})));w.sO({store:s,value:l,transaction:r})}function je(e){const{environment:t,simpleTableStore:n,transaction:o}=e,r=F.getColumnOrder(n)||[],s=F.getColumnFormat(n)||{},{headerRow:c}=F.getHeadersEnabled(n),m=n.getContentStores();if(!r.length)return;const f=r[0],h=n.getSpaceId(),v=(0,l.ZP)(),b=(0,l.ZP)(),y=c?m[0]:void 0,_=(0,g.m8)(r.map(((e,t)=>function(e){const{columnID:t,columnIndex:n,titleColumnID:o,headerRowStore:i}=e;let r=t,a="text",s=L.turnIntoCollectionColumnTitle;t===o&&(r="title",a="title",s=L.turnIntoCollectionTitle);const l=P.default.getIntl();return[r,{name:i?M.Xh(i.getPropertyValue(t),i):l.formatMessage(s,{columnIndex:n}),type:a}]}({columnID:e,columnIndex:t,titleColumnID:f,headerRowStore:y})))),k={id:v,version:0,parent_table:d.iU,parent_id:n.id,space_id:h,name:void 0,schema:_,alive:!0},x=w.ae({environment:t,table:"collection",value:k,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o});w.sW({store:n,data:{type:i.Ti.collectionView,view_ids:[b],collection_id:v},transaction:o}),w.sW({store:n.getFormatStore(),data:{collection_pointer:{table:u.v,id:v,spaceId:h}},transaction:o}),m.map(((e,r)=>{if(c&&0===r)return void Ee({rowStore:e,simpleTableStore:n,transaction:o});const a=e.getProperties();w.sW({store:e,data:{type:i.Ti.page},transaction:o}),I.sO({environment:t,store:e.getBlockTitleStore(),value:a[f],transaction:o}),w.sW({store:e.getPropertiesStore(),data:{[f]:void 0},transaction:o}),S.zw({childStore:e,parentStore:x,transaction:o})}));const T={id:b,version:0,type:"table",name:void 0,parent_id:n.id,parent_table:"block",space_id:h,format:{table_properties:r.map((e=>({visible:!0,property:e===f?"title":e,width:s&&e in s?s[e].width:void 0})))},page_sort:m.map((e=>e.id)).slice(0,a.gq),alive:!0},A={table:p.n,id:b,spaceId:h};C.applyOperation({store:(0,D.Kv)(n,A),operation:{pointer:A,command:"set",path:[],args:T},transaction:o})}function Ue(e){var t;const{environment:n,collectionViewBlockStore:o,pageStores:a,transaction:l}=e,d=o.getCollectionViewSourceCollectionStore();if(!d)return;if(a.length>F.simpleTableTransformPageLimit||a.some((e=>e.hasContent())))return;const[u]=o.getCollectionViewStores(),p=d.getSchema(),m=(u.getFormat().table_properties||[]).filter((e=>e.visible&&e.property in p));if(!m)return;const f=o.getContentStore(),h=(0,c.ZP)();w.sW({store:o,data:{type:i.Ti.table,collection_id:null},transaction:l}),w.sW({store:o.getFormatStore(),data:{table_block_column_order:m.map((e=>"title"===e.property?h:e.property)),table_block_column_format:(0,g.m8)(m.map((e=>["title"===e.property?h:e.property,{width:e.width}]))),table_block_column_header:!0,collection_pointer:null},transaction:l});const v=w.j4({environment:n,type:"table_row",properties:(0,g.m8)(m.map((e=>{const t=e.property,n=t in p?p[t]:void 0;return["title"===t?h:t,n?[[n.name]]:[]]}))),inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:l,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),b=D.G.createChildStore(f,v.pointer);S.SH({parentStore:f,childStore:b,transaction:l});const y=(0,r.$z)(p),_=y.length>0?null===(t=d.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey():void 0;a.map(((e,t)=>{const o=D.G.createChildStore(f,e.pointer),a=e.getProperties(),c=y.reduce((function(e,t){const n=(0,r.wf)(_,s.ah(a[t]));return e[t]=[[n]],e}),{});w.sW({store:o,data:{type:i.Ti.tableRow},transaction:l}),w.sW({store:o.getPropertiesStore(),data:{...c,[h]:o.getBlockTitleStore().getValue()},transaction:l}),I.sO({environment:n,store:o.getBlockTitleStore(),value:void 0,transaction:l}),S.jG({parentStore:f,childStore:o,transaction:l})})),w.sW({store:d,data:{alive:!1},transaction:l}),w.sW({store:u,data:{alive:!1},transaction:l})}function Le(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),i=!Boolean(o.table_block_column_header);y.FH({stores:[t],update:{table_block_column_header:i},transaction:n})}function Oe(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),i=!Boolean(o.table_block_row_header);y.FH({stores:[t],update:{table_block_row_header:i},transaction:n})}function Ne(e,t,n){const o=U.Z.state;if(!o.isActive)return;const{selection:i,simpleTableStore:r}=o;if("row"===i.type){const e=r.getContentStores()[i.start.row];y.FH({stores:[e],update:{block_color:"default"===t?void 0:t},transaction:n})}if("column"===i.type){const e=F.getColumnOrder(r),o=F.getColumnFormat(r)||{};if(!e)return;const a=e[i.start.col];a in o?o[a].color=t:o[a]={color:t},y.FH({stores:[r],update:{table_block_column_format:o},transaction:n})}B.default.state.phase!==B.SelectionPhase.Selected||e.device.isMobile||k.ZH(e)}function ze(e){const{simpleTableStore:t,parentWidth:n,transaction:o}=e,i=F.getColumnOrder(t);if(!i)return;const r=F.getColumnFormat(t),a=(n-18)/i.length,s=(0,g.m8)(i.map((e=>[e,{width:a,color:r&&r[e]?r[e].color:void 0}])));y.FH({stores:[t],update:{table_block_column_format:s},transaction:o})}},27534:(e,t,n)=>{n.r(t),n.d(t,{blockSelectionInSimpleTable:()=>C,cloneCellsForDragOverlay:()=>D,columnsHaveData:()=>V,getCellTextStore:()=>R,getColumnFormat:()=>I,getColumnOrder:()=>S,getHeadersEnabled:()=>x,getNextEditableStoreForSimpleTable:()=>N,getNumberOfColumns:()=>w,getNumberOfRows:()=>k,getNumberOfUnresolvedComments:()=>F,getPagesInCollectionForSimpleTableTransform:()=>L,getPreviousEditableStoreForSimpleTable:()=>O,getSimpleTableCellFromTextSelection:()=>A,getTableResizeState:()=>B,isColumnSelected:()=>T,isPropertyTypeConvertableToSimpleTable:()=>j,isRowSelected:()=>M,isSingleCellSelected:()=>P,renderCellValueForActivity:()=>E,rowsHaveData:()=>Z,simpleTableTransformPageLimit:()=>U});var o=n(8848),i=n(42875),r=n(29477),a=n(21202),s=n(23867),l=n(97880),c=n(54642),d=n(42239),u=n(60682),p=n(43250),m=n(14976),f=n(65598),g=n(89086),h=n(24646),v=n(26136),b=n(24666),y=n(84139),_=n(29574);function S(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_order}function w(e){var t;return(null===(t=S(e))||void 0===t?void 0:t.length)||0}function k(e){return e.getContentLength()}function I(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_format}function x(e){var t,n;return{headerColumn:null==e||null===(t=e.getFormat())||void 0===t?void 0:t.table_block_row_header,headerRow:null==e||null===(n=e.getFormat())||void 0===n?void 0:n.table_block_column_header}}function C(e){const t=["table","table_row"];return e.map((e=>e.getType())).some((e=>e&&t.includes(e)))}function T(e){const{selection:t,columnIndex:n,simpleTableStore:o}=e,i=t.start.col<=n&&n<=t.end.col;return"column"===t.type&&i&&0===t.start.row&&t.end.row===k(o)-1}function M(e){const{selection:t,rowIndex:n,simpleTableStore:o}=e,i=t.start.row<=n&&n<=t.end.row;return"row"===t.type&&i&&0===t.start.col&&t.end.col===w(o)-1}function P(e){return e.start.col===e.end.col&&e.start.row===e.end.row}function A(){const e="editing"===b.default.state.mode&&b.default.state.multiSelection;if(e)return y.Z.findCellFromTextStore(e.start.store)}function R(e){const{simpleTableStore:t,rowIndex:n,columnIndex:o}=e,i=t.getContentStores()[n];if(!i)return;const r=S(t);if(!r)return;const a=r[o];return a?i.getPropertyStore(a):void 0}function D(e){const{cells:t,type:n,theme:i}=e;return t.map((e=>function(e){const{cell:t,type:n,theme:i}=e;if(!t.getNode())return;const r=d.eN(t.getNode()),a=r.cloned.querySelector(`.${p.Apy}`),s=r.cloned.querySelector(`.${p.f0e}`);"column"===n?(a&&(a.style.left="calc(50% - 15px)",a.style.fill=o.ZP.white,a.style.background=i.simpleTableSelectionBorder),s&&(s.style.visibility="hidden")):(s&&(s.style.top="calc(50% - 15px)",s.style.left="-7px",s.style.fill=o.ZP.white,s.style.background=i.simpleTableSelectionBorder),a&&(a.style.visibility="hidden"));return{cloned:r.cloned,rect:DOMRect.fromRect(r.rect)}}({cell:e,type:n,theme:i}))).filter(l.$K)}function B(e,t){const n=_.Z.state;if(n.isActive&&n.simpleTableStore===e&&(!t||n.resize===t))return n}function E(e){const{environment:t,cellValue:n,spaceId:o,parentStore:i,theme:r}=e;return m.IY({environment:t,textValue:n?{value:n,spaceId:o}:void 0,parentStore:i,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableHover:!0,disabled:!0,theme:r,emojiType:(0,u.e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})}function F(e){const{simpleTableStore:t,environment:n,includeInline:o}=e;return f.Xp(t,{recursivelyLoadAllDiscussions:o,onlyIncludeBlockLevelDiscussions:(0,h.Sx)(n)})}function Z(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),i=S(t);if(!o||!i)return!1;for(let r=o.length-1;r>Math.max(o.length-1-n,0);r--){const e=o[r].getProperties();if(e&&i.some((t=>t in e&&e[t])))return!0}return!1}function V(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),i=S(t);if(!o||!i)return!1;const r=i.slice(-n);return o.some((e=>{const t=e.getProperties();return t&&r.some((e=>e in t&&t[e]))}))}const j={title:!0,text:!0,url:!0,email:!0,person:!0,number:!0,date:!0,phone_number:!0,select:!0,multi_select:!0,status:!0,auto_increment_id:!0,file:!1,checkbox:!1,relation:!1,rollup:!1,formula:!1,created_by:!1,created_time:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,button:!1,location:!1,verification:!1},U=200;async function L(e){const{environment:t,collectionViewBlockStore:n}=e,o=n.getCollectionViewSourceCollectionStore();if(!o)return[];const[l]=n.getCollectionViewStores(),d={source:{type:"collection",id:o.id,spaceId:(0,s.C)(o.pointer.spaceId)},collectionView:{id:l.id,spaceId:(0,s.C)(l.pointer.spaceId)},loader:{type:"reducer",reducers:{results:{type:"results",limit:U+1,loadContentCover:!1}},searchQuery:void 0,userId:t.currentUser.id,userTimeZone:(0,i.r)()}},u=c.queryCollection(t,d,void 0,{src:"simple_tbl_transform"}),p=await(0,r.OI)(1e4,[u]);if(!p.timeout){const{result:e}=p;if("success"===e.type){const t=e.data.result.reducerResults.results;return(t&&"results"===t.type?t.blockIds:[]).map((e=>v.G.createChildStore(o,{id:e,table:a.iU})))}}return[]}function O(e){let t;if(0===e.getProps().rowIndex){const n=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:0,columnIndex:0});n&&(t=(0,g.mK)(n))}else t=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:e.getProps().rowIndex-1,columnIndex:e.getProps().columnIndex});return t}function N(e){let t;const n=k(e.getProps().simpleTableStore);if(e.getProps().rowIndex===n-1){const o=w(e.getProps().simpleTableStore),i=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:n-1,columnIndex:o-1});i&&(t=(0,g.hn)(i))}else t=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:e.getProps().rowIndex+1,columnIndex:e.getProps().columnIndex});return t}},41662:(e,t,n)=>{n.d(t,{Wv:()=>gt,fZ:()=>ze,HM:()=>i,g$:()=>o});var o=n(27534),i=n(98794),r=n(45697),a=n.n(r),s=n(67294),l=n(83355),c=n(1302),d=n(12137),u=n(52989),p=n(61045),m=n(23864),f=n(68709),g=n(53336),h=n(79954),v=n(95645),b=n(43250),y=n(78316),_=n(12534),S=n(38755),w=n(24646),k=n(34859),I=n(77794);var x=n(49085);class C extends x.default{getInitialState(){return{}}setTemporaryFormat(e){this.update((t=>({...t,temporaryFormat:e})))}updateColumnOrder(e){this.update((t=>({...t,temporaryFormat:{...t.temporaryFormat,table_block_column_order:e}})))}}const T=C;var M=n(64359),P=n(5676),A=n(63208),R=n(13991),D=n(480),B=n(86628),E=n(24405),F=n(8848),Z=n(55631),V=n(42853),j=n(77734),U=n(73599),L=n(82990),O=n(51454),N=n(9291),z=n(82530),W=n(13966),q=n(23063),H=n(64921),K=n(52275),G=n(31945),$=n(78140),Q=n(32163),Y=n(72495),J=n(24006),X=n(26388),ee=n(87279),te=n(95802),ne=n(22294),oe=n(27724),ie=n(29574),re=n(85893);function ae(e){var t;window.__c={n:"ActionBarContent"};const{simpleTableStore:n,rootSizeObserver:o,offset:r,hoverSizeObserver:a}=e,s=(0,D.O7)(),l=(0,E.Fg)(),c=(0,B.VK)((()=>te.C.findScrollToSelectableFromStore(n)),[n]),d=null==c||null===(t=c.getNode())||void 0===t?void 0:t.getBoundingClientRect(),u=(0,B.VK)((()=>o.rect.state.width),[o]),p=(0,B.VK)((()=>a.rect.state.width),[a]),m=(0,B.VK)((()=>Math.min((null==d?void 0:d.width)||0,u,p)+r),[d,u,p,r]);return d?(0,re.jsx)("div",{style:{width:0,position:"absolute",left:m,zIndex:O.t8},onMouseDown:_.$0,children:(0,re.jsx)("div",{style:{position:"relative"},children:(0,re.jsxs)("div",{style:le(l),children:[(0,re.jsx)(X.ZP,{placement:X.ug.Top,render:e=>(0,re.jsx)(H.Z,{...e,style:ce(l),onClick:()=>{z.createAndCommit({userAction:"SimpleTableActionBar.ActionBarContent",environment:s,perform:e=>{i.fitToPage({simpleTableStore:n,parentWidth:a.rect.state.width,transaction:e})}})},children:(0,Z.n)({width:20,fill:l.regularIconColor})}),renderTooltip:()=>(0,re.jsx)(N.FormattedMessage,{defaultMessage:"Fit table to page width",id:"simpleTable.actionBar.fitToPage"})}),(0,re.jsx)(G.ZP,{popupType:G.Z4.Popup,originGap:4,renderOrigin:e=>(0,re.jsxs)(H.Z,{style:ce(l),...e,children:[(0,re.jsx)(N.FormattedMessage,{id:"simpleTable.actionBar.options",defaultMessage:"Options"}),(0,V.i)({width:10,fill:l.mediumIconColor,marginLeft:4})]}),render:()=>(0,re.jsx)(se,{simpleTableStore:n})}),(0,re.jsx)(W.Z,{store:n,fadeIn:!1,style:{display:"flex",justifyContent:"center",alignSelf:"center",width:30,height:void 0,padding:"9px 8px"},iconStyle:{fill:l.regularTextColor}})]})})}):null}function se(e){window.__c={n:"OptionsMenu"};const{simpleTableStore:t}=e,n=(0,D.O7)(),r=(0,E.Fg)(),a=[{key:"header row",action:()=>{z.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{i.toggleHeaderRow({simpleTableStore:t,transaction:e})}})},render:e=>(0,re.jsx)(K.Z,{...e,icon:(0,U.f)({width:16,fill:r.regularIconColor}),title:(0,re.jsx)(N.FormattedMessage,{id:"action.columnHeader.title",defaultMessage:"Header row"}),right:(0,re.jsx)(J.Z,{on:o.getHeadersEnabled(t).headerRow||!1,onClick:e.onClick})})},{key:"header column",action:()=>{z.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{i.toggleHeaderColumn({simpleTableStore:t,transaction:e})}})},render:e=>(0,re.jsx)(K.Z,{...e,icon:(0,j.s)({width:16,fill:r.regularIconColor}),title:(0,re.jsx)(N.FormattedMessage,{id:"SimpleTableActionBar.action.rowHeader.title",defaultMessage:"Header column"}),right:(0,re.jsx)(J.Z,{on:o.getHeadersEnabled(t).headerColumn||!1,onClick:e.onClick})})}];return(0,re.jsx)($.Z,{menuType:ee.og.Popup,width:240,maxHeight:n.device.isMobile?70:void 0,children:(0,re.jsx)(Q.Z,{type:Q.i.Vertical,sections:[{key:"appearance section",render:e=>(0,re.jsx)(Y.Z,{...e}),items:a}],initialFocus:void 0})})}function le(e){return{position:"absolute",top:-40,right:0,borderRadius:4,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:L.Z.getCompositeFontFamily(R.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow}}function ce(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${F.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`}}const de=function(e){window.__c={n:"SimpleTableActionBar"};const{disabled:t,canEdit:n,simpleTableStore:o}=e,i=(0,B.VK)((()=>{const e=A.Z.state,t=M.Z.state,n=ie.Z.state,i=ne.Z.state,r=oe.default.state,a=e.isActive&&e.simpleTableStore===o,s=1===r.stores.length&&r.stores[0]===o,l=t.isActive&&t.simpleTableStore===o&&"cell"===t.hover.type&&t.hover.resizing,c=n.isActive&&n.simpleTableStore===o;return(a||s)&&!l&&!c&&!i.isKeyboardMode}),[o]);return t||!n?null:(0,re.jsx)(q.Z,{isVisible:i,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:h.z},render:()=>(0,re.jsx)(ae,{...e})})};var ue=n(78429),pe=n(33125),me=n(893),fe=n(80402),ge=n(993),he=n(98104),ve=n(65187),be=n(68056),ye=n(77907),_e=n(24666),Se=n(84139),we=n(6695),ke=n(72126),Ie=n(6685),xe=n(89224);const Ce=function(e){window.__c={n:"SimpleTableColumnResizer"};const t=(0,s.useRef)(),n=(0,D.O7)(),r=(0,B.VK)((()=>Boolean(o.getTableResizeState(e.simpleTableStore))),[e.simpleTableStore]),{columnIndex:a,simpleTableStore:l,columnID:c,getWidth:d,onTemporaryResize:u,onAccept:p,onCancel:m}=e,f=(0,B.VK)((()=>{const e=M.Z.state;return!!e.isActive&&(e.simpleTableStore===l&&("cell"===e.hover.type&&(!r&&(e.hover.x===a&&(e.hover.showResizer||e.hover.resizing)))))}),[a,r,l]),g=(0,E.yK)((e=>({wrapper:{position:"absolute",right:0,width:0,top:0,flexGrow:0,height:"100%",zIndex:1},innerStyle:{position:"absolute",width:3,marginLeft:-1,marginTop:-1,height:"calc(100% + 2px)",transition:"background 150ms ease 50ms",cursor:r?void 0:"col-resize",background:f?e.simpleTableSelectionBorder:F.ZP.blueWithAlpha(0)}})),[r,f]),h=(0,s.useCallback)((e=>{e.preventDefault();const n=o.getColumnFormat(l);t.current=n&&c in n?n[c]:{},t.current.width=d(),i.setResizing(!0)}),[c,d,l]),v=(0,s.useCallback)((e=>{const t=w(e);t&&u(t)}),[u]),y=(0,s.useCallback)((e=>{const t=w(e);t&&p(t),i.setResizing(!1)}),[p]),_=(0,s.useCallback)((()=>{m(),t.current=void 0,i.setResizing(!1)}),[m]),S=(0,s.useCallback)((()=>{const t=Se.Z.findCellsInColumnFromStore(e.simpleTableStore,e.columnId),o=ke.oA(t.map((e=>{var t;const n=null===(t=e.getNode())||void 0===t?void 0:t.querySelector(`.${b.Iiy}`);if(n)return function(e){const t=window.getComputedStyle(e),n=e.cloneNode(!0),o=n;o.id="notion-table-cell-shadow",Array.from(t).forEach((e=>o.style.setProperty(e,t.getPropertyValue(e),t.getPropertyPriority(e)))),o.style.opacity="0",o.style.width="100%",o.style.pointerEvents="none",document.body.appendChild(n);const i=o.querySelector(`.${b.qnV}`);if(!i)return void o.remove();i.style.width="",i.style.display="inline-block";const r=window.document.createRange();r.selectNode(i);const a=xe.getRect(r);return o.remove(),null!=a&&a.width?a.width+Le:void 0}(n)})));z.createAndCommit({userAction:"SimpleTableColumnResizer.handleDoubleClick",environment:n,perform:t=>{i.resizeColumn({tableBlockColumnFormat:{...Te(e.format,e.formatStore).table_block_column_format,[e.columnId]:{width:Math.max(...o)}},simpleTableStore:e.simpleTableStore,transaction:t})}})}),[n,e.columnId,e.format,e.formatStore,e.simpleTableStore]);function w(e){var n;if(null!==(n=t.current)&&void 0!==n&&n.width){const n=Math.max(t.current.width+e.diffX,we.lw);return{...t,width:n}}}return(0,re.jsx)("div",{style:g.wrapper,onMouseMove:()=>i.showResizeBar(!0),onMouseLeave:()=>i.showResizeBar(!1),children:(0,re.jsx)(Ie.Z,{onDraggableDragStart:h,onDraggableDragMove:v,onDraggableDragEnd:y,onDraggableDragCancel:_,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,re.jsx)("div",{style:g.innerStyle,onDoubleClick:S,...e})})})};function Te(e,t){const{temporaryFormat:n}=t;return n||e}const Me=function(e){window.__c={n:"SimpleTableReorderDropZone"};const{rowIndex:t,columnIndex:n,simpleTableStore:o}=e,i=(0,B.VK)((()=>{const e=P.Z.state;if(e.isActive&&e.simpleTableStore===o&&e.moved&&e.source.index!==e.destIndex)return{destIndex:e.destIndex,sourceIndex:e.source.index,type:e.source.type}}),[o],{useDeepEqual:!0}),{destIndex:r,sourceIndex:a,type:s}=i||{destIndex:0,sourceIndex:0},l=(0,E.yK)((e=>({sharedStyle:{position:"absolute",flexGrow:0,zIndex:2,background:e.simpleTableSelectionBorder},rowStyle:{top:a>r?0:void 0,bottom:a<r?0:void 0,left:-1,width:"calc(100% + 2px)",height:3},columnStyle:{top:-1,left:a>r?0:void 0,right:a<r?0:void 0,width:3,height:"calc(100% + 2px)"}})),[a,r]);return i?"row"===s&&r===t?(0,re.jsx)("div",{style:{...l.sharedStyle,...l.rowStyle}}):"column"===s&&r===n?(0,re.jsx)("div",{style:{...l.sharedStyle,...l.columnStyle}}):null:null};var Pe=n(12217),Ae=n(97880),Re=n(50906),De=n(6404),Be=n(8949),Ee=n(35431);class Fe extends Ee.Z{findSelectorsOfTypeFromStore(e,t){return this.filter((n=>{const o=n.getProps();return o.simpleTableStore===t&&o.type===e}))}}const Ze=new Fe;const Ve=function(e){window.__c={n:"SimpleTableRowColumnSelector"};const t=(0,D.O7)(),n=(0,s.useRef)(),r=(0,s.useRef)(null),a=(0,E.Fg)();(0,pe.c)(Ze,(()=>({getProps:()=>e,getNode:()=>{var e;return(null===(e=r.current)||void 0===e?void 0:e.getNode())??null}})),[e]);const l=()=>{n.current=void 0,i.cancelReorder()},c=n=>{De.Qn({environment:t,stores:[e.simpleTableStore],left:n.startX,top:n.startY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"})},d=(0,B.VK)((()=>{const{isMobile:n}=t.device;if(n)return function(e,t,n){const i=A.Z.state;if(!i.isActive)return!1;if(i.simpleTableStore!==e)return!1;const{selection:r}=i;if(o.isSingleCellSelected(r)){if("column"===t)return r.start.col===n;if("row"===t)return r.start.row===n}return!1}(e.simpleTableStore,e.type,e.index);const{isKeyboardMode:i}=ne.Z.state;if(i)return!1;const{simpleTableStore:r,type:a,index:s}=e;if(P.Z.state.isActive)return!1;const l=M.Z.state;if(!l.isActive)return!1;if(l.simpleTableStore!==r)return!1;if(o.getTableResizeState(r))return!1;const c=oe.default.state;if(c.stores[0]===r&&c.phase===oe.SelectionPhase.Selected)return!1;const d=l.hover;return"cell"!==d.type?d.type===a&&d.index===s:"column"===a?d.x===s:"row"===a&&d.y===s}),[t.device,e],{useDeepEqual:!0}),u=e.isSelected||d;return(0,re.jsx)(Ie.Z,{ref:r,allowDragWhileTextEditing:!0,onDraggableDragStart:u?o=>{var s;const{type:l}=e;o.preventDefault();const c=null===(s=r.current)||void 0===s||null===(s=s.getNode())||void 0===s?void 0:s.parentNode;if(!(c&&c instanceof Element))return;const d=c.getBoundingClientRect();n.current="column"===l?d.x:d.y;const u="column"===l?o.startX-d.x:o.startY-d.y;i.startReorder({...e,environment:t,theme:a,selectorStartPx:n.current,mouseOffsetPx:u})}:void 0,onDraggableDragMove:u?t=>{const{type:o}=e;if(!n.current)return;const r=P.Z.state;if(!r.isActive)return;const a="column"===o?t.diffX:t.diffY;if(0!==a){const t=n.current+a,o=function(e,t,n){const{delta:o,selectorDragPx:i}=e,r=Ze.findSelectorsOfTypeFromStore(n,t);if(o>0){const e=r.map((e=>{var t;const o=null===(t=e.getNode())||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const i=o.getBoundingClientRect();return"column"===n?null==i?void 0:i.x:null==i?void 0:i.y})).filter(Ae.$K);e.sort(((e,t)=>e-t));for(let t=e.length-1;t>=0;t--)if(i>e[t])return t;return 0}const a=r.map((e=>{var t;const o=null===(t=e.getNode())||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const i=o.getBoundingClientRect();return"column"===n?i.x+i.width:i.y+i.height})).filter(Ae.$K);return a.sort(((e,t)=>e-t)),a.filter(Ae.$K).findIndex((e=>i<e))}({delta:a,selectorDragPx:t+r.source.mouseOffsetPx},e.simpleTableStore,e.type);i.continueReorder({destIndex:o,selectorDragPx:t})}}:void 0,onDraggableDragEnd:u?n=>{const{isMobile:o}=t.device,{simpleTableStore:r,type:a,format:s}=e;z.createAndCommit({userAction:"SimpleTableRowColumnSelector.handleDragEnd",environment:t,perform:e=>{i.completeReorder({event:n,environment:t,simpleTableStore:r,transaction:e,format:s,type:a,onNoChange:o?void 0:c})}}),"row"===a&&Re.ROv(t,{from:"selection_menu",draggedTypes:["table_row"],asCopy:!1}),l()}:void 0,onDraggableDragCancel:u?()=>{l()}:void 0,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:t=>(0,re.jsx)(je,{enabled:u,isSelected:e.isSelected,draggableEvents:t,type:e.type,index:e.index,simpleTableStore:e.simpleTableStore})})};function je(e){window.__c={n:"SimpleTableButton"};const{type:t,enabled:n,isSelected:o,draggableEvents:r}=e,a=(0,D.O7)(),s=(0,B.VK)((()=>P.Z.state.isActive),[],{useDeepEqual:!0}),l=()=>{const{simpleTableStore:t,type:n,index:o}=e;i.hoverRowColumn({type:n,simpleTableStore:t,index:o})},c=()=>{i.clearHover()},d=(0,E.yK)((t=>({base:{opacity:n?1:0,pointerEvents:n?void 0:"none",transition:"opacity 150ms ease",fill:t.lightIconColor,position:"absolute",display:"flex",alignItems:"center",cursor:s?"grab":"pointer",justifyContent:"center",borderRadius:4,background:t.whiteButtonBackground,boxShadow:e.isSelected?void 0:t.lightBoxShadow,zIndex:4},column:{...Ue(e.isSelected,t),top:-8,left:"calc(50% - 13px)",height:16,width:26,padding:"2px 4px"},row:{...Ue(e.isSelected,t),top:"calc(50% - 13px)",left:-8,width:16,height:26,padding:"4px 2px"},hovered:{background:t.whiteButtonHoveredBackground,...Ue(e.isSelected,t)},pressed:{...Ue(e.isSelected,t,!0)}})),[n,s,e.isSelected]);return(0,re.jsx)(H.Z,{className:"column"===t?b.Apy:b.f0e,style:{...d.base,...d[t]},hoveredStyle:d.hovered,pressedStyle:d.pressed,onClick:t=>function(e,t,n,o,r){const{isMobile:a}=r.device;Be.Z.state.isActive||De.Qn({environment:r,stores:[o],left:e.clientX,top:e.clientY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"});a&&("column"===t?i.selectColumn({environment:r,index:n,simpleTableStore:o}):i.selectRow({environment:r,index:n,simpleTableStore:o}))}(t,e.type,e.index,e.simpleTableStore,a),onTouchStart:l,onTouchEnd:c,onMouseEnter:l,onMouseLeave:c,...r,disallowTabbing:!0,children:(0,Pe.D)({fill:o?F.ZP.white:void 0,width:14,height:14,transform:"column"===t?"rotate(90deg)":void 0})})}function Ue(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e||n?{background:t.simpleTableSelectionBorder}:void 0}const Le=1;function Oe(e){window.__c={n:"SimpleTableCell"};const t=(0,s.useRef)(null),n=(0,s.useRef)(null);(0,pe.c)(Se.Z,(()=>({getProps:()=>e,getNode:()=>t.current})),[e,t.current]);const{value:r}=(0,ye.useDependency)(ye.deps.exportJsxRenderer),{value:a}=(0,ye.useDependency)(ye.deps.markdownLinkifyIt),{columnID:l,columnIndex:c,simpleTableStore:d,rowIndex:u,textStore:p,store:m,format:f,disabled:g,canEdit:h,legacyTransclusionParent:v,selection:y}=e,S=(0,D.Fy)(),w=(0,D.O7)(),k=!g&&h,I=(0,B.VK)((()=>e.formatStore.state.temporaryFormat||e.format),[e.format,e.formatStore]),x=e=>{const t=A.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:i}=t,s=o.getColumnOrder(i);if(!s)return;me.JG({environment:w,event:e,markdownLinkifyIt:a});const l="editing"===_e.default.state.mode&&_e.default.state.multiSelection;l&&!(0,be.iG)(l)||fe.qn({environment:w,simpleTableStore:i,selection:n,currentRows:i.getContentStores(),columnOrder:s,event:e,exportJsxRenderer:r})},C=(0,B.VK)((()=>{if(!m)return!1;const e=P.Z.state;if(!e.isActive||e.simpleTableStore!==d||!e.moved)return!1;const{type:t,id:n}=e.source;return"column"===t?n===l:n===m.id}),[l,d,m]),{headerColumn:T,headerRow:M}=(0,B.VK)((()=>function(e){return o.getHeadersEnabled(e)}(e.simpleTableStore)),[e.simpleTableStore]),{blockColor:R,columnFormat:Z}=(0,B.VK)((()=>({blockColor:null==m?void 0:m.getFormat().block_color,columnFormat:o.getColumnFormat(d)})),[m,d]),V=(0,E.yK)((e=>{var t,n;const o=function(e){const{columnFormat:t,rowIndex:n,columnIndex:o,columnID:i,theme:r,headerColumn:a,headerRow:s,blockColor:l}=e;let c=l||"default";if(t&&i in t){var d;const e=null===(d=t[i])||void 0===d?void 0:d.color;e&&(c=e)}if(0===n&&s||0===o&&a)return"default"!==c?{...(0,F.fi)(c,r),fontWeight:L.Z.fontWeight.medium}:{background:r.tableHeaderRowColumnBackground,fontWeight:L.Z.fontWeight.medium};return(0,F.fi)(c,r)}({columnFormat:Z,rowIndex:u,columnIndex:c,headerColumn:T,headerRow:M,columnID:l,blockColor:R,theme:e}),i=I.table_block_column_format;return{cell:{...o,border:`${Le}px solid ${e.tableDividerColor}`,position:"relative",verticalAlign:"top",textAlign:"start",minWidth:(null==i||null===(t=i[l])||void 0===t?void 0:t.width)??120,maxWidth:(null==i||null===(n=i[l])||void 0===n?void 0:n.width)??240,minHeight:32},contents:{width:"100%",height:"100%",...o},text:{padding:"7px 9px",backgroundColor:"transparent",fontSize:14,lineHeight:"20px"}}}),[R,Z,l,c,I.table_block_column_format,T,M,u]),{isColumnSelected:j,isRowSelected:U}=(0,B.VK)((()=>y?{isColumnSelected:o.isColumnSelected({selection:y,columnIndex:c,simpleTableStore:d}),isRowSelected:o.isRowSelected({selection:y,rowIndex:u,simpleTableStore:d})}:{isColumnSelected:!1,isRowSelected:!1}),[c,u,y,d]),O=(0,re.jsxs)(re.Fragment,{children:[C&&(0,re.jsx)("div",{style:V.contents}),(0,re.jsxs)("div",{className:b.Iiy,style:{visibility:C?"hidden":void 0},children:[m&&0===u&&k&&(0,re.jsx)(Ve,{index:c,type:"column",simpleTableStore:d,isSelected:j,id:l,format:f,rowStore:m}),m&&0===c&&k&&(0,re.jsx)(Ve,{index:u,type:"row",simpleTableStore:d,isSelected:U,id:m.id,format:f,rowStore:m}),p?(0,re.jsx)(ve.Z,{ref:n,disabled:g,store:p,disableSlashCommands:!0,onClick:t=>{const{rowIndex:n,columnIndex:o,simpleTableStore:r,disabled:a,canEdit:s}=e;a||s&&t.shiftKey&&i.expandCellSelection({environment:w,rowIndex:n,columnIndex:o,simpleTableStore:r})},onEnter:t=>{var o;if(t.preventDefault(),null===(o=n.current)||void 0===o||!o.isComposing())if(S.isMobile){const{disabled:t,canEdit:n}=e;if(t||!n)return;const o=_e.default.state;"editing"===o.mode&&z.createAndCommit({userAction:"SimpleTableCell.mobileEnter",environment:w,perform:e=>{ge.hJ({environment:w,string:"\n",multiSelection:o.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})}else{"editing"===_e.default.state.mode&&i.handleUpDownKey({environment:w,direction:"down",bypassExistingTextSelection:!0})}},onTab:e=>{e.preventDefault(),i.handleLeftRightKey({environment:w,direction:"right",bypassExistingTextSelection:!0})},onUntab:e=>{e.preventDefault(),i.handleLeftRightKey({environment:w,direction:"left",bypassExistingTextSelection:!0})},onEsc:t=>{e.disabled||(t.preventDefault(),he.ZH(w))},onCut:t=>{const{disabled:n,canEdit:o}=e;if(n||!o)return;x(t);const r="editing"===_e.default.state.mode&&_e.default.state.multiSelection;r&&!(0,be.iG)(r)?z.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:w,perform:e=>{ge.pz({environment:w,multiSelection:r,transaction:e})}}):z.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:w,perform:e=>{i.clearSelectedCell({environment:w,transaction:e})}})},onCopy:x,style:V.text,pasteBehavior:"inline",className:b.qnV,disableDrag:!0,legacyTransclusionParent:v}):(0,re.jsx)("div",{style:V.text,children:"Â "}),!S.isMobile&&k&&(0,re.jsx)(Ce,{format:e.format,formatStore:e.formatStore,columnId:e.columnID,columnIndex:c,columnID:l,simpleTableStore:d,getWidth:()=>{var e;return(null===(e=t.current)||void 0===e?void 0:e.getBoundingClientRect().width)||0},onTemporaryResize:t=>{const{formatStore:n}=e;n.setTemporaryFormat({...I,table_block_column_format:{...f.table_block_column_format,[l]:t}})},onAccept:()=>{const{simpleTableStore:t,formatStore:n}=e,o=I.table_block_column_format;z.createAndCommit({userAction:"SimpleTableCell.handleColumnResizeAccept",environment:w,perform:e=>{i.resizeColumn({tableBlockColumnFormat:o||{},simpleTableStore:t,transaction:e})}}),n.setTemporaryFormat(void 0)},onCancel:()=>{const{formatStore:t}=e;t.setTemporaryFormat(void 0)}}),!S.isMobile&&k&&(0,re.jsx)(Me,{simpleTableStore:d,rowIndex:u,columnIndex:c})]})]}),N={style:V.cell,onClick:t=>{const{columnIndex:n,simpleTableStore:o,rowIndex:r,disabled:a,canEdit:s}=e;a||(0,_.ZP)({event:t,context:_.Af.EditorClick,callback:()=>{s&&t.shiftKey?i.expandCellSelection({environment:w,rowIndex:r,columnIndex:n,simpleTableStore:o}):s?i.selectCellAndSetCursor({environment:w,rowIndex:r,columnIndex:n,simpleTableStore:o}):i.selectCell({environment:w,rowIndex:r,columnIndex:n,simpleTableStore:o})}})},onContextMenu:t=>{const{columnIndex:n,simpleTableStore:o,rowIndex:r,disabled:a}=e;a||(0,_.ZP)({event:t,context:_.Af.EditorContextMenu,callback:()=>{i.selectCell({environment:w,rowIndex:r,columnIndex:n,simpleTableStore:o})}})},onMouseEnter:()=>{const{rowIndex:t,columnIndex:n,simpleTableStore:o,disabled:r}=e;r||i.hoverCell({x:n,y:t,simpleTableStore:o})},onMouseLeave:()=>{e.disabled||i.clearHover()}};return M&&0===u?(0,re.jsx)("th",{ref:t,scope:"col",...N,children:O}):T&&0===c?(0,re.jsx)("th",{ref:t,scope:"row",...N,children:O}):(0,re.jsx)("td",{ref:t,...N,children:O})}class Ne extends v.Z{constructor(){super(...arguments),this.isLegacyTransclusionStore=this.createComputedStore((()=>Boolean(this.props.rowStore)&&this.props.rowStore.getParentId()!==this.props.store.id)),this.styleStore=this.createComputedStore((()=>(0,ue.H)()&&this.isLegacyTransclusionStore.state?{border:"3px dashed deeppink"}:{}))}renderPersisted(){const{columnOrder:e,store:t,rowIndex:n,rowStore:o,selection:i,formatStore:r,disabled:a}=this.props;return e?(0,re.jsx)("tr",{className:b.M_0,style:this.styleStore.state,children:e.map(((e,s)=>(0,re.jsx)(Oe,{disabled:a,canEdit:this.canEdit(),columnID:e,columnIndex:s,rowIndex:n,store:o,simpleTableStore:t,selection:i,formatStore:r,format:t.getFormat(),textStore:null==o?void 0:o.getPropertyStore(e),legacyTransclusionParent:this.isLegacyTransclusionStore.state?this.props.store:void 0},e)))}):null}}const ze=Ne;var We=n(8958),qe=n(40150),He=n(55367),Ke=n(24677),Ge=n(3386),$e=n(52689);function Qe(e){window.__c={n:"SimpleTableKeyboardArea"};const{store:t,children:n,selection:r,disabled:a,canEdit:l}=e,c=(0,D.O7)(),d=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleLeftRightKey({environment:c,direction:"left",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),u=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleLeftRightKey({environment:c,direction:"right",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),p=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleUpDownKey({environment:c,direction:"up",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),m=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),i.handleUpDownKey({environment:c,direction:"down",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),f=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const t=A.Z.state;if(t.isActive){const{selection:e,simpleTableStore:n}=t;o.isSingleCellSelected(e)&&i.selectCellAndSetCursor({environment:c,rowIndex:e.start.row,columnIndex:e.start.col,simpleTableStore:n})}}),[c]),g=(0,s.useCallback)((e=>{var t;null===(t=e.preventDefault)||void 0===t||t.call(e);const n=A.Z.state;if(!n.isActive)return;const{selection:r,simpleTableStore:a}=n;o.isSingleCellSelected(r)&&r.end.row===o.getNumberOfRows(a)-1&&z.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleShiftEnter",environment:c,perform:e=>{const t=r.end.row+1;i.insertRow({environment:c,transaction:e,index:t,simpleTableStore:a}),i.selectCellAndSetCursor({environment:c,rowIndex:t,columnIndex:r.start.col,simpleTableStore:a})}})}),[c]),h=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const n=A.Z.state;if(!n.isActive)return;const{selection:r,simpleTableStore:a}=n;o.getSimpleTableCellFromTextSelection()?he.ZH(c):o.isSingleCellSelected(r)?i.selectRow({environment:c,index:r.start.row,simpleTableStore:a}):(i.clearSelection(),Ke.Z5({environment:c,stores:[t]}))}),[c,t]),v=(0,s.useCallback)((e=>{z.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDelete",environment:c,perform:e=>{i.handleDelete({environment:c,transaction:e})}})}),[c]),b=(0,s.useCallback)((e=>{!e.key||e.metaKey||e.ctrlKey||(ne.Z.setKeyboardMode(!0),z.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleKeypress",environment:c,perform:t=>{i.handleKeypress({environment:c,transaction:t,key:e.key})}}))}),[c]),{value:y}=(0,ye.useDependency)(ye.deps.exportJsxRenderer),_=(0,s.useCallback)((e=>{const t=A.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:i}=t,r=o.getColumnOrder(i);r&&fe.qn({environment:c,simpleTableStore:i,selection:n,currentRows:i.getContentStores(),columnOrder:r,event:e,exportJsxRenderer:y})}),[c,y]),S=(0,s.useCallback)((e=>{!a&&l&&(_(e),z.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleCut",environment:c,perform:e=>{i.clearSelectionContents({environment:c,transaction:e})}}))}),[c,a,l,_]),{value:w}=(0,ye.useDependency)(ye.deps.markdownLinkifyIt),{value:k}=(0,ye.useDependency)(ye.deps.tinyMceMicrosoftWordPasteFilter),I=(0,s.useCallback)((e=>{if(a||!l)return;const t=A.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:i}=t,r=o.getColumnOrder(i);r&&z.createAndCommit({userAction:"SimpleTableSelectionOverlay.handlePaste",environment:c,perform:t=>{fe.j0({environment:c,simpleTableStore:i,selection:n,currentRows:i.getContentStores(),columnOrder:r,event:e,transaction:t,markdownLinkifyIt:w,tinyMceMicrosoftWordPasteFilter:k})}})}),[c,a,l,w,k]),x=(0,s.useCallback)((e=>{e.preventDefault(),z.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDuplicate",environment:c,perform:e=>{i.handleDuplicate({environment:c,transaction:e})}})}),[c]),C=(0,s.useCallback)(((e,n)=>{!a&&l&&(n.preventDefault(),z.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleAnnotation",environment:c,perform:n=>{i.annotateSimpleTableSelection({environment:c,simpleTableStore:t,annotation:e,transaction:n})}}))}),[c,a,l,t]),T=(0,s.useCallback)((e=>C(["h",$e.Z.state.color],e)),[C]),M=(0,s.useCallback)((e=>C(["b"],e)),[C]),P=(0,s.useCallback)((e=>C(["i"],e)),[C]),R=(0,s.useCallback)((e=>C(["s"],e)),[C]),B=(0,s.useCallback)((e=>C(["_"],e)),[C]),E=(0,s.useCallback)((e=>C(["c"],e)),[C]);return(0,re.jsx)(Ge.Z,{capture:Boolean(r)&&!a&&l,onLeft:d,onRight:u,onUntab:d,onTab:u,onUp:p,onDown:m,onEnter:f,onShiftEnter:g,onEsc:h,onDelete:v,onBackspace:v,onKeypress:b,onCut:S,onCopy:_,onPaste:I,onDuplicate:x,onToggleHighlight:T,onToggleBold:M,onToggleItalics:P,onToggleStrike:R,onToggleUnderline:B,onToggleCode:E,children:n})}var Ye=n(6740),Je=n(47453),Xe=n(71644);const et=(0,N.defineMessages)({tooltipContent:{id:"simpleTable.resizer.dimensions",defaultMessage:"{num_columns} Ã— {num_rows}"}});const tt=function(e){window.__c={n:"SimpleTableResizer"};const t=(0,s.useRef)(null),n=(0,D.O7)(),{store:r,type:a,formatStore:l}=e,[c,d]=(0,s.useState)(!1),u=()=>{z.createAndCommit({userAction:"SimpleTableResizer.handleResizeClick",environment:n,perform:e=>{"row"!==a&&i.extendColumns({count:1,simpleTableStore:r,transaction:e}),"column"!==a&&i.extendRows({environment:n,count:1,simpleTableStore:r,transaction:e,analyticsFrom:"resize_click"})}})},p=(0,B.VK)((()=>Boolean(o.getTableResizeState(r,a))),[r,a]),m=(0,B.VK)((()=>{const e=o.getTableResizeState(r,a);return null==e?void 0:e.tooltipOriginRect}),[r,a]),f=(0,B.VK)((()=>{const e=r.getFormat(),{temporaryFormat:t}=l.state;return(t||e).table_block_column_order}),[l,r]),g=(0,B.VK)((()=>{const t=o.getTableResizeState(e.store);return t?t.rowsDelta:0}),[e.store]),h=(0,B.VK)((()=>{const t=M.Z.state,n=o.getTableResizeState(e.store,e.type);return!ne.Z.state.isKeyboardMode&&(function(e,t,n){if(!e.isActive||e.simpleTableStore!==n)return!1;const{hover:i}=e;if("cell"===i.type){const e=i.y===o.getNumberOfRows(n)-1,r=i.x===o.getNumberOfColumns(n)-1;return"row"===t?e:("column"===t||e)&&r}return"resizer"===i.type&&i.resizer===t}(t,e.type,e.store)||Boolean(n))||c}),[c,e.store,e.type]),v=(0,E.yK)((e=>({button:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:p?e.simpleTableSelectionBorder:e.lightDividerColor},plusIcon:{width:12,height:12,fill:p?F.ZP.white:e.mediumIconColor,padding:"auto"},outer:{},inner:{display:"flex",flexDirection:"row"===a?"row":void 0,width:"100%",height:"100%",opacity:h?1:0,pointerEvents:h?void 0:"none",transition:"opacity 150ms ease 50ms"}})),[p,h,a]);return(0,re.jsx)("div",{style:it(e.type),onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,Ye.E)(t)&&d(!0)},onBlur:()=>{d(!1)},onMouseEnter:()=>{const{store:t,type:n}=e;i.hoverResizer({simpleTableStore:t,resizer:n})},onMouseLeave:()=>{i.clearHover()},ref:t,children:(0,re.jsx)(Ie.Z,{onDraggableDragStart:e=>{var n;e.preventDefault();const o=null===(n=t.current)||void 0===n?void 0:n.getBoundingClientRect();ie.Z.setState({isActive:!0,simpleTableStore:r,resize:a,rowsDelta:0,columnsDelta:0,tooltipOriginRect:o}),l.setTemporaryFormat(r.getFormat())},onDraggableDragMove:n=>{var s;const c=o.getTableResizeState(r,a);if(!c)return;const d=null===(s=t.current)||void 0===s?void 0:s.getBoundingClientRect();if("row"!==a){const t=n.diffX>0?Math.ceil((n.diffX-30)/120):Math.floor((n.diffX+30)/120);if(t<0&&o.columnsHaveData({simpleTableStore:r,lastN:Math.abs(t)}))return;ie.Z.setState({...c,columnsDelta:t,tooltipOriginRect:d});const a=function(t){const{store:n}=e,i=f||[],r=o.getColumnOrder(n)||[];if(t>0){const e=t-(i.length-r.length);if(e>0){const t=[...Array(e).keys()].map((e=>(0,Xe.ZP)()));return[...i,...t]}return i.slice(0,i.length+e)}return r.slice(0,Math.max(1,r.length-Math.abs(t)))}(t);l.updateColumnOrder(a),i.updateRowSelectionOnResize(a.length-1)}if("column"!==a){const e=n.diffY>0?Math.ceil((n.diffY-8)/32):Math.max(-(o.getNumberOfRows(r)-1),Math.floor((n.diffY+8)/32));if(e<0&&o.rowsHaveData({simpleTableStore:r,lastN:Math.abs(e)}))return;ie.Z.setState({...c,rowsDelta:e,tooltipOriginRect:d}),i.updateColumnSelectionOnResize(o.getNumberOfRows(r)+e-1)}},onDraggableDragEnd:t=>{const s=o.getNumberOfColumns(r);z.createAndCommit({userAction:"SimpleTableResizer.handleDragEnd",environment:n,perform:e=>{"row"!==a&&f&&(f.length>s?i.extendColumns({count:f.length-s,simpleTableStore:r,transaction:e}):f.length<s&&i.contractColumns({simpleTableStore:r,columnOrder:f,transaction:e})),"column"!==a&&(g>0?i.extendRows({environment:n,count:g,simpleTableStore:r,transaction:e,analyticsFrom:"resize_drag"}):g<0&&i.contractRows({numRowsToDelete:Math.abs(g),simpleTableStore:r,transaction:e}))}}),ot(e.formatStore)},onDraggableDragCancel:()=>{ot(e.formatStore)},disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:t=>(0,re.jsx)("div",{style:v.inner,...t,children:(0,re.jsx)(X.ZP,{renderTooltip:()=>(0,re.jsx)(nt,{type:a,isResizing:p,columnOrder:f||[],rowCount:o.getNumberOfRows(r)+g}),placement:X.ug.Bottom,delayThreshold:0,originRect:m,forceVisibleState:!0===p||void 0,render:t=>(0,re.jsx)(H.Z,{onClick:u,style:rt(!0,e.type),hoveredStyle:rt(!0,e.type),...t,children:(0,re.jsx)("div",{style:v.button,children:(0,Je.R)(v.plusIcon)})})})})})})};function nt(e){window.__c={n:"ResizerTooltip"};const t=(0,N.useIntl)(),{type:n,isResizing:o,columnOrder:i,rowCount:r}=e,a=(0,E.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",alignItems:"center",color:e.mediumInvertedTextColor},boldText:{color:e.regularInvertedTextColor}})),[]);if(!o){const e=e=>(0,re.jsx)("b",{style:a.boldText,children:e});return(0,re.jsxs)("div",{style:a.wrapper,children:[(0,re.jsxs)("div",{children:["row"===n&&(0,re.jsx)(N.FormattedMessage,{id:"simpleTable.resizer.tooltipRow",defaultMessage:"<b>Click</b> to add a new row",values:{b:e}}),"column"===n&&(0,re.jsx)(N.FormattedMessage,{id:"simpleTable.resizer.tooltipColumn",defaultMessage:"<b>Click</b> to add a new column",values:{b:e}}),"corner"===n&&(0,re.jsx)(N.FormattedMessage,{id:"simpleTable.resizer.tooltipCorner",defaultMessage:"<b>Click</b> to add a new row and column",values:{b:e}})]}),(0,re.jsxs)("div",{children:["row"===n&&(0,re.jsx)(N.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleRow",defaultMessage:"<b>Drag</b> to quickly add or remove rows",values:{b:e}}),"column"===n&&(0,re.jsx)(N.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleColumn",defaultMessage:"<b>Drag</b> to quickly add or remove columns",values:{b:e}}),"corner"===n&&(0,re.jsx)(N.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleCorner",defaultMessage:"<b>Drag</b> to quickly add or remove rows and columns",values:{b:e}})]})]})}const s=i||[],l=t.formatMessage(et.tooltipContent,{num_columns:s.length,num_rows:r});return(0,re.jsx)("div",{children:l})}function ot(e){e.reset(),ie.Z.reset()}function it(e){const t={position:"absolute",display:"flex"};return"row"===e?{...t,flexDirection:"row",bottom:-18,left:0,right:0}:"column"===e?{...t,right:-18,top:0,bottom:0}:{...t,bottom:-18,right:-18}}function rt(e,t){const n=e?16:20,o="100%";return"column"===t?{flex:1,width:n,height:o,cursor:"col-resize",borderRadius:4,overflow:"hidden"}:"row"===t?{flex:1,width:o,height:n,cursor:"row-resize",borderRadius:4,overflow:"hidden"}:{flex:1,width:n,height:n,cursor:"nwse-resize",borderRadius:"50%",overflow:"hidden"}}function at(e){window.__c={n:"SimpleTableSelectionDragHandle"};const{position:t,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:i,onDraggableDragCancel:r}=e,a=(0,D.Fy)().isMobile?26:9,s=(0,E.yK)((e=>({tapArea:{position:"absolute",top:"top-left"===t?-a/2:void 0,left:"top-left"===t?-a/2:void 0,bottom:"bottom-right"===t?-a/2:void 0,right:"bottom-right"===t?-a/2:void 0,width:a,height:a,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",pointerEvents:"auto",cursor:"nwse-resize",zIndex:10},dragHandle:{width:9,height:9,border:`2px solid ${F.ZP.blueWithAlpha(.57)}`,background:e.contentBackground,borderRadius:"50%"}})),[t,a]);return(0,re.jsx)(Ie.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:i,onDraggableDragCancel:r,render:e=>(0,re.jsx)("div",{...e,style:s.tapArea,children:(0,re.jsx)("div",{style:s.dragHandle})})})}const st=function(e){window.__c={n:"SimpleTableSelectionOverlay"};const t=(0,D.O7)(),n=(0,s.useRef)(null),o=(0,s.useRef)(void 0),{children:r,store:a,selection:l,formatStore:c,disabled:u,canEdit:p,columnOrder:m}=e,f=(0,B.VK)((()=>{const{disabled:n,canEdit:o}=e,{device:i}=t;return!(n||!o||i.isMobile)&&!(He.ZP.state.isDragging||function(e){const t=M.Z.state;if(!t.isActive)return!1;if(t.simpleTableStore!==e)return!1;if("cell"!==t.hover.type)return!1;return t.hover.resizing}(e.store)||function(e){const t=P.Z.state;return t.isActive&&t.simpleTableStore===e}(e.store))}),[t,e]),g=(0,B.SI)((()=>{if(l&&n.current&&m)return lt({cell:l.start,tableElement:n.current,store:a,columnOrder:m})}),[m,l,a],{useDeepEqual:!0}),h=(0,B.SI)((()=>{if(l&&n.current&&m)return lt({cell:l.end,tableElement:n.current,store:a,columnOrder:m})}),[m,l,a],{useDeepEqual:!0}),v=(0,B.Kw)(g),b=(0,B.Kw)(h);(0,s.useEffect)((()=>{const e=()=>{g.enqueueRecompute(),h.enqueueRecompute()};if(n.current){const t=new MutationObserver(e);return t.observe(n.current,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),()=>t.disconnect()}}),[h,g]);const y=(0,B.VK)((()=>{const t=P.Z.state;if(!t.isActive)return;if(t.simpleTableStore!==e.store)return;if(!n.current)return;const{source:o,selectorDragPx:i,moved:r}=t;if(o.selectorStartPx===i&&!r)return;if(!o.draggedCells[0])return;const a=o.draggedCells[0].rect,s=n.current.getBoundingClientRect(),l="column"===o.type?0:(0,d.Z)(i-s.top,-8,s.height-32);return{left:"column"===o.type?(0,d.Z)(i-s.left,-a.width/3,s.width-2/3*a.width):0,top:l,draggedCells:o.draggedCells,type:o.type}}),[e.store]),_=(0,B.VK)((()=>!e.disabled&&(v&&b||y)),[y,e.disabled,b,v]);return(0,re.jsx)(Qe,{store:a,selection:l,disabled:u,canEdit:p,children:(0,re.jsx)(Ie.Z,{ref:e=>n.current=null==e?void 0:e.getNode(),onDraggableDragStart:t=>{e.canEdit&&(t.shiftKey&&e.selection?o.current=e.selection.start:o.current=mt(t.startX,t.startY,e.store))},onDraggableDragMove:n=>{if(!e.canEdit||!o.current)return;const r=o.current,a=mt(n.currentX,n.currentY,e.store);(0,qe.bp)(r,a)?i.selectCell({environment:t,rowIndex:r.row,columnIndex:r.col,simpleTableStore:e.store}):i.selectMultiCell({environment:t,start:r,end:a,simpleTableStore:e.store})},render:e=>(0,re.jsxs)("div",{style:{position:l||f?"relative":void 0},...e,children:[r,_&&(0,re.jsxs)("div",{style:{position:"absolute",top:0,left:0,pointerEvents:"none"},children:[(0,re.jsx)(ct,{store:a,dragState:y,tableElement:n.current}),v&&b&&(0,re.jsx)(dt,{startRect:v,endRect:b,dragState:y,canEdit:p,selection:l,store:a})]}),f&&(0,re.jsxs)(re.Fragment,{children:[(0,re.jsx)(tt,{store:a,type:"column",formatStore:c},"column"),(0,re.jsx)(tt,{store:a,type:"row",formatStore:c},"row"),(0,re.jsx)(tt,{store:a,type:"corner",formatStore:c},"corner")]})]})})})};function lt(e){const{cell:t,tableElement:n,store:o,columnOrder:i}=e,r=o.getContentStores()[t.row],a=Se.Z.findCellsInRowFromStore(r,o,t.row),s=(l=a,c=i[t.col],null===(d=l.find((e=>e.getProps().columnID===c)))||void 0===d||null===(d=d.getNode())||void 0===d?void 0:d.getBoundingClientRect());var l,c,d;if(!s)return;const u=n.getBoundingClientRect(),p=s.top-u.top,m=s.left-u.left,f=s.width,g=function(e){return Math.max(...e.map((e=>{var t;return(null===(t=e.getNode())||void 0===t||null===(t=t.getBoundingClientRect())||void 0===t?void 0:t.height)||0})))}(a);return new DOMRect(m-2,p-2,f+4,g+4)}function ct(e){const{store:t,tableElement:n,dragState:o}=e;if(!o||!n)return null;const i=n.getBoundingClientRect(),{draggedCells:r,type:a,left:s,top:l}=o;for(const c of r)c.rect="column"===a?new DOMRect(0,c.rect.top-i.top,c.rect.width,c.rect.height):new DOMRect(c.rect.left-i.left,0,c.rect.width,c.rect.height);return(0,re.jsx)("div",{style:{position:"absolute",left:s,top:l,zIndex:5},children:(0,re.jsx)(We.Z,{store:t,ghostElement:r,opacity:.9},"simple_table_drag")})}function dt(e){window.__c={n:"SelectionOverlay"};const{startRect:t,endRect:n,dragState:o,selection:r,store:a}=e,l=(0,D.O7)(),c=(0,D.Fy)(),d=Math.min(t.left,n.left),u=Math.min(t.top,n.top),p=Math.max(t.right,n.right),m=Math.max(t.top+t.height,n.top+n.height),f=(0,s.useRef)(void 0);function g(e){if(!r)return;const{start:t,end:n}=r;f.current={col:"top-left"===e?Math.max(t.col,n.col):Math.min(t.col,n.col),row:"top-left"===e?Math.max(t.row,n.row):Math.min(t.row,n.row)}}const h=t=>{if(!f.current)return;const n=mt(t.currentX,t.currentY,a);i.selectMultiCell({environment:l,start:f.current,end:n,simpleTableStore:e.store})},v=(0,E.yK)((e=>({base:{position:"absolute",left:o&&"column"===o.type?o.left:d+1.5,top:o&&"row"===o.type?o.top:u+1.5,width:p-d-3,height:m-u-3},wrapper:{zIndex:o?4:2,backgroundColor:o?e.contentBackground:void 0,opacity:o?.9:void 0,boxShadow:o?e.mediumBoxShadow:void 0,borderRadius:2},inner:{border:`solid ${e.simpleTableSelectionBorder}`,borderWidth:2,borderRadius:2,zIndex:o?5:3}})),[3,o,m,p,d,u]);return t&&n?(0,re.jsxs)("div",{className:b.y4j,children:[(0,re.jsx)("div",{style:{...v.base,...v.wrapper}}),(0,re.jsx)("div",{style:{...v.base,...v.inner},children:e.canEdit&&(0,re.jsxs)(re.Fragment,{children:[!c.isMobile&&(0,re.jsx)(at,{position:"top-left",onDraggableDragStart:()=>g("top-left"),onDraggableDragMove:h}),(0,re.jsx)(at,{position:"bottom-right",onDraggableDragStart:()=>g("bottom-right"),onDraggableDragMove:h})]})})]}):null}function ut(e,t){const n=Se.Z.findCellsInRowFromStore(void 0,t,0).sort(((e,t)=>e.getProps().columnIndex-t.getProps().columnIndex));for(let o=0;o<n.length;o++){if(e<=n[o].getNode().getBoundingClientRect().right)return o}return n.length-1}function pt(e,t){const n=Se.Z.findCellsInColumnFromStore(t,0).sort(((e,t)=>e.getProps().rowIndex-t.getProps().rowIndex));for(let o=0;o<n.length;o++){if(e<=n[o].getNode().getBoundingClientRect().bottom)return o}return n.length-1}function mt(e,t,n){return{col:ut(e,n),row:pt(t,n)}}class ft extends v.Z{constructor(){super(...arguments),this.storeTypes={formatStore:T},this.rootSizeObserver=new I.E,this.hoverSizeObserver=new I.E,this.nodeRef=s.createRef(),this.handleMount=e=>{e&&this.rootSizeObserver.observe(e)},this.handleHoverMount=e=>{const t=null==e?void 0:e.getNode();t&&this.hoverSizeObserver.observe(t)},this.getSelectableStyle=this.createComputedStore((()=>{const{device:e}=this.environment,t={width:"100%",position:"relative",alignSelf:"center"};return(e.isMobile||this.isInColumnList()||!this.isRootOrDirectChild())&&(t.maxWidth=this.numberOfComments.state?"calc(100% - 40px)":"100%"),t})),this.columnOrder=this.createComputedStore((()=>{const{store:e}=this.props,t=e.getFormat(),{temporaryFormat:n}=this.stores.formatStore.state;return(n||t).table_block_column_order})),this.simpleTableSelection=this.createComputedStore((()=>{const e=A.Z.state,{store:t}=this.props;if(e.isActive&&e.simpleTableStore===t){var n;const i=(null===(n=this.columnOrder.state)||void 0===n?void 0:n.length)||o.getNumberOfColumns(t),r=o.getNumberOfRows(t)+this.numTempRows.state,{selection:a}=e;return{start:{col:(0,d.Z)(a.start.col,0,i-1),row:(0,d.Z)(a.start.row,0,r-1)},end:{col:(0,d.Z)(a.end.col,0,i-1),row:(0,d.Z)(a.end.row,0,r-1)},type:a.type}}}),!0),this.numTempRows=this.createComputedStore((()=>{const e=o.getTableResizeState(this.props.store);return e?e.rowsDelta:0})),this.resizeCursor=this.createComputedStore((()=>{const{store:e}=this.props,t=M.Z.state;if(t.isActive&&t.simpleTableStore===e){const{hover:e}=t;if("cell"===e.type&&e.resizing)return"col-resize"}const n=o.getTableResizeState(e);if(n){if("column"===n.resize)return"col-resize";if("row"===n.resize)return"row-resize";if("corner"===n.resize)return"nwse-resize"}const i=P.Z.state;if(i.isActive&&i.simpleTableStore===e)return"grab"})),this.numberOfBlockComments=this.createComputedStore((()=>o.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!1})),!0),this.numberOfComments=this.createComputedStore((()=>o.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!0})),!0)}willUnmount(){this.rootSizeObserver.destroy(),this.hoverSizeObserver.destroy()}renderPersisted(){var e,t;const{store:n,disabled:o,disableHoverMenu:i}=this.props,r=this.numberOfComments.state,a=this.numberOfBlockComments.state,s=r>0&&0===a,l=(0,re.jsx)(m.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!this.marginCommentsVisible.state,hideIfSidebarOrMarginCommentsVisible:s}),c=Boolean(l)&&r>0||this.isInColumnList(),d=(0,re.jsx)(g.Z,{type:k.Z.X,preventType:p.Q7(this.environment),style:{flexGrow:1,marginLeft:-8},showLeftRightOverlay:!0,leftOverlayStyle:{left:c?-8:-8-((null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft)||0),top:8,bottom:18},rightOverlayStyle:{top:8,bottom:18},children:this.renderContent(c)}),v=(0,S.Fn)(this.environment),b=!o&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn();return(0,re.jsxs)(f.p,{allowSelectionWithin:!0,style:this.getStyle(),ref:this.handleMount,onMouseDown:e=>function(e,t){const{device:n}=t;n.isMobile||(0,_.ZP)({event:e,context:_.Af.EditorMouseDown,callback:()=>{e.preventDefault(),u.AI({environment:t,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!0})}})}(e,this.environment),children:[c?(0,re.jsx)(h.Z,{store:n,shouldShowHoverMenu:!i&&(this.canEdit()||v),shouldShowCommentMenu:b,style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:d}):d,l,(0,re.jsx)(de,{disabled:o,canEdit:this.canEdit(),simpleTableStore:n,rootSizeObserver:this.rootSizeObserver,offset:c?0:this.getOffset()||0,hoverSizeObserver:this.hoverSizeObserver})]})}renderContent(e){var t;const{store:n,disabled:i,disableHoverMenu:r}=this.props,a=n.getContentStores(),s=this.columnOrder.state;if(!s)return;const l=this.numTempRows.state,c=l<0?a.length+l:a.length,d=this.simpleTableSelection.state,{device:u}=this.environment,p=!u.isPhone,m=!i&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn(),f=(0,re.jsx)("div",{style:{display:"flex"},children:(0,re.jsx)("div",{style:{paddingTop:8,paddingLeft:8,paddingBottom:18,paddingRight:18},children:(0,re.jsx)(h.Z,{store:n,shouldShowHalo:!0,canSelect:!0,canDropLeft:p,canDropRight:p,canDropAbove:!1,canDropBelow:!1,aboveDropZoneMargin:4,belowDropZoneMargin:4,analyticsName:"page_content",shouldShowDropZone:!0,style:{position:"relative"},className:b.OE$,shouldShowCommentMenu:m,nodeRef:this.nodeRef??void 0,children:(0,re.jsx)(st,{store:n,selection:d,columnOrder:s,formatStore:this.stores.formatStore,disabled:i,canEdit:this.canEdit(),children:(0,re.jsx)("table",{children:(0,re.jsxs)("tbody",{ref:this.nodeRef,children:[a.slice(0,c).map(((e,t)=>(0,re.jsx)(ze,{rowIndex:t,rowStore:e,store:n,disabled:i,columnOrder:s,selection:d,formatStore:this.stores.formatStore},e.id))),l>0&&[...Array(l).keys()].map(((e,t)=>(0,re.jsx)(ze,{rowIndex:o.getNumberOfRows(n)+t,store:n,rowStore:void 0,disabled:i,columnOrder:s,selection:d,formatStore:this.stores.formatStore},t)))]})})})})})}),g=(0,S.Fn)(this.environment);return(0,re.jsx)("div",{className:b.fOh,style:{cursor:this.resizeCursor.state,...e?{paddingRight:20}:this.getLeftRightPadding()},children:e?f:(0,re.jsx)(h.Z,{store:n,shouldShowCommentMenu:m,shouldShowHoverMenu:!r&&(this.canEdit()||g),style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:f})})}handleCreated(){c.default.afterNextFlush((()=>{i.selectCellAndSetCursor({environment:this.environment,rowIndex:0,columnIndex:0,simpleTableStore:this.props.store})}))}getStyle(){const{store:e}=this.props;return{...this.getBlockColorStyle(),...this.props.style,position:"relative",display:"flex",...(0,y.Ks)(e)&&{width:(0,w.$3)(this.environment),position:"sticky",left:0}}}isInColumnList(){return this.context.isInColumnList}getLeftRightPadding(){const{store:e}=this.props;return(0,y.Bs)({environment:this.environment,store:e,isFullScreen:!1,sizeObserver:this.rootSizeObserver})}getOffset(){var e;return null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft}}ft.contextTypes={...l.w,isInColumnList:a().any};const gt=ft},84139:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(35431);class i extends o.Z{findCellsInRowFromStore(e,t,n){return this.filter((o=>{const i=o.getProps();return e?i.store===e:i.simpleTableStore===t&&i.rowIndex===n}))}findCellsInColumnFromStore(e,t){return this.filter((n=>{const o=n.getProps();return o.simpleTableStore===e&&("number"==typeof t&&o.columnIndex===t||"string"==typeof t&&o.columnID===t)}))}findCellFromTextStore(e){return this.find((t=>t.getProps().textStore===e))}findCellFromElement(e,t){return this.find((n=>n.getProps().simpleTableStore===t&&n.getNode()===e))}}const r=new i},64359:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},5676:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},29574:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},63208:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},69475:(e,t,n)=>{n.d(t,{A:()=>g,V:()=>f});n(21703),n(57658);var o=n(28084),i=n(68626),r=n(55652),a=n(72126),s=n(45953),l=n(21202),c=n(35092),d=n(12139),u=n(66504),p=n(84693);let m=1;class f extends Error{}class g{constructor(e,t){this.getLatency=new r.s,this.batchReadWorkers=15,this.pendingWrites=s.Ao.create(),this.getManyFromDisk=async e=>{const t=s.Ao.create();e.forEach(((e,n)=>{let{pointer:o}=e;t.set(o,n)}));const n=await p.Q6(this.connection,e),o=s.Ao.create();for(const i of n)this.setCachedRecordMap(o,i);return e.map((e=>{let{pointer:t,userId:n}=e;const i=this.getInMemory(t,n);if(i)return i;const r=o.get(t);return r&&r[n]}))},this.diskReadQueue=new o.Z({batchSize:Math.floor(c.mz/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=s.Ao.create();const t=a.VS(Array.from(e),(e=>{let{value:t}=e;return t?Object.values(t):[]}));try{await p.Y3(this.connection,this.maxSize,t)}catch(n){d.rn(n,{from:"SqliteRecordCache",type:"applyRecordCacheOperationsError"})}},this.debouncedFlushWrites=a.Ds(this.flushWrites,500,{maxWait:3e3}),this.connection=e,this.maxSize=t}set(e,t,n,o,r){if(void 0===e||void 0===e.id){const t=new Error("Attempting to set a record with an invalid pointer.");return i.log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:t.stack},data:{pointer:e}}),void d.IE(t)}const a={pointer:e,userId:o=o||u.I,value:t,timestamp:Date.now(),importance:n};this.removePendingWrite(e,o,"delete"),this.enqueueWrite({type:"set",record:a,maybeStaleRecord:r})}async get(e,t){const n=`get ${m}`;t=t||u.I,m++,this.getLatency.start(n);try{const o=this.getInMemory(e,t);if(o)return this.enqueueWrite({type:"access",record:o}),this.getLatency.end(n,"memory"),o.value;const i=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:e,userId:t}):this.getFromDiskUnbatched(e,t));if(i)return this.enqueueWrite({type:"access",record:i}),this.getLatency.end(n,"disk"),i.value}catch(o){throw d.rn(o,{from:"SqliteRecordCache",type:"getError"}),new f(o instanceof Error?o.message:String(o))}finally{this.getLatency.end(n,"miss")}}deleteRecord(e,t){t=t||u.I,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),n=e.userId||u.I,o=await p.lR(this.connection,{...e,timestamp:t,userId:n}),i=s.Ao.create(),r=a.oA(Array.from(this.pendingWrites).map((o=>{const r=o&&o.value&&n&&o.value[n];if(!r||"set"!==r.type)return;const a=r.record.value?r.record.value.value:void 0;if(!a)return;if(r.record.pointer.table!==l.iU)return;const s=a;return s.parent_id===e.parent.id&&s.parent_table===e.parent.table?(i.set(r.record.pointer,!0),r.record.timestamp<t&&(r.record.timestamp=t),r.record.value):void 0})));for(const a of o)i.get(a.pointer)||this.getInMemory(a.pointer,a.userId)||r.push(a.value);return r}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||u.I,o=await p.GF(this.connection,{...e,timestamp:t,userId:n});return o.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),o}async reset(){this.pendingWrites=s.Ao.create(),await p.G$(this.connection)}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,o=this.pendingWrites.get(t),i=o&&o[n];if(i){if("set"===i.type&&"access"===e.type){const t={type:"set",record:{...i.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===i.type&&!i.maybeStaleRecord&&i.record.value&&i.record.value.value?i.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),o=n&&n[t];if(o&&"set"===o.type)return o.record}setCacheOperationMap(e,t){const n=t,{pointer:o,userId:i}=n.record,r=e.get(o)||{};e.set(o,{...r,[i]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:o}=t,i=e.get(n)||{};e.set(n,{...i,[o]:t})}removePendingWrite(e,t,n){const o=this.pendingWrites.get(e);o&&o[t]&&o[t].type===n&&this.pendingWrites.delete(e)}}},84693:(e,t,n)=>{n.d(t,{Y3:()=>V,y6:()=>T,G$:()=>j,lR:()=>F,GF:()=>Z,Q6:()=>E});n(21703),n(57658);var o=n(72126),i=n(73360),r=n(606),a=n(21202),s=n(80873),l=n(35092),c=n(24681),d=n(97880);const u={table:a.iU,recordColumnTypes:{id:s.Z.UUID,space_id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,properties:s.Z.JSON,content:s.Z.StringArray,discussions:s.Z.StringArray,view_ids:s.Z.StringArray,collection_id:s.Z.UUID,permissions:s.Z.JSON,created_time:s.Z.Number,last_edited_time:s.Z.Number,copied_from:s.Z.UUID,file_ids:s.Z.StringArray,ignore_block_count:s.Z.Boolean,is_template:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,moved:s.Z.JSON,format:s.Z.JSON,created_by:s.Z.UUID,last_edited_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,content_classification:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_last_access_timestamp:s.Z.Number,meta_role:s.Z.String}};const p={table:n(6287).v,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.JSON,description:s.Z.JSON,icon:s.Z.String,cover:s.Z.String,schema:s.Z.JSON,format:s.Z.JSON,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,file_ids:s.Z.StringArray,template_pages:s.Z.StringArray,copied_from:s.Z.UUID,migrated:s.Z.Boolean,space_id:s.Z.UUID,deleted_schema:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const m={table:n(13493).n,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,name:s.Z.String,page_sort:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,format:s.Z.JSON,query2:s.Z.JSON,space_id:s.Z.UUID},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const f={table:n(70279).x_,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,text:s.Z.JSON,created_time:s.Z.Number,last_edited_time:s.Z.Number,alive:s.Z.Boolean,created_by_table:s.Z.String,created_by_id:s.Z.UUID,space_id:s.Z.UUID,content:s.Z.UUIDArray,reactions:s.Z.UUIDArray},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const g={table:n(33709).qF,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,context:s.Z.JSON,resolved:s.Z.Boolean,comments:s.Z.StringArray,space_id:s.Z.UUID},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const h={table:n(65311).uX,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,user_id:s.Z.UUID,activity_id:s.Z.UUID,received:s.Z.Boolean,read:s.Z.Boolean,visited:s.Z.Boolean,emailed:s.Z.Boolean,invalid:s.Z.Boolean,space_id:s.Z.UUID,navigable_block_id:s.Z.UUID,collection_id:s.Z.UUID,discussion_id:s.Z.UUID,type:s.Z.String,end_time:s.Z.String,channel:s.Z.String,archived_at:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const v={table:n(19889).KJ,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,email:s.Z.String,given_name:s.Z.String,family_name:s.Z.String,profile_photo:s.Z.String,onboarding_completed:s.Z.Boolean,mobile_onboarding_completed:s.Z.Boolean,clipper_onboarding_completed:s.Z.Boolean,reverify:s.Z.Boolean,name:s.Z.String,is_banned:s.Z.Boolean,suspended_time:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const b={table:n(80396).yo,recordColumnTypes:{id:s.Z.UUID,space_id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,created_time:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,icon:s.Z.String,actors:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const y={table:n(15047).bx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.String,permissions:s.Z.JSON,permission_groups:s.Z.JSON,email_domains:s.Z.StringArray,pages:s.Z.StringArray,icon:s.Z.String,disable_public_access:s.Z.Boolean,disable_public_access_requests:s.Z.Boolean,disable_guests:s.Z.Boolean,disable_move_to_space:s.Z.Boolean,disable_export:s.Z.Boolean,disable_space_page_edits:s.Z.Boolean,beta_enabled:s.Z.Boolean,created_time:s.Z.Number,last_edited_time:s.Z.Number,deleted_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,admin_disable_public_access:s.Z.Boolean,space_pages:s.Z.UUIDArray,plan_type:s.Z.String,invite_link_enabled:s.Z.Boolean,initial_use_cases:s.Z.String,public_home_page:s.Z.String,bot_settings:s.Z.JSON,settings:s.Z.JSON,subscription_tier:s.Z.String,disable_team_creation:s.Z.Boolean,overdue_subscription:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const _={table:n(77858).zU,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,bookmarked_pages:s.Z.StringArray,shared_pages:s.Z.StringArray,visited_templates:s.Z.StringArray,sidebar_hidden_templates:s.Z.StringArray,notify_mobile:s.Z.Boolean,notify_desktop:s.Z.Boolean,notify_email:s.Z.Boolean,notify_email_always:s.Z.Boolean,created_getting_started:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,created_onboarding_templates:s.Z.Boolean,private_pages:s.Z.UUIDArray,joined:s.Z.Boolean,joined_teams:s.Z.UUIDArray,settings:s.Z.JSON,ai_suggestions:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const S={table:n(29369).e0,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,name:s.Z.String,description:s.Z.String,icon:s.Z.String,created_time:s.Z.Number,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_time:s.Z.Number,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,archived_by:s.Z.UUID,archived_at:s.Z.Number,team_pages:s.Z.UUIDArray,pinned_pages:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,settings:s.Z.JSON,is_default:s.Z.Boolean,membership:s.Z.JSON,permissions:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const w={table:n(66079).dx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_views:s.Z.StringArray,space_view_pointers:s.Z.JSON,left_spaces:s.Z.StringArray,deleted_email:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const k={table:n(28182).Sr,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,settings:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}},I=[u,y,_,w,v,m,p,S,k,h,f,g,b],x=new Set(I.map((e=>e.table))),C=Object.keys({record_table:!0,record_id:!0,record_value:!0,space_id:!0,timestamp:!0,parent_table:!0,parent_id:!0,importance:!0,user_id:!0});async function T(e,t){await(0,l.G$)({connection:e,statements:[{sql:"\n\t\t\t\tUPDATE records SET user_id = ? WHERE user_id is null\n\t\t\t\t",args:[t]}],queryName:"backfillRecordsWithUserId"})}function M(e){const t=o.vM(e.records,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((t=>{let[i,r]=t;const a=I.find((e=>e.table===i));if(!a)return;const s=Object.keys(a.recordColumnTypes),c=Object.keys(a.metaColumnTypes),d=s.concat(c);o.yo(r,Math.floor(l.mz/d.length)).forEach((t=>{const r=`(${d.join(",")})`,a=Array(t.length).fill(`(${"?, ".repeat(d.length-1)}?)`).join(",");let l;l=e.maybeStaleRecords&&d.includes("version")?`INSERT INTO ${i} ${r} VALUES ${a}`.concat("ON CONFLICT (id, meta_user_id) DO UPDATE SET").concat("\n").concat(d.map((e=>`${e} = excluded.${e}`)).join(",")).concat("\n").concat(`WHERE excluded.version > ${i}.version`):`INSERT OR REPLACE INTO ${i} ${r} VALUES ${a}`;const u=o.xH(t.map((e=>{let{value:t,timestamp:n,userId:o}=e;if(!t)return[];const i=t.value;if(!i)return[];const r=s.map((e=>function(e){if(null==e)return null;if("string"==typeof e||"number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;return JSON.stringify(e)}(i[e]))),a=c.map((e=>{switch(e){case"meta_user_id":return o;case"meta_role":return t.role;case"meta_last_access_timestamp":return n;default:throw new Error(`Unknown meta column ${e}`)}}));return r.concat(a)})));n.push({sql:l,args:u})}))})),n}function P(e){const[t,n]=o.uK(e.records,(e=>U(e))),r=M({records:t,maybeStaleRecords:e.maybeStaleRecords}),a=function(e){const{records:t,maybeStaleRecords:n}=e;return o.yo(t,Math.floor(l.mz/C.length)).map((e=>{let t=`\n\t\t\tINSERT INTO records\n\t\t\t(\n\t\t\t\trecord_table,\n\t\t\t\trecord_id,\n\t\t\t\trecord_value,\n\t\t\t\ttimestamp,\n\t\t\t\tparent_table,\n\t\t\t\tparent_id,\n\t\t\t\timportance,\n\t\t\t\tuser_id,\n\t\t\t\tspace_id\n\t\t\t)\n\t\t\tVALUES ${Array(e.length).fill("(?, ?, ?, ?, ?, ?, ?, ?, ?)").join(",")}`;return t=n?t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.record_value\n\t\t\t\t\t\tELSE records.record_value\n\t\t\t\t\t\tEND,\n\t\t\t\t\ttimestamp =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.timestamp\n\t\t\t\t\t\tELSE records.timestamp\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_table =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_table\n\t\t\t\t\t\tELSE records.parent_table\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_id\n\t\t\t\t\t\tELSE records.parent_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\timportance =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.importance\n\t\t\t\t\t\tELSE records.importance\n\t\t\t\t\t\tEND,\n\t\t\t\t\tuser_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.user_id\n\t\t\t\t\t\tELSE excluded.user_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"):t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value = excluded.record_value,\n\t\t\t\t\ttimestamp = excluded.timestamp,\n\t\t\t\t\tparent_table = excluded.parent_table,\n\t\t\t\t\tparent_id = excluded.parent_id,\n\t\t\t\t\timportance = excluded.importance,\n\t\t\t\t\tuser_id = excluded.user_id,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"),{sql:t,args:o.xH(e.map((e=>{let{pointer:t,value:n,timestamp:o,importance:r,userId:a}=e,s=null,c=null;return n&&n.value&&(0,i.oK)(n.value)&&(s=n.value.parent_id,c=n.value.parent_table),[t.table,t.id,(0,l.gI)(n),o,c,s,"number"==typeof r?r:null,a,t.spaceId||null]})))}}))}({records:n,maybeStaleRecords:e.maybeStaleRecords});return[...A(t),...R(n.filter((e=>x.has(e.pointer.table)))),...r,...a]}function A(e){return o.yo(e,Math.floor(l.mz/(2*e.length))).map((e=>{const t=c.v.or(e.map((e=>c.v`(records.record_id = ${e.pointer.id} AND records.user_id = ${e.userId})`)));return c.v`DELETE FROM records WHERE ${t}`.asWrite()}))}function R(e){const t=o.vM(e,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((e=>{let[t,i]=e;o.yo(i,Math.floor(l.mz/(2*i.length))).forEach((e=>{const o=c.v.or(e.map((e=>c.v`(id = ${e.pointer.id} AND meta_user_id = ${e.userId})`)));n.push(c.v`DELETE FROM ${c.v.ident(t)} WHERE ${o}`.asWrite())}))})),n}async function D(e,t){if(0===t.length)return[];const n=o.vM(t,(e=>e.pointer.table)),i=[];Object.entries(n).forEach((t=>{let[n,a]=t;const s=I.find((e=>e.table===n));if(!s)return;const c=Array(a.length).fill("(id = ? AND meta_user_id = ?)").join(" OR "),d=o.VS(a,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[n,o]}));i.push(async function(){const[t]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM ${n}\n\t\t\t\tWHERE ${c}`,args:d,getData:!0}],queryName:"getRecordsFromSeparateTables"});return t.data.map((e=>function(e,t,n){return{pointer:r.dr.fromPointerLike({table:e,id:t.id,spaceId:t.space_id||void 0}),value:{role:t.meta_role,value:B(t,n)},timestamp:t.meta_last_access_timestamp,importance:0,userId:t.meta_user_id}}(n,e,s)))}())}));const a=await Promise.all(i);return o.xH(a)}function B(e,t){const n={};return Object.keys(t.recordColumnTypes).forEach((o=>{const i=t.recordColumnTypes[o];if(null!==e[o])switch(i){case s.Z.UUID:case s.Z.String:case s.Z.Number:n[o]=e[o];break;case s.Z.StringArray:case s.Z.JSON:n[o]=JSON.parse(e[o]);break;case s.Z.XML:n[o]=e[o];break;case s.Z.UUIDArray:n[o]=JSON.parse(e[o]);break;case s.Z.Boolean:n[o]=1===e[o];break;case s.Z.CIDR:n[o]=e[o];break;case s.Z.NumberArray:n[o]=JSON.parse(e[o]);break;default:(0,d.t1)(i)}})),n}async function E(e,t){const[n,i]=o.uK(t,(e=>x.has(e.pointer.table))),a=await D(e,n),s=new Set(a.map((e=>r.P2.toKey({pointer:e.pointer,userId:e.userId})))),c=n.filter((e=>!s.has(r.P2.toKey(e)))),d=(await async function(e,t){if(0===t.length)return[];const n=Array(t.length).fill("(record_table = ? AND record_id = ? AND user_id = ?)").join(" OR "),i=o.VS(t,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[t,n,o]})),[a]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM records\n\t\t\t\tWHERE ${n}`,args:i,getData:!0}],queryName:"getRecordsFromRecordsTable"});return a.data.map((e=>({pointer:r.dr.fromPointerLike({table:e.record_table,id:e.record_id,spaceId:e.space_id||void 0}),value:JSON.parse(e.record_value),timestamp:e.timestamp,importance:"number"==typeof e.importance?e.importance:void 0,userId:e.user_id})))}(e,i.concat(c))).filter((e=>!U(e)));return a.concat(d)}async function F(e,t){const n=c.v`
  SELECT * FROM block
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asRead(),o=c.v`
  UPDATE block
  SET meta_last_access_timestamp = ${t.timestamp}
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asWrite(),[i]=await(0,l.G$)({connection:e,statements:[n,o],queryName:"getBlocksWithParent"});return i.data.map((e=>({pointer:r.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:B(e,u)},userId:t.userId})))}async function Z(e,t){const n=c.v`
    WITH RECURSIVE page_blocks AS (
      SELECT * FROM block
      WHERE id = ${t.page.id}
      AND meta_user_id = ${t.userId}

      UNION

      SELECT block.*
      FROM
        block INDEXED BY block_parent_id,
        page_blocks
      WHERE
      (
        page_blocks.id = ${t.page.id}
        OR page_blocks.type NOT IN ('page', 'toggle')
      )
      AND block.parent_table = 'block'
      AND block.parent_id = page_blocks.id
      AND block.meta_user_id = ${t.userId}
    )
    SELECT * FROM page_blocks
    `,o=await n.all(e,"getPageBlocksByParent");return 0===o.length?[]:o.map((e=>({pointer:r.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:B(e,u)},userId:t.userId})))}async function V(e,t,n){const o=n.filter((e=>"set"===e.type&&!e.maybeStaleRecord)),i=n.filter((e=>"set"===e.type&&e.maybeStaleRecord)),r=n.filter((e=>{let{type:t}=e;return"access"===t})),s=n.filter((e=>{let{type:t}=e;return"delete"===t})),d=[];if(r.forEach((e=>{const t=e.record.pointer.table;U(e.record)?t===a.iU&&d.push(c.v`
	        UPDATE block
	        SET meta_last_access_timestamp = ${e.record.timestamp}
	        WHERE id = ${e.record.pointer.id}
	        AND meta_user_id = ${e.record.userId}
	        `.asWrite()):d.push({sql:"UPDATE records\n          SET timestamp = ?\n          WHERE record_table = ?\n          AND record_id = ?\n          AND user_id = ?",args:[e.record.timestamp,t,e.record.pointer.id,e.record.userId]})})),o.length>0||i.length>0){if(o.length>0){const e=o.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!1}))}if(i.length>0){const e=i.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!0}))}d.push(c.v`
			DELETE FROM records
			WHERE rowid IN (
				SELECT rowid FROM records
				ORDER BY importance DESC, timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite()),d.push(c.v`
			DELETE FROM block
			WHERE rowid in (
				SELECT rowid FROM block
				ORDER BY meta_last_access_timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite())}if(s.length>0){const e=s.map((e=>e.record));d.push(...function(e){const t=R(e.filter((e=>x.has(e.pointer.table)))),n=A(e);return t.concat(n)}(e))}0!==d.length&&await(0,l.G$)({connection:e,statements:d,queryName:"applyRecordCacheOperations"})}async function j(e){await async function(e){const t=[];x.forEach((e=>{t.push(c.v`DELETE FROM ${c.v.ident(e)}`.asWrite())})),await(0,l.G$)({connection:e,statements:t,queryName:"deleteAllCachedRecordsFromSeparateTables"})}(e),await async function(e){await(0,l.sf)({connection:e,sql:"DELETE FROM records",queryName:"deleteAllCachedRecordsFromRecordsTable"})}(e)}function U(e){return x.has(e.pointer.table)&&void 0!==e.value&&void 0!==e.value.value}},4023:(e,t,n)=>{n.d(t,{u:()=>o,v:()=>i});let o=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Center=4]="Center",e}({}),i=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({})},70726:(e,t,n)=>{n.d(t,{Z:()=>i});var o=function(e){return e[e.Preview=0]="Preview",e[e.Mention=1]="Mention",e[e.Link=2]="Link",e}(o||{});const i=o},34859:(e,t,n)=>{n.d(t,{Z:()=>i});var o=function(e){return e[e.All=0]="All",e[e.X=1]="X",e[e.Y=2]="Y",e[e.None=3]="None",e}(o||{});const i=o},83960:(e,t,n)=>{n.d(t,{T:()=>o,l:()=>i});const o={localLanguagePreferenceKey:"CodeBlockDefaultLanguage",localCodeWrapPreferenceKey:"CodeBlockDefaultCodeWrap",defaultLanguage:"JavaScript",defaultCodePreviewFormat:"code"},i={localSizePreferenceKey:"QuoteBlockDefaultSize"}},96198:(e,t,n)=>{n.d(t,{O:()=>o});const o=44},15723:(e,t,n)=>{n.d(t,{Ep:()=>a,Kr:()=>d,MU:()=>m,aP:()=>l,bM:()=>r,dQ:()=>u,iL:()=>i,jn:()=>p,kK:()=>c,uh:()=>s});var o=n(72126);class i{static from(e){return new i(e.left,e.top,e.width,e.height)}constructor(e,t,n,o){this.x=e,this.y=t,this.width=n,this.height=o,this.top=this.height<0?this.y+this.height:this.y,this.bottom=this.height<0?this.y:this.y+this.height,this.left=this.width<0?this.x+this.width:this.x,this.right=this.width<0?this.x:this.x+this.width}toJSON(){return{...this}}}const r=new i(0,0,0,0);function a(e){return Boolean(e&&(o.hj(e.top)||o.hj(e.left)))}function s(e,t,n){return e.left<=t&&t<=e.right&&e.top<=n&&n<=e.bottom}function l(e,t){return e.left<=t.left&&e.right>=t.right&&e.top<=t.top&&e.bottom>=t.bottom}function c(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}function d(e,t){return!(e.right<=t.left||t.right<=e.left)}function u(e,t){return!(e.bottom<=t.top||t.bottom<=e.top)}function p(e,t){return new i(e.left-t,e.top-t,e.width+2*t,e.height+2*t)}function m(e){const t=e.top+e.height/2,n=e.left+e.width/2;return new i(n,t,0,0)}},12252:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{constructor(){super(...arguments),this.pause=()=>{this.setState({active:!1,onActive:[]})},this.resume=()=>{this.state.onActive.map((e=>e())),this.setState({active:!0,onActive:[]})}}getInitialState(){return{active:!0,onActive:[]}}whenActive(e){this.state.active?e():this.setState({...this.state,onActive:i.jj([...this.state.onActive,e])})}}const a=new r},51214:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}isGeneratingAtAll(){return Object.values(this.state).some((e=>!0===e))}isGeneratingFor(e){return Boolean(this.state[e])}setIsGeneratingFor(e){this.update((t=>({...t,[e]:!0})))}setGenerationCompleteFor(e){this.update((t=>({...t,[e]:!1})))}}const r=new i},58455:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var o=n(49085),i=n(4615),r=n(95477);class a extends o.default{constructor(){super(...arguments),this.verboseAnalytics=r.default.isAdminMode||false}getInitialState(){return{isLoaded:!1,isLoggingEnabled:!1,isAmplitudeEnabled:!1,isSegmentEnabled:!1,isZendeskEnabled:!1,isIntercomEnabled:!1,intercomAppId:void 0,intercomUserHash:void 0,noIntercomUserId:!1,isSprigEnabled:!1,zendeskToken:void 0}}shouldRefresh(e){return!this.state.isLoaded||Boolean(e)!==Boolean(this.state.user_id)||Boolean(e&&this.state.user_id&&(0,i.cj)(this.state.user_id)!==(0,i.cj)(e))}}const s=new a},51:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.publicPageData)))}}const r=new i},80444:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o=n(49085),i=n(72126),r=n(59753),a=n(74446);n(7406);const s={wiki_promo:0,ai_qna_alpha:0,ai_qna_beta_waitlist:0,enterprise_launch_promo:0,notion_calendar_launch_promo:0,tasks_migration_modal:0,sidebar_tour:1,better_template_initialization:2,pm_intro_tooltip:3,pm_intro_sidebar_notif:3,customer_io:3,share_button_tooltip:3,add_icon_tooltip:3,persona_collection:3,add_on_discount_popup:3,team_add_app_template_tooltip:3,ai_onboarding_tooltip:3,share_menu_tutorial:3,clear_templates_opt_out:3};class l extends o.default{getInitialState(){return{activeCallouts:new Set}}updateCalloutStatus(e){let{calloutId:t,visible:n}=e;const{activeCallouts:o}=this.state;if(n){const e=new Set(o).add(t);for(const n of o){s[t]<s[n]&&e.delete(n)}this.setState({activeCallouts:e})}else{const e=new Set(o);e.delete(t);this.setState({activeCallouts:e})}}canShow(e){const{activeCallouts:t}=this.state;if(t.has(e))return!0;for(const n of t){if(s[n]<=s[e])return!1}return!0}}const c=l;var d=n(30539),u=n(89523);class p extends o.default{getInitialState(){return{initialized:!1,isTransitioning:!1,renderPhase:"booting",pageVisitStore:new d.Z,presenceStore:new u.Z,inAppCalloutStore:new c}}getCurrentBlockModelFn(){const{mainEditorCurrentBlockStore:e}=this.state,t=a.mF.tryUntilFound(...i.oA([e&&e.getRecordValue]));return r.om.fromGetRecordValueFn(t)}waitUntilRendered(){return this.waitUntil((()=>"rendered"===this.state.renderPhase))}}p.sidebarIsExpandedPreferenceKey="sidebarIsExpanded";const m=new p},92425:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getSharedPagesState(e){const{userId:t,spaceId:n}=e;let o=this.state[t];o||(o={},this.state[t]=o);return o[n]}setSharedPagesState(e){const{userId:t,spaceId:n,state:o}=e;let i=this.state[t];i||(i={},this.state[t]=i),i[n]=o,this.emit()}}const r=new i},21273:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(38823),r=(n(95477),n(77080));class a extends o.default{getInitialState(){return new i.m({getEligibleGroup:()=>"control",isAiEnabled:()=>!1,getIsWorkspaceVectorEmbeddingsComplete:()=>!1,checkGate:()=>!1})}isAiEnabled(){return this.state.isAiEnabled()}isContextEnabled(){return this.state.isContextEnabled()}isMobileWebExperienceEnabled(){return this.modeIsAtMost("beta")}isAssistantExperienceQna(){return this.state.isAssistantExperienceQna()}isQnaRightSideDeeplinkEnabled(){return this.isMode("beta")||this.isMode("development")}isQnATooltipsVisible(e,t){if(!t||!t.isReady())return!1;if(e.isMobile)return!1;const n=t.getSettings();return!!n&&"tooltip"===n.ai_qna_intro_onboarding_phase}shouldShowQnaInSearchOnly(){return this.modeIsAtMost("beta")}shouldDisableForMobileBrowser(e){return e.isMobileBrowser&&!this.isMobileWebExperienceEnabled()}shouldShowSearchMenuItemAskAI(e){return this.modeIsAtMost("beta")&&!this.shouldDisableForMobileBrowser(e)}shouldShowAssistantInCorner(e){return!(e.isMobileNative&&e.isPhone)&&(this.modeIsAtMost("beta")&&!this.shouldDisableForMobileBrowser(e))}isShowingAssistantInsteadOfHelpCenterInBottomRight(){return this.modeIsAtMost("beta")}isShowingQNAOnMobile(){return this.modeIsAtMost("beta")}showAiQnaOnboardingModalForBetaLaunch(){return this.modeIsAtMost("beta")}showSearchAiFeatures(){return this.modeIsAtMost("beta")}showRemindersToUseQnA(){return this.state.showRemindersToUseQnA()}showScopedSearch(){return this.modeIsAtMost("development")}canSeeWaitlistModal(){return!!this.isAiEnabled()&&(!(this.state.isWorkspaceVectorEmbeddingsComplete()&&!this.state.isQnAExplicitlyDisabled())&&!(!this.state.haveWeLaunchedYet()||this.state.isQnAExplicitlyDisabled()))}showCustomSkills(){return!1}shouldShowAISections(){return this.modeIsAtMost("wild_west")}shouldShowSuggestedQuestions(){return this.modeIsAtMost("beta")}isSuggestedQuestionsExperimentOn(){return"on"===r.default.getEligibleGroup({experimentId:"show_qna_suggested_questions",defaultGroup:"unassigned"})}shouldAttributeChangesToAI(){return this.modeIsAtMost("wild_west")}isXMLAssistantEnabled(e){return!1}isJSAssistantEnabled(e){return!1}isAssistantInWriterEnabled(){return!1}isChatHistoryEnabled(){return this.state.isChatHistoryEnabled()}shouldShowDebugHelpers(){return this.modeIsAtMost("exploratory")}getMode(){return this.state.getMode()}isMode(e){return this.state.isMode(e)}modeIsAtMost(e){return this.state.modeIsAtMost(e)}}const s=new a},98180:(e,t,n)=>{n.d(t,{Z:()=>l});n(21703);var o=n(49085),i=n(92595);const r=10*n(63143).hM;class a extends o.default{getInitialState(){return{activeAiSessionId:void 0,sessions:{},lastSessionInitializedUnixEpochTime:Date.now()}}clearAllSessions(){this.reset()}getActiveSessionId(){return this.state.activeAiSessionId}getActiveSession(){const e=this.state.activeAiSessionId;if(e)return this.state.sessions[e]}getActiveAssistantRuntimeStore(){var e;return null===(e=this.getActiveSession())||void 0===e?void 0:e.assistantRuntimeStore}getActiveAssistantRuntimeState(){var e;return null===(e=this.getActiveAssistantRuntimeStore())||void 0===e?void 0:e.state}getActiveAssistantConfigurationStore(){var e;return null===(e=this.getActiveSession())||void 0===e?void 0:e.assistantConfigurationStore}getActiveAssistantConfigurationState(){var e;return null===(e=this.getActiveAssistantConfigurationStore())||void 0===e?void 0:e.state}getSessionContext(e){return this.state.sessions[e]}getSessionContextOrThrow(e){const t=this.getSessionContext(e);if(!t)throw new Error("No assistant context for given session");return t}setActiveSessionId(e){this.update((t=>({...t,activeAiSessionId:e})))}setNewActiveSession(e){const{sessionId:t,context:n}=e;this.update((e=>({...e,activeAiSessionId:t,sessions:{...e.sessions,[t]:n},lastSessionInitializedUnixEpochTime:Date.now()})))}addNewSession(e){const{sessionId:t,context:n}=e;this.update((e=>({...e,sessions:{...e.sessions,[t]:n}})))}endCurrentSession(){this.update((e=>({...e,activeAiSessionId:void 0})))}setLastSessionInitializedUnixEpochTime(){this.update((e=>({...e,lastSessionInitializedUnixEpochTime:Date.now()})))}wasActiveSessionLastOpenedOutsideOfHistorySavedWindow(){const e=this.state.lastSessionInitializedUnixEpochTime;return!e||Date.now()-e>=r}}const s=new a,l=s;(0,i.exposeDebugValue)("AssistantRegistryStore",s),(0,i.exposeDebugValue)("getTranscript",(()=>{var e;const t=(null===(e=s.getActiveSession())||void 0===e||null===(e=e.assistantRuntimeStore.state)||void 0===e?void 0:e.evaluator.getTranscript())??[];return JSON.stringify(t)}))},58454:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{open:!1}}}const a=new r;(0,i.exposeDebugValue)("AutomationModalStore",a);const s=a},8297:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{banners:[]}}}const r=i},24229:(e,t,n)=>{n.d(t,{Z:()=>d,u:()=>s});var o=n(49085),i=n(92595),r=n(49427),a=n(15723);let s=function(e){return e[e.Open=0]="Open",e[e.Resolved=1]="Resolved",e[e.NewThread=2]="NewThread",e}({});class l extends o.default{getInitialState(){return{open:!1,rect:a.bM,recursivelyLoadAllDiscussions:!1}}getFramePageFirstSelectedDiscussionId(){var e;return this.state.open&&r.Z.isBlockInFrame(this.state.blockStore)?null===(e=this.state.discussionIds)||void 0===e?void 0:e[0]:void 0}}const c=new l;(0,i.exposeDebugValue)("BlockDiscussionMenuStore",c);const d=c},8949:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},61207:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},58484:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}}const r=i},68859:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{dragging:!1}}}const r=i},61766:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=i},17746:(e,t,n)=>{n.d(t,{Z:()=>s,t:()=>r});var o=n(49085),i=n(15157);let r=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class a extends o.default{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}static getLocalViewPreferenceKey(e){return`CalendarView:${e}`}static getLocalPreferences(e){let{collectionViewId:t,currentUserId:n}=e;return i.Z.get({userId:n,key:a.getLocalViewPreferenceKey(t)})}static getLocalDateRangeStart(e){let{collectionViewId:t,currentUserId:n}=e;const o=this.getLocalPreferences({collectionViewId:t,currentUserId:n});return o&&o.dateRangeStart?o.dateRangeStart:Date.now()}static setLocalDateRangeStart(e){let{collectionViewId:t,dateRangeStart:n,currentUserId:o}=e;const r=this.getLocalPreferences({collectionViewId:t,currentUserId:o})||{},s=a.getLocalViewPreferenceKey(t),l={...r,dateRangeStart:n};i.Z.set({userId:o,key:s,value:l})}}const s=a},4926:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(0)},87143:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{active:!1,stringValue:""}}}const r=new i},77556:(e,t,n)=>{n.d(t,{Z:()=>N});n(57658);var o=n(14577),i=n(49085),r=n(92996),a=n(41432),s=n(76205),l=n(14714),c=n(99036),d=n(43690),u=n(10070),p=n(28155),m=n(8848),f=n(33147),g=n(6695),h=n(72126),v=n(96367),b=n(21202),y=n(6287),_=n(97880),S=n(14900),w=n(23924),k=n(77472),I=n(28020),x=n(97004),C=n(75079),T=n(92918),M=n(26991),P=n(65742),A=n(78316),R=n(77181),D=n(33929),B=n(98165);class E{constructor(e){this.supportsLongTask=void 0,this.entriesObserved=void 0,this.observer=void 0,this.observing=!1,this.supportsLongTask=PerformanceObserver.supportedEntryTypes.includes("longtask"),this.entriesObserved=[],this.observer=new PerformanceObserver((t=>{this.entriesObserved.push(...t.getEntries()),e&&e(t,this.observer)}))}observe(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.supportsLongTask&&(this.observer.observe({type:"longtask",buffered:e}),this.observing=!0)}get isObserving(){return this.observing}disconnect(){this.observer.disconnect(),this.observing=!1}takeRecords(){const e=this.entriesObserved;return this.entriesObserved=[],e}}var F=n(94841),Z=n(26136);class V extends i.default{constructor(e){super(),this.collectionContextStore=e}getInitialState(){return new Map}getGroupState(e){const t=Array.isArray(e)?e:void 0!==e?[e]:[],n=(0,l.KW)(t),r=this.state.get(n);if(r)return r;const a=function(e,t){const n=i.default.createValue(void 0),r=e.collectionViewBlockStore();if(!r)return;let a;t.length>0?(a=r.clone(),a.setRecordStoreUIParent(r)):a=r;const s=A.bd(e),l=new o.Z((()=>{const e=n.state;return(e&&"results"===e.type?e.blockIds:[]).map((e=>Z.G.createChildStore(a,{id:e,table:b.iU})))}),{debugName:"resultsStore"});return{groupsPointer:t,groupUiParentStore:a,reducerResultStore:n,resultsStore:l,currentLimit:i.default.createValue(s),toggleStateStore:i.default.createValue(!1)}}(this.collectionContextStore,t);return a?(this.state.set(n,a),this.emit(),a):void 0}getAllGroupStates(){return[...this.state.values()]}anyGroupHasResults(){for(const e of this.state.values())if(e.reducerResultStore.state)return!0;return!1}anyGroupHasNonEmptyResults(){for(const t of this.state.values()){var e;if(null!==(e=t.reducerResultStore.state)&&void 0!==e&&null!==(e=e.blockIds)&&void 0!==e&&e.length)return!0}return!1}anySpecifiedGroupHasResults(e){for(const t of e){const e=this.getGroupState(t);if(null!=e&&e.reducerResultStore.state)return!0}return!1}resetAllLimits(){const e=A.bd(this.collectionContextStore);for(const t of this.state.values())t.currentLimit.setState(e)}setLimitIfGreater(e,t){const n=this.getGroupState(e),o=null==n?void 0:n.currentLimit;o&&t>o.state&&o.setState(t)}incrementLimit(e){const{isFullScreen:t,currentResultCount:n,groupsPointer:o,incrementLimitsInRelatedGroups:i}=e,r=this.collectionContextStore.collectionViewStore();if(!r)return;const a=this.getGroupState(o);if(!a)return;const s=i?[...this.state.values()].filter((e=>1===o.length?1===e.groupsPointer.length:2===o.length&&(0,l.ZH)(o[0],e.groupsPointer[0]))):[a];for(const l of s){const e=l.currentLimit,o=e.state+A.NG({collectionViewStore:r,isFullScreen:t,currentResultCount:n});e.setState(o)}}}class j extends i.default{getInitialState(){return{hasLocalUpdates:!1,blockIds:new Set}}addLocalChange(e){const t=this.state.blockIds.size;for(const n of e)this.state.blockIds.add(n);t!==this.state.blockIds.size&&(this.state.hasLocalUpdates=!0,this.emit())}resetWithRemote(){const e=this.getInitialState();for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.blockIds=new Set(...n),this.setState(e)}}var U=n(77080),L=n(83212);class O{static getLocalViewPreferenceKey(e){return`${O.PREFERENCE_KEY_PREFIX}${e}`}constructor(e){this.context=i.default.createValue(void 0),this.reducers=i.default.createValue({}),this.reducerDependencies=new Map,this.resultSet=new j,this.remoteResult=i.default.createValue(void 0),this.remoteCollectionIds=i.default.createValue([]),this.lastRemoteRequest=i.default.createValue(void 0),this.searchOpen=i.default.createValue(!1),this.searchQuery=i.default.createValue(""),this.isLoading=i.default.createValue(!1),this.isLoaded=i.default.createValue(!1),this.loadingDetails=i.default.createValue({type:"load_general"}),this.wasCreatedThisSession=i.default.createValue(!1),this.isFullScreen=i.default.createValue(!1),this.isRootChild=i.default.createValue(!1),this.isInPeekRenderer=i.default.createValue(!1),this.relativeVariables=i.default.createValue({}),this.groupsStore=new V(this),this.groupsLimit=i.default.createValue(T.XD),this.boardColumnsLimitStore=i.default.createValue(T.XD),this.settingsStore=i.default.createValue({open:!1,stack:[]}),this.filtersBarOpen=i.default.createValue(void 0),this.temporaryState=i.default.createValue({}),this.filterBarItemSettingsStoreMap=new Map,this.frozoneStore=i.default.createValue({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1}),this.filterBarSortSettingsStore=i.default.createValue({open:!1,stack:[]}),this.filterBarCombinatorFilterSettingsStore=i.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap=new Map,this.filterOptionsCombinatorFilterSettingsStore=i.default.createValue({open:!1,stack:[]}),this.dateRangeStart=i.default.createValue(Date.now()),this.dateRangeEnd=i.default.createValue(Date.now()),this.calendarByMenuOpen=i.default.createValue(!1),this.timelineByMenuOpen=i.default.createValue(!1),this.subitemExpandedStore=i.default.createValue(new Map),this.numberChildrenReceived=i.default.createValue(0),this.numberChildrenUnfurled=i.default.createValue(0),this.renderEmitter=new f.Z,this.remoteRequestStoreCallback=void 0,this.localResultStoreCallback=void 0,this.updateCounter=0,this.isClientModeEnabled=i.default.createValue(!1),this.isViewSpecificClientModeEnabled=i.default.createValue(!1),this.asyncAggregationStatus=i.default.createValue({calculating:!1,aggregation:void 0,changingType:!1}),this.infiniteScrollLongTaskObserver=new E,this.collectionStoresStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(!e)return[];const t=this.collectionStore();return t?[t]:this.remoteCollectionIds.state.map((t=>Z.NW.createChildStore(e,{table:y.v,id:t})))}),{debugName:"collectionStoresStore"}),this.localResultStore=new o.Z((()=>S.pi(this.environment,this)),{useDeepEqual:!0,debugName:"localResultStore"}),this.isEmptyStore=new o.Z((()=>{var e;const t=this.reducers.state;if(this.isLoading.state||this.shouldShowSpinner.state||h.xb(t))return!1;const n=this.localResultStore.state,o=this.remoteResult.state,i=this.wasCreatedThisSession.state;if(!n&&o&&0===this.collectionStoresStore.state.length)return!0;if(this.collectionStoresStore.state.length>0&&"calendar"===this.getViewType())return!1;if((0,p.nx)(null===(e=this.collectionViewStore())||void 0===e?void 0:e.getCollectionSource())&&o){if(Object.values(o.reducerResults).every((e=>"results"===e.type&&0===e.blockIds.length)))return!0}if(!n||"reducer"!==n.type||!o||"reducer"!==o.type)return!1;const r=Object.values(n.reducerResults).filter((e=>"results"===e.type)),a=Object.values(o.reducerResults).filter((e=>"results"===e.type));return!(!i&&0===a.length)&&(0!==r.length&&r.every((e=>"results"===e.type&&0===e.blockIds.length)))}),{debugName:"isEmptyStore"}),this.remoteRequestStore=new o.Z((()=>S.oh(this.environment,this)),{debugName:"remoteRequestStore"}),this.normalizedFormatStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore();if(!e||!t)return{};const n=t.getType(),o=this.normalizedQueryStore.state;if(!n||!o)return{};const i=this.normalizedSchemaStore.state,r=t.getNormalizedFormat(i);return r?(0,I.qG)(e.id)&&this.isCompactView.state?{...r,...(0,F.Vj)(n,r)}:r:{}}),{useDeepEqual:!0,debugName:"normalizedFormatStore"}),this.normalizedSchemaStore=new o.Z((()=>{const e=this.context.state;switch(null==e?void 0:e.type){case"collectionTypedView":const t=e.databaseType===r.iS?(0,r.uV)(D.default.getIntl()):{};if(!this.collectionViewBlockStore())return t;const n=this.collectionStoresStore.state;if(0===n.length)return t;const o=(0,u.jf)({schemas:[...n.map(w.gD),t],onlyPropertyIds:Object.keys(t),prioritizeLooserLimitRule:!0});return o.error?t:o.value;case"collectionVirtualView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:const i=this.collectionStore();return i?i.getSchema():c.Kc(D.default.getIntl());default:(0,_.t1)(e)}}),{useDeepEqual:!0,debugName:"normalizedSchemaStore"}),this.normalizedDeletedSchemaStore=new o.Z((()=>{const e=this.collectionStore();return e?e.getDeletedSchema():c.Kc(D.default.getIntl())}),{useDeepEqual:!0,debugName:"normalizedDeletedSchemaStore"}),this.normalizedQueryStore=new o.Z((()=>{const e=this.collectionViewStore();if(e){const t=e.getType();if(t){const n=this.normalizedSchemaStore.state;return(0,d.Qo)({type:t,query2:e.getQueryStore().getValue()},n)}}}),{useDeepEqual:!0,debugName:"normalizedQueryStore"}),this.subitemTreeStore=new o.Z((()=>(0,R.yr)(this,this.environment.currentUser.id)),{debugName:"subitemTreeStore"}),this.shouldShowSpinner=new o.Z((()=>{var e,t,n,o;if(!this.isLoading.state)return!1;const i=null===(e=this.lastRemoteRequest.state)||void 0===e?void 0:e.loader,r=null===(t=this.remoteRequestStore.state)||void 0===t?void 0:t.loader;if(!h.Xy(null==i?void 0:i.filter,null==r?void 0:r.filter))return!0;if(!h.Xy(null==i?void 0:i.sort,null==r?void 0:r.sort))return!0;if(!h.Xy(null==i?void 0:i.searchQuery,null==r?void 0:r.searchQuery))return!0;if(!h.Xy(null===(n=this.lastRemoteRequest.state)||void 0===n?void 0:n.source,null===(o=this.remoteRequestStore.state)||void 0===o?void 0:o.source))return!0;const a=(null==i?void 0:i.reducers)||{},s=(null==r?void 0:r.reducers)||{};for(const l in s){const e=s[l],t=a[l];if(!h.Xy(e,t))return!0}return!1}),{debugName:"shouldShowSpinner"}),this.shouldShowSource=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore(),n=this.collectionStore();if(!e||!t||!n)return!1;return!(e.getCollectionViewSourceCollectionStore()&&this.isFullScreen.state||t.getFormat().hide_linked_collection_name)}),{debugName:"shouldShowSource"}),this.isCompactView=new o.Z((()=>{if(this.isFullScreen.state)return!1;const e=this.collectionViewStore();return!!e&&e.isCompactView()}),{debugName:"isCompactView"}),this.permissionScopes=new o.Z((()=>{const e=this.collectionStore(),t=this.collectionViewStore(),n=this.collectionViewBlockStore(),o=this.isFullScreen.state,i=A.eD({collectionStore:e,collectionViewBlockStore:n,checkNavigableAncestorLocked:!o}),r=Boolean(null==n?void 0:n.isLocked()),a=Boolean(null==e?void 0:e.isSyncedCollection());if(!t||!n)return{canConfigureCollection:i,canConfigureBlock:Boolean((null==n?void 0:n.canEditCollection())&&!n.isLocked()),canEditContent:Boolean((null==n?void 0:n.canEditCollection())||(null==n?void 0:n.canEditContentOnly())),isLocked:r,isSyncedCollection:a};const s=!o&&n.isNavigableAncestorLocked(),l=Boolean(n.inMemoryRecordCache.snapshotData),c=L.Z.getMode(this.environment,n);if(s||l||"comment"===(null==c?void 0:c.permission)||"view"===(null==c?void 0:c.permission))return{canConfigureCollection:i,canConfigureBlock:!1,canEditContent:!1,isLocked:r,isSyncedCollection:a};const d=n.canEditCollection();return{canConfigureCollection:i,canConfigureBlock:Boolean(d&&!r),canEditContent:Boolean(e&&e.canEdit()),isLocked:r,isSyncedCollection:a}}),{debugName:"permissionScopes"}),this.filtersBarOpenStore=new o.Z((()=>{if(this.environment.device.isPhone)return!0;const e=this.filtersBarOpen.state;if(void 0!==e)return e;return this.currentPropertyFiltersStore.state.some((e=>{const t=e.filter;return(0,s.Oo)(t)}))||(0,x.Nq)(this)}),{debugName:"filtersBarOpenStore"}),this.localStateDiffStore=new o.Z((()=>(0,x.Zh)(this,"normalized")),{useDeepEqual:!0,debugName:"localStateDiffStore"}),this.currentCombinatorFilterStore=new o.Z((()=>{var e;const t=this.temporaryState.state.combinatorFilter;return t?t.value:null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.filter}),{useDeepEqual:!0,debugName:"currentCombinatorFilterStore"}),this.currentSubitemFormatStore=new o.Z((()=>{var e,t;const n=U.default.checkGate("collection_level_subitems_setting");if(n&&"flattened"===(null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormat().subitem_display_mode))return;const o=n?(0,R.wf)(this):(0,R.T6)(this),i=null===(t=this.collectionViewStore())||void 0===t?void 0:t.getType(),r=(0,x.RL)({collectionContextStore:this,applySubitemFilter:!1}),a=(0,s.kk)(r);return a&&(0,s.SH)(a,(e=>!!(0,s.aN)(e)&&(e.property===(null==o?void 0:o.property)||e.property===(null==o?void 0:o.inverse))))&&i&&!(0,R.Av)(i)?void 0:o}),{useDeepEqual:!0,debugName:"currentSubitemFormatStore"}),this.currentArrowsByFormatStore=new o.Z((()=>(0,P.H5)(this)),{useDeepEqual:!0,debugName:"currentArrowsByFormatStore"}),this.currentPropertyFiltersStore=new o.Z((()=>{const e=this.normalizedSchemaStore.state,t=this.temporaryState.state.propertyFilters;return(t?t.value||[]:this.normalizedFormatStore.state.property_filters||[]).map((t=>{const n=(0,d.dN)(t.filter,e),o=this.collectionViewBlockStore();if(e[t.filter.property]&&n&&(0,s.J5)(e,t.filter.property,n.filter,null==o?void 0:o.getRecordModel))return n&&{id:t.id,filter:n}})).filter(_.$K)}),{useDeepEqual:!0,debugName:"currentPropertyFiltersStore"}),this.currentSortsStore=new o.Z((()=>{var e;const t=this.temporaryState.state.sorts;return t?t.value||[]:(null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.sort)||[]}),{useDeepEqual:!0,debugName:"currentSortsStore"}),this.blockIsPrivateStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(e)return(0,B.RC)({environment:this.environment,store:e})}),{debugName:"blockIsPrivateStore"}),this.inheritedBlockColorStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),{ThemeModeStore:t}=this.environment;if(!e)return;const n=e.findRecordStoreUIAncestor((e=>Boolean(e instanceof Z.G&&e.getRecordStoreUIParent()&&e.getFormat().block_color&&!e.isCollectionView()))).ancestor;if(n&&n instanceof Z.G){const e=n.getType(),o=n.getFormat().block_color;if(o){const n=(0,m.gh)({theme:t.state});return e===a.Ti.callout?(0,m.x7)(o,n):(0,m.fi)(o,n)}}}),{useDeepEqual:!0,debugName:"inheritedBlockColorStore"}),this.defaultPageTemplateStore=new o.Z((()=>{var e,t;const n=this.collectionStore(),o=this.collectionViewStore(),i=h.oA([null==o||null===(e=o.getFormat())||void 0===e?void 0:e.collection_view_default_template,null==n||null===(t=n.getFormat())||void 0===t?void 0:t.collection_default_template]),r=null==n?void 0:n.getTemplatePageStores();for(const a of i){if("empty"===a)return;const e=null==r?void 0:r.find((e=>e.id===a.template_page_id));if(null!=e&&e.getAlive())return e}}),{debugName:"defaultPageTemplateStore"}),this.relativeVariableStore=new o.Z((()=>{const e=this.context.state;if(!e)return;const t=e.collectionViewBlockStore;if(!t)return;const n={},o=this.relativeVariables.state;for(const[i,r]of(0,_.qP)(o)){const e=Z.NW.createChildStore(t,{id:i,table:y.v}),o=e.getSchema(),a=null==e?void 0:e.getFormat().app_config_uri;if(a&&(0,v.oN)(o,a)){n[i]={};for(const[t,s]of(0,_.qP)(r)){const r=Z.G.createChildStore(e,{id:s,table:b.iU});r.isDefined()&&((0,M.iL)({blockStore:r,collectionId:i,appConfigUri:a,variable:t,schema:o})&&(n[i][t]=s))}}}return n}),{useDeepEqual:!0,debugName:"relativeVariableStore"}),this.relativeVariablesAreStale=new o.Z((()=>{const e=this.context.state;if(!e)return!1;const t=e.collectionViewBlockStore;if(!t)return!1;const n=this.relativeVariables.state;for(const[o,i]of(0,_.qP)(n)){const e=Z.NW.createChildStore(t,{id:o,table:y.v}),n=e.getSchema(),r=null==e?void 0:e.getFormat().app_config_uri;if(r&&(0,v.oN)(n,r))for(const[t,a]of(0,_.qP)(i)){const i=Z.G.createChildStore(e,{id:a,table:b.iU});if(i.isDefined()&&!(0,M.iL)({blockStore:i,collectionId:o,appConfigUri:r,variable:t,schema:n}))return!0}}return!1}),{debugName:"relativeVariablesAreStale"}),this.aliveAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)(o.isTriggerType("notification_event")||o.isTriggerType("event"))&&o.getAlive()&&(n+=1);return n}),{debugName:"aliceAutomationCount"}),this.aliveSlackAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)o.isTriggerType("notification_event")&&o.getAlive()&&(n+=1);return n}),{debugName:"aliveSlackAutomationCount"}),this.getCompleteSprintButtonContext=new o.Z((()=>{var e,t;const n=U.default.checkGate("recurring_sprints");if((null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("app_config_uri").getValue())!==r.g3)return;const o=this.sprintSettingsContextStore.state;if(!o||!o.sprintCollectionStore)return;if(n&&!o.automationContext)return;const{sprintCollectionStore:i,taskCollectionStore:a,automationContext:s}=o,l=this.getAutomationCollectionValue(a),c=this.getAutomationCollectionValue(i),d=null==c||null===(t=c.format)||void 0===t?void 0:t.app_config_uri,u=i.getSchema();return d&&v.qB[d]&&(0,v.oN)(u,d)&&l&&c?{...o,sprintCollectionStore:i,taskCollectionValue:l,sprintCollectionValue:c,sprintCollectionSchema:u,automationContext:s}:void 0}),{useDeepEqual:!0,debugName:"getCompleteSprintButtonContext"}),this.sprintSettingsContextStore=new o.Z((()=>{const e=(()=>{const e=this.collectionStore(),t=this.collectionViewBlockStore();if(!t||!e)return;const n=e.getParentBlockStore();if(!n||!Boolean(n.pathIsAccessibleAndAlive()))return;const o=e.getDatabaseType();if(o!==r.p$&&o!==r.iS)return;let i,a,s,l;if(o===r.iS){var d;i=e,a=n;const o=null===(d=i.getFormatStore().getKeyStore("app_uri_map").getValue())||void 0===d?void 0:d[r.Es.TaskToSprintRelation];if(!o)return{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};const u=i.getSchemaStore().getKeyStore(o).getValue();if(!u||!c.p_(u))return;const p=c.j0(u);if(!p)return{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};if(s=Z.NW.createChildStore(t,p),l=s.getParentBlockStore(),!l)return{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};if(s.getDatabaseType()!==r.p$)return}else if(o===r.p$){var u;s=e,l=n;const o=null===(u=s.getFormatStore().getKeyStore("app_uri_map").getValue())||void 0===u?void 0:u[r.b0.SprintToTaskRelation];if(!o)return;const d=s.getSchemaStore().getKeyStore(o).getValue();if(!d||!c.p_(d))return;const p=c.j0(d);if(!p)return;if(i=Z.NW.createChildStore(t,p),a=i.getParentBlockStore(),i.getDatabaseType()!==r.iS||!a)return}else(0,_.t1)(o);const p=s?h.Ps(h.oA(s.getAutomationStores().map((e=>{if(!Boolean(e.getAlive()))return;const t=e.getActionStores();return e.isTriggerType("recurrence")&&1===t.length&&Boolean(t[0].getAlive())&&t[0].isType("complete_sprint")?{automationStore:e,automationActionStore:t[0]}:void 0})))):void 0;return Boolean(i.getAlive())&&a.pathIsAccessibleAndAlive()?Boolean(s.getAlive())&&l.pathIsAccessibleAndAlive()?{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:s,sprintCollectionViewBlockStore:l,automationContext:p}:{currentCollectionViewBlockStore:t,taskCollectionStore:i,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0}:void 0})(),t=(e=>{var t;if(!e)return;if(!e.taskCollectionViewBlockStore.canEditCollection())return{canEdit:!1};const n=e.sprintCollectionViewBlockStore,o=Boolean(null===(t=e.sprintCollectionViewBlockStore)||void 0===t?void 0:t.canEditCollection());return n&&!o?{canEdit:!1}:!e.sprintCollectionViewBlockStore||o&&!e.automationContext?{canEdit:!0,displayStatus:"displayOff"}:o&&e.automationContext?{canEdit:!0,displayStatus:"displayOn"}:void 0})(e);return e&&t?{...e,permissionsContext:t}:void 0}),{useDeepEqual:!0,debugName:"sprintSettingsContextStore"}),this.initialDatabaseItemsVisibleTracker=void 0,this.onItemMount=()=>{var e;null===(e=this.initialDatabaseItemsVisibleTracker)||void 0===e||e.handleItemMount(),this.trackInfiniteScrollLongTasksDebounced()},this.trackInfiniteScrollLongTasksDebounced=h.Ds(this.trackInfiniteScrollLongTasks,1e3),this.environment=e}setContext(e){this.context.setState(e)}get contextType(){var e;return null===(e=this.context.state)||void 0===e?void 0:e.type}get databaseType(){const e=this.context.state;if(e){if("collectionTypedView"===e.type)return e.databaseType;if("collectionView"===e.type){const t=e.collectionStore;return null==t?void 0:t.getDatabaseType()}}}collectionViewStore(){const e=this.context.state,t=null==e?void 0:e.type;if(t)switch(t){case"collectionTypedView":case"collectionView":case"collectionVirtualView":return e.collectionViewStore;case"collectionPage":case"collectionViewBlock":return;default:(0,_.t1)(t)}}collectionStore(){const e=this.context.state;if(e&&"collectionTypedView"!==e.type)return"collectionVirtualView"===e.type||"collectionView"===(null==e?void 0:e.type)||"collectionPage"===(null==e?void 0:e.type)?e.collectionStore:void("collectionViewBlock"!==(null==e?void 0:e.type)&&(0,_.t1)(e))}hasSingleCollection(){switch(this.contextType){case"collectionTypedView":case"collectionVirtualView":return!1;case"collectionPage":case"collectionViewBlock":case"collectionView":case void 0:return!0;default:(0,_.t1)(this.contextType)}}collectionViewBlockStore(){const e=this.context.state;return null==e?void 0:e.collectionViewBlockStore}formatStore(){const e=this.context.state;if(e)return"collectionPage"===e.type?e.collectionStore:"collectionView"===e.type||"collectionTypedView"===e.type||"collectionVirtualView"===e.type?e.collectionViewStore:void("collectionViewBlock"!==e.type&&(0,_.t1)(e))}getPropertyFormatKey(){const e=this.context.state;if("collectionPage"===(null==e?void 0:e.type))return"collection_page_properties";if("collectionView"===(null==e?void 0:e.type)||"collectionTypedView"===(null==e?void 0:e.type)){const t=e.collectionViewStore.getType();if(!t)return;return g.oz(t)}}getPropertyFormat(e){var t;const n=null===(t=this.formatStore())||void 0===t?void 0:t.getFormat(),o=null==this?void 0:this.getPropertyFormatKey();if(!n||!o)return;return(n[o]??[]).find((t=>t.property===e))}createUpdateCounter(){return this.updateCounter++,this.updateCounter}shouldUpdate(e){return this.updateCounter===e}getCurrentUserId(){return this.environment.currentUser.id}getViewType(){const e=this.collectionViewStore();if(null!=e&&e.isDefined())return e.getType();const t=this.context.state;return"collectionPage"===(null==t?void 0:t.type)?"page":void 0}currentViewHasSort(){const e=this.normalizedQueryStore.state;return Boolean(e&&e.sort&&e.sort.length>0)}resetLoadingState(){this.isLoading.setState(!1),this.loadingDetails.reset()}getCollectionViewBlockSourceState(){const e=this.collectionViewBlockStore();if(!e)return"uninitialized";if(e.getCollectionViewSourceCollectionStore())return"source";return e.getCollectionViewStores().some((e=>Boolean(e.getCollectionStore())))?"linked":"uninitialized"}getFilterBarItemSettingsStore(e){let t=this.filterBarItemSettingsStoreMap.get(e.id);return t||(t=i.default.createValue({open:!1,stack:[]}),this.filterBarItemSettingsStoreMap.set(e.id,t)),t}getFilterOptionsItemSettingsStore(e){let t=this.filterOptionsItemSettingsStoreMap.get(e.id);return t||(t=i.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap.set(e.id,t)),t}viewIsFlushToTopbar(){if(!this.collectionStore())return!1;if(this.shouldShowSource.state)return!1;if(this.filtersBarOpenStore.state)return!1;return void 0===this.getCompleteSprintButtonContext.state}shouldAllowNewItemCreation(e){const t=this.permissionScopes.state,n="collectionTypedView"===this.contextType;return!t.isSyncedCollection&&(t.canEditContent||n&&(null==e?void 0:e.overrideAllowForTypedViews))}getAutomationCollectionValue(e){if(e.isDefined())return{id:e.id,space_id:e.getSpaceId(),schema:e.getSchema(),format:e.getFormat()}}async trackInfiniteScrollLongTasks(){if(!this.infiniteScrollLongTaskObserver.isObserving)return;this.infiniteScrollLongTaskObserver.disconnect();const e=this.infiniteScrollLongTaskObserver.takeRecords();if(!(await k.TA("collections.infinite_scroll_long_tasks.max_duration")))return;const t=e.reduce(((e,t)=>(e.entryCount++,e.maxDuration=Math.max(e.maxDuration,t.duration),e)),{maxDuration:0,entryCount:0}),n=C.Pn(this);k.j(this.environment,"collections.infinite_scroll_long_tasks.count",{count:t.entryCount,...n}),t.entryCount>0&&k.j(this.environment,"collections.infinite_scroll_long_tasks.max_duration",{time:t.maxDuration,...n})}getPageVisitSourceOverride(){var e;switch(null===(e=this.context.state)||void 0===e?void 0:e.type){case"collectionTypedView":case"collectionVirtualView":return this.context.state.pageVisitSourceOverride;case"collectionPage":case"collectionView":case"collectionViewBlock":case void 0:return;default:(0,_.t1)(this.context.state)}}getAnalyticsFromOverride(){var e;switch(null===(e=this.context.state)||void 0===e?void 0:e.type){case"collectionTypedView":case"collectionVirtualView":return this.context.state.analyticsFromOverride;case"collectionPage":case"collectionView":case"collectionViewBlock":case void 0:return;default:(0,_.t1)(this.context.state)}}resultsInViewOrder(e){var t;const n=this.collectionViewBlockStore(),o=this.collectionViewStore(),i=this.collectionStoresStore.state;if(!n||!o||!i.length)return[];const r=this.normalizedFormatStore.state,a="board"===this.getViewType()?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},s=this.normalizedSchemaStore.state,c=r[a.groupByKey],d=(0,_.$K)(c)?(0,l.Qq)({schema:s,groupBy:c}):[],u=Object.values((null===(t=this.localResultStore.state)||void 0===t?void 0:t.reducerResults)??{}).find((e=>"groups"===e.type)),p=(0,T.Cz)({getRecordModel:n.getRecordModel,schema:s,groupBy:c,formatGroups:r[a.groupsFormatKey]??[],schemaGroups:d,reducerResults:(null==u?void 0:u.results)??[],relativeVariableResult:this.relativeVariableStore.state,viewAppConfigUri:o.getFormat().app_config_uri});let m,f;if(0===p.length){const e=this.localResultStore.state;if(e){const t=Object.values(e.reducerResults).find((e=>"results"===e.type));m=((null==t?void 0:t.blockIds)??[]).map((e=>Z.G.createChildStore(o,{table:"block",id:e})))}else m=[]}else{m=[];for(const e of p){const t=this.groupsStore.getGroupState(e),n=null==t?void 0:t.resultsStore.state;m.push(...n??[])}}if(m=h.mN(m,(e=>e.id)),this.currentSubitemFormatStore.state){f=[];const t=this.subitemTreeStore.state;for(const n of m){if(void 0!==e&&f.length>=e)break;const o=t.children.find((e=>e.value.store.id===n.id));if(o){const e=[];(0,R.yU)({results:e,tree:o}),f.push(...e)}}}else f=m;return void 0!==e?f.slice(0,e):f}collectionStoreResultsInViewOrder(){if("collectionTypedView"!==this.contextType){const e=this.collectionStore();return e?[e]:[]}const e=this.resultsInViewOrder(void 0);return h.oA(h.mN(e.map((e=>e.getAssociatedCollectionStore())),"id"))}}O.PREFERENCE_KEY_PREFIX="CollectionView:",O.incrementScrollOffset=600;const N=O},58421:(e,t,n)=>{n.d(t,{n:()=>i});var o=n(72126);function i(e){const t=e.state;return o.Z$(t.stack)}},6776:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return i.d9(this.state)}}const a=new r},19511:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const a=new r},16772:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});n(21703);var o=n(49085),i=n(12139);class r extends o.default{constructor(){super(...arguments),this.lastUpdater=0}getInitialState(){return{type:"closed"}}setState(e){if("completionPopup"===this.state.type&&"results"===this.state.stage&&("completionPopup"!==e.type||"results"!==e.stage)){const{inMemoryRecordCache:e,context:t}=this.state;if(e.cacheUsingThisInstanceAsAnOverride){const n=`CompletionsStore transitioning away from completionPopup results while inMemoryRecord cache is still overriding ${e.cacheUsingThisInstanceAsAnOverride===t.currentPage.inMemoryRecordCache?"page's in-memory cache":"an unknown cache"}!`;i.rn(new Error(n),{from:"CompletionsStore",type:"dangerousStateTransition"})}}super.setState(e)}createUpdater(){const e=++this.lastUpdater;return t=>{if(e===this.lastUpdater)return t()}}invalidateLastUpdater(){this.lastUpdater+=1}resetStore(e){const{environment:t}=e;this.invalidateLastUpdater();const n=this.state;"completionPopup"===n.type&&("initialPromptForAIBlock"!==n.stage&&"initialPrompt"!==n.stage&&t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache),this.setState({type:"closed"}))}getExistingSessionId(){return"closed"!==this.state.type?this.state.sessionId:void 0}isEditingEmptyBlock(){var e;const t=this.state;return Boolean("completionPopup"===t.type&&"initialPrompt"===t.stage&&"cursor"===t.context.type&&(null===(e=t.context.currentBlock)||void 0===e?void 0:e.isEmptyEditableBlock()))}}const a=new r},72371:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),i=n(49085),r=n(92595);class a extends i.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ComplianceIntegrationStore.integrations"}),this.webhookSubscriptions=new o.Z((()=>{const e=this.state;return e.loaded?e.webhookSubscriptions:[]}),{debugName:"ComplianceIntegrationStore.webhookSubscriptions"})}getInitialState(){return{loaded:!1,loading:!1}}}const s=new a;(0,r.exposeDebugValue)("ComplianceIntegrationStore",s);const l=s},81700:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},80641:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{bypassedPageIds:new Set}}bypassedPage(e){return this.state.bypassedPageIds.has(e)}bypassPage(e){this.state.bypassedPageIds.add(e),this.emit()}}const r=new i},61893:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(86658),r=n(12955);class a extends o.default{getInitialState(){return{permission:i.UE}}getId(){return this.getState().id}getPermission(){return this.getState().permission}setPermission(e){this.setState({...this.state,permission:e})}async setCookieConsent(e,t){this.setState(t),await(0,r.setCookieConsentCookie)(e,t)}clearCookieConsent(){this.reset(),(0,r.removeCookieConsentCookie)()}}const s=new a},45293:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},56681:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageId:void 0,lastInteractionTimes:{}}}}const r=new i},28748:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},30581:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.containerDomNodeStore=o.default.createValue(null)}getInitialState(){return{overlays:new Set}}}const r=new i},55367:(e,t,n)=>{n.d(t,{Dl:()=>r,ZP:()=>s,vh:()=>i});var o=n(49085);let i=function(e){return e[e.Above=0]="Above",e[e.Below=1]="Below",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Onto=4]="Onto",e}({}),r=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}({});class a extends o.default{getInitialState(){return{isDragging:!1}}}const s=new a},45452:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isDragging:!1,willDrag:!1}}}const r=i},10084:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72126);class r extends o.default{getInitialState(){return{initiator:"none",dragging:!1,waiting:!1}}hasDragged(){return this.state.dragging&&!i.Xy(this.state.startingPoint,this.state.currentPoint)}}const a=r},80796:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{initiator:"none",isDragging:!1,disableVerticalEdgeScroll:!1,disableHorizontalEdgeScroll:!1}}}const r=new i},12211:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{dropTargetRectMap:new Map}}}const a=new r;(0,i.exposeDebugValue)("GlobalDropTargetRectStore",a);const s=a},24042:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isTabsFeatureEnabled:!1}}}const r=new i},64233:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},66949:(e,t,n)=>{n.d(t,{P:()=>r,Z:()=>l});var o=n(49085),i=n(92595);let r=function(e){return e.Forward="Forward",e.Backward="Backward",e}({});class a extends o.default{getInitialState(){return{open:!1}}isOpen(){if(this.state.open){this.state;return!0}return!1}}const s=new a;i.exposeDebugValue("EquationAnnotationStore",s);const l=s},77080:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b,localExperimentsV2Key:()=>h});var o=n(14577),i=n(49085);var r=n(12174),a=n(68626),s=n(15157),l=n(72126),c=n(97715),d=n(34886),u=n(97880),p=n(95477),m=n(64496),f=n(80444),g=n(7339);const h="experimentsSettingsV2";class v extends i.default{getInitialState(){return{isLoaded:!1}}updateState(e,t){!e.test&&this.state.isLoaded&&this.state.test||(this.setState(e),(0,m._3)(t)||s.Z.set({userId:e.userId,key:h,value:e}))}setState(e){super.setState(e)}getExperimentsForCurrentSpace(){if(!this.state.isLoaded)return[];if(this.state.test)return this.state.experiments;const e=f.default.state.currentSpaceStore;return e&&this.state.experimentsBySpace[e.id]||this.state.experimentsWithoutSpace}getGroup(e){if(r.TS.has(e))return c.Le;let t;if(this.state.isLoaded){const n=this.getExperimentsForCurrentSpace().find((t=>t.experimentId===e));if(!n)return c.Le;t=n.group}return t||c.Le}getExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t.group})),e}getExperiments(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t})),Object.values(e)}getUsedNonControlExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{"control"!==t.group&&(0,r.DP)(t.experimentId)&&(e[t.experimentId]=t.group)})),e}getAcceptLanguageHeader(){if(this.state.isLoaded)return this.state.acceptLanguageHeader}}const b=new class extends v{constructor(){super(),this.statsigExposureCacheForAnalytics={},this.computedStoreMap=new Map,this.isStatsigEnabled()&&g.C.addListener((()=>{this.recomputeAllGroupStores()}))}isStatsigEnabled(){var e;return Boolean(null===(e=p.default.statsig)||void 0===e?void 0:e.apiKey)}isStatsigEnabledAndInitialized(){return this.isStatsigEnabled()&&g.C.isInitialized()}isLoaded(){return this.state.isLoaded}getGroup(e,t){if(!(0,r.YY)(e)){return this.createComputedGroupStore(`group-${e}`,(()=>super.getGroup(e))).state.group||c.Le}return this.getEligibleGroup({experimentId:e,defaultGroup:c.Le,disableExposureLogging:null==t?void 0:t.disableExposureLogging})}getEligibleGroup(e){const{experimentId:t,defaultGroup:n,parameter:o=g.Z,disableExposureLogging:i=!1}=e,r=o===g.Z;this.state.isLoaded;const a=`eligible-group-${t}-${o}`;return this.createComputedGroupStore(a,(()=>{if(!this.isStatsigEnabledAndInitialized())return;const e=this.validateGroupIsString(g.C.getGroup(t,i));return void 0!==e&&(this.statsigExposureCacheForAnalytics[`statsig-${t}`]=e),r?e:g.C.getGroup(t,i,o,n)})).state.group??n}manuallyLogExperimentExposure(e){g.C.manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getFeatureGateOverrideForBrowserTest(e);if((0,u.$K)(n))return n;const o=this.getFeatureGateOverrideForUnitTest(e);if((0,u.$K)(o))return o;return this.createComputedGateStore(e,(()=>{if(!this.isStatsigEnabledAndInitialized())return!1;const n=g.C.checkGate(e,t);return this.statsigExposureCacheForAnalytics[`statsig-${e}`]=n,n})).state.gate}getConfigKey(e,t,n){const o=r.LI[e][t];return this.createComputedDynamicConfigKeyStore(e,t,(()=>{var i;return this.isStatsigEnabledAndInitialized()&&(null===(i=g.C.getConfig(e,n))||void 0===i?void 0:i.get(String(t),o))||o})).state.value}logEvent(e,t,n){return this.isStatsigEnabledAndInitialized()?g.C.logEvent(e,t,(0,d.R)(n)):(a.log({level:"error",from:"ExperimentStore.ts",type:"statsigIsNotInitialized",data:{miscDataToConvertToString:{eventName:e,value:t,metadata:(0,d.R)(n),isStatsigEnabled:this.isStatsigEnabled(),isInitialized:g.C.isInitialized()}}}),!1)}getExperimentsMap(){return{...super.getExperimentsMap(),...this.statsigExposureCacheForAnalytics}}getStatsigExperimentsMap(){return this.statsigExposureCacheForAnalytics}updateState(e,t){(void 0===e.userId||this.state.isLoaded&&this.state.userId!==e.userId)&&(this.statsigExposureCacheForAnalytics={}),super.updateState(e,t)}reset(){super.reset(),this.statsigExposureCacheForAnalytics={},this.recomputeAllGroupStores()}async waitUntilStatsigReady(){this.isStatsigEnabled()&&await g.C.waitUntil((()=>g.C.state.ready))}createComputedGroupStore(e,t){return this.createComputedStore(e,(()=>({group:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedGateStore(e,t){return this.createComputedStore(`gate-${e}`,(()=>({gate:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedDynamicConfigKeyStore(e,t,n){return this.createComputedStore(`config-${e}-${String(t)}`,(()=>({value:n(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedStore(e,t){const n=(new Date).getMinutes();let i=this.computedStoreMap.get(e);return i?i.state.lastUpdatedMinute!==n&&i.setShouldRecompute():(i=new o.Z(t,{debugName:`ExperimentStore.${e}`}),i.addListener(l.yR),this.computedStoreMap.set(e,i)),i}recomputeAllGroupStores(){this.computedStoreMap.forEach((e=>{e.enqueueRecompute()}))}getFeatureGateOverrideForBrowserTest(e){}getFeatureGateOverrideForUnitTest(e){}validateGroupIsString(e){return"string"==typeof e?e:void 0}}},30874:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(14577),i=n(49085),r=n(92595),a=n(45953),s=n(77420),l=n(9844);class c extends i.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ExternalIntegrationStore.integrations"}),this.bots=new o.Z((()=>{const e=this.state;return e.loaded?e.bots:[]}),{debugName:"ExternalIntegrationStore.bots"}),this.externalAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.externalAuthentications:[]}),{debugName:"ExternalIntegrationStore.externalAuthentications"}),this.completeSlackAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.completeSlackAuthentications:[]}),{debugName:"ExternalIntegrationStore.completeSlackAuthentications"})}getInitialState(){return{loaded:!1,loading:!1}}getIntegrationsAsRecordMap(){const e=a.Ak.create();return this.integrations.state.forEach((t=>e.setValue({table:l.K2,id:t.id},t))),e}getBotsAsRecordMap(){const e=a.Ak.create();return this.bots.state.forEach((t=>e.setValue({table:s.cZ,id:t.id},t))),e}}const d=new c;(0,r.exposeDebugValue)("ExternalIntegrationStore",d);const u=d},79167:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(49085),i=n(41432),r=n(77657),a=n(72126),s=n(45953),l=n(21202),c=n(77420),d=n(6287),u=n(97880),p=n(63143),m=n(30874);class f extends o.default{getInitialState(){return{externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}}}addFromRecordMapWithRoleJson(e){this.addFromRecordMapWithRole(s.PF.create(e))}addFromRecordMapWithRole(e){const t=e.getByTable(d.v).filter((e=>{var t;let{value:n}=e;return null==n||null===(t=n.value)||void 0===t||null===(t=t.format)||void 0===t?void 0:t.external_object_id})).map((e=>{let{value:t}=e;return(null==t?void 0:t.value)&&{id:t.value.id,table:d.v,spaceId:t.value.space_id}})).filter(u.$K),n=m.Z.getBotsAsRecordMap(),o=e.getByTable(l.iU).filter((e=>{let{value:t}=e;if(!(t&&t.value&&t.value.format&&t.value.format.external_object_id))return!1;if(t.value.type!==i.Ti.externalObjectInstancePage&&t.value.type!==i.Ti.externalObjectInstance)return!1;const o=t.value.format.bot_id;if(!o)return!1;if(!0===m.Z.state.loaded){const e=n.getValue({table:c.cZ,id:o});if(e&&e.integration_id&&e.integration_id===r.U9)return!1}return!0})).map((e=>{let{value:t}=e;return null==t?void 0:t.value})).filter(u.$K),s=a.oA(o.map((e=>{if(e.type===i.Ti.externalObjectInstancePage&&e.parent_table===d.v)return{id:e.parent_id,table:e.parent_table,spaceId:e.space_id}}))),f=(0,p.m8)(o.map((e=>{const t={id:e.id,table:l.iU,spaceId:e.space_id};return[e.id,t]}))),g=(0,p.m8)([...t,...s].map((e=>[e.id,e])));this.setState({externalObjectInstanceBlockPointersMap:{...this.state.externalObjectInstanceBlockPointersMap,...f},externalCollectionInstancePointersMap:{...this.state.externalCollectionInstancePointersMap,...g}})}reset(){this.setState({externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}})}isEmpty(){return 0===Object.keys(this.state.externalCollectionInstancePointersMap).length&&0===Object.keys(this.state.externalObjectInstanceBlockPointersMap).length}}const g=new f},83279:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isLoading:!1,progressPercent:0}}}const r=i},69316:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,findQuery:"",inputRef:void 0}}}const r=new i},89256:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},73329:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},17903:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(92595);const i=new(n(45589).Z);(0,o.exposeDebugValue)("FrameScrollerStore",i);const r=i},46735:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(50475),i=n(92595),r=n(35683),a=n(80444);const s=new class{constructor(){this.frecencyStore=void 0,this.spaceId=void 0,this.userId=void 0}get(e){const{currentSpaceStore:t}=a.default.state,n=t&&t.id;return void 0===n||void 0===e?(this.userId=void 0,this.spaceId=void 0,void(this.frecencyStore=void 0)):(this.spaceId===n&&this.userId===e||(this.spaceId=n,this.userId=e,this.frecencyStore=new r._R({store:localStorage,prefix:`BlockFrecency:${e}:${n}`,maxBlocks:100,maxStoredVisits:10,version:r.uP}),this.frecencyStore.initialize()),this.frecencyStore)}};const l={lazyFrecencyStore:s,recordVisit:e=>{const{id:t,type:n,timestampForTestingOnly:i,currentUserId:r,systemBlockType:a}=e;if((0,o.EW)(a))return;const l=s.get(r);return l?l.recordVisit({id:t,type:n,timestampForTestingOnly:i}):void 0},sortFrecencyHighToLow:function(e){const{currentUserId:t,items:n,now:o,recordFrecency:i}=e,r=s.get(t);return r?r.sortFrecencyHighToLow({items:n,now:o,recordFrecency:i}):n},getVisitedIds:e=>{const t=s.get(e);return t?t.getVisitedIds():[]},clearForUser:function(e){for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith(`BlockFrecency:${e}`)&&localStorage.removeItem(n)}}};(0,i.exposeDebugValue)("FrecencyStore",l);const c=l},38302:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{isOpen:!1,backgroundAnimationComplete:!0,fullscreenNodeAnimationComplete:!0,startScrollTop:0,skipAnimations:!1,isSaving:!1,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}}}}const a=new r;(0,i.exposeDebugValue)("GlobalFullScreenStore",a);const s=a},81258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},73796:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},27411:(e,t,n)=>{n.r(t),n.d(t,{GlobalFileUploadStore:()=>i,default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getKeyState(e){return this.state[e]}setKeyState(e,t){const n=this.state;let o;if(t){var i;const a=t.file.type.indexOf("image")>=0;var r;if(t.file!==(null===(i=n[e])||void 0===i?void 0:i.file)&&a)o=null===(r=n[e])||void 0===r?void 0:r.dataURL,t.dataURL=URL.createObjectURL(t.file);n[e]={...t,dataURL:t.dataURL}}else{var a;o=null===(a=n[e])||void 0===a?void 0:a.dataURL,delete n[e]}if(o){const e=o;setTimeout((()=>{URL.revokeObjectURL(e)}),1e3)}this.emit()}isUploading(){const e=this.state,t=Object.keys(e);for(const n of t){if(e[n])return!0}return!1}getBlockKey(e){return e}}const r=new i},96049:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),i=n(55367),r=n(80796),a=n(69784),s=n(59238);const l=new o.Z((()=>r.Z.state.isDragging||i.ZP.state.isDragging||s.Z.state.isDragging||a.default.state.isActive),{debugName:"GlobalIsDraggingStore"})},45483:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{openModals:new Set}}}const a=new r,s=a;(0,i.exposeDebugValue)("GlobalModalStore",a)},3418:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{openPopups:new Set,namedOpenPopups:new Set}}hasOpenPopups(){const{openPopups:e,namedOpenPopups:t}=this.getState();return e.size>0||t.size>0}hasOpenMobileSlideUps(){const{openPopups:e,namedOpenPopups:t}=this.getState();if(t.size>0)return!0;for(const n of e){if(n.props.hidesMobileNativeBottomBar)return!0;if(n.isSlideUp(n.props)&&!n.props.preventSlideUpTransition)return!0}return!1}hasOpenMouseCapturePopup(){const{openPopups:e}=this.state;return e.size>0&&Array.from(e.values()).some((e=>!e.props.disableMouseCapture))}closeAll(){for(const n of this.state.openPopups){var e,t;null===(e=(t=n.props).onDismiss)||void 0===e||e.call(t,null)}}addNamedPopup(e){this.state.namedOpenPopups.add(e),this.emit()}removeNamedPopup(e){this.state.namedOpenPopups.delete(e),this.emit()}}const r=new i},69327:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(18466),i=n(49085),r=n(72126),a=n(44615),s=n(21202),l=n(63143),c=n(15447),d=n(2688),u=n(80444),p=n(26136);class m extends i.default{constructor(){super(...arguments),this.userPageVisitListenerReference=void 0,this.recentPageRefreshTimer=void 0,this.isInitialized=!1,this.reinitializeState=async(e,t,n)=>{this.cleanup(e),await(0,c.h_)({environment:e,userId:t,spaceId:n}),this.isInitialized=!0;const o=5*l.hM;this.recentPageRefreshTimer=window.setTimeout((()=>{(0,c.h_)({environment:e,userId:t,spaceId:n})}),o),this.userPageVisitListenerReference=d.Z.addListener((0,a.Ns)(t),r.P2(((e,n)=>(0,c.rw)(t,n)),100),void 0,e)}}getInitialState(){return{recentPages:new Map}}cleanup(e){this.userPageVisitListenerReference&&(d.Z.removeListener(this.userPageVisitListenerReference,e),this.userPageVisitListenerReference=void 0),this.recentPageRefreshTimer&&(clearTimeout(this.recentPageRefreshTimer),this.recentPageRefreshTimer=void 0)}getRecentPagesWithStores(e,t){const n=u.default.state.currentSpaceStore;return n?t.map((t=>({...t,store:p.G.createChildStore(n.getPagesStore(),{table:s.iU,id:t.pageId,spaceId:e})}))):[]}set(e,t){const n=this.getRecentPagesWithStores(e,t);this.update((t=>(t.recentPages.set(e,n),t))),this.emit()}get(e){return this.state.recentPages.get(e)}getWithoutSubscribing(e){return o.Z.withListenerIgnored((()=>this.get(e)))||[]}mergeRecentPages(e,t){const n=this.getRecentPagesWithStores(t,e),o=(this.state.recentPages.get(t)??[]).concat(n),i=r.mN(o,"pageId");this.set(t,i)}}const f=new m},7844:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},475:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},52689:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(54153);const r="currentHighlightColor";class a extends o.default{getInitialState(){return{color:Boolean(localStorage)&&i.Z.get(r)||"yellow_background"}}setHighlightColor(e){i.Z.set(r,e),this.setState({color:e})}}const s=new a},42653:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isPinned:!1}}}const r=new i},20144:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},65686:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(34859);class r extends o.default{getInitialState(){return{capturingAreas:new Set}}getPreventScrollType(){let e=!1,t=!1,n=!1;return this.state.capturingAreas.forEach((o=>{o.preventType===i.Z.All?e=!0:o.preventType===i.Z.X?t=!0:o.preventType===i.Z.Y&&(n=!0)})),e||t&&n?i.Z.All:t?i.Z.X:n?i.Z.Y:i.Z.None}}const a=new r},41577:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{loaded:!1,error:!1}}}const r=i},94416:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},95424:(e,t,n)=>{n.d(t,{H:()=>a});var o=n(92595),i=n(54153),r=n(63143);class a{static getNumber(e){const t=i.Z.get(e);if("number"==typeof t&&!isNaN(t))return t}static getLatest(){return this.getNumber(this.LAST_TIMEOUT_STORAGE_KEY)}static trackPersistently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();i.Z.set(this.LAST_TIMEOUT_STORAGE_KEY,e);const t=this.getTotal()??0;i.Z.set(this.TOTAL_TIMEOUTS_STORAGE_KEY,t+1)}static getTotal(){return this.getNumber(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static clear(){i.Z.remove(this.LAST_TIMEOUT_STORAGE_KEY),i.Z.remove(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static hasOccurredRecently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();const t=this.getLatest();return"number"==typeof t&&e-t<this.RECENT_TIME_WINDOW_MS}}a.LAST_TIMEOUT_STORAGE_KEY="latestNotionTransactionTimeout",a.TOTAL_TIMEOUTS_STORAGE_KEY="totalNotionTransactionTimeouts",a.RECENT_TIME_WINDOW_MS=7*r.A0,(0,o.exposeDebugValue)("IndexedDBTimeoutTracker",a)},96826:(e,t,n)=>{n.d(t,{Z:()=>k});var o,i=n(54064),r=n(68626),a=n(72126),s=n(91155),l=n(29477),c=n(606),d=n(12139),u=n(63143),p=(n(95477),n(21830)),m=n(15517),f=n(2414),g=n(63037),h=n(88632),v=n(77080),b=n(99757),y=n(26634),_=n(9425);class S{constructor(e){this.debug=!1,this.shouldStopLooping=!1,this.attemptedToClaimSessions=!1,this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.events=new i.Z,this.waiter=void 0,this.transactionBackoffController=new f.h(y._W),this.retryReasonCounters={_total:0},this.errorCounts={},this.startTime=Date.now(),this.disableStorageManagerEstimate=!1,this.dependencies=void 0,this.transactionStore=void 0,this.sessionId=void 0,this.debugLogger=void 0,this.enableHeartbeatTimeout=void 0;const{dependencies:t,transactionStore:n,sessionId:o,debugLogger:a,enableHeartbeatTimeout:s}=e;this.dependencies=t,this.transactionStore=n,this.sessionId=o,this.debugLogger=a,this.enableHeartbeatTimeout=s,r.clientLogglyEnvironmentData.idbSessionId=this.sessionId,this.disableStorageManagerEstimate=v.default.checkGate("disable_storage_manager_estimate",!0),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"createdIndexedDBTransactionQueue",data:{sessionId:this.sessionId}})}startLoop(){setTimeout((()=>{this.heartbeatLoop()}),1),setTimeout((()=>{this.txLoop()}),1),setTimeout((()=>{this.healthcheckLoop()}),1)}stopLoop(){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"stopLoop",data:{message:"Stopping loop."}}),this.shouldStopLooping=!0}hasAttemptedToClaimSessions(){return this.attemptedToClaimSessions}logEmptyTaskForDebugging(e){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"logEmptyTaskForDebugging",data:{message:`Task created by ${e} was empty.`}})}async enqueueTask(e){const t=await this.transactionStore.saveTask(this.sessionId,e,this.getIndexedDBTimeoutMs());if(this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp),t.error)throw this.incrementErrors(t.error,"enqueueTask"),this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"enqueueTask",error:(0,s.Ui)(t.error)}),t.error;this.clearErrors("enqueueTask"),this.getWaitable(!1).trigger()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return!!this.transactionStore&&this.transactionStore.hasTasks()}async hasTasksForUser(e){const t=await this.transactionStore.hasTasksForUser(e,this.getIndexedDBTimeoutMs());return t.error?(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.hasTasksForUser",error:(0,s.Ui)(t.error)}),!1):t.value}async anySessionHasTasks(){const e=await this.transactionStore.anySessionHasTasks(this.getIndexedDBTimeoutMs());return e.error?(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.anySessionHasTasks",error:(0,s.Ui)(e.error)}),!1):e.value}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return this.hasTask((t=>t.operations.some((t=>(0,c.qo)(t.pointer,e)))))}async reset(){await this.transactionStore.reset()}async clearForUser(e){await this.transactionStore.clearTasksForUser(e)}async checkObjectStores(){return await this.transactionStore.checkObjectStores()}async getTotalNumberOfTasks(){const e=await this.transactionStore.getTotalNumberOfTasks(this.getIndexedDBTimeoutMs());return e.error?(r.log({level:"error",from:"IndexedDBTransactionQueue",type:"getTotalNumberOfTasks",error:(0,s.Ui)(e.error)}),0):e.value}startSyncing(){h.Z.setState({...h.Z.state,syncing:!0})}updateDependencies(e){this.dependencies=e}DEV_ONLY_deadlockDb(e){return this.transactionStore.DEV_ONLY_deadlockDb(e)}debugLog(){if(this.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("IndexedDBTransactionQueue:",...t)}}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}async txLoop(){for(;!this.shouldStopLooping;)try{await this.txLoopIteration(),this.clearErrors("txLoop")}catch(e){this.incrementErrors(e,"txLoop"),(0,g.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"txLoopIteration",error:(0,s.Ui)(e)}),d.IE(e),await l.Vs(15e3)}}async txLoopIteration(){const e=await this.getTasks();if(!e)return this.events.emit("drain"),void(await this.wait(...this.getMinMaxLoopDelay(!1)));const{tasks:t,sessionId:n}=e;if(0===t.length){const e=await this.transactionStore.deleteSession({currentSessionId:this.sessionId,sessionId:n});return void(e.error&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteSession",data:{sessionId:n},error:(0,s.Ui)(e.error)})))}this.startSyncing(),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSubmitTransactionAttempt",data:{message:`for session ${n}: attempt submitTransaction with ${t.length} tasks`,sessionId:n,taskIds:w(t)}}),await this.useSaveTransactionsApi(t,n);const o=this.hasTasks();o||(this.doneSyncing(),this.events.emit("drain")),await this.wait(...this.getMinMaxLoopDelay(o))}getMinMaxLoopDelay(e){const[t,n]=(0,_.Z)()?[g.xd,g.CE]:[g.V_,g.Ud];return Boolean(e)?[t,t]:[t,n]}async useSaveTransactionsApi(e,t){const n=await this.dependencies.handleSaveTransactions(e);if(n.error){const{savedTasks:e,failedTasks:o,message:i,retryDelay:a,retryReason:l}=n.error;l?(0,g.Os)(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handlePartialSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),r.log({level:"warning",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsError",data:{message:`for session ${t}: ${i}`,taskIds:w(o),sessionId:t},error:(0,s.Ui)(n.error)}),await this.cleanupTasks(o,n.error)):this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsRetryableError",data:{message:`for session ${t}: ${i}`,sessionId:t}}),a>0?await this.transactionBackoffController.backOffOnFailure(a-g.V_,n.error.retryReason):this.transactionBackoffController.reset()}else{const e=n.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0),this.transactionBackoffController.reset()}}incrementErrors(e,t){this.debugLog("incrementErrors",e,t),void 0===this.errorCounts[t]?this.errorCounts[t]=1:this.errorCounts[t]+=1;const n=a.Fp(Object.values(this.errorCounts))||0;this.errorCounts[t]===S.maxErrors+1&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:`maxErrors.${t}`,error:(0,s.Ui)(e)})),n>S.maxErrors&&b.Z.setState({...b.Z.state,transactionQueueError:e}),e.type===p.vZ&&this.events.emit("timeout")}clearErrors(e){this.errorCounts[e]&&delete this.errorCounts[e];(a.Fp(Object.values(this.errorCounts))||0)<=S.maxErrors&&b.Z.setState({...b.Z.state,transactionQueueError:void 0})}async heartbeatLoop(){for(;!this.shouldStopLooping;)try{await this.heartbeat(),await l.Vs(S.heartbeatInterval)}catch(e){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"heartbeatLoopIteration",error:(0,s.Ui)(e)}),await l.Vs(S.heartbeatInterval)}}async heartbeat(){const e=this.enableHeartbeatTimeout?this.getIndexedDBTimeoutMs():void 0;{this.debugLog("heartbeat");const t=await this.transactionStore.heartbeat({currentSessionId:this.sessionId,isActive:!0,timeoutMs:e});if(t.error)return this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.heartbeat",error:(0,s.Ui)(t.error)}),void this.incrementErrors(t.error,"heartbeat");this.clearErrors("heartbeat")}{const t=Date.now()-S.claimSessionDelay,n=await this.transactionStore.claimSessions({currentSessionId:this.sessionId,staleSessionTimeoutMs:t,transactionTimeoutMs:e});if(n.error)return this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.claimSessions",error:(0,s.Ui)(n.error)}),void(n.error.type===p.vZ&&this.incrementErrors(n.error,"claimSessions"));this.clearErrors("claimSessions"),this.attemptedToClaimSessions=!0}this.checkStorageQuota()}async checkStorageQuota(){if(this.disableStorageManagerEstimate)return;const e=await(0,m.sK)();e&&(r.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota,r.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,b.Z.setState({...b.Z.state,storageUsageEstimate:e}))}doneSyncing(){h.Z.setState({...h.Z.state,syncing:!1})}hasTask(e){return this.transactionStore.hasTask(e)}async getTasks(){const e="on"===this.dependencies.getExperimentGroup("sort_indexeddb_tasks_by_index"),t=await this.transactionStore.getTasks(this.sessionId,e);if(t.error)throw t.error;return t.value}async cleanupTasks(e,t){for(const i of e)if(i.callback)try{i.callback(t)}catch(o){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"cleanupTask",data:{taskId:i.id},error:(0,s.Ui)(o)})}const n=await this.transactionStore.deleteTasks(e);n.error&&(this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteTasks",error:(0,s.Ui)(n.error)}))}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6),this.waiter}async healthcheckLoop(){for(;!this.shouldStopLooping;){try{var e;const t=await this.transactionStore.getTotalNumberOfTasks(S.defaultIndexedDBTimeoutMs),n={queue_type:"IndexedDBTransactionQueue",uptime:Date.now()-this.startTime,queue_size:t.error?void 0:t.value,error_type:null===(e=t.error)||void 0===e?void 0:e.type,is_considered_online:h.Z.state.online,retry_reasons:this.retryReasonCounters};(n.queue_size&&n.queue_size>S.transactionSizeHealthcheckThreshold||n.error_type)&&(this.debugLogger.flush(),r.log({level:"info",from:"IndexedDBTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:n}}),this.dependencies.handleHealthcheck(n))}catch(t){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(t)}),d.IE(t)}await l.Vs(S.healthcheckInterval)}}getIndexedDBTimeoutMs(){if("on"===this.dependencies.getExperimentGroup("indexeddb-transaction-timeout-v2"))return S.defaultIndexedDBTimeoutMs}}function w(e){return e.map((e=>{var t;return null!==(t=e.debug)&&void 0!==t&&t.userAction?`${e.id} (${e.debug.userAction})`:e.id}))}o=S,S.heartbeatInterval=2.5*u.C0,S.claimSessionDelay=5*o.heartbeatInterval,S.healthcheckInterval=15*u.hM,S.transactionSizeHealthcheckThreshold=1e3,S.defaultIndexedDBTimeoutMs=180*u.C0,S.maxErrors=5;const k=S},50619:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(68626),i=n(82798),r=n(96826),a=n(99757);class s{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.handleIndexedDbTimeout=()=>{const e=(0,i.R9)(this.activeQueue,r.Z);e.hasTasks()||(e.stopLoop(),e.events.removeListener("timeout",this.handleIndexedDbTimeout),a.Z.reset(),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,o.log({level:"warning",from:"IndexedDBWithInMemoryFallbackTransactionQueue",type:"handleIndexedDbTimeout",data:{message:"IndexedDB timeout occurred while the transaction queue is empty. Switching over to InMemoryTransactionQueue."}}))},this.activeQueue=e,this.inMemoryTransactionQueue=t,e.events.addListener("timeout",this.handleIndexedDbTimeout)}startLoop(){this.activeQueue.startLoop()}logEmptyTaskForDebugging(e){var t,n;null===(t=(n=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(n,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}getIndexedDBTransactionQueue(){if(this.activeQueue instanceof r.Z)return this.activeQueue}}},64113:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focused:!1}}}const r=i},48863:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},22294:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isEnabled:!0,isKeyboardMode:!1}}setEnabled(e){this.setState({...this.state,isEnabled:e})}setKeyboardMode(e){this.state.isEnabled&&this.setState({isEnabled:!0,isKeyboardMode:e})}}const r=new i},23178:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},23883:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{limitParents:new WeakMap}}setLimitParents(e,t){this.state.limitParents.set(e,t),this.emit()}removeLimitParents(e){this.state.limitParents.delete(e),this.emit()}}const r=new i},31104:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},37598:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}getEditedBlocksForCollection(e){const t=this.state[e];if(t)return t;{const t=new Set;return this.state[e]=t,t}}setEditedBlock(e,t){this.getEditedBlocksForCollection(e).add(t),this.emit()}}const r=new i},84166:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{}const r=new i},91390:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},19111:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(72087);class r extends o.default{getInitialState(){return{open:!1,userRequestStore:new i.Z,botRequestStore:new i.Z,pageRequestStore:new i.Z,mentionTypes:{page:!1,heading:!1,createPage:!1,user:!1,inviteUser:!1,bot:!1,date:!1,reminder:!1,templateVariable:!1,group:!1}}}}const a=new r},29798:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0,isInitialized:!1}}}setState(e){super.setState({...e,focus:{...e.focus,isInitialized:!0}})}update(e){this.setState(e({...this.state}))}unsetFocus(){this.setState({...this.state,focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0}})}}const r=i},69454:(e,t,n)=>{n.d(t,{Z:()=>c,i:()=>s});var o=n(49085),i=n(72126),r=n(5162),a=n(3418);let s=function(e){return e[e.willHide=0]="willHide",e[e.hidden=1]="hidden",e[e.willShow=2]="willShow",e[e.shown=3]="shown",e}({});class l extends o.default{constructor(){var e;super(...arguments),e=this,this.updateKeyboardPhaseDebounced=i.Ds(((e,t)=>{this.setState({...this.state,phase:e,estimatedKeyboardWebViewOverlap:t})}),300),this.updateKeyboardPhase=(e,t,n)=>{const{device:o,RouterStore:i}=e,r="page"===i.state.route.name,a=o.isAndroid&&o.isMobileNative;r&&a?this.updateKeyboardPhaseDebounced(t,n):this.setState({...this.state,phase:t,estimatedKeyboardWebViewOverlap:n})},this.updateShouldResizeWebview=function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v2";const{mobileNative:i}=t;switch(o){case"v1":const t=null==i?void 0:i.api.setShouldResizeWebView;t&&t(n);break;case"v2":const o=null==i?void 0:i.api.setShouldResizeWebViewV2;(0,r.Y)("supportsWebViewResizingOnSelection")&&o&&(e.setState({...e.state,shouldResizeWebView:n}),o(n).then((t=>{t.length>0&&e.setState({...e.state,shouldResizeWebView:t[0]})})))}},this.mobileNativeBottomPadding=e=>this.estimatedNativeWebBottomOverlapInternal(e),this.estimatedNativeWebBottomOverlap=()=>this.estimatedNativeWebBottomOverlapInternal(void 0),this.estimatedNativeWebBottomOverlapInternal=e=>{const t=(null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0;if((0,r.Y)("supportsNativeBottomBarOverlappingWebView")){const n=a.Z.hasOpenMobileSlideUps()?t:t+48;return Math.max(this.estimatedKeyboardWebViewOverlap(e),n)}return this.estimatedKeyboardWebViewOverlap(e)},this.estimatedKeyboardWebViewOverlap=e=>{let t;return t=(0,r.Y)("supportsFixedSizeWebView")?(0,r.Y)("supportsWebViewResizingOnSelection")&&this.state.shouldResizeWebView?0:this.state.estimatedKeyboardWebViewOverlap:0,t>0?t:(null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0}}getInitialState(){return{phase:s.hidden,estimatedKeyboardWebViewOverlap:0,shouldResizeWebView:!1}}async onShow(e){await this.waitUntil((()=>this.state.phase===s.shown)),e()}async onHide(e){await this.waitUntil((()=>this.state.phase===s.hidden)),e()}}const c=new l},17294:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},42330:(e,t,n)=>{n.d(t,{ZP:()=>s,o1:()=>i,rJ:()=>a});var o=n(49085);const i=["page","space","team","space-private-pages"];class r extends o.default{getInitialState(){return{isOpen:!1,lastPageId:void 0}}getVariant(){if(this.state.isOpen)return this.state.variant}getTargetsDatabaseType(){if(this.state.isOpen)return a(this.state.targets)}}function a(e){var t;if(0===e.length)return;const n=null===(t=e[0].getAssociatedCollectionStore())||void 0===t?void 0:t.getDatabaseType();if(n){for(const t of e){var o;if(n!==(null===(o=t.getAssociatedCollectionStore())||void 0===o?void 0:o.getDatabaseType()))return}return n}}const s=new r},53730:(e,t,n)=>{n.r(t),n.d(t,{TEST_ONLY__setTransactionQueue:()=>oe,isIndexedDbGracefulFallbackToInMemoryEnabled:()=>X,setupTransactionQueue:()=>ne,transactionQueue:()=>te});n(57658),n(21703);var o=n(36769),i=n(7406),r=n(68626),a=n(72126),s=n(91155),l=n(29477),c=n(4615),d=n(63143),u=n(482),p=n(97880),m=n(99757),f=n(21830);const g="Transaction",h="bySessionId",v="byTimestamp",b="byId",y="byUserId",_="Session",S="bySessionId",w="byUpdatedAt",k="byOwnerSessionId";const I=45*d.C0;class x{constructor(e,t){this.db=void 0,this.debugLogger=void 0,this.runOptimizedScans=!0,this.activeTasks=new Map,this.ownedSessionIds=new Set,this.db=new f.pz(t,"TransactionStore",2,{upgrade(e,t,n,o){if(t<1&&function(e){const t=e.createObjectStore(_,{keyPath:p.MN("index"),autoIncrement:!0});t.createIndex(w,p.MN("updatedAt"),{unique:!1}),t.createIndex(k,p.MN("ownerSessionId"),{unique:!1}),t.createIndex(S,p.MN("sessionId"),{unique:!0});const n=e.createObjectStore(g,{keyPath:p.MN("index"),autoIncrement:!0});n.createIndex(v,p.MN("timestamp"),{unique:!1}),n.createIndex(h,[p.MN("sessionId"),p.MN("timestamp")],{unique:!1}),n.createIndex(b,p.MN("id"),{unique:!0})}(e),t<2){o.objectStore(g).createIndex(y,p.MN("userId"))}}}),this.debugLogger=e,this.runOptimizedScans=!t.device.isEdgeHTML}async DEV_ONLY_deadlockDb(e){throw new Error("This function is only available in development builds.")}async heartbeat(e){const{currentSessionId:t,isActive:n,timeoutMs:o}=e,i=n?[_,g]:[_],a=await this.db.startTransaction({storeNames:i,mode:"readwrite",name:"IndexedDBTransactionStore.heartbeat",timeoutMs:o},(async(e,o)=>{const i=new Set,a=e.objectStore(_);let l=await a.index(k).openCursor(t);o("Obtained session cursor.");let c=0;for(;l;){c+=1;const e=l.value;e.sessionId!==t&&i.add(e.sessionId);const n={...e,updatedAt:Date.now()};l.update(n),l=await l.continue()}if(o(`Finished processing ${c} sessions.`),n){const t=e.objectStore(g).index(b),n=Date.now()-I;o(`Processing ${this.activeTasks.size} active tasks.`),this.activeTasks.forEach((async e=>{if(e.timestamp>=n)return;if(!(await t.get(e.id))){if(e.callback)try{e.callback(void 0)}catch(o){this.debugLogger.flush(),r.log({level:"error",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollectCleanupError",error:(0,s.Ui)(o)})}this.debugLogger.flush(),r.log({level:"warning",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollect",data:{miscDataToConvertToString:{task:e,expireTime:n}}}),this.activeTasks.delete(e.id)}}))}return{value:i}}));return a.error?a:(this.ownedSessionIds=a.value,{value:void 0})}async claimSessions(e){const{currentSessionId:t,staleSessionTimeoutMs:n,transactionTimeoutMs:o}=e,i=await this.db.startTransaction({storeNames:[_],mode:"readwrite",name:"IndexedDBTransactionStore.claimSessions",timeoutMs:o},(async(e,o)=>{const i=[],r=e.objectStore(_);let a=await r.index(w).openCursor(IDBKeyRange.upperBound(n));for(o("Obtained session cursor.");a;){const e=a.value,n={...e,ownerSessionId:t,updatedAt:Date.now()};i.push(e.sessionId),o(`Taking ownership of session ${e.sessionId}.`);const r=Date.now()-e.updatedAt;this.debugLogger.log({from:"IndexedDBTransactionStore",level:"debug",type:"claimSession",data:{message:`claimed ${e.sessionId} updated ${r}ms ago`,sessionId:e.sessionId,sinceLastUpdate:r}}),a.update(n),a=await a.continue()}return{value:i}}));if(i.error)return i;for(const r of i.value)this.ownedSessionIds.add(r);return{value:void 0}}getTasks(e,t){return this.db.startTransaction({storeNames:[_,g],mode:"readonly",name:"IndexedDBTransactionStore.getTasks",timeoutMs:void 0},(async(n,o)=>{let i;const r=[],a=n.objectStore(_);let s=await a.index(k).openCursor(e);for(o("Obtained session cursor.");s;){const e=s.value;r.push(e),s=await s.continue()}if(o(`Found ${r.length} owned sessions.`),0===r.length)return{value:void 0};r.sort(((e,t)=>e.index-t.index));const l=r[0].sessionId,c=[];let d=await this.createTransactionCursor(n,l);for(;d;){const e=d.value;(0,u.d)(e.operations);const t=this.activeTasks.get(e.id);e.sessionId===l&&c.push({...e,callback:t&&t.callback}),d=await d.continue()}return o(`Found ${c.length} tasks.`),i={sessionId:l,tasks:c},t?i.tasks.sort(((e,t)=>e.index&&t.index?e.index-t.index:e.timestamp-t.timestamp)):i.tasks.sort(((e,t)=>e.timestamp-t.timestamp)),{value:i}}))}saveTask(e,t,n){const o={id:t.id,userId:t.userId,spaceId:t.spaceId,sessionId:e,timestamp:t.timestamp,debug:t.debug,operations:t.operations,useSudoMode:t.useSudoMode};return m.Z.setOrIncTotal(this.activeTasks.size+1),this.activeTasks.set(o.id,t),this.db.startTransaction({storeNames:[_,g],mode:"readwrite",name:"IndexedDBTransactionStore.saveTask",timeoutMs:n},(async(t,n)=>{const r=t.objectStore(_),a=await r.index(S).get(e);if(n("Obtained session cursor."),!a){const t={sessionId:e,updatedAt:Date.now(),ownerSessionId:e};n(`Adding session ${t.sessionId}.`);try{await r.add(t)}catch(s){throw(0,f.XH)((0,i.tg)(s),`session ${t.sessionId}`)}}try{await t.objectStore(g).add(o)}catch(s){throw(0,f.XH)((0,i.tg)(s),`task ${o.id}`)}return this.debugLogger.log({from:"IndexedDBTransactionStore",type:"saveTask",level:"debug",data:{message:`create task ${o.id} in ${a?"existing":"NEW"} session ${e}`,sessionId:e,taskId:o.id,isNewSession:!Boolean(a)}}),{value:void 0}}))}async deleteSession(e){const{currentSessionId:t,sessionId:n}=e,o=await this.db.startTransaction({storeNames:[_,g],mode:"readwrite",name:"IndexedDBTransactionStore.deleteSession",timeoutMs:void 0},(async(e,o)=>{let i=await this.createTransactionCursor(e,n);for(o("Obtained transaction cursor.");i;){if(i.value.sessionId===n)return{value:`Attempt to delete non-empty session: has task ${i.value.id}`,abort:!0};i=await i.continue()}const r=e.objectStore(_),a=await r.index(S).get(n);if(!a)return{value:"Session is missing",abort:!0};const s=a;return s.ownerSessionId!==t?{value:`Attempt to delete another tab's session: owned by ${s.ownerSessionId}`,abort:!0}:(r.delete(s.index),{value:void 0})}));return o.error?o:o.value?{error:{type:"LogicalError",message:o.value,userDetails:"Could not perform an operation due to a logical error."}}:{value:void 0}}hasTasks(){return this.activeTasks.size>0||this.ownedSessionIds.size>0}getTotalNumberOfTasks(e){return this.db.startTransaction({storeNames:[g],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasks",timeoutMs:e},(async e=>{const t=e.objectStore(g);return{value:await t.count()}}))}getTotalNumberOfTasksForUser(e,t){return this.db.startTransaction({storeNames:[g],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasksForUser",timeoutMs:t},(async t=>{const n=t.objectStore(g).index(y);return{value:await n.count(e)}}))}async anySessionHasTasks(e){const t=await this.getTotalNumberOfTasks(e);return t.error?t:{value:t.value>0}}async hasTasksForUser(e,t){const n=await this.getTotalNumberOfTasksForUser(e,t);return n.error?n:{value:n.value>0}}hasTask(e){for(const[,t]of this.activeTasks)if(e(t))return!0;return!1}async deleteTasks(e){const t=await this.db.startTransaction({storeNames:[g,_],mode:"readwrite",name:"IndexedDBTransactionStore.deleteTasks",timeoutMs:void 0},(async(t,n)=>{const o=[],i=[],a=new Set,s=t.objectStore(g),l=s.index(b),c=t.objectStore(_);await(0,f.qv)(e.map((0,f.zp)((async e=>{o.push(e.id);const t=await l.openCursor(e.id);if(n(`Obtained transaction cursor for task ${e.id}.`),t){a.add(t.value.sessionId),await t.delete(),n(`Deleted task ${e.id}.`);const o=String(e.id);this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${e.id}`,taskId:o}})}else this.debugLogger.flush(),r.log({from:"IndexedDBTransactionStore",type:"deleteTasksTaskNotExist",level:"warning",data:{message:`could not delete task not stored in indexeddb ${e.id}`,taskId:e.id}})}))));const d=s.index(h);return a.forEach((async e=>{let n=0;if(this.runOptimizedScans)n=await d.count(this.getTransactionRange(e));else{let o=await this.createTransactionCursor(t,e);for(;o;){if(o.value.sessionId===e){n++;break}o=await o.continue()}}if(0===n){const t=await c.index(S).openCursor(e);t&&(i.push(t.value.sessionId),t.delete(),this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteSession",level:"debug",data:{message:`delete empty session ${e}`,sessionId:e}}))}})),{value:{deletedTaskIds:o,deletedSessionIds:i}}}));if(t.error)return t;const{deletedTaskIds:n,deletedSessionIds:o}=t.value;for(const i of n)this.activeTasks.delete(i);for(const i of o)this.ownedSessionIds.delete(i);return m.Z.updateRemaining(this.activeTasks.size),{value:void 0}}async checkObjectStores(){const e="IndexedDBTransactionStore.checkObjectStores",t=this.db.startTransaction({storeNames:["Session"],mode:"readonly",name:`${e}: read from Session object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),n=this.db.startTransaction({storeNames:["Transaction"],mode:"readonly",name:`${e}: read from Transaction object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),[o,i]=await Promise.all([t,n]);return{session:o,transaction:i}}async reset(){await this.db.reset(),this.activeTasks.clear(),this.ownedSessionIds.clear(),m.Z.updateRemaining(0)}async clearTasksForUser(e){const t=await this.db.startTransaction({storeNames:[g],mode:"readwrite",name:"IndexedDBTransactionStore.clearTasksForUser",timeoutMs:void 0},(async(t,n)=>{const o=[],i=t.objectStore(g);let r=await i.index(y).openCursor(IDBKeyRange.only(e));for(n("Obtained transaction cursor.");r;)o.push(r.value.id),await r.delete(),r=await r.continue();return{value:{deletedTaskIds:o}}}));if(t.error)return t;const{deletedTaskIds:n}=t.value;for(const o of n)this.activeTasks.delete(o);m.Z.updateRemaining(this.activeTasks.size)}getTransactionRange(e){return IDBKeyRange.bound([e,0],[e,Number.MAX_VALUE],!0,!0)}createTransactionCursor(e,t){const n=e.objectStore("Transaction");return this.runOptimizedScans?n.index(h).openCursor(this.getTransactionRange(t),"next"):n.openCursor()}}var C=n(15517),T=n(97448),M=n(54064),P=n(606),A=n(12139),R=n(63037),D=n(88632),B=n(26634),E=n(35092),F=n(24681);const Z="NativeBackedTransactionQueue";class V{constructor(e,t,n){this.lastTaskTimestamp=0,this.tasks=new Map,this.sessionId="00000000-0000-0000-0000-000000000000",this.events=new M.Z,this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new r.BatchedLogger({from:Z,type:"BulkDebug",level:"info",maxLength:250}),this.connection=e,this.dependencies=t,r.log({from:Z,level:"debug",type:"NativeBackedTransactionQueueCreated"}),n.subscribeToUpdateTransactionState((e=>this.updateTransactionState(e)))}async enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;var n;(this.tasks.set(e.id,{...e,sessionId:this.sessionId}),this.hasTooManyOperations(e))&&r.log({from:Z,type:"enqueueTask",level:"warning",data:{message:`enqueing task with operation count > ${V.operationCountWarningThreshold}`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(n=e.debug)||void 0===n?void 0:n.userAction,miscDataToConvertToString:{operationsCount:e.operations.length}}});const o=JSON.stringify(e.operations).length;var i;this.stringifiedOperationSizeIsTooLarge(o)&&r.log({from:Z,type:"enqueueTask",level:"warning",data:{message:`enqueing task with stringified operation count > ${V.stringifiedOperationSizeByteThreshold} bytes`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(i=e.debug)||void 0===i?void 0:i.userAction,miscDataToConvertToString:{operationsCount:e.operations.length,stringifiedOperationsSize:o}}});await async function(e,t){await F.v`
		INSERT OR REPLACE INTO transactions (
		    id,
		    user_id,
		    space_id,
		    operations,
		    timestamp,
			debug
		)
		VALUES (
		    ${t.id},
		    ${t.userId||null},
		    ${t.spaceId||null},
		    ${JSON.stringify(t.operations)},
		    ${t.timestamp},
			${t.debug?JSON.stringify(t.debug):null}
		)
	`.run(e)}(this.connection,e),this.debugLogger.log({from:Z,type:"enqueueTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}})}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}unpause(){}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return await async function(e,t){return(await(0,E.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions WHERE user_id = ?",args:[t]}))[0].count}(this.connection,e)>0}async getTotalNumberOfTasks(){return await async function(e){return(await(0,E.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions"}))[0].count}(this.connection)}async anySessionHasTasks(){return await this.getTotalNumberOfTasks()>0}async reset(){await async function(e){await F.v`DELETE FROM transactions`.run(e)}(this.connection),this.tasks.clear()}async clearForUser(e){const t=await async function(e,t){const[n]=await(0,E.G$)({connection:e,statements:[{sql:"SELECT * FROM transactions WHERE user_id = ?",args:[t],getData:!0},{sql:"DELETE FROM transactions WHERE user_id = ?",args:[t]}],queryName:"deleteTransactionsForUser"});return n.data.map((e=>e.id))}(this.connection,e);for(const n of t)this.tasks.delete(n)}updateDependencies(e){this.dependencies=e}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}hasTooManyOperations(e){return e.operations.length>=V.operationCountWarningThreshold}stringifiedOperationSizeIsTooLarge(e){return e>=V.stringifiedOperationSizeByteThreshold}async drain(){return this.tasks.size>0?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();e>V.transactionSizeHealthcheckThreshold&&(this.debugLogger.flush(),r.log({level:"info",from:"NativeBackedSqliteTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck({queue_type:"NativeBackedSqliteTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:D.Z.state.online,retry_reasons:this.retryReasonCounters}))}catch(e){this.debugLogger.flush(),r.log({level:"error",from:"NativeBackedSqliteTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(V.healthcheckInterval,this.dependencies.timeSource)}}updateTransactionState(e){(e.syncing||this.hasTasks())&&D.Z.setState({...D.Z.state,syncing:!0});let t=[],n=[];if(e.saveTransactionResult)if(e.saveTransactionResult.error){const{retryReason:o}=e.saveTransactionResult.error;o?(0,R.Os)(this.retryReasonCounters,o):this.retryReasonCounters={_total:0},t=e.saveTransactionResult.error.savedTasks.map((e=>this.tasks.get(e.id))).filter(p.$K),n=e.saveTransactionResult.error.failedTasks.map((e=>this.tasks.get(e.id))).filter(p.$K),(0,B.o)({backoffEstimate:void 0,retryReason:o})}else this.retryReasonCounters={_total:0},t=e.saveTransactionResult.value.map((e=>this.tasks.get(e.id))).filter(p.$K),n=[],(0,B.Om)();t.forEach((e=>{if(e.callback)try{e.callback(void 0)}catch(t){this.debugLogger.flush(),r.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateSavedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id)})),n.forEach((e=>{if(e.callback)try{e.callback(new Error(`Failed to save transaction with id: ${e.id}`))}catch(t){this.debugLogger.flush(),r.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateFailedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id),this.dependencies.rollbackTask(e)})),e.syncing||this.hasTasks()||(D.Z.setState({...D.Z.state,syncing:!1}),this.events.emit("drain"))}}V.healthcheckInterval=5*d.hM,V.transactionSizeHealthcheckThreshold=1e3,V.operationCountWarningThreshold=500,V.stringifiedOperationSizeByteThreshold=1e5;var j=n(77080),U=n(95424),L=n(82798),O=n(96826);class N{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.indexedDBDrainListener=void 0,this.debugLogger=void 0,this.activeQueue=e,this.inMemoryTransactionQueue=t,this.indexedDBDrainListener=()=>this.handleIndexedDBQueueDrain(),this.debugLogger=new r.BatchedLogger({from:"IndexedDBToInMemoryTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),setTimeout((()=>{this.activeQueue instanceof O.Z&&(this.debugLogger.log({level:"error",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"IndexedDBTransactionQueue has not drained after 5 minutes."}}),this.debugLogger.flush())}),5*d.hM)}startLoop(){if(this.activeQueue instanceof O.Z){this.activeQueue.events.addListener("drain",this.indexedDBDrainListener)}this.activeQueue.startLoop()}handleIndexedDBQueueDrain(){const e=(0,L.R9)(this.activeQueue,O.Z);e.hasAttemptedToClaimSessions()&&(e.stopLoop(),e.events.removeListener("drain",this.indexedDBDrainListener),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,this.debugLogger.log({level:"info",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"Switching over from IndexedDBTransactionQueue to InMemoryTransactionQueue."}}))}logEmptyTaskForDebugging(e){var t,n;null===(t=(n=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(n,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}}var z=n(50619),W=n(2414),q=n(9425);const H="InMemoryTransactionQueue";class K{constructor(e){this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.tasks=new Map,this.events=new M.Z,this.waiter=void 0,this.transactionBackoffController=new W.h(B._W),this.sessionId="00000000-0000-0000-0000-000000000000",this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new r.BatchedLogger({from:H,type:"BulkDebug",level:"info",maxLength:250}),this.dependencies=e}startLoop(){setTimeout((()=>this.txLoop()),1),setTimeout((()=>this.healthcheckLoop()),1)}enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;return this.tasks.set(e.id,{...e,sessionId:this.sessionId}),m.Z.setOrIncTotal(this.tasks.size),this.debugLogger.log({from:H,type:"saveTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}}),this.getWaitable(!1).trigger(),Promise.resolve()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return Promise.resolve(Array.from(this.tasks.values()).some((t=>t.userId===e)))}updateDependencies(e){this.dependencies=e}async getTotalNumberOfTasks(){return Promise.resolve(this.tasks.size)}async anySessionHasTasks(){return Promise.resolve(this.hasTasks())}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}async reset(){return this.tasks=new Map,m.Z.updateRemaining(0),Promise.resolve()}async clearForUser(e){const t=Array.from(this.tasks.values()).filter((t=>t.userId===e));for(const n of t)this.tasks.delete(n.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}async txLoop(){for(;;)try{await this.txLoopIteration()}catch(e){(0,R.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),r.log({level:"error",from:H,type:"txLoopIteration",error:(0,s.Ui)(e)}),A.IE(e),await l.Vs(15e3)}}async txLoopIteration(){const e=this.hasTasks();e||(this.doneSyncing(),this.events.emit("drain"));const[t,n]=(0,q.Z)()?[R.xd,R.CE]:[R.V_,R.Ud];await this.wait(t,e?t:n);const o=Array.from(this.tasks.values()),i=Array.from(o).sort(((e,t)=>e.timestamp-t.timestamp));if(0===i.length)return;const a=[];for(let r=0;r<i.length;r++)i[r]!==o[r]&&a.push(r);a.length>0&&r.log({from:H,level:"warning",type:"TasksNotOrdered",data:{miscDataToConvertToString:{unsortedTaskIds:o.map((e=>e.id)),mismatch:a},taskIds:i.map((e=>e.id))}}),this.startSyncing(),await this.useSaveTransactionsApi(i)}async useSaveTransactionsApi(e){const t=await this.dependencies.handleSaveTransactions(e);if(t.error){const{savedTasks:e,failedTasks:o,message:i,retryDelay:a,retryReason:l}=t.error;var n;if(l?(0,R.Os)(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:H,type:"handlePartialSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),r.log({level:"warning",from:H,type:"handleSaveTransactionsError",data:{message:i,taskIds:o.map((e=>e.id))},error:(0,s.Ui)(t.error)}),await this.cleanupTasks(o,t.error)):this.debugLogger.log({level:"debug",from:H,type:"handleSaveTransactionsRetryableError",data:{message:i}}),a>0)await this.transactionBackoffController.backOffOnFailure(a-R.V_,null===(n=t.error)||void 0===n?void 0:n.retryReason);else this.transactionBackoffController.reset()}else{const e=t.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:H,type:"handleSaveTransactionsSuccess",data:{message:`will clean up ${e.length} submitted tasks`,taskIds:e.map((e=>e.id))}}),this.transactionBackoffController.reset(),await this.cleanupTasks(e,void 0)}}async cleanupTasks(e,t){for(const o of e)if(o.callback)try{o.callback(t)}catch(n){this.debugLogger.flush(),r.log({level:"error",from:"InMemoryTransactionQueue",type:"cleanupTask",data:{taskId:o.id},error:(0,s.Ui)(n)})}for(const o of e)this.debugLogger.log({from:H,type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${o.id}`,taskId:o.id}}),this.tasks.delete(o.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6),this.waiter}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}startSyncing(){D.Z.setState({...D.Z.state,syncing:!0})}doneSyncing(){D.Z.setState({...D.Z.state,syncing:!1})}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();if(e>K.transactionSizeHealthcheckThreshold){const t={queue_type:"InMemoryTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:D.Z.state.online,retry_reasons:this.retryReasonCounters};this.debugLogger.flush(),r.log({level:"info",from:"InMemoryTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck(t)}}catch(e){this.debugLogger.flush(),r.log({level:"error",from:"InMemoryTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(K.healthcheckInterval)}}}K.healthcheckInterval=15*d.hM,K.transactionSizeHealthcheckThreshold=1e3;const G=K;var $=n(68026);const Q="FeatureFlagTransactionQueue",Y="00000000-0000-0000-0000-000000000000";async function J(e){if(!window.indexedDB)return{available:!1,message:"The IndexedDB API is missing or disabled on this platform."};if(e.device.isFirefox){const e="FirefoxFeatureCheck";if(!(await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}}))))return{available:!1,message:"IndexedDB is disabled in Firefox Private Browsing."}}if(e.device.isChrome&&parseInt(e.device.browserVersion,10)>=99){const e="Chrome99FeatureCheck";let n=!1;try{if(n=await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}})),!n)return{available:!1,message:"IndexedDB is unstable in Chrome 99."}}catch(t){return{available:!1,message:(0,i.tg)(t).message}}}return X()&&U.H.hasOccurredRecently()?{available:!1,message:"A NotionTransactionTimeout has happened recently, avoiding use of IndexedDB.",previousTimeouts:U.H.getTotal()}:{available:!0}}const X=a.HP((()=>"on"===(0,T.fastGetGroup)("indexeddb_graceful_fallback_to_in_memory_queue")));async function ee(e){const t=new $.TransactionQueueDependenciesImpl(e);async function n(){const n=await J(e);if(!n.available)return r.log({from:Q,level:"warning",type:"preferIndexedDBUnavailable",data:{previousTimeouts:n.previousTimeouts,miscDataToConvertToString:{message:n.message,userAgent:navigator.userAgent}}}),o();r.log({from:Q,type:"preferIndexedDB",level:"info"});const i=function(e,t){const n="react-native"===e.device.platform?Y:(0,c.ZP)(),o=new r.BatchedLogger({from:"IndexedDBTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),i=new x(o,e);return new O.Z({dependencies:t,transactionStore:i,sessionId:n,debugLogger:o,enableHeartbeatTimeout:X()})}(e,t),l=await(0,C.sK)();if(l&&!(0,C.mn)(l)){let e=!1;try{e=await i.anySessionHasTasks(),r.log({from:Q,type:"indexedDBStorageVeryFull",level:"warning",data:{storage:{hasTasks:e,...l}}})}catch(d){r.log({from:Q,level:"error",type:"indexedDBStorageReadError",data:{storage:l},error:(0,s.Ui)(d)})}if(!e)return new G(t)}if(e.device.isFirefox)try{const e=await i.checkObjectStores(),n=a.oA([e.transaction,e.session].map((e=>e.error)));if(n.length>0){const o=[];return e.transaction.error&&o.push("Transaction"),e.session.error&&o.push("Session"),r.log({from:Q,level:"error",type:"FirefoxHealthCheckFailed",error:{miscErrorString:(0,s.LK)(n)},data:{message:`Can't read ${o}. Using InMemoryTransactionQueue instead.`}}),new G(t)}}catch(d){return r.log({from:Q,level:"error",type:"indexedDBHealthCheckError",error:(0,s.Ui)(d)}),new G(t)}return X()?(i.events.addListener("timeout",(()=>{U.H.trackPersistently()})),new z.Z(i,new G(t))):i}function o(){return r.log({from:Q,type:"preferInMemory",level:"info"}),new G(t)}const{device:i,mobileNative:u}=e;if(i.isBrowser&&i.isDesktop){if(i.isChrome||i.isFirefox)return n();if(i.isSafari){if(parseInt(i.browserVersion,10)<17)return n();const e=(0,T.fastGetGroup)("safari_17_transaction_queue")??j.default.getGroup("safari_17_transaction_queue");if("force_in_memory"===e)return r.log({from:Q,type:"Safari17.forceInMemoryTransactionQueue",level:"info"}),o();const t=await n();if(t instanceof O.Z){if("prefer_indexed_db"===e)return r.log({from:Q,type:"Safari17.usingIndexedDBTransactionQueue",level:"info"}),t;if((await l.OI(15*d.C0,[t.anySessionHasTasks()])).result)return r.log({from:Q,type:"Safari17.usingIndexedDBToInMemoryTransactionQueue",level:"info"}),new N(t,o())}return r.log({from:Q,type:"Safari17.usingInMemoryTransactionQueue",level:"info"}),o()}return o()}return i.isBrowser&&i.isMobile?o():i.isElectron?n():i.isMobileNative&&u&&u.sqliteConnection?new V(u.sqliteConnection,t,u):o()}(0,o.exposeDebugEnvironmentValue)("getIndexedDBAvailability",(e=>()=>J(e)));let te=new class{constructor(e,t){this.getActiveQueueName=void 0,this.queues=void 0,this.createQueues=void 0,this.getActiveQueueName=e,this.createQueues=t}getQueues(){const e=this.queues?this.queues:this.createQueues();return this.queues=e,e}applyToAllQueues(e){return Object.values(this.getQueues()).map(e)}applyToActiveQueue(e){return e(this.getQueues()[this.getActiveQueueName()])}startLoop(){this.applyToAllQueues((e=>e.startLoop()))}enqueueTask(e){return this.applyToActiveQueue((t=>t.enqueueTask(e)))}unpause(){this.applyToAllQueues((e=>e.unpause()))}pause(){this.applyToAllQueues((e=>e.pause()))}getLastTaskTimestamp(){return this.applyToActiveQueue((e=>e.getLastTaskTimestamp()))}hasTasks(){return this.applyToAllQueues((e=>e.hasTasks())).some(Boolean)}async hasTasksForUser(e){return(await Promise.all(this.applyToAllQueues((t=>t.hasTasksForUser(e))))).some((e=>e))}updateDependencies(e){this.applyToAllQueues((t=>t.updateDependencies(e)))}async anySessionHasTasks(){for(const e of this.applyToAllQueues((e=>e.anySessionHasTasks())))if(await e)return!0;return!1}async getTotalNumberOfTasks(){return a.Sm(await Promise.all(this.applyToAllQueues((e=>e.getTotalNumberOfTasks()))))}async drain(){await Promise.all(this.applyToAllQueues((e=>e.drain())))}awaitRecordTransaction(e){return this.applyToActiveQueue((t=>t.awaitRecordTransaction(e)))}isPendingTransactionForRecord(e){return this.applyToAllQueues((t=>t.isPendingTransactionForRecord(e))).some(Boolean)}async reset(){await Promise.all(this.applyToAllQueues((e=>e.reset())))}async clearForUser(e){await Promise.all(this.applyToAllQueues((t=>t.clearForUser(e))))}}((()=>"error"),(()=>{throw new Error("Need to await setupTransactionQueue")}));const ne=async e=>(te=await ee(e),te),oe=e=>{te=e}},66353:(e,t,n)=>{n.d(t,{RJ:()=>s,Rx:()=>a,Ve:()=>c,ZP:()=>p,fK:()=>r,uZ:()=>l});var o=n(49085),i=n(54153);const r=320,a=470,s=390,l="unread_and_read",c={filter:l,width:s},d="notification_inbox_panel";const u=o.default.createValue(function(){const e=i.Z.get(d);return{...c,...e}}());u.addListener((e=>{try{t=e.state,i.Z.set(d,t)}catch{}var t}));const p=u},45325:(e,t,n)=>{n.r(t),n.d(t,{NotificationInboxFilterOptions:()=>r,default:()=>s});var o=n(49085),i=n(97880);const r=["unread_and_read","unread_only","archived_only","all_updates"];class a extends o.default{getInitialState(){return{openState:"closed",isResizerHovered:!1,isResizing:!1,discussionIdToExpansionStartPointMap:{}}}isOpen(){const{openState:e}=this.state;switch(e){case"open":case"opening":return!0;case"closed":case"closing":return!1;default:(0,i.t1)(e)}}isTransitioningOpenState(){const{openState:e}=this.state;switch(e){case"opening":case"closing":return!0;case"open":case"closed":return!1;default:(0,i.t1)(e)}}}const s=new a},45946:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(53809),i=n(30548);const r=new o.D({key:"openInDesktopApp",namespace:i.$p,important:!0,trackingType:"necessary"})},64970:(e,t,n)=>{n.d(t,{m:()=>o});const o=n(49085).default.createValue(!1)},70704:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isHidden:!1}}}const r=i},79689:(e,t,n)=>{n.d(t,{L:()=>r,c:()=>a});var o=n(49085);const i=new Map;function r(e){const t="shared"===e.type?e.type:`${e.type}${e.teamId}${e.teamOutlinerType}`,n=i.get(t);if(n)return n;{const e=o.default.createValue(!1);return i.set(t,e),e}}function a(){const e=Array.from(i.entries());return 0===e.length||e.every((e=>!e[1].state))}},19671:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},93220:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{ready:!1,initialRequestCompleted:!1,loading:!1,endOfResultsReached:!1,error:void 0,currentCursor:void 0,currentChunkNumber:void 0}}}const r=i},85526:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{forceShowProperties:!1}}}const r=new i},94896:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pages:new Set}}setStatus(e,t){t?this.state.pages.add(e):this.state.pages.delete(e),this.emit()}}const r=new i},82136:(e,t,n)=>{n.d(t,{S:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e[e.Frame=0]="Frame",e[e.PeekView=1]="PeekView",e[e.InAppTemplatePreview=2]="InAppTemplatePreview",e[e.InPageSnapShot=3]="InPageSnapShot",e[e.CollectionPageView=4]="CollectionPageView",e}({});class r extends o.default{getInitialState(){return{forceDiscussionOpen:!1}}}const a=r},85844:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isVisible:!0}}}const r=new i},72014:(e,t,n)=>{n.d(t,{$g:()=>a,jx:()=>s});var o=n(49085),i=n(4615);class r extends o.default{getInitialState(){}initializeNewPageVisitId(){this.setState((0,i.ZP)())}getCurrentPageVisitId(){return this.getState()}}const a=new r,s=new r},30539:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageId:void 0,lastViewTime:void 0,lastExitTime:void 0,omittedUserIds:[]}}}const r=i},69503:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,hasPassword:!1}}isSetNewPasswordModal(){const e=this.state;return!0===e.setNewPassword&&!1===e.isSet}isPasswordSetModal(){const e=this.state;return!0===e.setNewPassword&&!0===e.isSet}isRemovePasswordModal(){const e=this.state;return!0===e.removePassword&&!1===e.isSuccess}isRemovePasswordSuccessModal(){const e=this.state;return!0===e.removePassword&&!0===e.isSuccess}isVerifyIdentityWithMfaModal(){return!0===this.state.verifyIdentity}isPasswordModalClosed(){return!this.state.open}}const r=new i},91551:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},13023:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},88923:(e,t,n)=>{n.r(t),n.d(t,{CenterPeekModeOuterWidth:()=>c,PeekModeCenter:()=>r,PeekModeOuterPadding:()=>l,PeekModePadding:()=>s,PeekModeSide:()=>a,default:()=>v,getPeekModeFromCollectionPeekModeFormat:()=>u,getPeekModeFromUrlParam:()=>d,getUrlParamFromPeekMode:()=>p,sidePeekInitialMaxWidth:()=>m,sidePeekMinWidth:()=>g,sidePeekNoColumnWidth:()=>f});var o=n(14577),i=n(49085);const r="center_peek",a="side_peek",s={horizontal:{center_peek:126,side_peek:48}},l=72,c=708+2*s.horizontal[r];function d(e){switch(e){case"s":return a;case"c":return r}}function u(e){switch(e){case"side_peek":return a;case"center_peek":return r}}function p(e){switch(e){case a:return"s";case r:return"c"}}const m=980,f=640,g=430;class h extends i.default{constructor(){super(...arguments),this.isSidePeekOpening=new o.Z((()=>this.state.open&&this.isSidePeekOpen()&&this.state.isOpening),{debugName:"isSidePeekOpening"}),this.isSidePeekClosing=new o.Z((()=>this.state.open&&this.state.isClosing),{debugName:"isSidePeekClosing"}),this.peekTarget=new o.Z((()=>this.state.open?this.state.target:void 0),{debugName:"peekTarget"})}getInitialState(){return{open:!1,mode:r,preferredSidePeekWidth:0,savedSidebarExpandedStoreState:!1}}getCollectionModeFormat(){switch(this.state.mode){case a:return"side_peek";case r:return"center_peek"}}getPeekMode(){return this.state.open?this.state.mode:a}getPeekModeWidth(e){return this.isCenterPeekOpen()?c:this.getSidePeekWidth(e)}getSidePeekWidth(e){const t=Math.min(e/2,m),n=this.state.preferredSidePeekWidth||t;return Math.min(Math.max(n,g),e)}setSidePeekWidth(e,t){const n=Math.min(Math.max(e,g),t);this.setState({...this.state,preferredSidePeekWidth:n})}isCenterPeekOpen(){return this.state.open&&this.state.mode===r}isSidePeekOpen(){return this.state.open&&this.state.mode===a&&!this.state.isClosing}setSidebarExpandedStoreState(e){this.setState({...this.state,savedSidebarExpandedStoreState:e})}}const v=new h},98452:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},99332:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},24612:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},42057:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(92595),i=n(45589);const r=(0,o.exposeDebugValue)("PeekViewScrollerStore",new i.Z)},29677:(e,t,n)=>{n.d(t,{Db:()=>a,cl:()=>i,fZ:()=>o,ow:()=>r});n(49085),n(21202);function o(e){return"existingUser"===e.type}function i(e){return"newUser"===e.type}function r(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function a(e){return e.inviteTargets.every((e=>"existingUser"===e.type||"newUser"===e.type||"group"===e.type))}},31194:(e,t,n)=>{n.d(t,{FJ:()=>m,Iw:()=>u,ZP:()=>g,lU:()=>p});var o=n(49085),i=n(4023),r=n(15723);const{Top:a,Bottom:s,Left:l,Right:c,Center:d}=i.u,u=i.u,p=i.v,m=e=>{switch(e){case a:return s;case s:return a;case l:return c;case c:return l;case d:return d}};class f extends o.default{getInitialState(){return{open:!1,placementFlipped:!1,offsetX:0,offsetY:0,originRect:r.bM}}}const g=f},89523:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1,userId:void 0}}isReady(){return Boolean(this.state.remotePresenceData)}}const r=i},24864:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(70704).Z)},83212:(e,t,n)=>{n.d(t,{Z:()=>l,m:()=>a});var o=n(49085),i=n(72141),r=n(67669);const a={disabled:{hasPublicPermission:!1},view:{hasPublicPermission:!0,permission:"view"},comment:{hasPublicPermission:!0,permission:"comment"},edit:{hasPublicPermission:!0,permission:"edit"}};Object.freeze(a),Object.freeze(a.disabled),Object.freeze(a.view),Object.freeze(a.comment),Object.freeze(a.edit);class s extends o.default{getInitialState(){return{editing:!1,commenting:!1}}getMode(e,t){const n=this.getModeType(e,t)||"disabled";return a[n]}getModeType(e,t){if(!t.isDefaultRecordCache()||!(0,r.IJ)(e,t))return;const n=t.getRole(),o=!n||(0,i.J5)(n),a=!n||(0,i.RF)(n),s=e.currentUser.isLoggedIn();return o&&s&&this.state.editing?"edit":a&&s?"comment":"view"}}const l=new s},81236:(e,t,n)=>{n.d(t,{Z:()=>l});n(84633);var o=n(49085),i=n(92595),r=n(15157);class a extends o.default{constructor(){var e;super(...arguments),e=this,this.fetchSpaceIds=new Set,this.fetchedSpaceIds=new Set,this.fetch=async function(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=await Promise.resolve().then(n.bind(n,54642)),a=t.currentUser.id,s=Array.from(e.fetchSpaceIds.values());try{if(s.length>0){if(!o){for(const t of s){const n=r.Z.get({userId:a,key:e.getLocalKey(t)});n&&(e.setPublicSpaceData(t,n),e.fetchSpaceIds.delete(t),e.fetchedSpaceIds.add(t))}e.setState({...e.state,fetching:!1})}const n=await i.getPublicSpaceData(t,{type:"space-ids",spaceIds:s});"success"===n.type&&n.data.results.forEach(((t,n)=>{if(t){const o=s[n];e.setPublicSpaceData(o,t),r.Z.set({userId:a,key:e.getLocalKey(o),value:t}),e.fetchSpaceIds.delete(o),e.fetchedSpaceIds.add(o)}}))}}finally{e.setState({...e.state,fetching:!1})}}}getInitialState(){return{publicSpaceDataMap:{},fetching:!1}}getPublicSpaceData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n&&(this.fetchSpaceIds.delete(t),this.fetchedSpaceIds.delete(t)),this.fetchSpaceIds.has(t)||this.fetchedSpaceIds.has(t)||(this.fetchSpaceIds.add(t),this.setState({...this.state,fetching:!0}),setImmediate((()=>this.fetch(e,n)))),this.state.publicSpaceDataMap[t]}async awaitPublicSpaceData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getPublicSpaceData(e,t,n),await this.waitUntil((()=>Boolean(this.state.publicSpaceDataMap[t])&&!this.state.fetching)),this.state.publicSpaceDataMap[t]}setPublicSpaceData(e,t){this.state.publicSpaceDataMap[e]=t||null,this.emit()}TEST_ONLY__setPublicSpaceData(e,t){this.fetchedSpaceIds.add(e),this.state.publicSpaceDataMap[e]=t||null,this.emit()}getLocalKey(e){return`${a.localKeyPrefix}:${e}`}}a.localKeyPrefix="PublicSpaceData";const s=new a;i.exposeDebugValue("PublicSpaceDataStore",s);const l=s},69784:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isActive:!1}}}const r=new i},13105:(e,t,n)=>{n.d(t,{P:()=>r});var o=n(14577),i=n(92595);class r{constructor(e){this.memo=new WeakMap,this.debugName=void 0,this.hits=0,this.misses=0,this.getStateFor=e=>this.computeMemo(e),this.computeMemo=e=>{let t=this.memo.get(e);return t?this.hits++:(this.misses++,t=new o.Z((()=>this.options.compute(e,this.options.memoizeRecursion?this.computeMemo:this.computeNonMemo)),{debugName:this.debugName}),this.memo.set(e,t)),t.getState()},this.computeNonMemo=e=>this.options.compute(e,this.computeNonMemo),this.options=e,this.debugName=`RecursiveComputedStore.${e.debugName}`,(0,i.exposeDebugInstance)(this.debugName,this)}}},64951:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.blockStore)}}const r=new i},82187:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.clonedBlockStore)}}const r=new i},72087:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{ready:!1,loading:!1}}}const r=i},91681:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isResizing:!1}}}const r=new i},70354:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u,groupIntervalMs:()=>c});var o=n(49085),i=n(72126),r=n(11799),a=n(97880),s=n(82798);class l{constructor(){this.idMap=new r.Z({getKey:e=>{let{textInstanceId:t,opId:n}=e;return`${t},${n[0]},${n[1]}`}})}remapIdsForReinsertedText(e,t){(0,s.T)(t.args.textInstanceId===e.args.textInstanceId),(0,s.T)(i.Xy(t.args.originId,e.args.originId)),(0,s.T)(t.args.content.length===e.args.deletedIds.length);const n=t.args.id,o=t.args.content;for(let i=0;i<o.length;i++)this.addMapping({textInstanceId:e.args.textInstanceId,opId:e.args.deletedIds[i]},{textInstanceId:t.args.textInstanceId,opId:[n[0],n[1]+i]})}addMapping(e,t){(0,s.T)(!this.idMap.has(e)),(0,s.T)(!this.idMap.has(t)),(0,s.T)(e.textInstanceId===t.textInstanceId,"IDs can only be remapped within the same text instance"),this.idMap.set(e,t)}getMappedId(e){let t,n=e;for(;n=this.idMap.get(n);)t=n;return t}getInvertedTextOperationWithMaybeRemappedIds(e){switch(e.command){case"invertedInsertText":{var t,n;const o=null===(t=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.startId}))||void 0===t?void 0:t.opId,i=null===(n=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.endId}))||void 0===n?void 0:n.opId;return o||i?{...e,args:{...e.args,startId:o??e.args.startId,endId:i??e.args.endId}}:e}case"invertedAddAnnotation":case"invertedRemoveAnnotation":{var o,i;const t=null===(o=this.getMappedId({textInstanceId:e.args.startTextInstanceId,opId:e.args.startId}))||void 0===o?void 0:o.opId,n=null===(i=this.getMappedId({textInstanceId:e.args.endTextInstanceId,opId:e.args.endId}))||void 0===i?void 0:i.opId;if("invertedAddAnnotation"===e.command)return t||n?{...e,args:{...e.args,startId:t??e.args.startId,endId:n??e.args.endId}}:e;if("invertedRemoveAnnotation"===e.command)return t||n?{...e,args:{...e.args,startId:t??e.args.startId,endId:n??e.args.endId}}:e;(0,a.t1)(e);break}case"invertedDeleteText":{var r;const t=null===(r=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.originId}))||void 0===r?void 0:r.opId;return t?{...e,args:{...e.args,originId:t??e.args.originId}}:e}case"invertedMoveTextSlice":return e;default:(0,a.t1)(e)}}}const c=700;class d extends o.default{getInitialState(){return{undoStack:[],redoStack:[],invertedTextOperationIdMapper:new l}}}const u=new d},49557:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{isActive:!1,isAnimatingClosed:!1,top:0,left:0}}}const a=(0,i.exposeDebugValue)("RichTextMenuStore",new r)},4935:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},45589:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isScrolling:!1,scrollTop:0,scrollHeight:0,scrollLeft:0,scrollWidth:0,clientWidth:0}}}const r=i},32470:(e,t,n)=>{n.d(t,{BJ:()=>m,ZP:()=>h,gq:()=>g,lO:()=>f,v_:()=>p});var o=n(49085),i=n(15157),r=n(72126),a=n(53772),s=n(95477);const l="SearchDebugStorePersistenceKey";class c extends o.default{setState(e){super.setState(e),function(e){let{newState:t,key:n}=e;i.Z.set({userId:"global",key:n,value:t})}({newState:e,key:this.getPersistenceKey()})}setStateWithoutPersisting(e){super.setState(e)}reloadFromDisk(){const e=i.Z.get({userId:"global",key:this.getPersistenceKey()});super.setState({...this.getInitialState(),...e})}}class d extends c{constructor(e){super(),this.column=void 0,this.getPersistenceKey=()=>`SearchDebugStorePersistenceKey:${this.column}`,this.updateForcedClusterPattern=e=>{this.setState({...this.state,forcedClusterPattern:e})},this.updateForcedBlockIds=e=>{this.setState({...this.state,forcedBlockIds:e})},this.column=e}getInitialState(){return{forcedClusterPattern:void 0,forcedBlockIds:void 0,searchExperimentOverrides:{},visible:!0}}hasDebugOverrides(){return!r.xb(this.state.forcedClusterPattern)||!r.xb(this.state.searchExperimentOverrides)||!r.xb(this.state.forcedBlockIds)}}const u=new class extends c{constructor(){super(...arguments),this.getPersistenceKey=()=>l}getInitialState(){return{showDebugInfo:!1,debug:void 0}}getDebugLevel(){return this.state.debug??(this.state.showDebugInfo?"explain":void 0)}},p=new d("left"),m=new d("right");function f(){u.reloadFromDisk(),p.reloadFromDisk(),m.reloadFromDisk()}function g(e){let{device:t}=e;return(0,a.x)(s.default)&&!t.isMobile&&(p.hasDebugOverrides()||m.hasDebugOverrides()||p.state.forcedClusterPattern||m.state.forcedClusterPattern)&&m.state.visible}const h=u},55320:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0,isPublicPageSearch:!1,preferSidePeekOpen:!0}}closeAndResetMetricsState(){this.update((e=>({...e,open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0})))}isOpen(){return this.state.open||this.state.openAsPage}}const r=new i},87956:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){}}const r=new i},29026:(e,t,n)=>{n.d(t,{Xv:()=>l,ZP:()=>u});var o=n(49085),i=n(15157),r=n(94804),a=n(92338),s=n(80444);const l=20;let c=function(e){return e.Default="Default",e.Results="Results",e}({});class d extends o.default{constructor(){super(...arguments),this.resetQuery=e=>{let{resetFilters:t}=e;this.setState({...this.state,query:{...this.state.query,text:"",...t&&{filters:(0,a.u4)()}},limit:l,source:"quick_find_input_change"})},this.resetFilters=()=>{this.update((e=>({...e,query:{...e.query,filters:(0,a.u4)()}})))},this.updateFilters=e=>{const t=this.state.query.filters,n=(0,a.jl)(t,e);this.setState({...this.state,query:{...this.state.query,filters:n},limit:l,source:"quick_find_filters"})},this.setIsAnyPopupOpen=e=>{this.update((t=>({...t,isPopupOpen:e})))},this.expandFilterBar=()=>{this.updateFilterBarVisibilityState(!0)},this.collapseFilterBar=()=>{this.updateFilterBarVisibilityState(!1)},this.updateFilterBarVisibilityState=e=>{var t;const n=null===(t=s.default.state.currentUserStore)||void 0===t?void 0:t.id;n&&(i.Z.set({userId:n,key:r.rE,value:e}),this.update((t=>({...t,filterBar:{...t.filterBar,show:e}}))))},this.updateQueryText=e=>{this.setState({...this.state,query:{...this.state.query,text:e},limit:l,source:"quick_find_input_change"})},this.switchToSearchPane=()=>{this.setState({...this.state,mode:"search"})}}getInitialState(){return{mode:"search",isSidePeekPanelOpen:!1,isDebugSidebarOpen:!1,query:{text:"",filters:(0,a.u4)(),sort:{field:"relevance"}},limit:l,source:"quick_find",hasScrolled:!1,filterBar:{order:["titleToggle","personFilter","teamsFilter","pageFilter","dateFilter","dev_notInPageFilter","dev_notInTeamFilter"],show:!0},isPopupOpen:!1}}updateFilterOrder(e){this.setState({...this.state,filterBar:{...this.state.filterBar,order:e}})}hasQuery(){return Boolean(this.state.query.text)}isDebugSidebarOpen(){return this.state.isDebugSidebarOpen}}d.Mode=c;const u=new d},86486:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isOpen:!1}}}const r=new i},50628:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){return{selectableRectMap:new Map,selectableContainerRectMap:new Map,selectableElementRectMap:new Map,lastUpdate:0}}hasBeenUpdatedSince(e){return this.state.lastUpdate>e}}const a=new r;(0,i.exposeDebugValue)("SelectableRectStore",a);const s=a},27724:(e,t,n)=>{n.r(t),n.d(t,{SelectionPhase:()=>c,default:()=>u});var o=n(49085),i=n(97880),r=n(16339),a=n(95802),s=n(88923),l=n(26136);let c=function(e){return e[e.Selected=0]="Selected",e[e.Editing=1]="Editing",e}({});class d extends o.default{getInitialState(){return{stores:[],phase:c.Selected}}cloneState(){return{stores:[...this.state.stores],phase:this.state.phase}}getEditing(){if(this.state.phase===c.Editing)return this.state.stores[0]}isSelected(){return this.state.stores.length>0&&this.state.phase===c.Selected}getNodes(){return this.state.stores.map((e=>a.C.findNodeFromStore(e)||void 0)).filter(i.$K)}getCurrentRootStore(){var e,t;const n=null===(e=this.getCurrentDefaultContainer())||void 0===e?void 0:e.props.store;return n&&n instanceof l.G?n:null===(t=this.getDefaultContainer())||void 0===t||null===(t=t.props)||void 0===t?void 0:t.store}getCurrentRecordCache(){const e=this.getCurrentRootStore();if(e)return e.inMemoryRecordCache}getDefaultContainerFromTarget(e){return r.Z.find((t=>{const n=t.getNode();return Boolean(n&&n.contains(e))}))}getCurrentDefaultContainer(){const e=this.state.anchorContainer;return e||this.getDefaultContainer()}getDefaultContainer(){const e=this.state.defaultContainerStack;if(e&&e.length>0)return e[e.length-1]}isInPeekRenderer(){if(this.state.anchorContainer)return Boolean(this.state.anchorContainer.isPeekRenderer());{var e;const t=Boolean(null===(e=this.state.anchor)||void 0===e?void 0:e.isPageBlock()),n=s.default.state.open&&this.state.anchor===s.default.state.target;return t&&n}}}const u=new d},77794:(e,t,n)=>{n.d(t,{E:()=>a});var o=n(49085),i=n(72126),r=n(15723);class a{constructor(e){this.rect=o.default.createValue(r.bM),this.el=void 0,this.resizeObserver=void 0,this.options=void 0,this.recomputeThrottled=void 0,this.recompute=()=>{var e;const t=(null===(e=this.el)||void 0===e?void 0:e.getBoundingClientRect())??r.bM;return this.rect.setState(t),t},this.options=e||{},this.options.throttleMs&&(this.recomputeThrottled=i.P2(this.recompute,this.options.throttleMs))}observe(e){this.el=e,"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.getRecomputeFn()),this.resizeObserver.observe(this.el)),this.recompute()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect()}getRecomputeFn(){return this.recomputeThrottled||this.recompute}}},10743:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},1310:(e,t,n)=>{n.d(t,{JY:()=>r,Ty:()=>i,ZP:()=>s});var o=n(49085);const i=5e3,r=1e4;class a extends o.default{getInitialState(){return{currentItem:void 0,shouldReset:!0}}}const s=new a},64404:(e,t,n)=>{n.d(t,{Q:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e.Members="members",e.Groups="groups",e.Guests="guests",e.Reprovisioning="reprovisioning",e.Requests="requests",e}({});class r extends o.default{getInitialState(){return{currentTab:i.Members,limitMembers:!0,limitGuests:!0,limitTeamGuests:!0,membersFilter:"",guestsFilter:"",teamGuestsFilter:"",groupsFilter:"",groupNameInputValue:"",upsellModalOpen:!1,sorts:{members:{group:"members",by:"role",asc:!1},guests:void 0,team_guests:void 0}}}}const a=r},92083:(e,t,n)=>{n.d(t,{R:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e[e.OpenInDesktopApp=0]="OpenInDesktopApp",e[e.TwoStepVerification=1]="TwoStepVerification",e}({});class r extends o.default{getInitialState(){return{open:!1,currentTab:"settings",defaultSubtab:void 0,highlightedSetting:void 0,openedFrom:void 0}}}const a=new r},27242:(e,t,n)=>{n.d(t,{U:()=>i,Z:()=>a});var o=n(49085);let i=function(e){return e.CurrentSpace="current-space",e.TargetSpace="domain-claim-upgrade-team-plan-workspace",e}({});class r extends o.default{getInitialState(){return{open:!1,type:i.CurrentSpace}}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}closeWithFailure(){this.setState({open:!1,succeeded:!1})}open(e){const{subscriptionTier:t,addOnFeature:n,billingInterval:o,coupon:r,isTrial:a,sessionId:s}=e;this.setState({open:!0,temporaryBillingInterval:o,temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,subscriptionTier:t,vatApplicable:!1,calculatingTax:!1,payButtonState:"enabled",type:i.CurrentSpace,addOnFeature:n,onlyShowAddOn:void 0!==n,sessionId:s,coupon:r,isTrial:a})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}setValidationErrorState(e,t){const n=this.state;if(!n.open)return;const o=n.validationErrors??{};o[e]=t,this.setState({...n,validationErrors:o})}clearValidationErrorState(e){const t=this.state;t.open&&t.validationErrors&&e in t.validationErrors&&(delete t.validationErrors[e],this.setState({...t}))}}const a=new r},9209:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},99757:(e,t,n)=>{n.d(t,{Z:()=>l,n:()=>s});var o=n(14577),i=n(49085);class r extends i.default{constructor(){super(...arguments),this.updateRemaining=e=>{this.state.remainingPending!==e&&(0===e?this.setState({...this.state,totalPending:0,remainingPending:0}):this.setState({...this.state,remainingPending:e}))}}getInitialState(){return{totalPending:0,remainingPending:0,transactionQueueError:void 0,storageUsageEstimate:void 0,connectionError:void 0}}percentComplete(e){if(this.state.totalPending>0){const t=1-this.state.remainingPending/this.state.totalPending;return e.formatNumber(t,{style:"percent",maximumFractionDigits:0})}return e.formatNumber(1,{style:"percent"})}setOrIncTotal(e){this.state.totalPending>e?this.setState({...this.state,totalPending:this.state.totalPending+1}):this.setState({...this.state,totalPending:e})}}const a=new r,s=new o.Z((()=>Boolean(a.state.transactionQueueError)),{debugName:"transactionQueueUnhealthyStore"}),l=a},26634:(e,t,n)=>{n.d(t,{Om:()=>i,_W:()=>a,o:()=>r});var o=n(99757);function i(){o.Z.setState({...o.Z.state,connectionError:void 0})}function r(e){const{connectionError:t}=o.Z.state,n=Date.now(),i=void 0===e.backoffEstimate?void 0:e.backoffEstimate+n;o.Z.setState({...o.Z.state,connectionError:{startTime:(null==t?void 0:t.startTime)??n,numAttempts:t?t.numAttempts+1:1,approximateBackoffDelayEndTime:i,retryReason:e.retryReason??(null==t?void 0:t.retryReason)}})}const a={onReset:i,onBackoff(e,t){r({backoffEstimate:e,retryReason:t})}}},29370:(e,t,n)=>{n.d(t,{N:()=>r,Z:()=>s});var o=n(49085),i=n(72126);function r(e,t){return e.collectionViewBlockStore===t.collectionViewBlockStore&&i.Xy(e.groupFormat,t.groupFormat)}class a extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return i.d9(this.state)}}const s=new a},42185:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(void 0)},30397:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{teams:[],lastEmitData:{value:"no value saved yet",spaceId:void 0,userId:void 0}}}shouldRefetchTeamsInSpace(e){let{currentUserId:t,currentSpaceId:n,emitValue:o}=e;const{spaceId:i,userId:r,value:a}=this.state.lastEmitData;return n!==i||(t!==r||o!==a)}}const r=new i},24666:(e,t,n)=>{n.r(t),n.d(t,{TextSelectionStore:()=>l,default:()=>c});var o=n(14577),i=n(49085),r=n(72126),a=n(62965),s=n(68056);class l extends i.default{constructor(){super(...arguments),this.isEditingStore=new o.Z((()=>"editing"===this.state.mode),{debugName:"isEditingStore"}),this.isExpandedStore=new o.Z((()=>"empty"!==this.state.mode&&!(0,s.iG)(this.state.multiSelection)),{debugName:"isExpandedStore"})}getInitialState(){return{mode:"empty"}}setState(e){if("empty"===e.mode||"empty"===this.instanceState.mode)return super.setState(e);if(!(0,a.Z)(this.instanceState,e)){const{savedSelectionXPosition:t,...n}=this.instanceState,{savedSelectionXPosition:o,...i}=e;this.instanceState=e,(0,a.Z)(n,i)||this.emit()}}cloneState(){return"editing"===this.state.mode?{mode:"editing",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition,forceExtendAnnotations:r.Xh(this.state.forceExtendAnnotations)}:"readOnly"===this.state.mode?{mode:"readOnly",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition}:{mode:"empty"}}isEmptySelection(){if("empty"===this.state.mode)return!0;const{multiSelection:e}=this.state;return(0,s.iG)(e)}isEditingComment(){return"editing"===this.state.mode&&("comment"===this.state.multiSelection.start.store.table||"comment"===this.state.multiSelection.end.store.table)}isEditingCaption(){return"editing"===this.state.mode&&(r.Xy(this.state.multiSelection.start.store.path,["properties","caption"])||r.Xy(this.state.multiSelection.end.store.path,["properties","caption"]))}hasSelection(){return"empty"!==this.state.mode}isEditingEmptyBlock(){return!("empty"===this.state.mode||!this.isEmptySelection())&&!this.state.multiSelection.start.store.isDefined()}}const c=new l},45131:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}setOpen(e,t){this.setState({...this.state,[e]:t})}toggle(e){this.setState({...this.state,[e]:!this.isOpen(e)})}isOpen(e){return!!this.state[e]}}const r=new i},48588:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(92595);class r extends o.default{getInitialState(){}}const a=new r;(0,i.exposeDebugValue)("TokenHoverStore",a);const s=a},58948:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{focused:!1,hovered:!1}}}const r=i},16194:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(!1)},52258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},66708:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},77503:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},59238:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{isDragging:!1}}}const r=new i},68026:(e,t,n)=>{n.r(t),n.d(t,{TransactionQueueDependenciesImpl:()=>F});var o=n(68626),i=n(91155),r=n(21051),a=n(50906),s=(n(21703),n(57658),n(92595)),l=n(59730),c=n(72126),d=n(4615),u=n(97880),p=n(9291),m=n(54642),f=n(47307),g=n(77080),h=n(56518),v=n(33954),b=n(24608),y=n(33929),_=n(44133),S=n(482),w=n(4408);async function k(e,t){const n=c.mN(t.operations.flatMap((e=>[e.pointer,...(0,S.S)(e)?e.additionalUpdatedPointers??[]:[]])),(e=>e.id));await Promise.all(n.map((n=>w.HB({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:n,userId:t.userId}))))}var I=n(99341);let x=0;const C=(0,p.defineMessages)({requestTooLarge:{id:"transactionHelpers.requestTooLargeError.message",defaultMessage:"Sorry, that request was too large."},requestTooLargeTryImportInstead:{id:"transactionHelpers.requestTooLargeError.message.tryImportInstead",defaultMessage:"Sorry, that request was too large. Try import instead?"}});let T=!1;(0,s.exposeDebugValue)("toggleTransactionQueue",(()=>{T=!T,console.info(T?"Transactions paused":"Transactions resumed")}));class M extends Error{constructor(e){super(e.message),this.retryDelay=void 0,this.retryReason=void 0,this.savedTasks=void 0,this.failedTasks=void 0,this.clientData=void 0,this.name="HandleSaveTransactionsError",this.retryDelay=e.retryDelay,this.retryReason=e.retryReason,this.savedTasks=e.savedTasks,this.failedTasks=e.failedTasks,this.clientData=e.clientData}}function P(e){if(1===e.subTasks.length)return e.task.debug;const t=new Map;for(const o of e.subTasks){var n;const e=null===(n=o.debug)||void 0===n?void 0:n.userAction;if(e){const n=t.get(e)??0;t.set(e,n+1)}}return{...e.task.debug,squashedUserActions:Object.fromEntries(t)}}async function A(e){if(T)return{value:[]};const{environment:t,tasks:n}=e,r=function(e,t){const n=new Set(t.map((e=>e.timestamp))),o=t.length-n.size;return o>0&&a.LAz(e,{collision_count:o}),o}(t,n),{userId:s,squashedTasks:p}=I.Vm(n,{allowSquashing:!0}),S=p.map((e=>({id:e.task.id,spaceId:e.task.spaceId,debug:P(e),operations:e.task.operations,inSudoMode:e.task.useSudoMode}))),w=(0,d.ZP)(),k=g.default.checkGate("client_http_gzip")?"gzip":void 0,A=await m.saveTransactions(t,{requestId:w,transactions:S},s,void 0,void 0,void 0,k);if("success"===A.type)return x=0,{value:p.flatMap((e=>e.subTasks))};const F="Notion is unavailable, please try again later."===A.error.message;if(!F&&!A.error.data.offline||Math.random()<.01){const e=[...new Set(S.map((e=>e.spaceId??"NO_SPACE_ID")))];o.log({level:"error",from:"transactionActions",type:"ClientTransactionError",error:{miscErrorString:(0,i.LK)(A)},data:{requestId:w,miscDataToConvertToString:{transactions:S},userId:t.currentUser.id,spaceIds:e}})}if(413===A.status){let e,n,i=0;p.forEach((t=>{var o,r;null!==(o=t.task.debug)&&void 0!==o&&o.userAction&&(e=t.task.debug.userAction),null!==(r=t.task.debug)&&void 0!==r&&r.userFlow&&(n=t.task.debug.userFlow),i+=t.subTasks.length})),o.log({level:"error",from:"transactionActions",type:"ClientTransaction413Error",data:{totalTaskCount:i,userId:t.currentUser.id,requestId:w,userAction:e,userFlow:n}});const r=JSON.stringify(S);a.F4S(t,{totalTaskCount:i,payloadLength:r.length,userAction:e});const s=Math.ceil(r.length/I._V);for(let a=0;a<s;a++)o.log({level:"error",from:"transactionActions",type:"ClientTransaction413ErrorRecovery",data:{userId:t.currentUser.id,totalTaskCount:i,requestId:w,miscDataToConvertToString:{chunkTotal:s,chunkIndex:a,operationChunk:r.slice(a*I._V,(a+1)*I._V)}}});f.showErrorMessage(y.default.formatMessage(e===h.xF?C.requestTooLargeTryImportInstead:C.requestTooLarge))}const Z=e=>{const n=x;if(e.failedTasks.length>0&&(x+=1),!F&&!A.error.data.offline){var s,l;const c=e.failedTasks.length>0?e.failedTasks[0]:void 0;c&&"space_not_found_in_record_path"===(null===(s=e.clientData)||void 0===s?void 0:s.type)&&o.log({level:"error",from:"transactionActions",type:"ClientTransactionSpaceNotFoundError",error:(0,i.Ui)(e),data:{userId:t.currentUser.id,requestId:w,miscDataToConvertToString:(0,_.getDebugSourcesForIdsInOperations)(t,c.operations)}}),a.mcx(t,{status:A.status,message:(0,b.pO)(A),previous_consecutive_rollbacks:n,saved_tasks:e.savedTasks.length,failed_tasks:e.failedTasks.length,first_failed_task_user_action:null==c||null===(l=c.debug)||void 0===l?void 0:l.userAction,will_retry:e.retryDelay>0,retry_reason:e.retryReason,timestamp_collision_count:r})}return{error:e}};if((0,l.Rp)(A.body)){if((0,l.oE)(A.body.clientData)){const{errors:e}=A.body.clientData,n=e[0],o=p.findIndex((e=>e.task.id===n.id));if(o<0)return D(t,w,n),Z(new M({message:n.name,clientData:n.clientData,retryDelay:0,retryReason:void 0,savedTasks:[],failedTasks:[]}));const i=p.slice(0,o),r=i.flatMap((e=>e.subTasks)),a=[],s=[],l=[];let c=o,d=0,m=0;for(const u of e){const e=p[c];u.id===e.task.id?(u.retryable?(s.push({error:u,squashedTask:e}),m+=1):(d+=1,await R(t,e.task,w),e.subTasks.forEach((e=>a.push(e))),l.push({error:u,squashedTask:e})),c++):D(t,w,u)}const f=[`${i.length} successful`,d>0?`${d} failed unretryable (data loss)`:void 0,m>0?`${m} retryable`:void 0].filter(u.$K).join(", "),g=[`API error for ${p.length} transactions: ${f}.`,B(l,"unretryable"),B(s,"retryable")].filter(u.$K).join(" ");let h,v=0;return s.length>0&&(v=2e3,h=s[0].error.name),Z(new M({savedTasks:r,failedTasks:a,message:g,retryDelay:v,retryReason:h,clientData:n.clientData}))}if(c.q9(E,A.status))return await Promise.all(p.map((e=>R(t,e.task,w)))),Z(new M({savedTasks:[],failedTasks:p.flatMap((e=>e.subTasks)),message:(0,v.wf)(y.default.getIntl(),A),retryDelay:0,retryReason:void 0}))}let V=`http${A.status}`;return A.error.data.offline?V="offline":F&&(V="notionUnavailable"),Z(new M({savedTasks:[],failedTasks:[],message:(0,v.wf)(y.default.getIntl(),A),retryDelay:5e3,retryReason:V}))}async function R(e,t,n){try{await k(e,t)}catch(r){o.log({level:"error",from:"transactionActions",type:"ClientTransactionCleanupError",error:(0,i.Ui)(r),data:{userId:e.currentUser.id,requestId:n}})}}function D(e,t,n){o.log({level:"error",from:"transactionActions",type:"ClientTransactionNotFoundError",error:(0,i.Ui)(n),data:{userId:e.currentUser.id,requestId:t}})}function B(e,t){if(e.length>0){var n;const{error:o,squashedTask:{task:i}}=e[0];return`First ${t} error: ${o.name} for transaction ${i.id} created by ${null===(n=i.debug)||void 0===n?void 0:n.userAction}.`}}const E=[400,413];class F{constructor(e){this.timeSource=r.O,this.environment=e}getExperimentGroup(e){return g.default.getGroup(e)}handleSaveTransactions(e){return A({environment:this.environment,tasks:e})}handleHealthcheck(e){a.h23(this.environment,e)}async rollbackTask(e){try{await k(this.environment,e)}catch(t){o.log({level:"error",from:"TransactionQueueDependencies",type:"ClientTransactionCleanupError",error:(0,i.Ui)(t),data:{userId:this.environment.currentUser.id}})}}}},9425:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(88893),i=n(88280),r=n(77080);function a(){const e=i.subscriptionDataStoreInstance.state;return!(!e||(0,o.CM)(e).length>1)&&r.default.checkGate("optimize_single_workspace")}},1634:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},80064:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},40671:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{updatingUrls:new Set}}add(e){this.state.updatingUrls.add(e),this.emit()}delete(e){this.state.updatingUrls.delete(e),this.emit()}}const r=new i},85703:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.data)))}}const r=new i},62820:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},4761:(e,t,n)=>{n.d(t,{ZP:()=>l,g0:()=>a,n_:()=>c});var o=n(49085),i=n(4615),r=n(97880);function a(e){return"mentions"===e||"allPages"!==e&&"archive"!==e&&void(0,r.t1)(e)}class s extends o.default{getInitialState(){return{currentTab:"mentions",isCurrentTabEmpty:!0,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,loadingId:void 0,sessionId:void 0,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}}startSession(){let{forceRestart:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(void 0===this.state.sessionId||e)&&this.setState({...this.state,sessionId:(0,i.ZP)()})}endSession(){this.setState({...this.state,sessionId:void 0})}startLoading(){const e=Math.random().toString();return this.setState({...this.state,loadingId:e}),e}endLoading(e){e===this.state.loadingId&&this.setState({...this.state,loadingId:void 0})}isFilteredToUnreadOnly(){if("mentions"===this.state.currentTab)return this.state.showOnlyUnreadNotifications}}const l=new s,c=o.default.createValue(!0)},29226:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),i=n(29477);class r extends o.default{getInitialState(){return{readyPromise:(0,i.UZ)(),localSpaceInaccessiblePages:void 0,remoteSpaceInaccessiblePages:void 0}}getSpaceInaccessiblePages(e,t){const n=this.state;return n.remoteSpaceInaccessiblePages&&n.remoteSpaceInaccessiblePages[t]?n.remoteSpaceInaccessiblePages[t][e]:n.localSpaceInaccessiblePages&&n.localSpaceInaccessiblePages[t]?n.localSpaceInaccessiblePages[t][e]:void 0}}const a=new r},76117:(e,t,n)=>{n.d(t,{p:()=>r});var o=n(49085);class i extends o.default{getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}}const r=new i},17963:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{pageMap:{}}}setStatus(e,t){const{pageMap:n}=this.state;t?n[e]=!0:delete n[e],this.emit()}}const r=new i},33759:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(85974).Z)},89403:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{}}}const r=new i},85974:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{loginType:"email",email:"",password:"",hasAccount:!1,showPassword:!1,signUpLinkSent:!1,hiddenPasscode:!1,forceAdminSamlLogin:!1}}isGoogle(){return"google"===this.state.loginType}isEmail(){return"email"===this.state.loginType}isReverifying(){return"reverify"===this.state.loginType}isTemporaryPasscode(){return"temporary"===this.state.loginType}isExclusiveLoginLinkTemporaryPasscode(){return"temporary"===this.state.loginType&&Boolean(this.state.hiddenPasscode)}isPassword(){return"password"===this.state.loginType}isForgotPassword(){return"forgot"===this.state.loginType}isPasswordResetSent(){return"reset"===this.state.loginType}isSaml(){return"saml"===this.state.loginType}isMfa(){return"mfa"===this.state.loginType}}const r=i},7339:(e,t,n)=>{n.d(t,{C:()=>S,Z:()=>b});n(21703);var o=n(30120),i=n(41351),r=n.n(i),a=n(49085),s=n(7406),l=n(68626),c=n(91155),d=n(90965),u=n(34886),p=n(97880),m=n(77472),f=n(12955),g=n(97448),h=n(35057),v=n(80444);const b="group";class y extends a.default{constructor(){super(...arguments),this.environment=void 0}getInitialState(){return{currentUserId:void 0,currentSpaceId:void 0,ready:!1}}isInitialized(){return g.StatsigInitializer.isComplete}async initialize(e){const t=Date.now();this.environment=e;const{userId:n,spaceId:o}=_(e);if(this.isInitialized()&&void 0!==n)await this.updateUserAndSpace(e);else try{this.setStateBeforeInitOrUpdate(n,o),await this.confirmInitializeDidSucceed(),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"initialize"}),this.setStateAfterInitOrUpdate(n,o),this.trackMetric("statsig_client_init_success")}catch(i){this.logError("initialize",i,{nextUserId:n}),this.trackMetric("statsig_client_init_error")}finally{this.trackMetric("statsig_client_init_duration",{time:Date.now()-t})}}async updateUserAndSpace(e){const{userId:t,spaceId:n}=_(e);this.state.currentUserId===t&&this.state.currentSpaceId===n||(this.setStateBeforeInitOrUpdate(t,n),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"updateUserAndSpace"}),this.setStateAfterInitOrUpdate(t,n))}async confirmInitializeDidSucceed(){if(!g.StatsigInitializer.initializePromise)throw new Error("`statsig.initialize` was not called on app bootstrap");if(await g.StatsigInitializer.initializePromise,g.StatsigInitializer.error)throw g.StatsigInitializer.error}async updateStatsigUserWithAllKnownFields(e){let{environment:t,stage:n}=e;const o=Date.now();try{const e=await this.createStatsigUser(t);await r().updateUser(e),this.trackMetric("statsig_client_update_user_success")}catch(i){this.logError("updateUser",i,{nextUserId:t.currentUser.id,err:(0,s.tg)(i).message,stage:n}),this.trackMetric("statsig_client_update_user_error")}finally{this.trackMetric("statsig_client_update_user_duration",{time:Date.now()-o})}}setStateBeforeInitOrUpdate(e,t){super.setState({currentUserId:e,currentSpaceId:t,ready:!1})}setStateAfterInitOrUpdate(e,t){const{currentSpaceId:n,currentUserId:o}=super.getState();n===t&&o===e&&super.setState({currentUserId:e,currentSpaceId:t,ready:!0})}getGroup(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,o=arguments.length>3?arguments[3]:void 0;const i=Date.now();if(!this.isInitialized())return;let a;try{return a=t?r().getExperimentWithExposureLoggingDisabled(e):r().getExperiment(e),this.trackMetric("statsig_client_get_group_success",{experiment_id:e}),a.get(n,o)}catch(s){this.trackMetric("statsig_client_get_group_error",{experiment_id:e}),this.logError("getGroup",s,{experimentId:e,expConfig:JSON.stringify(a)})}finally{this.trackMetric("statsig_client_get_group_duration",{time:Date.now()-i})}}manuallyLogExperimentExposure(e){r().manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return!1;let o;try{return o=t?r().checkGateWithExposureLoggingDisabled(e):r().checkGate(e),this.trackMetric("statsig_client_check_gate_success",{gate_name:e}),o}catch(i){const t=i instanceof Error?i.message:void 0;return this.logError("checkGate",i,{gateName:e,...t&&{errorMessage:t}}),this.trackMetric("statsig_client_check_gate_error",{gate_name:e}),!1}finally{this.trackMetric("statsig_client_check_gate_duration",{time:Date.now()-n})}}getConfig(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return;let o;try{return o=t?r().getConfig(e):r().getConfigWithExposureLoggingDisabled(e),this.trackMetric("statsig_client_get_config_success",{config_name:e}),o}catch(i){const t=i instanceof Error?i.message:void 0;return this.logError("getConfig",i,{dynamicConfigName:e,...t&&{errorMessage:t}}),void this.trackMetric("statsig_client_get_config_error",{config_name:e})}finally{this.trackMetric("statsig_client_get_config_duration",{time:Date.now()-n})}}logEvent(e,t,n){const o=Date.now();if(!this.isInitialized())return!1;try{return r().logEvent(e,t,n),this.trackMetric("statsig_client_log_event_success",{event_name:e}),!0}catch(i){const o=i instanceof Error?i.message:void 0;return this.logError("logEvent",i,{eventName:e,value:String(t),...n,...o&&{errorMessage:o}}),this.trackMetric("statsig_client_log_event_error",{event_name:e}),!1}finally{this.trackMetric("statsig_client_log_event_duration",{time:Date.now()-o})}}getLocalOverride(e){if(!this.isInitialized())return;const t=r().getAllOverrides().configs[e];return null==t?void 0:t[b]}updateLocalOverrideConfig(e,t){this.isInitialized()&&(r().overrideConfig(e,{[b]:t}),super.emit())}updateLocalOverrideGate(e,t){this.isInitialized()&&(r().overrideGate(e,"true"===t),super.emit())}removeAllLocalOverrides(){if(!this.isInitialized())return;const e=r().getAllOverrides();(0,p.Yd)(e.configs).forEach((e=>r().removeConfigOverride(e))),(0,p.Yd)(e.gates).forEach((e=>r().removeGateOverride(e))),super.emit()}async createStatsigUser(e){var t,n,i,r,a,s,l;const{device:c}=e,{currentUserSettingsStore:p,currentSpaceStore:m}=v.default.getState(),{userId:b,userEmail:y,spaceId:S}=_(e),w=await f.getBrowserId(e),k=await f.getExperimentDeviceId(e);return(0,g.createStatsigUser)({userId:b,device:c,spaceId:S,userEmail:y,deviceId:k,browserId:w,locale:null==p||null===(t=p.getSettings())||void 0===t?void 0:t.preferred_locale,spaceMemberCount:(0,u.F)((0,d.t5)(null==m?void 0:m.getPermissionItems())),spaceCreatedTime:null==m?void 0:m.getCreatedTime(),spaceCreatedDate:null!=m&&m.getCreatedTime()?o.ou.fromMillis(null==m?void 0:m.getCreatedTime()).toFormat("yyyy-MM-dd"):void 0,subscriptionTier:(0,h.zt)(),planType:null==m?void 0:m.getPlanType(),signupTime:null==p||null===(n=p.getSettings())||void 0===n?void 0:n.signup_time,domainType:null==p||null===(i=p.getSettings())||void 0===i?void 0:i.domain_type,persona:null==p||null===(r=p.getSettings())||void 0===r?void 0:r.persona,teamRole:null==p||null===(a=p.getSettings())||void 0===a?void 0:a.team_role,useCases:null==p||null===(s=p.getSettings())||void 0===s?void 0:s.use_cases,companySize:null==p||null===(l=p.getSettings())||void 0===l?void 0:l.company_size})}logError(e,t,n){l.log({level:"error",from:"statsig",type:e,error:(0,c.Ui)(t),data:{miscDataToConvertToString:{...n,...this.state}}})}trackMetric(e,t){this.environment&&e.endsWith("_error")&&m.j(this.environment,e,t)}}function _(e){const{currentUser:t}=e,{currentSpaceStore:n,currentUserStore:o}=v.default.getState(),i=t.id,r=null==o?void 0:o.getEmail();return{userId:i,spaceId:null==n?void 0:n.id,userEmail:r}}const S=new y},22616:(e,t,n)=>{n.d(t,{Zz:()=>s,aQ:()=>c,yD:()=>l});n(21703);var o=n(64793),i=n(12139),r=n(54642),a=(n(95477),n(70060),n(33493));async function s(e){const{environment:t,spaceId:n}=e;if("init"!==a.Z.state.status)return;a.Z.didStartLoading();const s=await r.listPrices(t,{spaceId:n});if("success"!==s.type)return void a.Z.resetExceptSelectedCurrencyCode();const l=s.data.prices;l&&0!==l.length||i.IE(new Error("Received empty price list")),a.Z.setPrices(l.map((e=>new o.tA(e))))}function l(e){a.Z.availableCurrencyCodes.includes(e)&&a.Z.update((t=>({...t,selectedCurrencyCode:e})))}async function c(e){let{environment:t,spaceId:n}=e;return await s({environment:t,spaceId:n}),a.Z.state.prices}},34583:(e,t,n)=>{n.d(t,{$B:()=>ie,EO:()=>J,Fp:()=>pe,I0:()=>ue,M_:()=>de,Mg:()=>$,OR:()=>re,TV:()=>Q,Xb:()=>me,bi:()=>ae,px:()=>se,r7:()=>oe,sv:()=>he,y3:()=>Y,zb:()=>le});n(21703);var o=n(30120),i=(n(67294),n(41892),n(68626)),r=(n(65454),n(15157)),a=n(4615),s=n(9182),l=n(26929),c=n(2438),d=n(9291),u=n(86572),p=n(54642),m=n(35253),f=n(47307),g=n(92625),h=n(97977),v=n(72899),b=n(91754),y=(n(95477),n(15010)),_=n(33929),S=n(78873),w=n(95697),k=n(80444),I=n(77080),x=n(73329),C=n(53730),T=n(81236),M=n(26136),P=n(92083),A=n(27242),R=n(9209),D=n(85703),B=n(76117),E=n(70060),F=n(28517),Z=n(42198),V=n(22616),j=n(5682),U=n(58333),L=n(88893),O=n(35057),N=n(62142),z=n(33493),W=n(88280),q=n(64891),H=n(85893);let K;const G=(0,d.defineMessages)({updatingSubscription:{id:"subscriptionSettings.updatingSubscriptionMessage",defaultMessage:"Updating your subscriptionâ€¦"},updatingPaymentMethod:{id:"subscriptionSettings.updatingPaymentMethodMessage",defaultMessage:"Updating your payment methodâ€¦"},verifyingEligibility:{id:"subscriptionSettings.verifyingEligibilityMessage",defaultMessage:"Verifying eligibilityâ€¦"},personalFree:{id:"subscriptionSettings.personalFreeMessage",defaultMessage:"You are now subscribed to Notionâ€™s Personal Pro Plan for free."},educationPlusFree:{id:"subscriptionSettings.educationPlusFreeMessage",defaultMessage:"You are now subscribed to Notion's Education plan for free"}});async function $(e){const{from:t,isMmOrEnt:n=!1,environment:o,spaceStore:i,billingEmail:r,paymentData:a,vatId:l,coupon:c,customerName:d,businessName:h,addressLine1:v,addressZip:b,addressCity:_,addressState:S,addressCountry:w,promoCodeId:k,useTestClock:I,sessionId:C,inAppOffer:T,desiredState:M}=e;m.Js({bannerStore:x.Z}),g.j({message:G.updatingSubscription});const P=W.subscriptionDataStoreInstance.state;if(!P)throw new Error("Subscription data not loaded.");const A=await V.aQ({environment:o,spaceId:i.id}),R=(0,j.P)(A,P),D=(0,s.iv)(R),{plan:B,addOns:E,isTrial:F}=(0,U.ug)(D,M),Z=await p.updateSubscription(o,{spaceId:i.id,plan:B,addOns:E,billingEmail:r,stripeToken:fe(a),paymentMethodId:ge(a),vatId:l,coupon:c,customerName:d,businessName:h,addressLine1:v,addressZip:b,addressCity:_,addressState:S,addressCountry:w,promoCodeId:k,useTestClock:I,modalSessionId:C,inAppOffer:T,isTrial:F,clientVersion:o.device.version});if(g.x(),"failed"===Z.type)throw f.showError(Z),new Error("An error occurred while updating subscription");await ne({environment:o,spaceStore:i,newDefaultTeamId:Z.data.newDefaultTeamId});const L=W.subscriptionDataStoreInstance.state;if(function(e){var t;let{environment:n,context:o,oldData:i,newData:r,desiredState:a}=e;const l=(0,s.F6)(i.subscription),c=(0,s.zt)(i.subscription),d=(0,s.xi)(i.subscription),p=(0,s.Hw)(i.subscription),m=(0,s.bs)(i.subscription),f=i.email,g=(0,s.F6)(a),h=(0,s.zt)(a),v=(0,s.xi)(a),b=(0,s.Hw)(a),_=(0,s.bs)(a),S=Boolean(null==a?void 0:a.trialEnd),w=r.email,k=i.subscription,I=!(0,s.YK)(k)&&(0,s.YK)(a),x=(0,s.YK)(k)&&(0,s.YK)(a),C=(0,s.YK)(k)&&!(0,s.YK)(a);I&&g?u.k6(n,{plan:g,credit_amount:0}):x?u.wl(n,{billing_email_changed:f!==w,plan_changed:g!==l,plan_current:g,plan_old:l,currency_code:_,billing_address_changed:!1}):C&&l&&u.rx(n,{plan:l});u._j(n,{from:o.from,action:C?"cancel":"update",spaceId:o.spaceId,isMmOrEnt:o.isMmOrEnt,planType:o.planType,addressCountry:null===(t=r.address)||void 0===t?void 0:t.country,oldSubscriptionTier:c,newSubscriptionTier:h,oldCurrency:m,newCurrency:_,oldPriceId:l,newPriceId:g,oldAddOns:d,newAddOns:v,oldBillingInterval:p,newBillingInterval:b,creditAmount:0,isProfessionalTeamUser:(0,y.QZ)(),isTrial:S})}({environment:o,context:{spaceId:i.id,planType:i.getPlanType(),from:t,isMmOrEnt:n},oldData:R,newData:(0,j.P)(A,L),desiredState:M}),!L)throw new Error("Subscription data not loaded.");return Z.data}async function Q(e){const{environment:t,spaceStore:n,paymentMethodId:o}=e;g.j({message:G.updatingPaymentMethod});const i=await p.updatePaymentMethod(t,{spaceId:n.id,paymentMethodId:o});if(g.x(),"failed"!==i.type)return await ae(t),i.data;f.showError(i)}async function Y(e){const{environment:t,spaceStore:n,address:o}=e;m.Js({bannerStore:x.Z}),g.j({message:G.updatingSubscription});const i=await p.updateSubscription(t,{spaceId:n.id,customerName:o.name,businessName:o.businessName,addressLine1:o.addressLine1,addressLine2:o.addressLine2,addressZip:o.zipCode,addressCity:o.city,addressState:o.state,addressCountry:o.country});if("failed"===i.type)throw g.x(),f.showError(i),i.error;u.wl(t,{billing_email_changed:!1,plan_changed:!1,billing_address_changed:!0}),await ae(t),await se(t),g.x()}async function J(e){const{environment:t,spaceStore:n,planType:o,from:i}=e,r=W.subscriptionDataStoreInstance.state;if(!r)throw new Error("Subscription data not loaded.");m.Js({bannerStore:x.Z}),g.j({message:G.updatingSubscription});const a=X(t,r),s=r.addOns,l=L.XX(r),d=null==l?void 0:l.plan,h=d?(0,c.qH)(d):void 0,v=await p.cancelSubscription(t,{spaceId:n.id,planType:o,cancelImmediately:e.cancelImmediately});if("failed"===v.type)return g.x(),void f.showError(v);const b=L.XX(r);let _;"subscribed_admin"===r.type&&b&&(_=!0,u.rx(t,{plan:b.plan})),await ne({environment:t,spaceStore:n,newDefaultTeamId:"success"===v.type?v.data.newDefaultTeamId:void 0});const S=W.subscriptionDataStoreInstance.state;if(!S)throw new Error("Subscription data not loaded.");return u._j(t,{from:i,action:"cancel",spaceId:n.id,oldSubscriptionTier:a,newSubscriptionTier:X(t,S),oldPriceId:ee(r,b),oldCurrency:te(r),newCurrency:te(S),oldAddOns:s.map((e=>e.feature)),oldBillingInterval:h,newBillingInterval:void 0,isCancelSubscription:_,isProfessionalTeamUser:(0,y.QZ)()}),g.x(),!0}function X(e,t){const n=(0,O.zt)();if(!t)return n;return(0,L.DH)(t)?"free":n}function ee(e,t){if(!e)return;return(0,L.DH)(e)||null==t?void 0:t.plan}function te(e){if(e)return"currencyCode"in e?e.currencyCode:void 0}async function ne(e){let{environment:t,newDefaultTeamId:n,spaceStore:o}=e;if(await ae(t),await se(t),z.Z.reset(),(0,w.bq)()&&t.currentUser.id&&void 0!==n){await F.m({userId:t.currentUser.id,spaceId:o.id,environment:t});const e=M.zX.createChildStore(o,{table:"team",id:n,spaceId:o.id});await e.load()}}async function oe(e){const{environment:t,spaceStore:n,code:o}=e;g.j({message:G.verifyingEligibility});const i=W.subscriptionDataStoreInstance.state;if(!i)throw new Error("Subscription data not loaded.");const r=await p.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:o});"failed"===r.type?f.showError(r):r.data.isEligible?ce(i,t):R.Z.setState({open:!0,handlePromoCode:async e=>{g.j({message:G.updatingSubscription});const o=await p.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:e});"failed"===o.type?f.showError(o):o.data.isEligible?ce(i,t):f.showErrorMessage((0,H.jsx)(d.FormattedMessage,{id:"subscriptionSettings.invalidPromoCodeError.message",defaultMessage:"This promo code is not valid."})),g.x()}}),g.x()}function ie(){K&&K.close()}async function re(e){const{environment:t,spaceId:n,isNewlyCreatedSpace:o}=e,i=W.subscriptionDataStoreInstance.spaceId;if(!t.currentUser.isLoggedIn()||i&&i===n)await W.subscriptionDataStoreInstance.waitUntilLoaded();else if(D.Z.setState({...D.Z.state,spaceId:n}),o){const e={type:"unsubscribed_admin",users:[],bots:[],joinedMemberIds:[],blockUsage:0,hasPaidNonzero:!1,accountBalance:0,timelineViewUsage:0,inviteLinkCode:"",userSimilarity:{},spaceUsers:[],members:[],customerData:void 0,revenueCatEnabled:!1,addOns:[],currencyCode:void 0};W.subscriptionDataStoreInstance.setState(e),W.subscriptionDataStoreInstance.spaceId=n,B.p.setState({}),ae(t)}else ae(t),se(t)}async function ae(e){var t;const n=null===(t=k.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=e.currentUser.id;if(!n)throw new Error("No spaceId.");{const t=`SubscriptionData:${n}:v2`,a=r.Z.get({userId:o,key:t});a&&(W.subscriptionDataStoreInstance.setState(a),W.subscriptionDataStoreInstance.spaceId=n),await async function(e){let{environment:t,spaceId:n,currentUserId:o,localKey:a}=e;o&&Z.default.initializeAndLoadAllUserSignals({environment:t,userId:o,spaceId:n});await C.transactionQueue.drain();const[s,l]=await Promise.all([p.getSubscriptionData(t,{spaceId:n}),p.getVisibleUsers(t,{spaceId:n})]);if("success"===s.type&&"success"===l.type){var c;const e={...s.data,...l.data};r.Z.set({userId:o,key:a,value:e}),(null===(c=k.default.state.currentSpaceStore)||void 0===c?void 0:c.id)===n&&(W.subscriptionDataStoreInstance.setState(e),W.subscriptionDataStoreInstance.spaceId=n,L.YK(e)&&u.jw(t))}else i.log({level:"error",from:"subscriptionActions",type:"fetchSubscriptionDataFailed",data:{miscDataToConvertToString:{getSubscriptionDataResponseType:s.type,getSubscriptionDataResponseStatus:s.status,getVisibleUserResponseType:l.type,getVisibleUserResponseStatus:l.status}}});await Promise.all([T.Z.awaitPublicSpaceData(t,n,!0),v.E0.loader().then((e=>{let{completionActions:o}=e;return o.updateAiEligibility(t,n)}))])}({environment:e,spaceId:n,currentUserId:o,localKey:t})}}async function se(e){var t;const n=null===(t=k.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=e.currentUser.id;if(!n)throw new Error("No spaceId.");{const t=`UpcomingInvoiceData:${n}:v2`,a=r.Z.get({userId:o,key:t});a&&D.Z.setState({spaceId:n,data:a}),await C.transactionQueue.drain();const s=await p.getInvoiceData(e,{spaceId:n,type:"upcoming"});if("success"===s.type){const{data:e}=s;r.Z.set({userId:o,key:t,value:e.invoiceData}),D.Z.state.spaceId===n&&D.Z.setState({spaceId:n,data:e.invoiceData})}else i.log({level:"error",from:"subscriptionActions",type:"fetchUpcomingInvoiceCall",data:{miscDataToConvertToString:{upcomingInvoiceResponse:s}}})}}async function le(e,t){const n=k.default.state.currentSpaceStore;if(!n)return;const o=await p.getBillingHistory(e,{spaceId:n.id,limit:t.state.billingEventsLimit});"success"===o.type&&t.update((e=>({...e,billingEvents:o.data.events})))}async function ce(e,t){await ae(t),se(t),z.Z.reset();const n=()=>{f.showMessage({message:_.default.formatMessage(G.educationPlusFree)}),P.Z.setState({...P.Z.state,currentTab:"billing",defaultSubtab:void 0});const n=L.XX(e);u.jh(t,{plan:"student_free",old_plan:n?n.plan:void 0})};await h.shouldCreatePassword(t)?S.E({environment:t,onSubmit:n,onCancel:n}):n()}function de(e){const t=W.subscriptionDataStoreInstance.state;if(e.device.isMobileNative&&e.device.isIOS)return!0;if(e.device.isMobileNative&&e.device.isAndroid&&!I.default.checkGate("android_native_blocks"))return!0;if(t){if((0,E.du)())return!0;if(L.Ln(e,t))return u.lj(e),function(e){if((0,E.du)())return;m.Bw({id:"SubscriptionEditingBlocker",bannerStore:x.Z,styleKey:b.v.Red,contentKey:"over_free_block_limit"})}(),!1;L.XZ(e,t)&&u.z2(e)}if((0,E.e0)()){var n,i;const e=null===(n=k.default.state.currentSpaceStore)||void 0===n?void 0:n.getOverdueSubscription(),t=L.aS(W.subscriptionDataStoreInstance.state),r=null==t||null===(i=t.testClock)||void 0===i?void 0:i.frozen_time,a=r?o.ou.fromSeconds(r):o.ou.now(),{paymentStatus:s}=(0,l.cS)({now:a,overdueSubscription:e});if("unpaid"===s)return!1}return m.qL({bannerStore:x.Z,id:"SubscriptionEditingBlocker"}),!0}function ue(e,t){const{subscriptionTier:n,from:o,addOnFeature:i,coupon:r,isTrial:s}=t,l=(0,a.ZP)();u.Lc(e,{subscriptionTier:n,from:o,addOnFeature:i,currency_code:z.Z.state.selectedCurrencyCode,isTrial:s,modal_id:l});const c=i||s||!E.F4()?"month":"year";A.Z.open({subscriptionTier:n,billingInterval:c,addOnFeature:i,coupon:r,isTrial:s,sessionId:l})}function pe(e){const t=A.Z.state;t.open&&(u.LY(e,{modal_id:t.sessionId}),A.Z.setState({open:!1}))}function me(e){N.Z.open(e)}function fe(e){return"stripeToken"===(null==e?void 0:e.type)?e.value:void 0}function ge(e){return"paymentMethodId"===(null==e?void 0:e.type)?e.value:void 0}async function he(e){const{environment:t,product:n,spaceStore:o,spaceSubscriptionPlansStore:i,data:r,from:a,pageSection:l}=e,c=await V.aQ({environment:t,spaceId:o.id}),d=(0,j.P)(c,r);if(!d.subscription||!L.MM(r))return void ue(t,{subscriptionTier:n,from:a});const u=(0,s.Hw)(d.subscription),p=(0,s.bs)(d.subscription),m=(0,E.bU)()?(0,s.Lg)(d):(0,s.iv)(d);let f;if("free"!==n&&p&&u){const e={product:n,currency:p,interval:u};f=(0,U.AI)(c,m,e)}else{if("free"!==n)throw new Error("Trying to update plan on a subscription with no items");f=(0,U.t4)(m,"plan")}return(0,U._D)(m,f)?async function(e){const{environment:t,from:n,spaceSubscriptionPlansStore:o,spaceStore:i,desiredState:r,product:a}=e;let s="churn_by_end_of_billing_period";o&&(s=await new Promise((e=>{o.setState({...o.state,churnType:a,churnSurveyModalOpen:!0,onAccept:t=>{e(t?"churn_immediately":"churn_by_end_of_billing_period")},onClose:()=>e("no_churn")})})));if("no_churn"===s)return;0===r.items.length?await J({environment:t,spaceStore:i,planType:"personal",from:n,cancelImmediately:"churn_immediately"===s}):await $({environment:t,spaceStore:i,desiredState:r,from:n})}({environment:t,from:a,spaceStore:o,spaceSubscriptionPlansStore:i,desiredState:f,product:n}):q.af({environment:t,from:a,view:"plans",temporarySubscriptionTier:n,billingInterval:u,pageSection:l})}},40469:(e,t,n)=>{n.d(t,{SP:()=>v,W_:()=>f,l_:()=>g,nf:()=>h});var o=n(19234),i=n(31919),r=n(47425),a=n(54642),s=n(27242),l=n(88893),c=n(63423),d=n(62142),u=n(33493),p=n(25692),m=n(88280);async function f(e){const t=s.Z.state,n=m.subscriptionDataStoreInstance.state;if(!t.open||!n)return;const i=t.temporaryAddress;if(!(0,o.A)(i))return;s.Z.update((e=>({...e,calculatingTax:!0})));const{planAmount:r,promoInfo:c,accountBalance:d}=(0,l.uN)({promo:t.appliedPromo,currencyCode:u.Z.selectedCurrencyCode,data:n,addOnFeature:t.addOnFeature,onlyShowAddOn:t.onlyShowAddOn,subscriptionTier:t.subscriptionTier,taxAmount:t.taxAmount,calculatingTax:t.calculatingTax,billingInterval:t.temporaryBillingInterval??"year",coupon:t.coupon}),p=Math.max(0,r-c.amount+d),f=await a.calculateTax(e,{address:i,price:p,vatId:t.vatApplicable?t.temporaryVatCode:void 0,customerId:"subscribed_admin"===n.type?n.customerData.stripe.customerId:void 0});if("failed"===f.type)s.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=f.data;e.valid?s.Z.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):s.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function g(e){var t;const n=d.Z.state,r=m.subscriptionDataStoreInstance.state;if(!n.open||!r)return;const s=n.temporaryAddress;if(!(0,o.A)(s))return;d.Z.update((e=>({...e,calculatingTax:!0})));const l=(null===(t=n.totalUpgradeCost)||void 0===t?void 0:t.amount)||0,c=await a.calculateTax(e,{address:s,price:l,vatId:n.vatApplicable?n.temporaryVatCode:void 0,customerId:"subscribed_admin"===r.type?r.customerData.stripe.customerId:void 0});if("failed"===c.type)d.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=c.data;e.valid?d.Z.update((t=>({...t,taxAmount:i.n.fromValue({amount:e.taxAmount,currencyCode:u.Z.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):d.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function h(e){const{environment:t,priceForTaxCalculation:n,address:o,customerId:i,vatId:r}=e,s=c.Z.state,l=await a.calculateTax(t,{address:o,customerId:i,vatId:r,price:n});if("failed"===l.type);else{const e=l.data;e.valid&&s.open&&c.Z.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function v(e){var t;const n=p.Z.state,i=m.subscriptionDataStoreInstance.state;if(!n.open||!i)return;if("subscribed_admin"!==i.type&&"unsubscribed_admin"!==i.type)return;const s=null===(t=i.customerData)||void 0===t?void 0:t.stripe;if(!s)return;const c=s.address;if(!c||!(0,o.A)(c))return;p.Z.update((e=>({...e,calculatingTax:!0})));const d=n.temporarySubscriptionTier??n.subscriptionTier,f=(0,r.QM)(d)&&n.addOnFeature?"month":"year",g=n.temporaryBillingInterval??n.billingInterval??f,h=!(0,r.QM)(d)&&Boolean(n.addOnFeature),{payAmount:v}=(0,l.uN)({promo:void 0,currencyCode:u.Z.selectedCurrencyCode,data:i,addOnFeature:n.addOnFeature,onlyShowAddOn:h,subscriptionTier:d,taxAmount:n.taxAmount,calculatingTax:n.calculatingTax,billingInterval:g,coupon:n.coupon}),b=await a.calculateTax(e,{address:c,price:v.amount,vatId:s.vatId,customerId:s.customerId});if("failed"===b.type)return void p.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1,taxCalculationError:b.error})));const y=b.data;y.valid?p.Z.update((e=>({...e,taxAmount:y.taxAmount,calculatingTax:!1}))):p.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})))}},64891:(e,t,n)=>{n.d(t,{Mg:()=>M,OT:()=>T,Zo:()=>A,af:()=>I,bX:()=>C,cM:()=>x,y5:()=>P});var o=n(4615),i=n(9182),r=n(86572),a=n(54642),s=n(47307),l=n(92625),c=n(91376),d=n(64964),u=n(80444),p=n(70060),m=n(5682),f=n(40670),g=n(58333),h=n(35057),v=n(87598),b=n(33493),y=n(25692),_=n(88280),S=n(22616),w=n(34583),k=n(40469);function I(e){const{environment:t,from:n,view:i,temporarySubscriptionTier:a,temporaryBillingInterval:s,billingInterval:l,addOnFeature:c,pageSection:d,onSuccess:u}=e,p=(0,o.ZP)();r.YT(t,{from:n,pageSection:d,view:i,modal_id:p,currency_code:b.Z.selectedCurrencyCode}),y.Z.setState({open:!0,modalId:p,view:i,subscriptionTier:(0,h.zt)(),temporarySubscriptionTier:a,billingInterval:l,temporaryBillingInterval:s,calculatingTax:!1,isExpandedView:!1,addOnFeature:c,onSuccess:u}),k.SP(t)}function x(e){const t=y.Z.state;t.open&&(r.q7(e,{state:t}),y.Z.setState({open:!1}))}function C(e){const t=y.Z.state;t.open&&(r.y$(e,{state:t}),y.Z.setState({...t,isExpandedView:!0}))}function T(e){const t=y.Z.state;t.open&&(r.k1(e,{state:t}),y.Z.setState({...t,isExpandedView:!1}))}async function M(e,t){const n=u.default.state.currentSpaceStore;if(!n)return;const o=y.Z.state;if(!o.open)return;r.nd(e,{state:o});const{view:a,onSuccess:s}=o,l=_.subscriptionDataStoreInstance.state,c=await S.aQ({spaceId:n.id,environment:e}),h=(0,m.P)(c,l),v=(0,p.bU)()?(0,i.Lg)(h):(0,i.iv)(h),k=o.temporarySubscriptionTier,I=(0,i.Hw)(v)??"year",C=o.temporaryBillingInterval??"year",T=o.addOnFeature,M=b.Z.selectedCurrencyCode;let P,A=v;if("add_ons"===a&&T){const e={product:T,interval:I,currency:M};A=(0,g.AI)(c,A,e),P=f.aQ({addOnFeature:T})}else if("billing_interval"===a)A=(0,g.Zl)(c,A,C),P=f.Nj({billingInterval:C});else{if("plans"!==a||!k)return void x(e);{const e={product:k,interval:I,currency:M};A=(0,g.AI)(c,A,e),P=f.s6({newTier:k})}}await w.Mg({environment:e,from:"space_settings-plans_tab",spaceStore:n,desiredState:A,inAppOffer:t}),x(e),P&&d.oV(P),null==s||s()}async function P(e){var t;const{environment:n,customerData:o}=e,r=u.default.state.currentSpaceStore;if(!r)return;const l=await S.aQ({spaceId:r.id,environment:n}),c=(0,m.P)(l,o);if(null===(t=c.subscription)||void 0===t||!t.pending)return s.showErrorMessage((0,f.iS)());if(!r)return s.showErrorMessage((0,f.iS)());const p=(0,f.dY)(o);let g;if(o.willCancelAt){const e=(0,i.iv)(c);await w.Mg({environment:n,from:"space_settings-billing_tab",spaceStore:r,desiredState:e}),g={type:"success"}}else{if(!p)return s.showErrorMessage((0,f.iS)());g=await a.releaseSubscriptionSchedule(n,{id:p})}return"success"===g.type?(d.oV({label:(0,f.UW)()}),await w.bi(n)):s.showErrorMessage((0,f.iS)())}async function A(e){const t=u.default.state.currentSpaceStore;t&&(l.j({message:v.z.cancellingTrial}),await w.EO({environment:e,spaceStore:t,planType:t.getPlanType()??"personal",from:"space_settings-plans_tab"}),l.x(),c.r$({currentTab:"billing"}))}},5682:(e,t,n)=>{n.d(t,{P:()=>s});n(21703);var o=n(30120),i=n(72126),r=n(97880),a=n(88893);function s(e,t){var n;const i=function(e){return(0,r.$K)(e)&&"customerData"in e?(0,a.aS)(e):e}(t),s=null==i?void 0:i.customerId,c=null==i||null===(n=i.testClock)||void 0===n?void 0:n.frozen_time;return{externalId:s,now:c?o.ou.fromSeconds(c):o.ou.now(),email:null==i?void 0:i.billingEmail,address:null==i?void 0:i.address,subscription:function(e,t){if(!t)return;const n=t.subscriptionId,i="trialEnd"in t?t.trialEnd:void 0,a=i?o.ou.fromSeconds(i):void 0,s=function(e,t){var n;if(t.willCancelAt){return{items:[],startDate:o.ou.fromSeconds(t.willCancelAt)}}if("trialEnd"in t&&t.trialEnd){return{items:l(e,t),startDate:o.ou.fromSeconds(t.trialEnd)}}if(!(0,r.$K)(t.schedule))return;const i=((null==t||null===(n=t.schedule)||void 0===n?void 0:n.phases)??[])[1];if(!(0,r.$K)(i))return;return{items:i.items.map((t=>{const n=e.find((e=>e.externalId===t.price.id));if(!n)throw new Error(`Unable to find price for priceId: ${t.price.id}`);return{price:n}})),startDate:o.ou.fromSeconds(i.start_date)}}(e,t),c=l(e,t);if(!t.isSubscribed&&0===c.length)return;return{externalId:n,trialEnd:a,items:c,pending:s}}(e,i)}}function l(e,t){const n="plan"in t?t.plan:void 0,o=n?e.find((e=>e.externalId===n)):void 0,r=o?{price:o}:void 0;if(n&&!r)throw new Error(`Unable to find price for plan priceId: ${n}`);return t.addOns.map((t=>{const n=e.find((e=>e.externalId===t.priceId));if(!n)throw new Error(`Unable to find price for addOn priceId: ${t.priceId}`);return{price:n}})).concat((0,i.oA)([r]))}},40670:(e,t,n)=>{n.d(t,{A0:()=>Z,Nj:()=>U,Tg:()=>B,UW:()=>S,Z_:()=>E,aQ:()=>L,bM:()=>I,dA:()=>k,dY:()=>w,iS:()=>_,n8:()=>D,rO:()=>F,s6:()=>j});n(57658),n(67294);var o=n(13991),i=n(7057),r=n(36591),a=n(3791),s=n(47425),l=n(97880),c=n(9291),d=n(33929),u=n(88893),p=n(35057),m=n(85893);const f=(0,c.defineMessages)({cancellationError:{id:"midtermSubscriptionHelpers.cancellationFailed",defaultMessage:"There was an error attempting to cancel your pending changes. Please try again."},unableToCancelError:{id:"midtermSubscriptionHelpers.unableToCancel",defaultMessage:"We cannot cancel your scheduled changes right now. Please contact support for more help."},cancellationSuccess:{id:"midtermSubscriptionHelpers.cancellationSucceeded",defaultMessage:"Pending changes have been canceled"},invalidSubscriptionId:{id:"midtermSubscriptionHelpers.invalidSubscriptionId",defaultMessage:"Unable to cancel your pending changes. Something was wrong with your pending subscription changes."}});function g(e){return(0,s.QM)(e)?"free":(0,s.iJ)(e)?"education":(0,s.Aw)(e)?"singlePlayerPlus":(0,s.eR)(e)?"plus":(0,s.NG)(e)?"business":(0,u.gG)(e)?"enterprise":"legacy"}const h=(0,c.defineMessages)({personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),v={free:{planTitle:h.freePlan},singlePlayerPlus:{planTitle:h.plusPlan},education:{planTitle:h.educationPlusPlan},plus:{planTitle:h.plusPlan},business:{planTitle:h.businessPlan},enterprise:{planTitle:h.enterprisePlan},legacy:{planTitle:h.legacyPlan}},b=(0,c.defineMessages)({notionAI:{defaultMessage:"Notion AI",id:"notionAI.title"},removeAI:{defaultMessage:"Remove AI",id:"notionAI.remove.title"}}),y=(0,c.defineMessages)({month:{defaultMessage:"Monthly billing",id:"billingInterval.monthly"},year:{defaultMessage:"Annual billing",id:"billingInterval.annual"}});function _(){return d.default.formatMessage(f.unableToCancelError)}function S(){return d.default.formatMessage(f.cancellationSuccess)}function w(e){var t;return null===(t=e.schedule)||void 0===t?void 0:t.id}function k(e){return e.willCancelAt}function I(e){var t;const n=null===(t=e.schedule)||void 0===t?void 0:t.status;return"not_started"===n||"active"===n}const x={personal_monthly_5:"personal",personal_yearly_48:"personal",team_monthly_10:"plus",team_yearly_96:"plus",business_monthly:"business",business_yearly:"business",enterprise_monthly_25:"enterprise",enterprise_yearly_240:"enterprise"};function C(e){for(const t of e)if(t.plan in x)return x[t.plan]}function T(e){for(const n of e)try{const e=(0,a.PG)(n.plan);if(e)return e}catch(t){}}function M(e){for(const t of e)return t.billingInterval}function P(e){var t;if(e.willCancelAt)return{oldTier:p.zt(),newTier:"free",oldAddOn:null===(t=e.addOns[0])||void 0===t?void 0:t.feature,newAddOn:void 0,oldInterval:e.interval,newInterval:void 0,phaseOneEndDate:e.willCancelAt,phaseTwoEndDate:NaN};const n=e.schedule;if(!n)return;const o=n.phases;if(!o)return;const i=o[0],r=o[1];if(!i)return;const a=[],s=[];for(const l of i.items)a.push({billingInterval:l.billing_interval,plan:l.plan});if(r)for(const l of r.items)s.push({billingInterval:l.billing_interval,plan:l.plan});return{oldTier:p.zt(),newTier:C(s),oldAddOn:T(a),newAddOn:T(s),oldInterval:M(a),newInterval:M(s),phaseOneEndDate:1e3*i.end_date,phaseTwoEndDate:1e3*(null==r?void 0:r.end_date)}}function A(e,t){const n=g(e),o=d.default.formatMessage(v[n].planTitle);if(!t)return"";const i=g(t);return`${o} â†’ ${d.default.formatMessage(v[i].planTitle)}`}function R(e,t){return`${d.default.formatMessage(e?b.notionAI:b.removeAI)} â†’ ${d.default.formatMessage(t?b.notionAI:b.removeAI)}`}function D(e){const t=[];return p.QM()||t.push(A(p.zt(),"free")),(0,a.de)(e.addOns)&&t.push(R("ai",void 0)),{cancelledChanges:t}}function B(e){const t=P(e),n=[];if(!t)return{scheduledChanges:n,periodEndDate:0};const{newTier:o,oldTier:i,oldAddOn:r,newAddOn:a,oldInterval:s,newInterval:l,phaseOneEndDate:c}=t;return i!==o&&n.push(A(i,o)),r!==a&&n.push(R(r,a)),s!==l&&n.push(function(e,t){return e&&t?`${d.default.formatMessage("month"===e?y.month:y.year)} â†’ ${d.default.formatMessage("month"===t?y.month:y.year)}`:""}(s,l)),{scheduledChanges:n,periodEndDate:c}}function E(e,t,n){return"billing_interval"===e&&"year"===t&&"month"===n}function F(e,t,n){return"plans"===e||"add_ons"===e||"billing_interval"===e&&"month"===t&&"year"===n}function Z(e){if(e.willCancelAt)return!0;const t=P(e),{oldAddOn:n,newAddOn:o}=t||{};return"ai"===n&&!o}function V(e){return(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,r.e)({width:12}),e.children]})}function j(e){const{newTier:t}=e;switch(t){case"plus":return{label:(0,m.jsx)(V,{children:(0,m.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.plus",defaultMessage:"You have successfully upgraded to the Plus plan"})})};case"business":return{label:(0,m.jsx)(V,{children:(0,m.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.business",defaultMessage:"You have successfully upgraded to the Business plan"})})};case"enterprise":return{label:(0,m.jsx)(V,{children:(0,m.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.enterprise",defaultMessage:"You have successfully upgraded to the Enterprise plan"})})};case"student":return{label:(0,m.jsx)(V,{children:(0,m.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.student",defaultMessage:"You have successfully upgraded to the Student plan"})})};case"free":case"personal":case"personal_free":case"team_free":return;default:(0,l.t1)(t)}}function U(e){const{billingInterval:t,effectiveDateEpochMs:n}=e,r=n?(0,i.Yx)(n,"medium",o.SP):void 0;return r?{label:(0,m.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.future",defaultMessage:"{billingInterval, select, year {Yearly} other {Monthly}} billling will be effective {date}",values:{billingInterval:t,date:r}})}:{label:(0,m.jsx)(V,{children:(0,m.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.success",defaultMessage:"You have successfully changed to {billingInterval, select, year {yearly} other {monthly}} billing",values:{billingInterval:t}})})}}function L(e){const{addOnFeature:t}=e;switch(t){case"ai":return{label:(0,m.jsx)(V,{children:(0,m.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.purchaseAddOn.ai",defaultMessage:"You have successfully added Notion AI"})})};default:(0,l.t1)(t)}}},70060:(e,t,n)=>{n.d(t,{F4:()=>S,G2:()=>I,IC:()=>w,KC:()=>p,ML:()=>F,MV:()=>x,Pw:()=>B,R$:()=>Z,SF:()=>T,U0:()=>A,XA:()=>E,Xg:()=>f,Z$:()=>M,bI:()=>P,bP:()=>D,bQ:()=>U,bU:()=>V,du:()=>g,e0:()=>k,fQ:()=>v,fX:()=>R,fw:()=>h,i4:()=>_,lF:()=>u,oP:()=>b,px:()=>y,uO:()=>j,yt:()=>C});var o=n(44317),i=n(3791),r=n(47425),a=n(80444),s=n(77080),l=n(88280),c=n(88893),d=n(35057);function u(){return s.default.getEligibleGroup({experimentId:"block_limit_cta_earlier",defaultGroup:"unassigned"})}function p(){return s.default.getEligibleGroup({experimentId:"block_limit_increase"})}function m(){const{currentSpaceStore:e}=a.default.state,t=null==e?void 0:e.getSettings().first_invited_member_time;return t?(0,o.O5)(t):null}function f(){return s.default.getEligibleGroup({experimentId:"block_limit_cta_earlier",defaultGroup:"unassigned"})}function g(){const e=m();return null!==e&&(!(null!==e&&e>7)&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_delay",defaultGroup:"control"}))}function h(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettings();return null!=t&&t.seen_block_limit_reduction_v2&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_reduction"})?"decrease":null!=t&&t.seen_block_limit_increase&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_increase"})?"increase":"normal"}function v(){const e=m();return null!==e&&7-e>0?7-e:-1}function b(){return Boolean("on"===s.default.getGroup("churn_nudge"))}function y(e,t){var n;if(e.device.isMobile)return!1;const o=l.subscriptionDataStoreInstance.state;if(!o)return!1;if(("subscribed_admin"===o.type||"unsubscribed_admin"===o.type)&&null!==(n=o.customerData)&&void 0!==n&&n.stripe&&Boolean(o.customerData.stripe.promo))return!1;const i=t??(0,d.zt)();return!!((0,r.mq)(i)&&(0,c.su)(o)<100&&Boolean("on"===s.default.getGroup("largesse")))}function _(){return!(0,c.DB)(l.subscriptionDataStoreInstance.state)&&Boolean("on"===s.default.getGroup("plans_page_refresh"))}function S(){return Boolean("on"===s.default.getGroup("subscription_default_annual"))}function w(){const e=s.default.getGroup("subscription_payment_status");return Boolean("on"===e||"message_only"===e)}function k(){return Boolean("on"===s.default.getGroup("subscription_payment_status"))}function I(){return Boolean(s.default.checkGate("test_clocks"))}function x(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettings();return Boolean(null==t?void 0:t.exposed_to_timed_trials_in_onboarding_v2)}function C(){return Boolean(s.default.checkGate("tt_mm_ent"))}function T(){return Boolean(s.default.checkGate("tt_mm_ent",!0))}function M(){return Boolean("unassigned"===s.default.getEligibleGroup({experimentId:"tt_me_pregunto",defaultGroup:"unassigned"}))}function P(){return Boolean("on"===s.default.getEligibleGroup({experimentId:"tt_me_pregunto",defaultGroup:"unassigned"}))}function A(e){var t;if(!(0,d.QM)())return!1;if((0,i.E3)(e.addOns))return!1;const n=null===(t=a.default.state.currentSpaceStore)||void 0===t?void 0:t.getSettings();return null!=n&&n.exposed_to_timed_trials_in_onboarding?P():null!=n&&n.exposed_to_timed_trials_in_onboarding_v2?C():Boolean("on"===s.default.getGroup("tt_pp"))}function R(){return Boolean(s.default.checkGate("advanced_security_in_enterprise"))}function D(e){return!e.device.isMobile&&Boolean("on"===s.default.getGroup("checkout_name_required"))}function B(e){return!e.device.isMobile&&Boolean("on"===s.default.getGroup("checkout_refresh"))}function E(e){return!e.device.isMobile&&Boolean("on"===s.default.getGroup("upsell_to_plans_page"))}function F(){return Boolean("on"===s.default.getGroup("sidebar_upgrade_nudge"))}function Z(){return Boolean("on"===s.default.getGroup("upsell_colors"))}function V(){return Boolean(s.default.checkGate("use_mp2_update_subscription_path",!0))}function j(){const e=V(),t=Boolean(s.default.checkGate("can_remove_plan_without_removing_addon",!0));return e&&t}function U(){return Boolean("on"===s.default.getGroup("mobile_web_subscriptions"))}},58333:(e,t,n)=>{n.d(t,{AI:()=>p,B:()=>u,Zl:()=>c,_D:()=>l,t4:()=>d,ug:()=>s});n(21703);var o=n(9182),i=n(47425),r=n(63143),a=n(70060);function s(e,t){if(!t)return{plan:void 0,addOns:[],isTrial:void 0};const n=e.items.find((e=>"plan"===(0,o.tw)(e))),i=e.items.filter((e=>"plan"!==(0,o.tw)(e))),r=t.items.find((e=>"plan"===(0,o.tw)(e))),s=t.items.filter((e=>"plan"!==(0,o.tw)(e))),l=n&&!r&&s.length>0,c=(0,a.uO)();if(l&&!c)throw new Error("Cancelling plan while updating addOns is not support by api.updateSubscription");return{isTrial:Boolean(t.trialEnd),plan:null==r?void 0:r.price.externalId,addOns:m(i,s).map((e=>{let[t,n]=e;return{isCancellation:!n,priceId:(n??t).price.externalId}}))}}function l(e,t){return m(e.items,t.items).some((e=>{let[t,n]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const n=(0,o.H6)(e),r=(0,o.H6)(t);if(!n||!r)return!1;return i.rC[n]>i.rC[r]}(t,n)}))}function c(e,t,n){let{trialEnd:o,items:i}=t;return{trialEnd:o,items:i.map((t=>{const o=t.price.product,i=t.price.unitAmount.currencyCode,r=f(e,{interval:n,product:o,currency:i});return{...t,price:r}}))}}function d(e,t){const n=(0,a.uO)();if("plan"===t&&!n)return{...e,items:[]};const i=e.items.filter((e=>(0,o.tw)(e)!==t));return{...e,items:i}}function u(e,t){const n=e.items.filter((e=>(0,o.tw)(e)!==(0,o.h_)(t.product))),i={price:t};return{...e,items:n.concat([i])}}function p(e,t,n){const{product:i,interval:r,currency:a}=n,s=function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(i),l=t.items.filter((e=>(0,o.tw)(e)!==(0,o.h_)(s))),c={price:f(e,{interval:r,product:s,currency:a})};return{...t,items:l.concat([c])}}function m(e,t){return(0,r.UV)(e,(e=>(0,o.tw)(e)),t,(e=>(0,o.tw)(e)))}function f(e,t){let{interval:n,product:o,currency:i}=t;return function(e,t){if(null==e)throw new Error(t);return e}(e.find((e=>"current"===e.state&&e.product===o&&e.billingInterval===n&&e.unitAmount.currencyValue.currencyCode===i)),`Unable to find price with interval: ${n}, product: ${o}, currency: ${i}`)}},88893:(e,t,n)=>{n.d(t,{A7:()=>le,AX:()=>$,AY:()=>S,Bu:()=>B,CM:()=>ue,DB:()=>D,DH:()=>A,Et:()=>z,Fu:()=>he,GD:()=>G,GJ:()=>x,Gh:()=>O,He:()=>_e,Io:()=>de,KU:()=>I,Ln:()=>fe,Lz:()=>q,M9:()=>Q,MM:()=>N,Md:()=>H,ND:()=>oe,NM:()=>ee,NW:()=>J,Nf:()=>ke,Ns:()=>ce,Q6:()=>pe,SX:()=>U,Tj:()=>_,XX:()=>w,XZ:()=>L,YK:()=>R,_9:()=>me,aS:()=>k,cA:()=>te,f3:()=>ye,gG:()=>T,hn:()=>re,lk:()=>ie,m_:()=>ge,o9:()=>ve,pu:()=>K,qF:()=>E,qX:()=>se,qb:()=>j,ri:()=>P,su:()=>ae,t1:()=>Se,uN:()=>X,uo:()=>V,wY:()=>M,wl:()=>C,xR:()=>W,y$:()=>be,ye:()=>Z,zl:()=>ne});n(57658),n(67294);var o=n(72126),i=n(72141),r=n(3791),a=n(31919),s=n(2438),l=n(47425),c=n(97880),d=n(9291),u=n(95477),p=n(52533),m=n(80444),f=n(81236),g=(n(27242),n(88280)),h=n(70060),v=n(33941),b=n(35057),y=n(85893);const _=.9;function S(e){var t;if(x(e))return null===(t=e.customerData)||void 0===t||null===(t=t.stripe)||void 0===t?void 0:t.paymentMethodTrustLevel}function w(e){if(e&&"subscribed_admin"===e.type&&function(e){return void 0!==e.billing}(e.customerData.stripe))return e.customerData.stripe}function k(e){var t;if(x(e))return null===(t=e.customerData)||void 0===t?void 0:t.stripe}function I(e){const t=k(e);return null==t?void 0:t.customerId}function x(e){return"subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)}function C(e){return e&&function(e){const t=w(e);if(t)return t.productId}(e)===u.default.pricing.student.productId}function T(e){return e.startsWith("enterprise")}function M(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&"revenueCat"===e.customerData.activeSubscriptionPlatform&&e.customerData.revenueCat&&!0===e.customerData.revenueCat.isSubscribed)}function P(e){return"verifying"===S(e)}function A(e){const t=w(e);return t&&"number"==typeof t.canceledAt&&"number"==typeof t.willCancelAt}function R(e){return Boolean(e&&"unsubscribed_admin"!==e.type&&"unsubscribed_member"!==e.type&&"unsubscribed_guest"!==e.type)}function D(e){return!!e&&(R(e)||(0,r.E3)(e.addOns))}function B(e){return!R(e)}function E(e){return!we(e,["personal","student","personal_free"])}function F(e){return(0,b.QM)()}function Z(){return(0,b.mq)()}function V(e){return we(e,["personal_free","personal","free"])}function j(e,t){return t===(0,b.zt)()}function U(e,t){const n=(0,h.Xg)();let o=.75;return"25"===n?o=.25:"50"===n&&(o=.5),ne(e,t)>=o}function L(e,t){return ne(e,t)>=.75}async function O(e){const{environment:t,userRootStore:n}=e;if(!n)return;const i=n.getAdminSpaceIds().map((async e=>{const n=await f.Z.awaitPublicSpaceData(t,e);return n&&n.productId})),r=await Promise.all(i);return o.oA(r)}function N(e){var t;const n="subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)?null===(t=e.customerData)||void 0===t?void 0:t.stripe:void 0;return Boolean(null==n?void 0:n.paymentMethodType)}function z(e){const t=w(e);return"unsubscribed_admin"===e.type||"unsubscribed_member"===e.type?e.accountBalance:t?t.accountBalance:0}function W(e){const{environment:t,userRootStore:n}=e;if(!n)return;const i=n.getAdminSpaceIds().map((e=>{const n=f.Z.getPublicSpaceData(t,e);return n&&n.productId}));return o.oA(i)}function q(e,t){const n=ae(t)>1;return B(t)&&F()&&n?t.blockUsage:0}function H(e,t){const{currentUserStore:n}=m.default.state,o=w(t),i=null!=n&&n.isDefined()?n.getEmail():void 0;return e.temporaryBillingEmail||("subscribed_admin"===t.type&&o?o.billingEmail:void 0)||i}function K(){const e=g.subscriptionDataStoreInstance.state,{currentUserStore:t}=m.default.state,n=null!=t&&t.isDefined()?null==t?void 0:t.getEmail():void 0;if(!e)return n;const o=w(e);return"subscribed_admin"===e.type&&null!=o&&o.billing?o.billingEmail:n}function G(e){return e||"month"}function $(e){var t;return(null===(t=w(e))||void 0===t?void 0:t.interval)??"year"}function Q(e){return!!(0,b.QM)()&&((0,p.S$)({environment:e})?"personal":"plus")}function Y(e){const{memberCount:t,subscriptionTier:n,addOnFeature:o,isAddOnFeature:i,billingInterval:r,coupon:a}=e,s=function(e){const{subscriptionTier:t,addOnFeature:n,isAddOnFeature:o}=e;if(!u.default.pricing)return;if(o&&void 0!==n)return u.default.pricing[n].productId;const i=u.default.pricing[t];if("productId"in i)return i.productId}({subscriptionTier:n,addOnFeature:o,isAddOnFeature:i});let l,c,d;return s===u.default.pricing.ai.productId?(l=u.default.pricing.ai.yearlyPricePerMember,c=u.default.pricing.ai.monthlyPricePerMember,"ai_fifty_percent"===a&&(l-=4800,c-=500),d="year"===r?l*t:c*t):s===u.default.pricing.personal.productId?(l=u.default.pricing.personal.yearlyPrice,c=u.default.pricing.personal.monthlyPrice,d="year"===r?l:c):s===u.default.pricing.plus.productId?(l=u.default.pricing.plus.yearlyPricePerMember,c=u.default.pricing.plus.monthlyPricePerMember,d="year"===r?l*t:c*t):s===u.default.pricing.business.productId?(l=u.default.pricing.business.yearlyPricePerMember,c=u.default.pricing.business.monthlyPricePerMember,d="year"===r?l*t:c*t):(l=u.default.pricing.enterprise.yearlyPricePerMember,c=u.default.pricing.enterprise.monthlyPricePerMember,d="year"===r?l*t:c*t),{yearlyUnitPrice:l,monthlyUnitPrice:c,planAmount:d}}function J(e){const t=g.subscriptionDataStoreInstance.state;return e===u.default.pricing.personal.productId||M(t)?"personal":e===u.default.pricing.student.productId?"personal_education":e===u.default.pricing.plus.productId?"plus":e===u.default.pricing.business.productId?"business":e===u.default.pricing.enterprise.productId?"enterprise":e===u.default.pricing.ai.productId?"ai":"legacy"}function X(e){const{subscriptionTier:t,currencyCode:n,promo:o,data:i,onlyShowAddOn:r,calculatingTax:l,taxAmount:c,addOnFeature:u,billingInterval:p,coupon:m}=e,f=ae(i),g=Math.min(0,z(i));let h=0,v=0,b=0;const _=void 0!==u;if(!r){const e=Y({subscriptionTier:t,memberCount:f,isAddOnFeature:!1,billingInterval:p});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}if(_){const e=Y({subscriptionTier:t,memberCount:f,isAddOnFeature:!0,addOnFeature:u,billingInterval:p,coupon:m});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}const S=(0,s.uN)(b,o),w=a.n.fromValue({amount:b-S.amount+g+(c&&!l?c:0),currencyCode:n}).zeroIfNegative(),k=[{type:"standard",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.subTotal",defaultMessage:"Subtotal"}),price:a.n.fromValue({amount:b,currencyCode:n})}];return k.push({type:l?"calculating":"standard",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.taxIfApplicable.title",defaultMessage:"Tax if applicable"}),price:a.n.fromValue({amount:b,currencyCode:n})}),0!==S.amount&&k.push({type:"promotion",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo",defaultMessage:"Coupon"}),price:a.n.fromValue({amount:S.amount,currencyCode:n}),subtitle:S.monthsRemaining?(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo.subtitle",defaultMessage:"Valid for {durationInMonths} months",values:{durationInMonths:S.monthsRemaining}}):void 0}),g<0&&k.push({type:"promotion",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.balance",defaultMessage:"Balance"}),price:a.n.fromValue({amount:-g,currencyCode:n})}),{yearlyUnitPrice:h,monthlyUnitPrice:v,planAmount:b,payAmount:w,accountBalance:g,lineItems:k,promoInfo:S}}function ee(e){return"bots"in e?e.bots:[]}function te(e,t){if((0,h.du)()&&fe(e,t)){const e=(0,h.fQ)(),t=(()=>{switch(e){case 0:return(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitToday",defaultMessage:"to upgrade today"});default:return(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitNumDays",defaultMessage:"{remainingDays, plural, one {1 day to upgrade} other {{remainingDays} days to upgrade}}",values:{remainingDays:e}})}})();return(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimit",defaultMessage:"You've hit Notion's trial block limit, and you have {remainingDaysMessage} before we limit new content creation.",values:{remainingDaysMessage:t}})}return(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.reachedFreeBlockLimit",defaultMessage:"This workspace has used {usedBlocks} of its {freeBlockLimit} block storage limit ({utilizationPercentage}).",values:{usedBlocks:q(0,t),freeBlockLimit:(0,l.v5)((0,h.fw)()),utilizationPercentage:(0,y.jsx)(d.FormattedNumber,{value:ne(e,t),style:"percent",maximumSignificantDigits:2,maximumFractionDigits:0})}})}function ne(e,t){return q(0,t)/(0,l.v5)((0,h.fw)())}function oe(e){return ue(e).filter((e=>!(0,i.Jy)(e.role)))}function ie(e){return oe(e).length}function re(e){return ue(e).filter((e=>(0,i.Jy)(e.role)))}function ae(e){return re(e).length}function se(){const e=g.subscriptionDataStoreInstance.state;return e?ae(e):1}function le(){const e=g.subscriptionDataStoreInstance.state;return e?oe(e):[]}function ce(){const e=se();return e<=99?"SMB":e<=1999?"Mid-Market":"Enterprise"}function de(){const e=g.subscriptionDataStoreInstance.state;return e?re(e):[]}function ue(e){return"visibleUsers"in e?e.visibleUsers:e.users}function pe(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&e.customerData.stripe.isSubscribed&&("enterprise_free"===e.customerData.stripe.plan||"business_sales_assisted"===e.customerData.stripe.plan||"plus_sales_assisted"===e.customerData.stripe.plan))}function me(e){return"unsubscribed_member"===e.type||"unsubscribed_admin"===e.type||"subscribed_member"===e.type||"subscribed_admin"===e.type||"subscribed_membership_admin"===e.type}function fe(e,t){return q(0,t)>=(0,l.v5)((0,h.fw)())}function ge(e){return l.wP(e)?"setup_enterprise_trial":l.NG(e)?"setup_business_trial":void 0}function he(e){return!1}function ve(e){return l.QM(e)}function be(e){return!F()}function ye(e){return!F()}function _e(){return l.hf((0,b.zt)())}function Se(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(v.a.free);case"personal":return t.formatMessage(v.a.personal);case"student":return t.formatMessage(v.a.educationPlan);case"plus":return t.formatMessage(v.a.plusPlan);case"business":return t.formatMessage(v.a.business);case"enterprise":return t.formatMessage(v.a.enterprise);default:(0,c.t1)(e)}}function we(e,t){const n=(0,b.zt)();return!!n&&t.includes(n)}function ke(e){const{subscriptionData:t,spaceStore:n}=e;return!M(t)&&((null==n?void 0:n.canAdmin())??!1)}},33941:(e,t,n)=>{n.d(t,{D:()=>r,a:()=>i});var o=n(9291);const i=(0,o.defineMessages)({ai:{defaultMessage:"AI",id:"ai.title"},personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),r=(0,o.defineMessages)({ai:{defaultMessage:"Notion AI",id:"spaceSubscriptionUpgradeModal.orderSummary.ai.addOn"},personal:{defaultMessage:"Plus plan with a 1-member limit",id:"spaceSubscriptionUpgradeModal.orderSummary.singlePlayerPlusPlan"},plus:{defaultMessage:"Plus plan",id:"spaceSubscriptionUpgradeModal.orderSummary.plusPlan"},business:{defaultMessage:"Business plan",id:"spaceSubscriptionUpgradeModal.orderSummary.businessPlan"},enterprise:{defaultMessage:"Enterprise plan",id:"spaceSubscriptionUpgradeModal.orderSummary.enterprisePlan"}})},35057:(e,t,n)=>{n.d(t,{Aw:()=>p,Mk:()=>d,QM:()=>c,Rs:()=>s,iJ:()=>m,mq:()=>u,p4:()=>f,sX:()=>a,wP:()=>l,zt:()=>r});var o=n(47425),i=n(88280);function r(){var e;return o.O9(null===(e=i.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)}function a(){return o.sX(r())}function s(){return o.Rs(r())}function l(){return o.wP(r())}function c(){return o.QM(r())}function d(){return o.Mk(r())}function u(){return o.mq(r())}function p(){return o.Aw(r())}function m(){return o.iJ(r())}function f(e){return o.eZ(r(),e)}},87598:(e,t,n)=>{n.d(t,{z:()=>o});const o=(0,n(9291).defineMessages)({cancellingTrial:{defaultMessage:"Cancelling your trial.",id:"cancelTrial.error.message"},cancellationConfirmationMessage:{defaultMessage:"Are you sure you want to cancel your trial?",id:"cancelTrial.confirmation.message"},yes:{defaultMessage:"Yes, cancel my trial",id:"cancelTrial.yes.confirmation.message"}})},63423:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},62142:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),i=n(4615),r=n(27242);class a extends o.default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:(0,i.ZP)(),type:r.U.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const s=new a},33493:(e,t,n)=>{n.d(t,{Z:()=>d});n(21703);var o=n(49085),i=n(92595),r=n(64793),a=n(12139),s=n(80444),l=n(22616);class c extends o.default{constructor(){var e;let t,n;super(),e=this;const o=()=>{if("ready"!==this.state.status)return;const e=this.state.prices.map((e=>{const t=Math.floor(100*Math.random()),n=Math.floor(e.unitAmount.amount/100);return new r.tA({external_id:e.externalId,product:e.product,billing_interval:e.billingInterval,currency:e.currencyCode,state:e.state,regions:e.regions,unit_amount:100*n+t})}));this.setPrices(e)};(0,i.exposeDebugValue)("randomizePrices",(function(){let i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("ready"!==e.state.status)return;const r=Boolean(n);i!==r&&(n&&(clearInterval(n),n=void 0),i?(t=e.state.prices,n=setInterval(o,1e3),o()):t&&e.setPrices(t))}))}getInitialState(){return{status:"init",prices:[],availableCurrencyCodes:["USD"],selectedCurrencyCode:void 0}}resetExceptSelectedCurrencyCode(){this.update((e=>({...this.getInitialState(),selectedCurrencyCode:e.selectedCurrencyCode})))}waitUntilReady(){return this.waitUntil((()=>"ready"===this.state.status))}setPrices(e){this.update((t=>{const n=Array.from(new Set(e.map((e=>e.currencyCode))));n.sort();const o=t.selectedCurrencyCode&&n.includes(t.selectedCurrencyCode)?t.selectedCurrencyCode:n.find((e=>"USD"!==e))??"USD";return{...t,status:"ready",prices:e,availableCurrencyCodes:n,selectedCurrencyCode:o}}))}didStartLoading(){this.update((e=>({...e,status:"loading"})))}getPrice(e,t){const{status:n,selectedCurrencyCode:o}=this.state;if("init"===n){var i;const t=null===(i=s.default.state.currentSpaceStore)||void 0===i?void 0:i.id;t&&l.Zz({environment:e,spaceId:t})}if("ready"!==n)return{isLoaded:!1,result:void 0};const r=this.state.prices,c=r.filter((e=>e.currencyCode===o)),d=c.find(t);return d||a.IE(new Error("No matching price found in PriceStore.getPrice"),{extra:{allPriceCount:r.length,selectedCurrencyCode:o,selectedCurrencyPriceCount:c.length}}),{isLoaded:!0,result:d}}get selectedCurrencyCode(){return this.state.selectedCurrencyCode??"USD"}get availableCurrencyCodes(){return this.state.availableCurrencyCodes}get prices(){return this.state.prices}}const d=new c},25692:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},88280:(e,t,n)=>{n.r(t),n.d(t,{SubscriptionDataStore:()=>i,subscriptionDataStoreInstance:()=>r});var o=n(49085);class i extends o.default{constructor(){super(...arguments),this.spaceId=void 0}getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}}const r=new i},99334:(e,t,n)=>{let o;function i(e){o=e}function r(){return o}n.d(t,{$:()=>i,K:()=>r})},9867:(e,t,n)=>{n.d(t,{wT:()=>se,aQ:()=>ye,ED:()=>Ce,mX:()=>X,w6:()=>me,Ui:()=>we,Xy:()=>Te,Uj:()=>pe,Cj:()=>ue,um:()=>ce,s:()=>he,Dv:()=>ge,lo:()=>ae,tn:()=>xe,hI:()=>Ie,mN:()=>be,WO:()=>ve,X0:()=>oe,YH:()=>_e,JX:()=>ke,Ju:()=>ie,$J:()=>J,jg:()=>re,xI:()=>Y,lH:()=>$,fs:()=>K,$x:()=>G,d:()=>Se,W8:()=>te,Ce:()=>ee,RF:()=>fe});n(21703),n(57658);var o=n(15145),i=n(5220),r=n(68626),a=n(91155),s=n(86517),l=n(72141),c=n(15047),d=n(29369),u=n(19889),p=n(90965),m=n(64684),f=n(97880),g=n(63143),h=n(50906),v=n(91536),b=n(54642),y=n(47307),_=n(76464),S=n(9953),w=n(75754),k=n(29974),I=n(150),x=n(82530),C=n(65452),T=n(28020),M=n(33929),P=n(45010),A=n(78122),R=n(21115),D=n(27406),B=n(68418),E=n(38676),F=n(55838),Z=n(77999),V=n(80444),j=n(3418),U=n(26136),L=n(42185),O=n(30397),N=n(34583),z=n(35057),W=n(30297),q=n(60396),H=n(36225);function K(e){const{store:t,update:n,transaction:o}=e;S.sW({store:t,data:(0,g.Q2)(n),transaction:o})}function G(e){let{environment:t,store:n,update:o,transaction:i}=e;const r=function(e){let{store:t,update:n}=e;const o=t.getSettingsStore().getValue();if(!o)return{};const i={};for(const r in n)i[r]=o[r];return i}({store:n,update:o});S.sW({store:n.getSettingsStore(),data:(0,g.Q2)(o),transaction:i}),h.ORE(t,{store:n,old_settings:r,updated_settings:o})}async function $(e){let{environment:t,spaceValue:n,addedStores:o,removedStores:i,createNewTeamFlowId:r,from:a}=e;const s=t.currentUser.id;if(!s||o.some((e=>!e.isDefined())))return!1;if(!(0,p.wv)(n,s))throw new Error("Only admins can update default teams");const{performResult:{results:l},serverCommitResult:c}=x.createAndCommit({environment:t,userAction:"teamActions.updateDefaultTeams",perform:e=>{const n=[];for(const i of o){const o=Q({environment:t,transaction:e,teamStore:i,isDefault:!0,from:a,createNewTeamFlowId:r});n.push(o)}for(const o of i){const i=Q({environment:t,transaction:e,teamStore:o,isDefault:!1,from:a,createNewTeamFlowId:r});n.push(i)}return{results:n}}});return await c,await N.bi(t),l.every((e=>e))}function Q(e){let{environment:t,transaction:n,teamStore:o,isDefault:i,from:r,createNewTeamFlowId:a}=e;return o.isDefault()===i||(S.sW({store:o,data:{is_default:i},transaction:n}),n.postSubmitCallbacks.push((e=>{e||h.cXp(t,{store:o,is_default_team:i,create_new_team_flow_id:a,from:r})}))),!0}function Y(e){var t;const{environment:n,teamStore:o,newRole:i,transaction:r,permissionsToClear:a}=e,s=a.map((e=>({...e,role:"none"}))),c=(null===(t=o.getTeamPermission())||void 0===t?void 0:t.role)??"none",d={type:"explicit_team_permission",team_id:o.id,role:i};s.push(d),_.ep({environment:n,store:o,permissionItems:s,transaction:r}),o.isDefault()&&_.ep({environment:n,store:o,permissionItems:[{type:"space_permission",role:i}],transaction:r}),(0,l.J5)(c)||!(0,l.J5)(i)||o.getDisableTeamPageEdits()||G({environment:n,store:o,update:{disable_team_page_edits:!0},transaction:r})}function J(e){const{environment:t,teamStore:n,newRole:o,transaction:i,permissionsToClear:r}=e,a=r.map((e=>({...e,role:"none"}))),s={type:"explicit_team_guest_permission",team_id:n.id,role:o};a.push(s),_.ep({environment:t,store:n,permissionItems:a,transaction:i})}function X(e){let{userId:t,teamStore:n,transaction:o,environment:i,permissionRole:r}=e;const a=n.getMembershipDefinedOnTeam(),l=a.find((e=>"user"===e.entity_type&&e.user_id===t));if(!l)throw new Error("Specified user is not on the team");if("member"===l.type)return!1;if(!n.isDefined())return!1;const c=n.getPermissionItems(),d=n.id;if(r&&(0,s.bk)({teamValue:{id:d,permissions:c},permissionRole:r}))throw new Error("Cannot set member's permission to be lower than default team permission.");if(!(0,m.XO)({membership:a}).includes(t))throw new Error("Specified user is not an owner of the team");let u=!1;if(a.length>0){const e=a.filter((e=>!("user"===e.entity_type&&e.user_id===t)));u=a.length!==e.length;const r=[{entity_type:"user",type:"member",user_id:t},...e];x.applyOperation({store:n,operation:{pointer:n.pointer,path:["membership"],command:"set",args:r},transaction:o}),v.Pd(i,{store:n,permission_user_id:t,team_role:"member"})}let p=r||"none";const f=(0,m.xC)({id:d,permissions:c});f&&r===f&&(p="none");const g={type:"user_permission",role:p,user_id:t};return _.ep({environment:i,store:n,permissionItems:[g],transaction:o,skipAnalytics:u})}function ee(e){let{environment:t,userId:n,teamStore:o,spaceStore:i,transaction:r,newTeamRole:a}=e;if(!o.isDefined())return!1;const s=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));return!!s&&(s.type!==a&&(x.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"setTeamMembershipItem",args:{entity_type:"user",type:a,user_id:n}},transaction:r}),_.ep({environment:t,store:i,permissionItems:[{type:"user_permission",role:"read_and_write",user_id:n}],transaction:r}),oe({environment:t,memberInfo:s,teamStore:o,transaction:r}),!0))}function te(e){let{environment:t,userId:n,teamStore:o,transaction:i}=e;const r=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));if(!r)throw new Error("Specified user is not on the team");if("owner"===r.type)return!1;if(!o.isDefined())return!1;const a=o.getMembershipDefinedOnTeam().filter((e=>!("user"===e.entity_type&&e.user_id===n))),s=[{entity_type:"user",type:"owner",user_id:n},...a];return x.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"set",args:s},transaction:i}),v.Pd(t,{store:o,permission_user_id:n,team_role:"owner"}),oe({environment:t,memberInfo:r,teamStore:o,transaction:i}),!0}function ne(e){let{memberInfo:t,newRole:n}=e;return"user"===t.entity_type?{type:"user_permission",user_id:t.user_id,role:n}:{type:"group_permission",group_id:t.group_id,role:n}}function oe(e){let{environment:t,memberInfo:n,teamStore:o,transaction:i}=e;return!!o.getPermissionItems()&&(_.ep({environment:t,store:o,permissionItems:[ne({memberInfo:n,newRole:"none"})],transaction:i}),!0)}async function ie(e){let{store:t,environment:n,accessLevel:o,teamName:i,from:r,isDefault:a}=e;const{currentSpaceStore:s}=V.default.getState();if(!s)throw new Error("currentSpaceStore does not exist");const l=t.isDefault()??!1,c=t.getTeamAccessLevel(),d=(0,m.Hf)({membership:t.getRawMembership()}).length;if(o===c&&a===l)return!1;if(!(await A.hL({teamName:i,accessLevel:o,currentIsDefault:l,isDefault:a,numberOfTeamGuests:d})))return!1;const u=t.getPermissionItems(),p=t.getSettingsStore().getValue();if(!p||!u)return!1;const f=(0,m.AW)({teamValue:{id:t.id,permissions:u,settings:p},accessLevel:o,isDefault:a}),{performResult:{result:g}}=x.createAndCommit({userAction:"teamActions.setTeamAccessLevel",environment:n,perform:e=>{Q({environment:n,transaction:e,teamStore:t,isDefault:"invite_only"!==f.settings.space_member_join_access&&a,from:r,createNewTeamFlowId:void 0});const o=_.ep({environment:n,store:t,permissionItems:f.permissions,transaction:e});return S.sW({store:t.getSettingsStore(),data:f.settings,transaction:e}),{result:o}}});return g&&h.BWF(n,{store:t,old_access_level:c,new_access_level:o,from:r}),g}function re(e){let{memberInfo:t,teamStore:n,transaction:o,environment:i,permissionRole:r}=e;if("owner"===t.type)return X({userId:t.user_id,teamStore:n,transaction:o,environment:i,permissionRole:r});if(!n.isDefined())return!1;const a=n.id,l=n.getPermissionItems(),c=n.getMembers();if(r&&(0,s.bk)({teamValue:{id:a,permissions:l},permissionRole:r}))throw new Error("Cannot set member's permission to be lower than default team permission.");const d=(0,m.hY)({membership:c});if("user"===t.entity_type&&!d.find((e=>"user"===e.entity_type&&e.user_id===t.user_id))||"group"===t.entity_type&&!d.find((e=>"group"===e.entity_type&&e.group_id===t.group_id)))throw new Error("Specified memberInfo not found on team");let u=r||"none";const p=(0,m.xC)({id:a,permissions:l});return p&&r===p&&(u="none"),_.ep({environment:i,store:n,permissionItems:[ne({memberInfo:t,newRole:u})],transaction:o})}function ae(e,t){B.Z.setState({...B.Z.state,open:!0,from:e}),B.Z.state.onClose=null==t?void 0:t.onClose}async function se(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:i,action:r}=e;const a=t.currentUser.id;if(!a||!n||!(0,W.o)({userId:a,spaceStore:n,entrypoint:i}))return!1;if(!(await async function(e){return!H.Z.state.open&&await new Promise((t=>{H.Z.setState({open:!0,type:e,onAccept:()=>t(!0),onCancel:()=>t(!1)})}))}(r)))return!1;const s=await b.setAdminPrivilegedTeamMembership(t,{spaceId:n.id,teamId:o.id,teamRole:le(r)});if("failed"===s.type)return Te(s),!1;switch(r){case"joinTeamAsOwner":case"joinClosedOrPrivateTeamAsMember":de({environment:t,teamStore:o,from:i,newRole:"joinTeamAsOwner"===r?"owner":"member",usingAdminPrivileges:!0,andNavigateToTeamHome:!1});break;case"upgradeToOwner":v.Pd(t,{permission_user_id:a,team_role:"owner",store:o});const e=o.getName();e&&(0,R._t)(e);break;default:(0,f.t1)(r)}return!0}function le(e){switch(e){case"joinTeamAsOwner":case"upgradeToOwner":return"owner";case"joinClosedOrPrivateTeamAsMember":return"member";default:(0,f.t1)(e)}}async function ce(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:i,andNavigateToTeamHome:r}=e;const a=t.currentUser.id;if(!a)return!1;const s=await b.updateTeamMembers(t,{spaceId:n.id,teamId:o.id,newMembersOrGuestsToAdd:[{type:"member",entity_type:"user",user_id:a}]});return"failed"===s.type?(Te(s),!1):(de({environment:t,teamStore:o,from:i,newRole:"member",usingAdminPrivileges:!1,andNavigateToTeamHome:r}),!0)}function de(e){let{environment:t,teamStore:n,from:o,newRole:i,usingAdminPrivileges:r,andNavigateToTeamHome:a}=e;const s=t.currentUser.id,l=V.default.state.currentSpaceStore,c=V.default.state.currentSpaceViewStore;if(!s||!l||!c)return!1;!function(e){var t;let{environment:n,currentSpaceViewStore:o,teamId:i}=e;const r=null===(t=(0,T.k_)(n).state)||void 0===t?void 0:t.userJoinedTeamsStores;if(!r||!o)return!1;const a=[...r.map((e=>{let{id:t}=e;return t})).filter((e=>e!==i)),i];I.Ct({environment:n,currentSpaceViewStore:o,orderedTeamIds:a,userAction:"TeamBrowserOutliner",isExplicitUserAction:!1})}({environment:t,currentSpaceViewStore:c,teamId:n.id}),h.UD9(t,{store:n,joined_role:i,from:o}),C.l({environment:t,userId:s,spaceId:l.id});const d=n.getName();a?(Ie({environment:t,teamStore:n,shouldScroll:!1}),d&&new Promise((e=>setTimeout(e,500))).then((()=>{(0,R.$$)({teamName:d,usingAdminPrivileges:r})}))):d&&(0,R.$$)({teamName:d,usingAdminPrivileges:r})}async function ue(e){let{environment:t,teamId:n,spaceId:o,teamMemberInfos:i,isSettingDefaultTeam:r,inviterId:a}=e;const s=t.currentUser.id;if(!o||!s)return!1;return"failed"!==(await b.updateTeamMembers(t,{spaceId:o,teamId:n,newMembersOrGuestsToAdd:i,isSettingDefaultTeam:r,addNewMembersToSpace:!1},a)).type}async function pe(e){let{environment:t,teamStore:n,teamMemberInfos:o,isSettingDefaultTeam:i,createNewTeamFlowId:r}=e;const a=n.getSpaceId();if(!a)return!1;const s=t.currentUser.id;if(!a||!s)return!1;if("failed"===(await b.updateTeamMembers(t,{spaceId:a,teamId:n.id,newMembersOrGuestsToAdd:o,isSettingDefaultTeam:i,addNewMembersToSpace:(0,z.Mk)()},s)).type)return!1;if(!i){const e=o.flatMap((e=>"user"!==e.entity_type?[]:e.user_id)),i=e.length,a=o.filter((e=>"group"===e.entity_type)).length;i>0&&h.ixp(t,{store:n,num_members_invited:i,create_new_team_flow_id:r,members_invited:e}),a>0&&h.$1W(t,{store:n,num_groups_invited:a,create_new_team_flow_id:r})}return!0}function me(e){switch(e){case"team_browser":case"duplicate_team":case"create_team_from_page":case"permission_item":case"teams_dropdown_for_team_guest":case"teams_dropdown_for_team_member":case"teams_dropdown_for_group":case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":case"team_breadcrumb_popup":case"team_menu_header":case"sidebar_team_modal":case"team_invite_link":case"teams_dropdown_space_settings_people":return!1;case"manage_teams_table":return!0;default:(0,f.t1)(e)}}function fe(e){let{environment:t,teamId:n,tab:o,from:i,buttonPopupStore:r}=e;const a=V.default.state.currentSpaceStore;if(!a)return;const s=U.zX.createChildStore(a,{table:d.e0,id:n});if(s.canRead())F.Z.update((e=>({...e,open:!0,tab:o,teamStore:s,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!1})));else{const e=ge({environment:t,spaceStore:a,teamId:n,from:i});if(!e)return;F.Z.update((t=>({...t,open:!0,tab:o,unjoinedPrivateTeamStore:e,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!0})))}r&&(j.Z.removeNamedPopup("team_more_actions"),r.setState({...r.state,open:!1}))}function ge(e){var t;let{environment:n,spaceStore:o,teamId:r,from:a}=e;if(!me(a))return;const s=o.getModel(),l=null===(t=V.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!(0,i.Hx)({spaceModel:s,userId:l}))return;const c=q.Z.createTeamStoreFromCache({environment:n,teamId:r,spaceId:o.id,userId:l}),d=null==c?void 0:c.getModel();return null!=c&&c.canRead()&&d&&(0,m.Ei)({userId:l,teamModel:d,spaceModel:s})?c:void 0}async function he(e){let{environment:t,teamStore:n,currentSpaceStore:o,from:i}=e;const r=t.currentUser.id;return!!r&&await ve({environment:t,teamStore:n,currentSpaceStore:o,userId:r,from:i})}async function ve(e){let{environment:t,teamStore:n,currentSpaceStore:o,userId:i,from:r}=e;const a=n.getSpaceId();if(!(n.isDefined()&&null!=o&&o.isDefined()&&t.currentUser.id&&a))return!1;const s=n.getMembers(),l=(0,m.XO)({membership:s}),c=l.some((e=>e===i));if(c&&1===l.length)return A.ZH(),!1;const d=(0,m.x4)({members:s,groups:o.getPermissionGroups()}).filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(i)}));if(!n.getMembers().find((e=>"user"===e.entity_type&&e.user_id===i)))return A.T0(d),!1;const p=U.t1.createChildStore(n,{table:u.KJ,id:i}),f=i===t.currentUser.id,g=n.getName()??"",v=p.getDisplayName(M.default.getIntl());if(!(await A.A8({isCurrentUser:f,teamName:g,memberName:v})))return!1;const y=[{entity_type:"user",type:c?"owner":"member",user_id:i}],_=await b.updateTeamMembers(t,{spaceId:a,teamId:n.id,existingMembersOrGuestsToRemove:y});return"failed"===_.type?(Te(_),!1):(h.$aC(t,{store:n,is_leaving_team:f,num_members_removed:y.length,from:r}),d.length>0?f?(0,R.K9)(g,d):(0,R.zs)(v,g,d):f&&(0,R.e6)(g),C.l({environment:t,userId:i,spaceId:a}),!0)}function be(e){let{environment:t,teamStore:n,group:o}=e;const i=n.getSpaceId();if(!i)return;const r=n.getMembers().find((e=>"group"===e.entity_type&&e.group_id===o.id));r&&A.iT({group:o,onAccept:async()=>{const e=[r],o=await b.updateTeamMembers(t,{spaceId:i,teamId:n.id,existingMembersOrGuestsToRemove:e});"failed"!==o.type?h.miu(t,{store:n,num_groups_removed:e.length}):Te(o)}})}async function ye(e){const{currentSpaceStore:t}=V.default.getState();if(!t)throw new Error("currentSpaceStore does not exist");const{environment:n,teamStore:o,from:i}=e,r=n.currentUser.id,a=o.getName()||"",d=t.getSettingsStore();if(!r)return;const u=O.Z.state.teams.map((e=>({membership:e.getMembers(),id:e.id,archived_by:e.getArchivedBy(),is_default:e.isDefault()}))),p=(0,s.wN)({spaceValue:{permissions:t.getPermissionItems(),permission_groups:t.getPermissionGroups()},teamsInSpace:u,currentUserId:r});if(await A.Fy(a,p)){if(p){const e=await A.wG(a);x.createAndCommit({userAction:"teamsHelpers.archiveLastTeam",environment:n,perform:n=>{if(K({store:o,update:{archived_by:r,archived_at:Date.now()},transaction:n}),S.sW({store:d,data:{is_teams_enabled:!1},transaction:n}),k.oy({planType:"personal",spaceStore:t,transaction:n}),e){const e=o.getTeamPagesStores()??[];for(const o of e){const e=o.getRole();if(!e)continue;const i={type:"user_permission",user_id:r,role:e},a=[...o.getPermissionItems().filter((e=>!l.fG(e)&&!l.Le(e)&&!l.ix(e))),i];S.sW({store:o,data:{parent_id:t.id,parent_table:c.bx,permissions:a},transaction:n})}S.sW({store:o,data:{team_pages:[]},transaction:n})}}}),h.mFL(n,{store:o,from:i})}else x.createAndCommit({userAction:"teamsHelpers.archiveTeam",environment:n,perform:e=>{K({store:o,update:{archived_by:r,archived_at:Date.now()},transaction:e})}});h.Gpy(n,{store:o,from:i}),"inactive"!==Z.default.state.type&&Z.default.setState({type:"inactive"}),F.Z.setState({open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}),(0,R.CC)(a)}}function _e(e){let{environment:t,teamStore:n,teamName:o,from:i}=e;x.createAndCommit({userAction:"teamsHelpers.restoreArchivedTeam",environment:t,perform:e=>{K({store:n,update:{archived_by:void 0,archived_at:void 0},transaction:e})}}),h.IWJ(t,{store:n,from:i}),(0,R.JB)(o)}async function Se(e){let{settingName:t,newTeamSettingValue:n,spaceSettingValue:o,environment:i,store:r}=e;let a=!0;return"disable"===o&&"allow"===n?a=await A.hC(t):"disable"===n&&(a=await A.Bj(t)),!!a&&(x.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:i,perform:e=>{G({environment:i,store:r,update:{[t]:"disable"===n},transaction:e})}}),!0)}function we(e){return`TeamToggle_${e.id}`}function ke(e){let{teamStore:t,environment:n}=e;if(n.device.isMobile)return;const o=we(t),i=D.Z.findDropTargetFromKey(o);if(i){const e=i.getNode();if(!(e instanceof HTMLElement))return;if(P.Z.SidebarScroller){var r;const n=(null===(r=P.Z.SidebarScroller.scrollerEl())||void 0===r?void 0:r.offsetTop)||0;P.Z.SidebarScroller.scrollTo(e.offsetTop-n,0,{animate:!0}),L.Z.setState(t.id),setTimeout((()=>{L.Z.state===t.id&&L.Z.setState(void 0)}),1500)}}}function Ie(e){const{environment:t,teamStore:n,shouldScroll:i}=e;i&&ke({teamStore:n,environment:t});const r=n.getTeamPagesStores();!r||r.length<1||(w._({environment:t,store:r[0],pageVisitSource:o.tY.JoinTeam}),h.SJp(t,{store:n}))}function xe(e,t){let{from:n}=t;h.piC(e,{from:n}),E.sidebarShowTeamBrowserStore.setState(!E.sidebarShowTeamBrowserStore.state)}function Ce(e){let{environment:t,from:n,teamStore:o}=e;const{state:i}=B.Z;var r,a;(h.Prc(t,{screen:i.screen,team_id:i.teamId,team_has_icon:Boolean(i.icon),team_has_name:Boolean(i.name),team_has_description:Boolean(i.description),team_access_level:i.accessLevel,flow_id:i.flowId,from:n,store:o}),i.teamId)&&(null===(r=(a=B.Z.state).onClose)||void 0===r||r.call(a,i.teamId));B.Z.reset()}function Te(e){y.showError(e),r.log({level:"error",from:"teamActions",type:"TeamApiError",error:(0,a.Ui)(e.error),data:{miscDataToConvertToString:{body:e.body,status:e.status}}})}},73292:(e,t,n)=>{n.d(t,{RW:()=>l,k7:()=>s,oO:()=>c});var o=n(15157),i=n(50906),r=n(77999),a=n(70704);function s(e){const{environment:t,spaceViewStore:n,teamStore:a,outlinerToggleButtonStore:s,newIsHidden:c,shouldPersistToggleState:d,isExplicitUserAction:u}=e;s.setState({...s.state,isHidden:c}),u&&i.MRb(t,{store:a,is_toggled:!c,outliner_type:e.teamOutlinerType}),d&&o.Z.set({userId:n.environment.currentUser.id,key:l(n,a.id),value:c}),c&&r.default.setState({type:"inactive"})}function l(e,t){return`Team_Outliner_Item_${e.id}:${t}`}function c(e){let{oldState:t,teamIds:n,spaceId:i,userId:r}=e;return n.reduce(((e,n)=>{if(n in e)return e;if(n in t)return e[n]=t[n],e;const s=l({id:i},n),c=o.Z.get({userId:r,key:s});return e[n]=new a.Z,e[n].setState({isHidden:c??!1}),e}),{})}},28517:(e,t,n)=>{n.d(t,{I:()=>s,m:()=>l});n(21703);var o=n(72126),i=n(54642),r=n(95697),a=n(69911);async function s(e){let{environment:t,spaceId:n,userId:o}=e;if(!t.currentUser.loggedInUserIds.includes(o))throw new Error("Must be logged in user.");(0,r.bq)()&&(a.Z.getUserJoinedTeamsState({userId:o,spaceId:n})||await l({environment:t,spaceId:n,userId:o}))}async function l(e){var t;let{environment:n,spaceId:r,userId:s,emitValue:l}=e;if(!n.currentUser.loggedInUserIds.includes(s))throw new Error("Must be logged in user.");a.Z.setHasFetched({userId:s,spaceId:r});const c=await i.getTeams(n,{spaceId:r,onlyJoined:!0},s);if("failed"===c.type)return;const d=c.data.teamIds,u=(null===(t=a.Z.getUserJoinedTeamsState({userId:s,spaceId:r}))||void 0===t?void 0:t.joinedTeamsIds)||[];d.length===u.length&&0===o.e5(d,u).length&&0===o.e5(u,d).length||a.Z.setUserJoinedTeamsState({userId:s,spaceId:r,state:{joinedTeamsIds:d,lastEmitValue:l}})}},74016:(e,t,n)=>{n.d(t,{p:()=>m});n(67294);var o=n(480),i=n(86628),r=n(24405),a=n(79362),s=n(22808),l=n(31278),c=n(38755),d=n(80444),u=n(26136),p=n(85893);function m(e){window.__c={n:"TeamSpaceIcon"};const{store:t,size:n=16,style:m,disabled:f=!1,onChange:g=(()=>{})}=e,h=(0,o.O7)(),{name:v,icon:b}=(0,i.VK)((()=>{const n=d.default.state.currentSpaceStore;return t?t instanceof u.zX?{name:t.getName(),icon:e.icon??t.getIcon()}:{name:(0,c.rn)(h,t),icon:e.icon??(0,c.Wd)(h,t)}:{name:n&&`team-icon-${n.id}`,icon:e.icon}}),[t,h,e.icon]),y=(0,r.yK)((e=>({backgroundContainer:{background:b&&(0,a.V2)(b.icon)?(0,a.Pk)(b.icon,e.mode):e.regularDividerColor,width:n,height:n}})),[b,n]),_=b&&b.icon&&((0,a.V2)(b.icon)||(0,s.Z)(b.icon)),S=e.iconLoggingData||t&&{recordTable:t.table,source:"team_settings"};return(0,p.jsx)(l.Z,{title:v,icon:b,size:_?.9*n:n,emojiSize:_?.78*n:n,isEmptyPage:!1,style:_?{...m,...y.backgroundContainer}:m,isLarge:!0,largeIcon:!0,iconLoggingData:S,...f?{disabled:!0}:{disabled:!1,onChange:g,bucket:"public"}})}},30297:(e,t,n)=>{n.d(t,{o:()=>l,r:()=>c});var o=n(480),i=n(86628),r=n(5220),a=n(80444),s=n(9867);function l(e){let{entrypoint:t,userId:n,spaceStore:o}=e;return(0,r.Hx)({spaceModel:null==o?void 0:o.getModel(),userId:n})&&s.w6(t)}function c(e){const t=(0,o.O7)().currentUser.id;return(0,i.VK)((()=>{const{currentSpaceStore:n}=a.default.state;return l({entrypoint:e,spaceStore:n,userId:t})}),[t,e])}},60396:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(26263),i=n(49085),r=n(29369),a=n(97880),s=n(20431);class l extends i.default{getInitialState(){return{initialized:!1}}createTeamStoreFromCache(e){let{environment:t,teamId:n,spaceId:o,userId:i}=e;if(this.state.initialized&&o&&i&&this.state.spaceId===o&&this.state.userId===i)return new s.z(t,{table:r.e0,id:n},{inMemoryRecordCache:this.state.inMemoryCache})}initialize(e){let{environment:t,userId:n,spaceId:i,teamIds:s,getRecordWithRole:l}=e;const c=new o.Z({name:"GlobalEnterpriseAdminTeamsStore"});for(const o of s){const e={table:r.e0,id:o};c.setRecord({pointer:e,userId:n},l(e))}return this.setState({initialized:!0,spaceId:i,userId:n,inMemoryCache:c}),s.map((e=>this.createTeamStoreFromCache({environment:t,teamId:e,spaceId:i,userId:n}))).filter(a.$K)}}const c=new l},36225:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{open:!1}}}const r=new i},75769:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{hasShownTooltip:!1}}hasShownTootlip(e){return this.state.hasShownTooltip&&this.state.teamId===e}}const r=new i},69911:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{joinedTeamsStates:{},hasFetched:new Set}}getKey(e){let{userId:t,spaceId:n}=e;return`${t}:${n}`}getUserJoinedTeamsState(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.joinedTeamsStates[o]}setUserJoinedTeamsState(e){let{userId:t,spaceId:n,state:o}=e;const i=this.getKey({userId:t,spaceId:n});this.state.joinedTeamsStates[i]=o,this.emit()}getHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.hasFetched.has(o)}setHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});this.state.hasFetched.add(o)}}const r=new i},83941:(e,t,n)=>{n.d(t,{M:()=>i});var o=n(77080);function i(e){return"on"===o.default.getEligibleGroup({experimentId:"duplication_workspace_selection_modal2",defaultGroup:"control",...e})}},51247:(e,t,n)=>{n.d(t,{E2:()=>i,YQ:()=>o,dm:()=>r,wN:()=>a});const o=90,i=90,r=275,a=32},29949:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(49085);class i extends o.default{getInitialState(){return{status:"closed"}}open(e){const{analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:i}=e;this.setState({...this.state,status:"opening",analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:i})}}const r=new i},24161:(e,t,n)=>{n.d(t,{N:()=>a,v:()=>r});var o=n(97880);const i={invertedInsertText:!0,invertedDeleteText:!0,invertedMoveTextSlice:!0,invertedAddAnnotation:!0,invertedRemoveAnnotation:!0};function r(e){return Boolean(i[e.command])}function a(e){const{pointer:t,invertedCrdtOperation:n}=e,i=n.type;switch(i){case"invertedInsertText":return{command:"invertedInsertText",pointer:t,path:[],args:n};case"invertedDeleteText":return{command:"invertedDeleteText",pointer:t,path:[],args:n};case"invertedAddAnnotation":return{command:"invertedAddAnnotation",pointer:t,path:[],args:n};case"invertedRemoveAnnotation":return{command:"invertedRemoveAnnotation",pointer:t,path:[],args:n};default:(0,o.t1)(i)}}},65663:(e,t,n)=>{n.d(t,{F:()=>a});var o=n(67175),i=n(82530),r=n(24161);function a(e){const{transaction:t,store:n,crdtOperations:a,invertedOperations:s}=e;i.applyCrdtTextOperations({transaction:t,store:n,operations:a.map((e=>(0,o.W5)({pointer:n.pointer,crdtOperation:e}))),invertedOperations:s.map((e=>(0,r.N)({pointer:n.pointer,invertedCrdtOperation:e})))})}},60027:(e,t,n)=>{n.d(t,{T:()=>S,n:()=>w});var o=n(30120),i=(n(67294),n(68626)),r=n(9182),a=n(9291),s=n(86572),l=n(54642),c=n(47307),d=n(80444),u=n(22616),p=n(34583),m=n(5682),f=n(70060),g=n(58333),h=n(88893),v=n(33493),b=n(88280),y=n(22500),_=n(85893);async function S(e){const{environment:t,stripe:n,elements:l}=e,S=b.subscriptionDataStoreInstance.state;if(!S)return void i.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Unable to get subscription data."}});if(!l||!n)return void i.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}});const{error:w}=await l.submit();if(w)return void s.iL(t,{error:"could not submit form",error_type:"payment_method"});const k=await n.createPaymentMethod({elements:l});if(k.error)return void s.iL(t,{error:k.error.message,error_type:"payment_method"});if(!k.paymentMethod)return void s.iL(t,{error:"could not create token",error_type:"payment_method"});const I={type:"paymentMethodId",value:k.paymentMethod.id},x=d.default.state.currentSpaceStore;if(!x)return;const C=x.id,T=await u.aQ({environment:t,spaceId:C}),M=(0,m.P)(T,S),P=(0,r.Lg)(M),A=v.Z.state.selectedCurrencyCode??"USD",R={product:(0,y.Hy)(),interval:"month",currency:A},D=(0,g.AI)(T,P,R),B=o.ou.now().plus({days:14});return await async function(e){const{environment:t,spaceStore:n,paymentData:o,desiredState:i,stripe:r}=e;try{const e=await p.Mg({environment:t,spaceStore:n,desiredState:i,paymentData:o,from:"onboarding",isMmOrEnt:(0,f.MV)()&&(0,f.yt)(),billingEmail:(0,h.pu)()}),s=e.paymentIntentClientSecret,l=e.paymentIntentStatus;if(s&&"requires_action"===l){const{error:e}=await r.handleNextAction({clientSecret:s});e&&(await p.EO({environment:t,spaceStore:n,planType:n.getPlanType()??"personal",from:"subscription_upgrade_onboarding_failed_payment"}),c.showErrorMessage((0,_.jsx)(a.FormattedMessage,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."})))}return"success"}catch{return void s.Bg(t)}}({environment:t,spaceStore:x,desiredState:{...D,trialEnd:B},paymentData:I,stripe:n,subscriptionTier:(0,y.Hy)()})}async function w(e){const t=await l.getExternalOrgData(e,{});if("failed"===t.type)return!1;const n=t.data;return"company_employee_count"in n&&parseInt(n.company_employee_count)>99}},22500:(e,t,n)=>{n.d(t,{Hy:()=>c,XG:()=>l,zQ:()=>s});var o=n(47425),i=n(53809),r=n(30548);const a=new i.D({key:"trialUpsell",namespace:r.$p,important:!1,trackingType:"preference"});function s(e){a.setState(e)}function l(){a.setState(void 0)}function c(){const e=a.getState();return e&&(0,o.mq)(e)&&(0,o.NG)(e)?"business":"plus"}},42198:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o=n(49085),i=n(72126),r=n(63143),a=n(77080),s=(n(57658),n(97880)),l=n(54642),c=n(98730);async function d(e){const{spaceId:t,userId:n,environment:o}=e,i=await l.getUserSignals(o,{spaceId:t,signals:[{name:"similarUserRecentPages",includeRecords:!0},{name:"topPages7dPageView",includeRecords:!0},{name:"editedPages1d",includeRecords:!0},{name:"similarUsersEditedPages1d",includeRecords:!0}]});if("success"===i.type){const e={};i.data.signals.forEach((t=>{if("error"===t.status)return;const n=t.name;"similarUserRecentPages"===n?e[n]=function(e){const t=new Map,n=new Map;return e.forEach((e=>{let{userId:t,similarity:o}=e;n.set(t,o)})),e.forEach((e=>{const{userId:o,similarity:i}=e;e.recentPages.forEach((r=>{let{visitedAt:a,pageId:s}=r;const l=t.get(s);if(l){l.userIds.push(o),l.mostRecentlyVisitedAt<a&&(l.mostRecentlyVisitedUser=e.userId,l.mostRecentlyVisitedAt=a);const t=n.get(l.mostSimilarUser);t&&t<i&&(l.mostSimilarUser=o)}else t.set(s,{userIds:[o],mostRecentlyVisitedUser:o,mostRecentlyVisitedAt:a,mostSimilarUser:o})}))})),{pagesMetadata:t,userSimilarityScores:n}}(t.data):"topPages7dPageView"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.pageAuthorityV1)})),t}(t.data):"editedPages1d"===n||"similarUsersEditedPages1d"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.editedAt)})),t}(t.data):(0,s.t1)(n)})),m.update((o=>({...o,userSignals:o.userSignals.set(m.getKey(t,n),e)}))),c.S(o)}}const u=5*r.hM;class p extends o.default{constructor(){super(...arguments),this.refreshTimer=void 0,this.getKeyMemoized=(0,i.HP)(this.getKey)}getInitialState(){return{userSignals:new Map}}getKey(e,t){return`${e}:${t}`}getUserSignals(e){let{spaceId:t,userId:n}=e;if(!t||!n)return;const o=this.getKeyMemoized(t,n),i=this.state.userSignals.get(o);return i||void 0}initializeAndLoadAllUserSignals(e){this.refreshTimer&&window.clearTimeout(this.refreshTimer);(a.default.getEligibleGroup({experimentId:"search-new-local-recall-v2",parameter:"userSignals",defaultGroup:[]})??[]).length>0&&(d(e),this.refreshTimer=window.setTimeout((()=>{d(e)}),u))}isSimilarUsersRecentPages(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t?void 0:t.has(i)}getNumSimilarUsersVisitedPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t||null===(t=t.userIds)||void 0===t?void 0:t.length}getSimilarUsersMostRecentVisitTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t?void 0:t.mostRecentlyVisitedAt}getHighestViewerSimilarityScoreForPage(e){var t,n;const{userId:o,spaceId:i,pageId:r}=e,a=this.getUserSignals({userId:o,spaceId:i}),s=null==a||null===(t=a.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(r))||void 0===t?void 0:t.mostSimilarUser;if(s)return null==a||null===(n=a.similarUserRecentPages)||void 0===n||null===(n=n.userSimilarityScores)||void 0===n?void 0:n.get(s)}isTopPages7dPageView(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.has(i)}getPageAuthorityV1ForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.get(i)}isRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.has(i)}getUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.get(i)}isSimilarUsersRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.has(i)}getSimilarUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:i}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.get(i)}}const m=new p},28084:(e,t,n)=>{n.d(t,{Z:()=>r});n(21703),n(57658);var o=n(7406),i=n(29477);const r=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.requestDelayMs=void 0,this.requestTimeoutMs=void 0,this.queue=[],this.currentWorkers=0,this.currentSetTimeouts=0,this.dequeue=async()=>{if(this.currentSetTimeouts=0,this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;this.currentWorkers++;const e=this.queue.splice(0,this.batchSize),t=e.map((e=>e.request));let n,r;try{if(this.requestTimeoutMs){const e=await i.OI(this.requestTimeoutMs,[this.performRequests(t)]);if(e.timeout)throw new Error("Timed out.");n=e.result}else n=await this.performRequests(t)}catch(a){r=(0,o.tg)(a)}try{if(r)for(let t=0;t<e.length;t++){e[t].deferred.reject(r)}else if(n)for(let t=0;t<e.length;t++){const o=e[t],i=n[t];o.deferred.resolve(i)}}catch(s){}this.currentWorkers--,this.queue.length>=this.batchSize?this.dequeue():this.dequeueAfterTimeout()};const{performRequests:t,batchSize:n,maxWorkers:r,requestDelayMs:a,requestTimeoutMs:s}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=r,this.requestDelayMs=a||0,this.requestTimeoutMs=s}getQueueSize(){return this.queue.length}updateBatchSize(e){this.batchSize=e}updateRequestDelayMs(e){this.requestDelayMs=e}getMaxWorkers(){return this.maxWorkers}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterTimeout()}enqueue(e){const t=i.UZ();return this.queue.push({request:e,deferred:t}),this.dequeueAfterTimeout(),t.promise}dequeueAfterTimeout(){this.currentSetTimeouts<this.maxWorkers&&(this.currentSetTimeouts++,setTimeout(this.dequeue,this.requestDelayMs))}}},54064:(e,t,n)=>{n.d(t,{Z:()=>o});const o=class{constructor(){this.listeners={}}addListener(e,t){let n=this.listeners[e];n||(n=new Set,this.listeners[e]=n),n.add(t)}addOnceListener(e,t){var n=this;const o=function(){n.removeListener(e,o),t(...arguments)};this.addListener(e,o)}removeListener(e,t){const n=this.listeners[e];n&&(n.delete(t),0===n.size&&delete this.listeners[e])}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const i=this.listeners[e];i&&i.forEach((e=>e(...n)))}listenerCount(e){const t=this.listeners[e];return t?t.size:0}}},55652:(e,t,n)=>{n.d(t,{s:()=>i});n(57658);var o=n(97880);class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};this.buckets={},this.count=0,this.total=0,this.unique=0,this.startedAt=new Map,this.logger=e}async measureErrors(e,t,n,o){const i=`${e} ${++this.unique}`;this.start(i);try{const e=await o();return this.end(i,t),e}catch(r){throw this.end(i,n,r),r}}get average(){return Math.floor(this.total/this.count)}get summary(){const e=[];e.push(`avg ${this.average}ms for ${this.count} calls`);for(const[t,n]of(0,o.qP)(this.buckets)){if(!n)continue;const o=Math.floor(n.total/n.count),i=(n.count/this.count*100).toFixed(2);e.push(`[${t}: ${i}% avg ${o}ms]`)}return e.join(" ")}start(e){this.startedAt.set(e,"object"==typeof performance?performance.now():Date.now())}end(e,t){const n=this.startedAt.get(e);if(!n)return;this.startedAt.delete(e);const o=("object"==typeof performance?performance.now():Date.now())-n;this.count++,this.total=this.total+o;let i=this.buckets[t];i||(i={count:0,total:0},this.buckets[t]=i),i.count++,i.total=i.total+o;for(var r=arguments.length,a=new Array(r>2?r-2:0),s=2;s<r;s++)a[s-2]=arguments[s];this.logger(`end ${e} ${t}: ${o}ms`,...a)}}},15157:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(30548);const i=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"necessary")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get(this.makeUserKey(t,n))}set(e){let{userId:t,key:n,value:o}=e;return this.localStorageStore.set(this.makeUserKey(t,n),o)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove(this.makeUserKey(t,n))}clearStorageForUser(e){this.localStorageStore.scan((t=>{t.startsWith(e)&&this.remove({userId:e,key:t})}))}scan(e){this.localStorageStore.scan(e)}makeUserKey(e,t){return`${e||"guest"}:${t}`}}(o.TA,!1)},75189:(e,t,n)=>{n.d(t,{uP:()=>P,yx:()=>M});var o=n(74487);const i=o.union([o.number(),o.string(),o.boolean(),o.isNull(),o.array(o.string())]),r=o.undefinable(i),a=o.union([i,o.record(o.string(),i)]),s=o.union([r,o.record(o.string(),r)]),l=o.union([s,o.record(o.string(),s)]),c=l,d=o.without(o.without(o.nonEmpty(o.string()),"{"),"}");o.object({required:{key:d,value:a,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}}),o.object({required:{id:o.string()},optional:{}}),o.object({required:{setValueTime:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),updates:o.record(o.string(),r),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}});const u=o.object({required:{blockId:o.string(),userId:o.string(),spaceId:o.string(),operation:o.literal("logPageExit"),pageVisitId:o.undefinable(o.string()),ts:o.number()},optional:{}}),p=(o.object({required:{},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{operation:o.literal("setValue"),key:d,value:o.string(),ttl:o.undefinable(o.number())},optional:{}})),m=o.object({required:{operation:o.literal("setValue"),key:d,value:s,version:o.number()},optional:{}}),f=o.object({required:{operation:o.literal("increment"),key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),g=o.object({required:{operation:o.literal("increment"),key:d,value:o.number(),version:o.number()},optional:{}}),h=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),v=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),version:o.number()},optional:{}}),b=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),y=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),_=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),updates:o.record(o.string(),r),ttl:o.undefinable(o.number())},optional:{}}),S=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),w=o.object({required:{operation:o.literal("logPageExit"),spaceId:o.string(),userId:o.string(),blockId:o.string(),pageVisitId:o.undefinable(o.string())},optional:{}}),k=o.object({required:{operation:o.literal("logPageExit")},optional:{}}),I={setValue:p,increment:f,setIfGreater:h,setField:b,updateField:_,logPageExit:w},x=o.union(Object.values(I)),C={setValue:m,increment:g,setIfGreater:v,setField:y,updateField:S,logPageExit:k},T=o.union(Object.values(C)),M=(o.object({required:{operations:o.array(x)},optional:{}}),o.object({required:{responses:o.array(T)},optional:{}}),o.object({required:{subscriptions:o.array(o.object({required:{key:d,version:o.number()},optional:{}}))},optional:{}}),o.object({required:{responses:o.array(o.object({required:{key:d,wasNotified:o.boolean()},optional:{}})),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d,version:o.number()},optional:{}}),o.object({required:{key:d,wasNotified:o.boolean()},optional:{}}),o.object({required:{keys:o.array(d)},optional:{}}),o.object({required:{keys:o.array(d),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{disconnectId:o.string(),operations:o.array(x)},optional:{}}),o.object({required:{disconnectId:o.string(),hadDisconnect:o.boolean()},optional:{}}),o.object({required:{disconnectId:o.string()},optional:{}}),o.object({required:{disconnectId:o.string(),wasRemoved:o.boolean()},optional:{}}),o.union([o.object({required:{type:o.literal("notification"),key:d,value:l,version:o.number()},optional:{passThroughData:c}}),o.object({required:{type:o.literal("response"),status:o.literals("ok","error"),requestId:o.string(),result:o.any()},optional:{}})])),P=o.object({required:{userId:o.string(),present:o.boolean()},optional:{activityTimestamp:o.number(),blockId:o.union([o.isNull(),o.string()])}});o.object({required:{max_records:o.number()},optional:{}}),o.object({required:{values:o.array(u)},optional:{}}),o.object({required:{last_length:o.number(),new_length:o.number(),added:o.boolean()},optional:{}})},11799:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(67266),i=n.n(o),r=n(72126);let a;const s=new WeakMap;function l(e){let t=s.get(e);return void 0!==t||(t=i()(e),s.set(e,t)),t}a=Symbol.iterator;class c{constructor(){let{getKey:e=l,from:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.map=new Map,this.getKey=void 0,this.getKey=e,t)for(const[n,o]of t)this.set(n,o)}get size(){return this.map.size}set(e,t){return this.map.set(this.getKey(e),[e,t])}get(e){const t=this.map.get(this.getKey(e));if(t)return t[1]}has(e){return this.map.has(this.getKey(e))}delete(e){return this.map.delete(this.getKey(e))}*entries(){for(const e of this.map.values())yield e}[a](){return this.entries()}*keys(){for(const e of this.map.keys())yield JSON.parse(e)}*values(){for(const[e,t]of this.map.values())yield t}valuesArray(){return Array.from(this.values())}compactedValuesArray(){return r.oA(Array.from(this.values()))}}},27731:(e,t,n)=>{n.d(t,{Z:()=>i});class o{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>o.timestep?(t-=o.timestep,e=o.timestep):(e=t,t=0);const[n,i]=this.rk4(this.currentValue,this.velocity,e);this.velocity=i,this.currentValue=n}while(t>0);const n=this.isAtRest();return n&&this.setAtRest(),n}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,n){var o=e,i=t,r=this.computeAccel(o,i,0),a=e+.5*i*n,s=t+.5*r*n,l=this.computeAccel(a,s,n/2),c=e+.5*s*n,d=t+.5*l*n,u=this.computeAccel(c,d,n/2),p=e+d*n,m=t+u*n;return[e+n/6*(i+2*s+2*d+m),t+n/6*(r+2*l+2*u+this.computeAccel(p,m,n))]}computeAccel(e,t,n){return this.stiffness*o.stiffnessMultiplier*(this.endValue-e)-this.damping*o.dampingMultiplier*t}}o.stiffnessMultiplier=1e-5,o.dampingMultiplier=.005,o.timestep=1e3/60;const i=o},95371:(e,t,n)=>{n.d(t,{CY:()=>m,DG:()=>i,DY:()=>c,MW:()=>s,Sr:()=>d,Xf:()=>u,YL:()=>p,Yc:()=>l,Yz:()=>a,lj:()=>f,mp:()=>r,qF:()=>v,si:()=>g,ub:()=>h});n(57658);var o=n(97880);class i{constructor(e){this.children=e}map(e){const t=this.children.map((t=>t.map(e)));return new i(t)}toString(){return`DetachedTreeRoots([${this.children}])`}}class r{constructor(e,t){this.value=e,this.children=t}map(e){return s(this,(t=>({value:e(t.value),children:t.children})))}toString(){return`Tree(${this.value}, [${this.children}])`}}function a(e,t){return t(e.value)||e.children.some((e=>a(e,t)))}function s(e,t){const n=t(e);if(!n)return;const{value:i,children:a}=n,l=a?a.map((e=>s(e,t))).filter(o.$K):[];return new r(i,l)}function l(e){const{values:t,isAncestor:n,compareOrder:o}=e;if(0===t.length)return;const a=(e,t)=>{for(const o of e)if(n(o.value,t))return void a(o.children,t);e.push(new r(t,[]))},s=t.slice().sort(o),l=[];for(const i of s)a(l,i);return new i(l)}function c(e,t){for(const n of e){if(t(n))return[n];{const e=c(n.children,t);if(e)return[n,...e]}}}function d(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));if(i>0)return{prev:o.children[i-1]};if(o!==e)return{parent:o}}return{}}function u(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));return i<o.children.length-1?{next:o.children[i+1]}:u(e,t.slice(0,t.length-1))}return{}}function p(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,i=o.children.findIndex((e=>e===n));if(i>0){return{prev:m(o.children[i-1])}}if(o!==e)return{parent:o}}return{}}function m(e){for(;e.children.length>0;)e=e.children[e.children.length-1];return e}function f(e,t){if(t&&t.length>0){const n=t[t.length-1];if(n.children.length>0){return{next:n.children[0]}}const{next:o}=u(e,t);return{next:o}}return{}}function g(e){if(e&&e.length>0){const t=e[e.length-1];if(t.children.length>0)return t.children[0]}}function h(e){if(e&&e.length>1)return e[e.length-2]}function v(e,t){if(0===e.length||0===t.length)return-1;for(let n=Math.min(e.length,t.length)-1;n>-1;n--){if(e[n]===t[n])return n}return-1}},39721:(e,t,n)=>{n.d(t,{F:()=>a,o:()=>s});n(21703),n(57658);var o=n(95371),i=n(73597),r=n(97880);const a={applyMutable:function(e,t){const n=(0,o.DY)(e.children,(e=>e===t.target));if(void 0===n)return!1;if(0===n.length)throw new Error("findPathInTree: empty path");const i=1===n.length?e.children:n[n.length-2].children,a=i.indexOf(t.target);if(-1===a)throw new Error("findPathInTree: cannot find node");switch(t.operation){case"indentSelf":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n,...n.children),n.children=[],!0}(i,a);case"indentSelfAndSubtree":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n),!0}(i,a);case"unindentSelf":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],i=t.indexOf(o);if(-1===i)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],i=o.children[n];return o.children.splice(n,1),e.splice(t+1,0,i),!0}(t,i,a)}case"unindentSelfAndUpdateSiblings":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],i=t.indexOf(o);if(-1===i)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],i=o.children[n],r=o.children.splice(n+1,o.children.length-n-1);return i.children.push(...r),o.children.splice(n,1),e.splice(t+1,0,i),!0}(t,i,a)}default:(0,r.t1)(t.operation)}}};const s={getIndentOperationsFromTreeRange:(e,t)=>"indent"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"indentSelf",target:n});return t}(e):"indentSelfAndSubtree"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"indentSelfAndSubtree",target:n});return t}(e):"unindent"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"unindentSelfAndUpdateSiblings",target:n});return t.reverse()}(e):"unindentSelf"===t?function(e){const t=[];for(const n of(0,i.bu)(e))t.push({operation:"unindentSelf",target:n});return t.reverse()}(e):void(0,r.t1)(t)}},73597:(e,t,n)=>{n.d(t,{JK:()=>i,bu:()=>a,tL:()=>r});n(21703);var o=n(97880);function*i(e){yield e;for(const t of e.children)yield*i(t)}function*r(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(!n)throw new Error("Start boundary must be defined");t===e.startPath.length-1?yield n.parent:yield*n.childrenInsideRange}}function*a(e){for(const{position:t,tree:n}of function*(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(n&&(t===e.startPath.length-1&&(yield{position:"start",tree:n.parent}),t>0))for(const e of n.childrenInsideRange)yield{position:"within",tree:e}}for(let t=0;t<e.endPath.length;t++){const n=e.getEndBoundary(t);if(n)for(const t of n.childrenInsideRange)e.isInEndPath(t)?yield{position:"endPath",tree:t}:yield{position:"within",tree:t}}}(e))switch(t){case"start":case"endPath":yield n;break;case"within":yield*i(n);break;default:(0,o.t1)(t)}}},374:(e,t,n)=>{n.d(t,{Z:()=>i,f:()=>r});var o=n(97880);function i(e){return[{operation:"delete",deleteFromParent:e.moveFromParent,deletingChildren:e.movingChildren,debug:e.debug},{operation:"insert",insertIntoParent:e.moveToParent,insertChildren:e.movingChildren,adjacentSibling:e.moveToAdjacentSibling,direction:e.moveToDirection,debug:e.debug}]}const r={applyMutable:function(e){switch(e.operation){case"delete":return a(e);case"insert":return s(e);case"move":const[t,n]=i(e),r=a(t),l=s(n);return r||l;default:(0,o.t1)(e)}}};function a(e){const{deleteFromParent:t,deletingChildren:n}=e;if(0===n.length)return!1;const o=new Set(n),i=t.children.filter((e=>!o.has(e)));return i.length!==t.children.length&&(t.children=i,!0)}function s(e){const{direction:t,insertChildren:n,insertIntoParent:i,adjacentSibling:r}=e;if(0===n.length)return!1;const a=r?i.children.indexOf(r):-1,s=(()=>{switch(t){case"listBefore":return Math.max(0,a);case"listAfter":return-1===a?i.children.length:a+1;default:(0,o.t1)(t)}})();return i.children.splice(s,0,...n),!0}},70842:(e,t,n)=>{n.d(t,{T:()=>i});n(21703),n(57658);var o=n(95371);class i{constructor(e,t,n){if(this.maxDepth=void 0,this.start=void 0,this.end=void 0,this.startPathSet=void 0,this.endPathSet=void 0,this.isInStartPath=e=>this.startPathSet.has(e),this.isInEndPath=e=>this.endPathSet.has(e),this.commonAncestor=e,this.startPath=t,this.endPath=n,0===this.startPath.length||0===this.endPath.length)throw new Error(`Cannot create TreeRange with empty path: ${this.startPath} ${this.endPath}`);this.start=this.startPath[this.startPath.length-1],this.end=this.endPath[this.endPath.length-1],this.startPathSet=new Set(t),this.endPathSet=new Set(n),this.maxDepth=Math.max(this.startPath.length,this.endPath.length)}static fromNearestCommonAncestor(e,t){const n=(0,o.qF)(e,t);if(!(n<0))return new this(e[n],e.slice(n),t.slice(n))}getStartBoundary(e){if(e>=this.startPath.length||e<0)return;const t=this.startPath[e];if(0===e&&this.startPath.length<=1&&this.endPath.length<=1)return{parentType:"commonAncestor",parent:t,childrenBeforeRange:[],childrenInsideRange:[],childrenAfterRange:t.children.slice()};const n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath),i=t.children.slice(0,n),r=t.children.slice(n,-1===o?void 0:o+1),a=-1===o?[]:t.children.slice(o+1);return 0===e?{parentType:"commonAncestor",parent:t,childrenBeforeRange:i,childrenInsideRange:r,childrenAfterRange:a}:{parentType:"startPath",parent:t,childrenBeforeRange:i,childrenInsideRange:r}}getEndBoundary(e){if(e>=this.endPath.length||e<0)return;if(0===e)return this.getStartBoundary(0);const t=this.endPath[e],n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath)+1,i=t.children.slice(n,o),r=t.children.slice(o);return{parentType:"endPath",parent:t,childrenInsideRange:i,childrenAfterRange:r}}getAnalagousNodesAtOffset(e){const t=this.startPath.length-1-e,n=this.endPath.length-1-e;return{start:this.getStartBoundary(t),end:this.getEndBoundary(n)}}*iterateAnalogousNodes(){for(let e=0;e<this.maxDepth;e++)yield this.getAnalagousNodesAtOffset(e)}getDeletionAtOffset(e){const{start:t,end:n}=this.getAnalagousNodesAtOffset(e),o=[];t&&t.childrenInsideRange.length>0&&o.push({operation:"delete",deleteFromParent:t.parent,deletingChildren:t.childrenInsideRange});const i=(null==t?void 0:t.parent)||this.commonAncestor;if(i&&n&&n.parent!==this.commonAncestor&&n.parent!==i&&n.childrenAfterRange.length>0){const e=i.children.find(this.isInStartPath);o.push({operation:"move",moveFromParent:n.parent,movingChildren:n.childrenAfterRange,moveToParent:i,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"})}return o}*iterateDeletion(){for(let e=0;e<this.maxDepth;e++)yield*this.getDeletionAtOffset(e)}getInsertionAtOffset(e,t,n){const o=Math.max(0,e.length-1-t),i=e[o],r=e[o+1],{start:a,end:s}=this.getAnalagousNodesAtOffset(t),l=[];if(a&&a.childrenInsideRange.length>0){const e=n.get(i)||r;l.push({operation:"move",moveFromParent:a.parent,movingChildren:a.childrenInsideRange,moveToParent:i,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"});const t=a.childrenInsideRange[a.childrenInsideRange.length-1];n.set(i,t)}const c=this.startPath.length-1-t,d=Math.min(c,this.endPath.length-1),u=this.getEndBoundary(d);if(u&&u.parent!==this.commonAncestor&&i!==e[0]){const e=i.children.indexOf(r)+1,t=i.children.slice(e);if(t.length){const e=0===u.childrenInsideRange.length&&u.childrenAfterRange.length>0,n=e?u.childrenAfterRange[0]:u.childrenInsideRange[u.childrenInsideRange.length-1];l.push({operation:"move",moveFromParent:i,movingChildren:t,moveToParent:u.parent,moveToAdjacentSibling:n,moveToDirection:e?"listBefore":"listAfter"})}}return s&&s.parent!==this.commonAncestor&&s.childrenAfterRange.length>0&&l.push({operation:"delete",deleteFromParent:s.parent,deletingChildren:s.childrenAfterRange}),l}*iterateInsertionAt(e){const t=new Map,n=[];for(let o=0;o<this.maxDepth;o++)n.push(...this.getInsertionAtOffset(e,o,t));yield*n}}},66504:(e,t,n)=>{n.d(t,{I:()=>a,o:()=>s});var o=n(45953),i=n(97880);let r;const a="guest";r=Symbol.iterator;class s{constructor(e){this.data=void 0,this.data=e??{}}getUserRecordMap(e){const t=e??a;let n=this.data[t];return n||(n=o.PF.create(),this.data[t]=n),n}getValue(e){return this.getUserRecordMap(e.userId).getValue(e.pointer)}getRole(e){return this.getUserRecordMap(e.userId).getRole(e.pointer)}setValueAndRole(e,t,n){return this.getUserRecordMap(e.userId).setValueAndRole(e.pointer,t,n),this}setModelAndRole(e,t,n){return this.getUserRecordMap(e.userId).setModelAndRole(e.pointer,t,n),this}delete(e){this.getUserRecordMap(e.userId).delete(e.pointer)}*[r](){for(const[e,t]of(0,i.qP)(this.data))for(const{pointer:n,model:o,role:i}of t)void 0!==o&&(yield{pointer:n,model:o,role:i,userId:e===a?void 0:e})}}},40902:(e,t,n)=>{n.d(t,{B9:()=>A,BX:()=>x,Dn:()=>C,Fb:()=>V,KN:()=>U,OC:()=>w,OS:()=>T,Yr:()=>M,Z3:()=>B,fc:()=>E,gg:()=>D,hY:()=>Z,j4:()=>R,lv:()=>F,md:()=>j,n_:()=>L,tR:()=>S});n(57658);var o=n(41432),i=n(99036),r=(n(80951),n(72126)),a=n(59753),s=n(72141),l=n(4615),c=n(70921),d=n(21202),u=n(6287),p=(n(13493),n(33709)),m=n(65311),f=n(15047),g=n(29369),h=n(19889),v=n(99108),b=n(70203),y=n(97880),_=n(63143);_.hM;function S(e,t){const n=a.kk.fromValue(c.TY,t),{edits:o,index:i}=e,s=[...n&&n.getEdits()||[],...o],m=v.VR(s),h=m[0],b=h&&h.timestamp.toString()||n&&n.start_time||o[0].timestamp,y=r.Z$(m),_=y&&y.timestamp.toString()||n&&n.end_time||b,S=k(o[0]),w=function(e){const{space_id:t,navigable_block_id:n,collection_id:o,collection_row_id:i,top_level_block_id:r,discussion_id:a,team_id:s,access_request_type:l}=e;return n?"guest_invite_request"===l?{parent_table:f.bx,parent_id:t}:{parent_table:d.iU,parent_id:n}:r?{parent_table:d.iU,parent_id:r}:i?{parent_table:d.iU,parent_id:i}:a?{parent_table:p.qF,parent_id:a}:o?{parent_table:u.v,parent_id:o}:s?{parent_table:g.e0,parent_id:s}:{parent_table:f.bx,parent_id:t}}(o[0]);return{type:c.L8[o[0].type],index:i,start_time:b.toString(),end_time:_.toString(),edits:m.slice(0,1e3),invalid:I(m),shard_id:(0,l.bm)(S.space_id),context_id:c.rH(S),...S,...w}}function w(e){if("collection-changed"===e.type&&e.collection_data){if(!e.collection_data.before&&!e.collection_data.after)return!1;if(!e.collection_data.before||!e.collection_data.after)return!0;return C(e.collection_data.before.description,e.collection_data.after.description)}if("collection-created"===e.type&&e.collection_data){const t=e.collection_data.description;return Boolean(t)}return!1}function k(e){return _.ei(e,c.uJ)}function I(e){if(0===v.hI(e).length)return!0;{const t=e[0];if("mention-deleted"===t.type)return!0;if("mention-created"===t.type){if(t.authors&&t.authors.some((e=>e.table===h.KJ&&e.id===t.mentioned_user_id)))return!0}else if(e.every((e=>"comment-deleted"===e.type)))return!0}return!1}function x(e,t){return function(e){const t=a.kk.fromValue(c.TY,e),n=t&&t.getEdits()||[];return _.cf(r.xH(n.map((e=>e.authors||[]))))}(a.kk.fromValue(c.TY,e)).some((e=>e.table===h.KJ&&e.id===t))}function C(e,t){const n=b.OAI(e||[]),o=b.OAI(t||[]);return!r.Xy(n,o)}function T(e){const{before:t,after:n,schema:o}=e,r=[];return(o?Object.keys(o):i.qF).forEach((e=>{C(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&r.push(e)})),r}function M(e){const{before:t,after:n}=e,o=[];return new Set((0,y.Yd)(t.properties||{}).concat((0,y.Yd)(n.properties||{}))).forEach((e=>{C(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&o.push(e)})),o}const P=["page_icon","is_placeholder"];function A(e){const{before:t,after:n}=e,o=[];return P.forEach((e=>{(t.format&&t.format[e])!==(n.format&&n.format[e])&&o.push(e)})),o}function R(e){const{before:t,after:n,property:o}=e;return C(t&&t.properties&&t.properties[o],n&&n.properties&&n.properties[o])}function D(e){return T(e).length>0}function B(e){return e.after.type===o.Ti.tableRow&&M(e).length>0}function E(e){return A(e).length>0}function F(e){const{before:t,after:n}=e,o=a.kk.fromBlock(t),i=a.kk.fromBlock(n),r=o.type,s=i.type,l=o.isNavigableBlock()&&i.isNavigableBlock();return r&&s&&r!==s&&!l}function Z(e){const{activity:t,getRecordModel:n,baseUrl:o,pageVisitSource:i}=e;if(t.isType("top-level-block-created")||t.isType("top-level-block-deleted")){const e=n(t.getTopLevelBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("commented")){const e=n(t.getDiscussionPointer());if(e){const t=n(e.getParentPointer());if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,discussionId:e.id,pageVisitSource:i})}}else if(t.isType("collection-row-created")||t.isType("collection-row-deleted")){const e=n(t.getCollectionRowPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("permissions-edited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}else if(t.isType("block-edited")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("user-mentioned")){const e=n(t.getMentionedBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("reminder")){const e=n(t.getReminderBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else if(t.isType("user-invited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}else if(t.isType("block-property-edited")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:i})}return o||"/"}function V(e){switch(e){case"top-level-block-created":return"activity_top_level_block_created";case"top-level-block-deleted":return"activity_top_level_block_deleted";case"collection-row-created":return"activity_collection_row_created";case"collection-row-deleted":return"activity_collection_row_deleted";case"block-edited":return"activity_block_edited";case"block-property-edited":return"activity_block_property_edited";case"permissions-edited":return"activity_permissions_edited";case"user-mentioned":return"activity_mention";case"commented":return"activity_comment";case"user-invited":return"activity_invited";case"collection-edited":return"collection_edited";case"collection-view-edited":return"collection_view_edited";case"collection-property-edited":return"collection_property_edited";case"reminder":return"activity_reminder";case"permission-group-edited":return"activity_permission_group_edited";case"page-locked":return"activity_page_locked";case"page-unlocked":return"activity_page_unlocked";case"email-edited":return"activity_email_edited";case"access-requested":return"activity_access_requested";case"access-request-resolved":return"activity_access_request_resolved";case"page-deleted":return"activity_page_deleted";case"page-restored":return"activity_page_restored";case"page-permanently-deleted":return"activity_page_permanently_deleted";case"team-membership-edited":return"activity_team_membership_edited";case"private-content-transferred":return"activity_private_content_transferred";case"permission-group-mentioned":return"activity_permission_group_mentioned";case"verification-expired":return"activity_verification_expired";case"import-completed":return"activity_import_completed";case"export-completed":return"activity_export_completed"}}function j(e){const t=[],n=[],o=[];return e.forEach((e=>{!function(e){if("permission-created"===e.type){const t=e.permission_data;if("user_permission"===t.type&&s.YX(t.role)&&e.authors&&1===e.authors.length&&e.authors[0].table===h.KJ&&e.authors[0].id===t.user_id)return!0}return!1}(e)?"permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?n.push(e):o.push(e):t.push(e)})),{autojoinEdits:t,inheritanceEdits:n,otherEdits:o}}function U(e){return"commented"===e||"following"===m.hE[e]}function L(e){return"mentions"===m.hE[e]}},19234:(e,t,n)=>{n.d(t,{A:()=>r});n(72126);const o=/^\d{5}(-\d{4})?$/,i=/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] ?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i;function r(e){if(!e.country)return!1;switch(e.country){case"US":return o.test(e.zipCode);case"CA":return i.test(e.zipCode);default:return!0}}},79946:(e,t,n)=>{n.d(t,{iI:()=>_,HR:()=>w,SY:()=>y,Q3:()=>S,rQ:()=>f,xx:()=>b,j:()=>g,VT:()=>C,dG:()=>k,k3:()=>D,PL:()=>P,L1:()=>T,Dq:()=>R,I$:()=>x,T1:()=>I,tO:()=>M,kd:()=>A});n(57658);var o=n(74686),i=n(68626),r=n(91155),a=n(54153),s=n(46637),l=n(97880),c=n(64002);let d,u,p=[],m="/";async function f(e){const{device:t,config:n,cookieService:i}=e;u=!["staging","production"].includes(n.env),await o.vO({trackingType:"targeting",cookieService:i})&&(t.isNative||t.doNotTrackEnabled||(m=function(e){if(e.isLocalhost)return"http://localhost:3000";return"https://aif.notion.so"}(n),function(e){if(!m)return;const t=document.createElement("iframe");t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.setAttribute("style","position: absolute; opacity: 0; width: 1px; height: 1px; top: 0; left: 0; border: none; display: block; z-index: -1;"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.setAttribute("referrerpolicy","no-referrer"),t.setAttribute("src",e.aif.url),document.body.appendChild(t),t.addEventListener("load",(()=>{d=t;for(const e of p)v(t,e);p=[]}))}(n)))}async function g(e){const{device:t,event:n,cookieService:a}=e;if(await o.vO({trackingType:"targeting",cookieService:a}))if(t.isNative||t.doNotTrackEnabled)h(n)&&i.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupDoNotTrackEnabled"});else try{d?v(d,n):p.push(n)}catch(s){i.log({level:"error",from:"adAnalyticsHelpers",type:"analyticsTrack",error:(0,r.Ui)(s)})}}function h(e){var t,n;return"CompleteRegistration"===(null===(t=e.facebook)||void 0===t?void 0:t.eventName)||"registration"===(null===(n=e.google)||void 0===n?void 0:n.eventName)}function v(e,t){h(t)&&i.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupIFramePostCall"}),e.contentWindow&&e.contentWindow.postMessage(t,m)}function b(e){if("facebook"===e.type){const t=`fb.1.${Date.now()}.${e.id}`;s.Z.set("adClick",{type:"facebook",id:t})}else"google"===e.type?s.Z.set("adClick",{type:"google",id:e.id}):(0,l.t1)(e)}function y(){return s.Z.get("adClick")}function _(){s.Z.remove("adClick")}function S(){return s.Z.get("fbp")}function w(){a.Z.remove("fbp")}function k(e){const{eventType:t,source:n,eventData:o}=e;if(u)console.debug(`track GTM event:%c ${t}`,"font-weight: bold;",o);else if("front"===n){(window.dataLayer=window.dataLayer||[]).push({event:t,data:o})}else{const e={google:{eventName:"custom",data:{event:t,data:o}}};d&&d.contentWindow?d.contentWindow.postMessage(e,m):p.push(e)}}function I(){k({eventType:"sign_up_flow_start",source:"client"})}function x(){k({eventType:"sign_up_flow_complete",source:"client"})}function C(e){let{planType:t,subscriptionTier:n,domainType:o}=e;t&&"team"===t?k({eventType:"create_space",source:"client",eventData:{planType:t}}):n&&k({eventType:"create_space",source:"client",eventData:{subscriptionTier:n,domainType:o}})}function T(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"professional_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function M(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"team_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function P(){k({eventType:"onboarding_complete",source:"client"})}function A(e,t){k({eventType:"workspace_first_invite_sent",source:"client",eventData:{subscriptionTier:e,domainType:t}})}function R(){k({eventType:"professional_workspace_first_invite_sent",source:"client"})}async function D(e){var t;const{device:n,email:o,cookieService:i}=e,r=(0,c.DP)(null===(t=document.location)||void 0===t?void 0:t.href),a=null==r?void 0:r.get("cid"),s=null==r?void 0:r.get("metadata_cid");var l;if(s)return g({device:n,event:{metadataio:{eventName:"sign_up",data:{email:o,cid:a,mcid:s,url:null===(l=document.location)||void 0===l?void 0:l.href}}},cookieService:i})}},93214:(e,t,n)=>{n.d(t,{LC:()=>i,np:()=>r});let o;function i(){return o}function r(e){if(o)return;const t=new URL(e).searchParams.get("tid");t&&(o=t)}},82813:(e,t,n)=>{n.d(t,{e:()=>i});var o=n(97880);function i(e,t){const{notificationId:n,activityId:i,sessionId:r,from:a,alreadyRead:s}=t,l=function(e){const{alreadyRead:t,from:n}=e;switch(n){case"mark_as_unread":return t?"unread":"no_change";case"read_on_page":case"email":case"mark_as_read":case"add_reaction":case"title":case"body":case"frame":case"archive":case"unarchive":case"open_reply_menu":case"mark_all_as_read":case"main":return t?"no_change":"read";default:return(0,o.t1)(n)}}({alreadyRead:s,from:a});if("no_change"===l)return;const c={notificationId:n,activityId:i,sessionId:r,from:a,target:l};e.trackEvent({eventName:"mark_notification_as_read",properties:c})}},5809:(e,t,n)=>{n.d(t,{$:()=>i});n(21703);var o=n(12139);function i(){if(!0===window.__mobileAppBackgroundLaunch)return;const e=window.__webStartTime;if("number"==typeof e)return e;{const e=new Error("App Start Time not found. It should be in index.html.");o.IE(e)}}},94568:(e,t,n)=>{n.d(t,{If:()=>c,OU:()=>d,Ox:()=>a,TM:()=>l,vj:()=>r,y3:()=>s});var o=n(21202),i=n(70203);const r="5ee0e0b5-7f0a-4788-a438-f37644514636",a="[zf`",s="0ab77975-f984-4c43-95cc-bcdc2c41b326",l="70f46cce-b6c2-4f4c-848a-c04c9b50a0bc";function c(e){for(const n of e.currentPageAncestors){if(n.table===o.iU&&"0ab77975-f984-4c43-95cc-bcdc2c41b326"===n.value.parent_id)return n.value.id;if(n.table===o.iU){var t;const e=(0,i.QaF)(null===(t=n.value)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.gXoN).trim();if(e)return e}}}function d(e){const t=e.match(/test\+(.*)@makenotion.com/);if(t)return decodeURIComponent(t[1])}},37167:(e,t,n)=>{n.d(t,{t:()=>s});var o=n(15145),i=n(80310),r=n(4615),a=n(64002);function s(e){const{blockId:t,pageVisitSource:n}=e,s={};return s[i.UJ]=(0,r.cj)(t),n&&(s[o.$X]=String(n)),(0,a.bf)({url:"/chat",query:s})}},38823:(e,t,n)=>{n.d(t,{m:()=>i});var o=n(12174);class i{constructor(e){this.getEligibleGroup=void 0,this.isAiEnabledFn=void 0,this.getIsWorkspaceVectorEmbeddingsComplete=void 0,this.checkGate=void 0,this.getEligibleGroup=e.getEligibleGroup,this.isAiEnabledFn=e.isAiEnabled,this.getIsWorkspaceVectorEmbeddingsComplete=e.getIsWorkspaceVectorEmbeddingsComplete,this.checkGate=e.checkGate}isAiEnabled(){return this.isAiEnabledFn()}isQnAExplicitlyDisabled(){return this.checkGate("disable_qna_for_workspace")}haveWeLaunchedYet(){return this.checkGate("qna_nov_9_rollout")}isXMLAssistantEnabled(){return this.modeIsAtMost("exploratory")}isJSAssistantEnabled(){return this.modeIsAtMost("wild_west")}isAssistantInWriterEnabled(){return this.isXMLAssistantEnabled()||this.isJSAssistantEnabled()}isContextEnabled(){return this.modeIsAtMost("exploratory")}isAssistantExperienceQna(){return this.isMode("beta")||this.isMode("development")}showRemindersToUseQnA(){return(this.isMode("beta")||this.isMode("development"))&&this.checkGate("qna_enable_reminders")}isChatHistoryEnabled(){return this.modeIsAtMost("development")}isWorkspaceVectorEmbeddingsComplete(){return this.getIsWorkspaceVectorEmbeddingsComplete()}getMode(){if(!this.isAiEnabledFn())return"control";if(this.isQnAExplicitlyDisabled())return"control";const e=this.getEligibleGroup("assistant_variant");return e&&o.KM.find((t=>t===e))?e:this.getIsWorkspaceVectorEmbeddingsComplete()?"beta":"control"}isMode(e){return this.getMode()===e}modeIsAtMost(e){const t=["control",...o.KM],n=this.getMode();return t.indexOf(e)<=t.indexOf(n)}}},63362:(e,t,n)=>{function o(e,t){e.trackEvent({eventName:"automation_triggered",properties:t})}function i(e,t){e.trackEvent({eventName:"add_automation_step",properties:t})}function r(e,t){e.trackEvent({eventName:"delete_automation_step",properties:t})}function a(e,t){e.trackEvent({eventName:"click_configure_button",properties:t})}function s(e,t){e.trackEvent({eventName:"click_configure_button_done",properties:t})}function l(e,t){e.trackEvent({eventName:"click_automation_modal_option",properties:t})}function c(e,t){e.trackEvent({eventName:"automation_execution_success",properties:t})}function d(e,t){e.trackEvent({eventName:"automation_execution_fail",properties:t})}function u(e,t){e.trackEvent({eventName:"automation_create",properties:t})}function p(e,t){e.trackEvent({eventName:"automation_update",properties:t})}function m(e,t){e.trackEvent({eventName:"automation_delete",properties:t})}function f(e,t){e.trackEvent({eventName:"automation_enable",properties:t})}function g(e,t){e.trackEvent({eventName:"automation_disable",properties:t})}function h(e,t){e.trackEvent({eventName:"automation_trigger_create",properties:t})}function v(e,t){e.trackEvent({eventName:"automation_trigger_delete",properties:t})}function b(e,t){e.trackEvent({eventName:"automation_action_create",properties:t})}function y(e,t){e.trackEvent({eventName:"automation_action_delete",properties:t})}function _(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function S(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function w(e,t){e.trackEvent({eventName:"automation_learn_click",properties:t})}n.d(t,{A2:()=>b,By:()=>d,Cz:()=>c,Ey:()=>v,OK:()=>y,Rt:()=>f,T0:()=>u,W5:()=>l,ai:()=>g,co:()=>r,d:()=>S,eI:()=>i,lN:()=>s,nC:()=>_,nK:()=>h,qu:()=>w,r4:()=>p,rg:()=>o,uO:()=>m,yK:()=>a})},3865:(e,t,n)=>{n.d(t,{AQ:()=>I,Cf:()=>E,SF:()=>_,TX:()=>B,Vd:()=>b,XO:()=>h,Ym:()=>M,_X:()=>P,bD:()=>R,cO:()=>S,g9:()=>w,gq:()=>g,n6:()=>C,nl:()=>v,rX:()=>T,vp:()=>x});n(57658);var o=n(9291),i=n(81730),r=n(23290),a=n(99036),s=n(6695),l=n(78106),c=n(76218),d=n(72126),u=n(482),p=n(149),m=n(97880);const f=(0,o.defineMessages)({slackAutomationDefaultName:{id:"automationStore.slackAutomation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s notifications} other {Notifications}}"},automationDefaultName:{id:"automatonStore.automation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s automation} other {Automation}}"}});function g(e,t){return e.formatMessage(f.slackAutomationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function h(e,t){return e.formatMessage(f.automationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function v(e){return"notification_event"===e.trigger.type}function b(e){return"event"===e.trigger.type}(0,m.AO)((e=>(0,m.$K)(e)&&(0,m.$K)(e.target)&&(0,m.$K)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target}}:{false:e}));const y={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function _(e){return Boolean(y[e.type]&&!(0,a.NK)(e)&&(!(0,a.qQ)(e)||void 0===(0,a.q3)(e)))}function S(e){const{collectionFormat:t,collectionSchema:n,filter:o,sort:i,sourcePropertyIds:r}=e,a=(r??(0,m.Yd)(n)).filter(((e,t,i)=>{const r=n[e];return!(!r||!_(r))&&(!o||o([e,r],t,n))}));if(0===a.length)return[];if(!t||!1===i)return a;const l=(0,s.iB)(t,n,void 0,s.j5.Page).collection_page_properties||[];return d.MR(a,(e=>l.findIndex((t=>t.property===e))))}async function w(e){const{config:t,collectionPointer:n,collectionSchema:o,actionId:a,context:s,getCurrentPropertyValue:d}=e,u={};for(const f of t.properties||[]){var m;const e=null===(m=t.values)||void 0===m?void 0:m[f],g=null==o?void 0:o[f];if(!g||!_(g))continue;const h=(0,c.H0)(n,f,g);if(!h)return{error:new i.Ox({actionId:a,property:f,collectionPointer:n})};const v=await(0,c.OH)({value:(null==e?void 0:e.value)||{type:"simple",value:void 0},context:{...s,returnType:h},executeFormula:s.executeContextualFormula});if(p.x.isFail(v))return{error:new i.x6({actionId:a,cause:v.error})};const b=(0,l.bw)({result:v.value,action:(0,r.o9)(e),currentPropertyValue:null==d?void 0:d(f),propertySchema:g});u[f]=b}return{value:u}}function k(e,t){"replace"===e.type?t(e.value):"keep"===e.type||(0,m.t1)(e)}function I(e){const{pointer:t,target:n,visitor:o}=e,i=[];return k(o.visitVariableOutsideOfFormula(n.id),(e=>{(0,m.$K)(e)?i.push(u.op.update({pointer:t,path:["config","target"],args:{id:e}})):i.push(u.op.update({pointer:t,path:["config"],args:{target:null}}))})),i}function x(e){const{pointer:t,config:{properties:n,values:o},visitor:i}=e;if(!n||!o)return[];const r=[];for(const a of n){const e=o[a];null!=e&&e.value&&k(i.visitFormula(e.value),(n=>{r.push(u.op.update({pointer:t,path:["config","values"],args:{[a]:n?{...e,value:n}:null}}))}))}return r}function C(e){const{fieldName:t,pointer:n,config:o,visitor:i}=e,r=[],a=o[t];return a&&k(i.visitFormula(a),(e=>{r.push(u.op.update({pointer:n,path:["config"],args:{[t]:e??null}}))})),r}function T(e){const{formulaValueTypes:t,minimumRole:n,targetId:o}=e,i=(0,l.vx)(t,o);if(i){const e=i.type;if("array"===e.type&&"block"===e.of.type&&e.of.collection)return[{type:"record_permission",pointer:e.of.collection,minimumRole:n??"reader"}]}return[]}const M={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1};function P(e){const{collectionFormat:t,collectionSchema:n,filter:o,sort:i}=e,r=(0,m.Yd)(n).filter(((e,t,i)=>{var r;const s=n[e];return!(!s||!M[s.type])&&((!(0,a.qQ)(s)||null===(r=(0,a.q3)(s))||void 0===r||!r.auto_update_on_edit)&&(!o||o([e,s],t,n)))}));if(0===r.length)return[];if(!t||!1===i)return r;const l=(0,s.iB)(t,n,void 0,s.j5.Page).collection_page_properties||[];return d.MR(r,(e=>l.findIndex((t=>t.property===e))))}const A={checkbox:!0,multi_select:!0,select:!0,status:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,email:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,number:!1,person:!1,phone_number:!1,relation:!1,rollup:!1,text:!1,title:!1,url:!1,verification:!1};function R(e){return A[e.type]}const D={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function B(e){return D[e.type]}function E(e){const{tab:t}=e;return"automationSettings"===(null==t?void 0:t.type)||"automationCreateSettings"===(null==t?void 0:t.type)||"automationEditSettings"===(null==t?void 0:t.type)}},48777:(e,t,n)=>{n.d(t,{L:()=>w,Y:()=>_});n(57658),n(21703);var o=n(9291),i=n(3865),r=n(41432),a=n(84116),s=n(78106),l=n(79317),c=n(47453),d=n(482),u=n(63306),p=n(4615),m=n(149),f=n(18844),g=n(21202),h=n(6287),v=n(97880),b=n(81730);const y=(0,o.defineMessages)({createPage:{id:"automations.actions.createPage",defaultMessage:"Add page toâ€¦"},createPageDefaultVariableName:{id:"automations.actions.createPageDefaultVariableName",defaultMessage:"New page added"},createPageVariableNameWithDatabase:{id:"automations.actions.createPageVariableNameWithDatabase",defaultMessage:"New page added in {databaseName}"},createPageVariableNameWithDatabaseAndStepNumber:{id:"automations.actions.createPageVariableNameWithDatabaseAndStepNumber",defaultMessage:"New page added in {databaseName} from step {stepNumber}"},createPageDescription:{id:"automations.actions.createPageDescription",defaultMessage:"Adds a new page to a database."}}),_={relation:!0,person:!0,multi_select:!0,title:!1,text:!1,url:!1,email:!1,phone_number:!1,checkbox:!1,created_by:!1,last_edited_by:!1,file:!1,select:!1,status:!1,number:!1,date:!1,created_time:!1,last_edited_time:!1,last_visited_time:!1,formula:!1,rollup:!1,button:!1,auto_increment_id:!1,location:!1,verification:!1},S=new Set(["button","event","recurrence"]),w={type:"create_page",display:{icon:c.R,name:y.createPage,description:y.createPageDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();return"notification_event"===t&&(t="event"),"event"===t?await e.checkSubscribed():S.has(t)},getExecutionDependencies:(e,t)=>{const n=[],o=t.getConfig();return null!=o&&o.collection&&(n.push({type:"record_permission",pointer:o.collection,minimumRole:"content_only_editor"},{type:"collection_default_template_record_permission",pointer:o.collection,minimumRole:"none"}),null!=o&&o.template_page_id&&n.push({type:"record_permission",pointer:{id:o.template_page_id,spaceId:o.collection.spaceId,table:g.iU},minimumRole:"reader"})),n},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};const o=e.getRecordModel(n.collection);if(!o)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};if(!n.collection.spaceId)return{error:new b.MO("Collection missing space ID")};if(n.template_page_id){const t=e.getRecordModel({id:n.template_page_id,table:g.iU});if(!t)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(!t.isTemplate())return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(t.getParentId()!==n.collection.id)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}}}let i=!1,r=!1;for(const a of e.automationModel.getActionIds()){if(a===t.id)continue;const o=e.getRecordModel({id:a,spaceId:e.automationModel.getSpaceId(),table:f.Xj});var l;if("create_page"===(null==o?void 0:o.type))i=!0,(null===(l=o.getConfig())||void 0===l||null===(l=l.collection)||void 0===l?void 0:l.id)===n.collection.id&&(r=!0)}const c=(0,s.Kd)({source:"action",action_id:t.id,action_output_type:"page"}),d=e.automationModel.getActionIds().indexOf(t.id)??-1,u=o.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone,intl:e.intl}),p=r?e.intl.formatMessage(y.createPageVariableNameWithDatabaseAndStepNumber,{databaseName:u,stepNumber:d+1}):i?e.intl.formatMessage(y.createPageVariableNameWithDatabase,{databaseName:u}):e.intl.formatMessage(y.createPageDefaultVariableName);return{value:{valueTypes:[{kind:a.yp.ContextValue,id:c,name:p,type:{type:"block",collection:n.collection}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection||!n.collection.spaceId)return{error:new b.mK({pointer:null==n?void 0:n.collection,actionId:t.id})};const o=await e.loadRecordModel(n.collection);if(!o)return{value:{values:[]}};const c=o.getSpaceShardedPointer(),u=o.getNormalizedSchema();let f,y,_;if(u){const o=await(0,i.g9)({config:n,collectionPointer:c,collectionSchema:u,actionId:t.id,context:e});if(m.x.isFail(o))return o;f=o.value}else f={};if(n.template_page_id){const t={id:n.template_page_id,spaceId:n.collection.spaceId,table:g.iU};k({getRecordModel:(await e.handleDataRequest({recordPointers:[t]})).getRecordModel,pointer:t})&&(y=n.template_page_id)}if(!(0,v.$K)(y)){const t=(await e.handleDataRequest({recordPointers:[n.collection]})).getRecordModel(n.collection),o=null==t?void 0:t.getDefaultTemplatePagePointer();if(o){k({getRecordModel:(await e.handleDataRequest({recordPointers:[o]})).getRecordModel,pointer:o})&&(y=o.id)}}const S=[];if(y){const t=await e.executeEffectMap.initializeTemplateInDatabase({templateId:y,collection:n.collection,propertyUpdates:f});if(m.x.isFail(t))return t;_=t.value.pageId}else{_=(0,p.ZP)();const t={created_time:Date.now(),last_edited_time:Date.now(),id:_,type:r.Ti.page,version:0,parent_id:n.collection.id,parent_table:h.v,alive:!0,space_id:n.collection.spaceId,properties:f,...e.author?{created_by_table:e.author.table}:{},...e.author?{created_by_id:e.author.id}:{}};S.push(d.op.set({pointer:{table:g.iU,id:t.id,spaceId:t.space_id},path:[],args:t})),e.author&&S.push(d.op.update({pointer:{table:g.iU,id:_,spaceId:c.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}const w=o.isPageTreeCollection(),I=o.getRootPagePointer();if(w&&I){const e=(0,l.A6)(I.table,g.iU);if(!e)throw new Error(`Could not find child path for parent table ${I.table} and child table ${g.iU}`);S.push({pointer:I,path:e,command:"insertChildrenAfter",args:{ids:[_]}})}if(S.length>0){const n=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"create_page",collection:c,pageId:_},operations:S});if(n.error)return n}const x=(0,s.Kd)({source:"action",action_id:t.id,action_output_type:"page"});return{value:{values:[{kind:a.yp.ContextValue,id:x,value:{type:"block",value:{table:g.iU,id:_,spaceId:c.spaceId}}}]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,o=t.getConfig();return o?(0,i.vp)({pointer:t.pointer,config:o,visitor:n}):[]}};function k(e){const{getRecordModel:t,pointer:n}=e,o=u.DW(n,t);return u.Zg(o)}},28751:(e,t,n)=>{n.d(t,{z:()=>ae,P:()=>se});var o=n(23290),i=n(9291),r=n(11751),a=n(149);const s=(0,i.defineMessages)({assistant:{id:"automations.actions.assistant",defaultMessage:"Notion AI"},assistantDescription:{id:"automations.actions.assistantDescription",defaultMessage:"Uses Notion AI to execute a task."}}),l={type:"assistant",display:{icon:r.t,name:s.assistant,description:s.assistantDescription,hasSideEffects:!0},isAvailableForContext:async e=>"wild_west"===await e.checkExperimentGroup("assistant_variant"),getExecutionDependencies:(e,t)=>[],typecheck:(e,t)=>({value:{valueTypes:[]}}),execute:async(e,t)=>{const n=t.getConfig();if("code"===(null==n?void 0:n.type)&&n.value){const o=await e.executeEffectMap.commitCode({actionId:t.id,code:n.value});if(a.x.isFail(o))return o}if("prompt"===(null==n?void 0:n.type)&&n.value){const o=await e.executeEffectMap.commitPrompt({actionId:t.id,prompt:n.value});if(a.x.isFail(o))return o}return{value:{values:[]}}},acceptFormulaVisitor:e=>[]};n(57658);var c=n(30120),d=n(92996),u=n(40506),p=n(84116),m=n(45953),f=n(98963),g=n(70203),h=n(81730),v=n(41432),b=n(72126),y=n(59753),_=n(482),S=n(4615),w=n(96367),k=n(21202),I=n(6287);async function x(e){const{completeSprintAction:t,completeSprintExecutionContext:n}=e,o=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext,r=w.qB[d.p$].current.reducer.getCombinatorFilter(t);return await C((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,filter:r,limit:1})),e)}(n);if(a.x.isFail(o))return o;const i=o.value.blockIds[0],r=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext,r=w.qB[d.p$].next.reducer.getCombinatorFilter(t);return await C((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,filter:r,limit:1})),e)}(n);if(a.x.isFail(r))return r;const s=b.Ps(r.value.blockIds);let l,c;if(s)c=s,l=1;else{const e=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusNextOptionName:o,sprintStatusPropertyId:i}=t.sprintCollectionContext,{context:r,action:a}=t.automationContext,{recordMap:s,spaceId:l}=t,c={id:n,table:k.iU,spaceId:l},d=s.getModel(c);if(!d)return{error:new h.Do({actionId:a.id,pointer:c})};const u=A({intl:r.intl,userTimeZone:r.userTimeZone,getRecordModel:y.om.fromRecordMap(s),incrementSprintIdAmount:1,sourceSprintPageModel:d}),p={title:(0,g.TPx)(u),[i]:[[o]]};return await M({completeSprintExecutionContext:t,pageProperties:p})}({completeSprintExecutionContext:n,currentSprintPageId:i});if(a.x.isFail(e))return e;c=e.value.blockId,l=2}const u=await async function(e){const{sprintUniqueIdPropertyId:t,sprintStatusPropertyId:n,sprintStatusFutureOptionName:o,sprintCollectionPointer:i}=e.sprintCollectionContext,{context:r,action:a}=e.automationContext,s={operator:"and",filters:[{property:n,filter:{operator:"status_is",value:{type:"is_option",value:o}}}]};return await C((()=>r.executeEffectMap.queryCollection({actionId:a.id,collection:i,filter:s,sort:[{property:t,direction:"ascending"}],limit:1})),e)}(n);if(a.x.isFail(u))return u;let p=u.value.blockIds[0];if(!p){const e=await T({completeSprintExecutionContext:n,sprintPageWithLargestUniqueId:c,incrementFutureSprintIdAmount:1});if(l=1===l?2:3,a.x.isFail(e))return e;p=e.value.blockId}const m=await async function(e){const{sprintUniqueIdPropertyId:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext;return await C((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,sort:[{property:t,direction:"descending"}],limit:1})),e)}(n);if(a.x.isFail(m))return m;const f=m.value.blockIds[0];let v;if(v="complete_sprint"===t?{value:{blockIds:[]}}:await async function(e){const{taskStatusPropertyId:t,taskStatusCompleteGroupName:n,taskSprintRelationPropertyId:o,taskCollectionPointer:i}=e.taskCollectionContext,{context:r,action:a}=e.automationContext,s={operator:"and",filters:[{property:t,filter:{operator:"status_is_not",value:{type:"is_group",value:n}}},{filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:"current"}}},property:o}]};return await C((()=>r.executeEffectMap.queryCollection({actionId:a.id,collection:i,filter:s})),e)}(n),function(e){var t;const{sprintStatusPropertySchema:n}=e.sprintCollectionContext;return(null===(t=n.options)||void 0===t?void 0:t.some((e=>e.id===d.Rw)))??!1}(n)){const e=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:i}=e.automationContext,r=w.qB[d.p$].last.reducer.getCombinatorFilter(t);return await C((()=>o.executeEffectMap.queryCollection({actionId:i.id,collection:n,filter:r,limit:1})),e)}(n);if(a.x.isFail(e))return e;const t=e.value.blockIds[0],o=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusLastOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[];o&&c.push(_.op.update({pointer:{id:n,table:k.iU,spaceId:l},path:["properties"],args:{[i]:[[o]]}}));return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,currentSprintPageId:i});if(a.x.isFail(o))return o;if(t){const e=await async function(e){const{completeSprintExecutionContext:t,lastSprintPageId:n}=e,{sprintStatusPastOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[_.op.update({pointer:{id:n,table:k.iU,spaceId:l},path:["properties"],args:{[i]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,lastSprintPageId:t});if(a.x.isFail(e))return e}}else{const e=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusPastOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[_.op.update({pointer:{id:n,table:k.iU,spaceId:l},path:["properties"],args:{[i]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,currentSprintPageId:i});if(a.x.isFail(e))return e}const S=await async function(e){const{completeSprintExecutionContext:t,nextSprintPageId:n}=e,{sprintStatusCurrentOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r,nextSprintDateRange:a,sprintDatePropertyId:s}=t.sprintCollectionContext,{context:l,action:c}=t.automationContext,{spaceId:d}=t,u=[_.op.update({pointer:{id:n,table:k.iU,spaceId:d},path:["properties"],args:{[i]:[[o]],[s]:[(0,g.YCD)(["d",a])]}})];return await l.executeEffectMap.saveTransaction({actionId:c.id,operations:u,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,nextSprintPageId:c});if(a.x.isFail(S))return S;const I=await async function(e){const{completeSprintExecutionContext:t,nextFutureSprintPageId:n}=e,{sprintStatusNextOptionName:o,sprintStatusPropertyId:i,sprintCollectionPointer:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:l,spaceId:c}=t,d={id:n,table:k.iU,spaceId:c},u=l.getModel(d);if(!u)return{error:new h.Do({actionId:s.id,pointer:d})};l.addModel(u);const p=[_.op.update({pointer:u.pointer,path:["properties"],args:{[i]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:p,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,nextFutureSprintPageId:p});if(a.x.isFail(I))return I;const x=await T({completeSprintExecutionContext:n,sprintPageWithLargestUniqueId:f,incrementFutureSprintIdAmount:l});if(a.x.isFail(x))return x;if("complete_sprint_and_move_incomplete_tasks_to_next_sprint"===t){const e=await async function(e){const{completeSprintExecutionContext:t,incompleteTasksResult:n,nextSprintPageId:o}=e,{taskSprintRelationPropertyId:i,taskCollectionPointer:r}=t.taskCollectionContext,{context:s,action:l}=t.automationContext,{spaceId:c}=t;if(a.x.isFail(n))return n;const d=n.value.blockIds,u=d.map((e=>_.op.update({pointer:{id:e,table:k.iU,spaceId:c},path:["properties"],args:{[i]:[(0,g.YCD)((0,g.$0A)(o,c))]}})));return await s.executeEffectMap.saveTransaction({actionId:l.id,operations:u,info:{type:"update_pages",collection:r,editedProperties:[{id:i,type:"relation"}],pageIds:d}})}({completeSprintExecutionContext:n,incompleteTasksResult:v,nextSprintPageId:c});if(a.x.isFail(e))return e}else if("complete_sprint_and_move_incomplete_tasks_to_backlog"===t){const e=await async function(e,t){const{taskSprintRelationPropertyId:n,taskCollectionPointer:o}=e.taskCollectionContext,{context:i,action:r}=e.automationContext,{spaceId:s}=e;if(a.x.isFail(t))return t;const l=t.value.blockIds,c=l.map((e=>_.op.update({pointer:{id:e,table:k.iU,spaceId:s},path:["properties"],args:{[n]:void 0}})));return await i.executeEffectMap.saveTransaction({actionId:r.id,operations:c,info:{type:"update_pages",collection:o,editedProperties:[{id:n,type:"relation"}],pageIds:l}})}(n,v);if(a.x.isFail(e))return e}return{value:{}}}async function C(e,t){const{spaceId:n,recordMap:o}=t,{context:i}=t.automationContext,r=await e();if(a.x.isFail(r))return r;const s=r.value;if(s.recordMap)o.assign(s.recordMap.toRecordMap());else{const e=s.blockIds.map((e=>({id:e,table:k.iU,spaceId:n}))),t=await i.loadRecordModel(e);o.assign(t)}return{value:{blockIds:s.blockIds}}}async function T(e){const{completeSprintExecutionContext:t,sprintPageWithLargestUniqueId:n,incrementFutureSprintIdAmount:o}=e,{sprintStatusFutureOptionName:i,sprintStatusPropertyId:r}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:l,spaceId:c}=t,d={id:n,table:k.iU,spaceId:c},u=l.getModel(d);if(!u)return{error:new h.Do({actionId:s.id,pointer:d})};const p=A({intl:a.intl,userTimeZone:a.userTimeZone,getRecordModel:y.om.fromRecordMap(l),incrementSprintIdAmount:o,sourceSprintPageModel:u}),m={title:(0,g.TPx)(p),[r]:[[i]]};return await M({completeSprintExecutionContext:t,pageProperties:m})}async function M(e){const{completeSprintExecutionContext:t,pageProperties:n}=e,{recordMap:o,sprintCollectionContext:i,automationContext:r,spaceId:s}=t,{context:l,action:c}=r,d=i.sprintCollectionPointer,u=o.getModel(d);if(!u)return{error:new h.fH("invalid_record",`Could not find collection record: ${d.id}`)};let p;const m=u.getDefaultTemplatePagePointer();if(m){const e=await l.executeEffectMap.initializeTemplateInDatabase({templateId:m.id,collection:u.getSpaceShardedPointer(),propertyUpdates:n});if(a.x.isFail(e))return e;p=e.value.pageId;const t={id:p,table:k.iU,spaceId:s},i=await l.loadRecordModel(t);if(!i)return{error:new h.fH("invalid_record",`Could not find new sprint page: ${t.id}`)};o.addModel(i)}else{p=(0,S.ZP)();const e={created_time:Date.now(),last_edited_time:Date.now(),id:p,type:v.Ti.page,version:0,parent_id:d.id,parent_table:I.v,alive:!0,space_id:s,properties:n,...l.author?{created_by_table:l.author.table}:{},...l.author?{created_by_id:l.author.id}:{}},t=[_.op.set({pointer:{id:p,table:k.iU,spaceId:s},path:[],args:e})],i=await l.executeEffectMap.saveTransaction({actionId:c.id,operations:t,info:{type:"create_page",collection:d,pageId:p}});if(a.x.isFail(i))return i;o.setValue({id:p,table:k.iU,spaceId:s},e)}return{value:{blockId:p}}}const P=(0,i.defineMessages)({defaultSprintName:{id:"completeSprint.newSprint.defaultName",defaultMessage:"Sprint"},sprintNameWithId:{id:"completeSprint.newSprintWithId.name",defaultMessage:"Sprint {sprintId}"}});function A(e){const{intl:t,userTimeZone:n,getRecordModel:o,sourceSprintPageModel:i,incrementSprintIdAmount:r}=e,a=i.getRenderTitle({intl:t,userTimeZone:n,getRecordModel:o}),s=b.Z$(null==a?void 0:a.trim().split(" "));let l;if(s){const e=parseInt(s);isNaN(e)||(l=e+r)}return void 0!==l?t.formatMessage(P.sprintNameWithId,{sprintId:l}):t.formatMessage(P.defaultSprintName)}const R={type:"complete_sprint",isAvailableForContext:async e=>Promise.resolve("recurrence"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>{const n=t.getConfig(),o=[];return null!=n&&n.sprint_collection&&o.push({type:"record_permission",pointer:n.sprint_collection,minimumRole:"editor"}),null!=n&&n.task_collection&&o.push({type:"record_permission",pointer:n.task_collection,minimumRole:"editor"}),o},typecheck:(e,t)=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n,i,r,s,l,v,b,y,_,S,w;const k=t.getConfig();if(!k)return{error:new h.Qq({actionId:t.id})};const I=m.Ak.create(),C=await e.loadRecordModel(k.sprint_collection);if(!C)return{error:new h.Do({actionId:t.id,pointer:k.sprint_collection})};I.addModel(C);const T=C.getNormalizedSchema(),M=null===(n=C.getFormat())||void 0===n||null===(n=n.app_uri_map)||void 0===n?void 0:n[d.b0.StatusV2];if(!M)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:d.b0.StatusV2})};const P=null===(i=C.getFormat())||void 0===i||null===(i=i.app_uri_map)||void 0===i?void 0:i[d.b0.UniqueId];if(!P)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:d.b0.UniqueId})};const A=null===(r=C.getFormat())||void 0===r||null===(r=r.app_uri_map)||void 0===r?void 0:r[d.b0.Dates];if(!A)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:d.b0.Dates})};const R=T[M];if(!R||"status"!==R.type)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:d.b0.StatusV2})};const D=null===(s=R.options)||void 0===s||null===(s=s.find((e=>e.id===d.df)))||void 0===s?void 0:s.value,B=null===(l=R.options)||void 0===l||null===(l=l.find((e=>e.id===d.Rw)))||void 0===l?void 0:l.value,E=null===(v=R.options)||void 0===v||null===(v=v.find((e=>e.id===d.SF)))||void 0===v?void 0:v.value,F=null===(b=R.options)||void 0===b||null===(b=b.find((e=>e.id===d.YE)))||void 0===b?void 0:b.value,Z=null===(y=R.options)||void 0===y||null===(y=y.find((e=>e.id===d.eH)))||void 0===y?void 0:y.value;if(!(D&&E&&F&&Z))return{error:new h.fH("invalid_property_schema",`Could not find required options for ${d.b0.StatusV2}.`)};const V={id:e.automationModel.id,table:f.cv,spaceId:C.id},j=await e.loadRecordModel(V);if(!j||!j.isType("recurrence"))return{error:new h.Do({actionId:t.id,pointer:V})};const U=await e.loadRecordModel(k.task_collection);if(!U)return{error:new h.Do({actionId:t.id,pointer:k.task_collection})};I.addModel(U);const L=null===(_=U.getFormat())||void 0===_||null===(_=_.app_uri_map)||void 0===_?void 0:_[d.Es.Status];if(!L)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:d.Es.Status})};const O=null===(S=U.getFormat())||void 0===S||null===(S=S.app_uri_map)||void 0===S?void 0:S[d.Es.TaskToSprintRelation];if(!O)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:d.Es.TaskToSprintRelation})};const N=U.getNormalizedSchema(),z=N[L];if(!z||"status"!==z.type)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:d.Es.Status})};const W=null===(w=z.groups)||void 0===w||null===(w=w.find((e=>e.id===d.uS)))||void 0===w?void 0:w.name;if(!W)return{error:new h.fH("invalid_property_schema",`Could not find required group for ${d.Es.Status}.`)};const q=function(e){let t,n;if(e.forEach((e=>{e.kind===p.yp.ContextValue&&(e.id===o.Pv&&"date"===e.value.type&&(0,u.h)(e.value.value)?t=e.value.value:e.id===o.JL&&"text"===e.value.type&&(n=(0,g.QaF)(e.value.value)))})),!(t&&n))return;return{nextSprintDateRange:t,completeSprintActionType:n}}(e.values);let H,K;if(q)H=q.completeSprintActionType,K=q.nextSprintDateRange;else{const e=j.getTrigger().recurrence,t=function(e){const{nextSprintStartDate:t,recurrence:n}=e,o=n.frequency,i=c.ou.fromJSDate(t).toUTC().setZone("local",{keepLocalTime:!0});if("week"!==o)return;const r=i.plus({weeks:n.interval}).minus({days:1}),a=e=>e.toISODate();return{type:"daterange",start_date:a(i),end_date:a(r)}}({nextSprintStartDate:c.ou.fromJSDate(new Date(Date.now())).toUTC().setZone("local",{keepLocalTime:!0}).toJSDate(),recurrence:e});if(!t)return{error:new h.fH("misc",`Expected a next sprint date range for recurrence automation: ${j.id}`)};K=t,H=k.complete_sprint_action}const G={spaceId:C.space_id,automationContext:{action:t,context:e},sprintCollectionContext:{sprintCollectionPointer:k.sprint_collection,sprintCollectionSchema:T,nextSprintDateRange:K,sprintDatePropertyId:A,sprintStatusCurrentOptionName:E,sprintStatusFutureOptionName:Z,sprintStatusNextOptionName:F,sprintStatusPastOptionName:D,sprintStatusLastOptionName:B,sprintStatusPropertyId:M,sprintStatusPropertySchema:R,sprintUniqueIdPropertyId:P},taskCollectionContext:{taskCollectionPointer:k.task_collection,taskCollectionSchema:N,taskSprintRelationPropertyId:O,taskStatusCompleteGroupName:W,taskStatusPropertyId:L,taskStatusPropertySchema:z},recordMap:I},$=await x({completeSprintAction:H,completeSprintExecutionContext:G});return a.x.isFail($)?$:{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var D=n(48777),B=n(88437),E=n(97880);const F=(0,i.defineMessages)({duplicateBlocks:{id:"automations.actions.duplicateBlocks",defaultMessage:"Insert blocks"},duplicateBlocksDescription:{id:"automations.actions.duplicateBlocksDescription",defaultMessage:"Insert text or blocks on this page."}}),Z={type:"duplicate_blocks",display:{icon:B.a,name:F.duplicateBlocks,description:F.duplicateBlocksDescription,hasSideEffects:!0},isAvailableForContext:async e=>Promise.resolve("button_block"===e.contextType),getExecutionDependencies:(e,t)=>[{type:"record_permission",pointer:e.automationModel.getParentPointer(),minimumRole:"content_only_editor"}],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n;const o=b.Ps(t.getBlocks()??[]),i=(null===(n=t.getConfig())||void 0===n?void 0:n.insertion_point)??y.IN.DEFAULT_INSERTION_POINT;return(0,E.$K)(o)&&await e.executeEffectMap.duplicateBlockChildren({blockPointer:{table:k.iU,id:o,spaceId:e.automationModel.getSpaceId()},insertionPoint:i}),{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var V=n(3865),j=n(78106),U=n(76218),L=n(84169);const O=(0,i.defineMessages)({modalConfirmation:{id:"automations.actions.modalConfirmation",defaultMessage:"Show confirmation"},modalConfirmationDescription:{id:"automations.actions.modalConfirmationDescription",defaultMessage:"Shows a confirmation window before proceeding."}}),N={type:"modal_confirmation",display:{icon:L.m,name:O.modalConfirmation,description:O.modalConfirmationDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>[],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n,o,i;const r=t.getConfig();let s=[];if(null!=r&&r.text){const n=await(0,U.OH)({value:r.text,context:{...e,returnType:{type:"text"}},executeFormula:e.executeContextualFormula});if(a.x.isFail(n))return{error:new h.x6({actionId:t.id,cause:n.error})};s=(0,j.j4)(n.value)}(0,g.VrM)(s)>f.tb&&(s=(0,g.Zdj)(s,f.tb),s.push((0,g.V3y)("â€¦")));return"cancel"===await e.executeEffectMap.displayModal({format:{icon:null===(n=e.automationModel.getProperties())||void 0===n?void 0:n.icon,text:s,continueButtonText:(null==r||null===(o=r.continue_button)||void 0===o?void 0:o.text)??"",cancelButtonText:(null==r||null===(i=r.cancel_button)||void 0===i?void 0:i.text)??""}})?{error:new h.nQ}:{value:{values:[]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,o=t.getConfig();return o?(0,V.n6)({fieldName:"text",config:o,pointer:t.pointer,visitor:n}):[]}};var z=n(9999);const W=(0,i.defineMessages)({openPage:{id:"automations.actions.openPage",defaultMessage:"Open page"},openPageDescription:{id:"automations.actions.openPageDescription",defaultMessage:"Opens a specified page."}}),q={type:"open_page",display:{icon:z.J,name:W.openPage,description:W.openPageDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>{var n,o;const i=t.getConfig();return"page"===(null==i||null===(n=i.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==i?void 0:i.target.page,minimumRole:"reader"}]:"variable"===(null==i||null===(o=i.target)||void 0===o?void 0:o.type)?[{id:i.target.id,minimumRole:"reader",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();return null!=n&&n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"open_page",key:"target"}]}}},execute:(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new h.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o;if("page"===n.target.type)o=n.target.page;else if("variable"===n.target.type){const i=(0,j.dh)(e.values,n.target.id);if(!i)return{error:new h.Hb({actionId:t.id,source:"action",variable:i})};if("block"===i.value.type)o=i.value.value;else{if("array"!==i.value.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:i.value})};{const e=i.value.values[0];if(!e||"block"!==e.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:i.value})};o=e.value}}}else(0,E.t1)(n.target);return e.executeEffectMap.navigateToPage({actionId:t.id,page:o,openIn:t.getOpenPageIn()}),{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,i=n.getConfig();if(!i)return[];const r=[];return"variable"===(null==i||null===(t=i.target)||void 0===t?void 0:t.type)&&r.push(...(0,V.AQ)({pointer:n.pointer,target:i.target,visitor:o})),r}};var H=n(49019);const K=(0,i.defineMessages)({queryCollection:{id:"automations.actions.queryCollection",defaultMessage:"Get pages"},queryCollectionDescription:{id:"automations.actions.queryCollectionDescription",defaultMessage:"Get a list of pages from a database with optional filters and sorts, to be used in a subsequent automation step."},queryCollectionPages:{id:"automations.actions.queryCollectionPages",defaultMessage:"Pages from step {stepNumber}"}}),G={type:"query_collection",display:{icon:H.e,name:K.queryCollection,description:K.queryCollectionDescription,hasSideEffects:!1},isAvailableForContext:async()=>Promise.resolve(!1),getExecutionDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.collection?[{type:"record_permission",pointer:null==n?void 0:n.collection,minimumRole:"reader"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{valueTypes:[]}};const o=(0,j.Kd)({source:"action",action_id:t.id,action_output_type:"pages"}),i=e.automationModel.getActionIds().indexOf(t.id)??-1;return{value:{valueTypes:[{kind:p.yp.ContextValue,id:o,name:e.intl.formatMessage(K.queryCollectionPages,{stepNumber:i+1}),type:{type:"array",of:{type:"block",collection:n.collection}}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{values:[]}};if(null==n||!n.collection.spaceId)return{error:new h.mK({pointer:null==n?void 0:n.collection,actionId:t.id})};const o={table:I.v,id:null==n?void 0:n.collection.id,spaceId:null==n?void 0:n.collection.spaceId},i=await e.executeEffectMap.queryCollection({actionId:t.id,collection:o,filter:null==n?void 0:n.filter,sort:null==n?void 0:n.sort,limit:null==n?void 0:n.limit});if(i.error)return i;const r=(0,j.Kd)({source:"action",action_id:t.id,action_output_type:"pages"});return{value:{values:[{kind:p.yp.ContextValue,id:r,value:{type:"array",values:i.value.blockIds.map((e=>({type:"block",value:{table:k.iU,id:e,spaceId:o.spaceId}})))}}]}}},acceptFormulaVisitor:e=>[]};var $=n(24600),Q=n(77420);const Y=(0,i.defineMessages)({slackNotification:{defaultMessage:"Send Slack notification toâ€¦",id:"automations.actions.slackNotification"},slackNotificationDescription:{defaultMessage:"Sends a Slack notification to a user or channel.",id:"automations.actions.slackNotificationDescription"}}),J={type:"slack_notification",display:{icon:$.P,name:Y.slackNotification,description:Y.slackNotificationDescription,hasSideEffects:!1},isAvailableForContext:async e=>{const t=e.automationActions.filter((e=>e.isType("slack_notification"))),n="canAddAction"===e.checkType?t.length<1:t.length<=1;return Promise.resolve("event"===e.contextType&&n)},getExecutionDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.external_bot_id?[{minimumRole:"editor",pointer:{id:n.external_bot_id,table:Q.cZ},type:"record_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.external_bot_id)return{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"external_bot_id"}]}};return e.getRecordModel({id:n.external_bot_id,table:Q.cZ})?n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"target"}]}}:{value:{validationFailures:[{type:"missing_required_value",actionType:"slack_notification",key:"external_bot_id"}]}}},execute:(e,t)=>({value:{values:[]}}),acceptFormulaVisitor:e=>[]};var X=n(38297),ee=n(25651);const te=(0,i.defineMessages)({updatePages:{id:"automations.actions.updatePages",defaultMessage:"Edit pages inâ€¦"},updatePagesDescription:{id:"automations.actions.updatePagesDescription",defaultMessage:"Edits the properties of specified pages in a database."}}),ne=new Set(["button","event"]);async function oe(e){const{pointer:t,context:n,actionId:o}=e,i=await n.loadRecordModel(t);if(!i)return{error:new h.Do({pointer:t,actionId:o})};const r=await(0,X.Rd)({block:i,loadRecordModel:n.loadRecordModel});return r?{value:r.getSpaceShardedPointer()}:{error:new h.Do({pointer:t,actionId:o})}}const ie={type:"update_pages",display:{icon:ee.R,name:te.updatePages,description:te.updatePagesDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();if("notification_event"===t&&(t="event"),"event"===t){if(!(await e.checkSubscribed()))return!1;const t=e.automationActions.filter((e=>{var t;return e.isType("update_pages")&&"collection"===(null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.type)}));return"canAddAction"===e.checkType?t.length<5:t.length<=5}return ne.has(t)},getExecutionDependencies:(e,t)=>{var n,o;const i=t.getConfig();return"collection"===(null==i||null===(n=i.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==i?void 0:i.target.collection,minimumRole:"content_only_editor"}]:"variable"===(null==i||null===(o=i.target)||void 0===o?void 0:o.type)?[{id:i.target.id,minimumRole:"read_and_write",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();return null!=n&&n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"update_pages",key:"target"}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new h.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o,i,r,s=e.loadRecordModel;if("collection"===(null==n?void 0:n.target.type)){const l=await s(n.target.collection);if(!l)return{error:new h.Do({pointer:n.target.collection,actionId:t.id})};const c=await e.executeEffectMap.queryCollection({actionId:t.id,collection:n.target.collection,filter:n.target.filter,limit:n.target.limit,sort:n.target.sort});if(a.x.isFail(c))return c;r=c.value.blockIds,o=l.getNormalizedSchema(),i=n.target.collection,c.value.recordMap&&(s=y.s8.tryUntilFound(s,y.s8.fromRecordMapWithRole(c.value.recordMap)))}else if("variable"===n.target.type){const l=(0,j.dh)(e.values,n.target.id);if(!l)return{error:new h.L({actionId:t.id,contextValueId:n.target.id})};if("block"===l.value.type){let n=await oe({pointer:l.value.value,context:e,actionId:t.id});if(a.x.isFail(n)){const t=function(e){var t;const{actionModels:n,contextValue:o}=e,i=(0,j.MY)(o.id);if("action"!==i.source)return{error:new h.Hb({source:"global",variable:o.value})};const r=n.find((e=>e.id===i.action_id));if(!r||"create_page"!==r.getType())return{error:new h.Hb({actionId:i.action_id,source:"action",variable:o.value})};const a=null===(t=r.getConfig())||void 0===t?void 0:t.collection;return a?{value:a}:{error:new h.Hb({actionId:i.action_id,source:"action",variable:o.value})}}({actionModels:e.actionModels,contextValue:l});if(a.x.isFail(t))return n;n=t}r=[l.value.value.id],i=n.value;const s=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:i});if(a.x.isFail(s))return s;o=s.value.collectionSchema}else{if("array"!==l.value.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:l.value})};{const n=l.value.values[0];if(!n||"block"!==n.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:n})};const c=await s(n.value),d=c?await(0,X.Rd)({block:c,loadRecordModel:s}):void 0;if(!d)return{error:new h.Do({pointer:n.value,actionId:t.id})};const u=d.getSpaceShardedPointer();r=b.oA(l.value.values.map((e=>"block"===e.type?e.value.id:void 0)));const p=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:u});if(a.x.isFail(p))return p;o=p.value.collectionSchema,i=u}}}else if("page"===n.target.type){const s=n.target.page,l=await oe({pointer:s,context:e,actionId:t.id});if(a.x.isFail(l))return l;r=[s.id],i=l.value;const c=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:i});if(a.x.isFail(c))return c;o=c.value.collectionSchema}else(0,E.t1)(n.target);const l=[];for(const c of r){const r=await s({table:k.iU,id:c,spaceId:i.spaceId});let d;if(o){const s=null==r?void 0:r.getProperties(),l=await(0,V.g9)({config:n,collectionPointer:i,collectionSchema:o,actionId:t.id,context:e,getCurrentPropertyValue:e=>null==s?void 0:s[e]});if(a.x.isFail(l))return l;d=l.value}else d={};l.push({pointer:{table:k.iU,id:c,spaceId:i.spaceId},command:"update",path:["properties"],args:d}),e.author&&l.push(_.op.update({pointer:{table:k.iU,id:c,spaceId:i.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}if(l.length>0){const s=(n.properties??[]).map((e=>{var t;const n=null===(t=o)||void 0===t?void 0:t[e];if(n)return{id:e,type:n.type}})).filter(E.$K),c=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"update_pages",pageIds:r,collection:i,editedProperties:s},operations:l});if(a.x.isFail(c))return c}return{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,i=n.getConfig();if(!i)return[];const r=[];if("variable"===(null==i||null===(t=i.target)||void 0===t?void 0:t.type)){const e=(0,V.AQ)({pointer:n.pointer,target:i.target,visitor:o});r.push(...e)}return r.push(...(0,V.vp)({pointer:n.pointer,config:i,visitor:o})),r}},re={query_collection:G,create_page:D.L,update_pages:ie,open_page:q,slack_notification:J,duplicate_blocks:Z,modal_confirmation:N,complete_sprint:R,assistant:l};function ae(e){return re[e]}function se(e){return(0,o.FP)(e).map((e=>ae(e)))}},81730:(e,t,n)=>{n.d(t,{Do:()=>a,Hb:()=>s,L:()=>p,MO:()=>o,Ox:()=>c,Pn:()=>l,Qq:()=>f,fH:()=>i,iR:()=>d,mK:()=>r,nQ:()=>m,x6:()=>u});n(21703);class o extends Error{}class i extends Error{constructor(e,t){super(t),this.type=e}}class r extends i{constructor(e){super("invalid_record_pointer","Invalid record pointer"),this.data=e}}class a extends i{constructor(e){super("invalid_record","Invalid record"),this.data=e}}class s extends i{constructor(e){super("invalid_variable_type","Invalid variable type"),this.data=e}}class l extends i{constructor(e){super(e.type,e.message),this.data=e}}class c extends i{constructor(e){super("invalid_property_schema","Invalid property schema"),this.data=e}}class d extends i{constructor(e){super("unsupported_context","Unsupported context"),this.data=e}}class u extends i{constructor(e){super("formula_execution_failed","Formula execution failed"),this.data=e}}class p extends i{constructor(e){super("missing_context_value","Missing context value"),this.data=e}}class m extends i{constructor(){super("user_cancelled","User cancelled")}}class f extends i{constructor(e){super("missing_action_config","Missing automation action config"),this.data=e}}Error},94412:(e,t,n)=>{n.d(t,{X:()=>r,e:()=>a});var o=n(59753),i=n(18844);class r{constructor(e){this.triggerType=void 0,this.actions=void 0,this.spaceId=void 0,this.parentPointer=void 0,this.triggerType=e.triggerType,this.actions=e.actions,this.spaceId=e.spaceId,this.parentPointer=e.parentPointer}get id(){return"structured-automation-id"}getSpaceId(){return this.spaceId}getActionIds(){return this.actions.map((e=>e.id))}getProperties(){}getTriggerType(){return this.triggerType}getParentPointer(){return this.parentPointer}}class a{constructor(e,t){this.underlying=e,this.spaceId=t}get id(){return this.underlying.id}get pointer(){return{id:this.underlying.id,table:i.Xj,spaceId:this.spaceId}}getType(){return this.underlying.type}getConfig(){return this.underlying.config}getBlocks(){return this.underlying.blocks??[]}getOpenPageIn(){var e;return(null===(e=this.underlying.config)||void 0===e?void 0:e.open_in)??o.th.DEFAULT_PEEK_MODE_FORMAT}}},61202:(e,t,n)=>{n.d(t,{Ps:()=>s,TD:()=>l});n(57658);var o=n(3865),i=n(77492),r=n(72126),a=n(97880);function*s(e){const{permissions:t,typecheckContextValues:n}=e,s=[];for(const l of t)if("record_permission"===l.type)s.push((0,r.Xh)(l));else if("collection_default_template_record_permission"===l.type){const e=yield*i.R.fetchRecord(l.pointer),t=null==e?void 0:e.getDefaultTemplatePagePointer();(0,a.$K)(t)&&s.push({minimumRole:l.minimumRole,pointer:t,type:"record_permission"})}else if("formula_value_permission"===l.type){const e=(0,o.rX)({formulaValueTypes:n,minimumRole:l.minimumRole,targetId:l.id});e.length>0&&s.push(...e)}else(0,a.t1)(l);return s}const{sync:l,async:c}=i.R.makeRunners(s)},10450:(e,t,n)=>{n.d(t,{E$:()=>S,J0:()=>p,NG:()=>x,R4:()=>w,W7:()=>I,ZF:()=>k,Zy:()=>C,dG:()=>b,io:()=>_,rb:()=>y,rj:()=>T,zW:()=>v});var o=n(9291),i=n(53877),r=n(84116),a=n(78106),s=n(72126),l=n(19889),c=n(70203),d=n(23290);const u=(0,o.defineMessages)({buttonPage:{id:"automations.triggers.button.page.label",defaultMessage:"This page"},currentUser:{id:"automations.triggers.currentUser.label",defaultMessage:"Person who clicked button"},now:{id:"automations.triggers.now.label",defaultMessage:"Now"},today:{id:"automations.triggers.today.label",defaultMessage:"Today"}});function p(){return(0,a.Kd)({source:"global",global:"button_page"})}function m(){return(0,a.Kd)({source:"global",global:"current_user"})}function f(){return(0,a.Kd)({source:"global",global:"now"})}function g(){return(0,a.Kd)({source:"global",global:"today"})}function h(e){const{blockPointer:t,currentUserId:n}=e,o=p(),a=m(),s=f(),c=g();return{values:[{kind:r.yp.ContextValue,id:o,value:{type:"block",value:t}},{kind:r.yp.ContextValue,id:a,value:{type:"person",value:{table:l.KJ,id:n}}},{kind:r.yp.ContextValue,id:s,value:{type:"date",value:(0,i.CQ)(Date.now(),e.userTimeZone)}},{kind:r.yp.ContextValue,id:c,value:{type:"date",value:(0,i.hT)(Date.now(),e.userTimeZone)}}]}}function v(e){const{collectionPointer:t}=e,n=p(),o=m(),i=f(),a=g();return{valueTypes:[{kind:r.yp.ContextValue,id:n,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:t}},{kind:r.yp.ContextValue,id:o,name:e.intl.formatMessage(u.currentUser),type:{type:"person"}},{kind:r.yp.ContextValue,id:i,name:e.intl.formatMessage(u.now),type:{type:"date"}},{kind:r.yp.ContextValue,id:a,name:e.intl.formatMessage(u.today),type:{type:"date"}}]}}function b(e){return h(e)}function y(e){const t=m(),n=f(),o=g(),i=p(),a={kind:r.yp.ContextValue,id:t,name:e.intl.formatMessage(u.currentUser),type:{type:"person"}},l={kind:r.yp.ContextValue,id:n,name:e.intl.formatMessage(u.now),type:{type:"date"}},c={kind:r.yp.ContextValue,id:o,name:e.intl.formatMessage(u.today),type:{type:"date"}},d=e.collectionPointer?{kind:r.yp.ContextValue,id:i,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:e.collectionPointer}}:void 0;return{valueTypes:s.oA([a,l,c,d])}}function _(e){const{currentUserId:t,pagePointer:n}=e,o=m(),a=f(),s=g(),c=p();return{values:[{kind:r.yp.ContextValue,id:o,value:{type:"person",value:{table:l.KJ,id:t}}},{kind:r.yp.ContextValue,id:a,value:{type:"date",value:(0,i.CQ)(Date.now(),e.userTimeZone)}},{kind:r.yp.ContextValue,id:s,value:{type:"date",value:(0,i.hT)(Date.now(),e.userTimeZone)}},{kind:r.yp.ContextValue,id:c,value:{type:"block",value:n}}]}}function S(e){const t=f(),n=g(),o=p(),i={kind:r.yp.ContextValue,id:o,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:e.collectionPointer}};return{valueTypes:[{kind:r.yp.ContextValue,id:t,name:e.intl.formatMessage(u.now),type:{type:"date"}},{kind:r.yp.ContextValue,id:n,name:e.intl.formatMessage(u.today),type:{type:"date"}},i]}}function w(e){return h(e)}function k(){return{valueTypes:[]}}function I(){return{values:[]}}function x(e){const{nextSprintDateRange:t,completeSprintActionType:n}=e;return{values:[{kind:r.yp.ContextValue,id:d.Pv,value:{type:"date",value:t}},{kind:r.yp.ContextValue,id:d.JL,value:{type:"text",value:(0,c.TPx)(n)}}]}}function C(){return{valueTypes:[]}}function T(){return{values:[]}}},86433:(e,t,n)=>{n.d(t,{rS:()=>p});n(57658);var o=n(77492),i=n(78106),r=n(42875),a=n(72126),s=n(149),l=n(97880),c=n(28751),d=n(61202),u=n(10450);const{sync:p,async:m}=o.R.makeRunners((function*(e){let t=[];return"button_property"===e.contextType?t=(0,u.zW)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"button_block"===e.contextType?t=(0,u.rb)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"structured_automation"===e.contextType?t=(0,u.Zy)().valueTypes??[]:"event"===e.contextType?t=(0,u.E$)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"recurrence"===e.contextType?t=(0,u.ZF)().valueTypes??[]:(0,l.t1)(e),yield*f({automationModel:e.automationModel,actionModels:e.actionModels,handleDataRequest:(0,i.yf)(e.getRecordModel,e.loadRecordModel),intl:e.intl,getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone||(0,r.r)(),valueTypes:t})}));function*f(e){const{actionModels:t,automationModel:n}=e,r={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}};for(const l of t){const t=(0,c.z)(l.getType()),u=t.getExecutionDependencies({automationModel:n},l),p=yield*(0,d.Ps)({permissions:u,typecheckContextValues:r.valueTypes});yield*o.R.fetchRecords(p.map((e=>e.pointer)));const m=t.typecheck(e,l),f=a.d9(r.valueTypes);if(r.actionInputValueTypes[l.id]=f,s.x.isFail(m))return m;for(const e of m.value.valueTypes??[]){r.valueTypes.some((t=>(0,i.Fl)(e,t)))||r.valueTypes.push(e)}m.value.validationFailures&&(r.actionValidationFailures[l.id]=m.value.validationFailures)}return{value:r}}const{sync:g,async:h}=o.R.makeRunners(f)},23290:(e,t,n)=>{n.d(t,{E2:()=>c,FP:()=>s,Gl:()=>m,JL:()=>r,Pv:()=>i,Xp:()=>f,lK:()=>l,o9:()=>d,ss:()=>p,xZ:()=>u});var o=n(78106);const i=(0,o.Qc)("COMPLETE_SPRINT_NEXT_SPRINT_DATE_RANGE"),r=(0,o.Qc)("COMPLETE_SPRINT_ACTION_TYPE"),a={duplicate_blocks:{display:!0},create_page:{display:!0},modal_confirmation:{display:!0},open_page:{display:!0},query_collection:{display:!0},slack_notification:{display:!0},update_pages:{display:!0},assistant:{display:!0},complete_sprint:{display:!1}};function s(e){return Object.entries(a).filter((t=>{let[n,o]=t;return o[e]})).map((e=>{let[t]=e;return t}))}function l(e,t){return a[e][t]}const c=["replace","append","remove"];function d(e){return(null==e?void 0:e.action)||"replace"}const u=100,p=50,m={recurrence:{min:1,max:1},notification_event:{min:1,max:1},button:{min:0,max:"default_bound"},event:{min:1,max:"default_bound"}};function f(e){return l(e.type,"display")}},36576:(e,t,n)=>{n.d(t,{sU:()=>I,xU:()=>y});n(57658);var o=n(41432),i=n(99036),r=n(14215),a=n(38297),s=n(72126),l=n(59753),c=n(63306),d=n(86517),u=n(606),p=n(21202),m=n(70279),f=n(33709),g=n(23867),h=n(62965),v=n(70203),b=n(97880);async function y(e){const{loadRecordValue:t,operationPointers:n,getInitialRecordModel:o,getFinalRecordModel:i}=e,a=[],c=[];return await Promise.all(n.map((async e=>{if((0,u.$O)(e,p.iU)){const n=o.getRecordValue(e),d=i.getRecordValue(e),u=null==d?void 0:d.space_id,m={...e,spaceId:(0,g.C)(u)},f=(0,r.E)(_(n),_(d));if(await Promise.all([...f.deleted.map((async n=>{await async function(e){const t=e.getInitialRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;const n=e.getFinalRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(n&&n.parent_id!==e.parentId)return!0;if(!n){const t=await e.loadRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getInitialRecordModel:o,getFinalRecordModel:i})&&c.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})})),...f.created.map((async n=>{await async function(e){const t=e.getFinalRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;if(!t){const t=await e.loadRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getFinalRecordModel:i})&&a.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})}))]),n&&d&&n.parent_id!==d.parent_id){if(n.parent_table===p.iU){let o=i.getRecordValue({table:p.iU,id:n.parent_id,spaceId:n.space_id});o||(o=await t({table:p.iU,id:n.parent_id,spaceId:n.space_id})),o&&o.content&&o.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,b.xL)(n.parent_id),parent_pointer:m}})}if(d.parent_table===p.iU){let n=i.getRecordValue({table:p.iU,id:d.parent_id,spaceId:d.space_id});n||(n=await t({table:p.iU,id:d.parent_id})),n&&n.content&&!n.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,b.xL)(d.parent_id),parent_pointer:{id:d.parent_id,table:p.iU,spaceId:d.space_id}}})}}let h;if(n&&(h=l.kk.fromBlock(n).getCollectionPointer()),(!n||!h)&&d){const e=l.kk.fromBlock(d).getCollectionPointer();if(e){let n=i.getRecordValue(e);n||(n=await t(e)),n&&n.parent_id!==d.id&&a.push({block_id:(0,b.xL)(n.parent_id),mentioned_from:{type:"collection_reference",block_id:d.id,pointer:{id:d.id,spaceId:d.space_id,table:p.iU}}})}}const v=(0,r.N)(w(n),w(d),S);for(const{blockId:t,propertyId:o}of v.created)a.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});for(const{blockId:t,propertyId:o}of v.deleted)c.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});const y=x(n),k=x(d);y&&!s.Xy(y,k)&&c.push({block_id:y.id,mentioned_from:{type:"alias",pointer:m}}),k&&!s.Xy(y,k)&&a.push({block_id:k.id,mentioned_from:{type:"alias",pointer:m}});const I=C(n),T=C(d);I&&!s.Xy(I,T)&&c.push({block_id:I.id,mentioned_from:{type:"transclusion_reference",pointer:m}}),T&&!s.Xy(I,T)&&a.push({block_id:T.id,mentioned_from:{type:"transclusion_reference",pointer:m}})}else if((0,u.$O)(e,m.x_)){const t=o.getRecordValue(e),n=i.getRecordValue(e),s=null==n?void 0:n.space_id,l={...e,spaceId:(0,g.C)(s)},d=(0,r.E)(k(t),k(n));for(const o of d.created)a.push({block_id:o,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}});for(const o of d.deleted)c.push({block_id:o,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}})}}))),{createdBacklinks:a,deletedBacklinks:c}}function _(e){const t=l.kk.fromValue(p.iU,e);return t?t.getContentIds():[]}function S(e){return`${e.blockId}${e.propertyId}`}function w(e){const t=l.kk.fromValue(p.iU,e),n=[];if(!t)return n;const o=t.getProperties();if(!o)return n;for(const i in o){const e=v.jDe(t.getProperty(i));for(const t of e)n.push({propertyId:i,blockId:t})}return n}function k(e){const t=l.kk.fromValue(m.x_,e);return t&&t.alive?v.jDe(t.getText()):[]}function I(e){window.__c={n:"filterBacklinksToHide"};const{actor:t,blockId:n,backlinks:r,getRecordModel:u}=e,v=(0,c.DW)({table:p.iU,id:n},u),y=s.Z$(v),_=v[0];if(!y||"block"!==_.table)return[];const S=(0,d.IJ)({actor:t,ancestors:v});return r.filter((e=>{const n=function(e){var t,n,o,i;return"comment_mention"===e.mentioned_from.type?{table:m.x_,id:e.mentioned_from.comment_id,spaceId:(0,g.C)(null===(t=e.mentioned_from.pointer)||void 0===t?void 0:t.spaceId)}:"reference"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.parent_block_id,spaceId:(0,g.C)(null===(n=e.mentioned_from.parent_pointer)||void 0===n?void 0:n.spaceId)}:"property_mention"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(o=e.mentioned_from.pointer)||void 0===o?void 0:o.spaceId)}:"collection_reference"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(i=e.mentioned_from.pointer)||void 0===i?void 0:i.spaceId)}:"alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type?e.mentioned_from.pointer:void(0,b.t1)(e.mentioned_from)}(e),r=(0,c.DW)(n,u);if(!(0,c.Zg)(r))return!1;const s=(0,d.IJ)({actor:t,ancestors:r});if(s){if(!S)return!1;if(!(0,h.Z)(s.from,S.from))return!1}if(r.some((e=>e.table===f.qF&&e.resolved)))return!1;if("property_mention"===e.mentioned_from.type){var v;const t=u({table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(v=e.mentioned_from.pointer)||void 0===v?void 0:v.spaceId)});if(!t)return!1;const n=(0,a.ky)({block:t,getRecordModel:u});if(n){const t=l.kk.fromCollection(n);if("title"!==e.mentioned_from.property_id){const o=i.oC(n),r=e.mentioned_from.property_id,s=o[r];if(!s)return!1;if("relation"===s.type){const e=(0,a.ky)({block:_,getRecordModel:u}),n=i.F0(s);if(!e||e.id!==n)return!1;if(i.EY({...t.pointer,propertyId:r,propertySchema:s},e))return!1}else if("title"!==s.type&&"text"!==s.type)return!1}}else if("title"===e.mentioned_from.property_id){if(!(0,o.XD)(t.type))return!1}else{if("caption"!==e.mentioned_from.property_id)return!1;if(!l.kk.fromBlock(t).isType(o.oe))return!1}}const y=(0,c.zN)(r)[0],w=(0,c.uJ)({table:p.iU,id:e.block_id},u)[1];return!y||!w||y.id!==w.id}))}function x(e){const t=l.kk.fromValue(p.iU,e);if(t&&"alias"===t.type)return t.getAliasTargetPointer()}function C(e){const t=l.kk.fromValue(p.iU,e);if(t&&"transclusion_reference"===t.type)return t.getTransclusionReferenceTargetPointer()}},49271:(e,t,n)=>{n.d(t,{N7:()=>r,ZD:()=>a});var o=n(8848),i=n(82990);function r(e){return{color:o.ZP.defaultText,fill:"currentColor",lineHeight:1.5,fontFamily:i.Z.getCompositeFontFamily(e).sans}}const a={paddingTop:3,paddingBottom:3,paddingLeft:2,paddingRight:2}},50475:(e,t,n)=>{n.d(t,{EW:()=>i});var o=n(97880);function i(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":case"home_my_tasks":return!0;case void 0:return!1;default:(0,o.t1)(e)}}},14248:(e,t,n)=>{n.d(t,{Ko:()=>T,ND:()=>D,RA:()=>x,WL:()=>R,Xq:()=>j,hz:()=>U,r9:()=>N,wg:()=>L,zk:()=>C});n(57658);var o=n(76205),i=n(30823),r=n(14714),a=n(99036),s=n(80951),l=n(10070),c=n(40506),d=n(53877),u=n(76725),p=n(72126),m=n(59753),f=n(77337),g=n(4615),h=n(74446),v=n(606),b=n(21202),y=n(19889),_=n(70203),S=n(97880);function w(e){const t=[],n=[];for(const[o,i]of Object.entries(e))i&&((0,a.S4)(o)||("person"===i.type?t.push(o):"date"===i.type&&n.push(o)));return{date:n,person:t}}const k=_.V3y(", ");function I(e,t){const n={command:"update",args:t,pointer:{table:b.iU,id:e.id},path:["properties"]};return m.kk.fromValue(e.table,(0,f.lK)(n,e.__IM_SORRY__getValue()))}function x(e){const{block:t,schema:n,propertyMapping:i,filter:r,userFilterContext:a,groupsPointer:s,relativeVariableResult:l,getRecordModel:c,intl:d,resultCache:u}=e,{userId:f,userTimeZone:g,userStartOfWeek:v}=a;let y=t;const _=m.om.tryUntilFound(m.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===y.id)return y}),h.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===y.id)return y.__IM_SORRY__getValue()}))),c),S={};for(const o of s)Object.assign(S,B({block:y,getRecordModel:_,schema:n,propertyMapping:i,group:o,intl:d,userFilterContext:a,relativeVariableResult:l,resultCache:u})),y=I(t,S);if(r){const e=Z({block:y,schema:n,filter:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:l,getRecordModel:c,intl:d,resultCache:u}),o="failsFilter"===e.type||"coercedByFilter"===e.type?e.update??{}:{};Object.assign(S,o),y=I(t,S)}for(const o of s)Object.assign(S,B({block:y,getRecordModel:_,schema:n,propertyMapping:i,group:o,intl:d,userFilterContext:a,relativeVariableResult:l,resultCache:u})),y=I(t,S);const w=I(y,S),k=p.yW(s.map((e=>{const t=C({group:e,schema:n,timeZone:g}),i=t?(0,o.q)({context:{schema:n,userId:f,userTimeZone:g,userStartOfWeek:v,relativeVariableResult:l,intl:d},filter:t}):void 0;return Boolean(i&&i({block:w,getRecordModel:c,propertyMapping:void 0,resultCache:u}))}))),x=r?(0,o.q)({filter:r,context:{schema:n,userId:f,userTimeZone:g,userStartOfWeek:v,relativeVariableResult:l,intl:d}}):void 0,T=!x||x({block:w,getRecordModel:c,propertyMapping:void 0,resultCache:u});return{coercionSucceeded:k&&T,update:S}}function C(e){const t=T(e);return t?(0,o.vA)(t)?t:{operator:"and",filters:[t]}:void 0}function T(e){const{schema:t,group:n,timeZone:o}=e,i=n.property,a=t[i];if(!a)return;const s=n.value;if((0,r.LG)(a)&&s.type===a.type){if(void 0===s.value)return{property:i,filter:{operator:"is_empty"}};if("select"===a.type)return"string"==typeof s.value?{property:i,filter:{operator:"enum_is",value:{type:"exact",value:s.value}}}:void 0;if("status"===a.type)return void 0!==s.value&&"status"===s.type?{property:i,filter:{operator:"status_is",value:"by_group"===s.value.type?{type:"is_group",value:s.value.group}:{type:"is_option",value:s.value.option}}}:void 0;if((0,r.pd)(a.type))return"object"==typeof s.value&&s.type===a.type?{property:i,filter:{operator:"person_contains",value:{type:"exact",value:s.value}}}:void 0;if("relation"===a.type)return"object"==typeof s.value&&"relation"===s.type?function(e,t){if((0,r.RA)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"exact",value:t.value.id}}};if((0,r.t2)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:t.value.value.variable}}}}}(i,s):void 0;if("location"===a.type)return"object"==typeof s.value&&"location"===s.type?{property:i,filter:{operator:"location_is",value:{type:"exact",value:s.value.id}}}:void 0;if("multi_select"===a.type)return"string"==typeof s.value?{property:i,filter:{operator:"enum_contains",value:{type:"exact",value:s.value}}}:void 0;if((0,r.A1)(a.type)){if(s.type!==a.type)return;return M(s.value,n.property,o)}if((0,r.HB)(a.type)){if(s.type!==a.type)return;return P(s.value,n.property)}if("number"===a.type){if("number"!==s.type)return;return A(s.value,n.property)}if("checkbox"===a.type){if("checkbox"!==s.type)return;return{property:i,filter:{operator:"checkbox_is",value:{type:"exact",value:s.value}}}}if("formula"===a.type){if("formula"!==s.type)return;const e=s.value;if(void 0===e.value)return;if((0,r.R7)(e))return P(e.value,n.property);if("number"===e.type)return A(e.value,n.property);if("checkbox"===e.type)return{property:i,filter:{operator:"checkbox_is",value:{type:"exact",value:e.value}}};if((0,r.Mc)(e))return M(e.value,n.property,o);if((0,r.q6)(e))return function(e,t){return{property:e,filter:{operator:"person_contains",value:{type:"exact",value:t.value}}}}(n.property,e);if((0,r.tL)(e))return(0,r.RA)(e.value)?{property:i,filter:{operator:"relation_contains",value:{type:"exact",value:e.value.id}}}:void 0;(0,S.t1)(e)}(0,S.t1)(a.type)}}function M(e,t,n){const o=(0,r.Hk)(e,n);return{property:t,filter:{operator:"date_is_within",value:{type:"exact",value:d.OQ.toPersistedDateRange(o,n)}}}}function P(e,t){if("alphabet_prefix"===e.type){const n=e.value;return isNaN(parseInt(n))?{operator:"or",filters:[{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toUpperCase()}}},{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toLowerCase()}}}]}:{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value}}}}return"other"===e.type?{property:t,filter:{operator:"string_has_no_alphabet_prefix"}}:"exact"===e.type?{property:t,filter:{operator:"string_is",value:{type:"exact",value:e.value}}}:void(0,S.t1)(e)}function A(e,t){if("range"===e.type){const{start:n,end:o}=e;return{operator:"and",filters:[{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:o}}}]}}if("out_of_range"===e.type){const{start:n,end:o}=e;return{operator:"or",filters:[{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:o}}}]}}(0,S.t1)(e)}function R(e,t){const n=e.property,o=null==t?void 0:t[n];if(null!=o&&o.derived_property_record_metadata)return!1;if(o&&s.A0(o))return!1;const i=e.value;return!i.value||("select"===i.type||"multi_select"===i.type||"status"===i.type||"person"===i.type||"checkbox"===i.type||"relation"===i.type||"date"===i.type||"number"===i.type||((0,r.R7)(i)?"exact"===i.value.type:"formula"!==i.type&&"created_by"!==i.type&&"last_edited_by"!==i.type&&"created_time"!==i.type&&"last_edited_time"!==i.type&&"location"!==i.type&&"last_visited_time"!==i.type&&void(0,S.t1)(i.type)))}function D(e){const{schema:t,group:n,block:o,resultCache:i}=e;if(!R(n,t))return{};const a=function(e){const{schema:t,group:n}=e,o=n.property,i=t[o];if(!i)return;const a=n.value;return(0,r.LG)(i)&&a.type===i.type&&void 0!==a.value?"person"===i.type?"object"==typeof a.value&&"person"===a.type?{property:o,filter:{operator:"person_does_not_contain",value:{type:"exact",value:a.value}}}:void 0:"relation"===i.type?"relation"===a.type&&(0,r.RA)(a.value)?{property:o,filter:{operator:"relation_does_not_contain",value:{type:"exact",value:a.value.id}}}:"relation"===a.type&&(0,r.t2)(a.value)?{property:o,filter:{operator:"relation_does_not_contain",value:{type:"relative",value:{type:"builtin",variable:a.value.value.variable}}}}:void 0:"location"===i.type?"object"==typeof a.value&&"location"===a.type?{property:o,filter:{operator:"location_is_not",value:{type:"exact",value:a.value.id}}}:void 0:"multi_select"===i.type?"string"==typeof a.value?{property:o,filter:{operator:"enum_does_not_contain",value:{type:"exact",value:a.value}}}:void 0:void("select"!==i.type&&"status"!==i.type&&"checkbox"!==i.type&&"date"!==i.type&&"text"!==i.type&&"title"!==i.type&&"url"!==i.type&&"email"!==i.type&&"phone_number"!==i.type&&"number"!==i.type&&"formula"!==i.type&&"created_by"!==i.type&&"last_edited_by"!==i.type&&"created_time"!==i.type&&"last_edited_time"!==i.type&&"last_visited_time"!==i.type&&(0,S.t1)(i)):void 0}({schema:t,group:n});if(!a)return{};const s=V({...e,property:a.property,filter:a.filter,schema:t,block:o,resultCache:i});return("failsFilter"===s.type||"coercedByFilter"===s.type)&&s.update||{}}function B(e){const{schema:t,group:n,block:i,userFilterContext:r}=e,{userTimeZone:a}=r;if(!R(n,t))return{};const s=T({schema:t,group:n,timeZone:a});if(!s||!(0,o.aN)(s))return{};const l=V({...e,property:s.property,filter:s.filter,schema:t,block:i});return("failsFilter"===l.type||"coercedByFilter"===l.type)&&l.update||{}}function E(e){const{dateValue:t,timestamp:n,userTimeZone:o}=e;if("date"===t.type)return{...d.hT(n,o),reminder:t.reminder};if("datetime"===t.type)return{...d.CQ(n,o),reminder:t.reminder};if("daterange"===t.type){const e=d.DF(c.Nh(t),o).valueOf(),i=d.DF(c.v3(t),o).valueOf()-e;return{...d.fZ(n,n+i,o),reminder:t.reminder}}if("datetimerange"===t.type){const e=d.Sy(c.C1(t)).valueOf(),i=d.Sy(c.C1(t)).valueOf()-e;return{...d.iC(n,n+i,o),reminder:t.reminder}}(0,S.t1)(t)}const F={text:function(e){const{filter:t,value:n}=e;if("is_empty"===t.operator)return{type:"text",value:void 0};if("is_not_empty"===t.operator)return;if("string_has_no_alphabet_prefix"===t.operator)return;const o=(t.value.value||"").trim();return"string_is_not"===t.operator||"string_does_not_contain"===t.operator?{type:"text",value:void 0}:"string_is"===t.operator?{type:"text",value:o}:"string_contains"===t.operator||"string_ends_with"===t.operator?{type:"text",value:(n.value||"")+o}:"string_starts_with"===t.operator?{type:"text",value:o+(n.value||"")}:void(0,S.t1)(t.operator)},checkbox:function(e){const{filter:t}=e,n=t.value;return"checkbox_is"===t.operator?{type:"checkbox",value:Boolean(n.value)}:"checkbox_is_not"===t.operator?{type:"checkbox",value:!Boolean(n.value)}:void(0,S.t1)(t.operator)},select:function(e){var t;const{filter:n,propertySchema:i}=e;if("is_empty"===n.operator)return{type:"select",value:void 0};if("is_not_empty"===n.operator)return{type:"select",value:i.options&&i.options.length>0?i.options[0].value:void 0};const r=null===(t=(0,o.mg)(n)[0])||void 0===t?void 0:t.value;return void 0!==r?"enum_is"===n.operator?{type:"select",value:r}:"enum_is_not"===n.operator?{type:"select",value:void 0}:void(0,S.t1)(n.operator):void 0},multi_select:function(e){var t;const{filter:n,propertySchema:i,value:r}=e;if("is_empty"===n.operator)return{type:"multi_select",value:void 0};if("is_not_empty"===n.operator)return{type:"multi_select",value:i.options&&i.options.length>0?[i.options[0].value]:void 0};const a=null===(t=(0,o.qC)(n)[0])||void 0===t?void 0:t.value;if(void 0===a)return;const s=r.value||[];return"enum_contains"===n.operator?{type:"multi_select",value:[...s,a]}:"enum_does_not_contain"===n.operator?{type:"multi_select",value:s.filter((e=>e!==a))}:void(0,S.t1)(n.operator)},status:function(e){const{filter:t,propertySchema:n}=e,i=n.groups??[],r=n.options??[];if("is_empty"===t.operator)return{type:"status",option:void 0,group:void 0};if("is_not_empty"===t.operator)return{type:"status",option:n.options&&n.options.length>0?n.options[0].value:void 0,group:n.groups&&n.groups.length>0?n.groups[0].name:void 0};const a=(0,o.wB)(t);if(0===a.length)return;const s=i.map((e=>{const t=r.filter((t=>{var n;return null===(n=e.optionIds)||void 0===n?void 0:n.includes(t.id)}));return{group:e,groupOptions:t}}));if("status_is"===t.operator){const{type:e,value:t}=a[0];if("is_group"===e){var l;const e=i.findIndex((e=>e.name===t)),n=e>=0?s[e]:void 0;return{type:"status",group:null==n?void 0:n.group.name,option:null==n||null===(l=n.groupOptions[0])||void 0===l?void 0:l.value}}if("is_option"===e){const e=r.find((e=>e.value===t)),n=e&&i.find((t=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)}));return{type:"status",group:null==n?void 0:n.name,option:null==e?void 0:e.value}}(0,S.t1)(e)}if("status_is_not"===t.operator)return{type:"status",group:void 0,option:void 0};(0,S.t1)(t.operator)},relation:function(e){var t;const{filter:n,value:i,propertySchema:r,relativeVariableResult:a}=e;if("is_empty"===n.operator)return{type:"relation",value:void 0};if("is_not_empty"===n.operator)return;const s=(0,o.YO)(n),l=null===(t=s[0])||void 0===t?void 0:t.type;let c;var d;if("exact"===l)c=null===(d=s[0])||void 0===d?void 0:d.value;else if("relative"===l){var u,p;const e=null===(u=r.collection_pointer)||void 0===u?void 0:u.id;if(!e||!a)return;c=a[e][null===(p=s[0])||void 0===p?void 0:p.value.variable]}if(void 0===c)return;const m=i.value||[];return"relation_contains"===n.operator?{type:"relation",value:[...m,{id:c,table:b.iU,spaceId:0!==m.length?m[0].spaceId:void 0}]}:"relation_does_not_contain"===n.operator?{type:"relation",value:m.filter((e=>e.id!==c))}:void(0,S.t1)(n.operator)},person:function(e){const{filter:t,userFilterContext:n,value:i}=e,{userId:r}=n;if("is_empty"===t.operator)return{type:"person",value:void 0};if("is_not_empty"===t.operator)return r?{type:"person",value:[{table:y.KJ,id:r}]}:void 0;const a=(0,o.R8)(t)[0];if(!a)return;const s=(0,o.l$)({operatorValue:a,userId:r});if(void 0===s)return;const l=i.value||[];return"person_contains"===t.operator?{type:"person",value:[...l,s]}:"person_does_not_contain"===t.operator?{type:"person",value:l.filter((e=>!p.Xy(e,s)))}:void(0,S.t1)(t.operator)},number:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"number",value:void 0};if("is_not_empty"===t.operator)return{type:"number",value:0};const n=t.value.value;return void 0===n||p.i2(n)?void 0:"number_equals"===t.operator||"number_greater_than_or_equal_to"===t.operator||"number_less_than_or_equal_to"===t.operator?{type:"number",value:n}:"number_less_than"===t.operator?{type:"number",value:n-1}:"number_greater_than"===t.operator?{type:"number",value:n+1}:"number_does_not_equal"===t.operator?{type:"number",value:void 0}:void(0,S.t1)(t.operator)},date:function(e){const{filter:t,userFilterContext:n,value:i}=e,{userTimeZone:r,userStartOfWeek:a}=n;if("is_empty"===t.operator)return{type:"date",value:void 0};if("is_not_empty"===t.operator)return{type:"date",value:d.Lg(r)};const s=i.value;if((0,o.TQ)(t)){const e=(0,o.sw)({operatorValue:t.value,userTimeZone:r,userStartOfWeek:a});if(void 0===s){const t=d.Lg(r),n=d.NK(t,r).start.valueOf();return void 0!==e.start&&void 0!==e.end&&n>=e.start&&n<=e.end?{type:"date",value:t}:void 0!==e.start?{type:"date",value:d.hT(e.start,r)}:void 0!==e.end?{type:"date",value:d.hT(e.end,r)}:void 0}const n=d.NK(s,r).start.valueOf();return void 0!==e.end&&n>e.end?{type:"date",value:E({dateValue:s,timestamp:e.end,userTimeZone:r})}:void 0!==e.start&&n<e.start?{type:"date",value:E({dateValue:s,timestamp:e.start,userTimeZone:r})}:void 0}const l=t.value,c=(0,o.og)({operatorValue:l,userTimeZone:r});if(void 0!==c){if("date_is"===t.operator||"date_is_on_or_before"===t.operator||"date_is_on_or_after"===t.operator)return s?{type:"date",value:E({dateValue:s,timestamp:c,userTimeZone:r})}:{type:"date",value:d.hT(c,r)};if("date_is_before"===t.operator){const e=d.Xz({date:c,daysToAdd:-1});return s?{type:"date",value:E({dateValue:s,timestamp:e,userTimeZone:r})}:{type:"date",value:d.hT(e,r)}}if("date_is_after"===t.operator){const e=d.Xz({date:c,daysToAdd:1});return s?{type:"date",value:E({dateValue:s,timestamp:e,userTimeZone:r})}:{type:"date",value:d.hT(e,r)}}(0,S.t1)(t.operator)}},file:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"file",value:void 0};"is_not_empty"!==t.operator&&(0,S.t1)(t)},location:()=>{},verification:function(e){const{filter:t}=e;if("verification_is"===t.operator)return{type:"verification",value:void 0};"verification_is_not"!==t.operator&&(0,S.t1)(t.operator)}};function Z(e){const{filter:t,block:n,schema:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:s,getRecordModel:l,intl:c,resultCache:d}=e,{userId:u,userTimeZone:p,userStartOfWeek:f}=a,g=t.filters||[];if(0===g.length)return{type:"passesFilter"};if((0,o.q)({context:{schema:i,userId:u,userTimeZone:p,userStartOfWeek:f,relativeVariableResult:s,intl:c},filter:t})({block:n,getRecordModel:l,propertyMapping:void 0,resultCache:d}))return{type:"passesFilter"};if("or"===t.operator){const e=g.map((e=>(0,o.aN)(e)?V({intl:c,block:n,schema:i,propertyMapping:r,property:e.property,filter:e.filter,userFilterContext:a,getRecordModel:l,relativeVariableResult:s,resultCache:d}):(0,o.Mm)(e)?{type:"failsFilter"}:(0,o.vA)(e)?Z({filter:e,intl:c,block:n,schema:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:s,getRecordModel:l,resultCache:d}):void(0,S.t1)(e)));if(e.some((e=>"passesFilter"===e.type)))return{type:"passesFilter"};const t=e.find((e=>"coercedByFilter"===e.type));return t||(e.find((e=>"failsFilter"===e.type))||{type:"failsFilter"})}const v=[...g];v.reverse();let y="passesFilter";const _={};let w=n;const k=m.om.tryUntilFound(m.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===w.id)return w}),h.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===w.id)return w.__IM_SORRY__getValue()}))),l);for(const m of v){if((0,o.Mm)(m))continue;const e=(0,o.aN)(m)?V({intl:c,block:w,schema:i,propertyMapping:r,property:m.property,filter:m.filter,userFilterContext:a,getRecordModel:k,relativeVariableResult:s,resultCache:d}):Z({filter:m,intl:c,block:w,schema:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:s,getRecordModel:k,resultCache:d});"coercedByFilter"===e.type&&"passesFilter"===y&&(y="coercedByFilter"),"failsFilter"===e.type&&(y="failsFilter"),("coercedByFilter"===e.type||"failsFilter"===e.type&&e.update)&&(Object.assign(_,e.update),w=I(n,_))}return"passesFilter"===y?{type:y}:{type:y,update:_}}function V(e){const{filter:t,block:n,property:r,schema:a,propertyMapping:l,userFilterContext:c,getRecordModel:d,relativeVariableResult:u,intl:p,resultCache:m}=e,{userId:f,userTimeZone:g,userStartOfWeek:h}=c;if((0,o.Y1)({context:{schema:a,userId:f,userTimeZone:g,userStartOfWeek:h,relativeVariableResult:u,intl:p},filter:t,property:r,depth:0})({block:n,getRecordModel:d,propertyMapping:l,resultCache:m}))return{type:"passesFilter"};if((0,o.a_)(t))return{type:"failsFilter"};const v=a[r];if(!v)return{type:"failsFilter"};if(!(0,i.BJ)(v))return{type:"failsFilter"};const b=(0,i.vc)(v.type),y=(0,i.ML)({filterValueType:b,block:n,propertyValue:s.wS(n,r,d),propertySchema:v,getRecordModel:d,collectionRequestContext:{userId:f,userTimeZone:g,intl:p,depth:0,visitedProperties:new Set,resultCache:new Map}}),_=(0,F[b])({filter:t,value:y,propertySchema:v,userFilterContext:c,relativeVariableResult:u});if(void 0===_)return{type:"failsFilter"};const S=(0,i.qg)({propertyType:v.type,filterValue:_});return{type:"coercedByFilter",update:{[(null==l?void 0:l[r])??r]:S}}}function j(e){const{blockProperties:t,oldSchema:n,newSchema:o,typesMatch:i,oldPropertyMapping:r,newPropertyMapping:a}=e,s=Object.keys(n),c=Object.keys(o),d={propertyUpdate:function(e){const{blockProperties:t,oldSchema:n,newSchema:o}=e,i={},r=null==t?void 0:t.title,a=_.lcG(r),[s]=_.nai(r),{person:[l],date:[c]}=w(o),{person:[d],date:[p]}=w(n);if(l&&(null==t||!t[l])&&!d&&a.length>0){const e=Array.from(new Set(a));i[l]=(0,u.Z)(e.map((e=>_.YCD(_.tEo(e)))),(()=>k))}return!c||null!=t&&t[c]||p||!s||(i[c]=[_.YCD(_.pZr(s))]),i}({blockProperties:t,oldSchema:n,newSchema:o}),newSchema:o},p=["relation","auto_increment_id","verification"];for(const u of s){const e=n[u],s=null==t?void 0:t[u];if(e&&!p.includes(e.type)){if(i){const e=l.aQ.deriveTypeUri(u,r),n=e?null==a?void 0:a[e]:void 0;if(n&&n!==u){d.propertyUpdate[n]=(null==t?void 0:t[u])||null,d.propertyUpdate[u]=null;continue}}if(s){const i=c.find((e=>u===e))||c.find((t=>{const n=o[t];return Boolean(e&&n&&e.name.trim().toLowerCase()===n.name.trim().toLowerCase()&&e.type===n.type)}));if(i&&d.propertyUpdate)i!==u&&(d.propertyUpdate[i]=t[u]||null,d.propertyUpdate[u]=null);else{const e=(0,g.ZP)(),o=n[u];d.newSchema={...d.newSchema,[e]:o},d.propertyUpdate&&(d.propertyUpdate[e]=t[u]||null,d.propertyUpdate[u]=null)}}}}return d}function U(e){const{block:t,schema:n,property:o,oldValue:i,newValue:a}=e;if(void 0===i.value)return{};if(void 0===a.value)return{};const l=t.getProperties();if(!l)return{};const c=l[o];if(!c)return{};const d=n[o];if(!d)return{};if(!(0,r.LG)(d))return{};if("status"===d.type||"select"===d.type||"multi_select"===d.type||"checkbox"===d.type)return function(e){const{propertySchema:t,property:n,oldValue:o,newValue:i,propertyValue:a}=e;if(void 0===o.value)return{};if(void 0===i.value)return{};if(!(0,r.LG)(t))return{};if("select"===t.type){if("select"!==o.type||"select"!==i.type)return{};if(void 0===i.value)return{};const e=s.Ak(a);return 0===e.length&&void 0===o.value||e.some((e=>(e||"").trim().toLowerCase()===(o.value||"").trim().toLowerCase()))?{[n]:s.O2(i.value)}:{}}if("multi_select"===t.type){if("multi_select"!==o.type||"multi_select"!==i.type)return{};if(void 0===i.value)return{};const e=s.Ak(a);if(!e.some((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase())))return{};const t=i.value,r=e.map((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase()?t:e));return{[n]:s.zq(r)}}if("status"===t.type){const e=t.groups??[],r=t.options??[];if("checkbox"===o.type&&"status"===i.type){if(s.Ml(a)!==o.value)return{};let t;if("by_group"===i.value.type){const n=i.value.group,o=e.find((e=>e.name===n)),a=r.find((e=>{var t;return e.id===(null==o||null===(t=o.optionIds)||void 0===t?void 0:t[0])}));t=null==a?void 0:a.value}else t=i.value.option;if(t)return{[n]:s.Is(t)}}var l;return"status"===o.type&&"status"===i.type?"by_option"!==o.value.type||"by_option"!==i.value.type||(null===(l=s.Ak(a))||void 0===l?void 0:l[0])!==o.value.option?{}:{[n]:s.Is(i.value.option)}:{}}if("checkbox"===t.type)return"status"!==o.type||"checkbox"!==i.type||"by_option"!==o.value.type?{}:s.Ak(a).includes(o.value.option)?{[n]:s._I(i.value)}:{};(0,S.t1)(t)}({propertySchema:d,property:o,propertyValue:c,oldValue:i,newValue:a});if("person"===d.type){if("person"!==i.type||"person"!==a.type)return{};if(void 0===i.value)return{};if(void 0===a.value)return{};const e=a.value,n=i.value,r=m.kk.fromBlock(t),l=s.DW({textValue:c,propertySchema:d,blockCreatorPointer:r.getCreatedByPointer()});if(!l.some((e=>p.Xy(e,n))))return{};const u=l.map((t=>p.Xy(t,n)?e:t));return{[o]:s.C1(u)}}if("relation"===d.type){if("relation"!==i.type||"relation"!==a.type||void 0===i.value||void 0===a.value)return{};if((0,r.t2)(i.value)||(0,r.t2)(a.value))return{};const e=a.value,t=i.value,n=s.rq(c);if(!n.some((e=>(0,v.qo)(e,t))))return{};const l=n.map((n=>(0,v.qo)(n,t)?e:n));return{[o]:s.ow(l)}}if((0,r.HB)(d.type)){if(i.type!==d.type||a.type!==d.type||void 0===i.value||void 0===a.value||"exact"!==i.value.type||"exact"!==a.value.type)return{};return _.QaF(c)!==i.value.value?{}:{[o]:(0,_.TPx)(a.value.value)}}if("date"===d.type||"number"===d.type||"formula"===d.type||"created_by"===d.type||"last_edited_by"===d.type||"created_time"===d.type||"last_edited_time"===d.type||"location"===d.type||"last_visited_time"===d.type)return{};(0,S.t1)(d.type)}function L(e){const{block:t,schema:n,property:i,value:a,timeZone:s,intl:l,getRecordModel:c,resultCache:u}=e,p=n[i];if(!p||!(0,r.LG)(p)||t.is_template)return!1;const m=T({schema:n,group:{property:i,value:a},timeZone:s});if(!m)return!1;return(0,o.q)({filter:{operator:"and",filters:[m]},context:{schema:n,intl:l,userId:void 0,userTimeZone:"UTC",userStartOfWeek:(0,d.aN)(),relativeVariableResult:void 0}})({block:t,getRecordModel:c,propertyMapping:void 0,resultCache:u})}const O={Todo:"To-do","To-do":"To-do","To do":"To-do","Not started":"To-do",Backlog:"To-do",Incomplete:"To-do",Waiting:"To-do","On hold":"To-do",Later:"To-do",Blocked:"To-do","In progress":"In progress",Building:"In progress",Designing:"In progress",Research:"In progress",Scoping:"In progress",Planning:"In progress","Needs review":"In progress",Reviewed:"In progress",Review:"In progress",Pending:"In progress",Recurring:"In progress","Review needed":"In progress","Edits needed":"In progress",Editing:"In progress",Complete:"Complete",Completed:"Complete",Done:"Complete",Finished:"Complete",Archive:"Complete",Archived:"Complete",Deleted:"Complete",Published:"Complete",Reverted:"Complete"};function N(e,t,n){var o;const i=(0,a.I4)(e,n),r=i.groups??[],s=i.options??[],l=p.Cw(O,((e,t)=>t.toLowerCase())),c=new Set,d=new Set;for(const a of t){const e=s.findIndex((e=>e.value.toLowerCase()===a.value.toLowerCase()));if(e>-1){const t=s[e];if(!c.has(t.id)){d.add(a.id),c.add(t.id),s[e]={...a,id:t.id};continue}}const t=l[a.value.toLowerCase()],n=r.find((e=>e.name===t));var u;if(n)null===(u=n.optionIds)||void 0===u||u.push(a.id),d.add(a.id)}for(const[a,p]of r.entries()){var m;const e=null===(m=p.optionIds)||void 0===m?void 0:m.some((e=>d.has(e)));p.optionIds=(p.optionIds??[]).filter((t=>!(!d.has(t)&&!c.has(t))||!e))}null==r||null===(o=r[0].optionIds)||void 0===o||o.push(...t.filter((e=>!d.has(e.id))).map((e=>e.id)));const f=[...s,...t],g=[];for(const a of r)for(const e of a.optionIds??[]){const t=f.find((t=>t.id===e));t&&g.push(t)}return{type:"status",name:e,groups:r,options:g}}},34296:(e,t,n)=>{n.d(t,{S:()=>o});let o=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({})},63144:(e,t,n)=>{n.d(t,{P:()=>i});var o=n(72126);function i(e,t){return t.getAlive()!==e.getAlive()||!o.Xy(t.getText(),e.getText())||!o.Xy(t.getContent(),e.getContent())}},1274:(e,t,n)=>{n.d(t,{IC:()=>c,bM:()=>u,fz:()=>d,o0:()=>p});n(57658);var o=n(21202),i=n(77420),r=n(6287),a=n(13493),s=n(15047),l=n(97880);function c(e){const{targetTriggerType:t,targetParentPointer:n,targetSpaceId:o}=e;return"notification_event"===t||"event"===t?[{pointer:n,minimumRequiredRole:"editor"},{pointer:{id:o,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===t||"button"===t?[{pointer:n,minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(t)}function d(e){const{automationValue:t,actionValues:n}=e,o=n.flatMap((e=>p(e))).filter(l.$K);return"notification_event"===t.trigger.type||"event"===t.trigger.type?(o.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"editor"},{pointer:{id:t.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}),(0,l.$K)(t.trigger.event.source)&&(t.trigger.event.source.type===a.n||t.trigger.event.source.type===r.v?o.push({pointer:t.trigger.event.source.pointer,minimumRequiredRole:"reader"}):"filter"===t.trigger.event.source.type||(0,l.t1)(t.trigger.event.source))):"recurrence"===t.trigger.type||"button"===t.trigger.type?o.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"read_and_write"}):(0,l.t1)(t.trigger),o}function u(e){return"notification_event"===e.trigger.type||"event"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"editor"},{pointer:{id:e.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===e.trigger.type||"button"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(e.trigger)}function p(e){if("create_page"===e.type){var t,n;const i=[];var r,a;if(null!==(t=e.config)&&void 0!==t&&t.collection)i.push({pointer:null===(r=e.config)||void 0===r?void 0:r.collection,minimumRequiredRole:"content_only_editor"});if(null!==(n=e.config)&&void 0!==n&&n.template_page_id)i.push({pointer:{id:null===(a=e.config)||void 0===a?void 0:a.template_page_id,table:o.iU,spaceId:e.space_id},minimumRequiredRole:"reader"});return i}var s,c;if("query_collection"===e.type){if(null!==(s=e.config)&&void 0!==s&&s.collection)return[{pointer:null===(c=e.config)||void 0===c?void 0:c.collection,minimumRequiredRole:"content_only_editor"}]}else if("update_pages"===e.type){var d;const t=null===(d=e.config)||void 0===d?void 0:d.target;if(!t)return[];if("collection"===t.type)return[{pointer:t.collection,minimumRequiredRole:"content_only_editor"}];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"content_only_editor"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("open_page"===e.type){var u;const t=null===(u=e.config)||void 0===u?void 0:u.target;if(!t)return[];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"reader"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("slack_notification"===e.type){var p;if(null!==(p=e.config)&&void 0!==p&&p.external_bot_id)return[{pointer:{id:e.config.external_bot_id,table:i.cZ},minimumRequiredRole:"editor"}]}else{if("duplicate_blocks"===e.type)return[];if("modal_confirmation"===e.type)return[];if("complete_sprint"===e.type){var m,f;const t=[];return null!==(m=e.config)&&void 0!==m&&m.sprint_collection&&t.push({pointer:e.config.sprint_collection,minimumRequiredRole:"editor"}),null!==(f=e.config)&&void 0!==f&&f.task_collection&&t.push({pointer:e.config.task_collection,minimumRequiredRole:"editor"}),t}if("assistant"===e.type)return[];(0,l.t1)(e)}}},86658:(e,t,n)=>{n.d(t,{Fd:()=>c,G_:()=>l,UE:()=>d,cW:()=>u,fV:()=>r,ze:()=>a});n(67294);var o=n(9291),i=n(85893);const r="v9",a=(0,o.defineMessages)({cookieSettingsLabel:{id:"cookieConsent.settings.label",defaultMessage:"Cookie settings"},customizeCookiesHeader:{id:"cookieConsent.customizeCookies.header",defaultMessage:"Customize cookies"},trackingTypeNecessaryTitle:{id:"cookieConsent.trackingTypeNecessary.title",defaultMessage:"Strictly necessary"},trackingTypeNecessaryCaption:{id:"cookieConsent.trackingTypeNecessary.caption",defaultMessage:"Essential for the site to function. Always On."},trackingTypePreferenceTitle:{id:"cookieConsent.trackingTypePreference.title",defaultMessage:"Functional"},trackingTypePreferenceCaption:{id:"cookieConsent.trackingTypePreference.caption",defaultMessage:"Used to remember preference selections and provide enhanced features."},trackingTypePerformanceTitle:{id:"cookieConsent.trackingTypePerformance.title",defaultMessage:"Analytics"},trackingTypePerformanceCaption:{id:"cookieConsent.trackingTypePerformance.caption",defaultMessage:"Used to measure usage and improve your experience."},trackingTypeTargetingTitle:{id:"cookieConsent.trackingTypeTargeting.title",defaultMessage:"Marketing"},trackingTypeTargetingCaption:{id:"cookieConsent.trackingTypeTargeting.caption",defaultMessage:"Used for targeted advertising."},trackingTypeTargetingSubtitleiOS:{id:"cookieConsent.trackingTypeTargeting.subtitleiOS",defaultMessage:"Not collected nor used within the iOS app"},cookieDismissButtonLabel:{id:"cookieConsent.dismissButton.label",defaultMessage:"Done"},acceptAllButtonLabel:{id:"cookieConsent.acceptAllButton.label",defaultMessage:"Accept all"},rejectAllButtonLabel:{id:"cookieConsent.rejectAllButton.label",defaultMessage:"Reject all"},moreOptionsButtonLabel:{id:"cookieConsent.moreOptionsButton.label",defaultMessage:"More options"},reloadAfterSaveMessage:{id:"cookieConsent.reloadAfterSave.message",defaultMessage:"Notion will now reload to apply your cookie preferences. Click okay to continue."}}),s=(0,o.defineMessages)({banner:{id:"cookieConsent.bannerDisclaimer.message",defaultMessage:"Notion uses cookies to offer you a better experience. See<cookielink>Cookie Notice</cookielink>for details."},settings:{id:"cookieConsent.settingsDisclaimer.message",defaultMessage:"Customize cookies. See<cookielink>Cookie Notice</cookielink>for details."},snackbar:{id:"cookieConsent.snackbarDisclaimer.message",defaultMessage:"Notion uses cookies. See<cookielink>Cookie Notice</cookielink>for details."}});function l(e,t){switch(e){case"necessary":return{title:a.trackingTypeNecessaryTitle,caption:a.trackingTypeNecessaryCaption};case"preference":return{title:a.trackingTypePreferenceTitle,caption:a.trackingTypePreferenceCaption};case"performance":return{title:a.trackingTypePerformanceTitle,caption:a.trackingTypePerformanceCaption};case"targeting":const e=t?a.trackingTypeTargetingSubtitleiOS:void 0;return{title:a.trackingTypeTargetingTitle,subtitle:e,caption:a.trackingTypeTargetingCaption}}}function c(e,t){return(0,i.jsx)(o.FormattedMessage,{...s[t],values:{cookielink:t=>(0,i.jsxs)(i.Fragment,{children:["Â ",e("https://www.notion.so/Cookie-Notice-bc186044eed5488a8387a9e94b14e58c",t),"Â "]})}})}const d={necessary:!0,performance:!0,preference:!0,targeting:!0},u={necessary:!0,performance:!1,preference:!1,targeting:!1}},57081:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(72126),i=n(70203),r=n(97880),a=n(82798),s=n(59579);class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.ops=e,function(e){for(let t=1;t<e.length;t++)(0,a.T)((0,s.$c)(e[t-1].id,e[t].id)<0)}(e)}add(e){const t=this.findInsertionIndex(e.id);this.ops.splice(t,0,e)}findInsertionIndex(e){const t=this.ops.findIndex((t=>(0,s.$c)(t.id,e)>0));return t>=0?t:this.ops.length}getOps(){return this.ops}getActiveAnnotations(){const e=new Map;for(const t of this.ops){const n=t.type;"addAnnotation"===n?e.set(i.XSJ(t.annotation),t.annotation):"removeAnnotation"===n?e.delete(i.XSJ(t.annotationKey)):(0,r.t1)(n)}return e}getResolvedAnnotations(){return[...this.getActiveAnnotations().values()]}containsOpId(e){return this.ops.some((t=>o.Xy(t.id,e)))}clone(){return new l([...this.ops])}equals(e){return o.Xy(this.ops,e.ops)}static equals(e,t){return e===t||(void 0===e||void 0===t?e===t:e.equals(t))}toString(){const e=this.ops.map((e=>{switch(e.type){case"addAnnotation":return`+${c(e.annotation)}`;case"removeAnnotation":return`-${c(e.annotationKey)}`}}));return`[AnnotationOpSet ${e.length?e.join(", "):"empty"}]`}}function c(e){const t="string"==typeof e?e:i.c14(e);return"string"==typeof t?t:`(${t.join(",")})`}},43993:(e,t,n)=>{n.d(t,{JE:()=>p,Jy:()=>c,KH:()=>u,vM:()=>d});var o=n(72126),i=n(70203),r=n(97880),a=n(82798),s=n(57081);class l{constructor(e){this.prev=void 0,this.next=void 0,this.annotationOpSetBefore=void 0,this.annotationOpSetAfter=void 0,this.id=e}startsWithId(e){return this.containsId(e)}endsWithId(e){return this.containsId(e)}containsId(e){return o.Xy(this.id,e)}getAnnotationOpSetForAnchor(e){return"before"===e?this.annotationOpSetBefore:"after"===e?this.annotationOpSetAfter:void(0,r.t1)(e)}maybeCreateAnnotationOpSetForAnchor(e,t){var n;if("before"===e)this.annotationOpSetBefore??=(null==t||null===(n=t.opSet)||void 0===n?void 0:n.clone())??new s.Z;else if("after"===e){var o;this.annotationOpSetAfter??=(null==t||null===(o=t.opSet)||void 0===o?void 0:o.clone())??new s.Z}else(0,r.t1)(e)}copyAnnotationOpSetTo(e){this.annotationOpSetBefore&&(e.annotationOpSetBefore=this.annotationOpSetBefore.clone()),this.annotationOpSetAfter&&(e.annotationOpSetAfter=this.annotationOpSetAfter.clone())}equals(e){return typeof this==typeof e&&s.Z.equals(this.annotationOpSetBefore,e.annotationOpSetBefore)&&s.Z.equals(this.annotationOpSetAfter,e.annotationOpSetAfter)}toString(){return`[${this.className}]`}}class c extends l{constructor(e,t,n,o){super(e),this.className="TextItem",this.deleted=!1,this.id=e,this.originId=t,this.content=n,this.length=o,this.verifyValueAndLength()}verifyValueAndLength(){(0,a.T)(!this.content||this.content.length===this.length,"TextItem content length must match item length"),(0,a.T)(this.length>0,"TextItem must have nonzero length"),(0,a.T)(!this.content||!(0,i.pIV)(this.content),"TextItem must not contain disallowed characters")}getStartId(){return this.id}getEndId(){const e=this.id;return[e[0],e[1]+this.length-1]}startsWithId(e){return o.Xy(this.getStartId(),e)}endsWithId(e){return o.Xy(this.getEndId(),e)}containsId(e){return"start"!==e&&"end"!==e&&this.id[0]===e[0]&&this.id[1]<=e[1]&&e[1]<=this.id[1]+this.length-1}getDefinedContent(){return(0,a.TO)(this.content)}isDeleted(){return this.deleted}setDeleted(){this.deleted=!0,this.content=void 0}splitBeforeId(e){return this.split(e,"before")}splitAfterId(e){return this.split(e,"after")}split(e,t){var n;(0,a.T)(this.length>1),(0,a.T)(this.containsId(e));const o=e[1]-this.id[1]+("after"===t?1:0);(0,a.T)(0<o&&o<this.length);const i=[this.id[0],this.id[1]+o],r=[this.id[0],this.id[1]+o-1],s=this.deleted?c.createDeleted(i,r,this.length-o):c.create(i,r,this.getDefinedContent().slice(o));this.annotationOpSetAfter&&(s.annotationOpSetAfter=this.annotationOpSetAfter.clone());const l=this.next;return this.next=s,s.prev=this,l&&(s.next=l,l.prev=s),this.content=null===(n=this.content)||void 0===n?void 0:n.slice(0,o),this.length=o,this.verifyValueAndLength(),this.annotationOpSetAfter=void 0,this.next=s,s}maybeMergeWithNext(){const e=this.next;if(!(e instanceof c))return!1;const t=this.getEndId(),n=e.getStartId();return!(!o.Xy(t,e.originId)||t[0]!==n[0]||t[1]!==n[1]-1||this.deleted!==e.deleted||void 0!==this.annotationOpSetAfter||void 0!==e.annotationOpSetBefore)&&(this.content&&e.content&&(this.content+=e.content),this.length+=e.length,this.verifyValueAndLength(),e.annotationOpSetAfter&&(this.annotationOpSetAfter=e.annotationOpSetAfter.clone()),this.next=e.next,e.next&&(e.next.prev=this),e.prev=void 0,e.next=void 0,!0)}getLength(){return this.length}clone(){const e=this.deleted?c.createDeleted(this.id,this.originId,this.length):c.create(this.id,this.originId,this.getDefinedContent());return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof c&&o.Xy(this.id,e.id)&&o.Xy(this.originId,e.originId)&&this.deleted===e.deleted&&this.content===e.content&&this.length===e.length}static create(e,t,n){return new c(e,t,n,n.length)}static createDeleted(e,t,n){const o=new c(e,t,void 0,n);return o.setDeleted(),o}toString(){return this.deleted?`[${this.className} (deleted)]`:`[${this.className} ${this.content}]`}}class d extends l{constructor(){super("start"),this.className="StartItem"}clone(){const e=new d;return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof d}}class u extends l{constructor(){super("end"),this.className="EndItem",this.originId="start"}clone(){const e=new u;return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof u}}class p extends l{constructor(e,t){super(e),this.className="SplitItem",this.id=e,this.originId=t}clone(){const e=new p(this.id,this.originId);return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof p&&o.Xy(this.id,e.id)&&o.Xy(this.originId,e.originId)}}},19056:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(82798);class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.value=e}get(){return this.value}set(e){this.value=e}}class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.valueHolder=void 0,this.valueHolder="number"==typeof e?new i(e):e,(0,o.T)(this.valueHolder.get()>=0)}reserveTicks(e){(0,o.T)(e>0);const t=this.valueHolder.get(),n=t+1;return this.valueHolder.set(t+e),n}maybeUpdateClock(e){return e>this.valueHolder.get()&&(this.valueHolder.set(e),!0)}getValue(){return this.valueHolder.get()}}},69920:(e,t,n)=>{n.d(t,{ZP:()=>y,rd:()=>b,GU:()=>g});n(52262),n(24506),n(57658),n(21703);var o=n(67266),i=n.n(o),r=n(72126),a=n(4615),s=n(70203),l=n(97880),c=n(82798),d=n(59579),u=n(43993),p=n(52136),m=n(19056);function f(e){switch(e.type){case"insertText":return e.id[1]+e.content.length-1;case"splitText":case"addAnnotation":case"removeAnnotation":return e.id[1]}}const g=(0,l.AO)((e=>e instanceof u.vM||e instanceof u.JE?{true:e}:{false:e})),h=(0,l.AO)((e=>e instanceof u.KH||e instanceof u.JE?{true:e}:{false:e})),v=(0,l.AO)((e=>e instanceof u.Jy?{true:e}:{false:e})),b=(0,l.AO)((e=>"end"===e?{false:e}:{true:e}));class y{constructor(e,t,n){this.textInstanceId=void 0,this.opClock=void 0,this.startItem=void 0,this.endItem=void 0,this.visibleCount=void 0,this.textInstanceId=e,this.opClock=t,this.startItem=n,this.endItem=(0,c.Fb)(p.s(n),h),this.visibleCount=p.TS(n),(0,c.T)(this.startItem!==this.endItem)}getStartItem(){return this.startItem}getEndItem(){return this.endItem}getVisibleCount(){return this.visibleCount}applyOperation(e){switch(e.type){case"insertText":this.applyInsertTextOperation(e);break;case"deleteText":this.applyDeleteTextOperation(e);break;case"splitText":this.applySplitTextOperation(e);break;case"addAnnotation":case"removeAnnotation":this.applyAnnotationOperation(e);break;default:(0,l.t1)(e)}}applyInsertTextOperation(e){const t=u.Jy.create(e.id,e.originId,e.content);this.integrateItem(t),this.opClock.maybeUpdateClock(f(e)),this.validateContent()}applyDeleteTextOperation(e){for(const t of e.idRanges)for(const e of this.getTextItemsInIdRange(t))e.isDeleted()||(e.setDeleted(),this.visibleCount-=e.getLength(),e.prev instanceof u.Jy&&e.prev.maybeMergeWithNext(),e.maybeMergeWithNext());this.validateContent()}applySplitTextOperation(e){const t=new u.JE(e.id,e.originId);this.integrateItem(t),this.opClock.maybeUpdateClock(f(e))}integrateItem(e){(0,c.T)(!this.containsOpId(e.id),`Already contains ID: ${e.id}`);const t=(0,c.TO)(this.getItemEndingWithId(e.originId));let n=t;for(;n.next&&!((0,d.Dx)(e.id,n.next.id)>0);)n=n.next;const o=n.next;if(n.next=e,e.prev=n,o&&(e.next=o,o.prev=e),e instanceof u.Jy&&(this.visibleCount+=e.getLength()),e instanceof u.JE){this.validateNotEndingWithHighSurrogate(t,"Cannot split content between a surrogate pair");const n=this.getPreceedingAnnotationOpSet({id:e.id,anchor:"before"});n&&e.maybeCreateAnnotationOpSetForAnchor("before",{opSet:n})}n instanceof u.Jy&&n.maybeMergeWithNext()}validateContent(){(0,c.T)(!s.PM3(this.getText()),"Content must not contain unpaired surrogates")}validateNotEndingWithHighSurrogate(e,t){if(!(e instanceof u.Jy)||e.isDeleted())return;const n=e.getDefinedContent().at(-1);n&&(0,c.T)("high"!==s.kG3(n),t)}applyAnnotationOperation(e){(0,c.T)(!this.containsOpId(e.id),`Already contains ID: ${e.id}`);const t=(0,c.TO)("before"===e.start.anchor?this.getItemStartingWithId(e.start.id):this.getItemEndingWithId(e.start.id)),n=(0,c.TO)("before"===e.end.anchor?this.getItemStartingWithId(e.end.id,{includeEndItem:!0}):this.getItemEndingWithId(e.end.id,{includeEndItem:!0}));let o=this.getPreceedingAnnotationOpSet(e.start);t.maybeCreateAnnotationOpSetForAnchor(e.start.anchor,{opSet:o});const i=this.iterateItemAnnotationOpSets({direction:"forward",from:e.start,to:e.end,includeSplitCharacters:!0});for(const{item:r,anchor:a}of i){r instanceof u.JE&&r.maybeCreateAnnotationOpSetForAnchor(a,{opSet:o});const t=(0,c.TO)(r.getAnnotationOpSetForAnchor(a));o=t.clone(),t.add(e)}n.maybeCreateAnnotationOpSetForAnchor(e.end.anchor,{opSet:o}),this.opClock.maybeUpdateClock(f(e))}getPreceedingAnnotationOpSet(e){const t=this.iterateItemAnnotationOpSets({direction:"backward",from:e});for(const{annotationOpSet:n}of t)return(0,c.TO)(n)}getActiveAnnotationsAfterId(e){const t=(0,c.TO)(this.getItemContainingId(e)),n=t.endsWithId(e)?{anchor:"after",id:e}:{anchor:"before",id:t instanceof u.Jy?t.getStartId():t.id},o=this.getPreceedingAnnotationOpSet(n);return o?o.getActiveAnnotations():new Map}*iterateItems(e){yield*p.Hi(this.startItem,e)}*iterateItemAnnotationOpSets(e){const{direction:t,from:n,includeSplitCharacters:o,to:i}=e;let r=(0,c.TO)(this.getItemContainingId(n.id));(0,c.T)("before"===n.anchor?r.startsWithId(n.id):r.endsWithId(n.id));let a=n.anchor;for(;r;){if(i&&r.containsId(i.id)&&a===i.anchor)return void(0,c.T)("before"===i.anchor?r.startsWithId(i.id):r.endsWithId(i.id));const e=r.getAnnotationOpSetForAnchor(a);switch(e?yield{item:r,anchor:a,annotationOpSet:e}:o&&r instanceof u.JE&&("forward"===t&&"before"===a||"backward"===t&&"after"===a)&&(yield{item:r,anchor:a,annotationOpSet:void 0}),t){case"forward":r="before"===a?r:r.next,a="before"===a?"after":"before";break;case"backward":r="after"===a?r:r.prev,a="after"===a?"before":"after";break;default:(0,l.t1)(t)}}}getItemStartingWithId(e,t){return this.getItem(e,{...t,shouldStartWithId:!0})}getItemEndingWithId(e,t){return this.getItem(e,{...t,shouldEndWithId:!0})}getItemWithOnlyId(e){return this.getItem(e,{shouldStartWithId:!0,shouldEndWithId:!0})}getItemContainingId(e,t){return this.getItem(e,t)}containsItemWithId(e,t){return Boolean(this.getItemContainingId(e,t))}getItem(e,t){const n=this.iterateItems({includeDeleted:!0,includeEndItem:null==t?void 0:t.includeEndItem});for(const o of n){if(o instanceof u.Jy&&o.containsId(e)){if("start"===e||"end"===e)continue;let n=o;return null!=t&&t.shouldStartWithId&&!n.startsWithId(e)&&(n=n.splitBeforeId(e)),null!=t&&t.shouldEndWithId&&!n.endsWithId(e)&&n.splitAfterId(e),n}if(o.containsId(e))return o}}getTextItemsInIdRange(e){const[t,n]=e,[o,i]=t,a=[o,i+n-1],s=[],l=this.iterateItems({includeDeleted:!0});for(const r of l)!(r instanceof u.Jy)||r.getStartId()[0]!==o||(0,d.e0)(a,r.getStartId())<0||(0,d.e0)(r.getEndId(),t)<0||s.push(r);(0,c.T)(s.length>0),r.MR(s,(e=>e.getStartId()[1]));for(let r=1;r<s.length;r++)(0,c.T)(s[r].getStartId()[1]=s[r-1].getEndId()[1]+1);const p=s[0];if((0,c.T)(p.containsId(t)),(0,d.e0)(p.getStartId(),t)<0){const e=p.splitBeforeId(t);s[0]=e}const m=(0,c.TO)(s.at(-1));return(0,c.T)(m.containsId(a)),(0,d.e0)(a,m.getEndId())<0&&m.splitAfterId(a),s}findClosestVisibleIndexForOpId(e){let t=0;for(const n of this.iterateItems({includeDeleted:!0}))if(n instanceof u.Jy){if(n.containsId(e)){if(n.isDeleted())return-t-1;return t+(e[1]-n.id[1])}n.isDeleted()||(t+=n.getLength())}}getItemIdsInRange(e,t){(0,c.T)(e<=t),(0,c.T)(0<=e&&t<this.visibleCount);const n=[];let o=0,i=-1;for(const r of this.iterateItems({includeDeleted:!1})){if(!(r instanceof u.Jy))continue;const a=i+1,s=a+r.getLength()-1;if(s<e){i=s;continue}if(t<a)break;const l=Math.max(0,e-a),c=Math.min(s-a,t-a),[d,p]=r.id,m=[d,p+l],f=c-l+1;n.push([m,f]),o+=f,i=s}return(0,c.T)(o===t-e+1),n}getItemIdAtIndex(e){return this.getItemIdsInRange(e,e)[0][0]}getItemIdBeforeIndex(e){const t=this.getItemIdAtIndex(e),n=(0,c.Fb)((0,c.TO)(this.getItemContainingId(t)),v);if(!n.startsWithId(t))return[t[0],t[1]-1];const o=(0,c.TO)(n.prev);return o instanceof u.Jy?o.getEndId():o.id}getItemIdAfterIndex(e){const t=this.getItemIdAtIndex(e);return this.getItemIdAfterItem(t)}getItemIdAfterItem(e){if("start"===e){(0,c.R9)(this.getStartItem(),u.vM);return(0,c.TO)(this.getStartItem().next).id}const t=(0,c.Fb)((0,c.TO)(this.getItemContainingId(e)),v);if(!t.endsWithId(e))return[e[0],e[1]+1];const n=(0,c.TO)(t.next);return n instanceof u.Jy?n.getStartId():n.id}getOriginItemIdForInsertionIndex(e){let t;if((0,c.T)(0<=e&&e<=this.visibleCount),e===this.visibleCount)t=this.getEndItem();else{const n=this.getItemIdAtIndex(e),o=(0,c.Fb)((0,c.TO)(this.getItemContainingId(n)),v);if(!o.startsWithId(n))return[n[0],n[1]-1];t=o}for(;t.prev;){const e=t.prev;if(e instanceof u.Jy&&!e.isDeleted())return e.getEndId();if(e instanceof u.KH)throw new Error("Unexpected");if(e.getAnnotationOpSetForAnchor("after"))return e instanceof u.Jy?e.getEndId():(0,c.Fb)(e.id,b);t=t.prev}return(0,c.Fb)((0,c.Fb)(t,g).id,b)}isLastOriginItemId(e){return r.Xy(this.getOriginItemIdForInsertionIndex(this.visibleCount),e)}containsOpId(e){for(const o of this.iterateItems({includeDeleted:!0,includeEndItem:!0})){var t,n;if(o.containsId(e))return!0;if(null!==(t=o.getAnnotationOpSetForAnchor("before"))&&void 0!==t&&t.containsOpId(e))return!0;if(null!==(n=o.getAnnotationOpSetForAnchor("after"))&&void 0!==n&&n.containsOpId(e))return!0}return!1}getTextValue(){const e=[];let t;for(const i of this.iterateItems({includeDeleted:!0})){var n,o;t=(null===(n=i.getAnnotationOpSetForAnchor("before"))||void 0===n?void 0:n.getResolvedAnnotations())??t,i instanceof u.Jy&&i.getLength()&&!i.isDeleted()&&(t?(t.length?e.push([i.getDefinedContent(),t]):e.push([i.getDefinedContent()]),t=void 0):e.length?(0,c.TO)(e.at(-1))[0]+=i.getDefinedContent():e.push([i.getDefinedContent()])),t=(null===(o=i.getAnnotationOpSetForAnchor("after"))||void 0===o?void 0:o.getResolvedAnnotations())??t}return e}getText(){const e=[];for(const t of this.iterateItems())t instanceof u.Jy&&e.push(t.getDefinedContent());return e.join("")}getSliceStartKey(){return`${this.textInstanceId},${i()(this.startItem.id)}`}getSliceKey(){return`${this.textInstanceId},${i()(this.startItem.id)},${i()(this.endItem.id)}`}static combineSlices(e){(0,c.T)(e.length>0);const{textInstanceId:t,opClock:n}=(0,c.TO)(e[0]),o=n.getValue(),r=new Map;for(const d of e){(0,c.T)(d.textInstanceId===t),(0,c.T)(d.opClock.getValue()===o);const e=i()(d.getStartItem().id);(0,c.T)(!r.has(e)),r.set(e,d)}const a=(0,c.TO)(r.get(i()("start")));r.delete(i()("start"));const s=a.startItem;let l=a.endItem;for(;"end"!==l.id;){const e=i()(l.id),t=(0,c.TO)(r.get(e));r.delete(e);const n=(0,c.TO)(t.startItem.next);l.next=n,n.prev=l,l=t.endItem}return(0,c.T)(0===r.size),new y(t,n,s)}splitIntoSlices(){const e=p.Eg(this.startItem);this.endItem=(0,c.Fb)(p.s(this.startItem),h),this.visibleCount=p.TS(this.startItem),(0,c.T)(this.startItem!==this.endItem);const t=[this];for(let n=1;n<e.length;n++)t.push(new y(this.textInstanceId,this.opClock,(0,c.Fb)(e[n],g)));return t}equals(e){if(this===e)return!0;if(this.textInstanceId!==e.textInstanceId)return!1;const t=[...this.iterateItems({includeDeleted:!0,includeEndItem:!0})],n=[...e.iterateItems({includeDeleted:!0,includeEndItem:!0})];if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++){const e=n[o];if(!t[o].equals(e))return!1}return!0}static createEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZP)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new m.Z;const n=new u.vM,o=new u.KH;return n.next=o,o.prev=n,new y(e,t,n)}}},46227:(e,t,n)=>{n.d(t,{ZP:()=>m,wb:()=>p});n(57658),n(52262),n(24506),n(21703),n(30541);var o=n(15095),i=n(72126),r=n(4615),a=n(70203),s=n(97880),l=n(82798),c=n(59579),d=n(69920);const u={type:"contains",includeEndItem:!1},p=(0,r.ZP)();class m{constructor(e,t){this.parent=void 0,this.children=[],this.sessionId=e,this.textSlice=t}insertText(e,t){if(0===t.length)return this;const n=this.getOperationForInsertText(e,t).operation;return this.applyInsertTextOperation(n),this}insertTextValue(e,t){if(0===t.length)return this;const n=this.getOperationsForInsertTextValue(e,t).operations;for(const o of n){const e=o.type;"insertText"===e?this.applyInsertTextOperation(o):"addAnnotation"===e||"removeAnnotation"===e?this.applyAnnotationOperation(o):(0,s.t1)(e)}return this}findClosestVisibleIndexForOpId(e,t){let n=0;for(const o of this.iterateTextSliceTrees()){const i=o.getTextSlice();if(i.textInstanceId===e){const e=i.findClosestVisibleIndexForOpId(t);if(void 0!==e)return e>=0?n+e:e-n}n+=i.getVisibleCount()}}findGraphemeIndexOfOpId(e,t){const n=this.findClosestVisibleIndexForOpId(e,t);if(void 0===n)return;const i=this.getTextValue(),r=new o.nV(a.eeV(i));return n>=0?r.getGraphemeIndex(n):-r.getGraphemeIndex(-n-1)-1}getOperationsForInsertTextValue(e,t){const n=a.QaF(t),{operation:o,invertedOperation:i}=this.getOperationForInsertText(e,n),{textSliceTree:r}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e),{textSlice:s}=r;return{operations:[o,...this.getAnnotationOperationsForInsertTextValue(o,t,s)],invertedOperations:[i]}}getOperationsForInsertTextValueAfterOriginId(e,t,n){const o=(0,l.TO)(this.findTextSliceTreeContainingItemWithId(e,t)),{textSlice:i}=o,r=a.QaF(n),s={type:"insertText",textInstanceId:e,id:[this.sessionId,i.opClock.reserveTicks(r.length)],originId:t,content:r},c={type:"invertedInsertText",textInstanceId:e,startId:s.id,endId:[s.id[0],s.id[1]+r.length-1]};return{operations:[s,...this.getAnnotationOperationsForInsertTextValue(s,n,i)],invertedOperations:[c]}}getAnnotationOperationsForInsertTextValue(e,t,n){const i=new Map,r=new Map,s=new o.W3(a.eeV(t));a.Sfs({textValue:t,startIndex:0,endIndex:s.getLength()}).forEach((e=>{let{startIndex:t,endIndex:n,annotation:o}=e;const l=s.getStringStartIndex(t),c=s.getStringEndIndex(n-1),d=a.XSJ(o);i.set(d,o);const u=r.get(d)??[];u.push([l,c]),r.set(d,u)}));const c=n.getActiveAnnotationsAfterId(e.originId),d=new Map,u=new Map;for(const[o,a]of r){if(c.has(o)){const e=f(a,s.getStringLength()-1);e.length&&d.set(o,e)}else u.set(o,a)}for(const o of c.keys())r.has(o)||((0,l.T)(!d.has(o)),d.set(o,[[0,s.getStringLength()-1]]));const p=s.getStringLength(),m=n.getItemIdAfterItem(e.originId),g=[];for(const[o,f]of d){const t=(0,l.TO)(c.get(o)),i=a.J7s(t),r=a.$z2(i);for(const[o,s]of f){const i=r?{anchor:"before",id:[this.sessionId,e.id[1]+o]}:{anchor:"after",id:o-1>=0?[this.sessionId,e.id[1]+o-1]:e.originId},l={anchor:"before",id:s+1<p?[this.sessionId,e.id[1]+s+1]:m};g.push({type:"removeAnnotation",textInstanceId:e.textInstanceId,id:[this.sessionId,n.opClock.reserveTicks(1)],start:i,end:l,annotationKey:a.c14(t)})}}for(const[o,f]of u){const t=(0,l.TO)(i.get(o)),r=a.J7s(t),s=a.$z2(r);for(const[o,i]of f){const r={anchor:"before",id:[this.sessionId,e.id[1]+o]},a=s?{anchor:"before",id:i+1<p?[this.sessionId,e.id[1]+i+1]:m}:{anchor:"after",id:[this.sessionId,e.id[1]+i]};g.push({type:"addAnnotation",textInstanceId:e.textInstanceId,id:[this.sessionId,n.opClock.reserveTicks(1)],start:r,end:a,annotation:t})}}return g}getOperationForInsertText(e,t){(0,l.T)(t.length>0);const{textSliceTree:n,originId:o}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e),{textSlice:i}=n,r={type:"insertText",textInstanceId:i.textInstanceId,id:[this.sessionId,i.opClock.reserveTicks(t.length)],originId:o,content:t};return{operation:r,invertedOperation:{type:"invertedInsertText",textInstanceId:i.textInstanceId,startId:r.id,endId:[r.id[0],r.id[1]+t.length-1]}}}applyInsertTextOperation(e){(0,l.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,e.originId)).applyInsertTextOperation(e)}deleteText(e,t){return this.getOperationsForDeleteText(e,t).operations.forEach((e=>this.applyDeleteOperation(e))),this}getOperationsForDeleteText(e,t){(0,l.T)(e<=t);const n=[],i=[];for(const{textSliceTree:r,textSliceStartIndex:s,textSliceEndIndex:d}of this.getTextSliceTreesInRange(e,t)){const{textSlice:u}=r,p=Math.max(0,e-s),m=Math.min(d-s,t-s),f=u.getItemIdsInRange(p,m),g=(0,c.jY)(f),h=u.getTextValue(),v=new o.nV(a.eeV(h)),b=a.KU1(h,v.getGraphemeIndex(p),v.getGraphemeIndex(m)+1),y=b.reduce(((e,t)=>{var n;return e+((null===(n=t[0])||void 0===n?void 0:n.length)??0)}),0);(0,l.T)(y===g.length,`Deleted text should have same length as deleted item IDs: expected ${g.length} but got ${y} `),n.push({type:"deleteText",textInstanceId:u.textInstanceId,idRanges:f}),i.push({type:"invertedDeleteText",textInstanceId:u.textInstanceId,originId:(0,l.TO)(g.at(-1)),textValue:b,deletedIds:g})}return(0,l.T)(n.length>0),(0,l.T)(i.length>0),{operations:n,invertedOperations:i}}applyDeleteOperation(e){(0,l.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,(0,l.TO)(e.idRanges[0][0]))).applyDeleteTextOperation(e)}addAnnotation(e,t,n){return this.getOperationsForAddAnnotation(e,t,n).operations.forEach((e=>this.applyAnnotationOperation(e))),this}removeAnnotation(e,t,n){return this.getOperationsForRemoveAnnotation(e,t,n).operations.forEach((e=>this.applyAnnotationOperation(e))),this}getOperationsForAddAnnotation(e,t,n){(0,l.T)(e<=t);const o=a.J7s(n),i=a.$z2(o),r=this.getTextSliceSpansForAnnotationOperation(e,t,i,!1).map((e=>{let{textSlice:t,start:o,end:i}=e;return{type:"addAnnotation",textInstanceId:t.textInstanceId,id:[this.sessionId,t.opClock.reserveTicks(1)],start:o,end:i,annotation:n}}));(0,l.T)(r.length>0);const{textSliceTree:s,opId:c}=this.getTextSliceTreeAndItemIdForIndex(e),{textSliceTree:d,opId:u}=this.getTextSliceTreeAndItemIdForIndex(t);return{operations:r,invertedOperations:[{type:"invertedAddAnnotation",startTextInstanceId:s.textSlice.textInstanceId,startId:c,endTextInstanceId:d.textSlice.textInstanceId,endId:u,annotationKey:a.c14(n)}]}}getOperationsForRemoveAnnotation(e,t,n){(0,l.T)(e<=t);const r=a.JA7(n),s=a.$z2(r),c=this.getTextSliceSpansForAnnotationOperation(e,t,s,!0).map((e=>{let{textSlice:t,start:o,end:i}=e;return{type:"removeAnnotation",textInstanceId:t.textInstanceId,id:[this.sessionId,t.opClock.reserveTicks(1)],start:o,end:i,annotationKey:n}}));(0,l.T)(c.length>0);const{textSliceTree:d,opId:u}=this.getTextSliceTreeAndItemIdForIndex(e),{textSliceTree:p,opId:m}=this.getTextSliceTreeAndItemIdForIndex(t),f=this.getTextValue(),g=new o.nV(a.eeV(f)),h=a.Sfs({textValue:f,startIndex:g.getGraphemeIndex(e),endIndex:g.getGraphemeIndex(t)+1,annotationType:a.JA7(n)}).find((e=>{let{annotation:t}=e;return i.Xy(a.c14(t),n)}));return{operations:c,invertedOperations:h?[{type:"invertedRemoveAnnotation",startTextInstanceId:d.textSlice.textInstanceId,startId:u,endTextInstanceId:p.textSlice.textInstanceId,endId:m,annotation:h.annotation}]:[]}}getTextSliceSpansForAnnotationOperation(e,t,n,o){(0,l.T)(0<=e&&e<=t&&t<this.getVisibleCount(),`Invalid range: [${e}, ${t}]`);const i=[];for(const{textSliceTree:r,textSliceStartIndex:a,textSliceEndIndex:s}of this.getTextSliceTreesInRange(e,t)){const{textSlice:l}=r;let c,d;c=e<a?{id:l.getStartItem().id,anchor:"after"}:o&&!n?{id:l.getItemIdBeforeIndex(e-a),anchor:"after"}:{id:l.getItemIdAtIndex(e-a),anchor:"before"},d=s<t?{id:l.getEndItem().id,anchor:"before"}:o||n?{id:l.getItemIdAfterIndex(t-a),anchor:"before"}:{id:l.getItemIdAtIndex(t-a),anchor:"after"},i.push({textSlice:l,start:c,end:d})}return i}applyAnnotationOperation(e){(0,l.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,e.start.id)).applyAnnotationOperation(e)}splitAtIndex(e){const t=this.getOperationsForSplitAtIndex(e),n=t.type;switch(n){case"splitNodeEnd":{const{newTextSliceTree:e,textSliceTreesToMove:n}=t;e.detachFromParent();for(const t of n)t.detachFromParent(),e.appendChild(t);return e}case"splitWithinNode":{const{splitOp:e,textSliceTreesToMove:n}=t,o=this.applySplitOperation(e);o.detachFromParent();for(const t of n)t.detachFromParent(),o.appendChild(t);return o}default:(0,s.t1)(n)}}getOperationsForSplitForMerge(){const{textSlice:e}=this;e.opClock.reserveTicks(20);return{type:"splitWithinNode",splitOp:{type:"splitText",textInstanceId:e.textInstanceId,id:[this.sessionId,e.opClock.reserveTicks(1)],originId:(0,l.Fb)(e.getStartItem().id,d.rd)},textSliceTreeToSplit:this,textSliceTreesToMove:[]}}getOperationsForSplitAtIndex(e){const{textSliceTree:t,originId:n}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e),{textSlice:o}=t;if(o.isLastOriginItemId(n)){const e=this.getNextTextSliceTree(t);if(e)return{type:"splitNodeEnd",previousTextSliceTree:t,newTextSliceTree:e,textSliceTreesToMove:this.getFollowingTopLevelTextSliceTrees(e)}}return{type:"splitWithinNode",splitOp:{type:"splitText",textInstanceId:o.textInstanceId,id:[this.sessionId,o.opClock.reserveTicks(1)],originId:n},textSliceTreeToSplit:t,textSliceTreesToMove:this.getFollowingTopLevelTextSliceTrees(t)}}applySplitOperation(e){const t=(0,l.TO)(this.findTextSliceTreeContainingItemWithId(e.textInstanceId,e.originId));t.textSlice.applySplitTextOperation(e);const n=t.textSlice.splitIntoSlices();(0,l.T)(2===n.length);const o=(0,l.T)(n[1]),i=new m(this.sessionId,o);for(;t.children.length;){const e=t.children[0];e.detachFromParent(),i.appendChild(e)}return t.appendChild(i),i}getTextValue(){const e=[];for(const t of this.iterateTextSliceTrees())e.push(...t.textSlice.getTextValue());return a.Zxt(e)}getText(){return a.QaF(this.getTextValue())}detachFromParent(){var e;null===(e=this.parent)||void 0===e||e.removeChild(this)}getTextSlice(){return this.textSlice}replaceTextSlice(e){(0,l.T)(e.textInstanceId===this.textSlice.textInstanceId&&e.opClock===this.textSlice.opClock),this.textSlice=e}removeChild(e){const t=this.children.indexOf(e);return(0,l.T)(-1!==t),this.children.splice(t,1),e.parent=void 0,this}appendChild(e){if((0,l.T)(void 0===e.parent),e.parent=this,this.children.push(e),e.hasCycle())throw e.detachFromParent(),new Error("Appending child resulted in a cycle");return this}hasCycle(){const e=new Set;let t=this;for(;t;){if(e.has(t))return!0;e.add(t),t=t.parent}return!1}getTextSliceTreeAndOriginItemIdForInsertionIndex(e){let t,n;if(0===e){let e;for(const t of this.iterateTextSliceTrees())if(e=t,t.textSlice.getVisibleCount()>0)break;t=(0,l.TO)(e),n=0}else{const o=(0,l.TO)(this.getTextSliceTreesInRange(e-1,e-1)[0]);t=o.textSliceTree,n=e-o.textSliceStartIndex}return{textSliceTree:t,originId:t.textSlice.getOriginItemIdForInsertionIndex(n)}}getTextSliceTreeAndItemIdForIndex(e){const{textSliceTree:t,textSliceStartIndex:n}=(0,l.TO)(this.getTextSliceTreesInRange(e,e)[0]),o=e-n;return{textSliceTree:t,opId:t.textSlice.getItemIdAtIndex(o)}}findTextSliceContainingItemWithId(e,t,n){var o;return null===(o=this.findTextSliceTreeContainingItemWithId(e,t,n))||void 0===o?void 0:o.textSlice}findTextSliceTreeBeforeTextSliceStartingWithItemId(e,t){let n;for(const o of this.iterateTextSliceTrees()){const{textSlice:i}=o;if(i.textInstanceId===e&&i.getStartItem().startsWithId(t))return n;n=o}}findTextSliceTreeContainingItemWithId(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u;for(const o of this.iterateTextSliceTrees(e))switch(n.type){case"contains":if(o.textSlice.containsItemWithId(t,n))return o;break;case"start":if(o.textSlice.getStartItem().startsWithId(t))return o;break;case"end":if(o.textSlice.getEndItem().endsWithId(t))return o;break;default:(0,s.t1)(n)}}getTextSliceTreesInRange(e,t){const n=[];(0,l.T)(0<=e&&e<=t&&t<this.getVisibleCount(),`Invalid range: [${e}, ${t}]`);let o=-1;for(const i of this.iterateTextSliceTrees()){const{textSlice:r}=i;if(0===r.getVisibleCount())continue;const a=o+1,s=a+r.getVisibleCount()-1;if(s<e)o=s;else{if(t<a)break;n.push({textSliceTree:i,textSliceStartIndex:a,textSliceEndIndex:s}),o=s}}return n}getNextTextSliceTree(e){let t;for(const n of this.iterateTextSliceTrees()){if(t===e)return n;t=n}}getFollowingTopLevelTextSliceTrees(e){const t=[this];for(;t.length;){const n=(0,l.TO)(t.shift());if(n===e)return[...t];t.unshift(...n.children)}return[]}getLastTextSliceTreeInPreOrderTraversal(){let e=this;for(const t of this.iterateTextSliceTrees())e=t;return e}getVisibleCount(){let e=0;for(const t of this.iterateTextSliceTrees())e+=t.textSlice.getVisibleCount();return e}*iterateTextSliceTrees(e){e&&this.textSlice.textInstanceId!==e||(yield this);for(const t of this.children)yield*t.iterateTextSliceTrees(e)}equals(e){if(this===e)return!0;const t=[...this.iterateTextSliceTrees()],n=[...e.iterateTextSliceTrees()];if(t.length!==n.length)return!1;for(let o=0;o<t.length;o++){const e=t[o],i=n[o];if(!e.textSlice.equals(i.textSlice))return!1;const r=e.children,a=i.children;if(r.length!==a.length)return!1;for(let t=0;t<r.length;t++){const e=r[t],n=a[t];if(e.textSlice.getSliceKey()!==n.textSlice.getSliceKey())return!1}}return!0}static createEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.ZP)();return new m(arguments.length>1&&void 0!==arguments[1]?arguments[1]:p,d.ZP.createEmpty(e))}}function f(e,t){const n=[];let o=-1;for(const[i,r]of e)i>o+1&&n.push([o+1,i-1]),o=r;return t>=o+1&&n.push([o+1,t]),n}},97531:(e,t,n)=>{n.d(t,{K$:()=>l,Vt:()=>d});n(21703);var o=n(41432),i=n(21202),r=n(82798),a=n(68955),s=n(46227);function l(e,t){const n=e,o=s.ZP.createEmpty(n);return t&&o.insertTextValue(0,t),{use_crdt:!0,text_slice_tree:a.Z.serialize(o),text_clocks:a.Z.serializeClocks(o)}}function c(e){var t,n;(0,r.T)(!(null!==(t=e.format)&&void 0!==t&&t.use_crdt));const i=null===(n=e.properties)||void 0===n?void 0:n.title,a=(0,o.h5)(e.type)?l(e.id,i):{use_crdt:!0},s={...e};return s.format={...s.format,...a},s}function d(e){return e.map((e=>{if("set"!==e.command||e.pointer.table!==i.iU)return e;if(e.path.length>0)throw new Error("Block operation should modify root record");const t=e.args.id?e.args:{...e.args,id:e.pointer.id};return{...e,args:c(t)}}))}},59579:(e,t,n)=>{n.d(t,{$c:()=>r,Dx:()=>a,e0:()=>i,jY:()=>s});n(57658);var o=n(82798);function i(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:e[0]<t[0]?-1:e[0]>t[0]?1:0}function r(e,t){const n=i(e,t);return(0,o.T)(0!==n,`Expected IDs to be distinct: ${e}`),n}function a(e,t){const n=function(e,t){return"start"===e?"start"===t?0:-1:"end"===e?"start"===t?1:"end"===t?0:-1:"start"===t||"end"===t?1:i(e,t)}(e,t);return(0,o.T)(0!==n,`Expected IDs to be distinct: ${e}`),n}function s(e){const t=[];for(const n of e){const[e,o]=n,[i,r]=e;for(let n=0;n<o;n++)t.push([i,r+n])}return t}},52136:(e,t,n)=>{n.d(t,{AB:()=>l,Eg:()=>s,Hi:()=>i,TS:()=>a,s:()=>r});n(57658);var o=n(43993);function*i(e,t){let n=e;for(;n;){let e=!0;(null==t||!t.includeDeleted)&&n instanceof o.Jy&&n.isDeleted()?e=!1:null!=t&&t.includeEndItem||n.next||(e=!1),e&&(yield n),n=n.next}}function r(e){let t=e;for(const n of i(e,{includeDeleted:!0,includeEndItem:!0}))t=n;return t}function a(e){let t=0;for(const n of i(e,{includeDeleted:!1}))n instanceof o.Jy&&(t+=n.getLength());return t}function s(e){const t=[e];let n=e.next;for(;n;)if(n instanceof o.JE&&n.next){const e=n.clone(),o=n.next;e.next=o,o.prev=e,e.prev=void 0,n.next=void 0,t.push(e),n=e.next}else n=n.next;return t}function l(e){for(let t=1;t<e.length;t++)e[t].prev=e[t-1],e[t-1].next=e[t]}},47247:(e,t,n)=>{n.d(t,{Z:()=>u});n(57658);var o=n(82798),i=n(52136),r=n(69920),a=n(97880),s=n(43993),l=n(57081);class c{static serialize(e){return[...e.getOps()]}static deserialize(e){return new l.Z(e)}}class d{static serialize(e){let t;e instanceof s.vM?t=d.serializeStartItem(e):e instanceof s.KH?t=d.serializeEndItem(e):e instanceof s.JE?t=d.serializeSplitItem(e):e instanceof s.Jy?t=d.serializeTextItem(e):(0,a.t1)(e);const n=e.getAnnotationOpSetForAnchor("before");n&&(t.annotationOpsBefore=c.serialize(n));const o=e.getAnnotationOpSetForAnchor("after");return o&&(t.annotationOpsAfter=c.serialize(o)),t}static serializeStartItem(e){return{type:"start"}}static serializeEndItem(e){return{type:"end"}}static serializeSplitItem(e){return{type:"split",id:e.id,originId:e.originId}}static serializeTextItem(e){return e.isDeleted()?{type:"text",id:e.id,originId:e.originId,deleted:!0,length:e.getLength()}:{type:"text",id:e.id,originId:e.originId,deleted:!1,content:e.getDefinedContent()}}static deserialize(e){let t;const n=e.type;switch(n){case"start":t=d.deserializeStartItem(e);break;case"end":t=d.deserializeEndItem(e);break;case"split":t=d.deserializeSplitItem(e);break;case"text":t=d.deserializeTextItem(e);break;default:(0,a.t1)(n)}return e.annotationOpsBefore&&t.maybeCreateAnnotationOpSetForAnchor("before",{opSet:c.deserialize(e.annotationOpsBefore)}),e.annotationOpsAfter&&t.maybeCreateAnnotationOpSetForAnchor("after",{opSet:c.deserialize(e.annotationOpsAfter)}),t}static deserializeStartItem(e){return new s.vM}static deserializeEndItem(e){return new s.KH}static deserializeSplitItem(e){return new s.JE(e.id,e.originId)}static deserializeTextItem(e){return e.deleted?s.Jy.createDeleted(e.id,e.originId,e.length):s.Jy.create(e.id,e.originId,e.content)}}class u{static serialize(e){const t=[];for(const n of e.iterateItems({includeDeleted:!0,includeEndItem:!0}))t.push(d.serialize(n));return{textInstanceId:e.textInstanceId,items:t}}static deserialize(e,t){const n=[];for(const o of e.items)n.push(d.deserialize(o));i.AB(n);const a=(0,o.Fb)(n[0],r.GU);return new r.ZP(e.textInstanceId,t,a)}}},68955:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(82798),i=n(19056),r=n(46227),a=n(47247);class s{static serialize(e){const t={};for(const n of e.iterateTextSliceTrees()){const e=n.getTextSlice(),o=n.children;t[e.getSliceKey()]={textSlice:a.Z.serialize(e),childKeys:o.map((e=>e.getTextSlice().getSliceKey()))}}return{root:e.getTextSlice().getSliceKey(),nodes:t}}static serializeClocks(e){const t={};for(const n of e.iterateTextSliceTrees()){const{textInstanceId:e,opClock:i}=n.getTextSlice();t[e]?(0,o.T)(t[e]===i.getValue()):t[e]=i.getValue()}return t}static deserialize(e,t,n){const o=t.root,i=t.nodes;return s.deserializeHelper(e,o,i,n)}static deserializeTreeAndClocks(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.wb;const o=s.deserializeClocks(t);return{textSliceTree:s.deserialize(n,e,o),opClockMap:o}}static deserializeHelper(e,t,n,i){const{textSlice:l,childKeys:c=[]}=(0,o.TO)(n[t]),d=(0,o.TO)(i[l.textInstanceId]),u=a.Z.deserialize(l,d),p=new r.ZP(e,u);for(const o of c){const t=s.deserializeHelper(e,o,n,i);p.appendChild(t)}return p}static deserializeClocks(e){const t={};for(const[n,o]of Object.entries(e))t[n]=new i.Z(o);return t}}},52936:(e,t,n)=>{n.d(t,{Bp:()=>m,yu:()=>g});n(57658),n(21703);var o=n(30120),i=n(80951),r=n(40506),a=n(53877),s=n(21768),l=n(482),c=n(72141),d=n(149),u=n(21202),p=n(97880);const m=["consume_gap","preserve_gap"];class f{constructor(){this.operations=[],this.numDependenciesUpdated=0,this.numCouldNotUpdateDueToPermissions=0}push(e){this.operations.push(...e.operations),this.numDependenciesUpdated+=e.numDependenciesUpdated,this.numCouldNotUpdateDueToPermissions+=e.numCouldNotUpdateDueToPermissions}pushUpdatedBlockDates(e,t){for(const[n,o]of e)this.operations.push(...t.toOperations(o,{id:n,table:u.iU}));this.numDependenciesUpdated+=e.size}}function g(e){const{block:t,options:n,blockingPropertyId:r,blockedByPropertyId:a,timeZone:s,locale:l,collectionSchema:c,getRecordRole:u,getRecordValue:m,dateProperty:g,endDateProperty:y}=e,_=function(e){return t=>{let{oldDateValue:n,newDateValue:i,dependencyDateValue:r}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=r.getStart(),c=i.getStart(),d=i.getEnd();let u;if("consume_gap"===s){if(d.valueOf()>=l.valueOf()){if(a)return k({dateShiftMode:s,newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r});u=d.plus(r.nudgeForDate("start"))}}else if("preserve_gap"===s)if(n){const e=n.getStart(),t=n.getEnd();if(a)return k({dateShiftMode:s,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r});const i=d.diff(t);u=l.plus(i)}else d.valueOf()>=l.valueOf()&&(u=d.plus(r.nudgeForDate("start")));else(0,p.t1)(s);return u&&r.changeBoundary({type:"start",newValue:u})}}(n),S=function(e){return t=>{let{oldDateValue:n,newDateValue:i,dependencyDateValue:r}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=r.getEnd(),c=i.getStart(),d=i.getEnd();let u;if("consume_gap"===s){if(c.valueOf()<=l.valueOf()&&(u=c.minus(r.nudgeForDate("end")),a))return w({dateShiftMode:s,newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r})}else if("preserve_gap"===s)if(n){const e=n.getStart(),t=n.getEnd();if(a)return w({dateShiftMode:s,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:r});const i=e.diff(c);u=l.minus(i)}else c.valueOf()<=l.valueOf()&&(u=c.minus(r.nudgeForDate("end")));else(0,p.t1)(s);return u&&r.changeBoundary({type:"end",newValue:u})}}(n),I={timeZone:s,locale:l};let x,M;if((0,p.$K)(y)){const e=new T({convertArgs:I,startPropertyId:g.id,endPropertyId:y.id});x=e;const n=e.getFromBlock(t),o=(0,i.Gl)(g.newValue)??(null==n?void 0:n.startValue),r=(0,i.Gl)(y.newValue)??(null==n?void 0:n.endValue);if(!(0,p.$K)(o))return new f;M=new A({convertArgs:I,startValue:o,endValue:r})}else{x=new C({convertArgs:I,propertyId:g.id});const e=(0,i.Gl)(g.newValue);if(!(0,p.$K)(e))return new f;M=new P({convertArgs:I,value:e})}const R={startingBlock:t,startingNewDateValue:M,context:{collectionSchema:c,getRecordRole:u,getRecordValue:m,accessor:x}};if("consume_gap"===n.mode){const e=new f,t=b({...R,dependencyPropertyId:r,dateAdjuster:_,dateRangeIsFurtherThan:(e,t)=>e.getStart().valueOf()>t.getStart().valueOf()});if(d.x.isFail(t))return new f;e.push(t.value);const n=b({...R,dependencyPropertyId:a,dateAdjuster:S,dateRangeIsFurtherThan:(e,t)=>e.getEnd().valueOf()<t.getEnd().valueOf()});return d.x.isFail(n)?new f:(e.push(n.value),e)}if("preserve_gap"===n.mode)return function(e){const{startingBlock:t,startingNewDateValue:n,forwardConfig:o,backwardConfig:i,context:r}=e,{accessor:a}=r,s=new Set,l=[{block:t,newDateValue:n}],c=new Map,d=new f;for(;;){const e=l.shift();if(!e)break;const{block:n,newDateValue:u}=e;if(s.has(n.id))continue;s.add(n.id);const p=a.getFromBlock(n);for(const{dependencyPropertyId:a,dateAdjuster:s}of[o,i]){const e=v(r,n,a);for(const n of e)n.id!==t.id&&h({context:r,adjust:e=>s({oldDateValue:p,newDateValue:u,dependencyDateValue:e}),result:d,dependencyPointer:n,onDateUpdated:(e,t)=>{c.has(n.id)||c.set(n.id,t),l.push({block:e,newDateValue:t})}})}}return d.pushUpdatedBlockDates(c,a),d}({...R,forwardConfig:{dependencyPropertyId:r,dateAdjuster:_},backwardConfig:{dependencyPropertyId:a,dateAdjuster:S}});(0,p.t1)(n.mode)}function h(e){const{result:t,dependencyPointer:n,context:o,adjust:i,onDateUpdated:r}=e,{accessor:a,getRecordValue:s,getRecordRole:l}=o,d=l(n);if(d&&!(0,c.J5)(d))return void t.numCouldNotUpdateDueToPermissions++;const u=s(n);if(!u)return;const p=a.getFromBlock(u);if(!p)return;const m=i(p);m&&!m.equals(p)&&r(u,m)}function v(e,t,n){var o;const r=e.collectionSchema[n];return r&&"relation"===r.type?(0,i.j$)({propertySchema:r,getRecordModel:s.o.fromGetRecordValueFn(e.getRecordValue),relationValue:(0,i.rq)(null===(o=t.properties)||void 0===o?void 0:o[n])}):[]}function b(e){const{startingBlock:t,startingNewDateValue:n,context:o,dateAdjuster:i,dateRangeIsFurtherThan:r,dependencyPropertyId:a}=e,{accessor:s}=o,l=new Set,c=[{block:t,newDateValue:n,path:[]}],d=new Map,u=new f;for(;;){const e=c.shift();if(!e)break;const{block:t,newDateValue:n,path:p}=e;if(p.includes(t.id))return{error:"cycle_detected"};if(l.has(t.id))continue;l.add(t.id);const m=s.getFromBlock(t),f=[...p,t.id],g=v(o,t,a);for(const a of g)h({context:o,adjust:e=>i({oldDateValue:m,newDateValue:n,dependencyDateValue:e}),result:u,dependencyPointer:a,onDateUpdated:(e,t)=>{const n=d.get(a.id);n&&!r(t,n)||d.set(a.id,t),c.push({block:e,newDateValue:t,path:f})}})}return u.pushUpdatedBlockDates(d,s),{value:u}}function y(e){const{inputDate:t,dateShiftDirection:n}=e;return 6===t.weekday?t.plus({days:"right"===n?2:-1}):7===t.weekday?t.plus({days:"right"===n?1:-2}):t}function _(e,t){let n,o,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;if(e.valueOf()>t.valueOf())n=t,o=e;else{if(!(e.valueOf()<t.valueOf()))return 0;n=e,o=t}for(i&&(n=n.plus({days:1}),o=o.minus({days:1}));n.valueOf()<=o.valueOf();)S(n)||r++,n=n.plus({days:1});return r}function S(e){return 6===e.weekday||7===e.weekday}function w(e){const{newDateData:t,dependencyDateValue:n,dateShiftMode:o}=e,i=n.getStart(),r=n.getEnd(),a=_(i,r);let s=y({inputDate:t.start.minus({days:1}),dateShiftDirection:"left"});if("preserve_gap"===o){const n=_(e.oldDateData.start,r,!0);for(let e=_(t.start,s,!0);e<n;e++)s=s.minus({days:1}),S(s)&&(s=y({inputDate:s,dateShiftDirection:"left"}))}let l=s,c=1;for(;c<a;)l=l.minus({days:1}),S(l)||c++;return n.changeBoundaries({newStart:l,newEnd:s})}function k(e){const{dependencyDateValue:t,newDateData:n,dateShiftMode:o}=e,i=t.getStart(),r=_(i,t.getEnd());let a=y({inputDate:n.end.plus({days:1}),dateShiftDirection:"right"});if("preserve_gap"===o){const t=_(e.oldDateData.end,i,!0);for(let e=_(n.end,a,!0);e<t;e++)a=a.plus({days:1}),S(a)&&(a=y({inputDate:a,dateShiftDirection:"right"}))}let s=a,l=1;for(;l<r;)s=s.plus({days:1}),S(s)||l++;return t.changeBoundaries({newStart:a,newEnd:s})}function I(e,t){if(!(e instanceof t))throw new Error(`Expected ShiftableDate to be of type ${t}`)}class x{constructor(e){this.convertArgs=e}}class C extends x{constructor(e){super(e.convertArgs),this.propertyId=void 0,this.propertyId=e.propertyId}getFromBlock(e){var t;const n=(0,i.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.propertyId]);return n?new P({value:n,convertArgs:this.convertArgs}):void 0}toOperations(e,t){return I(e,P),[l.op.update({pointer:t,path:["properties"],args:{[this.propertyId]:(0,i.d7)(e.value)}})]}}class T extends x{constructor(e){super(e.convertArgs),this.startPropertyId=void 0,this.endPropertyId=void 0,this.startPropertyId=e.startPropertyId,this.endPropertyId=e.endPropertyId}getFromBlock(e){var t;const n=(0,i.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.startPropertyId]);if((0,p.$K)(n)){var o;const t=(0,i.Gl)(null===(o=e.properties)||void 0===o?void 0:o[this.endPropertyId]);return new A({startValue:n,endValue:t,convertArgs:this.convertArgs})}}toOperations(e,t){return I(e,A),[l.op.update({pointer:t,path:["properties"],args:{[this.startPropertyId]:(0,i.d7)(e.startValue),...e.endValue?{[this.endPropertyId]:(0,i.d7)(e.endValue)}:{}}})]}}class M{constructor(e){this.convertArgs=e}toLuxon(e){return a.OQ.notionDateOrDateTimeToLuxon(e,this.convertArgs)}}class P extends M{constructor(e){super(e.convertArgs),this.value=void 0,this.value=e.value}getStart(){return this.toLuxon(r.Ws(this.value))}getEnd(){return this.toLuxon(r.S$(this.value))}nudgeForDate(e){return"date"===this.value.type||"daterange"===this.value.type?{days:1}:"datetime"===this.value.type?{minutes:1}:"datetimerange"===this.value.type?{}:void(0,p.t1)(this.value)}equals(e){return I(e,P),r.AP(this.value,e.value)}changeBoundary(e){let t;if("daterange"===this.value.type||"datetimerange"===this.value.type){const n=a.NK(this.value,this.convertArgs.timeZone,this.convertArgs.locale),o=n.end.diff(n.start);t=("daterange"===this.value.type?a.OQ.toPersistedDateRange:a.OQ.toPersistedDateTimeRange)("start"===e.type?{start:e.newValue,end:e.newValue.plus(o)}:{start:e.newValue.minus(o),end:e.newValue},this.convertArgs.timeZone)}else if("date"===this.value.type||"datetime"===this.value.type){t=("date"===this.value.type?a.OQ.toPersistedDate:a.OQ.toPersistedDateTime)(e.newValue.valueOf(),this.convertArgs.timeZone)}else(0,p.t1)(this.value);return new P({value:t,convertArgs:this.convertArgs})}changeBoundaries(e){const{newStart:t,newEnd:n}=e;return new P({value:a.OQ.toPersistedDateWithType({start:t,end:n},this.value.type,this.convertArgs.timeZone),convertArgs:this.convertArgs})}}class A extends M{getMergedValue(){if(this._mergedValue===A.MergedValueNotCalculated){const e=a.rH(this.startValue,this.endValue);this._mergedValue=e?a.Qq(e):void 0}return this._mergedValue}constructor(e){super(e.convertArgs),this.startValue=void 0,this.endValue=void 0,this._mergedValue=void 0,this.startValue=e.startValue,this.endValue=e.endValue}getStart(){return this.toLuxon(r.Ws(this.getMergedValue()??this.startValue))}getEnd(){return this.toLuxon(r.S$(this.getMergedValue()??this.endValue??this.startValue))}equals(e){return I(e,A),r.AP(this.startValue,e.startValue)&&((0,p.$K)(this.endValue)?(0,p.$K)(e.endValue)&&r.AP(this.endValue,e.endValue):!(0,p.$K)(e.endValue))}nudgeForDate(e){const t="start"===e?this.startValue:this.endValue??this.startValue;return"date"===t.type?{days:1}:"datetime"===t.type||"datetimerange"===t.type||"daterange"===t.type?{}:void(0,p.t1)(t)}toPersistedDateDiscardingRange(e,t){return void 0===t||"date"===t||"daterange"===t?a.OQ.toPersistedDate(e.valueOf(),this.convertArgs.timeZone):"datetime"===t||"datetimerange"===t?a.OQ.toPersistedDateTime(e.valueOf(),this.convertArgs.timeZone):void(0,p.t1)(t)}changeBoundary(e){var t,n;const o=this.getEnd().diff(this.getStart());return new A({convertArgs:this.convertArgs,..."start"===e.type?{startValue:this.toPersistedDateDiscardingRange(e.newValue,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue.plus(o),null===(t=this.endValue)||void 0===t?void 0:t.type)}:{startValue:this.toPersistedDateDiscardingRange(e.newValue.minus(o),this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue,null===(n=this.endValue)||void 0===n?void 0:n.type)}})}changeBoundaries(e){var t;const{newStart:n,newEnd:o}=e;return new A({startValue:this.toPersistedDateDiscardingRange(n,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(o,null===(t=this.endValue)||void 0===t?void 0:t.type),convertArgs:this.convertArgs})}}A.MergedValueNotCalculated=Symbol("Merged value not calculated yet")},44317:(e,t,n)=>{n.d(t,{Ct:()=>a,O5:()=>s,eG:()=>r});var o=n(9291),i=n(63143);const r=(0,o.defineMessages)({year:{id:"timeUtils.durationDescriptor.intervalYear",defaultMessage:"{numYears, plural, one {1 year} other {{numYears} years}}"},day:{id:"timeUtils.durationDescriptor.intervalDay",defaultMessage:"{numDays, plural, one {1 day} other {{numDays} days}}"},hour:{id:"timeUtils.durationDescriptor.intervalHour",defaultMessage:"{numHours, plural, one {1 hour} other {{numHours} hours}}"},minute:{id:"timeUtils.durationDescriptor.intervalMinute",defaultMessage:"{numMinutes, plural, one {1 minute} other {{numMinutes} minutes}}"},second:{id:"timeUtils.durationDescriptor.intervalSecond",defaultMessage:"{numSeconds, plural, one {1 second} other {{numSeconds} seconds}}"}});function a(e,t){const n=Math.floor(e/i._I),o=Math.floor(e/i.A0),a=Math.floor(e/i.U6),s=Math.floor(e/i.hM),l=Math.floor(e/i.C0);return n>=1?t.formatMessage(r.year,{numYears:n}):o>=1?t.formatMessage(r.day,{numDays:o}):a>=1?t.formatMessage(r.hour,{numHours:a}):s>=1?t.formatMessage(r.minute,{numMinutes:s}):t.formatMessage(r.second,{numSeconds:l})}function s(e){return Math.floor((Date.now()-e)/864e5)}},93824:(e,t,n)=>{n.d(t,{q:()=>i});n(57658);var o=n(35311);function i(e,t){const n=o.create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!n)return{beforeOps:{},removeOps:new Set};let i=[],r=[];for(const o in n)"_t"!==o&&("_"===o[0]?i.push(parseInt(o.slice(1),10)):1===n[o].length&&r.push({index:parseInt(o,10),value:n[o][0]}));const a={},s=new Set,l=[...e];i=i.sort(((e,t)=>e-t));for(let o=i.length-1;o>=0;o--){const e=i[o],t=l.splice(e,1)[0];s.add(t)}r=r.sort(((e,t)=>e.index-t.index));for(let o=0;o<r.length;o++){const e=r[o];a[e.value]=l[e.index],l.splice(e.index,0,e.value)}return{beforeOps:a,removeOps:s}}},76837:(e,t,n)=>{n.d(t,{t1:()=>te,tV:()=>ee,PZ:()=>Q,nM:()=>q,eb:()=>G});n(57658),n(21703),n(92996);var o=n(3865),i=n(28751),r=n(41432),a=n(76205),s=n(14714),l=n(99036),c=n(1274),d=n(68955),u=n(46227);const p="415fc269-e68f-4da0-b3e3-b1273b741a7f";n(42509);var m=n(89789),f=n(59753),g=(n(482),n(4615)),h=n(98963),v=n(18844),b=n(21202),y=n(70203);function _(e){var t;const{blockValue:n,factoryButtonDeprecationContext:o,source:i}=e,r=function(e){return f.kk.fromValue(b.iU,e).getCreatedByPointer()??{id:m.P_.id,table:m.P_.table}}(n),a=n.space_id,s=(0,g.ZP)(),l=(0,g.ZP)(),c=o.isRootBlockFactoryBlock&&o.isCurrentBlockRootBlock?o.rootTextContainerId:(0,g.ZP)(),d=function(e){const{automationActionId:t,textContainerBlockId:n,creatorPointer:o,originalBlockValue:i,spaceId:r,blockContent:a}=e;return{table:b.iU,value:{id:n,space_id:r,alive:!0,parent_table:v.Xj,parent_id:t,type:"text",version:0,content:a,created_time:i.created_time,created_by_table:o.table,created_by_id:o.id}}}({automationActionId:l,textContainerBlockId:c,creatorPointer:r,originalBlockValue:n,blockContent:"duplication"===i?null===(t=n.content)||void 0===t?void 0:t.map((t=>e.pointerMapper({id:t,table:b.iU}).id)):n.content,spaceId:a}),u=function(e){const{automationId:t,automationActionId:n,spaceId:o,textContainerBlockId:i}=e;return{table:v.Xj,value:{id:n,space_id:o,alive:!0,parent_table:h.cv,parent_id:t,type:"duplicate_blocks",blocks:[i],version:0,config:void 0}}}({automationActionId:l,automationId:s,creatorPointer:r,originalBlockValue:n,spaceId:a,textContainerBlockId:c});return{textContainerBlock:d,automation:function(e){var t;const{creatorPointer:n,automationActionId:o,originalBlockValue:i,spaceId:r,automationId:a}=e,s=(0,g.ZP)(),l=Date.now();return{table:h.cv,value:{id:a,space_id:r,alive:!0,trigger:{id:s,type:"button"},parent_id:i.id,parent_table:b.iU,action_ids:[o],status:"active",properties:{name:(0,y.QaF)(null===(t=i.properties)||void 0===t?void 0:t.title)},created_by_id:n.id,created_by_table:n.table,created_time:i.created_time??l,last_edited_time:i.last_edited_time??l,version:0,last_edited_by_id:i.last_edited_by_id??n.id,last_edited_by_table:i.last_edited_by_table??n.table}}}({automationActionId:l,automationId:s,creatorPointer:r,originalBlockValue:n,spaceId:a}),automationAction:u}}var S=n(6695),w=n(78106),k=n(76218),I=n(59730),x=n(64572),C=n(72126),T=n(77337),M=n(63306),P=n(86517),A=n(72141),R=n(71644),D=n(74446),B=n(45953),E=n(606),F=n(77420),Z=n(6287),V=n(13493),j=n(70279),U=n(33709),L=n(80396),O=n(23867),N=n(91644),z=n(97880),W=n(63143);function q(e){const t=G([y.V3y(e)]);return y.QaF(t)}function H(e){if(e.length<3||!e.startsWith("(")||!e.endsWith(")"))return;const t=e.substring(1,e.length-1),n=parseInt(t);return!Number.isNaN(n)&&n>0&&function(e){return Boolean(e.match(/^[1-9][0-9]*$/))}(t)?n:void 0}function K(e){const t=e=>`(${e})`,{title:n,digit:o}=function(e){const t=e.trimEnd(),n=t.split(" "),o=H(n[n.length-1]);let i=t;if(void 0!==o){const e=n.slice(0,n.length-1).join(" ");i=e.length>0?e:void 0}return{title:i,digit:o}}(e[0]),i=void 0===n?"":`${n.trimEnd()} `,r=t(void 0===o?1:o+1);return y.V3y(`${i}${r}`)}function G(e){const t=y.QaF(e);if(0===t.trim().length||void 0===e)return[y.V3y(t)];const n=e[e.length-1];if(y.QJH(n)){return[...e.slice(0,e.length-1),K(n)]}return[...e,K([""])]}function $(e){return(t=e.table)===b.iU||t===Z.v||t===V.n||t===U.qF||t===j.x_||t===L.yo||t===h.cv||t===v.Xj||t===N.AT;var t}function Q(e){const{sourceBlockId:t,targetBlockPointer:n,recordMap:o,options:i,baseUrl:r,publicDomainName:a,actor:s,getRecordRole:l}=e,c=e.recordPointerMap||B.Ao.create();for(const{pointer:f}of o){const e=f.id===t?n:c.get(f)||{spaceId:n.spaceId,table:f.table,id:(0,g.ZP)()};c.set(f,e)}const d=B.Ak.create(),u=e=>{let{requested:t}=e;return c.get(t)},p=o.getModel({id:t,table:b.iU}),m=p?function(e){const t="duplication",n=new Map;let o;return"factory"===e.type?(o={type:t,isRootBlockFactoryBlock:!0,isCurrentBlockRootBlock:!1,factoryBlockIdToNewTextContainerIdMap:n,rootTextContainerId:(0,g.ZP)()},o.factoryBlockIdToNewTextContainerIdMap.set(e.id,{id:o.rootTextContainerId,table:b.iU})):o={type:t,isRootBlockFactoryBlock:!1,factoryBlockIdToNewTextContainerIdMap:n},o}(p):void 0;for(const{pointer:f,model:g}of o){if(void 0===g)continue;if(!$(g))continue;if(!(null!=i&&i.duplicateDiscussions||f.table!==U.qF&&f.table!==j.x_&&f.table!==L.yo))continue;const e=Boolean((null==i?void 0:i.resolveTemplateVariables)&&oe({rootSourceBlockIds:[t],childSourcePointer:f,getSourceRecordValue:D.mF.fromRecordMap(o)}))?{...i,resolveTemplateVariables:!1}:i;null!=m&&m.isRootBlockFactoryBlock&&(m.isCurrentBlockRootBlock=g.id===t);const{duplicateRecord:c,additionalRecords:p}=J({table:g.table,record:g.__IM_SORRY__getValue(),mapper:u,options:e,rewiredUriMap:{},typedCollectionViewBlocks:[],originOptions:{baseUrl:r,publicDomainName:a},actor:s,getRecordRole:l,factoryButtonDeprecationContext:m});if(void 0!==c){if(g.table===b.iU&&c.id===n.id){const e=c;delete e.parent_id,delete e.parent_table,delete e.alive}Y({duplicateRecordMap:d,duplicateRecordResult:{duplicateRecord:c,additionalRecords:p,duplicateRecordTable:g.table}})}}return{duplicateRecordMap:d,originalToDuplicate:c}}function Y(e){const{duplicateRecordResult:t,duplicateRecordMap:n}=e,{additionalRecords:o,duplicateRecord:i,duplicateRecordTable:r}=t;n.setValue(E.dr.fromPointerLike({table:r,id:i.id}),i);for(const a of o)n.setValue(E.dr.fromPointerLike({id:a.value.id,table:a.table}),a.value)}function J(e){const{table:t,record:n,mapper:a,options:c,originOptions:m,actor:x,helperRecordMap:M,getRecordRole:q,rewiredUriMap:H,typedCollectionViewBlocks:K,factoryButtonDeprecationContext:G}=e,$=C.Xh(n),Q=a({requested:E.dr.fromPointerLike({table:t,id:n.id,spaceId:n.space_id}),requester:E.dr.fromPointerLike({table:t,id:n.id})});if(void 0===Q)throw new I.D3(`Failed to duplicate record ${n.id}`);$.id=Q.id,$.space_id=(0,O.C)(Q.spaceId);const Y=[];if(t===b.iU){const e=$,{additionalRecords:t}=function(e){var t,n,o,i,a,s;const{originalBlock:l,duplicateBlock:c,mapper:m,options:v,originOptions:w,rewiredUriMap:k,typedCollectionViewBlocks:I,actor:x,helperRecordMap:T,factoryButtonDeprecationContext:M}=e,R={table:b.iU,id:l.id,spaceId:l.space_id};null!==(t=l.format)&&void 0!==t&&t.app_config_uri&&null!==(n=c.format)&&void 0!==n&&n.app_config_uri&&((0,S.iA)(l.format.app_config_uri)?c.format.app_config_uri=void 0:((0,r.dM)(c.type)&&I.push(c.id),k[l.id]=c.id));const D=[];if(null!==(o=c.format)&&void 0!==o&&o.use_crdt&&c.format.text_slice_tree&&c.format.text_clocks){const{textSliceTree:e}=d.Z.deserializeTreeAndClocks(c.format.text_slice_tree,c.format.text_clocks),t=e.getTextValue();c.properties={...c.properties,title:t&&y.VrM(t)>0?t:void 0}}if(c.format){const{use_crdt:e,text_slice_tree:t,text_clocks:n,...o}=c.format;c.format=o}if("factory"===c.type&&M){const{automation:e,automationAction:t,textContainerBlock:n}=_({blockValue:c,source:"duplication",pointerMapper:e=>m({requested:e,requester:R})??e,factoryButtonDeprecationContext:M});D.push(e,t,n),M.factoryBlockIdToNewTextContainerIdMap.set(l.id,{id:n.value.id,table:b.iU});const o=c;o.type="button",o.content=[],o.format={...o.format,automation_id:e.value.id}}(0,g.e)(l.id)&&(c.format||(c.format={}),c.format.copied_from_pointer={table:b.iU,id:l.id,spaceId:l.space_id},c.copied_from=l.id);const B=(l.parent_table===b.iU?null==M?void 0:M.factoryBlockIdToNewTextContainerIdMap.get(l.parent_id):void 0)??m({requested:{table:c.parent_table,id:c.parent_id,spaceId:c.space_id},requester:R});B&&(c.parent_id=B.id);const j=c;if(j.content){var L;if(j.content=j.content.map((e=>{var t;return(null===(t=m({requested:{table:b.iU,id:e},requester:R}))||void 0===t?void 0:t.id)||e})),c.space_id===p&&null!==(L=c.properties)&&void 0!==L&&L.title){var N,q,H;const e=(0,y.lzi)(null===(N=c.properties)||void 0===N?void 0:N.title);e&&e.length>0&&e[0].length>0&&null!==(q=e[0][0])&&void 0!==q&&null!==(q=q.trim())&&void 0!==q&&q.startsWith("ðŸŽ²")&&null!==(H=e[0][0])&&void 0!==H&&null!==(H=H.trim())&&void 0!==H&&H.endsWith("ðŸŽ²")&&(j.content=C.TV(j.content))}}null!==(i=c.format)&&void 0!==i&&i.ai_instructions_page_pointer&&(c.format.ai_instructions_page_pointer=m({requested:c.format.ai_instructions_page_pointer,requester:R}));null!==(a=c.format)&&void 0!==a&&a.ai_skill_pointer&&(c.format.ai_skill_pointer=m({requested:c.format.ai_skill_pointer,requester:R}));const K=c;K.view_ids&&(K.view_ids=K.view_ids.map((e=>{var t;return(null===(t=m({requested:{table:V.n,id:e,spaceId:K.space_id},requester:R}))||void 0===t?void 0:t.id)||e})));const G=f.kk.fromBlock(K).getCollectionPointer();if(G){var $;if(null==T||null===($=T.getValue(G))||void 0===$||null===($=$.format)||void 0===$?void 0:$.bot_id)K.collection_id=G.id,K.format={...K.format,collection_pointer:G};else{const e=m({requested:G,requester:R})||G;if(e.table!==Z.v)throw new Error(`Collection pointer for duplicate collection is invalid: ${JSON.stringify(e)}`);K.collection_id=e.id,K.format={...K.format,collection_pointer:e}}}c.discussions&&(v.duplicateDiscussions?c.discussions=c.discussions.map((e=>{var t;return(null===(t=m({requested:E.dr.fromPointerLike({table:U.qF,id:e,spaceId:c.space_id}),requester:R}))||void 0===t?void 0:t.id)||e})):delete c.discussions);if(c.permissions){var Q;if(v.duplicatePermissions)c.permissions=function(e){const{block:t,targetSpaceSettings:n,targetTeamSettings:o}=e;return(t.permissions||[]).filter((e=>!(0,A.FB)(e)&&(!(0,A.hV)(e)&&((!(!o&&n.disablePublicAccess||o&&o.disable_public_access)||!(0,A.$D)(e))&&!((!o&&n.disableGuests||o&&o.disable_guests)&&(0,A.jg)(e)&&!(0,P.N0)({spacePermissions:n.permissions||[],userId:e.user_id,botId:void 0}))))))}({block:c,targetSpaceSettings:v.duplicatePermissions.targetSpaceSettings,targetTeamSettings:null===(Q=v.duplicatePermissions)||void 0===Q?void 0:Q.targetTeamSettings});else delete c.permissions}c.content_classification&&delete c.content_classification;c.moved&&delete c.moved;c.properties||(c.properties={});for(const r in c.properties){const e=v.duplicateDiscussions?c.properties[r]:y.OAI(c.properties[r]);c.properties[r]=e}c.ignore_block_count&&delete c.ignore_block_count;if(c.properties)for(const r of Object.keys(c.properties)){const e=c.properties[r];e&&(c.properties[r]=ne({...w,text:{value:e,spaceId:(0,O.C)(c.space_id)},mapper:m,requester:R,resolveTemplateVariables:v.resolveTemplateVariables||!1}))}if("transclusion_reference"===c.type&&v.deepCopyTransclusionContainers){const e=c;if(e.format&&e.format.transclusion_reference_pointer){const t=e.format.transclusion_reference_pointer,n=m({requested:t,requester:R});n&&(e.format.transclusion_reference_pointer=n)}}if("transclusion_container"===c.type&&!v.deepCopyTransclusionContainers){const e=c;e.type="transclusion_reference",e.content=void 0;const t=e.format||{};t.transclusion_reference_pointer=R,e.format=t}if("alias"===c.type&&c.format&&c.format.alias_pointer){const e=c.format.alias_pointer,t=m({requested:e,requester:R});t&&(c.format.alias_pointer=t)}c.type===r.Ti.externalObjectInstancePage&&(c.type=r.Ti.externalObjectInstance);if(c.type===r.Ti.externalObjectInstance){var Y,J,X;if(null!==(Y=c.format)&&void 0!==Y&&Y.related_external_object_uris_to_instance_ids&&(c.format.related_external_object_uris_to_instance_ids=(0,W.m8)((0,z.qP)(c.format.related_external_object_uris_to_instance_ids).map((e=>{var t;let[n,o]=e;return[n,(null===(t=m({requested:{table:b.iU,id:o,spaceId:K.space_id},requester:R}))||void 0===t?void 0:t.id)||o]})))),v.convertExternalObjectInstancesToPlaceholders&&(null===(J=c.format)||void 0===J||!J.is_placeholder)&&null!==(X=c.format)&&void 0!==X&&X.bot_id){const e=null==T?void 0:T.getValue({table:F.cZ,id:c.format.bot_id}),t=null==e?void 0:e.integration_id;if(t){const e={is_placeholder:!0,integration_id:t};c.format=e}}}c.file_ids&&function(e){var t;const n=JSON.stringify(e.properties);e.file_ids=null==e||null===(t=e.file_ids)||void 0===t?void 0:t.filter((t=>{var o,i,r,a,s,l;return!(null===(o=e.format)||void 0===o||!o.display_source||-1===(null===(i=e.format)||void 0===i||null===(i=i.display_source)||void 0===i?void 0:i.indexOf(t)))||(!(null===(r=e.format)||void 0===r||!r.page_cover||-1===(null===(a=e.format)||void 0===a||null===(a=a.page_cover)||void 0===a?void 0:a.indexOf(t)))||(!(null===(s=e.format)||void 0===s||!s.page_icon||-1===(null===(l=e.format)||void 0===l||null===(l=l.page_icon)||void 0===l?void 0:l.indexOf(t)))||-1!==n.indexOf(t)))}))}(c);if(null!==(s=c.format)&&void 0!==s&&s.automation_id){const e=m({requested:{table:h.cv,id:c.format.automation_id,spaceId:c.space_id},requester:R});e&&(c.format.automation_id=e.id)}"collection"===l.parent_table&&l.type===r.Ti.copyIndicator&&c.properties&&(0,z.Yd)(c.properties).length>0&&(c.type=r.Ti.page);if(v.blocksShouldUseCrdt){const e=u.ZP.createEmpty(c.id);c.properties.title&&y.VrM(c.properties.title)>0&&(e.insertTextValue(0,c.properties.title),c.properties.title=e.getTextValue()),c.format={...c.format,use_crdt:!0,text_slice_tree:d.Z.serialize(e),text_clocks:d.Z.serializeClocks(e)}}if(!v.preserveSourceMetadataTimestamps){const e=Date.now();c.created_time=e,c.last_edited_time=e}x&&(c.last_edited_by_id=x.id,c.last_edited_by_table=x.table,c.created_by_id=x.id,c.created_by_table=x.table);return{duplicateRecord:c,additionalRecords:D}}({originalBlock:n,duplicateBlock:e,mapper:a,options:c??{},rewiredUriMap:H,typedCollectionViewBlocks:K,originOptions:m,actor:x,helperRecordMap:M,factoryButtonDeprecationContext:G});Y.push(...t)}else if(t===Z.v){!function(e,t,n,o,i){var r,a,s,c;const d={table:Z.v,id:e.id,spaceId:e.space_id};null!==(r=e.format)&&void 0!==r&&r.app_config_uri&&(i[e.id]=t.id);if((0,g.e)(e.id)){if(t.format||(t.format={}),t.format.copied_from_pointer={table:Z.v,id:e.id,spaceId:e.space_id},void 0!==t.format.collection_default_template&&"empty"!==t.format.collection_default_template){const e=n({requested:{table:b.iU,id:t.format.collection_default_template.template_page_id},requester:d});e&&(t.format.collection_default_template={template_page_id:e.id})}t.copied_from=e.id}const u=n({requested:{table:t.parent_table,id:t.parent_id},requester:d});u&&(t.parent_id=u.id);const p=l.oC(t);for(const f in p){const e=p[f];if(e&&"relation"===e.type&&l.j0(e)){const t=n({requested:l.j0(e),requester:d});t?(e.collection_id=t.id,e.collection_pointer={id:t.id,table:Z.v,spaceId:(0,O.C)(t.spaceId)}):e.property&&(e.property=(0,R.ZP)())}e&&"title"===e.type&&t.name&&(t.name=ne({...o,text:{value:t.name,spaceId:t.space_id},mapper:n,requester:d,resolveTemplateVariables:!1}))}t.description&&(t.description=ne({...o,text:{value:t.description,spaceId:t.space_id},mapper:n,requester:d,resolveTemplateVariables:!1}));for(const l in p){const e=p[l];if(!e||"formula"!==e.type||"v2"!==e.version||!e.formula2)continue;const t=(0,w.Wo)(e.formula2.code,n,d);e.formula2.code=t}t.template_pages&&(t.template_pages=t.template_pages.map((e=>{var t;return(null===(t=n({requested:{table:b.iU,id:e},requester:d}))||void 0===t?void 0:t.id)||e})));if(null!==(a=t.format)&&void 0!==a&&a.collection_mode&&"page_tree"===t.format.collection_mode.type){var m;const e=t.format.collection_mode.root_page_pointer,o=(null===(m=n({requested:E.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:d}))||void 0===m?void 0:m.id)||e.id;t.format.collection_mode={type:"page_tree",root_page_pointer:{id:o,table:"block",spaceId:t.space_id}}}null!==(s=t.format)&&void 0!==s&&s.related_external_object_uris_to_instance_ids&&(t.format.related_external_object_uris_to_instance_ids=(0,W.m8)((0,z.qP)(t.format.related_external_object_uris_to_instance_ids).map((e=>{var o;let[i,r]=e;return[i,(null===(o=n({requested:{table:Z.v,id:r,spaceId:t.space_id},requester:d}))||void 0===o?void 0:o.id)||r]}))));delete t.deleted_schema,null!==(c=t.format)&&void 0!==c&&c.automation_ids&&(t.format.automation_ids=t.format.automation_ids.map((e=>{var o;return null===(o=n({requested:{id:e,table:h.cv,spaceId:t.space_id},requester:d}))||void 0===o?void 0:o.id})).filter(z.$K))}(n,$,a,m,H)}else if(t===V.n){!function(e,t,n,o,i){var r,a,l,c,d,u;const p={table:V.n,id:e.id,spaceId:e.space_id};null!==(r=e.format)&&void 0!==r&&r.app_config_uri&&null!==(a=t.format)&&void 0!==a&&a.app_config_uri&&((0,S.iA)(e.format.app_config_uri)?t.format.app_config_uri=void 0:o[e.id]=t.id);const m=null===(l=t.format)||void 0===l?void 0:l.collection_pointer;if(m){const e=null==i?void 0:i.getModel(m);if(!Boolean(null==e?void 0:e.isSyncedCollection())){const e=n({requested:m,requester:p})||m;t.format={...t.format,collection_pointer:e}}}if(t.format){var f;const e=null===(f=t.format.collection_groups)||void 0===f?void 0:f.map((e=>{if("relation"===e.value.type&&(0,s.RA)(e.value.value)&&e.value.value){return{...e,value:{type:"relation",value:n({requested:e.value.value,requester:p})}}}return e}));if(t.format.collection_groups=e,void 0!==t.format.collection_view_default_template&&"empty"!==t.format.collection_view_default_template){const e=n({requested:{table:b.iU,id:t.format.collection_view_default_template.template_page_id},requester:p});e&&(t.format.collection_view_default_template={template_page_id:e.id})}}const g=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:p});g&&(t.parent_id=g.id);t.page_sort&&(t.page_sort=t.page_sort.map((e=>{var o;return(null===(o=n({requested:{table:b.iU,id:e,spaceId:t.space_id},requester:p}))||void 0===o?void 0:o.id)||e})));if("page"===t.type&&null!==(c=t.format)&&void 0!==c&&c.page_pointer){var h;const e=t.format.page_pointer,o=(null===(h=n({requested:E.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:p}))||void 0===h?void 0:h.id)||e.id;t.format.page_pointer={table:"block",id:o,spaceId:t.space_id}}if(null!==(d=t.format)&&void 0!==d&&d.property_filters){const e=t.format.property_filters;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:p}))||void 0===t?void 0:t.id}))}if(null!==(u=t.format)&&void 0!==u&&u.filters2){const e=t.format.filters2;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:p}))||void 0===t?void 0:t.id}))}const v=t.query2;v&&v.filter&&X(v.filter,(e=>{var t;return null===(t=n({requested:e,requester:p}))||void 0===t?void 0:t.id}))}(n,$,a,H,M)}else t===U.qF?function(e,t,n,o){const i={table:U.qF,id:e.id,spaceId:e.space_id},r=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:i});r&&(t.parent_id=r.id);t.comments&&(t.comments=t.comments.map((e=>{var o;return(null===(o=n({requested:{table:j.x_,id:e,spaceId:t.space_id},requester:i}))||void 0===o?void 0:o.id)||e})));t.context&&(t.context=ne({...o,text:{value:t.context,spaceId:t.space_id},mapper:n,requester:i,resolveTemplateVariables:!1}))}(n,$,a,m):t===j.x_?function(e,t,n,o){const i={table:j.x_,id:e.id,spaceId:e.space_id},r=n({requested:E.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:i});r&&(t.parent_id=r.id);t.text&&(t.text=ne({...o,text:{value:t.text,spaceId:t.space_id},mapper:n,requester:i,resolveTemplateVariables:!1}));if(t.content)for(const[s,l]of t.content.entries()){var a;const e=(null===(a=n({requested:E.dr.fromPointerLike({table:b.iU,id:l,spaceId:t.space_id}),requester:i}))||void 0===a?void 0:a.id)??l;t.content[s]=e}}(n,$,a,m):t===L.yo?function(e,t,n,o){const i={table:L.yo,id:e.id,spaceId:e.space_id},r=n({requested:E.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:i});r&&(t.parent_id=r.id)}(n,$,a):t===h.cv?function(e){const{original:t,duplicate:n,mapper:i,originOptions:r,options:a,actor:s}=e,l={table:h.cv,id:t.id,spaceId:t.space_id},c=i({requested:E.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:l}),d=(null==c?void 0:c.id)||n.parent_id,u=(n.action_ids??[]).map((e=>{var t;return(null===(t=i({requested:E.dr.fromPointerLike({table:v.Xj,id:e,spaceId:n.space_id}),requester:l}))||void 0===t?void 0:t.id)??e}));ee({duplicate:n,newParentId:d,newActionIds:u,originOptions:r,options:a,actor:s}),(0,o.Vd)(n)&&function(e){var t;const{duplicate:n,mapper:o,original:i,requester:r}=e,a=n.trigger.event.source,s=`Source automation id: ${i.id}\nSource automation name: ${(null===(t=i.properties)||void 0===t?void 0:t.name)??""}\nSource automation parent id: ${i.parent_id}\nSource automation parent table: ${i.parent_table}\n`;if(!(0,z.$K)(a))throw new Error(["Duplicated automation is missing trigger source - undefined",s].join("\n"));if("collection"===a.type){const e=o({requested:a.pointer,requester:r});if(!e)throw new Error(["Duplicated automation is missing trigger source - Collection",`Source automation trigger target id: ${a.pointer.id}`,s].join("\n"));if(e.table!==Z.v)throw new Error(["Duplicated automation has mismatch trigger target",`Wanted: Collection, got ${e.table}`,s].join("\n"));if(void 0!==e.spaceId&&e.spaceId!==n.space_id)throw new Error(["Duplicated automation has mismatch workspace id.",`Wanted: ${n.space_id}, got ${e.spaceId}`,s].join("\n"));a.pointer={...e,spaceId:n.space_id}}else if("collection_view"===a.type){const e=o({requested:a.pointer,requester:r});if(!e)throw new Error(["Duplicated automation is missing trigger source - Collection View",`Source automation trigger target id: ${a.pointer.id}`,s].join("\n"));if(e.table!==V.n)throw new Error(["Duplicated automation has mismatch trigger target",`Wanted: Collection View, got ${e.table}`,s].join("\n"));if(void 0!==e.spaceId&&e.spaceId!==n.space_id)throw new Error(["Duplicated automation has mismatch workspace id",`Wanted: ${n.space_id}, got ${e.spaceId}`,s].join("\n"));a.pointer={...e,spaceId:n.space_id}}else"filter"===a.type||(0,z.t1)(a)}({duplicate:n,original:t,mapper:i,requester:l})}({original:n,duplicate:$,mapper:a,originOptions:m,options:c??{},actor:x}):t===v.Xj?function(e){const{original:t,duplicate:n,mapper:o,getRecordRole:r,options:a,originOptions:s}=e,l=t.space_id!==n.space_id,c={table:v.Xj,id:t.id,spaceId:t.space_id},d=o({requested:E.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:c});let u=r;(function(e){const{automationAction:t,mapper:n,options:o}=e;if(!t.config)return;const i=(e,t)=>({spaceId:t.spaceId,...n({id:t.id,table:t.table,spaceId:t.spaceId}),table:e});if("create_page"===t.type){if(t.config.collection&&(t.config.collection=i(Z.v,t.config.collection)),t.config.template_page_id){(null==o?void 0:o.isTemplateInstantiation)&&o.sourceBlockIds.has(t.config.template_page_id)||(t.config.template_page_id=i(b.iU,{id:t.config.template_page_id,table:b.iU,spaceId:t.space_id}).id)}}else if("query_collection"===t.type)t.config.collection&&(t.config.collection=i(Z.v,t.config.collection));else if("update_pages"===t.type){const e=t.config.target;e&&("collection"===e.type?(e.collection=i(Z.v,e.collection),e.filter&&X(e.filter,(e=>{var t;return null===(t=n(e))||void 0===t?void 0:t.id}))):"variable"===e.type||("page"===e.type?e.page=i(b.iU,e.page):(0,z.t1)(e)))}else if("open_page"===t.type){const e=t.config.target;e&&("page"===e.type?e.page=i(b.iU,e.page):"variable"===e.type||(0,z.t1)(e))}else"complete_sprint"===t.type||"duplicate_blocks"===t.type||"modal_confirmation"===t.type||"slack_notification"===t.type||"assistant"===t.type||(0,z.t1)(t)})({automationAction:n,mapper:e=>{const t=o({requester:c,requested:e});return t?(u=D.DH.tryUntilFound(D.DH.constantForPointer(t,"editor"),u),t):l?(u=D.DH.tryUntilFound(D.DH.constantForPointer(e,"none"),u),e):e},options:a.resolveAutomationConfig}),function(e){const{automationAction:t,requester:n,mapper:o,originOptions:r}=e,a=(0,i.z)(t.type);function s(e){const i=(0,w.MY)(e);if("action"===i.source){var r;const e=(null===(r=o({requester:n,requested:{id:i.action_id,table:v.Xj,spaceId:t.space_id}}))||void 0===r?void 0:r.id)??i.action_id;return(0,w.Kd)({...i,action_id:e})}if("global"===i.source)return e;(0,z.t1)(i)}const l=f.kk.fromValue(v.Xj,t),c=a.acceptFormulaVisitor({action:l,visitor:{visitFormula:e=>{const i=(0,k.Zw)(e,s);let a;return a=i.value?{...i,value:ne({...r,text:{value:i.value,spaceId:t.space_id},mapper:o,requester:n,resolveTemplateVariables:!1})}:i,{type:"replace",value:a}},visitVariableOutsideOfFormula:e=>({type:"replace",value:s(e)})}}),d=B.Ak.create();d.setValue(l.pointer,t),(0,T.FS)({recordMap:d,operations:c,updateOnly:!1});const u=d.getValue(l.pointer);if(!u)throw new Error("Updated automation action not found in record map");t.config=u.config}({automationAction:n,mapper:o,requester:c,originOptions:s});const p=(null==d?void 0:d.id)??n.parent_id;te({original:t,duplicate:n,newParentId:p,getRecordRole:u});const m=(n.blocks??[]).map((e=>{var t;return null===(t=o({requested:E.dr.fromPointerLike({table:b.iU,id:e,spaceId:n.space_id}),requester:c}))||void 0===t?void 0:t.id})).filter(z.$K);n.blocks=m.length>0?m:void 0}({original:n,duplicate:$,mapper:a,getRecordRole:q,options:c??{},originOptions:m}):t===N.AT?function(e){let{original:t,duplicate:n,mapper:o,originOptions:i}=e;const r={table:N.AT,id:t.id,spaceId:t.space_id},a=o({requested:E.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:r});a&&(n.parent_id=a.id)}({original:n,duplicate:$,mapper:a,originOptions:m}):(0,z.t1)(t);return{duplicateRecord:$,additionalRecords:Y}}function X(e,t){if(a.vA(e)){(e.filters||[]).forEach((e=>X(e,t)))}if(a.aN(e)){if(a.e(e.filter)){const n=e.filter;if("relation_contains"===n.operator||"relation_does_not_contain"===n.operator)if(Array.isArray(n.value)){const e=n.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:b.iU,id:n})||n}}if("relative"===n)return e;(0,z.t1)(n)}));n.value=e}else{const e=n.value.type;if("exact"===e){const e=n.value.value;n.value.value=e&&t({table:b.iU,id:e})||e}else{if("relative"===e)return;(0,z.t1)(e)}}}if(a.a_(e.filter)){const n=e.filter.subfilter;if(a.e(n)){const e=n;if("relation_contains"===e.operator||"relation_does_not_contain"===e.operator)if(Array.isArray(e.value)){const n=e.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:b.iU,id:n})||n}}if("relative"===n)return e;(0,z.t1)(n)}));e.value=n}else{const n=e.value.type;if("exact"===n){const n=e.value.value;e.value.value=n&&t({table:b.iU,id:n})||n}else{if("relative"===n)return;(0,z.t1)(n)}}}}}}function ee(e){const{duplicate:t,newParentId:n,newActionIds:o,actor:i,options:r}=e;t.parent_id=n,t.action_ids=o;const a=Date.now();t.created_time=a,t.last_edited_time=a,i&&(t.last_edited_by_id=i.id,t.last_edited_by_table=i.table,t.created_by_id=i.id,t.created_by_table=i.table),"recurrence"===t.trigger.type&&r.shouldDisableRecurrenceAutomation&&(t.status="disabled")}function te(e){const{original:t,duplicate:n,newParentId:o,getRecordRole:i}=e;n.parent_id=o,t.space_id!==n.space_id&&"slack_notification"===n.type&&(n.config={});const r=(0,c.o0)(n);if(r){r.some((e=>{const t=i(e.pointer);return!t||!(0,P.yY)(t,e.minimumRequiredRole)}))&&(n.config={})}}function ne(e){const{text:t,mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:a}=e;if(void 0!==t)return t.value.map((e=>function(e){const{token:t,mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:a}=e;let s;const l=y.hDy(t.token).map((e=>{if(y.STW(e)){const t=y.yrl(e);if(t){const e=n({requested:t,requester:o});if(e)return y.$0A(e.id,e.spaceId)}}if(y.j0F(e)){const t=y.zW$(e),i=(0,x.A5)({url:t,baseUrl:r,publicDomainName:a});if(i){const e=n({requested:{table:b.iU,id:i,spaceId:(0,O.C)(void 0)},requester:o});if(e)return y.edl((0,x.nR)({pageId:e.id}))}}if(y.nSN(e)){const t=y.frW(e);if(t){const e=n({requested:{table:b.iU,id:t,spaceId:(0,O.C)(void 0)},requester:o});if(e)return y.x36(e.id)}}if(y.xw5(e)){const i=y.h19(e),r=n({requested:{table:U.qF,id:i,spaceId:t.spaceId},requester:o});if(r)return y.jw(r.id)}if(y.aq(e)&&i){const t=y.x5L(e,i);if(t&&y.IWo(t)&&i){const e=y.zEN(t);if(e===i.currentUserId){if(s)return;s=e}}return t}if(y.IWo(e)&&i){const t=y.zEN(e);if(t===i.currentUserId){if(s)return;s=t}}return e})).filter(z.$K);return y.V3y(y.WiV(t.token),l)}({token:{token:e,spaceId:t.spaceId},mapper:n,requester:o,resolveTemplateVariables:i,baseUrl:r,publicDomainName:a})))}function oe(e){const{rootSourceBlockIds:t,childSourcePointer:n,getSourceRecordValue:o}=e;for(const i of(0,M.BW)(n,o))if(ie({rootSourceBlockIds:t,recordWithTable:i}))return!0;return!1}function ie(e){const{recordWithTable:t,rootSourceBlockIds:n}=e;if(t.table!==b.iU)return t.table===v.Xj;if(n.includes(t.value.id))return!1;if(f.kk.fromBlock(t.value).isTemplateVariableContainerBlock())return!0}},5220:(e,t,n)=>{n.d(t,{Hx:()=>a});var o=n(59730),i=(n(47969),n(90965)),r=n(47425);function a(e){let{spaceModel:t,userId:n}=e;if(!t||!n)return!1;return void 0===function(e){const{spaceModel:t,userId:n}=e;if(!(0,i.wv)({permissions:t.getPermissionItems()},n))return new o.XV("You do not have permissions to this feature in the requested space.",{type:"generic_insufficient_permissions"});return s(t)}({spaceModel:t,userId:n})}function s(e){if(!(0,r.wP)(e.getSubscriptionTier()))return new o.XV("The feature is not available on your current plan type.",{type:"generic_insufficient_plan_type"})}},55632:(e,t,n)=>{n.d(t,{HX:()=>v,fK:()=>h,$A:()=>g,Jq:()=>b,j2:()=>p,Pv:()=>y,j:()=>_});var o=n(15145),i=n(74686);var r=n(68626),a=n(72126),s=n(91155),l=n(4615);var c=n(64002);const d=new o.nY((async e=>{const{config:t,deviceId:i,disableCookies:r}=e,a=await n.e(9543).then(n.t.bind(n,16791,23));return await new Promise((e=>{const n=t.amplitude&&t.amplitude.apiKey;if(!n)return e(void 0);const s=new URL(t.domainBaseUrl),d=`${s.host}${t.api.http}/teV1`;let u=!0;"http:"===s.protocol&&(u=!1);const p=i?(0,l.XR)(i):void 0;a.getInstance("eventTrailApi").init(n,"",{apiEndpoint:d,forceHttps:u,includeReferrer:!0,includeUtm:!0,includeFbclid:!0,includeGclid:!0,unsetParamsReferrerOnNewSession:!1,saveParamsReferrerOncePerSession:!1,storage:r?"none":"",saveEvents:!r,deviceId:p},(n=>{n&&n.setVersionName((t.env,"2023092001")),e(n),function(){const e=(0,c.gy)(window.location.href);if(!e)return;const t={utm_campaign:e.searchParams.get("utm_campaign")||o.cL,utm_content:e.searchParams.get("utm_content")||o.cL,utm_medium:e.searchParams.get("utm_medium")||o.cL,utm_source:e.searchParams.get("utm_source")||o.cL,utm_term:e.searchParams.get("utm_term")||o.cL};h({traits:(0,o.bt)({...t})})}()}))}))}));function u(e,t,n){return function(o,i,l){if(200===o&&"success"===i)return;const c=a.CE(t,"experiments"),d={data:{responseBody:i,eventName:e,eventData:c,groupData:n},statusCode:o,message:null==l?void 0:l.reason};r.log({level:"error",from:"eventTrailApiHelpers",type:"trackFailure",error:(0,s.Ui)(d)})}}async function p(e){const{config:t,isEnabled:n,deviceId:o,cookieService:a}=e,l=!(await i.ec({service:"amplitude",cookieService:a}));try{await d.load({config:t,isEnabled:n,deviceId:o,disableCookies:l})}catch(c){r.log({level:"error",from:"eventTrailApiHelpers",type:"initialize",error:(0,s.Ui)(c)})}}function m(e,t){const n=new e.Identify;if(t)for(const o of Object.keys(t)){const e=t[o];void 0!==e&&(Array.isArray(e)?n.append(o,e):n.set(o,e))}return n}function f(e,t,n){const o=t.userPropertiesOperations||{};n.logEvent(e,o,void 0,u(e,o))}async function g(e){const{userId:t,traits:n,spaceIds:o}=e,i=await d.getInstance();if(!i)return;i.setUserId((0,l.XR)(t));const r=m(i,n);o&&r.set("workspace",a.jj(o)),f("$identify_user",r,i)}async function h(e){const{traits:t}=e,n=await d.getInstance();if(!n)return;const o=new n.Identify;for(const i of t)"set"===i.operation?o.set(i.name,i.value):"setOnce"===i.operation&&o.setOnce(i.name,i.value);f("$identify_device",o,n)}async function v(){const e=await d.getInstance();null==e||e.setUserId(null)}async function b(e){const{spaceId:t,spaceData:n}=e;if(!t)return;const o=await d.getInstance();if(!o)return;const i=a.d9(n),r=Object.entries(i).filter((e=>{let[t,n]=e;return Array.isArray(n)}));r.forEach((e=>{let[t,n]=e;return delete i[t]}));var s=m(o,i);r.forEach((e=>{let[t,n]=e;return s=s.set(t,n)})),o.groupIdentify("workspace",t,s)}async function y(e){const t=await d.getInstance();t&&t.setDeviceId((0,l.XR)(e))}async function _(e){const{eventName:t,eventData:n,spaceId:o}=e,i=await d.getInstance();if(i)if(o){const e={workspace:o};i.logEventWithGroups(t,n,e,void 0,u(t,n,e))}else i.logEvent(t,n,void 0,u(t,n))}},12174:(e,t,n)=>{n.d(t,{DP:()=>h,KM:()=>m,LI:()=>w,TS:()=>v,XY:()=>y,YY:()=>I,_n:()=>x,b2:()=>_,dn:()=>S,g6:()=>i,l4:()=>b,nb:()=>C});var o=n(97880);const i={"search-vectors":["log-norm","min-max-norm","cohere-snippets"],"vector-search-vanilla-ltr":["on","force-disable"],"search-no-local-blending":["on"],"search-debug-only-no-recent-boosting":["on"],"search-clear-results-on-query-change":["on"],"search-shorten-inactive-timer":["0","10","30","60","90"],"search-debug-only-force-random-sample":["on"],"search-debug-force-log-signals":["on"],"search-more-recent-pages-in-local":["lazy-100","lazy-200","lazy-500","lazy-1000"],"search-intent-based-grouping-n-side-peek":["on"],"search-results-new-utilities":["on"],"search-new-local-recall-v2":["v1","v2","v3","v4"],"search-query-expansion":["prefix-completion","word-splitting","spell-correction","all"],"search-debug-force-no-rerank":["on","always-rerank"],"search-client-page-match":["minisearch","minisearch-frecency"],"search-rerank-new-recall":["on"],"dev-search-rerank-new-recall":["v1","v2"]},r={teams_invite_link:["on"],team_invite_link_ms2:["on"],expandable_permission_items:["on"]},a={simplified_email_subject_line:["on"],improved_product_notif_email_and_settings:["on"],mobile_push_notification_reply_action:["on"],inbox_2_0:["on"],access_request_email_digest:["on"]},s={new_page_suggested_templates:["variant_1","variant_2","variant_3","variant_4"],search_modal_suggested_templates:["on"],acquisition_global_holdout_aa_testing:["on"],acq_simplify_enterprise_joiner_onboarding_flow_v1:["on"],page_invite_message:["control","variant_1","variant_2"],invitation_email_final_reminder:["on"],share_modal_placeholder:["on"],share_modal_pending_invite_status_ui:["on"],invitation_modal_guest_vs_member_tag:["on"],invite_email_quotes:["on"],share_modal_guest_member_confirmation:["v1","v2"],page_invitation_email_selfserve_exp:["v1","v2","v3","v4"],space_invitation_email_selfserve_exp:["v1","v2","v3","v4"],share_modal_autofill_email:["control","v1"],humanize_page_invite_joiner_email_copy:["on"],persona_template_truncation:["on"],acq_person_property_invite_v1:["on"],acq_slack_imports_invite_v1:["on"],rename_general_teamspace:["on"],team_land_getting_started:["on"],sidebar_tour:["on"],acq_display_admin_invite_request_v1:["on"],blue_signup_buttons:["on"]},l={in_app_contact_sales_cta_billing:["on"]},c={block_limit_cta_earlier:["25"],block_limit_increase:["on"],block_limit_reduction:["on"],checkout_name_required:["on"],checkout_refresh:["on"],churn_nudge:["on"],largesse:["on"],plans_page_refresh:["on"],mobile_web_subscriptions:["on"],quick_workspace_creation:["on"],sidebar_upgrade_nudge:["on"],subscription_payment_status:["message_only","on"],subscription_default_annual:["on"],subscription_elements:["payment_and_address","payment"],tt_me_pregunto:["on"],tt_pp:["on"],upsell_colors:["on"],upsell_to_plans_page:["on"]},d={csv_adaptiveschema:["on"],csv_column_limit:["on"]},u={duplication_workspace_selection_modal2:["on"]},p={public_site_topbar_cta:["on_marketing","on_signup"]},m=["beta","development","exploratory","wild_west"],f={assistant_variant:m,qna_answer_using:["anthropic-qa-alpha","anthropic-1","openai-2","openai-5","openai-6","openai-7","openai-8"]},g={"indexeddb-transaction-timeout-v2":["on"],"product-page-length":["no-demo","short-scroll","shortest-scroll"],"remove-profile-photo-string":["on"],"heath-ceramics":["on"],csat:["on"],"template-checklist":["on"],mermaid:["on"],polyglot:["on"],rc:["on"],"ios-json-bridge-v2":["on"],"clear-record-cache-on-login":["on"],"await-update-user-id":["on"],aloha:["on"],"multi-select-new-page-view-block-layout":["on"],"embed-previews":["on"],"beta-developers-external":["on"],"db-sync":["on"],janus:["on"],"mobile-drag-delay":["1000","600","700","800","900","1100","1200","1300","1400","1500"],"android-context-menu":["on"],"mobile-bottom-bar-ios-v4":["on"],"lucy-in-the-sky-with-tab-blocks":["on"],"messagestore-ios-v3":["on"],"home-ios":["on"],"home-ipad":["on"],"home-android":["on"],"txnqueue-ios-v6":["on"],"onboarding-emails":["generic","meeting-notes-focused"],patchExternalCollection:["on"],"emoji-apple-spritesheets":["enabled"],"default-new-page-property-to-hide-when-empty":["on"],"android-background-bridge-message-parsing":["on"],"columns-full-width":["on"],"notion-to-slack":["on"],"notion-mentions-to-slack":["on"],slash_menu_spaces_preceding:["on"],geo_ip_lookup_database:["on"],database_sync_for_google_calendar:["on"],database_sync_for_gitlab:["on"],database_sync_for_asana:["on"],enforce_enterprise_tier_for_scim:["on"],collections_workspace_client_mode:["on_200","on_500","on_1000"],...i,...r,...a,...s,...l,...c,...u,...d,...p,"newer-primus":["on"],sort_indexeddb_tasks_by_index:["on"],marketing_home_page_hero_signup:["test","focus","work"],marketing_home_hero_text:["V1","V2","V3"],above_the_fold_product:["V1","V2","V3","V4"],marketing_contact_3_new_fields:["test"],template_gallery_web:["on"],invite_members_from_share_menu:["on"],statsig_space_id_debug:["on"],enforce_write_once_permissions_for_block_updates:["on"],"contextual-invite-on-select-focus":["on"],integration_discovery:["top_left_sidebar","bottom_right_button"],zendesk:["on"],relations_sections:["on"],collection_table_drag_and_fill:["on"],collection_client_refetch_throttle_time_ms:["2000","3000","5000"],collections_loading_state:["on"],highlight_legacy_transclusions:["on"],lightbox_v2:["on"],user_similarity_debugging:["on"],log_iframely_results:["on"],iframely_switch:["on"],prompt_work_account_sidebar:["on"],request_membership:["on"],parallel_confluence_importer:["on"],parallel_confluence_importer_via_api:["on"],special_case_confluence_file_size:["on"],confluence_dynamic_batch_size_temp:["on"],confluence_server_allow_requests:["on"],confluence_logs:["on"],confluence_api_v2:["on"],confluence_search_api:["on"],send_notification_for_transfer_content:["on"],box_file_picker:["on"],guest_membership_request:["on"],link_preview_resizing:["on"],link_preview_resizing_api:["on"],google_external_integration_file_picker:["on"],enable_google_drive_external_integration:["on"],my_home:["on"],show_instruction_on_auth_popup_blocked:["on"],block_property_router:["on","on_v2"],teamspace_guests:["on"],asana_max_task_limit:["on"],better_asana_importer:["on"],monday_importer:["on"],generic_importer:["on"],special_case_generic_file_size:["on"],asana_to_single_team_space:["on"],learn_notion_three_steps:["on"],state_manangement_in_asana_importer:["on"],android_3rd_party_login_with_external_browser:["on"],ios_3rd_party_login_with_external_browser:["on"],block_limit_delay:["on"],asana_import_by_batch:["on"],intro_share_tooltip_condition:["d3","b200"],ignore_non_renderable_blocks_in_export:["on"],prioritize_slash_menu_block_placeholder:["on"],joiner_subject_line_v2:["variant_1","variant_2","variant_3"],joiner_email_facepile:["on"],slash_menu_tooltip:["on"],redirect_after_passcode_sent:["with_gmail_cta","without_gmail_cta"],wiki_education_convert_modal:["bottom_right"],avoid_empty_eoip_creation_unfurl_collection:["on"],jira_import_and_sync:["on"],block_property_item_indexing:["on"],block_property_item_query_prefilter:["on"],use_global_local_search_cache:["on"],...f,export_comments:["on"],safari_17_transaction_queue:["force_in_memory","prefer_indexed_db"],indexeddb_graceful_fallback_to_in_memory_queue:["on"],ai_writer_autofill_gpt_4:["on"],allow_auth_with_app_browser_for_mobile:["on"],show_qna_suggested_questions:["on"],property_creation_tooltips_exp:["on"],monetizationExperiments:["on"]};function h(e){return Boolean(g[e])}const v=new Set([]),b=["log_iframely_results","iframely_switch","database_sync_for_google_calendar","database_sync_for_gitlab","database_sync_for_asana","enforce_enterprise_tier_for_scim","slash_menu_spaces_preceding","geo_ip_lookup_database","sort_indexeddb_tasks_by_index","marketing_contact_3_new_fields","marketing_home_page_hero_signup","marketing_home_hero_text","above_the_fold_product","invite_members_from_share_menu","contextual-invite-on-select-focus","enforce_write_once_permissions_for_block_updates","integration_discovery",...(0,o.Yd)(r),"zendesk","highlight_legacy_transclusions","lightbox_v2","relations_sections","collection_table_drag_and_fill","prompt_work_account_sidebar","request_membership","special_case_confluence_file_size","special_case_generic_file_size","confluence_dynamic_batch_size_temp","confluence_server_allow_requests","confluence_logs","user_similarity_debugging","send_notification_for_transfer_content","box_file_picker","google_external_integration_file_picker","guest_membership_request","link_preview_resizing","link_preview_resizing_api","enable_google_drive_external_integration","show_instruction_on_auth_popup_blocked","parallel_confluence_importer","parallel_confluence_importer_via_api","confluence_api_v2","confluence_search_api",...(0,o.Yd)(i),...(0,o.Yd)(s),...(0,o.Yd)(l),"block_property_router",...(0,o.Yd)(c),...(0,o.Yd)(u),...(0,o.Yd)(d),...(0,o.Yd)(p),"teamspace_guests","asana_max_task_limit","better_asana_importer","monday_importer","generic_importer","asana_to_single_team_space","state_manangement_in_asana_importer",...(0,o.Yd)(a),"learn_notion_three_steps","android_3rd_party_login_with_external_browser","ios_3rd_party_login_with_external_browser","collection_client_refetch_throttle_time_ms","block_limit_delay","asana_import_by_batch","intro_share_tooltip_condition","ignore_non_renderable_blocks_in_export","prioritize_slash_menu_block_placeholder","joiner_subject_line_v2","joiner_email_facepile","slash_menu_tooltip","redirect_after_passcode_sent","wiki_education_convert_modal","avoid_empty_eoip_creation_unfurl_collection","collections_workspace_client_mode","collections_loading_state","jira_import_and_sync","block_property_item_indexing","block_property_item_query_prefilter","use_global_local_search_cache",...(0,o.Yd)(f),"export_comments","safari_17_transaction_queue","indexeddb_graceful_fallback_to_in_memory_queue","ai_writer_autofill_gpt_4","allow_auth_with_app_browser_for_mobile","show_qna_suggested_questions","property_creation_tooltips_exp"],y=[...b].sort(),_=["polyglot","enforce_write_once_permissions_for_space_updates","person_vote","allow_dead_space_views_when_joining_space","throw_on_changing_unmanaged_scim_user","log_all_headers_for_unknown_scim_idp","enable_get_private_page_info_endpoint","log_saml_response_on_error","wiki_query_killswitch","debug_analytics","connected_relation","enable_search_team_filter","expiring_public_links","enable_property_view_icons","enable_emoji_icon_color_picker","collection_dependencies","relation_left_properties","button_property","display_date_in_user_timezone","text_selection_completions","new_page_completions","completions_chat","database_sync_ugc","triage_notification_can_read","admin_content_search_tab","japan_full_launch","event_trail_router_v2","ai_waitlist_in_app_popup","model-2-space","public_api_dev_mode","optimize_single_workspace","enabled_bev_default_audience_filter","sprig","ai_multi_level_undo","ai_favorites","settings_console_analytics","autoretry_file_uploads","audit_log_enterprise_cache_check","enable_secure_file_url_for_user","lock_on_scim_patch_group","jit_onboarding_improvements","prevent_saml_guest_login","saml_hide_onboarding_password","free_tier_sync_database","developer_integration_form_redesign","return_scim_errors_to_client","use_secure_file_url_for_audit_log","use_secure_file_url_for_space_export","use_secure_file_url_for_block_export","return_404_on_scim_get_for_user_not_in_workspace","client-performance-profiler","react_18_concurrent_rendering","customerio","dev_only_show_updates_filters","property_updates_notifications","enable_notifications_processor","sidebar_pages_hide_toggles","prefetch_spaces","sidebar_home_gate","sidebar_home_beta_gate","sidebar_home_beta_wave_3_gate","team_add_app_template_tooltip","new_share_menu_tooltip","optimize_fetch_user_content_emit","send_reminder_log_debugging","space_settings_people_section","tips_inapp_modal","slack_bot_connection_message_revamp","relation_menu_refactor","collections_relation_picker_require_edit_perms","typed_db_creation","proj_management_sprints_upgrade","proj_management_tooltip_tour","unique_id","formulas_dark_read","db_view_scrolling_refactor","sync_collection_relation_as_admin","typed_db_migration","collections_bulk_relation_sync_queue_enabled","property_descriptions","collection_subitem_nested_operations","collection_level_subitems_setting","collections_shorten_url","collection_sqlite","webhooks_beta","public_api_developer_survey","e_discovery","add_comments_on_blocks","install_dlp_integrations","public_api_use_secure_file_proxy","webhooks_enable_nightfall","inactive_webhook_subscription_ui","advanced_security_in_enterprise","deny_multiplayer_personal_plan_upgrade","enable_midterm_subscription_changes","estudiantes","test_clocks","tt_mm_ent","upgrade_modal_ai_option","android_native_blocks","use_mp2_update_subscription_path","can_remove_plan_without_removing_addon","hardcoded_payment_method_types","prices_test_country","enable_new_creator_profile","template_submission_backend_v2","csv_schema_typed_merge","csv_validation_errors_fix","csv_relation_support","csv_twoway_relation_support","card_details_unified","trello_pagination_enabled","trello_media_queue","enable_text_crdt_server","enable_text_crdt_client","enable_default_create_crdt_page","automation_ui_unify","sites_published_settings","sites_multiple_domains","sites_banner","sites_admin_sort_sites_table","sites_search_engine_index_for_all","sites_scrollable_banner","block_attribution","space_consolidation_ga","desktop_app_login_with_email_redirect","ai_property_autofill_v2","desktop_app_signup_hide_passcode","ios_app_signup_hide_passcode","better_asana_import_task_dependency","user_data_consent_admin_bypass","goodbye_credits","link_preview_auth_with_server_integration","formulas_prototype","formula_buttons","ai_onboarding_logging","enable_deleted_page_indicator","onetrust_onboarding_checkbox","forethought","survey_data_writes","typed_db_improvements_property_restrictions","typed_db_improvements_announcement","enable_refetch_eoi_blocks_on_retry","adding_extra_logs_in_eoi_retry_fg","snapshot_optional_collection_rollback_enabled","prevent_login_with_temporary_password","saml_throw_on_temporary_password_use_case_mismatch","saml_enforced_disallow_send_temporary_password","audit_log_aes_event_read","audit_log_permanently_deleted_filter_enable","audit_log_event_name_column","guest_invite_requests","drawing_block","log_identify_cross_domain_device_ids","duplcate_template_tracking_serverside","disable_ai_big_red_button","ai_data_sharing","convert_cut_paste_to_move","page_title_in_reranker","text_align","enable_giphy_feature_gate","dependency_date_shifting_by_space","admin_content_search_only_search_titles","legacy_slack_notifications","overlay_trap_focus","mobile_better_filing_eligibility","server_dispatch_recents_background_fetch","client_handle_query_collection_locally","onetrust_onboarding_unsub_link","google_drive_connected_relation","figma_connected_relation","zendesk_connected_relation","cron_connected_relation","notion_calendar","notion_calendar_launch_modal","zendesk_ai_enabled","toggleable_transcript","use_assembly","transcript_feedback_button","space_for_ai_tooltip_enabled","log_page_exit_events_to_analytics","export_collections_v1","use_new_import_notification","use_new_export_notification","message_store_client_send_request_metric_enabled","template_gallery_web","response_size_instrumentation","append_favorites","collection_properties_select_auto_sort_options","collection_typed_db_duplication","support_synced_database_automations","template_contentful_sync_job","mobile_bridge_performance_logging","ai_source_picker","client_http_gzip","is_visibility_enabled_for_db_sync","disable_poll_jobs_for_collection_entities","export_new_structure","embed_block_fallback","automation_update_pages_batching","update_pages_action_batching","topbar_connection_indicator_v2","delete_kvs","force_kvs_break","add_ai_summary_button_transcript","enable_guest_export","animated_use_css_transition","perform_get_latest_activity_queries_sequentially","autofill_translate","scim_post_user_version_conflict","collections_view_specific_client_mode_enabled","autofill_tags","autotag_ambient_trigger","autotag_ambient_trigger_space","enable_vector_search_in_autotag","dark_fetch_autotag","typed_move_to_improved_search","typed_move_to_improved_default_results","first_party_links","search_index_collection_ranking_features","ios_enable_prefetching","mobile_browser_remove_bottom_padding_hack","hide_orphan_blocks","restore_private_pages","wiki_perf_improvement_local_enabled","show_keep_existing_guests_modal","export_content_analytics_stream","space_user_recovery_write","space_user_recovery_delete","export_admin_content_search_stream","export_puppeteer_upgrade","affiliates_s2s_routing","meeting_notes_transcript_consumer_setup","meeting_notes_transcript_new_consumer","meeting_notes_formatting_fix","enable_external_integration_auth_strict_access","student_form","native-find-in-page","assistant-labeler-mode","active_token_counter","vector_db_search","vector-search-live-indexing","embeddings-enabled-for-spaceid","qna-slack-workspaces","vector-spans-instead-of-load-page","qna_vector_search_reranker_using_decision_tree","people_profile_popup","collection_split_aggregation_v2","send_student_form_error_messages","recurrence_queue_task_improvements","enterprise_launch_modal","quick_search","search_toggle_side_peek","update_space_permissions_if_no_records","improved_asana_importer_screens","disable_storage_manager_estimate","recurring_sprints","toc_nested_headings","mention_menu_page_headings","use_new_undo_redo_behavior","inline_mention_invites","qna_nov_9_rollout","disable_qna_for_workspace","derived_property_sync_processor","organization_audit_logs","enable_transcript_tab","wiki_query_perf_improve_enabled","autofill_turbo_traffic","enable_admin_mode_authz","filter_dependencies","enable-cron-job-updateembeddingindexedflags","mobile_native_external_link_fix","browser_sqlite_v0","localized_parse_number","internal_communication_with_connections","qna_enable_reminders","inert_html_attribute","mint-device-id-cookie","remove_apostrophe_for_maps_url","last_sprint","student_form_v2","admin_console_enabled","settings_console_audit_log_enabled","page_view_block_refactor","enable_githubwh_auth_strict_access","use_hierarchy_in_zip_importer","cache_formulas2_filters","audit_log_guest_membership_request","qna_enable_suggested_questions_cron_job","is_evernote_authpopup_closing_fix_enabled","show_topbar_layout_info_button","enable_oauth_from_desktop_ux_v2","enable_public_content_scanning","reduce_create_email_user_return_gate","inactive_webhook_subscriptions","should_extract_media_from_html","dark_read_block_property_item"],S=[..._].sort(),w={event_trail_events:{},page_tree_query_strategy:{strategy:"postgres_recursion"},event_trail_routing:{},collection_request_settings:{clientFormulaTimeoutMs:3e5},sentry:{errorsSampleRate:0,"tracesSampleRate-v0":0,"replaysSessionSampleRate-v0":0,"replaysOnErrorSampleRate-v0":0,profilesSessionSampleRate:0,profilesSampleRate:0},gtm_ai_favorites:{space_id:void 0,collection_id:void 0},palette:{"sessionSampleRate-v4":0,pageLoadSampleIntervalMs:10,interactionSampleIntervalMs:10,maxBufferSize:1e5},permanently_delete_tree_queue_task_override:{queue_task_kill_switch_on:!1,task_delay_override_seconds:void 0,elastic_search_request_batch_size:200,s3_request_batch_size:200,redis_read_batch_size:1e4,tree_iteration_batch_size:1e4,tree_iteration_max_buffer_size:5e4,postgres_query_batch_size:1e5},load_test_simulator_configs:{commenter_interval_ms:1e3,page_viewer_interval_ms:100,editor_interval_ms:1e3,editor_typing_interval_ms:100,presence_interval_ms:1e3},education_free_submit_form_config:{},notion_people_block_id:{data:{}},template_ids_to_use_duplicate_block:{data:[]},csv_limits:{maxRelationPages:1e3,maxRows:1e5,maxColumns:500},model_overrides:{},slack_contacts_limit:{maxLimit:100,defaultLimit:100},automation_update_pages:{},assistant_error_message_override:{},inbox_2_0_shadow_traffic_testing:{getNotificationLogPassRate:0,getUserNotificationsPassRate:0},active_token_counter_config:{},text_crdt_config:{delete_merge_slice_tree_block_limit:100,crdt_page_banner_link:"https://dev.notion.so/notion/Conflict-Resolution-784929c697f54e1eb18d77ac782fc548"},default_create_crdt_page_config:{private:!1,collection_table_view:!1,collection_non_table_view:!1,collection_instantiate_template:!1,other:!1}},k=new Set(b);function I(e){return k.has(e)}function x(e){return g[e]}const C="_unassigned_"},64962:(e,t,n)=>{n.d(t,{O:()=>F});n(57658);var o=n(66897),i=n(15145),r=n(15070),a=n(90559),s=n(35011),l=n(80951),c=n(34299),d=n(56373),u=n(1800),p=n(40506),m=n(7057),f=n(53877),g=n(61075),h=n(64572),v=n(72126),b=n(25718),y=n(59753),_=n(63306),S=n(21202),w=n(77420),k=n(6287),I=n(19889),x=n(70203),C=n(7928),T=n(63143),M=n(4308);const P=m.ZV;function A(e){return(0,g.hJ)({...e,fromString:e=>e}).join("")}function R(e){const{textValue:t}=e;if(t){const n=[];for(const o of t)x.QJH(o)||n.push(A({...e,textValue:[o]}));return n.join(", ")}return""}const D={[x.GKr.Page]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToPage:o}=n,i=x.TOT(t),r=(0,g.Ho)({intl:n.intl,blockId:i,getRecordValue:n.getRecordValue,userTimeZone:n.userTimeZone}),a=o({toPageId:i});if(r&&a)return`${r} (${a})`},[x.GKr.Comment]:e=>{let{annotation:t,exportArgs:n}=e;const{getRecordValue:o,baseUrl:r}=n,a=y.om.fromGetRecordValueFn(o),s=x.$WM(t);if(!s)return;const l=a(s);if(!l)return;const c=l.getParentId(),d=l.getParentPointer(),p=(0,_.el)((0,_.DW)(d,o));if(!p)return;const m=a(d);let f;if(m){const e=a(m.getParentPointer());f=e&&"table_row"===e.getType()?e.getParentId():m.getParentId()}return(0,u.Z)({pageId:p.id,scrollToBlockId:f,pageValue:p,baseUrl:r,discussionId:c,pageVisitSource:i.tY.Export})},[x.GKr.Link]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToFile:o,getExportedPathToPage:i,navigableBlockId:r,baseUrl:a,publicDomainName:s}=n,l=x.zW$(t),c=(0,h.A5)({url:l,baseUrl:a,publicDomainName:s});return c?i({toPageId:c}):o({fromBlockId:r,toFileURI:l})},[x.GKr.User]:e=>{let{annotation:t,exportArgs:n}=e;const{intl:o}=n,i=x.zEN(t),r=n.getRecordValue({table:I.KJ,id:i});if(r)return`@${(0,C.Nz)(o,r)}`},[x.GKr.Bot]:e=>{let{annotation:t,exportArgs:n}=e;const o=x._Rq(t),i=n.getRecordValue({table:w.cZ,id:o});if(i)return`@${(0,r.Mh)(i)}`},[x.GKr.Group]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,g.kF)({annotation:t,exportArgs:n});if(o)return o},[x.GKr.ExternalObjectInstance]:e=>{var t;let{annotation:n,exportArgs:o}=e;const i=x.frW(n);return null===(t=o.getRecordValue({table:S.iU,id:i,spaceId:o.root.spaceId}))||void 0===t||null===(t=t.format)||void 0===t?void 0:t.original_url},[x.GKr.Date]:e=>{let{annotation:t,exportArgs:n}=e;const{date_format:o,time_format:i,...r}=x.zyO(t);return`@${(0,m.ZV)({value:r,date_format:o,time_format:i,userTimeZone:n.userTimeZone,allowRelativeDates:!1,intl:n.intl})}`},[x.GKr.Equation]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,b.dx)(t),i=(0,b.wB)(t,n.getExportedPathToPage,n);return`${o}${x.xey(t)}${i}`},[x.GKr.Bold]:g.Hf,[x.GKr.Italic]:g.Hf,[x.GKr.Strike]:g.Hf,[x.GKr.Code]:g.Hf,[x.GKr.Highlight]:g.Hf,[x.GKr.Discussion]:g.Hf,[x.GKr.Underline]:g.Hf,[x.GKr.Inserted]:g.Hf,[x.GKr.Deleted]:g.Hf,[x.GKr.TemporaryComment]:g.Hf,[x.GKr.TemporaryCursor]:g.Hf,[x.GKr.TemporaryEquation]:g.Hf,[x.GKr.TemporaryPage]:g.Hf,[x.GKr.TemporaryInput]:g.Hf,[x.GKr.TemporarySelection]:g.Hf,[x.GKr.TemporaryFindHighlight]:g.Hf,[x.GKr.TemplateVariable]:g.Hf,[x.GKr.FormulaPageProperty]:g.Hf,[x.GKr.FormulaContextValue]:g.Hf,[x.GKr.FormulaError]:g.Hf,[x.GKr.Citation]:g.Hf},B=()=>{},E=()=>Promise.resolve(void 0),F={blockRenderers:{text:B,header:B,sub_header:B,sub_sub_header:B,quote:B,bulleted_list:B,toggle:B,to_do:B,numbered_list:B,code:B,page:B,image:B,video:B,embed:B,bookmark:B,file:B,tweet:B,maps:B,gist:B,framer:B,invision:B,mixpanel:B,drive:B,figma:B,loom:B,pdf:B,typeform:B,codepen:B,audio:B,divider:B,equation:B,collection_view:B,collection_view_page:B,column_list:B,column:B,factory:B,copy_indicator:B,breadcrumb:B,link_to_collection:B,link_to_page:B,table_of_contents:B,callout:B,whimsical:B,miro:B,abstract:B,sketch:B,excalidraw:B,replit:B,alias:B,transclusion_container:B,transclusion_reference:B,external_object_instance:B,table:B,table_row:B,tab:B,hex:B,deepnote:B,external_object_instance_page:B,button:B,ai_block:B,drawing:B,personal_home_page:B},asyncBlockRenderers:{text:E,header:E,sub_header:E,sub_sub_header:E,quote:E,bulleted_list:E,toggle:E,to_do:E,numbered_list:E,code:E,page:E,image:E,video:E,embed:E,bookmark:E,file:E,tweet:E,maps:E,gist:E,framer:E,invision:E,mixpanel:E,drive:E,figma:E,loom:E,pdf:E,typeform:E,codepen:E,audio:E,divider:E,equation:E,collection_view:E,collection_view_page:E,column_list:E,column:E,factory:E,copy_indicator:E,breadcrumb:E,link_to_collection:E,link_to_page:E,table_of_contents:E,callout:E,whimsical:E,miro:E,abstract:E,sketch:E,excalidraw:E,replit:E,alias:E,transclusion_container:E,transclusion_reference:E,external_object_instance:E,table:E,table_row:E,tab:E,hex:E,deepnote:E,external_object_instance_page:E,button:E,ai_block:E,drawing:E,personal_home_page:E},annotationRenderers:D,propertyRenderers:{title:e=>A(e),text:A,select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[];return l.Sj(t,o)},multi_select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[],i=l.uP(t,o);return i.sort(),i.join(", ")},status:e=>{const{textValue:t,propertySchema:n}=e;return l.ZG(t,n)},relation:e=>{const{textValue:t,propertySchema:n,exportArgs:o}=e;if("relation"!==n.type)return;const i=l.j$({relationValue:l.rq(t),getRecordModel:y.om.fromGetRecordValueFn(o.getRecordValue),propertySchema:n}),r=l.ow(i);return R({...e,textValue:r})},rollup:e=>{const t=e.exportArgs.getRecordValue,n=y.kk.fromValue(S.iU,e.block),o=y.om.fromGetRecordValueFn(t);return c.kJ({...e,block:n,getRecordModel:o,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:e.exportArgs.resultCache}})},url:e=>{let{textValue:t}=e;return l.zB(t)},email:e=>{let{textValue:t}=e;return l.zB(t)},phone_number:e=>{let{textValue:t}=e;return l.zB(t)},checkbox:e=>{let{textValue:t}=e;return l.Ml(t)?"Yes":"No"},person:e=>{let{textValue:t,exportArgs:n,propertySchema:o,block:i}=e;const{intl:r}=n,a=y.kk.fromBlock(i),s=l.DW({textValue:t,propertySchema:o,blockCreatorPointer:a.getCreatedByPointer()});return v.oA(s.map((e=>{const t=n.getRecordValue(e),o=t&&y.kk.fromValue(e.table,t);return null==o?void 0:o.getDisplayName(r)}))).join(", ")},number:e=>{let{textValue:t}=e;const n=l.VY(t);if(void 0!==n)return n.toString()},date:e=>{let{textValue:t,propertySchema:n,...o}=e;const i=o.exportArgs.userTimeZone,r=l.Gl(t),{date_format:a,time_format:s}=n;if(r)return(0,m.ZV)({allowRelativeDates:!1,value:r,date_format:a,time_format:s,userTimeZone:i,intl:o.exportArgs.intl})},file:R,formula:e=>{const{property:t,schema:n,block:o,exportArgs:i}=e,{userTimeZone:r,getRecordValue:a,intl:l,resultCache:c}=i,d=(0,s.py)({schema:n,property:t,blockModel:y.kk.fromBlock(o),getRecordModel:y.om.fromGetRecordValueFn(a),intl:l,userTimeZone:r,depth:0,resultCache:c});return"boolean"==typeof d?d?"Yes":"No":(0,T.hj)(d)?d.toString():(0,p.U3)(d)?P({value:d,userTimeZone:r,allowRelativeDates:!1,intl:i.intl}):d},created_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.created_time)return P({allowRelativeDates:!1,value:(0,f.CQ)(t.created_time,o),userTimeZone:o,intl:n.intl})},last_edited_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.last_edited_time)return P({allowRelativeDates:!1,value:(0,f.CQ)(t.last_edited_time,o),userTimeZone:o,intl:n.intl})},created_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:i,intl:r}=n;if(t.created_by_table&&t.created_by_id){const e=(0,o.Hl)({getRecordValue:i,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,o.$4)(r,e)}},last_edited_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:i,intl:r}=n;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,o.Hl)({getRecordValue:i,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,o.$4)(r,e)}},button:e=>"",auto_increment_id:e=>{let{textValue:t,block:n,exportArgs:o}=e;const i=l.ah(t),{getRecordValue:r}=o;if(void 0!==i){const e=y.kk.fromBlock(n),t=e.getParentTable();if(t!==k.v)return;const o=r((0,d.We)({spaceId:e.getSpaceId(),parentTable:t,parentId:e.getParentId()}));return(0,a.wf)(null==o?void 0:o.record_key,i)}},last_visited_time:e=>"",location:e=>"",verification:e=>{let{textValue:t,exportArgs:n}=e;const o=l._w(t);if(!o)return"";const i=M.WN(o);return n.intl.formatMessage(M.A3(i.type))}}}},42509:(e,t,n)=>{n.d(t,{Ev:()=>l,Gq:()=>s,OY:()=>u,hD:()=>c});var o=n(21202),i=n(6287),r=n(97880);(0,r.AO)((e=>e&&e.parent_table===o.iU&&a(e)&&e.format&&e.format.original_url&&!e.format.is_placeholder?{true:e}:{false:e})),(0,r.AO)((e=>{var t,n;return e&&e.parent_table===o.iU&&a(e)&&e.format&&void 0===e.format.original_url&&null!==(t=e.format)&&void 0!==t&&t.external_object_id&&null!==(n=e.format)&&void 0!==n&&n.uri&&!e.format.is_placeholder?{true:e}:{false:e}}));const a=(0,r.AO)((e=>d(e)&&"external_object_instance"===e.type?{true:e}:{false:e})),s=((0,r.AO)((e=>d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,r.AO)((e=>e&&e.parent_table===i.v&&d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,r.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===o.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&e.format.external_object_id?{true:e}:{false:e}}))),l=(0,r.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===o.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&!e.format.external_object_id?{true:e}:{false:e}})),c=((0,r.AO)((e=>{var t;return!e||d(e)?{false:e}:e.parent_table===i.v&&null!==(t=e.format)&&void 0!==t&&t.external_object_id?{true:e}:{false:e}})),(0,r.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!=e&&null!==(t=e.format)&&void 0!==t&&t.original_url||null!=e&&null!==(n=e.format)&&void 0!==n&&n.external_object_id||u(e)||p(e)||m(e)?{true:e}:{false:e}}))),d=(0,r.AO)((e=>"type"in e&&e.type?{true:e}:{false:e})),u=((0,r.AO)((e=>void 0===e.format?{true:e}:{false:e})),(0,r.AO)((e=>{var t;return null!==(t=e.format)&&void 0!==t&&t.is_placeholder?{true:e}:{false:e}})),(0,r.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!==(t=e.format)&&void 0!==t&&t.is_placeholder&&null!==(n=e.format)&&void 0!==n&&n.integration_id?{true:e}:{false:e}}))),p=(0,r.AO)((e=>d(e)?{false:e}:e.parent_table===i.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&e.format.integration_id?{true:e}:{false:e})),m=(0,r.AO)((e=>d(e)?{false:e}:e.parent_table===i.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&void 0===e.format.integration_id?{true:e}:{false:e}))},76218:(e,t,n)=>{n.d(t,{A6:()=>d,Ck:()=>m,H0:()=>f,OH:()=>y,S3:()=>h,UB:()=>v,YD:()=>c,Zw:()=>b,iC:()=>u,qW:()=>g});n(57658);var o=n(76725),i=n(72126),r=n(6287),a=n(23867),s=n(70203),l=n(97880);function c(e){if(void 0!==e)return[p(e)]}function d(e){const t=e||[],n=[];for(const o of t){const e=(0,s.hDy)(o),t=(0,s.hH9)(e)||(0,s.V8Y)(e)||(0,s.sP4)(e)||(0,s.K9C)(e);t&&n.push(t);const i=(0,s.WiV)(o).split(",");for(const o of i){const e=o.trim(),t=e.indexOf('"'),i=e.lastIndexOf('"');if(t>=0&&i>=0){const o=e.slice(t+1,i);o.length>0&&n.push(o)}else"true"===e?n.push(!0):"false"===e&&n.push(!1)}}return n}function u(e){const t=i.mN(e,(e=>JSON.stringify(e)));if(0!==t.length)return(0,s.Zxt)([["["],...(0,o.Z)(t.map(p),(()=>[", "])),["]"]])}function p(e){return"string"==typeof e?[`"${e}"`]:"boolean"==typeof e?[`${e}`]:(0,s.YCD)(e)}function m(e,t){return e.filter((e=>JSON.stringify(e)!==JSON.stringify(t)))}function f(e,t,n){const o=g(e,t,n);if(o)return function(e){if("text"===e.type)return e;if("number"===e.type)return e;if("checkbox"===e.type)return e;if("date"===e.type)return e;if("block_array"===e.type)return{type:"array",of:{type:"block",collection:e.collection}};if("person_array"===e.type)return{type:"array",of:{type:"person"}};if("select"===e.type)return{type:"select",collection:e.collection,property:e.property};if("select_array"===e.type)return{type:"array",of:{type:"select",collection:e.collection,property:e.property}};(0,l.t1)(e)}(o)}function g(e,t,n){if("text"===n.type||"url"===n.type||"email"===n.type||"phone_number"===n.type||"title"===n.type)return{type:"text"};if("checkbox"===n.type)return{type:"checkbox"};if("multi_select"===n.type)return{type:"select_array",collection:e,property:t};if("select"===n.type||"status"===n.type)return{type:"select",collection:e,property:t};if("person"===n.type)return{type:"person_array"};if("number"===n.type||"auto_increment_id"===n.type)return{type:"number"};if("date"===n.type)return{type:"date"};if("relation"===n.type){if(n.collection_pointer)return{type:"block_array",collection:{table:r.v,id:n.collection_pointer.id,spaceId:(0,a.C)(n.collection_pointer.spaceId)}};if(n.collection_id)return{type:"block_array",collection:{table:r.v,id:n.collection_id,spaceId:e.spaceId}}}else{if("formula"===n.type||"rollup"===n.type||"last_edited_by"===n.type||"last_edited_time"===n.type||"button"===n.type||"created_time"===n.type||"created_by"===n.type||"file"===n.type||"location"===n.type||"verification"===n.type||"last_visited_time"===n.type)return;(0,l.t1)(n)}}function h(e){return"string"!=typeof e&&"boolean"!=typeof e}function v(e){return(e.value??[]).map((e=>{if(!(0,s.km_)(e))return;const t=(0,s.sP4)(e[1]);if(!t)return;return(0,s.vmO)(t).id})).filter(l.$K)}function b(e,t){return{...e,value:e.value?e.value.map((e=>{if(!(0,s.km_)(e))return e;const n=i.Xh(e);for(const o of n[1])(0,s.wjk)(o)&&(o[1].id=t(o[1].id));return n})):void 0}}async function y(e){const{value:t,context:n,executeFormula:o}=e,{returnType:i}=n,r=t.value;if("simple"===t.type){if("number"===i.type){const e=(0,s.QaF)(r),t=parseFloat(e);return isNaN(t)?{value:{type:"undefined"}}:{value:{type:"number",value:t}}}if("text"===i.type)return{value:{type:"text",value:r||[]}};if("checkbox"===i.type){return{value:{type:"checkbox",value:"true"===(0,s.QaF)(r)}}}return o(n,r)}return"formula"===t.type?o(n,r):(0,l.t1)(t.type)}},5773:(e,t,n)=>{n.d(t,{ZP:()=>c,jy:()=>d,xN:()=>l});n(57658);var o=n(80951),i=n(43593),r=n(70203),a=n(97880);const s=["source"];function l(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const c=[],p=[];if(e.properties){const i=Object.keys(e.properties);for(const m of i){const i=e.properties[m],f=i?o.g(i):void 0;if(l){const e=u(f,t,n,r,a);if(e&&e.length>0&&s.includes(m)){const t={pointer:l,path:["properties",m],command:"set",args:e};p.push(t)}}const g=d(f,[t,n],r,a);c.push(...g)}}if(e.format){const{page_cover:o,page_icon:s}=e.format;if(o){const e=(0,i.mV)(o,[t,n],r,a);e&&c.push(e)}if(s){const e=(0,i.mV)(s,[t,n],r,a);e&&c.push(e)}}return{files:c,operations:p}}function c(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const a=l(e,t,n,o,i,r);return a.files}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return void 0===e?[]:e.map((e=>(0,i.mV)(e.url,t,n,o))).filter(a.$K)}function u(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4?arguments[4]:void 0;if(void 0===e)return;const l=e.map((e=>(0,i.Wv)(e.url,t,n,o,s))).filter(a.$K);return l&&l.length>0?[r.V3y(l[0].link)]:void 0}},89789:(e,t,n)=>{n.d(t,{GR:()=>s,P_:()=>a});var o=n(66897),i=n(77420),r=n(19889);const a=(0,o.dp)(r.s$),s=((0,o.dp)(r.el),(0,o.dp)(r.T0));(0,o.dp)(r.fs),(0,o.D$)(i._H)},79317:(e,t,n)=>{n.d(t,{T1:()=>U,A6:()=>V,Wr:()=>Z,rb:()=>j});var o={};n.r(o),n.d(o,{derivePrimitiveOperations:()=>u,getAdditionalRelatedPointers:()=>p,invert:()=>m});var i={};n.r(i),n.d(i,{derivePrimitiveOperations:()=>h,getAdditionalRelatedPointers:()=>v,getOperationToAddChildBackToOldParent:()=>y,invert:()=>b});var r={};n.r(r),n.d(r,{derivePrimitiveOperations:()=>_,getAdditionalRelatedPointers:()=>S,invert:()=>w});var a={};n.r(a),n.d(a,{derivePrimitiveOperations:()=>R,getAdditionalRelatedPointers:()=>D,invert:()=>B});var s=n(90559),l=n(80951),c=n(38297),d=n(6287);function u(e,t){const{collectionId:n,spaceId:o}=e.args,i=t(e.pointer);if(!i)return[];if(i.is_template)return[];const r=(0,c.ky)({block:i,getRecordValue:t});if((null==r?void 0:r.id)===n){const i=(0,s.Y7)({spaceId:o,parentTable:d.v,parentId:n}),r=t(i),a=t({table:d.v,id:n,spaceId:o});if(a&&r&&r.alive)return(0,s.FT)(a).flatMap((t=>[{pointer:e.pointer,command:"set",path:["properties",t],args:(0,l.e7)(r.next_value)},{pointer:i,command:"set",path:["next_value"],args:r.next_value+1}]))}return[]}function p(e){const{collectionId:t,spaceId:n}=e.args;return[(0,s.Y7)({spaceId:n,parentTable:d.v,parentId:t})]}function m(e,t){return[]}n(21703),n(57658);var f=n(72126),g=n(73360);const h=function(e,t){const n=[];n.push({...e,command:"insertChildrenBefore"===e.command?"listBeforeMulti":"listAfterMulti",args:{...e.args}});const o=Z(e.pointer.table,e.path);if(!o)throw new Error(`Unsupported operation table and operation path ${JSON.stringify(e)} `);return e.args.ids.forEach((i=>{const r={id:i,table:o,spaceId:e.pointer.spaceId};n.push({command:"update",pointer:r,path:[],args:{parent_table:e.pointer.table,parent_id:e.pointer.id,alive:!0}});const a=t(r);if(a&&a.parent_id&&a.parent_table&&a.parent_id!==e.pointer.id){const e=V(a.parent_table,o);e?n.push({command:"listRemove",pointer:{id:a.parent_id,table:a.parent_table,spaceId:a.space_id},path:e,args:{id:a.id}}):function(e){if(!e)throw new Error("Assertion failed in insertChildrenOperationHelper")}(a.parent_table===d.v)}})),n},v=function(e){const t=Z(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.map((n=>({id:n,table:t,spaceId:e.pointer.spaceId})))},b=function(e,t){const n=Z(e.pointer.table,e.path);if(!n)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.flatMap((o=>{const i={id:o,table:n,spaceId:e.pointer.spaceId},r=t(i);if(r&&r.parent_table&&r.parent_id){if(V(r.parent_table,n)){const n=t({id:r.parent_id,table:r.parent_table,spaceId:r.space_id});if(n){const e=y(g.mk.create(r.parent_table,n),r.parent_table,i);return e?[e]:[]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}return[{command:"setParent",pointer:i,path:[],args:{parentId:r.parent_id,parentTable:r.parent_table}}]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}))},y=function(e,t,n){const o=V(e.table,n.table);if(!o)return{command:"setParent",pointer:n,path:[],args:{parentId:e.value.id,parentTable:t}};const i=f.U2(e.value,o);if(!i)return;const r=i.indexOf(n.id);if(-1===r)return;const a={id:e.value.id,table:t,spaceId:n.spaceId};if(0===r){return{command:"insertChildrenBefore",pointer:a,path:o,args:{ids:[n.id]}}}return{command:"insertChildrenAfter",pointer:a,path:o,args:{ids:[n.id],after:i[r-1]}}},_=function(e){const t=[];t.push({...e,command:"listRemove"});const n=Z(e.pointer.table,e.path);if(!n)throw new Error(`invalid operation ${JSON.stringify(e)}`);return t.push({command:"set",path:["alive"],args:!1,pointer:{table:n,spaceId:e.pointer.spaceId,id:e.args.id}}),t},S=function(e){const t=Z(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return[{id:e.args.id,table:t,spaceId:e.pointer.spaceId}]},w=function(e,t){const n=t(e.pointer);if(!n)return[];const o=Z(e.pointer.table,e.path);if(!o)throw new Error(`Invalid operation ${JSON.stringify(e)}`);const i=y(g.mk.create(e.pointer.table,n),e.pointer.table,{id:e.args.id,table:o,spaceId:e.pointer.spaceId});return i?[i]:[]};var k=n(98963),I=n(18844),x=n(21202),C=n(70279),T=n(33709),M=n(91644),P=n(15047),A=n(29369);const R=function(e,t){const n=[{command:"update",pointer:e.pointer,path:[],args:{parent_table:e.args.parentTable,parent_id:e.args.parentId,alive:!0}}],o=t(e.pointer);if(o&&o.parent_id&&o.parent_table){const t=V(o.parent_table,e.pointer.table);t&&n.push({command:"listRemove",pointer:{id:o.parent_id,table:o.parent_table,spaceId:o.space_id},path:t,args:{id:e.pointer.id}})}return n},D=function(e){return[]},B=function(e,t){const n=t(e.pointer);if(!n||!n.parent_id||!n.parent_table)return[{command:"set",pointer:e.pointer,path:["alive"],args:!1}];if(n.parent_id===e.args.parentId&&n.parent_table===e.args.parentTable)return[];const o=n.parent_table;if(V(o,e.pointer.table)){const o=t({id:n.parent_id,table:n.parent_table,spaceId:n.space_id});if(o){const t=y(g.mk.create(n.parent_table,o),n.parent_table,e.pointer);if(t)return[t]}return[]}return[{command:"setParent",pointer:e.pointer,path:[],args:{parentId:n.parent_id,parentTable:n.parent_table}}]},E={insertChildrenAfter:i,insertChildrenBefore:i,setParent:a,removeChild:r,assignAutoIncrementId:o},F={[x.iU]:[{childTable:x.iU,childPath:["content"]},{childTable:T.qF,childPath:["discussions"]}],[P.bx]:[{childTable:x.iU,childPath:["pages"]}],[T.qF]:[{childTable:C.x_,childPath:["comments"]}],[C.x_]:[{childTable:x.iU,childPath:["content"]}],[A.e0]:[{childTable:x.iU,childPath:["team_pages"]}],[k.cv]:[{childTable:I.Xj,childPath:["action_ids"]}],[I.Xj]:[{childTable:x.iU,childPath:["blocks"]}],[M.AT]:[]},Z=function(e,t){var n;const o=F[e];if(o)return null===(n=o.find((e=>{let{childPath:n}=e;return f.Xy(n,t)})))||void 0===n?void 0:n.childTable},V=function(e,t){var n;const o=F[e];if(o)return null===(n=o.find((e=>t===e.childTable)))||void 0===n?void 0:n.childPath},j=(e,t)=>E[e.command].invert(e,t),U=(e,t)=>E[e.command].derivePrimitiveOperations(e,t)},19531:(e,t,n)=>{n.d(t,{$O:()=>tt,KD:()=>se,xR:()=>nt,RE:()=>ot});n(57658),n(30541);var o=n(30120),i=n(41432),r=n(99036),a=n(80951),s=n(97531),l=n(9291),c=n(84795),d=n(68626),u=n(5773),p=n(59730),m=n(30845),f=n(72126),g=n(38737),h=n(482),v=n(21202),b=n(6287),y=n(13493),_=n(70203),S=n(63143);const w="PartialMatch",k="FullMatch",I="ColumnCategory",x=(0,l.defineMessages)({titleColumnName:{id:"database.titleColumn.name",defaultMessage:"Title"},genericColumnName:{id:"database.genericColumn.name",defaultMessage:"Column {columnNumber}"}});function C(e){const{table:t,intl:n,randomShortID:o,isPhoneNumber:i,useCsvAdaptiveSchema:s}=e,l=function(e,t,n,o){var i;let r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;const l=(e=e.filter((e=>e.some((e=>Boolean((e.text||"").trim())))))).length>0?e[0].length:0,c=e.map(((e,t)=>({row:e,rowIndex:t}))).filter((e=>{let{row:t}=e;return t.length!==l}));if(c.length>0){const e=c[0];throw new p.p8("CsvImportError",{data:{},clientData:{type:"csv_import_inconsistent_columns",messageValues:{numTitleColumns:l,numBadRows:c.length,firstBadRowIndex:e.rowIndex+1,firstBadRow:JSON.stringify(e.row.map((e=>e.text))),firstBadRowLength:e.row.length}}})}const d=null===(i=e[0])||void 0===i?void 0:i.length;null==s||s.set(I,H(d));let u=[];1===e.length?u=e[0].map(((e,n)=>t.formatMessage(x.genericColumnName,{columnNumber:n+1}))):e.length>1&&(u=e[0].map((e=>e.text)),e.shift());const m=e,g=q(o),h=f.oA(f.Ri(m).map((e=>e.length&&e[0].columnType?e[0].columnType:K(t,e.map((e=>null==e?void 0:e.text)),n,g,r,s)))),v=u.map((()=>!1));for(let a=0;a<u.length;a++)if("text"===h[a].schema.type)for(let e=0;e<m.length;e++){const t=m[e][a].textValue;if(t)for(const n of t)if(_.AJd(n)){v[a]=!0,e=m.length;break}}let b=!0;const y={title:{type:"title",name:t.formatMessage(x.titleColumnName)}};u.forEach(((e,t)=>{const o=h[t];if(o)if("text"===o.schema.type&&b&&!v[t]){b=!1,o.id="title",o.schema={type:"title",name:e};const t=y.title;t&&(t.name=e)}else{const t=n();o.id=t,y[t]={name:e,...o.schema}}}));const S=m.map((e=>{const t={};return h.forEach(((n,o)=>{if(n){const{id:i,schema:r,coerce:s}=n,{type:l}=r;if(i){const n=e[o]||"";t[i]="url"===l?a.iD(n.text):"date"===l?a.d7(s(n.text)):"text"===l?n.textValue||_.TPx(s(n.text)):"file"===l?n.textValue||[]:_.TPx(s(n.text))}}})),t}));return{schema:y,types:h,pages:S}}(t,n,o,i,s,e.csvEvalContext);return function(e){const{actor:t,blockType:n,rootId:o,parentId:i,parentTable:a,spaceId:s,name:l,format:c,ignoreBlockCount:d,randomID:p,pages:m,schema:g,columnIds:h,secureFileS3Url:S,secureFileS3UrlV2:w}=e,k=p(),I=p(),x=Date.now(),C=[],T={id:k,version:0,parent_table:v.iU,parent_id:o,space_id:s,name:_.TPx(l),schema:g,alive:!0,format:{collection_page_properties:f.oA(h.map((e=>{if(e)return{visible:!0,property:e}})))}};C.push({pointer:{table:b.v,id:k,spaceId:s},command:"set",path:[],args:T});const M={id:o,version:0,type:n,collection_id:k,format:{collection_pointer:{table:b.v,id:k,spaceId:s}},view_ids:[I],alive:!0,created_by_table:t.table,created_by_id:t.id,created_time:x,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:x,parent_id:i,parent_table:a,space_id:s};C.push({pointer:{table:v.iU,id:o,spaceId:s},command:"update",path:[],args:M});const P=function(e){const{actor:t,collectionId:n,spaceId:o,pages:i,ignoreBlockCount:r,secureFileS3Url:a,secureFileS3UrlV2:s,randomID:l}=e,c=Date.now();return i.map((e=>{const i=l(),d={id:i,version:0,parent_id:n,parent_table:b.v,space_id:o,type:"page",created_by_table:t.table,created_by_id:t.id,created_time:c,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:c,properties:e,...r?{ignore_block_count:!0}:void 0,alive:!0};if(a&&s){const e=(0,u.ZP)(d,a,s);e.length>0&&(d.file_ids=e.map((e=>e.id)))}return{id:i,operation:{pointer:{table:v.iU,id:i,spaceId:o},command:"set",path:[],args:d}}}))}({actor:t,collectionId:k,secureFileS3Url:S,secureFileS3UrlV2:w,spaceId:s,pages:m,ignoreBlockCount:d,randomID:p});P.forEach((e=>{let{operation:t}=e;return C.push(t)}));const A={id:I,version:0,type:"table",name:"Show All",parent_id:o,parent_table:"block",space_id:s,format:{table_properties:f.oA(h.map((e=>{if(e)return{visible:!0,property:e}}))),...c},page_sort:P.map((e=>e.id)).slice(0,r.gq),alive:!0};return C.push({pointer:{table:y.n,id:I,spaceId:s},command:"set",path:[],args:A}),{operations:C}}({...l,columnIds:l.types.map((e=>e.id)),...e})}const T=["yes","Yes","true","True","checked"],M=["no","No","false","False","unchecked"];function P(e){return T.some((t=>e===t))||M.some((t=>e===t))}function A(e,t){return e.length===t.length}function R(e,t){if(t.every(P))return{schema:{type:"checkbox"},validate:P,coerce:e=>T.some((t=>e===t))?r.bx:r.HC}}const D=function(e,t){const n=t.map(g._g),o=n[0];if(o&&n.every((e=>Boolean(e&&e.format===o.format))))return{schema:{type:"number",number_format:o.format},validate(e){const t=g._g(e);return!S.z4(t)&&t.format===o.format},coerce(e){const t=g._g(e);return`${t?t.value:void 0}`}}},B=function(e,t){if(parseInt(t)&&t.length<=6)return!1;const n=c.parseFreeformDateString(t,e);return Boolean(n)};function E(e,t){const n=t.filter((t=>B(e,t)));if(n.length>=t.length/2)return{schema:{type:"date"},validate:t=>B(e,t),coerce:t=>c.parseFreeformDateString(t,e),isFullMatch:A(t,n)}}const F=function(e){return e.length<320&&e.includes("@")&&m.B(e,"email")},Z=function(e,t){const n=t.filter(F);if(n.length>=t.length/2)return{schema:{type:"email"},validate:F,coerce:f.yR,isFullMatch:A(t,n)}},V=function(e){return e.length<320&&m.B(e,"url")},j=function(e,t){const n=t.filter(V);if(n.length>=t.length/2)return{schema:{type:"url"},validate:V,coerce:f.yR,isFullMatch:A(t,n)}},U=function(e,t){return!String(t).match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)&&e(String(t))},L=function(e,t,n){const o=U.bind(null,e),i=n.filter(o);if(i.length>=n.length/2)return{schema:{type:"phone_number"},validate:o,coerce:f.yR,isFullMatch:A(n,i)}},O=function(e,t,n){const o=[];t.forEach((e=>e.split(",").forEach((e=>o.push(e.trim())))));const i=new Set(o);if(a=i.size,s=o.length,l=t.length,s>l&&N(a,s)){return{schema:{type:"multi_select",options:Array.from(i).map(((e,t)=>({id:n(),value:e,color:(0,r.TL)([])})))},validate:e=>i.has(e),coerce:f.yR}}var a,s,l},N=function(e,t){return e>0&&e**2<t},z=function(e,t,n){const o=new Set(t);if(N(o.size,t.length)){return{schema:{type:"select",options:Array.from(o).map(((e,t)=>({id:n(),value:e,color:(0,r.TL)([])})))},validate:e=>o.has(e),coerce:f.yR}}},W=function(e,t){return{schema:{type:"text"},validate:f._z,coerce:f.yR}};function q(e){return[{test:L.bind(null,e),sampledSchemaIsComplete:!0},{test:D,sampledSchemaIsComplete:!0},{test:Z,sampledSchemaIsComplete:!0},{test:j,sampledSchemaIsComplete:!0},{test:E,sampledSchemaIsComplete:!0},{test:R,sampledSchemaIsComplete:!1},{test:O,sampledSchemaIsComplete:!1},{test:z,sampledSchemaIsComplete:!1},{test:W,sampledSchemaIsComplete:!0}]}const H=function(e){return e<50?"lessthan50":e<100?"lessthan100":e<500?"lessthan500":e<1e3?"lessthan1000":e<5e3?"lessthan5000":"greaterthan5000"},K=function(e,t,n,o,i,r){const a=t.filter((e=>Boolean(e)));if(0===a.length)return W();if(i)for(const s of o){const t=s.test(e,a,n);if(t){let e=t;if(!1===t.isFullMatch){d.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, setting data type as string",columnType:t.schema.type,matchType:"Partial"}}),e=W();const n=(null==r?void 0:r.get(w))||0;null==r||r.set(w,n+1)}else d.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Complete column type match detected",columnType:t.schema.type,matchType:"Full"}});const n=(null==r?void 0:r.get(k))||0;return null==r||r.set(k,n+1),e}}else{const t=a.filter((e=>!f.xb(e))).slice(0,100);for(const i of o){const o=i.test(e,t,n);if(o){const s=i.sampledSchemaIsComplete||t.length===a.length?o:i.test(e,a,n);if(s){if(!1===s.isFullMatch){d.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, Potential data loss due to parsing failures",columnType:s.schema.type,matchType:"Partial"}});const e=(null==r?void 0:r.get(w))||0;null==r||r.set(w,e+1)}else{const e=(null==r?void 0:r.get(k))||0;null==r||r.set(k,e+1)}return s}}}}return W()};var G=n(53877),$=n(95538),Q=n(15095),Y=n(7406),J=n(43593),X=n(19233),ee=n(4615),te=n(33709);const ne=n(60809),oe={a:!0,strong:!0,em:!0,code:!0,del:!0,s:!0,span:!0,time:!0},ie={meta:!0,style:!0,script:!0,head:!0,title:!0},re="sourceCode";function ae(e){if(!e)return;const t=parseInt(e);return isNaN(t)?void 0:t}const se={[_.GKr.Page]:"data-notion-page-id",spaceId:"data-notion-space-id",[_.GKr.Highlight]:"data-notion-highlight",[_.GKr.User]:"data-notion-user-id",[_.GKr.Discussion]:"data-notion-block-discussion-id",[_.GKr.Equation]:"data-notion-inline-equation",[i.Ti.code]:"data-notion-code-syntax",[i.Ti.callout]:"data-notion-callout",calloutIcon:"data-notion-callout-icon",calloutBackground:"data-notion-callout-background",[i.Ti.tableOfContents]:"data-notion-toc",[i.Ti.file]:"data-notion-file",fileAlias:"data-notion-file-alias",[i.Ti.columnList]:"data-notion-column-list",[i.Ti.column]:"data-notion-column-ratio",[i.Ti.video]:"data-notion-video",[i.Ti.audio]:"data-notion-audio",[i.Ti.pdf]:"data-notion-pdf",[i.Ti.equation]:"data-notion-equation",dateFormat:"data-notion-date-format"};function le(e,t){return t&&t.nodeType===e.Node.ELEMENT_NODE}const ce=function(e,t){return e.nodeType===t.Node.TEXT_NODE||e instanceof t.Element&&oe[e.tagName.toLowerCase()]},de=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.push(e);for(const n of Q.p4(e.childNodes))de(n,t);return t},ue=function(e){const t=[];if(!e.parentNode)return t;let n=e.parentNode;for(;n;)t.push(n),n=n.parentNode||void 0;return t};function pe(e,t){return ue(e).filter((e=>e instanceof t.Element&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase()))).length}const me=["â€¢","â—¦","â–ª"],fe=["h1","h2","h3","h4","h5","h6"].map((e=>`${e}:not(:first-child)`)).join(", "),ge=function(e){const{node:t,window:n,stripText:i,timeZone:r}=e;if(!i){for(const e of Array.from(t.querySelectorAll("p:not(:first-child)")))e.prepend("\n");for(const e of Array.from(t.querySelectorAll(fe)))e.prepend("\n");for(const e of Array.from(t.querySelectorAll("ul > li"))){const t=pe(e,n)-1,o=me[t%me.length],i="    ".repeat(t);e.prepend(`\n${i}${o} `)}for(const e of Array.from(t.querySelectorAll("ol"))){const t=pe(e,n),o="    ".repeat(t);for(let n=0;n<e.children.length;n+=1){e.children[n].prepend(`\n${o}${n+1}. `)}}for(const e of Array.from(t.querySelectorAll("pre")))e.parentNode&&e.parentNode.insertBefore(n.document.createTextNode("\n\n"),e)}const a=[],s=de(t).filter((e=>e.nodeType===n.Node.TEXT_NODE&&(!i||!/^( |\t)*(\n)+( |\t)*$/.test(e.data))));let l=!0;s.forEach(((e,c)=>{let d=e.data;i&&(d=d.replace(/\[ \] /g,""),d=d.replace(/\[x\] /g,""),d=d.replace(/^[\-\*\â€¢]\s?/g,""),d=d.replace(/(\s)+/g,"$1")),t.hasAttribute("confluenceTabSpaces")||0!==c||(d=d.trimStart()),c===s.length-1&&l&&(d=d.trimEnd());const u=[],p=ue(e);let m;!i&&p.some((e=>e instanceof n.Element&&("h1"===e.tagName.toLowerCase()||"h2"===e.tagName.toLowerCase()||"h3"===e.tagName.toLowerCase()||"h4"===e.tagName.toLowerCase()||"h5"===e.tagName.toLowerCase()||"h6"===e.tagName.toLowerCase())))&&u.push([_.GKr.Bold]),p.some((e=>e instanceof n.Element&&"strong"===e.tagName.toLowerCase()))&&u.push([_.GKr.Bold]),p.some((e=>e instanceof n.Element&&"em"===e.tagName.toLowerCase()))&&u.push([_.GKr.Italic]),p.some((e=>e instanceof n.Element&&"u"===e.tagName.toLowerCase()))&&u.push([_.GKr.Underline]),p.some((e=>e instanceof n.Element&&("code"===e.tagName.toLowerCase()||"pre"===e.tagName.toLowerCase())))&&u.push([_.GKr.Code]),p.some((e=>e instanceof n.Element&&("del"===e.tagName.toLowerCase()||"strike"===e.tagName.toLowerCase()||"s"===e.tagName.toLowerCase())))&&u.push([_.GKr.Strike]);const f=p.find((e=>{var t;return e instanceof n.Element&&(e.hasAttribute(se[_.GKr.Highlight])||(null===(t=e.parentElement)||void 0===t?void 0:t.hasAttribute(se[_.GKr.Highlight])))}));if(f&&f instanceof n.Element){var g;const e=f.getAttribute(se[_.GKr.Highlight]),t=null===(g=f.parentElement)||void 0===g?void 0:g.getAttribute(se[_.GKr.Highlight]),n=at(e&&"undefined"!==e?e||"":t||"");n&&u.push([_.GKr.Highlight,n])}const h=p.find((e=>e instanceof n.Element&&"a"===e.tagName.toLowerCase()));if(h){const e=h.getAttribute(se[_.GKr.Page]),t=h.getAttribute("notionUserId")||h.getAttribute(se[_.GKr.User]),n=h.getAttribute(se.spaceId),o=h.getAttribute(se[_.GKr.Comment]);"string"==typeof e&&(0,ee.e)(e)&&"string"==typeof n&&(0,ee.e)(n)?m=_.$0A(e,n):h.href?u.push(_.edl(h.href)):"string"==typeof t&&(0,ee.e)(t)?(m=_.tEo(t),h.getAttribute("notionUserId")&&c===s.length-2&&(l=!1)):o&&n&&(0,ee.e)(o)&&(0,ee.e)(n)&&(m=_.mfJ(o,n))}const v=p.find((e=>!!(e instanceof n.Element&&e.getAttribute(se[_.GKr.Discussion]))));if(v){const e=v.getAttribute(se[_.GKr.Discussion]);e&&u.push(_.jw(e))}const b=p.find((e=>e instanceof n.Element&&"sub"===e.tagName.toLowerCase()));let y;"true"===(null==b?void 0:b.getAttribute("confluenceProcessableEquation"))&&(y=`_{${b.textContent}}`);const S=p.find((e=>e instanceof n.Element&&"sup"===e.tagName.toLowerCase()));let w;"true"===(null==S?void 0:S.getAttribute("confluenceProcessableEquation"))&&(w=`^{${S.textContent}}`);const k=p.find((e=>e instanceof n.Element&&e.hasAttribute(se[_.GKr.Equation])));let I;null!=k&&k.textContent&&(I=k.textContent);const x=p.find((e=>e instanceof n.Element&&"time"===e.tagName.toLowerCase()));if(x){const e=x.getAttribute("datetime");if(e){const t={...function(e,t){const n=o.ou.fromISO(e),i=n.toMillis();return i===n.startOf("day").toMillis()?G.OQ.toPersistedDate(i,t):G.OQ.toPersistedDateTime(i,t)}(e,r)};"relative"===x.getAttribute(se.dateFormat)&&(t.date_format="relative"),m=_.pZr(t)}}m?a.push(_.YCD(m,u)):y?a.push(_.qZ6(y,u)):w?a.push(_.qZ6(w,u)):I?a.push(_.qZ6(I,u)):a.push(_.V3y(d,u))}));return _.Zdj(a,1e5)};const he=function(e){const t=["img[src]","a[download]",`a[${se[i.Ti.file]}]`,`audio[${se[i.Ti.audio]}]`,`video[${se[i.Ti.video]}]`],n=e.querySelectorAll(t.join(","));return Q.p4(n)};function ve(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:r,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g}=e;return Le({actor:t,parentId:n,parentTable:o,spaceId:i,nodes:he(r),allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g})}function be(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:r,type:a,allOperations:s,window:l,ignoreBlockCount:c,stripText:d,randomID:u}=e,p=u(),m={id:p,version:0,type:a,properties:{title:ge({node:r,window:l,stripText:d})},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!c||void 0};return s.push({pointer:{table:v.iU,id:p,spaceId:i},command:"set",path:[],args:m}),Ue({node:r,spaceId:i,blockId:p,allOperations:s}),p}function ye(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,tableData:s,allOperations:l,ignoreBlockCount:c,intl:d,secureFileS3Url:u,secureFileS3UrlV2:p,randomID:m,randomShortID:f,isPhoneNumber:g,tableType:b}=e,y=m();if("table"===b){const{operations:e}=function(e){const{actor:t,parentId:n,tableId:o,parentTable:r,spaceId:a,ignoreBlockCount:s,randomID:l,randomShortID:c,table:d}=e,u=Date.now(),p=[],m=d.length?d[0].map((e=>c())):[],f=d.map((e=>l()));p.push(h.op.set({pointer:{id:o,table:v.iU,spaceId:a},path:[],args:{id:o,version:0,type:i.Ti.table,content:f,format:{table_block_column_order:m},properties:{},parent_id:n,space_id:a,parent_table:r,created_by_table:t.table,created_by_id:t.id,created_time:u,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:u,alive:!0,ignore_block_count:!!s||void 0}}));const g=f.map(((e,n)=>{const r=S.m8(m.flatMap(((e,t)=>{var o;const i=null===(o=d[n])||void 0===o||null===(o=o[t])||void 0===o?void 0:o.textValue;return i?[[e,i]]:[]})));return h.op.set({pointer:{id:e,table:v.iU,spaceId:a},path:[],args:{id:e,version:0,type:i.Ti.tableRow,parent_id:o,parent_table:v.iU,alive:!0,space_id:a,properties:r,created_by_table:t.table,created_by_id:t.id,created_time:u,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:u}})}));return p.push(...g),{operations:p}}({actor:t,tableId:y,parentId:n,parentTable:o,spaceId:r,table:s,ignoreBlockCount:c,randomID:m,randomShortID:f});l.push(...e),Ue({node:a,spaceId:r,blockId:y,allOperations:l})}else if("collection"===b){const{operations:e}=C({actor:t,blockType:"collection_view",rootId:y,parentId:n,parentTable:o,spaceId:r,name:"",format:{table_wrap:!0},table:s,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:c,intl:d,randomID:m,randomShortID:f,isPhoneNumber:g});l.push(...e)}return y}function _e(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:i.Ti.divider,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:v.iU,id:c,spaceId:r},command:"set",path:[],args:d}),c}function Se(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,source:a,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,randomID:p,fallbackWidth:m}=e;let f;"image"===a.type&&a.width?f=Math.min(a.width,700):m&&(f=Math.min(m,700));const g=p(),h={id:g,version:0,type:i.Ti.image,properties:{source:_.TPx(a.url)},format:{block_width:f},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!d||void 0},b=(0,u.ZP)(h,l,c);return h.file_ids=b.map((e=>e.id)),s.push({pointer:{table:v.iU,id:g,spaceId:r},command:"set",path:[],args:h}),g}function we(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:r,sourceUrl:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=ae(r.getAttribute("height")),u=ae(r.getAttribute("width")),p=c();let m;try{m=new URL(a)}catch(g){m=a}const f={id:p,version:0,type:$.Dz({url:a,baseUrl:m instanceof URL?m.origin:m,publicDomainName:""}),properties:{source:_.TPx(a)},format:{block_width:u,block_height:d,block_full_width:!1,block_page_width:!(u||d),block_preserve_scale:!0},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:v.iU,id:p,spaceId:i},command:"set",path:[],args:f}),p}function ke(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,source:r,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,randomID:p}=e,m=p(),f=$.Dz({url:r.url,baseUrl:r.url,publicDomainName:""}),g={id:m,version:0,type:"embed"===f?"file":f,properties:{title:_.TPx((0,J.w2)(r.url)),source:a.iD(r.url)},format:{block_width:"image"===r.type&&r.width?Math.min(r.width,700):void 0},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!d||void 0},h=(0,u.ZP)(g,l,c);return g.file_ids=h.map((e=>e.id)),s.push({pointer:{table:v.iU,id:m,spaceId:i},command:"set",path:[],args:g}),m}function Ie(e){return"#text"===e.nodeName?e.textContent?e.textContent:"":Array.from(e.childNodes).map((e=>{const t=e.nodeName.toLowerCase();return"br"===t?"\n":"div"===t?`${Ie(e)}\n`:Ie(e)})).map((e=>e.split("\n").map((e=>e.trimRight())).join("\n"))).join("")}function xe(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=a.getAttribute(se.calloutBackground),_=y?at(y):void 0,S=a.getAttribute(se.calloutIcon),w=S&&S.match(ne())?S:void 0,{title:k,children:I}=function(e){const{node:t,window:n}=e,o=Q.p4(t.childNodes),[i,...r]=o;if(!i)return{title:[]};return(e=>t=>!!(le(e,t)&&t instanceof e.HTMLParagraphElement))(n)(i)?{title:ge({node:i,window:n,stripText:!1}),children:r}:ce(i,n)?{title:ge({node:t,window:n,stripText:!1}),children:void 0}:{title:[],children:o}}({node:a,window:c}),x=Array.isArray(I)?Le({actor:t,parentId:b,parentTable:v.iU,spaceId:r,nodes:I,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}):[],C={id:b,version:0,type:i.Ti.callout,content:x,properties:{title:k},format:{block_color:_,page_icon:w},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:r},command:"set",path:[],args:C}),Ue({node:a,spaceId:r,blockId:b,allOperations:s}),b}function Ce(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,importFileMap:a,node:s,allOperations:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:p,randomID:m}=e,f=s.getAttribute(se[i.Ti.file])||"",g=a[f]?a[f].url:f;let h=s.getAttribute(se.fileAlias)||"";!h&&g.lastIndexOf("/")>=0&&(h=g.substring(g.lastIndexOf("/")+1));const b=m(),y={alive:!0,created_by_id:t.id,created_by_table:t.table,created_time:Date.now(),id:b,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),parent_id:n,parent_table:o,space_id:r,properties:{source:_.TPx(g),title:_.TPx(h)},type:i.Ti.file,version:0,ignore_block_count:!!p||void 0},S=(0,u.ZP)(y,c,d);return y.file_ids=S.map((e=>e.id)),l.push({pointer:{table:v.iU,id:b,spaceId:r},command:"set",path:[],args:y}),b}const Te=/language-(\w+)/;function Me(e){let t=null;return null==e||e.forEach(((e,n,o)=>{if(t)return;if(X.Y.hasOwnProperty(e))return void(t=e);const i=e.match(Te);i&&i.length>1&&X.Y.hasOwnProperty(i[1])&&(t=i[1])})),t}function Pe(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=c();let u=a.getAttribute(se[i.Ti.code]);if(!u){var p;u=Me(null===(p=a.querySelector("code"))||void 0===p||null===(p=p.parentElement)||void 0===p?void 0:p.classList)}if(!u){var m;u=Me(null===(m=a.querySelector("code"))||void 0===m?void 0:m.classList)}const f=u&&X.Y[u]?X.Y[u]:"Plain Text",g={id:d,version:0,type:i.Ti.code,properties:{title:_.TPx(Ie(a)),language:_.TPx(f)},format:{code_wrap:!0},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:v.iU,id:d,spaceId:r},command:"set",path:[],args:g}),Ue({node:a,spaceId:r,blockId:d,allOperations:s}),d}function Ae(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=c(),u={id:d,version:0,type:i.Ti.equation,properties:{title:_.TPx(Ie(a))},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:v.iU,id:d,spaceId:r},command:"set",path:[],args:u}),d}function Re(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:i.Ti.tableOfContents,format:{block_color:"gray"},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:v.iU,id:c,spaceId:r},command:"set",path:[],args:d}),c}function De(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),[y,...S]=Q.p4(a.childNodes),w=Le({actor:t,parentId:b,parentTable:v.iU,spaceId:r,nodes:S,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}),k={id:b,version:0,type:i.Ti.quote,properties:{title:_.TPx(null!=y&&y.textContent?y.textContent.trim():"")},content:w,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:r},command:"set",path:[],args:k}),Ue({node:a,spaceId:r,blockId:b,allOperations:s}),b}function Be(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=a.querySelector("summary"),S=Q.p4(a.childNodes).filter((e=>e!==y)),w=y&&y.textContent&&ge({node:y,window:c,stripText:!1}),k=Le({actor:t,parentId:b,parentTable:v.iU,spaceId:r,nodes:S,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}),I={id:b,version:0,type:i.Ti.toggle,content:k,properties:{title:w||_.TPx("")},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:r},command:"set",path:[],args:I}),b}function Ee(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=Q.p4(a.children).filter((e=>e.hasAttribute(se[i.Ti.column]))).slice(0,8).map((e=>function(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=a.getAttribute(se[i.Ti.column]);let _;if(null!==y){const e=parseFloat(y);!Number.isNaN(e)&&e>0&&e<=1&&(_=e)}const S=Le({actor:t,parentId:b,parentTable:v.iU,spaceId:r,nodes:Q.p4(a.children),allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}),w={id:b,version:0,type:i.Ti.column,format:{column_ratio:_},content:S,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:r},command:"set",path:[],args:w}),b}({actor:t,parentId:b,parentTable:v.iU,spaceId:r,node:e,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}))),_={id:b,version:0,type:i.Ti.columnList,content:y,parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:r},command:"set",path:[],args:_}),b}const Fe=/^\[x\].*/,Ze=/^\[ \].*/,Ve=/^[-\*\â€¢].*/;function je(e){const{actor:t,parentId:n,parentTable:o,spaceId:a,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:f,randomID:g,randomShortID:h,isPhoneNumber:b}=e,y=g(),S=d.document.createElement("span"),w=[];Q.p4(s.childNodes).forEach(((e,t)=>{0===t&&Ke(e,d)?w.push(e):0===t&&!(We(e,d)||qe(e,d)||He(e,d))||ce(e,d)?(S.appendChild(e),e instanceof d.Element&&he(e).forEach((e=>w.push(e)))):w.push(e)}));const k=Le({actor:t,parentId:y,parentTable:"block",spaceId:a,nodes:w,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:f,randomID:g,randomShortID:h,isPhoneNumber:b}),I=Fe.test(S.textContent||""),x=Ze.test(S.textContent||"");let C;C=I||x?i.Ti.toDo:s.parentNode instanceof d.Element&&"ol"===s.parentNode.tagName.toLowerCase()?i.Ti.numberedList:i.Ti.bulletedList;let T=!1;C===i.Ti.toDo&&I&&(T=!0);const M={id:y,version:0,type:C,content:k,properties:{title:ge({node:S,window:d,stripText:!0}),checked:T?_.TPx(r.bx):void 0},parent_id:n,parent_table:o,space_id:a,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!m||void 0};return l.push({pointer:{table:v.iU,id:y,spaceId:a},command:"set",path:[],args:M}),Ue({node:S,spaceId:a,blockId:y,allOperations:l}),y}function Ue(e){const{node:t,spaceId:n,blockId:o,allOperations:i}=e,r=Array.from(t.querySelectorAll(`span[${se[_.GKr.Discussion]}]`));for(const a of r){const e=a.getAttribute(se[_.GKr.Discussion]);if(e){const t={id:e,parent_id:o,parent_table:v.iU,resolved:!1,context:[[a.innerHTML,[[_.GKr.Discussion,e]]]],space_id:n,version:0};i.push({pointer:{table:te.qF,id:e,spaceId:n},command:"set",path:[],args:t},{pointer:{table:v.iU,id:o,spaceId:n},command:"listAfter",path:["discussions"],args:{id:e}})}}}function Le(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,nodes:r,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:g,isPhoneNumber:h,htmlParserErrors:v}=e;return f.G0(...r.map((e=>Oe({actor:t,parentId:n,parentTable:o,spaceId:i,node:e,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:g,isPhoneNumber:h,htmlParserErrors:v}))))}function Oe(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b,htmlParserErrors:y}=e;if(s&&s instanceof d.Element){const e=s.tagName.toLowerCase();if("h1"===e)return[be({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.header,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h}),...ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("h2"===e)return[be({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.subHeader,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h}),...ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("hr"===e)return[_e({actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:l,ignoreBlockCount:m,randomID:h})];if("h"===e[0])return[be({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.subSubHeader,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h}),...ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("pre"===e||"code"===e||"div"===e&&s.className===re)return[Pe({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,ignoreBlockCount:m,randomID:h}),...ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if(s.hasAttribute(se[i.Ti.callout]))return[xe({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("blockquote"===e)return[De({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("details"===e)return[Be({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("table"===e){const{tableData:S,tableFiles:w}=function(e){const{node:t,window:n,importFileMap:o,intl:r}=e,s=[],l=[],c=Array.from(t.querySelectorAll("tr")).filter((e=>e.closest("table")===t));for(const d of c){const e=[],t=[],c=Array.from(d.querySelectorAll("td, th")).filter((e=>e.closest("tr")===d));for(const r of c){const a=(r.textContent||"").trim(),s=Ne(r.getAttribute("rowspan"),1);e.push({text:a,textValue:ge({node:r,window:n,stripText:!1}),rowSpan:s});const l=Ne(r.getAttribute("colspan"),1);for(let t=1;t<l;t++)e.push({text:"",rowSpan:s});const c=he(r);if(c.length){const e=f.oA(c.flatMap((e=>{var t;const n=e.getAttribute("src")||e.getAttribute(se[i.Ti.file])||e.getAttribute(se[i.Ti.audio])||e.getAttribute(se[i.Ti.video]),r=e.getAttribute(se.fileAlias);return n?{name:r||n,url:(null===(t=o[n])||void 0===t?void 0:t.url)||n}:void 0})));t.push(...e)}}e.length&&l.push(e);const u=a.CC(t);s.push({text:r.formatMessage({id:"htmlHelpers.table.fileColumnName",defaultMessage:"Files"}),textValue:u})}for(let i=0;i<l.length;i++){const e=l[i];for(let t=0;t<e.length;t++){const n=e[t].rowSpan;if(n>1)for(let e=1;e<n&&!(i+e>=l.length);e++){l[i+e].splice(t,0,{text:"",rowSpan:1})}}}return{tableData:l,tableFiles:s}}({node:s,window:d,importFileMap:c,intl:g});if(w.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length})))for(let e=0;e<S.length;e++)S[e].push({text:w[e].text,textValue:w[e].textValue,columnType:{schema:{type:"file"},validate:f._z,coerce:f.yR}});let k="table";if(w.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length}))&&(k="collection"),0===f.Ar(S).length)return[];try{return[ye({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,tableData:S,allOperations:l,ignoreBlockCount:m,secureFileS3Url:u,secureFileS3UrlV2:p,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b,tableType:k})]}catch(_){const t=(0,Y.tg)(_);if(!y||"CsvImportError"!==t.message)throw _;const n=y.get(e)||0;return y.set(e,n+1),[]}}if("div"===e&&s.hasAttribute(se[i.Ti.columnList]))return[Ee({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("nav"===e&&s.hasAttribute(se[i.Ti.tableOfContents]))return[Re({actor:t,parentId:n,parentTable:o,spaceId:r,allOperations:l,ignoreBlockCount:m,randomID:h}),...ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("ul"===e||"ol"===e)return f.G0(...f.UI(s.children,(e=>Oe({actor:t,parentId:n,parentTable:o,spaceId:r,node:e,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b}))));if("li"===e||Fe.test(s.textContent||"")||Ze.test(s.textContent||"")||Ve.test(s.textContent||""))return[je({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("img"===e){const e=s.getAttribute("src");if(e)return[Se({actor:t,parentId:n,parentTable:o,spaceId:r,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h,fallbackWidth:s instanceof d.HTMLImageElement?s.width:void 0})]}if("a"===e&&s.getAttribute(se[i.Ti.file]))return[Ce({actor:t,parentId:n,parentTable:o,spaceId:r,importFileMap:c,node:s,allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})];if("a"===e&&0===Q.p4(s.childNodes).length){const e=s.getAttribute("href");if(s.hasAttribute("download")&&e)return[ke({actor:t,parentId:n,parentTable:o,spaceId:r,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})]}if("video"===e){const e=s.querySelector("source");if(e){const i=e.getAttribute("src");if(i&&$.xL({url:i}))return[ke({actor:t,parentId:n,parentTable:o,spaceId:r,source:{type:"unknown",url:i},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})]}}if("audio"===e){const e=s.querySelector("source");if(e){const i=e.getAttribute("src");if(i&&$._c({url:i}))return[ke({actor:t,parentId:n,parentTable:o,spaceId:r,source:{type:"unknown",url:i},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})]}}if("iframe"===e){const e=s.getAttribute("src");if(e)return[we({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,sourceUrl:e,allOperations:l,ignoreBlockCount:m,randomID:h})]}return"p"===e&&s.getAttribute("confluenceNewLine")?[be({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.text,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h})]:s.hasAttribute(se[i.Ti.equation])?[Ae({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,ignoreBlockCount:m,randomID:h})]:[.../^\s*$/g.test(s.textContent||"")?[]:[be({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,type:i.Ti.text,allOperations:l,window:d,ignoreBlockCount:m,stripText:!1,randomID:h})],...ve({actor:t,parentId:n,parentTable:o,spaceId:r,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})]}return[]}function Ne(e,t){const n=null!==e?parseInt(e,10):t;return isFinite(n)?n:t}const ze=function(e){if(e&&-1!==e.indexOf("em"))return parseInt(e)},We=function(e,t){return e instanceof t.Element&&"img"===e.tagName.toLowerCase()},qe=function(e,t){return e instanceof t.Element&&"video"===e.tagName.toLowerCase()},He=function(e,t){return e instanceof t.Element&&"audio"===e.tagName.toLowerCase()},Ke=function(e,t){return e instanceof t.Element&&"a"===e.tagName.toLowerCase()&&e.hasAttribute(se[i.Ti.file])},Ge=function(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);for(let i=e.attributes.length-1;i>=0;--i){const t=e.attributes[i];o.setAttribute(t.name,t.value)}return e.parentNode&&e.parentNode.replaceChild(o,e),o},$e=function(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);e.appendChild(o)},Qe=function(e){const t=[];let n=e;for(;e.firstChild;){const o=e.firstChild;t.push(o),e.parentNode&&e.parentNode.insertBefore(o,n.nextSibling),n=o}const o=e.parentNode;return o&&(o.removeChild(e),o.normalize()),t};function Ye(e,t){!function(e,t){const n=Array.from(e.querySelectorAll("p"));for(const o of n){let e=o.firstChild,n=0;for(;e&&n<1e4;){let i=!1;if(e instanceof t.Element&&null!==e.textContent&&!e.textContent.trim()){const t=Array.from(e.querySelectorAll("br"));if(t.length>0){for(const n of t)o.insertBefore(n,e);i=!0}}const r=e.nextSibling;i&&o.removeChild(e),e=r,n+=1}}}(e,t);const n=Array.from(e.querySelectorAll("p"));for(let o=0;o<1e4;o++){const e=n.shift();if(!e||!e.parentNode)return;const o=e.querySelector("br");if(!o)continue;if(o.parentElement!==e)continue;const i=t.document.createElement("p");e.parentNode.insertBefore(i,e.nextSibling);let r=o.nextSibling;for(;r;){const e=r.nextSibling;i.appendChild(r),r=e}e.removeChild(o),n.unshift(i)}}function Je(e){const t=e.match(/^([0-9]+)px$/i);if(t)return parseInt(t[1])}const Xe=function(e){const{rootNode:t,window:n,isInlineContent:o,emojiData:i}=e;!function(e){const{rootNode:t,window:n,emojiData:{emojiByName:o}}=e,i=Array.from(t.querySelectorAll("img[data-stringify-emoji]"));for(const r of i){const e=r.getAttribute("data-stringify-emoji")||"",t=e.match(/^:(.+):$/);if(!t||!r.parentNode)continue;const i=o[t[1]]||e;r.parentNode.replaceChild(n.document.createTextNode(i),r)}}({rootNode:t,window:n,emojiData:i}),t.normalize(),Ye(t,n);const r=Q.p4(t.childNodes);for(;r.length>0;){let e=r.shift();if(e instanceof n.Element&&e.parentNode&&"google-sheets-html-origin"===e.tagName.toLowerCase()){const t=Q.p4(e.childNodes);for(const n of t)e.parentNode.insertBefore(n,e);r.unshift(...t),e.remove()}else if(e&&e.parentNode&&3===e.nodeType&&/^( |\t)*(\n)+( |\t)*$/.test(e.data))e.parentNode.removeChild(e);else if(e&&e instanceof n.Element&&e.parentNode&&ie[e.tagName.toLowerCase()])e.parentNode.removeChild(e);else{if(e instanceof n.HTMLElement){const t=(a=e.style.fontSize||void 0)&&-1!==a.indexOf("px")||a&&-1!==a.indexOf("pt")?parseInt(a):void 0,o=ze(e.style.fontSize||void 0);(t&&t>=24||o&&o>2)&&(e=Ge(e,"h1",n))}if(e instanceof n.HTMLElement&&("line-through"===e.style.textDecoration&&$e(e,"del",n),"italic"===e.style.fontStyle&&$e(e,"em",n),("bold"===e.style.fontWeight||e.style.fontWeight&&parseInt(e.style.fontWeight)>=500)&&$e(e,"strong",n)),e instanceof n.HTMLImageElement){const t=Je(e.style.width);!e.width&&t&&(e.width=t)}if(e instanceof n.HTMLElement&&("b"===e.tagName.toLowerCase()?e=Ge(e,"strong",n):"i"===e.tagName.toLowerCase()&&(e=Ge(e,"em",n))),e instanceof n.HTMLElement&&"strong"===e.tagName.toLowerCase()&&"normal"===e.style.fontWeight&&(e=Ge(e,"span",n)),e instanceof n.HTMLElement&&("section"===e.tagName.toLowerCase()||"article"===e.tagName.toLowerCase())&&(e=Ge(e,"div",n)),e instanceof n.HTMLElement&&"div"===e.tagName.toLowerCase()&&"inline"===e.style.display&&(e=Ge(e,"span",n)),e instanceof n.HTMLElement&&"input"===e.tagName.toLowerCase()&&"checkbox"===e.type){const t=e.checked,o=e.parentNode,i=n.document.createElement("span");i.textContent=`[${t?"x":" "}] `,o&&(o.insertBefore(i,e),o.removeChild(e)),r.push(i)}else{if(e instanceof n.HTMLElement&&"table"===e.tagName.toLowerCase()){const t=Array.from(e.querySelectorAll("tr")).map((e=>e.querySelectorAll("td, th")));if(t.every((e=>1===e.length))){const o=n.document.createDocumentFragment();for(const e of t){const t=e[0],i=t.childNodes.length;for(let e=0;e<i;e+=1){const n=t.childNodes[e];n&&(o.appendChild(n.cloneNode(!0)),r.push(n))}o.appendChild(n.document.createElement("hr"))}e.parentNode&&e.parentNode.replaceChild(o,e)}}if(e instanceof n.HTMLElement&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase())&&e.parentNode instanceof n.HTMLElement&&("ul"===e.parentNode.tagName.toLowerCase()||"ol"===e.parentNode.tagName.toLowerCase())&&e.previousSibling instanceof n.HTMLElement&&"li"===e.previousSibling.tagName.toLowerCase()&&e.previousSibling.appendChild(e),e instanceof n.Element&&(e.removeAttribute("style"),e.removeAttribute("dir")),e instanceof n.Element&&"span"===e.tagName.toLowerCase()){(e.hasAttribute(se[_.GKr.Highlight])||e.hasAttribute(se[_.GKr.Discussion])||e.hasAttribute(se[_.GKr.Equation])?Array.from(e.children):Qe(e)).forEach((e=>r.push(e)))}else if(e){Q.p4(e.childNodes).forEach((e=>r.push(e)))}}}}var a;for(Q.p4(t.childNodes).forEach((e=>r.push(e)));r.length>0;){const e=r.shift();if(e)if(et(e,n)&&f.yW(e.childNodes,(e=>e instanceof n.Element&&"h1"===e.tagName.toLowerCase()))){const t=n.document.createElement("h1");f.S6(e.childNodes,(e=>{f.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const i=n.document.createElement(e.tagName.toLowerCase());i.appendChild(t),o.insertBefore(i,e)}else o.insertBefore(t,e);o.removeChild(e)}r.push(t)}else if(et(e,n)&&f.yW(e.childNodes,(e=>e instanceof n.Element&&"h2"===e.tagName.toLowerCase()))){const t=n.document.createElement("h2");f.S6(e.childNodes,(e=>{f.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const i=n.document.createElement(e.tagName.toLowerCase());i.appendChild(t),o.insertBefore(i,e)}else o.insertBefore(t,e);o.removeChild(e)}r.push(t)}else if(e instanceof n.HTMLElement&&("div"===e.tagName.toLowerCase()||"span"===e.tagName.toLowerCase())&&e.parentNode&&0===e.childNodes.length)e.parentNode.removeChild(e);else if(!et(e,n)||"p"!==e.tagName.toLowerCase()&&"div"!==e.tagName.toLowerCase()&&"figure"!==e.tagName.toLowerCase()||!Q.p4(e.childNodes).some((e=>e instanceof n.Element&&("p"===e.tagName.toLowerCase()||"div"===e.tagName.toLowerCase()||"img"===e.tagName.toLowerCase()||"ul"===e.tagName.toLowerCase()||"table"===e.tagName.toLowerCase()||"hr"===e.tagName.toLowerCase()||"video"===e.tagName.toLowerCase())))){if(e&&e.childNodes){Q.p4(e.childNodes).forEach((e=>r.push(e)))}}else{Qe(e).forEach((e=>r.push(e)))}}t.normalize(),o||Q.p4(t.childNodes).forEach((e=>{if(3===e.nodeType){const o=n.document.createElement("p");t.insertBefore(o,e),o.appendChild(e)}}))};function et(e,t){return e instanceof t.Element&&(0!==e.childNodes.length&&!(e.hasAttribute(se[i.Ti.columnList])||e.hasAttribute(se[i.Ti.column])||e.hasAttribute(se[i.Ti.callout])))}function tt(e){const{actor:t,parentId:n,spaceId:o,parentTable:i,rootNode:r,importFileMap:a,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g,emojiData:h,htmlParserErrors:v,useCrdt:b}=e;Xe({rootNode:r,window:l,isInlineContent:!1,emojiData:h});const y=[],_=Le({actor:t,parentId:n,parentTable:i,spaceId:o,nodes:Q.p4(r.children),allOperations:y,importFileMap:a,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g,htmlParserErrors:v});return{allOperations:b?(0,s.Vt)(y):y,rootContentIds:_}}const nt=function(e){const{node:t,window:n,stripText:o,emojiData:i}=e;return Xe({rootNode:t,window:n,isInlineContent:!0,emojiData:i}),ge({node:t,window:n,stripText:o})};function ot(e){const{node:t,window:n,emojiData:o}=e;return Xe({rootNode:t,window:n,isInlineContent:!1,emojiData:o}),rt(t,n)}const it=new Set(["span","div","p"]);function rt(e,t){const n=e.tagName.toLowerCase();if(!it.has(n))return!0;if("div"===n&&(e.className===re||e.hasAttribute(se[i.Ti.columnList])))return!0;for(const o of Array.from(e.childNodes))if(le(t,o)&&rt(o,t))return!0;return!1}function at(e){if("default"===e||"gray"===e||"brown"===e||"orange"===e||"yellow"===e||"teal"===e||"blue"===e||"purple"===e||"pink"===e||"red"===e||"gray_background"===e||"brown_background"===e||"orange_background"===e||"yellow_background"===e||"teal_background"===e||"blue_background"===e||"purple_background"===e||"pink_background"===e||"red_background"===e)return e}},45208:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("abstract",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 16C0 3.199 3.199 0 16 0s16 3.199 16 16-3.199 16-16 16S0 28.801 0 16zm9.976 7.71a6.128 6.128 0 003.398 1.043 6.14 6.14 0 006.146-6.127 6.126 6.126 0 10-9.544 5.085zm11.521.79h3.004v-17H7.499v2.997h13.998V24.5zm-5-5.874a3.123 3.123 0 11-6.246 0 3.123 3.123 0 016.246 0z"})})},52897:(e,t,n)=>{n.d(t,{d:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("aiImproveWriting",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8.84082 0.982422C8.84082 0.524414 8.45801 0.134766 8 0.134766C7.54199 0.134766 7.15234 0.524414 7.15234 0.982422V3.06738C7.15234 3.52539 7.54199 3.9082 8 3.9082C8.45801 3.9082 8.84082 3.52539 8.84082 3.06738V0.982422ZM10.9463 3.9082C10.6318 4.22949 10.6318 4.77637 10.96 5.10449C11.2744 5.41895 11.8281 5.41895 12.1494 5.09082L13.5781 3.66211C13.8994 3.34766 13.8926 2.79395 13.5645 2.46582C13.25 2.14453 12.6963 2.1582 12.375 2.47949L10.9463 3.9082ZM3.84375 5.09082C4.16504 5.41895 4.71875 5.41895 5.0332 5.10449C5.36133 4.77637 5.36133 4.22949 5.04688 3.9082L3.625 2.47949C3.30371 2.1582 2.75 2.14453 2.43555 2.46582C2.10742 2.78711 2.10742 3.34082 2.42188 3.65527L3.84375 5.09082ZM13.3047 14.9277C13.7148 15.3447 14.4121 15.3379 14.8154 14.9277C15.2188 14.5107 15.2188 13.834 14.8154 13.417L8.32812 6.88184C7.91797 6.47168 7.2207 6.47168 6.81738 6.88184C6.40723 7.29883 6.41406 7.97559 6.81738 8.38574L13.3047 14.9277ZM0.931641 7.19629C0.473633 7.19629 0.0908203 7.5791 0.0908203 8.03711C0.0908203 8.49512 0.473633 8.87793 0.931641 8.87793H3.0166C3.47461 8.87793 3.86426 8.49512 3.86426 8.03711C3.86426 7.5791 3.47461 7.19629 3.0166 7.19629H0.931641ZM15.0615 8.87793C15.5195 8.87793 15.9092 8.49512 15.9092 8.03711C15.9092 7.5791 15.5195 7.19629 15.0615 7.19629H12.9834C12.5254 7.19629 12.1357 7.5791 12.1357 8.03711C12.1357 8.49512 12.5254 8.87793 12.9834 8.87793H15.0615ZM9.62695 10.1357L7.49414 7.99609C7.32324 7.83203 7.26172 7.62012 7.43262 7.45605C7.58301 7.30566 7.80176 7.36035 7.97266 7.53125L10.0918 9.65723L9.62695 10.1357ZM2.42188 12.3984C2.10059 12.7197 2.09375 13.2734 2.4082 13.5879C2.72949 13.916 3.2832 13.9229 3.60449 13.6084L5.0332 12.1797C5.35449 11.8584 5.36133 11.3115 5.04688 10.9902C4.72559 10.6689 4.17188 10.6621 3.85059 10.9766L2.42188 12.3984ZM8.84082 13.0137C8.84082 12.5557 8.45801 12.166 8 12.166C7.54199 12.166 7.15234 12.5557 7.15234 13.0137V15.0918C7.15234 15.5498 7.54199 15.9395 8 15.9395C8.45801 15.9395 8.84082 15.5498 8.84082 15.0918V13.0137Z"})})},9999:(e,t,n)=>{n.d(t,{J:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alias",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.1475 10.5869V3.72363C13.1475 3.25195 12.833 2.93066 12.3477 2.93066H5.48438C5.02637 2.93066 4.70508 3.27246 4.70508 3.67578C4.70508 4.07227 5.05371 4.40039 5.46387 4.40039H7.89746L10.8438 4.30469L9.59961 5.39844L3.08496 11.9199C2.92773 12.0771 2.8457 12.2686 2.8457 12.46C2.8457 12.8564 3.20801 13.2256 3.61816 13.2256C3.80957 13.2256 3.99414 13.1504 4.15137 12.9932L10.6729 6.47168L11.7803 5.22754L11.6641 8.05762V10.6074C11.6641 11.0176 11.9922 11.373 12.4023 11.373C12.8057 11.373 13.1475 11.0312 13.1475 10.5869Z"})})},82477:(e,t,n)=>{n.d(t,{L:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alignCenter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-8.736 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.656-1.905-1.922-1.905H5.704c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.843-.28-.843-.85V5.78c0-.568.298-.85.843-.85h4.452c.539 0 .843.282.843.85v4.44c0 .568-.304.85-.697.85H5.774z"})})},70622:(e,t,n)=>{n.d(t,{$:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alignLeft",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zM3.372 12.218H8.11c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H3.372c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H3.442z"})})},53376:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("alignRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-6.408 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H8.032c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H8.102z"})})},33907:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("arrowRight",{viewBox:"0 0 30 30",svg:(0,i.jsx)("polygon",{points:"1 14 25.188 14 16.594 5.406 18 4 29 15 18 26 16.594 24.594 25.188 16 1 16"})})},55631:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("arrowsOut",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M7.09101 20.6434C7.50813 20.2263 7.49239 19.6124 7.07527 19.1953L6.41418 18.5342L3.51009 15.9449L7.75998 16.0551L12.6237 16.0709C12.8992 16.0787 13.1353 15.9685 13.3242 15.7797C13.7728 15.3311 13.8121 14.7093 13.3714 14.2686C13.1589 14.0561 12.8992 13.938 12.6159 13.938L7.75998 13.9459L3.51009 14.0561L6.42205 11.4589L7.07527 10.8057C7.49239 10.3886 7.52387 9.77473 7.09888 9.34974C6.6739 8.92476 6.06002 8.9405 5.63503 9.36548L1.2671 13.7334C0.464339 14.5362 0.464339 15.4649 1.2671 16.2676L5.63503 20.6356C6.04428 21.0448 6.6739 21.0605 7.09101 20.6434ZM24.3739 20.6592L28.7418 16.2912C29.5446 15.4885 29.5524 14.5519 28.7497 13.7492L24.3818 9.38123C23.9725 8.97198 23.3429 8.95624 22.9179 9.38123C22.5087 9.79047 22.5165 10.4122 22.9336 10.8293L23.5947 11.4904L26.5067 14.0718L22.2489 13.9695L17.3931 13.9459C17.1176 13.938 16.8736 14.0561 16.6847 14.245C16.244 14.6857 16.1968 15.3153 16.6375 15.7561C16.85 15.9685 17.1176 16.0787 17.4009 16.0787L22.2489 16.0787L26.5067 15.9607L23.5947 18.5578L22.9336 19.2189C22.5165 19.636 22.485 20.2499 22.91 20.6749C23.335 21.0999 23.9568 21.0763 24.3739 20.6592Z"})})},12970:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("assistFindActionItems",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.15503 7.44971C4.80298 7.44971 6.16748 6.0918 6.16748 4.43726C6.16748 2.78271 4.80957 1.41821 3.15503 1.41821C1.4939 1.41821 0.135986 2.78271 0.135986 4.43726C0.135986 6.0918 1.4939 7.44971 3.15503 7.44971ZM2.79248 6.06543C2.63428 6.06543 2.50903 5.97974 2.40356 5.85449L1.66528 4.97778C1.58618 4.87891 1.55322 4.7998 1.55322 4.68774C1.55322 4.45044 1.7312 4.27246 1.95532 4.27246C2.10034 4.27246 2.18604 4.33179 2.28491 4.45044L2.78589 5.0437L3.95264 3.17822C4.05151 3.02002 4.17017 2.94751 4.32178 2.94751C4.55249 2.94751 4.74365 3.1189 4.74365 3.33643C4.74365 3.42871 4.71729 3.5144 4.64478 3.62646L3.18799 5.84131C3.0957 5.97974 2.95068 6.06543 2.79248 6.06543ZM8.47461 5.16235H15.1257C15.5278 5.16235 15.8574 4.84595 15.8574 4.43726C15.8574 4.03516 15.5278 3.71216 15.1257 3.71216H8.47461C8.07251 3.71216 7.74951 4.03516 7.74951 4.43726C7.74951 4.84595 8.07251 5.16235 8.47461 5.16235ZM3.15503 15.0566C4.80957 15.0566 6.16748 13.6921 6.16748 12.0376C6.16748 10.3831 4.80957 9.01855 3.15503 9.01855C1.4939 9.01855 0.135986 10.3831 0.135986 12.0376C0.135986 13.6921 1.4939 15.0566 3.15503 15.0566ZM3.15503 13.6592C2.27173 13.6592 1.53345 12.9209 1.53345 12.0376C1.53345 11.1543 2.27173 10.416 3.15503 10.416C4.03833 10.416 4.77661 11.1543 4.77661 12.0376C4.77661 12.9209 4.03833 13.6592 3.15503 13.6592ZM8.47461 12.7957H15.1257C15.5278 12.7957 15.8574 12.4727 15.8574 12.0706C15.8574 11.6685 15.5278 11.3455 15.1257 11.3455H8.47461C8.07251 11.3455 7.74951 11.6685 7.74951 12.0706C7.74951 12.4727 8.07251 12.7957 8.47461 12.7957Z"})})},12436:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("audio",{viewBox:"0 0 26 23",svg:(0,i.jsx)("path",{d:"M0 6.06667V16.4667H5.2L12.1333 22.5333V0L5.2 6.06667H0ZM4.33333 14.7333H1.73333V7.8H4.33333V14.7333ZM6.06667 7.61193L10.4 3.8194V18.7139L6.06667 14.9214V7.61193ZM19.0667 11.2667C19.0667 8.84433 17.6445 6.76087 15.5931 5.78847L14.586 7.24447C16.1928 7.87627 17.3333 9.43453 17.3333 11.2684C17.3333 13.1023 16.1928 14.6588 14.586 15.2923L15.5931 16.7483C17.6445 15.7725 19.0667 13.689 19.0667 11.2667ZM19.5607 0.0563333L18.5718 1.48287C21.9709 3.42247 24.2658 7.07373 24.2658 11.2667C24.2658 15.4596 21.9709 19.1109 18.5727 21.0505L19.5615 22.477C23.4087 20.2193 26 16.0507 26 11.2667C26 6.48267 23.4087 2.314 19.5607 0.0563333ZM22.5333 11.2667C22.5333 7.6648 20.5339 4.53093 17.5855 2.9094L16.5915 4.34547C19.0918 5.64547 20.8 8.25413 20.8 11.2649C20.8 14.2757 19.0901 16.8844 16.5915 18.1844L17.5855 19.6205C20.5339 18.0015 22.5333 14.8685 22.5333 11.2667Z"})})},83096:(e,t,n)=>{n.d(t,{Q:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("book",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M27,23V1H7C4.791,1,3,2.791,3,5v20c0,2.209,1.791,4,4,4h20v-2h-1v-4H27z M21,3v6l-1-1.333L19,9V3H21z M20,11l3,4V3h2v18H9V3 h8v12L20,11z M5,5c0-1.103,0.896-2,2-2v18c-0.729,0-1.411,0.195-2,0.537V5z M24,27H7c-1.104,0-2-0.896-2-2s0.896-2,2-2h17V27z"})})},49089:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("caption",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.87 8.975h6.74c1.119 0 1.775-.65 1.775-1.904V2.444c0-1.254-.656-1.904-1.922-1.904H2.871C1.605.54.949 1.19.949 2.444V7.07c0 1.254.656 1.904 1.922 1.904zm.07-1.148c-.544 0-.843-.282-.843-.85v-4.44c0-.568.299-.849.844-.849h6.451c.54 0 .844.281.844.85v4.44c0 .567-.305.849-.697.849H2.94zm-1.39 4.386h12.893a.604.604 0 00.608-.601.604.604 0 00-.608-.602H1.55a.598.598 0 00-.601.602c0 .335.266.601.601.601zm8.49 3.247H1.55a.598.598 0 01-.601-.601c0-.335.266-.602.601-.602h8.49c.336 0 .609.267.609.602a.604.604 0 01-.608.601z"})})},36591:(e,t,n)=>{n.d(t,{e:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("check",{viewBox:"0 0 14 14",svg:(0,i.jsx)("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})},22225:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("checkPartial",{viewBox:"0 0 14 14",svg:(0,i.jsx)("rect",{x:"1.75",y:"6.125",width:"10.5",height:"1.75"})})},72261:(e,t,n)=>{n.d(t,{v:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("checkboxCircle",{viewBox:"0 0 22 23",svg:(0,i.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"2"})})},65628:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("checkboxSquare",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"})})},42853:(e,t,n)=>{n.d(t,{i:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("chevronDown",{viewBox:"0 0 30 30",svg:(0,i.jsx)("polygon",{points:"15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "})})},17693:(e,t,n)=>{n.d(t,{A:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("chevronDownRoundedThick",{viewBox:"0 0 12 12",svg:(0,i.jsx)("path",{d:"M6.02734 8.80274C6.27148 8.80274 6.47168 8.71484 6.66211 8.51465L10.2803 4.82324C10.4268 4.67676 10.5 4.49609 10.5 4.28125C10.5 3.85156 10.1484 3.5 9.72363 3.5C9.50879 3.5 9.30859 3.58789 9.15234 3.74902L6.03223 6.9668L2.90722 3.74902C2.74609 3.58789 2.55078 3.5 2.33105 3.5C1.90137 3.5 1.55469 3.85156 1.55469 4.28125C1.55469 4.49609 1.62793 4.67676 1.77441 4.82324L5.39258 8.51465C5.58789 8.71973 5.78808 8.80274 6.02734 8.80274Z"})})},5257:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("chevronRight",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},53465:(e,t,n)=>{n.d(t,{X:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("clearInput",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.993 15.528a7.273 7.273 0 01-2.923-.593A7.633 7.633 0 012.653 13.3a7.797 7.797 0 01-1.633-2.417 7.273 7.273 0 01-.593-2.922c0-1.035.198-2.01.593-2.922A7.758 7.758 0 015.063.99 7.273 7.273 0 017.985.395a7.29 7.29 0 012.93.593 7.733 7.733 0 012.417 1.64 7.647 7.647 0 011.64 2.41c.396.914.594 1.888.594 2.923 0 1.035-.198 2.01-.593 2.922a7.735 7.735 0 01-4.058 4.05 7.272 7.272 0 01-2.922.594zM5.59 11.06c.2 0 .371-.066.513-.198L8 8.951l1.904 1.911a.675.675 0 00.498.198.667.667 0 00.491-.198.67.67 0 00.205-.49.64.64 0 00-.205-.491L8.981 7.969l1.92-1.911a.686.686 0 00.204-.491.646.646 0 00-.205-.484.646.646 0 00-.483-.205.67.67 0 00-.49.205L8 6.995 6.081 5.083a.696.696 0 00-.49-.19.682.682 0 00-.491.198.651.651 0 00-.198.49c0 .181.068.342.205.484l1.912 1.904-1.912 1.92a.646.646 0 00-.205.483c0 .19.066.354.198.49.136.132.3.198.49.198z"})})},19525:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("closeThick",{viewBox:"0 0 8 8",svg:(0,i.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},3124:(e,t,n)=>{n.d(t,{_:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("codeOnly",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M8.093 13.62c.458.123.875-.123 1.011-.58l3.364-11.533c.13-.43-.082-.855-.54-.978-.451-.123-.848.075-.998.581L7.58 12.595c-.137.465.041.895.513 1.025zM.115 7.064c0 .233.103.472.301.643l4.423 3.992c.362.328.848.322 1.148-.02.308-.342.267-.834-.082-1.149L2.077 7.064l3.828-3.472c.349-.315.39-.8.082-1.142-.3-.342-.786-.348-1.148-.02L.416 6.415a.879.879 0 00-.3.65zm19.763 0a.878.878 0 00-.3-.649L15.153 2.43c-.362-.328-.847-.322-1.148.02-.308.342-.267.827.082 1.142l3.828 3.472-3.828 3.466c-.349.315-.39.807-.082 1.149.3.341.786.348 1.148.02l4.423-3.992c.198-.17.3-.41.3-.643z"})})},5049:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("codePreviewOnly",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M2.608 11.906h1.21v1.032c0 1.463.766 2.215 2.243 2.215h9.33c1.477 0 2.243-.758 2.243-2.215V6.444c0-1.463-.766-2.221-2.242-2.221H14.12V3.197c0-1.463-.772-2.221-2.242-2.221h-9.27C1.132.976.366 1.734.366 3.197v6.494c0 1.457.766 2.215 2.242 2.215zm.082-1.34c-.635 0-.984-.328-.984-.99v-6.27c0-.662.349-.99.984-.99h9.106c.629 0 .984.328.984.99v.917H6.06c-1.476 0-2.242.758-2.242 2.221v4.122H2.69zm3.453 3.254c-.636 0-.985-.335-.985-.998V6.561c0-.664.349-.998.985-.998h9.167c.628 0 .984.334.984.998v6.261c0 .663-.356.998-.984.998H6.143zm2.713-1.77c0 .307.335.437.595.287l3.972-2.324a.372.372 0 00-.007-.643L9.451 7.046c-.26-.15-.595-.027-.595.287v4.717z"})})},43661:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("codepen",{viewBox:"0 0 40 40",svg:(0,i.jsx)("path",{d:"M39.9834,13.7071 C39.8236,12.6665 38.6647,12.1063 37.8655,11.586 C36.4269,10.6255 35.0283,9.70502 33.5897,8.74452 C30.1931,6.46334 26.7564,4.18216 23.3598,1.90098 C22.5606,1.38071 21.7613,0.820424 20.9621,0.300155 C20.4027,-0.100052 19.6434,-0.100052 19.044,0.300155 C16.7663,1.82094 14.4485,3.38175 12.1708,4.90253 L2.10066,11.626 C1.22152,12.1863 0.0626603,12.7466 0.0226996,13.9472 C-0.0172612,15.2679 0.0226996,16.6286 0.0226996,17.9493 L0.0226996,24.3526 C0.0226996,25.5132 -0.217065,26.8739 0.861875,27.5943 C3.41936,29.3552 6.01681,31.036 8.61426,32.7569 C11.8111,34.878 15.008,37.0391 18.2048,39.1602 C19.084,39.7606 19.9631,40.4009 21.0421,39.6805 C21.9611,39.0802 22.8403,38.4799 23.7594,37.8796 C27.3159,35.5184 30.8724,33.1171 34.4289,30.7559 L38.385,28.1145 C38.6248,27.9544 38.9045,27.7944 39.1443,27.5943 C39.7037,27.1941 39.9435,26.6338 39.9435,25.9534 L39.9435,14.9477 C39.9834,14.5075 40.0234,14.1073 39.9834,13.7071 C39.9834,13.7871 39.9834,13.6671 39.9834,13.7071 Z M21.7214,4.94255 L35.1882,13.9472 L29.194,17.9893 L21.7214,12.9867 L21.7214,4.94255 Z M18.2848,4.94255 L18.2848,12.9467 L10.8521,17.9493 L4.81799,13.9472 L18.2848,4.94255 Z M3.45932,17.1489 L7.73512,20.0304 L3.45932,22.9118 L3.45932,17.1489 Z M18.2848,35.1182 L4.81799,26.1135 L10.8121,22.0714 L18.2448,27.074 L18.2448,35.1182 L18.2848,35.1182 Z M20.0031,24.1125 L13.929,20.0304 L20.0031,15.9482 L26.0771,20.0304 L20.0031,24.1125 Z M21.7214,35.1182 L21.7214,27.114 L29.1541,22.1114 L35.1482,26.1535 L21.7214,35.1182 Z M36.5468,22.9118 L32.271,20.0304 L36.5868,17.1489 L36.5468,22.9118 Z"})})},35013:(e,t,n)=>{n.d(t,{i:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionBoard",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.39697 14.4634H13.5964C15.0532 14.4634 15.8311 13.6921 15.8311 12.2485V4.24609C15.8311 2.80249 15.0532 2.03125 13.5964 2.03125H2.39697C0.940186 2.03125 0.162354 2.7959 0.162354 4.24609V12.2485C0.162354 13.6987 0.940186 14.4634 2.39697 14.4634ZM2.52222 12.9934C1.94214 12.9934 1.63232 12.7034 1.63232 12.0969V4.39771C1.63232 3.79126 1.94214 3.50122 2.52222 3.50122H4.92822V12.9934H2.52222ZM6.34546 12.9934V3.50122H9.64795V12.9934H6.34546ZM13.4712 3.50122C14.0447 3.50122 14.3611 3.79126 14.3611 4.39771V12.0969C14.3611 12.7034 14.0447 12.9934 13.4712 12.9934H11.0652V3.50122H13.4712Z"})})},21321:(e,t,n)=>{n.d(t,{N:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionCalendar",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"})})},69628:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionGallery",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.0542 7.75952H5.96973C7.00464 7.75952 7.50562 7.25854 7.50562 6.19727V3.58691C7.50562 2.53223 7.00464 2.03125 5.96973 2.03125H2.0542C1.01929 2.03125 0.518311 2.53223 0.518311 3.58691V6.19727C0.518311 7.25854 1.01929 7.75952 2.0542 7.75952ZM10.0303 7.75952H13.9392C14.9741 7.75952 15.4751 7.25854 15.4751 6.19727V3.58691C15.4751 2.53223 14.9741 2.03125 13.9392 2.03125H10.0303C8.98877 2.03125 8.48779 2.53223 8.48779 3.58691V6.19727C8.48779 7.25854 8.98877 7.75952 10.0303 7.75952ZM2.06079 6.55322C1.83008 6.55322 1.71802 6.44116 1.71802 6.20386V3.58032C1.71802 3.34961 1.83008 3.23755 2.06079 3.23755H5.96313C6.18726 3.23755 6.30591 3.34961 6.30591 3.58032V6.20386C6.30591 6.44116 6.18726 6.55322 5.96313 6.55322H2.06079ZM10.0369 6.55322C9.79956 6.55322 9.69409 6.44116 9.69409 6.20386V3.58032C9.69409 3.34961 9.79956 3.23755 10.0369 3.23755H13.9392C14.1633 3.23755 14.2754 3.34961 14.2754 3.58032V6.20386C14.2754 6.44116 14.1633 6.55322 13.9392 6.55322H10.0369ZM2.0542 14.4634H5.96973C7.00464 14.4634 7.50562 13.969 7.50562 12.9077V10.2974C7.50562 9.24268 7.00464 8.7417 5.96973 8.7417H2.0542C1.01929 8.7417 0.518311 9.24268 0.518311 10.2974V12.9077C0.518311 13.969 1.01929 14.4634 2.0542 14.4634ZM10.0303 14.4634H13.9392C14.9741 14.4634 15.4751 13.969 15.4751 12.9077V10.2974C15.4751 9.24268 14.9741 8.7417 13.9392 8.7417H10.0303C8.98877 8.7417 8.48779 9.24268 8.48779 10.2974V12.9077C8.48779 13.969 8.98877 14.4634 10.0303 14.4634ZM2.06079 13.2637C1.83008 13.2637 1.71802 13.1516 1.71802 12.9143V10.2974C1.71802 10.0601 1.83008 9.94141 2.06079 9.94141H5.96313C6.18726 9.94141 6.30591 10.0601 6.30591 10.2974V12.9143C6.30591 13.1516 6.18726 13.2637 5.96313 13.2637H2.06079ZM10.0369 13.2637C9.79956 13.2637 9.69409 13.1516 9.69409 12.9143V10.2974C9.69409 10.0601 9.79956 9.94141 10.0369 9.94141H13.9392C14.1633 9.94141 14.2754 10.0601 14.2754 10.2974V12.9143C14.2754 13.1516 14.1633 13.2637 13.9392 13.2637H10.0369Z"})})},17948:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionList",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.08716 5.15576C2.64087 5.15576 3.08911 4.70752 3.08911 4.15381C3.08911 3.6001 2.64087 3.15186 2.08716 3.15186C1.53345 3.15186 1.08521 3.6001 1.08521 4.15381C1.08521 4.70752 1.53345 5.15576 2.08716 5.15576ZM5.29736 4.85254H14.2161C14.605 4.85254 14.9148 4.54272 14.9148 4.15381C14.9148 3.76489 14.605 3.45508 14.2161 3.45508H5.29736C4.90845 3.45508 4.59863 3.7583 4.59863 4.15381C4.59863 4.54272 4.90186 4.85254 5.29736 4.85254ZM2.08716 9.24927C2.64087 9.24927 3.08911 8.80103 3.08911 8.24731C3.08911 7.6936 2.64087 7.24536 2.08716 7.24536C1.53345 7.24536 1.08521 7.6936 1.08521 8.24731C1.08521 8.80103 1.53345 9.24927 2.08716 9.24927ZM5.29736 8.94604H14.2161C14.605 8.94604 14.9148 8.64282 14.9148 8.24731C14.9148 7.8584 14.605 7.54858 14.2161 7.54858H5.29736C4.90845 7.54858 4.59863 7.8584 4.59863 8.24731C4.59863 8.63623 4.90186 8.94604 5.29736 8.94604ZM2.08716 13.3428C2.64087 13.3428 3.08911 12.8945 3.08911 12.3408C3.08911 11.7937 2.64087 11.3389 2.08716 11.3389C1.53345 11.3389 1.08521 11.7937 1.08521 12.3408C1.08521 12.8945 1.53345 13.3428 2.08716 13.3428ZM5.29736 13.0396H14.2161C14.605 13.0396 14.9148 12.7363 14.9148 12.3408C14.9148 11.9519 14.605 11.6487 14.2161 11.6487H5.29736C4.90845 11.6487 4.59863 11.9519 4.59863 12.3408C4.59863 12.7297 4.90186 13.0396 5.29736 13.0396Z"})})},49019:(e,t,n)=>{n.d(t,{e:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionSearch",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M0 6.35938C0 9.86719 2.85156 12.7188 6.35938 12.7188C7.66406 12.7188 8.85938 12.3203 9.85938 11.6406L13.4531 15.2344C13.6719 15.4609 13.9766 15.5625 14.2812 15.5625C14.9453 15.5625 15.4219 15.0625 15.4219 14.4141C15.4219 14.1016 15.3125 13.8125 15.1016 13.5938L11.5312 10.0156C12.2734 8.99219 12.7188 7.72656 12.7188 6.35938C12.7188 2.85156 9.86719 0 6.35938 0C2.85156 0 0 2.85156 0 6.35938ZM1.65625 6.35938C1.65625 3.76562 3.75781 1.65625 6.35938 1.65625C8.95312 1.65625 11.0625 3.76562 11.0625 6.35938C11.0625 8.95312 8.95312 11.0625 6.35938 11.0625C3.75781 11.0625 1.65625 8.95312 1.65625 6.35938Z"})})},10405:(e,t,n)=>{n.d(t,{_:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("collectionTimeline",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5964 14.4634H2.39697C0.940186 14.4634 0.162354 13.6987 0.162354 12.2485V4.24609C0.162354 2.7959 0.940186 2.03125 2.39697 2.03125H13.5964C15.0532 2.03125 15.8311 2.80249 15.8311 4.24609V12.2485C15.8311 13.6921 15.0532 14.4634 13.5964 14.4634ZM1.63232 12.0969C1.63232 12.7034 1.94214 12.9934 2.52222 12.9934H13.4712C14.0447 12.9934 14.3611 12.7034 14.3611 12.0969V4.39771C14.3611 3.79126 14.0447 3.50122 13.4712 3.50122H2.52222C1.94214 3.50122 1.63232 3.79126 1.63232 4.39771V12.0969ZM8.92711 6.13826H2.71776C2.44986 6.13826 2.23645 5.91123 2.23645 5.64787C2.23645 5.37997 2.44986 5.15747 2.71776 5.15747H8.92711C9.19955 5.15747 9.40842 5.37542 9.40842 5.64787C9.40842 5.91577 9.19955 6.13826 8.92711 6.13826ZM11.3757 8.49036H4.75992C4.49201 8.49036 4.2786 8.26332 4.2786 7.99996C4.2786 7.73206 4.49201 7.50957 4.75992 7.50957H11.3757C11.6482 7.50957 11.857 7.72752 11.857 7.99996C11.857 8.26332 11.6482 8.49036 11.3757 8.49036ZM13.2822 10.8424H8.24608C7.97818 10.8424 7.76477 10.6109 7.76477 10.352C7.76477 10.0841 7.97818 9.85711 8.24608 9.85711H13.2822C13.5547 9.85711 13.7636 10.0796 13.7636 10.352C13.7636 10.6154 13.5547 10.8424 13.2822 10.8424Z"})})},70037:(e,t,n)=>{n.d(t,{h:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("commentAlert",{viewBox:"0 0 34 28",svg:(0,i.jsx)("path",{d:"M8.99023 25.3516C9.55957 25.3516 9.94629 25.1582 10.6338 24.5566L14.2324 21.3232C15.0059 22.1719 16.1768 22.6338 17.6699 22.6338H21.376L24.9639 25.7061C25.6191 26.2646 25.9736 26.5547 26.4893 26.5547C27.2305 26.5547 27.6494 26.0283 27.6494 25.2119V22.6338H28.1006C30.7969 22.6338 32.5908 21.001 32.5908 18.1973V11.8486C32.5908 9.03418 30.7969 7.40137 28.1006 7.40137H26.4141V6.58496C26.4141 3.67383 24.6846 1.97656 21.7627 1.97656H6.39062C3.58691 1.97656 1.73926 3.67383 1.73926 6.58496V16.4785C1.73926 19.4004 3.58691 21.0869 6.39062 21.0869H7.80859V24.0303C7.80859 24.8574 8.22754 25.3516 8.99023 25.3516ZM9.43066 20.3672C9.43066 19.7549 9.06543 19.4756 8.59277 19.4756H6.49805C4.59668 19.4756 3.46875 18.4336 3.46875 16.4355V6.64941C3.46875 4.65137 4.59668 3.59863 6.49805 3.59863H21.6553C23.5566 3.59863 24.6846 4.65137 24.6846 6.64941V7.40137H17.6699C14.8555 7.40137 13.1904 9.03418 13.1904 11.8486V18.1973C13.1904 18.7773 13.2549 19.3037 13.3945 19.7764L9.43066 23.4395V20.3672ZM26.0381 24.6104L22.5898 21.5166C22.1602 21.1406 21.9023 21.0117 21.3115 21.0117H17.7773C15.9834 21.0117 14.9092 20.0449 14.9092 18.1436L14.9199 11.9023C14.9199 10.0117 15.9834 9.02344 17.7773 9.02344H28.0039C29.7871 9.02344 30.8613 10.0117 30.8613 11.9023V18.1436C30.8613 20.0449 29.7871 21.0117 28.0039 21.0117H26.8652C26.4033 21.0117 26.0381 21.291 26.0381 21.8926V24.6104ZM22.9014 16.3389C23.3955 16.3389 23.6641 16.0596 23.6855 15.5225L23.8359 11.7734C23.8574 11.2148 23.4277 10.8174 22.8906 10.8174C22.3428 10.8174 21.9346 11.2041 21.9561 11.7627L22.0957 15.5225C22.1172 16.0488 22.3857 16.3389 22.9014 16.3389ZM22.8906 19.6045C23.4814 19.6045 23.9971 19.1318 23.9971 18.541C23.9971 17.9395 23.4922 17.4775 22.8906 17.4775C22.2891 17.4775 21.7842 17.9502 21.7842 18.541C21.7842 19.1318 22.2998 19.6045 22.8906 19.6045Z"})})},25654:(e,t,n)=>{n.d(t,{m:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("compass",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M18,4.361V3c0-1.657-1.343-3-3-3s-3,1.343-3,3v1.361C6.27,5.718,2,10.854,2,17c0,7.18,5.82,13,13,13s13-5.82,13-13 C28,10.854,23.73,5.718,18,4.361z M14,3c0-0.552,0.448-1,1-1s1,0.448,1,1v1.051C15.669,4.025,15.338,4,15,4s-0.669,0.025-1,0.051V3z M16,27.949V26h-2v1.949C8.724,27.474,4.526,23.276,4.051,18H6v-2H4.051C4.526,10.724,8.724,6.526,14,6.051V8h2V6.051 c5.276,0.476,9.474,4.673,9.949,9.949H24v2h1.949C25.474,23.276,21.276,27.474,16,27.949z M8,24l10-4l4-10l-10,4L8,24z M18.41,13.59 l-1.949,4.871L11.59,20.41l1.949-4.871L18.41,13.59z"})})},75553:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("copy",{viewBox:"0 0 14 16",svg:(0,i.jsx)("path",{d:"M2.404 15.322h5.701c1.26 0 1.887-.662 1.887-1.927V12.38h1.154c1.254 0 1.91-.662 1.91-1.928V5.555c0-.774-.158-1.266-.626-1.74L9.512.837C9.066.387 8.545.21 7.865.21H5.463c-1.254 0-1.91.662-1.91 1.928v1.084H2.404c-1.254 0-1.91.668-1.91 1.933v8.239c0 1.265.656 1.927 1.91 1.927zm7.588-6.62c0-.792-.1-1.161-.592-1.665L6.225 3.814c-.452-.462-.844-.58-1.5-.591V2.215c0-.533.28-.832.843-.832h2.38v2.883c0 .726.386 1.113 1.107 1.113h2.83v4.998c0 .539-.276.832-.844.832H9.992V8.701zm-.79-4.29c-.206 0-.288-.088-.288-.287V1.594l2.771 2.818H9.201zM2.503 14.15c-.563 0-.844-.293-.844-.832V5.232c0-.539.281-.837.85-.837h1.91v3.187c0 .85.416 1.26 1.26 1.26h3.14v4.476c0 .54-.28.832-.843.832H2.504zM5.79 7.816c-.24 0-.346-.105-.346-.345V4.547l3.223 3.27H5.791z"})})},86215:(e,t,n)=>{n.d(t,{u:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("cornerResize",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{fillRule:"evenodd",strokeWidth:"1.5",d:"M 14 0C 12.8955 0 12 0.895447 12 2L 12 12L 2 12C 0.895508 12 0 12.8954 0 14C 0 15.1046 0.895508 16 2 16L 14 16C 15.1045 16 16 15.1046 16 14L 16 2C 16 0.895447 15.1045 0 14 0Z"})})},42773:(e,t,n)=>{n.d(t,{$:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("dateInterval",{viewBox:"0 0 20 20",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M4.345 10.359l1.832 1.36c.191.146.378.182.56.11.183-.074.274-.226.274-.459v-.847H8.96a.52.52 0 00.54-.533.513.513 0 00-.157-.376.521.521 0 00-.383-.158H7.01V8.63c0-.246-.093-.4-.28-.465-.186-.068-.371-.034-.553.103L4.345 9.64a.43.43 0 00-.185.362c0 .146.062.264.185.356zm11.31 0l-1.832 1.36c-.191.146-.378.182-.56.11-.183-.074-.274-.226-.274-.459v-.847H11.04a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.146.052-.272.157-.376a.521.521 0 01.383-.158h1.95V8.63c0-.246.093-.4.28-.465.186-.068.371-.034.553.103l1.832 1.374a.43.43 0 01.185.362.423.423 0 01-.185.356zM3.378 15.16c.183 0 .33-.051.445-.16a.553.553 0 00.17-.42V5.449a.592.592 0 00-.17-.438.601.601 0 00-.445-.17.592.592 0 00-.437.17.592.592 0 00-.171.438v9.132c0 .173.057.31.17.42s.26.16.438.16zm13.24 0c.183 0 .33-.051.445-.16a.552.552 0 00.17-.42V5.447a.592.592 0 00-.17-.437.6.6 0 00-.445-.17.592.592 0 00-.437.17.593.593 0 00-.171.437v9.132c0 .173.057.31.17.42.115.11.26.16.438.16z"})})})},90827:(e,t,n)=>{n.d(t,{N:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("deepnote",{viewBox:"0 0 92 92",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,i.jsx)("path",{fill:"#0265B4",fillRule:"evenodd",d:"M20 73h22.153l12.461-4.673-4.673-18.346-14.365 1.558L20 73z",clipRule:"evenodd"}),(0,i.jsx)("path",{fill:"#002868",fillRule:"evenodd",d:"M42.153 73s7.004-3.695 8.3-10.242c1.296-6.546-5.1-11.22-14.876-11.22 0-.172 8.582-12.114 8.582-12.114l20.84.605-4.622 24.407-8.628 6.74L42.153 73z",clipRule:"evenodd"}),(0,i.jsx)("path",{fill:"#3793EF",fillRule:"evenodd",d:"M20 44.615l17.307-25.614s.424.004 1.385 0c6.784-.03 34.268 1.315 34.268 25.467 0 27.57-30.807 28.53-30.807 28.53s12.865-2.463 12.865-14.687-11.619-13.696-19.095-13.696H20z",clipRule:"evenodd"})]})})},56666:(e,t,n)=>{n.d(t,{o:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("dots",{viewBox:"0 0 13 3",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"}),(0,i.jsx)("path",{d:"M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"}),(0,i.jsx)("path",{d:"M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"})]})})},64330:(e,t,n)=>{n.d(t,{a:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("download",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8.215 15.126c3.862 0 7.061-3.192 7.061-7.062 0-3.862-3.199-7.061-7.068-7.061-3.862 0-7.055 3.2-7.055 7.061 0 3.87 3.2 7.062 7.062 7.062zm0-1.388a5.654 5.654 0 01-5.667-5.674 5.642 5.642 0 015.66-5.667 5.66 5.66 0 015.68 5.667 5.66 5.66 0 01-5.673 5.674zm0-9.174c-.342 0-.602.247-.602.588v3.234l.062 1.401-.622-.766-.766-.8a.557.557 0 00-.41-.177.54.54 0 00-.56.547c0 .164.054.3.163.41l2.256 2.283c.15.157.294.226.479.226.191 0 .335-.075.485-.226l2.256-2.283a.557.557 0 00.164-.41.539.539 0 00-.56-.547.523.523 0 00-.41.178l-.766.793-.622.779.054-1.408V5.152c0-.341-.253-.588-.601-.588z"})})},12217:(e,t,n)=>{n.d(t,{D:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("dragHandle",{viewBox:"0 0 10 10",svg:(0,i.jsx)("path",{d:"M3,2 C2.44771525,2 2,1.55228475 2,1 C2,0.44771525 2.44771525,0 3,0 C3.55228475,0 4,0.44771525 4,1 C4,1.55228475 3.55228475,2 3,2 Z M3,6 C2.44771525,6 2,5.55228475 2,5 C2,4.44771525 2.44771525,4 3,4 C3.55228475,4 4,4.44771525 4,5 C4,5.55228475 3.55228475,6 3,6 Z M3,10 C2.44771525,10 2,9.55228475 2,9 C2,8.44771525 2.44771525,8 3,8 C3.55228475,8 4,8.44771525 4,9 C4,9.55228475 3.55228475,10 3,10 Z M7,2 C6.44771525,2 6,1.55228475 6,1 C6,0.44771525 6.44771525,0 7,0 C7.55228475,0 8,0.44771525 8,1 C8,1.55228475 7.55228475,2 7,2 Z M7,6 C6.44771525,6 6,5.55228475 6,5 C6,4.44771525 6.44771525,4 7,4 C7.55228475,4 8,4.44771525 8,5 C8,5.55228475 7.55228475,6 7,6 Z M7,10 C6.44771525,10 6,9.55228475 6,9 C6,8.44771525 6.44771525,8 7,8 C7.55228475,8 8,8.44771525 8,9 C8,9.55228475 7.55228475,10 7,10 Z"})})},88437:(e,t,n)=>{n.d(t,{a:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("duplicate",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.83887 12.1523H4.00098V13.1846C4.00098 14.6406 4.75977 15.3994 6.24316 15.3994H13.1611C14.6377 15.3994 15.4033 14.6406 15.4033 13.1846V6.21191C15.4033 4.75586 14.6377 3.99707 13.1611 3.99707H11.999V2.96484C11.999 1.50879 11.2334 0.75 9.75684 0.75H2.83887C1.3623 0.75 0.59668 1.50195 0.59668 2.96484V9.93066C0.59668 11.3936 1.3623 12.1523 2.83887 12.1523ZM2.9209 10.8125C2.28516 10.8125 1.93652 10.4844 1.93652 9.82129V3.08105C1.93652 2.41797 2.28516 2.08301 2.9209 2.08301H9.68164C10.3105 2.08301 10.666 2.41797 10.666 3.08105V3.99707H6.24316C4.75977 3.99707 4.00098 4.75586 4.00098 6.21191V10.8125H2.9209ZM6.31836 14.0596C5.68262 14.0596 5.34082 13.7314 5.34082 13.0684V6.32812C5.34082 5.66504 5.68262 5.33691 6.31836 5.33691H13.0791C13.708 5.33691 14.0635 5.66504 14.0635 6.32812V13.0684C14.0635 13.7314 13.708 14.0596 13.0791 14.0596H6.31836Z"})})},75e3:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("enter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M5.38965 14.1667C5.81812 14.1667 6.10156 13.8767 6.10156 13.468C6.10156 13.2571 6.01587 13.0989 5.89062 12.967L4.18994 11.3125L3.02979 10.3369L4.55908 10.4028H12.7922C14.4402 10.4028 15.1389 9.65796 15.1389 8.04297V4.13403C15.1389 2.48608 14.4402 1.78735 12.7922 1.78735H9.13379C8.70532 1.78735 8.4021 2.11035 8.4021 2.50586C8.4021 2.90137 8.69873 3.22437 9.13379 3.22437H12.7593C13.4316 3.22437 13.7151 3.50781 13.7151 4.17358V7.99683C13.7151 8.67578 13.425 8.95923 12.7593 8.95923H4.55908L3.02979 9.03174L4.18994 8.04956L5.89062 6.39502C6.01587 6.26978 6.10156 6.11157 6.10156 5.89404C6.10156 5.48535 5.81812 5.19531 5.38965 5.19531C5.21167 5.19531 5.01392 5.27441 4.8689 5.41943L1.08521 9.1438C0.933594 9.28882 0.854492 9.48657 0.854492 9.68433C0.854492 9.87549 0.933594 10.0732 1.08521 10.2183L4.8689 13.9492C5.01392 14.0876 5.21167 14.1667 5.38965 14.1667Z"})})},56185:(e,t,n)=>{n.d(t,{F:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("excalidraw",{viewBox:"0 0 32 32",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"m14.2933 1.41174c-.8308.66246-2.1108 1.78526-3.1214 2.75088l-.7972.75228.146.98807c.0786.53895.2246 1.59439.3144 2.33544.101.74105.2021 1.43719.2358 1.53825.0449.13473 0 .2021-.1235.2021-.2134 0-.2246-.05614.3593 1.79654.2133.7073.4154 1.3586.4379 1.4259.0224.0786.1122.1123.2133.0786.1011-.0449.1572-.1347.1235-.2133-.0337-.0898.0225-.1797.1123-.2133.1235-.045.1123-.1348-.0786-.4604-.3032-.5053-1.0779-4.81685-1.1228-6.20913-.0337-.98807-.0337-.9993.3817-1.5607.4043-.55018 1.3362-1.38105 2.7734-2.43649.4042-.30316.8084-.64.9207-.75228.1684-.20211.247-.14597 1.6617 1.35859.8197.86456 1.7292 1.75158 2.0211 1.97614l.5389.40422-.4154.87579c-.2246.47157-1.134 2.29052-2.0323 4.01966-1.8751 3.6379-1.4933 3.2898-3.6716 3.3235l-1.4147.0112-.4716.539c-.494.5726-.5614.7859-.3256 1.1452.0898.1235.1572.3257.1572.4492 0 .2021.0786.2358.5277.2582.2807.0112.539.0449.5726.0786.0337.0337.0786.7298.1123 1.5495l.0449 1.4821-.7522 1.6168c-1.2464 2.6948-1.74039 3.9299-1.74039 4.3341 0 .2133.04491.3929.08982.3929.11227 0 .11227-.0112 4.68207-9.5438 2.1221-4.4239 4.132-8.5895 4.4688-9.27441.3369-.68491.64-1.31369.6625-1.40351.0224-.10105-.7523-.87579-1.9874-1.96491-1.1116-.98807-2.0884-1.88632-2.1782-1.98737-.2583-.314389-.64-.213336-1.325.33684zm.3818 12.91226c-.5165.9993-.539 1.0106-1.9537 1.0779-1.2463.0674-1.2688.0562-1.2688-.1796 0-.1348-.0449-.3144-.101-.4042-.0674-.1011-.0225-.2807.1347-.5278l.247-.3817h1.1228c.6176-.0112 1.325-.0562 1.572-.1011s.4603-.0673.4828-.0561c.0224.0112-.0898.2695-.2358.5726zm-.9432 1.7965c-.0898.2358-.3256.7298-.5165 1.1004-.3143.6287-.348.6512-.4266.393-.0449-.1572-.0786-.6176-.0898-1.033-.0113-.8197-.0337-.8084.9094-.8646l.3032-.0112z"}),(0,i.jsx)("path",{d:"m14.6302 4.08401c-.2021.14597-.2583.29193-.2583.66246 0 .43789.0337.50526.3369.62877s.3817.11228.7298-.12351c.4604-.31439.4716-.39298.1348-.89824-.292-.4379-.5839-.51649-.9432-.26948zm.64.40421c.1796.31439.0674.55018-.2695.55018-.3031 0-.4379-.30316-.2695-.60632.1348-.24701.393-.22456.539.05614z"}),(0,i.jsx)("path",{d:"m21.6702 6.61034c0 .05614-.0674.11228-.146.11228-.0674 0-.2582.31439-.4042.69614-.4491 1.16772-4.9404 10.04914-4.9516 9.76844 0-.146-.0673-.247-.1796-.247-.1572 0-.1797.0898-.1123.5277.0674.5053.0224.6175-1.5719 3.7165-.8983 1.7628-1.8639 3.6042-2.1446 4.0982-.2919.5165-.5165 1.0779-.5389 1.3137-.0337.4042.0112.4604.988 1.3025.5614.494 1.28 1.1115 1.5944 1.3922 1.4147 1.2913 2.0772 1.8078 2.2569 1.7741.2694-.0449 4.435-4.4127 4.4463-4.6597 0-.1122-.2021-1.8189-.4492-3.7951-.4266-3.3684-.8308-7.3094-.7859-7.6912.0337-.2358-.1348-1.4259-.2583-1.9424-.101-.4043-.0561-.5727.7523-2.4141.4716-1.0891 1.0891-2.42524 1.3586-2.96419.2583-.53894.4828-1.01052.4828-1.04421 0-.03368-.0786-.05614-.1684-.05614s-.1684.04492-.1684.11228zm-2.5825 8.38736c.1235.786.3705 2.6723.5502 4.1881.3481 2.7845.7523 5.8723.8646 6.6582.0673.393.0224.4716-.7074 1.28-1.2688 1.426-2.6162 2.8295-3.0765 3.1888l-.4267.3368-2.1894-2.0435c-2.0211-1.8638-2.1895-2.0547-2.066-2.2793.0674-.1235.64-1.1677 1.2688-2.3129.6287-1.1453 1.4596-2.6723 1.8414-3.3909.3929-.7299.7522-1.3586.8196-1.3923.0786-.0449.1011 1.0891.0786 3.5032-.0449 3.6042-.0337 3.6154.3256 3.5368.0449 0 .0786-1.819.0786-4.0309v-4.0196l1.179-2.3579c.6512-1.3025 1.1901-2.3467 1.2126-2.3355.0225.0113.1347.6737.247 1.4709z"})]})})},37240:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("expand",{viewBox:"-1 -1 9 11",svg:(0,i.jsx)("path",{id:"path0_stroke",d:"M 3.5 0L 3.98809 -0.569442L 3.5 -0.987808L 3.01191 -0.569442L 3.5 0ZM 3.5 9L 3.01191 9.56944L 3.5 9.98781L 3.98809 9.56944L 3.5 9ZM 0.488094 3.56944L 3.98809 0.569442L 3.01191 -0.569442L -0.488094 2.43056L 0.488094 3.56944ZM 3.01191 0.569442L 6.51191 3.56944L 7.48809 2.43056L 3.98809 -0.569442L 3.01191 0.569442ZM -0.488094 6.56944L 3.01191 9.56944L 3.98809 8.43056L 0.488094 5.43056L -0.488094 6.56944ZM 3.98809 9.56944L 7.48809 6.56944L 6.51191 5.43056L 3.01191 8.43056L 3.98809 9.56944Z"})})},13797:(e,t,n)=>{n.d(t,{F:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("factoryBlockSettings",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M12,8c-2.209,0-4,1.791-4,4s1.791,4,4,4s4-1.791,4-4S14.209,8,12,8z M12,14c-1.104,0-2-0.896-2-2s0.896-2,2-2s2,0.896,2,2 S13.104,14,12,14z M24,15V9h-3.523c-0.105-0.299-0.227-0.589-0.361-0.872l2.491-2.492l-4.243-4.243l-2.491,2.491 C15.59,3.75,15.299,3.629,15,3.523V0H9v3.523C8.701,3.629,8.411,3.75,8.128,3.885L5.636,1.394L1.394,5.636l2.491,2.492 C3.75,8.411,3.629,8.701,3.523,9H0v6h3.523c0.106,0.299,0.227,0.589,0.362,0.872l-2.492,2.491l4.243,4.243l2.492-2.491 C8.411,20.25,8.701,20.371,9,20.477V24h6v-3.523c0.299-0.105,0.59-0.227,0.872-0.361l2.491,2.491l4.243-4.243l-2.491-2.491 c0.135-0.283,0.256-0.573,0.361-0.872H24z M19.778,18.363l-1.415,1.415l-2.077-2.077c-0.896,0.502-2.271,1.049-3.286,1.363V22h-2 v-2.936c-1.016-0.314-2.391-0.861-3.286-1.363l-2.078,2.077l-1.415-1.415L6.3,16.285C5.781,15.359,5.234,13.953,4.936,13H2v-2h2.936 C5.234,10.047,5.781,8.641,6.3,7.714L4.222,5.636l1.415-1.415l2.078,2.077C8.609,5.797,9.984,5.25,11,4.936V2h2v2.936 c1.016,0.314,2.391,0.861,3.286,1.363l2.077-2.077l1.415,1.415L17.7,7.714c0.519,0.926,1.065,2.333,1.364,3.286H22v2h-2.936 c-0.299,0.953-0.846,2.359-1.364,3.285L19.778,18.363z"})})},71441:(e,t,n)=>{n.d(t,{O:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("figma",{viewBox:"0 0 36 55",svg:(0,i.jsx)("path",{d:"M19.5,27.5 C19.5,23.08142 23.08142,19.5 27.5,19.5 C31.9186,19.5 35.5,23.08142 35.5,27.5 C35.5,31.9186 31.9186,35.5 27.5,35.5 C23.08142,35.5 19.5,31.9186 19.5,27.5 Z M0.5,46.5 C0.5,42.08142 4.08142,38.5 8.5,38.5 L16.5,38.5 L16.5,46.5 C16.5,50.9186 12.9186,54.5 8.5,54.5 C4.08142,54.5 0.5,50.9186 0.5,46.5 Z M19.5,16.5 L19.5,0.5 L27.5,0.5 C31.9186,0.5 35.5,4.08142 35.5,8.5 C35.5,12.9186 31.9186,16.5 27.5,16.5 L19.5,16.5 Z M8.5,16.5 C4.08142,16.5 0.5,12.9186 0.5,8.5 C0.5,4.08142 4.08142,0.5 8.5,0.5 L16.5,0.5 L16.5,16.5 L8.5,16.5 Z M8.5,35.5 C4.08142,35.5 0.5,31.9186 0.5,27.5 C0.5,23.08142 4.08142,19.5 8.5,19.5 L16.5,19.5 L16.5,35.5 L8.5,35.5 Z"})})},50066:(e,t,n)=>{n.d(t,{R:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("file",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.35645 15.4678H11.6367C13.0996 15.4678 13.8584 14.6953 13.8584 13.2256V7.02539C13.8584 6.0752 13.7354 5.6377 13.1406 5.03613L9.55176 1.38574C8.97754 0.804688 8.50586 0.667969 7.65137 0.667969H4.35645C2.89355 0.667969 2.13477 1.44043 2.13477 2.91016V13.2256C2.13477 14.7021 2.89355 15.4678 4.35645 15.4678ZM4.46582 14.1279C3.80273 14.1279 3.47461 13.7793 3.47461 13.1436V2.99219C3.47461 2.36328 3.80273 2.00781 4.46582 2.00781H7.37793V5.75391C7.37793 6.73145 7.86328 7.20312 8.83398 7.20312H12.5186V13.1436C12.5186 13.7793 12.1836 14.1279 11.5205 14.1279H4.46582ZM8.95703 6.02734C8.67676 6.02734 8.56055 5.9043 8.56055 5.62402V2.19238L12.334 6.02734H8.95703ZM8.59473 12.7266V10.6279L8.54004 9.56152L9.06641 10.1152L9.59277 10.6484C9.68848 10.7646 9.8457 10.833 9.98926 10.833C10.2969 10.833 10.5293 10.6143 10.5293 10.3066C10.5293 10.1357 10.4678 10.0127 10.3379 9.90332L8.45117 8.16699C8.29395 8.02344 8.16406 7.96191 7.99316 7.96191C7.8291 7.96191 7.69922 8.02344 7.54199 8.16699L5.65527 9.90332C5.52539 10.0127 5.46387 10.1357 5.46387 10.3066C5.46387 10.6143 5.68945 10.833 6.00391 10.833C6.14746 10.833 6.29785 10.7646 6.40039 10.6484L6.92676 10.1152L7.45312 9.56152L7.39844 10.6279V12.7266C7.39844 13.0547 7.67188 13.3008 7.99316 13.3008C8.32129 13.3008 8.59473 13.0547 8.59473 12.7266Z"})})},60997:(e,t,n)=>{n.d(t,{B:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("framer",{viewBox:"0 0 32 32",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"m9 6h14v7h-7zm0 7h7l7 7h-14zm0 7h7v7z"})})})},80750:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("genericError",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M16.0242 29.0485c7.1251 0 13.0243-5.8992 13.0243-13.0243C29.0485 8.91198 23.1365 3 16.0115 3 8.89922 3 3 8.91198 3 16.0242c0 7.1251 5.91198 13.0243 13.0242 13.0243zm-.0127-11.1089c-.6768 0-1.0471-.3959-1.0726-1.0726l-.1788-6.3078c-.0255-.70232.5108-1.20031 1.2386-1.20031.7151 0 1.2769.51076 1.2514 1.21301l-.1916 6.2951c-.0255.6895-.3958 1.0726-1.047 1.0726zm0 4.6989c-.7406 0-1.4301-.5874-1.4301-1.379 0-.7917.6767-1.3791 1.4301-1.3791.7533 0 1.4301.5746 1.4301 1.3791 0 .8044-.6895 1.379-1.4301 1.379z"})})},84869:(e,t,n)=>{n.d(t,{c:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("googleDrive",{viewBox:"0 0 512 512",svg:(0,i.jsxs)("g",{children:[" ",(0,i.jsx)("path",{d:"M175.5,44.9c2.6,0,4.5,0,6.5,0c50.5,0,101,0.1,151.5-0.2c5.5,0,8.5,2,11,6.4c10.7,19,21.5,38,32.3,56.9   c13.2,23.2,26.5,46.4,39.8,69.5c14.8,25.9,29.8,51.6,44.6,77.5c11.9,20.7,23.6,41.6,35.4,62.4c1.5,2.6,5,5.2,3.5,7.8  c-0.8,1.4-5.6,0.6-8.5,0.6c-28.8-0.3-57.6-0.4-86.4-1.2c-19.7-0.6-39.3-0.3-58.9-0.8c-5.6-0.1-11.3-0.6-16.9-0.7   c-2.3,0-3.1-1.2-4-2.9c-9.7-17.9-19.4-35.7-29.2-53.6c-10.4-19.1-20.8-38.2-31.3-57.4c-11.5-21.2-23-42.4-34.5-63.5   c-11.6-21.3-23.3-42.6-34.9-64C188.7,69.7,182.3,57.6,175.5,44.9z"})," ",(0,i.jsx)("path",{d:"M97.1,474c1.6-6.5,5.5-10.8,8.3-15.6c14.5-25.3,29.3-50.3,43.9-75.5c8.6-14.9,17.1-29.8,25.5-44.8   c1.4-2.5,3.1-3.2,5.6-3.2c27.6,0.4,55.3,0.3,82.9,1.3c16.7,0.6,33.3,0.4,49.9,0.8c20.1,0.4,40.3,0.2,60.4,1.2  c13.8,0.6,27.6,0.4,41.4,0.7c29.3,0.5,58.6,0.8,87.9,1.2c1.4,0,3.2-0.7,4,1.1c0.5,1.3-0.4,2.4-1.2,3.6   c-10.4,16.3-20.8,32.7-31.2,49.1c-10.6,16.7-21.1,33.5-31.6,50.2c-5.3,8.4-10.6,16.7-15.6,25.2c-2.3,3.9-4.9,6.2-9.8,5.7   c-5.4-0.6-11-0.7-16.4-0.7c-99.3-0.1-198.6-0.2-297.9-0.3C101.3,474,99.4,474,97.1,474z"})," ",(0,i.jsx)("path",{d:"M9.8,326.3c1.1-5.3,4.5-9.5,7.1-14c14.3-25.7,28.9-51.2,43.3-76.8c9.7-17.1,19.5-34.3,29.2-51.4   c12.9-22.8,25.7-45.7,38.6-68.5c10.7-18.9,21.6-37.8,32.4-56.7c4.7-8.2,5.1-8.4,9.3-0.6c8.3,15.6,16.7,31.1,24.8,46.8  c6.1,11.9,12.6,23.7,18.9,35.5c7.2,13.6,14.5,27.2,21.7,40.7c2.2,4.2,4.3,8.6,6.8,12.7c1.3,2.1,0.9,3.4-0.3,5.4   c-16.2,27.3-32.2,54.7-48.4,81.9c-14,23.6-28.3,47-42.3,70.6c-16.4,27.5-32.6,55.1-49,82.6c-6.6,11.2-13.3,22.4-20,33.6   c-0.6,1.1-0.8,2.8-2.5,2.7c-1.6-0.1-2-1.7-2.6-2.8c-3.7-7.6-7.3-15.2-10.9-22.8c-6.9-14.7-13.9-29.3-20.9-44   c-9-18.8-18-37.5-27-56.3c-2.3-4.8-4.5-9.6-6.8-14.3C10.6,329.2,9.7,328,9.8,326.3z"})," "]})})},59341:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("hand",{viewBox:"0 0 28 28",svg:(0,i.jsx)("path",{d:"M13.6572 23.1553C16.918 23.1553 19.1943 21.415 20.416 17.9873L21.9893 13.584C22.1035 13.2588 22.1562 12.9512 22.1562 12.6611C22.1562 11.6592 21.4092 10.9209 20.416 10.9209C19.7832 10.9209 19.2119 11.2812 18.9131 11.9668L18.4385 13.1182C18.4209 13.1533 18.4033 13.1709 18.3682 13.1709C18.3242 13.1709 18.3066 13.1445 18.3066 13.1006V6.35059C18.3066 5.23438 17.5771 4.51367 16.4961 4.51367C16.1621 4.51367 15.8545 4.61914 15.6172 4.82129C15.4414 3.93359 14.8174 3.38867 13.9121 3.38867C13.0332 3.38867 12.3916 3.94238 12.207 4.80371C11.9873 4.61035 11.7061 4.51367 11.4072 4.51367C10.3965 4.51367 9.70215 5.2168 9.70215 6.2627V7.08008C9.48242 6.86914 9.16602 6.75488 8.83203 6.75488C7.82129 6.75488 7.10938 7.51074 7.10938 8.58301V16.2822C7.10938 20.5361 9.72852 23.1553 13.6572 23.1553ZM13.6133 21.6523C10.4668 21.6523 8.54199 19.6484 8.54199 16.124V8.75C8.54199 8.41602 8.75293 8.1875 9.06934 8.1875C9.39453 8.1875 9.62305 8.41602 9.62305 8.75V13.2764C9.62305 13.6543 9.93066 13.918 10.2822 13.918C10.6426 13.918 10.9502 13.6543 10.9502 13.2764V6.48242C10.9502 6.14844 11.1611 5.91992 11.4863 5.91992C11.8027 5.91992 12.04 6.14844 12.04 6.48242V12.8105C12.04 13.1885 12.3389 13.4609 12.6904 13.4609C13.0508 13.4609 13.3584 13.1885 13.3584 12.8105V5.36621C13.3584 5.04102 13.5869 4.79492 13.9033 4.79492C14.2197 4.79492 14.4482 5.04102 14.4482 5.36621V12.7051C14.4482 13.0654 14.7383 13.3467 15.0986 13.3467C15.4678 13.3467 15.7666 13.0654 15.7666 12.7051V6.48242C15.7666 6.14844 15.9863 5.91992 16.3115 5.91992C16.6279 5.91992 16.8564 6.14844 16.8564 6.48242V15.2451C16.8564 15.7549 17.1816 16.0449 17.6035 16.0361C17.9551 16.0361 18.2715 15.8779 18.4824 15.4121L19.748 12.5732C19.8975 12.2305 20.1963 12.125 20.4688 12.2217C20.7676 12.3359 20.8643 12.626 20.7236 13.0039L19.0889 17.5127C17.999 20.501 16.1621 21.6523 13.6133 21.6523Z"})})},84169:(e,t,n)=>{n.d(t,{m:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("help",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM7.84277 9.4248C8.21875 9.4248 8.45801 9.21289 8.47852 8.93262C8.47852 8.90527 8.47852 8.87109 8.47852 8.85059C8.49902 8.49512 8.74512 8.25586 9.18945 7.96875C9.85938 7.52441 10.2969 7.13477 10.2969 6.3418C10.2969 5.2002 9.27148 4.55078 8.06152 4.55078C6.89258 4.55078 6.09277 5.08398 5.88086 5.72656C5.83984 5.84277 5.81934 5.95898 5.81934 6.08203C5.81934 6.41016 6.0791 6.61523 6.35254 6.61523C6.60547 6.61523 6.76953 6.5127 6.90625 6.32812L7.01562 6.19141C7.24121 5.81543 7.56934 5.61719 7.97949 5.61719C8.5332 5.61719 8.90918 5.94531 8.90918 6.41016C8.90918 6.84082 8.62207 7.05273 8.04102 7.45605C7.55566 7.79102 7.2002 8.14648 7.2002 8.76855V8.84375C7.2002 9.22656 7.43262 9.4248 7.84277 9.4248ZM7.83594 11.5234C8.27344 11.5234 8.63574 11.2021 8.63574 10.7715C8.63574 10.3408 8.27344 10.0264 7.83594 10.0264C7.3916 10.0264 7.03613 10.3477 7.03613 10.7715C7.03613 11.2021 7.39844 11.5234 7.83594 11.5234Z"})})},74155:(e,t,n)=>{n.d(t,{u:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("helpButtonGuide",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 2.77344C7.39844 2.0625 6.05859 1.42676 4.48633 1.42676C2.3877 1.42676 0.692383 2.51367 0.241211 3.5459V13.8066C0.241211 14.4766 0.678711 14.7363 1.16406 14.7363C1.52637 14.7363 1.73145 14.627 1.96387 14.4561C2.42871 14.0801 3.1875 13.6426 4.48633 13.6426C5.79199 13.6426 6.68066 14.0801 7.07715 14.415C7.2959 14.5791 7.54883 14.7363 8 14.7363C8.45117 14.7363 8.69727 14.5654 8.92285 14.415C9.34668 14.1006 10.208 13.6426 11.5137 13.6426C12.8125 13.6426 13.585 14.0869 14.0361 14.4561C14.2686 14.627 14.4736 14.7363 14.8359 14.7363C15.3213 14.7363 15.7588 14.4766 15.7588 13.8066V3.5459C15.3076 2.51367 13.6191 1.42676 11.5137 1.42676C9.94141 1.42676 8.6084 2.0625 8 2.77344ZM1.72461 4.01758C1.90918 3.56641 2.9209 2.80078 4.48633 2.80078C6.05176 2.80078 7.09766 3.57324 7.26172 4.01758V13.0342C6.55762 12.5283 5.55273 12.2549 4.48633 12.2549C3.41309 12.2549 2.41504 12.5283 1.72461 13.0547V4.01758ZM14.2754 4.01758V13.0547C13.585 12.5283 12.5869 12.2549 11.5137 12.2549C10.4473 12.2549 9.44238 12.5283 8.73828 13.0342V4.01758C8.90234 3.57324 9.94824 2.80078 11.5137 2.80078C13.0791 2.80078 14.0908 3.56641 14.2754 4.01758Z"})})},64258:(e,t,n)=>{n.d(t,{p:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("hex",{viewBox:"0 0 92 92",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.8 34v8.368h-2.4V34H15v24h8.4V46h2.4v12h8.4V34h-8.4Zm10.7995 24h19.2v-9.6h-8.4v6h-2.4V46h10.8V34h-19.2v24Zm8.4-15.6v-4.8h2.4v4.8h-2.4Zm24.0007 0V34h8.4v6l-3.6 4.2 3.6 4.2V58h-8.4V45.968h-2.4V58h-8.4v-9.6l3.6-4.2-3.6-4.2v-6h8.4v8.4h2.4Z",fill:"#473982"})]})})},37250:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(67294),i=n(45238),r=n(85893);const a=(0,i.I)("imageError",{viewBox:"0 0 32 32",svg:(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)("path",{d:"M6.39515 31.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33305.6662-.69079.6662z"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 17.5539V3h26v26H12.6862c.4113-.6095.7364-1.282.9578-2H28v-4H13.7749c-.1687-.7106-.4373-1.3825-.7902-2H28V5H6v12.1798c-.69548.0352-1.36626.164-2 .3741zM11.3329 19c-.6875-.5905-1.48192-1.0601-2.35027-1.3757L13 12l2 1 5-5 6 11H11.3329zM12 9c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm3.395 6.434l-1.76-.881L11.887 17h10.744l-3.107-5.695-4.129 4.129z"})]})})},44495:(e,t,n)=>{n.d(t,{D:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("info",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.97266 14.9453C11.7871 14.9453 14.9453 11.7803 14.9453 7.97266C14.9453 4.1582 11.7803 1 7.96582 1C4.1582 1 1 4.1582 1 7.97266C1 11.7803 4.16504 14.9453 7.97266 14.9453ZM7.97266 13.7832C4.74609 13.7832 2.16895 11.1992 2.16895 7.97266C2.16895 4.74609 4.73926 2.16211 7.96582 2.16211C11.1924 2.16211 13.7764 4.74609 13.7832 7.97266C13.79 11.1992 11.1992 13.7832 7.97266 13.7832ZM7.91113 5.53906C8.41016 5.53906 8.7998 5.14258 8.7998 4.64355C8.7998 4.14453 8.41016 3.74805 7.91113 3.74805C7.41895 3.74805 7.02246 4.14453 7.02246 4.64355C7.02246 5.14258 7.41895 5.53906 7.91113 5.53906ZM6.77637 11.7324H9.55859C9.83887 11.7324 10.0576 11.5273 10.0576 11.2471C10.0576 10.9805 9.83887 10.7686 9.55859 10.7686H8.71094V7.28906C8.71094 6.91992 8.52637 6.67383 8.17773 6.67383H6.89258C6.6123 6.67383 6.39355 6.88574 6.39355 7.15234C6.39355 7.43262 6.6123 7.6377 6.89258 7.6377H7.62402V10.7686H6.77637C6.49609 10.7686 6.27734 10.9805 6.27734 11.2471C6.27734 11.5273 6.49609 11.7324 6.77637 11.7324Z"})})},48964:(e,t,n)=>{n.d(t,{v:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("invision",{viewBox:"0 0 215 182",svg:(0,i.jsxs)("g",{stroke:"none",strokeWidth:"1",children:[" ",(0,i.jsxs)("g",{transform:"translate(0.000000, -222.000000)",children:[" ",(0,i.jsxs)("g",{children:[" ",(0,i.jsx)("path",{d:"M98.9196618,401.249534 L67.23738,401.249534 C69.0283748,394.069758 70.787323,387.019973 72.4415558,380.387695 C68.8636285,384.425558 65.4170469,389.032134 61.2582199,392.866884 C50.6503674,402.647395 38.1012175,405.941417 24.0797327,402.23079 C13.9819165,399.55829 7.92421985,391.917675 6.61663119,381.562133 C5.46837247,372.464529 7.41824578,363.782628 9.57890401,355.080416 C13.7219334,338.391847 17.8017725,321.687933 21.9028255,304.989434 C22.0454551,304.409889 22.1339216,303.817254 22.2995706,302.96283 L-0.0003,302.96283 C2.30975824,294.403698 4.53721769,286.151943 6.78995327,277.806756 L60.5229552,277.806756 C60.3491817,278.642223 60.2273147,279.357627 60.0512844,280.059943 C53.0231647,308.023022 45.9535198,335.97572 39.0057421,363.95911 C38.1427426,367.435481 37.6331576,371.059899 37.479244,374.638277 C37.2535643,379.877659 40.2013936,382.783512 45.4935844,382.824134 C53.5440336,382.885068 60.4588621,379.769784 66.3955944,374.554776 C72.743064,368.979131 77.1564578,362.201967 79.1663619,353.808936 C83.0828089,337.452117 87.2971531,321.167064 91.379249,304.850416 C91.5232327,304.276286 91.5715282,303.678686 91.6933952,302.909569 L69.2513464,302.909569 C69.6155936,301.479211 69.9089773,300.269116 70.2316994,299.067145 C71.9843286,292.540938 73.758623,286.020597 75.4882328,279.488522 C75.7789084,278.389461 76.0555918,277.645621 77.5008451,277.651037 C92.8448135,277.709714 108.18833,277.692562 123.531847,277.702492 C123.75166,277.702492 123.97102,277.781931 124.411096,277.867238 C122.458966,286.803255 120.511801,295.717606 118.565087,304.631958 C118.656261,304.671226 118.747887,304.710043 118.838611,304.749311 C120.277996,302.605804 121.639297,300.404524 123.17076,298.328721 C129.752485,289.408051 137.659853,281.997178 148.043831,277.728671 C168.022811,269.515732 188.005402,280.685076 192.142563,302.283534 C193.975534,311.851454 193.064691,321.305631 190.553778,330.628914 C187.175803,343.16994 183.622249,355.664024 180.318748,368.224458 C179.661569,370.722733 179.467484,373.448493 179.624106,376.035235 C179.988804,382.073072 185.463796,384.737899 190.442292,381.268749 C192.360119,379.932273 194.120421,378.060937 195.308399,376.052387 C197.438816,372.450086 199.08989,368.563429 200.922861,364.787355 C201.278532,364.054347 201.552056,363.281168 201.937066,362.346854 C206.06836,363.936993 210.106223,365.491476 214.381049,367.137584 C210.178891,380.337594 205.268551,393.058261 192.248181,399.864312 C181.021966,405.732889 169.389528,405.395272 158.535233,398.5987 C151.013326,393.889214 148.484358,386.186312 148.027131,377.697592 C147.620005,370.133709 149.656088,362.968376 151.693976,355.800786 C154.30148,346.629159 157.031754,337.485517 159.315182,328.232646 C160.272516,324.353211 160.657977,320.20973 160.534756,316.210233 C160.26394,307.425422 153.949871,301.479211 145.147908,301.094201 C135.701404,300.681207 128.636273,304.704626 123.601357,312.562796 C119.514296,318.940958 117.721496,326.162711 115.917863,333.384916 C110.367494,355.603993 104.804488,377.819911 99.2455434,400.036731 C99.157077,400.390597 99.0564238,400.741303 98.9196618,401.249534 Z M28.7006165,241.023028 C28.6658618,230.356047 37.1446512,221.982425 47.9637399,222.000028 C58.6717942,222.017631 67.1365914,230.335285 67.169992,240.873176 C67.2033927,251.467488 58.5991253,259.984192 47.8874602,259.958916 C37.2349231,259.934091 28.7349198,251.545573 28.7006165,241.023028 Z"})," "]})," "]})," "]})})},90199:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("locked",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.79395 14.7227H11.1992C12.252 14.7227 12.7783 14.1963 12.7783 13.0479V8.20801C12.7783 7.19629 12.3682 6.66992 11.541 6.56055V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.56055C3.625 6.66992 3.21484 7.19629 3.21484 8.20801V13.0479C3.21484 14.1963 3.73438 14.7227 4.79395 14.7227ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.54004H5.75098V4.83105ZM4.99219 13.5059C4.69141 13.5059 4.54102 13.3623 4.54102 13V8.25586C4.54102 7.89355 4.69141 7.76367 4.99219 7.76367H11.0078C11.3086 7.76367 11.4521 7.89355 11.4521 8.25586V13C11.4521 13.3623 11.3086 13.5059 11.0078 13.5059H4.99219Z"})})},97485:(e,t,n)=>{n.d(t,{p:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("loom",{viewBox:"0 0 190 190",svg:(0,i.jsx)("path",{d:"M189.611 84.2622H134.166L182.184 56.539L171.639 38.2692L123.621 65.9923L151.338 17.9781L133.068 7.42678L105.351 55.4409V0H84.2598V55.4462L56.5322 7.42678L38.2681 17.9728L65.9904 65.987L17.9723 38.2692L7.42658 56.5337L55.4447 84.2569H0V105.349H55.4394L7.42658 133.072L17.9723 151.342L65.9851 123.624L38.2628 171.638L56.5322 182.184L84.2545 134.165V189.611H105.346V134.17L133.063 182.184L151.332 171.638L123.61 123.619L171.628 151.342L182.174 133.072L134.161 105.354H189.6V84.2622H189.611ZM94.8055 123.491C78.9021 123.491 66.0116 110.601 66.0116 94.6968C66.0116 78.7929 78.9021 65.9021 94.8055 65.9021C110.709 65.9021 123.599 78.7929 123.599 94.6968C123.599 110.601 110.709 123.491 94.8055 123.491Z"})})},81822:(e,t,n)=>{n.d(t,{h:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("maps",{viewBox:"0 0 160 164",svg:(0,i.jsxs)("g",{children:[" ",(0,i.jsx)("polyline",{points:"16 163.155 76.159 103 136.314 163.155 16 163.155"})," ",(0,i.jsx)("path",{d:"M91.1523093,12 C89.1061243,15.5558234 87.6020864,19.4206238 86.7688642,23.441 C84.8448642,33.084 86.5958642,43.241 91.3038642,51.836 C91.8382207,52.8588753 92.3925227,53.8704894 92.9644441,54.8718184 L0,147.839 L0,24.942 C0,17.799 5.796,12 12.942,12 L91.1523093,12 L91.1523093,12 Z M27.8186945,28.8787927 C20.9826945,31.9947927 15.9026945,38.8067927 15.1686945,46.3227927 C13.7376945,56.9777927 21.5856945,67.7337927 32.0706945,69.9057927 C40.5536945,71.9007927 50.5746945,68.4527927 54.8196945,60.5497927 C57.5256945,56.1347927 57.8816945,50.7917927 57.3626945,45.7587927 C50.5816945,45.0857927 43.5296945,45.6577927 36.6486945,45.4797927 C36.5946945,48.0237927 36.6096945,50.5677927 36.7256945,53.1037927 C40.8396945,53.0417927 44.9526945,53.0807927 49.0736945,53.0727927 C47.8296945,58.9497927 41.9446945,62.9007927 36.0456945,62.2127927 C27.0296945,62.0967927 20.6586945,51.4727927 24.4936945,43.3927927 C27.4236945,35.1807927 39.1766945,32.2347927 45.4326945,38.4437927 C47.4426945,36.5027927 49.4526945,34.5547927 51.4096945,32.5597927 C45.1536945,26.7907927 35.5196945,25.3527927 27.8186945,28.8787927 Z"})," ",(0,i.jsx)("path",{d:"M124.80036,20.6120969 C120.325021,21.6105482 116.569675,25.5689693 116.191987,30.2012296 C115.721991,34.5142624 118.24735,38.8911407 122.112695,40.7949674 C126.304191,43.0118678 131.806442,42.332644 135.307176,39.1288306 C138.574835,36.2380909 139.764822,31.2458343 138.057917,27.2058756 C136.037937,22.1505427 130.041845,19.2713414 124.80036,20.6120969 Z M129.322621,0 C138.754833,0.539994477 147.978584,5.14840888 153.696218,12.7298698 C157.440026,17.5182824 159.529236,23.4620677 160,29.4989291 L160,31.7396754 C159.779233,43.4418634 152.290848,53.047919 145.807068,62.1501336 C138.528681,72.435413 131.801058,83.6445291 129.937231,96.3213226 C129.438005,98.4697621 129.034302,102.445875 127.470333,102.445875 C124.80036,102.3677 123.210376,86.842958 120.185792,80.3707165 C116.755058,72.8300244 111.978183,66.0154787 107.125156,59.3463161 C104.17134,55.3471262 101.384446,51.2079378 99.0798538,46.7964445 C95.4583524,40.1849736 94.1114431,32.3719766 95.591428,24.9543602 C96.8052617,19.097497 99.8698458,13.6698602 104.112879,9.47298004 C109.830513,3.88303721 117.561972,0.499225663 125.538045,0 L129.322621,0 Z"})," ",(0,i.jsx)("path",{d:"M151.652474,72 L151.652474,148.672145 C135.535571,132.464045 127.553192,124.419378 127.705338,124.538145 C131.041338,123.277145 130.263338,119.369145 130.912338,116.576145 C133.335338,100.096145 142.081338,85.5241452 151.543338,72.1531452 C151.579693,72.102109 151.616072,72.0510607 151.652474,72 Z"})," ",(0,i.jsx)("path",{d:"M106.040648,74 L92,88.0399478 L125.952845,121.992793 C123.906994,113.374953 121.723258,103.970177 117.61803,95.9459594 C114.174293,88.3766869 110.811044,80.7912134 106.040648,74 Z"})," "]})})},15289:(e,t,n)=>{n.d(t,{M:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("miro",{viewBox:"0 0 32 32",svg:(0,i.jsx)("path",{d:"M13.75 20.895l1.761.359v-7.82l-1.76.344v7.117zm4.604-4.28v4.28l1.761.359V16.88c0-.993.56-1.441 1.432-1.607l1.015-.186v-1.835l-1.015.164c-1.935.44-3.193 1.073-3.193 3.197zm-7.446-.256c0-2.313-1.539-3.085-2.777-3.068-.984.014-1.785.423-2.265 1.047-.478-.685-1.325-1.068-2.016-1.068-.85 0-1.597.373-2.09.97v-.806L0 13.778v7.117l1.76.359v-4.895c0-.776.568-1.328 1.418-1.328.836 0 1.403.552 1.403 1.328v4.536l1.76.359v-4.895c0-.776.568-1.328 1.404-1.328.835 0 1.402.552 1.402 1.328v4.536l1.76.359v-4.895h.001zm17.176 5.059c2.356 0 3.916-1.636 3.916-4.081 0-2.446-1.56-4.067-3.916-4.067-2.446 0-4.082 1.62-4.082 4.067 0 2.445 1.636 4.08 4.082 4.08zm0-1.65c-1.366 0-2.281-.976-2.281-2.431 0-1.456.915-2.416 2.281-2.416 1.275 0 2.115.96 2.115 2.416 0 1.455-.84 2.43-2.115 2.43zm-13.416-7.552c.641 0 1.065-.445 1.065-1.11S15.31 10 14.668 10c-.665 0-1.11.44-1.11 1.106 0 .665.445 1.11 1.11 1.11"})})},78810:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("mixpanel",{viewBox:"0 0 101 106",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M31.008 41.412h13.385c-3.342-2.09-4.593-5.021-6.272-10.454l-5.022-18.613C30.803 3.982 28.918.005 19.714.005H.484v5.022H3.21c5.639 0 6.273 2.091 7.952 8.364l4.387 16.315c2.297 7.952 5.861 11.706 15.476 11.706h-.016zm30.968 0h13.37c9.614 0 12.956-3.77 15.27-11.706l4.387-16.315c1.679-6.273 2.502-8.364 7.952-8.364h2.724V.006H86.655c-9.41 0-11.294 3.77-13.385 12.34l-5.02 18.611c-1.68 5.639-2.93 8.363-6.273 10.454zM44.393 58.963h17.584l-.001-17.55H44.393v17.55zM.484 100.369h19.23c9.204 0 11.088-3.976 13.385-12.34l5.022-18.611c1.679-5.434 2.93-8.364 6.272-10.455H31.008c-9.615 0-13.179 3.77-15.475 11.706l-4.388 16.315c-1.68 6.273-2.297 8.364-7.952 8.364H.484v5.021zm86.14 0h19.023v-5.021h-2.724c-5.433 0-6.273-2.091-7.952-8.364L90.583 70.67c-2.296-7.952-5.639-11.706-15.27-11.706H61.976c3.343 2.091 4.546 4.816 6.225 10.455l5.022 18.612c2.09 8.57 3.975 12.339 13.385 12.339h.015z"})})})},41898:(e,t,n)=>{n.d(t,{d:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("overlap",{viewBox:"0 0 20 20",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M4.917 14.496h1.729v-1.1H4.93c-.342 0-.604-.091-.786-.274-.182-.182-.273-.45-.273-.806V5.52c0-.356.09-.625.273-.807.182-.182.444-.273.786-.273h6.83c.336 0 .596.09.779.273.186.182.28.451.28.807v1.497h1.1V5.459c0-.702-.18-1.23-.54-1.586-.355-.355-.888-.533-1.6-.533H4.918c-.716 0-1.254.178-1.614.533-.355.351-.533.88-.533 1.586v6.918c0 .707.178 1.237.533 1.593.36.35.898.526 1.614.526zm3.315 3.165h6.863c.711 0 1.244-.177 1.6-.533.36-.355.54-.884.54-1.586V8.624c0-.702-.18-1.23-.54-1.586-.356-.355-.889-.533-1.6-.533H8.232c-.716 0-1.253.178-1.613.533-.356.351-.534.88-.534 1.586v6.918c0 .707.178 1.235.534 1.586.36.356.897.533 1.613.533zm.014-1.1c-.342 0-.604-.091-.787-.274-.182-.182-.273-.45-.273-.806V8.686c0-.356.091-.625.273-.807.183-.182.445-.273.787-.273h6.829c.337 0 .597.09.779.273.187.182.28.451.28.807v6.795c0 .355-.093.624-.28.806-.182.183-.442.274-.78.274H8.247z"}),(0,i.jsx)("path",{d:"M13.976 12.448l-1.832 1.36c-.192.147-.379.183-.561.11-.182-.073-.273-.225-.273-.458v-.848H9.7a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.145.053-.27.157-.376s.233-.157.383-.157h1.61v-.827c0-.246.093-.401.28-.465.187-.068.371-.034.554.103l1.832 1.374a.43.43 0 01.184.362.423.423 0 01-.184.356z"})]})})},87292:(e,t,n)=>{n.d(t,{B:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("pdf",{viewBox:"0 0 42 42",svg:(0,i.jsx)("path",{d:"M6,3 L36,3 C37.6569,3 39,4.34326 39,6 L39,36 C39,37.6567 37.6569,39 36,39 L6,39 C4.34314,39 3,37.6567 3,36 L3,6 C3,4.34326 4.34314,3 6,3 Z M12.3916324,17.6692964 C12.6740492,17.8831067 12.8153869,18.2406755 12.8153869,18.7423682 C12.8153869,19.2441828 12.6740492,19.6106452 12.3916324,19.8417552 C12.1138709,20.0728653 11.7225736,20.188603 11.21787,20.188603 L9.22452987,20.188603 L9.22452987,17.3486418 L11.21787,17.3486418 C11.7225736,17.3486418 12.1138709,17.4553642 12.3916324,17.6692964 Z M14.0168221,21.143866 C14.6280786,20.6727524 14.9336421,19.8679485 14.9336421,18.7293325 C14.9336421,17.6868398 14.6280786,16.9167572 14.0168221,16.4194503 C13.4056949,15.9221434 12.5861173,15.6734899 11.5582184,15.6734899 L7.09921423,15.6734899 L7.09921423,25.3187101 L9.22452987,25.3187101 L9.22452987,21.8505974 L11.3983891,21.8505974 C12.5328408,21.8505974 13.4056949,21.6151015 14.0168221,21.143866 Z M19.3259732,23.6435582 L19.3259732,17.3486418 L21.2984941,17.3486418 C22.2709182,17.3486418 22.9191579,17.6125239 23.243213,18.14041 C23.5719234,18.6639102 23.7364079,19.4164494 23.7364079,20.3979056 C23.7364079,21.1091447 23.6275275,21.7218239 23.4098958,22.2366742 C23.0117451,23.1745156 22.3079014,23.6435582 21.2984941,23.6435582 L19.3259732,23.6435582 Z M23.243213,15.8829144 C22.8219155,15.7520698 22.294065,15.6821398 21.6596618,15.6734899 L17.2493564,15.6734899 L17.2493564,25.3187101 L21.6596618,25.3187101 C23.2062299,25.3187101 24.3498627,24.718823 25.0906895,23.5191705 C25.6371608,22.6293298 25.9102672,21.5431004 25.9102672,20.2604823 C25.9102672,19.7546473 25.845482,19.2221317 25.7157824,18.6639102 C25.586212,18.1055668 25.343106,17.5863307 24.9865936,17.1065672 C24.5420199,16.513137 23.9608931,16.1053745 23.243213,15.8829144 Z M35.4978258,15.6865256 L28.2398178,15.6865256 L28.2398178,25.3187101 L30.3650558,25.3187101 L30.3650558,21.2748324 L34.8587673,21.2748324 L34.8587673,19.5996805 L30.3650558,19.5996805 L30.3650558,17.3814139 L35.4978258,17.3814139 L35.4978258,15.6865256 Z"})})},17683:(e,t,n)=>{n.d(t,{Q:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("peekModeCenter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM4.33594 11.0654H11.6504C12.0742 11.0654 12.2588 10.8809 12.2588 10.4502V5.69238C12.2588 5.25488 12.0742 5.07715 11.6504 5.07715H4.33594C3.91211 5.07715 3.72754 5.25488 3.72754 5.69238V10.4502C3.72754 10.8809 3.91211 11.0654 4.33594 11.0654Z"})})},31490:(e,t,n)=>{n.d(t,{M:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("peekModeFull",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM2.77734 12.1113H13.2158C13.5645 12.1113 13.7559 11.9131 13.7559 11.5645V4.57812C13.7559 4.22949 13.5645 4.02441 13.2158 4.02441H2.77734C2.42871 4.02441 2.2373 4.22949 2.2373 4.57812V11.5645C2.2373 11.9131 2.42871 12.1113 2.77734 12.1113Z"})})},32240:(e,t,n)=>{n.d(t,{y:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("peekModeSide",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM8.51953 12.1113H13.2158C13.5986 12.1113 13.7559 11.9541 13.7559 11.5645V4.57812C13.7559 4.18848 13.5986 4.02441 13.2158 4.02441H8.51953C8.13672 4.02441 7.98633 4.18848 7.98633 4.57812V11.5645C7.98633 11.9541 8.13672 12.1113 8.51953 12.1113Z"})})},25651:(e,t,n)=>{n.d(t,{R:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("pencil",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},44597:(e,t,n)=>{n.d(t,{U:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("picture",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M1,4v22h28V4H1z M27,24H3V6h24V24z M18,10l-5,6l-2-2l-6,8h20L18,10z M11.216,17.045l1.918,1.918l4.576-5.491L21.518,20H9 L11.216,17.045z M7,12c1.104,0,2-0.896,2-2S8.104,8,7,8s-2,0.896-2,2S5.896,12,7,12z"})})},87111:(e,t,n)=>{n.d(t,{I:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("play",{viewBox:"0 0 14 16",svg:(0,i.jsx)("path",{d:"M1.34699 16C1.73805 16 2.07697 15.8756 2.52017 15.6089L12.8703 9.47556C13.6437 9.01333 14 8.62222 14 8C14 7.37778 13.6437 6.98667 12.8703 6.52444L2.52017 0.391111C2.07697 0.133333 1.73805 0 1.34699 0C0.582247 0 0 0.595556 0 1.57333V14.4356C0 15.4044 0.582247 16 1.34699 16Z"})})},59401:(e,t,n)=>{n.d(t,{K:()=>a});var o=n(67294),i=n(45238),r=n(85893);const a=(0,i.I)("playbackError",{viewBox:"0 0 32 32",svg:(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)("path",{d:"M6.39515 29.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33306.6662-.69079.6662z"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.1373 16.1987c0 6.7017-5.542 12.2437-12.2436 12.2437-1.622 0-3.1761-.3246-4.6001-.9118.3323-.4107.6226-.8567.8644-1.3316 1.1612.4325 2.4197.6687 3.7357.6687 5.9082 0 10.6689-4.7608 10.6689-10.669-.0122-5.9082-4.7729-10.65671-10.6812-10.65671-5.5497 0-10.08288 4.20726-10.5961 9.62871-.55173.0075-1.08925.0738-1.60656.193.4362-6.32082 5.78156-11.40862 12.20266-11.40862 6.7139 0 12.2559 5.54199 12.2559 12.24362zm-15.4585 4.4372a7.628 7.628 0 00-.0797-.2566.65573.65573 0 01-.0013-.0424v-8.2764c0-.5004.5859-.7202 1.0498-.4516l6.7016 4.0161c.4395.2686.4517.8911 0 1.1597l-6.7016 3.9917c-.3763.2257-.796.1398-.9688-.1405z"})]})})},47453:(e,t,n)=>{n.d(t,{R:()=>r,s:()=>i});n(67294);var o=n(45238);const i=(0,n(85893).jsx)("path",{d:"M7.977 14.963c.407 0 .747-.324.747-.723V8.72h5.362c.399 0 .74-.34.74-.747a.746.746 0 00-.74-.738H8.724V1.706c0-.398-.34-.722-.747-.722a.732.732 0 00-.739.722v5.529h-5.37a.746.746 0 00-.74.738c0 .407.341.747.74.747h5.37v5.52c0 .399.332.723.739.723z"}),r=(0,o.I)("plus",{viewBox:"0 0 16 16",svg:i})},36067:(e,t,n)=>{n.d(t,{J:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("replit",{viewBox:"0 0 793.8 871.5",svg:(0,i.jsx)("g",{children:(0,i.jsx)("path",{d:"M396.9 356.1H227.2c-16.6 0-30-13.4-30-30v-99.8c0-16.6 13.4-30 30-30h139.7c16.6 0 30 13.4 30 30v129.8zm169.7 159.7H396.9V356.1h169.7c16.5 0 29.9 13.4 29.9 29.9v99.8c0 16.6-13.4 30-29.9 30zM366.9 675.6H227.2c-16.5 0-29.9-13.4-29.9-29.9v-99.8c0-16.5 13.4-29.9 29.9-29.9h169.7v129.8c0 16.3-13.4 29.8-30 29.8z"})})})},18442:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("settings",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.30957 15.4814H8.69043C9.25781 15.4814 9.70215 15.1328 9.83203 14.5928L10.1123 13.3828L10.29 13.3145L11.3428 13.9639C11.8213 14.2646 12.3818 14.1895 12.7783 13.7861L13.7354 12.8291C14.1455 12.4258 14.2139 11.8652 13.9131 11.3936L13.2637 10.3477L13.3252 10.1768L14.5352 9.89648C15.0684 9.75977 15.4238 9.31543 15.4238 8.75488V7.4082C15.4238 6.84766 15.0752 6.40332 14.5352 6.2666L13.3389 5.97949L13.2705 5.80176L13.9199 4.75586C14.2207 4.28418 14.1455 3.73047 13.7422 3.31348L12.7852 2.35645C12.3887 1.95996 11.8281 1.88477 11.3564 2.17871L10.3037 2.82129L10.1123 2.74609L9.83203 1.53613C9.70215 0.996094 9.25781 0.647461 8.69043 0.647461H7.30957C6.73535 0.647461 6.29785 0.996094 6.16797 1.53613L5.8877 2.74609L5.69629 2.82129L4.64355 2.17871C4.16504 1.88477 3.60449 1.95996 3.20801 2.35645L2.25098 3.31348C1.84766 3.73047 1.77246 4.28418 2.07324 4.75586L2.72949 5.80176L2.6543 5.97949L1.46484 6.2666C0.917969 6.40332 0.576172 6.84766 0.576172 7.4082V8.75488C0.576172 9.31543 0.924805 9.75977 1.46484 9.89648L2.66797 10.1768L2.73633 10.3477L2.08008 11.3936C1.7793 11.8652 1.85449 12.4258 2.25781 12.8291L3.21484 13.7861C3.61816 14.1895 4.17871 14.2646 4.65039 13.9639L5.70312 13.3145L5.8877 13.3828L6.16797 14.5928C6.29785 15.1328 6.73535 15.4814 7.30957 15.4814ZM7.47363 14.2441C7.35742 14.2441 7.30273 14.1895 7.28223 14.0869L6.87891 12.4053C6.44141 12.3027 6.03125 12.1318 5.69629 11.9199L4.21973 12.8291C4.1377 12.8838 4.05566 12.877 3.9668 12.7949L3.24219 12.0703C3.16699 11.9951 3.16016 11.9131 3.22168 11.8242L4.13086 10.3477C3.93945 10.0264 3.75488 9.61621 3.65234 9.18555L1.96387 8.78223C1.86133 8.76172 1.81348 8.70703 1.81348 8.59082V7.56543C1.81348 7.44238 1.86133 7.39453 1.96387 7.36719L3.65234 6.9707C3.75488 6.5127 3.95312 6.08887 4.11719 5.79492L3.21484 4.3252C3.15332 4.22949 3.15332 4.14746 3.23535 4.06543L3.95996 3.34766C4.04883 3.27246 4.11719 3.25879 4.21973 3.31348L5.68945 4.20898C5.99707 4.02441 6.44824 3.83301 6.87891 3.72363L7.28223 2.04199C7.30273 1.93945 7.35742 1.88477 7.47363 1.88477H8.52637C8.64258 1.88477 8.69727 1.93262 8.71094 2.04199L9.12109 3.7373C9.56543 3.83984 9.96875 4.02441 10.3037 4.21582L11.7734 3.32031C11.876 3.26562 11.9443 3.27246 12.0264 3.35449L12.7578 4.07227C12.8398 4.14746 12.8398 4.22949 12.7783 4.3252L11.876 5.79492C12.04 6.08887 12.2451 6.5127 12.3477 6.9707L14.0293 7.36719C14.1387 7.39453 14.1865 7.44238 14.1865 7.56543V8.59082C14.1865 8.70703 14.1318 8.76172 14.0293 8.78223L12.3408 9.18555C12.2383 9.61621 12.0537 10.0264 11.8691 10.3477L12.7715 11.8242C12.8262 11.9131 12.8262 11.9951 12.751 12.0635L12.0264 12.7949C11.9375 12.877 11.8555 12.8838 11.7734 12.8291L10.2969 11.9199C9.96191 12.1318 9.57227 12.3027 9.12109 12.4053L8.71094 14.0869C8.69727 14.1963 8.64258 14.2441 8.52637 14.2441H7.47363ZM8 10.6621C9.42188 10.6621 10.5908 9.49316 10.5908 8.06445C10.5908 6.64941 9.42188 5.48047 8 5.48047C6.57812 5.48047 5.40234 6.64941 5.40234 8.06445C5.40234 9.49316 6.57129 10.6621 8 10.6621ZM8 9.49316C7.2207 9.49316 6.57812 8.85059 6.57812 8.06445C6.57812 7.29199 7.2207 6.65625 8 6.65625C8.76562 6.65625 9.40137 7.29199 9.40137 8.06445C9.40137 8.84375 8.76562 9.49316 8 9.49316Z"})})},1436:(e,t,n)=>{n.d(t,{g:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("settingsConnectedApps",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M16.492 3.922C15.695 3.125 14.57 3 13.234 3H7.148c-1.312 0-2.437.125-3.234.922C3.117 4.719 3 5.836 3 7.14v6.03c0 1.337.117 2.446.914 3.243.797.797 1.922.922 3.25.922h6.07c1.336 0 2.461-.125 3.258-.922.797-.797.914-1.906.914-3.242V7.164c0-1.336-.117-2.453-.914-3.242zm-.344 3.023v6.438c0 .812-.101 1.64-.578 2.117-.468.469-1.312.578-2.117.578h-6.5c-.805 0-1.648-.11-2.125-.578-.469-.477-.57-1.305-.57-2.117V6.969c0-.82.101-1.664.57-2.133.477-.477 1.328-.578 2.149-.578h6.476c.805 0 1.649.11 2.117.578.477.476.578 1.305.578 2.11zm-3.492 5.149c.344 0 .57-.266.57-.625V7.78c0-.46-.25-.64-.648-.64h-3.71c-.368 0-.602.226-.602.57s.242.57.617.57h1.422l1.156-.125-1.219 1.133-2.875 2.883a.62.62 0 00-.187.422c0 .351.226.578.57.578.188 0 .336-.07.445-.18l2.875-2.875 1.125-1.203-.117 1.219v1.351c0 .368.227.61.578.61z"})})},56996:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sidebarHome",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.54446 3.06854C9.8066 2.84385 10.1934 2.84385 10.4556 3.06854L15.7064 7.56922C16.0832 7.89219 16.3 8.36369 16.3 8.85996V14.6C16.3 15.5389 15.5389 16.3 14.6 16.3H11.75C11.3634 16.3 11.05 15.9866 11.05 15.6V11.7H8.95001V15.6C8.95001 15.9866 8.63661 16.3 8.25001 16.3H5.40001C4.46113 16.3 3.70001 15.5389 3.70001 14.6V8.85996C3.70001 8.36369 3.91687 7.89219 4.29367 7.56922L9.54446 3.06854ZM10 4.52198L5.20477 8.63218C5.13828 8.68918 5.10001 8.77238 5.10001 8.85996V14.6C5.10001 14.7657 5.23433 14.9 5.40001 14.9H7.55001V11.5C7.55001 10.8373 8.08727 10.3 8.75001 10.3H11.25C11.9128 10.3 12.45 10.8373 12.45 11.5V14.9H14.6C14.7657 14.9 14.9 14.7657 14.9 14.6V8.85996C14.9 8.77238 14.8617 8.68918 14.7952 8.63218L10 4.52198Z"})})},31317:(e,t,n)=>{n.d(t,{j:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sketch",{viewBox:"0 0 46 46",svg:(0,i.jsx)("g",{fillRule:"evenodd",children:(0,i.jsx)("path",{d:"M23.0831783 10.0045301l8.1450351.8960958c.2099814.0231017.4008968.1324906.5270123.3019626l6.0917147 8.1859511c.2137793.2872733.1982297.6847539-.0373384.9544486L23.4296391 36.806161c-.2072579.2372831-.5676296.2616233-.8049127.0543654l-.0543655-.0543654L8.19039805 20.3429882c-.23556813-.2696947-.25111774-.6671753-.03733843-.9544486l6.09171468-8.1859511c.1261155-.169472.3170309-.2788609.5270123-.3019626l8.1450351-.8960958a.76060447.76060447 0 01.1663566 0zm2.0141776 2.4229231c-.0693405-.0648437-.1764661-.0687976-.2504897-.0092454-.081512.0655766-.0939018.1841651-.0276733.2648747l3.8573181 4.7007387c.055083.0671271.085151.1509825.085151.2374739 0 .207984-.1702805.3765884-.3803321.3765884H17.6186701c-.0873512 0-.1720402-.0297721-.2398346-.0843129-.163024-.1311532-.1878035-.3683301-.0553465-.5297494l3.8573181-4.7007387c.0601442-.073295.0561509-.1793661-.0093373-.2480242-.0721132-.0756035-.1924706-.0790085-.2688257-.0076051l-5.750016 5.3771171c-.0774384.0724164-.1819972.1093609-.2882425.1018466-.2095178-.0148182-.3672335-.1950067-.352268-.4024622l.2753824-3.8174045c.0064096-.0888512-.0509385-.1699933-.1374402-.1944648-.1009848-.0285688-.206239.0293302-.2350918.129321L13.1553109 17.98681c-.0869135.3012032-.3194364.539875-.62031.6367138l-2.76499194.8899366c-.07834118.0252148-.13137885.0975058-.13137885.1790711 0 .1039921.08514024.1882942.19016605.1882942h2.66553224c.3250892 0 .6276464.1644528.8021788.4360184L20.3459621 31.28552c.0777639.1209976.2347663.165079.3651002.1025088.1417556-.0680534.2009545-.2370061.1322245-.3773663l-5.0526479-10.3185107c-.0376144-.0768161-.0571558-.1610746-.0571558-.2464434 0-.3119761.2554207-.5648827.5704981-.5648827h13.3920376c.0862174 0 .1713136.0193492.2488932.0565933.2835111.1361069.401909.4740123.2644491.7547328l-5.0526479 10.3185107c-.0631922.129051-.0186726.2845081.1035279.3615065.1329093.0837462.3092182.0449521.3937968-.086649l7.0494549-10.9686759c.1745324-.2715656.4770896-.4360184.8021788-.4360184h2.5849257c.0818532 0 .1545231-.0518618.1804073-.1287503.0332121-.0986555-.0206353-.2052903-.1202715-.2381755l-2.6912281-.888246c-.2977515-.0982735-.5273437-.3357047-.6135671-.6345159l-1.2609059-4.3697316c-.0247148-.0856502-.1066636-.1424338-.196398-.1360873-.1047589.0074091-.1836168.0975033-.176134.2012311l.2753824 3.8174045c.0075889.1051994-.0297228.2087291-.1028592.2854053-.1442263.1512071-.3849411.158017-.5376513.0152103z"})})})},24600:(e,t,n)=>{n.d(t,{P:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("slackLogo",{viewBox:"0 0 16 16",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z",fill:"#E01E5A"}),(0,i.jsx)("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z",fill:"#E01E5A"}),(0,i.jsx)("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z",fill:"#36C5F0"}),(0,i.jsx)("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z",fill:"#36C5F0"}),(0,i.jsx)("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z",fill:"#2EB67D"}),(0,i.jsx)("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z",fill:"#2EB67D"}),(0,i.jsx)("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z",fill:"#ECB22E"}),(0,i.jsx)("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z",fill:"#ECB22E"})]})})},11751:(e,t,n)=>{n.d(t,{t:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sparkles",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.2757 4.82358C7.57934 4.71847 7.57934 4.53161 7.2757 4.41483L5.62905 3.78419C5.33709 3.67908 4.99842 3.3404 4.88164 3.03676L4.25101 1.39009C4.1459 1.08644 3.95905 1.08644 3.84226 1.39009L3.21163 3.03676C3.10653 3.32872 2.76786 3.6674 2.46422 3.78419L0.817572 4.41483C0.513934 4.51994 0.513934 4.70679 0.817572 4.82358L2.46422 5.45422C2.75618 5.55933 3.09485 5.898 3.21163 6.20165L3.84226 7.84832C3.94737 8.15196 4.13422 8.15196 4.25101 7.84832L4.88164 6.20165C4.98674 5.90968 5.32541 5.571 5.62905 5.45422L7.2757 4.82358ZM15.2991 10.5929C16.2334 10.3593 16.2334 9.9739 15.2991 9.74032L13.2321 9.22647C12.2978 8.9929 11.3402 8.03526 11.1066 7.10097L10.5928 5.03387C10.3592 4.09959 9.97382 4.09959 9.74025 5.03387L9.2264 7.10097C8.99283 8.03526 8.03521 8.9929 7.10094 9.22647L5.03387 9.74032C4.09961 9.9739 4.09961 10.3593 5.03387 10.5929L7.10094 11.1067C8.03521 11.3403 8.99283 12.2979 9.2264 13.2322L9.74025 15.2993C9.97382 16.2336 10.3592 16.2336 10.5928 15.2993L11.1066 13.2322C11.3402 12.2979 12.2978 11.3403 13.2321 11.1067L15.2991 10.5929Z"})})},95855:(e,t,n)=>{n.d(t,{z:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("speechBubble",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14z"})})},87784:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("splitView",{viewBox:"0 0 24 20",svg:(0,i.jsx)("path",{d:"M13.456 11.143V2.864c0-1.476-.766-2.242-2.222-2.242H2.915C1.452.622.693 1.388.693 2.864v8.278c0 1.477.76 2.243 2.222 2.243h8.32c1.462 0 2.221-.766 2.221-2.242zm-1.34-.083c0 .636-.335.985-.998.985H3.024c-.663 0-.99-.349-.99-.985V7.663h10.082v3.397zM2.033 2.946c0-.629.328-.984.991-.984h8.094c.663 0 .998.355.998.984v3.405H2.033V2.946z"})})},65153:(e,t,n)=>{n.d(t,{n:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sub",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M5 3V20H23.187L19.594 16.406L21 15L27 21L21 27L19.594 25.594L23.187 22H3V3H5Z"})})},60291:(e,t,n)=>{n.d(t,{b:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("sync",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M27.93 13.81h-1.54c-.606-5.717-5.536-10.265-11.387-10.265-3.425 0-6.514 1.55-8.625 3.987-.427.483-.37 1.078.079 1.392.438.315.965.214 1.336-.202a9.57 9.57 0 017.21-3.268 9.503 9.503 0 019.456 8.356h-1.673c-.798 0-1 .539-.573 1.156l2.516 3.583c.359.516.898.528 1.269 0l2.504-3.572c.45-.628.236-1.167-.573-1.167zM2.064 16.202h1.55c.607 5.716 5.526 10.253 11.388 10.253 3.425 0 6.525-1.561 8.636-3.987.416-.483.36-1.09-.078-1.404-.438-.314-.977-.202-1.337.214-1.74 2.01-4.324 3.268-7.221 3.268a9.496 9.496 0 01-9.467-8.344H7.22c.798 0 1-.55.573-1.157l-2.516-3.583c-.359-.516-.898-.527-1.269 0l-2.515 3.572c-.438.617-.236 1.168.572 1.168z"})})},77734:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("tableHeaderColumn",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM14.6762 4.19293C14.6762 3.56913 14.325 3.25402 13.7037 3.25402H7V5.60772H14.6762V4.19293ZM7 6.81672V9.18328H14.6762V6.81672H7ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H7V12.7395H13.7037Z"})})},73599:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("tableHeaderRow",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM1.32377 6.81672V9.18328H7.34825V6.81672H1.32377ZM8.645 6.81672V9.18328H14.6762V6.81672H8.645ZM1.32377 11.8071C1.32377 12.4309 1.66821 12.7395 2.29633 12.7395H7.34825V10.3923H1.32377V11.8071ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H8.645V12.7395H13.7037Z"})})},63003:(e,t,n)=>{n.d(t,{f:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("tex",{viewBox:"0 0 32 21",svg:(0,i.jsxs)("g",{children:[" ",(0,i.jsxs)("g",{id:"d7fc5246-3c04-467c-8f25-6c129c5642ac","data-name":"tex",children:[" ",(0,i.jsxs)("g",{id:"ec363c67-067d-4da0-8c27-f8d029e068bd","data-name":"E",children:[" ",(0,i.jsx)("path",{id:"e1948427-1829-4c96-a9f4-14a99a3d5b97","data-name":"path0 fill",d:"M497.33,497.82c-1.2,0-2.11-.06-3-0.06a0.5,0.5,0,0,0-.55.27c0,0.15.17,0.23,0.57,0.32a1.08,1.08,0,0,1,1.06,1.23c0,0.55,0,1,0,3.32s-0.08,4.43-.13,5.21c-0.08,1-.42,1.2-1.39,1.41a0.59,0.59,0,0,0-.53.32c0,0.21.23,0.25,0.59,0.25,0.7,0,1.08-.09,2.13-0.09,2.76,0,6,.13,6.21.13a0.7,0.7,0,0,0,.36-0.21,14.63,14.63,0,0,0,.68-2.07c0-.21,0-0.53-0.15-0.53a0.78,0.78,0,0,0-.48.55,2.41,2.41,0,0,1-1.54,1.41,9,9,0,0,1-1.8.15,10.57,10.57,0,0,1-1.69-.13,0.74,0.74,0,0,1-.38-0.44,7,7,0,0,1-.15-1.56c0-.78,0-2.49.06-2.93a0.26,0.26,0,0,1,.17-0.17c0.53,0,1.29,0,1.9,0,1.06,0.06,1.18.13,1.44,1a0.52,0.52,0,0,0,.32.4c0.15,0,.23-0.19.23-0.53s-0.06-.68-0.06-1.2,0-.84.06-1.35c0-.17,0-0.46-0.17-0.46a0.54,0.54,0,0,0-.36.42c-0.34.87-.38,0.93-2.09,0.93h-1.27a0.18,0.18,0,0,1-.17-0.17c0-.44,0-3.84.08-4.29a0.5,0.5,0,0,1,.27-0.55,21.09,21.09,0,0,1,2.7.1,1.4,1.4,0,0,1,1.25,1.31,0.54,0.54,0,0,0,.3.47,0.46,0.46,0,0,0,.3-0.51c0-.38,0-1.08,0-1.84a0.28,0.28,0,0,0-.17-0.23,14.12,14.12,0,0,1-1.75.08h-2.81Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,i.jsxs)("g",{id:"8dfbf0a9-85f0-49da-99d8-6229354b9534","data-name":"T",children:[" ",(0,i.jsx)("path",{id:"8602b8e9-f5d6-42d3-88c6-0649b350ce04","data-name":"path1 fill",d:"M490.48,490.82c-2.18,0-3.91-.06-4.39-0.11a1.32,1.32,0,0,1-.68-0.34,0.85,0.85,0,0,0-.3-0.3,0.39,0.39,0,0,0-.28.32,19.85,19.85,0,0,1-.38,2.55,0.4,0.4,0,0,0,.23.42c0.08,0,.19,0,0.38-0.42a5.64,5.64,0,0,1,.61-1,1.72,1.72,0,0,1,1.35-.44c0.32,0,1.94,0,2.3.09a0.26,0.26,0,0,1,.17.25v2.26c0,1.46-.09,5.3-0.13,6.44-0.06,1.41-.11,1.71-1.41,2a0.47,0.47,0,0,0-.38.34c0,0.11.19,0.23,0.57,0.23s1.33-.13,2.22-0.13,2.13,0.1,2.28.1,0.53,0,.53-0.25a0.65,0.65,0,0,0-.49-0.34c-1.22-.25-1.31-0.53-1.39-1.33s-0.1-2.6-.1-4.81c0-1.63,0-3.61,0-4.5a0.35,0.35,0,0,1,.15-0.25c0.29-.06,2.26-0.06,2.6,0,1.12,0.06,1.37.15,1.5,1.16,0.06,0.48.15,0.61,0.28,0.61a0.43,0.43,0,0,0,.32-0.38,11.69,11.69,0,0,1,.42-2.2c0.1-.27,0-0.44-0.09-0.44a0.72,0.72,0,0,0-.28.13,2.49,2.49,0,0,1-1.33.32C494,490.8,491.49,490.82,490.48,490.82Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,i.jsxs)("g",{id:"88168da7-a35d-4a6e-af2a-2bab78b9d062","data-name":"X",children:[" ",(0,i.jsx)("path",{id:"f33958e3-fb20-476c-b2a8-674ffe821a96","data-name":"path2 fill",d:"M504,491a0.52,0.52,0,0,0,.51.36,3,3,0,0,1,1.84,1.14,53.54,53.54,0,0,1,3,4.73,0.22,0.22,0,0,1-.06.27c-1.14,1.58-2.22,2.87-3,3.72a4.47,4.47,0,0,1-2.22,1.27c-0.51.1-.7,0.27-0.7,0.44s0.15,0.21.51,0.21,1.2-.1,2-0.1c0.61,0,1.48.06,2,.06,0.25,0,.46-0.08.46-0.27a0.53,0.53,0,0,0-.46-0.32c-0.74-.27-1-0.47-0.17-1.82,0.53-.78,1.44-2,2.05-2.72a0.15,0.15,0,0,1,.19,0c0.23,0.21,2.09,3.17,2.53,4a0.26,0.26,0,0,1-.08.34,3.18,3.18,0,0,1-.68.23c-0.32.11-.42,0.19-0.42,0.34s0.11,0.25.47,0.25,1-.08,1.58-0.08c1.12,0,2.17.11,2.79,0.11,0.42,0,.57-0.09.57-0.25a0.49,0.49,0,0,0-.44-0.36,3.37,3.37,0,0,1-2.34-1.73c-0.49-.67-2.7-4-2.83-4.31a0.45,0.45,0,0,1,0-.23c0.91-1.27,2.17-2.7,2.85-3.52a3.79,3.79,0,0,1,2.38-1.41,0.5,0.5,0,0,0,.44-0.34,0.44,0.44,0,0,0-.46-0.21c-0.44,0-1.56.06-2,.06s-1.12,0-1.69,0c-0.36,0-.53.1-0.53,0.25a0.49,0.49,0,0,0,.48.34c0.67,0.13,1,.34.72,0.89a32.86,32.86,0,0,1-2.53,3.44,0.14,0.14,0,0,1-.19,0,33.44,33.44,0,0,1-2.3-3.63c-0.21-.38,0-0.59.34-0.68s0.46-.21.46-0.36a0.43,0.43,0,0,0-.47-0.21c-0.55,0-.91,0-1.63,0s-2-.1-2.39-0.1S504,490.84,504,491Z",transform:"translate(-484.44 -490.06)"})," "]})," "]})," "]})})},98519:(e,t,n)=>{n.d(t,{k:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("thinCheck",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},16695:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("thinCheckboxCircle",{viewBox:"0 0 22 23",svg:(0,i.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"1"})})},33676:(e,t,n)=>{n.d(t,{A:()=>a});n(67294);var o=n(45238),i=n(39986),r=n(85893);const a=(0,o.I)("thumbDown",{viewBox:"0 0 18 19",svg:(0,r.jsx)("g",{transform:"rotate(180 9 9.5)",children:i.f})})},97022:(e,t,n)=>{n.d(t,{E:()=>a});n(67294);var o=n(45238),i=n(10498),r=n(85893);const a=(0,o.I)("thumbDownFilled",{viewBox:"0 0 16 18",svg:(0,r.jsx)("g",{transform:"rotate(180 8 9)",children:i.O})})},39986:(e,t,n)=>{n.d(t,{P:()=>r,f:()=>i});n(67294);var o=n(45238);const i=(0,n(85893).jsx)("path",{d:"M0.539062 12.3125C0.539062 15.0547 2.29688 17.3125 4.54688 17.3125H7.11719C8.17188 17.8516 9.42188 18.1641 10.8047 18.1641H11.8906C12.9062 18.1641 13.7734 18.1016 14.3359 17.9609C15.4766 17.6797 16.1953 16.8672 16.1953 15.8516C16.1953 15.6641 16.1719 15.5 16.1172 15.3281C16.6562 14.9141 16.9609 14.2969 16.9609 13.6328C16.9609 13.3203 16.8984 13.0078 16.7891 12.7578C17.1484 12.375 17.3594 11.8203 17.3594 11.25C17.3594 10.875 17.2656 10.4922 17.1094 10.2031C17.3281 9.86719 17.4531 9.42188 17.4531 8.9375C17.4531 7.69531 16.5078 6.73438 15.2734 6.73438H12.3672C12.1953 6.73438 12.0859 6.65625 12.0938 6.50781C12.1328 5.69531 13.4062 3.75781 13.4062 2.17188C13.4062 1.01562 12.5859 0.171875 11.4688 0.171875C10.6484 0.171875 10.0859 0.59375 9.55469 1.61719C8.58594 3.48438 7.40625 5.125 5.65625 7.28125H4.25C2.14844 7.28125 0.539062 9.52344 0.539062 12.3125ZM5.375 12.25C5.375 10.5938 5.75 9.53125 6.80469 8.11719C7.99219 6.53125 9.625 4.63281 10.8125 2.27344C11.0625 1.77344 11.2344 1.64844 11.4844 1.64844C11.7891 1.64844 11.9844 1.86719 11.9844 2.25C11.9844 3.42188 10.6641 5.35156 10.6641 6.61719C10.6641 7.55469 11.4219 8.15625 12.4375 8.15625H15.2422C15.7031 8.15625 16.0391 8.5 16.0391 8.95312C16.0391 9.28125 15.9297 9.5 15.6562 9.76562C15.4609 9.96875 15.4375 10.25 15.6094 10.4453C15.8359 10.7734 15.9375 10.9844 15.9375 11.25C15.9375 11.5781 15.7812 11.8516 15.4609 12.0938C15.2031 12.2812 15.1094 12.5859 15.2656 12.8828C15.4297 13.2109 15.5156 13.3672 15.5156 13.6172C15.5156 14 15.2734 14.2891 14.7812 14.5469C14.5312 14.6875 14.4609 14.9531 14.5703 15.1875C14.7344 15.5938 14.7578 15.6641 14.7578 15.8438C14.7578 16.1797 14.5078 16.4531 13.9766 16.5859C13.5156 16.7031 12.7812 16.75 11.8203 16.7422L10.8125 16.7344C7.57031 16.7031 5.375 14.8828 5.375 12.25ZM1.9375 12.3125C1.9375 10.3281 2.96094 8.73438 4.14062 8.6875C4.34375 8.6875 4.55469 8.6875 4.75781 8.6875C4.20312 9.76562 3.95312 10.8984 3.95312 12.25C3.95312 13.6875 4.46094 14.9531 5.375 15.9453C5.07812 15.9453 4.76562 15.9375 4.46875 15.9375C3.10156 15.8906 1.9375 14.2812 1.9375 12.3125Z"}),r=(0,o.I)("thumbUp",{viewBox:"0 0 18 19",svg:i})},10498:(e,t,n)=>{n.d(t,{O:()=>i,w:()=>r});n(67294);var o=n(45238);const i=(0,n(85893).jsx)("path",{d:"M4 12.1875C3.99219 15.1641 6.34375 17.4297 10.0859 17.4375H11.1719C12.1953 17.4375 12.9766 17.3594 13.4297 17.2422C14.1016 17.0781 14.7031 16.6562 14.7031 15.8828C14.7031 15.5859 14.625 15.3594 14.5312 15.1875C14.4766 15.1016 14.4922 15.0234 14.5703 14.9922C15.0859 14.7578 15.4766 14.2812 15.4766 13.6562C15.4766 13.2969 15.375 12.9766 15.2031 12.75C15.125 12.6406 15.1406 12.5469 15.2656 12.4766C15.625 12.25 15.875 11.7891 15.875 11.2656C15.875 10.8828 15.7578 10.4844 15.5547 10.2812C15.4453 10.1797 15.4609 10.1094 15.5781 10.0156C15.8281 9.78906 15.9844 9.41406 15.9844 8.96094C15.9844 8.15625 15.3516 7.5 14.5234 7.5H11.7031C11.0234 7.5 10.5781 7.15625 10.5781 6.60156C10.5781 5.54688 11.9141 3.57812 11.9141 2.14844C11.9141 1.375 11.4219 0.90625 10.75 0.90625C10.1641 0.90625 9.85938 1.28906 9.53125 1.9375C8.33594 4.24219 6.75781 6.11719 5.54688 7.72656C4.49219 9.11719 4.00781 10.3125 4 12.1875ZM0.015625 12.25C0.015625 14.6719 1.52344 16.6719 3.53125 16.6719H4.89062C3.47656 15.5938 2.85156 13.9922 2.86719 12.1719C2.875 10.2031 3.57812 8.77344 4.32031 7.79688H3.23438C1.41406 7.79688 0.015625 9.75 0.015625 12.25Z"}),r=(0,o.I)("thumbUpFilled",{viewBox:"0 0 16 18",svg:i})},91:(e,t,n)=>{n.d(t,{L:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("triangle",{viewBox:"0 0 100 100",svg:(0,i.jsx)("polygon",{points:"5.9,88.2 50,11.8 94.1,88.2 "})})},77926:(e,t,n)=>{n.d(t,{l:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("twitter",{viewBox:"0 0 300 300",svg:(0,i.jsx)("path",{d:"M103.62,251.13969 C197.96,251.13969 249.56,172.97969 249.56,105.19969 C249.56,102.97969 249.56,100.76969 249.41,98.5696903 C259.448314,91.3087989 268.113555,82.3184843 275,72.0196903 C265.638791,76.167708 255.708293,78.8879768 245.54,80.0896903 C256.24744,73.6795109 264.261235,63.5974102 268.09,51.7196903 C258.021575,57.6942435 247.006461,61.9048105 235.52,64.1696903 C219.620828,47.2636331 194.357194,43.1258162 173.895493,54.0764896 C153.433792,65.027163 142.86275,88.3429476 148.11,110.94969 C106.868957,108.882186 68.4447578,89.402923 42.4,57.3596903 C28.7862276,80.7961376 35.7398788,110.778285 58.28,125.82969 C50.117412,125.587766 42.1327937,123.385822 35,119.40969 C35,119.61969 35,119.83969 35,120.05969 C35.0066813,144.47562 52.2175149,165.505042 76.15,170.33969 C68.598696,172.399091 60.6758059,172.700133 52.99,171.21969 C59.7094793,192.113919 78.9657456,206.427529 100.91,206.83969 C82.7473504,221.11401 60.3105951,228.862968 37.21,228.83969 C33.1290357,228.831856 29.0520407,228.584765 25,228.09969 C48.4563595,243.152456 75.749134,251.13686 103.62,251.09969"})})},51929:(e,t,n)=>{n.d(t,{G:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("typeform",{viewBox:"0 0 30 31",svg:(0,i.jsx)("path",{d:"M15.027 30.53c-4.294-.036-8.467-2.247-11.47-5.222C.553 22.333-.09 19.78.009 15.654.107 11.53 1.2 7.81 4.047 4.68 6.895 1.55 10.121.11 14.25.006c4.129-.103 7.291 1.046 10.44 4.156 3.15 3.11 5.242 7.127 5.31 11.392.067 4.266-1.978 6.94-4.972 9.936-2.994 2.995-5.706 5.077-10 5.04zm-4.891-19.66h3.818v10.304h1.903V10.87h3.818V9.071h-9.54v1.798z"})})},55863:(e,t,n)=>{n.d(t,{s:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("undo",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M14.542 10.6826C14.542 7.96875 12.71 6.10254 9.59961 6.10254H5.29297L3.70703 6.1709L4.91016 5.15234L6.67383 3.43652C6.80371 3.30664 6.89258 3.14258 6.89258 2.91699C6.89258 2.5 6.59863 2.19238 6.1543 2.19238C5.96973 2.19238 5.76465 2.28125 5.61426 2.4248L1.69043 6.29395C1.5332 6.4375 1.45117 6.64258 1.45117 6.84766C1.45117 7.05273 1.5332 7.25098 1.69043 7.40137L5.61426 11.2705C5.76465 11.4141 5.96973 11.5029 6.1543 11.5029C6.59863 11.5029 6.89258 11.1953 6.89258 10.7715C6.89258 10.5527 6.80371 10.3887 6.67383 10.252L4.91016 8.53613L3.70703 7.52441L5.29297 7.59277H9.64746C11.8486 7.59277 13.0586 8.84375 13.0586 10.6211C13.0586 12.4053 11.8486 13.7109 9.64746 13.7109H8.05469C7.60352 13.7109 7.2959 14.0459 7.2959 14.4629C7.2959 14.873 7.61035 15.208 8.05469 15.208H9.69531C12.751 15.208 14.542 13.4102 14.542 10.6826Z"})})},95097:(e,t,n)=>{n.d(t,{H:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("video",{viewBox:"0 0 30 30",svg:(0,i.jsx)("path",{d:"M2,2v26h26V2H2z M26,6h-2V4h2V6z M22,14H8V4h14V14z M6,10H4V8h2V10z M6,12v2H4v-2H6z M6,16v2H4v-2H6z M6,20v2H4v-2H6z M8,16 h14v10H8V16z M24,20h2v2h-2V20z M24,18v-2h2v2H24z M24,14v-2h2v2H24z M24,10V8h2v2H24z M6,4v2H4V4H6z M4,24h2v2H4V24z M24,26v-2h2v2 H24z"})})},54497:(e,t,n)=>{n.d(t,{t:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("warning",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M1.619 12.581h9.96c.983 0 1.618-.73 1.618-1.625 0-.266-.07-.54-.21-.793L7.998 1.25a1.593 1.593 0 00-2.8 0L.217 10.163c-.14.26-.216.527-.216.793 0 .895.635 1.625 1.619 1.625zm4.989-4.367c-.375 0-.59-.21-.603-.584l-.089-3.174c-.013-.394.267-.666.686-.666.406 0 .704.279.691.672l-.101 3.162c-.013.387-.222.59-.584.59zm0 2.196c-.432 0-.787-.31-.787-.73 0-.419.349-.73.787-.73.432 0 .78.311.78.73 0 .425-.355.73-.78.73z"})})},98616:(e,t,n)=>{n.d(t,{A:()=>r});n(67294);var o=n(45238),i=n(85893);const r=(0,o.I)("whimsical",{viewBox:"0 0 32 32",svg:(0,i.jsxs)("g",{children:[(0,i.jsx)("path",{opacity:".8",fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#A7A6A2"}),(0,i.jsx)("mask",{id:"a",maskUnits:"userSpaceOnUse",x:"3",y:"7",width:"19",height:"19",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#fff"})}),(0,i.jsx)("g",{filter:"url(#filter0_d)",mask:"url(#a)",children:(0,i.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#000",fillOpacity:".01"})}),(0,i.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#A7A6A2"}),(0,i.jsx)("defs",{children:(0,i.jsxs)("filter",{id:"filter0_d",x:"8.055",y:"4.964",width:"22.98",height:"23.071",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,i.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,i.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,i.jsx)("feOffset",{}),(0,i.jsx)("feGaussianBlur",{stdDeviation:"1.018"}),(0,i.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.6 0"}),(0,i.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow"}),(0,i.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})]})})]})})},74229:(e,t,n)=>{n.d(t,{H1:()=>o});n(57658);const o={is:e=>i(e),async*fromValues(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];yield*t},async collect(e){const t=[];for await(const n of e)t.push(n);return t},async*withIndex(e){let t=0;for await(const n of e)yield[t,n],t++},async*chunk(e,t){let n=[];for await(const o of e)n.push(o),n.length>=t&&(yield n,n=[]);n.length>0&&(yield n)},async*map(e,t){for await(const n of e)yield t(n)},async*concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(const o of t)yield*o},async*filter(e,t){for await(const n of e){t(n)&&(yield n)}},async*take(e,t){let n=0;for await(const o of e)if(yield o,n+=1,n>=t)break},withSideEffect:(e,t)=>Object.assign({},e,{async*[Symbol.asyncIterator](){for await(const n of e)await t(n),yield n}}),async*ensureReturned(e){try{for await(const t of e)yield t}finally{var t;if(r(e))await(null===(t=e.return)||void 0===t?void 0:t.call(e))}}};function i(e){return Symbol.asyncIterator in e}function r(e){return"next"in e}},25718:(e,t,n)=>{n.d(t,{Lk:()=>D,wB:()=>x,dx:()=>I,c8:()=>$,lM:()=>Q,on:()=>Y,CK:()=>H,WB:()=>R});n(57658);var o=n(67266),i=n.n(o),r=n(41432),a=n(80951),s=n(7057),l=n(14215),c=n(95538),d=n(64962),u=n(61075),p=n(64572),m=n(22808),f=n(72126),g=n(59753),h=n(21202);var v=n(19233),b=n(606),y=n(70279),_=n(19889),S=n(70203);n(29477);var w=n(97880),k=n(7928);function I(e){const t=S.J7s(e);return"a"===t?"[":"b"===t?"**":"i"===t?"*":"c"===t?"`":"s"===t?"~~":"e"===t?"$":""}function x(e,t,n){const o=S.J7s(e);if(S.j0F(e)){const o=S.zW$(e),i=(0,p.A5)({...n,url:o});return`](${(i?t({toPageId:i}):o)||""})`}return"b"===o?"**":"i"===o?"*":"c"===o?"`":"s"===o?"~~":"e"===o?"$":""}function C(e){const{annotation:t,exportArgs:n}=e,{getRecordValue:o,userTimeZone:i,getExportedPathToPage:r,intl:a,transformAnnotation:l}=n;if(l){const e=l(t,n);if("string"==typeof e)return e}if(S.IWo(t)){const e=S.zEN(t),n=o({table:_.KJ,id:e});return`@${(0,k.Nz)(a,n)}`}if(S.STW(t)){const e=S.TOT(t),i=o({table:h.iU,id:e});if(i){return`[${R({block:i,exportArgs:n})}](${r({toPageId:e})})`}}else{if(S.K$_(t)){var c;const e=S.r3j(t),i=o({table:y.x_,id:e,spaceId:n.root.spaceId});return null==i||null===(c=i.text)||void 0===c?void 0:c.toString()}if(S.fpG(t)){const{date_format:e,time_format:o,...r}=S.zyO(t);return(0,s.ZV)({value:r,date_format:e,time_format:o,userTimeZone:i,allowRelativeDates:!1,intl:n.intl})}if(S.kuv(t))return S.xey(t);if(S._bk(t)){const e=(0,u.kF)({annotation:t,exportArgs:n});if(e)return e}else{if(S.nSN(t)){var d;const e=S.frW(t);return null===(d=o({table:h.iU,id:e,spaceId:n.root.spaceId}))||void 0===d||null===(d=d.format)||void 0===d?void 0:d.original_url}if(S.OU5(t))return"";if(S.inx(t)||S.j0F(t)||S.aC4(t)||S.xw5(t)||S.pV3(t)||S.STW(t)||S.rIb(t)||S.LAI(t)||S.fTS(t)||S.aq(t)||S.QVC(t)||S.uge(t)||S.Lyt(t)||S.wjk(t))return;(0,w.t1)(t)}}}const T=e=>{const t=/^\s+/.exec(e);return t?t[0]:""},M=e=>{const t=/\s+$/.exec(e);return t?t[0]:""},P=e=>{const t=M(e);return t.length>0?e.slice(0,-1*t.length):e},A=e=>{const t=T(e);return e.slice(t.length)};function R(e){const{block:t,exportArgs:n}=e;return H({textValue:S.lzi(g.kk.fromBlock(t).getProperties().title),exportArgs:n})}function D(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n,i=t&&t.content?t.content:[];return f.oA(f.UI(i,(t=>z({block:o({table:h.iU,id:t}),exportArgs:{...n,blockId:t},visitedBlock:e.visitedBlock}))))}function B(e){return e.split("\n")}function E(e){const{block:t,exportArgs:n}=e,o=S.lzi(g.kk.fromBlock(t).getProperties().caption);return o.length>0?[{text:H({textValue:o,exportArgs:n}),breakLines:!0,children:[]}]:[]}function F(e){const{block:t,exportArgs:n}=e;return H({textValue:S.lzi(g.kk.fromBlock(t).getProperties().caption),exportArgs:n})}function Z(e){return{text:"",breakLines:!0,children:D(e)}}function V(){}function j(e){const{block:t,exportArgs:n}=e;return{text:`# ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:D(e)}}function U(e){const{block:t,exportArgs:n}=e;return{text:`- ${R({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:W,children:D(e)}}function L(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:i}=g.kk.fromBlock(t).getProperties(),r=S.QaF(i),a=o({fromBlockId:n.blockId,toFileURI:r});return{text:`[${F(e)||R({block:t,exportArgs:n})||a}](${a})`,breakLines:!0,children:E(e)}}function O(e){const{block:t,exportArgs:n}=e,{getRecordValue:o,getExportedPathToPage:i,userTimeZone:r,intl:a}=n;if("collection_view"===t.type||"collection_view_page"===t.type){return{text:`[${(0,u.Ho)({blockId:t.id,getRecordValue:o,userTimeZone:r,intl:a})}](${i({toPageId:t.id,exportFileExt:".csv"})})`,breakLines:!0,children:[]}}}const N={text:function(e){const{block:t,exportArgs:n}=e;return{text:R({block:t,exportArgs:n}),breakLines:!0,children:D(e)}},header:j,sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`## ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:D(e)}},sub_sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`### ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:D(e)}},quote:function(e){const{block:t,exportArgs:n}=e;return{text:`> ${R({block:t,exportArgs:n}).trim()}`,breakLines:!0,childrenPrefix:"> ",children:D(e)}},bulleted_list:U,toggle:U,to_do:function(e){const{block:t,exportArgs:n}=e;let o;return o=a.Ml(g.kk.fromBlock(t).getProperties().checked)?"- [x] ":"- [ ] ",{text:`${o} ${R({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:W,children:D(e)}},numbered_list:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;return{text:`${function(e){const{block:t,getRecordValue:n}=e,o=t.parent_id,i=n({table:h.iU,id:o});let a;a=i?f.oA(f.UI(i.content,(e=>n({table:h.iU,id:e})))):[];const s=f.cx(a,(e=>e.id===t.id)),l=f.tP(a,0,s),c=f.qr(l,(e=>e.type!==r.Ti.numberedList));return l.length-(c+1)}({block:t,getRecordValue:o})+1}. ${R({block:t,exportArgs:n})}`,breakLines:!1,childrenPrefix:W,children:D(e)}},code:function(e){const{block:t,exportArgs:n}=e,o=R({block:t,exportArgs:n});return{text:`${`\`\`\`${t.properties&&t.properties.language?function(e){const t=S.QaF(e);if(!t)return"";const n=v.W[t];return void 0===n||n===v.W["Plain Text"]?"":n}(t.properties.language):""}\n${B(o).join("\n")}\n\`\`\``}`,breakLines:!0,children:[]}},page:function(e){const{block:t,exportArgs:n}=e;if(t.id===n.navigableBlockId&&!n.renderParentBlockId)return j(e);const{getExportedPathToPage:o}=n;return{text:`[${R({block:t,exportArgs:n})}](${o({toPageId:t.id})})`,breakLines:!0,children:[]}},image:function(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:i}=g.kk.fromBlock(t).getProperties(),r=S.QaF(i),a=o({fromBlockId:n.blockId,toFileURI:r}),s=F(e)||R({block:t,exportArgs:n})||a;return{text:(0,c.SR)({url:r})?`![${s}](${a})`:`[${s}](${a})`,breakLines:!0,children:E(e)}},video:L,embed:L,bookmark:function(e){const{block:t,exportArgs:n}=e,{link:o}=g.kk.fromBlock(t).getProperties(),i=a.zB(o);return{text:`[${R({block:t,exportArgs:n})}](${i})`,breakLines:!0,children:E(e)}},file:L,external_object_instance:function(e){var t;const{block:n}=e,o=null===(t=n.format)||void 0===t?void 0:t.original_url;if(o)return{text:`[${o}](${o})`,breakLines:!0,children:[]}},tweet:L,maps:L,gist:L,framer:L,invision:L,mixpanel:L,drive:function(e){const{block:t}=e;if(t.format&&t.format.drive_properties){const{url:e,title:n}=t.format.drive_properties;return{text:`[${n}](${e})`,breakLines:!0,children:[]}}return L(e)},figma:L,loom:L,pdf:L,typeform:L,codepen:L,audio:L,divider:function(){return{text:"---",breakLines:!0,children:[]}},equation:function(e){const{block:t}=e;let n="";return t&&t.properties&&t.properties.title&&(n=S.QaF(t.properties.title)),{text:`$$\n${n}\n$$`,breakLines:!0,children:[]}},collection_view:O,collection_view_page:O,column_list:Z,column:Z,factory:V,personal_home_page:V,copy_indicator:V,breadcrumb:V,link_to_collection:V,link_to_page:V,callout:function(e){var t;const{block:n,exportArgs:o}=e,i=R({block:n,exportArgs:o}),r=null===(t=n.format)||void 0===t?void 0:t.page_icon;return{text:`${(0,m.Z)(r)?r:"string"==typeof r?function(e){let{source:t,width:n=40,exportArgs:o}=e;const{getExportedRenderAsset:i}=o,r=i({fromBlockId:o.blockId,toFileURI:t});return`<img src="${r}" alt="${r}" width="${n}px" />`}({source:r,exportArgs:o}):""} ${i}`.trim(),breakLines:!0,children:D(e),htmlTag:"aside"}},table_of_contents:V,whimsical:L,miro:L,abstract:L,sketch:L,excalidraw:L,replit:L,hex:L,deepnote:L,alias:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.alias_pointer&&(0,b.$O)(t.format.alias_pointer,h.iU)){const i=o(t.format.alias_pointer);if(i)return z({block:i,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.alias_pointer.id},visitedBlock:e.visitedBlock})}},transclusion_container:Z,transclusion_reference:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.transclusion_reference_pointer){const i=o(t.format.transclusion_reference_pointer);if(i)return z({block:i,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.transclusion_reference_pointer.id},visitedBlock:e.visitedBlock})}},table:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i}=o,r=(null===(t=n.format)||void 0===t||null===(t=t.table_block_column_order)||void 0===t?void 0:t.length)||0,a=n.content,s={text:"",breakLines:!0,children:[]};if(0===r||!a)return s;const l=a.map((t=>{const r=i({table:h.iU,id:t});return r&&z({block:r,exportArgs:{...o,blockId:t,renderParentBlockId:n.id},visitedBlock:e.visitedBlock})||s})),c={text:`| ${[...Array(r).keys()].map((()=>"---")).join(" | ")} |`,breakLines:!1,children:[]};return{text:"",breakLines:!0,children:[l[0],c,...l.slice(1)]}},table_row:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i,renderParentBlockId:r}=o;if(!r)return;const s=i({table:h.iU,id:r}),l=null==s||null===(t=s.format)||void 0===t?void 0:t.table_block_column_order;if(!l)return;return{text:`| ${l.map((t=>{const o=a.wS(n,t);return o?(0,u.hJ)({textValue:o,fromString:e=>e,exportArgs:e.exportArgs,renderers:d.O}).join(""):void 0})).join(" | ")} |`,breakLines:!1,children:[]}},tab:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:i}=o;return{text:`${f.oA(null===(t=n.content)||void 0===t?void 0:t.flatMap((e=>{const t=i({table:h.iU,id:e});if(t)return[R({block:t,exportArgs:o}),q(D({block:t,exportArgs:o})).trim()]}))).join("\n\n")}\n\t\t`,breakLines:!0,children:[]}},external_object_instance_page:V,button:V,ai_block:Z,drawing:V};function z(e){const{block:t,forceRenderAsText:n,exportArgs:{transformBlockMapping:o}}=e;if(t&&t.type){if(e.visitedBlock){if(e.visitedBlock.has(t.id))return;e.visitedBlock.add(t.id)}const i=n&&r.wL[t.type]?(null==o?void 0:o.text)??N.text:(null==o?void 0:o[t.type])??N[t.type];if(i)return i(e)}}const W="    ";function q(e){let t="";for(const n of e){n.breakLines&&(t+="\n"),n.htmlTag&&(t+=`<${n.htmlTag}>\n`),n.text&&(t+=`${n.text}\n`),n.breakLines&&(t+=n.childrenPrefix?`${n.childrenPrefix}\n`:"\n");let e=q(n.children);if(e&&n.childrenPrefix){const t=B(e);e=[...t.slice(0,-1).map((e=>n.childrenPrefix+e)),...t.slice(-1)].join("\n")}t+=`${e}`,n.htmlTag&&(t+=`</${n.htmlTag}>\n\n`),n.suffix&&(t+=`${n.suffix}\n\n`)}return t=t.replace(/[\n]{3,}/g,"\n\n"),t}function H(e){const{textValue:t,exportArgs:n}=e;let o="";const r=S.lzi(t);let a=[];for(const c of r){const e=S.hDy(c),t=(0,l.N)(a,e,(e=>i()(e))),r=S.WiV(c),s=e.map((e=>C({annotation:e,exportArgs:n}))).find((e=>(0,w.$K)(e)))??r,d=M(o);o=P(o),t.deleted.reverse();for(const i of t.deleted)o+=x(i,n.getExportedPathToPage,n);o+=d,o+=T(s);for(const n of t.created)o+=I(n);o+=A(s);a=[...f.DY(a,e,((e,t)=>f.Xy(e,t))),...t.created]}const s=M(o);o=P(o),a.reverse();for(const i of a)o+=x(i,n.getExportedPathToPage,n);return o+=s,o}function K(e,t){const n=(new e).match(t)||[];if(0===n.length)return t;let o="",i=0;for(const r of n){const e=0===r.index||"<"!==t[r.index-1],n=r.lastIndex===t.length||">"!==t[r.lastIndex],a=Boolean(t.slice(r.index).match(/^[a-z][a-z]+:/i)),s=e&&n&&a;o+=t.slice(i,r.index),s&&(o+="<"),o+=r.raw,s&&(o+=">"),i=r.lastIndex}return o+=t.slice(i),o}function G(e){return e.replace(/\\/g,"\\\\")}const $=e=>{const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:i}=e,r=new t({linkify:!0});return i&&r.use(i),r.render(G(K(n,o)))},Q=e=>{const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:i}=e,r=new t({linkify:!0});return i&&r.use(i),r.renderInline(G(K(n,o)))};function Y(e,t){const n=new Set;return q(f.oA(e.map((e=>z({block:e,exportArgs:{...t,blockId:e.id},visitedBlock:n}))))).trim()}},44615:(e,t,n)=>{n.d(t,{Cy:()=>v,JK:()=>C,JY:()=>g,Lp:()=>b,Mv:()=>S,NP:()=>k,Ns:()=>_,T0:()=>I,ZS:()=>p,bS:()=>h,e7:()=>T,jY:()=>f,je:()=>y,pD:()=>x,pb:()=>w,pz:()=>m});var o=n(606),i=n(21202),r=n(6287),a=n(13493),s=n(80396),l=n(15047),c=n(77858),d=n(29369);const u={[l.bx]:!0,[i.iU]:!0,[a.n]:!0,[r.v]:!0,[c.zU]:!0,[d.e0]:!0,[s.yo]:!0};function p(e){return(0,o.UI)(e.table)&&!(e.table in u)?`versions/${e.id}:${e.table}:${e.spaceId}`:`versions/${e.id}:${e.table}`}function m(e){const t=e.indexOf("/");if(-1===t)return;const n=e.substring(t+1).split(":");return 2===n.length?o.dr.fromPointerLike({table:n[1],id:n[0]}):3===n.length?o.dr.fromPointerLike({table:n[1],id:n[0],spaceId:n[2]}):void 0}function f(e){return`collection/${e}`}function g(e){return`typedDatabasesListChanged/${e.spaceId}-${e.databaseType}`}function h(e){return`activity/${e}`}function v(e){return`activity/${e}`}function b(e){return`notification/${e}`}function y(e){return`teams_in_space/${e}`}function _(e){return`user_page_visit/${e}`}function S(e){return`backlinks/${e}`}function w(e){return`page_visit/${e}`}function k(e){return`user_shared_pages_in_space/${e.spaceId}-${e.userId}`}function I(e){return`presence/${e}`}function x(e){return`user_joined_teams_in_space/${e.userId}:${e.spaceId}`}function C(e){return`diagnosticPing/${e}`}function T(e){return`presence/drawing/${e}`}},56589:(e,t,n)=>{function o(e,t){return t&&e.redirect_uris.includes(t)?t:t||1!==e.redirect_uris.length?void 0:e.redirect_uris[0]}n.d(t,{_:()=>o})},82036:(e,t,n)=>{n.d(t,{_:()=>o});const o={invalid_request:"invalid_request",unauthorized_client:"unauthorized_client",access_denied:"access_denied",unsupported_response_type:"unsupported_response_type",invalid_scope:"invalid_scope",server_error:"server_error",temporarily_unavailable:"temporarily_unavailable"}},77337:(e,t,n)=>{n.d(t,{FS:()=>D,bv:()=>T,lK:()=>C,Iw:()=>A});n(21703),n(57658);var o=n(40902),i=n(53504),r=n(79317),a=n(59730),s=(n(30541),n(72126));function l(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t!==e.id)),n}function c(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t&&t.id&&t.id!==e.remove.id)),n}var d=n(59753),u=n(482),p=n(86517),m=n(80951),f=n(606),g=n(21202);n(70203);function h(e,t){const n=(0,m.rq)(t).filter((t=>t.id!==e.id));return(0,m.ow)(n)}function v(e,t){const n=(0,m.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"removeRelation",args:{id:e.args.id,spaceId:e.args.spaceId}}:o===n.length-1?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n[o+1].id,spaceId:e.args.spaceId}}}var b=n(76462),y=n(64684),_=n(67175),S=n(97880),w=n(63143);const k={set:e=>e,update:(e,t)=>(t||(t={}),{...t,...e}),listBefore:function(e,t){let n=Array.isArray(t)?t:[];n=l({id:e.id},n);const o=s.cx(n,(t=>t===e.before));return o>=0?n.splice(o,0,e.id):n.unshift(e.id),n},listAfter:function(e,t){let n=Array.isArray(t)?t:[];n=l({id:e.id},n);const o=s.cx(n,(t=>t===e.after));return o>=0?n.splice(o+1,0,e.id):n.push(e.id),n},listRemove:l,listReplace:function(e,t){let n=Array.isArray(t)?t:[];return n=n.map((t=>t===e.id?e.newId:t)),n},listAfterMulti:function(e,t){const n=new Set(e.ids),o=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),i=s.cx(o,(t=>t===e.after));return i>=0?o.splice(i+1,0,...e.ids):o.push(...e.ids),o},listBeforeMulti:function(e,t){const n=new Set(e.ids),o=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),i=s.cx(o,(t=>t===e.before));return i>=0?o.splice(i,0,...e.ids):o.unshift(...e.ids),o},keyedObjectListBefore:function(e,t){let n=Array.isArray(t)?t:[];n=c({remove:{id:e.value.id}},n);const o=e.before?e.before.id:void 0,i=s.cx(n,(e=>e&&e.id&&e.id===o));return i>=0?n.splice(i,0,e.value):n.unshift(e.value),n},keyedObjectListAfter:function(e,t){let n=Array.isArray(t)?t:[];n=c({remove:{id:e.value.id}},n);const o=e.after?e.after.id:void 0,i=s.cx(n,(e=>e&&e.id&&e.id===o));return i>=0?n.splice(i+1,0,e.value):n.push(e.value),n},keyedObjectListRemove:c,keyedObjectListUpdate:function(e,t){const n=Array.isArray(t)?[...t]:[],o=s.cx(n,(t=>t&&t.id&&t.id===e.value.id));return o>=0?n[o]=e.value:n.push(e.value),n},appendActivity:o.tR,setPermissionItem:p.r2,setSingletonPermissionItem:p.co,addRelation:function(e,t){const n=(0,m.rq)(t),o={id:e.id,spaceId:e.spaceId,table:g.iU},i=f.dr.uniq([...n,o]);return(0,m.ow)(i)},addRelationAfter:function(e,t){const n=h({id:e.id,spaceId:e.spaceId},t),o=(0,m.rq)(n),i={id:e.id,spaceId:e.spaceId,table:g.iU};let r;if(e.after){const t=o.findIndex((t=>t.id===e.after));r=f.dr.uniq([...o.slice(0,t+1),i,...o.slice(t+1)])}else r=f.dr.uniq([...o,i]);return(0,m.ow)(r)},addRelationBefore:function(e,t){const n=h({id:e.id,spaceId:e.spaceId},t),o=(0,m.rq)(n),i={id:e.id,spaceId:e.spaceId,table:g.iU};let r;if(e.before){const t=o.findIndex((t=>t.id===e.before));r=f.dr.uniq([...o.slice(0,t),i,...o.slice(t)])}else r=f.dr.uniq([i,...o]);return(0,m.ow)(r)},addRelations:function(e,t){const n=s.Kn(t)?t:{},o={...n};for(const i in e){const t=e[i],r=(0,m.rq)(n[i]),a=f.dr.uniq([...r,...t.map((e=>({id:e.id,spaceId:e.spaceId,table:g.iU})))]);o[i]=(0,m.ow)(a)}return o},removeRelation:h,copyFile:(e,t)=>{const n=t.file_ids||[];return n.includes(e.fileId)?{...t}:{...t,file_ids:[...n,e.fileId]}},removeTeamMembershipItem:y.Uk,setTeamMembershipItem:y.I6};const I=(e,t)=>function(e,t){if(0!==e.path.length||!(0,S.Kn)(t)||0!==Object.keys(t).length||!(0,S.Kn)(e.args))return!1;const n=e.args.format;return!!(0,S.Kn)(n)&&!0===n.use_crdt}(e,t)?{pointer:e.pointer,path:[],command:"update",args:{alive:!1}}:{pointer:e.pointer,path:e.path,command:"set",args:w.z4(t)?null:t};function x(e){return void 0===e.size?1:e.size}const C=function(e,t){let n,o,r=t||{};if(n=e.path.length>0?s.U2(r,e.path):r,o=r.version?r.version+x(e):x(e),!k[e.command])throw new Error(`Unknown operation command ${e.command}.`);if(void 0!==e.expectedVersion&&r.version&&e.expectedVersion!==r.version)throw new a.vq("Mismatching expected and actual versions for the record",{clientData:{type:"operation_conflict",expectedVersion:e.expectedVersion,currentVersion:r.version,command:e.command,path:e.path,pointer:e.pointer}});n=(0,k[e.command])(e.args,n);r=e.path.length>0?function(e,t,n){if(0===t.length)throw new a.D3("Empty path to set");const o=s.d9(e);let i=o;for(let r=0;r<t.length;r++){const e=t[r];if(r===t.length-1)i[e]=n;else{let n=s.d9(i[e]);null==n&&(n="number"==typeof t[r+1]?[]:{}),i[e]=n,i=n}}return o}(r,e.path,n):n;const l=b.ZP[e.pointer.table],c=l.requiredColumns||{},d=l.defaultColumnValues||{};for(const i of Object.keys(c))!t||w.z4(t[i])||r&&!w.z4(r[i])||(d.hasOwnProperty(i)?r[i]=d[i]:r[i]=t[i]);if(r&&t){const e=t.file_ids||[];(r.file_ids||[]).length<e.length&&(r.file_ids=e)}return r=(0,i.Z)(r,"mangle-class-instances")||{},r.id=e.pointer.id,r.version=o,r},T=function(e,t){let n;switch(t=t||{},n=e.path.length>0?s.U2(t,e.path):t,e.command){case"set":return I(e,n);case"update":return((e,t)=>{t||(t={});const n={};return Object.keys(e.args).forEach((e=>{n[e]=t[e],void 0===n[e]&&(n[e]=null)})),{pointer:e.pointer,path:e.path,command:"update",args:n}})(e,n);case"listBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id}};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id,before:t}}}return{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:t}}}return 0===o?{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}:{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id)),i=n[o-1];return i?{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:i}}:{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}}(e,n);case"keyedObjectListBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:e.args};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value,before:{id:t.id}}}}return{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:e.args.value,after:{id:t.id}}}}return 0===o?{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.remove.id)),i=n[o],r=n[o-1];return i?r?{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:i,after:{id:r.id}}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:i}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:r.id}}}}(e,n);case"keyedObjectListUpdate":return function(e,t){t||(t={});const n=(Array.isArray(t)?t:[]).find((t=>t.id===e.args.value.id));return n?{pointer:e.pointer,path:e.path,command:"keyedObjectListUpdate",args:{value:n}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"addRelation":case"addRelationAfter":case"addRelationBefore":return v(e,n);case"removeRelation":return function(e,t){const n=(0,m.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:0===o?{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n.length>1?n[1].id:void 0,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,after:n[o-1].id,spaceId:e.args.spaceId}}}(e,n);default:return}};function M(e){let{operation:t,previousOperation:n}=e;return{...t,args:t.args,size:x(t)+x(n)}}function P(e){let{operation:t,previousOperation:n}=e;return{...t,args:{...n.args,...t.args},size:x(t)+x(n)}}function A(e){const[t,...n]=e,o=[t];for(const i of n){const e=o[o.length-1],t=s.Xy(i.pointer,e.pointer)&&s.Xy(i.path,e.path);"set"===i.command&&"set"===e.command&&t?o[o.length-1]=M({operation:i,previousOperation:e}):"update"===i.command&&"update"===e.command&&t?o[o.length-1]=P({operation:i,previousOperation:e}):o.push(i)}return o}function R(e){const{getRecordModel:t,setNewValue:n,primitiveOperation:o,updateOnly:i}=e,r=t.getRecordValue(o.pointer);if(!i||r){const e=C(o,r);n({pointer:o.pointer,newValue:e})}}function D(e){const{recordMap:t,operations:n,updateOnly:o}=e;n.forEach((e=>{if((0,_.Qf)(e))throw new Error("Text operations should be applied separately")})),function(e){const{getRecordModel:t,setNewValue:n,recordOperations:o,updateOnly:i}=e;for(const a of o)if((0,u.S)(a)){const e=(0,r.T1)(a,t.getRecordValue);for(const o of e)R({primitiveOperation:o,getRecordModel:t,setNewValue:n,updateOnly:i})}else R({primitiveOperation:a,getRecordModel:t,setNewValue:n,updateOnly:i})}({getRecordModel:d.om.fromRecordMap(t),setNewValue:e=>{const{pointer:n,newValue:o}=e;t.setValue(n,o)},recordOperations:n,updateOnly:o})}},69246:(e,t,n)=>{n.d(t,{PT:()=>a,cz:()=>r,fY:()=>l,g$:()=>s,kg:()=>o,mu:()=>i});const o="teamSidebar",i="teamBrowserSearch",r="teamBrowserUnjoinedTeams",a="teamBrowserJoinedTeams",s="publicPageTemplateIncludes";function l(e){const{block:t,query:n,getRecordModel:o,userTimeZone:i,intl:r}=e;if(!n)return!0;const a=null==t?void 0:t.getRenderTitle({getRecordModel:o,userTimeZone:i,intl:r});return!!a&&a.toLowerCase().indexOf(n.trim().toLowerCase())>=0}},86517:(e,t,n)=>{n.d(t,{D3:()=>de,FD:()=>re,GU:()=>G,Gx:()=>se,IF:()=>E,IJ:()=>S,KJ:()=>C,Kf:()=>x,L2:()=>Y,N0:()=>$,OC:()=>j,Rh:()=>oe,SL:()=>D,Ub:()=>ee,WM:()=>ie,Wo:()=>Q,Xr:()=>te,YO:()=>L,ZO:()=>_,_G:()=>X,bk:()=>ue,co:()=>I,gr:()=>B,kD:()=>le,mq:()=>ae,nl:()=>T,oF:()=>M,qY:()=>W,r2:()=>k,uH:()=>ne,uq:()=>ce,wN:()=>pe,ws:()=>w,xO:()=>F,yY:()=>R,zX:()=>O});n(57658),n(21703);var o=n(9291),i=n(41432),r=n(15070),a=n(59730),s=n(72126),l=n(59753),c=n(63306),d=n(21202),u=n(77420),p=n(33709),m=n(15047),f=n(29369),g=n(19889),h=(n(47425),n(64684)),v=n(97880),b=n(72141),y=n(8637);function _(e){const{actor:t,ancestors:n,updatedPermissionItem:o}=e;return W({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:(0,y.as)({actorPointers:(0,y.iY)({actors:[t]}),recordMap:void 0})}).some((e=>{const t=x(e.permissionItem,o)?o.role:e.permissionItem.role;return!!t&&(0,b.zz)(t)}))}function S(e){const{actor:t,ancestors:n}=e,o=W({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:(0,y.as)({actorPointers:(0,y.iY)({actors:[t]}),recordMap:void 0})});if(1===o.length){const e=o[0];if((0,b.$D)(e.permissionItem)&&(0,b.YX)(e.permissionItem.role))return e}}function w(e,t){return e.some((e=>"user_permission"===e.type&&e.user_id===t))}function k(e,t){let n=t||[];if("public_permission"===e.type){const t=n.filter((e=>(0,b.$D)(e))).map((e=>e.added_timestamp||0));t.length>0?e.added_timestamp=Math.min(...t):e.added_timestamp=(new Date).getTime()}return n=n.filter((t=>!x(t,e))),n.push(e),n=n.filter((e=>!(0,b.C2)(e)||"none"!==(0,b.cY)(e))),n}function I(e,t){const{singletonPermissionItem:n,set:o}=e;let i=t||[];return i=i.filter((e=>!x(e,n))),o&&i.push(n),i}function x(e,t){return!(!e||!t)&&((0,b.jg)(e)&&(0,b.jg)(t)||(0,b.e_)(e)&&(0,b.e_)(t)?e.user_id===t.user_id:(0,b.FB)(e)&&(0,b.FB)(t)?e.bot_id===t.bot_id:(0,b.hV)(e)&&(0,b.hV)(t)?e.group_id===t.group_id:(0,b.LW)(e)&&(0,b.LW)(t)||(0,b.zU)(e)&&(0,b.zU)(t)?e.team_id===t.team_id:e.type===t.type)}function C(e){return(0,c.gc)(e).map((e=>{if(e.table===d.iU){const t=l.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=l.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:d.iU,blockId:n},permissions:t}}else if(e.table===f.e0){const t=l.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=l.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:f.e0,teamId:n},permissions:t}}})).filter(v.$K)}function T(){let e=0,t="none";for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];for(const a of o)if("string"==typeof a)e=Math.max(e,b.Av.indexOf(a));else for(const e of(0,v.Yd)(a))a[e]&&(t=A(t,e));const r=b.Av[e];return"editor"===r||"read_and_write"===r||"membership_admin"===r?r:"none"!==t&&Object.keys(t).length?("reader"!==r&&"comment_only"!==r&&"content_only_editor"!==r||(t=A(t,"read_content")),t):r}const M=(0,v.AO)((e=>"object"==typeof e?{true:e}:{false:e})),P=(0,v.AO)((e=>(0,r.pH)(e)||(0,r.Ye)(e)||"none"===e?{true:e}:{false:e}));function A(e,t){let n;return"none"===e?"read_content"===t?n={read_content:!0}:"update_content"===t?n={update_content:!0}:"insert_content"===t?n={insert_content:!0}:"read_property"===t||"update_property"===t||"insert_property"===t?n={read_property:!0}:"read_comment"===t?n={read_comment:!0}:"insert_comment"===t?n={insert_comment:!0}:(0,v.t1)(t):(n={...e},"read_content"===t?(n.read_content=!0,delete n.read_property):"update_content"===t?(n.update_content=!0,delete n.update_property):"insert_content"===t?(n.insert_content=!0,delete n.insert_property):"read_property"===t?n.read_content||(n.read_property=!0):"update_property"===t?n.update_content||(n.update_property=!0):"insert_property"===t?n.insert_content||(n.insert_property=!0):"read_comment"===t?n.read_comment=!0:"insert_comment"===t?n.insert_comment=!0:(0,v.t1)(t)),n}function R(e,t){if("string"==typeof e&&"string"==typeof t)return E(e,t);if("string"==typeof e){if("editor"===e||"membership_admin"===e)return!0;e=b.jD[e]}if("string"==typeof t){if("editor"===t||"membership_admin"===t)return!1;t=b.jD[t]}return function(e,t){if("none"===t)return!0;if("none"===e)return!1;let n=!0;for(const o of(0,v.Yd)(t))"read_property"===o?n&&=e.read_property||e.read_content:"update_property"===o?n&&=e.update_property||e.update_content:"insert_property"===o?n&&=e.insert_property||e.insert_content:"read_content"===o?n&&=e.read_content:"update_content"===o?n&&=e.update_content:"insert_content"===o?n&&=e.insert_content:"read_comment"===o?n&&=e.read_comment:"insert_comment"===o?n&&=e.insert_comment:"link_preview"===o||"synced_database"===o||(0,v.t1)(o);return Boolean(n)}(e,t)}function D(e,t){return b.Av.indexOf(e)<=b.Av.indexOf(t)}function B(e,t){return b.Av.indexOf(e)<b.Av.indexOf(t)}function E(e,t){return b.Av.indexOf(e)>=b.Av.indexOf(t)}function F(e,t){return b.Av.indexOf(e)>b.Av.indexOf(t)}function Z(e,t){return void 0!==e&&e||void 0!==t&&t}function V(e){const{inheritedPermissionToCompare:t,mostPermissivePermissionLoose:n}=e,o=n;if((0,b.KF)(o.permissionItem)&&!(0,b.KF)(t.permissionItem))return t;const i=o.permissionItem.role,r=T(i,t.permissionItem.role),a=r!==i?t:o;return{from:a.from,permissionItem:{...a.permissionItem,role:r}}}function j(e){return e?(0,b.jg)(e)||(0,b.e_)(e)?`${e.type}:${e.user_id}`:(0,b.FB)(e)?`${e.type}:${e.bot_id}`:(0,b.hV)(e)?`${e.type}:${e.group_id}`:(0,b.zU)(e)||(0,b.LW)(e)?`${e.type}:${e.team_id}`:e.type:""}function U(e){return 1===e.length?e[0]:e.reduce(((e,t)=>{if(!x(e.permissionItem,t.permissionItem))throw Error("Items should be grouped by target, but given items have different targets");return(0,b.jg)(t.permissionItem)||(0,b.e_)(t.permissionItem)||(0,b.ix)(t.permissionItem)||(0,b.bm)(t.permissionItem)||(0,b.RI)(t.permissionItem)||(0,b.ZQ)(t.permissionItem)||(0,b.hV)(t.permissionItem)||(0,b.FB)(t.permissionItem)?V({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,b.$D)(t.permissionItem)?function(e){const{mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n}=e,o=V({mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n});var i,r,a,s;return o.permissionItem={...o.permissionItem,allow_duplicate:(a=o.permissionItem.allow_duplicate,s=n.permissionItem.allow_duplicate,void 0===a||a||void 0===s||s),allow_search_engine_indexing:Z(o.permissionItem.allow_search_engine_indexing,n.permissionItem.allow_search_engine_indexing),expiration_timestamp:(i=o.permissionItem.expiration_timestamp,r=n.permissionItem.expiration_timestamp,i&&r?Math.max(i,r):i||r)},o}({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,b.gG)(t.permissionItem)?{...e,from:t.from}:(0,b.Le)(t.permissionItem)?e:void(0,v.t1)(t.permissionItem)}),e[0])}function L(e){const t=s.xH(e.map((e=>{const{permissions:t,from:n}=e;return t.map((e=>({from:n,permissionItem:e})))})));t.reverse();const n=s.vM(t,(e=>j(e.permissionItem))),o=s.Q8(n,U),i=new Set,r=[];for(const s of t){const e=j(s.permissionItem);i.has(e)||(i.add(e),r.push(o[e]))}const a=r.find((e=>(0,b.gG)(e.permissionItem)));return a?[a]:r}function O(e){return e.table===m.bx}function N(e){return e.table===m.bx}function z(e){return e.table===f.e0}function W(e){const{actorPointer:t,ancestors:n,permissionsContext:o}=e;if((0,c.GR)(n))return[];let i=e.ignorePublicPermissions;i||(0,c.Zg)(n)||(i=!0);const r=n.find(N),[a,s,l]=r?[r.__IM_SORRY__getValue(),r.getPermissionItems(),r.getPermissionGroups()]:[null,[],[]],m=(null==t?void 0:t.table)===g.KJ&&t,f=(null==t?void 0:t.table)===u.cZ&&t,v=f&&f.id,y=n.find(z),_=y?y.__IM_SORRY__getValue():null;if(f&&f.spaceId&&a&&a.id!==f.spaceId)return[];f&&!i&&(i=!0);const S=m&&m.id,w=S?l.filter((e=>e.user_ids&&e.user_ids.includes(S))).reduce(((e,t)=>(e.add(t.id),e)),new Set):new Set,k=L(C(n).map((e=>{const{permissions:t,from:n}=e;return{from:n,permissions:t.filter((e=>{if((0,b.jg)(e)||(0,b.e_)(e))return e.user_id===S;if((0,b.FB)(e))return e.bot_id===v;if((0,b.hV)(e))return w.has(e.group_id);if((0,b.Ix)(e))return Boolean(S&&_&&a&&(0,h.AL)({userId:S,team:_,space:a,groupIdsThatIncludeUser:w}));if((0,b.KK)(e))return Boolean(_&&m&&(0,h.pd)(_,m.id));if((0,b.zU)(e)){const t=K({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&t&&a&&(0,h.AL)({userId:S,team:t,space:a,groupIdsThatIncludeUser:w}))}if((0,b.LW)(e)){const t=K({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(t&&m&&(0,h.pd)(t,m.id))}if((0,b.bm)(e)){const t=K({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&t&&a&&(0,h.s8)({userId:S,team:t}))}return!0}))}}))),I=$({spacePermissions:s,userId:S||void 0,botId:v||void 0}),x=(0,c.Zg)(n),T=n.some((e=>Boolean(e.table===p.qF&&e.resolved)));return k.filter((e=>{const{permissionItem:t}=e;if(!(0,b.C2)(t))return!1;if((!x||T)&&(0,b.rz)(t.role)&&!(0,b.FB)(t))return!1;if(((0,b.jg)(t)||(0,b.e_)(t))&&t.user_id===S)return!0;if((0,b.FB)(t)&&t.bot_id===v)return!0;if((0,b.Ix)(t))return Boolean(S&&_&&a&&(0,h.AL)({userId:S,team:_,space:a,groupIdsThatIncludeUser:w}));if((0,b.KK)(t))return Boolean(_&&m&&(0,h.pd)(_,m.id));if((0,b.zU)(t)){const e=K({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&e&&a&&(0,h.AL)({userId:S,team:e,space:a,groupIdsThatIncludeUser:w}))}if((0,b.bm)(t)){const e=K({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&e&&a&&(0,h.s8)({userId:S,team:e}))}if((0,b.LW)(t)){const e=K({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(e&&m&&(0,h.pd)(e,m.id))}return!(!(0,b.ix)(t)||!I)||(!(i||!(0,b.$D)(t)||(0,b.o7)(t))||!!((0,b.hV)(t)&&I&&w.has(t.group_id)))})).map((e=>{const{from:t,permissionItem:o}=e,[i,r]=n;if("content_only_editor"===o.role){if(t.table!==d.iU)return H(n,t,e,o);if(!q(t,i)&&!q(t,r))return H(n,t,e,o);if(r&&r.table===t.table&&"collection"!==i.table&&"collection_view"!==i.table&&r.hasWikiBlockUri())return H(n,t,e,o)}return e}))}function q(e,t){return!!t&&(t.table===e.table&&t.id===e.blockId)}function H(e,t,n,o){return function(e,t){if(t.table!==d.iU)return!1;const n=e.findIndex((e=>e.table===d.iU&&e.type===i.Ti.page&&e.is_template));if(n<0)return!1;const o=e[n+2];if(!o)return!1;if(o.table!==d.iU)return!1;return o.isType(i.pg)&&o.id===t.blockId}(e,t)?{...n,permissionItem:{...o,role:"comment_only"}}:{...n,permissionItem:{...o,role:"read_and_write"}}}function K(e){var t;let{team:n,permissionItem:o,spaceId:i,permissionsContext:r}=e;if(n&&n.id===o.team_id)return n;const a={table:f.e0,id:o.team_id,spaceId:i};let s=null===(t=r.explicitTeamsRecordMap)||void 0===t?void 0:t.get(a);return s||(s=r.originalRecordMap.getValue(a)),s}function G(e){const{spacePermissions:t,userId:n}=e;return t.some((e=>(0,b.jg)(e)&&e.user_id===n&&(0,b.J5)(e.role)))}function $(e){const{spacePermissions:t,userId:n,botId:o}=e;return t.some((e=>{const t=(0,b.jg)(e)&&e.user_id===n&&(0,b.J5)(e.role),i=(0,b.FB)(e)&&e.bot_id===o&&(0,b.J5)(e.role),r=(0,b.jg)(e)&&e.user_id===n&&(0,b.Bc)(e.role);return t||i||r}))}function Q(e){return L(C(e)).map((e=>{let{permissionItem:t}=e;return t}))}function Y(e,t){const n=[],o=[],i=[],r=[],a={};for(const s of e){a[j(s)]=s}for(const l of t){const e=j(l);if(a[e]){const t=a[e];(0,b.C2)(t)&&(0,b.C2)(l)&&!s.Xy(t.role,l.role)?i.push([t,l]):r.push(l),delete a[e]}else n.push(l)}for(const s of Object.values(a))o.push(s);return{created:n.sort(X),deleted:o.sort(X),changed:i.sort(X),unchanged:r.sort(X)}}function J(e){return Array.isArray(e)?e[0].type:e.type}function X(e,t){return b.UF.indexOf(J(e))-b.UF.indexOf(J(t))}function ee(e,t,n){const o=Y(t,n),i=o.unchanged.filter((e=>(0,b.C2)(e)));for(const[s,l]of o.changed){const t=T(s.role,l.role);e.isCollectionView()||"read_and_write"!==s.role||"content_only_editor"!==l.role?s.role!==l.role&&s.role!==t&&i.push(s):i.push(s)}const r=[];for(const s of i){const t={pointer:e.pointer,command:"setPermissionItem",path:["permissions"],args:{...s,role:"none"}};r.push(t)}const a={pointer:e.pointer,command:"setSingletonPermissionItem",path:["permissions"],args:{singletonPermissionItem:{type:"restricted_permission"},set:!1}};return r.push(a),r}function te(e,t){const n=[],o=Y(e,t);for(const i of o.created)if((0,b.C2)(i)){const e={...i,role:"none"};n.push([e,i])}for(const[i,r]of o.changed){const e=T(i.role,r.role);("content_only_editor"===r.role&&"read_and_write"===i.role||i.role!==e)&&n.push([i,r])}return n}function ne(e){if(e){const{read_user_without_email:t,read_user_with_email:n,inherit_creator_permissions:o,link_preview:i,synced_database:r,webhooks:a,workspace_search:s,workspace_page_export:l,read_teamspace:c,...d}=e;if(P(d))return d}return"none"}function oe(e){if(!e)return{};const{read_user_with_email:t,read_user_without_email:n}=e;return n&&t?{read_user_without_email:n,read_user_with_email:t}:n?{read_user_without_email:n}:{}}function ie(e){if(!e)return{};const{link_preview:t,synced_database:n}=e;return t&&n?{link_preview:t,synced_database:n}:t?{link_preview:t}:{}}function re(e){return Boolean(e&&e.inherit_creator_permissions)}const ae=(0,o.defineMessages)({adminLabel:{id:"userPermissionsMenu.adminItem.label",defaultMessage:"Admin"},adminCaption:{id:"userPermissionsMenu.adminItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},workspaceOwnerLabel:{id:"userPermissionsMenu.workspaceOwnerItem.label",defaultMessage:"Workspace owner"},workspaceOwnerCaption:{id:"userPermissionsMenu.workspaceOwnerItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},membershipAdminLabel:{id:"userPermissionsMenu.membershipAdminItem.label",defaultMessage:"Membership admin"},membershipAdminCaption:{id:"userPermissionsMenu.membershipAdminItem.caption",defaultMessage:"Can manage workspace and group membership."},fullAccessLabel:{id:"userPermissionsMenu.fullAccessItem.label",defaultMessage:"Full access"},fullAccessCaption:{id:"userPermissionsMenu.fullAccessItem.caption",defaultMessage:"Can edit and share with others."},memberLabel:{id:"userPermissionsMenu.memberItem.label",defaultMessage:"Member"},memberCaption:{id:"userPermissionsMenu.memberItem.caption",defaultMessage:"Cannot change workspace settings or invite new members to the workspace."},canEditLabel:{id:"userPermissionsMenu.canEditItem.label",defaultMessage:"Can edit"},canEditCaption:{id:"userPermissionsMenu.canEditItem.caption",defaultMessage:"Can edit, but not share with others."},canEditContentLabel:{id:"userPermissionsMenu.canEditContentItem.label",defaultMessage:"Can edit content"},canEditContentCaption:{id:"userPermissionsMenu.canEditContentItem.caption",defaultMessage:"Can edit content, but can't edit the database's views or structure."},canReadLabel:{id:"userPermissionsMenu.canReadItem.label",defaultMessage:"Can view"},canReadCaption:{id:"userPermissionsMenu.canReadItem.caption",defaultMessage:"Cannot edit or share with others."},canWriteLabel:{id:"userPermissionsMenu.canWriteItem.label",defaultMessage:"Can write."},canWriteCaption:{id:"userPermissionsMenu.canWriteItem.caption",defaultMessage:"Cannot read or share with others."},canCommentLabel:{id:"userPermissionsMenu.canCommentItem.label",defaultMessage:"Can comment"},canCommentCaption:{id:"userPermissionsMenu.canCommentItem.caption",defaultMessage:"Can view and comment, but not edit."},mixedAccessLabel:{id:"userPermissionsMenu.mixedAccessItem.label",defaultMessage:"Mixed access"},mixedAccessCaption:{id:"userPermissionsMenu.mixedAccessItem.caption",defaultMessage:"Has mixed access."},leaveWorkspaceLabel:{id:"userPermissionsMenu.leaveWorkspaceItem.label",defaultMessage:"Leave workspace"},removeFromWorkspaceLabel:{id:"userPermissionsMenu.removeFromWorkspaceItem.label",defaultMessage:"Remove from workspace"},removeWorkspaceLabel:{id:"userPermissionsMenu.removeWorkspaceItem.label",defaultMessage:"Remove"},disabledLabel:{id:"userPermissionsMenu.disabledItem.label",defaultMessage:"Disabled"},noAccessLabel:{id:"userPermissionsMenu.noAccessItem.label",defaultMessage:"No access"},guestLabel:{id:"userPermissionsMenu.guestItem.label",defaultMessage:"Guest"},pageGuestLabel:{id:"userPermissionsMenu.pageGuestItem.label",defaultMessage:"Page guest"},teamGuestLabel:{id:"userPermissionsMenu.teamGuestItem.label",defaultMessage:"Teamspace guest"},canAccessLabel:{id:"userPermissionsMenu.canAccessItem.label",defaultMessage:"Can access"},limitedAccessLabel:{id:"userPermissionsMenu.limitedAccessItem.label",defaultMessage:"Limited access"}});function se(e,t){if(!e)throw new Error("Expected to have a role");if("none"===e)return{label:ae.noAccessLabel};if(t===m.bx)return{label:ae.memberLabel,caption:ae.memberCaption};if(e.read_content&&e.update_content&&e.insert_content)return{label:ae.canEditLabel,caption:ae.canEditCaption};if(e.insert_content||e.update_content||e.read_content||e.read_comment)return{label:ae.mixedAccessLabel,caption:ae.mixedAccessCaption};if(e.insert_comment)return{label:ae.canCommentLabel,caption:ae.canCommentCaption};if(e.insert_property||e.update_property||e.read_property)throw new Error("Unsupported permission role");(0,v.t1)(e)}function le(e,t){if(M(e)){const{label:n}=se(e,t);return n}return"reader"===e?ae.canReadLabel:"editor"===e?ae.fullAccessLabel:"read_and_write"===e?ae.canEditLabel:"content_only_editor"===e?ae.canEditContentLabel:"comment_only"===e?ae.canCommentLabel:"none"===e?ae.noAccessLabel:"membership_admin"===e?ae.membershipAdminLabel:void(0,v.t1)(e)}async function ce(e){return function(e){if(e.shared_to_web)return"shared_to_web";if(e.shared_externally)return"shared_externally";if(e.shared_internally)return"shared_internally";return"private"}(await async function(e){const{permissionItems:t,spaceUserPermissions:n,hasTeamLevelGuests:o,teamHasTeamLevelGuestsCache:i}=e,r={shared_internally:!1,shared_externally:!1,shared_to_web:!1,private:!1},a=t.filter((e=>!(0,b.Le)(e)));if(1===a.length&&(0,b.jg)(a[0]))return r.private=!0,r;const s=new Set((n??[]).map((e=>{let{user_id:t}=e;return t})));for(const l of a)switch(l.type){case"user_permission":case"exclusive_user_permission":s.has(l.user_id)?r.shared_internally=!0:r.shared_externally=!0;continue;case"explicit_team_owner_permission":case"explicit_team_permission":case"explicit_team_guest_permission":const e=l.team_id;(void 0!==(null==i?void 0:i[e])?i[e]:await o(e))?r.shared_externally=!0:r.shared_internally=!0;continue;case"bot_permission":r.shared_externally=!0;continue;case"group_permission":case"space_permission":r.shared_internally=!0;continue;case"public_permission":r.shared_to_web=!0;break;case"deleted_permission":case"restricted_permission":case"team_owner_permission":case"team_permission":continue;default:(0,v.t1)(l)}return r}(e))}function de(e){switch(e.type){case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"explicit_team_permission":return e.team_id;case"bot_permission":return e.bot_id;case"exclusive_user_permission":case"user_permission":return e.user_id;case"group_permission":return e.group_id;case"public_permission":case"team_permission":case"team_owner_permission":case"deleted_permission":case"restricted_permission":case"space_permission":return;default:(0,v.t1)(e)}}function ue(e){let{teamValue:t,permissionRole:n}=e;const o=(0,h.xC)(t);if(!o)throw new a.p8("Couldn't find team's default permission");return T(n,o)===o&&n!==o}function pe(e){let{spaceValue:t,teamsInSpace:n,currentUserId:o}=e;const i=function(e){const t=l.kk.isAnyModel(e)?e.getPermissionItems():e.permissions;return s.oA((t||[]).map((e=>{if((0,b.jg)(e)&&(0,b.Jy)(e.role))return{userId:e.user_id,role:e.role}})))}(t),r=n.filter((e=>!(0,h.m4)({archived_by:e.archived_by}))).filter((e=>(0,h.AL)({team:e,space:t,userId:o})));return Boolean(1===i.length&&i[0].userId===o&&1===r.length&&(0,h.pd)({membership:r[0].membership},o))}},8637:(e,t,n)=>{n.d(t,{J3:()=>s,as:()=>a,iY:()=>l});n(57658);var o=n(16691),i=n(61158),r=n(45953);function a(e){const{actorPointers:t,recordMap:n}=e,a=n||r.Ak.create();return{actorPointersSet:i.Z.fromArray({values:t,getKeyFn:o.dn}),explicitTeamsRecordMap:void 0,temporarySpacesForSpaceUserValues:void 0,originalRecordMap:a,type:"empty_permissions_context"}}function s(e){const{recordMap:t,explicitTeamsRecordMap:n,actorPointers:a}=e;return{originalRecordMap:t||r.Ak.create(),explicitTeamsRecordMap:n,actorPointersSet:i.Z.fromArray({values:a,getKeyFn:o.dn}),temporarySpacesForSpaceUserValues:void 0,type:"loaded_permissions_context"}}function l(e){const{actors:t}=e,n=[];return t&&t.forEach((e=>{e&&n.push(e.pointer)})),n}},19233:(e,t,n)=>{n.d(t,{W:()=>i,Y:()=>r});var o=n(20852);const i={ABAP:o.PrismLanguages.abap,Agda:o.PrismLanguages.agda,Arduino:o.PrismLanguages.arduino,Assembly:o.PrismLanguages.nasm,Bash:o.PrismLanguages.bash,BASIC:o.PrismLanguages.basic,BNF:o.PrismLanguages.bnf,C:o.PrismLanguages.c,"C#":o.PrismLanguages.csharp,"C++":o.PrismLanguages.cpp,Clojure:o.PrismLanguages.clojure,CoffeeScript:o.PrismLanguages.coffeescript,Coq:o.PrismLanguages.coq,CSS:o.PrismLanguages.css,Dart:o.PrismLanguages.dart,Dhall:o.PrismLanguages.dhall,Diff:o.PrismLanguages.diff,Docker:o.PrismLanguages.docker,EBNF:o.PrismLanguages.ebnf,Elixir:o.PrismLanguages.elixir,Elm:o.PrismLanguages.elm,Erlang:o.PrismLanguages.erlang,"F#":o.PrismLanguages.fsharp,Flow:o.PrismLanguages.flow,Fortran:o.PrismLanguages.fortran,Gherkin:o.PrismLanguages.gherkin,GLSL:o.PrismLanguages.glsl,Go:o.PrismLanguages.go,GraphQL:o.PrismLanguages.graphql,Groovy:o.PrismLanguages.groovy,Haskell:o.PrismLanguages.haskell,HTML:o.PrismLanguages.html,Idris:o.PrismLanguages.idris,Java:o.PrismLanguages.java,JavaScript:o.PrismLanguages.jsx,JSON:o.PrismLanguages.json,Julia:o.PrismLanguages.julia,Kotlin:o.PrismLanguages.kotlin,LaTeX:o.PrismLanguages.latex,Less:o.PrismLanguages.less,Lisp:o.PrismLanguages.lisp,LiveScript:o.PrismLanguages.livescript,"LLVM IR":o.PrismLanguages.llvm,Lua:o.PrismLanguages.lua,Makefile:o.PrismLanguages.makefile,Markdown:o.PrismLanguages.markdown,Markup:o.PrismLanguages.markup,MATLAB:o.PrismLanguages.matlab,Mathematica:o.PrismLanguages.mathematica,Mermaid:o.PrismLanguages.mermaid,Nix:o.PrismLanguages.nix,"Notion Formula":o.PrismLanguages.notion,"Objective-C":o.PrismLanguages.objectivec,OCaml:o.PrismLanguages.ocaml,Pascal:o.PrismLanguages.pascal,Perl:o.PrismLanguages.perl,PHP:o.PrismLanguages.php,"Plain Text":"null",PowerShell:o.PrismLanguages.powershell,Prolog:o.PrismLanguages.prolog,Protobuf:o.PrismLanguages.protobuf,PureScript:o.PrismLanguages.purescript,Python:o.PrismLanguages.python,R:o.PrismLanguages.r,Racket:o.PrismLanguages.racket,Reason:o.PrismLanguages.reason,Ruby:o.PrismLanguages.ruby,Rust:o.PrismLanguages.rust,Sass:o.PrismLanguages.sass,Scala:o.PrismLanguages.scala,Scheme:o.PrismLanguages.scheme,Scss:o.PrismLanguages.scss,Shell:o.PrismLanguages.bash,Solidity:o.PrismLanguages.solidity,SQL:o.PrismLanguages.sql,Swift:o.PrismLanguages.swift,TOML:o.PrismLanguages.toml,TypeScript:o.PrismLanguages.tsx,"VB.Net":o.PrismLanguages.vbnet,Verilog:o.PrismLanguages.verilog,VHDL:o.PrismLanguages.vhdl,"Visual Basic":o.PrismLanguages.visualBasic,WebAssembly:o.PrismLanguages.wasm,XML:o.PrismLanguages.xml,YAML:o.PrismLanguages.yaml,"Java/C/C++/C#":o.PrismLanguages.clike},r={[o.PrismLanguages.abap]:"ABAP",[o.PrismLanguages.agda]:"Agda",[o.PrismLanguages.arduino]:"Arduino",[o.PrismLanguages.bash]:"Shell",[o.PrismLanguages.basic]:"BASIC",[o.PrismLanguages.bnf]:"BNF",[o.PrismLanguages.c]:"C",[o.PrismLanguages.clojure]:"Clojure",[o.PrismLanguages.coffeescript]:"CoffeeScript",[o.PrismLanguages.coq]:"Coq",[o.PrismLanguages.cpp]:"C++",[o.PrismLanguages.csharp]:"C#",[o.PrismLanguages.css]:"CSS",[o.PrismLanguages.dart]:"Dart",[o.PrismLanguages.dhall]:"Dhall",[o.PrismLanguages.diff]:"Diff",[o.PrismLanguages.docker]:"Docker",[o.PrismLanguages.ebnf]:"EBNF",[o.PrismLanguages.elixir]:"Elixir",[o.PrismLanguages.elm]:"Elm",[o.PrismLanguages.erlang]:"Erlang",[o.PrismLanguages.flow]:"Flow",[o.PrismLanguages.fortran]:"Fortran",[o.PrismLanguages.fsharp]:"F#",[o.PrismLanguages.gherkin]:"Gherkin",[o.PrismLanguages.glsl]:"GLSL",[o.PrismLanguages.go]:"Go",[o.PrismLanguages.graphql]:"GraphQL",[o.PrismLanguages.groovy]:"Groovy",[o.PrismLanguages.haskell]:"Haskell",[o.PrismLanguages.html]:"HTML",[o.PrismLanguages.idris]:"Idris",[o.PrismLanguages.java]:"Java",[o.PrismLanguages.javascript]:"JavaScript",[o.PrismLanguages.json]:"JSON",[o.PrismLanguages.jsx]:"JavaScript",[o.PrismLanguages.julia]:"Julia",[o.PrismLanguages.kotlin]:"Kotlin",[o.PrismLanguages.latex]:"LaTeX",[o.PrismLanguages.less]:"Less",[o.PrismLanguages.lisp]:"Lisp",[o.PrismLanguages.livescript]:"LiveScript",[o.PrismLanguages.llvm]:"LLVM IR",[o.PrismLanguages.lua]:"Lua",[o.PrismLanguages.makefile]:"Makefile",[o.PrismLanguages.markdown]:"Markdown",[o.PrismLanguages.markup]:"Markup",[o.PrismLanguages.matlab]:"MATLAB",[o.PrismLanguages.mathematica]:"Mathematica",[o.PrismLanguages.mermaid]:"Mermaid",[o.PrismLanguages.nasm]:"Assembly",[o.PrismLanguages.notion]:"Notion Formula",[o.PrismLanguages.nix]:"Nix",[o.PrismLanguages.objectivec]:"Objective-C",[o.PrismLanguages.ocaml]:"OCaml",[o.PrismLanguages.pascal]:"Pascal",[o.PrismLanguages.perl]:"Perl",[o.PrismLanguages.php]:"PHP",[o.PrismLanguages.powershell]:"PowerShell",[o.PrismLanguages.prolog]:"Prolog",[o.PrismLanguages.protobuf]:"Protobuf",[o.PrismLanguages.purescript]:"PureScript",[o.PrismLanguages.python]:"Python",[o.PrismLanguages.r]:"R",[o.PrismLanguages.racket]:"Racket",[o.PrismLanguages.reason]:"Reason",[o.PrismLanguages.ruby]:"Ruby",[o.PrismLanguages.rust]:"Rust",[o.PrismLanguages.sass]:"Sass",[o.PrismLanguages.scala]:"Scala",[o.PrismLanguages.scheme]:"Scheme",[o.PrismLanguages.scss]:"Scss",[o.PrismLanguages.solidity]:"Solidity",[o.PrismLanguages.sql]:"SQL",[o.PrismLanguages.swift]:"Swift",[o.PrismLanguages.toml]:"TOML",[o.PrismLanguages.tsx]:"TypeScript",[o.PrismLanguages.typescript]:"TypeScript",[o.PrismLanguages.vbnet]:"VB.Net",[o.PrismLanguages.verilog]:"Verilog",[o.PrismLanguages.vhdl]:"VHDL",[o.PrismLanguages.visualBasic]:"Visual Basic",[o.PrismLanguages.wasm]:"WebAssembly",[o.PrismLanguages.xml]:"XML",[o.PrismLanguages.yaml]:"YAML",[o.PrismLanguages.clike]:"Java/C/C++/C#"}},90850:(e,t,n)=>{n.d(t,{$r:()=>a,Zj:()=>r,Zk:()=>s});var o=n(15157);const i="promoCode";function r(e){let{currentUserId:t,promoCode:n}=e;n?o.Z.set({userId:t,key:i,value:n}):o.Z.remove({userId:t,key:i})}function a(e){o.Z.remove({userId:e,key:i})}function s(e){return o.Z.get({userId:e,key:i})}},96367:(e,t,n)=>{n.d(t,{P8:()=>h,Zv:()=>g,oN:()=>f,qB:()=>d,un:()=>p,zy:()=>u});n(57658);var o=n(9291),i=n(61514),r=n(72621),a=n(76205),s=n(99036);class l{constructor(e,t){this.variable=void 0,this.property=void 0,this.variable=e,this.property=t}getProperty(){return this.property}get(e){const t=this.getCombinatorFilter(e);if(t)return{type:"results",limit:1,filter:t}}getCombinatorFilter(e){const t=this.getPropertyFilter(e,this.variable);if(t)return{operator:"and",filters:[{property:this.property,filter:t}]}}getPropertyFilter(e,t){var n;const o=e[this.property];if(!o)return;return{operator:"status_is",value:{type:"is_option",value:null===(n=o.options)||void 0===n||null===(n=n.find((e=>e.id===t)))||void 0===n?void 0:n.value}}}}const c=(0,o.defineMessages)({current:{id:"database.filterValue.relationType.relativeSprintVariable.current",defaultMessage:"Current"},next:{id:"database.filterValue.relationType.relativeSprintVariable.next",defaultMessage:"Next"},last:{id:"database.filterValue.relationType.relativeSprintVariable.last",defaultMessage:"Last"}}),d={[r.p$]:{current:{messageDescriptor:c.current,reducer:new l(i.SF,i.b0.StatusV2)},next:{messageDescriptor:c.next,reducer:new l(i.YE,i.b0.StatusV2)},last:{messageDescriptor:c.last,reducer:new l(i.Rw,i.b0.StatusV2)}}};function u(e,t){const{filter:n,property:o}=e;if(!(0,a.e)(n)||!(0,a.vR)(n))return!1;const i=t[o];if(!i||!(0,s.p_)(i))return!1;return(0,a.YO)(n).some((e=>"relative"===e.type))}function p(e,t,n){if(!e)return!1;const o=t[n];return!!o&&m(e,n,o)}function m(e,t,n){return e===r.p$&&t===i.b0.StatusV2&&(0,s.gB)(n)}function f(e,t){return!!e&&p(t,e,i.b0.StatusV2)}function g(e,t){const n=e[i.b0.StatusV2];if(!n||!m(t,i.b0.StatusV2,n))return[];return Object.keys(d[t]).filter((e=>{var t;return null===(t=n.options)||void 0===t?void 0:t.find((t=>t.id===e))}))}function h(e,t){const n=Object.entries(t).find((t=>{let[n,o]=t;return e===o}));return n?n[0]:void 0}},76462:(e,t,n)=>{n.d(t,{OC:()=>ut,ZP:()=>mt});n(59730);var o=n(72126),i=n(97880),r=n(63143),a=n(74487),s=n(58129),l=n(70921),c=n(30842),d=n(39050),u=n(54368),p=n(51650),m=n(88179),f=n(80926),g=n(8542),h=n(10188),v=n(98963),b=n(18844),y=n(21202),_=n(7470),S=n(77420),w=n(60014),k=n(6287),I=n(13493),x=n(70279),C=n(75908),T=n(6359),M=n(7678),P=n(73409),A=n(60897),R=n(69549),D=n(33709),B=n(44312),E=n(4986),F=n(52719),Z=n(58912),V=n(19639),j=n(36077),U=n(97715),L=n(32161),O=n(82447),N=n(9713),z=n(57398),W=n(49953),q=n(14710),H=n(9508),K=n(62643),G=n(57883),$=n(66726),Q=n(30754),Y=n(6946),J=n(9844),X=n(25753),ee=n(84683),te=n(38429),ne=n(89488),oe=n(65311),ie=n(16427),re=n(61220),ae=n(96683),se=n(70017),le=n(89470),ce=n(49126),de=n(94578),ue=n(4137),pe=n(80396),me=n(24836),fe=n(86135),ge=n(78929),he=n(84323),ve=n(83200),be=n(67627),ye=n(65963),_e=n(14130),Se=n(34406),we=n(42314),ke=n(16663),Ie=n(19221),xe=n(93646),Ce=n(91644),Te=n(63787),Me=n(38952),Pe=n(40837),Ae=n(15047),Re=n(65635),De=n(96740),Be=n(63921),Ee=n(75990),Fe=n(57829),Ze=n(63188),Ve=n(56877),je=n(76413),Ue=n(47969),Le=n(47238),Oe=n(35623),Ne=n(77858),ze=n(37202),We=n(29369),qe=n(26195),He=n(60113),Ke=n(14718),Ge=n(14327),$e=n(71495),Qe=n(53412),Ye=n(65836),Je=n(5505),Xe=n(24494),et=n(66295),tt=n(10354),nt=n(19889),ot=n(19716),it=n(76244),rt=n(98897),at=n(46769),st=n(66079),lt=n(58161),ct=n(28182),dt=n(35794);const ut={block:y.ZP,customer:A.ZP,notion_user:nt.ZP,space:Ae.ZP,space_bot:Re.ZP,space_user:Ue.ZP,space_view:Ne.ZP,token:Je.Z,user_root:st.ZP,temporary_password:Ye.ZP,password:ce.Z,collection:k.Z,collection_view:I.Z,apple_token:m.Z,google_token:Y.Z,follow:G.ZP,activity:l.ZP,notification:oe.ZP,firebase_token:K.ZP,trello_token:et.Z,asana_token:f.Z,confluence_token:C.Z,monday_token:ne.Z,external_entity:N.Z,external_token:H.Z,external_integration_app:z.Z,slack_integration:Te.Z,slack_notification:Me.Z,discussion:D.ZP,comment:x.ZP,snapshot:Pe.Z,credit:M.ZP,used_credit:tt.Z,user_settings:ct.ZP,evernote_token:j.Z,space_recover_pages:je.ZP,drive_token:E.ZP,block_token:_.Z,user_metadata:at.Z,bot:S.ZP,bot_token:w.Z,saml_config:ge.ZP,experiment:U.ZP,education_domain:F.Z,education_email:Z.Z,space_invite_link:Ze.Z,public_email_domain:ue.Z,user_data_consent_permissions:ot.Z,access_request:s.ZP,csat_feedback:P.ZP,template_checklist:He.Z,template_tag:Qe.ZP,page_visit:le.ZP,page_exit:se.ZP,subscription:ze.ZP,space_domain:Be.ZP,admin_api_log:c.Z,admin_api_op_log:d.Z,integration:J.ZP,integration_token:X.Z,oauth_authorization_code:ie.Z,mfa_settings:te.ZP,device:R.ZP,user_device:it.Z,[L.P]:L.Z,[O.r]:O.Z,[dt.b]:dt.Z,[q.Dw]:q.ZP,[lt.t]:lt.Z,team:We.ZP,[xe.O]:xe.Z,[T.H]:T.Z,[Q.G]:Q.Z,[$.l]:$.Z,[pe.yo]:pe.ZP,[W.r9]:W.ZP,[B.Jd]:B.ZP,[V.mz]:V.ZP,[Ee.F]:Ee.Z,[ee.Tu]:ee.ZP,[v.cv]:v.ZP,[he.b]:he.Z,[ye.a]:ye.Z,[ke.h]:ke.Z,[Se.f1]:Se.ZP,[we.P]:we.Z,[ve.w]:ve.Z,[_e.O]:_e.Z,[be.m]:be.Z,[Ie.a]:Ie.Z,[me.qV]:me.ZP,[fe.FM]:fe.ZP,[b.Xj]:b.ZP,[Fe.fF]:Fe.ZP,[Le.x]:Le.ZP,[rt.pm]:rt.ZP,[De.L]:De.Z,[Ve.L9]:Ve.ZP,[qe.nE]:qe.ZP,[Ge.z]:Ge.Z,[Ke.u]:Ke.Z,[$e.Az]:$e.ZP,[re.V7]:re.ZP,[ae.K]:ae.Z,[u.y]:u.Z,[Oe.M]:Oe.Z,[Ce.AT]:Ce.ZP,[p.b]:p.Z,[Xe.w]:Xe.Z,[de.P9]:de.ZP,[g.t_]:g.ZP,[h.J4]:h.ZP};(0,i.Yd)(ut);a.literals(...(0,r.XP)(ut));const pt={};o.M6(ut,(e=>{e.columnTypes&&o.M6(e.columnTypes,((e,t)=>{t&&(pt[t]=!0)}))}));const mt=ut},53772:(e,t,n)=>{function o(e){return"development"===e.env||"local"===e.env||e.isAdminMode}n.d(t,{x:()=>o})},94804:(e,t,n)=>{n.d(t,{A7:()=>r,Y6:()=>l,fe:()=>s,rE:()=>a,w8:()=>c});var o=n(15157),i=n(97880);function r(e){let{searchSessionId:t,searchSessionFlowNumber:n}=e;if((0,i.$K)(t)&&(0,i.$K)(n))return`1:${t}:${n}`}const a="SearchShowFilterBar";function s(e){return d({key:a,userId:e,defaultValue:!1})}const l="SearchSidePeekDefaultOpen";function c(e){return!e||d({key:l,userId:e,defaultValue:true})}function d(e){const{key:t,userId:n,defaultValue:i}=e,r=o.Z.get({userId:n,key:t});return void 0===r?i:"boolean"==typeof r&&r}},92338:(e,t,n)=>{n.d(t,{GA:()=>b,Ix:()=>_,Um:()=>S,dK:()=>w,iY:()=>c,jl:()=>p,n8:()=>d,u4:()=>u,vp:()=>y});var o=n(72621),i=n(41432),r=n(74487);const a=r.object({required:{type:r.literal("date"),start_date:r.string()},optional:{}}),s=r.union([r.object({required:{starting:a,ending:r.isUndefined()},optional:{}}),r.object({required:{starting:r.isUndefined(),ending:a},optional:{}}),r.object({required:{starting:a,ending:a},optional:{}}),r.object({required:{starting:r.isUndefined(),ending:r.isUndefined()},optional:{}})]),l=r.union([r.array(r.string()),r.object({required:{teamIds:r.array(r.string()),includeSpaceRecords:r.boolean()},optional:{}})]);function c(e){if(e)return Array.isArray(e)?e:e.teamIds?e.teamIds:void 0}r.object({required:{id:r.string(),type:r.union([r.literal("user"),r.literal("permission_group")])},optional:{}});let d=function(e){return e.CollectionsInSpace="CollectionsInSpace",e.BlocksInSpace="BlocksInSpace",e.BlocksInAncestor="BlocksInAncestor",e.BlocksInParent="BlocksInParent",e.BlocksInCollection="BlocksInCollection",e}({});r.object({required:{ancestors:r.array(r.string()),createdBy:r.array(r.string()),editedBy:r.array(r.string()),lastEditedTime:s,createdTime:s},optional:{requireEditPermissions:r.boolean(),isDeletedOnly:r.boolean(),excludeTemplates:r.boolean(),isAdminModeDeletedPageSearch:r.boolean(),blockTypes:r.minLength(r.array(r.literals(...Object.keys(i.Ti))),1),inTeams:l,navigableBlockContentOnly:r.boolean(),includePublicPagesWithoutExplicitAccess:r.boolean(),audience:r.array(r.literals("private","shared_internally","shared_externally","shared_to_web")),dev_excludedPages:r.array(r.string()),dev_excludedTeams:r.array(r.string()),parentId:r.string(),databaseType:r.array(r.literals(...o.fW))}});function u(e){return{isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,requireEditPermissions:!1,includePublicPagesWithoutExplicitAccess:!1,ancestors:[],parentId:void 0,createdBy:[],editedBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},inTeams:[],...e}}function p(e,t){return{...e,...t,createdTime:{...e.createdTime,...t.createdTime},lastEditedTime:{...e.lastEditedTime,...t.lastEditedTime}}}const m=["quick_find","quick_find_public","quick_find_input_change","quick_find_scroll","quick_find_filters","quick_find_ancestor_filter","quick_find_navigational_mode"],f=(m.filter((e=>"quick_find_ancestor_filter"!==e)),["cron_attachment_search_input_change","cron_attachment_parent_search_input_change","cron_time_collection_views_query"]),g=(r.union([...m.map(r.literal),...f.map(r.literal),r.literal("ancestor_filter_page_search"),r.literal("debugging"),r.literal("report_bad_search"),r.literal("trash"),r.literal("link_to_page_block"),r.literal("link_to_collection_block"),r.literal("mention_menu"),r.literal("move_to_menu"),r.literal("public_home_page_menu"),r.literal("relation_menu"),r.literal("relation_setup_menu"),r.literal("web_clipper"),r.literal("oauth"),r.literal("collection_group_value"),r.literal("collection_settings_source"),r.literal("collection_settings_select_relation_source"),r.literal("admin_search_permanently_deleted_pages"),r.literal("bot_iterate_blocks_in_space"),r.literal("api_unknown"),r.literal("simple_formula_value_page_search"),r.literal("automation_page_picker"),r.literal("automation_collection_picker"),r.literal("admin_content_search"),r.literal("ediscovery_search_api"),r.literal("admin_content_search_export"),r.literal("question_answer_context_search"),r.literal("export_content_analytics"),r.literal("send_to_notion_database_options"),r.literal("search_content_analytics"),r.literal("search_unique_id"),r.literal("update_sidebar_tab_assistant"),r.literal("legacy_searchPagesWithParent")]),["lastEdited","created","scroll","id",...Object.keys({pageViewsLast7Days:"pageViews.pageViewsLast7Days",pageViewsLast28Days:"pageViews.pageViewsLast28Days",pageViewsLast90Days:"pageViews.pageViewsLast90Days",pageViewsAllTime:"pageViews.pageViewsAllTime",uniquePageViewsLast7Days:"uniquePageViews.uniquePageViewsLast7Days",uniquePageViewsLast28Days:"uniquePageViews.uniquePageViewsLast28Days",uniquePageViewsLast90Days:"uniquePageViews.uniquePageViewsLast90Days",uniquePageViewsAllTime:"uniquePageViews.uniquePageViewsAllTime"})]),h=r.object({required:{field:r.literals("relevance")},optional:{}}),v=r.object({required:{field:r.literals(...g),direction:r.literals("asc","desc")},optional:{missing:r.union([r.literal("_first"),r.literal("_last"),r.number(),r.boolean(),r.string()]),searchAfter:r.undefinable(r.union([r.number(),r.string()]))}}),b=r.union([h,v]);let y=function(e){return e.Local="local",e.ElasticSearch="es",e.Postgres="pg",e.VectorDBBlock="vector_block",e.VectorDBCollection="vector_collection",e.ElasticsearchRandom="es_random",e.ElasticsearchUniqueID="es_uniqueId",e.ElasticsearchForcedRecentRecall="es_forced_recent_recall",e}({});const _={RequestFailed:{type:"RequestFailed",message:"Something went wrong."},NoResults:{type:"NoResultsFound",message:"No results found."},Offline:{type:"Offline",message:"Go online for more results."}},S="<gzkNfoUU>",w="</gzkNfoUU>"},98275:(e,t,n)=>{n.d(t,{S3:()=>o,St:()=>i,r8:()=>r,vl:()=>a});const o={local:"http://localhost:3008",development:"https://integrations-api-dev.notion.com",staging:"https://integrations-api-stg.notion.com",production:"https://integrations-api.notion.com"};function i(e){return`${o[e]}/slack/install`}function r(e){return`${o[e]}/github/install`}function a(e){return`${o[e]}/zendesk/install`}},25666:(e,t,n)=>{n.d(t,{D:()=>a,T:()=>r});var o=n(24211),i=n(72126);const r="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function a(e,t){if(i.HD(e))return e;{const n=e[t];return void 0!==n?n:e[o.al]}}},94044:(e,t,n)=>{n.d(t,{$e:()=>m,TQ:()=>p,UF:()=>s,VX:()=>c,jm:()=>d,my:()=>u,p_:()=>a,vr:()=>l});var o=n(9291),i=n(30845),r=n(59753);n(4615);const a=8,s=70,l=1e3,c=(0,o.defineMessages)({member:{id:"sharedContextualInviteHelpers.member.inviteMessage2",defaultMessage:"{userName} shared a page {pageName} with you."},guest:{id:"sharedContextualInviteHelpers.guest.inviteMessage2",defaultMessage:"{userName} shared {pageName}. Join {spaceName} to view this page."},default:{id:"sharedContextualInviteHelpers.default.inviteMessage",defaultMessage:"Your invitation message"},optional:{id:"sharedContextualInviteHelpers.default.inviteMessagePrefix",defaultMessage:"Optional message..."}});function d(e){const{includeOptional:t,isGuest:n,emailProps:o,intl:i}=e,r=n?c.guest:c.member;if(t){return`${i.formatMessage(c.optional)}\n"${i.formatMessage(r,o)}"`}return i.formatMessage(r,o)}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if(!e)return"";const n=i.s(e,"url");let o=e.slice();return n.forEach(((e,t)=>{o=o.replace(e.value,"[link]")})),o.length>t&&(o=`${o.substring(0,t)}...`),o}function p(e){if(!e)return!1;return i.s(e,"url").length>0}function m(e,t){var n;const o=null===(n=r.kk.fromValue("block",e).getPermissionItems())||void 0===n?void 0:n.find((e=>"user_permission"===e.type&&e.user_id===t.invited_user_id));if(o&&"invite_id"in o)return o.invite_id}},99108:(e,t,n)=>{n.d(t,{VR:()=>P,hI:()=>R});n(57658);var o=n(40902),i=n(41432),r=n(80951),a=n(53504),s=n(72126),l=n(86517),c=n(72141),d=n(97880);function u(e,t){return e.space_id===t.space_id&&e.collection_id===t.collection_id&&e.navigable_block_id===t.navigable_block_id}function p(e){return e.table+e.id}function m(e,t){return s.Xy(s.MR(e.authors||[],p),s.MR(t.authors||[],p))}function f(e,t){return s.MR(s.mN([...e.authors||[],...t.authors||[]],p),p)}function g(e,t){return e.block_id===t.block_id&&u(e,t)}function h(e,t){return e.block_id===t.block_id&&u(e,t)}function v(e,t){return u(e,t)&&e.comment_id===t.comment_id}function b(e,t){return u(e,t)}function y(e,t){return e.collection_property_id===t.collection_property_id&&u(e,t)}function _(e,t){return e.collection_view_id===t.collection_view_id&&u(e,t)}function S(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_user_id===t.mentioned_user_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function w(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_group_id===t.mentioned_group_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function k(e){const t=[];e:for(;e.list.length>0;){const n=e.list.shift();let o,i=0,r=!1;for(;i<e.list.length;){const t=e.list[i];if(r=e.cancel(n,t),r){e.list.splice(i,1);continue e}if(o=e.replace(n,t),o){e.list[i]=o;continue e}i++}t.push(n)}return t}function I(e,t){return 0===s.e5(e,t).length&&0===s.e5(t,e).length}function x(e,t){return u(e,t)&&e.permission_group_id===t.permission_group_id}function C(e){return"permission-created"===e.type||"permission-deleted"===e.type?(0,l.OC)(e.permission_data):"permission-changed"===e.type?(0,l.OC)(e.permission_data.before):void(0,d.t1)(e)}function T(e,t){return!!u(e,t)&&(!!m(e,t)&&("permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type||(null===(n=e.permission_data)||void 0===n||null===(n=n.actual_changes)||void 0===n?void 0:n.some((e=>(0,l.OC)(e)===C(t)))):"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type?t.permission_data.actual_changes.some((t=>(0,l.OC)(t)===C(e))):C(e)===C(t)));var n}function M(e,t){if("permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)&&!function(e,t){return c.cY(e)===c.cY(t)}(e.permission_data,t.permission_data))return{...t,type:"permission-changed",timestamp:t.timestamp,permission_data:{before:e.permission_data,after:t.permission_data}}}function P(e){const t=k({list:k({list:s.MR((0,a.Z)(e,"mangle-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>M(e,t)}),cancel:(e,t)=>function(e,t){return"block-created"===e.type&&"block-deleted"===t.type&&g(e,t)}(e,t)||function(e,t){return"block-deleted"===e.type&&"block-created"===t.type&&g(e,t)}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t)){if(e.block_data.after.block_value.type===i.Ti.tableRow){const n=o.Yr({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=o.Yr({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return I(n,i)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},n),s.ei(t.block_data.after.block_value.properties||{},i))}const n=o.OS({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),r=o.B9({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),a=o.OS({before:t.block_data.before.block_value,after:t.block_data.after.block_value,schema:t.block_schema}),l=o.B9({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return!o.lv({before:t.block_data.before.block_value,after:t.block_data.after.block_value})&&I(n,a)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},n),s.ei(t.block_data.after.block_value.properties||{},a))&&I(r,l)&&s.Xy(s.ei(e.block_data.before.block_value.format||{},r),s.ei(t.block_data.after.block_value.format||{},l))}return!1}(e,t)||function(e,t){return!("block-property-changed"!==e.type||"block-property-changed"!==t.type||!h(e,t))&&I(Object.keys(e.property_updates),Object.keys(t.property_updates))&&s.Xy(Object.values(e.property_updates).map((e=>e.before)),Object.values(t.property_updates).map((e=>e.after)))}(e,t)||function(e,t){return"permission-created"===e.type&&"permission-deleted"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t)&&s.Xy(e.permission_data.before,t.permission_data.after)}(e,t)||function(e,t){return"mention-created"===e.type&&"mention-deleted"===t.type&&S(e,t)}(e,t)||function(e,t){return"mention-deleted"===e.type&&"mention-created"===t.type&&S(e,t)}(e,t)||function(e,t){return"permission-group-mention-created"===e.type&&"permission-group-mention-deleted"===t.type&&w(e,t)}(e,t)||function(e,t){return"permission-group-mention-deleted"===e.type&&"permission-group-mention-created"===t.type&&w(e,t)}(e,t)||function(e,t){return"comment-created"===e.type&&"comment-deleted"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-deleted"===e.type&&"comment-created"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t)&&s.Xy(e.comment_data.before,t.comment_data.after)}(e,t)||function(e,t){return!!("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t)&&e.collection_data&&t.collection_data)&&s.Xy(e.collection_data.before,t.collection_data.after)}(e,t)||function(e,t){return"collection-property-created"===e.type&&"collection-property-deleted"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-deleted"===e.type&&"collection-property-created"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t)&&s.Xy(e.collection_property_data.before,t.collection_property_data.after)}(e,t)||function(e,t){return"collection-view-created"===e.type&&"collection-view-deleted"===t.type&&_(e,t)}(e,t)||function(e,t){return"collection-view-deleted"===e.type&&"collection-view-created"===t.type&&_(e,t)}(e,t)||function(e,t){return"collection-view-changed"===e.type&&"collection-view-changed"===t.type&&_(e,t)&&s.Xy(e.collection_view_data.before,t.collection_view_data.after)}(e,t)||function(e,t){return"permission-group-created"===e.type&&"permission-group-deleted"===t.type&&x(e,t)}(e,t)||function(e,t){return"permission-group-deleted"===e.type&&"permission-group-created"===t.type&&x(e,t)}(e,t),replace:(e,t)=>function(e,t){if("block-created"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:t.block_data.after}}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:{before:e.block_data.before,after:t.block_data.after}}}(e,t)||function(e,t){if("block-property-changed"===e.type&&"block-property-changed"===t.type&&h(e,t)){const n=e.property_updates;return t.property_updates&&Object.entries(t.property_updates).forEach((o=>{let[i,r]=o;i in n?s.Xy(n[i].before,r.after)?(delete n[i],e.filtered_block_schema&&delete e.filtered_block_schema[i],t.filtered_block_schema&&delete t.filtered_block_schema[i]):n[i].after=r.after:n[i]=r})),{...e,timestamp:t.timestamp,authors:f(e,t),filtered_block_schema:{...e.filtered_block_schema,...t.filtered_block_schema},property_updates:n}}}(e,t)||function(e,t){if("comment-created"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:t.comment_data.after}}(e,t)||function(e,t){if("comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:{before:e.comment_data.before,after:t.comment_data.after}}}(e,t)||function(e,t){if("permission-created"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,timestamp:t.timestamp,permission_data:t.permission_data.after}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,permission_data:{before:e.permission_data.before,after:t.permission_data.after},timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-created"===t.type&&"permission-restriction-created"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-deleted"===t.type&&"permission-restriction-deleted"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("collection-created"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,authors:f(e,t),collection_data:t.collection_data?t.collection_data.after:void 0}}(e,t)||function(e,t){if("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_data:{before:e.collection_data?e.collection_data.before:void 0,after:t.collection_data?t.collection_data.after:void 0}}}(e,t)||function(e,t){if("collection-property-created"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:t.collection_property_data.after}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:{before:e.collection_property_data.before,after:t.collection_property_data.after}}}(e,t)||function(e,t){if("collection-view-created"===e.type&&"collection-view-changed"===t.type&&_(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:t.collection_view_data.after}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-changed"===t.type&&_(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:{before:e.collection_view_data.before,after:t.collection_view_data.after}}}(e,t)||function(e,t){if("permission-group-created"===e.type&&"permission-group-changed"===t.type&&x(e,t))return{...e,timestamp:t.timestamp,permission_group_data:t.permission_group_data.after,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-changed"===t.type&&x(e,t))return{...e,permission_group_data:{before:e.permission_group_data.before,after:t.permission_group_data.after},timestamp:t.timestamp,authors:f(e,t)}}(e,t)}).filter((e=>!function(e){if("block-changed"===e.type){const t=o.gg({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),n=o.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=o.fc({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),r=o.Z3({before:e.block_data.before.block_value,after:e.block_data.after.block_value});return!(t||n||i||r)}return!1}(e)));return s.MR(t,(e=>e.timestamp))}function A(e){const t=k({list:s.MR((0,a.Z)(e,"ignore-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>function(e,t){if("block-changed"===e.type&&"block-deleted"===t.type&&g(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-deleted"===t.type&&x(e,t))return{...t,timestamp:t.timestamp,permission_group_data:e.permission_group_data.before,authors:f(e,t)}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-deleted"===t.type&&T(e,t))return{...t,timestamp:t.timestamp,permission_data:e.permission_data.before}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-deleted"===t.type&&y(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-deleted"===t.type&&_(e,t))return{...t,authors:f(e,t)}}(e,t)});return s.MR(t,(e=>e.timestamp))}function R(e){return function(e){const t=[];return e.forEach((e=>{if("block-changed"===e.type)if(o.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value})){const n={...e,type:"block-created",block_data:e.block_data.after},o={...e,type:"block-deleted",block_data:e.block_data.before};t.push(o),t.push(n)}else t.push(e);else t.push(e)})),t}(A(e)).filter((e=>!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&i.wL[e.block_data.block_value.type]&&"page"!==e.block_data.block_value.type&&!(0,r.wS)(e.block_data.block_value,"title")}(e)&&!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&i.XX[e.block_data.block_value.type]}(e)))}},34886:(e,t,n)=>{n.d(t,{F:()=>a,R:()=>r});var o=n(72126),i=n(97880);function r(e){const t={};return e?((0,i.qP)(e).forEach((e=>{let[n,i]=e;n&&i&&(t[String(n)]=o.HD(i)?i:JSON.stringify(i))})),t):t}function a(e){return e>=1e3?"1000+":e>=500?"500-999":e>=100?"100-499":e>=50?"50-99":e>=10?"10-49":e>=2?"2-9":e>=1?"1":"0"}},46637:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(30548);const i=["adClick","fbp"];const r=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"targeting")}get(e){return this.localStorageStore.get(e)}set(e,t){return this.localStorageStore.set(e,t)}remove(e){return this.localStorageStore.remove(e)}removeAllIfNoPermission(){this.localStorageStore.hasPermissionForTrackingType||i.forEach((e=>this.remove(e)))}}(o.$p,!1)},72128:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(30548);const i=["sourceInitialPage"];const r=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"performance")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get((0,o.dq)(t,n))}set(e){let{userId:t,key:n,value:i}=e;return this.localStorageStore.set((0,o.dq)(t,n),i)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove((0,o.dq)(t,n))}removeAllIfNoPermission(){const{namespace:e,hasPermissionForTrackingType:t}=this.localStorageStore;if(t)return;const n=`${o.eg}${e}:`;Object.keys(localStorage).filter((e=>e.startsWith(n))).filter((e=>{const[t,n,o,r]=e.split(":");return r&&i.includes(r)})).forEach((e=>localStorage.removeItem(e)))}}(o.TA,!1)},64793:(e,t,n)=>{n.d(t,{tA:()=>a});var o=n(97880),i=n(31919),r=n(896);class a{constructor(e){this.lastVersion=void 0,this.externalId=void 0,this.product=void 0,this.billingInterval=void 0,this.unitAmount=void 0,this.state=void 0,this.regions=void 0,this.externalId=e.external_id,this.product=e.product,this.billingInterval=e.billing_interval,this.unitAmount=i.n.fromValue({amount:e.unit_amount,currencyCode:e.currency}),this.state=e.state,this.regions=e.regions}get currencyCode(){return this.unitAmount.currencyCode}isAddOn(){return"ai"===this.product}getMonthlyUnitCost(e){const t=this.getAdjustedUnitAmount(e);return"year"===this.billingInterval?t.withDividedAmount(12):t}getMonthlyCost(e){const{quantity:t,coupon:n}=e;return this.getMonthlyUnitCost(n).withMultipliedAmount(t)}getCostPerBillingInterval(e){const{quantity:t,coupon:n}=e;return this.getAdjustedUnitAmount(n).withMultipliedAmount(t)}getDiscountPerBillingInterval(e){var t;const{quantity:n,coupon:o,promo:i}=e,a=this.unitAmount.withMultipliedAmount(n);if(o&&this.doesCouponApply(o))return a.withMultipliedAmount((0,r.ZN)(o));let s=0;return null!=i&&i.percent_off&&null!==(t=i.applies_to)&&void 0!==t&&t.includes(this.externalId)&&(s=i.percent_off/100),a.withMultipliedAmount(s)}getAdjustedUnitAmount(e){let t=1;return e&&this.doesCouponApply(e)&&(t=1-(0,r.ZN)(e)),this.unitAmount.withMultipliedAmount(t)}doesCouponApply(e){switch(this.product){case"ai":return"ai_fifty_percent"===e;case"free":case"student":case"personal":return!1;case"plus":return["team_three_months","team_annual"].includes(e);case"business":case"enterprise":return["business_three_months","business_annual"].includes(e);default:(0,o.t1)(this.product)}}}},9182:(e,t,n)=>{n.d(t,{F6:()=>d,H6:()=>p,Hw:()=>l,Lg:()=>i,YK:()=>s,bs:()=>a,h_:()=>f,iv:()=>r,tw:()=>m,xi:()=>u,zt:()=>c});n(21703);var o=n(72126);n(63143);function i(e){return e.subscription?e.subscription.pending?{...e.subscription.pending,trialEnd:void 0}:e.subscription:{items:[],trialEnd:void 0}}function r(e){return e.subscription??{trialEnd:void 0,items:[]}}function a(e){if(e)return g(e.items.map((e=>e.price.unitAmount.currencyCode)),"All subscription items should have the same currency code.")}function s(e){return!!e&&e.items.length>0}function l(e){if(e)return g(e.items.map((e=>e.price.billingInterval)),"All subscription items should have the same billing interval.")}function c(e){var t;return null===(t=((null==e?void 0:e.items)??[]).find((e=>"plan"===m(e))))||void 0===t?void 0:t.price.product}function d(e){var t;return null===(t=((null==e?void 0:e.items)??[]).find((e=>"plan"===m(e))))||void 0===t?void 0:t.price.externalId}function u(e){return((null==e?void 0:e.items)??[]).filter((e=>"plan"!==m(e))).map((e=>e.price.product))}function p(e){return"ai"!==e.price.product?e.price.product:void 0}function m(e){return f(e.price.product)}function f(e){return"ai"!==e?"plan":"ai"}function g(e,t){const n=(0,o.jj)(e);if(n.length>1)throw new Error(t);return n[0]}},31919:(e,t,n)=>{n.d(t,{n:()=>i});n(21703);const o={BRL:{currencyCode:"BRL",minorUnitDigits:2},EUR:{currencyCode:"EUR",minorUnitDigits:2},USD:{currencyCode:"USD",minorUnitDigits:2}};class i{static fromValue(e){const{amount:t,currencyCode:n}=e,r=o[n];if(!r)throw new Error(`Unsupported currency code: ${n}`);return new i(r,t)}static sum(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t.filter((e=>void 0!==e));if(0===o.length)return;const{currencyCode:r}=o[0];if(o.some((e=>e.currencyCode!==r)))throw new Error("Cannot add money with different currencies");const a=o.reduce(((e,t)=>e+t.amount),0);return i.fromValue({amount:a,currencyCode:r})}static zero(e){return i.fromValue({amount:0,currencyCode:e})}constructor(e,t){this.currencyValue=void 0,this.amount=void 0,this.currencyValue=e,this.amount=t}get currencyCode(){return this.currencyValue.currencyCode}toMoneyValue(){return{amount:this.amount,currencyCode:this.currencyValue.currencyCode}}withAmount(e){return new i(this.currencyValue,e)}withAddedAmount(e){return new i(this.currencyValue,this.amount+e)}plus(e){if(this.currencyCode!==e.currencyCode)throw new Error(`Cannot add money with currency code ${this.currencyCode} to money with currency code ${e.currencyCode}`);return new i(this.currencyValue,this.amount+e.amount)}minus(e){return this.plus(e.withMultipliedAmount(-1))}withMultipliedAmount(e){return new i(this.currencyValue,this.amount*e)}withDividedAmount(e){return new i(this.currencyValue,this.amount/e)}zeroIfNegative(){return new i(this.currencyValue,Math.max(0,this.amount))}zeroIfPositive(){return new i(this.currencyValue,Math.min(0,this.amount))}isPositive(){return this.amount>0}isNegative(){return this.amount<0}}},896:(e,t,n)=>{n.d(t,{$v:()=>r,ZN:()=>a,pp:()=>i});var o=n(97880);function i(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!0;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!1;default:(0,o.t1)(e)}}function r(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!1;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!0;default:(0,o.t1)(e)}}function a(e){switch(e){case"team_three_months":case"ai_fifty_percent":return.5;case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return.1;default:(0,o.t1)(e)}}},26929:(e,t,n)=>{n.d(t,{Ym:()=>l,cS:()=>s});n(21703);var o=n(30120),i=n(97880);const r={payment_failed:30,confirmation_required:15};function a(e){const{now:t,subscriptionId:n,invoiceId:o,overdueReason:a,subscriptionStatus:s,invoiceDueDate:l}=e,c=function(e){const{subscriptionId:t,subscriptionStatus:n}=e;if(t&&n)switch(n){case"past_due":case"unpaid":return{paymentStatus:n,reason:`Subscription [${t}] status is '${n}'. This triggered the '${n}' payment status`};case"incomplete":return{paymentStatus:"past_due",reason:`Subscription [${t}] status is '${n}'. This triggered the 'past_due' payment status`};case"active":case"canceled":case"incomplete_expired":case"paused":case"trialing":return;default:(0,i.t1)(n)}}({subscriptionId:n,subscriptionStatus:s}),d=function(e){const{invoiceId:t,invoiceDueDate:n,overdueReason:o,now:i}=e;if(!t||!n||!o)return;if(i<n)return;const a=n.toFormat("LLLL dd, yyyy"),s=r[o];if(!s)throw new Error(`Unsupported overdue reason '${o}'`);const l=n.plus({days:s});if(i>=l)return{paymentStatus:"unpaid",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'unpaid' payment status after a ${s} day warning period ending on ${l.toFormat("LLLL dd, yyyy")}`};return{paymentStatus:"past_due",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'past_due' payment status on the due date.`}}({now:t,invoiceId:o,invoiceDueDate:l,overdueReason:a});return"unpaid"===(null==c?void 0:c.paymentStatus)?c:"unpaid"===(null==d?void 0:d.paymentStatus)?d:"past_due"===(null==c?void 0:c.paymentStatus)?c:"past_due"===(null==d?void 0:d.paymentStatus)?d:{paymentStatus:"paid"}}function s(e){const{now:t,overdueSubscription:n}=e;if(!n)return{paymentStatus:"paid",reason:"No overdue subscription was provided"};const{subscriptionId:i,invoiceId:r,subscriptionStatus:s,dueDate:l,overdueReason:c}=n;return a({now:t,subscriptionId:i,invoiceId:r,overdueReason:c,subscriptionStatus:s,invoiceDueDate:l?o.ou.fromMillis(l):void 0})}function l(e){let{status:t}=e;return["requires_payment_method","requires_source"].includes(t)}},2438:(e,t,n)=>{n.d(t,{CF:()=>a,du:()=>r,iB:()=>s,nR:()=>c,qH:()=>d,uN:()=>l});n(21703),n(57658);var o=n(72141),i=n(60897);function r(e){return"none"===e.role}function a(e){return"none"!==e.role}function s(e){return"none"!==e.role&&(0,o.Bc)(e.role)}function l(e,t){return t?t.percent_off?{amount:e*t.percent_off/100,monthsRemaining:t.duration_in_months}:t.amount_off?{amount:t.amount_off}:{amount:0}:{amount:0}}function c(e){return"personal"!==e&&i.tt.find((t=>t===e))}function d(e){const t=i.KK.find((t=>t.includes(e))),n=null==t?void 0:t.findIndex((t=>t===e));if(0===n||e.includes("monthly")||e.includes("free")||e.includes("trial"))return"month";if(1===n||e.includes("yearly"))return"year";if(i.uw.has(e))return i.uw.get(e);throw new Error(`${e} not found in billing interval config nor contain known billing interval indicators.`)}},64684:(e,t,n)=>{n.d(t,{AL:()=>g,AW:()=>P,B5:()=>M,Ei:()=>A,Hf:()=>u,I6:()=>F,J2:()=>y,Rk:()=>f,Uk:()=>E,V3:()=>_,W9:()=>D,XO:()=>d,ah:()=>T,hY:()=>l,jI:()=>R,jc:()=>S,lF:()=>B,m4:()=>p,pd:()=>m,s8:()=>v,t0:()=>x,tO:()=>k,x4:()=>c,xC:()=>b,xf:()=>w,zz:()=>h});n(57658),n(21703);var o=n(72126),i=(n(59753),n(63306),n(72141)),r=n(29369),a=n(90965),s=n(97880);function l(e){return void 0===e.membership?[]:e.membership}function c(e){let{members:t,groups:n}=e;if(!t||!n)return[];const i=o.KX(n,(e=>e.id)),r=t.map((e=>"group"===e.entity_type?i[e.group_id]:void 0));return o.oA(r)}function d(e){const t=l(e);return o.oA(t.map((e=>{if("owner"===e.type)return e.user_id})))}function u(e){const t=l(e);return o.oA(t.map((e=>{if("team_level_guest"===e.type)return e.user_id})))}function p(e){return Boolean(e.archived_by)}function m(e,t){return d(e).includes(t)}function f(e){var t;let{team:n,space:o,userId:i}=e;const a=null===(t=I({team:n,space:o}).find((e=>{let{userId:t}=e;return t===i})))||void 0===t?void 0:t.teamMemberInfos;if(!a||0===a.length)return"none";return function(){let e=0;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];for(const i of n)e=Math.max(e,r.d2.indexOf(i));return r.d2[e]}(...a.map((e=>e.type)))}function g(e){let{team:t,space:n,userId:o,groupIdsThatIncludeUser:i}=e;window.__c={n:"isNonGuestTeamMember"};const r=(0,a.kC)(n.permissions,o);if(!r)return!1;if(t.is_default&&r)return!0;i||(i=(n.permission_groups??[]).filter((e=>e.user_ids&&e.user_ids.includes(o))).reduce(((e,t)=>(e.add(t.id),e)),new Set));const c=l(t);for(const a of c){if("member"!==a.type&&"owner"!==a.type)continue;const{entity_type:e}=a;switch(e){case"user":if(a.user_id===o)return!0;break;case"group":if(i.has(a.group_id))return!0;break;default:(0,s.t1)(e)}}return!1}function h(e){let{team:t,space:n,userId:o}=e;const i=f({team:t,space:n,userId:o});switch(i){case"owner":case"member":case"team_level_guest":return!0;case"none":return!1;default:(0,s.t1)(i)}}function v(e){let{team:t,userId:n}=e;return l(t).some((e=>"team_level_guest"===e.type&&e.user_id===n))}function b(e){if(!e.permissions)return"none";const t=e.permissions.find((t=>y(t,e.id)));return t?t.role:"none"}function y(e,t){return(0,i.zU)(e)?e.team_id===t:(0,i.Ix)(e)}function _(e,t){return!!(0,i.bm)(e)&&e.team_id===t}function S(e,t){return!(!(0,i.LW)(e)||e.team_id!==t)||(0,i.KK)(e)}function w(e){let{team:t,space:n}=e;const o=I({team:t,space:n}),i=[];for(const r of o){const{teamMemberInfos:e,userId:t}=r;e.some((e=>"owner"===e.type||"member"===e.type))&&i.push(t)}return i}function k(e){let{team:t,space:n}=e;return I({team:t,space:n}).map((e=>e.userId))}function I(e){let{team:t,space:n}=e;const o={},i={},r=new Set((0,a.Mi)(n));return(t.is_default?x({team:t,space:n}):l(t)).forEach((e=>{if("user"===e.entity_type){("team_level_guest"===e.type||r.has(e.user_id))&&(o[e.user_id]=[e])}else"group"===e.entity_type?i[e.group_id]=e:(0,s.t1)(e)})),n.permission_groups&&n.permission_groups.forEach((e=>{if(e.id in i&&e.user_ids){const t=i[e.id];e.user_ids.forEach((e=>{e in o||(o[e]=[]),r.has(e)&&o[e].push(t)}))}})),(0,s.qP)(o).map((e=>{let[t,n]=e;return{userId:t,teamMemberInfos:n}}))}function x(e){let{team:t,space:n}=e;const o=[],i=new Set;for(const a of l(t))o.push(a),"user"!==a.entity_type||"member"!==a.type&&"owner"!==a.type||i.add(a.user_id);const r=(0,a.UD)(n);for(const a of r)i.has(a.user_id)||o.push({type:"member",entity_type:"user",user_id:a.user_id});return o}function C(e){return"user"===e.entity_type?`${e.entity_type}|${e.user_id}`:"group"===e.entity_type?`${e.entity_type}|${e.group_id}`:void(0,s.t1)(e)}function T(e,t){return C(e)===C(t)}function M(e){return"self_join"===e.space_member_join_access?"open":"team_members"===e.visibility?"private":"closed"}function P(e){const{accessLevel:t,isDefault:n}=e,{id:o,permissions:r,settings:a}=e.teamValue,l={type:"explicit_team_owner_permission",role:"editor",team_id:o},c=(null==r?void 0:r.find(i.zU))||{type:"explicit_team_permission",role:"editor",team_id:o},d=null==r?void 0:r.find(i.ix),u={visibility:"space_members",space_member_join_access:"self_join",invite_access:"team_members"};if(n)return{settings:u,permissions:[l,c,{type:"space_permission",role:c.role},{type:"explicit_team_guest_permission",role:"none",team_id:o}]};if("open"===t){const e=(null==d?void 0:d.role)??"none";return{settings:u,permissions:[l,c,{type:"space_permission",role:(0,i.YX)(e)?e:c.role}]}}return"closed"===t?{settings:{visibility:"space_members",space_member_join_access:"invite_only",invite_access:a.invite_access},permissions:[l,c,{type:"space_permission",role:"none"}]}:"private"===t?{settings:{visibility:"team_members",space_member_join_access:"invite_only",invite_access:null==a?void 0:a.invite_access},permissions:[l,c,{type:"space_permission",role:"none"}]}:void(0,s.t1)(t)}function A(e){let{userId:t,teamModel:n,spaceModel:o}=e;if(void 0===t||void 0===n||void 0===o)return!1;if("private"!==M(n.getSettings()))return!1;return"none"===f({userId:t,team:{is_default:n.isDefault(),membership:n.getRawMembership()},space:{permissions:o.getPermissionItems()}})}function R(e){return d(e).length<1}function D(e,t,n){return!!R(e)&&(!!(0,a.wv)(n,t)&&("private"!==M(e.settings)||(n.subscription_tier,g({team:e,space:n,userId:t}))))}function B(e){let{groupId:t,teamMember:n}=e;return"group"===n.entity_type&&n.group_id===t}function E(e,t){return t?t.filter((t=>!T(t,e))):[]}function F(e,t){return(t=(t=t??[]).filter((t=>!T(t,e)))).push(e),t}},62992:(e,t,n)=>{n.d(t,{J:()=>i});const o=new Set(["7754cf02-251f-4bc9-ab2f-9cc897765336","ba43b46e-4ad3-47f7-95f0-58a3ba01476f","86fd2f05-b95a-48d9-a2fd-9fd8aab2f74f","aa94ac95-f6b0-47f1-8211-37087c9dcba6","10e7ee2a-3beb-4b49-96f2-8b8f662aabd4","6ce5f94a-8f64-42bd-9df9-2718a97bf539","c3eec6d5-b872-4ed6-ba75-306ec8006d88","7777cfa6-76ad-4976-8ef6-8f49c217ab52","6f521ac5-cfca-4580-860b-65df285f9660","fbe283d2-7e33-41ce-ac39-4b29f194ee26","c1de9900-4b7d-431b-a470-84c5c26eefde","dfb87d56-70af-4ac6-917d-1291d8ec7354","73feb0ab-635a-4c7c-8925-0bf551c61700","f0391877-6552-4b6c-969f-4effd300e264","75aacb5d-c105-4c73-8aad-bba3df0181f8","6f040c35-60bf-432c-b30a-096d494c5960","b8cf3a52-269f-430e-8dcf-e4cc860e0884","ad3d8b0b-22d8-48d1-9146-812b7ad4faec","0bc5a2e1-f401-4179-ba2a-c99bcae55190","179b5241-bada-44e4-8928-1efd1656c38d","c9443c7b-c803-49fb-bce3-44d4e9021454","27fdba35-578f-482d-b496-a98821942c35","b72f783a-5dce-41e3-9735-2cae3fcef6e6","3d811429-6bdf-489a-8f10-832380aa873d","de1cdbdd-9c77-4f08-8211-007a2b3401c3","307087b5-e940-46bf-ae69-fe3eebe91031","566b2711-4a9c-4d1b-a9d7-a2439f358674","bb957a92-76ec-4283-aaab-7fa77deba3f1","bef399e1-8841-4a69-aa8b-1471664c582c","ee6c3e86-3fd1-4164-9351-b31ccbc695f8","35eee73a-0536-420a-a6a5-125e0aad2d54","ddc2981c-e7fd-4880-81b5-86e0c4bc2ea1","14d1a2a5-dc71-4275-9b0c-cfc5a1b13b00","fcc6e15e-257d-4260-bced-da7d6aeb7257","10a07eab-3d8f-42d2-86fe-e58aba32c6a4","a929b937-0b73-427a-afd5-1896715abc49","1f87c3fd-3c99-484d-af03-7a6296dd09af","9b8c7303-4148-4754-ae47-da98ad15ebd3","06917ea1-367b-44d4-9e74-8d0a507d0a1f","44b19dbc-c008-4dc3-a203-77d28f5c1859","c87c2638-8564-444c-88c6-8d6231da145e","f3627a1c-aa76-40d0-956d-4b305813f3b2","0bf1bac9-af83-47e9-8bd0-987732d57348","3b9a8796-0d8e-455e-af31-f5b4631ae438","4728ffef-226b-423b-a730-c71d38e71d85","835f8d33-9268-42e6-9e04-a9c9db7acfac","0f844dc5-4142-4061-9e84-e0dd1ef71d00","44ed096e-f287-46a7-9222-f8f1e519b0bb","866ce03b-d6a6-4ce3-a527-b95118b56bd7","82c3118e-5e8b-4917-a921-9e695a1853bb","72630fc1-3d80-4b39-b7de-269b1ce5d455","039fba32-3bea-4377-8b42-04ff8e5dd3f4","9f115bdc-8fa6-4272-896d-2678970d3ef8","98772d76-b111-49e4-a9db-f000e9d61b03","960c9f76-30d6-4861-bc01-ce82ba1a8591","b830a9d4-06bd-4639-ba9e-2832ee81a689","912d82c7-cd39-455d-8ff6-9742118186db","ca827af1-3833-4a3a-8e82-c02552d820f5","bb439161-a466-4571-b5da-63f84b193474","a80ed33e-3840-408e-a445-b1099ce2b9d0","f24f8158-ecde-49ef-a51a-95b6ccc0703e","bdcdf14b-1f7d-471b-b4d6-e3cd244d12a6","e15410a0-4766-499d-a513-f536544bd2f3","ef512485-d49b-448f-a038-c6c71cfddbca","5f6d17ed-543a-4395-a5a7-04b3d2a35a55","48374a18-b873-461c-9d08-0127c6553204","d3cc5d9f-1aee-4ebe-90ec-77968c058905","b3558f2a-8ee3-472b-ab47-3d05b83e47a4","caca4605-2888-4869-8dfd-ef8f1dedab70","61c5eaf1-c511-4e80-9ad9-a4aab4edd106","1a49c41e-4107-4161-ad19-7161197defa5","bf154056-b048-4a3e-bb40-f41ec111791b","0c805a36-50be-4442-9a35-ed2907d70239","72955d7d-a8c1-4e84-a5e1-db637f53781e","e5c98f03-928b-4d20-ba01-e36382468187","0fa21220-95d0-400f-9fa4-5a95a046e9e8","ff889770-d18d-4b18-9f01-905a57cd9b28","2273a46b-12b5-483b-8f67-f4842f282967","47f7d067-7741-4113-ab72-6d12b8cd5786","e609dd4f-39d7-4424-b273-6eead26c7fe9","4ba726cb-4898-4702-9e05-4e23d85fd015","d6ec9638-6bb3-4b9d-ae4f-47122405e3eb","282a4fdf-1457-4d32-88cd-51d599481d71","eb12d79d-5dff-4d0a-ba49-02c7fd72e7ac","04576141-9d17-4d7c-a499-79590630e9fa","e0513925-3754-4cdc-8213-398c81f89d1b","25154d3e-5937-43f2-a47e-11509f34ce5a","59fd9e00-4b34-4e8d-bf9e-26b86323fd81","07b1a6c5-3526-4272-a35a-127684cfbcfe","e9642cc5-1342-4e34-b0c4-585321151347","a2bbdea8-2e03-4df8-9b89-0569c0ffd127","6905c1f8-6e8b-4e92-b3e5-5bf3059ce472","7cb6e153-76d8-4f11-9c3c-2f0c3b816ddc","8c37f1d6-19ee-4de0-a851-65ddbef0d642","1b65b28b-db02-4a9a-b596-26bd59ec9ce0","1d32c0de-c904-4e01-b56f-759c643c20ca","14fc89bf-4a6a-44ab-b9f4-79c5f997a73a","c352dfd4-67b1-413c-88ea-f7bf2ec8a3e0","bdb36fd4-ac83-4c8d-b83b-2884fa63f0fd","f7bdcac5-3454-4ffe-904e-ad4fe91b4b53","ea04b311-11bd-4872-9ab7-c15faadc3e3c","b03f9c77-daaf-432a-8573-71a931204d98","89238317-2b73-4ca7-922d-7c6df95f6bdb","33f2c6ca-7a7e-44d0-ba49-8e8e2897c91f","70b3c08c-cd4a-40db-9c2c-0029a23ba970","8de1c223-226e-46f6-9f16-36847f42b99f","4175a9b5-ea6e-489b-a2b1-70db5518f9db","f582c072-525e-4412-8f5a-68e8f9aaba9b","1b53b923-a77d-4bca-adc6-764ff78769f7","16a18cca-cacb-48ed-b1a6-72560e0ad728","cb5551ab-a47f-41a0-8a9c-ad134d77c693","75fd09a5-821f-4faa-a8f4-9f862d3892d9","75a93415-c9a4-4270-86fd-42664893cc7c","754b3d46-509e-4a4b-82d0-ec340114d5b5","42a45521-808f-4f85-9922-dc8bc583e287","a5b24576-80f8-415c-9877-45ba9d6e6033","58444e8f-94eb-4708-9f3b-6582245e6a9e","e29a8fd7-faf4-4614-9341-c55cce539b3d","f41adbea-5c0a-4b74-b222-d898d8ece92c","aa2398a2-6261-4995-bcf5-2423e8560336","cf48a687-67bd-4117-ad07-c20c0682662c","edbfd965-92a1-4291-b11e-f52d21184507","e7b453b7-98b4-4166-a97a-e99fc7bd6a35","d7768c90-8491-42af-b960-3575f5b218a7","9368e169-ec01-4953-b7dc-817398ab6e53","3477b696-40b1-4548-8ff0-a93e0d41fc25","e0ccdb5a-bacd-4d8c-875c-4f29c8786048","8fb16dba-6f02-4d4f-b69c-210a900f9e57","9a47645f-8880-4d04-8b1e-d49f9f24a524","ded667af-370f-469a-ae2b-16737d423cfe","cd19749e-355c-493a-a1a9-64be68ba9399","aa94fec7-7dba-4aa3-a444-d321c2e6e11c","68e75880-ea6b-43f6-9a62-f813972d8f40","8c6f9188-eaff-426b-9d81-a14c4148a34b","b17d77ae-2af7-48e3-be6b-0c70b1dadd61","3e2349d2-0ca4-47ed-b4b9-817e5daafb19","5fd0af8d-72f1-4b7e-8246-4c46b651c531","e558a94c-6104-4bfd-b97b-ac7a2cecce35","cb137291-1ad2-4c35-b496-6f87a469c1b2","a7d3d253-0bfd-4c9d-a9c3-3459ec3ee8d8","3a966f53-355f-4a2e-a25a-4afce1ea4a0f","eea1c2a4-4992-459e-bf8c-735bf96abbe9","57c9d2f6-7086-4d8e-9d5d-1eca18ec8891","06334913-07b1-4622-9b2a-370cf56f0007","74dfb5af-738b-4a0e-916b-ce1970ec85cf","ba72173e-c456-46e9-92dc-73185c654d77","1887f846-11e7-4ab2-b816-c2e8c724718e","9ac64262-cad7-44f3-bfae-96dabec9e770","5b51de44-604b-4a96-b421-9f3e3cf470d2","b9626438-4451-441c-9608-35ab50e3b182","eb402bfa-b46f-4f51-878c-37aef629d3fa","89c371f3-766b-4dab-bde6-d23a97952cd5","ff21bacf-9b2b-4dc2-a715-02cf94e08015","87c07fd3-dcb2-4ba2-8855-927206bfba62","ea69e9ee-ee67-4f2d-83f6-7f862a8495ff","958b2624-6de2-44c8-bf07-ce363d450a28","67a391bb-2b1e-4fb6-b032-dc006e236e6e","e1218662-df9e-477c-bf3d-805e9b420911","697d17c4-4597-4949-9c24-c220aefc31f7","3d6561ad-7ea5-4c0e-9b9d-3280be3ffcc7","0f12132a-db77-4cdb-8b24-449d623a9010","05017ffd-160e-48c5-a6cf-67d04a45f53f","92cc7ea8-55a1-486c-a2ba-71c5093628aa","0821d4cd-353f-431c-bc63-5b51a7971bf0","4c801bb7-cb1b-45e3-a5eb-5aa31bbe1098","5c94c383-f6b2-4cf3-aff8-d629519c5fcd","b989c735-bc3a-4695-a7c2-9496aa28b8a6","a9019468-ed82-456b-854c-c08adf545757","4a898da1-68ac-4794-a30c-1fb7135776eb","aaddc9ad-2a6b-49cd-85a3-e80f4a04c5b8","6dd32bf2-72f8-4e62-bd77-870d9cc9cc99","949b3963-dbea-4abe-9590-97c7cd361209","897a2735-0e80-46da-b6f6-58fc3df53086","cdbbe77b-4b6c-49f0-a006-c1cb7c053d15","61a5c696-b407-4e63-85a8-b57f3f935cbb","42e9c365-194e-49b2-a7ac-d651f12c8cf7","fd81a9e6-b912-4f81-904c-a52526f6dbda","c46efa5f-a694-475c-8663-040a95fb807b","4adffda2-b85f-4660-b450-cfe09c9b0738","bd5cc0b9-d2e8-421b-9c88-de91dda82774","e9bc2136-0167-4fec-a72d-737571f7b027","0f93fc48-ec04-445d-94e5-ce4ed8b70c87","db3c3399-ddb8-4bae-9e89-1b0478931527","f3dfe652-b303-4177-ac57-10dff07f906f","56f414f6-20c9-40e8-8ff2-29784f768d1c","644c1c6a-8d94-4041-8dd4-5fb6a2aada91","7da30be9-2725-4226-9247-2a8fbf5d3d71","dd5540c5-fb12-49f9-b94f-5ffca3054ba5","b4f7298d-08b2-407a-9bee-50dbac0a7f00","7a950eae-90da-4885-8157-68009c201af0","8da6e187-ca72-4c85-8640-517601e1271f","046c0e5f-7098-42d1-b754-64fcc6276660","0b1a2c1b-3b18-4a55-8fa8-08fd5985aa4f","1abf52e0-b652-4629-8353-e2fc1ed8f046","bd871031-b4ad-417f-8082-5fd7bf3c805d","e8d82ad2-a010-4448-a29e-bd19ddf655e7","13d638ec-4f82-4318-bfa6-1f636643dc46","eeb6fd30-006e-4f99-b4c2-40931da53359","4c86679b-7ab7-407e-b863-2a8a46b82a8b","0a0b7aa2-bec5-46e7-949e-fd54ef7bffdc","d355b3d8-545a-4720-82f9-2a0243d72407","dc7a8827-25ac-4443-b8e1-c7de2304eb25","79ddf4d1-9031-4700-b30b-8db26a7b02af","68b8c5b5-7836-476b-8a02-af5b500aa180","e118777a-a087-4a6a-ba10-699cb73b06c4","b4d83009-a10d-4eb4-a04b-ff3dbc8e1304","1c3735df-eb4a-4a7a-ac45-a12b8c6ddbf7","412cb881-aecd-4cfd-8187-cbef4f6d70bb","3d875026-6da6-4cdf-ac18-084706a3eb24","f992976c-ecb4-41b5-ae2c-b25d48707701","90b462a0-5cbe-43d3-8de1-04926b96d492","a28036b8-5a0d-4867-9d8f-dfe034d6ac77","34e78ee8-d46b-4bd1-accb-8efffd17e7f2","1aacaa6e-3718-4b6b-9436-e5cf747a85f5","b147ba74-1764-41ec-93f2-47694e1b8ae3","f8243ce8-45a0-468f-a949-42595e728618","42496cf1-408c-45b5-9492-90985b5d933d","ee70e79d-2c8e-4307-81e3-5e8d1e6cdc4f","833ac885-ef61-4748-bd02-85e3e927a7da","da2975ce-c5eb-4f36-9ae5-541d74b0b370","edc45a1f-e2b4-4a8d-8868-c5d33027ff65","0907e06e-8884-4cdd-bc9a-766dc771049a","22f3e6fb-90b9-4cc6-bd8c-7d97998ffb9c","020a62e4-c5b4-4280-9872-3bf56fa34803","be58e424-c2ac-4835-a482-1083af3f75db","f3a92c2d-1fe4-48e6-b07e-52bf0a73735b","5b51f361-b0a8-4442-a095-4e781cdd2a38","476b5d8c-6d64-49fb-b664-d5c3b19e0dc6","bccc09eb-c3c0-43e1-a377-73ede6bfdc93","b31728b7-f4c4-4870-85dd-e4e543354fa9","4d2f560e-ef38-414b-b78c-c6b400f6d521","634abe84-7bfd-41c4-8ca8-8f2d8d548ec5","06c04e85-a23f-411c-8134-7d75ae627ebb","4c007793-6634-4891-b899-f709d3f8be13","90f9e4a2-b696-4f0c-ba98-d2856619b921","011db133-fd04-47f7-8fc1-255d2bb63e0b","652d83ae-50de-45da-8086-33749e5a8484","dc42afef-e4eb-4f39-9414-30cf73df3ec6","dd47099e-f772-48fd-97da-0396514afd22","9a0a5a76-bca8-44f9-87dc-65384c3a217c","99dcd6b6-61a3-4a17-945c-3e7be66ea38d","30b77330-aeed-45ff-84cc-fe68ff1f8f3a","f5157133-84a3-4904-97d4-07ee533ad17d","5ff9e66d-d71c-4449-825f-2f40aea916a7","05d2906c-0d7e-464a-86a7-e201ef984fdf","46500981-90b0-466c-ba96-7c8cc3abe6bb","66e403e8-7381-4576-a3a1-55b3e5562142","b8f6fce4-32fe-44d3-aa93-1f2b98735a46","9a87eddb-b5c5-4d26-9c05-2ebb3bc25c38","d7608a6b-48f4-4155-abcc-e3f816d76540","5b1ea383-85a8-49e0-92db-c5314fc2bf60","09c9fad5-8783-4bc5-823b-ee96006c988a","c6754733-1cae-447c-87f1-7dcc97ec3c91","e75096b4-c1b9-457c-a0b1-08bb16a9ccb7","184316f7-5174-4e40-ab49-9d0acc795626","1d1f0bf1-ed8d-4b28-b95d-2d45951f6bb7","e4bcde5b-a9af-4ca3-8048-84ed66114db6","fe748adb-5348-4b99-9550-eb578d1267fe","77af2dcb-2afc-4346-afed-eb4a056e6aea","4e041ef3-1f42-4185-a27c-89f919eab933","87546bbc-daa7-45f8-a9a4-1d3fb0dbccc8","c45fab4c-5aae-47ec-a2e8-3eff476212ca","83b9fbc2-90db-4d77-805e-3e5439c3cf94","81bb64e8-81e8-491d-8f87-d08a1a563293","7c02ebd1-16b2-45a2-93c0-276a9b2b802f","5ba31d6f-cb0d-404d-ba7e-470460959007","52308efd-956f-40f1-86c7-121262bfacc1","f76d2214-119e-4338-a84c-976c0f816f8d","d80b366f-38f8-4f43-b773-5fd57180ea04","7b2a23ff-8a2d-437d-927a-d3ebe2bfad75","0397fc82-ee33-457d-b0f5-ee1d6cdb96c8","c11cb495-f207-4780-b893-c049f88cb828","29927ba5-b792-45d2-a9eb-92009c88f23e","4c3cd83e-e143-4a16-9c5a-fafada32b0d1","65767cff-5517-4446-bc54-ab2783fd245e","2a5c0225-dc76-4cdf-9505-bef61cca3074","e687822e-f385-4a3a-b52f-e07dcf1eb946","85dbea68-b96e-4807-a076-fd2e76050c56","f3bccfd2-1ead-4101-8fb8-fd91e9264c47","93aaac98-cf8b-4647-bec1-75cadd34b277","5b6740a2-5ecb-4333-9971-ce9122536803","d138d7b0-547f-4a7a-aa7e-f5905d6f93d1","57ba4b5b-cda7-4fbf-a84b-d390fa8cb998","67e3ad55-b09b-45db-9e1c-d19f6cf42f75","c79374e2-375f-483d-b911-fcf31f5ab260","7cdb9ea8-6ba6-4e96-bd55-4a088f564c1a","2b8820f7-aa83-4844-aa7c-49f65e76ca13","5d695d09-8b83-4974-bbfa-e23db25c9777","965b2b54-ddd1-4aa4-ae8b-e9063f176508","cd7e1241-257f-4fb6-8a47-b58c44fa7fd8","144276a5-081a-491d-a7fe-1d2c302c3c77","48a232b8-2bc3-4e9c-8a19-3a6ea3b0a4f2","eb9db865-87c3-4c9f-8fc2-b616f33a191c","5a05fe82-51e7-4dec-be56-9ee88e1dfb09","1819b87e-93f4-437f-a576-a81829aea8a9","ad85e229-b68e-4609-b15d-7fb83cc57440","ac64ba9a-7be1-49a1-b3c7-ab03eeabb887","a04035db-bb1c-4a4f-a401-46b2852b69d5","31118d8a-d030-4990-ab6c-c1903e25f52d","b55a8da7-da4c-4f95-b24d-df30c2f45c71","d004e080-0446-4f6d-b7c1-e23a4112e42e","2229861a-a659-49b6-83f7-04532904bcaf","c627a829-9cce-40ba-9f5f-658730381474","cd180496-ae10-45de-b90d-ed645113e574","9f85c044-5eb6-43c3-8067-f3a7c605e90f","0428cf5d-33df-46de-bde7-15cdf830836e","2343e042-1a90-4156-bb85-1b4796cef497","f1559f2d-b7fa-438f-8203-314660014496","1137fddf-9bc0-4096-a8f7-60299e1045fa","933b8d80-00ac-441a-b7f1-ff89747a96ef","04530f0c-0761-4c13-8d09-9de1f762f1fb","47345698-eaa6-4dff-a289-a6166b7ed7de","73d74b26-c367-41d2-9631-8b0870281364","f871a524-8782-4e18-82bd-b37c9a02d20e","1cb94ea7-851b-47c4-9779-ca6e36ff729e","d825ee6e-087e-4529-b9c6-cc872035a99b","a0813507-dd48-4247-9e11-5591505be841","22e4f4a0-11e2-48e4-971f-45b042ab5ffe","f2cf7d5a-be29-4778-8716-2ba8052782b5","f7dcc389-593f-440f-9d0f-f2fcb13969b4","f1337a6d-af6e-4577-b393-b1b951b29caf","b0221a97-158b-40c8-9fdb-96de7f828d6f","ebeec459-313c-4cc1-b10e-1d1fd89379d2","67fd654f-5f30-4da9-a9ac-c3a00e62298d","ee5fc60a-9b57-470e-965b-016a9c78965d","1a69020b-4480-48c5-863e-0d362dadc4c5","07cedd59-44b0-4cf0-bb2f-71c15d4d959a","d9deb1c2-2e23-48c2-9df9-d45053a3d7c9","749d0431-47c8-491b-b325-2632a3450efa","3e688f6f-dd89-44a2-990b-1fbebfe4c545","49b38afa-be03-45c9-9709-e99f0fa29896","c0f9dd57-cb4c-4275-8c2c-923bf844fdcb","1224bf88-115f-4ccb-9990-9193ff2c38a5","0e60c769-183d-4657-9a98-b4348b446275","3a47f793-6767-4fab-bddd-acfd43149d5b","345b4e0a-1cd4-4bf6-9647-2830ff18d5ec","8f3857a7-54c3-4a78-8b47-5826f8886fee","dfe91161-0409-42bb-adf7-a97310d6a5e7","49a239b3-6587-4943-8518-ab1f6aa0c200","42f690d6-1db4-410d-85b7-5c89d567ecda","5632a03f-c43a-4560-86f8-9c85313f4164","5ecf0ee6-6e50-4b3e-a08e-62c57333a30c","073ca394-eaed-4b85-a191-6f44fc33ee41","538b78d9-928e-4ad4-b15a-34b37c96ab37","424d82df-9b44-41b5-b611-a1c29ee8ba3e","7a913969-1603-411f-9d1f-cea873782252","b67ce306-a79d-42b0-b2ea-030fc537611e","73aa919d-2805-4438-848b-8349c3f65fe0","c11dafa1-9f92-4f55-8fb7-4e1661bd8fa6","8d9c8281-961f-4c0f-94d3-c50222841c73","98846fb8-3d54-4f77-9d36-414234d86ef6","33b07269-76b3-44d8-9b67-8e101b1df37e","09556661-5d31-4e2b-a916-40772339c29d","a0a3bb82-6ff0-41b3-8b56-65bfad9bddfe","0de62cce-27ed-4c27-a27c-ad4ff7df3cb3","cfaa64e2-78ef-4426-a6a5-9c97b9416a9c","fac15e0e-1c6d-4f78-8b8b-0f64c67559e8","628a2e25-26d3-4ad2-af01-47435cb033aa","7d775bff-9e67-4e9c-bdf6-657139b0c7e3","c69ae828-ce06-417b-8d30-193e8f051c03","4d3d6a95-ba15-4d1a-ab3f-c62584729c22","40b390b6-94d7-4328-879a-4c44fc289ad4","fdebe0c2-395c-425b-ab3b-b460431c9f62","8885799b-3107-4637-8d53-e1a9c3699875","b6f9434d-abba-4b06-b4c5-802dd940be7c","f563cfb6-381f-49ba-85b1-7a59d873d828","5964fc7d-d005-414d-8ddd-f600e78816fc","26655761-99f0-4668-abd0-e86f18515d7d","a9fdbb7a-f803-49ba-b75d-cfa1a3742687","a17cce9b-db68-45da-8f95-44470ab22288","92fe12c4-d11f-4721-830f-acc1dc7ae238","fe508199-026a-4d25-8f86-4863e133ec55","a3d9e508-d6aa-43f0-81cd-bc04671db8e3","8131a139-1b1c-4eda-a538-5f3ffd99a260","eb1a4b9f-2727-4e6e-868e-5120a6f2a48a","f8a4db90-da62-41d3-a74f-fd50fc4f5458","b5c44d60-6655-4f28-a7a0-edd81828f572","6338cbe2-021e-406d-9bb8-88f1ddf0cbbe","51e3a828-8857-4d4c-907f-289e425fff1a","5ca2c593-796b-4ec9-a6af-0f9b56419b9b","41ecdb08-d684-418c-ae6a-6e459f7b7e39","b0df2874-6a4a-41f0-ab0a-74ffd9a58638","814f566f-c8da-4034-8ea5-dc73d1041280","7d3ffe57-f411-4116-97b1-5da284fb32f5","2731005d-3f2c-4d59-af95-857605008540","5c186c47-5c84-44c6-9019-fb1eda5ab042","4ae28606-869e-475e-aa55-6497ecb88ffc","1e9e7223-cf3f-4483-a682-c4da7477279f","e1473692-e4ad-40e2-a560-349cf8f67dbb","ed8ae3e6-b566-4e62-987c-f5d529774521","4e4db2c2-8ccb-4bfe-ae24-3562d9bbc9b1","7293bd3a-0389-4060-862d-33fc45dde040","c969b419-b18f-42cb-99cd-d361018bd4be","456f3b5a-9909-4d60-9810-7a8604038228","32b5f3ee-c089-4dbf-9f4d-afc4753d3ca6","35489a7a-2c8a-46f0-9ac7-b057f8310ddc","2278e74f-c3a5-46de-bc28-c6f4248b1f00","37dd0d04-d5bd-40a7-b057-3aa0ce27c438","f30afd5d-3d43-476e-96ba-30f31569e913","93c85785-8b2a-4305-b81d-f42431891bc0","b14624c2-72fa-44e9-a8ec-c9d82657e130","6dc57f42-9f7b-40e4-ab76-053508dd1cfb","17047d04-360c-41a4-b396-798269d987c5","15978e45-60a6-486a-bdfe-71c6359eae43","cd0038d3-3aff-4bce-aedf-d2caabc0ff24","38ccea82-6607-4013-a099-9e1d2dba1c29","bf90ab92-062f-4db9-bad7-bbf3d2de6203","c5a2d542-031b-465e-8227-e25357b6824c","e267772f-7f8f-4ff2-8420-8a74e70cbac6","f9131d21-248c-48ee-a7d2-0a955bc18143","e82516e0-a77e-481c-87f3-0c6111a60dee","78d7784c-3e69-4e7e-951e-b141fc903c01","5a86d993-6611-4359-b89c-090341d3cad6","60f6e613-1c1f-4e0c-ade6-c1d1df66c942","4f47a4f1-f305-4c53-a102-4c87a1140962","899c1257-4bd8-413e-8c22-15217d3bf246","dc37be6e-7432-43db-a5c4-85c3a61a41bf","b9a001df-14be-44a2-bd41-a91ecd393375","45efbfa5-1720-47fe-ae18-37f7997f2a9a","0da47389-92f1-435f-acb6-b6b88feb8cc3","18819350-9c15-44ef-9d3e-bea11c4f2a31","bad9dc3b-5768-4d3b-b929-cc30b44c6780","2c27388a-7069-4004-b793-7a46d671b9cc","8f94bda0-a5c9-4d38-9367-f76ba52212e5","c6717003-5b76-4978-bd64-e45a9815d9ad","2d189307-1cf8-4374-9357-32f7f719fdaa","4d6f6eed-8b98-4db2-82af-3c4459822a67","05932da9-e597-4c69-97bb-3178abe38ba7","76736415-9cd4-405e-92cc-36ef7fd42af7","35c2b473-7820-47de-b4e4-04001621ad86","c59c055e-e32d-4a75-9637-672fc770456a","927d26d8-a163-40cc-b8c0-95aae0d4c11e","9d09f6b8-402d-4023-8277-d73ef25bfadb","439e0c29-cea7-411a-8c43-f45fa2151183","d6ec245c-cddd-440e-b0b1-81330cb4a693","830701d2-8642-447e-9b42-41bc8cf0df9a","9a6bd000-39e6-4336-9bce-bfc1e0e4f59f","85770327-8f9d-464e-b0c1-5b8e9959e881","4867da7c-1548-4c15-afe2-105d99fca78c","34df3977-43be-4bcb-a7d8-89ef602f253d","7396298f-9fa6-48de-bc19-f7a13bd5ba35","44ee4609-b70a-4577-9728-a9d62330a30e","2c3e349c-e1ea-4089-b4af-20ba6836c694","250c35ee-2fa5-4eb9-b0eb-c7e46c240f3f","e4091305-7e34-41c2-b2e0-7eb6543f4710","02beaf98-46f4-4de2-a54b-9c6369d5409e","d6a2cc8c-7689-4cd5-802d-64373cf7ce8e","36e2df71-8508-4161-b4e2-cefb95aa211e","dafcf971-afd9-4346-a02a-198a71c4fd1f","813ff5ba-c59d-4597-98a9-a349a4b4008a","09c278d6-282b-4553-b1a3-0ecc88adb1ae","e578ce9a-42cf-4124-bc61-c6eb083de860","c25d1c6a-0ff7-4fce-9a3b-6f0d8669f75b","deb12fde-ed41-4923-970c-b8f29dbaea2e","8d3de27b-fb2f-40a8-9527-7c20df05cc8d","00ea135f-a479-45e1-a548-1f22f49ff99b","2bdd0d05-3d1f-4d51-a699-9e69435aab0c","8c371dbd-1a3c-402e-aa75-331025962d7b","83d0a451-567a-4e25-895a-62ead41abb09","310a39f7-be67-47aa-a92e-178da5267ee4","27e68f03-e28a-465e-a81f-336307432807","9f020f1c-ed8e-43fe-a4a0-1ba5c1b005e4","3348bfc5-29f4-4a7d-bbab-72c173fc43f2","24c2d68c-ea31-430c-a60c-718c61628680","bfc49a80-d536-48df-a7bb-b6e6b76a865f","6f5ce424-89c3-4459-ae53-a4945b232dae","c5906279-6c27-40e9-81e0-b440b781dddd","cadf74c9-8649-4b86-9eee-c1484a480745","460843c7-1b6a-4089-8f59-3413e3a5b6f4","6fae06c8-6ad4-47ba-82dc-8af74c6f6834","0e67e333-1728-4aa8-ac78-78a80bfaf00c","f04f5325-8bef-4a11-8dd1-7aee77bd888b","e3fa9fd5-10c3-4e52-88ae-9cb554776ba5","c9d27ef3-e2d0-4f15-9b26-76c6a0ef5c76","01f003ec-b90a-426b-b4f3-963bdb77a0db","4af52f7e-86d4-439f-9ff4-e11717f1c78f","8e76bce7-7c70-4854-aabc-ba8772740776","01fefbbd-9750-4fdd-a775-ccc4b2f43ea8","d77b6817-b98c-4827-a163-f4bfc77b5785","cf30353f-7429-4e89-b992-67b7dbe6ecca","a9056d36-db54-4e74-855c-6749a363dd21","6e424ac3-047a-4b53-b527-0d3689f94f3d","6eaa925a-29af-4359-9560-b8347e47f6fe","92b29e7d-c8ba-4cf2-a42c-f7e885704f63","32fbf9b8-4d95-4c94-9c0d-4ade7df6f586","f579b995-1c59-47d0-aca2-0d5c7b7802d9","4fad536a-fbdb-4acd-8e98-c71f64a8c88d","52d017d6-c4f9-4250-b478-b587d0ab6130","328ceba1-e265-457a-882a-41bbbb0e13e7","f281bde8-1b22-455f-ad21-843533f32437","bc5feb55-c4d3-4f3c-b07f-d160e1d4fb69","53368c52-10b3-4fa8-81d9-d6dca66bdd8b","d7d8b44d-0d19-421e-b3b4-4cb27442e225","75748896-5a01-4af3-8ff1-e63a8448acf6","7f1895e0-ba4e-48ac-85fc-8f8491b8d136","a504ed15-cddc-408f-8521-f302c6013c59","4aeb7590-be76-4ed6-bf30-339680701d77","4b9f4739-40d3-42c2-9868-605478b8dfb7","90bedd71-d96a-4b6a-a8eb-b783151461e6","4b9b3c6f-43c0-4652-9e0c-c308dc5bd091","89194e22-7505-4e71-9089-b2b21473ae2c","6efa3aeb-a5e6-4deb-9995-12bdee1bc77c","813736a0-b2f8-4998-b526-a0702f07f3f7","d99ec63a-e805-40a6-bb2f-c15a589241e0","269bb4b1-693f-4e47-844b-f181b6c92137","3bb69b37-9033-4507-8777-1a290c2074cb","5b31bc69-877b-41d5-a9c5-94460219ca5b","55258282-a6c6-4a33-afbf-70a927aa4c7a","1b74ea0a-9cd0-4f35-8070-cbed478058b1","91f94047-dcef-4d55-a243-9222d57dea3c","626a046b-e7ad-4795-af3a-9676745688b1","cd8e1b6b-7c3a-4e27-8473-c927becc83e8","2c76610c-703f-4246-9937-d21590f8dfff","ec844790-40e3-4651-8ac8-0263bf457b50","229e1236-0e31-4ca9-87a9-14566d3eb47e","805ed1ef-3805-4d0a-a165-9113872dd4d9","3f8bd200-0916-427d-9faa-fc20e4e17491","3dc84eb4-3ca6-44e8-80b8-85a74f989a5f","ab72f8f7-2e66-4adc-8056-5034b9417e87","ffd13238-71af-4015-8cb7-a633ead39d75","cc0f64ab-f56d-4dae-87e9-b77931ce4b7c","2007f60f-317f-4c63-9d0a-a9fec1968026","0af9b723-7a50-4db6-88d3-ca9eac2521d1","b1e3b467-7928-44ee-b131-d4689d2c9fbb","64de2a69-5822-47e2-affb-0138152703a2","003222f5-d07f-4347-a61b-bcabb3b852c1","66ed0ce7-e2b1-4c7a-bd7a-6e1901de2400","397ab7e2-065b-47c4-87d1-1b3119d20e7d","e96547f7-1f3d-42b8-a4ca-9bfbf2c0728e","36cd4db0-a61a-4b36-bbb0-0f87d0a7b7e0","00e361f1-9021-450e-bf35-fe48f1fb6844","ce6bbda4-1b44-44fa-983e-e5f37b89895b","4cd0eced-e273-46c2-84f5-a7efd7fbdd2f","82be252e-5184-44cd-a91b-a7d6ffdefac6","bea8efd0-61d7-495b-a255-5c1f40753cf7","12a6eaa5-30f7-419b-aee7-1be2dbc7278c","75db54d0-46ad-43b1-8ef0-7556ce0e9069","89ba9061-3275-4d76-966f-11691fdfd72f","0eb824c6-f768-47bc-9204-d94dbb912c6e","09f3541c-8edb-4603-9bc3-02bd22cd7836","b13cc3bd-a0a3-4b61-b482-63051d7804b5","b2b10be2-1b2f-4a48-a453-532657bd8e92","a00ebb82-58f2-4b40-89ee-a65be3befabf","6d1f21ba-36cf-4c90-9ecb-d5e377942f3a","50a76940-a26e-443a-b752-1412855e6ad7","30fa18a6-609e-4f5b-af3d-31906c46fe23","3afd60d5-3ce7-431a-b812-2c836b7596a3","dd2f1d05-d4ef-48a0-899c-10fe0346a447","ac411712-ee48-4589-828d-b4e5827efc17","0c5be7d7-cfcf-417b-824a-1a280254a58e","35c18cd6-99a8-47f3-91ee-40dbfec922fa","017372b2-9d34-4118-ad13-9b8e15c30ebd","035cfcde-4292-4905-82b2-6517e58a28b9","bd0b93b9-a0e9-4582-a164-98acdc7a5b45","ecdfe65a-28ee-46d2-a82b-99573e3dd63d","56dd4a06-5073-46d2-8aca-8e37d90e5610","1f8febec-2e84-4be2-a67d-7b5165845a4b","ee67a0e4-8343-4dd6-9636-9504cae6c573","eabf4d1f-9a77-441f-88fb-de9e9e0dc26e","56ba9c1f-2a28-4d05-910c-e89fb051327d","07ffa801-adfb-41f3-809b-87f69ae9e9cd","27fa9add-6ec7-433a-88c9-58279f5055c3","24c31e38-d546-423f-b3cb-a0533e711d02","6e87073b-2877-44d1-9df7-2dd266bb35e3","d6367cec-2e43-4558-882d-fb9a00545fef","172fd543-704b-489a-8d2e-7d1255f51bef","8f27f9ff-57f2-4c07-ad65-55c7f7f7501f","24f220ca-372b-4003-8e74-13291220c778","e16c2241-0f08-4946-908e-c5e6612b0a8c","2e568628-70b1-4f35-934e-81ea4263d0e8","3d8c8d33-f904-41f7-a3ff-b6272c633079","9aefc3b4-f172-4917-b1c7-495c26ec37f9","4453c56e-831c-4203-83fc-9736e276b7dc","6239e7bb-e6a6-4cb4-b4fa-236035bad7f7","95dafcd5-6243-4838-bea1-8e19b0596f6f","34d8ae09-8161-49ec-ae2d-c188c477bb90","cb2a5d30-074f-4c07-97b5-61147e0ea504","e950a58c-0d6f-42c3-8225-9e7adc5d4182","bfe1c963-57ad-4ed2-a9f9-65a3e65f61fd","4ba67e59-362e-4fee-9a67-da423ceefa54","6e41b1fc-a49b-491c-a312-13578c137ab4","037b290e-c8e2-4985-9859-83c40b32b47a","ed447931-f637-4b99-ad61-a2d9d6292ed9","46bcda2b-ec7a-47cc-bcd4-255bb39d310d","61430569-a0c3-4804-a0a3-088135cbbf3e","8e9658b3-1879-43ee-8dd0-aa453db5102d","d8d61f33-8960-4603-849b-b4d1f13a6d36","ece03bf4-b8b2-477a-abe6-125ed58de706","e7bd67f9-1c39-4ac0-b9fe-3441fa74bc14","1ac86639-060b-4e5d-8801-5dd0a40743ff","3ebbe91c-2198-4cd8-8558-ca0b7b47464f","c3762916-2f17-40e0-bd88-12b9442756fd","fe341c1f-ce4e-4845-a24a-802d106b1c80","b5bc1d11-c24d-4523-b371-22c3ee0c4253","0c017ea5-219e-4212-bfdf-89f2ea88187f","39365f4f-a881-461b-97e5-d9aa4ff49498","37f70389-a5e2-4fb8-840f-8cfe940662ef","5ab11760-87f6-4b8a-ae84-206e92aa9009","2486c8b2-de46-4f07-8df9-00ac5080303e","453e1a27-0815-46a0-a5ad-b55267008588","a91e6b04-d782-4974-b523-6c4519a54f50","2c2559b7-77fa-4a0b-877b-2b9769a0caab","ff21f4c6-5ca3-4bb6-b795-aeb1c5b2fe06","845cb0c6-34d2-46fe-9d44-adc3dc124c80","64917ef4-eb94-4a23-a8dc-cb07d7756103","6c5d4d64-558f-4925-8168-b1a96613b0ad","ffb3e282-814e-4b16-a707-5efb54961ba7","7ea58f0d-22f4-4c96-8188-42319c1509ae","1e371f92-dae2-43d6-b029-3d4d1ac8acd9","47a3e557-3e63-45f6-beeb-f7f767589a83","d6070391-2f76-412f-b5a5-bccbfcafc4e5","a96635d9-4dfb-4970-9671-b8f64a5c080c","2238e3ac-7da8-4c47-a13f-854c0576fbd4"]);function i(e){return o.has(e.id)}},95807:(e,t,n)=>{n.d(t,{Hl:()=>r,Sl:()=>i});var o=n(97880);function i(e,t){if(!(0,o.$K)(t)||"production"===e)return t;const n=`notion-${e}-`;return t.startsWith(n)?t:`${n}${t}`}function r(e){return e&&e.startsWith("//")?`https:${e}`:e}},94826:(e,t,n)=>{n.d(t,{EY:()=>x,I$:()=>T,M2:()=>R,RW:()=>M,Uw:()=>C,ZB:()=>k,iV:()=>d,uw:()=>A,z6:()=>P});var o=n(9291),i=n(15070),r=n(72126),a=n(4615),s=n(97880),l=n(64002),c=n(63143);const d={headers:{authorization:{prefix:"Bearer"},hmac:!1},body:{path:["event"]},urlValidator:function(e){return Boolean((0,l.yn)(e))}},u=(0,o.defineMessages)({nightfall:{id:"temporaryWebhookIntegrationConfig.taglines.nightfall",defaultMessage:"Simplify security and compliance with Nightfall AI"},panther:{id:"temporaryWebhookIntegrationConfig.taglines.panther",defaultMessage:"A SIEM built for speed, scale, and flexibility"},sumologic:{id:"temporaryWebhookIntegrationConfig.taglines.sumologic",defaultMessage:"Secure and protect against modern threats with cloud-native log analytics"},splunk:{id:"temporaryWebhookIntegrationConfig.taglines.splunk",defaultMessage:"The unified security and observability platform"},datadog:{id:"temporaryWebhookIntegrationConfig.taglines.datadog",defaultMessage:"Detect, investigate, and automate response to threats at any scale"},polymer:{id:"temporaryWebhookIntegrationConfig.taglines.polymer",defaultMessage:"Protect sensitive data across cloud apps and reduce the risk of exposure"},onna:{id:"temporaryAdminIntegrationConfig.taglines.onna",defaultMessage:"Connect. Find. Act."},hanzo:{id:"temporaryAdminIntegrationConfig.taglines.hanzo",defaultMessage:"Manage Risk Everywhere Work Is Done"},aware:{id:"temporaryAdminIntegrationConfig.taglines.aware",defaultMessage:"Secure Your Digital Workplace. Drive Growth. Scale AI."},metomic:{id:"temporaryAdminIntegrationConfig.taglines.metomic",defaultMessage:"Metomic integration tagline"}}),p={id:"a2768733-a1f9-4174-84fa-40a9ff2053d7",name:"nightfall",icon:"/images/external_integrations/nightfall-logo.svg",website_url:"https://www.nightfall.ai/",signupUrl:"https://www.nightfall.ai/integrations/notion",privacy_policy_url:"https://www.nightfall.ai/privacy",terms_of_use_url:"https://www.nightfall.ai/terms",developer_name:"Nightfall AI",installation_info_url:void 0,type:"dlp",tagline:u.nightfall,webhookUrl:"https://notion.nightfall.ai/notion/v1/event",customization:{headers:{hmac:!0}},allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/nightfall-ai",redirectUri:"https://app.nightfall.ai/dashboard"},m={id:"fb50a39e-955a-4b9c-9ffb-49587de2a79c",name:"panther",icon:"/images/external_integrations/panther-logo.png",website_url:"https://panther.com/",signupUrl:"https://panther.com/product/request-a-demo/",privacy_policy_url:"https://panther.com/privacy-policy/",terms_of_use_url:"https://panther.com/terms-of-service/",developer_name:"Panther",installation_info_url:void 0,type:"siem",customization:{headers:{hmac:!0},urlValidator:function(e){if(!e||!(0,l.yn)(e))return!1;const t=new URL(e);if("https:"!==t.protocol)return!1;if(!t.pathname.startsWith("/http/"))return!1;const n=t.pathname.replace("/http/","");return!!(0,a.t)(n)}},tagline:u.panther,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0,integrationGalleryUrl:"https://www.notion.so/integrations/panther"},f={id:"3ecda536-3b09-4218-a756-bda416c512d7",name:"sumologic",icon:"/images/external_integrations/sumo-logic-logo.jpeg",website_url:"https://www.sumologic.com/",signupUrl:"https://www.sumologic.com/sign-up/",privacy_policy_url:"https://www.sumologic.com/privacy-statement/",terms_of_use_url:"https://www.sumologic.com/terms-conditions/",developer_name:"Sumo Logic",installation_info_url:void 0,type:"siem",tagline:u.sumologic,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/sumo-logic",customization:{urlValidator:function(e){if(!e||!(0,l.yn)(e))return!1;const t=new URL(e);return"https:"===t.protocol&&(!!t.hostname.endsWith("sumologic.com")&&!!t.pathname.startsWith("/receiver/v1/http/"))}}},g={id:"ff522b0f-e688-4986-9b7d-255627316f73",name:"splunk",icon:"/images/external_integrations/splunk-logo.jpeg",website_url:"https://www.splunk.com/",signupUrl:"https://www.splunk.com/en_us/talk-to-sales.html",privacy_policy_url:"https://www.splunk.com/en_us/legal/privacy/privacy-policy.html",terms_of_use_url:"https://www.splunk.com/en_us/legal/terms/terms-of-use.html",developer_name:"Splunk",installation_info_url:void 0,integrationGalleryUrl:"https://www.notion.so/integrations/splunk",customization:{headers:{authorization:{prefix:"Splunk"}},body:{path:["event"]},urlValidator:function(e){if(!e||!(0,l.yn)(e))return!1;const t=new URL(e);if(!["http:","https:"].includes(t.protocol))return!1;let n=t.hostname;return!(!n.startsWith("http-inputs")||!n.endsWith(".splunkcloud.com"))&&(n=n.replace("http-inputs","").replace(".splunkcloud.com",""),!(n.length<2||!n.startsWith("-")&&!n.startsWith("."))&&!!["/services/collector/raw","/services/collector/event"].includes(t.pathname))}},type:"siem",tagline:u.splunk,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0},h={id:"97d68716-a483-4472-8fa9-da26215d721a",name:"datadog",icon:"/images/external_integrations/datadog-logo.png",website_url:"https://www.datadoghq.com/",signupUrl:"https://www.datadoghq.com/free-datadog-trial/",privacy_policy_url:"https://www.datadoghq.com/legal/privacy/",terms_of_use_url:"https://www.datadoghq.com/legal/terms/",developer_name:"Datadog",installation_info_url:void 0,type:"siem",integrationGalleryUrl:"https://www.notion.so/integrations/datadog",customization:{headers:{hmac:!0}},oauth:{accountInfoPropertyNames:{accountId:"dd_oid",accountName:"dd_org_name"},usePKCE:!0,apiDomainsByRegion:{"https://app.datadoghq.com":"api.datadoghq.com","https://us3.datadoghq.com":"api.us3.datadoghq.com","https://us5.datadoghq.com":"api.us5.datadoghq.com","https://app.datadoghq.eu":"datadoghq.eu","https://app.ddog-gov.com":"ddog-gov.com","https://ap1.datadoghq.com":"ap1.datadoghq.com"},tokenPath:"/oauth2/v1/token",apiKeyPath:"/api/v2/api_keys/marketplace"},tagline:u.datadog,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1},v={icon:"/images/external_integrations/polymer-logo.jpeg",website_url:"https://www.polymerhq.io/",signupUrl:"https://www.polymerhq.io/request-demo/",privacy_policy_url:"https://www.polymerhq.io/privacy/",terms_of_use_url:"https://www.polymerhq.io/terms-of-service/",installation_info_url:void 0,type:"dlp",tagline:u.polymer,integrationGalleryUrl:"https://www.notion.so/integrations/polymer",allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_listUsers","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,redirectUri:"https://www.polymerhq.io/"},b={...v,id:"9fb229bb-d287-45de-82f1-7331e99d9c6b",name:"polymer",developer_name:"Polymer",webhookUrl:"https://notion.polymerhq.io/notion/events"},y={...v,id:"1b725b3c-5eda-454d-9b41-0f903de3ba00",name:"polymerDev",developer_name:"PolymerDev",webhookUrl:"https://pilot.qa.polymerhq.io/notion/events"},_={icon:"https://s3-us-west-2.amazonaws.com/public.notion-static.com/3944326d-8881-4093-90f8-63637b1ef75f/metomic.png",website_url:"https://metomic.io/",privacy_policy_url:"https://metomic.io/privacy-policy",terms_of_use_url:"https://metomic.io/terms-and-conditions",signupUrl:"https://metomic.io/",allowedBotCapabilities:{webhooks:!0,read_comment:!0,read_content:!0,insert_content:!0,update_content:!0,read_user_with_email:!0,read_user_without_email:!0},type:"dlp",tagline:u.metomic,allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/metomic",redirectUri:"https://metomic.io/"},S=["public_exportPage","public_workspaceSearch","public_getUser","public_listUsers","public_listTeamspaces","public_getPage","public_getDatabase","public_getSelf"],w={workspace_search:!0,workspace_page_export:!0,read_content:!0,read_user_without_email:!0,read_user_with_email:!0,read_teamspace:!0},k={datadog:h,nightfall:p,panther:m,polymer:b,polymerDev:y,metomic:{..._,id:"05d23763-7da5-4fcc-aad4-a147d5034cc3",name:"metomic",developer_name:"Metomic",webhookUrl:"https://integrations-api.metomic.io/notion/webhooks/generic/0188965b-c4f7-589c-45c0-7766857bad32"},metomicStaging:{..._,id:"75b66e0c-be9f-4fc5-bed6-1bc156f91e1c",name:"metomicStaging",developer_name:"Metomic (Staging)",webhookUrl:"https://integrations-api.metomic-staging.io/notion/webhooks/generic/01889547-4e22-1e0b-f363-571468d1b042"},splunk:g,sumologic:f,onna:{id:"bb67e6bb-09f3-48fe-a7b2-428665ff20ac",name:"onna",icon:"/images/external_integrations/onna-icon.jpeg",website_url:"https://onna.com/",privacy_policy_url:"https://onna.com/privacy-policy",terms_of_use_url:"https://onna.com/master-subscription-agreement",developer_name:"Onna",type:"ediscovery",tagline:u.onna,integrationGalleryUrl:"https://www.notion.so/integrations/onna",allowedBotCapabilities:w,allowedEndpoints:S,redirectUri:"https://localhost:3005"},aware:{id:"99b8b727-7eee-40f8-af16-de045fb78e15",name:"aware",icon:"/images/external_integrations/aware-icon.png",website_url:"https://www.awarehq.com/",privacy_policy_url:"https://www.awarehq.com/privacy",terms_of_use_url:"https://www.awarehq.com/terms-conditions",developer_name:"Aware",type:"ediscovery",tagline:u.aware,integrationGalleryUrl:"https://www.notion.so/integrations/aware",allowedBotCapabilities:w,allowedEndpoints:S,redirectUri:"https://localhost:3005"},hanzo:{id:"2ebac254-9d38-4c94-b579-0eac7fe0f43c",name:"hanzo",icon:"/images/external_integrations/hanzo-icon.png",website_url:"https://www.hanzo.co/",privacy_policy_url:"https://www.hanzo.co/privacy",terms_of_use_url:"https://www.hanzo.co/privacy",developer_name:"Hanzo",type:"ediscovery",tagline:u.hanzo,integrationGalleryUrl:"https://www.notion.so/integrations/hanzo",allowedBotCapabilities:w,allowedEndpoints:S,redirectUri:"https://localhost:3005"}},I=(0,c.m8)((0,s.qP)(k).map((e=>{let[t,n]=e;return[n.id,n]})));function x(e){var t;return null===(t=T(e))||void 0===t?void 0:t.name}function C(e){const t=T(e);return Boolean(t&&"ediscovery"===t.type)}function T(e){if(e)return I[e]}function M(e){const t=T(e);if(t&&("siem"===t.type||"dlp"===t.type))return t}function P(e){return Boolean(T(e))}function A(e){if(!e)return!1;const t=T(e);return!!t&&(0,i.ms)(t.allowedBotCapabilities)}function R(e){const{env:t,integrationConfig:n,webhookUrlToValidate:o}=e;return!!(0,r.TS)({},d,n.customization).urlValidator(o)||"local"===t&&o.startsWith("http://localhost:3005/")}},67175:(e,t,n)=>{n.d(t,{Qf:()=>r,W5:()=>a});var o=n(97880);const i={insertText:!0,deleteText:!0,splitTextIntoBlock:!0,splitText:!0,moveTextSliceIntoBlock:!0,moveTextSlice:!0,addAnnotation:!0,removeAnnotation:!0};function r(e){return Boolean(i[e.command])}function a(e){const{pointer:t,crdtOperation:n}=e,i=n.type;switch(i){case"insertText":return{command:"insertText",pointer:t,path:[],args:n};case"deleteText":return{command:"deleteText",pointer:t,path:[],args:n};case"addAnnotation":return{command:"addAnnotation",pointer:t,path:[],args:n};case"removeAnnotation":return{command:"removeAnnotation",pointer:t,path:[],args:n};case"splitText":return{command:"splitText",pointer:t,path:[],args:n};default:(0,o.t1)(i)}}},7250:(e,t,n)=>{n.d(t,{$A:()=>d,Jq:()=>u,Nv:()=>g,OP:()=>b,j:()=>p,oG:()=>c});n(57658);var o=n(67294),i=n(74686),r=n(65454),a=n(4615);const s={download_desktop_app:!0,download_mobile_app:!0,sign_up:!0,onboarding_show:!0,onboarding_complete:!0,gdpr_consent:!0,create_subscription:!0,subscription_update_plan:!0,subscription_update_billing:!0,subscription_update_billing_email:!0,cancel_subscription:!0,click_upgrade_button:!0,create_space:!0,join_space:!0,leave_space:!0,delete_space:!0,open_support_chat:!0},l=[];function c(e){let{getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:c,cookieService:d}=e;(0,o.useEffect)((()=>{!async function(e){const{getLocale:t,analyticsSettings:n,deviceId:o,onVisibilityChange:s,cookieService:c}=e;if(void 0===n||!n.isIntercomEnabled)return;if(!(await i.ec({service:"intercom",cookieService:c})))return;const d=t().split("-")[0];window.intercomSettings={app_id:n.intercomAppId,user_hash:n.intercomUserHash?n.intercomUserHash:void 0,language_override:d},!n.noIntercomUserId&&n.user_id?window.intercomSettings.user_id=(0,a.cj)(n.user_id):n.user_email&&(window.intercomSettings.email=n.user_email);o&&(window.intercomSettings.device_id=(0,a.cj)(o));let u=Promise.resolve();const p=window.Intercom;if("function"==typeof p)p("reattach_activator"),p("update",window.intercomSettings);else{const e=function(){e.c(arguments)};e.q=l,e.c=function(t){e.q.push(t)},window.Intercom=e,u=(0,r.ZP)(`https://widget.intercom.io/widget/${n.intercomAppId}`)}s&&(f("onShow",(()=>{s(!0)})),f("onHide",(()=>{s(!1)})))}({getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:c,cookieService:d})}),[t,n,s,c,d])}function d(e){if(v()){const{userId:n,userName:o,traits:i,settings:r}=e;if(!r)return;var t={};o&&(t.name=o);const a={email:r.user_email,user_hash:r.intercomUserHash,...i,...t};!r.noIntercomUserId&&n?a.user_id=n:delete a.user_id,Intercom("update",a)}}function u(e){if(v()){const{companiesData:t}=e;Intercom("update",{companies:t})}}function p(e){const{eventName:t,eventData:n}=e;v()&&s[t]&&Intercom("trackEvent",t,n)}let m=!1;function f(e,t){if(v())Intercom(e,t);else{l.push([e,t])}}function g(e){const{prepopulatedContent:t,waitForCssInsets:n}=e;f("showNewMessage",t),!m&&n&&(m=!0,h((()=>n())))}const h=function(e){f("onHide",e)},v=function(){return"undefined"!=typeof Intercom};function b(){if(v())return Intercom("getVisitorId")}},49902:(e,t,n)=>{n.d(t,{j:()=>s,kI:()=>a});n(57658);var o=n(67294),i=n(66673),r=n(65454);function a(e){let{isEnabled:t,isLoggedIn:n,userId:a,userEmail:l,spaceId:c,sprigConfig:d,userDaysSinceSignup:u,userDomainType:p,isSpaceAdmin:m,spaceMemberCount:f}=e;(0,o.useEffect)((()=>{if(!t||!n||void 0===a||void 0===l||void 0===c||void 0===d||void 0===p)return;if(window.Sprig)return;const e=function(){e._queue.push(arguments)};e._queue=[],e.appId=d.environmentId,window.Sprig=e,window.UserLeap=e,window.Sprig("setUserId",a),window.Sprig("setEmail",l),window.Sprig("setAttribute","SPACE_ID",c),f&&window.Sprig("setAttribute","SPACE_MEMBER_COUNT",f),u>=3&&u<=14&&"professional"===p&&s(m?{name:"trigger-phase-1"}:{name:"trigger-phase-1-1"}),(0,r.ZP)("https://cdn.sprig.com/shim.js")}),[t,n,a,d,l,c,m,p,u,f]);const g=(0,i.D9)(n);(0,o.useEffect)((()=>{g&&!n&&window.Sprig&&window.Sprig("logoutUser")}),[g,n])}function s(e){const t=e.name;if(!window.Sprig)return void console.error("Sprig not loaded, not tracking: ",t);const n="args"in e?e.args:{};window.Sprig("track",t,n)}},9163:(e,t,n)=>{n.d(t,{FW:()=>i,eU:()=>o,lR:()=>r});const o={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]}},i="completed",r="dismissed"},41641:(e,t,n)=>{function o(e){return![".","#","$","[","]"].map((t=>-1!==e.indexOf(t))).reduce(((e,t)=>e||t),!1)}n.d(t,{Z:()=>o})},73123:(e,t,n)=>{n.d(t,{Fi:()=>p,Hz:()=>r,Rh:()=>s,Zj:()=>c,aT:()=>f,ez:()=>a,hx:()=>m,xX:()=>l,y3:()=>u,yM:()=>d});var o=n(9291),i=n(97880);const r=["last_7_days","last_28_days","last_90_days","all_time"],a={last_7_days:7,last_28_days:28,last_90_days:90},s=((0,i.AO)((e=>7===e||28===e||90===e?{true:e}:{false:e})),(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.last7days",defaultMessage:"Last 7 Days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.last28days",defaultMessage:"Last 28 Days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.last90days",defaultMessage:"Last 90 Days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.allTime",defaultMessage:"All Time"}})),l=(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last7days",defaultMessage:"last 7 days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last28days",defaultMessage:"last 28 days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last90days",defaultMessage:"last 90 days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.allTime",defaultMessage:"all time"}});function c(e,t,n){const o=e||0,i=t||0;return n?o-i:i-o}function d(e,t,n){const o=e||-1,i=t||-1;return n?o-i:i-o}const u=(0,o.defineMessages)({page:{id:"contentAnalyticsHeaderMessages.columnHeader.page",defaultMessage:"Page"},pageId:{id:"contentAnalyticsHeaderMessages.columnHeader.pageId",defaultMessage:"Page ID"},teams:{id:"contentAnalyticsHeaderMessages.columnHeader.teamspace",defaultMessage:"Teamspace"},audience:{id:"contentAnalyticsHeaderMessages.columnHeader.audience",defaultMessage:"Audience"},allViews:{id:"contentAnalyticsHeaderMessages.columnHeader.allViews",defaultMessage:"All views"},uniqueViews:{id:"contentAnalyticsHeaderMessages.columnHeader.uniqueViews",defaultMessage:"Unique views"},createdBy:{id:"contentAnalyticsHeaderMessages.columnHeader.createdBy",defaultMessage:"Created by"},createdAt:{id:"contentAnalyticsHeaderMessages.columnHeader.createdAt",defaultMessage:"Created at"},lastEditedBy:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedBy",defaultMessage:"Last edited by"},lastEditedAt:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedAt",defaultMessage:"Last edited at"}});const p={num_searches:"numSearches",num_unique_users:"numUniqueUsers",ctr:"ctr"},m={numSearches:"num_searches",numUniqueUsers:"num_unique_users",ctr:"ctr"};function f(e){return e<=1?"1":e<=50?"2-50":e<=100?"51-100":e<=500?"101-500":e<=1e3?"501-1000":e<=5e3?"1001-5000":"5001-plus"}},51454:(e,t,n)=>{n.d(t,{A_:()=>V,Bh:()=>O,D_:()=>l,E:()=>G,Eo:()=>B,Gt:()=>k,I5:()=>p,IK:()=>b,LI:()=>Z,LN:()=>y,MC:()=>g,MU:()=>U,Mo:()=>D,Nm:()=>M,Nn:()=>R,Qm:()=>a,RJ:()=>v,S1:()=>P,VT:()=>h,Wd:()=>K,Wi:()=>o,XB:()=>j,XP:()=>i,Y6:()=>E,YO:()=>L,_:()=>H,_Y:()=>x,ag:()=>Q,db:()=>Y,eU:()=>s,eu:()=>A,fQ:()=>I,hT:()=>z,hc:()=>T,ke:()=>J,l6:()=>r,lB:()=>W,lI:()=>F,mJ:()=>q,mK:()=>w,nD:()=>c,ov:()=>_,p8:()=>$,py:()=>u,sL:()=>f,t8:()=>S,vt:()=>N,wx:()=>m,xP:()=>d,y:()=>C});const o=1,i=2,r=2,a=2,s=3,l=9,c=9,d=30,u=81,p=83,m=83,f=84,g=84,h=85,v=85,b=85,y=85,_=85,S=85,w=86,k=86,I=86,x=86,C=86,T=87,M=87,P=88,A=89,R=99,D=99,B=99,E=99,F=100,Z=100,V=101,j=102,U=102,L=109,O=110,N=111,z=111,W=113,q=999,H=9999,K=9999999,G=1e6,$=1,Q=2,Y=3,J=4},88642:(e,t,n)=>{n.d(t,{j:()=>l,g:()=>c});var o=n(74686),i=n(29477);let r,a;async function s(e,t,n){if(r)return r;e.planType=t,e.isSalesAssistedPlan=n;const a=(0,i.UZ)();r=a.promise,await async function(e){if(!(await o.ec({service:"zendesk",cookieService:e.cookieService})))return;const t=document.createElement("script");if(t.type="text/javascript",t.async=!0,t.src="https://solve-widget.forethought.ai/embed.js",t.id="forethought-widget-embed-script",t.setAttribute("data-api-key","c895ee24-2c6c-4ed6-a100-3037e65cadda"),t.setAttribute("data-ft-full-name",e.fullName||"Forethought Deflected"),t.setAttribute("data-ft-email",e.email||"forethought@makenotion.com"),e.locale){var n;const o=null===(n=e.locale.split("-")[0])||void 0===n?void 0:n.toLowerCase();o&&t.setAttribute("data-ft-embed-script-language",o)}const i=e.planType||"undefined";"enterprise"===i&&e.isSalesAssistedPlan?(t.setAttribute("data-ft-plan-type","enterprise_free"),t.setAttribute("data-ft-workflow-tag","enterprise_free"),t.setAttribute("initial-intent-id","d5cb32d0-3637-4e8e-87fa-c4ea8d79d45f")):(t.setAttribute("data-ft-plan-type",i),t.setAttribute("data-ft-workflow-tag",i));const r=document.getElementsByTagName("script")[0];return null==r||r.parentNode.insertBefore(t,r),window.addEventListener("message",(e=>{var t,n;"forethoughtWidgetClosed"===(null==e||null===(t=e.data)||void 0===t?void 0:t.event)&&(null===(n=Forethought)||void 0===n||n("widget","hide"))})),new Promise((e=>{t.addEventListener("load",(()=>{var t;null===(t=Forethought)||void 0===t||t("widget","hide"),e()}))}))}(e),a.resolve()}async function l(e){if(a)return a;const t=(0,i.UZ)();a=t.promise,e.isForethoughtEnabled&&await s(e.forethoughtInitializeArgs,e.userHighestPlanType,e.isSalesAssistedPlan),await async function(e){const{locale:t,cookieService:n}=e;if(!(await o.ec({service:"zendesk",cookieService:n})))return;const i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src="https://static.zdassets.com/ekr/snippet.js?key=b9ad856d-6b98-4cf5-a2f6-d96e50557722",i.id="ze-snippet";const r=document.getElementsByTagName("script")[0];return null==r||r.parentNode.insertBefore(i,r),new Promise((e=>{i.addEventListener("load",(()=>{var n=window.zE;n&&(n("webWidget","setLocale",t),n("webWidget","hide"),e())}))}))}(e),t.resolve()}async function c(e){if(await l(e),"undefined"!=typeof Forethought)Forethought("widget","show"),Forethought("widget","open");else{var t=window.zE;if(!t)return;t("webWidget","show"),t("webWidget","open"),t("webWidget:on","close",(function(e){(t=window.zE)&&t("webWidget","hide")}))}}}}]);