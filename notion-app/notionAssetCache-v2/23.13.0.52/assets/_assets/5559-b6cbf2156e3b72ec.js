"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5559],{79698:(e,t,o)=>{o.d(t,{j:()=>h});var i=o(9291),r=o(14542),n=o(96809),s=o(47307),a=o(96802),l=o(27153),d=o(82530),p=o(53471);const c=(0,i.defineMessages)({pageCover:{defaultMessage:"Page cover",id:"pageCover.title"},fileTypeCaption:{defaultMessage:"Images wider than {idealImageWidth} pixels work best.",id:"pageCover.fileType.caption"},uploadFailed:{defaultMessage:"Upload failed",id:"pageCover.errorDialogMessage.uploadFailed"},embedTitle:{defaultMessage:"Link",id:"pageCover.embedType.title"},embedPlaceholder:{defaultMessage:"Paste an image linkâ€¦",id:"pageCover.embedType.placeholder"},embedCaption:{defaultMessage:"Works with any image from the web.",id:"pageCover.embedType.caption"},embedSubmit:{defaultMessage:"Submit",id:"pageCover.embedType.buttonText"}});function h(e){let{environment:t,intl:o,store:i,rect:r}=e;l.$(t,{originGap:3,originRect:r,isSmallWidth:!1,popupWidth:540,maxHeight:485,title:o.formatMessage(c.pageCover),onDelete:()=>{!function(e){let{environment:t,store:o}=e;l.Z(),d.createAndCommit({userAction:"PageCover.handleDelete",environment:t,perform:e=>{a.MF({store:o,transaction:e})}})}({environment:t,store:i})},currentTab:"gallery",tabs:[{type:"gallery",onChange:e=>{let{url:o,position:r}=e;u({environment:t,store:i,url:o,position:r})}},{type:"file",fileUpload:!1,imageUpload:!0,videoUpload:!1,caption:o.formatMessage(c.fileTypeCaption,{idealImageWidth:1500}),onUpload:e=>{l.Z(),p.cT({environment:t,file:e,bucket:"secure",record:i.pointer,onStart:m,onProgress:y,onComplete:e=>{var o;o={environment:t,store:i,url:e},g({...o,position:.5})},onError:()=>{s.showErrorMessage(o.formatMessage(c.uploadFailed))}})}},{type:"embed",title:o.formatMessage(c.embedTitle),inputPlaceholder:o.formatMessage(c.embedPlaceholder),caption:o.formatMessage(c.embedCaption),buttonText:o.formatMessage(c.embedSubmit),onChange:e=>{var o;o={environment:t,store:i,url:e},g({...o,position:.5}),l.Z()}},{type:"unsplash",onChange:e=>{let{url:o,position:r}=e;u({environment:t,store:i,url:o,position:r})}}]})}async function g(e){const{environment:t,store:o,url:i,position:s}=e,{serverCommitResult:l}=d.createAndCommit({userAction:"PageCover.updatePageCover",environment:t,perform:e=>{a.fs({store:o,url:i,position:s||.5,transaction:e})}});await l,n.Z.state.loadingMode===r.NS&&n.Z.setState({loadingMode:r.EP,dataURL:n.Z.state.dataURL,uploadProgress:100})}function u(e){g(e),e.environment.device.isMobile&&l.Z()}function m(e){const{file:t,name:o,size:i}=e;if(l.Z(),n.Z.setState({loadingMode:r.SS,file:t,name:o,size:i}),t.type.indexOf("image")>=0){const e=new FileReader;e.onload=e=>{n.Z.state.loadingMode===r.SS&&n.Z.setState({...n.Z.state,uploadProgress:0,loadingMode:r.NS,dataURL:e.target.result})},e.readAsDataURL(t)}}function y(e){const{progressPercent:t}=e;n.Z.state.loadingMode===r.NS&&n.Z.setState({...n.Z.state,uploadProgress:t})}},87636:(e,t,o)=>{o.d(t,{Z:()=>y});var i=o(67294),r=o(13991),n=o(480),s=o(24405),a=o(22491),l=o(97880),d=o(82990),p=o(17311),c=o(23063),h=o(64921),g=o(26388),u=o(85893);function m(e){window.__c={n:"ActionMenuGroupButton"};const{button:t,isLast:o}=e,r=(0,s.yK)((e=>({button:{display:"flex",alignItems:"center",padding:"4px 6px",fontWeight:d.Z.fontWeight.medium,borderRight:`1px solid ${e.regularDividerColor}`,color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor},buttonLast:{borderRight:"none"},buttonHovered:{background:e.whiteButtonHoveredBackground},buttonPressed:{background:e.whiteButtonPressedBackground}})),[]);return i.cloneElement(t,{...(0,a.iv)(t.props.style,r.button,o&&r.buttonLast),hoveredStyle:(0,a.iv)(r.buttonHovered,o&&r.buttonLast).style,pressedStyle:r.buttonPressed})}const y=function(e){let{children:t,isVisible:o,position:y,style:v}=e;window.__c={n:"ActionMenuGroup"};const S=(0,n.O7)(),f=(0,s.yK)((e=>({container:{color:e.actionMenuButtonTextColor,fill:e.actionMenuButtonTextColor,fontSize:12,background:e.whiteButtonBackground,boxShadow:e.lightBoxShadow,display:"flex",whiteSpace:"nowrap",borderRadius:p.Z.borderRadius,maxWidth:"calc(100% - 16px)",minHeight:24,overflow:"hidden",pointerEvents:S.device.isMobile?"auto":"none",opacity:S.device.isMobile?1:0,fontFamily:d.Z.getCompositeFontFamily(r.SP).sans,position:"absolute",right:p.Z.horizontal.small,bottom:p.Z.vertical.small,zIndex:2},containerHover:{pointerEvents:"auto",opacity:1},containerTop:{top:p.Z.vertical.small,bottom:void 0}})),[S]),C=i.Children.toArray(t).filter(l.$K),b=C.length;return(0,u.jsx)(c.Z,{isVisible:!0,animationStyle:{opacity:o?1:0},render:()=>(0,u.jsx)("div",{...(0,a.iv)(f.container,v,o&&f.containerHover,"top"===y&&f.containerTop),children:C.map(((e,t)=>{const o=t===b-1;if(e&&"object"==typeof e&&"type"in e){if(e.type===g.ZP&&i.isValidElement(e))return i.cloneElement(e,{render:(t,i)=>{const r=e.props.render(t,i);return(0,u.jsx)(m,{isLast:o,button:r},e.key)}});if(e.type===h.Z&&i.isValidElement(e))return(0,u.jsx)(m,{isLast:o,button:e},e.key)}}))})})}},65496:(e,t,o)=>{o.d(t,{Z:()=>k});var i=o(67294),r=o(83355),n=o(9291),s=o(96802),a=o(79698),l=o(82530),d=o(28651),p=o(50627),c=o(94841),h=o(14542),g=o(96809),u=o(87636),m=o(23063),y=o(64921),v=o(12981),S=o(65107),f=o(68785),C=o(32854),b=o(81865),P=o(97496),x=o(56282),w=o(85893);class M extends r.Z{constructor(){super(...arguments),this.lastProxiedUrl=void 0,this.storeTypes={mouseStore:d.Z},this.renderControl=e=>{let{isVisible:t,isRepositioning:o,handleCancelClick:i,handleRepositionClick:r,handleSavePositionClick:s}=e;if(this.props.disabled||g.Z.state.loadingMode!==h.LU)return;const{device:a}=this.environment,{isMobile:l}=a;return(0,w.jsx)(m.Z,{isVisible:!0,animationStyle:{width:R(this.props.store),opacity:t?1:0},render:()=>(0,w.jsx)("div",{style:{position:"absolute",pointerEvents:t?"auto":"none",maxWidth:"100%",top:48},children:(0,w.jsxs)(u.Z,{isVisible:t,position:"bottom",style:{marginRight:this.props.paddingRight,marginLeft:this.props.paddingLeft},children:[!o&&(0,w.jsx)(y.Z,{style:{borderRight:l?"none":void 0,...P.ar},onClick:this.handleChangeCoverClick,children:(0,w.jsx)(n.FormattedMessage,{defaultMessage:"Change cover",id:"pageCover.changeCover.text"})}),!o&&!l&&(0,w.jsx)(y.Z,{style:{...P.ar,borderRight:"none"},onClick:e=>r(e,this.lastProxiedUrl),children:(0,w.jsx)(n.FormattedMessage,{defaultMessage:"Reposition",id:"pageCover.reposition.text"})}),o&&!l&&(0,w.jsx)(y.Z,{style:P.ar,onClick:s,children:(0,w.jsx)(n.FormattedMessage,{defaultMessage:"Save position",id:"pageCover.savePosition.text"})}),o&&!l&&(0,w.jsx)(y.Z,{style:{...P.ar,borderRight:"none"},onClick:i,children:(0,w.jsx)(n.FormattedMessage,{defaultMessage:"Cancel",id:"pageCover.reposition.cancelText"})})]})})})},this.handleChangeCoverClick=e=>{const{intl:t,store:o}=this.props;this.stores.mouseStore.reset();const i=e.target.getBoundingClientRect();a.j({environment:this.environment,intl:t,store:o,rect:i})},this.coverWithRecordStore=this.createComputedStore((()=>this.props.store.getCover()),!0),this.isPersonalHome=this.createComputedStore((()=>(0,c.WE)(this.props.store)))}renderComponent(){const e=this.coverWithRecordStore.getState();if(!e)return;const t=g.Z.state,o=t.loadingMode!==h.LU&&t.loadingMode!==h.SS;return(0,w.jsx)(x.Z,{mouseStore:this.stores.mouseStore,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:i,reset:r}=e;l.createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,perform:e=>{s.Mp({store:t,coverPosition:i,transaction:e}),r()}})}(e,this.props.store,this.environment),renderControl:this.renderControl,source:"page",store:this.props.store,style:{display:"flex",flexDirection:"column",alignItems:"center",height:this.props.height,cursor:"default"},render:r=>(0,w.jsxs)(i.Fragment,{children:[(0,w.jsx)(b.Z,{url:e.cover,isAuthenticated:!0,permissionRecord:e.pointer,width:this.props.proxyWidth,render:(e,i)=>{this.lastProxiedUrl=i;const n={width:"100%",height:this.props.height,objectFit:"cover",opacity:o?.5:1,objectPosition:`center ${100*(1-(r.imagePosition||0))}%`,borderRadius:0},s={width:"100%",height:this.props.height};return(0,w.jsx)(S.B,{src:i,placeholderSrc:o?t.dataURL:void 0,placeholderBehavior:o?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:s,imageStyle:n,onLoadComplete:j})}}),o&&(0,w.jsxs)("div",{style:v.I,children:[(0,w.jsx)(f.Z,{style:{width:16,height:16,marginRight:4}}),(0,w.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,w.jsx)(C.Z,{percentage:t.uploadProgress})})]})]})})}}M.displayName="PageCover";const k=(0,n.injectIntl)(M);function R(e){let t;return t=!!e.isFullWidth()?"100%":p.zL,t}function j(){g.Z.reset()}},56282:(e,t,o)=>{o.d(t,{Z:()=>w});o(67294);var i=o(73935),r=o(83355),n=o(13991),s=o(6740),a=o(49085),l=o(12137),d=o(8848),p=o(22491),c=o(72126),h=o(82990),g=o(63143),u=o(9291),m=o(24677),y=o(28651),v=o(27724);class S extends a.default{getInitialState(){return{showFadeInAnimation:!1,isRepositioning:!1}}}const f=S;var C=o(23063),b=o(6685),P=o(85893);class x extends r.Z{constructor(){super(...arguments),this.storeTypes={focusStore:a.default.createClass(!1),mouseStore:y.Z,withImageRepositioningStore:f},this.renderDraggable=()=>(0,P.jsx)(b.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disabled:!this.isRepositioning(),render:e=>(0,P.jsx)("div",{...(0,p.iv)(this.getDragContainerStyle()),...e,children:this.props.render({imagePosition:this.getRenderedCoverPosition(),isRepositioning:this.isRepositioning(),showFadeInAnimation:!1})})}),this.shouldBeActiveStore=this.createComputedStore((()=>0===v.default.state.stores.length)),this.handleFocus=e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,s.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=e=>{this.stores.focusStore.setState(!1)},this.handleMouseMove=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.mouseStore.setState({...this.mouseStore.state,mouseEntered:!1})},this.handleMouseMoveThrottled=(0,c.P2)(this.handleMouseMove,100),this.handleMouseLeaveDebounced=(0,c.Ds)(this.handleMouseLeave,100),this.handleWindowMouseDown=e=>{const t=i.findDOMNode(this);t&&!t.contains(e.target)&&this.isRepositioning()&&this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.mouseStore.reset(),this.stores.withImageRepositioningStore.reset()}})},this.handleRepositionClick=(e,t)=>{m.ZH(this.environment);const o=new Image;o.onload=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,isRepositioning:!0,image:o})},t&&(o.src=t)},this.handleCancelClick=e=>{this.stores.withImageRepositioningStore.reset()},this.handleSavePositionClick=e=>{this.props.onFlushTemporaryPosition({imagePosition:this.getRenderedCoverPosition(),reset:()=>{this.stores.withImageRepositioningStore.reset()}})},this.handleDragStart=e=>{const t=this.isRepositioning(),{image:o}=this.stores.withImageRepositioningStore.state;if(o&&t){const e=i.findDOMNode(this);if(e&&e instanceof Element){const t=e.getBoundingClientRect().width/o.width*o.height,i=this.getRenderedCoverPosition();this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:t,startDragRenderedPosition:i})}}},this.handleDragMove=e=>{if(this.isRepositioning()){const{startDragRenderedPosition:t,startDragImageScreenHeight:o}=this.stores.withImageRepositioningStore.state,i=e.diffY/(o||0)+(t||0);this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,temporaryPosition:(0,c.NM)((0,l.Z)(i,0,1),4)})}},this.handleDragEnd=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})},this.handleDragCancel=()=>{this.stores.withImageRepositioningStore.setState({...this.stores.withImageRepositioningStore.state,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})}}didMount(){super.didMount(),window.addEventListener("mousedown",this.handleWindowMouseDown)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown)}UNSAFE_willMountOrUpdate(){this.isRepositioning()&&!this.shouldBeActiveStore.state&&this.stores.withImageRepositioningStore.reset()}renderComponent(){const{device:e}=this.environment,{style:t}=this.props,{isMobile:o}=e,i=this.isRepositioning(),{mouseEntered:r}=this.mouseStore.state,n=this.stores.focusStore.state;return(0,P.jsxs)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseEnter:this.handleMouseMoveThrottled,onMouseMove:this.handleMouseMoveThrottled,onMouseLeave:this.handleMouseLeaveDebounced,...(0,p.iv)({position:"relative",width:"100%"},t),children:[this.renderDraggable(),this.renderDragMessage(),this.props.renderControl({handleRepositionClick:this.handleRepositionClick,handleSavePositionClick:this.handleSavePositionClick,handleCancelClick:this.handleCancelClick,isVisible:o||r||n||i,isRepositioning:i})]})}renderDragMessage(){const{isRepositioning:e}=this.stores.withImageRepositioningStore.state;if(!this.props.small)return(0,P.jsx)(C.Z,{isVisible:!0,animationStyle:{opacity:e?1:0},render:()=>(0,P.jsx)("div",{style:{background:d.ZP.blackWithAlpha(.4),borderRadius:4,color:d.ZP.white,fontSize:12,fontFamily:h.Z.getCompositeFontFamily(n.SP).sans,width:180,left:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"},"aria-hidden":!e,children:(0,P.jsx)(u.FormattedMessage,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})})}isRepositioning(){return this.stores.withImageRepositioningStore.state.isRepositioning}getRenderedCoverPosition(){const{temporaryPosition:e}=this.stores.withImageRepositioningStore.state;return(0,c.hj)(e)?e:function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,c.hj)(e))return e}const o=.5;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e){const t=e.getFormat().collection_cover_position;return(0,g.z4)(t)?o:t}}const i=t.getFormat().page_cover_position;if((0,c.hj)(i))return i;return o}(this.props.source,this.props.store)}get mouseStore(){return this.props.mouseStore||this.stores.mouseStore}getDragContainerStyle(){return{width:"100%",cursor:this.isRepositioning()?"move":"inherit"}}}x.displayName="WithImageRepositioning";const w=x},41883:(e,t,o)=>{o.d(t,{Z:()=>B});var i=o(67294),r=o(480),n=o(72126),s=o(9291),a=o(96802),l=o(82530),d=o(79131),p=o(87167),c=o(1302),h=o(99036),g=o(51365),u=o(66890),m=o(78030),y=o(80559),v=o(86628),S=o(24405),f=o(80951),C=o(42875),b=o(47453),P=o(33929),x=o(1018),w=o(85526),M=o(97039),k=o(52275),R=o(85893);function j(e){window.__c={n:"PagePropertiesRowValue"};const{property:t,store:o,disabled:n,canConfigureCollection:a,onTab:l,onUntab:d,schema:p,blockPropertyValueOverlayStore:c,collectionStore:h}=e,y=(0,r.O7)(),{device:j,currentUser:Z}=y,I=(0,S.Fg)(),T=(0,u.Y$)(),B=p[t],D=(0,S.yK)((()=>({propertyOuter:{display:"flex",alignItems:"left",marginLeft:4,height:"100%",flex:"auto",flexDirection:"column",minWidth:0},property:{display:"flex",alignItems:"center",marginLeft:4,height:"100%",flex:"auto",minWidth:0},addPageButton:{fontSize:14,minHeight:x.wI,color:I.lightTextColor,background:void 0,boxShadow:void 0}})),[I.lightTextColor]),L=(0,i.useCallback)((()=>{w.Z.setState({...w.Z.state,hoveredProperty:e.property})}),[e.property]),F=(0,i.useCallback)((()=>{w.Z.setState({...w.Z.state,hoveredProperty:void 0})}),[]),A=(0,i.useCallback)((()=>{g.bA({environment:y,blockPropertyValueOverlayStore:c,store:o,property:t,format:m.C.Page,collectionContextStore:T})}),[y,c,o,t,T]),O=(0,v.VK)((()=>j.isMobile&&!n&&"relation"===(null==B?void 0:B.type)&&o.isDefined()&&!f.wV({block:o.getModel(),property:t,schema:p,getRecordModel:o.getRecordModel,userId:Z.id,userTimeZone:(0,C.r)(),intl:P.default.getIntl()})),[Z.id,j.isMobile,n,t,B,p,o]);return(0,R.jsxs)("div",{role:"cell",style:D.propertyOuter,children:[(0,R.jsx)("div",{style:D.property,onMouseMove:L,onMouseLeave:F,children:(0,R.jsx)(M.Z,{store:o,property:t,locked:!a,disabled:n,format:m.C.Page,onTab:l,onUntab:d,tableWrap:!1,blockPropertyValueOverlayStore:c,onOpenProperty:A,showRelationTooltip:!0,collectionStore:h})},t),O&&(0,R.jsx)(k.Z,{focused:!1,icon:(0,b.R)({width:14,fill:I.lightIconColor}),buttonStyle:{marginRight:0,width:"calc(100% - 4px)"},style:D.addPageButton,title:(0,R.jsx)(s.FormattedMessage,{id:"pagePropertyRowValue.addRelationButtonMessage",defaultMessage:"Add page"}),onClick:A})]})}const Z=i.memo(j);function I(e){window.__c={n:"PagePropertyRow"};const{schema:t,format:o,store:s,collectionStore:a,disabled:l,locked:d,blockPropertyValueOverlayStore:h,isInPeekRenderer:v,property:S,mergedProperties:f,dragHandleStyle:C,hideDragHandle:b,disablePropertyName:P}=e,x=(0,i.useId)(),w=(0,r.O7)(),M=(0,u.Y$)(),k=(0,p.v)(a),j=(0,i.useCallback)((()=>{const e=h.state;if(!e.isOpen)return;const o=f,i=o.findIndex((t=>t.property===e.property)),r=o.find(((e,o)=>o>i&&T(t,e.property)))||o.find(((e,o)=>T(t,e.property)));r&&c.default.afterNextFlush((()=>{g.bA({environment:w,blockPropertyValueOverlayStore:h,store:s,property:r.property,format:m.C.Page,collectionContextStore:M})})),g.xv({environment:w,blockPropertyValueOverlayStore:h})}),[h,M,w,f,t,s]),I=(0,i.useCallback)((()=>{const e=h.state;if(!e.isOpen)return;const o=f,i=o.findIndex((t=>t.property===e.property)),r=n.dF(o,((e,o)=>o<i&&T(t,e.property)))||n.dF(o,((e,o)=>T(t,e.property)));r&&c.default.afterNextFlush((()=>{g.bA({environment:w,blockPropertyValueOverlayStore:h,store:s,property:r.property,format:m.C.Page,collectionContextStore:M})})),g.xv({environment:w,blockPropertyValueOverlayStore:h})}),[h,M,w,f,t,s]);return(0,R.jsxs)("div",{role:"row","aria-labelledby":x,style:{display:"flex",paddingBottom:4,width:"100%"},children:[(0,R.jsx)(y.Z,{schema:t,format:o,property:S,collectionStore:a,disabled:Boolean(l||P),locked:d,canConfigureCollection:k,isInPeekRenderer:v,dragHandleStyle:C,hideDragHandle:b,propertyNameAriaId:x,blockStore:s}),(0,R.jsx)(Z,{schema:t,property:S,store:s,collectionStore:a,disabled:l||d,canConfigureCollection:k,onTab:j,onUntab:I,blockPropertyValueOverlayStore:h})]},S)}function T(e,t){const o=e[t];return Boolean(o&&!h.uk.includes(o.type))}function B(e){window.__c={n:"PageProperties"};const{disabled:t,locked:o,collectionStore:c,format:h,mergedProperties:g,showHiddenProperties:u,hideDragHandle:m}=e,y=(0,r.O7)(),v=(0,s.useIntl)(),S=g,f=(0,p.v)(c),C=(0,i.useMemo)((()=>S.filter((e=>"section"!==e.visibility&&(!!u||"hide"!==e.visibility&&!("hide_if_empty"===e.visibility&&!e.hasValue)))).map((e=>e.property))),[S,u]),b=(0,i.useCallback)((e=>{const t=h.collection_page_properties||[],o=[...n.oA(e.map((e=>t.find((t=>t.property===e))))),...t.filter((t=>!e.includes(t.property)))];l.createAndCommit({userAction:"PageProperties.handleReorder",environment:y,perform:e=>{a.FH({stores:[c],update:{collection_page_properties:o},transaction:e})}})}),[c,y,h.collection_page_properties]),P=v.formatMessage({id:"pageProperties.tableLabel",defaultMessage:"Page properties"});return t||o||!f||m?(0,R.jsx)("div",{role:"table","aria-label":P,style:d.yA,children:C.map(((t,o)=>(0,R.jsx)("div",{children:(0,R.jsx)(I,{...e,property:t})},o)))}):(0,R.jsx)(d.ZP,{role:"table","aria-label":P,direction:"vertical",keys:C,renderKey:t=>(0,R.jsx)(I,{...e,property:t}),onDrop:b})}},12867:(e,t,o)=>{o.d(t,{Uv:()=>I,ZP:()=>T});var i=o(67294),r=o(480),n=o(86628),s=o(24405),a=o(56666),l=o(47453),d=o(9291),p=o(16956),c=o(5149),h=o(66890),g=o(68641),u=o(98742),m=o(61766),y=o(97039),v=o(78030),S=o(51774),f=o(23063),C=o(64921),b=o(31945),P=o(1743),x=o(53437),w=o(26388),M=o(80559),k=o(87167),R=o(41883),j=o(65091),Z=o(85893);const I=130;function T(e){window.__c={n:"PagePropertiesCompact"};const{store:t,collectionStore:o,blockPropertyValueOverlayStore:a,compactProperties:l,disabled:d,locked:p,format:c,isInPeekRenderer:g,hiddenProperties:u,rowLength:S}=e,C=(0,n.VK)((()=>o.getSchema()),[o]),[b,P]=(0,i.useState)(!1),x=(0,k.v)(o),w=(0,r.Fy)(),R=(0,n.qz)(void 0,m.Z),j=(0,h.Y$)(),I=(0,s.yK)((()=>({PagePropertiesCompactRow:{display:l.length>S?"grid":"flex",justifyContent:"flex-start",gridTemplateColumns:`repeat(${S}, 1fr)`,columnGap:10,rowGap:4,marginTop:2,marginBottom:6}})),[l.length,S]),T=(0,i.useCallback)((()=>{P(!0)}),[]),D=(0,i.useCallback)((()=>{P(!1)}),[]);return(0,Z.jsx)("div",{style:I.PagePropertiesCompactRow,onMouseEnter:T,onMouseLeave:D,children:l.map(((e,i)=>{const r=i===l.length-1;return(0,Z.jsxs)("span",{style:{flexShrink:1,display:r?"flex":void 0},children:[(0,Z.jsxs)("span",{style:{flex:1,overflow:"hidden"},children:[(0,Z.jsx)(M.Z,{schema:C,format:c,hideIcon:!0,hideDragHandle:!0,property:e.property,blockStore:t,collectionStore:o,disabled:d,locked:p,canConfigureCollection:x,isInPeekRenderer:g,style:{height:24,width:"100%"}}),(0,Z.jsx)(y.Z,{store:t,collectionStore:o,blockPropertyValueOverlayStore:a,property:e.property,format:v.C.CompactPage,disabled:d,locked:p,tableWrap:!1})]}),r&&(0,Z.jsx)(f.Z,{isVisible:b||w.isMobile,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1,marginLeft:"auto"},exitAnimationStyle:{opacity:0},render:()=>(0,Z.jsx)(B,{onClose:D,hiddenProperties:u,canConfigureCollection:x,store:t,collectionStore:o,collectionContextStore:j,blockPropertyValueOverlayStore:a,disabled:d,locked:p,isInPeekRenderer:g,format:c,buttonPopupStore:R})})]},e.property)}))})}const B=i.memo((e=>{window.__c={n:"CompactPropertyActionButton"};const{hiddenProperties:t,canConfigureCollection:o,collectionStore:h,isInPeekRenderer:m,buttonPopupStore:y,collectionContextStore:v,hideDragHandle:f,overflowButtonWrapperStyle:M,overflowButtonStyle:k}=e,I=(0,r.Fy)(),T=(0,r.O7)(),B=(0,n.VK)((()=>h.getSchema()),[h]),D=(0,s.yK)((e=>({overflowIcon:{width:16,height:16,fill:e.mediumIconColor},pagePropertiesOverflow:{width:"100%",fontSize:14,padding:f?"10px":"10px 10px 10px 28px",maxHeight:500,overflowY:"scroll"},overflowButtonWrapper:{display:"flex",alignItems:"center",paddingBottom:8,...M},overflowButton:{display:"flex",width:32,height:32,borderRadius:4,justifyContent:"center",alignItems:"center",...k}})),[f,M,k]),L=(0,i.useCallback)((()=>{p.fH({environment:T,collectionContextStore:v,collectionStore:h,isInPeekRenderer:m,onCloseMenu:()=>{y.setState({open:!1})}})}),[T,v,h,m,y]);return t.length?(0,Z.jsx)(b.ZP,{onClose:e.onClose,popupWrapStyle:{width:500},buttonPopupStore:y,popupType:I.isMobile?x.kQ.SlideUp:x.kQ.Popup,render:()=>(0,Z.jsx)(P.Z,{capture:!0,children:(0,Z.jsxs)("div",{style:D.pagePropertiesOverflow,children:[(0,Z.jsx)(R.Z,{showHiddenProperties:!0,schema:B,mergedProperties:t,format:e.format,store:e.store,collectionStore:e.collectionStore,disabled:e.disabled,locked:e.locked,blockPropertyValueOverlayStore:e.blockPropertyValueOverlayStore,isInPeekRenderer:e.isInPeekRenderer,hideDragHandle:f}),o&&(0,Z.jsx)(j.le,{collectionStore:h,isInPeekRenderer:m})]})}),renderOrigin:e=>(0,Z.jsx)("div",{style:D.overflowButtonWrapper,children:(0,Z.jsx)(w.ZP,{renderTooltip:()=>(0,Z.jsx)(d.FormattedMessage,{defaultMessage:"{num, plural, one {1 more property} other {{num} more properties}}",id:"database.pageProperties.compact.showMoreTooltip",values:{num:t.length}}),placement:w.ug.Bottom,render:t=>(0,Z.jsx)(C.Z,{style:D.overflowButton,mobileFeedback:I.isMobile,...(0,u.Z)(e,t),children:(0,a.o)(D.overflowIcon)})})})}):o?(0,Z.jsx)("div",{style:D.overflowButtonWrapper,children:(0,Z.jsx)(w.ZP,{renderTooltip:()=>(0,Z.jsx)(d.FormattedMessage,{defaultMessage:"Add a property",id:"database.pageProperties.compact.addPropertyButtonTitle"}),placement:w.ug.Bottom,render:t=>(0,Z.jsx)(b.ZP,{popupType:T.device.isMobile?x.kQ.SlideUp:x.kQ.Popup,onClose:e.onClose,buttonPopupStore:y,originGap:1,alignmentToOrigin:b.vR.Start,render:()=>(0,Z.jsx)(S.P,{context:g.HV.TopbarFilterPopup,collectionContextStore:v,collectionSettingsStore:v.settingsStore,hideDesktopHeader:!0}),onClick:L,onDismiss:()=>{const e=v.settingsStore;c.E3({collectionSettingsStore:e})},renderOrigin:e=>(0,Z.jsx)(C.Z,{style:D.overflowButton,mobileFeedback:I.isMobile,...(0,u.Z)(e,t),children:(0,l.R)(D.overflowIcon)})})})}):null}))},65091:(e,t,o)=>{o.d(t,{ZP:()=>P,le:()=>x});o(57658);var i=o(67294),r=o(480),n=o(86628),s=o(24405),a=o(72787),l=o(47453),d=o(9291),p=o(16956),c=o(5149),h=o(66890),g=o(68641),u=o(61766),m=o(85526),y=o(51774),v=o(64921),S=o(31945),f=o(53437),C=o(87167),b=o(85893);function P(e){window.__c={n:"PagePropertyActions"};const{locked:t,disabled:o,collectionStore:i,mergedProperties:r,schema:s,isCompact:a}=e,l=(0,n.VK)((()=>m.Z.state.forceShowProperties),[]),d=R(r,s,a),p=(0,C.v)(i),c=[];return(l||0===d)&&(!t&&!o&&p)&&c.push((0,b.jsx)(x,{...e},"add-property")),d>0&&(l?c.push((0,b.jsx)(M,{mergedProperties:r,schema:s,isCompact:a},"hide-properties")):c.push((0,b.jsx)(w,{mergedProperties:r,schema:s,isCompact:a},"show-more"))),(0,b.jsx)(b.Fragment,{children:c})}function x(e){window.__c={n:"AddPropertyButton"};const{collectionStore:t,isInPeekRenderer:o}=e,s=(0,h.Y$)(),a=(0,r.O7)(),m=(0,n.qz)(void 0,u.Z),C=k(),P=(0,n.VK)((()=>s.settingsStore.state.open),[s.settingsStore]);(0,i.useEffect)((()=>{P||m.setState({...m.state,open:!1})}),[m,P]);const x=(0,i.useCallback)((()=>{p.fH({environment:a,collectionContextStore:s,collectionStore:t,isInPeekRenderer:o,onCloseMenu:()=>{m.setState({open:!1})}})}),[m,s,t,a,o]);return(0,b.jsx)("div",{style:{display:"flex"},children:(0,b.jsx)(S.ZP,{popupType:a.device.isMobile?f.kQ.SlideUp:f.kQ.Popup,buttonPopupStore:m,originGap:1,alignmentToOrigin:S.vR.Start,render:()=>(0,b.jsx)(y.P,{context:g.HV.TopbarFilterPopup,collectionContextStore:s,collectionSettingsStore:s.settingsStore,hideDesktopHeader:!0}),onClick:x,onClose:()=>{const e=s.settingsStore;c.E3({collectionSettingsStore:e})},renderOrigin:t=>(0,b.jsxs)(v.Z,{style:{...C.AddOrTogglePropertyButtonStyle,...e.style},...t,children:[(0,l.R)(C.ActionPropertyButtonIconStyle),(0,b.jsx)("div",{style:C.AddPropertyButtonTitleStyle,children:(0,b.jsx)(d.FormattedMessage,{defaultMessage:"Add a property",id:"database.pageProperties.addPropertyButtonTitle"})})]})})})}function w(e){window.__c={n:"ShowMoreButton"};const{mergedProperties:t,schema:o,isCompact:r}=e,n=k(),s=R(t,o,r),l=(0,i.useCallback)((()=>{m.Z.setState({...m.Z.state,forceShowProperties:!0})}),[]);return(0,b.jsx)("div",{style:{display:"flex"},children:(0,b.jsxs)(v.Z,{style:{...n.AddOrTogglePropertyButtonStyle,...e.style},onClick:l,children:[(0,a.Y)(n.ActionPropertyButtonIconStyle),(0,b.jsx)("div",{style:n.AddPropertyButtonTitleStyle,children:(0,b.jsx)(d.FormattedMessage,{defaultMessage:"{num, plural, one {1 more property} other {{num} more properties}}",id:"database.pageProperties.showMorePropertyTitle",values:{num:s}})})]},"show-more")})}function M(e){window.__c={n:"HidePropertiesButton"};const{mergedProperties:t,schema:o,isCompact:r}=e,n=R(t,o,r),s=k(e.style),l=(0,i.useCallback)((()=>{m.Z.setState({...m.Z.state,forceShowProperties:!1})}),[]);return(0,b.jsx)("div",{style:{display:"flex"},children:(0,b.jsxs)(v.Z,{style:{...s.AddOrTogglePropertyButtonStyle,...e.style},onClick:l,children:[(0,a.Y)({...s.ActionPropertyButtonIconStyle,transform:"rotate(180deg)"}),(0,b.jsx)("div",{style:s.AddPropertyButtonTitleStyle,children:(0,b.jsx)(d.FormattedMessage,{defaultMessage:"{num, plural, one {Hide 1 property} other {Hide {num} properties}}",id:"database.pageProperties.hidePropertyTitle",values:{num:n}})})]},"hide-properties")})}function k(e){const t=(0,r.O7)();return(0,s.yK)((o=>{const{device:i}=t;return{AddOrTogglePropertyButtonStyle:{display:"flex",alignItems:"center",color:o.lightTextColor,borderRadius:4,paddingLeft:6,paddingRight:6,height:34,width:i.isMobile?"100%":"auto",...e},ActionPropertyButtonIconStyle:{width:16,height:16,marginRight:9,marginTop:1,fill:o.lightIconColor},AddPropertyButtonTitleStyle:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",minWidth:0,lineHeight:"16px"}}}),[t,e])}function R(e,t,o){return(0,i.useMemo)((()=>e.filter((e=>"hide"===e.visibility||"hide_if_empty"===e.visibility&&!e.hasValue)).length),[e])}},87167:(e,t,o)=>{o.d(t,{v:()=>n});var i=o(86628),r=o(78316);function n(e){return(0,i.VK)((()=>r.eD({collectionStore:e,collectionViewBlockStore:e.getParentBlockStore(),checkNavigableAncestorLocked:!1})),[e])}},14542:(e,t,o)=>{o.d(t,{EP:()=>s,LU:()=>a,NS:()=>n,SS:()=>r,ZP:()=>d});var i=o(49085);const r="loadingLocalImage",n="uploading",s="downloading",a="loaded";class l extends i.default{getInitialState(){return{loadingMode:a}}}const d=l},96809:(e,t,o)=>{o.d(t,{Z:()=>i});const i=new(o(14542).ZP)},72787:(e,t,o)=>{o.d(t,{Y:()=>n});o(67294);var i=o(45238),r=o(85893);const n=(0,i.I)("chevronDownThin",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8.004 12a.72.72 0 00.54-.237l6.238-6.487A.735.735 0 0015 4.753c0-.426-.314-.753-.733-.753a.76.76 0 00-.524.213l-5.739 5.955-5.747-5.955A.73.73 0 001.733 4C1.314 4 1 4.327 1 4.753c0 .204.08.384.218.531l6.238 6.479a.751.751 0 00.548.237z"})})},82356:(e,t,o)=>{o.d(t,{l:()=>n});o(67294);var i=o(45238),r=o(85893);const n=(0,i.I)("import",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M13.291 14.5723C13.291 14.1484 12.9902 13.834 12.5732 13.834H8.06836C8.24609 13.8203 8.42383 13.7314 8.56055 13.5947L13.0586 9.08301C13.2158 8.91895 13.291 8.74121 13.291 8.54297C13.291 8.12598 12.9902 7.81836 12.5801 7.81836C12.3682 7.81836 12.1836 7.90039 12.0469 8.03711L10.4951 9.56836L8.69043 11.585L8.75195 10.1084V1.61133C8.75195 1.16016 8.44434 0.852539 8 0.852539C7.5625 0.852539 7.25488 1.16016 7.25488 1.61133V10.1084L7.30957 11.5781L5.50488 9.56836L3.95312 8.03711C3.82324 7.90039 3.63184 7.81836 3.42676 7.81836C3.0166 7.81836 2.70898 8.12598 2.70898 8.54297C2.70898 8.74121 2.78418 8.91895 2.94141 9.08301L7.44629 13.5947C7.58301 13.7314 7.75391 13.8203 7.93848 13.834H3.44043C3.0166 13.834 2.70898 14.1484 2.70898 14.5723C2.70898 14.9893 3.0166 15.3037 3.44043 15.3037H12.5732C12.9902 15.3037 13.291 14.9893 13.291 14.5723Z"})})},27714:(e,t,o)=>{o.d(t,{N:()=>n});o(67294);var i=o(45238),r=o(85893);const n=(0,i.I)("link",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.69922 10.8945L8.73828 9.84863C7.91797 9.77344 7.34375 9.51367 6.91992 9.08984C5.76465 7.93457 5.76465 6.29395 6.91309 5.14551L9.18262 2.87598C10.3379 1.7207 11.9717 1.7207 13.127 2.87598C14.2891 4.04492 14.2822 5.67188 13.1338 6.82031L11.958 7.99609C12.1768 8.49512 12.2451 9.10352 12.1289 9.62988L14.0908 7.6748C15.7725 6 15.7793 3.62109 14.084 1.92578C12.3887 0.223633 10.0098 0.237305 8.33496 1.91211L5.95605 4.29785C4.28125 5.97266 4.26758 8.35156 5.96289 10.0469C6.36621 10.4434 6.90625 10.7441 7.69922 10.8945ZM8.30078 5.13184L7.26855 6.17773C8.08203 6.25293 8.66309 6.51953 9.08008 6.93652C10.2422 8.09863 10.2422 9.73242 9.08691 10.8809L6.81738 13.1504C5.66211 14.3057 4.03516 14.3057 2.87305 13.1504C1.71094 11.9883 1.71777 10.3545 2.87305 9.20605L4.04199 8.03027C3.83008 7.53125 3.75488 6.92969 3.87109 6.39648L1.91602 8.35156C0.234375 10.0264 0.227539 12.4121 1.92285 14.1074C3.61816 15.8027 5.99707 15.7891 7.67188 14.1143L10.0439 11.7354C11.7256 10.0537 11.7324 7.6748 10.0371 5.98633C9.64062 5.58301 9.10059 5.28223 8.30078 5.13184Z"})})}}]);