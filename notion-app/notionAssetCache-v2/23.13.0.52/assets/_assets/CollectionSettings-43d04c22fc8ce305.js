"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4544],{26797:(e,t,o)=>{o.d(t,{Fv:()=>T,JN:()=>b,QG:()=>P,cQ:()=>M,f$:()=>w,fX:()=>_,td:()=>j,xD:()=>k});o(57658);var n=o(30120),i=o(80951),r=o(40506),s=o(53877),a=o(42875),l=o(72126),c=o(6287),d=o(97880),p=o(78316),u=o(95802),g=o(15723),m=o(17746),S=o(26136),f=o(8406),y=o(49865),h=o(75134),x=o(42239),v=o(19785),C=o(9953);function b(e){const{environment:t,droppedStores:o,duplicate:l,calendarBy:d,transaction:u,collectionContextStore:g}=e,m=n.ou.fromMillis(e.startOfDay);let S=!0;for(const n of o){const t=e.collectionStore?e.collectionStore:(0,p.Bm)({store:n,collectionContextStore:g});if(n.getParentTable()===c.v||!t){S=!1;break}v.zw({childStore:n,parentStore:t,transaction:u})||(S=!1)}const h=x.LQ({environment:t,droppedStores:o,duplicate:l,duplicateUseCrdt:!1,transaction:u,resolveTemplateVariables:!1});for(const n of h){const o=e.collectionStore?e.collectionStore:(0,p.Bm)({store:n,collectionContextStore:g}),l=n.getPropertyStore(d),c=i.Gl(l.getValue())||s.Lg((0,a.r)()),h=s.c$(c,(0,a.r)()),x=m.toFormat(s.Iq);let v;if("date"===h.type||"datetime"===h.type)v={...h,start_date:x};else{const e=s.NK(h,(0,a.r)());if(!e.end)return;const t={...h,start_date:x},o=s.NK(t,(0,a.r)()).start.diff(e.start,"days"),n=e.end.plus(o).toFormat(s.Iq);v={...h,start_date:x,end_date:n}}const C=s.c$(v,r.yw(c)||(0,a.r)());o&&y.mp({environment:t,store:n,collectionStore:o,collectionContextStore:g,shouldCoerce:!0,groupsPointer:[],transaction:u,alreadyMovedToCollection:S}),k({environment:t,type:"dateValue",propertyId:d,store:n,transaction:u,dateValue:C}),f.rv({environment:t,collectionContextStore:g,block_id:n.id,property:d,property_type:"date",from:"calendar"})}}function w(e){const{calendarStore:t,direction:o,target:n}=e;t.setState({...t.state,isDragging:!0,target:n,direction:o})}function j(e){const{calendarStore:t,x:o,y:c,calendarBy:d}=e,p=t.state;if(p.isDragging){const e=i.Gl(p.target.getPropertyStore(d).getValue());if(!e)return;const S=s.c$(e,(0,a.r)()),f=p.temporaryValue||e,y=s.c$(f,(0,a.r)()),h=[];p.dayStoreMap.forEach(((e,t)=>{h.push({store:e,timestamp:t})}));const x=h.find((e=>{let{store:t}=e;const n=u.C.getRectFromStore(t);return Boolean(n&&g.uh(n,o,c))}));let v;if(x){const e=n.ou.fromMillis(x.timestamp),t=e.endOf("day"),o=e.toFormat(s.Iq);if(S){const i=s.NK(S,(0,a.r)());if(p.direction===m.t.Left)if(n.Xp.fromDateTimes(e,t).contains(i.start))v=S;else{let e;e="datetimerange"===S.type||"daterange"===S.type?{...S,start_date:o,end_date:S.end_date}:"datetime"===S.type?{type:"datetimerange",start_date:o,start_time:S.start_time,end_date:S.start_date,end_time:S.start_time,time_zone:S.time_zone,reminder:S.reminder}:{type:"daterange",start_date:o,end_date:S.start_date,reminder:S.reminder};const t=s.NK(e,(0,a.r)());v=!i.end&&t.start>i.start||i.end&&t.start>i.end?y:e}else if(i.end?n.Xp.fromDateTimes(e,t).contains(i.end):n.Xp.fromDateTimes(e,t).contains(i.start))v=S;else{let e;e="date"===S.type?{...S,type:"daterange",end_date:o}:"datetime"===S.type?{...S,type:"datetimerange",end_date:o,end_time:"00:00"}:{...S,end_date:o};const t=s.NK(e,(0,a.r)());v=t.end&&t.end<t.start?y:e}}}if(v&&!l.Xy(y,v)){const e=s.c$(v,r.yw(f)||(0,a.r)());t.setState({...p,temporaryValue:e})}}}function _(e){const{environment:t,calendarStore:o,calendarBy:n,transaction:i}=e,r=o.state;r.isDragging&&r.temporaryValue&&(k({type:"dateValue",environment:t,dateValue:r.temporaryValue,propertyId:n,store:r.target,transaction:i}),o.setState({...o.state,isDragging:!1}))}function M(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function T(e){const{environment:t,store:o,collectionStore:r,collectionContextStore:l,startDayOfWeek:c,transaction:d}=e,p=l.dateRangeStart.state,u=(0,a.r)(),g=l.normalizedQueryStore.state;if(!g||!g.calendar_by)return;const m=g.calendar_by,S=s.gQ(p,c,u),f=S.startOf("month"),h=S.endOf("month"),x=n.ou.now().startOf("day");let v;return v=n.Xp.fromDateTimes(f,h).contains(x)?s.hT(x.valueOf(),u):s.hT(s.em(p,c,u).valueOf(),u),C.sW({store:o.getPropertiesStore(),data:{[m]:i.d7(v)},transaction:d}),y.mp({environment:t,store:o,collectionStore:r,collectionContextStore:l,shouldCoerce:!0,groupsPointer:[],transaction:d}),o}function k(e){const{environment:t,store:o,propertyId:n,transaction:r}=e;let l;"timestamp"===e.type?l=s.hT(e.timestampMs.valueOf(),(0,a.r)()):"dateValue"===e.type?l=e.dateValue:(0,d.t1)(e);const c=o.getPropertyValue(n),p=i.d7(l);C.sW({store:o.getPropertiesStore(),data:{[n]:p},transaction:r}),h.H({environment:t,store:o,dateProperty:{id:n,oldValue:c,newValue:p}})}function P(e){const{environment:t,collectionStore:o,calendarBy:n,store:i,insertStores:r,collectionContextStore:s,transaction:a}=e,l=i.getPropertyStore(n).getValue();for(const c of r)y.mp({environment:t,store:c,collectionStore:o,collectionContextStore:s,shouldCoerce:!0,groupsPointer:[],transaction:a}),C.sO({store:c.getPropertyStore(n),value:l,transaction:a});return r.map((e=>S.G.createChildStore(o,e.pointer)))}},58188:(e,t,o)=>{o.d(t,{Lg:()=>p,N:()=>d,aG:()=>c});var n=o(13493),i=o(29369),r=o(82530),s=(o(77907),o(30806)),a=o(80444),l=o(14900);o(72711);function c(e){const{environment:t,currentSpaceViewStore:o,...n}=e,i=o.getModel();if(!i)return;const a=!i.showFeatureOnPersonalHome(e.feature);r.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{r.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:a}},transaction:t})}}),(0,s.cY)({environment:t,show:a,...n})}function d(e){let{environment:t,option:o,from:n,userAction:i}=e;const l=a.default.state.currentSpaceViewStore;if(!l)return!1;const c=l.getOnAppStartStore().getValue();return r.createAndCommit({userAction:i,environment:t,perform:e=>{r.applyOperation({store:l,operation:{pointer:l.pointer,path:["settings","on_app_start"],command:"set",args:o},transaction:e})}}),(0,s.BX)({environment:t,oldValue:c,newValue:o,from:n}),!0}function p(e){const{environment:t,selectedStore:o,currentSpaceViewStore:a,collectionContextStore:c}=e,d=c.collectionViewStore(),p=c.collectionStore(),u=c.collectionViewBlockStore();if(!(p&&d&&u&&a))return;const g=a.getTeamsStores(),m=o.table===i.e0?g.indexOf(o)+1:0,S=o.table===i.e0?o.id:void 0;r.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{r.applyOperation({store:d,operation:{pointer:{id:d.id,table:n.n},path:["format","collection_view_source","teamId"],command:"set",args:S},transaction:e}),l.mc({environment:t,collectionViewBlockStore:u,collectionViewStore:d,collectionStore:p,collectionContextStore:c,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}}),(0,s.Ay)({environment:t,teamId:S,index:m})}},36821:(e,t,o)=>{o.d(t,{KV:()=>K,U6:()=>N,Wu:()=>z,Xx:()=>Z,YD:()=>U,g9:()=>O,jc:()=>R,m8:()=>L,ys:()=>W});var n=o(30120),i=o(15145),r=o(92996),s=o(99036),a=o(40506),l=o(53877),c=o(4615),d=o(81491),p=o(98963),u=o(18844),g=o(21202),m=o(15047),S=o(29369),f=o(39927),y=o(70203),h=o(16732),x=o(40663),v=o(33929),C=o(77907),b=o(80444),w=o(77080),j=o(26136),_=o(54642),M=o(26797),T=o(16956),k=o(5149),P=o(14900),V=o(96802),F=o(9953),A=o(21862),B=o(82530),I=o(39865);function Z(e){var t;const{environment:o,transaction:n,tasksBlockStore:i,sprintsBlockStore:r}=e;if(!w.default.checkGate("recurring_sprints"))return;const s=null===(t=r.getFormat())||void 0===t?void 0:t.collection_pointer,a=i.getFormat().collection_pointer;s&&a&&D({environment:o,transaction:n,sprintCollectionStore:j.NW.createChildStore(r,s),taskCollectionStore:j.NW.createChildStore(i,a),sprintSettingsConfig:f.i})}function D(e){const{environment:t,sprintSettingsConfig:o,transaction:n,sprintCollectionStore:i,taskCollectionStore:r}=e,s=i.getSpaceId(),a=(0,c.ZP)(),l=(0,c.ZP)();F.ae({environment:t,table:p.cv,inMemoryRecordCache:i.inMemoryRecordCache,value:{id:a,parent_id:i.id,parent_table:i.table,alive:!0,space_id:s,status:o.autoCompleteSprints?"active":"disabled",trigger:{id:(0,c.ZP)(),type:"recurrence",recurrence:$(o)},action_ids:[l]},transaction:n}),V.FH({stores:[i],update:{automation_ids:[...i.getFormat().automation_ids??[],a]},transaction:n}),F.ae({environment:t,table:u.Xj,inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,value:{id:l,parent_id:a,parent_table:p.cv,type:"complete_sprint",alive:!0,space_id:s,config:{sprint_collection:i.getSpaceShardedPointer(),task_collection:r.getSpaceShardedPointer(),complete_sprint_action:o.actionConfig.complete_sprint_action}}})}function K(e){const{environment:t,automationStore:o,transaction:n,newDuration:i,currentSprintBlockStore:r}=e;F.sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{interval:i},transaction:n}),E({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function O(e){const{environment:t,automationStore:o,transaction:n,newWeekday:i,currentSprintBlockStore:r}=e;F.sW({store:o.getTriggerStore().getKeyStore("recurrence"),data:{weekdays:[i]},transaction:n}),E({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function R(e){const{environment:t,automationStore:o,transaction:n,newAutocompleteStatus:i,currentSprintBlockStore:r}=e;F.sW({store:o,data:{status:i?"active":"disabled"},transaction:n}),E({environment:t,transaction:n,automationStore:o,currentSprintBlockStore:r})}function E(e){const{automationStore:t,currentSprintBlockStore:o,transaction:n,environment:i}=e;if("active"!==t.getStatus())return;const s=t.getRecurrence();if(!s)return;const{originalStartDate:l,newEndDate:c,newStartDate:d}=G({recurrence:s,currentSprintBlockStore:o});c&&l&&d&&(F.sW({store:t.getTriggerStore().getKeyStore("recurrence"),data:{start_date:(0,a.Io)(d.plus({minutes:1}).toJSDate())},transaction:n}),M.xD({store:o,propertyId:r.b0.Dates,transaction:n,environment:i,type:"dateValue",dateValue:{type:"daterange",start_date:l.toISODate(),end_date:c.toISODate()}}))}function G(e){var t;const{recurrence:o,currentSprintBlockStore:i}=e,s=null===(t=o.weekdays)||void 0===t?void 0:t[0],a=o.interval;if(!s)return{originalStartDate:void 0,newStartDate:void 0,newEndDate:void 0};const l=i.getPropertyValue(r.b0.Dates);if(!l)return{originalStartDate:void 0,newStartDate:void 0,newEndDate:void 0};const c=(0,y.nai)(l)[0];if(!c||"daterange"!==c.type)return{originalStartDate:void 0,newStartDate:void 0,newEndDate:void 0};const p=n.ou.fromISO(c.start_date);let u=p;const g=d.WEEKDAY_STR_TO_WEEKDAY_NUMBER_MAP[s];for(;u.weekday%7!==g;)u=u.plus({days:1});let m=u.plus({weeks:a});for(;m.diffNow("days").days<1;)m=m.plus({weeks:1});return{originalStartDate:p,newStartDate:m.minus({weeks:a}),newEndDate:m.minus({days:1})}}function N(e){const{transaction:t,newRemainingTasksBehavior:o,actionStore:n}=e;F.sW({store:n.getConfigStore(),data:{complete_sprint_action:o},transaction:t})}async function W(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:n,appConfigs:i}=await C.deps.AppTemplates.loader(),{environment:r,collectionContextStore:s}=e,{currentSpaceViewStore:a}=b.default.state,l=s.collectionStore(),c=null==l?void 0:l.getParentBlockStore(),d=null==c?void 0:c.getParentStore(),p=null==l||null===(t=l.getFormat())||void 0===t?void 0:t.app_config_uri,u=p&&(0,x.YB)(i(),p);if(!l||!c||!d||!a||d.table!==m.bx&&d.table!==g.iU&&d.table!==S.e0||!u)return;const f=c.getFormat().app_id,y=f?await _.getCollectionViewBlocksByAppId(r,{spaceId:c.getSpaceId(),appId:f}):void 0,v="success"===(null==y?void 0:y.type)&&y.data.result.length?y.data.result.map((e=>j.G.createChildStore(d,{table:g.iU,id:e.blockId,spaceId:c.getSpaceId()}))):[c];await H({environment:r,taskCollectionStore:l,executeFn:()=>{B.createAndCommit({userAction:"sprintSettingsActions.handleTurnOnSprints",environment:r,perform:e=>{const t=o.applyFeatures({environment:r,spaceViewStore:a,appParentStore:d,appUri:u.uri,features:[{type:"simple",featureUri:(0,h.eu)().uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:v});n.createSprintPage({environment:r,spaceViewStore:a,appParentStore:d,transaction:e,blockStores:t,creationEntryPoint:{type:"sprint_settings"}}),k.E3({collectionSettingsStore:s.settingsStore})}})}})}async function L(e){const{environment:t,collectionContextStore:o,sprintSettingsContext:n,sprintBoardViewBlockIds:r}=e,{sprintCollectionStore:s,automationContext:a,currentCollectionViewBlockStore:l,sprintCollectionViewBlockStore:c,taskCollectionStore:d,taskCollectionViewBlockStore:p}=n;if(!s||!c||!a)return;const u=p.getSpaceId(),m=[c,...r.map((e=>new j.G(t,{id:e,table:g.iU,spaceId:u})))];l.id===p.id?k.E3({collectionSettingsStore:o.settingsStore}):A.r({environment:t,store:p,pageVisitSource:i.tY.LeaveOrRemove}),await H({environment:t,taskCollectionStore:d,executeFn:()=>{B.createAndCommit({userAction:"sprintSettingsActions.handleTurnOffSprints",environment:t,perform:e=>{!function(e){const{transaction:t,automationStore:o,blocksToDelete:n,environment:i,sprintCollectionStore:r}=e;F.sW({store:r,transaction:t,data:{alive:!1}}),F.sW({store:o,transaction:t,data:{alive:!1}}),I.y8({environment:i,blocks:n,transaction:t,permanentlyDelete:!0})}({environment:t,transaction:e,automationStore:a.automationStore,blocksToDelete:m,sprintCollectionStore:s})}})}})}function U(e){const{environment:t,collectionContextStore:o}=e,n=o.collectionViewStore();if(!n)return;const i=n.getFormat(),s=n.getRawQuery();B.createAndCommit({userAction:"sprintSettingsActions.handleManageSprintFromThisView",environment:t,perform:e=>{P.iG({collectionViewStore:n,transaction:e,update:{name:v.default.formatMessage(h.sY.tasksCurrentSprintV2ViewName),query2:{...s,filter:void 0},format:{...i,collection_view_icon:"/icons/playback-play-button_gray.svg",property_filters:[h.Ws],app_config_uri:r.g3,hide_linked_collection_name:!0}}})}})}function z(e){const{environment:t,sprintSettingsContext:o}=e;if(!w.default.checkGate("recurring_sprints")||!o)return;const n=o.sprintCollectionStore;n&&!o.automationContext&&B.createAndCommit({userAction:"sprintSettingsActions.ensureCompleteSprintAutomation",environment:t,perform:e=>{D({environment:t,transaction:e,sprintCollectionStore:n,taskCollectionStore:o.taskCollectionStore,sprintSettingsConfig:f.i})}})}async function H(e){const{executeFn:t,environment:o,taskCollectionStore:n}=e;await async function(e){var t;const{environment:o,taskCollectionStore:n}=e,i=n.getFormat().app_uri_map,a=r.Es.TaskToSprintRelation,l=n.getSchema(),c=(null==i?void 0:i[a])??a,d=l[c];if(!d||!(0,s.p_)(d))return;const p=null===(t=(0,s.j0)(d))||void 0===t?void 0:t.id;if(!p)return;const u=new Set([c]);Object.entries(l).forEach((e=>{var t;let[o,n]=e;n&&(0,s.p_)(n)&&(null===(t=(0,s.j0)(n))||void 0===t?void 0:t.id)===p&&u.add(o)}));const{serverCommitResult:g}=B.createAndCommit({userAction:"sprintSettingsActions.clearSprintRelationDataFromTaskCollection",environment:o,perform:e=>{for(const t of u)T.E2({environment:o,transaction:e,permanentlyDelete:!0,collectionStore:n,schema:l,property:t});null==i||delete i[a],i&&V.FH({stores:[n],transaction:e,update:{app_uri_map:i}})}});await g}({environment:o,taskCollectionStore:n}),t()}function $(e){return{frequency:"week",interval:e.recurrenceConfig.interval,weekdays:e.recurrenceConfig.weekdays,start_date:n.ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,l.Sv)(),hour:0,minute:0}}},43169:(e,t,o)=>{o.r(t),o.d(t,{default:()=>ud});var n=o(67294),i=o(83355),r=o(480),s=o(86628),a=o(4615),l=o(9291),c=o(50906),d=o(5149),p=o(96802),u=o(82530),g=(o(57658),o(43261)),m=o.n(g),S=o(24405),f=o(66897),y=o(63362),h=o(3865),x=o(28751),v=o(23290),C=o(76205),b=o(99036),w=o(80951),j=o(84619),_=o(76218),M=o(88607),T=o(91856),k=o(65422),P=o(84169),V=o(20669),F=o(25651),A=o(47453),B=o(24600),I=o(42283),Z=o(63030),D=o(69196),K=o(53016),O=o(48524),R=o(43393),E=o(32426),G=o(71500),N=o(73201),W=o(72050),L=o(55159),U=o(26774),z=o(34093),H=o(92607),$=o(32623),q=o(53866),Y=o(3729),Q=o(108),X=o(83303),J=o(56505),ee=o(8938),te=o(94308),oe=o(606),ne=o(97880),ie=o(82990),re=o(29804),se=o(67174),ae=o(29723),le=o(23704),ce=o(93377),de=o(82207),pe=o(84799),ue=o(99144),ge=o(4328),me=o(73427),Se=o(93060),fe=o(20239),ye=o(76954),he=o(87181),xe=o(56812),ve=o(91494),Ce=o(13005),be=o(42917),we=o(68894),je=o(16354),_e=o(72495),Me=o(62385),Te=o(26388),ke=o(52821),Pe=o(54802),Ve=o(67669),Fe=o(37034),Ae=o(63474),Be=o(80444),Ie=o(77080),Ze=o(26136),De=o(58812),Ke=o(6740),Oe=o(37989),Re=o(33907),Ee=o(54497),Ge=o(77744),Ne=o(12589),We=o(44736),Le=o(56666),Ue=o(88437),ze=o(37612),He=o(52275),$e=o(31945),qe=o(73063),Ye=o(78140),Qe=o(32163),Xe=o(61766),Je=o(95193),et=o(35294),tt=o(85893);const ot=(0,l.defineMessages)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuPauseTitle:{defaultMessage:"Pause",id:"automations.AutomationSummaryCard.MoreActionsMenu.Pause.title"},automationSummaryCardMoreMenuResumeTitle:{defaultMessage:"Resume",id:"automations.AutomationSummaryCard.MoreActionsMenu.Resume.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"}});function nt(e){window.__c={n:"AutomationSummaryMoreActionsButton"};const{focused:t,style:o,onEdit:i,onDelete:r,onDuplicate:a,onDisable:c,onEnable:d}=e,p=(0,l.useIntl)(),u=(0,s.qz)(void 0,Xe.Z),g=(0,et.d)();(0,n.useEffect)((()=>{t||u.setState({open:!1})}),[t,u]);const m=(0,S.yK)((e=>({iconButton:{border:`1px solid ${e.regularDividerColor}`,height:26,width:26,...o},iconButtonIcon:{width:16}})),[o]);return(0,tt.jsx)(tt.Fragment,{children:(0,tt.jsx)($e.ZP,{stopClickPropagation:!0,popupType:g,alignmentToOrigin:$e.vR.Center,placementToOrigin:$e.pO.Bottom,originGap:0,renderOrigin:e=>(0,tt.jsx)(qe.Z,{ariaLabel:p.formatMessage(ot.automationSummaryCardMoreButtonAriaLabel),icon:Le.o,iconStyle:m.iconButtonIcon,style:m.iconButton,hasBackground:!0,...e}),render:e=>(0,tt.jsx)(it,{onClose:()=>e.close(),onEdit:i,onDelete:r,onDuplicate:a,onDisable:c,onEnable:d}),buttonPopupStore:u})})}function it(e){window.__c={n:"MoreActionsMenu"};const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:r,onEnable:s}=e,a=(0,l.useIntl)(),c=(0,Je.F)(),d=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,tt.jsx)(He.Z,{...e,icon:(0,F.R)({height:16,width:16}),title:a.formatMessage(ot.automationSummaryCardMoreMenuEditTitle)})}:void 0,p=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,tt.jsx)(He.Z,{...e,icon:(0,Ue.a)({height:16,width:16}),title:a.formatMessage(ot.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,u=r?{action:()=>{t(),r()},key:"disable",render:e=>(0,tt.jsx)(He.Z,{...e,icon:(0,We.g)({height:16,width:16}),title:a.formatMessage(ot.automationSummaryCardMoreMenuPauseTitle)})}:void 0,g=s?{action:()=>{t(),s()},key:"enable",render:e=>(0,tt.jsx)(He.Z,{...e,icon:(0,Ne.M)({height:16,width:16}),title:a.formatMessage(ot.automationSummaryCardMoreMenuResumeTitle)})}:void 0,m=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,tt.jsx)(He.Z,{...e,icon:(0,ze.y)({height:16,width:16}),title:a.formatMessage(ot.automationSummaryCardMoreMenuDeleteTitle)})}:void 0;return(0,tt.jsx)(Ye.Z,{...c,children:(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,sections:[{items:[d,p,u,g,m].filter(ne.$K),key:"items",render:e=>(0,tt.jsx)(_e.Z,{enableActionSheetTitle:!0,topBorder:!0,...e})}],initialFocus:0})})}var rt=o(64921),st=o(92864),at=o(75024);function lt(e){window.__c={n:"AutomationSummaryCard"};const{actions:t,caption:o,focused:i,hasWarning:s,maxIcons:a,onBlur:l,onClick:c,onDelete:d,onDisable:p,onDuplicate:u,onEdit:g,onEnable:m,onFocus:f,onMouseDown:y,onMouseEnter:h,onMouseLeave:x,title:v,triggers:C}=e,{isMobile:b}=(0,r.Fy)(),w=(0,n.useRef)(null),[j,_]=(0,Ke.Z)(),[M,T]=(0,Oe.Z)(),[k,P]=(0,n.useState)(!1),V=b||k||_||T,F=(0,S.yK)((e=>({wrap:{background:e.cardContentBackground,border:`1px solid ${e.regularDividerColor}`,borderRadius:8,display:"flex",flexDirection:"column",gap:15,padding:15,position:"relative"},moreButtonWrap:{display:V?"block":"none",position:"absolute",right:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:5,listStyle:"none",margin:"0 30px 0 0",padding:0},body:{display:"flex",flexDirection:"column",gap:b?4:2},titleWrap:{...s?{alignItems:"center",display:"inline-flex",gap:4}:(0,at.pd)(2),fontSize:b?16:14,fontWeight:ie.Z.fontWeight.medium,lineHeight:"130%"},title:{...s?ie.Z.textOverflowStyle:{}},warning:{color:e.accentColors.orange[400],height:"auto",width:b?16:14},caption:{...(0,at.pd)(2),color:e.lightTextColor,fontSize:b?14:12,fontWeight:ie.Z.fontWeight.regular,lineHeight:"130%",margin:0}})),[s,V,b]),A=(0,n.useCallback)((e=>{P(!0),h&&h(e)}),[h]),B=(0,n.useCallback)((e=>{P(!1),x&&x(e)}),[x]);(0,n.useEffect)((()=>{i&&null!==w.current&&w.current.focus()}),[i]);const I=(0,Ge.lq)(w,j,M),Z=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,r=t.length,s=i>0&&r>0,a=Math.max(o,3),l=s?a-1:a;let c=Math.max(Math.floor(l/2),1),d=Math.max(Math.ceil(l/2),1);if(i<c&&r>d){d+=c-i,c=i}else if(r<d&&i>c){c+=d-r,d=r}const p=[];if(i>0)if(i>c)if(1===c)p.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);p.push(...n.slice(0,c-1)),p.push({color:"gray",type:"truncate",value:e})}else p.push(...n);s&&p.push({type:"arrow"});if(r>0)if(r>d)if(1===d)p.push({color:"gray",type:"truncate",value:r});else{const e=r-(d-1);p.push(...t.slice(0,d-1)),p.push({color:"gray",type:"truncate",value:e})}else p.push(...t);return p}({actionIcons:t,maxIcons:St(a),triggerIcons:C}),D=Boolean(d||p||m||u||g);return(0,tt.jsxs)(rt.Z,{onBlur:l,onClick:c,onFocus:f,onMouseDown:y,onMouseEnter:A,onMouseLeave:B,ref:I,style:F.wrap,children:[(0,tt.jsxs)("header",{children:[D&&(0,tt.jsx)("div",{style:F.moreButtonWrap,children:(0,tt.jsx)(nt,{focused:V,onDelete:d,onDisable:p,onEnable:m,onDuplicate:u,onEdit:g})}),(0,tt.jsx)("ul",{"aria-hidden":"true",style:F.iconList,children:Z.map(((e,t)=>(0,tt.jsx)("li",{children:(0,tt.jsx)(ct,{icon:e})},t)))})]}),(0,tt.jsxs)("div",{style:F.body,children:[(0,tt.jsxs)("div",{style:F.titleWrap,children:[(0,tt.jsx)("span",{style:F.title,children:v}),s&&(0,Ee.t)(F.warning)]}),o&&(0,tt.jsx)("p",{style:F.caption,children:o})]})]})}function ct(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,tt.jsx)(dt,{color:t.color,icon:t.icon}):"person"===t.type?(0,tt.jsx)(mt,{actor:t.actor}):"app"===t.type?(0,tt.jsx)(ut,{color:"default",icon:t.icon}):"arrow"===t.type?(0,tt.jsx)(pt,{}):"truncate"===t.type?(0,tt.jsx)(gt,{color:t.color,value:t.value}):void(0,ne.t1)(t.type)}function dt(e){window.__c={n:"StandardIcon"};const{color:t,icon:o}=e,n=ft(t);return(0,tt.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function pt(){window.__c={n:"ArrowIcon"};const e=ft("default");return(0,tt.jsx)("div",{style:{...e.iconWrap,...e.iconArrowWrap},children:(0,Re.n)({...e.icon,...e.iconArrow})})}function ut(e){window.__c={n:"AppIcon"};const{icon:t}=e,o=ft("default");return(0,tt.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function gt(e){window.__c={n:"TruncateIcon"};const{color:t,value:o}=e,n=ft(t);return(0,tt.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function mt(e){window.__c={n:"PersonIcon"};const{actor:t}=e,o=ft("default");return(0,tt.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:(0,tt.jsx)(st.ZP,{actor:t,avatarSize:26,format:st.ZP.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0}})})}function St(e){return void 0===e||e<0?6:e}function ft(e){const t="default"===e?"gray":e;return(0,S.yK)((e=>{const o="light"===e.mode?400:800,n="light"===e.mode?100:400;return{icon:{fill:e.accentColors[t][o],width:16},iconWrap:{background:e.accentColors[t][n],borderRadius:6,padding:6},iconApp:{width:14},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:e.accentColors.gray[n],padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},iconArrow:{fill:e.accentColors.gray[600]},iconArrowWrap:{background:void 0},truncateWrap:{alignItems:"center",background:e.accentColors.gray[n],color:e.accentColors[t][o],display:"inline-flex",fontSize:12,fontWeight:ie.Z.fontWeight.semibold,height:28,justifyContent:"center",padding:3,width:28}}}),[t])}const yt=(0,l.defineMessages)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationTabFilterButton:{defaultMessage:"Filter",id:"database.viewSettings.automationTab.filterButton"},automationTabAddFilterButton:{defaultMessage:"Add filter",id:"database.viewSettings.automationTab.addFilterButton"},automationTabFilterMenuSearchInputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.automationTab.filterMenuSearchInputPlaceholder"},automationTabFilterMenuNoResults:{defaultMessage:"No results",id:"database.viewSettings.automationTab.filterMenuNoResults"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationDisabledCaption:{defaultMessage:"Paused",id:"database.viewSettings.automationTab.disabledCaption"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically set status, assignees, property values and more with automations",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"You're a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentOnly:{defaultMessage:"You're a content editor. Content editors can edit pages, but cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentOnly"},automationSearchPlaceholder:{defaultMessage:"Search for an automation…",id:"database.viewSettings.automationTab.automationSearchPlaceholder"}});function ht(e){window.__c={n:"CollectionSettingsAutomationsView"};const{collectionContextStore:t,collectionSettingsStore:o,tabSettings:i}=e,a=(0,l.useIntl)(),c=(0,Ae.D)(),{isMobile:p}=(0,r.Fy)(),[u,g]=(0,n.useState)(""),f=(0,s.VK)((()=>t.collectionStore()),[t]),h=(0,s.VK)((()=>t.collectionViewBlockStore()),[t]),C=(0,s.VK)((()=>f&&f.id),[f]),b=(0,s.VK)((()=>null==f?void 0:f.getSchema()),[f]),w=(0,s.VK)((()=>null==f?void 0:f.getFormat()),[f]),j=(0,s.VK)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const r of n){const e=r.getModel();null!=e&&e.getAlive()&&((r.isTriggerType("event")||r.isTriggerType("notification_event"))&&i.push(r))}return i}({collectionStore:f,collectionViewBlockStore:h})),[f,h]),_=(0,s.VK)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:n}=e,i=new Map,r=[];for(const l of t){var s;if(!l.isDefined())continue;const e=[],t=l.getName();void 0!==t&&e.push(t);const c=null===(s=l.getOwnerStore())||void 0===s?void 0:s.getDisplayName(n);if(void 0!==c&&e.push(c),l.isTriggerType("event")||l.isTriggerType("notification_event")){const t=l.getEventConfiguration(),i=null==t?void 0:t.pagePropertiesEdited;if("some"===(null==i?void 0:i.type))for(const n of i.some){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${ke.SO[t.type]}`)}const r=l.getActionStores();for(const s of r){const t=s.getType();if(t){const o=(0,x.z)(t);(0,v.Xp)(o)&&e.push(n.formatMessage(o.display.name))}if(s.isType("create_page")||s.isType("update_pages")){var a;const t=s.getConfig();null==t||null===(a=t.properties)||void 0===a||a.forEach((t=>{const n=null==o?void 0:o[t];n&&e.push(`${n.name} ${ke.SO[n.type]}`)}))}}}const d=e.join(" ");i.set(l.id,d),r.push(d)}return function(e){const o=new Set(m().filter(e,r).map((e=>{let{original:t}=e;return t})));return t.filter((0,ne.AO)((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("notification_event"))return{false:e};const t=i.get(e.id);return t&&o.has(t)?{true:e}:{false:e}})))}}({automationStores:j,collectionSchema:b,intl:a})),[j,b,a]),M=(0,s.VK)((()=>_(u)),[_,u]),T=(0,s.VK)((()=>Pe.Li({collectionStore:f})),[f]),k=(0,n.useCallback)((()=>{d.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings"}})}),[o]),V=(0,n.useCallback)((e=>g(e.target.value)),[]),F=(0,n.useCallback)((()=>{c&&C&&y.qu(c,{collection_id:C})}),[c,C]);(0,n.useEffect)((()=>{if(!c||!C)return;const e="collection_table_header"===i.source?{property_type:i.propertyType,source:i.source}:{source:i.source};y.d(c,{...e,collection_id:C}),Ie.default.logEvent("automation_list_view","true")}),[c,C,i]);const[B,I]=n.useState(!1),Z=(0,s.VK)((()=>function(e){var t;const o=null===(t=Be.default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const r of e){const e=r.getCreatedByPointer();o&&e&&oe.dr.isEqual(o,e)?n.push(r):i.push(r)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(M)),[M]),D=(0,n.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=Z;return B?[...e,...t]:e.length>0?e:t}),[Z,B]),K=M.length-D.length,O=!B&&K>0,R=D.length>0,E=!R&&!(""!==u),G=(0,S.yK)((e=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:p?0:12,paddingBlockStart:p?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:42,paddingInline:12},menuScrollerStyle:{marginBlockStart:p?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginLeft:12,marginBottom:12,marginRight:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:e.text.secondary,fontSize:12,margin:0}})),[p]);return f&&b&&w&&h?(0,tt.jsx)(Ce.ZP,{...e,header:!E&&(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(we.ZP,{focusInitial:!p,onChange:V,placeholder:a.formatMessage(yt.automationSearchPlaceholder),showClearButton:!0,value:u})}),footer:(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[T&&(0,tt.jsx)(be.Z,{icon:A.R,onClick:k,title:a.formatMessage(yt.automationNewAutomationTitle),isGray:!0}),(0,tt.jsx)(je.Z,{href:"https://www.notion.so/help/database-automations",external:!0,onClick:F,children:(0,tt.jsx)(be.Z,{icon:P.m,title:a.formatMessage(yt.automationLearnAutomationTitle),isGray:!0})})]}),menuScrollerStyle:G.menuScrollerStyle,title:R||u?a.formatMessage(yt.automationTabTitle):null,children:(0,tt.jsx)("div",{style:G.wrap,children:E?(0,tt.jsx)("div",{style:G.emptyViewWrap,children:(0,tt.jsx)(xt,{collectionStore:f})}):(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{style:G.buttonList,children:D.length>0?D.map(((e,n)=>(0,tt.jsx)(Ct,{collectionContextStore:t,collectionStore:f,collectionSettingsStore:o,focused:!1,schema:b,automationStore:e},e.id))):(0,tt.jsx)("p",{style:G.noResultsTitle,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})}),O&&(0,tt.jsx)(Me.Z,{style:G.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),I(!0)},children:(0,tt.jsx)("div",{style:G.showMoreButtonContent,children:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:K}})})})]})})}):null}function xt(e){window.__c={n:"EmptyView"};const{collectionStore:t}=e,o=(0,r.O7)(),n=(0,S.yK)((e=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},icon:{fill:e.icon.yellow,height:24,width:24},title:{fontSize:17,fontWeight:ie.Z.fontWeight.medium,margin:0},copy:{color:e.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,s.VK)((()=>t.getRole()),[t]);let a;return a=(0,s.VK)((()=>Boolean((0,Ve.IJ)(o,t))),[t,o])||!i||"editor"===i?yt.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?yt.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?yt.automationEmptyViewContentOnly:yt.automationEmptyViewEditorPublic,(0,tt.jsxs)("div",{style:n.wrap,children:[(0,tt.jsx)("div",{"aria-hidden":!0,children:(0,k.K)(n.icon)}),(0,tt.jsx)("p",{style:n.title,children:(0,tt.jsx)(l.FormattedMessage,{...yt.automationTabTitle})}),(0,tt.jsx)("p",{style:n.copy,children:(0,tt.jsx)(l.FormattedMessage,{...a})})]})}const vt={text:Q.p,number:L.J,url:ee.O,file:R.Z,date:K.V,person:U.O,email:O.n,phone_number:z.u,checkbox:I.r,select:q.w,multi_select:W.A,status:Y.T,relation:H.v,rollup:$.G,formula:E.D,created_time:Z.I,created_by:D.H,title:X.c,last_edited_time:Z.I,last_edited_by:D.H,last_visited_time:Z.I,button:Y.T,auto_increment_id:G.A,location:N.w,verification:te.f,ai_summary:T.Y,ai_custom_prompt:V.y,ai_extract:W.A,ai_translate:M.Q};function Ct(e){window.__c={n:"AutomationSummaryCardWrapper"};const{automationStore:t,collectionContextStore:o,collectionStore:i,collectionSettingsStore:a,focused:c,schema:p}=e,u=(0,l.useIntl)(),g=(0,r.O7)(),m=(0,ve.X)({automationStore:t,collectionStore:i}),S=(0,s.VK)((()=>!!(i&&t&&m)&&Pe.qk({automationContextStore:m,automationStore:t,collectionStore:i})),[m,t,i]),y=(0,s.VK)((()=>t.getActionStores()),[t]),x=(0,s.VK)((()=>t.getTriggerStore().getValue()),[t]),v=(0,s.VK)((()=>t.getNameWithDefault(u)),[u,t]),M=(0,s.VK)((()=>"active"===t.getStatus()),[t]),T=(0,s.VK)((()=>o.aliveAutomationCount.state),[o]),k=(0,s.VK)((()=>Pe.i1({actionStores:y,automationStore:t})),[y,t]),P=(0,s.VK)((()=>Pe.qM({automationStore:t})),[t]),V=(0,n.useCallback)((async()=>{await De.SC({collectionStore:i,environment:g,existingAutomationStore:t,intl:u,triggerType:"event",onDelete:()=>{1===T&&d.wl({collectionSettingsStore:a,item:{type:"main"}})}})}),[u,g,i,a,t,T]),I=(0,n.useCallback)((()=>{De.j3({automationStore:t,collectionStore:i,environment:g})}),[i,g,t]),Z=(0,n.useCallback)((()=>{d.H4({collectionSettingsStore:a,item:{type:"automationEditSettings",automationId:t.id}})}),[a,t]),D=(0,n.useCallback)((()=>{De.$K({automationStore:t,collectionStore:i,environment:g})}),[i,g,t]),K=(0,n.useMemo)((()=>x?function(e){const{schema:t,triggerConfig:o}=e;if("notification_event"!==o.type&&"event"!==o.type)return[];const n=[];o.event.pagesAdded&&n.push({color:"blue",icon:A.R,type:"page"});const i=o.event.pagePropertiesEdited;if("any"===i.type)n.push({color:"blue",icon:F.R,type:"misc"});else if("some"===i.type)for(const r of i.some){const e=t[r.property],o=r.filter;if(!e)continue;if(!h.Ym[e.type]){n.push({color:"gray",icon:Pt(e.type),type:"property"});continue}const i=b.gB(e),s=b.cu(e);if("changes_to_any"===o.operator)n.push({color:i||s?"gray":"blue",icon:Pt(e.type),type:"property"});else if(i&&!C.mv(o)&&C.r2(o)){const t=C.wB(o);if(t.length>1)n.push({color:"gray",icon:Pt(e.type),type:"property"});else if(1===t.length){const o=t[0];if("is_group"===o.type){const t=(e.groups??[]).find((e=>e.name===o.value));t&&n.push({color:t.color??"gray",icon:Pt(e.type),type:"property"})}else{const t=(e.options??[]).find((e=>e.value===o.value));t&&n.push({color:t.color??"gray",icon:Pt(e.type),type:"property"})}}}else if(s&&!C.mv(o)&&(C.dx(o)||C.NU(o))){const t=C.dx(o)?C.mg(o):C.qC(o);if(1===t.length){const o=t[0],i=(e.options??[]).find((e=>e.value===o.value));i&&n.push({color:i.color??"gray",icon:Pt(e.type),type:"property"})}else t.length>1&&n.push({color:"gray",icon:Pt(e.type),type:"property"})}}return n}({schema:p,triggerConfig:x}):[]),[p,x]),O=(0,s.VK)((()=>function(e){const{actionStores:t,collectionStore:o,schema:n}=e,i=[];for(const c of t)if(c.isType("slack_notification"))i.push({icon:B.P,type:"app"});else if(c.isType("update_pages")){const e=c.getConfig(),t=(null==e?void 0:e.properties)??[];if(1===t.length){var r,s;const l=t[0],c=n[l],d=null==e||null===(r=e.values)||void 0===r?void 0:r[l];if(!c||!d)continue;if(!h.SF(c)){i.push({color:"gray",icon:Pt(c.type),type:"property"});continue}const p=(0,_.A6)(null===(s=d.value)||void 0===s?void 0:s.value);if(b.gB(c)){const e=(c.options||[]).find((e=>e.value===p[0]));e&&i.push({color:e.color??"gray",icon:Pt(c.type),type:"property"})}else if(b.cu(c))if(1===p.length){const e=(c.options||[]).find((e=>e.value===p[0]));e&&i.push({color:e.color??"gray",icon:Pt(c.type),type:"property"})}else p.length>1&&i.push({color:"gray",icon:Pt(c.type),type:"property"});else if(b.KR(c)){var a;const e=(0,w.DW)({textValue:null===(a=d.value)||void 0===a?void 0:a.value,propertySchema:c,blockCreatorPointer:void 0}).map((e=>(0,f.Hl)({pointer:e,getRecordValue:o.getRecordValue})));1===e.length?i.push({actor:e[0],type:"person"}):i.push({color:"gray",icon:Pt(c.type),type:"property"})}else i.push({color:"gray",icon:Pt(c.type),type:"property"})}else t.length>1&&i.push({color:"gray",icon:F.R,type:"misc"})}else if(c.isType("create_page")){var l;(null===(l=c.getConfig())||void 0===l?void 0:l.collection)&&i.push({color:"blue",icon:A.R,type:"page"})}return i}({actionStores:y,collectionStore:i,schema:p})),[p,i,y]),R=(0,s.VK)((()=>M?m&&function(e){const{environment:t,actionStores:o,automationContextStore:n,collectionStore:i,canUserManageAutomation:r,intl:s,schema:a,triggerConfig:c}=e;if(!c||"event"!==c.type&&"notification_event"!==c.type)return;const{event:d}=c,p=[];d.pagesAdded&&p.push(xe.Mz(s));if("none"===d.pagePropertiesEdited.type);else if("any"===d.pagePropertiesEdited.type)p.push(xe.c5(s));else if("some"===d.pagePropertiesEdited.type)for(const l of d.pagePropertiesEdited.some){const e=a[l.property];if(!e){p.push(xe.nf(s));continue}if(!h.Ym[e.type]){p.push((0,re.u)({propertySchema:e}));continue}const{filter:t}=l;if("changes_to_any"===t.operator)p.push(xe.$G(s,{propertyName:e.name}));else if(h.bD(e))if("status"===e.type){if(!C.r2(t)||!C.vR(t))continue;const o=C.wB(t),n=(0,he.L)({intl:s,groupValues:o.map((e=>"is_group"===e.type?e.value:void 0)).filter(ne.$K),isText:!0,optionValues:o.map((e=>"is_option"===e.type?e.value:void 0)).filter(ne.$K),propertySchema:e,tokenFormat:j.lo.Small}),i=s.formatList(n,{style:"long",type:"disjunction"});p.push(xe.VO(s,{propertyName:e.name,propertyValues:i}))}else if("select"===e.type||"multi_select"===e.type){if(C.mv(t)||!C.dx(t)&&!C.NU(t))continue;const o=Array.isArray(t.value)?t.value:[t.value],n=(0,ye.z)({intl:s,isText:!0,optionValues:o.map((e=>e.value)).filter(ne.$K),propertySchema:e,tokenFormat:j.lo.Small}),i=s.formatList(n,{style:"long",type:"disjunction"});p.push(xe.XJ(s,{propertyName:e.name,propertyValues:i}))}else if("checkbox"===e.type){if(!C.XA(t))continue;p.push((0,fe.l4)({filter:t,propertySchema:e,intl:s}))}else(0,ne.t1)(e)}const u=s.formatList(p,{style:"long",type:"disjunction"}),g=[];for(const f of o)if(f.isType("slack_notification")){const e=f.getConfigStore().getKeyStore("target").getValue();g.push((0,tt.jsx)(l.FormattedMessage,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,tt.jsx)(se.p,{channel:e,isAutomationOwner:r})}}))}else if(f.isType("update_pages")){const e=f.getConfig(),o=null==e?void 0:e.properties,r=null==e?void 0:e.values,c=null==e?void 0:e.target;if(!o||0===o.length||!c)continue;if("collection"===c.type)if((0,oe.qo)(c.collection,i.pointer))g.push((0,tt.jsx)(l.FormattedMessage,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=Ze.NW.createChildStore(i,c.collection),o=(0,Fe.vU)({environment:t,intl:s,store:e});g.push((0,tt.jsx)(l.FormattedMessage,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:o}}))}else if("variable"===c.type){const e=o[0],t=a[e],l=null==r?void 0:r[e];if(!t){g.push(xe.aD(s));continue}if(!l)continue;if(h.SF(t))if("person"===t.type)g.push((0,tt.jsx)(bt,{collectionStore:i,propertyActionValue:l,propertySchema:t}));else if("status"===t.type){const e=(0,tt.jsx)(wt,{propertyActionValue:l,propertySchema:t});e&&g.push(e)}else if("select"===t.type||"multi_select"===t.type)g.push((0,tt.jsx)(jt,{propertyActionValue:l,propertySchema:t}));else if("checkbox"===t.type)g.push((0,tt.jsx)(_t,{propertyActionValue:l,propertySchema:t}));else if("relation"===t.type)g.push((0,tt.jsx)(Mt,{automationContextStore:n,collectionStore:i,propertyActionValue:l,propertySchema:t}));else if("date"===t.type){const o=(0,tt.jsx)(Tt,{automationContextStore:n,collectionStore:i,propertyActionValue:l,propertyId:e,propertySchema:t});o&&g.push(o)}else"number"===t.type||"phone_number"===t.type||"text"===t.type||"title"===t.type||"email"===t.type||"url"===t.type?g.push((0,tt.jsx)(kt,{automationStore:n.context.automationStore,propertyActionValue:l,propertySchema:t})):(0,ne.t1)(t);else g.push((0,re.u)({propertySchema:t}))}}else if(f.isType("create_page")){var m;const e=null===(m=f.getConfig())||void 0===m?void 0:m.collection;if(!e)continue;e.id===i.pointer.id?g.push((0,tt.jsx)(l.FormattedMessage,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):g.push((0,tt.jsx)(l.FormattedMessage,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}const S=s.formatList(g,{style:"long",type:"conjunction"});return s.formatMessage({defaultMessage:"When {triggers}, {actions}.",id:"automation.summaryCard.caption"},{actions:S,triggers:u})}({environment:g,actionStores:y,automationContextStore:m,canUserManageAutomation:k,collectionStore:i,intl:u,schema:p,triggerConfig:x}):u.formatMessage(yt.automationDisabledCaption)),[M,m,g,y,k,i,u,p,x]),E=(0,s.VK)((()=>{if(!t.isTriggerType("event")&&!t.isTriggerType("notification_event"))return!0;return!t.getTrigger()||Pe.vM({automationStore:t,collectionStore:i})}),[t,i]),G=!M||E,N=(0,n.useCallback)((e=>(0,n.createElement)(lt,{...e,key:t.id,actions:O,caption:R,focused:c,hasWarning:G,onClick:Z,onDelete:P?V:void 0,onDisable:M&&P&&S?I:void 0,onEdit:k?Z:void 0,onEnable:!M&&P&&S?D:void 0,title:v,triggers:K})),[O,t.id,k,P,R,c,G,M,S,V,I,Z,D,v,K]);return(0,tt.jsx)(Se.y,{caption:R,renderOrigin:N,title:v,tooltipAlignment:Te.v2.Start,tooltipPlacement:Te.ug.Bottom})}function bt(e){window.__c={n:"PersonActionTitle"};const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,l.useIntl)(),r=(0,s.VK)((()=>(0,de.UD)({getRecordModel:t.getRecordModel,propertySchema:n,value:o.value})),[t.getRecordModel,o.value,n]),a=(0,s.VK)((()=>(0,de.y3)({actors:r,intl:i,propertySchema:n})),[r,i,n]);return a||null}function wt(e){var t;window.__c={n:"StatusActionTitle"};const{propertyActionValue:o,propertySchema:n}=e,i=(0,_.A6)(null===(t=o.value)||void 0===t?void 0:t.value)[0],r=(0,l.useIntl)(),s=(0,ge.LQ)({intl:r,propertySchema:n,value:i});return s||null}function jt(e){var t,o;window.__c={n:"MultiSelectActionTitle"};const{propertyActionValue:n,propertySchema:i}=e,r=(0,l.useIntl)(),a=null!==(t=n.value)&&void 0!==t&&t.value?(0,_.A6)(null===(o=n.value)||void 0===o?void 0:o.value):[],c=xe.oJ({limit:ce.H,propertySchema:i,optionValues:a.map((e=>"string"==typeof e?e:void 0)).filter(ne.$K)});return(0,s.VK)((()=>(0,ue.I7)({intl:r,propertySchema:i,values:c})),[r,c,i])}function _t(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,ae.G7)({propertySchema:o,value:t.value})}function Mt(e){window.__c={n:"RelationActionTitle"};const{automationContextStore:t,collectionStore:o,propertyActionValue:n,propertySchema:i}=e,a=(0,l.useIntl)(),c=(0,r.O7)(),d=n.value,p=(0,s.VK)((()=>t.getAllContextValues()),[t]);return(0,s.VK)((()=>(0,pe.wr)({automationContextValues:p,collectionStore:o,environment:c,intl:a,propertySchema:i,value:d})),[p,o,c,a,i,d])}function Tt(e){window.__c={n:"DateActionTitle"};const{automationContextStore:t,collectionStore:o,propertyActionValue:i,propertyId:r,propertySchema:a}=e,c=(0,l.useIntl)(),d=i.value,p=(0,n.useMemo)((()=>({type:"collection",collectionStore:o,property:r})),[o,r]),u=(0,s.VK)((()=>(0,le.kD)({automationContextStore:t,intl:c,propertySchema:a,value:d,valueContext:p})),[t,c,a,d,p]);return u||null}function kt(e){window.__c={n:"TextActionTitle"};const{automationStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,r.O7)(),a=(0,S.Fg)(),l=(0,s.VK)((()=>(0,me.lG)({automationStore:t,environment:i,propertySchema:n,theme:a,value:o.value})),[t,i,o.value,n,a]);return l||null}function Pt(e){return(0,ne.$K)(e)?vt[e]??J.S:J.S}var Vt=o(7944),Ft=o(24039),At=o(12534),Bt=o(34859),It=o(58421),Zt=o(36857),Dt=o(59187),Kt=(o(52262),o(24506),o(1302)),Ot=o(39132),Rt=o(61061),Et=o(44495),Gt=o(95371),Nt=o(30188),Wt=o(66890),Lt=o(77472);var Ut=o(78316),zt=o(77181),Ht=o(42937),$t=o(29376),qt=o(5971),Yt=o(64275);function Qt(e){window.__c={n:"CollectionSettingsNotification"};const{title:t,icon:o,style:n,children:i,right:r,showCloseButton:s,onClose:a}=e,l=(0,S.Fg)(),c=(0,tt.jsx)(rt.Z,{onClick:a,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16},children:(0,Yt.D)({width:14,fill:l.mediumTextColor})});return(0,tt.jsxs)("div",{style:{padding:"12px 16px",margin:"4px 12px",fontSize:12,background:l.accentColors.orange[50],borderRadius:6,...n},children:[t&&(0,tt.jsxs)("div",{style:{display:"flex",marginBottom:2,alignItems:"center"},children:[o,(0,tt.jsx)("div",{style:{fontWeight:ie.Z.fontWeight.medium,flexGrow:1},children:t}),s?c:r]}),i]})}var Xt=o(64369),Jt=o(5210);function eo(e){window.__c={n:"CollectionSettingsViewSubitemsPreview"};const{propertyName:t,inversePropertyName:o,newDesign:n}=e,i=(0,S.yK)((e=>({togglePreviewParentIcon:{color:e.regularIconColor,marginRight:"4"},togglePreviewChildIcon:{color:e.mediumIconColor,marginLeft:"24px",marginRight:"4"},togglePreviewRowWithDivider:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderBottom:`1px solid ${e.regularDividerColor}`},togglePreviewRow:{padding:"4px",margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center"},togglePreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:"4px",alignItems:"center",...n?{fontWeight:ie.Z.fontWeight.medium,backgroundColor:e.accentColors.gray[30],padding:"9px 0"}:{}}})),[n]);return(0,tt.jsx)(tt.Fragment,{children:(0,tt.jsx)(_e.Z,{disableMobileBorders:!0,children:(0,tt.jsxs)("div",{style:i.togglePreviewOutsideBorder,children:[(0,tt.jsxs)("div",{style:i.togglePreviewRowWithDivider,children:[(0,tt.jsx)(Jt.Z,{isSidebar:!1,open:!0,fill:!0,onClick:()=>{},style:i.togglePreviewParentIcon,disabled:!0}),(0,tt.jsx)("span",{children:"🐔"}),(0,tt.jsx)("div",{style:{marginLeft:"5px"},children:o})]}),(0,tt.jsxs)("div",{style:i.togglePreviewRowWithDivider,children:[(0,tt.jsx)(Jt.Z,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:i.togglePreviewChildIcon,disabled:!0}),(0,tt.jsx)("span",{children:"🐣"}),(0,tt.jsx)("div",{style:{marginLeft:"5px"},children:t})]}),(0,tt.jsxs)("div",{style:i.togglePreviewRow,children:[(0,tt.jsx)(Jt.Z,{isSidebar:!1,open:!1,fill:!0,onClick:()=>{},style:i.togglePreviewChildIcon,disabled:!0}),(0,tt.jsx)("span",{children:"🐣"}),(0,tt.jsx)("div",{style:{marginLeft:"5px"},children:t})]})]})})})}var to=o(22491),oo=o(72126),no=o(65742),io=(o(21703),o(27731));function*ro(e,t){const o=new io.Z;for(o.currentValue=e,o.endValue=t,o.stiffness=35;;){const e=yield o.currentValue;if(o.step(e)){yield o.currentValue;break}}}function*so(e,t,o){let n=0;for(;n<o;){n+=(yield e+n/o*(t-e))}}function*ao(e){for(const[t,o]of oo.$R(e,e.slice(1)))(0,ne.$K)(t)&&(0,ne.$K)(o)&&(yield*ro(t,o))}function*lo(e,t){let o=0;for(;!(0,ne.$K)(t)||o<t;){o+=(yield e)}}function*co(e){let t=0;for(;;){const o={};for(const[n,i]of(0,ne.qP)(e)){const e=i.next(t);if(e.done)return;o[n]=e.value}t=yield o}}var po=o(28267),uo=o(43350);const go="inactive-task-filter",mo="active-task-filter",So="mouse-cursor-filter",fo=80,yo=24;function*ho(e){yield*co({x:e,opacity:lo(1)})}function xo(e){window.__c={n:"DateShiftingPreview"};const{mode:t}=e,o=(0,S.yK)((e=>({wrap:{margin:"0px 10px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112}})),[1]),i=(0,n.useRef)(null),r=(0,po.X)(i),s=r?r.width-2:264;return(0,tt.jsx)("div",{style:o.wrap,ref:i,children:(0,tt.jsx)(vo,{mode:t,sceneWidth:s})})}function vo(e){window.__c={n:"DateShiftingPreviewAnimation"};const{mode:t,sceneWidth:o}=e,i=(0,S.yK)((e=>({svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:no.lf},invalidArrow:{stroke:e.collectionInvalidDependencyArrow},svgContainer:{position:"absolute",width:"100%",height:"100%",backgroundColor:e.accentColors.gray[30]}})),[]),r=(0,n.useMemo)((()=>({none:function*(){for(;;)yield*ho(ao([o/2,o/2+40+20,o/2-40-20,o/2]))},preserve_gap:function*(){for(;;)yield*ho(ao([o/2,o/2+40,o/2-40,o/2]))},consume_gap:function*(){for(;;){yield*ho(ao([o/2,o/2-40,o/2+40,o/2+fo]));const e=500;yield*co({x:lo(o/2+fo),opacity:so(1,0,e)}),yield*co({x:lo(o/2),opacity:so(0,1,e)})}}})),[o]),{x:s,opacity:a}=function(e){const t=(0,n.useMemo)((()=>e()),[e]),[o,i]=(0,n.useState)((()=>{const e=t.next(0);if(e.done)throw new Error("Generator must provide at least one result");return e.value}));return(0,n.useEffect)((()=>{const e=t.next(0);e.done||i(e.value);let o=Date.now(),n=0;return n=requestAnimationFrame((function e(){n=requestAnimationFrame(e);const r=Date.now(),s=r-o;o=r;const a=t.next(s);a.done||i(a.value)})),()=>cancelAnimationFrame(n)}),[t]),o}(r[t??"none"]),l={x:o/2-160,y:10},c={x:s-40,y:42},d={x:o/2+fo,y:74},p={x:c.x+40,y:c.y+12};return(0,ne.$K)(t)&&("consume_gap"===t?(l.x=Math.min(l.x,c.x-fo),d.x=Math.max(d.x,c.x+fo)):"preserve_gap"===t?(l.x=l.x+s-o/2,d.x=d.x+s-o/2):(0,ne.t1)(t)),(0,tt.jsxs)("svg",{style:i.svgContainer,children:[oo.w6(o/2-160,o,40).map(((e,t)=>(0,tt.jsx)(bo,{startPoint:{x:e,y:0},endPoint:{x:e,y:110}},t))),(0,tt.jsx)(uo.Z,{startPoint:{x:c.x+fo,y:c.y+12},endPoint:{x:d.x-2,y:d.y+12},...(0,to.iv)(i.svgArrowTheme,c.x+fo>d.x?i.invalidArrow:void 0,{opacity:a}),showArrowHead:!0}),(0,tt.jsx)(uo.Z,{startPoint:{x:l.x+fo,y:l.y+12},endPoint:{x:c.x-2,y:c.y+12},...(0,to.iv)(i.svgArrowTheme,c.x<l.x+fo?i.invalidArrow:void 0,{opacity:a}),showArrowHead:!0}),(0,tt.jsx)(Co,{point:l,opacity:a}),(0,tt.jsx)(Co,{point:c,active:!0,opacity:a}),(0,tt.jsx)(Co,{point:d,opacity:a}),(0,tt.jsx)(wo,{point:p,opacity:a}),(0,tt.jsx)(jo,{})]})}function Co(e){window.__c={n:"SvgTaskBox"};const{point:t,active:o,opacity:n}=e,i=(0,S.Fg)(),r=o?"dark"===i.mode?"#28456C":"#E7F3F8":i.buttonBackground;return(0,tt.jsx)("g",{transform:`translate(${t.x-4},${t.y-2})`,opacity:n,children:(0,tt.jsx)("rect",{filter:`url(#${o?mo:go})`,width:fo,height:yo,x:"4",y:"2",fill:r,rx:"3"})})}function bo(e){window.__c={n:"SvgDashedLine"};const{startPoint:t,endPoint:o}=e,n=(0,S.Fg)(),i="dark"===n.mode?n.accentColors.gray[300]:"#E3E2E0";return(0,tt.jsx)("line",{x1:t.x,y1:t.y,x2:o.x,y2:o.y,stroke:i,strokeDasharray:"3 4"})}function wo(e){const{point:t,opacity:o}=e;return(0,tt.jsxs)("g",{filter:"url(#mouse-cursor-filter)",transform:`translate(${t.x},${t.y})`,opacity:o,children:[(0,tt.jsx)("path",{fill:"#32302C",d:"M14 12.25h-3.334l2.193 5.294-2.309.956-2.194-5.294L6 15.563l-.75-.75V3.94l1.06-.44L14 11.19v1.06z"}),(0,tt.jsx)("path",{stroke:"#fff",fill:"#32302C",strokeWidth:"0.5",d:"M14 12.5h.25v-1.413l-.073-.073-7.69-7.69-.12-.12-.154.065-1.059.44L5 3.775v11.142l.073.073.75.75.177.177.177-.177 2.092-2.091 2.05 4.948.096.23.23-.095 2.31-.956.231-.096-.096-.231-2.05-4.948H14z"})]})}function jo(){return(0,tt.jsxs)("defs",{children:[(0,tt.jsxs)("filter",{id:go,width:88,height:32,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,tt.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_7659"}),(0,tt.jsx)("feOffset",{}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,tt.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_7659"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feOffset",{dy:"2"}),(0,tt.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,tt.jsx)("feBlend",{in2:"effect1_dropShadow_637_7659",result:"effect2_dropShadow_637_7659"}),(0,tt.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_7659",result:"shape"})]}),(0,tt.jsxs)("filter",{id:mo,width:88,height:32,x:"0",y:"0",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,tt.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_637_5084"}),(0,tt.jsx)("feOffset",{}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.2 0 0 0 0 0.494118 0 0 0 0 0.662745 0 0 0 0.2 0"}),(0,tt.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_5084"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feOffset",{dy:"2"}),(0,tt.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,tt.jsx)("feBlend",{in2:"effect1_dropShadow_637_5084",result:"effect2_dropShadow_637_5084"}),(0,tt.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_637_5084",result:"shape"})]}),(0,tt.jsxs)("filter",{id:So,width:"17.75",height:"24.244",x:"0.75",y:"0.91",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,tt.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feOffset",{dy:"2"}),(0,tt.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.2 0"}),(0,tt.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_637_4925"}),(0,tt.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_637_4925",result:"shape"})]})]})}var _o=o(52936),Mo=o(18442),To=o(71644),ko=o(8406),Po=o(16956),Vo=o(14900),Fo=o(47307),Ao=o(9953),Bo=o(42922),Io=o(86825),Zo=o(87279),Do=o(61053),Ko=o(98519),Oo=o(69872);function Ro(e){window.__c={n:"CollectionSettingsViewDefaultPropertyPopup"};const{menuProps:t,property:o,defaultProperty:n,checkState:i,propertySchema:a,collectionContextStore:l,handleDefaultPropertySelect:c,handlePropertySelect:d,...p}=e,u=(0,r.MO)(),g=(0,s.VK)((()=>l.permissionScopes.state),[l]);return(0,s.VK)((()=>Ie.default.checkGate("collection_level_subitems_setting")),[])?(0,tt.jsx)(Oo.Z,{...t,disabled:!g.canConfigureBlock,propertySchema:a,format:Oo.L.Name,onClick:()=>c(o),right:(0,tt.jsx)(Eo,{property:o,checkState:o===n,collectionContextStore:l,defaultProperty:void 0})}):(0,tt.jsx)($e.ZP,{popupType:u?$e.Z4.SlideUp:$e.Z4.Popup,alignmentToOrigin:$e.vR.End,placementToOrigin:$e.pO.Bottom,originGap:0,renderOrigin:e=>(0,tt.jsx)(Oo.Z,{...t,...e,disabled:!g.canConfigureBlock,propertySchema:a,format:Oo.L.Name,right:(0,tt.jsx)(Eo,{property:o,defaultProperty:n,checkState:i,collectionContextStore:l})}),render:e=>(0,tt.jsx)(Go,{...p,parent:e,property:o,collectionContextStore:l,handleDefaultPropertySelect:c,handlePropertySelect:d})})}function Eo(e){window.__c={n:"DefaultCheck"};const{property:t,defaultProperty:o,checkState:n,collectionContextStore:i}=e,a=(0,r.MO)(),c=(0,s.VK)((()=>{var e;return null===(e=i.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[i]),d=(0,S.yK)((e=>({defaultText:{color:e.mediumTextColor,fontSize:12,fontWeight:500,textTransform:"uppercase",marginRight:4}})),[]);return(0,tt.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,tt.jsx)("div",{style:{...d.defaultText},children:t===o&&(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Default",id:"database.viewSettings.setViewPropertyDefault.defaultProperty.tag",values:{databaseName:c}})}),n&&(0,tt.jsx)("div",{style:{...a?{marginLeft:"auto",marginRight:20,minWidth:0,flexShrink:0}:{marginLeft:"auto",marginRight:12,minWidth:0,flexShrink:0},width:a?16:14,flexShrink:0},children:(0,Ko.k)()})]})}function Go(e){window.__c={n:"PropertySelectPopup"};const{parent:t,property:o,collectionContextStore:n,handleDefaultPropertySelect:i,handlePropertySelect:a,...c}=e,d=(0,r.MO)(),p=(0,s.VK)((()=>n.permissionScopes.state),[n]),u=(0,s.VK)((()=>n.databaseType),[n]),g=(0,s.VK)((()=>{var e;return null===(e=n.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[n]);let m;m=d?{menuType:Zo.og.ActionSheet}:{menuType:Zo.og.Popup,width:300};const S=p.canConfigureCollection;let f;if("v1"===e.version)f=(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[S&&(0,tt.jsx)(be.Z,{isGray:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Set on all new {databaseName} views",id:"database.viewSettings.setViewPropertyDefault.allDefaultButton.title",values:{databaseName:g}}),onClick:()=>{i(o),t.close()}}),(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.setViewPropertyDefault.setProperty.title",defaultMessage:"Set on this view"}),isGray:!0,onClick:()=>{a(o),t.close()}})]});else if("v2"===e.version){const n=(0,Ht.K9)({feature:e.feature,databaseType:u});f=(0,tt.jsxs)(tt.Fragment,{children:[S&&(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Set as default",id:"database.viewSettings.relationFeatures.setViewPropertyDefault.allDefaultButton.title",values:{databaseName:g}}),caption:(0,tt.jsx)(l.FormattedMessage,{...n}),shouldWrapCaption:!0,onClick:()=>{i(o),t.close()}})}),(0,tt.jsx)(_e.Z,{topBorder:S,children:(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationFeatures.setViewPropertyDefault.setProperty.title",defaultMessage:"Set on this view only"}),onClick:()=>{a(o),t.close()}})})]})}else(0,ne.t1)(e);return(0,tt.jsx)(Ye.Z,{...m,children:f})}var No=o(6695),Wo=o(33929),Lo=o(29798),Uo=o(73657);const zo=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.propertySelect.inputPlaceholder"}});function Ho(e){window.__c={n:"CollectionSetttingsGroupedPropertySelectMenu"};const{currentProperty:t,getGroupedProperties:o,onAccept:i,renderProperty:a,inputPlaceholder:c,schema:d,format:p,defaultShowPropertyGroupCount:u}=e,g=(0,r.Fy)(),f=(0,s.qz)(void 0,Lo.Z),y=(0,s.VK)((()=>o()),[o]),[h,x]=(0,n.useState)(!1),[v,C]=(0,n.useState)(""),b=(0,No.iB)(p,d,void 0,No.j5.Page).collection_page_properties||[],w=(0,n.useCallback)((e=>{C(e.target.value),f.setState({...f.state,focus:{section:0,indexLocal:0,indexGlobal:0}}),x(!1)}),[f]),j=(0,S.yK)((e=>({dotsIcon:{width:16,fill:e.mediumTextColor,marginLeft:4,marginRight:2},showMoreButton:{color:e.mediumTextColor}})),[]),_=oo.MR(y,(e=>Math.min(...e.map((e=>b.findIndex((t=>t.property===e))))))),M=[{key:"input",comp:(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(we.ZP,{focusInitial:!g.isMobile||void 0,focus:!g.isMobile||void 0,value:v,onChange:w,placeholder:c||Wo.default.formatMessage(zo.inputPlaceholder)})})}];if(v){const e=_.map((e=>e.filter((e=>{const t=d[e],o=t?`${t.name} ${ke.SO[t.type]}`:"";return Boolean(m().match(v,o))})))).filter((e=>e.length>0));if(0===e.length)M.push({key:"noResults",comp:(0,tt.jsx)(Uo.Z,{caption:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.propertySelect.noResultsTitle"})})});else{const o=[{key:"results",render:e=>(0,tt.jsx)(_e.Z,{...e}),items:e.flat().map((e=>qo({onAccept:i,property:e,schema:d,currentProperty:t,renderProperty:a}))).filter(ne.$K)}];M.push($o({sections:o,menuListStore:f}))}}else{const e=u||2;let o,n;if(!h&&_.length>e){o=_.slice(0,e);const t=oo.Sm(_.slice(e).map((e=>e.length)));n={key:"show_more",render:e=>(0,tt.jsx)(He.Z,{...e,icon:(0,Le.o)(j.dotsIcon),style:j.showMoreButton,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{moreCount} more",id:"database.viewSettings.propertySelect.showMoreTitle",values:{moreCount:t}})}),action:()=>{x(!0)}}}else o=_;const r=o.map(((e,r)=>({key:e.join("-"),render:e=>(0,tt.jsx)(_e.Z,{...e,topBorder:0!==r}),items:e.map((e=>qo({onAccept:i,property:e,schema:d,currentProperty:t,renderProperty:a}))).concat(r===o.length-1?[n]:[]).filter(ne.$K)})));M.push($o({sections:r,menuListStore:f}))}return(0,tt.jsx)(tt.Fragment,{children:M.map((e=>{let{key:t,comp:o}=e;return(0,tt.jsx)(n.Fragment,{children:o},t)}))})}function $o(e){const{menuListStore:t,sections:o}=e;return{key:"properties",comp:(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,initialFocus:0,sections:o,store:t})}}function qo(e){const{schema:t,currentProperty:o,onAccept:n,renderProperty:i,property:r}=e,s=t[r];if(!s)return;return{key:r,render:e=>{const t=r===o;return i?i(e,r,t,s):(0,tt.jsx)(Oo.Z,{...e,propertySchema:s,format:Oo.L.Name,checkState:t})},action:()=>{n(r)}}}var Yo=o(53437),Qo=o(31869),Xo=o(54281);function Jo(e){const{collectionContextStore:t,feature:o}=e,n=(0,l.useIntl)();return{initialPropertyName:(0,s.VK)((()=>{const e=t.collectionStore();if(null!=e&&e.isDefined()){const i=t.normalizedSchemaStore.state;return $t.m8(n,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:i,createUnique:!0,from:o})}return n.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[t,n,o])}}function en(e){const{feature:t,collectionContextStore:o,collectionSettingsStore:i,onPropertySelect:a}=e,c=(0,r.O7)(),p=(0,l.useIntl)(),{initialPropertyName:g}=Jo({collectionContextStore:o,feature:t}),m=(0,n.useCallback)((e=>{const{collectionViewStore:o,newProperty:n,transaction:i}=e;"subitem"===t?Nt.dR({collectionViewStore:o,propertyId:n,transaction:i}):"timeline_arrows_by"===t?Xo.tF({collectionViewStore:o,newProperty:n,transaction:i}):(0,ne.t1)(t)}),[t]),S=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),f=(0,n.useCallback)((()=>$t.ND(o,S)),[o,S]),y=(0,n.useCallback)((e=>{const{relationPropertyId:n,transaction:i}=e;"subitem"===t?Nt.jA({environment:c,collectionContextStore:o,relationPropertyId:n,transaction:i}):"timeline_arrows_by"===t?Xo._p({collectionContextStore:o,relationPropertyId:n,transaction:i}):(0,ne.t1)(t)}),[o,c,t]),h=(0,n.useCallback)((e=>{const{featureType:t}=e,n=o.collectionStore(),r=n,s=o.collectionViewStore();n&&r&&(u.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:c,perform:i=>{const a=Po.G3({environment:c,collectionStore:n,collectionViewArgs:s?{collectionViewStore:s,format:s.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:i});return Qo.n7({environment:c,collectionContextStore:o,collectionStore:n,property:a,propertyName:g,targetCollectionStore:r,hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:p,transaction:i,from:t}),s&&(m({collectionViewStore:s,newProperty:a,transaction:i}),y({relationPropertyId:a,transaction:i})),"timeline_arrows_by"===t&&Sn({environment:c,intl:p,collectionStore:n,transaction:i,newConfig:e.dateShiftingConfig}),a}}),d.wl({collectionSettingsStore:i,item:{type:"main"}}),ko._H({environment:c,collectionContextStore:o,from:t,property_type:"relation"}))}),[o,i,c,g,p,y,m]),x=(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;u.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:c,perform:t=>{m({collectionViewStore:n,newProperty:e,transaction:t}),y({relationPropertyId:e,transaction:t})}}),a(e),"subitem"===t?i="update_default_subitem":"timeline_arrows_by"===t?i="update_default_timeline_arrows_by":(0,ne.t1)(t),ko.wd({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:c,collectionContextStore:o})}),[o,c,a,t,m,y]);return{handlePropertySelect:(0,n.useCallback)((e=>{const n=o.collectionViewStore();if(!n)return;let i;u.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:c,perform:t=>{m({collectionViewStore:n,newProperty:e,transaction:t})}}),a(e),"subitem"===t?i="update_subitem":"timeline_arrows_by"===t?i="update_timeline_arrows_by":(0,ne.t1)(t),ko.wd({action:i,original_view_type:void 0,property_type:e?"relation":void 0,environment:c,collectionContextStore:o})}),[o,c,a,t,m]),handleDefaultPropertySelect:x,handleAddRelation:h,getProperties:f}}function tn(e){const{feature:t,collectionContextStore:o}=e;let n,i;const r=Ie.default.checkGate("collection_level_subitems_setting");var s,a,l,c;if("subitem"===t)r?(i=null===(s=o.collectionStore())||void 0===s?void 0:s.getFormatStore().getKeyStore("subitem_property").getValue(),n="flattened"===(null===(a=o.collectionViewStore())||void 0===a?void 0:a.getFormat().subitem_display_mode)?void 0:i):(n=null===(l=o.currentSubitemFormatStore.state)||void 0===l?void 0:l.property,i=null===(c=o.collectionStore())||void 0===c?void 0:c.getFormatStore().getKeyStore("collection_default_subitem").getValue());else if("timeline_arrows_by"===t){var d;n=o.currentArrowsByFormatStore.state,i=null===(d=o.collectionStore())||void 0===d?void 0:d.getFormatStore().getKeyStore("collection_default_arrows_by").getValue()}else(0,ne.t1)(t);const p=o.normalizedSchemaStore.state,u=$t.NA(o,p);(0,ne.$K)(n)&&!u.includes(n)&&(n=void 0),(0,ne.$K)(i)&&!u.includes(i)&&(i=void 0);const g=n??i;if(g)return{property:g,isDefault:g===i,enabledOnView:Boolean(n),enabledOnCollection:Boolean(i),supportedInView:fn({feature:t,viewType:o.getViewType()})}}function on(e){const{feature:t,collectionContextStore:o}=e;return(0,s.VK)((()=>tn({feature:t,collectionContextStore:o})),[o,t])}function nn(e){window.__c={n:"RelationPropertyPicker"};const{currentPropertyId:t,feature:o,collectionContextStore:n,collectionSettingsStore:i,permissionScopes:r,onPropertySelect:a,buttonPopupStore:c,disabled:d}=e,p=(0,l.useIntl)(),u=(0,s.VK)((()=>{var e,t;return"subitem"===o?null===(e=n.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.collection_default_subitem:"timeline_arrows_by"===o?null===(t=n.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void(0,ne.t1)(o)}),[o,n]),g=(0,s.VK)((()=>n.databaseType),[n]),{handleDefaultPropertySelect:m,handlePropertySelect:S,getProperties:f}=en({collectionContextStore:n,collectionSettingsStore:i,feature:o,onPropertySelect:a}),y=(0,Ht.g3)({feature:o,databaseType:g});return(0,tt.jsx)(sn,{intl:p,icon:H.v,caption:(0,tt.jsx)(l.FormattedMessage,{...y}),collectionContextStore:n,buttonPopupStore:c,shouldGroupProperties:!0,getGroupedProperties:f,currentProperty:t,disabled:d,onAccept:r.canConfigureBlock&&r.canConfigureCollection?S:()=>{},renderProperty:(e,t,i,r)=>(0,tt.jsx)(Ro,{version:"v2",feature:o,menuProps:e,property:t,defaultProperty:u,checkState:i,propertySchema:r,collectionContextStore:n,handleDefaultPropertySelect:m,handlePropertySelect:S})})}function rn(e){window.__c={n:"DatePropertyPicker"};const{currentPropertyId:t,collectionContextStore:o,onPropertyChanged:i,disabled:r,title:a}=e,c=(0,l.useIntl)(),d=(0,s.qz)(void 0,Xe.Z),p=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),u=(0,n.useCallback)((()=>Object.keys(p).filter((e=>{const t=p[e];return"date"===(null==t?void 0:t.type)})).filter(ne.$K)),[p]);return(0,tt.jsx)(sn,{intl:c,buttonPopupStore:d,title:a,collectionContextStore:o,shouldGroupProperties:!1,getProperties:u,currentProperty:t,disabled:r,onAccept:e=>{e&&i(e),d.setState({open:!1})}})}function sn(e){window.__c={n:"PopupPropertyPicker"};const{currentProperty:t,icon:o,caption:n,buttonPopupStore:i,collectionContextStore:a,disabled:c,title:d,shouldGroupProperties:p}=e,u=(0,r.Fy)(),g=(0,s.VK)((()=>{var e;return(null===(e=a.collectionStore())||void 0===e?void 0:e.getFormat())??{}}),[a]),m=(0,s.VK)((()=>a.normalizedSchemaStore.state),[a]),f=(0,S.yK)((e=>({caption:{fontSize:u.isMobile?ie.Z.fontSize.UISmall.mobile:ie.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,margin:"0 12px 12px 14px"}})),[u]),y=(0,s.VK)((()=>i.state.open),[i]),h=(0,s.VK)((()=>u.isPhone?{menuType:Zo.og.ActionSheet}:{menuType:Zo.og.Popup,width:300}),[u.isPhone]);return(0,tt.jsxs)(tt.Fragment,{children:[n&&(0,tt.jsx)("div",{style:f.caption,children:n}),(0,tt.jsx)($e.ZP,{popupType:u.isPhone?Yo.kQ.SlideUp:Yo.kQ.Popup,alignmentToOrigin:$e.vR.End,placementToOrigin:$e.pO.Bottom,disabled:c,originGap:0,renderOrigin:e=>{var n;return(0,tt.jsx)(be.Z,{title:d??(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationFeatures.propertyPicker.default.title",defaultMessage:"Property"}),showChevron:!0,right:t?(0,tt.jsx)("span",{style:ie.Z.textOverflowStyle,children:null===(n=m[t])||void 0===n?void 0:n.name}):void 0,rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},rotateChevron:y,disabled:c,icon:o,...e})},render:t=>(0,tt.jsx)(Ye.Z,{...h,children:p?(0,tt.jsx)(Ho,{...e,getGroupedProperties:e.getGroupedProperties,format:g,schema:m}):(0,tt.jsx)(Do.Z,{...e,getProperties:e.getProperties,format:g,schema:m})}),buttonPopupStore:i})]})}function an(e){var t;window.__c={n:"DateShiftingConfigSection"};const{currentConfig:o,onConfigChange:i,disabled:a,collectionContextStore:c}=e,d=(0,s.VK)((()=>c.databaseType),[c]),p=(0,r.O7)(),u=null===(t=o.configWithoutDates)||void 0===t?void 0:t.mode,[g,m]=(0,n.useState)(!(0,ne.$K)(o.configWithoutDates)||Boolean(o.configWithoutDates.avoid_weekends)),f=(0,ne.$K)(o.configWithoutDates)?Boolean(o.configWithoutDates.avoid_weekends):g;(0,n.useEffect)((()=>{if((0,ne.$K)(o.configWithoutDates)){const e=Boolean(o.configWithoutDates.avoid_weekends);e!==g&&m(e)}}),[o,g]);const y=(0,S.yK)((()=>({dateShiftContainer:{marginLeft:4},previewContainer:{marginLeft:4},previewTitle:{paddingLeft:10}})),[]),h=(0,n.useCallback)((e=>{(0,ne.$K)(o.configWithoutDates)&&(i({...o,configWithoutDates:{...o.configWithoutDates,avoid_weekends:e}}),ko.wd({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_avoid_weekends",new_avoid_weekends:e}))}),[c,o,p,i]),x=(0,n.useCallback)((e=>{(0,ne.$K)(e)?i({...o,configWithoutDates:{...o.configWithoutDates,mode:e,avoid_weekends:g}}):i({...o,configWithoutDates:void 0}),ko.wd({environment:p,collectionContextStore:c,action:"update_dependency_date_shift_mode",new_date_shift_mode:e??"none"})}),[c,o,p,g,i]);return(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(_e.Z,{title:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.dateShiftingSectionCaption}),disableMobileBorders:!0,style:y.previewContainer,desktopTitleStyle:y.previewTitle,children:(0,tt.jsx)(xo,{mode:u})}),(0,tt.jsx)(_e.Z,{disableMobileBorders:!0,style:y.dateShiftContainer,children:(0,tt.jsx)(gn,{currentMode:u,onModeChange:x,databaseType:d,disabled:a})}),(0,tt.jsxs)(_e.Z,{children:[(0,tt.jsx)(un,{currentValue:f,databaseType:d,onChange:h,disabled:a||!(0,ne.$K)(o.configWithoutDates)}),(0,tt.jsx)(ln,{...e})]})]})}function ln(e){window.__c={n:"DatePropertiesConfigSection"};const{collectionContextStore:t,currentConfig:o,onConfigChange:i,disabled:r}=e,a=(0,s.VK)((()=>{const e=t.normalizedSchemaStore.state;return Object.keys(e).filter((t=>{const o=e[t];return o&&(0,b.Lt)(o)}))}),[t]),c=a.length,d=o.datePropertyId?a.find((e=>e!==o.datePropertyId)):void 0,p="string"==typeof o.datePropertyId&&(0,ne.$K)(o.endDatePropertyId),u=(0,n.useCallback)(((e,t)=>{const n={[e]:t};if(p&&(0,ne.$K)(o.datePropertyId)){const i="datePropertyId"===e?"endDatePropertyId":"datePropertyId";o[i]===t&&(n[i]=a.find((e=>e!==t)))}i({...o,...n})}),[o,a,i,p]);return!(0,ne.$K)(o.configWithoutDates)||c<=1?null:(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(rn,{collectionContextStore:t,currentPropertyId:o.datePropertyId,title:p?(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.startDate}):(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.datePropertyPickerTitle}),onPropertyChanged:e=>u("datePropertyId",e),disabled:r}),(0,ne.$K)(d)&&"string"==typeof o.datePropertyId&&(0,tt.jsxs)(tt.Fragment,{children:[(0,ne.$K)(o.endDatePropertyId)&&(0,tt.jsx)(rn,{collectionContextStore:t,currentPropertyId:o.endDatePropertyId,title:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.endDate}),onPropertyChanged:e=>u("endDatePropertyId",e),disabled:r}),(0,tt.jsx)(Io.Z,{title:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationFeatures.datePropertyPicker.separateStartEnd",defaultMessage:"Separate start and end dates"}),focused:!1,on:p,disabled:r,disabledFeedback:!0,onClick:()=>{i({...o,endDatePropertyId:p?void 0:d})}})]})]})}function cn(e){const{collectionSettingsStore:t,feature:o,permissionScopes:n}=e,i=!n.canConfigureCollection&&!n.canConfigureBlock;return(0,tt.jsx)(be.Z,{icon:Mo.H,showChevron:!0,disabled:i,title:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.advancedSettings}),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"relationFeaturesAdvancedSettings",feature:o}})}})}function dn(e){window.__c={n:"TurnOnFeatureButton"};const{feature:t,handleAddRelation:o,databaseType:n,permissionScopes:i}=e,r=(0,S.yK)((e=>({button:{width:"100%"},buttonWrap:{margin:"0px 12px"}})),[]);if(!i.canConfigureBlock||!i.canConfigureCollection)return null;const s=(0,Ht.Tq)({feature:t,databaseType:n});return(0,tt.jsx)(_e.Z,{disableMobileBorders:!0,children:(0,tt.jsx)("div",{style:r.buttonWrap,children:(0,tt.jsx)(Bo.Z,{style:r.button,onClick:o,isLarge:!0,children:(0,tt.jsx)(l.FormattedMessage,{...s})})})})}function pn(e){window.__c={n:"TurnOffFeatureMenuItem"};const{feature:t,permissionScopes:o,propertyName:n,relationPropertyId:i,inversePropertyName:s,collectionContextStore:a,collectionSettingsStore:c,handleDefaultPropertySelect:p,databaseType:g}=e,m=(0,r.O7)(),f=(0,S.yK)((e=>({modalTitle:{fontWeight:ie.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalPropertyName:{color:e.darkTextColor,fontWeight:ie.Z.fontWeight.semibold}})),[]);if(!(o.canConfigureCollection&&o.canConfigureBlock&&n&&s))return null;const y=(0,Ht.nB)({feature:t,databaseType:g}),h=(0,Ht.OH)({feature:t,databaseType:g});return(0,tt.jsx)(be.Z,{icon:ze.y,title:(0,tt.jsx)(l.FormattedMessage,{...y}),isRed:!0,onClick:()=>{Fo.showDialog({description:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.turnOffFeatureDeletedProperties,values:{span:e=>(0,tt.jsx)("span",{style:f.modalPropertyName,children:e}),propertyName:n,inversePropertyName:s}}),message:(0,tt.jsx)("div",{style:f.modalTitle,children:(0,tt.jsx)(l.FormattedMessage,{...h})}),innerStyle:f.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.turnOffAndDelete}),color:"red",onAccept:async()=>{i&&(await async function(e){const{environment:t,collectionContextStore:o,propertyId:n,feature:i}=e,r=o.normalizedSchemaStore.state,s=o.collectionStore();if(!s)return;await u.createAndCommitAsync({environment:t,userAction:"CollectionSettingsViewRelationFeatures.handleTurnOffFeatureAndDeleteAccept",waitForServerCommit:!1,perform:e=>Po.yV({environment:t,collectionStore:s,schema:r,property:n,transaction:e})});const a=r[n];a&&ko.y9({environment:t,collectionContextStore:o,property_type:a.type,from:i,property:n})}({environment:m,propertyId:i,collectionContextStore:a,feature:t}),p(void 0),d.wl({collectionSettingsStore:c,item:{type:"main"}}))}},{label:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.turnOffFeature}),color:"red",onAccept:()=>{i&&(p(void 0),d.wl({collectionSettingsStore:c,item:{type:"main"}}))}}]})}})}function un(e){const{currentValue:t,onChange:o,disabled:n,databaseType:i}=e;return(0,tt.jsx)(Io.Z,{title:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.avoidWeekendsSwitcherTitle}),caption:(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.Bq)(i)}),shouldWrapCaption:!0,shouldWrapTitle:!0,focused:!1,on:t,disabled:n,disabledFeedback:!0,onClick:()=>o(!t)})}function gn(e){window.__c={n:"DateShiftModeSelect"};const{currentMode:t,onModeChange:o,disabled:n,databaseType:i}=e,r=(0,S.yK)((e=>({wrap:{display:"flex",flexDirection:"column",rowGap:8,marginLeft:12,marginRight:12}})),[]);return(0,tt.jsx)("div",{style:r.wrap,children:[..._o.Bp,void 0].map((e=>(0,tt.jsx)(mn,{dateShiftingMode:e,databaseType:i,onClick:()=>o(e),active:e===t,disabled:n},e??"none")))})}function mn(e){window.__c={n:"DateShiftButton"};const{dateShiftingMode:t,onClick:o,active:n,disabled:i,databaseType:s}=e,a=(0,r.Fy)(),c=(0,S.yK)((e=>({buttonStyles:{fontSize:a.isMobile?ie.Z.fontSize.UISmall.mobile:ie.Z.fontSize.UISmall.desktop,fontWeight:ie.Z.fontWeight.medium,borderRadius:4,width:"100%",padding:"8px 8px",boxShadow:`0 0 0 1px ${e.regularDividerColor}`,color:e.darkTextColor,fill:e.mediumTextColor,...n&&{boxShadow:`0 0 0 2px ${e.blueColor}`,color:e.blueColor,fill:e.blueColor},...i&&{opacity:.65}},icon:{width:20,height:20,marginRight:6},buttonContentWrap:{display:"flex",alignItems:"center"}})),[n,a,i]),d=(0,Ht.W3)({dateShiftingMode:t,databaseType:s}),p=(0,Ht.l7)(t);return(0,tt.jsx)(rt.Z,{style:c.buttonStyles,onClick:o,disabled:i,children:(0,tt.jsxs)("div",{style:c.buttonContentWrap,children:[(0,tt.jsx)("div",{children:p(c.icon)}),(0,tt.jsx)("div",{children:(0,tt.jsx)(l.FormattedMessage,{...d})})]})})}function Sn(e){const{environment:t,newConfig:o,collectionStore:n,transaction:i,intl:r}=e;let s;if((0,ne.$K)(o.configWithoutDates))if(o.datePropertyId)s={...o.configWithoutDates,date_property:o.datePropertyId,end_date_property:o.endDatePropertyId};else{const e=(0,To.ZP)(),a={name:r.formatMessage(Ht.dH.newDateProperty),type:"date"};Vo.xO({environment:t,collectionStore:n,update:{[e]:a},transaction:i}),s={...o.configWithoutDates,date_property:e,end_date_property:void 0}}Ao.sW({store:n.getFormatStore(),data:{dependency_date_shifting_config:s??null},transaction:i})}function fn(e){const{viewType:t,feature:o}=e;return"timeline_arrows_by"===o?"timeline"===t:"subitem"===o||void(0,ne.t1)(o)}function yn(e){window.__c={n:"CollectionSettingsViewRelationFeatures"};const{collectionContextStore:t,collectionSettingsStore:o,feature:i}=e,a=(0,l.useIntl)(),c=(0,r.Fy)(),d=(0,s.VK)((()=>t.normalizedSchemaStore.state),[t]),p=(0,s.VK)((()=>t.databaseType),[t]),u=(0,s.VK)((()=>t.collectionStore()),[t]),g=on({collectionContextStore:t,feature:i}),m=null==g?void 0:g.property,f=(0,n.useMemo)((()=>Ut.HI(d)),[d]),y=(0,s.VK)((()=>t.permissionScopes.state),[t]),h=(0,s.VK)((()=>{var e;return m&&(null===(e=d[m])||void 0===e?void 0:e.name)}),[d,m]),x=(0,s.VK)((()=>{const e=m&&d[m];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=d[o])||void 0===t?void 0:t.name:void 0}}),[m,d]),v=(0,s.VK)((()=>{const e=t.collectionStore();return null!=e&&e.isDefined()?$t.aI(a,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:i}):a.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[t,a,i]),C=(0,s.VK)((()=>Boolean(u&&function(e){const{collectionContextStore:t,collectionStore:o}=e,n=o.getFormat().collection_default_arrows_by,i=t.currentArrowsByFormatStore.state;return!(0,ne.$K)(i)||i===n}({collectionContextStore:t,collectionStore:u}))),[t,u]),b=(0,s.qz)(void 0,Xe.Z),w=(0,n.useCallback)((e=>{e&&b.setState({open:!1})}),[b]),{initialPropertyName:j}=Jo({collectionContextStore:t,feature:i}),_=en({collectionContextStore:t,collectionSettingsStore:o,onPropertySelect:w,feature:i}),{handleAddRelation:M,handleDefaultPropertySelect:T}=_,k=(0,qt.E)("collection_level_subitems_setting"),P=(0,S.yK)((e=>({container:{marginLeft:12,marginRight:12},captionText:{fontSize:c.isMobile?ie.Z.fontSize.UISmall.mobile:ie.Z.fontSize.UISmall.desktop,color:e.mediumTextColor,fontWeight:ie.Z.fontWeight.regular,marginLeft:14},subitemsPreviewContainer:{marginBottom:6,marginLeft:2}})),[c]);if(!u)return null;let V;if("subitem"===i)if(g)V=(0,tt.jsxs)(_e.Z,{disableMobileBorders:!0,children:[(0,tt.jsx)("div",{style:P.subitemsPreviewContainer,children:(0,tt.jsx)(eo,{propertyName:h||j,inversePropertyName:x||v,newDesign:!0})}),k?(0,tt.jsx)(bn,{databaseType:p,permissionScopes:y}):(0,tt.jsx)(Cn,{feature:i,databaseType:p,featuredRelationProperty:g,actions:_,permissionScopes:y}),(0,tt.jsx)(cn,{collectionSettingsStore:o,feature:i,permissionScopes:y}),(0,tt.jsx)(pn,{feature:i,databaseType:p,permissionScopes:y,propertyName:h,relationPropertyId:m,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:T,inversePropertyName:x})]});else{const e=()=>{M({featureType:"subitem"}),k&&Kt.default.afterNextFlush((()=>{const e=t.subitemTreeStore.getState(),o=t.resultsInViewOrder(1).at(0),n=(0,Gt.DY)(e.children,(e=>e.value.store===o));if(n){const e=n.map((e=>e.value.store.pointer)),o=(0,zt.Af)(e);Nt.rT({collectionContextStore:t,pathKey:o})}}))};V=(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(eo,{propertyName:h||j,inversePropertyName:x||v,newDesign:!0}),(0,tt.jsx)(dn,{feature:i,permissionScopes:y,databaseType:p,handleAddRelation:e})]})}else"timeline_arrows_by"===i?V=g?(0,tt.jsxs)(tt.Fragment,{children:[C?(0,tt.jsx)(xn,{collectionContextStore:t,firstDatePropertyId:f,permissionScopes:y}):(0,tt.jsx)(hn,{collectionContextStore:t,databaseType:p}),(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[(0,tt.jsx)(cn,{collectionSettingsStore:o,feature:i,permissionScopes:y}),(0,tt.jsx)(Cn,{feature:i,databaseType:p,featuredRelationProperty:g,actions:_,permissionScopes:y}),(0,tt.jsx)(pn,{feature:i,databaseType:p,permissionScopes:y,relationPropertyId:m,propertyName:h,inversePropertyName:x,collectionContextStore:t,collectionSettingsStore:o,handleDefaultPropertySelect:T})]})]}):(0,tt.jsx)(vn,{databaseType:p,collectionContextStore:t,firstDatePropertyId:f,handleAddRelation:M,permissionScopes:y}):(0,ne.t1)(i);const F=(0,Ht.Gt)({feature:i,databaseType:p}),A=(0,Ht.qi)({feature:i,databaseType:p});return(0,tt.jsxs)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{...F}),children:[(0,tt.jsx)(_e.Z,{disableMobileBorders:!0,children:(0,tt.jsx)("div",{style:{...P.container,...P.captionText},children:(0,tt.jsx)(l.FormattedMessage,{...A})})}),V]})}function hn(e){window.__c={n:"DateShiftingNotApplicableToThisViewMessage"};const{collectionContextStore:t,databaseType:o}=e,n=(0,r.MO)(),i=(0,S.yK)((e=>({wrap:{boxShadow:e.plainButtonBoxShadow,...n?{backgroundColor:e.sidebarBackground,margin:void 0,borderRadius:void 0}:{background:"rgba(196, 196, 196, 0.13)",marginTop:14,marginBottom:20}},iconWithMessage:{display:"flex",gap:8},icon:{width:14,height:14,position:"relative",top:1,color:e.mediumTextColor}})),[n]),a=(0,s.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),c=(0,Ht.uM)({currentDateShiftConfig:a,databaseType:o});return(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(_e.Z,{title:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.dateShiftingSectionCaption}),children:(0,tt.jsx)(xo,{mode:null==a?void 0:a.mode})}),(0,tt.jsx)(Qt,{style:i.wrap,showCloseButton:!1,children:(0,tt.jsxs)("div",{style:i.iconWithMessage,children:[(0,Et.D)(i.icon),(0,tt.jsx)(Xt.Z,{isSmall:!0,isMultiline:!0,children:(0,tt.jsx)(l.FormattedMessage,{...c})})]})})]})}function xn(e){window.__c={n:"FeatureEnabledDependenciesSection"};const{collectionContextStore:t,firstDatePropertyId:o,permissionScopes:i}=e,a=(0,r.O7)(),c=(0,l.useIntl)(),d=(0,s.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getNormalizedDependencyDateShiftingConfig()}),[t]),p=(0,n.useCallback)((e=>{const o=t.collectionStore();o&&u.createAndCommit({userAction:"FeatureEnabledDependenciesSection.handleConfigChange",environment:a,perform:t=>{Sn({collectionStore:o,environment:a,intl:c,newConfig:e,transaction:t})}})}),[t,a,c]),g=(0,n.useMemo)((()=>({configWithoutDates:d,...d?{datePropertyId:d.date_property,endDatePropertyId:d.end_date_property}:{datePropertyId:o}})),[d,o]);return(0,tt.jsx)(an,{collectionContextStore:t,currentConfig:g,disabled:!i.canConfigureBlock||!i.canConfigureCollection,onConfigChange:p})}function vn(e){window.__c={n:"FeatureDisabledDependenciesSection"};const{collectionContextStore:t,handleAddRelation:o,firstDatePropertyId:i,permissionScopes:r,databaseType:s}=e,[a,l]=(0,n.useState)({datePropertyId:i,configWithoutDates:{mode:"consume_gap",avoid_weekends:true}});return(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(an,{collectionContextStore:t,currentConfig:a,disabled:!r.canConfigureBlock||!r.canConfigureCollection,onConfigChange:l}),(0,tt.jsx)(dn,{feature:"timeline_arrows_by",permissionScopes:r,databaseType:s,handleAddRelation:()=>{o({featureType:"timeline_arrows_by",dateShiftingConfig:a})}})]})}function Cn(e){window.__c={n:"ToggleViewVisibilityMenuItem"};const{feature:t,featuredRelationProperty:o,actions:n,permissionScopes:i,databaseType:s}=e,a=(0,r.Fy)(),c=(0,S.yK)((()=>({eyeHideIcon:{width:20,height:a.isMobile?24:12,marginLeft:3}})),[a]);if(!o.supportedInView)return null;const d=o.enabledOnView,p=d?{icon:Rt.B,iconStyle:c.eyeHideIcon}:{icon:Ot.c};return(0,tt.jsx)(be.Z,{...p,onClick:()=>{n.handlePropertySelect(d?void 0:o.property)},title:(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.cn)({feature:t,isOn:d,databaseType:s})}),disabled:!i.canConfigureBlock})}function bn(e){window.__c={n:"SubitemDisplayModeMenuItem"};const{databaseType:t,permissionScopes:o}=e,i=(0,Wt.Y$)(),a=(0,s.VK)((()=>i.collectionViewStore()),[i]),c=(0,s.VK)((()=>null==a?void 0:a.getFormat()),[a]),d=void 0===(null==c?void 0:c.subitem_display_mode)||"show"===(null==c?void 0:c.subitem_display_mode),g=(0,r.Fy)(),m=(0,r.O7)(),f=(0,S.yK)((()=>({eyeHideIcon:{width:20,height:g.isMobile?24:12,marginLeft:3}})),[g]),y=n.useCallback((()=>{a&&u.createAndCommit({userAction:"actionRegistry.updateCollectionViewSubitemDisplayMode",environment:m,perform:e=>{p.FH({stores:[a],update:{subitem_display_mode:d?"flattened":"show",collection_view_subitem:d?void 0:(0,zt.wf)(i)},transaction:e})}})}),[d,i,a,m]);Lt.j(m,"configure_subitem_display_mode",{userAction:d?"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.flattened":"CollectionSettingsViewRelationFeatures.configureSubitemDisplayMode.show"});const h=d?{icon:Rt.B,iconStyle:f.eyeHideIcon}:{icon:Ot.c};return(0,tt.jsx)(be.Z,{...h,onClick:y,title:(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.cn)({feature:"subitem",isOn:d,databaseType:t})}),disabled:!o.canConfigureBlock})}var wn=o(41892),jn=o(91),_n=o(80402),Mn=o(24006),Tn=o(60442);function kn(e){const{render:t,showImage:o,caption:i,tooltipImage:r}=e,s=e.tooltipImageScale||1,[a,l]=n.useState(!1),[c,d]=n.useState({width:0,height:0});return n.useEffect((()=>{if(r){const e=new Image;e.src=r,e.onload=()=>{d({width:e.width*s,height:e.height*s}),l(!0)}}}),[r,s]),(0,tt.jsx)(Te.ZP,{placement:Te.ug.Left,disableTooltip:void 0===i,style:{whiteSpace:"break-spaces"},render:t,renderTooltip:()=>r&&a&&o?(0,tt.jsx)(Tn.Z,{caption:i,imageURL:r,imageWidth:c.width,imageHeight:c.height}):(0,tt.jsx)("div",{children:i})})}const Pn="box1-filter",Vn="box2-filter";function Fn(e){window.__c={n:"CollectionSettingsViewDependenciesPreview2"};const{propertyName:t,inversePropertyName:o}=e,n=(0,S.Fg)(),i=(0,S.yK)((e=>({svgWrap:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,backgroundColor:e.accentColors.gray[30],display:"flex",justifyContent:"center"}})),[]);return(0,tt.jsx)(_e.Z,{disableMobileBorders:!0,children:(0,tt.jsx)("div",{style:i.svgWrap,children:(0,tt.jsxs)("svg",{width:"266",height:"116",fill:"none",children:[(0,tt.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M124 20h.426c7.703 0 17.307-.002 25.029 1.93 3.979.994 8.078 2.638 11.248 5.575C164.082 30.635 166 34.868 166 40c0 8.001-6.095 12.917-11.524 15.932-5.553 3.086-12.74 5.481-19.23 7.644l-.349.116c-6.919 2.307-13.074 4.381-17.546 6.866C112.655 73.166 112 75 112 76c0 1.868.582 2.885 1.453 3.692 1.08 1.001 2.981 1.982 6.002 2.737C125.59 83.963 132.773 84 141 84"}),(0,tt.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M125 32c8.227 0 15.41.037 21.545 1.57 3.021.756 4.922 1.737 6.002 2.738.871.807 1.453 1.824 1.453 3.692 0 .999-.655 2.834-5.351 5.443-4.472 2.484-10.627 4.558-17.546 6.865l-.349.116c-6.49 2.163-13.677 4.558-19.23 7.644C106.095 63.084 100 67.998 100 76c0 5.132 1.918 9.365 5.297 12.495 3.17 2.937 7.269 4.581 11.248 5.576C124.267 96 133.871 96 141.574 96H142"}),(0,tt.jsx)("path",{fill:n.accentColors.gray[30],d:"M157 27h16v18h-16zM92 70h16v18H92z"}),(0,tt.jsx)("path",{stroke:"#DFAF49",strokeWidth:"2",d:"M136 88l5-4-5-4"}),(0,tt.jsx)("path",{stroke:"#E3E2E0",strokeWidth:"2",d:"M130 36l-5-4 5-4"}),(0,tt.jsxs)("g",{filter:"url(#box1-filter)",children:[(0,tt.jsx)("rect",{width:"100",height:"28",x:"24",y:"12",fill:n.buttonBackground,rx:"3"}),(0,tt.jsx)("text",{x:"67",y:"31",fill:"#000",children:"🌱"})]}),(0,tt.jsxs)("g",{filter:"url(#box2-filter)",children:[(0,tt.jsx)("rect",{width:"100",height:"28",x:"142",y:"76",fill:n.buttonBackground,rx:"3"}),(0,tt.jsx)("text",{x:"185",y:"95",fill:"#000",children:"🌳"})]}),(0,tt.jsx)(An,{x:"161",y:"26",width:"100",height:"16",textStyles:{fontSize:12,fontWeight:590,color:n.regularTextColor},children:t}),(0,tt.jsx)(An,{x:"15",y:"69",width:"90",height:"16",textStyles:{color:n.lightTextColor,fontSize:12,fontWeight:500,textAlign:"right"},children:o}),(0,tt.jsxs)("defs",{children:[(0,tt.jsxs)("filter",{id:Pn,width:"108",height:"36",x:"20",y:"10",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,tt.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,tt.jsx)("feOffset",{}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,tt.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feOffset",{dy:"2"}),(0,tt.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,tt.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,tt.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]}),(0,tt.jsxs)("filter",{id:Vn,width:"108",height:"36",x:"138",y:"74",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse",children:[(0,tt.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feMorphology",{in:"SourceAlpha",operator:"dilate",radius:"1",result:"effect1_dropShadow_1034_52436"}),(0,tt.jsx)("feOffset",{}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0707 0 0 0 0 0.0693 0 0 0 0 0.0693 0 0 0 0.1 0"}),(0,tt.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_1034_52436"}),(0,tt.jsx)("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,tt.jsx)("feOffset",{dy:"2"}),(0,tt.jsx)("feGaussianBlur",{stdDeviation:"2"}),(0,tt.jsx)("feComposite",{in2:"hardAlpha",operator:"out"}),(0,tt.jsx)("feColorMatrix",{values:"0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0 0.0705882 0 0 0 0.1 0"}),(0,tt.jsx)("feBlend",{in2:"effect1_dropShadow_1034_52436",result:"effect2_dropShadow_1034_52436"}),(0,tt.jsx)("feBlend",{in:"SourceGraphic",in2:"effect2_dropShadow_1034_52436",result:"shape"})]})]})]})})})}function An(e){const{children:t,textStyles:o,...n}=e;return(0,tt.jsx)("foreignObject",{...n,children:(0,tt.jsx)("div",{style:{...ie.Z.textOverflowStyle,...n.width?{width:Number(n.width)}:{},...o},children:t})})}function Bn(e){var t;window.__c={n:"CollectionSettingsDependenciesAdvancedSettings"};const{collectionContextStore:o,collectionSettingsStore:i,feature:r}=e,a=(0,l.useIntl)(),c=(0,qt.E)("collection_level_subitems_setting"),d=(0,s.VK)((()=>o.collectionStore()),[o]),p=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),u=(0,s.VK)((()=>o.permissionScopes.state),[o]),g=null===(t=on({collectionContextStore:o,feature:r}))||void 0===t?void 0:t.property,m=(0,s.VK)((()=>{var e;return g&&(null===(e=p[g])||void 0===e?void 0:e.name)}),[g,p]),f=(0,s.VK)((()=>{var e;return"table"===(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getType())}),[o]),y=(0,s.VK)((()=>{const e=g&&p[g];if(e&&"relation"===e.type){var t;const o=e.property;return o?null===(t=p[o])||void 0===t?void 0:t.name:void 0}}),[g,p]),h=(0,s.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?$t.aI(a,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:r}):a.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,a,r]),x=(0,s.qz)(void 0,Xe.Z),{initialPropertyName:v}=Jo({collectionContextStore:o,feature:r}),C=(0,n.useCallback)((e=>{e&&x.setState({open:!1})}),[x]),b=(0,S.yK)((()=>({previewContainer:{marginLeft:2}})),[]);if(!d)return null;let w;return"subitem"===r?w=(0,tt.jsx)(eo,{propertyName:m||v,inversePropertyName:y||h,newDesign:!0}):"timeline_arrows_by"===r?w=(0,tt.jsx)(Fn,{propertyName:m||v,inversePropertyName:y||h}):(0,ne.t1)(r),(0,tt.jsxs)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{...Ht.dH.advancedSettings}),children:[(0,tt.jsx)("div",{style:b.previewContainer,children:w}),(0,tt.jsxs)(_e.Z,{disableMobileBorders:!0,children:[(0,tt.jsx)(nn,{currentPropertyId:g,feature:r,onPropertySelect:C,buttonPopupStore:x,collectionContextStore:o,collectionSettingsStore:i,permissionScopes:u,disabled:c&&!u.canConfigureCollection}),"subitem"===r&&f&&(0,tt.jsx)(In,{collectionContextStore:o,permissionScopes:u})]})]})}function In(e){window.__c={n:"ToggleNestingOnTitleMenuItem"};const{collectionContextStore:t,permissionScopes:o}=e,i=(0,l.useIntl)(),a=(0,r.O7)(),c=(0,s.VK)((()=>"title"===t.normalizedFormatStore.state.table_subitem_toggle_column),[t]),d=!o.canConfigureBlock,p=(0,n.useCallback)((()=>{const e=t.collectionViewStore();e&&(_n.d1({environment:a,collectionViewStore:e,currentValue:t.normalizedFormatStore.state.table_subitem_toggle_column}),ko.wd({environment:a,collectionContextStore:t,action:"toggle_table_subitem_toggle_on_title"}))}),[t,a]);return(0,tt.jsx)(kn,{showImage:o.canConfigureBlock,caption:i.formatMessage(Ht.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:wn.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,tt.jsx)(be.Z,{...e,icon:e=>(0,jn.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),onClick:p,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,tt.jsx)(Mn.Z,{disallowTabbing:!0,on:c,disabled:d,onClick:p}),disabled:d})})}var Zn=o(40663),Dn=o(53787),Kn=o(89728);function On(e){window.__c={n:"CollectionSettingsViewDependenciesPreview"};const{propertyName:t}=e,o=(0,S.Fg)(),n=(0,S.yK)((e=>({dependenciesPreviewOutsideBorder:{margin:"0px 12px",border:`1px solid ${e.regularDividerColor}`,borderRadius:4,alignItems:"center",position:"relative",height:112,paddingLeft:19},svgContainer:{position:"absolute",width:"100%",height:"100%"},svgArrowTheme:{stroke:e.collectionValidDependencyArrow,strokeWidth:no.lf},dependencyPropertyNamePreview:{fontSize:12,position:"absolute",background:e.buttonBackground,top:48,left:96},timelineItemPreview:{padding:4,margin:"0px 12px",display:"flex",fontSize:14,alignItems:"center",borderRadius:5,background:e.cardBackground,boxShadow:e.buttonBoxShadow,width:100,justifyContent:"center"}})),[]);return(0,tt.jsx)(tt.Fragment,{children:(0,tt.jsx)(_e.Z,{children:(0,tt.jsxs)("div",{style:n.dependenciesPreviewOutsideBorder,children:[(0,tt.jsxs)("svg",{style:n.svgContainer,children:[(0,tt.jsx)(uo.Z,{startPoint:{x:110,y:25},endPoint:{x:110,y:87},style:n.svgArrowTheme,showArrowHead:!0}),(0,tt.jsx)(uo.Z,{startPoint:{x:210,y:87},endPoint:{x:223,y:87},style:n.svgArrowTheme,showArrowHead:!1}),(0,tt.jsx)("circle",{cx:223,cy:87,r:no.Wk,style:n.svgArrowTheme,fill:o.white})]}),(0,tt.jsx)("div",{style:n.dependencyPropertyNamePreview,children:t}),(0,tt.jsx)("div",{style:{...n.timelineItemPreview,marginTop:10,marginLeft:10},children:(0,tt.jsx)("span",{children:"🌱"})}),(0,tt.jsx)("div",{style:{...n.timelineItemPreview,marginTop:34,marginLeft:111},children:(0,tt.jsx)("span",{children:"🌳"})})]})})})}const Rn=(0,l.defineMessages)({subitemInputPlaceholder:{defaultMessage:"Sub-tasks…",id:"database.viewSettings.relationsPropertyTab.subitemInputPlaceholder"},timelineArrowsByInputPlaceholder:{defaultMessage:"Dependencies…",id:"database.viewSettings.relationsPropertyTab.timelineArrowsByInputPlaceholder"}});const En=(0,l.injectIntl)((function(e,t){window.__c={n:"CollectionSettingsViewRelationsProperty"};const{collectionContextStore:o,collectionSettingsStore:i,formatSetting:a}=e,c=(0,r.Fy)(),g=(0,l.useIntl)(),m=(0,r.O7)(),f="collection_page_properties",[y]=(0,n.useState)("no_limit"),h="subitem"===a,x="timeline_arrows_by"===a,v=(0,s.VK)((()=>o.databaseType),[o]),C=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),b=(0,s.VK)((()=>o.collectionStore()),[o]),w=(0,s.VK)((()=>(null==b?void 0:b.getFormat())??{}),[b]),j=(0,s.VK)((()=>{var e;return h?null===(e=o.currentSubitemFormatStore.state)||void 0===e?void 0:e.property:x?o.currentArrowsByFormatStore.state:void 0}),[o,h,x]),_=(0,s.VK)((()=>{var e,t;return h?null===(e=o.collectionStore())||void 0===e||null===(e=e.getFormat())||void 0===e?void 0:e.collection_default_subitem:x?null===(t=o.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by:void 0}),[o,h,x]),M=(0,s.VK)((()=>o.permissionScopes.state),[o]),T=(0,s.VK)((()=>$t.NA(o,C)),[o,C]),k=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),P=(0,s.VK)((()=>{var e;const t=o.currentSubitemFormatStore.state,n=o.currentArrowsByFormatStore.state;let i;return h?i=t?C[t.property]:void 0:x&&(i=n?C[n]:void 0),null===(e=i)||void 0===e?void 0:e.name}),[o,C,h,x]),V=(0,s.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?$t.m8(g,{targetCollectionStore:e,isSelfRelation:!0,sourceSchema:k,createUnique:!0,from:a}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.initialPropertyName.placeholder",defaultMessage:"Related to target"})}),[o,k,g,a]),[F,B]=(0,n.useState)(P||V),I=F===V,Z=(0,s.VK)((()=>{const e=o.currentSubitemFormatStore.state,t=o.currentArrowsByFormatStore.state;let n;if(h?n=e?C[e.property]:void 0:x&&(n=t?C[t]:void 0),n&&"relation"===n.type){var i;const e=n.property;return e?null===(i=C[e])||void 0===i?void 0:i.name:void 0}}),[o,C,h,x]),D=(0,s.VK)((()=>{const e=o.collectionStore();return null!=e&&e.isDefined()?$t.aI(g,{sourceCollection:e.getModel(),isSelfRelation:!0,targetCollectionStore:e,createUnique:!0,from:a}):g.formatMessage({id:"database.viewSettings.relationsPropertyTab.inverseName.placeholder",defaultMessage:"Related to this database"})}),[o,g,a]),K=(0,s.VK)((()=>"title"===o.normalizedFormatStore.state.table_subitem_toggle_column),[o]),[O,R]=(0,n.useState)({hasInverseRelation:!0,inverseName:Z,autoRelate:{enabled:!1}}),[E,G]=(0,n.useState)(0===T.length),N=(0,s.VK)((()=>(0,Zn.$4)()),[]),W=(0,s.qz)(void 0,Xe.Z),L=(0,s.Kw)(W),U=(0,n.useCallback)((()=>$t.NA(o,C)),[o,C]),z=(0,n.useCallback)((e=>{if(e){const t=C[e];if(t&&"relation"===t.type){const e=t.property;if(e){const t=C[e];if(t&&O){const e=t.name;R({hasInverseRelation:null==O?void 0:O.hasInverseRelation,inverseName:e,autoRelate:null==O?void 0:O.autoRelate})}}B(t.name)}}}),[C,O,B]),$=(0,n.useCallback)((e=>{const{collectionViewStore:t,newProperty:o,transaction:n}=e;h?(Nt.dR({collectionViewStore:t,propertyId:o,transaction:n}),(0,oo.o8)(t.getFormat().table_subitem_toggle_column)&&p.FH({stores:[t],update:{table_subitem_toggle_column:"title"},transaction:n})):x&&Xo.tF({collectionViewStore:t,newProperty:o,transaction:n})}),[h,x]),q=(0,n.useCallback)((e=>{const{relationPropertyId:t,transaction:n}=e;h&&Nt.jA({environment:m,collectionContextStore:o,relationPropertyId:t,transaction:n}),x&&Xo._p({collectionContextStore:o,relationPropertyId:t,transaction:n})}),[h,x,m,o]),Y=(0,n.useCallback)((e=>{const t=o.collectionViewStore();t&&(u.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handleDefaultPropertySelect",environment:m,perform:o=>{$({collectionViewStore:t,newProperty:e,transaction:o}),q({relationPropertyId:e,transaction:o})}}),z(e),G(!1),d.E3({collectionSettingsStore:i}),ko.wd({action:h?"update_default_subitem":"update_default_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:o}))}),[o,m,G,z,i,h,$,q]),Q=(0,n.useCallback)((e=>{const t=o.collectionViewStore();t&&(u.createAndCommit({userAction:"CollectionSettingsViewRelationsProperty.handlePropertySelect",environment:m,perform:o=>{$({collectionViewStore:t,newProperty:e,transaction:o})}}),z(e),G(!1),d.E3({collectionSettingsStore:i}),ko.wd({action:h?"update_subitem":"update_timeline_arrows_by",original_view_type:void 0,property_type:e?"relation":void 0,environment:m,collectionContextStore:o}))}),[o,m,z,i,h,$]),X=(0,n.useCallback)((()=>{Kt.default.afterNextFlush((()=>{G(!0),R({hasInverseRelation:!0,inverseName:D,autoRelate:{enabled:!1}}),B(V)}))}),[D,V]),J=(0,n.useCallback)((()=>{if(!O)return;const{hasInverseRelation:e,inverseName:t,autoRelate:n}=O,r=o.collectionStore(),s=r,l=o.collectionViewStore();r&&s&&(u.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:m,perform:i=>{const c=Po.G3({environment:m,collectionStore:r,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:f}:void 0,propertyType:"relation",transaction:i});return Qo.n7({environment:m,collectionContextStore:o,collectionStore:r,property:c,propertyName:F,targetCollectionStore:s,hasInverseRelation:e,inverseName:t,autoRelate:n,propertyLimit:y,intl:g,transaction:i,from:a}),l&&($({collectionViewStore:l,newProperty:c,transaction:i}),q({relationPropertyId:c,transaction:i})),c}}),d.z$({collectionSettingsStore:i}),d.H4({collectionSettingsStore:i,item:{type:"main"}}),ko._H({environment:m,collectionContextStore:o,from:a,property_type:"relation"}))}),[o,m,i,f,g,y,F,O,a,$,q]),ee=(0,n.useCallback)((()=>{const e=o.collectionViewStore();e&&(_n.d1({environment:m,collectionViewStore:e,currentValue:o.normalizedFormatStore.state.table_subitem_toggle_column}),ko.wd({environment:m,collectionContextStore:o,action:"toggle_table_subitem_toggle_on_title"}))}),[o,m]),te=!M.canConfigureBlock,oe=(0,S.yK)((e=>({emptyStateText:{color:e.mediumTextColor,fontSize:14,margin:"0px 12px"},useExistingTitle:{fontSize:12,color:e.mediumTextColor,marginLeft:12,marginTop:12}})),[]);if(!b)return null;const ne=h&&M.canConfigureBlock&&P&&N,ie=M.canConfigureCollection,re=(e,t,n,i)=>(0,tt.jsx)(Ro,{version:"v1",menuProps:e,property:t,defaultProperty:_,checkState:n,propertySchema:i,collectionContextStore:o,handleDefaultPropertySelect:Y,handlePropertySelect:Q});return(0,tt.jsxs)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.Gt)({feature:a,databaseType:v})}),footer:(0,tt.jsxs)(_e.Z,{topBorder:T.length>0&&!E,children:[ne&&!E&&(0,tt.jsx)(kn,{showImage:!te,caption:Wo.default.formatMessage(Ht.dH.toggleNestingOnTitleMenuItemTooltip),tooltipImage:wn.Z.images.tooltips.collectionSettings.subitemsToggleOnTitlePng,tooltipImageScale:.3,render:e=>(0,tt.jsx)(be.Z,{...e,icon:e=>(0,jn.L)({width:11,height:11,marginRight:5,marginLeft:6,transform:"rotateZ(180deg)"}),title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Show nesting toggle on title",id:"database.viewSettings.layoutTab.tableSubitemToggleOnTitle"}),right:(0,tt.jsx)(Mn.Z,{disallowTabbing:!0,on:K,onClick:ee,disabled:te}),disabled:te,isGray:!0,onClick:ee})}),ie&&T.length>0&&!E&&(0,tt.jsx)(be.Z,{icon:A.R,title:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.subitemTab.newRelation",defaultMessage:"Create new relation"}),isGray:!0,onClick:X}),!E&&(0,tt.jsx)(tt.Fragment,{children:M.canConfigureBlock&&!M.canConfigureCollection?(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeSubitemRelation.removeSubitemButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>Q(void 0)}):M.canConfigureBlock&&(0,tt.jsx)($e.ZP,{popupType:c.isPhone?Yo.kQ.SlideUp:Yo.kQ.Popup,alignmentToOrigin:$e.vR.End,placementToOrigin:$e.pO.Bottom,originGap:0,renderOrigin:e=>(0,tt.jsx)(tt.Fragment,{children:!(!M.canConfigureBlock||!j)&&(0,tt.jsx)(be.Z,{isGray:!0,icon:ze.y,title:(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.nB)({feature:a,databaseType:v})}),isRed:!0,...e})}),render:e=>{let t;return t=c.isPhone?{menuType:Zo.og.ActionSheet}:{menuType:Zo.og.Popup,width:300},(0,tt.jsx)(Ye.Z,{...t,footer:(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[M.canConfigureBlock&&(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.removeRelation.removeRelationButton.title",defaultMessage:"Turn off for this view"}),isRed:!0,onClick:()=>Q(void 0)}),M.canConfigureCollection&&(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Turn off for all new views",id:"database.viewSettings.relationsPropertyTab.removeRelation.removeAllDefaultButton.title"}),isRed:!0,onClick:()=>{Y(void 0)}})]})})}})})]}),children:[h&&(0,tt.jsx)(eo,{propertyName:F||V,inversePropertyName:(null==O?void 0:O.inverseName)||D,newDesign:!1}),x&&(0,tt.jsx)(On,{propertyName:F||V}),!E&&(0,tt.jsx)("div",{style:oe.useExistingTitle,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Use an existing relation",id:"database.viewSettings.relationsPropertyTab.useExistingRelation.title"})}),T.length>0&&!E?(0,tt.jsx)("div",{style:{paddingBottom:"6px"},children:(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)($e.ZP,{buttonPopupStore:W,render:e=>{let t;return t=c.isPhone?{menuType:Zo.og.ActionSheet}:{menuType:Zo.og.Popup,width:300},(0,tt.jsx)(Ye.Z,{...t,footer:(0,tt.jsx)(Do.Z,{schema:C,format:w,getProperties:U,onAccept:M.canConfigureBlock&&!M.canConfigureCollection?Q:()=>{},inputPlaceholder:Wo.default.formatMessage(h?Rn.subitemInputPlaceholder:Rn.timelineArrowsByInputPlaceholder),currentProperty:j,defaultShowPropertyCount:5,renderProperty:M.canConfigureBlock&&!M.canConfigureCollection?void 0:re})})},renderOrigin:e=>{var t;return(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.existingRelation",defaultMessage:"Property"}),showChevron:!0,right:j?null===(t=C[j])||void 0===t?void 0:t.name:void 0,rotateChevron:L.open,disabled:!1,icon:H.v,...e})},popupType:c.isPhone?Yo.kQ.SlideUp:Yo.kQ.Popup,alignmentToOrigin:$e.vR.End,placementToOrigin:$e.pO.Bottom,originGap:0})})}):ie&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)("div",{style:oe.emptyStateText,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Rename (optional)",id:"database.viewSettings.relationsPropertyTab.emptyStateDescription"})})}),(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(we.ZP,{value:F,placeholder:F,onChange:e=>B(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,tt.jsx)(Dn.Z,{collectionContextStore:o,targetCollectionStore:b,property:void 0,buttonContents:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Create",id:"database.viewSettings.relationsPropertyTab.createButton.title"}),temporaryInverseState:O,setTemporaryInverseState:R,isInitialPropertyName:I,onSubmit:J,from:a}),T.length>0&&(0,tt.jsx)("div",{style:{margin:"auto",textAlign:"center"},children:(0,tt.jsx)(Kn.Z,{onClick:()=>{Kt.default.afterNextFlush((()=>{G(!1)}))},isGray:!0,style:{margin:"6px 12px 6px 12px",width:"auto"},children:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.relationsPropertyTab.newRelation",defaultMessage:"Use existing relation"})})})]})]})}));var Gn=o(89475),Nn=o(98742),Wn=o(30874);function Ln(e){window.__c={n:"CollectionSettingsAccountPicker"};const{integration:t,collectionSettingsStore:o,collectionContextStore:n,onAccountSelect:i}=e,a=(0,S.yK)((()=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"}})),[]),c=(0,r.O7)(),p=(0,s.VK)((()=>{var e;return null===(e=n.collectionStore())||void 0===e?void 0:e.getSpaceId()}),[n]),u=(0,s.VK)((()=>{const e=Wn.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]);return t&&p?(0,tt.jsx)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Choose an account",id:"collectionSettingsAccountPicker.title"}),footer:Un({environment:c,integration:t,spaceId:p}),children:(0,tt.jsx)("div",{style:a.settingsMenu,children:(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,initialFocus:0,sections:[{key:"externalAuthentications",items:u.map((e=>({key:e.id,render:o=>(0,tt.jsx)(Te.ZP,{renderTooltip:()=>(0,tt.jsx)("span",{children:e.account_name}),placement:Te.ug.Left,textWrap:!0,render:n=>(0,tt.jsx)(He.Z,{...(0,Nn.Z)(n||{},o),title:e.account_name,icon:(0,tt.jsx)("img",{style:{width:18},src:t.info.icon}),focused:o.focused})}),action:()=>{d.z$({collectionSettingsStore:o}),i(e)}}))),render:e=>(0,tt.jsx)(_e.Z,{...e})}]})})}):null}function Un(e){const t=e.environment.device.isMobileBrowser;return(0,tt.jsx)(_e.Z,{topBorder:!0,children:t?void 0:zn(e)})}function zn(e){return(0,tt.jsx)(be.Z,{...e,icon:A.R,title:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsAccountPicker.addAccount",defaultMessage:"Connect another account"}),isGray:!0,onClick:async()=>{await Gn.hM({...e,from:"source_picker_connect_another_account"})}})}var Hn=o(8848),$n=o(58573),qn=o(59054),Yn=o(20270),Qn=o(35840),Xn=o(64002),Jn=o(57549),ei=o(54642),ti=o(893),oi=o(12170),ni=o(70764),ii=o(75079);function ri(e){window.__c={n:"CollectionSettingsAccountSelectionIndicator"};const{onClick:t,integration:o,accountName:n}=e,i=(0,S.yK)((e=>({accountSelection:{padding:"8px",borderTop:`1px solid ${e.regularDividerColor}`,cursor:"pointer"},accountSelectionLabel:{fontWeight:ie.Z.fontWeight.medium,paddingLeft:4,paddingTop:4}})),[]);return(0,tt.jsx)("div",{style:i.accountSelection,children:(0,tt.jsxs)("div",{onClick:t,children:[(0,tt.jsx)(Xt.Z,{isSecondaryColor:!0,isSmall:!0,style:i.accountSelectionLabel,children:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.currentAccountSection.label",defaultMessage:"Connected to {integration}",values:{integration:o.name}})}),(0,tt.jsx)(Te.ZP,{renderTooltip:()=>(0,tt.jsx)("span",{children:n}),placement:Te.ug.Left,textWrap:!0,render:t=>(0,tt.jsx)(He.Z,{showExtensionArrow:!0,focused:!1,...(0,Nn.Z)(t||{},e),title:n,icon:(0,tt.jsx)("img",{style:{width:18},src:o.info.icon})})})]})})}var si=o(29109),ai=o(1634),li=o(31278);function ci(e){window.__c={n:"CollectionSettingsExternalAuthentication"};const{collectionContextStore:t,integration:o}=e,n=(0,S.Fg)(),i=(0,s.VK)((()=>t.collectionStore()),[t]),a=(0,s.VK)((()=>null==i?void 0:i.getIcon()),[i]),c=(0,r.O7)(),d=(0,s.VK)((()=>{var e;return null===(e=Be.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),p=(0,S.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px 16px 16px 8px"},authenticationBody:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",padding:"0px 16px 16px 16px",textAlign:"center"},settingsMenuSubHeading:{display:"inline",fontSize:14,margin:"4px 20px 20px 20px",color:e.mediumTextColor,textAlign:"center"},settingsMenuAuthenticationButton:{fontSize:14,height:32,color:e.regularInvertedTextColor}})),[]),{background:u,hoveredBackground:g,pressedBackground:m}=(0,si.d)(o,n.mode);return(0,tt.jsx)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateHeader.title",values:{integration:o.name}}),children:(0,tt.jsx)("div",{style:p.settingsMenu,children:(0,tt.jsxs)("div",{style:p.authenticationBody,children:[(0,tt.jsx)(li.Z,{disabled:!0,bucket:"secure",store:i,icon:a,size:40,isEmptyPage:!1,style:{marginBottom:6}}),(0,tt.jsx)("div",{style:p.settingsMenuSubHeading,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Link your {integration} account for richer content previews and seamless imports.",id:"collectionSettingsCreateExternalViewPicker.authenticateBody.title",values:{integration:o.name}})}),(0,tt.jsx)(Kn.Z,{onClick:()=>{d&&(Gn.hM({environment:c,integration:o,spaceId:d,from:"placeholder_root_external_collection_view_block"}),ai.Z.reset())},style:{background:u,...p.settingsMenuAuthenticationButton},hoveredStyle:{background:g},pressedStyle:{background:m},children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Connect to {integration}",id:"collectionSettingsCreateExternalViewPicker.authenticateButton.title",values:{integration:o.name}})})]})})})}var di=o(33338),pi=o(68785),ui=o(53336);function gi(e){window.__c={n:"CollectionSettingsCreateExternalViewPicker"};const{collectionSettingsStore:t,collectionContextStore:o,externalAuthentication:n}=e,i=(0,s.VK)((()=>o.collectionStore()),[o]),r=(0,s.VK)((()=>{if(!i)return;const e=i.getFormat().integration_id;return Wn.Z.integrations.state.find((t=>t.id===e))}),[i]),a=(0,s.VK)((()=>!!r&&(0,ni.NP)(r.id).length>0),[r]),l=(0,s.VK)((()=>{var e;return null===(e=Be.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]);return i&&l&&r?(0,tt.jsx)(tt.Fragment,{children:a?(0,tt.jsx)(fi,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:r,externalAuthentication:n}):(0,tt.jsx)(ci,{...e,collectionContextStore:o,collectionSettingsStore:t,integration:r})}):null}const mi=e=>{var t;return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((e=>{var t;return null===(t=e.additional_types)||void 0===t?void 0:t.collection})).find((t=>{let{regex:o}=t;return new RegExp(o).test(e.url)}))},Si=(0,l.defineMessages)({all:{id:"collectionSettingsCreateExternalViewPicker.filters.all",defaultMessage:"All"},issues:{id:"collectionSettingsCreateExternalViewPicker.filters.issues",defaultMessage:"Issues"},pull_requests:{id:"collectionSettingsCreateExternalViewPicker.filters.pullRequests",defaultMessage:"Pull Requests"},board:{id:"collectionSettingsCreateExternalViewPicker.filters.boards",defaultMessage:"Boards"},project:{id:"collectionSettingsCreateExternalViewPicker.filters.projects",defaultMessage:"Projects"},Releases:{id:"collectionSettingsCreateExternalViewPicker.filters.releases",defaultMessage:"Releases"},"Pull Request":{id:"collectionSettingsCreateExternalViewPicker.filters.PullRequests",defaultMessage:"Pull Requests"},Issues:{id:"collectionSettingsCreateExternalViewPicker.filters.Issues",defaultMessage:"Issues"}});function fi(e){window.__c={n:"CollectionSettingsSourceSelection"};const{integration:t,collectionContextStore:o,collectionSettingsStore:i,externalAuthentication:a}=e,[c,p]=(0,n.useState)(""),u=(0,s.VK)((()=>{const e=Wn.Z.state;return e.loaded?e.externalAuthentications.filter((e=>e.integration_id===t.id)):[]}),[t]),g=(0,s.VK)((()=>a||(u.length?u[0]:null)),[u,a]),[m,f]=(0,n.useState)(!1),[y,h]=(0,n.useState)(null),x=(0,S.yK)((e=>({settingsMenu:{display:"flex",flexGrow:1,flexDirection:"column",padding:"8px"},settingsMenuSearchBox:{background:e.contentBackground,marginBottom:10},syncSourceButton:{width:"100%",display:"flex",justifyContent:"center"},noResults:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},suggestionBox:{display:"flex",alignItems:"center",fontSize:12,color:Hn.ZP.white,background:Hn.ZP.blue,borderRadius:6,padding:10,boxShadow:e.largeLightBoxShadow,alignSelf:"center",maxWidth:"80%"},errorMessage:{alignSelf:"center",padding:10,fontSize:14,color:e.errorText},syncingData:{width:"100%",paddingBottom:10,display:"flex",justifyContent:"center",fontSize:14,color:e.mediumTextColor},filterContainer:{position:"relative",flexGrow:0,overflow:"hidden"},filterContainerScroller:{display:"flex",alignItems:"center",padding:"8px 12px"}})),[]),v=(0,s.VK)((()=>o.collectionStore()),[o]),C=(0,s.VK)((()=>o.collectionViewBlockStore()),[o]),b=(0,r.O7)(),[{value:w,status:j}]=(0,qn.r5)((async()=>{if(!g)return;const e=g.parent_id;return ei.listExternalCollections(b,{bot_id:e})}),[b,g]),_="success"===(null==w?void 0:w.type)&&"data"in w.data?w.data.data:[],M="success"===(null==w?void 0:w.type)&&"error"in w.data?w.data.error:null,T=_.filter((e=>!y||e.type===y)),k=T.length?(0,$n.ZP)(c,T,(e=>e.title)):[],P=Array.from(new Set(_.map((e=>e.type)))),V=mi({integration:t,url:c}),F=async e=>{if(f(!0),!v||!C)return;const n=e||c,r=mi({integration:t,url:n});if(!r)return f(!1),void Fo.showDialog({items:[{label:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.copyDebuggingInformation",defaultMessage:"Copy debugging information"}),color:"blue",onAccept:()=>{ti.RD({environment:b,stringValue:JSON.stringify({botId:null==g?void 0:g.parent_id,url:n},null,2),copiedMessage:ti.tq.copiedToClipboard})}},{label:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.closeButton",defaultMessage:"Close"}),onAccept:()=>{}}],showCancel:!1,keepFocus:!1,message:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.unsupportedUrlErrorDialog.title",defaultMessage:"This source is currently not supported. Please try a different source."})});const s=(0,ni.NP)(t.id);await oi.UY({environment:b,url:n,botIds:s.map((e=>e.id)),externalCollectionStore:v,externalCollectionViewBlockStore:C});const{host:a}=(0,Xn.Qc)(n);Jn.Mp(b,{...(0,ii.Pn)(o),integrationId:t.id,type:"collection",entity:r.name,domain:a||"",from:"external_picker_settings"}),d.wl({collectionSettingsStore:i,item:{type:"shareSyncedView",integrationName:t.name,integrationIcon:t.info.icon}}),f(!1)};if(!v||!C)return null;const A=P.length>1?(0,tt.jsx)("div",{style:x.filterContainer,children:(0,tt.jsxs)(ui.Z,{type:Bt.Z.X,style:x.filterContainerScroller,showLeftRightOverlay:!1,children:[(0,tt.jsx)(di.Z,{title:(0,tt.jsx)("span",{children:Wo.default.formatMessage(Si.all)}),on:!(0,ne.K0)(y),hideChevron:!0,onClick:e=>{(0,At.ZP)({event:e,context:At.Af.CollectionSettingsClick,callback:()=>{h(null)}})}},"all"),P.map((e=>(0,tt.jsx)(di.Z,{title:(0,tt.jsx)("span",{children:Wo.default.formatMessage(Si[e])}),on:y===e,hideChevron:!0,onClick:t=>{(0,At.ZP)({event:t,context:At.Af.CollectionSettingsClick,callback:()=>{h((t=>t===e?null:e))}})}},e)))]})}):null,B=V?(0,tt.jsx)("div",{style:x.syncSourceButton,children:(0,tt.jsx)(Bo.Z,{isLarge:!0,onClick:e=>{(0,At.ZP)({event:e,context:At.Af.CollectionSettingsClick,callback:()=>{F()}})},disabled:!1,children:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.syncSourceButton.label",defaultMessage:"Sync Source"})})}):null,I=V||_.length&&k.length?null:(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{style:x.noResults,children:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.noResults.text",defaultMessage:"No results"})}),(0,tt.jsxs)("div",{style:x.suggestionBox,children:[(0,Et.D)({marginRight:8,width:14,height:14}),(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Try different search or paste any {integration} URL",id:"collectionSettingsCreateExternalViewPicker.noResults.help",values:{integration:t.name}})]})]}),Z=_.length&&k.length?(0,tt.jsx)(tt.Fragment,{children:(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,initialFocus:0,sections:[{key:"collections",items:k.map((e=>({key:e.url,render:t=>(0,tt.jsx)(Te.ZP,{renderTooltip:()=>(0,tt.jsx)("span",{children:e.title}),placement:Te.ug.Left,textWrap:!0,render:o=>(0,tt.jsx)(He.Z,{...(0,Nn.Z)(o||{},t),title:e.title,icon:(0,tt.jsx)("img",{style:{width:18},src:e.icon}),caption:e.parent.title})}),action:t=>{"stopPropagation"in t.event&&t.event.stopPropagation(),F(e.url)}}))),render:e=>(0,tt.jsx)(_e.Z,{...e,disableMobilePadding:!0})}]})}):null,D="pending"===j||"idle"===j||m;if(!g||M&&(M.status===Yn.mQ.UNAUTHORIZED||M.status===Yn.mQ.FORBIDDEN))return(0,tt.jsx)(ci,{collectionContextStore:o,collectionSettingsStore:i,integration:t});const K="rejected"===j||"failed"===(null==w?void 0:w.type)||M,O=(0,tt.jsx)(ri,{onClick:()=>{d.H4({collectionSettingsStore:i,item:{type:"selectAccountForExternalSource",integration:t,onAccountSelect:e=>{d.H4({collectionSettingsStore:i,item:{type:"createSyncedViewSource",externalAuthentication:e}})}}})},integration:t,accountName:g.account_name});return(0,tt.jsx)(Ce.ZP,{...e,footer:B||m?null:O,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Select from {integration}",id:"collectionSettingsCreateExternalViewPicker.title",values:{integration:t.name}}),header:!D&&"resolved"===j&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(we.ZP,{inputLeft:(0,tt.jsx)(we.f_,{icon:Qn.R}),onSubmit:()=>{V&&F()},style:x.settingsMenuSearchBox,focusInitial:!0,value:c,onChange:e=>{p(e.target.value)},placeholder:"Search source or paste a link..."}),V?null:A]}),children:(0,tt.jsxs)("div",{style:x.settingsMenu,children:[K&&(0,tt.jsx)("div",{style:x.errorMessage,children:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.error.unknown",defaultMessage:"Something went wrong.",values:{integration:t.name}})}),D&&(m?(0,tt.jsxs)("div",{style:x.syncingData,children:[(0,tt.jsx)("span",{children:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.settingUpSync",defaultMessage:"Setting up sync..."})}),(0,tt.jsx)(pi.Z,{style:{alignSelf:"center"}})]}):(0,tt.jsxs)("div",{style:x.syncingData,children:[(0,tt.jsx)("span",{children:(0,tt.jsx)(l.FormattedMessage,{id:"collectionSettingsCreateExternalViewPicker.loadingData",defaultMessage:"Loading available sources..."})}),(0,tt.jsx)(pi.Z,{style:{alignSelf:"center"}})]})),!D&&"resolved"===j&&(0,tt.jsxs)(tt.Fragment,{children:[B,I,Z]})]})})}var yi=o(26263),hi=o(49085),xi=o(92996),vi=o(93108),Ci=o(38715),bi=o(51592),wi=o(26122);function ji(e){window.__c={n:"CollectionSettingsCreateTypedDB"};const t=(0,S.Fg)(),o=(0,r.O7)(),i=o.device,[a,c]=(0,n.useState)(xi.br),[p,g]=(0,n.useState)(),m=(0,n.useMemo)((()=>hi.default.createValue("")),[]),f=(0,n.useMemo)((()=>new yi.Z({name:"CollectionSettingsCreateTypedDB"})),[]),y=(0,s.VK)((()=>{const t=e.collectionContextStore.collectionStore();if(t)return t.clone(f).getIcon()}),[e.collectionContextStore,f]);(0,n.useEffect)((()=>{var t;void 0===p&&g(null===(t=e.collectionContextStore.collectionViewStore())||void 0===t?void 0:t.getType())}),[e.collectionContextStore,p]),(0,n.useEffect)((()=>{const e=o.defaultRecordCache.inMemoryRecordCache;return e.addCacheOverride(f),()=>{e.removeCacheOverride(f)}}),[o,f,e.collectionContextStore]);const h=(0,n.useCallback)((e=>{m.setState(e)}),[m]),x=(0,n.useCallback)(((t,n)=>{const{collectionContextStore:i}=e,r=i.collectionViewStore(),s=i.collectionViewBlockStore();r&&s&&d.nr({environment:o,baseViewType:p,selectedDBType:n,collectionName:m.state,collectionContextStore:i,collectionViewBlockStore:s,collectionViewStore:r,useTemporaryRecordCache:t,temporaryRecordCache:f})}),[e,p,o,m,f]);(0,n.useEffect)((()=>{x(!0,xi.br)}),[x]);const v=(0,n.useCallback)((t=>{const{collectionContextStore:o}=e;c(t),x(!0,t),Vo.Ip({collectionContextStore:o})}),[e,x]);const C=(0,n.useCallback)((t=>{var n;const i=null===(n=e.collectionContextStore.collectionStore())||void 0===n?void 0:n.getIconStore().clone(f);i&&u.createAndCommit({userAction:"SpacePermissionGroup.handleIconChange",environment:o,perform:e=>{Ao.sO({store:i,value:t,transaction:e})}})}),[e.collectionContextStore,o,f]),b=(0,n.useCallback)((t=>{(0,At.ZP)({event:t,context:At.Af.CollectionSettingsClick,callback:()=>{const{collectionSettingsStore:t}=e;Fo.showDialog({message:(0,tt.jsx)("span",{children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Would you like to continue creating this database?",id:"collectionSettingsNewDatabase.confirmDialog.prompt"})}),showCancel:!1,keepFocus:!1,items:[{label:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Yes create {selectedType, select, untyped {an {type}} other {a {type}}} database",values:{selectedType:a,type:a===xi.br?"empty":(0,bi.Mn)(a)},id:"collectionSettingsNewDatabase.confirmDialog.affirmativeButton.label"}),color:"red",onAccept:()=>{x(!1,a),d.E3({collectionSettingsStore:t})}},{label:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Cancel",id:"collectionSettingsNewDatabase.confirmDialog.cancel.label"}),color:"blue",onAccept:()=>{}}]})}})}),[e,a,x]),w=(0,n.useCallback)((()=>{o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(f);const{collectionContextStore:t,collectionSettingsStore:n}=e,i=t.collectionViewBlockStore(),r=t.collectionViewStore();void 0!==i&&void 0!==r&&(t.setContext({type:"collectionView",collectionViewBlockStore:i,collectionStore:void 0,collectionViewStore:r}),d.H4({collectionSettingsStore:n,item:{type:"createViewSource"}}))}),[o,e,f]);return(0,tt.jsxs)(Ce.ZP,{...e,handleClose:b,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"New database",id:"database.viewSettings.createTypedDBTab.title"}),footer:(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[(0,tt.jsx)(be.Z,{icon:vi.p,isGray:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"View an existing database",id:"database.viewSettings.createTypedDBTab.viewExistingDatabaseButton"}),onClick:w}),(0,tt.jsx)(be.Z,{icon:Ci.N,isGray:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Import or sync from",id:"database.viewSettings.createTypedDB.importDatabaseButton"})})]}),children:[(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(wi.Z,{initialValue:"",placeholder:(0,bi.Mn)(a),inputStore:m,onBlur:h,onSubmit:h,iconButton:{icon:e=>(0,tt.jsx)(li.Z,{isEmptyPage:!0,disabled:!0,defaultIcon:(0,xi.T)(a)({width:16,height:16,backfaceVisibility:void 0,marginRight:6}),icon:y,size:16}),onSubmit:C,includeEmojiTab:!0}})}),(0,tt.jsxs)("div",{style:{...!i.isMobile&&{width:"100%",paddingLeft:8,paddingRight:8},...i.isMobile&&{background:t.contentBackground,width:"100%",paddingTop:12,paddingBottom:12}},children:[(0,tt.jsx)("div",{style:{display:"flex",flexFlow:"wrap",justifyContent:"center"},children:xi.Cr[xi.TM].map((function(e){return(0,tt.jsx)(_i,{dbType:e,isCurrentType:a===e,onClick:()=>v(e)})}))}),(0,tt.jsx)(Bo.Z,{style:{display:"flex",margin:"14px",height:32},onClick:function(){const{collectionSettingsStore:t}=e;x(!1,a),d.E3({collectionSettingsStore:t})},children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Create database",id:"database.viewSettings.createTypedDB.createDatabase"})})]})]})}function _i(e){window.__c={n:"CollectionSettingsTypedDBButton"};const{dbType:t,onClick:o,isCurrentType:n}=e,i=(0,S.Fg)();return(0,tt.jsxs)(rt.Z,{style:{display:"flex",width:"95%",height:45,flexGrow:0,flexShrink:0,fontSize:11,borderRadius:4,margin:6,padding:6,boxShadow:`0 0 0 1px ${i.regularDividerColor}`,color:i.mediumTextColor,fill:i.mediumTextColor,...n&&{boxShadow:`0 0 0 2px ${i.blueColor}`,color:i.blueColor,fill:i.blueColor,fontWeight:500}},disabled:n,onClick:o,children:[(0,tt.jsx)("div",{children:(0,xi.T)(t)({...n&&{fill:i.blueColor,color:i.blueColor},width:17,height:17,marginBottom:4,marginTop:4,marginLeft:4})}),(0,tt.jsxs)("div",{style:{position:"relative",width:"100%",marginLeft:12},children:[(0,tt.jsx)("span",{style:{position:"absolute",fontSize:13,fontWeight:500},children:(0,bi.Mn)(t)}),(0,tt.jsx)("span",{style:{position:"absolute",top:15,fontSize:12,marginTop:1},children:(0,tt.jsx)(l.FormattedMessage,{...xi.LI[t].caption})})]})]})}var Mi=o(79362),Ti=o(23877),ki=o(92165),Pi=o(80881),Vi=o(44643),Fi=o(6637),Ai=o(89036),Bi=o(93644),Ii=o(87990),Zi=o(13495),Di=o(27714),Ki=o(90199),Oi=o(62208),Ri=o(12677),Ei=o(84199),Gi=o(94110),Ni=o(33507),Wi=o(37888),Li=o(58188),Ui=o(72711),zi=o(28020),Hi=o(95697),$i=o(96367),qi=o(149),Yi=o(21202),Qi=o(39927),Xi=o(68305),Ji=o(36821);function er(e){var t;const{collectionContextStore:o}=e,i=(0,r.O7)(),a=(0,s.VK)((()=>o.sprintSettingsContextStore.state),[o.sprintSettingsContextStore]),l=(0,s.VK)((()=>null==a?void 0:a.permissionsContext),[a]),c=(0,s.VK)((()=>{var e;return"active"===(null==a||null===(e=a.automationContext)||void 0===e?void 0:e.automationStore.getStatus())}),[null==a||null===(t=a.automationContext)||void 0===t?void 0:t.automationStore]),d=(0,s.VK)((()=>{var e;return o.collectionStore()===(null==a?void 0:a.taskCollectionStore)&&(null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri)!==xi.g3}),[o,null==a?void 0:a.taskCollectionStore]),[p,g]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){if(g(void 0),!a)return;const{sprintCollectionViewBlockStore:e,sprintCollectionStore:t}=a;if(!e||!t)return;const o=t.getSchema(),n=$i.qB[xi.p$].current.reducer,r=await Xi.tA(i,{source:"automation",parentRecordStore:e,collectionPointer:t.getSpaceShardedPointer(),filter:n.getCombinatorFilter(o),limit:1});qi.x.isFail(r)||g(r.value.blockIds[0])}()}),[i,a]);const m=(0,s.VK)((()=>{const e=null==a?void 0:a.sprintCollectionViewBlockStore;if(e&&p)return Ze.G.createChildStore(e,{id:p,table:Yi.iU,spaceId:e.getSpaceId()})}),[p,null==a?void 0:a.sprintCollectionViewBlockStore]),S=(0,s.VK)((()=>{var e,t,o;if(!a)return;const n=(null===(e=a.automationContext)||void 0===e||null===(e=e.automationActionStore.getConfig())||void 0===e?void 0:e.complete_sprint_action)??Qi.i.actionConfig.complete_sprint_action,i="active"===(null===(t=a.automationContext)||void 0===t?void 0:t.automationStore.getStatus()),r=null===(o=a.automationContext)||void 0===o?void 0:o.automationStore.getRecurrence();return{autoCompleteSprints:i,actionConfig:{complete_sprint_action:n},recurrenceConfig:{interval:(null==r?void 0:r.interval)??Qi.i.recurrenceConfig.interval,weekdays:(null==r?void 0:r.weekdays)??Qi.i.recurrenceConfig.weekdays}}}),[a]),f=(0,s.VK)((()=>(0,ne.$K)(m)&&(0,ne.$K)(S)),[m,S]),y=n.useCallback((e=>{f&&u.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&m&&Ji.KV({environment:i,transaction:t,automationStore:a.automationContext.automationStore,currentSprintBlockStore:m,newDuration:e})}})}),[f,m,i,a]),h=n.useCallback((e=>{f&&u.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&m&&Ji.g9({environment:i,transaction:t,automationStore:a.automationContext.automationStore,currentSprintBlockStore:m,newWeekday:e})}})}),[f,m,i,a]),x=n.useCallback((e=>{f&&u.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&m&&Ji.jc({environment:i,transaction:t,automationStore:a.automationContext.automationStore,actionStore:a.automationContext.automationActionStore,currentSprintBlockStore:m,newAutocompleteStatus:e})}})}),[f,m,i,a]),v=n.useCallback((e=>{f&&u.createAndCommit({userAction:"useSprintSettings.updateSprintSettingsConfig",environment:i,perform:t=>{a&&a.sprintCollectionStore&&a.automationContext&&Ji.U6({transaction:t,actionStore:a.automationContext.automationActionStore,newRemainingTasksBehavior:e})}})}),[f,i,a]),C=n.useCallback((async()=>{await Ji.ys({environment:i,collectionContextStore:o})}),[o,i]),b=n.useCallback((async e=>{a&&await Ji.m8({environment:i,collectionContextStore:o,sprintSettingsContext:a,sprintBoardViewBlockIds:e})}),[o,i,a]),w=n.useCallback((()=>{a&&Ji.YD({environment:i,collectionContextStore:o})}),[o,i,a]);return{sprintSettingsConfig:S,sprintSettingsPermissionsContext:l,turnOnSprints:C,turnOffSprints:b,automaticSprintCompletionEnabled:c,canManageSprintFromThisView:d,manageSprintFromThisView:w,sprintSettingsConfigUpdater:{canUpdateSprintSettingsConfig:f,handleSprintDurationChange:y,handleSprintStartWeekdayChange:h,handleSprintAutoCompleteChange:x,handleSprintRemainingTasksBehaviorChange:v}}}var tr=o(30806),or=o(5933),nr=o(52489);function ir(e){window.__c={n:"CollectionContentOnlyEditorEducationPill"};const{style:t}=e,o=(0,S.Fg)(),n=(0,r.MO)(),i=(0,tt.jsx)("div",{style:{marginTop:1},children:(0,Ki.b)({width:14,marginRight:8,height:void 0})}),s=(0,tt.jsx)(Xt.Z,{style:{color:o.regularTextColor,lineHeight:ie.Z.lineHeight.UISmall.desktop},isSmall:!0,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"You're a content editor",id:"database.viewSettings.mainTab.contentOnlyEditorPill.title"})});return(0,tt.jsx)(Qt,{icon:i,title:s,style:n?{backgroundColor:o.sidebarBackground,boxShadow:o.plainButtonBoxShadow,margin:void 0,borderRadius:void 0,...t}:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",...t},showCloseButton:!1,children:(0,tt.jsx)(Xt.Z,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"})})})}var rr=o(66864),sr=o(9956),ar=o(40745),lr=o(13709);const cr=function(e){let{collectionContextStore:t}=e;window.__c={n:"CollectionSettingsFirstLoadLimit"};const o=(0,r.O7)(),n=(0,s.VK)((()=>t.normalizedFormatStore.state),[t]),i=(0,s.VK)((()=>t.isFullScreen.state),[t]),a=(0,s.VK)((()=>function(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}(t)),[t]),c=(0,s.VK)((()=>function(e){const t=e.normalizedFormatStore.state;return(0,No.rx)(t.inline_collection_first_load_limit,Boolean(t.collection_group_by))}(t)),[t]),d=(0,s.VK)((()=>t.permissionScopes.state),[t]);return n.collection_group_by||!i&&"calendar"!==a?(0,tt.jsx)(lr.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Load limit",id:"database.viewSettings.layoutTab.firstLoadLimitSetting"}),selectedKey:c,popupStyle:{minWidth:190},options:No.jk.map((e=>({key:e,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{limit} pages",values:{limit:e.limit},id:"database.viewSettings.layoutTab.limitPagesTitle"})}))),onChange:e=>function(e,t,o){const n=o.collectionViewStore();if(!n)return;u.createAndCommit({userAction:"CollectionSettingsFirstLoadLimit.handleFirstLoadLimitChange",environment:t,perform:t=>{p.FH({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),o.groupsStore.resetAllLimits(),ko.wd({environment:t,collectionContextStore:o,action:"set_first_load_limit"})}(e,o,t),disabled:!d.canConfigureBlock,icon:ar.M}):null};var dr=o(35011),pr=o(14714),ur=o(49865),gr=o(92918),mr=o(18514),Sr=o(26055),fr=o(75498),yr=o(21269),hr=o(79131),xr=o(5145),vr=o(28992),Cr=o(97820);class br extends i.Z{constructor(){super(...arguments),this.storeTypes={reducerResultStore:hi.default.createClass(void 0),groupsLimit:hi.default.createClass(gr.XD)},this.handleHideEmptyGroupsClick=()=>{const{groupByKey:e,collectionContextStore:t,groupsFormatKey:o}=this.props,n=Dr(this.props.collectionContextStore,this.props.groupByKey),i=this.groupsDisplayStateStore.state;if(!i)return;const{currentGroups:r}=i,s=t.collectionViewStore();if(!n||!s)return;const a=!n.hideEmptyGroups;u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:this.environment,perform:i=>{if(a){const e=r.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));ur.A6({collectionContextStore:t,newGroups:e,groupsFormatKey:o,transaction:i})}p.FH({stores:[s],update:{[e]:{...n,hideEmptyGroups:a}},transaction:i})}}),ko.wd({environment:this.environment,collectionContextStore:t,action:"toggle_hide_empty_groups"})},this.handleHideAllClick=()=>{const{collectionContextStore:e,groupsFormatKey:t}=this.props,o=this.groupsDisplayStateStore.state;if(!o)return;const{currentGroups:n}=o,i=n.map((e=>({...e,hidden:!0})));this.stores.groupsLimit.setState(gr.XD),u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:this.environment,perform:o=>{ur.A6({collectionContextStore:e,newGroups:i,groupsFormatKey:t,transaction:o})}}),ko.wd({environment:this.environment,collectionContextStore:e,action:"click_groups_hide_all"})},this.handleShowAllClick=()=>{const{collectionContextStore:e,groupsFormatKey:t}=this.props,o=this.groupsDisplayStateStore.state;if(!o)return;const{currentGroups:n}=o,i=n.map((e=>({...e,hidden:!1})));this.stores.groupsLimit.setState(gr.XD),u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleShowAllClick",environment:this.environment,perform:o=>{ur.A6({collectionContextStore:e,newGroups:i,groupsFormatKey:t,transaction:o})}}),ko.wd({environment:this.environment,collectionContextStore:e,action:"click_groups_show_all"})},this.handleGroupReorder=(e,t)=>{const{collectionContextStore:o,groupsFormatKey:n}=this.props,i=this.groupsDisplayStateStore.state;if(!i)return;const{currentGroups:r}=i,s=r.filter((t=>e.indexOf((0,pr.mD)(t))<0)),a=r.filter((t=>e.indexOf((0,pr.mD)(t))>=0)),l=oo.MR(a,(t=>{const o=e.indexOf((0,pr.mD)(t));return o>=0?o:1/0})),d=t?[...s,...l]:[...l,...s];u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleGroupReorder",environment:this.environment,perform:e=>{ur.A6({collectionContextStore:o,newGroups:d,groupsFormatKey:n,transaction:e})}}),c.wds(this.environment,{view_type:Zr(this.props.collectionContextStore),action:t?"reorder_hidden_groups":"reorder_groups"})},this.handleToggleGroupVisibility=e=>{const{collectionContextStore:t,groupsFormatKey:o}=this.props,n=this.groupsDisplayStateStore.state;if(!n)return;const{currentGroups:i}=n,r=i.map((t=>(0,pr.ZH)(t,e)?{...e,hidden:!(0,pr.eF)(e)}:t));u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupVisibility",environment:this.environment,perform:e=>{ur.A6({collectionContextStore:t,newGroups:r,groupsFormatKey:o,transaction:e})}}),ko.wd({environment:this.environment,collectionContextStore:t,action:"toggle_group_visibility"})},this.reducerStore=this.createComputedStore((()=>{const{collectionContextStore:e,groupsFormatKey:t}=this.props,o=e.normalizedFormatStore.state,n=e.normalizedSchemaStore.state,i=e.remoteRequestStore.state,r=Dr(this.props.collectionContextStore,this.props.groupByKey);if(r)return(0,gr.ej)({groupBy:r,schema:n,format:o,filter:null==i?void 0:i.loader.filter,groupsFormatKey:t,limit:this.stores.groupsLimit.state})})),this.schemaGroupsStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props,t=e.normalizedSchemaStore.state,o=Dr(this.props.collectionContextStore,this.props.groupByKey);if(o)return(0,pr.Qq)({schema:t,groupBy:o})}),!0),this.groupsDisplayStateStore=this.createComputedStore((()=>{var e;const{groupsFormatKey:t,collectionContextStore:o}=this.props,n=o.normalizedFormatStore.state,i=o.normalizedSchemaStore.state,r=o.collectionViewBlockStore(),s=Dr(this.props.collectionContextStore,this.props.groupByKey),a=this.stores.reducerResultStore.state;if(!s||!r||!a)return;const l=this.stores.groupsLimit.state,c=this.schemaGroupsStore.state,d=a.results,p=a?a.total:0,u=(0,gr.Cz)({groupBy:s,schema:i,formatGroups:n[t]||[],schemaGroups:c,reducerResults:d,getRecordModel:r.getRecordModel,relativeVariableResult:o.relativeVariableStore.state,viewAppConfigUri:null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri}),g=u.filter((e=>!(0,pr.eF)(e))).slice(0,l),m=u.filter((e=>(0,pr.eF)(e)));return{currentGroups:[...g,...m],visibleGroups:g,hiddenGroups:m,total:p}}),!0)}renderComponent(){const{collectionContextStore:e,groupByKey:t}=this.props,o=Dr(this.props.collectionContextStore,this.props.groupByKey),n=e.normalizedSchemaStore.state;return(0,tt.jsxs)(Ce.ZP,{...this.props,title:(0,tt.jsx)(Rr,{collectionSettingsStore:this.props.collectionSettingsStore,collectionContextStore:this.props.collectionContextStore}),children:[(0,tt.jsxs)(_e.Z,{children:[(0,tt.jsx)(Er,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore,groupByKey:this.props.groupByKey,groupsFormatKey:this.props.groupsFormatKey,groupBy:o}),o&&Mr({groupBy:o,schema:n})&&(0,tt.jsx)(Nr,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore,groupByKey:this.props.groupByKey,groupsFormatKey:this.props.groupsFormatKey,groupBy:o}),o&&(0,tt.jsx)(Wr,{collectionContextStore:this.props.collectionContextStore,groupByKey:this.props.groupByKey,groupBy:o}),o&&this.renderAutoHideButton(o),o&&"board_columns_by"===t&&(0,tt.jsx)(Gr,{collectionContextStore:this.props.collectionContextStore})]}),o&&this.renderGroupSortListReducer(),(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[o&&Or(this.props.collectionContextStore,this.props.groupByKey)&&(0,tt.jsx)(be.Z,{isGray:!0,icon:ze.y,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,o,n){const i=t.collectionViewStore();if(!i)return;u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,perform:e=>{p.FH({stores:[i],update:{[o]:void 0,[n]:void 0},transaction:e})}}),ko.wd({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(this.environment,this.props.collectionContextStore,this.props.groupByKey,this.props.groupsFormatKey),isRed:!0}),(0,tt.jsx)(yr.Z,{href:(0,mr.UY)("guides.databaseGroup"),title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})}renderAutoHideButton(e){return(0,tt.jsx)(Io.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(e.hideEmptyGroups),focused:!1,onClick:this.handleHideEmptyGroupsClick,disabled:!Kr(this.props.collectionContextStore),textWrapperStyle:{opacity:1}})}renderGroupSortListReducer(){const{groupsFormatKey:e}=this.props,t=this.reducerStore.state,o=this.groupsDisplayStateStore.state;return t?(0,tt.jsx)(fr.Z,{id:`group_menu_${e}`,reducer:t,collectionContextStore:this.props.collectionContextStore,resultStore:this.stores.reducerResultStore,render:()=>this.renderGroupSortListSections(o)}):this.renderGroupSortListSections(o)}renderGroupSortListSections(e){const t=Dr(this.props.collectionContextStore,this.props.groupByKey);if(!t)return;if(!e)return(0,tt.jsx)(_e.Z,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,children:(0,tt.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,tt.jsx)(pi.Z,{})})});const o="manual"===(0,pr.mu)(t).type&&!this.environment.device.isMobile&&Kr(this.props.collectionContextStore),n=this.stores.groupsLimit.state,{total:i,hiddenGroups:r,visibleGroups:s}=e,a=Math.min(gr.kW,i-r.length-s.length),c=a>0?(0,tt.jsx)(He.Z,{disabled:!1,focused:!1,style:{color:this.theme.mediumTextColor},icon:(0,Le.o)({width:14,height:14}),title:(0,tt.jsx)(l.FormattedMessage,{id:"database.groupMenu.loadMoreButton.text",defaultMessage:"Show {loadMoreAmount, plural, one {{loadMoreAmount} more group} other {{loadMoreAmount} more groups}}",values:{loadMoreAmount:a}}),onClick:()=>{this.props.collectionContextStore.isLoading.state||this.props.collectionContextStore.loadingDetails.setState({type:"load_groups_menu"}),this.stores.groupsLimit.setState(n+gr.kW)}}):void 0;return(0,tt.jsxs)(tt.Fragment,{children:[e.visibleGroups.length>0&&(0,tt.jsxs)(_e.Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,tt.jsx)("span",{style:{alignSelf:"center"},children:(0,tt.jsx)(l.FormattedMessage,{id:"database.groupMenu.visibleGroups",defaultMessage:"Visible groups"})}),right:(0,tt.jsx)(Kn.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:this.handleHideAllClick,disabled:!Kr(this.props.collectionContextStore),children:(0,tt.jsx)(l.FormattedMessage,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:[this.renderGroupSortList({displayState:e,groups:e.visibleGroups,canReorder:o,isHidden:!1}),c]}),e.hiddenGroups.length>0&&(0,tt.jsx)(_e.Z,{topBorder:!1,noTextOverflow:!0,isTitleUppercase:!1,title:(0,tt.jsx)(l.FormattedMessage,{id:"database.groupMenu.hiddenGroups",defaultMessage:"Hidden groups"}),right:(0,tt.jsx)(Kn.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:this.handleShowAllClick,disabled:!Kr(this.props.collectionContextStore),children:(0,tt.jsx)(l.FormattedMessage,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"})}),children:this.renderGroupSortList({displayState:e,groups:e.hiddenGroups,canReorder:o,isHidden:!0})})]})}renderGroupSortList(e){const{displayState:t,groups:o,canReorder:i,isHidden:r}=e;return i?(0,tt.jsx)(hr.ZP,{direction:"vertical",keys:o.map((e=>(0,pr.mD)(e))),renderKey:(e,n)=>{const r=o[n];return this.renderGroupSortListItem({displayState:t,groupFormat:r,canReorder:i})},onDrop:e=>{this.handleGroupReorder(e,r)},disabled:!Kr(this.props.collectionContextStore)}):o.map((e=>(0,tt.jsx)(n.Fragment,{children:this.renderGroupSortListItem({displayState:t,groupFormat:e,canReorder:i})},(0,pr.mD)(e))))}renderGroupSortListItem(e){const{collectionContextStore:t}=this.props,{displayState:o,groupFormat:n,canReorder:i}=e,r=t.normalizedSchemaStore.state,s=(0,pr.eF)(n),a=Dr(this.props.collectionContextStore,this.props.groupByKey);if(a)return(0,tt.jsx)(vr.Z,{disabled:!Kr(this.props.collectionContextStore),title:(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[i&&(0,tt.jsx)(xr.ZP,{iconSize:12,style:{marginRight:3}}),(0,tt.jsx)(Sr.Z,{groupBy:a,groupFormat:n,currentGroups:o.currentGroups,schema:r,disabled:!0,isHiddenGroup:!1,style:{padding:0},collectionContextStore:t})]}),right:(0,tt.jsx)(qe.Z,{icon:s?Rt.B:Ot.c,iconStyle:{width:16,height:16},isDarkIconColor:!s,onClick:()=>{this.handleToggleGroupVisibility(n)},disabled:!Kr(this.props.collectionContextStore)}),textWrapperStyle:{opacity:1}})}}function wr(e){return e?(0,tt.jsx)(Cr.Z,{propertySchema:e,showIcon:!1}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.groupTab.noGroupingSetMessage"})}function jr(e,t){return"collection_group_by"===e&&"board"===t?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function _r(e,t){return"manual"===t?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Manual",id:"database.viewSettings.groupTab.sortType.manual"}):"ascending"===t?(0,pr.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Oldest first",id:"database.viewSettings.groupTab.sortType.chronological"}):(0,pr.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.viewSettings.groupTab.sortType.alphabetical"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Ascending",id:"database.viewSettings.groupTab.sortType.ascending"}):"descending"===t?(0,pr.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Newest first",id:"database.viewSettings.groupTab.sortType.reverseChronological"}):(0,pr.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.groupTab.sortType.reverseAlphabetical"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Descending",id:"database.viewSettings.groupTab.sortType.descending"}):void(0,ne.t1)(t)}function Mr(e){const{groupBy:t,schema:o}=e,n=o[t.property];if(!n||!(0,pr.LG)(n))return;let i;if("formula"===n.type){const e=(0,dr.mm)(n);if("unknown"===e||"array"===e)return;i="block"===e?"relation":e}else i=n.type;return(0,pr.A1)(i)||(0,pr.HB)(i)||"number"===i||"status"===i?i:void 0}function Tr(e){const t=Mr(e);if(t)return(0,pr.A1)(t)?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,pr.HB)(t)?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function kr(e){return(0,pr.ib)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function Pr(e){return(0,pr.aB)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function Vr(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function Fr(e){const{groupBy:t}=e,o=Mr(e);if(o)if((0,pr.A1)(o)){const e=kr(t);if(e)return Ar(e.groupBy)}else if((0,pr.HB)(o)){const e=Pr(t);if(e)return Br(e.groupBy)}else if("number"===o){const e=Vr(t);if(e)return(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}function Ar(e){return"relative"===e?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"}):"day"===e?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"}):"week"===e?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"}):"month"===e?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"}):"year"===e?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}):void(0,ne.t1)(e)}function Br(e){return"exact"===e?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,ne.t1)(e)}br.displayName="CollectionSettingsViewGroup";const Ir=(0,l.injectIntl)(br);function Zr(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function Dr(e,t){return e.normalizedFormatStore.state[t]}function Kr(e){return e.permissionScopes.state.canConfigureBlock}function Or(e,t){return Kr(e)&&(0,gr._1)({viewType:Zr(e),groupByKey:t})}function Rr(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"Title"};const n=(0,s.VK)((()=>(0,It.n)(t)),[t]),i=(0,s.VK)((()=>Zr(o)),[o]);return n&&"group"===n.type?"collection_group_by"===n.groupByKey&&"board"===i?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function Er(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:n,groupByKey:i,groupsFormatKey:a}=e;window.__c={n:"PropertyMenuButton"};const l=(0,r.O7)(),c=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),p=t?c[t.property]:void 0,u=(0,s.VK)((()=>Kr(o)),[o]),g=(0,s.VK)((()=>Zr(o)),[o]);return(0,tt.jsx)(be.Z,{title:jr(i,g),showChevron:!0,right:wr(p),onClick:()=>{ko.wd({environment:l,collectionContextStore:o,action:"click_group_by_property",original_view_type:void 0,property_type:null==p?void 0:p.type}),d.H4({collectionSettingsStore:n,item:{type:"groupByProperty",groupByKey:i,groupsFormatKey:a}})},disabled:!u})}function Gr(e){let{collectionContextStore:t}=e;window.__c={n:"ColorColumnsOption"};const o=(0,r.O7)(),n=(0,s.VK)((()=>(0,gr.h6)(o,t)),[o,t]),i=(0,s.VK)((()=>Kr(t)),[t]);return(0,tt.jsx)(Io.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!n,focused:!1,onClick:()=>{d.iN({environment:o,collectionContextStore:t})},disabled:!i,textWrapperStyle:{opacity:1}})}function Nr(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:n,groupByKey:i,groupsFormatKey:a}=e;window.__c={n:"TypeMenuButtonComponent"};const c=(0,r.O7)(),g=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),m=(0,s.VK)((()=>Kr(o)),[o]),S="formula"===t.type?{...t.groupBy,property:t.property}:t;return(0,pr.ib)(S)?(0,tt.jsx)(lr.Z,{title:Tr({groupBy:S,schema:g}),popupStyle:{minWidth:190},selectedKey:S.groupBy,options:pr.z8.map((e=>({key:e,title:Ar(e)}))),onChange:e=>function(e,t,o,n,i){const r=Dr(o,n),s=o.collectionViewStore();if(!r||!s)return;const a=kr(r);if(a){if((0,pr.ib)(r))u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:t=>{p.FH({stores:[s],update:{[n]:{...r,groupBy:e},[i]:void 0},transaction:t})}});else if("formula"===r.type){const o={...oo.CE(a,"property"),type:"date",groupBy:e},l={...r,groupBy:o};u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:e=>{p.FH({stores:[s],update:{[n]:l,[i]:void 0},transaction:e})}})}ko.wd({environment:t,collectionContextStore:o,action:"update_date_group_by"})}}(e,c,o,i,a),disabled:!m}):(0,pr.aB)(S)?(0,tt.jsx)(lr.Z,{title:Tr({groupBy:S,schema:g}),popupStyle:{minWidth:190},selectedKey:S.groupBy,options:pr.Kp.map((e=>({key:e,title:Br(e)}))),onChange:e=>function(e,t,o,n,i){const r=Dr(o,n),s=o.collectionViewStore();if(!r||!s)return;const a=Pr(r);if(a){if((0,pr.aB)(r))u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:t=>{p.FH({stores:[s],update:{[n]:{...r,groupBy:e},[i]:void 0},transaction:t})}});else if("formula"===r.type){const o={...oo.CE(a,"property"),groupBy:e},l={...r,groupBy:o};u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:e=>{p.FH({stores:[s],update:{[n]:l,[i]:void 0},transaction:e})}})}ko.wd({environment:t,collectionContextStore:o,action:"update_text_group_by"})}}(e,c,o,i,a),disabled:!m}):"number"===S.type?(0,tt.jsx)(be.Z,{title:Tr({groupBy:S,schema:g}),showChevron:!0,right:Fr({groupBy:S,schema:g}),onClick:()=>{d.H4({collectionSettingsStore:n,item:{type:"groupByNumber",groupByKey:i,groupsFormatKey:a}})},disabled:!m}):"status"===S.type?(0,tt.jsx)(lr.Z,{title:Tr({groupBy:S,schema:g}),popupStyle:{minWidth:190},selectedKey:S.groupBy,options:pr.vu.map((e=>{return{key:e,title:(t=e,"group"===t?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"}):"option"===t?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}):void(0,ne.t1)(t))};var t})),onChange:e=>function(e,t,o,n,i){const r=Dr(o,n),s=o.collectionViewStore();r&&s&&"status"===(null==r?void 0:r.type)&&(u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,perform:t=>{p.FH({stores:[s],update:{[n]:{...r,groupBy:e},[i]:void 0},transaction:t})}}),ko.wd({environment:t,collectionContextStore:o,action:"update_status_group_by"}))}(e,c,o,i,a),disabled:!m}):null}function Wr(e){let{groupBy:t,collectionContextStore:o,groupByKey:n}=e;window.__c={n:"SortMenuButtonComponent"};const i=(0,r.O7)(),a=(0,s.VK)((()=>(0,pr.YG)(t,!Ie.default.checkGate("collection_properties_select_auto_sort_options"))),[t]),c=(0,s.VK)((()=>Kr(o)),[o]);if(a.length<=1)return null;const d=(0,pr.mu)(t);return(0,tt.jsx)(lr.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:d.type,options:a.map((e=>({key:e,title:_r(t,e)}))),onChange:e=>function(e,t,o,n){const i=Dr(o,n),r=o.collectionViewStore();if(i&&r){if("formula"===i.type){const o={...i,groupBy:{...i.groupBy,sort:{type:e}}};u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:e=>{p.FH({stores:[r],update:{[n]:o},transaction:e})}})}else u.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:t=>{p.FH({stores:[r],update:{[n]:{...i,sort:{type:e}}},transaction:t})}});ko.wd({environment:t,collectionContextStore:o,action:"update_group_sort"})}}(e,i,o,n),disabled:!c})}var Lr=o(5233),Ur=o(13148),zr=o(59960),Hr=o(25888),$r=o(12714),qr=o(91851),Yr=o(94841),Qr=o(83182);const Xr=(0,l.defineMessages)({learn:{id:"CollectionTaskTypeBadge.MoreMenu.LearnMore.title",defaultMessage:"Learn more"}});function Jr(e){window.__c={n:"CollectionTaskTypeBadge"};const t=(0,S.yK)((e=>({homeIcon:{width:13,marginRight:8},badgeTitle:{color:e.regularTextColor,lineHeight:ie.Z.lineHeight.UISmall.desktop,marginRight:5},badgeStyle:{background:"rgba(196, 196, 196, 0.13)",margin:"8px 14px",padding:"12px 14px"}})),[]),{collectionContextStore:o}=e,n=(0,zr.w)(t.homeIcon),i=(0,s.VK)((()=>o.permissionScopes.state.canConfigureCollection),[o]),r=(0,tt.jsx)(Xt.Z,{style:t.badgeTitle,isSmall:!0,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"This is a task database",id:"CollectionTaskTypeBadge.title"})});return(0,tt.jsx)(Qt,{icon:n,title:r,showCloseButton:!1,right:i?(0,tt.jsx)(ts,{collectionContextStore:o}):(0,tt.jsx)(es,{}),style:t.badgeStyle,children:(0,tt.jsx)(Xt.Z,{style:{marginLeft:22},isSmall:!0,isMultiline:!0,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"See your assigned tasks in Home.",id:"CollectionTaskTypeBadge.description"})})})}function es(){window.__c={n:"LearnMore"};const e=(0,l.useIntl)(),t=(0,r.O7)();return(0,tt.jsx)(qe.Z,{icon:P.m,ariaLabel:e.formatMessage(Xr.learn),onClick:()=>{Hr.Fs(t,{from:"view_settings_task_type_badge"}),$r.D({environment:t,url:Yr.h5})}})}function ts(e){window.__c={n:"MoreMenu"};const t=(0,r.O7)(),o=(0,l.useIntl)(),{collectionContextStore:i}=e,s=(0,S.yK)((e=>({buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:24,width:24},threeDotIcon:{width:12,height:12,fill:e.mediumIconColor},hideButtonIcon:{height:17,width:17},confirmationModalTitle:{fontWeight:500},confirmationModalDescription:{fontSize:13,display:"flex",textAlign:"center"}})),[]),a=(0,n.useCallback)((()=>{u.createAndCommit({environment:t,userAction:"CollectionTaskTypeBadge.untypeDatabase",perform:e=>{qr.RQ({environment:t,collectionContextStore:i,transaction:e})}})}),[t,i]),c=(0,tt.jsx)("span",{style:s.confirmationModalDescription,children:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.description",defaultMessage:"Tasks assigned from this database will no longer appear in Home or work with Sprints."})}),d=e=>[{key:"removeFromHome",render:e=>(0,tt.jsx)(He.Z,{...e,icon:(0,Ur.U)(s.hideButtonIcon),title:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.MoreMenu.RemoveFromHome.title",defaultMessage:"Undo task database"})}),action:()=>{const t=[{label:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.confirm",defaultMessage:"Remove"}),color:"red",onAccept:a}];Fo.showDialog({message:(0,tt.jsx)("div",{style:{textAlign:"center"},children:(0,tt.jsx)("span",{style:s.confirmationModalTitle,children:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionTaskTypeBadge.UntypeDatabase.modal.title",defaultMessage:"Undo Task Database?"})})}),description:c,showCancel:!0,keepFocus:!0,items:t}),e.close()}}],p=(0,tt.jsx)(_e.Z,{topBorder:!0,children:(0,tt.jsx)(Qr.Z,{href:Yr.h5,title:o.formatMessage(Xr.learn),analyticsFrom:"view_settings_task_type_badge"})});return(0,tt.jsx)($e.ZP,{popupType:$e.Z4.Popup,alignmentToOrigin:$e.vR.Center,originGap:2,renderOrigin:e=>(0,tt.jsx)(rt.Z,{style:s.buttonStyle,...e,children:(0,Le.o)(s.threeDotIcon)}),render:e=>{const t=[{key:"all",render:e=>(0,tt.jsx)(_e.Z,{...e}),items:d(e)}];return(0,tt.jsxs)(Ye.Z,{menuType:Zo.og.Popup,width:200,children:[(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,sections:t,initialFocus:void 0}),p]})}})}var os=o(1136),ns=o(74420),is=o(76798),rs=o(32662),ss=o(15047),as=o(29369),ls=o(77907);const cs=[1,2,3,4,5,6,7,8],ds={1:{key:"one_week",value:1},2:{key:"two_weeks",value:2},3:{key:"three_weeks",value:3},4:{key:"four_weeks",value:4},5:{key:"five_weeks",value:5},6:{key:"six_weeks",value:6},7:{key:"seven_weeks",value:7},8:{key:"eight_weeks",value:8}},ps={MO:"Monday",TU:"Tuesday",WE:"Wednesday",TH:"Thursday",FR:"Friday",SA:"Saturday",SU:"Sunday"},us=(0,l.defineMessages)({sprintsMenuTitle:{id:"sprintSettingsMenu.label",defaultMessage:"Sprints"},setupSprintsTitle:{id:"sprintSettingsMenu.setupSprints.label",defaultMessage:"Set up sprints"},setupSprintsCaption:{id:"sprintSettingsMenu.setupSprints.caption",defaultMessage:"Use sprints to regularly tackle a group of tasks in a recurring, set amount of time."},setupSprintsTeamspaceStatement:{id:"sprintSettingsMenu.setupSprintsTeamspaceStatement.caption",defaultMessage:"We'll also add to your teamspace:"},setupSprintsSprintBoardPageStatement:{id:"sprintSettingsMenu.setupSprintsSprintBoardPageStatement.caption",defaultMessage:"<bold>Sprint board page</bold>: To manage the tasks in each sprint"},setupSprintsSprintsDatabaseStatement:{id:"sprintSettingsMenu.setupSprintsSprintsDatabaseStatement.caption",defaultMessage:"<bold>Sprints database</bold>: To keep a historical record of sprints"},on:{id:"sprintSettingsMenu.on.label",defaultMessage:"On"},off:{id:"sprintSettingsMenu.off.label",defaultMessage:"Off"},completeSprintNextSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.label",defaultMessage:"Move to next sprint"},completeSprintNextSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToNextSprintOption.selected.label",defaultMessage:"Next sprint"},completeSprintBacklogActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.label",defaultMessage:"Move to backlog"},completeSprintBacklogActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.moveToBacklogOption.selected.label",defaultMessage:"Backlog"},completeSprintKeepInCurrentSprintActionMenuOptionText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.label",defaultMessage:"Keep in current sprint"},completeSprintKeepInCurrentSprintActionSelectedText:{id:"sprintSettingsMenu.remainingTasks.keepInCurrentSprint.selected.label",defaultMessage:"Current sprint"},automatedSprintsToggleTitle:{id:"sprintSettingsMenu.automatedSprintsToggle.label",defaultMessage:"Automated sprints"},automatedSprintsToggleCaption:{id:"sprintSettingsMenu.automatedSprintsToggle.caption",defaultMessage:"Sprints complete automatically before the start of the next sprint."},duration:{id:"sprintSettingsMenu.duration.label",defaultMessage:"Duration"},durationMenuOptionText:{id:"sprintSettingsMenu.duration.option.label",defaultMessage:"{durationValue, plural, one {1 week} other {{durationValue} weeks}}"},startOn:{id:"sprintSettingsMenu.startOn.label",defaultMessage:"Start on"},weekdayOption:{id:"sprintSettings.weekdayOption.label",defaultMessage:"{weekdayName}s"},incompleteTasks:{id:"sprintSettingsMenu.incompleteTasks.label",defaultMessage:"Incomplete tasks"},turnOnSprints:{id:"sprintSettingsMenu.turnOnSprints.button.label",defaultMessage:"Turn on sprints"},turnOffSprints:{id:"sprintSettingsMenu.turnOffSprints.button.label",defaultMessage:"Turn off sprints"},turnOffSprintsModalTitle:{id:"sprintSettingsMenu.turnOffSprints.modal.title.label",defaultMessage:"Turn off sprints?"},turnOffSprintsModalNoSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.default.description",defaultMessage:"This will delete your sprints database and its linked views."},turnOffSprintsModalWithSprintBoardsDescription:{id:"sprintSettingsMenu.turnOffSprints.modal.withSprintBoards.description",defaultMessage:"This will delete your sprint board(s), sprints database and its linked views."},turnOffAndDeleteModalButton:{id:"sprintSettingsMenu.turnOffAndDeleteModal.button.label",defaultMessage:"Turn off and delete"},learnSprintsTitle:{id:"sprintSettingsMenu.learnSprints.button.label",defaultMessage:"Learn about sprints"},manageSprintFromThisView:{id:"sprintSettingsMenu.manageSprintFromThisView.label",defaultMessage:"Manage sprint from this view"},manageSprintFromThisViewModalTitle:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.title.label",defaultMessage:"Manage sprint from this view?"},manageSprintFromThisViewModalButton:{id:"sprintSettingsMenu.manageSprintFromThisView.button.label",defaultMessage:"Update view"},manageSprintFromThisViewModalAutomaticSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.automaticSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint."},manageSprintFromThisViewModalManualSprintCompletionDescription:{id:"sprintSettingsMenu.manageSprintFromThisView.modal.manualSprintCompletion.description",defaultMessage:"The view will be updated with filters for the current sprint and a button to complete sprints will be displayed."}}),gs={complete_sprint_and_move_incomplete_tasks_to_next_sprint:{menuOptionText:us.completeSprintNextSprintActionMenuOptionText,selectedText:us.completeSprintNextSprintActionSelectedText},complete_sprint_and_move_incomplete_tasks_to_backlog:{menuOptionText:us.completeSprintBacklogActionMenuOptionText,selectedText:us.completeSprintBacklogActionSelectedText},complete_sprint:{menuOptionText:us.completeSprintKeepInCurrentSprintActionMenuOptionText,selectedText:us.completeSprintKeepInCurrentSprintActionSelectedText}};function ms(e){return(0,tt.jsx)(l.FormattedMessage,{...gs[e.completeSprintAction].menuOptionText})}function Ss(e){return(0,tt.jsx)(l.FormattedMessage,{...gs[e.completeSprintAction].selectedText})}function fs(e){const{weekday:t}=e;return(0,tt.jsx)(l.FormattedMessage,{...us.weekdayOption,values:{weekdayName:ps[t]}})}function ys(e){return ds[e]}function hs(e){const{sprintDurationValue:t}=e;return(0,tt.jsx)(l.FormattedMessage,{...us.durationMenuOptionText,values:{durationValue:ds[t].value}})}function xs(e){const{numOfSprintBoards:t}=e;return t>0?(0,tt.jsx)(l.FormattedMessage,{...us.turnOffSprintsModalWithSprintBoardsDescription}):(0,tt.jsx)(l.FormattedMessage,{...us.turnOffSprintsModalNoSprintBoardsDescription})}function vs(e){const{automaticSprintCompletionEnabled:t}=e;return t?(0,tt.jsx)(l.FormattedMessage,{...us.manageSprintFromThisViewModalAutomaticSprintCompletionDescription}):(0,tt.jsx)(l.FormattedMessage,{...us.manageSprintFromThisViewModalManualSprintCompletionDescription})}const Cs=(0,l.defineMessages)({viewNamePlaceholderMessage:{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNamePlaceholder.title"},addDescriptionTooltip:{defaultMessage:"Add view description",id:"database.viewSettings.mainTab.addDescriptionTooltip.title"},editDescriptionTooltip:{defaultMessage:"Edit view description",id:"database.viewSettings.mainTab.editDescriptionTooltip.title"}});class bs extends i.Z{constructor(){super(...arguments),this.storeTypes={showViewDescriptionStore:hi.default.createClass(!1)},this.handleViewDescriptionSubmit=e=>{const{collectionContextStore:t,collectionViewStore:o}=this.props,n=null==o?void 0:o.getFormat().description,i=this.environment;o&&e!==n&&(u.createAndCommit({userAction:"CollectionSettingsViewMain.handleDescriptionChange",environment:i,perform:t=>{Vo.iG({collectionViewStore:o,update:{format:{...o.getFormat(),description:e}},transaction:t})}}),ko.wd({environment:i,collectionContextStore:t,action:"set_description"}))},this.shouldRenderTurnIntoTaskStore=this.createComputedStore((()=>{const{device:e}=this.environment,{collectionContextStore:t}=this.props,o=t.collectionStore(),n=t.collectionViewBlockStore(),i=t.collectionViewStore();if(e.isMobile)return!1;if(!o||!n||!i)return!1;if(o.isSyncedCollection())return!1;const r=n.getCollectionViewSourceCollectionStore();return!!t.permissionScopes.state.canConfigureBlock&&((null==r||!r.isTypedCollection())&&void 0!==r)})),this.shouldRenderSourceStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props,t=e.collectionStore(),o=e.collectionViewBlockStore(),n=e.collectionViewStore();if(!t||!o||!n)return!1;if(t.isSyncedCollection())return!0;return void 0===o.getCollectionViewSourceCollectionStore()})),this.isMyTasks=this.createComputedStore((()=>{var e;const{collectionContextStore:t}=this.props,o=null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.id;return o&&(0,zi.qG)(o)}))}renderComponent(){const{device:e}=this.environment,{collectionContextStore:t,collectionViewStore:o,selectViewNameInitial:n}=this.props,i=t.collectionViewBlockStore();if(!o.isDefined()||!i)return;const r=t.permissionScopes.state,s=o.getFormat().collection_view_icon,a=o.getType(),c=o.getAppConfigUri(),d=c&&(0,Zn.xB)(c),p=!this.isMyTasks.state&&!d,g=Ie.default.checkGate("property_descriptions"),m=o.getFormat().description,S=this.stores.showViewDescriptionStore.state,f=(0,tt.jsx)(_e.Z,{title:e.isMobile&&(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"View name",id:"database.viewSettings.mainTab.viewNameSection.title"}),children:(0,tt.jsx)(wi.Z,{initialValue:o.getName()||"",placeholder:Wo.default.formatMessage(Cs.viewNamePlaceholderMessage),onBlur:e=>zs(e,this.environment,this.props.collectionContextStore,o),onSubmit:e=>zs(e,this.environment,this.props.collectionContextStore,o),focusInitial:n,selectAll:n,disabled:!r.canConfigureBlock||!p,iconButton:{icon:e=>(0,tt.jsx)(os.F,{color:"gray",viewIcon:s,viewType:a,style:{marginRight:6}}),iconStyle:{fill:Mi.Lr[this.theme.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;u.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewIconSubmit",environment:e,perform:e=>{Vo.Uy({collectionViewBlockStore:n,icon:o,transaction:e})}}),ko.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(this.environment,this.props.collectionContextStore,e)},inputRightButton:g&&(0,tt.jsx)(rr.l,{description:m,showTooltip:!S,onClick:()=>this.stores.showViewDescriptionStore.setState(!S),addDescriptionText:this.props.intl.formatMessage(Cs.addDescriptionTooltip),editDescriptionText:this.props.intl.formatMessage(Cs.editDescriptionTooltip)})})});return"page"===o.getType()?(0,tt.jsx)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:f}):this.isMyTasks.state&&t.isCompactView.state?(0,tt.jsxs)(tt.Fragment,{children:[t.isEmptyStore.state?null:(0,tt.jsxs)(_e.Z,{children:[(0,tt.jsx)(Rs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Es,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Gs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]}),(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[(0,tt.jsx)(be.Z,{icon:Vi.L,isPadded:!0,title:(0,tt.jsx)(l.FormattedMessage,{id:"PersonalHomePanel.moreDropdown.hide.title",defaultMessage:"Hide from home"}),showChevron:!1,onClick:()=>{Be.default.state.currentSpaceViewStore&&Li.aG({environment:this.environment,currentSpaceViewStore:Be.default.state.currentSpaceViewStore,feature:"tasks",from:"tasks_more_menu"})}}),t.isEmptyStore.state||this.environment.device.isPhone?null:(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(Lr.Z,{from:"home_tile_tasks"}),(0,tt.jsx)(be.Z,{icon:P.m,iconStyle:Hs(this.theme).iconStyles,isPadded:!0,title:(0,tt.jsx)(l.FormattedMessage,{id:"PersonalHomePanel.moreDropdown.dontSee.title",defaultMessage:"Don't see your tasks?"}),textWrapperStyle:Hs(this.theme).menuItemStyles,showChevron:!1,onClick:()=>{or.Z.setState(!0),(0,tr.Aq)({environment:this.environment,from:"home_tile_tasks"})}})]})]})]}):(0,tt.jsxs)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"View options",id:"database.viewSettings.mainTab.title"}),children:[(0,tt.jsx)(ks,{collectionContextStore:this.props.collectionContextStore}),f,g&&S&&(0,tt.jsx)(sr.i,{initialDescription:m,handleSaveDescription:this.handleViewDescriptionSubmit}),e.isMobile?(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[this.renderSource(),(0,tt.jsx)(Os,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Rs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Es,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Gs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Is,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Zs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Ls,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(As,{collectionSettingsStore:this.props.collectionSettingsStore,collectionContextStore:this.props.collectionContextStore}),(0,tt.jsx)(cr,{collectionContextStore:t}),(0,tt.jsx)(Fs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]}):(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsxs)(_e.Z,{children:[this.renderSource(),(0,tt.jsx)(Os,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]}),(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[(0,tt.jsx)(Rs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Es,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Gs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Is,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Zs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Ls,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(As,{collectionSettingsStore:this.props.collectionSettingsStore,collectionContextStore:this.props.collectionContextStore}),(0,tt.jsx)(cr,{collectionContextStore:t}),(0,tt.jsx)(Fs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore})]})]}),(0,Hi.QI)("dev_or_beta")?this.renderTurnIntoTask():void 0,(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[(0,Hi.QI)("dev_or_beta")?(0,tt.jsx)(Bs,{collectionContextStore:this.props.collectionContextStore}):void 0,(0,tt.jsx)($s,{collectionContextStore:this.props.collectionContextStore}),(0,tt.jsx)(qs,{collectionContextStore:this.props.collectionContextStore}),(0,tt.jsx)(Ys,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Qs,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore}),(0,tt.jsx)(Us,{collectionContextStore:this.props.collectionContextStore})]})]})}renderSource(){const{collectionContextStore:e,collectionSettingsStore:t}=this.props,o=e.collectionStore(),n=e.collectionViewBlockStore();if(!o||!n)return;if(!this.shouldRenderSourceStore.state)return;const i=o.getIcon();return(0,tt.jsx)(be.Z,{icon:Ai.v,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.mainTab.sourceButton.title"}),showChevron:!0,right:(0,tt.jsxs)(tt.Fragment,{children:[i&&(0,tt.jsx)(li.Z,{icon:i,isEmptyPage:!1,size:20,disabled:!0,style:{marginRight:4,opacity:.6}}),(0,tt.jsx)(is.Z,{store:o})]}),rightStyle:{flexShrink:1},textWrapperStyle:{flexShrink:0},onClick:()=>{ko.wd({environment:this.environment,collectionContextStore:e,action:"click_source"}),d.H4({collectionSettingsStore:t,item:{type:"source"}})}})}renderTurnIntoTask(){const{collectionContextStore:e}=this.props;if(e.collectionStore()&&this.shouldRenderTurnIntoTaskStore.state)return(0,tt.jsx)(_e.Z,{topBorder:!0,style:{marginLeft:4},children:(0,tt.jsx)(be.Z,{icon:()=>(0,Oi.z)({width:14}),title:(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:4},children:[(0,tt.jsx)("div",{style:ie.Z.textOverflowStyle,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Turn into task database",id:"database.viewSettings.mainTab.turnIntoTask.title"})}),(0,tt.jsx)(ns.Z,{})]}),caption:(0,tt.jsx)("div",{children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"See your assigned tasks in Home, manage tasks in sprints, and more.",id:"database.viewSettings.mainTab.turnIntoTask.caption"})}),shouldWrapCaption:!0,showChevron:!1,onClick:()=>{nr.Z.setState({isModalOpen:!0,databaseType:xi.iS,collectionContextStore:e}),ko.gd({environment:this.environment,database_type:xi.iS,collectionContextStore:e})}})})}}bs.displayName="CollectionSettingsViewMain";const ws=(0,l.injectIntl)(bs);function js(e,t,o){return t?o?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Unlock wiki",id:"action.unlockWikiName.name"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Lock wiki",id:"action.lockWikiName.name"}):e?o?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Unlock database",id:"database.viewSettings.mainTab.unlockDatabase.title"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Lock database",id:"database.viewSettings.mainTab.lockDatabase.title"}):o?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Unlock views",id:"database.viewSettings.mainTab.unlockViews.title"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Lock views",id:"database.viewSettings.mainTab.lockViews.title"})}function _s(e){let t;return t=e?e.supportedInView&&!e.enabledOnView?Ht.dH.relationFeatureHiddenMessage:Ht.dH.relationFeatureOnMessage:Ht.dH.relationFeatureOffMessage,Wo.default.formatMessage(t)}function Ms(e,t){const o=t.permissionScopes.state,n=(0,ne.$K)(e),i=o.canConfigureBlock;return n||i}function Ts(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function ks(e){let{collectionContextStore:t}=e;window.__c={n:"ContentOnlyEditorEducationPill"};return(0,s.VK)((()=>{const e=t.collectionViewBlockStore();return e&&"content_only_editor"!==e.getRole()}),[t])?null:(0,tt.jsx)(ir,{})}function Ps(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"SubitemV2"};const n=(0,s.VK)((()=>o.currentSubitemFormatStore.state),[o]),i=(0,s.VK)((()=>o.databaseType),[o]),r=(0,s.VK)((()=>tn({feature:"subitem",collectionContextStore:o})),[o]),a=(0,s.VK)((()=>Ms(n,o)),[o,n]);return(0,tt.jsx)(be.Z,{icon:Ri.Y,title:(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.Gt)({feature:"subitem",databaseType:i})}),showChevron:!0,right:_s(r),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"subitemV2"}})},disabled:!a})}function Vs(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"ArrowsByV2"};const n=(0,s.VK)((()=>o.currentArrowsByFormatStore.state),[o]),i=(0,s.VK)((()=>o.databaseType),[o]),r=(0,s.VK)((()=>tn({feature:"timeline_arrows_by",collectionContextStore:o})),[o]),a=(0,s.VK)((()=>Ms(n,o)),[o,n]);return(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.Gt)({feature:"timeline_arrows_by",databaseType:i})}),showChevron:!0,icon:Pi.I,right:_s(r),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"dependencies"}})},disabled:!a})}function Fs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"AutomationAction"};const n=(0,s.VK)((()=>(0,Pe.cB)(t)),[t]),i=(0,s.VK)((()=>t.aliveAutomationCount.state),[t]);return n?(0,tt.jsx)(be.Z,{icon:Ne.M,onClick:()=>{i>0?d.H4({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings"}}):(d.H4({collectionSettingsStore:o,item:{source:"collection_view_settings",type:"automationSettings"}}),d.H4({collectionSettingsStore:o,item:{type:"automationCreateSettings"}}))},right:i>0?i:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.mainTab.automations.none",defaultMessage:"None"}),showChevron:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Automations",id:"database.viewSettings.mainTab.automations.title"})}):null}function As(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"SprintSettings"};const n=(0,s.VK)((()=>Ie.default.checkGate("recurring_sprints")),[]),i=(0,s.VK)((()=>{const e=o.databaseType;return n&&(e===xi.iS||e===xi.p$)}),[o,n]),{sprintSettingsPermissionsContext:r}=er({collectionSettingsStore:t,collectionContextStore:o});let a;if(null!=r&&r.canEdit){const e=r.displayStatus;"displayOn"===e?a=(0,tt.jsx)(l.FormattedMessage,{...us.on}):"displayOff"===e?a=(0,tt.jsx)(l.FormattedMessage,{...us.off}):(0,ne.t1)(e)}return i&&a?(0,tt.jsx)(be.Z,{icon:Ni.L,right:a,showChevron:!0,title:(0,tt.jsx)(l.FormattedMessage,{...us.sprintsMenuTitle}),onClick:()=>{d.H4({collectionSettingsStore:t,item:{type:"sprintSettings"}})}}):null}function Bs(e){let{collectionContextStore:t}=e;window.__c={n:"TaskTypeBadgeComponent"};const o=(0,r.Fy)(),n=(0,s.VK)((()=>t.collectionViewBlockStore()),[t]),i=(0,s.VK)((()=>null==n?void 0:n.getRole()),[n]),a=(0,s.VK)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.getDatabaseType()}),[t]);return o.isMobile||a!==xi.iS?null:n&&"content_only_editor"!==i?(0,tt.jsx)(Jr,{collectionContextStore:t}):null}function Is(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"GroupComponent"};const n=(0,r.O7)(),i=(0,s.VK)((()=>Ts(t)),[t]),a="board"===i?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},c=(0,s.VK)((()=>t.normalizedSchemaStore.state),[t]),p=(0,s.VK)((()=>t.normalizedFormatStore.state),[t])[a.groupByKey],u=(0,s.VK)((()=>t.permissionScopes.state),[t]);return"calendar"!==i?(0,tt.jsx)(be.Z,{icon:"board"===i?Bi.b:Ii.q,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.mainTab.groupButton.title"}),showChevron:!0,right:wr(p?c[p.property]:void 0),onClick:()=>{var e;ko.wd({environment:n,collectionContextStore:t,action:"click_group",original_view_type:i,property_type:p?null===(e=c[p.property])||void 0===e?void 0:e.type:void 0}),t.isLoading.state||t.loadingDetails.setState({type:"load_groups_menu"}),d.H4({collectionSettingsStore:o,item:p?{type:"group",...a}:{type:"groupByProperty",...a}})},disabled:!p&&!u.canConfigureBlock}):null}function Zs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"SubGroupComponent"};const n=(0,r.O7)(),i=(0,s.VK)((()=>Ts(t)),[t]),a=(0,s.VK)((()=>t.normalizedSchemaStore.state),[t]),c=(0,s.VK)((()=>t.normalizedFormatStore.state),[t]).collection_group_by,p={groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},u=(0,s.VK)((()=>t.permissionScopes.state),[t]);return"board"===i?(0,tt.jsx)(be.Z,{icon:Ii.q,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.mainTab.subGroupButton.title"}),showChevron:!0,right:wr(c?a[c.property]:void 0),onClick:()=>{var e;ko.wd({environment:n,collectionContextStore:t,action:"click_subgroup",original_view_type:i,property_type:c?null===(e=a[c.property])||void 0===e?void 0:e.type:void 0}),t.isLoading.state||t.loadingDetails.setState({type:"load_groups_menu"}),d.H4({collectionSettingsStore:o,item:c?{type:"group",...p}:{type:"groupByProperty",...p}})},disabled:!c&&!u.canConfigureBlock}):null}function Ds(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"SubitemV1Component"};const n=(0,r.O7)(),i=(0,s.VK)((()=>t.normalizedSchemaStore.state),[t]),a=(0,s.VK)((()=>t.currentSubitemFormatStore.state),[t]),c=a?i[a.property]:void 0,p=(0,s.VK)((()=>t.permissionScopes.state),[t]),u=(0,s.VK)((()=>t.databaseType),[t]);return(0,tt.jsx)(be.Z,{icon:Ri.Y,title:(0,tt.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,tt.jsx)(l.FormattedMessage,{...(0,Ht.Gt)({feature:"subitem",databaseType:u})}),(0,tt.jsx)(rs.Z,{size:2})]}),showChevron:!0,right:(0,tt.jsx)("span",{style:{...ie.Z.textOverflowStyle},children:(null==c?void 0:c.name)??(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.subitemTab.none"})}),onClick:()=>{ko.wd({environment:n,collectionContextStore:t,action:"click_subitem"}),d.H4({collectionSettingsStore:o,item:{type:"subitem"}})},disabled:!a&&!p.canConfigureBlock})}function Ks(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"ArrowsByV1Component"};const n=(0,r.O7)(),i=(0,s.VK)((()=>t.normalizedSchemaStore.state),[t]),a=(0,s.VK)((()=>t.currentArrowsByFormatStore.state),[t]),c=a?i[a]:void 0,p=(0,s.VK)((()=>t.permissionScopes.state),[t]);return(0,tt.jsx)(be.Z,{icon:ki.Z,title:(0,tt.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Dependencies",id:"database.viewSettings.mainTab.dependencies.title"}),(0,tt.jsx)(rs.Z,{size:2})]}),showChevron:!0,right:(0,tt.jsx)("span",{style:{...ie.Z.textOverflowStyle},children:(null==c?void 0:c.name)??(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.arrowsByTab.none"})}),onClick:()=>{ko.wd({environment:n,collectionContextStore:t,action:"click_timeline_arrows_by"}),d.H4({collectionSettingsStore:o,item:{type:"arrowsBy"}})},disabled:!a&&!p.canConfigureBlock})}function Os(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"LayoutComponent"};const n=(0,r.O7)(),i=(0,s.VK)((()=>t.collectionViewStore()),[t]),a=(0,s.VK)((()=>null==i?void 0:i.getType()),[i]);return i&&a?(0,tt.jsx)(be.Z,{icon:Zi.M,isPadded:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.mainTab.layoutButton.title"}),showChevron:!0,right:ke.Bh[a],onClick:()=>{ko.wd({environment:n,collectionContextStore:t,action:"click_layout"}),d.H4({collectionSettingsStore:o,item:{type:"layout"}})}}):null}function Rs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"PropertiesComponent"};const n=(0,r.O7)(),i=((0,s.VK)((()=>t.normalizedFormatStore.state),[t])[(0,s.VK)((()=>(0,No.oz)(Ts(t))),[t])]||[]).filter((e=>Boolean(e.visible))).length;return(0,tt.jsx)(be.Z,{icon:Ei.N,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Properties",id:"database.viewSettings.mainTab.propertiesButton.title"}),showChevron:!0,right:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{propertiesShown} shown",id:"database.viewSettings.mainTab.propertiesButton.propertiesShown.title",values:{propertiesShown:i}}),onClick:()=>{ko.wd({environment:n,collectionContextStore:t,action:"click_properties"}),d.H4({collectionSettingsStore:o,item:{type:"properties",timelineViewTab:"timeline"}})}})}function Es(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"FilterComponent"};const n=(0,r.O7)(),i=(0,s.VK)((()=>t.permissionScopes.state),[t]),a=(0,s.VK)((()=>t.currentPropertyFiltersStore.state.length+(t.currentCombinatorFilterStore.state&&i.canConfigureBlock?1:0)),[t,i]);return(0,tt.jsx)(be.Z,{icon:Fi.I,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:a>0?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfFilters, plural, one {{numberOfFilters} filter} other {{numberOfFilters} filters}}",values:{numberOfFilters:a},id:"database.viewSettings.mainTab.filterButton.filters.title"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.filterButton.noFilters.title"}),onClick:()=>{ko.wd({environment:n,collectionContextStore:t,action:"click_filters"}),0===a?d.H4({collectionSettingsStore:o,item:{type:"createFilter"}}):d.H4({collectionSettingsStore:o,item:{type:"filters"}})}})}function Gs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"SortComponent"};const n=(0,r.O7)(),i=(0,s.VK)((()=>t.currentSortsStore.state.length),[t]);return(0,tt.jsx)(be.Z,{icon:Gi.j,isPadded:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.mainTab.sortButton.title"}),showChevron:!0,right:i>0?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:i},id:"database.viewSettings.mainTab.sortButton.oneOrMoreSorts.title"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.sortButton.noSorts.title"}),onClick:()=>{ko.wd({environment:n,collectionContextStore:t,action:"click_sort"}),0===i?d.H4({collectionSettingsStore:o,item:{type:"createSort"}}):d.H4({collectionSettingsStore:o,item:{type:"sort"}})}})}function Ns(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"SubitemComponent"};return(0,s.VK)((()=>Ie.default.checkGate("dependency_date_shifting_by_space")),[])?(0,tt.jsx)(Ps,{collectionSettingsStore:t,collectionContextStore:o}):(0,tt.jsx)(Ds,{collectionContextStore:o,collectionSettingsStore:t})}function Ws(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"ArrowsByComponent"};const n=(0,s.VK)((()=>Ie.default.checkGate("dependency_date_shifting_by_space")),[]),i=(0,s.VK)((()=>fn({feature:"timeline_arrows_by",viewType:Ts(o)})),[o]);return n?(0,tt.jsx)(Vs,{collectionSettingsStore:t,collectionContextStore:o}):i?(0,tt.jsx)(Ks,{collectionContextStore:o,collectionSettingsStore:t}):null}function Ls(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"RelationFeaturesComponent"};const i=(0,s.VK)((()=>t.collectionStore()),[t]),r=(0,s.VK)((()=>null==i?void 0:i.isSyncedCollection()),[i]),a=(0,s.VK)((()=>t.contextType),[t]);return r||"collectionTypedView"===a?null:(0,tt.jsxs)(n.Fragment,{children:[(0,tt.jsx)(Ns,{collectionSettingsStore:o,collectionContextStore:t}),(0,tt.jsx)(Ws,{collectionSettingsStore:o,collectionContextStore:t})]})}function Us(e){window.__c={n:"TaskMigrationInfoMenuItem"};const t=(0,r.O7)(),o=(0,s.VK)((()=>{const e=Be.default.state.mainEditorCurrentBlockStore;return Boolean(e&&(0,zi.qG)(e.id))}),[]),n=(0,s.VK)((()=>!t.device.isPhone&&(!!o&&!e.collectionContextStore.isEmptyStore.state)),[t,o,e.collectionContextStore]),i=(0,S.yK)((e=>({icon:Hs(e).iconStyles,title:Hs(e).menuItemStyles})),[]);return n?(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(Lr.Z,{from:"home_tasks"}),(0,tt.jsx)(be.Z,{showChevron:!1,icon:P.m,iconStyle:i.icon,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Don't see your tasks?",id:"tasksEmptyState.noDatabases.title"}),textWrapperStyle:i.title,onClick:()=>{or.Z.setState(!0),(0,tr.Aq)({environment:t,from:"home_tasks"})}})]}):null}function zs(e,t,o,n){n&&n.isDefined()&&(n.getName()!==e&&u.createAndCommit({userAction:"CollectionSettingsViewMain.handleViewNameSubmit",environment:t,perform:t=>{Vo.iG({collectionViewStore:n,update:{name:e},transaction:t})}}),ko.wd({environment:t,collectionContextStore:o,action:"rename",original_view_type:n.getType()}))}function Hs(e){return{menuItemStyles:{color:e.lightTextColor},iconStyles:{width:16,marginLeft:4,marginRight:2,fill:e.lightIconColor}}}function $s(e){let{collectionContextStore:t}=e;window.__c={n:"LockActionComponent"};const o=(0,r.O7)(),n=(0,s.VK)((()=>t.collectionViewBlockStore()),[t]),i=(0,s.VK)((()=>null==n?void 0:n.getCollectionViewSourceCollectionStore()),[n]),a=(0,s.VK)((()=>null==n?void 0:n.isLocked()),[n]),l=(0,s.VK)((()=>i?i.canEditCollection():null==n?void 0:n.canEditCollection()),[n,i]),c=(0,s.VK)((()=>null==n?void 0:n.isCollectionViewPageWithContent()),[n]);return n&&l?(0,tt.jsx)(be.Z,{icon:a?Wi.U:Ki.b,title:js(i,c,a),onClick:()=>function(e,t){const o=t.collectionViewBlockStore();o&&(Ui.bo({environment:e,store:o,lock:!o.isLocked()}),ko.wd({environment:e,collectionContextStore:t,action:"click_toggle_lock"}))}(o,t)}):null}function qs(e){let{collectionContextStore:t}=e;window.__c={n:"CopyLinkActionComponent"};const o=(0,r.O7)();return(0,tt.jsx)(be.Z,{icon:Di.N,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"}),onClick:()=>function(e,t){const o=t.collectionViewStore();o&&(d.Ol({environment:e,collectionContextStore:t,collectionViewStore:o}),ko.wd({environment:e,collectionContextStore:t,action:"click_copy_link",original_view_type:o.getType()}))}(o,t)})}function Ys(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"DuplicateActionComponent"};const n=(0,r.O7)(),i=(0,l.useIntl)(),a=(0,s.VK)((()=>t.permissionScopes.state),[t]);return(0,s.VK)((()=>!a.canConfigureBlock||"collectionTypedView"===t.contextType),[t,a])?null:(0,tt.jsx)(be.Z,{icon:Ue.a,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"}),onClick:()=>function(e,t,o,n){const i=t.collectionViewStore();i&&(d.zt({environment:e,collectionContextStore:t,collectionViewStore:i,collectionSettingsStore:o,intl:n}),ko.wd({environment:e,collectionContextStore:t,action:"click_duplicate",original_view_type:i.getType()}))}(n,t,o,i)})}function Qs(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"DeleteActionComponent"};const n=(0,r.O7)(),i=(0,s.VK)((()=>t.collectionViewBlockStore()),[t]),a=(0,s.VK)((()=>t.permissionScopes.state),[t]),c=(0,s.VK)((()=>!a.canConfigureBlock||"collectionTypedView"===t.contextType),[t,a]);return!i||c?null:(0,tt.jsx)(be.Z,{icon:ze.y,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteButton.title"}),isRed:!0,onClick:()=>function(e,t,o){const n=t.collectionViewStore();n&&(d.TT({environment:e,collectionContextStore:t,collectionViewStore:n,collectionSettingsStore:o,from:"view_settings"}),ko.wd({environment:e,collectionContextStore:t,action:"click_delete",original_view_type:n.getType()}))}(n,t,o)})}const Xs=function(e){window.__c={n:"CollectionSettingsCreateView"};const{collectionContextStore:t,collectionSettingsStore:o}=e,n=(0,l.useIntl)(),i=(0,S.Fg)(),a=(0,r.O7)(),{device:c}=a,p=(0,s.VK)((()=>t.collectionViewStore()),[t]),g=(0,s.VK)((()=>null==p?void 0:p.isDefined()),[p]),m=(0,s.VK)((()=>null==p?void 0:p.getFormat().collection_view_icon),[p]),f=(0,s.VK)((()=>null==p?void 0:p.getType()),[p]);return p&&g?(0,tt.jsxs)(Ce.ZP,{...e,collectionContextStore:t,collectionSettingsStore:o,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"New view",id:"database.viewSettings.createViewTab.title"}),desktopWidth:290,children:[(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(wi.Z,{initialValue:"",placeholder:n.formatMessage(Cs.viewNamePlaceholderMessage),focusInitial:!c.isMobile||void 0,onBlur:e=>Js(e,a,t),iconButton:{icon:e=>(0,tt.jsx)(os.F,{color:"gray",viewIcon:m,viewType:f,style:{marginRight:6}}),iconStyle:{fill:Mi.Lr[i.mode].gray},enforceIconColor:"gray",onSubmit:e=>function(e,t,o){const n=t.collectionViewStore();if(!n||!n.isDefined())return;u.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewIconSubmit",environment:e,perform:e=>{Vo.Uy({collectionViewBlockStore:n,icon:o,transaction:e})}}),ko.wd({environment:e,collectionContextStore:t,action:"change_icon",icon:o})}(a,t,e)},onSubmit:e=>function(e,t,o,n){Js(e,t,n),d.wl({collectionSettingsStore:o,item:{type:"main"}}),ko.wd({environment:t,collectionContextStore:n,action:"rename"})}(e,a,o,t)})}),(0,tt.jsx)(Ti.Z,{collectionContextStore:t,collectionSettingsStore:o,showDoneButton:!c.isMobile})]}):null};function Js(e,t,o){const n=o.collectionViewStore();n&&n.isDefined()&&n.getName()!==e&&u.createAndCommit({userAction:"CollectionSettingsCreateView.handleViewNameBlur",environment:t,perform:t=>{Vo.iG({collectionViewStore:n,update:{name:e},transaction:t})}})}var ea=o(49670),ta=o(39068),oa=o(55863),na=o(68641);class ia extends i.Z{renderComponent(){return(0,tt.jsx)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Deleted properties",id:"database.viewSettings.propertyTab.deletedTitle"}),children:this.renderContent()})}renderContent(){const{collectionContextStore:e}=this.props,t=e.normalizedDeletedSchemaStore.state,o=Object.entries(t).map((e=>{let[t,o]=e;if(o)return{propertyId:t,propertySchema:o}})).filter(ne.$K);if(0===o.length)return(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(vr.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"database.viewSettings.deletedPropertiesTab.noResults"})})});const{theme:n}=this;return(0,tt.jsx)(_e.Z,{children:o.map((e=>{let{propertyId:t,propertySchema:o}=e;return(0,tt.jsx)(vr.Z,{title:(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,tt.jsx)(ta.ZP,{type:o.type,icon:o.icon,size:16,theme:n,style:{fill:n.regularIconColor}}),(0,tt.jsx)("span",{style:{marginLeft:6,maxWidth:200,...ie.Z.textOverflowStyle},children:o.name})]}),right:(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(qe.Z,{icon:oa.s,iconStyle:{marginRight:2},onClick:()=>{!function(e,t,o,n,i){const r=o.collectionStore(),s=(0,na.jI)({timelineViewTab:n,collectionContextStore:o});if(r){const o=Ut.D8({deletedSchema:r.getDeletedSchema(),property:e});if(o){var a;if("verification"===(null===(a=r.getDeletedSchema()[e])||void 0===a?void 0:a.type)){const e=r.getSchema();if(Object.keys(e).some((t=>{var o;return"verification"===(null===(o=e[t])||void 0===o?void 0:o.type)})))return void Fo.showDialog({message:(0,tt.jsx)(l.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.verification",defaultMessage:"You can only have one verification property."}),showCancel:!1,keepFocus:!0,items:[{label:(0,tt.jsx)(l.FormattedMessage,{id:"database.deletedPropertiesTab.cannotRestoreDuplicateProperty.modal.dismissButton",defaultMessage:"Dismiss"}),onAccept:()=>{}}]})}u.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handleRestoreDeletedPropertyClick",environment:i,perform:e=>{Vo.xO({environment:i,collectionStore:r,update:o.updateSchema,transaction:e}),Vo.$N({collectionStore:r,update:o.updateDeletedSchema,transaction:e})}}),d.z$({collectionSettingsStore:t}),d.H4({collectionSettingsStore:t,item:{type:"property",property:e,formatKey:s}})}}}(t,this.props.collectionSettingsStore,this.props.collectionContextStore,this.props.timelineViewTab,this.environment)}}),(0,tt.jsx)(qe.Z,{icon:ze.y,onClick:()=>{!function(e,t,o){Fo.showDialog({message:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.deletedPropertiesTab.permanentlyDeleteProperty.modal.prompt",defaultMessage:"Are you sure you want to delete this property?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:()=>{const n=t.collectionStore();n&&u.createAndCommit({userAction:"CollectionSettingsDeletedProperties.handlePermanentlyDeleteDeletedPropertyClick",environment:o,perform:t=>{Vo.$N({collectionStore:n,update:{[e]:null},transaction:t})}})}}]})}(t,this.props.collectionContextStore,this.environment)}})]})},t)}))})}}ia.displayName="CollectionSettingsDeletedProperties";const ra=(0,l.injectIntl)(ia);var sa=o(83319),aa=o(89211),la=o(28410),ca=o(3791),da=o(10910),pa=o(79474),ua=o(52423),ga=o(44866),ma=o(19124),Sa=o(83212),fa=o(88280),ya=o(30905),ha=o(91965);const xa=(0,l.defineMessages)({autoUpdateExplanationMessage:{defaultMessage:"Keep values updated with the latest edits to pages",id:"database.CollectionSettingsPropertyAiAutofill.autoUpdateExplanationMessage"},onlyWithAiAddOnMessage:{defaultMessage:"Only with Notion AI add-on",id:"database.CollectionSettingsPropertyAiAutofill.onlyWithAiAddOnMessage"},updateOnPageEdits:{defaultMessage:"Auto-update on page edits",id:"database.viewSettings.propertyTab.aiAutofill.updateOnPageEdits"}});function va(e){let{collectionContextStore:t,environment:o,setAiInference:i,aiInference:r,doesUserHaveAIAddOn:s}=e;window.__c={n:"CollectionSettingsAiAutofillAutoUpdateToggle"};const c=(0,n.useRef)((0,a.ZP)()),d=(0,n.useCallback)((()=>{if(!t.collectionStore())return;if(!r)return;if(!(s||null!=r&&r.auto_update_on_edit))return void ga.triggerAiAutofillUpsell({environment:o,from:"ai_autofill_on_page_edit"});const e={...r,auto_update_on_edit:!r.auto_update_on_edit};i(e)}),[t,r,s,i,o]);return r?(0,tt.jsx)(Te.ZP,{renderTooltip:()=>(0,tt.jsxs)("div",{style:{width:159},children:[(0,tt.jsx)("div",{style:{color:"white",fontWeight:500,wordWrap:"break-word",whiteSpace:"pre-wrap"},children:(0,tt.jsx)(l.FormattedMessage,{...xa.autoUpdateExplanationMessage})}),!s&&(0,tt.jsx)("div",{style:{color:"#ACABA9",fontWeight:500},children:(0,tt.jsx)(l.FormattedMessage,{...xa.onlyWithAiAddOnMessage})})]}),render:e=>(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{...xa.updateOnPageEdits}),showChevron:!1,right:(0,tt.jsx)(Mn.Z,{inputId:c.current,on:!!r.auto_update_on_edit,onClick:d,disabled:!1,noColor:!1}),onClick:d,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})}):null}var Ca=o(1743);const ba=(0,l.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},extractPromptSectionTitle:{defaultMessage:"What key info to extract?",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptSectionTitle"},customPromptSectionTitle:{defaultMessage:"What to generate?",id:"database.viewSettings.propertyTab.aiAutofill.customPromptSectionTitle"},extractPromptInputPlaceholder:{defaultMessage:"e.g. “Key topics in bullets” or “People mentioned on the page”",id:"database.viewSettings.propertyTab.aiAutofill.extractPromptInputPlaceholder"},customPromptInputPlaceholder:{defaultMessage:"Tell AI what to generate from page content and properties…",id:"database.viewSettings.propertyTab.aiAutofill.customPromptInputPlaceholder"}});function wa(e){var t;let{environment:o,aiInference:i,setAiInference:r,collectionContextStore:a,isAutofillSetupEnabled:c,shouldShowUserPromptIsInvalidError:d,setShouldShowUserPromptIsInvalidError:p}=e;window.__c={n:"CollectionSettingsAiAutofillPromptInput"};const u=function(e){if(!e)return;switch(e.type){case"summarize":case"translate":return;case"extract":return{aiInferenceType:e.type,sectionTitle:ba.extractPromptSectionTitle,inputPlaceholder:ba.extractPromptInputPlaceholder,value:e.prompt};case"custom":return{aiInferenceType:e.type,sectionTitle:ba.customPromptSectionTitle,inputPlaceholder:ba.customPromptInputPlaceholder,value:e.prompt};case"select":case"multi_select":return{aiInferenceType:e.type,sectionTitle:ba.customPromptSectionTitle,inputPlaceholder:ba.customPromptInputPlaceholder,value:e.prompt};default:(0,ne.t1)(e)}}(i),g=(0,s.VK)((()=>(0,ke.k4)()),[]),m=(0,n.useCallback)((e=>{if(a.collectionStore()&&u)switch(e.target.value&&e.target.value.length<=la.Th?p(!1):e.target.value.length>la.Th&&p(!0),u.aiInferenceType){case"extract":case"custom":r({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??g});break;case"select":case"multi_select":r({type:u.aiInferenceType,prompt:e.target.value,auto_update_on_edit:(null==i?void 0:i.auto_update_on_edit)??g,add_options:((null==i?void 0:i.type)===u.aiInferenceType&&(null==i?void 0:i.add_options))??!1});break;case"summarize":case"translate":return;default:(0,ne.t1)(u.aiInferenceType)}}),[i,a,g,u,r,p]);return u?(0,tt.jsxs)(_e.Z,{title:Wo.default.formatMessage(u.sectionTitle),isInput:!0,style:{marginTop:-4},children:[(0,tt.jsx)(Ca.Z,{capture:!0,allowEsc:!0,children:(0,tt.jsx)(we.ZP,{inputOuterStyle:{margin:o.device.isMobile?"8px 0":0,border:d?"1px solid red":void 0},type:"text",value:u.value||"",onChange:m,placeholder:Wo.default.formatMessage(u.inputPlaceholder),textarea:!0,disabled:!c,autosize:!0,autosizeMinHeight:100,autosizeMaxHeight:600},u.aiInferenceType)}),d&&(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:12,fontSize:12},children:[(0,Ee.t)({width:12,height:12,fill:"#D34F43"}),(0,tt.jsx)("div",{style:{color:"#D34F43",paddingLeft:4},children:((null===(t=u.value)||void 0===t?void 0:t.length)??0)>la.Th?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Instruction is too long",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.exceedsMaxLength"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Required",id:"CollectionSettings.propertyTab.aiAutofill.promptInput.required"})})]})]}):null}function ja(e){const{collectionContextStore:t,isAutofillSetupEnabled:o,draftAiInference:n,setDraftAiInference:i,environment:r,shouldShowUserPromptIsInvalidError:s,setShouldShowUserPromptIsInvalidError:a,doesUserHaveAIAddOn:l}=e;return n?"select"!==n.type&&"multi_select"!==n.type?null:(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsxs)(_e.Z,{style:{marginBottom:10},children:[(0,tt.jsx)(va,{collectionContextStore:t,environment:r,setAiInference:i,aiInference:n,doesUserHaveAIAddOn:l}),(0,tt.jsx)(ha.Z,{setAiInference:i,aiInference:n})]}),n&&(0,tt.jsx)(_e.Z,{topBorder:!0,children:(0,tt.jsx)(wa,{environment:r,aiInference:n,setAiInference:i,collectionContextStore:t,isAutofillSetupEnabled:o,shouldShowUserPromptIsInvalidError:s,setShouldShowUserPromptIsInvalidError:a})})]}):null}o(30541);var _a=o(87205),Ma=o(5257),Ta=o(99417);const ka=new Xe.Z;var Pa=o(60458),Va=o(43765);const Fa=(0,l.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},whatToTranslate:{defaultMessage:"What to translate?",id:"CollectionSettingsPropertyAiAutofill.translateProperty.propertySelector"},translateTo:{defaultMessage:"Translate to",id:"CollectionSettingsPropertyAiAutofill.translateProperty.languageSelector"},selectorSearchPlaceholder:{defaultMessage:"Search",id:"CollectionSettingsPropertyAiAutofill.selectorOption.searchbar.placeholder"},allProperties:{defaultMessage:"All properties",id:"CollectionSettingsPropertyAiAutofill.selectorOption.allProperties.checkbox"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function Aa(e){window.__c={n:"CollectionSettingsTextPropertyAiAutofill"};const{collectionContextStore:t,propertySchema:o,previousPromptByAiInferenceType:i,isAutofillSetupEnabled:r,draftAiInference:s,setDraftAiInference:a,environment:l,propertyId:c,collectionSchema:d,shouldShowUserPromptIsInvalidError:p,setShouldShowUserPromptIsInvalidError:u,doesUserHaveAIAddOn:g}=e,m=(0,S.Fg)(),f=(0,n.useMemo)((()=>[new Xe.Z,new Xe.Z]),[]),y=(0,n.useMemo)((()=>function(e){var t;let{environment:o,aiInference:n,collectionSchema:i,setAiInference:r,property:s,theme:a,optionsButtonPopupStores:l}=e;if(!n||!(0,b.MD)(n.type))return[];switch(n.type){case"summarize":return[];case"translate":const e=oo.oA((0,ne.Yd)(i).map((e=>{if(e===s)return;const t=i[e];if(t&&(0,_a.K9)(t)){var o;if("text"===t.type&&"translate"===(null===(o=t.ai_inference)||void 0===o?void 0:o.type))return;return{id:e,option:t.name,icon:(0,tt.jsx)(ta.ZP,{icon:t.icon,type:t.type,theme:a,size:16})}}}))),o=e.findIndex((e=>"title"===e.id));if(o&&o>0){const t=e[o];e.splice(o,1),e.unshift(t)}for(;l.length<2;)l.push(new Xe.Z);return[{type:"multi",options:e,selectedIds:(null===(t=n.targetProperties)||void 0===t?void 0:t.length)>0?n.targetProperties:["title"],setSelectedIds:e=>{r({...n,targetProperties:e})},selectorTitle:Fa.whatToTranslate,selectAllTitle:Fa.allProperties,buttonPopupStore:l[0]},{type:"single",options:_a.nI.map((e=>{let{key:t,name:o}=e;return{id:t,option:Wo.default.formatMessage(o)}})),selectedId:n.toLanguage,onSelect:e=>{r({...n,toLanguage:e})},selectorTitle:Fa.translateTo,buttonPopupStore:l[1]}];case"extract":case"custom":return[];default:(0,ne.t1)(n)}}({environment:l,aiInference:s,collectionSchema:d,setAiInference:a,property:c,theme:m,optionsButtonPopupStores:f})),[l,s,d,a,c,m,f]);return(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsxs)(_e.Z,{style:{marginBottom:10},children:[(0,tt.jsx)(Ba,{propertySchema:o,previousPromptByAiInferenceType:i,draftAiInference:s,setDraftAiInference:a,environment:l}),(0,b.by)(s,"text")&&(0,tt.jsx)(va,{collectionContextStore:t,environment:l,setAiInference:a,aiInference:s,doesUserHaveAIAddOn:g})]}),(0,b.by)(s,"text")&&(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[(0,tt.jsx)(wa,{environment:l,aiInference:s,setAiInference:a,collectionContextStore:t,isAutofillSetupEnabled:r,shouldShowUserPromptIsInvalidError:p,setShouldShowUserPromptIsInvalidError:u}),(0,tt.jsx)(Za,{environment:l,optionProps:y})]})]})}function Ba(e){let{propertySchema:t,previousPromptByAiInferenceType:o,draftAiInference:i,setDraftAiInference:r,environment:a}=e;window.__c={n:"AiPromptTypeSelectorSections"};const c=(0,s.VK)((()=>(0,ke.k4)()),[]),d=(0,n.useCallback)((e=>{var n,i,s,a,l,d,p,u;if(!t||!(0,b.qQ)(t)||!e)return;let g;switch(e){case"summarize":g={type:e,auto_update_on_edit:c};break;case"translate":g={type:e,auto_update_on_edit:c,targetProperties:(null===(n=t.ai_inference)||void 0===n?void 0:n.type)===e?null===(i=t.ai_inference)||void 0===i?void 0:i.targetProperties:["title"],toLanguage:(null===(s=t.ai_inference)||void 0===s?void 0:s.type)===e?null===(a=t.ai_inference)||void 0===a?void 0:a.toLanguage:"english"};break;case"extract":g={type:e,prompt:(null===(l=t.ai_inference)||void 0===l?void 0:l.type)===e?null===(d=t.ai_inference)||void 0===d?void 0:d.prompt:o[e]??"",auto_update_on_edit:c};break;case"custom":g={type:e,prompt:(null===(p=t.ai_inference)||void 0===p?void 0:p.type)===e?null===(u=t.ai_inference)||void 0===u?void 0:u.prompt:o[e]??"",auto_update_on_edit:c};break;default:(0,ne.t1)(e)}r(g)}),[c,o,t,r]),p=(0,S.Fg)();return t&&(0,b.qQ)(t)?(0,tt.jsx)($e.ZP,{popupType:a.device.isMobile?$e.Z4.SlideUp:$e.Z4.Popup,buttonPopupStore:ka,render:e=>{const t={key:"section",render:e=>(0,tt.jsx)(_e.Z,{...e}),items:oo.oA(Object.keys(Ta.OE.text).map((t=>{if(("translate"!==t||(0,ma.hu)())&&(0,b.MD)(t))return{key:t,render:e=>{const o=Ta.OE.text[t];return(0,tt.jsx)(He.Z,{focused:!1,onClick:e.onClick,icon:o.svg({height:20,width:24,fill:p.aiPurpleColor}),title:Wo.default.formatMessage(o.name),checkState:(null==i?void 0:i.type)===t})},action:()=>{e.close(),d(t)}}})))};return(0,tt.jsx)(Ye.Z,{menuType:Zo.og.Popup,minWidth:260,maxWidth:"100vw",children:(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,initialFocus:void 0,sections:[t]})})},renderOrigin:e=>{let{onClick:t}=e;return(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:14,marginLeft:4,marginRight:4,marginTop:8,paddingLeft:12,paddingRight:12,cursor:"pointer",height:28},onClick:t,children:[(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Fill with",id:"CollectionSettingsPropertyAiAutofill.ClosedSelector.Title"}),(0,tt.jsx)(Ia,{aiActionType:null==i?void 0:i.type})]})}}):null}function Ia(e){let{aiActionType:t}=e;window.__c={n:"AiActionRenderer"};const o=(0,S.Fg)(),n=t&&(0,b.MD)(t)?Ta.OE.text[t]:{name:Fa.noAiAutofillSelected,svg:()=>null};return(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer",fontSize:14,paddingLeft:15,paddingBottom:0},children:[(0,tt.jsx)("div",{style:{color:o.lightIconColor},children:n.svg({height:16,width:16,marginRight:2})}),(0,tt.jsx)("div",{style:{color:o.lightTextColor,paddingLeft:4},children:(0,tt.jsx)(l.FormattedMessage,{...n.name})}),(0,tt.jsx)("div",{style:{color:o.lightIconColor,paddingLeft:4},children:(0,Ma.o)({height:12,width:12})})]})}function Za(e){let{environment:t,optionProps:o}=e;return o&&o.length>0?(0,tt.jsx)(_e.Z,{title:Wo.default.formatMessage(Fa.optionsSectionTitle),isInput:!0,style:{marginTop:-4},children:o.map(((e,o)=>"multi"===e.type?(0,tt.jsx)(Da,{environment:t,options:e.options,selectedIds:e.selectedIds,setSelectedIds:e.setSelectedIds,selectorTitle:e.selectorTitle,selectAllTitle:e.selectAllTitle,buttonPopupStore:e.buttonPopupStore},o):(0,tt.jsx)(Ka,{environment:t,options:e.options,selectedId:e.selectedId,onSelect:e.onSelect,selectorTitle:e.selectorTitle,buttonPopupStore:e.buttonPopupStore},o)))}):null}function Da(e){let{environment:t,options:o,selectedIds:i,setSelectedIds:r,selectorTitle:a,selectAllTitle:c,buttonPopupStore:d}=e;window.__c={n:"CheckSelectorOption"};const[p,u]=(0,n.useState)(""),g=(0,S.Fg)(),m=o.filter((e=>i.includes(e.id))),f=(0,s.VK)((()=>oo.jj(oo.MR(o.map((e=>e.id)))).join(",")===oo.jj(oo.MR(i)).join(",")),[o,i]),y=e=>{i.includes(e)?r(i.filter((t=>t!==e))):r(oo.jj([...i,e]))},h=()=>{i.length<o.length?r(o.map((e=>e.id))):r(["title"])},x=(0,tt.jsx)(_e.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,tt.jsx)(we.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:p,onChange:e=>{u(e.target.value)},placeholder:Wo.default.formatMessage(Fa.selectorSearchPlaceholder)})});return(0,tt.jsx)($e.ZP,{popupType:t.device.isMobile?$e.Z4.SlideUp:$e.Z4.Popup,buttonPopupStore:d,render:e=>{const t=o.filter((e=>{var t;const o=null===(t=e.option)||void 0===t?void 0:t.toLowerCase();return-1!==(null==o?void 0:o.indexOf(p.toLowerCase()))})).map((e=>{let{id:t,option:o,icon:n}=e;return{key:t,render:e=>(0,tt.jsx)(He.Z,{focused:!1,onClick:e.onClick,left:(0,tt.jsx)(Pa.Z,{checked:i.includes(t),size:14,checkSize:8,onClick:e=>{y(t)}}),icon:n,title:o}),action:()=>{y(t)}}})),n={key:"section",render:e=>(0,tt.jsx)(_e.Z,{...e,topBorder:!0}),items:t},r={key:"all-items",render:e=>(0,tt.jsx)(_e.Z,{...e}),items:[{key:"all-items",render:e=>(0,tt.jsx)(He.Z,{focused:!1,onClick:()=>{h()},left:(0,tt.jsx)(Pa.Z,{checked:f,size:14,checkSize:8,onClick:()=>{h()}}),title:Wo.default.formatMessage(c)}),action:()=>{h()}}]};return(0,tt.jsxs)(Ye.Z,{menuType:Zo.og.Popup,minWidth:260,maxWidth:"100vw",children:[x,0===t.length?(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(Va.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,initialFocus:void 0,sections:[r,n]})]})},renderOrigin:e=>(0,tt.jsx)(be.Z,{title:Wo.default.formatMessage(a),showChevron:!0,right:(0,tt.jsx)("div",{style:{color:g.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:oo.oA(m.map((e=>{let{id:t,option:o,icon:n}=e;return o}))).join(", ")}),rightStyle:{flexShrink:1},rotateChevron:d.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}function Ka(e){let{environment:t,options:o,selectedId:i,onSelect:r,selectorTitle:s,buttonPopupStore:a}=e;window.__c={n:"SelectorOption"};const[c,d]=(0,n.useState)(""),p=o.find((e=>e.id===i)),u=(0,S.Fg)(),g=(0,tt.jsx)(_e.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,tt.jsx)(we.ZP,{focusInitial:!t.device.isMobile||void 0,focus:!t.device.isMobile||void 0,value:c,onChange:e=>{d(e.target.value)},placeholder:Wo.default.formatMessage(Fa.selectorSearchPlaceholder)})});return(0,tt.jsx)($e.ZP,{popupType:t.device.isMobile?$e.Z4.SlideUp:$e.Z4.Popup,buttonPopupStore:a,render:e=>{const t=o.filter((e=>{var t;return-1!==(null===(t=e.option)||void 0===t?void 0:t.toLowerCase().indexOf(c.toLowerCase()))})).map((t=>{let{id:o,option:n,icon:s}=t;return{key:o,render:e=>(0,tt.jsx)(He.Z,{focused:!1,onClick:e.onClick,icon:s,title:n,checkState:o===i}),action:()=>{e.close(),r(o)}}})),n={key:"section",render:e=>(0,tt.jsx)(_e.Z,{...e}),items:t};return(0,tt.jsxs)(Ye.Z,{menuType:Zo.og.Popup,minWidth:260,maxWidth:"100vw",children:[g,0===t.length?(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(Va.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"CollectionSettingsPropertyAiAutofill.searchBar.noResults.label"})})}):(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,initialFocus:void 0,sections:[n]})]})},renderOrigin:e=>(0,tt.jsx)(be.Z,{title:Wo.default.formatMessage(s),showChevron:!0,right:p&&(0,tt.jsxs)(tt.Fragment,{children:[p.icon,(0,tt.jsx)("div",{style:{color:u.lightTextColor,paddingLeft:4,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"90%"},children:p.option})]}),rightStyle:{flexShrink:1},rotateChevron:a.state.open,disabled:!1,textWrapperStyle:{minWidth:"auto"},...e})})}var Oa=o(73420),Ra=o(3386),Ea=o(91839);const Ga=(0,l.defineMessages)({optionsSectionTitle:{defaultMessage:"Options",id:"database.viewSettings.propertyTab.aiAutofill.optionsSectionTitle"},removeAutofillButton:{defaultMessage:"Turn off AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.removeAutofillButton"},toggleFillWithAiSectionLabel:{defaultMessage:"Actions",id:"database.viewSettings.propertyTab.aiAutofill.actionsSectionLabel"},confirmOverwriteExistingPropertyValues:{defaultMessage:"Filling “{propertyName}” with AI will overwrite any existing values of the property. Are you sure you want to continue?",id:"database.viewSettings.propertyTab.aiAutofill.confirmOverwriteModal"},noAiAutofillSelected:{defaultMessage:"Select an option",id:"database.CollectionSettingsPropertyAiAutofill.noAiAutofillSelected"}});function Na(e){window.__c={n:"CollectionSettingsPropertyAiAutofill"};const{property:t,collectionContextStore:o,collectionSettingsStore:i}=e,a=(0,s.VK)((()=>o.normalizedSchemaStore.state[t]),[t,o.normalizedSchemaStore]),c=(0,s.VK)((()=>o.collectionStore()),[o]),p=(0,s.VK)((()=>o.normalizedSchemaStore.getState()),[o]),g=a&&(0,b.qQ)(a)?(0,b.q3)(a):void 0,m=(0,r.O7)(),S=La(),f=(0,s.VK)((()=>{const e=o.collectionStore();return e&&(0,ma.mX)(m,Sa.Z.getMode(m,e),e)}),[m,o]),y=hi.default.createValue({stage:"not_started"});(0,n.useEffect)((()=>{var e,n;if("page"===o.getViewType())return;if(!1!==(null===(e=o.getPropertyFormat(t))||void 0===e?void 0:e.visible))return;const i=new yi.Z({name:"CollectionSettingsPropertyAiAutofill"});m.defaultRecordCache.inMemoryRecordCache.addCacheOverride(i);const r=null===(n=o.formatStore())||void 0===n?void 0:n.clone(i),s=o.getPropertyFormatKey();return r&&s&&u.createAndCommit({userAction:"CollectionSettingsPropertyAiAutofill.open",environment:m,perform:e=>{Po.er({formatStore:r,formatKey:s,property:t,update:{visible:!0},transaction:e})}}),()=>{m.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i)}}),[o,m,t]);const h=(0,n.useRef)({}),x=(0,s.VK)((()=>(0,ke.k4)()),[]),[v,C]=(0,n.useState)(a&&ga.getDefaultAiInference(a,x)),[w,j]=(0,n.useState)(!1),_=(0,n.useCallback)((()=>{const e=o.collectionStore();if(!e||!a||!(0,b.qQ)(a))return;const n=(0,b.q3)(a);n&&"prompt"in n&&(h.current={...h.current,[n.type]:n.prompt}),ga.saveOrRemovePropertyAiInference({environment:m,propertySchema:a,collectionStore:e,property:t,draftAiInference:v})}),[o,a,v,t,m]),M=(0,s.VK)((()=>{var e;return(null===(e=o.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString())||""}),[o]),T=(0,n.useCallback)((async()=>{if(a&&(0,b.qQ)(a)&&oo.Xy(v,(0,b.q3)(a)))d.E3({collectionSettingsStore:i});else if(v){var e;if("prompt"in v)if((0,b.DS)(v)&&0===(null===(e=v.prompt)||void 0===e?void 0:e.length)||(0,ne.$K)(v.prompt)&&v.prompt.length>la.Th)return void j(!0);(null==g||!g.auto_update_on_edit)&&null!=v&&v.auto_update_on_edit&&x&&a?await pa.r({sourceAction:"auto_update",propertyName:a.name,collectionName:M})&&_():_()}}),[M,i,g,v,_,x,a]),k=(0,n.useCallback)((()=>{const e=o.collectionStore();e&&g&&a&&(ga.saveOrRemovePropertyAiInference({environment:m,propertySchema:a,collectionStore:e,property:t,draftAiInference:null}),d.z$({collectionSettingsStore:i}))}),[o,g,m,a,t,i]),P=a&&(0,b.qQ)(a)&&oo.Xy(v,(0,b.q3)(a)),F=(0,n.useCallback)((async()=>new Promise((e=>{Fo.showDialog({showCancel:!1,keepFocus:!1,message:(0,tt.jsxs)(Oa.sg,{alignItems:"center",gap:8,children:[(0,V.y)(S.confirmDiscardChangesDialogIconStyle),(0,tt.jsx)("div",{style:S.confirmDiscardChangesDialogMessageStyle,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Do you want to discard changes for AI autofill?",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.message"})})]}),items:[{label:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Discard",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.acceptLabel"}),color:"red",onAccept:()=>e(!0)},{label:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Continue editing",id:"database.viewSettings.propertyTab.aiAutofill.confirmDiscordChangesDialog.cancelLabel"}),onAccept:()=>e(!1)}]})}))),[S]),A=(0,n.useCallback)((async()=>{(P||await F())&&d.z$({collectionSettingsStore:i})}),[P,i,F]),B=(0,n.useCallback)((async()=>{(P||await F())&&d.E3({collectionSettingsStore:i})}),[P,i,F]),I=(0,s.VK)((()=>{var e;const t=(null===(e=fa.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,ca.de)(t)}),[]);return a&&(0,b.qQ)(a)&&c?(0,tt.jsx)(Ra.Z,{capture:!0,onEsc:B,children:(0,tt.jsxs)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Fill “{propertyName}” with AI",id:"database.viewSettings.propertyTab.aiAutofill.title",values:{propertyName:a.name}}),handleBackArrowClick:A,handleClose:B,children:[!f&&(0,tt.jsx)(_e.Z,{style:S.menuItemStyle,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"You don't have permission to set up AI autofill on this database.",id:"database.viewSettings.propertyTab.aiAutofill.noSetupPermission"})}),"text"===a.type&&(0,tt.jsx)(Aa,{collectionContextStore:o,propertySchema:a,previousPromptByAiInferenceType:h.current,isAutofillSetupEnabled:Boolean(f),draftAiInference:v,setDraftAiInference:C,environment:m,propertyId:t,collectionSchema:p,shouldShowUserPromptIsInvalidError:w,setShouldShowUserPromptIsInvalidError:j,doesUserHaveAIAddOn:I}),(0,b.cu)(a)&&(0,tt.jsx)(ja,{collectionContextStore:o,isAutofillSetupEnabled:Boolean(f),draftAiInference:v,setDraftAiInference:C,environment:m,shouldShowUserPromptIsInvalidError:w,setShouldShowUserPromptIsInvalidError:j,doesUserHaveAIAddOn:I}),(0,b.by)(v,a.type)&&(0,tt.jsxs)(_e.Z,{children:[(0,tt.jsx)(Wa,{environment:m,isAutofillSetupEnabled:f,collectionContextStore:o,tryAutofillStore:y,propertySchema:a,property:t,aiInference:v}),(0,tt.jsx)(Bo.Z,{style:{...S.buttonStyle,margin:"8px 12px 12px 12px",display:P?"none":"flex"},onClick:T,disabled:!f,children:P?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Done",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonAllSaved"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Save changes",id:"database.viewSettings.propertyTab.aiAutofill.saveButtonWithChanges"})})]}),(0,tt.jsxs)(_e.Z,{topBorder:!0,title:m.device.isMobile&&Wo.default.formatMessage(Ga.toggleFillWithAiSectionLabel),children:[(0,b.by)(g,a.type)&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(ya.TB,{environment:m,collectionContextStore:o,collectionStore:c,property:t,propertySchema:a,doesUserHaveAIAddOn:I,isAutofillSetupEnabled:Boolean(f)}),(0,tt.jsx)(be.Z,{icon:ze.y,isRed:!0,focused:!1,title:Wo.default.formatMessage(Ga.removeAutofillButton),onClick:k,disabled:!f})]}),(0,tt.jsx)(yr.Z,{href:(0,mr.UY)("guides.aiAutofill"),title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Learn about AI autofill",id:"database.viewSettings.propertyTab.aiAutofill.learnMoreLink"}),analyticsFrom:"collection_ai_autofill_menu"})]})]})}):null}function Wa(e){let{environment:t,isAutofillSetupEnabled:o,collectionContextStore:i,tryAutofillStore:r,propertySchema:c,property:d,aiInference:p}=e;window.__c={n:"TryOnThisViewActionSection"};const[u,g]=(0,n.useState)((0,a.ZP)()),m=(0,n.useRef)((0,a.ZP)()),S=(0,s.VK)((()=>r.state.stage),[r]),f=(0,s.VK)((()=>{const e=i.contextType;if("collectionPage"===e)return{type:"page",candidateBlockStores:oo.oA([(0,zi.np)()])};if("collectionTypedView"===e||"collectionView"===e)return{type:"collection",candidateBlockStores:i.resultsInViewOrder(5)};throw new Error(`Unexpected context type: ${e}`)}),[i]),y=(0,n.useCallback)((()=>{var e;da.qG(t,{ai_inference_type:p.type,type:"undo_from_collection_settings",inference_id:u,collection_id:null===(e=i.collectionStore())||void 0===e?void 0:e.id,session_id:m.current}),"not_started"!==S&&(ua.Yw(t,!1),r.setState({stage:"not_started"}))}),[t,p,u,i,S,r]),h=(0,ne.Of)(f.candidateBlockStores),x=La({isTryAutofillEnabled:o&&h});if(t.device.isMobile)return null;let v;return v=h?"collection"===f.type?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Updates the first {maxPages} pages. You can undo changes anytime.",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollectionDescription",values:{maxPages:5}}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:'Updates "{propertyName}" on this page. You can undo changes anytime.',id:"database.viewSettings.propertyTab.aiAutofill.tryOnPageDescription",values:{propertyName:c.name}}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Add more pages or remove filters to try AI on this view.",id:"database.viewSettings.propertyTab.tryAutofillDisabledDescription"}),(0,tt.jsx)(n.Fragment,{children:(0,tt.jsx)("div",{style:{margin:"8px 12px"},children:(0,tt.jsxs)(Oa.X2,{gap:8,children:[(0,tt.jsx)(Kn.Z,{disabled:!o||!h,style:{...x.buttonStyle,...x.undoButtonStyle,..."not_started"===S&&{display:"none"}},onClick:y,children:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Undo",id:"database.viewSettings.propertyTab.aiAutofill.undoButton"})}),(0,tt.jsx)(Te.ZP,{renderTooltip:()=>(0,tt.jsx)("div",{children:v}),render:e=>(0,tt.jsx)(Kn.Z,{...e,disabled:!o||!h,style:{...x.buttonStyle,...x.tryButtonStyle},hoveredStyle:x.tryButtonHoveredStyle,pressedStyle:x.tryButtonPressedStyle,onClick:async()=>{if((0,ne.Of)(f.candidateBlockStores)){const e=(0,a.ZP)();g(e),r.setState({stage:"in_progress"}),await ga.autofillPropertyForBlocks({environment:t,stores:f.candidateBlockStores,property:d,propertySchema:c,aiInferenceOverride:p,userEventForAnalytics:"generate_from_try_on_view_button",sessionIdForAnalytics:m.current,collectionContextStore:i,from:"ai_autofill_settings"}),r.setState({stage:"complete"})}},children:"in_progress"===S?(0,tt.jsx)(Ea.Z,{}):(0,tt.jsxs)(tt.Fragment,{children:[(0,V.y)({width:16,..."not_started"!==S&&{display:"none"}}),"not_started"!==S?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Try again",id:"database.viewSettings.propertyTab.aiAutofill.tryAgain"}):"collection"===f.type?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Try on this view",id:"database.viewSettings.propertyTab.aiAutofill.tryOnCollection"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Try on this page",id:"database.viewSettings.propertyTab.aiAutofill.tryOnPage"})]})})})]})})})}function La(e){const t=(0,S.Fg)();return(0,S.yK)((()=>({buttonStyle:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center",gap:8},menuItemStyle:{fontSize:13,borderRadius:6,background:t.accentColors.purple[50],color:t.accentColors.purple[500],margin:"8px 12px",padding:"8px 12px"},undoButtonStyle:{border:`1px solid ${t.accentColors.gray[100]}`,flex:1},tryButtonStyle:{fontWeight:500,flex:1,background:null!=e&&e.isTryAutofillEnabled?"light"===t.mode?t.accentColors.purple[50]:t.accentColors.purple[200]:t.accentColors.gray[50],color:null!=e&&e.isTryAutofillEnabled?t.aiPurpleColor:t.accentColors.gray[400]},fillAllPagesWandIconStyle:{fill:t.aiPurpleColor},tryButtonHoveredStyle:{background:t.accentColors.purple[100]},tryButtonPressedStyle:{background:t.accentColors.purple[200]},confirmDiscardChangesDialogIconStyle:{width:32,height:32,fill:t.aiPurpleColor,paddingTop:8},confirmDiscardChangesDialogMessageStyle:{textAlign:"center",fontWeight:500}})),[t,null==e?void 0:e.isTryAutofillEnabled])}var Ua=o(88268),za=o(16732);const Ha=(0,l.defineMessages)({upgradeButton:{id:"appTemplateUpgradeActions.upgradeConfirmationDialog.upgrade.label",defaultMessage:"Upgrade"},cancelUpgradeButton:{id:"appTemplateUpgradeActions.upgradeConfirmationDialog.cancelUpgrade.label",defaultMessage:"Don't upgrade"}});async function $a(e){const{environment:t,collectionViewBlockStore:o,collectionSettingsStore:n}=e,i=null==o?void 0:o.getFormat().app_config_uri,r=null==o?void 0:o.getParentStore();if(!o||i!==xi.NB&&i!==xi.J1)return!1;const s=i===xi.NB?o:await qr.JN({environment:t,collectionViewBlockStore:o,databaseUri:xi.iS}),a=i===xi.J1?o:await qr.JN({environment:t,collectionViewBlockStore:o,databaseUri:xi.p$});return!(!(s&&a&&r)||r.table!==ss.bx&&r.table!==Yi.iU&&r.table!==as.e0)&&(Fo.showDialog({message:(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{children:"Upgrade Existing Sprints to Latest?"}),(0,tt.jsx)("div",{style:{fontSize:12,padding:8},children:"This will update your Sprints Database, and change some existing views and properties."})]}),items:[{label:Wo.default.formatMessage(Ha.upgradeButton),color:"red",onAccept:async()=>{await async function(e){var t;const{environment:o,appParentStore:n,collectionViewBlockStore:i}=e,r=null===(t=i.getFormat())||void 0===t?void 0:t.app_uri_map,s=i.getCollectionStore();if(!r||!s)return;const a=await qa(i,n),l=(0,b.oC)({id:s.id,format:s.getFormat(),space_id:s.getSpaceId(),schema:s.getSchema()});u.createAndCommit({userAction:"appTemplateActions.upgradeSprintsDatabaseFromV1ToV2",environment:o,perform:e=>{Vo.Rm({environment:o,collectionStore:s,update:Ya[xi.p$](l,s.getFormat()),transaction:e}),a.forEach((t=>{const o=t.id,n=t.getFormat(),i=t.getQuery(l);r["notion://sprints/sprints_timeline_view"]===o?Vo.iG({collectionViewStore:t,update:Ya["notion://sprints/sprints_timeline_view"](n,i),transaction:e}):r["notion://sprints/sprints_view"]===o&&Vo.iG({collectionViewStore:t,update:Ya["notion://sprints/sprints_view"](n,i),transaction:e})}))}})}({environment:t,appParentStore:r,collectionViewBlockStore:a}),await async function(e){var t;const{environment:o,appParentStore:n,collectionViewBlockStore:i}=e,r=null===(t=i.getFormat())||void 0===t?void 0:t.app_uri_map;if(!r)return;const s=await qa(i,n);u.createAndCommit({userAction:"appTemplateActions.upgradeTasksDatabaseSprintsFeatureFromV1ToV2",environment:o,perform:e=>{s.forEach((t=>{const o=t.id,n=t.getFormat();if(r[xi.g3]===o){const o=Ya[xi.g3](n);Vo.iG({collectionViewStore:t,update:o,transaction:e})}else r[xi.y$]===o&&Vo.iG({collectionViewStore:t,update:Ya[xi.y$](n),transaction:e})}))}})}({environment:t,appParentStore:r,collectionViewBlockStore:s}),n.setState({open:!1,stack:[]})}},{label:Wo.default.formatMessage(Ha.cancelUpgradeButton),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}async function qa(e,t){return await Promise.all(e.getCollectionViewPointers().map((async e=>{const o=Ze.Xr.createChildStore(t,e);return await o.load(),o})))}const Ya={[xi.g3]:e=>({name:Wo.default.formatMessage(za.sY.tasksCurrentSprintV2ViewName),format:{...e,property_filters:[...(e.property_filters??[]).filter((e=>e.filter.property!==xi.Es.SprintStatusRollup)),za.Ws]}}),[xi.y$]:e=>({format:{...e,property_filters:[...(e.property_filters??[]).filter((e=>e.filter.property!==xi.Es.TaskToSprintRelation))],table_properties:[...(e.table_properties??[]).filter((e=>e.property!==xi.Es.SprintStatusRollup)),{property:xi.Es.SprintStatusRollup,visible:!1}]}}),[xi.p$]:(e,t)=>({schema:{...e,[xi.b0.UniqueId]:Ua.eK(Wo.default.getIntl())[xi.b0.UniqueId],[xi.b0.TotalTasksRollup]:za.X$,[xi.b0.CompletedTasksRollup]:za.sU,[xi.b0.StatusV2]:Ua.eK(Wo.default.getIntl())[xi.b0.StatusV2]},format:{...t,app_uri_map:{...(null==t?void 0:t.app_uri_map)||{},[xi.b0.UniqueId]:xi.b0.UniqueId,[xi.b0.TotalTasksRollup]:xi.b0.TotalTasksRollup,[xi.b0.CompletedTasksRollup]:xi.b0.CompletedTasksRollup,[xi.b0.StatusV2]:xi.b0.StatusV2}}}),"notion://sprints/sprints_timeline_view":(e,t)=>({format:{...e,table_properties:[...(e.table_properties??[]).filter((e=>e.property!==xi.b0.Status)),{width:147,visible:!1,property:xi.b0.Status},{width:147,visible:!0,property:xi.b0.StatusV2}],timeline_table_properties:[...(e.timeline_table_properties??[]).filter((e=>e.property!==xi.b0.Status)),{width:132,visible:!1,property:xi.b0.Status},{width:132,visible:!0,property:xi.b0.StatusV2}],collection_group_by:{sort:{type:"ascending"},type:"status",groupBy:"group",property:xi.b0.StatusV2}},query2:{...t??{},sort:[...(null==t?void 0:t.sort)??[],{property:xi.b0.StatusV2,direction:"ascending"}]}}),"notion://sprints/sprints_view":(e,t)=>({format:{...e,table_properties:[...(e.table_properties??[]).filter((e=>e.property!==xi.b0.Status)),{width:137,visible:!1,property:xi.b0.Status},{width:137,visible:!0,property:xi.b0.StatusV2},{width:75,visible:!0,property:xi.b0.TotalTasksRollup}],collection_group_by:{sort:{type:"ascending"},type:"status",groupBy:"group",property:xi.b0.StatusV2}},query2:{...t??{},sort:[...(null==t?void 0:t.sort)??[],{property:xi.b0.StatusV2,direction:"ascending"}]}})};var Qa=o(90559),Xa=o(10070),Ja=o(77657),el=o(87085),tl=o(34517),ol=o(54119),nl=o(15560),il=o(14871),rl=o(49117),sl=o(95477);var al=o(4850),ll=o(32363);var cl=o(33954),dl=o(12205);const pl=(0,l.defineMessages)({duplicateGithubPropertyTooltip:{defaultMessage:"A database can only have one GitHub Pull Requests property",id:"database.viewSettings.propertyTab.duplicateGithubProperty.tooltip"},wikiGithubPropertyTooltip:{defaultMessage:"A wiki cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.wikiGithubProperty.tooltip"},syncedDatabaseGithubPropertyTooltip:{defaultMessage:"A synced database cannot have a GitHub Pull Requests property",id:"database.viewSettings.propertyTab.syncedDatabaseGithubProperty.tooltip"},nonMeetingsCronPropertyTooltip:{defaultMessage:"The Cron Calendar property can only be added to a Meetings database",id:"database.viewSettings.propertyTab.nonMeetingsCronProperty.tooltip"},duplicateCronEventPropertyTooltip:{defaultMessage:"A database can only have one Cron Calendar event property",id:"database.viewSettings.propertyTab.duplicateCronEventProperty.tooltip"},newPill:{defaultMessage:"New",id:"database.viewSettings.newHighlightedFeature"}}),ul=(0,l.defineMessages)({text:{defaultMessage:"Add text that can be formatted. Great for summaries, notes, or descriptions.",id:"database.viewSettings.propertyTab.textProperty.tooltip"},number:{defaultMessage:"Accepts numbers. These can also be formatted as currency or progress bars. Useful for tracking counts, prices, and completion.",id:"database.viewSettings.propertyTab.numberProperty.tooltip"},select:{defaultMessage:"Select one option from a list of tags. Useful for categorization.",id:"database.viewSettings.propertyTab.selectProperty.tooltip"},multi_select:{defaultMessage:"Select one or more options from a list of tags. Useful for tagging items across multiple categories.",id:"database.viewSettings.propertyTab.multiSelectProperty.tooltip"},date:{defaultMessage:"Accepts a date or a date range (time optional). Useful for deadlines, especially with calendar and timeline views.",id:"database.viewSettings.propertyTab.dateProperty.tooltip"},formula:{defaultMessage:"Perform calculations based on other properties using Notion’s formula language.",id:"database.viewSettings.propertyTab.formulaProperty.tooltip"},relation:{defaultMessage:"Connect databases and mention database pages. Useful for connecting items across your workspace.",id:"database.viewSettings.propertyTab.relationProperty.tooltip"},rollup:{defaultMessage:"View and aggregate information about properties from relation properties. Useful for summarizing interconnected data.",id:"database.viewSettings.propertyTab.rollupProperty.tooltip"},person:{defaultMessage:"Tag anyone in your Notion workspace. Useful for assigning tasks or referencing relevant team members.",id:"database.viewSettings.propertyTab.personProperty.tooltip"},file:{defaultMessage:"Upload files and images for easy retrieval. Useful for storing documents and photos.",id:"database.viewSettings.propertyTab.filesProperty.tooltip"},checkbox:{defaultMessage:"Use a checkbox to indicate whether a condition is true or false. Useful for lightweight task tracking.",id:"database.viewSettings.propertyTab.checkboxProperty.tooltip"},url:{defaultMessage:"Accepts a link to a website and opens the link in a new tab when clicked.",id:"database.viewSettings.propertyTab.urlProperty.tooltip"},email:{defaultMessage:"Accepts an email address and launches your mail client when clicked.",id:"database.viewSettings.propertyTab.emailProperty.tooltip"},phone_number:{defaultMessage:"Accepts a phone number and prompts your device to call it when clicked.",id:"database.viewSettings.propertyTab.phoneNumberProperty.tooltip"},created_time:{defaultMessage:"Records the timestamp of an item's creation. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdTimeProperty.tooltip"},created_by:{defaultMessage:"Automatically records the person who created the item. Auto-generated and not editable.",id:"database.viewSettings.propertyTab.createdByProperty.tooltip"},last_edited_time:{defaultMessage:"Records the timestamp of an item's last edit. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedTimeProperty.tooltip"},last_edited_by:{defaultMessage:"Records the person who edited the item last. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastEditedByProperty.tooltip"},auto_increment_id:{defaultMessage:"Automatically creates a numerical ID for each item. IDs are unique and cannot be manually changed.",id:"database.viewSettings.propertyTab.uniqueIdProperty.tooltip"},status:{defaultMessage:"Track this item’s progress using status tags categorized by To-do, In progress, and Complete.",id:"database.viewSettings.propertyTab.statusProperty.tooltip"},verification:{defaultMessage:"Indicate whether a page has been verified by the page owner, with the option to set an expiration date.",id:"database.viewSettings.propertyTab.verificationProperty.tooltip"},button:{defaultMessage:"Trigger actions based on the item properties.",id:"database.viewSettings.propertyTab.buttonProperty.tooltip"},ai_summary:{defaultMessage:"Text property with AI summary set up for you. Generates a summary based on page content and properties.",id:"database.viewSettings.propertyTab.aiSummaryProperty.tooltip"},ai_translate:{defaultMessage:"Text property with AI translate set up for you. Translate a property to another language using AI. ",id:"database.viewSettings.propertyTab.aiTranslateProperty.tooltip"},ai_category:{defaultMessage:"Select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCategoryProperty.tooltip"},ai_keywords:{defaultMessage:"Multi-select property that automatically adds tags based on the page content and properties.",id:"database.viewSettings.propertyTab.aiKeywordsProperty.tooltip"},ai_custom_prompt:{defaultMessage:"Text property with a custom AI prompt. Generate content based on the page content and properties.",id:"database.viewSettings.propertyTab.aiCustomPromptProperty.tooltip"},ai_extract:{defaultMessage:"Text property with a custom AI prompt. Extract key info based on the page content and properties.",id:"database.viewSettings.propertyTab.aiExtractProperty.tooltip"},title:{defaultMessage:"Add a title for your database item. This determines the page's title.",id:"database.viewSettings.propertyTab.titleProperty.tooltip"},location:{defaultMessage:"Display the location of which database this item belongs to.",id:"database.viewSettings.propertyTab.locationProperty.tooltip"},last_visited_time:{defaultMessage:"Records the timestamp of the last time you visited this page. Auto-updated and not editable.",id:"database.viewSettings.propertyTab.lastVisitedTimeProperty.tooltip"}});function gl(e){let{collectionContextStore:t,propertySchema:o}=e;const i=(0,r.O7)(),a=(0,S.Fg)(),c=(0,s.VK)((()=>Ie.default.checkGate("recurring_sprints")),[]),d=(0,s.VK)((()=>t.collectionStore()),[t]),p=(0,s.VK)((()=>{if(!d)return;return d.getParentBlockStore()}),[d]),u=(0,s.VK)((()=>Wn.Z.bots.state),[]),g=(0,s.VK)((()=>{var e;if(!d)return;const t=null===(e=d.getFormat())||void 0===e?void 0:e.app_config_uri;return t?(0,Zn.YB)((0,tl.appConfigs)(),t):void 0}),[d]),m=(0,s.VK)((()=>{if(!d||!p||!g)return;if(void 0!==o)return;const e=d.isDefined()?function(e,t,o){const n=t=>{var n,i;const r=null===(n=o.format)||void 0===n?void 0:n.app_config_uri,s=Xa.aQ.deriveTypeUris(o.schema??{},null===(i=o.format)||void 0===i?void 0:i.app_uri_map);if(t.collectionUri!==r)return!1;const a=Be.default.state.mainEditorCurrentBlockStore,l=a&&Sa.Z.getMode(e,a),c=(0,ma.GD)(l);let d=!0;return t.uri===(0,za.GT)().uri&&s.has(xi.Es.GithubPrsRelation)&&(d=!1),t.dependencies.some((e=>"property"===e.type&&e.collectionUri===r&&(0,xi.jP)(e.uri)&&!s.has(e.uri)))&&(!t.isAi||c)&&d},i={};t.allFeatures.forEach((e=>{(0,Zn.FW)(e)&&e.variants.every((e=>Boolean(t.allFeatures.find((t=>t.uri===e&&(0,Zn.oX)(t)&&n(t))))))&&(i[e.uri]=e.variants)}));const r=Object.values(i).flat();return t.allFeatures.filter((e=>(0,Zn.oX)(e)&&!r.find((t=>t===e.uri))?n(e):!!(0,Zn.FW)(e)&&Boolean(i[e.uri]))).sort(((e,t)=>(0,Zn.FW)(e)?-1:(0,Zn.FW)(t)?1:e.dependencies.length-t.dependencies.length))}(i,g,{format:d.getFormat(),space_id:d.getSpaceId(),schema:d.getSchema()}):void 0;return e&&c?e.filter((e=>e.uri!==(0,za.eu)().uri)):e}),[d,p,g,o,i,c]),f=(0,s.VK)((()=>(null==d?void 0:d.getSchema())??{}),[d]),y=(0,s.VK)((()=>Boolean(null==d?void 0:d.isPageTreeCollection())),[d]),h=(0,s.VK)((()=>t.databaseType),[t]),x=(0,s.VK)((()=>Boolean(null==d?void 0:d.isSyncedCollection())),[d]),v=(0,dl.J)(),C=(0,l.useIntl)();return{suggestedProperties:m,renderSuggestedProperty:n.useCallback((e=>{const{isDisabled:o,propertyDisabledTooltip:n}=e.integrationId?hl({propertyConfig:e,bots:u,isSpaceAdmin:v,environment:i,isWikiCollection:y,databaseType:h,isSyncedCollection:x,schema:f,intl:C,isMobile:i.device.isMobile}):{isDisabled:!1,propertyDisabledTooltip:void 0},r=(e,t,n,i)=>{const r=Xa.aQ.deriveTypeUris((null==d?void 0:d.getSchema())??{},null==d?void 0:d.getPropertyMapping()),s=n.dependencies.find((e=>{var t;return"property"===e.type&&e.collectionUri===(null==d||null===(t=d.getFormat())||void 0===t?void 0:t.app_config_uri)&&(0,xi.jP)(e.uri)&&!r.has(e.uri)})),l=n.dependencies.find((e=>"property"===e.type&&(0,b.qQ)(e.propertySchema)&&(0,b.q3)(e.propertySchema)));if(s)return(0,tt.jsx)(He.Z,{...e,disabled:o,disabledFeedback:o,title:(0,tt.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t,l?(0,tt.jsx)(ol.Z,{}):null,n.isNew?"notion://projects/tasks_with_sprints_feature"===n.uri&&(0,tt.jsx)(nl.Z,{}):null]}),icon:(0,tt.jsx)(ta.ZP,{type:s.propertySchema.type,theme:a,icon:i,size:16,style:{fill:a.regularIconColor}})})};return{key:e.name,render:o=>{var s,a;return(0,tt.jsx)(kn,{showImage:!n,caption:n??e.description,tooltipImage:n||null===(s=e.tooltipImage)||void 0===s?void 0:s.img,tooltipImageScale:null===(a=e.tooltipImage)||void 0===a?void 0:a.scale,render:n=>{if((0,Zn.oX)(e))return r({...(0,Nn.Z)(o,n)},e.name,e,e.icon);{const s=oo.oA(e.variants.map((e=>{const t=null==g?void 0:g.allFeatures.find((t=>t.uri===e));if(t&&(0,Zn.oX)(t))return t})));return(0,tt.jsx)(il.Z,{items:s,getKey:e=>e.name,onSelect:async e=>{await el.G0({environment:i,feature:e,collectionContextStore:t})},selectedItem:void 0,renderOrigin:t=>r({...o,...(0,Nn.Z)(n,t)},e.name,s[0],e.icon),renderItem:e=>(0,tt.jsx)(He.Z,{...e,title:e.value.name,shouldWrapCaption:!0,shouldWrapTitle:!0})})}}})},action:async()=>{await el.G0({environment:i,feature:e,collectionContextStore:t})}}}),[u,v,i,y,h,x,f,C,d,a,null==g?void 0:g.allFeatures,t])}}function ml(e){let{collectionContextStore:t,propertyTypes:o,onAccept:i,propertySchema:r}=e;const a=(0,S.Fg)(),c=(0,l.useIntl)(),d=(0,s.VK)((()=>{var e;return(null===(e=t.collectionStore())||void 0===e?void 0:e.getSchema())??{}}),[t]),p=(0,s.VK)((()=>t.collectionViewBlockStore()),[t]),u=n.useCallback((()=>{for(const t in d){var e;const o=d[t];if("text"===(null==o?void 0:o.type)&&"summarize"===(null===(e=o.ai_inference)||void 0===e?void 0:e.type))return!1}return!0}),[d]);return{standardAndDerivedPropertyTypes:(0,s.VK)((()=>o.filter((e=>"button"===e?(0,rl.PN)():"auto_increment_id"===e?Ie.default.checkGate("unique_id"):"verification"===e?(null==p?void 0:p.isCollectionViewPageWithContent())&&d&&!function(e,t){for(const n in e){var o;if((null===(o=e[n])||void 0===o?void 0:o.type)===t)return!0}return!1}(d,"verification"):"ai_summary"===e?u():"ai_translate"!==e||(0,ma.hu)()))),[o,p,d,u]),renderStandardOrDerivedProperty:n.useCallback(((e,o,n)=>({key:e,render:i=>{const s=(null==r?void 0:r.type)===e,l=function(e,t,o){if("auto_increment_id"===t){var n;const t=e.collectionStore(),i=null==t?void 0:t.isPageTreeCollection(),r=Boolean(null==t?void 0:t.isSyncedCollection());if(i)return Wo.default.formatMessage(cl.zU.wiki_forbidden_auto_increment_id_property);if(r)return Wo.default.formatMessage(cl.zU.synced_database_forbidden_auto_increment_id_property);if(null!=o&&o.type)return Wo.default.formatMessage(cl.zU.convert_to_auto_increment_id_property);const s=t&&t.id,a=t&&t.getFormat(),l=t&&(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id),c=t&&t.getSchema(),d=t&&t.getDeletedSchema();if(!(s&&a&&l&&c&&d))return;if(t&&(0,Qa.cj)({id:s,format:a,space_id:l,schema:c,deleted_schema:d}))return Wo.default.formatMessage(cl.zU.duplicate_auto_increment_id_property)}}(t,e,r),d=void 0!==l,p=!n&&ul.hasOwnProperty(e)&&"on"===Ie.default.getEligibleGroup({experimentId:"property_creation_tooltips_exp",defaultGroup:"control"})?c.formatMessage(ul[e]):void 0,u=(0,tt.jsx)(He.Z,{...i,checkState:s,title:(0,tt.jsx)("div",{style:{display:"inline-flex",alignItems:"center"},children:o??ke.SO[e]}),icon:(0,tt.jsx)(ta.ZP,{type:e,icon:void 0,size:16,theme:a,style:{fill:(0,b.XU)(e)?a.aiPurpleColor:a.regularIconColor}}),disabled:d,disabledFeedback:d});return Boolean(l||p)?(0,tt.jsx)(Te.ZP,{placement:Te.ug.Left,render:e=>(0,tt.jsx)("div",{...e,children:u}),renderTooltip:()=>l??p,style:{whiteSpace:"break-spaces"}}):u},action:()=>{i(e,o)}})),[r,t,c,a,i])}}const Sl=new Set;function fl(e,t){const o=(0,r.O7)(),i=(0,l.useIntl)(),a=(0,s.VK)((()=>Wn.Z.bots.state),[]),c=(0,s.VK)((()=>e.collectionStore()),[e]),d=(0,s.VK)((()=>(null==c?void 0:c.getSchema())??{}),[c]),p=(0,s.VK)((()=>!(null==c||!c.isPageTreeCollection())),[c]),u=(0,s.VK)((()=>e.databaseType),[e]),g=(0,s.VK)((()=>{var e;return null===(e=Be.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()}),[]),m=(0,s.VK)((()=>{if(void 0===t)return function(e,t){if(!e)return[];const o=Ie.default.checkGate("google_drive_connected_relation"),n=Ie.default.checkGate("figma_connected_relation"),i=Ie.default.checkGate("zendesk_connected_relation"),r=Ie.default.checkGate("cron_connected_relation"),s=Ie.default.checkGate("connected_relation"),a=e.getDatabaseType()===xi.iS,l=Wn.Z.state;if(!l.loaded)return[];const c=l.integrations,d={};if(!a){const e=c.find((e=>e.id===Ja.U9)),t=(0,za.GT)();var p;e&&(d[t.name]={name:t.name,pattern:al.x,integration:e,tooltipImage:{img:wn.Z.images.tooltips.properties.githubSyncPullStatusPng,scale:.5},description:t.description,canOnlyAdminAuth:{disabledPropertyTooltipMessage:null===(p=t.canOnlyAdminAuth)||void 0===p?void 0:p.disabledPropertyTooltipMessage}})}const u=[];if(t&&(o&&u.push(Ja.f3),n&&u.push(Ja.mQ),i&&u.push(Ja.Nw)),r&&u.push(Ja.Dv),u.forEach((e=>{const t=c.find((t=>t.id===e));if(null!=t&&t.info.original_url_patterns)for(const n of t.info.original_url_patterns){var o;null!==(o=n.additional_types)&&void 0!==o&&o.connectedRelation&&(d[n.name]||(d[n.name]={name:(0,ll.ni)({pattern:n,integration:t}),pattern:n,integration:t}))}})),!s)return Object.values(d);for(const m of c)if(m.info.original_url_patterns&&t&&![Ja.U9,Ja.f3,Ja.mQ,Ja.Dv,Ja.Nw].includes(m.id))for(const e of m.info.original_url_patterns){var g;null!==(g=e.additional_types)&&void 0!==g&&g.connectedRelation&&(d[e.name]||(d[e.name]={name:(0,ll.ni)({pattern:e,integration:m}),pattern:e,integration:m}))}return Object.values(d)}(c,g)}),[c,t,g]),S=(0,s.VK)((()=>Boolean(null==c?void 0:c.isSyncedCollection())),[c]),f=(0,dl.J)();return{connectedRelationProperties:m,renderConnectedRelationProperty:n.useCallback((t=>{const{isDisabled:n,propertyDisabledTooltip:r}=hl({propertyConfig:t,bots:a,isSpaceAdmin:f,environment:o,isWikiCollection:p,databaseType:u,isSyncedCollection:S,schema:d,intl:i,isMobile:o.device.isMobile});return{key:t.name,render:e=>{var o,i;return(0,tt.jsx)(kn,{showImage:!n,caption:r??t.description,tooltipImage:r||null===(o=t.tooltipImage)||void 0===o?void 0:o.img,tooltipImageScale:null===(i=t.tooltipImage)||void 0===i?void 0:i.scale,render:o=>(0,tt.jsx)(He.Z,{...(0,Nn.Z)(e,o),checkState:!1,title:(0,tt.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[t.name,Sl.has(t.integration.id)?(0,tt.jsx)(ns.Z,{}):null]}),icon:(0,tt.jsx)("img",{src:t.integration.info.icon,alt:t.name,style:{width:16,height:16}}),disabled:n,disabledFeedback:n})})},action:async()=>{await el.Jw({environment:o,connectedRelationProperty:t,collectionContextStore:e,intl:i})}}}),[a,e,u,o,i,f,S,p,d])}}function yl(e,t){for(const n in e){var o;const i=e[n];if(i&&"connectedRelation"in i&&(null===(o=i.connectedRelation)||void 0===o?void 0:o.integration_id)===t)return!0}return!1}function hl(e){let{propertyConfig:t,databaseType:o,bots:n,isSpaceAdmin:i,isMobile:r,isWikiCollection:s,isSyncedCollection:a,schema:l,intl:c}=e;const d="integration"in t?t.integration.id:t.integrationId;if(!d)return{isDisabled:!1};var p;if((0,w.gi)({isAuthed:Boolean(n.find((e=>e.integration_id===d))),isSpaceAdmin:i,isPropertyAdminAuthOnly:Boolean(t.canOnlyAdminAuth),isMobile:r}))return{isDisabled:!0,propertyDisabledTooltip:null===(p=t.canOnlyAdminAuth)||void 0===p?void 0:p.disabledPropertyTooltipMessage};if(d===Ja.U9){if(yl(l,Ja.U9))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(pl.duplicateGithubPropertyTooltip)};if(s)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(pl.wikiGithubPropertyTooltip)};if(a)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(pl.syncedDatabaseGithubPropertyTooltip)}}else if(d===Ja.Dv){if(yl(l,Ja.Dv),o!==xi.Fi)return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(pl.nonMeetingsCronPropertyTooltip)};if(yl(l,Ja.Dv))return{isDisabled:!0,propertyDisabledTooltip:c.formatMessage(pl.duplicateCronEventPropertyTooltip)}}return{isDisabled:!1}}const xl=(0,l.defineMessages)({searchPlaceholder:{defaultMessage:"Search or add new property",id:"database.viewSettings.propertyTypeSelect.searchPlaceholder"},suggestedSectionTitle:{defaultMessage:"Suggested",id:"database.viewSettings.propertyTypeSection.suggested"},connectedRelationSectionTitle:{defaultMessage:"Connections",id:"database.viewSettings.propertyTypeSection.connected"},typesSectionTitle:{defaultMessage:"Type",id:"database.viewSettings.propertyTab.propertyType"},newProperty:{defaultMessage:"New property",id:"database.viewSettings.newProperty"},newPropertyWithDatabaseName:{defaultMessage:"New property on {databaseName}",id:"database.viewSettings.newPropertyOnDatabase"},selectToAddNewProperty:{defaultMessage:"Select to add",id:"database.viewSettings.selectToAdd"}});function vl(e){window.__c={n:"CollectionSettingsPropertyType"};const t=(0,r.Fy)(),[o,i]=n.useState(""),{collectionContextStore:a,propertyTypes:l,onAccept:c,propertySchema:d}=e,p=(0,r.O7)(),u=(0,s.VK)((()=>{var e;return null==a||null===(e=a.collectionStore())||void 0===e||null===(e=e.getName())||void 0===e?void 0:e.toString()}),[a]),{connectedRelationProperties:g,renderConnectedRelationProperty:S}=fl(e.collectionContextStore,e.propertySchema),{standardAndDerivedPropertyTypes:f,renderStandardOrDerivedProperty:y}=ml({collectionContextStore:a,propertyTypes:l,onAccept:c,propertySchema:d}),{suggestedProperties:h,renderSuggestedProperty:x}=gl({collectionContextStore:e.collectionContextStore,propertySchema:e.propertySchema}),{derivedPropertyTypesInSuggestedSection:v}=(0,n.useMemo)((()=>{const e=new Set;for(const t of f)(0,b.XU)(t)&&"suggested"===(0,ke.to)(t)&&e.add(t);return{derivedPropertyTypesInSuggestedSection:e}}),[f]);n.useEffect((()=>{!async function(){const e=await async function(e,t){if(!(0,Zn.Ru)()||!t.permissionScopes.state.canConfigureCollection)return!1;const o=t.collectionStore(),n=t.collectionViewBlockStore();if(!n)return!1;const i=n.getFormat();if((null==i?void 0:i.app_config_uri)===xi.NB){var r;const t=await qr.JN({environment:e,collectionViewBlockStore:n,databaseUri:xi.p$});if(!t)return!1;const o=null==t?void 0:t.getCollectionStore();return Boolean(!(null!=o&&null!==(r=o.getPropertyMapping())&&void 0!==r&&r[xi.b0.StatusV2]))}var s;return(null==i?void 0:i.app_config_uri)===xi.J1&&Boolean(!(null!=o&&null!==(s=o.getPropertyMapping())&&void 0!==s&&s[xi.b0.StatusV2]))}(p,a);w(e)}()}),[a,p]);const[C,w]=(0,n.useState)(!1),j=n.useCallback((async()=>{await $a({environment:p,collectionViewBlockStore:a.collectionViewBlockStore(),collectionSettingsStore:e.collectionSettingsStore})}),[a,p,e.collectionSettingsStore]),_=(0,n.useMemo)((()=>new Map(f.map((e=>[ke.SO[e].toLowerCase(),e])))),[f]);let M=[];if(""!==o){const e=(null==h?void 0:h.reduce(((e,t)=>(e[t.name]=x(t),e)),{}))||{};for(const o of v)e[ke.SO[o]]=y(o);const t=(null==g?void 0:g.reduce(((e,t)=>(S&&(e[t.name]=S(t)),e)),{}))||{},n=m().filter(o,Object.keys(e)).flatMap((t=>e[t.original])),i=m().filter(o,Array.from(_.keys())).flatMap((e=>{const t=_.get(e.original);return!t||v.has(t)?[]:y(t)})),r=m().filter(o,Object.keys(t)).flatMap((e=>t[e.original]));n.length&&M.push({key:"suggested",render:e=>(0,tt.jsx)(_e.Z,{...e,title:Wo.default.formatMessage(xl.suggestedSectionTitle)}),items:n}),i.length&&M.push({key:"search",render:e=>(0,tt.jsx)(_e.Z,{title:Wo.default.formatMessage(xl.typesSectionTitle),...e}),items:i}),r.length&&M.push({key:"connected",render:e=>(0,tt.jsx)(_e.Z,{...e,title:Wo.default.formatMessage(xl.connectedRelationSectionTitle)}),items:r}),o.length>0&&!e.hasOwnProperty(o.toLowerCase())&&!_.has(o.toLowerCase())&&M.push({key:"custom",render:e=>(0,tt.jsx)(_e.Z,{...e,title:Wo.default.formatMessage(xl.selectToAddNewProperty)}),items:[y("text",o,!0)]})}else{const e=(null==h?void 0:h.map((e=>x(e))))??[];for(const n of v)e.push(y(n));const t=f.map((e=>v.has(e)?void 0:y(e))).filter(ne.$K),o=(null==g?void 0:g.map((e=>S&&S(e))).filter(ne.$K))??[];M=oo.oA([e.length&&{key:"suggested",render:e=>(0,tt.jsx)(_e.Z,{...e,title:Wo.default.formatMessage(xl.suggestedSectionTitle)}),items:e},t.length&&{key:"properties",render:e=>(0,tt.jsx)(_e.Z,{...e,title:Wo.default.formatMessage(xl.typesSectionTitle)}),items:t},o.length&&{key:"connected",render:e=>(0,tt.jsx)(_e.Z,{...e,title:Wo.default.formatMessage(xl.connectedRelationSectionTitle)}),items:o}])}const T=(0,tt.jsx)(_e.Z,{desktopStyle:{paddingTop:12,paddingBottom:4},children:(0,tt.jsx)(we.ZP,{focusInitial:!t.isMobile||void 0,focus:!t.isMobile||void 0,value:o,onChange:e=>{i(e.target.value)},placeholder:Wo.default.formatMessage(xl.searchPlaceholder)})});return(0,tt.jsxs)(Ce.ZP,{...e,title:t.isDesktop&&u?Wo.default.formatMessage(xl.newPropertyWithDatabaseName,{databaseName:u}):Wo.default.formatMessage(xl.newProperty),children:[T,C&&(0,tt.jsxs)(rt.Z,{style:{border:"1px solid #b3d4fc",borderRadius:5,margin:"3px 11px",padding:7,fontSize:14,color:"rgba(35, 131, 226, 1)",boxShadow:"2px 2px 3px 0px #b3d4fc",cursor:"pointer",marginTop:10},onClick:j,children:["🏃 New Sprints 💨",(0,tt.jsx)("div",{style:{fontSize:11},children:"Upgrade V1 to V2!!!"})]}),(0,tt.jsx)(Qe.Z,{disableInitialScroll:!0,type:Qe.i.Vertical,initialFocus:0,sections:M})]})}var Cl=o(34296),bl=o(71846);class wl extends i.Z{constructor(){super(...arguments),this.searchSessionId=""}renderComponent(){const{collectionContextStore:e,collectionSettingsStore:t}=this.props,o=e.collectionViewBlockStore();if(!o)return;const n=hi.default.createValue("");return(0,tt.jsx)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Related to",id:"database.viewSettings.selectNewRelationSourceTab.title"}),handleClose:()=>{ko.tW({environment:this.environment,eventName:"abandoned_search",queryLength:n.state.length,sessionId:this.searchSessionId,source:Cl.S.Relation}),d.E3({collectionSettingsStore:t})},children:(0,tt.jsx)(bl.Z,{collectionContextStore:e,onAccept:e=>function(e,t,o,n,i,r){if(!o.collectionStore())return;ko.wd({environment:t,collectionContextStore:o,action:"select_relation_source"});const{stack:s}=n.state,a=s[s.length-2];a&&"setupRelation"===a.type&&d.z$({collectionSettingsStore:n});d.FK({collectionSettingsStore:n,item:{type:"setupRelation",property:i,formatKey:r,targetCollectionPointer:e.pointer}})}(e,this.environment,this.props.collectionContextStore,this.props.collectionSettingsStore,this.props.property,this.props.formatKey),parentStore:o,context:Cl.S.Relation,searchSessionId:this.searchSessionId,inputStore:n})})}UNSAFE_willMount(){this.searchSessionId=(0,a.ZP)()}}wl.displayName="CollectionSettingsSelectRelationSource";const jl=(0,l.injectIntl)(wl);var _l=o(16257),Ml=o(79892);function Tl(e){window.__c={n:"CollectionSettingsSetupRelation"};const{collectionContextStore:t,collectionSettingsStore:o,property:i,formatKey:a,targetCollectionPointer:c,from:g}=e,m=(0,s.VK)((()=>t.collectionStore()),[t]),S=(0,s.VK)((()=>{const e=t.collectionViewBlockStore();return function(e){const{targetCollectionPointer:t,collectionStore:o,collectionViewBlockStore:n}=e;if(!t)return;if(o&&o.pointer===t)return o;return n?Ze.NW.createChildStore(n,t):void 0}({targetCollectionPointer:c,collectionStore:m,collectionViewBlockStore:e})}),[t,m,c]),f=(0,s.VK)((()=>i?$t.KV(t,i):void 0),[t,i]),y=Boolean(m&&S&&m.id===S.id),h=Boolean("relation"===(null==f?void 0:f.type)&&f.connectedRelation),x=Boolean("subitem"===g),v=Boolean("timeline_arrows_by"===g),C=(0,s.VK)((()=>t.contextType),[t]),b=(0,r.O7)(),w=(0,l.useIntl)(),j=(0,s.VK)((()=>{const e=null==m?void 0:m.getSchema();return void 0===(null==f?void 0:f.name)&&S&&e?$t.m8(w,{targetCollectionStore:S,isSelfRelation:y,sourceSchema:e,createUnique:!0,from:g}):(null==f?void 0:f.name)||""}),[m,null==f?void 0:f.name,S,w,y,g]),[_,M]=(0,n.useState)(j),[T,k]=(0,n.useState)("no_limit"),[P,V]=(0,n.useState)(x||v?{hasInverseRelation:!0,inverseName:void 0,autoRelate:{enabled:!1}}:{hasInverseRelation:!1,inverseName:void 0,autoRelate:{enabled:!1}}),F=_===j,A=(0,n.useCallback)((()=>{d.H4({collectionSettingsStore:o,item:{type:"selectRelationSource",property:i,formatKey:a}})}),[o,i,a]),B=(0,n.useCallback)((()=>{if(!P)return;const{hasInverseRelation:e,inverseName:n,autoRelate:r}=P,s=t.collectionStore(),l=t.collectionViewStore();if(!s||!S)return;const{performResult:c}=u.createAndCommit({userAction:"CollectionSettingsSetupRelation.handleAddRelation",environment:b,perform:o=>{const c=i??Po.G3({environment:b,collectionStore:s,collectionViewArgs:l&&a?{collectionViewStore:l,format:l.getFormat(),formatKey:a}:void 0,propertyType:"relation",transaction:o});if(Qo.n7({environment:b,collectionContextStore:t,collectionStore:s,property:c,propertyName:_,targetCollectionStore:S,hasInverseRelation:e,inverseName:n,autoRelate:r,propertyLimit:T,intl:w,transaction:o,from:g}),l){var d;const e=(null===(d=l.getFormat().table_properties)||void 0===d?void 0:d.find((e=>e.property===c)))??{property:c,visible:!0};p.FH({stores:[l],update:{table_properties:[...l.getFormat().table_properties??[],e]},transaction:o})}return"subitem"===g&&l?(Nt.dR({collectionViewStore:l,propertyId:c,transaction:o}),Nt.jA({environment:b,collectionContextStore:t,relationPropertyId:c,transaction:o})):"timeline_arrows_by"===g&&l&&(Xo.tF({collectionViewStore:l,newProperty:c,transaction:o}),Xo._p({collectionContextStore:t,relationPropertyId:c,transaction:o})),c}});"subitem"===g||"timeline_arrows_by"===g?(d.z$({collectionSettingsStore:o}),d.H4({collectionSettingsStore:o,item:{type:"main"}})):d.qU({collectionSettingsStore:o,property:c,formatKey:a}),ko._H({environment:b,collectionContextStore:t,from:"collectionPage"===C?"page_properties":"view_settings",property_type:"relation"})}),[P,t,S,b,o,i,a,C,_,T,w,g]);return(0,tt.jsxs)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"New relation",id:"database.viewSettings.setupRelationTab.title"}),children:[(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(we.ZP,{value:_||"",placeholder:"Property name",onChange:e=>M(e.target.value),onBlur:()=>{},onSubmit:()=>{},focusInitial:!0,selectAll:!1})}),(0,tt.jsx)(Ml.Z,{isSelfRelation:y,collectionStore:S,showAs:"chevron",onClick:A,disabled:x}),!g&&(0,tt.jsx)(_l.U,{selectedKey:T,propertyType:"relation",onChange:e=>k(e)}),S&&!h&&(0,tt.jsx)(Dn.Z,{collectionContextStore:t,targetCollectionStore:S,property:i,propertyName:_,buttonContents:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Add relation",id:"database.viewSettings.setupRelationTab.addButton.title"}),temporaryInverseState:P,setTemporaryInverseState:V,isInitialPropertyName:F,onSubmit:B,from:g}),(0,tt.jsx)(_e.Z,{children:(0,tt.jsx)(yr.Z,{href:(0,mr.UY)("guides.relations"),title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Learn about relations",id:"database.viewSettings.propertyTab.relations.learnMoreButton.title"}),analyticsFrom:"view_settings_property_relation"})})]})}var kl=o(72141),Pl=o(63143),Vl=o(76464),Fl=o(88893),Al=o(29551),Bl=o(46978);class Il extends i.Z{constructor(){super(...arguments),this.storeTypes={restrictedStore:hi.default.createClass(!1)},this.handleContinue=()=>{const e=this.stores.restrictedStore.state,{collectionContextStore:t}=this.props,o=t.collectionViewBlockStore(),n=t.settingsStore;o&&(e&&function(e){const{environment:t,store:o}=e,n=t.currentUser.id;if(!n)return;u.createAndCommit({userAction:"CollectionSettingsSyncedContentShare.restrictAccessToSyncedContent",environment:t,perform:e=>{Vl.Pk({environment:t,store:o,shouldInherit:!1,transaction:e,permissionItem:{type:"user_permission",user_id:n,role:"editor"}})}})}({environment:this.environment,store:o}),c.KIh(this.environment,{type:e?"restrict":"share"}),d.E3({collectionSettingsStore:n}))}}renderComponent(){const{collectionSettingsStore:e,collectionContextStore:t,integrationName:o,integrationIcon:n}=this.props,{restrictedStore:i}=this.stores,r=t.collectionViewBlockStore();if(!r)return;const s=this.createComputedStore((()=>{const e=fa.subscriptionDataStoreInstance.state?Fl.CM(fa.subscriptionDataStoreInstance.state):[],t=(0,Pl.m8)(oo.oA(e.map((e=>[e.userId,e.role])))),o=(0,Ve.YO)(r).map((e=>e.permissionItem));let n=!1,i=!1;for(const r of o)kl.$D(r)?n=!0:kl.ix(r)&&!kl.Wi(r.role)&&(i=!0);const s=oo.jj(oo.oA([...o.map((e=>"user_permission"===e.type?e.user_id:void 0)),...i?Object.keys(t):[]])),a=s.filter((e=>"none"!==t[e])).length,l=s.filter((e=>{const n=t[e],i=Boolean(o.filter(kl.jg).find((t=>t.user_id===e)));return Boolean(n&&i&&!kl.YX(n))})).length;return{numberOfGuests:l,numberOfUsers:a+l,isPublic:n}})),{numberOfGuests:a,numberOfUsers:c,isPublic:p}=s.state;if(!p&&1===c)return void d.E3({collectionSettingsStore:e});const u=(0,tt.jsx)("div",{style:(g=this.theme,{color:g.regularTextColor,fontWeight:ie.Z.fontWeight.semibold,fontSize:14}),children:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.header",defaultMessage:"Share synced content with"})});var g;const m=(0,tt.jsxs)(tt.Fragment,{children:[0!==a?(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithGuests",defaultMessage:"{numberOfUsers} people (including you {numberOfGuests, plural, one {and {numberOfGuests} guest} other {and {numberOfGuests} guests}})",values:{numberOfUsers:c,numberOfGuests:a}})," "]}):(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.usersWithoutGuests",defaultMessage:"{numberOfUsers} people (including you)",values:{numberOfUsers:c}})," "]}),p&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.sharedWithPublic",defaultMessage:"and those with the link"})," "]}),(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.caption.accessToIntegration",defaultMessage:"will get access to content synced from {integrationName}",values:{integrationName:o}})]}),S=(0,tt.jsx)(Al.gq,{style:{marginTop:10},children:(0,tt.jsx)(Bo.Z,{style:{flex:"0 0 100%"},isLarge:!0,onClick:this.handleContinue,children:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.continueButton",defaultMessage:"Continue"})})}),f=(0,tt.jsx)(Al.gq,{style:{paddingBottom:24},alignItems:"center",justifyContent:"center",children:(0,tt.jsx)("img",{style:{width:40},src:n})}),y=(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,initialFocus:void 0,sections:[{key:"grant_permissions",items:[{key:"allow",action:()=>null,render:e=>(0,tt.jsx)(He.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.share.title",defaultMessage:"Anyone on this page"}),shouldWrapCaption:!0,caption:m,icon:(0,tt.jsx)(Bl.Z,{isSelected:!i.state}),onClick:()=>{i.setState(!1)}})},{key:"restrict",action:()=>null,render:e=>(0,tt.jsx)(He.Z,{...e,textWrapperStyle:{textAlign:"left"},title:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.title",defaultMessage:"Only you"}),shouldWrapCaption:!0,caption:(0,tt.jsx)(l.FormattedMessage,{id:"CollectionSettingsSyncedContentShare.option.restrict.caption",defaultMessage:"You'll need to share with others using the share menu"}),icon:(0,tt.jsx)(Bl.Z,{isSelected:i.state}),onClick:()=>{i.setState(!0)}})}],render:e=>(0,tt.jsx)(_e.Z,{...e})}]});return(0,tt.jsx)(Ce.ZP,{...this.props,children:(0,tt.jsxs)(Al.gq,{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0px 16px 16px 16px"},flexDirection:"column",children:[f,(0,tt.jsxs)("div",{children:[u,y]}),S]})})}}Il.displayName="CollectionSettingsSyncedContentShare";const Zl=(0,l.injectIntl)(Il);var Dl=o(21197),Kl=o(40778),Ol=o(97004);const Rl=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Filter by…",id:"database.viewSettings.createFilterTab.inputPlaceholder"}});class El extends i.Z{constructor(){super(...arguments),this.handlePropertyAccept=e=>{if(!e)return;const{collectionContextStore:t}=this.props,o=t.collectionViewStore(),n=this.suggestedFilters.state.find((t=>t.property===e));if(!n||!o)return;const i={id:(0,a.ZP)(),filter:n};Kl.iU({environment:this.environment,collectionContextStore:t,temporaryState:{...t.temporaryState.state,propertyFilters:{value:[...Ll(this.props.collectionContextStore),i]}}}),function(e,t,o,n,i){if(ko.wd({environment:i,collectionContextStore:t,action:"create_property_filter"}),o===na.HV.FilterBar||o===na.HV.TopbarFilterPopup){Nl(t,n);const o=t.getFilterBarItemSettingsStore(e);d.wl({collectionSettingsStore:o,item:{type:"filter"}})}else if(o===na.HV.ViewSettings){Wl(n);const o=t.getFilterOptionsItemSettingsStore(e);d.wl({collectionSettingsStore:o,item:{type:"filter"}})}}(i,this.props.collectionContextStore,this.props.context,this.props.collectionSettingsStore,this.environment)},this.suggestedFilters=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props,t=e.normalizedSchemaStore.state,o=e.collectionViewStore();if(!o)return[];return(0,Ol.qd)({schema:t,filters:Ll(this.props.collectionContextStore),getRecordModel:o.getRecordModel})}),!0)}renderComponent(){var e;const{collectionContextStore:t}=this.props,o=this.suggestedFilters.state,n=Ul(this.props.collectionContextStore),i=t.permissionScopes.state;return(0,tt.jsx)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.createFilterTab.title"}),footer:i.canConfigureBlock&&(0,tt.jsx)(_e.Z,{topBorder:!0,children:(0,tt.jsx)(be.Z,{icon:n?Dl.Q:A.R,isGray:!0,title:n?(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.createFilterTab.advancedFilter.title"}):(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Add advanced filter",id:"database.viewSettings.createFilterTab.addAdvancedFilter.title"}),right:n&&(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{ruleCount, plural, one {{ruleCount} rule} other {{ruleCount} rules}}",id:"database.viewSettings.createFilterTab.advancedFilterRulesCount.title",values:{ruleCount:(null===(e=n.filters)||void 0===e?void 0:e.length)||1}}),onClick:()=>function(e,t,o,n){if(!t.collectionViewStore())return;Ul(t)||Kl.iU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryState.state,combinatorFilter:{value:C.TI}}}),zl(t,o,n,e)}(this.environment,this.props.collectionContextStore,this.props.context,this.props.collectionSettingsStore)})}),children:(0,tt.jsx)(Do.Z,{schema:t.normalizedSchemaStore.state,format:t.normalizedFormatStore.state,getProperties:()=>o.map((e=>e.property)),onAccept:this.handlePropertyAccept,inputPlaceholder:Wo.default.formatMessage(Rl.inputPlaceholder)})})}}El.displayName="CollectionSettingsViewCreateFilter";const Gl=(0,l.injectIntl)(El);function Nl(e,t){e.filtersBarOpen.setState(!0),d.z$({collectionSettingsStore:t})}function Wl(e){d.wl({collectionSettingsStore:e,item:{type:"main"}}),d.H4({collectionSettingsStore:e,item:{type:"filters"}})}function Ll(e){return e.currentPropertyFiltersStore.state}function Ul(e){return e.currentCombinatorFilterStore.state}function zl(e,t,o,n){ko.wd({environment:n,collectionContextStore:e,action:"create_combinator_filter"}),t===na.HV.FilterBar||t===na.HV.TopbarFilterPopup?(Nl(e,o),d.wl({collectionSettingsStore:e.filterBarCombinatorFilterSettingsStore,item:{type:"filter"}})):t===na.HV.ViewSettings&&(Wl(o),d.wl({collectionSettingsStore:e.filterOptionsCombinatorFilterSettingsStore,item:{type:"filter"}}))}const Hl=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Sort by…",id:"database.viewSettings.createSortTab.inputPlaceholder"}});const $l=function(e){window.__c={n:"CollectionSettingsViewCreateSort"};const{context:t,collectionContextStore:o,collectionSettingsStore:n}=e,i=(0,r.O7)(),a=(0,l.useIntl)(),c=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),p=(0,s.VK)((()=>o.normalizedFormatStore.state),[o]),u=(0,s.VK)((()=>ql(o)),[o]);return(0,tt.jsx)(Ce.ZP,{...e,collectionContextStore:o,collectionSettingsStore:n,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"New sort",id:"database.viewSettings.createSortTab.title"}),children:(0,tt.jsx)(Do.Z,{schema:c,format:p,getProperties:()=>Object.keys(c).filter((e=>!u.find((t=>t.property===e)))),onAccept:e=>function(e,t,o,n,i){var r;if(!e)return;const s=o.collectionViewStore(),a=o.normalizedSchemaStore.state;if(!s||!a)return;const l=null===(r=a[e])||void 0===r?void 0:r.type;ko.wd({environment:t,collectionContextStore:o,action:"create_sort_accept",original_view_type:s.getType(),property_type:l});const c={property:e,direction:"ascending"},p=[...ql(o),c];if(Kl.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryState.state,sorts:{value:p}}}),n===na.HV.TopbarSortPopup||n===na.HV.FilterBar){o.filtersBarOpen.setState(!0),d.z$({collectionSettingsStore:i});const{filterBarSortSettingsStore:e}=o;d.wl({collectionSettingsStore:e,item:{type:"sort"}})}else n===na.HV.ViewSettings&&(d.wl({collectionSettingsStore:i,item:{type:"main"}}),d.H4({collectionSettingsStore:i,item:{type:"sort"}}))}(e,i,o,t,n),inputPlaceholder:a.formatMessage(Hl.inputPlaceholder)})})};function ql(e){return e.currentSortsStore.state}var Yl=o(18245),Ql=o(6758),Xl=o(8982);const Jl=function(e){window.__c={n:"CollectionSettingsViewFilter"};const{collectionContextStore:t,context:o,collectionSettingsStore:n}=e,i=(0,r.O7)(),a=(0,s.VK)((()=>t.collectionViewStore()),[t]),c=(0,s.VK)((()=>t.normalizedSchemaStore.state),[t]),p=(0,s.VK)((()=>function(e){return e.currentCombinatorFilterStore.state}(t)),[t]),u=(0,s.VK)((()=>null==a?void 0:a.getType()),[a]);return a&&p&&u?(0,tt.jsxs)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Advanced filter",id:"database.viewSettings.filterTab.title"}),unconstrainedWidth:!0,children:[(0,tt.jsx)(Xl.D,{children:(0,tt.jsx)(Ql.Pq,{index:0,level:0,combinatorFilter:p,schema:c,onChange:(e,o)=>function(e,t,o,n){var i;const r=null===(i=n.remoteResult.state)||void 0===i?void 0:i.sizeHint,s=Yl.default.mark("collections.update_filter_lag");Yl.default.measureAfterNextFlush(s,{environment:o,getData:()=>ii.Y5({from:"combinator_filter",collectionContextStore:n,sizeHintAtStart:r})}),Kl.iU({environment:o,collectionContextStore:n,temporaryState:{...n.temporaryState.state,combinatorFilter:{value:t}}}),ko.wd({environment:o,collectionContextStore:n,action:"update_combinator_filter"})}(0,o,i,t),collectionViewType:u,collectionViewId:a.id,parentStore:a})}),(0,tt.jsx)(_e.Z,{topBorder:!0,children:(0,tt.jsx)(be.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Delete filter",id:"database.viewSettings.filterTab.deleteFilterButton.title"}),onClick:()=>function(e,t,o,n){Kl.iU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryState.state,combinatorFilter:{value:void 0}}}),o===na.HV.FilterBar&&d.E3({collectionSettingsStore:n});ko.wd({environment:e,collectionContextStore:t,action:"delete_combinator_filter"})}(i,t,o,n)})})]}):null};var ec=o(28398),tc=o(40121),oc=o(58814),nc=o(19699);class ic extends i.Z{constructor(){super(...arguments),this.localStateHasChangesStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props;return(0,Ol.yU)(e)}))}renderComponent(){const{collectionContextStore:e}=this.props,{device:t}=this.environment,o=e.currentPropertyFiltersStore.state,n=o.map((e=>e.id)),i=e.permissionScopes.state,r=i.canConfigureBlock?e.currentCombinatorFilterStore.state:void 0;return(0,tt.jsx)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Filters",id:"database.viewSettings.filtersTab.title"}),footer:this.localStateHasChangesStore.state&&(0,tt.jsx)(_e.Z,{topBorder:!0,children:(0,tt.jsx)(sc,{collectionContextStore:this.props.collectionContextStore})}),unconstrainedWidth:!0,children:(0,tt.jsxs)(_e.Z,{desktopStyle:{paddingBottom:24},children:[(n.length>0||r)&&(0,tt.jsxs)("div",{style:t.isMobile?{paddingTop:8,background:this.theme.contentBackground}:void 0,children:[r&&(0,tt.jsx)(lc,{collectionContextStore:this.props.collectionContextStore}),ac(this.environment)?(0,tt.jsx)(hr.ZP,{direction:"vertical",keys:n,renderKey:e=>{const t=n.indexOf(e);return(0,tt.jsx)(cc,{collectionContextStore:this.props.collectionContextStore,filter:o[t]})},onDrop:e=>function(e,t,o){if(!o.collectionViewBlockStore())return;const n=o.currentPropertyFiltersStore.state,i=oo.oA(e.map((e=>n.find((t=>t.id===e)))));Kl.iU({environment:t,collectionContextStore:o,temporaryState:{...o.temporaryState.state,propertyFilters:{value:i}}}),ko.wd({environment:t,collectionContextStore:o,action:"reorder_filters"})}(e,this.environment,this.props.collectionContextStore),disabled:!i.canConfigureBlock}):n.map((e=>{const t=n.indexOf(e);return(0,tt.jsx)(cc,{collectionContextStore:this.props.collectionContextStore,filter:o[t]},e)}))]}),(0,tt.jsx)(He.Z,{focused:!1,icon:(0,A.R)({width:14,marginLeft:4,marginRight:4,fill:this.theme.mediumIconColor}),style:{color:this.theme.mediumTextColor},title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Add filter",id:"database.viewSettings.filtersTab.newFilter.title"}),onClick:()=>function(e,t,o){ko.wd({environment:e,collectionContextStore:o,action:"click_new_filter"}),d.H4({collectionSettingsStore:t,item:{type:"createFilter"}}),o.filtersBarOpen.setState(!0)}(this.environment,this.props.collectionSettingsStore,this.props.collectionContextStore)})]})})}}ic.displayName="CollectionSettingsViewFilters";const rc=(0,l.injectIntl)(ic);function sc(e){let{collectionContextStore:t}=e;return(0,tt.jsx)(ec.ZP,{context:ec.R1.SettingsFilters,collectionContextStore:t})}function ac(e){return!e.device.isMobile}function lc(e){let{collectionContextStore:t}=e;window.__c={n:"CombinatorFilter"};const o=(0,r.O7)();return(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[ac(o)&&(0,tt.jsx)(xr.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6,opacity:.4,cursor:void 0}}),(0,tt.jsx)(oc.Z,{context:tc.P.SettingsFilters,collectionContextStore:t,collectionSettingsStore:t.filterOptionsCombinatorFilterSettingsStore})]})}function cc(e){let{filter:t,collectionContextStore:o}=e;window.__c={n:"PropertyFilterComponent"};const n=(0,r.O7)(),i=(0,s.VK)((()=>o.getFilterOptionsItemSettingsStore(t)),[o,t]);return(0,tt.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 10px"},children:[ac(n)&&(0,tt.jsx)(xr.ZP,{iconSize:12,style:{marginLeft:6,marginRight:6}}),(0,tt.jsx)(nc.Z,{id:t.id,context:tc.P.SettingsFilters,collectionContextStore:o,collectionSettingsStore:i},t.id)]})}var dc=o(74194);class pc extends i.Z{constructor(){super(...arguments),this.storeTypes={inputValue:hi.default.createClass("")},this.handleChangeDebounced=oo.Ds((e=>{void 0!==e&&this.props.onChange(e)}),300)}UNSAFE_willMount(e){this.stores.inputValue.setState(e.value.toString())}renderComponent(){const e=this.stores.inputValue.state;return(0,tt.jsx)(dc.Z,{type:"number",value:e,inputClassName:"input-hide-arrows",style:{background:this.theme.contentBackground},onChange:e=>{const t=e.target.value,o=parseFloat(t);isNaN(o)?this.handleChangeDebounced(void 0):this.handleChangeDebounced(o),this.stores.inputValue.setState(t)}})}}pc.displayName="CollectionViewGroupMenuNumberInput";const uc=pc;const gc=(0,l.injectIntl)((function(e){let{numberGroupBy:t,collectionContextStore:o,schema:n,onChange:i}=e;window.__c={n:"CollectionViewNumberGroupMenu"};const r=(0,S.Fg)(),a=n[t.property];return(0,s.VK)((()=>o.collectionStore()),[o])&&a?(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(_e.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,tt.jsx)(l.FormattedMessage,{id:"database.groupMenu.numberGroupRange",defaultMessage:"Group range"}),isTitleUppercase:!1,children:(0,tt.jsxs)("div",{style:{display:"flex",paddingLeft:14,paddingRight:14},children:[(0,tt.jsx)(mc,{onChange:i,numberGroupBy:t,inputKey:"start"}),(0,tt.jsx)("span",{style:{color:r.mediumTextColor,margin:"0 8px"},children:"–"}),(0,tt.jsx)(mc,{onChange:i,numberGroupBy:t,inputKey:"end"})]})}),(0,tt.jsx)(_e.Z,{topBorder:!1,disableMobileBorders:!0,title:(0,tt.jsx)(l.FormattedMessage,{id:"database.groupMenu.numberGroupSize",defaultMessage:"Group every"}),isTitleUppercase:!1,children:(0,tt.jsxs)("div",{style:{paddingLeft:14,paddingRight:14},children:[(0,tt.jsx)(mc,{onChange:i,numberGroupBy:t,inputKey:"size"}),(0,tt.jsxs)("span",{style:{color:r.mediumTextColor,fontSize:12},children:[(0,tt.jsx)(Sr.Z,{groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start,end:t.start+t.size}}},schema:n,currentGroups:[],disabled:!0,isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ",(0,tt.jsx)(Sr.Z,{groupBy:t,groupFormat:{property:t.property,value:{type:"number",value:{type:"range",start:t.start+t.size,end:t.start+2*t.size}}},schema:n,currentGroups:[],disabled:!0,isHiddenGroup:!1,style:{display:"inline",paddingRight:0,paddingLeft:0},collectionContextStore:o}),", ..."]})]})})]}):null}));function mc(e){let{numberGroupBy:t,inputKey:o,onChange:n}=e;return(0,tt.jsx)(uc,{value:t[o],onChange:e=>{"size"===o&&e<=0&&(e=1),"start"===o&&e>t.end&&(e=t.end),"end"===o&&e<t.start&&(e=t.start),n({newNumberGroupBy:{...t,[o]:e}})}})}const Sc=(0,l.injectIntl)((function(e){return(0,tt.jsx)(Ce.ZP,{...e,title:(0,tt.jsx)(fc,{collectionSettingsStore:e.collectionSettingsStore,collectionContextStore:e.collectionContextStore}),children:(0,tt.jsx)(yc,{groupByKey:e.groupByKey,groupsFormatKey:e.groupsFormatKey,collectionContextStore:e.collectionContextStore})})}));function fc(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"Title"};const n=(0,s.VK)((()=>(0,It.n)(t)),[t]),i=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),r=(0,s.VK)((()=>o.normalizedFormatStore.state),[o]);if(!n||"groupByNumber"!==n.type)return null;const a=r[n.groupByKey];return a?Tr({groupBy:a,schema:i})??null:null}function yc(e){let{groupByKey:t,groupsFormatKey:o,collectionContextStore:n}=e;window.__c={n:"Content"};const i=(0,r.O7)(),a=(0,s.VK)((()=>n.collectionViewStore()),[n]),l=(0,s.VK)((()=>n.normalizedSchemaStore.state),[n]),c=(0,s.VK)((()=>function(e,t){return e.normalizedFormatStore.state[t]}(n,t)),[n,t]);if(!c||!a)return null;const d=Vr(c);return d?(0,tt.jsx)(gc,{numberGroupBy:d,disabled:!1,schema:l,onChange:e=>{if("number"===c.type)u.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,perform:n=>{p.FH({stores:[a],update:{[t]:e.newNumberGroupBy,[o]:void 0},transaction:n})}});else if("formula"===c.type){const n=oo.CE(e.newNumberGroupBy,"property"),r={...c,groupBy:n};u.createAndCommit({userAction:"CollectionSettingsViewGroupByNumber.renderContent",environment:i,perform:e=>{p.FH({stores:[a],update:{[t]:r,[o]:void 0},transaction:e})}})}ko.wd({environment:i,collectionContextStore:n,action:"group_by_number_update",original_view_type:void 0,property_type:c.type})},collectionContextStore:n}):null}const hc=function(e){window.__c={n:"CollectionSettingsViewGroupByProperty"};const{collectionContextStore:t,collectionSettingsStore:o,groupByKey:n,groupsFormatKey:i}=e,a=(0,r.O7)(),l=(0,s.VK)((()=>(0,It.n)(o)),[o]),c=(0,s.VK)((()=>t.collectionViewBlockStore()),[t]),g=(0,s.VK)((()=>t.collectionViewStore()),[t]),m=(0,s.VK)((()=>null==g?void 0:g.getType()),[g]),S=(0,s.VK)((()=>function(e,t){return e.normalizedFormatStore.state[t]}(t,n)),[t,n]),f=(0,s.VK)((()=>t.normalizedSchemaStore.state),[t]),y=(0,s.VK)((()=>t.normalizedFormatStore.state),[t]),h=(0,s.VK)((()=>void 0!==m&&(0,gr._1)({viewType:m,groupByKey:n})),[n,m]),x=(0,s.VK)((()=>function(e){const t=e.normalizedSchemaStore.state;return Object.entries(t).sort(xc).map((e=>e[0])).filter((e=>{const o=t[e];return o&&(0,pr.LG)(o)}))}(t)),[t]);return c&&g&&l&&m&&"groupByProperty"===l.type?(0,tt.jsx)(Ce.ZP,{...e,collectionContextStore:t,collectionSettingsStore:o,title:jr(l.groupByKey,m),children:(0,tt.jsx)(Do.Z,{schema:f,format:y,currentProperty:null==S?void 0:S.property,showNoneOption:h,getProperties:()=>x,onAccept:e=>function(e,t,o,n,i,r){const s=o.collectionViewStore(),a=o.normalizedSchemaStore.state;if(!s)return;if(e){const n=a[e];if(!n||!(0,pr.LG)(n))return;const l=(0,pr.fw)(e,n,"collectionTypedView"===o.contextType);u.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{p.FH({stores:[s],update:{[i]:l,[r]:void 0},transaction:e})}}),ko.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept",original_view_type:void 0,property_type:n.type})}else u.createAndCommit({userAction:"CollectionSettingsViewGroupByProperty.handlePropertyAccept",environment:t,perform:e=>{p.FH({stores:[s],update:{[i]:void 0,[r]:void 0},transaction:e})}}),ko.wd({environment:t,collectionContextStore:o,action:"group_by_property_accept"});d.wl({collectionSettingsStore:n,item:{type:"main"}}),d.H4({collectionSettingsStore:n,item:{type:"group",groupByKey:i,groupsFormatKey:r}})}(e,a,t,o,n,i)})}):null};function xc(e,t){var o,n;const i=null==e||null===(o=e[1])||void 0===o?void 0:o.name,r=null==t||null===(n=t[1])||void 0===n?void 0:n.name;return i&&r?i.localeCompare(r,void 0,{sensitivity:"base"}):i?1:r?-1:0}const vc=(0,l.injectIntl)((function(e){return(0,tt.jsx)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Layout",id:"database.viewSettings.layoutTab.title"}),desktopWidth:290,children:(0,tt.jsx)(Ti.Z,{...e})})}));var Cc=o(75544),bc=o(75117);class wc extends i.Z{constructor(){super(...arguments),this.localStateHasChangesStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props;return(0,Ol.Mj)(e)}))}renderComponent(){const{collectionContextStore:e,context:t}=this.props,o=e.permissionScopes.state,n=t===na.HV.ViewSettings&&this.localStateHasChangesStore.state,i=e.collectionViewStore();if(i)return(0,tt.jsx)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.sortTab.title"}),footer:n&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{style:{paddingTop:24}}),(0,tt.jsx)(_e.Z,{topBorder:!0,children:(0,tt.jsx)(Mc,{collectionContextStore:this.props.collectionContextStore})})]}),unconstrainedWidth:!0,children:(0,tt.jsx)(bc.Z,{collectionViewStore:e.collectionViewStore(),schema:e.normalizedSchemaStore.state,format:e.normalizedFormatStore.state,sorts:_c(this.props.collectionContextStore),disabled:!o.canConfigureBlock,parentStore:i,onChange:e=>function(e,t,o){!function(e,t,o){if(!t.collectionViewStore())return;Kl.iU({environment:o,collectionContextStore:t,temporaryState:{...t.temporaryState.state,sorts:{value:e}}})}(e,o,t)}(e,this.environment,this.props.collectionContextStore),showDeleteAll:!0,onDeleteAll:()=>function(e,t){t===na.HV.FilterBar&&d.E3({collectionSettingsStore:e})}(this.props.collectionSettingsStore,this.props.context)})})}}wc.displayName="CollectionSettingsViewSort";const jc=(0,l.injectIntl)(wc);function _c(e){return e.currentSortsStore.state}function Mc(e){let{collectionContextStore:t}=e;return(0,tt.jsx)(ec.ZP,{context:ec.R1.SettingsSort,collectionContextStore:t})}var Tc=o(59753),kc=o(47425);var Pc=o(75553),Vc=o(1436),Fc=o(60291),Ac=o(69619),Bc=o(15157),Ic=o(38737),Zc=o(16402),Dc=o(16011);class Kc extends i.Z{constructor(e){super(e),this.storeTypes={nextSync:hi.default.createClass(void 0),uri:hi.default.createClass(void 0),botId:hi.default.createClass(void 0)},this.reducer={type:"aggregation",filter:void 0,aggregation:{aggregator:"count",property:"title"}},this.setNextSync=this.setNextSync.bind(this)}didMount(){const e=this.stores.uri.state,t=this.stores.botId.state;if(e&&t){const o=`${t}:${e}`,n=Bc.Z.get({userId:this.environment.currentUser.id,key:o});this.setNextSync(n)}}renderComponent(){var e;const{collectionContextStore:t}=this.props,o=t.collectionStore(),n=null==o?void 0:o.getFormatStore(),i=null==n?void 0:n.getKeyStore("uri").getValue(),r=null==n?void 0:n.getKeyStore("bot_id").getValue(),s=null==o||null===(e=o.pointer)||void 0===e?void 0:e.spaceId,a=Be.default.state.currentSpaceStore,c=null==n?void 0:n.getKeyStore("original_url").getValue(),d=(0,ll.wY)(c,s),p=t.collectionViewBlockStore(),u=Ie.default.checkGate("free_tier_sync_database")||a&&!(0,kc.QM)(a.getSubscriptionTier());return this.stores.uri.setState(i),this.stores.botId.setState(r),(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(_e.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Source database",id:"database.viewSettings.syncedSourceTab.sourceDatabase"}),children:(0,tt.jsx)(Te.ZP,{placement:Te.ug.Left,alignment:Te.v2.Center,renderTooltip:()=>p&&(0,tt.jsx)(Dc.Z,{store:p,compactFormat:!0}),render:e=>(0,tt.jsx)(vr.Z,{...e,title:d,icon:(0,tt.jsx)(li.Z,{disabled:!0,icon:null==o?void 0:o.getIcon(),isEmptyPage:!1,size:20,style:Ec(this.environment,this.theme).menuItemIcon}),style:Ec(this.environment,this.theme).menuItemTitle})}),style:{paddingBottom:0}}),(0,tt.jsx)(_e.Z,{children:this.renderLimitMenuItem()}),(0,tt.jsxs)(_e.Z,{topBorder:!0,children:[u&&i&&r&&this.renderSyncButton({uri:i,botId:r}),(0,tt.jsx)(be.Z,{isGray:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Copy debugging information",id:"database.viewSettings.syncedSourceTab.copyDebugging"}),icon:Pc.U,onClick:()=>{const e={uri:i,botId:r,spaceId:s};ti.RD({environment:this.environment,stringValue:JSON.stringify(e,null,2),copiedMessage:ti.tq.copiedLinkToClipboard})}}),(0,tt.jsx)(je.Z,{href:`${sl.default.domainBaseUrl}?target=connected_apps`,children:(0,tt.jsx)(be.Z,{icon:Vc.g,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Manage my connections",id:"database.viewSettings.syncedSourceTab.manageConnections"}),isGray:!0})}),(0,tt.jsx)(yr.Z,{href:(0,mr.UY)("guides.syncedDatabases"),title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Learn about synced databases",id:"database.viewSettings.syncedSourceTab.learnMoreButton.title."}),analyticsFrom:"view_settings_source"})]})]})}renderCountRowValue(e){const{collectionContextStore:t}=this.props;return(0,tt.jsx)(fr.Z,{id:"table:uncategorized:title:count",collectionContextStore:t,reducer:this.reducer,render:t=>{const o=t.state;if(!o||"aggregation"!==o.type)return;if("number"!==o.aggregationResult.type)return;const n={...o.aggregationResult,value:o.aggregationResult.value&&Math.min(e,o.aggregationResult.value)};return(0,Ic.uf)(n.value,"number_with_commas",this.props.intl)}})}renderLimitMenuItem(){const{collectionContextStore:e}=this.props,t=e.collectionStore(),o=null==t?void 0:t.getFormatStore(),n="row_limit_exceeded"===(null==o?void 0:o.getKeyStore("sync_state").getKeyStore("syncing").getValue()),i=Be.default.state.currentSpaceStore,r=this.createComputedStore((()=>{var e;return function(e){if(!e)return 2e4;const t=Tc.kk.fromSpace(e),o=t.getSetting("database_sync_row_limit");return void 0!==o?o:(0,kc.QM)(t.getSubscriptionTier())?100:2e4}(null===(e=Be.default.state.currentSpaceStore)||void 0===e?void 0:e.getModel())}));return(0,tt.jsx)(vr.Z,{title:(0,tt.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[n&&i&&(0,kc.QM)(i.getSubscriptionTier())&&(0,tt.jsx)(Te.ZP,{placement:Te.ug.Left,alignment:Te.v2.Center,renderTooltip:()=>(0,tt.jsx)(l.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.limitFree.toolTip",defaultMessage:"Free Plans are limited to 1 synced database with up to 100 rows."}),render:e=>(0,tt.jsx)("div",{...e,children:(0,Ee.t)({fill:(0,Hn.fi)("orange",this.theme).fill,marginRight:14,width:12,alignSelf:"center"})})}),(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Limit",id:"database.viewSettings.syncedSourceTab.limit"})]}),right:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{value}/{limit} rows",id:"database.viewSettings.syncedSourceTab.limitRows",values:{value:this.renderCountRowValue(r.state),limit:(0,Ic.uf)(r.state,"number_with_commas",this.props.intl)}}),style:Ec(this.environment,this.theme).menuItem})}renderSyncButton(e){const{uri:t,botId:o}=e,n=this.stores.nextSync.state,i=!n||n<Date.now();return function(e,t){var o;const n=e.numberChildrenUnfurled.state,i=e.numberChildrenReceived.state,r=n/i,s=!0===(null===(o=e.collectionStore())||void 0===o||null===(o=o.getFormat().sync_state)||void 0===o?void 0:o.syncing),a=t.device.isMobile,l=s&&a;return n&&i&&r<1&&!a||l}(this.props.collectionContextStore,this.environment)?(0,tt.jsx)(vr.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Syncing",id:"database.viewSettings.syncedSourceTab.isSyncing"}),icon:(0,Fc.b)(Ec(this.environment,this.theme).menuItemIcon,"sync-spinner"),style:Ec(this.environment,this.theme).menuItem}):i?(0,tt.jsx)(be.Z,{isGray:!0,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"{message}",id:"database.viewSettings.syncedSourceTab.syncNow",values:{message:Rc().defaultMessage,description:Rc().description}}),icon:Fc.b,onClick:async()=>{var e,i;const r=null===(e=this.props.collectionContextStore.collectionStore())||void 0===e?void 0:e.id,s=!0===(null===(i=this.props.collectionContextStore.collectionStore())||void 0===i?void 0:i.getFormat().stale);r&&await d.R0({environment:this.environment,uri:t,botId:o,collectionId:r,nextSync:n,setNextSync:this.setNextSync,isStale:s})}}):(0,tt.jsx)(vr.Z,{title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Sync available in {timeToNextSync}",id:"database.viewSettings.syncedSourceTab.syncNow.disabled",values:{timeToNextSync:(0,Zc.hH)(Date.now(),n)}}),icon:(0,Ac.T)(Ec(this.environment,this.theme).menuItemIcon),style:Ec(this.environment,this.theme).menuItem})}setNextSync(e){this.stores.nextSync.setState(e)}}Kc.displayName="CollectionSettingsViewSyncedSource";const Oc=(0,l.injectIntl)(Kc);function Rc(){const e=Be.default.state.currentSpaceStore,t=e&&(0,kc.QM)(e.getSubscriptionTier());return{defaultMessage:t?"Clear and sync database":"Sync database",description:t?"Clears and refreshes the database ":"Refreshes the synced database."}}function Ec(e,t){const o=e.device.isMobile;return{menuItemTitle:{paddingLeft:o?4:8},menuItem:{color:t.mediumTextColor,paddingLeft:o?4:8},menuItemIcon:{height:16,width:16,marginRight:2}}}class Gc extends i.Z{constructor(){super(...arguments),this.searchSessionId=""}renderComponent(){var e;const{collectionContextStore:t,collectionSettingsStore:o}=this.props,n=Boolean(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewSourceCollectionStore()),i=t.collectionViewBlockStore();if(!i)return;const r=hi.default.createValue("");return(0,tt.jsx)(Ce.ZP,{...this.props,title:(0,tt.jsx)(l.FormattedMessage,{defaultMessage:"Source",id:"database.viewSettings.sourceTab.title"}),handleClose:()=>{ko.tW({environment:this.environment,eventName:"abandoned_search",sessionId:this.searchSessionId,source:Cl.S.Source,queryLength:r.state.length}),d.E3({collectionSettingsStore:o})},children:n?(0,tt.jsx)(Oc,{collectionContextStore:t}):(0,tt.jsx)(bl.Z,{collectionContextStore:t,parentStore:i,onAccept:e=>function(e,t,o,n){u.createAndCommit({userAction:"CollectionSettingsViewSource.handleSourcePickerAccept",environment:t,perform:n=>{Vo.yc({environment:t,collectionContextStore:o,collectionStore:e,transaction:n})}}),d.z$({collectionSettingsStore:n})}(e,this.environment,this.props.collectionContextStore,this.props.collectionSettingsStore),context:Cl.S.Source,searchSessionId:this.searchSessionId,inputStore:r})})}UNSAFE_willMount(){this.searchSessionId=(0,a.ZP)()}}Gc.displayName="CollectionSettingsViewSource";const Nc=(0,l.injectIntl)(Gc);var Wc=o(5336),Lc=o(69651),Uc=o(54582),zc=o(37694),Hc=o(88177),$c=o(5377),qc=o(53523);function Yc(e){window.__c={n:"SprintSettingsMenu"};const{collectionContextStore:t,collectionSettingsStore:o}=e,{sprintSettingsConfig:n,sprintSettingsPermissionsContext:i,sprintSettingsConfigUpdater:r,turnOffSprints:s,turnOnSprints:a,automaticSprintCompletionEnabled:l,canManageSprintFromThisView:c,manageSprintFromThisView:d}=er({collectionContextStore:t,collectionSettingsStore:o});if(!i||!i.canEdit||!n)return null;let p;return"displayOn"===i.displayStatus?p=(0,tt.jsx)(Qc,{...e,updateSprintSettingsConfig:r,onTurnOffSprints:s,automaticSprintCompletionEnabled:l,canManageSprintFromThisView:c,onManageSprintFromThisView:d,sprintSettingsConfig:n}):"displayOff"===i.displayStatus?p=(0,tt.jsx)(Xc,{...e,onTurnOnSprints:a}):(0,ne.t1)(i.displayStatus),p}function Qc(e){window.__c={n:"SprintSettingsEnabledMenuView"};const{sprintSettingsConfig:t,automaticSprintCompletionEnabled:o,canManageSprintFromThisView:n,updateSprintSettingsConfig:i,collectionContextStore:r,onTurnOffSprints:s,onManageSprintFromThisView:a}=e,c=dd(),d=[];return d.push((0,tt.jsxs)(_e.Z,{topBorder:!0,disableMobileBorders:!0,children:[n&&(0,tt.jsx)(id,{automaticSprintCompletionEnabled:o,manageSprintFromThisView:a}),(0,tt.jsx)(nd,{turnOffSprints:s,collectionContextStore:r}),(0,tt.jsx)(je.Z,{href:"https://www.notion.so/help/sprints",external:!0,children:(0,tt.jsx)(be.Z,{icon:P.m,iconStyle:c.icon,title:(0,tt.jsx)(l.FormattedMessage,{...us.learnSprintsTitle}),isGray:!0})})]},"turn-off-sprints-section")),(0,tt.jsxs)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{...us.sprintsMenuTitle}),footer:d,children:[(0,tt.jsxs)(_e.Z,{children:[(0,tt.jsx)(sd,{onChange:i.handleSprintDurationChange,disabled:!i.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,tt.jsx)(ad,{onChange:i.handleSprintStartWeekdayChange,disabled:!i.canUpdateSprintSettingsConfig,sprintSettingsConfig:t}),(0,tt.jsx)(ld,{onChange:i.handleSprintRemainingTasksBehaviorChange,disabled:!i.canUpdateSprintSettingsConfig,sprintSettingsConfig:t})]}),(0,tt.jsx)(_e.Z,{topBorder:!0,children:(0,tt.jsx)(rd,{onChange:i.handleSprintAutoCompleteChange,sprintSettingsConfig:t})})]})}function Xc(e){window.__c={n:"SprintSettingsDisabledMenuView"};const{onTurnOnSprints:t}=e,o=dd(),n=[];return n.push((0,tt.jsx)(_e.Z,{disableMobileBorders:!0,children:(0,tt.jsx)("div",{style:o.buttonWrap,children:(0,tt.jsx)(Bo.Z,{style:o.button,onClick:async()=>{await t()},isLarge:!0,children:(0,tt.jsx)(l.FormattedMessage,{...us.turnOnSprints})})})},"turn-on-sprints-section")),(0,tt.jsx)(Ce.ZP,{...e,title:(0,tt.jsx)(l.FormattedMessage,{...us.setupSprintsTitle}),footer:n,children:(0,tt.jsxs)(_e.Z,{disableMobileBorders:!0,children:[(0,tt.jsx)(Jc,{}),(0,tt.jsx)(ed,{}),(0,tt.jsx)(td,{})]})})}function Jc(){window.__c={n:"SprintSettingsMenuDescription"};const e=dd();return(0,tt.jsx)("div",{style:{...e.menuDescriptionContainer,...e.menuDescriptionText},children:(0,tt.jsx)(l.FormattedMessage,{...us.setupSprintsCaption})})}function ed(){window.__c={n:"SprintSettingsPreviewMedia"};const e=dd();return(0,tt.jsx)("div",{style:e.mediaWrap,children:(0,tt.jsx)("div",{style:e.media,children:(0,$c.y)(e.mediaIcon)})})}function td(){window.__c={n:"SprintSettingsDisclaimer"};const e=dd(),t=t=>(0,tt.jsx)("span",{style:e.boldText,children:t});return(0,tt.jsxs)("div",{style:e.disclaimerWrap,children:[(0,tt.jsx)("div",{children:(0,tt.jsx)(l.FormattedMessage,{...us.setupSprintsTeamspaceStatement})}),(0,tt.jsx)(od,{text:(0,tt.jsx)(l.FormattedMessage,{...us.setupSprintsSprintBoardPageStatement,values:{bold:t}}),icon:Ni.L}),(0,tt.jsx)(od,{text:(0,tt.jsx)(l.FormattedMessage,{...us.setupSprintsSprintsDatabaseStatement,values:{bold:t}}),icon:Hc.t})]})}function od(e){window.__c={n:"SprintSettingsDisclaimerSubitem"};const{text:t,icon:o}=e,n=dd();return(0,tt.jsxs)("div",{style:n.disclaimerSubitem,children:[(0,tt.jsx)("div",{children:o(n.disclaimerSubitemIcon)}),(0,tt.jsx)("div",{children:t})]})}function nd(e){window.__c={n:"TurnOffSprintsButton"};const{collectionContextStore:t,turnOffSprints:o}=e,n=(0,r.O7)(),i=(0,s.VK)((()=>t.sprintSettingsContextStore.state),[t.sprintSettingsContextStore]),[{value:a}]=(0,qn.r5)((async()=>{if(null==i||!i.taskCollectionStore||null==i||!i.taskCollectionViewBlockStore)return;return await async function(e){var t;const{environment:o,collectionStore:n,collectionViewBlockStore:i}=e,{appConfigs:r}=await ls.deps.AppTemplates.loader(),s=i.getSpaceId(),a=i.getParentStore(),l=null===(t=n.getFormat())||void 0===t?void 0:t.app_config_uri,c=l&&(0,Zn.YB)(r(),l);if(!a||a.table!==ss.bx&&a.table!==Yi.iU&&a.table!==as.e0||!c)return;const d=await ei.getSprintBoardViewBlocks(o,{spaceId:s,taskCollectionId:n.id,parentId:a.id,parentTable:a.table});return"success"===(null==d?void 0:d.type)?d.data.result:[]}({environment:n,collectionStore:i.taskCollectionStore,collectionViewBlockStore:i.taskCollectionViewBlockStore})}),[n,null==i?void 0:i.taskCollectionStore,null==i?void 0:i.taskCollectionViewBlockStore]),c=dd();return(0,tt.jsx)(be.Z,{icon:ze.y,title:(0,tt.jsx)(l.FormattedMessage,{...us.turnOffSprints}),isRed:!0,iconStyle:c.icon,onClick:()=>{Fo.showDialog({description:(0,tt.jsx)(xs,{numOfSprintBoards:a?a.length:0}),message:(0,tt.jsx)("div",{style:c.modalTitle,children:(0,tt.jsx)(l.FormattedMessage,{...us.turnOffSprintsModalTitle})}),innerStyle:c.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,tt.jsx)(l.FormattedMessage,{...us.turnOffAndDeleteModalButton}),color:"red",onAccept:async()=>{await o(a??[])}}]})}})}function id(e){window.__c={n:"ManageSprintFromThisViewButton"};const{automaticSprintCompletionEnabled:t,manageSprintFromThisView:o}=e,n=dd();return(0,tt.jsx)(be.Z,{icon:zc.u,title:(0,tt.jsx)(l.FormattedMessage,{...us.manageSprintFromThisView}),iconStyle:n.icon,onClick:()=>{Fo.showDialog({description:(0,tt.jsx)(vs,{automaticSprintCompletionEnabled:t}),message:(0,tt.jsx)("div",{style:n.modalTitle,children:(0,tt.jsx)(l.FormattedMessage,{...us.manageSprintFromThisViewModalTitle})}),innerStyle:n.modalInnerStyle,showCancel:!0,keepFocus:!0,items:[{label:(0,tt.jsx)(l.FormattedMessage,{...us.manageSprintFromThisViewModalButton}),color:"blue",onAccept:o}]})}})}function rd(e){window.__c={n:"AutoCompleteSprintSwitcherMenuItem"};const{onChange:t,sprintSettingsConfig:o}=e,n=dd();return(0,tt.jsx)(Io.Z,{title:(0,tt.jsx)(l.FormattedMessage,{...us.automatedSprintsToggleTitle}),caption:(0,tt.jsx)(l.FormattedMessage,{...us.automatedSprintsToggleCaption}),focused:!1,on:o.autoCompleteSprints,onClick:()=>{t(!o.autoCompleteSprints)},style:{alignItems:void 0},icon:(0,qc.N)(n.icon),shouldWrapCaption:!0})}function sd(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=ys(o.recurrenceConfig.interval),r=cs.map((e=>ys(e)));return(0,tt.jsx)(cd,{title:(0,tt.jsx)(l.FormattedMessage,{...us.duration}),right:(0,tt.jsx)(hs,{sprintDurationValue:i.value}),icon:Wc.r,getMenuItems:e=>r.map((o=>({key:o.key,render:e=>(0,tt.jsx)(He.Z,{...e,disabled:n,title:(0,tt.jsx)(hs,{sprintDurationValue:o.value}),checkState:o.key===i.key}),action:()=>{t(o.value),e.close()}}))),showChevron:!0})}function ad(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.recurrenceConfig.weekdays[0],r=["SU","MO","TU","WE","TH","FR","SA"];return(0,tt.jsx)(cd,{title:(0,tt.jsx)(l.FormattedMessage,{...us.startOn}),icon:Lc.C,right:(0,tt.jsx)(fs,{weekday:i}),getMenuItems:e=>r.map((o=>({key:o,render:e=>(0,tt.jsx)(He.Z,{...e,disabled:n,title:(0,tt.jsx)(fs,{weekday:o}),checkState:o===i}),action:()=>{t(o),e.close()}}))),showChevron:!0})}function ld(e){const{onChange:t,sprintSettingsConfig:o,disabled:n}=e,i=o.actionConfig.complete_sprint_action,r=["complete_sprint_and_move_incomplete_tasks_to_next_sprint","complete_sprint_and_move_incomplete_tasks_to_backlog","complete_sprint"];return(0,tt.jsx)(cd,{title:(0,tt.jsx)(l.FormattedMessage,{...us.incompleteTasks}),right:(0,tt.jsx)(Ss,{completeSprintAction:i}),icon:Uc.D,getMenuItems:e=>r.map((o=>({key:o,render:e=>(0,tt.jsx)(He.Z,{...e,disabled:n,title:(0,tt.jsx)(ms,{completeSprintAction:o}),checkState:o===i}),action:()=>{t(o),e.close()}}))),showChevron:!0})}function cd(e){window.__c={n:"DropdownButton"};const{getMenuItems:t}=e,o=(0,r.Fy)(),n=dd(),i=(0,Je.F)({width:250});return(0,tt.jsx)($e.ZP,{popupType:o.isMobile?Yo.kQ.SlideUp:Yo.kQ.Popup,alignmentToOrigin:$e.vR.End,placementToOrigin:$e.pO.Bottom,renderOrigin:t=>(0,tt.jsx)(be.Z,{...e,iconStyle:n.icon,...t}),render:e=>(0,tt.jsx)(Ye.Z,{...i,children:(0,tt.jsx)(Qe.Z,{type:Qe.i.Vertical,sections:[{key:0,render:e=>(0,tt.jsx)(_e.Z,{enableActionSheetTitle:!0,...e}),items:t(e)}],initialFocus:0})})})}function dd(){const e=(0,r.Fy)();return(0,S.yK)((t=>({icon:{width:16,height:"auto"},menuDescriptionContainer:{margin:"0px 12px"},menuDescriptionText:{fontSize:e.isMobile?ie.Z.fontSize.UISmall.mobile:ie.Z.fontSize.UISmall.desktop,color:t.mediumTextColor,fontWeight:ie.Z.fontWeight.regular,marginLeft:14},button:{width:"100%"},buttonWrap:{margin:"0px 12px"},disclaimerWrap:{margin:"0px 12px",fontSize:e.isMobile?ie.Z.fontSize.UIRegular.mobile:ie.Z.fontSize.UIRegular.desktop,color:t.mediumTextColor,fontWeight:ie.Z.fontWeight.regular},disclaimerSubitem:{display:"flex",padding:"0px 10px",margin:"7px 0px",gap:7},disclaimerSubitemIcon:{width:20,height:20,marginTop:e.isMobile?3:1},boldText:{color:t.regularTextColor,fontWeight:ie.Z.fontWeight.semibold},mediaWrap:{margin:"0px 12px"},media:{display:"flex",margin:"15px 0px",width:"100%",padding:"12px 0px",height:120,border:`1px solid ${t.regularDividerColor}`,borderRadius:"4px",background:t.cardBackground,justifyContent:"center",alignItems:"center"},mediaIcon:{width:40,height:40,color:t.lightIconColor},modalTitle:{fontWeight:ie.Z.fontWeight.semibold,fontSize:18},modalInnerStyle:{textAlign:"center"},modalReferencedPageName:{color:t.darkTextColor,fontWeight:ie.Z.fontWeight.semibold}})),[e])}class pd extends i.Z{constructor(){super(...arguments),this.lastTab=void 0}didMountOrUpdate(){const{collectionSettingsStore:e}=this.props,t=(0,It.n)(e),o=this.props.collectionContextStore.getViewType();t&&this.lastTab!==t&&c.r5L(this.environment,{view_type:o,menu:t.type}),this.lastTab=t}renderComponent(){var e;const{collectionSettingsStore:t}=this.props,o=(0,It.n)(t),n=(i=this.props,{main:e=>(0,tt.jsx)(gd,{tab:e,...i}),source:()=>(0,tt.jsx)(Nc,{...i}),createViewSource:()=>(0,tt.jsx)(ea.Z,{...i}),createSyncedViewSource:e=>(0,tt.jsx)(Sd,{tab:e,...i}),selectAccountForExternalSource:e=>(0,tt.jsx)(fd,{tab:e,...i}),shareSyncedView:e=>(0,tt.jsx)(yd,{tab:e,...i}),propertyType:e=>(0,tt.jsx)(hd,{tab:e,...i}),propertyAiAutofill:e=>(0,tt.jsx)(xd,{tab:e,...i}),createView:()=>(0,tt.jsx)(Xs,{...i}),duplicateExistingView:()=>(0,tt.jsx)(sa.Z,{...i}),properties:e=>(0,tt.jsx)(vd,{tab:e,...i}),property:e=>(0,tt.jsx)(Cd,{tab:e,...i}),deletedProperties:e=>(0,tt.jsx)(bd,{tab:e,...i}),selectRelationSource:e=>(0,tt.jsx)(wd,{tab:e,...i}),setupRelation:e=>(0,tt.jsx)(jd,{tab:e,...i}),layout:()=>(0,tt.jsx)(vc,{...i}),group:e=>(0,tt.jsx)(_d,{tab:e,...i}),groupByProperty:e=>(0,tt.jsx)(Md,{tab:e,...i}),subitem:e=>(0,tt.jsx)(kd,{tab:e,...i}),arrowsBy:e=>(0,tt.jsx)(Vd,{tab:e,...i}),githubConfig:e=>(0,tt.jsx)(Bd,{tab:e,...i}),filters:()=>(0,tt.jsx)(rc,{...i}),groupByNumber:e=>(0,tt.jsx)(Td,{tab:e,...i}),filter:e=>(0,tt.jsx)(Id,{tab:e,...i}),createFilter:()=>(0,tt.jsx)(Gl,{...i}),createSort:()=>(0,tt.jsx)($l,{...i}),sort:()=>(0,tt.jsx)(jc,{...i}),page:()=>(0,tt.jsx)(md,{...i}),createTypedDB:()=>(0,tt.jsx)(ji,{...i}),automationSettings:e=>(0,tt.jsx)(Zd,{tab:e,...i}),automationCreateSettings:e=>(0,tt.jsx)(Dd,{tab:e,...i}),automationEditSettings:e=>(0,tt.jsx)(Kd,{tab:e,...i}),dependencies:e=>(0,tt.jsx)(Fd,{tab:e,...i}),relationFeaturesAdvancedSettings:e=>(0,tt.jsx)(Ad,{tab:e,...i}),subitemV2:e=>(0,tt.jsx)(Pd,{tab:e,...i}),sprintSettings:e=>(0,tt.jsx)(Od,{tab:e,...i})});var i;if(o)return(0,tt.jsx)(Ft.Z,{capture:!0,preventType:Bt.Z.Y,children:(0,tt.jsx)(Ra.Z,{capture:!0,onEsc:e=>function(e,t){(0,At.ZP)({event:e,context:At.Af.CollectionSettingsClick,callback:()=>{d.E3({collectionSettingsStore:t})}})}(e,this.props.collectionSettingsStore),children:null===(e=n[o.type])||void 0===e?void 0:e.call(n,o)})})}}pd.displayName="CollectionSettings";const ud=(0,l.injectIntl)(pd);function gd(e){window.__c={n:"MainTabComponent"};const{collectionContextStore:t,tab:o}=e,n=(0,s.VK)((()=>{var e;return null===(e=t.collectionViewStore())||void 0===e?void 0:e.id}),[t]),i=(0,s.VK)((()=>t.collectionViewStore()),[t]);return"main"===o.type&&i?(0,tt.jsx)(ws,{selectViewNameInitial:o.selectViewNameInitial,collectionViewStore:i,...e},n):null}function md(e){window.__c={n:"PageViewTabComponent"};const{collectionContextStore:t}=e,o=(0,r.O7)(),n=(0,s.VK)((()=>t.collectionViewStore()),[t]);return n?(0,tt.jsx)(Ce.ZP,{...e,title:"Select page to display",children:(0,tt.jsx)("div",{style:{margin:12},children:(0,tt.jsx)(dc.Z,{showClearButton:!0,placeholder:"Enter page ID",focusInitial:!0,onChange:e=>{Zt.Z.setState({pageId:e.target.value})},onSubmit:e=>{const t=Zt.Z.state.pageId;if(!t)return null;u.createAndCommit({userAction:"collectionSettings.pageView.selectPage",environment:o,perform:e=>{p.FH({stores:[n],update:{page_pointer:{id:(0,a.Mt)(t),spaceId:e.spaceId,table:"block"}},transaction:e})}})}})})}):null}function Sd(e){const{tab:t}=e;return"createSyncedViewSource"!==t.type?null:(0,tt.jsx)(gi,{...e,...t})}function fd(e){const{tab:t}=e;return"selectAccountForExternalSource"!==t.type?null:(0,tt.jsx)(Ln,{...e,...t})}function yd(e){const{tab:t}=e;return"shareSyncedView"!==t.type?null:(0,tt.jsx)(Zl,{...e,...t})}function hd(e){const{tab:t}=e;return"propertyType"!==t.type?null:(0,tt.jsx)(vl,{...e,...t})}function xd(e){const{tab:t}=e;return"propertyAiAutofill"!==t.type?null:(0,tt.jsx)(Na,{...e,...t})}function vd(e){const{tab:t}=e;return"properties"!==t.type?null:(0,tt.jsx)(Cc.Z,{...e,timelineViewTab:t.timelineViewTab})}function Cd(e){const{tab:t}=e;return"property"!==t.type?null:(0,tt.jsx)(aa.ZP,{...e,...t},t.property)}function bd(e){const{tab:t}=e;return"deletedProperties"!==t.type?null:(0,tt.jsx)(ra,{...t,...e})}function wd(e){const{tab:t}=e;return"selectRelationSource"!==t.type?null:(0,tt.jsx)(jl,{...e,...t})}function jd(e){const{tab:t}=e;return"setupRelation"!==t.type?null:(0,tt.jsx)(Tl,{...e,...t})}function _d(e){const{tab:t}=e;return"group"!==t.type?null:(0,tt.jsx)(Ir,{...e,...t})}function Md(e){const{tab:t}=e;return"groupByProperty"!==t.type?null:(0,tt.jsx)(hc,{...e,...t})}function Td(e){const{tab:t}=e;return"groupByNumber"!==t.type?null:(0,tt.jsx)(Sc,{...e,...t})}function kd(e){const{tab:t}=e;return"subitem"!==t.type?null:(0,tt.jsx)(En,{...e,...t,formatSetting:"subitem"})}function Pd(e){const{tab:t}=e;return"subitemV2"!==t.type?null:(0,tt.jsx)(yn,{...e,feature:"subitem"})}function Vd(e){const{tab:t}=e;return"arrowsBy"!==t.type?null:(0,tt.jsx)(En,{...e,...t,formatSetting:"timeline_arrows_by"})}function Fd(e){const{tab:t}=e;return"dependencies"!==t.type?null:(0,tt.jsx)(yn,{...e,feature:"timeline_arrows_by"})}function Ad(e){const{tab:t}=e;return"relationFeaturesAdvancedSettings"!==t.type?null:(0,tt.jsx)(Bn,{...e,feature:t.feature})}function Bd(e){const{tab:t}=e;return"githubConfig"!==t.type?null:(0,tt.jsx)(Dt.Z,{...e,property:t.property})}function Id(e){const{tab:t}=e;return"filter"!==t.type?null:(0,tt.jsx)(Jl,{...e})}function Zd(e){const{tab:t}=e;return"automationSettings"!==t.type?null:(0,tt.jsx)(ht,{...e,tabSettings:t})}function Dd(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"automationCreateSettings"!==t.type?null:(0,tt.jsx)(Vt.Z,{collectionContextStore:o,collectionSettingsStore:n,mode:"create"})}function Kd(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;if("automationEditSettings"!==t.type)return null;const{automationId:i}=t;return(0,tt.jsx)(Vt.Z,{automationId:i,collectionContextStore:o,collectionSettingsStore:n,mode:"update"})}function Od(e){let{tab:t,collectionContextStore:o,collectionSettingsStore:n}=e;return"sprintSettings"!==t.type?null:(0,tt.jsx)(Yc,{collectionContextStore:o,collectionSettingsStore:n})}},75117:(e,t,o)=>{o.d(t,{Z:()=>O});var n=o(67294),i=o(480),r=o(86628),s=o(8848),a=o(63014),l=o(47453),c=o(37612),d=o(72126),p=o(9291),u=o(50906),g=o(12534),m=o(33929),S=o(87279),f=o(31339),y=o(42917),h=o(61053),x=o(60246),v=o(52275),C=o(31945),b=o(14871),w=o(77498),j=o(62045),_=o(50542),M=o(85893);const T=function(e){let{schema:t,sort:o,disabled:i,onChange:r,index:s,collectionViewType:a}=e;const l=t[o.property];return l?(0,M.jsxs)(n.Fragment,{children:[(0,M.jsx)(P,{disabled:i,schema:t,sort:o,onChange:r,index:s,collectionViewType:a,propertySchema:l}),(0,M.jsx)(k,{sort:o,index:s,onChange:r,collectionViewType:a,disabled:i})]}):null};function k(e){let{sort:t,index:o,onChange:n,collectionViewType:r,disabled:s}=e;window.__c={n:"SortDirection"};const a=(0,i.O7)(),l=(0,p.useIntl)(),c=t.direction,d={ascending:(0,M.jsx)(p.FormattedMessage,{defaultMessage:"Ascending",id:"collectionSortMenuRow.sortDirectionSelectMenu.ascending"}),descending:(0,M.jsx)(p.FormattedMessage,{defaultMessage:"Descending",id:"collectionSortMenuRow.sortDirectionSelectMenu.descending"})},g={menuTitle:l.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.title",defaultMessage:"Sort"}),items:[...x.C6],getKey:e=>e,selectedItem:c,disabled:s,onSelect:e=>{const i={...t,direction:e};n(o,i),r&&u.wds(a,{view_type:r,action:"set_sort_direction"})},renderItem:e=>(0,M.jsx)(v.Z,{title:d[e.value],...e}),renderOrigin:e=>(0,M.jsx)(j.Z,{...e,placeholder:l.formatMessage({id:"collectionSortMenuRow.sortDirectionSelectMenu.placeholder",defaultMessage:"Empty"}),title:c&&d[c],disabled:s,desktopStyle:{opacity:1}})};return(0,M.jsx)(b.Z,{...g,mobileActionSheet:!0},"direction")}function P(e){let{propertySchema:t,disabled:o,schema:n,sort:r,onChange:s,index:a,collectionViewType:l}=e;window.__c={n:"PropertyDropdownComponent"};const c=(0,i.O7)(),{device:d}=c;return(0,M.jsx)(C.ZP,{popupType:d.isMobile?C.Z4.SlideUp:C.Z4.Popup,renderOrigin:e=>(0,M.jsx)(_.Z,{...e,propertySchema:t,disabled:o,textWrapperStyle:{opacity:1}}),render:e=>(0,M.jsx)(w.Z,{isRelationProperty:!1,schema:n,onAccept:e=>function(e,t,o,n,i,r){n(i,{...o,property:e}),r&&u.wds(t,{view_type:r,action:"set_sort_property"})}(e,c,r,s,a,l),onClose:e.close}),disabled:o})}var V=o(79131),F=o(73063),A=o(78140),B=o(28992),I=o(53437),Z=o(72495),D=o(26388);const K=(0,p.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a property…",id:"database.viewSettings.collectionSortMenu.inputPlaceholder"}});const O=function(e){let{schema:t,format:o,sorts:n,showDeleteAll:r,disabled:s,parentStore:a,collectionViewStore:d,onChange:g,onDeleteAll:f}=e;window.__c={n:"CollectionSortMenu"};const x=(0,i.O7)(),{device:v}=x,b=!!Object.keys(t).some((e=>!n.find((t=>t.property===e)))),w=r&&n.length>0;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(U,{sorts:n,schema:t,disabled:s,parentStore:a,collectionViewStore:d,onChange:g}),(b||w)&&(0,M.jsxs)(Z.Z,{children:[b&&(0,M.jsx)(C.ZP,{popupType:v.isMobile?I.kQ.SlideUp:I.kQ.Popup,renderOrigin:e=>(0,M.jsx)(y.Z,{icon:l.R,isGray:!0,title:(0,M.jsx)(p.FormattedMessage,{id:"database.viewSettings.sortTab.newSort",defaultMessage:"Add sort"}),...e}),render:e=>{let i;return i=v.isMobile?{menuType:S.og.ActionSheet}:{menuType:S.og.Popup,width:280,height:287},(0,M.jsx)(A.Z,{...i,children:(0,M.jsx)(h.Z,{schema:t,format:o,getProperties:()=>Object.keys(t).filter((e=>!n.find((t=>t.property===e)))),onAccept:o=>{!function(e,t,o,n,i,r){var s;if(!e)return;const a=null===(s=o[e])||void 0===s?void 0:s.type,l=[...n,{property:e,direction:"ascending"}];i(l);const c=R(r);c&&u.wds(t,{action:"create_sort_accept",view_type:c,property_type:a})}(o,x,t,n,g,d),e.close()},inputPlaceholder:m.default.formatMessage(K.inputPlaceholder)})})}}),w&&(0,M.jsx)(y.Z,{icon:c.y,isRed:!0,isGray:!0,title:(0,M.jsx)(p.FormattedMessage,{id:"database.viewSettings.sortTab.deleteAllSorts",defaultMessage:"Delete sort"}),onClick:()=>function(e,t,o,n){t([]),null==n||n();const i=R(o);i&&u.wds(e,{action:"delete_all_sorts",view_type:i})}(x,g,d,f)})]})]})};function R(e){return null==e?void 0:e.getType()}function E(e,t,o,n,i,r){n(i.map(((o,n)=>n===e?t:o)));const s=R(r);s&&u.wds(o,{action:"update_sort",view_type:s})}function G(e,t,o,n,i){o(n.filter(((t,o)=>o!==e)));const r=R(i);r&&u.wds(t,{action:"delete_sort",view_type:r})}function N(e){let{index:t,onChange:o,sorts:n,collectionViewStore:r}=e;window.__c={n:"MobileDeleteButtonMenuItemComponent"};const a=(0,i.O7)();return(0,M.jsx)(v.Z,{title:(0,M.jsx)("div",{style:{color:s.ZP.red},children:(0,M.jsx)(p.FormattedMessage,{defaultMessage:"Delete",id:"database.viewSettings.sortTab.mobileDeleteButtonTitle"})}),icon:(0,M.jsx)(f.Z,{icon:c.y,styles:{color:s.ZP.red}}),onClick:()=>G(t,a,o,n,r),focused:!1})}function W(e){let{index:t,onChange:o,sorts:n,collectionViewStore:r}=e;window.__c={n:"DesktopDeleteButtonComponent"};const s=(0,i.O7)();return(0,M.jsx)(D.ZP,{render:e=>(0,M.jsx)(F.Z,{icon:a.b,onClick:()=>G(t,s,o,n,r),style:{marginRight:-6},...e}),renderTooltip:()=>(0,M.jsx)(p.FormattedMessage,{defaultMessage:"Remove sort rule",id:"database.sortMenu.deleteButtonTooltip"})})}function L(e){let{sort:t,index:o,schema:n,disabled:s,parentStore:a,collectionViewStore:l,onChange:c,sorts:d}=e;window.__c={n:"SortComponent"};const p=(0,i.O7)(),{device:u}=p,m=(0,r.VK)((()=>R(l)),[l]);return u.isMobile?(0,M.jsxs)(Z.Z,{children:[(0,M.jsx)(T,{index:o,sort:t,schema:n,parentStore:a,collectionViewType:m,onChange:(e,t)=>E(e,t,p,c,d,l)}),!s&&(0,M.jsx)(N,{onChange:c,sorts:d,collectionViewStore:l,index:o})]}):(0,M.jsx)(Z.Z,{extraTopPadding:!0,desktopStyle:{padding:"8px 0 0 8px",width:"100%"},children:(0,M.jsx)(B.Z,{showDragHandle:!u.isMobile&&!s,title:(0,M.jsx)("div",{style:{display:"flex",alignItems:"center",flexGrow:1,whiteSpace:"nowrap"},onMouseDown:g.$0,children:(0,M.jsx)(T,{index:o,sort:t,schema:n,parentStore:a,collectionViewType:m,onChange:(e,t)=>E(e,t,p,c,d,l)})}),right:!s&&(0,M.jsx)(W,{onChange:c,sorts:d,collectionViewStore:l,index:o})})})}function U(e){let{sorts:t,schema:o,disabled:n,parentStore:r,collectionViewStore:s,onChange:a}=e;window.__c={n:"SortsComponent"};const l=(0,i.O7)(),{device:c}=l;if(c.isMobile)return(0,M.jsx)(M.Fragment,{children:t.map(((e,i)=>(0,M.jsx)(L,{schema:o,disabled:n,parentStore:r,collectionViewStore:s,onChange:a,sorts:t,sort:e,index:i},i)))});{const e=t.map(((e,t)=>t.toString()));return e.length>0?(0,M.jsx)("div",{style:{marginBottom:2},children:(0,M.jsx)(V.ZP,{direction:"vertical",keys:e,renderKey:e=>(0,M.jsx)(L,{schema:o,disabled:n,parentStore:r,collectionViewStore:s,onChange:a,sorts:t,sort:t[parseInt(e)],index:parseInt(e)}),onDrop:e=>function(e,t,o,n,i){o(d.oA(e.map((e=>n[parseInt(e)]))));const r=R(i);r&&u.wds(t,{action:"reorder_sorts",view_type:r})}(e,l,a,t,s)})}):null}}},46978:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(67294),i=o(24405),r=o(85893);function s(e,t){let{isSelected:o}=e;window.__c={n:"RadioButtonIcon"};const{radioButtonStyle:n,dotStyle:s}=(0,i.yK)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:8,background:o?e.blueColor:e.whiteButtonBackground,border:o?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e.regularInvertedTextColor,transition:"opacity 100ms ease-out",opacity:o?1:0}})),[o]);return(0,r.jsx)("div",{ref:t,style:n,children:(0,r.jsx)("div",{style:s})})}const a=n.forwardRef(s)},90683:(e,t,o)=>{o.d(t,{a:()=>l});o(67294);var n=o(66897),i=o(97880),r=o(70301),s=o(45653),a=o(85893);function l(e){const{actor:t}=e,o={size:e.size??14,style:{marginRight:2,...e.style}};return(0,n.YU)(t)?(0,a.jsx)(r.Z,{botValue:t.asActor,...o}):(0,n.$S)(t)?(0,a.jsx)(s.Z,{userValue:t.asActor,...o}):(0,n.Iq)(t)?(0,a.jsx)(s.Z,{userValue:void 0,...o}):void(0,i.t1)(t)}},52489:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(49085);class i extends n.default{getInitialState(){return{isModalOpen:!1,collectionContextStore:void 0}}}const r=new i},28410:(e,t,o)=>{o.d(t,{RV:()=>a,Th:()=>i});o(57658);var n=o(97880);const i=12e3,r={"ft:gpt-4-0613:makenotion:qa-1000-kenny:8VYnFLJP":{name:"Kenny's Model 1000",createdTime:Date.parse("2023-12-13T07:56:00-04:00"),description:"Kenny's model trained on 1000 examples",variants:["exploratory"]},"ft:gpt-4-0613:makenotion:qa-100-kenny:8V91GG9C":{name:"Kenny's Model 100",createdTime:Date.parse("2023-12-12T08:55:00-04:00"),description:"Kenny's model trained on 100 examples",variants:["exploratory"]},"ft:gpt-3.5-turbo-1106:makenotion::8W3ZKTGG":{name:"Assistant Fast Model",createdTime:Date.parse("2023-12-14T02:27:00-04:00"),description:"Linus's speedy assistant model",variants:["exploratory"]},"ft:gpt-4-0613:makenotion::8SDS0jPI":{name:"JavaScript Assistant",createdTime:Date.parse("2023-12-03T10:58:00-04:00"),description:"Simon's JavaScript assistant",variants:["wild_west"]}},s=((0,n.qP)(r).reduce(((e,t)=>{let[o,{name:n}]=t;return e[n]=o,e}),{}),Object.values(r).map((e=>{let{name:t}=e;return t})));const a=function(){const e={};for(const o of Object.values(r))for(const t of o.variants)e[t]||(e[t]=[]),e[t].push(o);const t={};for(const[o,i]of(0,n.qP)(e))t[o]=i.sort(((e,t)=>e.createdTime-t.createdTime));return t}(),l=["openai-1.1","openai-2","openai-4","openai-5","openai-6","openai-7","openai-8","openai-9",...s];const c=["anthropic-1","anthropic-2","anthropic-qa-alpha","anthropic-3"]},65955:(e,t,o)=>{o.d(t,{o:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("addPage",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7 0c3.861 0 7 3.139 7 7s-3.139 7-7 7-7-3.139-7-7 3.139-7 7-7zM3.561 5.295a1.027 1.027 0 1 0 2.054 0 1.027 1.027 0 0 0-2.054 0zm5.557 1.027a1.027 1.027 0 1 1 0-2.054 1.027 1.027 0 0 1 0 2.054zm1.211 2.816a.77.77 0 0 0-.124-1.087.786.786 0 0 0-1.098.107c-.273.407-1.16.958-2.254.958-1.093 0-1.981-.55-2.244-.945a.788.788 0 0 0-1.107-.135.786.786 0 0 0-.126 1.101c.55.734 1.81 1.542 3.477 1.542 1.668 0 2.848-.755 3.476-1.541z"})})},68074:(e,t,o)=>{o.d(t,{v:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("addPageDiscussion",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.095 15.465c.287 0 .499-.137.84-.444l2.523-2.277 4.47.007c2.058 0 3.214-1.19 3.214-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.213h.273v1.983c0 .45.24.738.657.738zM3.958 5.156a.454.454 0 01-.444-.45c0-.24.198-.438.444-.438h7.157c.246 0 .445.198.445.437a.45.45 0 01-.445.451H3.958zm0 2.256a.454.454 0 01-.444-.451c0-.24.198-.444.444-.444h7.157a.448.448 0 010 .895H3.958zm0 2.256a.448.448 0 010-.896h4.669c.246 0 .437.206.437.452a.438.438 0 01-.437.444H3.958z"})})},72787:(e,t,o)=>{o.d(t,{Y:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("chevronDownThin",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8.004 12a.72.72 0 00.54-.237l6.238-6.487A.735.735 0 0015 4.753c0-.426-.314-.753-.733-.753a.76.76 0 00-.524.213l-5.739 5.955-5.747-5.955A.73.73 0 001.733 4C1.314 4 1 4.327 1 4.753c0 .204.08.384.218.531l6.238 6.479a.751.751 0 00.548.237z"})})},82356:(e,t,o)=>{o.d(t,{l:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("import",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M13.291 14.5723C13.291 14.1484 12.9902 13.834 12.5732 13.834H8.06836C8.24609 13.8203 8.42383 13.7314 8.56055 13.5947L13.0586 9.08301C13.2158 8.91895 13.291 8.74121 13.291 8.54297C13.291 8.12598 12.9902 7.81836 12.5801 7.81836C12.3682 7.81836 12.1836 7.90039 12.0469 8.03711L10.4951 9.56836L8.69043 11.585L8.75195 10.1084V1.61133C8.75195 1.16016 8.44434 0.852539 8 0.852539C7.5625 0.852539 7.25488 1.16016 7.25488 1.61133V10.1084L7.30957 11.5781L5.50488 9.56836L3.95312 8.03711C3.82324 7.90039 3.63184 7.81836 3.42676 7.81836C3.0166 7.81836 2.70898 8.12598 2.70898 8.54297C2.70898 8.74121 2.78418 8.91895 2.94141 9.08301L7.44629 13.5947C7.58301 13.7314 7.75391 13.8203 7.93848 13.834H3.44043C3.0166 13.834 2.70898 14.1484 2.70898 14.5723C2.70898 14.9893 3.0166 15.3037 3.44043 15.3037H12.5732C12.9902 15.3037 13.291 14.9893 13.291 14.5723Z"})})},27714:(e,t,o)=>{o.d(t,{N:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("link",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.69922 10.8945L8.73828 9.84863C7.91797 9.77344 7.34375 9.51367 6.91992 9.08984C5.76465 7.93457 5.76465 6.29395 6.91309 5.14551L9.18262 2.87598C10.3379 1.7207 11.9717 1.7207 13.127 2.87598C14.2891 4.04492 14.2822 5.67188 13.1338 6.82031L11.958 7.99609C12.1768 8.49512 12.2451 9.10352 12.1289 9.62988L14.0908 7.6748C15.7725 6 15.7793 3.62109 14.084 1.92578C12.3887 0.223633 10.0098 0.237305 8.33496 1.91211L5.95605 4.29785C4.28125 5.97266 4.26758 8.35156 5.96289 10.0469C6.36621 10.4434 6.90625 10.7441 7.69922 10.8945ZM8.30078 5.13184L7.26855 6.17773C8.08203 6.25293 8.66309 6.51953 9.08008 6.93652C10.2422 8.09863 10.2422 9.73242 9.08691 10.8809L6.81738 13.1504C5.66211 14.3057 4.03516 14.3057 2.87305 13.1504C1.71094 11.9883 1.71777 10.3545 2.87305 9.20605L4.04199 8.03027C3.83008 7.53125 3.75488 6.92969 3.87109 6.39648L1.91602 8.35156C0.234375 10.0264 0.227539 12.4121 1.92285 14.1074C3.61816 15.8027 5.99707 15.7891 7.67188 14.1143L10.0439 11.7354C11.7256 10.0537 11.7324 7.6748 10.0371 5.98633C9.64062 5.58301 9.10059 5.28223 8.30078 5.13184Z"})})},70406:(e,t,o)=>{o.d(t,{p:()=>r});o(67294);var n=o(45238),i=o(85893);const r=(0,n.I)("transcript",{viewBox:"0 0 16 16",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M3.99805 5.92188C3.85352 5.92188 3.72656 5.86719 3.61719 5.75781C3.50781 5.64844 3.45312 5.52148 3.45312 5.37695C3.45312 5.22852 3.50781 5.09961 3.61719 4.99023C3.72656 4.88086 3.85352 4.82617 3.99805 4.82617C4.15039 4.82617 4.2793 4.88086 4.38477 4.99023C4.49023 5.0957 4.54297 5.22461 4.54297 5.37695C4.54297 5.52539 4.49023 5.6543 4.38477 5.76367C4.2793 5.86914 4.15039 5.92188 3.99805 5.92188ZM3.99805 7.65625C3.85352 7.65625 3.72656 7.60352 3.61719 7.49805C3.50781 7.38867 3.45312 7.25977 3.45312 7.11133C3.45312 6.96289 3.50781 6.83594 3.61719 6.73047C3.72656 6.62109 3.85352 6.56641 3.99805 6.56641C4.15039 6.56641 4.2793 6.61914 4.38477 6.72461C4.49023 6.83008 4.54297 6.95898 4.54297 7.11133C4.54297 7.26367 4.49023 7.39258 4.38477 7.49805C4.2793 7.60352 4.15039 7.65625 3.99805 7.65625ZM3.99805 9.38477C3.84961 9.38477 3.7207 9.33203 3.61133 9.22656C3.50586 9.12109 3.45312 8.99219 3.45312 8.83984C3.45312 8.69141 3.50586 8.56445 3.61133 8.45898C3.7207 8.35352 3.84961 8.30078 3.99805 8.30078C4.15039 8.30078 4.2793 8.35352 4.38477 8.45898C4.49023 8.56445 4.54297 8.69141 4.54297 8.83984C4.54297 8.99219 4.49023 9.12109 4.38477 9.22656C4.2793 9.33203 4.15039 9.38477 3.99805 9.38477ZM3.99805 11.2129C3.85352 11.2129 3.72656 11.1582 3.61719 11.0488C3.50781 10.9395 3.45312 10.8105 3.45312 10.6621C3.45312 10.5137 3.50781 10.3848 3.61719 10.2754C3.72656 10.166 3.85352 10.1113 3.99805 10.1113C4.15039 10.1113 4.2793 10.166 4.38477 10.2754C4.49023 10.3809 4.54297 10.5098 4.54297 10.6621C4.54297 10.8145 4.49023 10.9453 4.38477 11.0547C4.2793 11.1602 4.15039 11.2129 3.99805 11.2129ZM5.67383 5.75195C5.56836 5.75195 5.47852 5.71484 5.4043 5.64062C5.33008 5.56641 5.29297 5.47852 5.29297 5.37695C5.29297 5.27148 5.33008 5.18164 5.4043 5.10742C5.48242 5.0293 5.57227 4.99023 5.67383 4.99023H12.1836C12.2891 4.99023 12.3789 5.0293 12.4531 5.10742C12.5312 5.18164 12.5703 5.27148 12.5703 5.37695C12.5703 5.47852 12.5332 5.56641 12.459 5.64062C12.3848 5.71484 12.293 5.75195 12.1836 5.75195H5.67383ZM5.67383 7.49219C5.57227 7.49219 5.48242 7.45508 5.4043 7.38086C5.33008 7.30664 5.29297 7.2168 5.29297 7.11133C5.29297 7.00586 5.33008 6.91602 5.4043 6.8418C5.47852 6.76367 5.56836 6.72461 5.67383 6.72461H9.31836C9.42383 6.72461 9.51367 6.76367 9.58789 6.8418C9.66211 6.91602 9.69922 7.00586 9.69922 7.11133C9.69922 7.2168 9.66211 7.30664 9.58789 7.38086C9.51367 7.45508 9.42383 7.49219 9.31836 7.49219H5.67383ZM5.67383 9.22656C5.56836 9.22656 5.47852 9.18945 5.4043 9.11523C5.33008 9.04102 5.29297 8.94922 5.29297 8.83984C5.29297 8.73828 5.33008 8.65039 5.4043 8.57617C5.47852 8.50195 5.56836 8.46484 5.67383 8.46484H12.1836C12.293 8.46484 12.3848 8.50195 12.459 8.57617C12.5332 8.65039 12.5703 8.73828 12.5703 8.83984C12.5703 8.94922 12.5332 9.04102 12.459 9.11523C12.3848 9.18945 12.293 9.22656 12.1836 9.22656H5.67383ZM5.67383 11.043C5.57227 11.043 5.48242 11.0059 5.4043 10.9316C5.33008 10.8535 5.29297 10.7637 5.29297 10.6621C5.29297 10.5566 5.33008 10.4668 5.4043 10.3926C5.47852 10.3184 5.56836 10.2812 5.67383 10.2812H9.31836C9.42383 10.2812 9.51367 10.3184 9.58789 10.3926C9.66211 10.4668 9.69922 10.5566 9.69922 10.6621C9.69922 10.7637 9.66211 10.8535 9.58789 10.9316C9.51367 11.0059 9.42383 11.043 9.31836 11.043H5.67383ZM2.97852 13.4922C2.3457 13.4922 1.86719 13.332 1.54297 13.0117C1.21875 12.6914 1.05664 12.2188 1.05664 11.5938V4.45703C1.05664 3.83203 1.21875 3.35938 1.54297 3.03906C1.86719 2.71484 2.3457 2.55273 2.97852 2.55273H13.0098C13.6465 2.55273 14.127 2.71484 14.4512 3.03906C14.7754 3.35938 14.9375 3.83203 14.9375 4.45703V11.5938C14.9375 12.2188 14.7754 12.6914 14.4512 13.0117C14.127 13.332 13.6465 13.4922 13.0098 13.4922H2.97852ZM3.04883 12.3438H12.9453C13.2148 12.3438 13.4219 12.2734 13.5664 12.1328C13.7109 11.9883 13.7832 11.7754 13.7832 11.4941V4.55664C13.7832 4.27539 13.7109 4.06445 13.5664 3.92383C13.4219 3.7793 13.2148 3.70703 12.9453 3.70703H3.04883C2.77539 3.70703 2.56641 3.7793 2.42188 3.92383C2.28125 4.06445 2.21094 4.27539 2.21094 4.55664V11.4941C2.21094 11.7754 2.28125 11.9883 2.42188 12.1328C2.56641 12.2734 2.77539 12.3438 3.04883 12.3438Z"})})})},39927:(e,t,o)=>{o.d(t,{i:()=>n});const n={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}}}}]);