"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8586,9091,2806],{24212:(e,t,s)=>{s.d(t,{Op:()=>R,Oq:()=>N,hS:()=>L});s(57658),s(67294);var n=s(41432),i=s(88437),o=s(66466),a=s(79310),r=s(37612),l=s(13289),d=s(9291),c=s(50906),u=s(3297),m=s(42858),p=s(82530),g=s(52275),h=s(31278),f=s(72495),x=s(19037),y=s(28020),S=s(38755),v=s(74948),b=s(80444),M=s(41363),j=s(82763),w=s(29768),C=s(62967),k=s(42784),T=s(71247),I=s(34658),P=s(6471),Z=s(5337),F=s(85893);const _=(0,d.defineMessages)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},removefromFavoritesName:{id:"action.removefromFavorites.name",defaultMessage:"Remove from Favorites"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"}}),A=(0,C.cN)({key:"remove pinned shared page",displayName:_.unpinName,analyticsName:_.unpinName.defaultMessage,svg:a.A,validators:[x.cW,x.uq],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:n,currentUserSettingsStore:i}=b.default.state;n&&i&&(p.createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:s,perform:e=>{for(const o of t)v.unpinSharedPage({environment:s,transaction:e,spaceViewStore:n,userSettingsStore:i,store:o})}}),c.An9(s,{type:"shared",from:"sidebar_dropdown_menu"}))}}),R=(0,C.cN)({key:"delete block without shortcuts",displayName:C.RE.deleteName,analyticsName:C.RE.deleteName.defaultMessage,svg:r.y,validators:[x.DF,x.eo,x.ff(x.sR),x.ff(x.P9(n.Ti.externalObjectInstancePage)),x.vd],closeParentMenu:!0,action:async e=>{let{blocks:t,environment:s}=e;await m.Qw({environment:s,blocks:t})}}),D=(0,C.cN)({key:"leave shared page",displayName:_.leaveName,analyticsName:_.leaveName.defaultMessage,svg:o.S,validators:[x.cW,x.zl,x.ff(x.uq)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;p.createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:s,perform:e=>{v.leaveBlocks({environment:s,blocks:t,transaction:e})}})}}),B=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,C.cN)({key:"remove from favorites",displayName:_.removefromFavoritesName,analyticsName:_.removefromFavoritesName.defaultMessage,svg:l.B,validators:[...e,x.UI,x.U7,x.ff(x.xD([x.uq,x.cW]))],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:n}=b.default.state;n&&p.createAndCommit({userAction:"actionRegistry.removeFromFavorites",environment:s,perform:e=>{v.unbookmarkPage({spaceViewStore:n,store:t[0],transaction:e})}})}})},L=B([x.tq]),O=B(),E=(0,C.MV)({key:"duplicate to workspace",displayName:_.duplicateToName,analyticsName:_.duplicateToName.defaultMessage,svg:i.a,validators:[x.DF,x.nJ,x.zz,x.ff(x.KE),x.Jl],subActions:e=>{let{blocks:t,environment:s}=e;const{currentUserRootStore:n}=b.default.state;if(!n)return[];const i=t[0],o=y.o(n),a=[];for(const r of o){const e=r.getSpaceStore();if(e){const t=(0,S.rn)(s,e),n=(0,S.Wd)(s,e);a.push({key:r.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await u.DK({environment:s,store:i,spaceStore:e,spaceViewStore:r,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,s)=>{let{environment:i}=s;return(0,F.jsx)(g.Z,{title:t,icon:(0,F.jsx)(h.Z,{icon:n,isEmptyPage:!1,title:t,size:i.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,C.$J)({key:"duplicate-to",render:e=>(0,F.jsx)(f.Z,{...e}),actions:a})]}}),N=[k.ww,{key:"outliner primary actions",render:e=>(0,F.jsx)(f.Z,{...e}),actions:[A,R,D,M._p,O,w.o1,w.vh,w.fI,w.MI,E,P.$]},{key:"outliner navigation",render:e=>(0,F.jsx)(f.Z,{...e}),actions:[M.IK,I.KB,I.oL,I.sN,I.Jw,j.H,j.K,M.Dw]},{key:"outliner move actions",render:e=>(0,F.jsx)(f.Z,{...e}),actions:[T.A]},{key:"turn page into teamspace or wiki",render:e=>(0,F.jsx)(f.Z,{...e}),actions:[Z.NO,Z.LM,Z.BW]}]},81267:(e,t,s)=>{s.d(t,{l:()=>m});s(67294);var n=s(8848),i=s(92717),o=s(9291),a=s(360),r=s(93405),l=s(19037),d=s(62967),c=s(85893);const u=(0,o.defineMessages)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),m=(0,d.cN)({key:"action report page",displayName:u.reportPageName,analyticsName:u.reportPageName.defaultMessage,validators:[l.Gg,l.iK,l.Id],closeParentMenu:!0,render:e=>(0,c.jsx)(r.Z,{...e,style:{color:n.ZP.red},svg:i.o,title:(0,c.jsx)(o.FormattedMessage,{...u.reportPageName})}),action:e=>{let{blocks:t,environment:s}=e;a.l()}})},5337:(e,t,s)=>{s.d(t,{NO:()=>_,LM:()=>Z,BW:()=>R,bV:()=>B,R$:()=>L});s(67294);var n=s(62208),i=s(73039),o=s(55863),a=s(70203),r=s(82990),l=s(9291),d=s(47307),c=s(82530),u=s(29919),m=s(72495),p=s(24405),g=s(98742),h=s(93405),f=s(74420),x=s(26388),y=s(85893);function S(e){let{menuListItemProps:t,title:s,caption:n,icon:i,disabled:o,tooltipText:a,showNewBadge:r}=e;window.__c={n:"CreateFromPageMenuItem"};const l=(0,p.yK)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,y.jsx)(x.ZP,{placement:x.ug.Right,textWrap:!1,disableTooltip:!a,renderTooltip:()=>a,render:e=>(0,y.jsx)(h.Z,{...(0,g.Z)(t,e),style:l.menuItem,title:s,caption:n,captionStyle:n?l.caption:void 0,svg:i,disabled:o,disabledFeedback:o,right:r&&(0,y.jsx)(f.Z,{})})})}var v=s(19037),b=s(95697),M=s(77080),j=s(21884),w=s(35057),C=s(73466),k=s(62967),T=s(11732);const I=(0,l.defineMessages)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}}),P=(e,t)=>(0,k.cN)({key:"turn page into team",displayName:t,analyticsName:I.createTeamFromPageFullName.defaultMessage,svg:n.z,validators:e,closeParentMenu:!0,render:(e,s)=>{const n=function(e){const{block:t,environment:s}=e;if(!s.currentUser.id)return;if(0===a.QaF(t.getTitleValue()).length)return(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,b.Pr)(t).accessLevel&&!(0,w.Rs)())return(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"})}({environment:s.environment,block:s.blocks[0]});return(0,y.jsx)(S,{menuListItemProps:e,title:(0,y.jsx)(l.FormattedMessage,{...t}),caption:(0,y.jsx)(l.FormattedMessage,{...I.createTeamFromPageCaption}),disabled:Boolean(n),tooltipText:n,icon:i.K})},action:e=>{let{blocks:t,environment:s}=e;const n=t[0];C.VG({environment:s,page:n})}}),Z=P([v.xD([v.jp,v.ff(v.KS)])],I.createTeamFromPageFullName),F=P([v.jp],I.createTeamFromPageName),_=(0,k.MV)({key:"turn into teamspace or wiki",displayName:T.s.turnIntoSection,analyticsName:T.s.turnIntoSection.defaultMessage,svg:n.z,validators:[v.jp,v.KS],subActions:()=>[(0,k.$J)({key:"turn into teamspace or wiki",render:e=>(0,y.jsx)(m.Z,{...e}),actions:[F,D]})],width:300}),A=(e,t)=>(0,k.cN)({key:"turn page into wiki",displayName:t,analyticsName:I.turnPageIntoWikiFullName.defaultMessage,svg:n.z,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;"bottom_right"===M.default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?j.E.setState({showConvertTooltip:!1,forceShow:!0,pendingWikiBlockStore:s[0]}):c.createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,perform:e=>{u.Y({environment:t,blocks:s,transaction:e,source:"page_menu"})}})},render:e=>(0,y.jsx)(S,{menuListItemProps:e,title:(0,y.jsx)(l.FormattedMessage,{...t}),disabled:!1,icon:n.z,caption:(0,y.jsx)(l.FormattedMessage,{...I.turnPageIntoWikiCaption})})}),R=A([v.xD([v.KS,v.ff(v.jp)])],I.turnPageIntoWikiFullName),D=A([v.KS],I.turnPageIntoWikiName);const B=A([v.KS],I.turnPageIntoWikiFullName),L=(0,k.cN)({key:"undo turn page into wiki",displayName:I.undoTurnPageIntoWikiName,analyticsName:I.undoTurnPageIntoWikiName.defaultMessage,svg:o.s,validators:[v.U7,v.U_,v.ff(v.p1),v.f7],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:s}=e;await d.confirmUserAction({message:(0,y.jsx)("div",{style:{textAlign:"center"},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to turn <bold>{pageName}</bold> back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:a.QaF(s[0].getTitleValue()),bold:e=>(0,y.jsx)("span",{style:{fontWeight:r.Z.fontWeight.semibold},children:e})}})}),description:(0,y.jsx)("div",{style:{textAlign:"center"},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})})&&c.createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,perform:e=>{u.Cq({environment:t,blocks:s,transaction:e,source:"page_menu"})}})}})},41311:(e,t,s)=>{s.d(t,{B3:()=>Z,T_:()=>P,XP:()=>k,bA:()=>I,h7:()=>F,w1:()=>C,y2:()=>T});s(57658);var n=s(92996),i=s(68626),o=s(4615),a=s(99405),r=s(23867),l=s(64002),d=s(9291),c=s(40663),u=s(95477),m=s(91924),p=s(77907),g=s(80444),h=s(22756),f=s(67940),x=s(57549),y=s(54642),S=s(47307),v=s(47839),b=s(43181),M=s(15356),j=s(82530);const w=(0,d.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function C(e){const{environment:t,flowId:s}=e;await y.disconnectAsana(t,{});const n=(0,m.eC)(t);let i=(0,a.s1)(u.default.domainBaseUrl,{authType:n,userId:t.currentUser.id});if(i=n.redirectToAuth?i:await(0,m.HU)(t,i),t.device.isElectron)return h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0}),void v.openExternalUrl(i);const o=await M.M(t,{width:580,height:800,url:i,titleMessage:w.titleMessage});if(!o)return;const r=l.Qc(o);if(!r.query.code||!r.query.state)return;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0});const d=await y.authWithAsana(t,{code:r.query.code,encryptedState:r.query.state}),c=await y.getAsanaWorkspacesNames(t,{});if("failed"===d.type)x.a1(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:d.error},flowId:s}),console.error(d.error),S.showError(d);else if(x.a1(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:s}),"success"===c.type){const{data:{account:e,workspaces:t}}=c;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!1,account:e,workspaces:t,currentTab:"selectData",isModalOpen:!0})}}async function k(e){const{environment:t}=e;h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!0});const s=await y.disconnectAsana(t,{});"failed"===s.type?(console.error(s.error),S.showError(s)):(x.qJ(t,{integration_name:"asana"}),"success"===s.type&&h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function T(e){const{selectedWorkspace:t,environment:s}=e;h.Z.setState({...h.Z.state,isLoadingProjects:!0});const n=await y.getTeamsAndProjectsInAsanaWorkspace(s,{workspaceId:t,size:5});"success"===n.type&&h.Z.setState({...h.Z.state,teamsAndProjects:n.data,isLoadingProjects:!1})}async function I(e){let{environment:t}=e;h.Z.setState({...h.Z.state,isLoadingAsanaWorkspaces:!0});const s=await y.getAsanaWorkspacesNames(t,{});"success"===s.type&&h.Z.setState({...h.Z.state,account:s.data.account,workspaces:s.data.workspaces,isLoadingAsanaWorkspaces:!1})}async function P(e){let{environment:t,spaceStore:s,currentSpaceViewStore:a,teamsStores:l,flowId:d}=e;const{appTemplatesSetupActions:u,appConfigs:m}=await p.deps.AppTemplates.loader(),S=h.Z.state.selectedWorkspace;if(!S)return;h.Z.setState({...h.Z.state,templateCreationInProgress:!0});const v={},M={};try{for(const e in h.Z.state.selectedProjectsAndTeamspaces){if(0===h.Z.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let i;const o=h.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:r}=o;if(!r)continue;const d=l.find((e=>e.id===o.notionTeamspaceId));if(i=d||s,M[r])v[e]=M[r];else{const{serverCommitResult:s,performResult:o}=j.createAndCommit({environment:t,perform:e=>{const s={type:"preset",uri:n.T3};if("preset"===s.type&&!s.uri.startsWith("notion://wiki")){var o;const n=s.uri,r=null===(o=(0,c.iX)(m(),n))||void 0===o?void 0:o.uri;if(!r)return;const l=m().find((e=>e.uri===r));if(null==l?void 0:l.presets.find((e=>e.uri===n))){return u.initializeApp({environment:t,spaceViewStore:a,appParentStore:i,appUri:r,presetUri:n,transaction:e,from:"asana_import"})}return[]}},userAction:"importActions.importAsana"});v[e]=o,M[r]=o,await s}}}catch(A){return void h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const w=[],C=g.default.state.currentSpaceViewStore;if(!C)return;const k=b.Ym({environment:t,spaceStore:s,spaceViewStore:C,append:!0});await k.deferred.promise;const T=k.pageId;h.Z.setState({...h.Z.state,loggerPageId:T});const I=new Set,P=[],Z=[];for(const n in v){const e=h.Z.state.selectedProjectsAndTeamspaces[n],t=v[n];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const i="string"==typeof e.projects?[]:e.projects;P.push(...i),I.add(e.notionTeamspaceId),Z.push(n),w.push({collectionViewBlocks:t.map((e=>({id:e.id,spaceId:(0,r.C)(s.id)}))),projectIds:i,asanaTeamId:n,notionTeamSpaceId:e.notionTeamspaceId,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}const F=y.parallelAsanaImport(t,{importParams:w,spaceId:(0,r.C)(s.id),asanaWorkspaceId:S,importCompletedTasks:h.Z.state.importCompletedTasks,loggerPageId:T,flowId:d||(0,o.ZP)()});h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"importingData",choosingWorkspacesCompleted:!0}),f.Z.reset();const _=h.Z.state.workspaces.find((e=>e.gid===S));_&&function(e,t,s){try{x.qy(e,{import_source:"asana",data:t,flowId:s})}catch(n){i.log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:n,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:_.name,teams:Z,projects:P,numberOfTeamspacesUsed:I.size,completedTasks:h.Z.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,r.C)(s.id)},d);for await(const n of F){if(!h.Z.state.isModalOpen)break;if(n.error)return void h.Z.setState({...h.Z.state,currentTab:"failure"});"success"===n.taskStatus&&h.Z.setState({...h.Z.state,currentTab:"confirm",result:n.value.status,isComplete:!0})}}function Z(e){var t;let{teamId:s,spaceId:n}=e;h.Z.setState({...h.Z.state,selectedProjectsAndTeamspaces:{...h.Z.state.selectedProjectsAndTeamspaces,[s]:{projects:(null===(t=h.Z.state.selectedProjectsAndTeamspaces[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:n}}})}function F(){h.Z.setState({...h.Z.state,isModalOpen:!0})}},79257:(e,t,s)=>{s.d(t,{D2:()=>h,Do:()=>g,M0:()=>m,W4:()=>p,bA:()=>c,xv:()=>u});var n=s(85680),i=s(98452),o=s(52258),a=s(50906),r=s(6404),l=s(96802),d=s(82530);function c(e){const{originRect:t}=e;o.Z.reset(),i.Z.reset(),r.xv(),n.Z.setState({isOpen:!0,rect:t})}function u(){n.Z.setState({isOpen:!1})}function m(e){const{format:t,store:s,property:n,visibility:i,transaction:o}=e,a=t.property_visibility;a&&o&&l.FH({stores:[s],update:{property_visibility:Object.values(a||{}).map((e=>({property:e.property,visibility:n===e.property?i:e.visibility})))},transaction:o})}function p(e){const{store:t,pageSection:s,visibility:n,environment:i,format:o}=e,r=o.page_section_visibility;r&&(a.Mzl(i,{section:s,visibility:n}),d.createAndCommit({userAction:"customizePageActions.updatePageSectionVisibility",environment:i,perform:e=>{l.FH({stores:[t],update:{page_section_visibility:{...r,[s]:n}},transaction:e})}}))}function g(e){const{store:t,transaction:s,pageSectionFormats:n}=e;l.FH({stores:[t],update:{collection_page_sections:n},transaction:s})}function h(e){const{store:t,properties:s,environment:n}=e;d.createAndCommit({userAction:"customizePageActions.updateCollectionPageProperties",environment:n,perform:e=>{l.FH({stores:[t],update:{collection_page_properties:s},transaction:e})}})}},43181:(e,t,s)=>{s.d(t,{Ym:()=>U,A1:()=>z,am:()=>K,ro:()=>V,su:()=>W});s(57658),s(21703);var n=s(13991),i=s(41432),o=s(7057),a=s(7406),r=s(68626),l=s(59730);const d=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],c=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],u={markdown:c,csv:["text/plain",".csv"],html:["text/html"],docx:d,gdocs:d,dropbox:d,quip:["text/html",c],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"]};var m=s(72126),p=s(91155),g=s(38737),h=s(29477),f=s(4615),x=s(21202),y=s(23867),S=s(9291),v=s(72340),b=s(33954),M=s(8989),j=s(33929),w=s(36214),C=(s(46190),s(78900)),k=s(90365),T=s(82066),I=s(88923),P=s(26136),Z=s(57549),F=s(54642),_=s(47307),A=s(94419),R=s(92625),D=s(9953),B=s(28014),L=s(82530),O=s(53471);const E=(0,S.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"{fileName} Import {date}"}}),N=1073741824;async function V(e){const{environment:t,pageStore:s,spaceStore:i,isTeamPage:d,spaceViewStore:c,uploadType:m,flowId:y}=e;let S;try{var w;const a=await O.y({multiple:!0,accept:u[m].join(",")});if(0===a.length)return;const r=1===a.length;if("confluence"===m){const s=(Number((0,v.$6)(t))||15)*N;if(a[0].size>s)throw Z.a1(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:a[0].size},flowId:y}),new l.nY("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:g.td(s,1)}}})}else if("genericImporter"===m){const s=(0,M.b)(t)||15,n=s*N;if(a[0].size>n)throw Z.a1(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:a[0].size},flowId:y}),new l.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${s} GB}`}}})}const p=await new Promise(((e,s)=>{O.IL({environment:t,uploadType:m,files:a,bucket:"temporary",preventLimitFreeFileSize:!0,flowId:y,onBatchStart:()=>{R.j({message:r?E.uploadingOneFile:E.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:a.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:t,progressPercent:s}=e;R.j({message:r?E.uploadingOneFile:E.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:t,totalNumberOfFiles:a.length,percentComplete:s}})},onBatchComplete:t=>{R.j({message:r?E.uploadingOneFile:E.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:a.length,percentComplete:100}}),e(t)},onBatchError:s})}));let b,C;if(I.default.isSidePeekOpen()&&null!==(w=I.default.peekTarget.state)&&void 0!==w&&w.isEmptyPage())b=I.default.peekTarget.state.id,C="ReplaceBlock";else if(s&&s.isEmptyPage())a.length>1||s.isInsideCollection()?(b=s.id,C="AppendToBlock"):(b=s.id,C="ReplaceBlock");else{const e={date:(0,o.Yx)(Date.now(),"medium",n.SP)};"genericImporter"===m&&(null!=a&&a[0].name?e.fileName=null==a?void 0:a[0].name.replace(".zip",""):e.fileName=(null==a?void 0:a[0].name)||"Universal File");const{performResult:s}=L.createAndCommit({userAction:"importActions.result",environment:t,perform:s=>{const n=j.default.formatMessage("genericImporter"===m?E.importTitleForGenericFileImporter:E.importTitle,e),o=B.KE({environment:t,spaceStore:i,spaceViewStore:c,isPrivate:!d,prepend:!d,title:n,transaction:s});let r;r=a.length>1?"AppendToBlock":"ReplaceBlock";const l=h.UZ();return s.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:o,pageId:o.id,importType:r}}});S=s.createdPage,b=s.pageId,C=s.importType,await s.deferred.promise}const k=p.map(((e,t)=>({fileURL:e,fileName:a[t].name})));let T=0;R.j({message:r?E.importingOneFile:E.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:a.length}});for(const{fileURL:e,fileName:s}of k){if("confluence"===m){Z.a1(t,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:a[0].size},flowId:y});const n=U({environment:t,spaceStore:i,spaceViewStore:c});await n.deferred.promise;const o=n.pageId,r=F.parallelImportConfluenceExport(t,{fileURL:e,fileName:s,page:{id:b,spaceId:i.id},loggerPageId:o,flowId:y||(0,f.ZP)()});for await(const e of r){if(e.error)throw e.error;e.value.isComplete||R.j(e.value.status)}}else if("AppendToBlock"===C){const n={fileURL:e,fileName:s,importType:C,block:{id:b,spaceId:i.id},flowId:y};Z.qy(t,{import_source:"file",data:n,flowId:y});const{value:o}=await F.importFile(t,n).next();if(o.error)throw o.error}else if("ReplaceBlock"===C){const n={fileURL:e,fileName:s,importType:C,block:{id:b,spaceId:i.id},flowId:y};Z.qy(t,{import_source:"file",data:n,flowId:y});const{value:o}=await F.importFile(t,n).next();if(o.error)throw o.error}T++,R.j({message:r?E.importingOneFile:E.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:T,totalNumberOfFiles:a.length}})}return R.x(),P.G.createChildStore(i,{table:x.iU,id:b})}catch(k){var C;let e;r.log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,p.Ui)(k),data:{spaceId:i.id}}),R.x(),L.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{S&&A.Od({parent:i.getPagesStore(),childToRemove:S,transaction:e})}});let s=null,n=null;if(k instanceof l.hm&&k.clientData?(s=k.clientData,b.Em[k.clientData.type]&&"ImportFileSizeTooLargeError"===(0,a.tg)(k).message?n=b.Em[k.clientData.type]:b.$5[k.clientData.type]&&"CsvImportError"===(0,a.tg)(k).message?n=b.$5[k.clientData.type]:b.zP[k.clientData.type]&&(n=b.zP[k.clientData.type])):k instanceof l.nY&&"upload_file_size_exceeded"===(null===(C=k.body)||void 0===C||null===(C=C.clientData)||void 0===C?void 0:C.type)&&b.zP[k.body.clientData.type]&&(s=k.body.clientData,n=b.zP[s.type]),s&&n){const t="messageValues"in s?s.messageValues:void 0;e=j.default.formatMessage(n,t)}else e="ImportFileSizeTooLargeError"===(0,a.tg)(k).message?j.default.formatMessage(E.fileImportFailedSizeTooLarge):j.default.formatMessage(E.importFailed);throw _.showErrorMessage(e),k}}function U(e){const{environment:t,spaceStore:s,spaceViewStore:i,append:a}=e,{performResult:r}=L.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const r=j.default.formatMessage(E.importTitle,{date:(0,o.Yx)(Date.now(),"medium",n.SP)}),l=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!a,title:`${r} Logs`,transaction:e}),d=h.UZ();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve()})),{deferred:d,pageId:l.id}}});return r}async function W(e){const{environment:t,boards:s,spaceStore:n,spaceViewStore:i}=e;R.j({message:E.importingFromTrelloMessage,interpolatedValues:{importingCount:s.length}}),T.Z.setState({open:!1});const{performResult:{deferred:o,pages:r}}=L.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const o=s.map((s=>B.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!0,title:s.name,transaction:e}))),a=h.UZ();return e.postSubmitCallbacks.push((e=>{e?a.reject(e):a.resolve()})),{deferred:a,pages:o}}});await o.promise;try{return await Promise.all(r.map((async(e,n)=>{const i=s[n],{value:o}=await F.importTrello(t,{boardId:i.id,block:{id:e.id,spaceId:(0,y.C)(e.pointer.spaceId)}}).next();if(o.error)throw o.error}))),R.x(),r[0]}catch(l){throw L.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of r)A.Od({parent:n.getPagesStore(),childToRemove:t,transaction:e})}}),_.showErrorMessage(j.default.formatMessage(E.trelloImportFailed)),R.x(),new Error((0,a.tg)(l).message)}}async function K(e){const{environment:t,spaceStore:s,spaceViewStore:n,notebooks:o,userSettingsStore:a}=e;if(0===o.length)throw new Error("Expected at least one notebook");R.j({message:E.importingFromEvernoteMessage,interpolatedValues:{importingCount:o.length}}),k.Z.setState({open:!1});const r=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,notebooks:o}=e,{serverCommitResult:a,performResult:{blockStores:r}}=L.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const a=m.jj(m.oA(o.map((e=>e.stack)))).sort().reverse(),r={};let l=e=>!0;return o.length>1&&a.length>0&&(a.forEach((a=>{const l=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!1,title:a,transaction:e}),d=l.getContentStore();o.filter((e=>e.stack===a)).forEach((s=>{const n=D.j4({environment:t,type:i.Ti.copyIndicator,inMemoryRecordCache:l.inMemoryRecordCache,transaction:e,spaceId:d.pointer.spaceId,useCrdt:l.useCrdt()});A.R3({parent:d,append:n,transaction:e}),r[s.guid]=n}))})),l=e=>!Boolean(e.stack)),o.filter(l).reverse().forEach((i=>{const o=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:i.title,transaction:e});r[i.guid]=o})),{blockStores:r}}});return await a,r}({environment:t,spaceStore:s,spaceViewStore:n,notebooks:o}),l=r[o[0].guid];try{return await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,notebooks:i,waitForNotebook:o,notebookMapping:a,userSettingsStore:r}=e;let l;if(h.dC(i,2,(async e=>{await Promise.all(e.map((async e=>{const s=a[e.guid];if(!s)throw new Error(`Missing notebook page ${e.guid}`);const n=h.UZ();s===o&&(l=n),await async function(e){const{environment:t,notebookStore:s,notebook:n,firstCompleted:i}=e,o=F.importEvernote(t,{notebookId:n.guid,block:{id:s.id,spaceId:(0,y.C)(s.pointer.spaceId)},timestamp:Date.now(),parentTable:x.iU}),{value:a}=await o.next();a.error&&(console.error(a.error),L.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=s.getParentBlockStore();if(t){const n=t.getContentStore();A.Od({parent:n,childToRemove:s,transaction:e})}}}),_.showErrorMessage(j.default.formatMessage(E.evernoteImportFailed)));i.resolve(void 0)}({environment:t,notebookStore:s,notebook:e,firstCompleted:n})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await w.FI({environment:t,type:"evernote",spaceStore:s,spaceViewStore:n,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:l,notebookMapping:r,notebooks:o,spaceStore:s,spaceViewStore:n,userSettingsStore:a}),R.x(),l}catch(d){throw R.x(),_.showErrorMessage(j.default.formatMessage(E.evernoteImportFailed)),d}}async function z(e){const{environment:t,spaceStore:s,spaceViewStore:i,space:l,flowId:d}=e;if(!t.currentUser.id)throw new Error("User does not exist.");R.j({message:E.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:l.name}}),C.Z.setState({open:!1});const c=U({environment:t,spaceStore:s,spaceViewStore:i});await c.deferred.promise;const u=c.pageId,{performResult:m}=L.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{const a=j.default.formatMessage(E.importTitle,{date:(0,o.Yx)(Date.now(),"medium",n.SP)}),r=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!0,title:a,transaction:e}),l=h.UZ();return e.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:r,pageId:r.id}}});await m.deferred.promise;const g=m.createdPage;try{if(!g)throw new Error("No root page");const e=F.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:l.key,confluenceSpaceId:l.id,page:{id:m.pageId,spaceId:s.id},loggerPageId:u,flowId:d});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||R.j(t.value.status)}return R.x(),g}catch(f){throw r.log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,p.Ui)(f),data:{spaceId:s.id}}),L.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{g&&A.Od({parent:s.getPagesStore(),childToRemove:g,transaction:e})}}),_.showErrorMessage(j.default.formatMessage(E.confluenceImportViaAPIFailed)),R.x(),new Error((0,a.tg)(f).message)}}},61397:(e,t,s)=>{s.d(t,{C8:()=>k,FM:()=>j,IO:()=>w,eL:()=>C,h7:()=>v,qF:()=>b,sC:()=>M});s(57658);var n=s(92996),i=s(68626),o=s(23867),a=s(9291),r=s(47307),l=s(40663),d=s(33929),c=s(77907),u=s(80444),m=s(67940),p=s(69122),g=s(57549),h=s(54642),f=s(43181),x=s(92625),y=s(82530);const S=(0,a.defineMessages)({successfullyConnected:{id:"mondayActions.successfullyConnected.message",defaultMessage:"Successfully connected monday.com instance."}});function v(){p.Z.setState({...p.Z.state,isModalOpen:!0})}async function b(e){const{environment:t,userEmail:s,APIToken:n,flowId:i,spaceId:o}=e;if(!t.currentUser.id||!s||!n)return r.showMessage({message:"Invalid details"}),void x.x();const a=await h.authenticateMondayUser(t,{userId:t.currentUser.id,spaceId:o,userEmail:s,APIToken:n});"failed"===a.type?(g.a1(t,{import_source:"monday.com",data:{import_type:"api",status:"failure",error:a.error},flowId:i}),console.error(a.error),r.showError(a)):(g.a1(t,{import_source:"monday.com",data:{import_type:"api",status:"success"},flowId:i}),p.Z.setState({...p.Z.state,account:s}),r.showMessage({message:d.default.formatMessage(S.successfullyConnected)})),x.x()}async function M(e){const{environment:t,spaceId:s}=e,n=await h.disconnectMonday(t,{spaceId:s});"failed"===n.type?r.showError(n):(g.qJ(t,{integration_name:"monday.com"}),"success"===n.type&&p.Z.setState({...p.Z.state,account:void 0,workspaces:[]}))}async function j(e){const{environment:t,spaceId:s}=e;p.Z.setState({...p.Z.state,isLoadingMondayWorkspaces:!0});const n=await h.getMondayWorkspaces(t,{spaceId:s});"success"===n.type&&p.Z.setState({...p.Z.state,workspaces:n.data.workspaces,isLoadingMondayWorkspaces:!1})}async function w(e){const{environment:t,spaceId:s,selectedWorkspace:n}=e;if(!s)return;p.Z.setState({...p.Z.state,isLoadingProjects:!0});const i=await h.getMondayFoldersAndBoards(t,{spaceId:s,selectedWorkspace:n});"success"===i.type&&p.Z.setState({...p.Z.state,mondayFoldersAndBoards:i.data.mondayFoldersAndBoards,isLoadingProjects:!1})}function C(e){var t;let{folderId:s,spaceId:n}=e;p.Z.setState({...p.Z.state,selectedProjectsAndTeamspaces:{...p.Z.state.selectedProjectsAndTeamspaces,[s]:{projects:(null===(t=p.Z.state.selectedProjectsAndTeamspaces[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:n}}})}async function k(e){const{environment:t,spaceStore:s,currentSpaceViewStore:a,teamsStores:r,flowId:d}=e,{appTemplatesSetupActions:x,appConfigs:S}=await c.deps.AppTemplates.loader(),v=p.Z.state.selectedWorkspace;if(!v)return;p.Z.setState({...p.Z.state,templateCreationInProgress:!0});const b={},M={},j=[],w=new Set;try{for(const e in p.Z.state.selectedProjectsAndTeamspaces){const i=p.Z.state.selectedProjectsAndTeamspaces[e].projects;if(0===i.length)continue;let o;j.push(...i.map((e=>e.mondayProjectId)));const d=p.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:c}=d;if(!c)continue;w.add(c);const u=r.find((e=>e.id===d.notionTeamspaceId));if(o=u||s,!b[c]){const{serverCommitResult:e,performResult:s}=y.createAndCommit({environment:t,perform:e=>{const s={type:"preset",uri:n.T3};if("preset"===s.type&&!s.uri.startsWith("notion://wiki")){var i;const n=s.uri,r=null===(i=(0,l.iX)(S(),n))||void 0===i?void 0:i.uri;if(!r)return;const d=S().find((e=>e.uri===r));if(null==d?void 0:d.presets.find((e=>e.uri===n))){return x.initializeApp({environment:t,spaceViewStore:a,appParentStore:o,appUri:r,presetUri:n,transaction:e,from:"monday_import"})}return[]}},userAction:"importActions.importMonday"});b[c]=s,await e}M.hasOwnProperty(c)?M[c]=[...M[c],{mondayFolderId:e,projects:i}]:M[c]=[{mondayFolderId:e,projects:i}]}}catch(Z){return void p.Z.setState({...p.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const C=[],k=u.default.state.currentSpaceViewStore;if(!k)return;const T=f.Ym({environment:t,spaceStore:s,spaceViewStore:k,append:!0});await T.deferred.promise;const I=T.pageId;p.Z.setState({...p.Z.state,loggerPageId:I});for(const[n,i]of Object.entries(M)){const e=b[n];e&&C.push({collectionViewBlocks:e.map((e=>({id:e.id,spaceId:(0,o.C)(s.id)}))),notionTeamSpaceId:n,mondayProjectsAndFolders:i})}const P=h.parallelMondayImport(t,{importParams:C,loggerPageId:I,spaceId:s.id,flowId:d});p.Z.setState({...p.Z.state,templateCreationInProgress:!1,currentTab:"importingData"}),m.Z.reset(),v&&function(e,t,s){try{g.qy(e,{import_source:"monday.com",data:t,flowId:s})}catch(n){i.log({level:"error",from:"mondayActions",type:"parallelMondayImport",error:{miscDataString:JSON.stringify({error:n,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceId:v,projects:j,numberOfTeamspacesUsed:w.size,userId:t.currentUser.id,spaceId:(0,o.C)(s.id)},d);for await(const n of P){if(!p.Z.state.isModalOpen)break;if(n.error)return void p.Z.setState({...p.Z.state,currentTab:"failure"});"success"===n.taskStatus&&p.Z.setState({...p.Z.state,currentTab:"confirm",result:n.value.status,isComplete:!0})}}},360:(e,t,s)=>{s.d(t,{l:()=>i,q:()=>o});var n=s(25399);function i(){n.Z.setState({open:!0,submitted:!1,error:void 0})}function o(){n.Z.setState({open:!1})}},37834:(e,t,s)=>{s.d(t,{FF:()=>h,U4:()=>f,gs:()=>x,jN:()=>g,xx:()=>S,zb:()=>y});s(67294);var n=s(23867),i=s(82990),o=s(9291),a=s(77080),r=s(46096),l=s(50906),d=s(54642),c=s(47307),u=s(92625),m=s(85893);const p=(0,o.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoring…"}});function g(e){const{environment:t,from:s,...n}=e;l.ya1(t,s),r.Z.setState({...n,open:!0,size:50})}const h=()=>{const e=r.Z.state;e.open&&r.Z.setState({...e,size:e.size+20})},f=function(){r.Z.setState({open:!1})};function x(e){const{environment:t,snapshot:s,nextFutureSnapshot:n}=e;l.qDg(t,s);const i=r.Z.state;i.open&&r.Z.setState({...i,snapshot:s,nextFutureSnapshot:n,openSnapshotNearTimestamp:void 0})}function y(){const e=r.Z.state;e.open&&r.Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function S(e){if(!r.Z.state.open)return;if(!r.Z.state.snapshot)return;const t="restore_collection",s=r.Z.state.pageHasCollection,g=a.default.checkGate("snapshot_optional_collection_rollback_enabled")&&s?[{key:t,text:(0,m.jsx)(o.FormattedMessage,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,m.jsx)(o.FormattedMessage,{defaultMessage:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:h,selectionResult:x}=await c.confirmUserActionV2({message:(0,m.jsx)("div",{style:{fontWeight:i.Z.fontWeight.semibold,fontSize:"medium"},children:(0,m.jsx)(o.FormattedMessage,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,m.jsx)(o.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:g});if(!h)return;l.R9m(e,r.Z.state.snapshot),u.j({message:p.restoringPreviousVersion});const y=await d.restoreSnapshot(e,{block:{id:r.Z.state.blockStore.id,spaceId:(0,n.C)(r.Z.state.blockStore.pointer.spaceId)},timestamp:r.Z.state.snapshot.timestamp,shouldRestoreCollection:(null==x?void 0:x.restore_collection)??!1}).next();y.value.error&&c.showErrorMessage(y.value.error.message),u.x(),f()}},54814:(e,t,s)=>{s.d(t,{nc:()=>l,rG:()=>r});s(57658);var n=s(6287),i=s(98165),o=s(26136),a=s(54642);async function r(e){let{environment:t,spaceId:s,databaseType:i,parentStore:r}=e;if(!s)return;const l=await a.getTypedDatabases(t,{spaceId:s,databaseType:i});return"success"===l.type?l.data.result.map((e=>o.NW.createChildStore(r,{table:n.v,id:e.collectionId}))):void 0}async function l(e){let{environment:t,spaceId:s,databaseTypes:n,parentStore:o,teamId:a}=e;const l=[];return await Promise.all(n.map((async e=>{await async function(e){let{environment:t,spaceId:s,databaseType:n,parentStore:o,teamId:a}=e;const l=await r({spaceId:s,environment:t,databaseType:n,parentStore:o});if(!l)return!1;for(const r of l){const e=i.VP(r);if(e&&e.id===a)return!0}return!1}({environment:t,spaceId:s,databaseType:e,parentStore:o,teamId:a})&&l.push(e)}))),l}},16859:(e,t,s)=>{s.d(t,{d:()=>Z});var n=s(67294),i=s(480),o=s(9291),a=s(73063),r=s(53437),l=s(26388),d=s(935),c=s(24405),u=s(64275),m=s(81570),p=s(83065),g=s(82990),h=s(42922),f=s(64921),x=s(60458),y=s(1743),S=s(74194),v=s(16354),b=s(64369),M=s(42402),j=s(43250),w=s(18514),C=s(85893);function k(e){const{checked:t,onChange:s}=e;return(0,C.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[(0,C.jsx)(x.Z,{checked:t,onClick:s,size:14}),(0,C.jsx)("div",{onClick:s,children:(0,C.jsx)(b.Z,{style:{cursor:"pointer"},isSmall:!0,children:(0,C.jsx)(o.FormattedMessage,{defaultMessage:"Share this AI session with Notion",id:"completions.FeedbackPopup.shareWithNotion"})})})]})}function T(){window.__c={n:"OptInLearnMore"};const e=(0,c.yK)((e=>({container:{display:"flex",flexDirection:"row"},giftIcon:{width:16,height:16,fill:e.lightIconColor},message:{marginLeft:9,color:e.mediumTextColor,fontSize:12}})),[]);return(0,C.jsxs)("div",{style:e.container,children:[(0,m.T)(e.giftIcon),(0,C.jsx)("div",{style:e.message,children:(0,C.jsx)(o.FormattedMessage,{defaultMessage:"You’re sharing data with Notion for AI quality improvement. <aiTerms>Learn more</aiTerms>",id:"completions.OptInLearnMore.description",values:{aiTerms:e=>(0,C.jsx)(M.Z,{external:!0,href:(0,w.UY)("ai.dataSharingTerms"),children:e})}})})]})}function I(e){window.__c={n:"ShareDataPopup"};const{onSubmit:t}=e,s=(0,c.yK)((e=>({container:{width:300,display:"flex",flexDirection:"column",alignItems:"center",padding:19,position:"relative"},closeButtonContainer:{position:"absolute",top:10,right:10},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},giftIcon:{width:24,height:24,fill:e.lightIconColor},terms:{color:e.mediumTextColor,textAlign:"center",fontSize:13},shareButton:{width:"100%",marginTop:17,paddingTop:7,paddingBottom:7},notNowButton:{color:e.mediumTextColor,fontSize:14,marginTop:15},title:{textAlign:"center",marginTop:9,marginBottom:8,fontWeight:g.Z.fontWeight.semibold}})),[]);return(0,C.jsxs)("div",{style:s.container,children:[(0,C.jsx)("div",{style:s.closeButtonContainer,children:(0,C.jsx)(f.Z,{onClick:()=>{t({optIn:!1})},style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,u.D)(s.closeButtonIcon)})}),(0,m.T)(s.giftIcon),(0,C.jsx)("div",{style:s.title,children:(0,C.jsx)(o.FormattedMessage,{defaultMessage:"Always share data to improve Notion AI?",id:"completions.ShareDataPopup.title"})}),(0,C.jsx)("div",{style:s.terms,children:(0,C.jsx)(o.FormattedMessage,{defaultMessage:"Help Notion improve AI quality by automatically sharing data from your usage of AI powered features.{br}By continuing, you agree to <aiTerms>AI Data Sharing Terms</aiTerms>",id:"completions.ShareDataPopup.description",values:{br:(0,C.jsx)("br",{}),aiTerms:e=>(0,C.jsx)(M.Z,{external:!0,href:(0,w.UY)("ai.dataSharingTerms"),children:e})}})}),(0,C.jsx)(h.Z,{style:s.shareButton,onClick:()=>{t({optIn:!0})},children:(0,C.jsx)(o.FormattedMessage,{defaultMessage:"Always share",id:"completions.ShareDataPopup.alwaysShareButton"})}),(0,C.jsx)(v.Z,{style:s.notNowButton,onClick:()=>{t({optIn:!1})},children:(0,C.jsx)(o.FormattedMessage,{defaultMessage:"Not now",id:"completions.ShareDataPopup.notNowButton"})})]})}function P(e){window.__c={n:"FeedbackPopup"};const{state:t,onUpdate:s,onSubmit:r,onCancel:l,userOptIn:d}=e,c=(0,n.useCallback)((()=>{s({...t,shareWithNotion:!t.shareWithNotion})}),[t,s]),u=(0,n.useCallback)((()=>{r(t)}),[r,t]),m=(0,n.useCallback)((e=>{s({...t,userContent:e.target.value})}),[s,t]),g=(0,o.useIntl)(),h=(0,i.O7)(),f=!d;return(0,C.jsx)("div",{style:{padding:14,...h.device.isMobile?{width:"100%"}:{minWidth:400}},className:j.YOJ,children:(0,C.jsxs)(y.Z,{capture:!0,children:[(0,C.jsx)(S.Z,{value:t.userContent,onChange:m,onSubmit:e=>{e.stopPropagation(),u()},onCancel:l,focusInitial:!0,placeholder:g.formatMessage({id:"completions.FeedbackPopup.userCommentPlaceholder",defaultMessage:"How could the output be improved? (optional)"})}),(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingTop:10},children:[f?(0,C.jsx)(k,{checked:t.shareWithNotion,onChange:c}):(0,C.jsx)(T,{}),(0,C.jsx)(a.Z,{icon:p._,onClick:u,ariaLabel:g.formatMessage({id:"completions.FeedbackPopup.submitButtonLabel",defaultMessage:"Submit feedback"}),isBlue:!0,iconStyle:{height:24,width:24},style:{height:20,width:20}})]})]})})}function Z(e){window.__c={n:"FeedbackButtonWithPopup"};const{type:t,ariaLabel:s,onClick:c,feedbackState:u,onDismiss:m,onSubmit:p,onUpdate:g,showShareDataPopup:h,onDataShareSubmit:f,userOptIn:x,iconButtonStyles:y}=e,S=(0,i.O7)(),v=t===(null==u?void 0:u.type),b=(0,d.L)(t,v),M=(0,n.useCallback)((()=>c(t)),[c,t]),j=(0,C.jsx)(l.ZP,{renderTooltip:()=>(0,C.jsx)("div",{children:(0,C.jsx)(o.FormattedMessage,{defaultMessage:"Share feedback with Notion",id:"completions.CompletionMenuActionBar.feedbackTooltip"})}),placement:l.ug.Bottom,render:e=>(0,C.jsx)(a.Z,{onClick:M,icon:b,ariaLabel:s,style:{...y},...e})});return(0,C.jsx)(r.ZP,{origin:j,open:(null==u?void 0:u.type)===t,popupType:S.device.isMobile?r.kQ.SlideUp:r.kQ.Popup,onDismiss:m,render:()=>u?h?(0,C.jsx)(I,{onCancel:m,onSubmit:f}):(0,C.jsx)(P,{state:u,onSubmit:p,onUpdate:g,onCancel:m,userOptIn:x}):null})}},935:(e,t,s)=>{s.d(t,{L:()=>b,u:()=>M});var n=s(67294),i=s(480),o=s(86628),a=s(33676),r=s(97022),l=s(39986),d=s(10498),c=s(9291),u=s(10910),m=s(64964),p=s(82530),g=s(37181),h=s(80444),f=s(77080),x=s(35057),y=s(83919),S=s(16859),v=s(85893);function b(e,t){switch(e){case"thumbsup":return t?d.w:l.P;case"thumbsdown":return t?r.E:a.A}}function M(e){window.__c={n:"FeedbackButtons"};const{revision:t}=e,s=(0,c.useIntl)(),a=(0,i.O7)(),[r,l]=(0,n.useState)(void 0),[d,b]=(0,n.useState)(!1),M=(0,n.useRef)(null),j=(0,o.VK)((()=>f.default.checkGate("ai_data_sharing")),[]),w=(0,o.VK)((()=>h.default.state.currentUserSettingsStore),[]),C=(0,o.VK)((()=>{var e;const t=null==w||null===(e=w.getSettings())||void 0===e?void 0:e.seen_ai_data_share_prompt_at,s=!(0,x.mq)();return!Boolean(t)&&s}),[w]),k=(0,o.VK)((()=>{var e;return(null==w||null===(e=w.getSettings())||void 0===e?void 0:e.ai_data_share_opt_in)??false}),[w]),T=(0,n.useCallback)((()=>{m.oV({label:s.formatMessage({id:"completions.CompletionMenuFooter.showFeedbackThanksMessage",defaultMessage:"Thanks for submitting feedback!"})})}),[s]),I=(0,n.useCallback)((e=>{M.current=document.activeElement,l((t=>({userContent:"",shareWithNotion:true,...t,type:e})))}),[]),P=(0,n.useCallback)((e=>{e.shareWithNotion&&C&&j?b(!0):(T(),l(void 0)),y.submitFeedbackForRevision({...e,environment:a,revision:t,userOptIn:k})}),[t,a,k,C,j,T]),Z=(0,n.useCallback)((e=>{e&&e.stopPropagation&&e.stopPropagation(),l(void 0),M.current&&M.current instanceof HTMLElement&&M.current.focus()}),[]),F=(0,n.useCallback)((e=>{const{optIn:t}=e;w&&(p.createAndCommit({userAction:"FeedbackButtons.aiDataShareOptIn",environment:a,userId:w.id,perform:e=>{g.d2({userSettingsStore:w,data:{ai_data_share_opt_in:t,seen_ai_data_share_prompt_at:Date.now()},transaction:e})}}),u.bd(a,{user_opt_in:t}),t?m.oV({label:s.formatMessage({id:"completions.CompletionMenuFooter.dataShareThanks",defaultMessage:"Thank you for your help making Notion better!"})}):T(),b(!1),l(void 0))}),[s,w,a,T]);return t.hasFeedback&&!d?null:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(S.d,{type:"thumbsup",ariaLabel:s.formatMessage({id:"completions.CompletionMenuFooter.thumbsUp",defaultMessage:"Submit positive feedback"}),onClick:I,feedbackState:r,onDismiss:Z,onSubmit:P,onUpdate:l,showShareDataPopup:d,onDataShareSubmit:F,userOptIn:k}),(0,v.jsx)(S.d,{type:"thumbsdown",ariaLabel:s.formatMessage({id:"completions.CompletionMenuFooter.thumbsDown",defaultMessage:"Submit negative feedback"}),onClick:I,feedbackState:r,onDismiss:Z,onSubmit:P,onUpdate:l,showShareDataPopup:d,onDataShareSubmit:F,userOptIn:k})]})}},41229:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var n=s(67294),i=s(13991),o=s(480),a=s(86628),r=s(24405),l=s(82356),d=s(4615),c=s(97880),u=s(9291),m=(s(54642),s(44458)),p=s(28344),g=(s(95477),s(1853)),h=s(76110),f=s(80444),x=s(21273),y=s(67940),S=s(92083),v=s(31809),b=s(66309),M=s(89024),j=s(90403),w=s(97122),C=s(89728),k=s(64369),T=s(6175),I=s(85893);const P=!1;function Z(){window.__c={n:"IntroVideo"};const e=(0,v.useNamedStyles)();return(0,I.jsx)(T.Z,{src:(0,h.Ix)(),defaultTextTrack:T.W[i.SP]||"en",options:{muted:!0,autoplay:!0,loop:!0},style:e.stubPng})}function F(e){const{currentUserSettingsStore:t}=f.default.state;t&&(0,m.CX)(e,{userSettingsStore:t,phase:"tooltip",transactionUserAction:"AiQnaIntroModal.debug.clickTryNow"})}function _(e){window.__c={n:"ImportContent"};const{onImport:t,onSkip:s}=e,i=(0,v.useNamedStyles)(),a=(0,r.Fg)(),d=(0,o.O7)();return(0,n.useEffect)((()=>{(0,p.trackQnaIntroModalShowImportRecommendation)(d)}),[d]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.U4,{}),(0,I.jsxs)(M.jX,{gap:30,children:[(0,I.jsx)(M.jX,{padding:"10px 22px 0px 28px",children:(0,l.l)({marginTop:20,marginBottom:-10,width:32,height:32,fill:a.lightIconColor})}),(0,I.jsxs)("div",{style:i.introCopyArea,children:[(0,I.jsx)("div",{style:i.introTitle,children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Add content for Q&A",id:"AiQnaIntroModal.import.title"})}),(0,I.jsx)(k.Z,{isSecondaryColor:!0,isMultiline:!0,style:i.mainCopyText,children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"AI answers questions from content in your Notion workspace. Get better responses by importing content from other tools.",id:"AiQnaIntroModal.import.caption"})})]}),(0,I.jsxs)(v.Footer,{children:[(0,I.jsx)(v.LearnMoreLink,{shouldShowHelpCenterLink:!0}),(0,I.jsxs)(M.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:[(0,I.jsx)(C.Z,{isGray:!0,onClick:s,children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Skip",id:"AiQnaIntroModal.import.skipButtonLabel"})}),(0,I.jsx)(w.h,{onClick:t,children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Import",id:"AiQnaIntroModal.import.importButtonLabel"})})]})]})]})]})}function A(e){window.__c={n:"ShouldShowImportModalRequest"};const{setShouldShowImportModal:t}=e,s=(0,o.O7)(),i=(0,a.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return null==e?void 0:e.getSpaceId()}),[]);return(0,n.useEffect)((()=>{t(P)}),[s,t,i]),null}function R(e){window.__c={n:"WelcomeContent"};const{onContinue:t}=e,s=(0,v.useNamedStyles)(),i=(0,o.O7)();return(0,n.useEffect)((()=>{(0,p.trackQnaIntroModalOpen)(i)}),[i]),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.U4,{}),(0,I.jsxs)(M.jX,{gap:30,children:[(0,I.jsx)(Z,{}),(0,I.jsxs)("div",{style:s.introCopyArea,children:[(0,I.jsx)(v.NotionAI,{}),(0,I.jsxs)("div",{style:s.introTitle,children:[(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Welcome to Q&A",id:"AiQnaIntroModal.intro.title"}),(0,I.jsx)(j.Z,{style:s.betaBadge,content:(0,I.jsx)(u.FormattedMessage,{id:"AiQnaIntroModal.intro.betaLabel",defaultMessage:"Beta"})})]}),(0,I.jsx)(k.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.mainCopyText,children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiQnaIntroModal.intro.caption"})})]}),(0,I.jsxs)(v.Footer,{children:[(0,I.jsx)(v.LearnMoreLink,{shouldShowHelpCenterLink:!0}),(0,I.jsx)(M.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:(0,I.jsx)(w.h,{onClick:t,children:(0,I.jsx)(u.FormattedMessage,{defaultMessage:"Continue",id:"AiQnaIntroModal.intro.signup.nextMessage"})})})]})]})]})}const D=(0,u.injectIntl)((function(e){window.__c={n:"AiQnaIntroModal"};const[t,s]=(0,n.useState)(!1),i=(0,o.O7)(),l=(0,r.Fg)(),[u,h]=(0,n.useState)(P),[v,M]=(0,n.useState)("welcome"),[j,w]=(0,n.useState)(!1),C=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=f.default.state;e&&((0,m.CX)(i,{userSettingsStore:e,phase:"tooltip",transactionUserAction:"AiQnaIntroModal.debug.clickCancel"}),(0,p.trackQnaIntroModalClose)(i,{modal_phase:v}))}),[i,v]),k=(0,n.useCallback)((()=>{(0,p.trackQnaIntroModalContinue)(i),u?M("importContent"):F(i)}),[i,u]),T=(0,n.useCallback)((()=>{(0,p.trackQnaIntroModalSkipImportClick)(i),F(i)}),[i]),Z=(0,n.useCallback)((()=>{(0,p.trackQnaIntroModalImportClick)(i),S.Z.setState({...S.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}),y.Z.setState({flowId:(0,d.ZP)()}),w(!0)}),[i]),D=(0,a.VK)((()=>!S.Z.state.open),[]),B=(0,a.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:s}=f.default.state;if(!e||!e.isReady())return!1;const n=e.getSettings();return!!n&&(!!(t&&s&&s.canRead())&&(!i.device.isMobile&&(!j&&(!(void 0!==n.ai_qna_intro_onboarding_phase||!x.Z.showAiQnaOnboardingModalForBetaLaunch())||void 0))))}),[j,i]);return function(){const e=(0,n.useRef)(!1),t=(0,o.O7)();(0,a.VK)((()=>{const{currentUserSettingsStore:s}=f.default.state;if(!s||!s.isReady())return;if(!x.Z.showRemindersToUseQnA())return;const n=s.getSettingsStore().getKeyStore("last_exposed_to_ai_qna_at").getValue();(0,c.$K)(n)||e.current||(e.current=!0,(0,m.Up)(t,{userSettingsStore:s}))}),[t])}(),(0,n.useEffect)((()=>{s(!!B)}),[B]),(0,n.useEffect)((()=>{j&&D&&(w(!1),F(i))}),[j,D,i]),(0,I.jsx)(g.gv.Provider,{value:C,children:(0,I.jsx)(b.default,{shouldShow:t,calloutId:"ai_qna_alpha",desktopRenderInner:()=>{switch(v){case"welcome":return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(A,{setShouldShowImportModal:h}),(0,I.jsx)(R,{onContinue:k})]});case"importContent":return(0,I.jsx)(_,{onImport:Z,onSkip:T});default:(0,c.t1)(v)}},desktopInnerStyle:{background:l.sidebarBackground,borderRadius:12,width:450},desktopOnDismiss:C,phoneRenderInner:()=>null})})}))},31809:(e,t,s)=>{s.r(t),s.d(t,{Footer:()=>q,LearnMoreLink:()=>Q,NotionAI:()=>ee,default:()=>ae,useNamedStyles:()=>oe});var n=s(67294),i=s(36769),o=s(13991),a=s(480),r=s(86628),l=s(24405),d=s(41892),c=s(3338),u=s(1436),m=s(11751),p=s(97880),g=s(82990),h=s(9291),f=s(25888),x=s(54642),y=s(64964),S=s(97627),v=s(28344),b=(s(95477),s(1853)),M=s(76110),j=s(15010),w=s(99622),C=s(12205),k=s(3791),T=s(88280);function I(){return(0,r.VK)((()=>{var e;const t=(null===(e=T.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,k.de)(t)}),[])}var P=s(80444),Z=s(21273),F=s(80671),_=s(44041),A=s(35057),R=s(66309),D=s(89024),B=s(90403),L=s(97122),O=s(42922),E=s(84076),N=s(89728),V=s(64369),U=s(6175),W=s(85893);const K=24;function z(e){const{stage:t,setStage:s}=e;switch(t){case"intro":return(0,W.jsx)(G,{onAddedToWaitlist:()=>s("thank-u-next")});case"thank-u-next":return(0,W.jsx)(ne,{});default:(0,p.t1)(t)}}function q(e){window.__c={n:"Footer"};const{children:t}=e,s=oe(),{isPhone:n}=(0,a.Fy)();return n?(0,W.jsx)(D.jX,{align:"center-right",gap:12,padding:K,style:s.footer,children:t}):(0,W.jsx)(D.jX,{align:"center",direction:"row",gap:"auto",padding:K,style:s.footer,children:t})}function G(e){window.__c={n:"IntroStage"};const{onAddedToWaitlist:t}=e,s=oe(),i=(0,a.O7)(),o=(0,n.useContext)(b.gv),r=function(e){const t=(0,a.O7)(),s=(0,w.Y)(T.subscriptionDataStoreInstance),i=(0,C.J)();return(0,n.useCallback)((()=>{const{currentSpaceStore:n,currentSpaceViewStore:o}=P.default.state;n&&o&&(x.addUserToWaitlist(t,{program:"ai",spaceId:n.id}),(0,v.trackQnaWaitlistModalRequestAccess)(t,{isSalesAssisted:s,isSpaceAdmin:i}),e())}),[t,e,s,i])}(t);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(b.U4,{}),(0,W.jsxs)(D.jX,{gap:32,children:[(0,W.jsx)(H,{}),(0,W.jsx)("div",{style:s.introCopyArea,children:(0,W.jsxs)(D.jX,{gap:8,children:[(0,W.jsx)(ee,{}),(0,W.jsxs)("div",{style:s.introTitle,children:[(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Introducing Q&A",id:"AiQnaWaitlistModal.intro.title"}),(0,W.jsx)(B.Z,{style:s.betaBadge,content:(0,W.jsx)(h.FormattedMessage,{id:"AiQnaWaitlistModal.intro.betaLabel",defaultMessage:"Beta"})})]}),(0,W.jsx)(V.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.mainCopyText,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiQnaWaitlistModal.intro.caption"})})]})}),(0,W.jsxs)(q,{children:[(0,W.jsx)(Q,{}),(0,W.jsxs)(D.jX,{align:"center-right",direction:"row",gap:12,width:"hug",children:[(0,W.jsx)(N.Z,{isSmall:!0,style:s.skipButton,onClick:()=>{(0,v.trackQnaWaitlistModalSkip)(i),null==o||o()},children:(0,W.jsx)(V.Z,{isSmall:!0,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Skip",id:"AiQnaWaitlistModal.intro.skip.nextMessage"})})}),(0,W.jsx)(L.h,{onClick:r,styles:{padding:"6px 16px",height:void 0},children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Request access to Q&A",id:"AiQnaWaitlistModal.intro.signup.nextMessage"})})]})]})]})]})}function H(){window.__c={n:"IntroVideo"};const e=oe();return(0,W.jsx)(U.Z,{src:(0,M.bv)(),defaultTextTrack:U.W[o.SP]||"en",options:{muted:!0,autoplay:!0,loop:!0},style:e.stubPng})}function Q(e){let{shouldShowHelpCenterLink:t}=e;window.__c={n:"LearnMoreLink"};const s=oe(),n=(0,a.O7)();return(0,W.jsx)("div",{style:s.learnMoreCopy,children:(0,W.jsxs)(E.Z,{onClick:()=>{f.Fs(n,{from:"qna_intro_modal"})},style:s.learnMoreLink,innerStyle:s.learnMoreLinkInner,href:t?"https://www.notion.so/help/qna":"https://www.notion.so/ai",external:!0,children:[(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Learn more about Q&A",id:"AiQnaWaitlistModal.intro.learnMoreUrl"}),(0,u.g)(s.connectedAppsIcon)]})})}function Y(){window.__c={n:"RequestAccessCta"};const e=oe(),t=function(){const e=(0,a.O7)(),t=(0,n.useContext)(b.gv),s=(0,r.VK)((()=>P.default.state.currentSpaceStore),[]);return(0,n.useCallback)((()=>{if(!s)return;(async()=>{await(0,F.jw)({environment:e,spaceStore:s,from:"ai_qna_waitlist"}),null==t||t(),y.oV({label:(0,W.jsx)(h.FormattedMessage,{id:"AiQnaWaitlistModal.requestAccess.snackbar",defaultMessage:"Thank you! We received your request"})})})()}),[e,t,s])}();return(0,W.jsx)(O.Z,{style:e.upsellButton,onClick:t,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Send upgrade request",id:"AiQnaWaitlistModal.requestUpgrade.nextMessage"})})}function $(){window.__c={n:"UpsellCta"};const e=oe(),t=function(){const e=(0,a.O7)();return(0,n.useCallback)((()=>{_.y(e,{from:"ai_qna_waitlist",for:(0,A.zt)(),addOnFeature:"ai"})}),[e])}();return(0,W.jsx)(O.Z,{style:e.upsellButton,onClick:t,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Get Notion AI",id:"AiQnaWaitlistModal.thankunext.nextMessage"})})}function J(){window.__c={n:"NextStepsCta"};const e=(0,C.J)(),t=(0,w.Y)(T.subscriptionDataStoreInstance);return I()||t&&e?null:t&&!e?(0,W.jsx)(Y,{}):!t&&e?(0,W.jsx)($,{}):t||e?null:(0,W.jsx)(Y,{})}function X(){window.__c={n:"NextSteps"};const e=(0,C.J)(),t=(0,w.Y)(T.subscriptionDataStoreInstance);return I()||t&&e?null:t&&!e?(0,W.jsx)(se,{}):!t&&e?(0,W.jsx)(ie,{}):t||e?null:(0,W.jsx)(se,{})}function ee(){window.__c={n:"NotionAI"};const e=oe();return(0,W.jsxs)(D.jX,{direction:"row",children:[(0,m.t)(e.sparklesIcon),(0,W.jsx)(V.Z,{isSmall:!0,style:e.notionAiText,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Notion AI",id:"AiQnaWaitlistModal.intro.brandingHero"})})]})}function te(){window.__c={n:"QnaBuds"};const e=oe(),t="dark"===(0,l.Fg)().mode?d.Z.images.onboarding.aiQnaBudsDarkPng:d.Z.images.onboarding.aiQnaBudsPng;return(0,W.jsx)("img",{style:e.qnaBuds,src:t})}function se(){window.__c={n:"RequestAccess"};const e=oe();return(0,W.jsxs)("div",{style:e.nextSteps,children:[(0,W.jsx)(V.Z,{isMultiline:!0,style:e.upsellHeader,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Request an upgrade",id:"AiQnaWaitlistModal.thankunext.requestUpgrade"})}),(0,W.jsx)(V.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,style:e.upsellCopy,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Send a request to your workspace owner to upgrade for unlimited usage of Notion AI.",id:"AiQnaWaitlistModal.thankunext.captionRequest"})}),(0,W.jsx)(te,{})]})}function ne(){window.__c={n:"ThankYouStage"};const e=oe(),t=(0,n.useContext)(b.gv),s=(0,r.VK)((()=>{var e;return null===(e=P.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(b.U4,{}),(0,W.jsxs)(D.jX,{gap:32,children:[(0,W.jsxs)(D.jX,{gap:32,padding:"0 24px",children:[(0,W.jsx)("div",{children:(0,W.jsxs)(D.jX,{gap:6,children:[(0,W.jsx)("div",{style:e.thanksHeaderArea,children:(0,W.jsxs)(D.jX,{gap:6,children:[(0,c.p)(e.circleCheckIcon),(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Thanks, you're on the list!",id:"AiQnaWaitlistModal.thankunext.title"})]})}),(0,W.jsx)(V.Z,{isSecondaryColor:!0,isMultiline:!0,style:e.thanksCopy,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Your workspace owners will get an email when {spaceName} receives access to Q&A.",id:"AiQnaWaitlistModal.thankunext.caption",values:{spaceName:s}})})]})}),(0,W.jsx)(X,{})]}),(0,W.jsxs)(q,{children:[(0,W.jsx)(Q,{}),(0,W.jsx)(N.Z,{isSmall:!0,style:e.thanksDoneButton,onClick:t,children:(0,W.jsx)(V.Z,{isSmall:!0,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Got it",id:"AiQnaWaitlistModal.thankunext.gotIt"})})}),(0,W.jsx)(J,{})]})]})]})}function ie(){window.__c={n:"Upsell"};const e=oe();return(0,W.jsxs)("div",{style:e.nextSteps,children:[(0,W.jsx)(V.Z,{isMultiline:!0,style:e.upsellHeader,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Upgrade to go unlimited",id:"AiQnaWaitlistModal.thankunext.headerUpsell"})}),(0,W.jsx)(V.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,style:e.upsellCopy,children:(0,W.jsx)(h.FormattedMessage,{defaultMessage:"Give everyone in your workspace unlimited use of Notion AI's writing assistant and database autofill. Plus, we'll bump you to the top of the list for Q&A!",id:"AiQnaWaitlistModal.thankunext.captionUpsell"})}),(0,W.jsx)(te,{})]})}function oe(){return(0,l.yK)((e=>({betaBadge:{borderRadius:4,display:"inline-block",fontSize:11,fontWeight:500,padding:"1px 4px"},circleCheckIcon:{color:e.grayButtonBackground,paddingBottom:4,width:32},connectedAppsIcon:{height:14,marginLeft:4,width:14},desktopInner:{background:e.sidebarBackground,borderRadius:12,width:450},footer:{borderTop:`1px solid ${e.tableLightDividerColor}`},introCopyArea:{paddingLeft:K,paddingRight:K},introTitle:{fontWeight:g.Z.fontWeight.bold,fontSize:25,display:"flex"},learnMoreCopy:{color:e.mediumTextColor,fontSize:12},learnMoreLink:{width:"max-content",marginLeft:-4},learnMoreLinkInner:{display:"flex",alignItems:"center",paddingLeft:4,paddingRight:4},mainCopyText:{width:350},nextSteps:{borderRadius:8,background:"dark"===e.mode?e.accentColors.gray[300]:e.accentColors.gray[50],padding:16,position:"relative"},notionAiText:{marginTop:2,paddingLeft:4,color:e.accentColors.gray[900],fontWeight:g.Z.fontWeight.medium},qnaBuds:{position:"absolute",height:50,bottom:0,right:0},sparklesIcon:{width:14},skipButton:{height:32},stubPng:{width:"100%",height:254},thanksCopy:{width:375},thanksDoneButton:{height:32},thanksHeaderArea:{fontWeight:g.Z.fontWeight.bold,fontSize:25,marginTop:40},upsellButton:{height:32,minWidth:72,width:"fit-content"},upsellCopy:{width:270},upsellHeader:{fontWeight:600,fontSize:16,paddingBottom:6,paddingTop:4}})),[])}(0,i.exposeDebugEnvironmentValue)("resetQnAWaitlist",(e=>()=>{const{currentSpaceViewStore:t}=P.default.state;t&&S.aW(e,{spaceViewStore:t,shown:void 0,transactionUserAction:"debugging.resetAIOnboarding"})}));const ae=function(){window.__c={n:"AiQnaWaitlistModal"};const[e,t]=(0,n.useState)(!1),[s,i]=(0,n.useState)("intro"),o=oe(),l=function(){const e=(0,a.O7)();return(0,r.VK)((()=>{const{currentSpaceViewStore:t,currentSpaceStore:s,mainEditorCurrentBlockStore:n,currentUserSettingsStore:i}=P.default.state;if(!t||!t.isReady())return!1;if(!i||!i.isReady())return!1;const o=t.getSettings();return!!o&&(!!(s&&n&&n.canRead())&&(!(Number((0,j.e2)(i))<=2)&&(!e.device.isMobile&&(!(void 0!==o.ai_qna_waitlist_shown||!Z.Z.canSeeWaitlistModal())&&((0,v.trackQnaWaitlistModalOpen)(e),!0)))))}),[e])}(),d=function(e,t){const s=(0,a.O7)();return(0,n.useCallback)((()=>{const{currentSpaceViewStore:n}=P.default.state;n&&(e(!1),t("intro"),S.aW(s,{spaceViewStore:n,shown:!0,transactionUserAction:"AiQnaWaitlistModal.cancel"}),(0,v.trackQnaWaitlistModalClose)(s))}),[s,e,t])}(t,i);return(0,n.useEffect)((()=>{t(!!l)}),[l]),(0,W.jsx)(b.gv.Provider,{value:d,children:(0,W.jsx)(R.default,{shouldShow:e,calloutId:"ai_qna_beta_waitlist",desktopRenderInner:()=>(0,W.jsx)(z,{stage:s,setStage:i}),desktopInnerStyle:o.desktopInner,desktopOnDismiss:d,phoneRenderInner:()=>(0,W.jsx)(z,{stage:s,setStage:i})})})}},87493:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});s(67294);var n=s(480),i=s(41363),o=s(87279),a=s(48019),r=s(78140),l=s(85893);const d=function(e){let{block:t,onAccept:s}=e;window.__c={n:"AliasBlockPopupMenu"};const d={blocks:[t],environment:(0,n.O7)(),publicEditMode:void 0};return(0,l.jsx)(r.Z,{menuType:o.og.Popup,children:(0,l.jsx)(a.Z,{sections:i.Qi,context:d,onAccept:s})})}},66309:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(27328),r=s(24677),l=s(98104),d=s(95477),c=s(18514),u=s(34859),m=s(80444),p=s(77080),g=s(69454),h=s(92083),f=s(36488),x=s(28451),y=s(50506),S=s(53437),v=s(53336),b=s(32662),M=s(85893);function j(e){window.__c={n:"AnnouncementModal"};const t=(0,n.O7)(),s=(0,o.Fg)(),j=(0,n.Fy)(),w=(0,i.VK)((()=>(0,c.__)(t)),[t]),C=(0,i.VK)((()=>t.TabbedRouterStore),[t.TabbedRouterStore]),k=(0,i.VK)((()=>(0,a.w_)(C.state)),[C]),T=(0,i.VK)((()=>{var e;return"web"===k.type&&((null===(e=k.redirectedTo)||void 0===e?void 0:e.route)||k.route)}),[k]),I=(0,i.VK)((()=>{const t=!m.default.state.isTransitioning&&m.default.state.initialized,s=p.default.state.isLoaded;if(!t||!s)return!1;if(h.Z.state.open)return!1;const n=d.default.isAdminMode;return j.isPhone&&w?e.shouldShow&&!n&&T&&"page"===T.name:e.shouldShow&&!d.default.isAdminMode}),[j.isPhone,w,e.shouldShow,T]),P=(0,i.VK)((()=>t.WindowSizeStore.isLandscape()),[t.WindowSizeStore]),Z=(0,i.VK)((()=>{const e=g.Z.state.phase===g.i.hidden||g.Z.state.phase===g.i.willHide;let s=g.Z.estimatedNativeWebBottomOverlap();return j.isMobileBrowser&&(s+=32),e?t.WindowSizeStore.getSafePaddingBottomPx(s):s}),[j.isMobileBrowser,t.WindowSizeStore]);if(j.isPhone){function n(){var s;null===(s=e.onModalShow)||void 0===s||s.call(e),r.ZH(t),l.sD()}return(0,M.jsx)(x.g,{calloutId:e.calloutId,shouldShow:I,onShow:n,children:(0,M.jsx)(S.ZP,{open:I,forceFullScreenSlideUp:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:S.ZP.PopupType.SlideUp,style:{background:s.sidebarBackground,borderRadius:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},render:()=>(0,M.jsxs)(v.Z,{type:u.Z.Y,style:{background:s.sidebarBackground,width:P?"80%":"100%",height:P?void 0:"100%",display:"flex",flexDirection:"column",alignItems:"center",...e.phoneInnerStyle},children:[(0,M.jsx)(b.Z,{size:P?200:0}),e.phoneRenderInner(),(0,M.jsx)(b.Z,{size:Z})]})})})}return(0,M.jsx)(x.g,{calloutId:e.calloutId,shouldShow:I,onShow:e.onModalShow,children:(0,M.jsx)(y.Z,{open:I,preventHideChildrenWhileOpening:!0,onDismiss:e.desktopOnDismiss,innerStyle:{background:s.sidebarBackground,borderRadius:12,...e.desktopInnerStyle},render:()=>(0,M.jsx)(f.Z,{capture:!0,allowEsc:!0,render:e.desktopRenderInner})})})}},40044:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Oc});var n=s(67294),i=s(480),o=s(86628),a=s(47839),r=s(52989),l=s(9291),d=s(36488),c=s(78140),u=s(53437),m=s(43250),p=s(87279),g=s(77907),h=s(95306),f=s(34047),x=s(9080),y=s(85893);const S=function(){window.__c={n:"ReplyDiscussionMenu"};const e=(0,i.O7)(),{device:t}=e,{open:s,rect:n}=(0,o.VK)((()=>x.Z.state),[]);return(0,y.jsx)(u.ZP,{popupType:t.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:s,originRect:n,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Center,originGap:4,onDismiss:()=>h.UZ(e),render:()=>(0,y.jsx)(v,{})})};function v(){window.__c={n:"DiscussionComponent"};const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>x.Z.state),[]);if(s.open){const{discussionStore:n,discussionInputStore:i,blockStore:o,discussionLocation:a}=s;let r;return r=t.isMobile?{menuType:p.og.Modal,title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Comments",id:"discussion.mobileReplyMenu.title"}),right:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>h.UZ(e),whiteBackground:!0}:{menuType:p.og.Popup,width:420,maxWidth:t.isMobileBrowser?"80vw":"100%"},(0,y.jsx)(c.Z,{className:m.LoZ,...r,children:(0,y.jsx)(d.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,y.jsx)(g.LazyDiscussion,{store:n,discussionInputStore:i,onDismiss:()=>h.UZ(e),format:f.O2.Menu,isFirst:!0,isOnly:!0,discussionLocation:a,showResolveButtonByDefaultIfPossible:!0,blockStore:o})})})}return null}var b=s(83355),M=s(72126),j=s(70203),w=s(50906),C=s(4727),k=s(82530),T=s(68056),I=s(31352),P=s(24666),Z=s(72187),F=s(69783),_=(s(57658),s(8848)),A=s(90902),R=s(15095),D=s(54153),B=s(97880),L=s(73657),O=s(32163),E=s(43145),N=s(72495),V=s(70177),U=s(33929),W=s(29798),K=s(60682),z=s(24990),q=s(49085);const G="recentEmojis";class H extends q.default{getInitialState(){return{recentEmojis:[],loadEmojiCount:0}}cleanupSkinTonedRecents(e){const t=M.jj(R.p4(D.Z.get(G)).map((t=>void 0===e?t:R.Gb(t))));return D.Z.set(G,t.join("")),this.setState({...this.state,recentEmojis:t}),t}}const Q=new H;var Y=s(64921),$=s(31945),J=s(1743),X=s(3386),ee=s(26388),te=s(98742),se=s(61766),ne=s(11059),ie=s(37181),oe=s(68894),ae=s(80444);function re(){window.__c={n:"EmojiPickerSkinTonePicker"};const e=(0,o.VK)((()=>{var e;return null===(e=ae.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}),[]),t=(0,i.O7)(),s=(0,o.qz)(void 0,se.Z);return(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Select skin tone",id:"emojiPickerSkinTonePicker.selectSkinTone"}),placement:ee.ug.Bottom,render:n=>(0,y.jsx)($.ZP,{buttonPopupStore:s,popupType:$.Z4.Popup,renderOrigin:t=>(0,y.jsx)(oe.DO,{icon:()=>(0,y.jsx)("div",{style:{paddingRight:6},children:void 0!==e?A.YN[e]:"✋"}),style:{fontSize:20},...(0,te.Z)(t,n)}),render:s=>function(e){const{parent:t,environment:s,currentSkinTone:n}=e,i=A.YN.map(((e,n)=>({key:e,action:()=>{t.close(),le({environment:s,skinTone:n})},render:t=>(0,y.jsx)(ce,{...t,insertEmoji:()=>{},emoji:e,variations:void 0,tooltip:void 0})})));return(0,y.jsx)(J.Z,{capture:!0,allowEsc:!0,children:(0,y.jsx)(O.Z,{type:O.i.Horizontal,initialFocus:n,sections:[{key:"variations",render:e=>(0,y.jsx)("div",{style:{display:"flex",padding:4},...e}),items:i}]})})}({parent:s,environment:t,currentSkinTone:e}),...n})})}function le(e){const{environment:t,skinTone:s}=e,{currentUserSettingsStore:n}=ae.default.state;n&&(void 0!==s&&Q.cleanupSkinTonedRecents(s),k.createAndCommit({userAction:"mediaPicker.setEmojiSkinTone",environment:t,perform:e=>{ie.d2({userSettingsStore:n,transaction:e,data:{emoji_picker_skin_tone:s}})}}))}class de extends b.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:se.Z},this.renderEmojiWithVariations=()=>{const{emoji:e,focused:t}=this.props,{buttonPopupStore:s}=this.stores;return(0,y.jsx)(X.Z,{capture:t,onEnter:this.handleOpenMenu,onEsc:this.handleCloseMenu,children:(0,y.jsx)($.ZP,{buttonPopupStore:s,popupType:$.Z4.Popup,renderOrigin:e=>this.renderSingleEmoji(e),render:this.renderVariationMenu})},e)},this.renderSingleEmoji=e=>{const{emoji:t,focused:s,onClick:n,onMouseEnter:i,tooltip:o}=this.props,{fontSize:a}=ue(this.environment);return(0,y.jsx)(ee.ZP,{allowHover:Boolean(o),renderTooltip:()=>o,closeDelay:0,disableTooltip:!o,render:o=>(0,y.jsx)(Y.Z,{focused:s,onClick:n,...(0,te.Z)(e||{},(0,te.Z)({onMouseEnter:i},o)),ignoreLocalHoverState:!0,style:me(this.environment).emojiButton,children:(0,y.jsx)(ne.Z,{size:a,char:t})},t)})},this.renderVariationMenu=e=>{const{emoji:t,variations:s,insertEmoji:n}=this.props,i=(s&&s.length>0?[t,...s]:[t]).map(((t,i)=>({key:t,action:o=>{e.close(),(null==s?void 0:s.length)===A.tN&&le({environment:this.environment,skinTone:i}),n(t,i)},render:e=>(0,y.jsx)(de,{...this.props,...e,emoji:t,variations:void 0})})));return(0,y.jsx)(J.Z,{capture:!0,allowEsc:!0,children:(0,y.jsx)(O.Z,{type:O.i.Horizontal,initialFocus:0,sections:[{key:"variations",render:this.renderVariationWrapper,items:i}]})})},this.renderVariationWrapper=e=>(0,y.jsx)("div",{style:me(this.environment).variationMenu,...e}),this.handleOpenMenu=e=>{e.preventDefault();const{buttonPopupStore:t}=this.stores;t.setState({...t.state,open:!0})},this.handleCloseMenu=()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})}}renderComponent(){const{variations:e}=this.props;return void 0===(0,K.sg)()&&e&&e.length>0?this.renderEmojiWithVariations():this.renderSingleEmoji()}}de.displayName="EmojiPickerMenuItem";const ce=de;function ue(e){const{device:t}=e;return t.isMobile?{width:Z.mz,height:Z.mz,fontSize:Z.jo}:{width:Z.T8,height:Z.T8,fontSize:Z.WB}}function me(e){return{emojiButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...ue(e)},variationMenu:{display:"flex",padding:4}}}const pe={display:"flex",flexDirection:"column"},ge=["💡","👉","☝","👌","🔑","🚧","⚠️","🔥","📌","✂️","❓","🚫","⛔","⏰","☎️","🚨","♻️","✅","🔒","📎","📖","🗣","➡️","📢","🛠","⚙"],he=(0,l.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});var fe=!1;class xe extends b.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.storeTypes={menuListStore:W.Z},this.createCategory=e=>{let t=[];if(t="recent"===e.id?Q.state.recentEmojis||[]:"callout"===e.id?ge:z.Z.state.emojiByCategory[e.id]||[],this.filter&&(t=ve(t,this.filter,this.splitFilter)),0!==t.length)return{key:e.id,items:t.map((e=>je(e))).map((e=>Ce(e,this.props.onSubmit,this.props.menuRef,this.environment,this.props.iconLoggingData))),render:t=>(0,y.jsx)(N.Z,{isTitleUppercase:!0,title:e.title,children:(0,y.jsx)("div",{style:ke(this.environment,this.theme),children:t.children})},t.key)}},this.handleScroll=e=>{if(e<100){const{loadEmojiCount:e}=Q.state,t=Math.max(be(this.environment,this.props.menuRef)*Me(this.environment),this.getAllSectionsEmojiCount());Q.setState({...Q.state,loadEmojiCount:Math.min(t,e+be(this.environment,this.props.menuRef)*Me(this.environment))})}}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),Q.setState({...Q.state,loadEmojiCount:be(this.environment,this.props.menuRef)*Me(this.environment)}),Q.cleanupSkinTonedRecents((0,K.sg)()),async function(){await(0,V.L)(),await async function(){if(!fe){await z.Z.waitUntilLoaded();for(const t in z.Z.state.positionalEmojiData){var e;const s=null===(e=R.yz(t,z.Z.state))||void 0===e?void 0:e.keywords;s&&(A.Q4[t]={...A.Q4[t],uniqueKeywords:M.jj(s.flatMap((e=>e.split(" "))))})}fe=!0}}()}()}didUpdate(e){const{menuListStore:t}=this.stores;e.filter!==this.props.filter&&t.setState({...t.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}renderComponent(){const{menuListStore:e}=this.stores,t=function(e){const{loadEmojiCount:t}=Q.state,s=[];let n=0;for(const i of e){if(!(n+i.items.length<=t)){s.push({...i,items:i.items.slice(0,t-n)});break}s.push(i),n+=i.items.length}return s}(this.getAllSections()),s=this.environment.device.isDesktop&&t.length>0?0:void 0;return 0===t.length&&(this.props.onNoResults&&this.props.onNoResults(),t.push({key:"no results",items:[{key:"no results",action:()=>{},render:(e,t)=>(0,y.jsx)(L.Z,{...e,caption:U.default.formatMessage(he.noResults)})}],render:e=>(0,y.jsx)(N.Z,{...e})})),(0,y.jsxs)("div",{style:pe,children:[(0,y.jsx)("div",{style:{flexGrow:1},children:(0,y.jsx)(O.Z,{...(n=this.environment,i=this.props.menuRef,{type:O.i.Grid,itemsPerRow:be(n,i),renderRow:(e,t)=>(0,y.jsx)("div",{style:{display:"flex"},children:e},t)}),store:e,initialFocus:s,sections:t,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,y.jsx)(E.Z,{onChange:this.handleScroll})]});var n,i}getAllSections(){this.filter=R.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const e=M.oA(Se(this.props.filter,this.props.isCallout).map(this.createCategory));return this.props.filter&&this.filter?function(e){let t=0;for(const s of e)t+=s.items.length;return t}(e)>be(this.environment,this.props.menuRef)*Me(this.environment)/2?e:this.createFilteredSection():e}getAllSectionsEmojiCount(){const e=this.getAllSections();let t=0;for(const s of e)t+=s.items.length;return t}createFilteredSection(){const e=ve(M.xH(Se(this.props.filter,this.props.isCallout).map((e=>(0,B.qg)(z.Z.state.emojiByCategory,e.id)?z.Z.state.emojiByCategory[e.id]??[]:[]))),this.filter,this.splitFilter);return 0===e.length?[]:[{key:"search-results",items:e.map((e=>je(e))).map((e=>Ce(e,this.props.onSubmit,this.props.menuRef,this.environment,this.props.iconLoggingData))),render:e=>(0,y.jsx)(N.Z,{children:(0,y.jsx)("div",{style:ke(this.environment,this.theme),children:e.children})},e.key)}]}}xe.displayName="EmojiPicker";const ye=xe;function Se(e,t){return M.oA([!e&&{id:"recent",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.recent",defaultMessage:"Recent"})},t?{id:"callout",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.callout",defaultMessage:"Callout"})}:void 0,{id:"People & Body",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.people",defaultMessage:"People"})},{id:"Animals & Nature",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.animals",defaultMessage:"Animals and nature"})},{id:"Food & Drink",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.food",defaultMessage:"Food and drink"})},{id:"Activities",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.activity",defaultMessage:"Activity"})},{id:"Travel & Places",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.travel",defaultMessage:"Travel and places"})},{id:"Objects",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.objects",defaultMessage:"Objects"})},{id:"Symbols",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.symbols",defaultMessage:"Symbols"})},{id:"Flags",title:(0,y.jsx)(l.FormattedMessage,{id:"emojiPicker.section.flags",defaultMessage:"Flags"})}])}function ve(e,t,s){const n=M.oA(e.map((e=>{const n=R.yz(e,z.Z.state),i=n&&n.keywords||[],o=t.length<3||t.includes(" ")?i:i.map((e=>e.replaceAll(" ",""))),a=o.findIndex((e=>e===`:${t}`));if(-1!==a)return[100-a,e];const r=o.findIndex((e=>e===t));if(-1!==r)return[10*(10-r),e];const l=o.findIndex((e=>e.startsWith(t)));if(-1!==l)return[10-l,e];if(s.length>1){const t=n&&n.uniqueKeywords||[];if(s.every((e=>t.find((t=>t.startsWith(e))))))return[s.length,e]}return o.some((e=>e.includes(t)))?[1,e]:void 0})));return M.MR(n,(e=>-e[0])).map((e=>e[1]))}function be(e,t){var s,n;const{device:i,WindowSizeStore:o}=e;return i.isPhone?(window.innerWidth-o.getSafePaddingLeftPx(Z.$P)-o.getSafePaddingRightPx(Z.qJ))/Z.mz:i.isTablet?Z.tg:null!=t&&null!==(s=t.current)&&void 0!==s&&s.offsetWidth?((null==t||null===(n=t.current)||void 0===n?void 0:n.offsetWidth)-2*Z.PS)/Z.T8:Z.IQ}function Me(e){return e.device.isMobile?Z.pq:Z.II}function je(e){var t;const s=(0,K.sg)(),n=void 0!==s&&0!==s,i=null===(t=R.yz(e,z.Z.state))||void 0===t?void 0:t.variations;return(null==i?void 0:i.length)===A.tN&&n?i[s-1]:e}function we(e,t,s,n,i){t(e),function(e,t,s){const n=D.Z.get(G),i=M.jj(M.G0([(o=e,void 0===(0,K.sg)()?o:R.Gb(o))],R.p4(n)));var o;const a=M.qn(i,Z.Nm*be(s,t));D.Z.set(G,a.join("")),Q.setState({...Q.state,recentEmojis:a})}(e,s,n),i&&w.fAb(n,"pick_emoji",{icon:e,...i})}function Ce(e,t,s,n,i){const o=R.Hk(e,z.Z.state),a=void 0===(0,K.sg)()?R.yS(e,z.Z.state):[];return{key:e,action:()=>{0===a.length&&we(e,t,s,n,i)},render:r=>(0,y.jsx)(ce,{...r,emoji:e,tooltip:o,variations:a,insertEmoji:e=>we(e,t,s,n,i)})}}function ke(e,t){const{device:s,WindowSizeStore:n}=e;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...s.isPhone?{background:t.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:n.getSafePaddingLeftCSS(Z.$P),paddingRight:n.getSafePaddingRightCSS(Z.qJ),boxShadow:`0 1px 0 ${t.regularDividerColor}`,marginBottom:1}:{background:_.ZP.transparent,paddingLeft:s.isTablet?Z.vP:Z.PS,paddingRight:s.isTablet?Z.vP:Z.PS}}}class Te extends b.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=F.Z.state,s=n.createRef();if(!t.open)return;let i;return i=e.isMobileNative&&!e.isTablet?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:Z.fG,maxHeight:Z.VJ,onClickOutside:C.xv},(0,y.jsx)(c.Z,{innerRef:s,...i,children:(0,y.jsx)(ye,{filter:Pe(t)||"",onSubmit:e=>function(e,t){k.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:t,perform:s=>{C.RL({environment:t,emoji:e,transaction:s})}})}(e,this.environment),onNoResults:this.handleNoResults,isCallout:!1,menuRef:s})})},this.handleNoResults=()=>{const e=F.Z.state;if(!e.open)return;const t=Pe(e);if(!t)return;const s=M.Z$(t);s&&(/\s/g.test(s)?C.xv():this.trackNoResultsDebounced(t))},this.trackNoResultsDebounced=M.Ds((e=>{w.VJs(this.environment,{searchQuery:e})}),500)}UNSAFE_willMountOrUpdate(){const e=F.Z.state;if(e.open){var t;const s=P.default.state,n=Pe(e);if("editing"!==s.mode)return void C.xv();const i=j.eeV(s.multiSelection.start.store.getValue())[s.multiSelection.start.index-1];if(!n&&":"!==i)return void C.xv();((null===(t=(0,T.QY)(s.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===n||":"===n||n.startsWith("\n")||n.startsWith(" "))&&C.xv()}}renderComponent(){const{device:e}=this.environment,t=F.Z.state;let s=!1;if(t.open){const e=Pe(t);e&&e.length>0&&(s=!0),t.showPopupWithEmptyFilter&&(s=!0)}return(0,y.jsx)(u.ZP,{popupType:e.isMobileNative&&!e.isTablet?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:s,originRect:t.open?t.selectionRect:void 0,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:Ze,render:this.renderMenu,keepFocus:!0})}}Te.displayName="EmojiMenu";const Ie=Te;function Pe(e){return I.zK(e.textStore,e.oldTextValue,!0)}function Ze(){C.xv()}var Fe=s(12534),_e=s(39500),Ae=s(95697),Re=s(35868);function De(){window.__c={n:"MessageStoreDebugPanelWrapper"};return(0,o.VK)((()=>Re.Z.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,y.jsx)(g.LazyMessageStoreDebugPanel,{}):null}var Be=s(75538),Le=s(59054),Oe=s(54642);const Ee=function(){window.__c={n:"PersonalHomeListener"};const e=(0,i.O7)(),t=(0,o.VK)((()=>{var e;return null===(e=ae.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,o.VK)((()=>(0,Ae.QI)("dev_or_beta")),[]),n=(0,o.VK)((()=>Be.default.state.isOnboarding),[]);return(0,Le.r5)((async()=>{t&&s&&!n&&await Oe.getUserHomePages(e,{spaceId:t})}),[t,e,s,n]),null};var Ne=s(94416),Ve=s(19671),Ue=s(13023),We=s(69784),Ke=s(44615),ze=s(2688),qe=s(28517),Ge=s(69911);function He(){window.__c={n:"UserJoinedTeamsListener"};const e=(0,i.O7)(),{currentSpaceStore:t}=(0,o.Kw)(ae.default),s=e.currentUser.id,a=(0,o.VK)((()=>null==t?void 0:t.id),[t]);return(0,n.useEffect)((()=>{if(!a||!s)return;const t=ze.Z.addListener((0,Ke.pD)({userId:s,spaceId:a}),(async(t,n)=>{(function(e){var t;let{spaceId:s,userId:n,emitValue:i}=e;const o=null===(t=Ge.Z.getUserJoinedTeamsState({userId:n,spaceId:s}))||void 0===t?void 0:t.lastEmitValue;if(o===i)return!1;if(void 0===o&&Ge.Z.getHasFetched({userId:n,spaceId:s}))return!1;return!0})({spaceId:a,userId:s,emitValue:n})&&await qe.m({environment:e,spaceId:a,userId:s,emitValue:n});const i=Ge.Z.getUserJoinedTeamsState({userId:s,spaceId:a});i&&Ge.Z.setUserJoinedTeamsState({userId:s,spaceId:a,state:{...i,lastEmitValue:n}})}),void 0,e);return function(){t&&ze.Z.removeListener(t,e)}}),[e,s,a]),null}var Qe=s(41464),Ye=s(54564),$e=s(92650),Je=s(24646),Xe=s(24229),et=s(24405),tt=s(41432),st=s(24039),nt=s(65598),it=s(34859),ot=s(40971),at=s(40721),rt=s(34541),lt=s(66957);const dt=[Xe.u.Open,Xe.u.Resolved];class ct extends b.Z{constructor(){super(...arguments),this.deepDiscussionsStores=this.createComputedStore((()=>{const{discussionIds:e}=this.props,{blockStore:t,recursivelyLoadAllDiscussions:s}=this.props;return nt.al(t,{recursivelyLoadAllDiscussions:s}).filter((t=>!e||e.includes(t.id)||(0,f.De)(t)))}))}renderComponent(){if((0,Je.Sx)(this.environment))return null;const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:p.og.Modal,title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:this.renderMenuHeader(),right:(0,y.jsx)(at.DoneMenuText,{}),onClickRight:Ye.LZ,whiteBackground:!0}:{menuType:p.og.Popup,header:this.renderMenuHeader(),width:480,maxHeight:"50vh",onClickOutside:Ye.LZ},(0,y.jsx)(st.Z,{capture:!0,preventType:it.Z.All,children:(0,y.jsx)(d.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,y.jsx)(X.Z,{capture:!0,onEsc:Ye.LZ,onBackspace:gt,onDelete:gt,children:(0,y.jsx)(rt.Z,{store:this.props.blockStore,droppable:!0,render:()=>(0,y.jsx)(c.Z,{...t,children:this.renderMenuContent()})},this.props.blockStore.id)})})})}renderMenuHeader(){const{device:e}=this.environment,{resolved:t,unresolved:s}=nt.bB(this.deepDiscussionsStores.state),n=s.length,i=t.length;return 0===i||0===n?null:(0,y.jsx)(lt.Z,{tabs:[(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:n}},"openDiscussions"),(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:i}},"resolvedDiscussions")],selectedIndex:dt.indexOf(this.props.tab),onChange:pt,style:{...e.isAndroid&&{borderBottom:"none"}}})}renderMenuContent(){const{device:e}=this.environment,{resolved:t,unresolved:s}=nt.bB(this.deepDiscussionsStores.state);if(this.props.tab===Xe.u.Open){if(s.length){const t=s.map(((e,t,s)=>(0,y.jsx)(g.LazyDiscussion,{store:e,format:f.O2.Menu,isFirst:0===t,isOnly:1===s.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:Ye.LZ},e.id))),i=this.props.blockStore.getType(),o=i&&tt.p2[i];if(e.isMobile&&o){const e=ot.h(this.props.blockStore);return e?(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1},children:(0,y.jsx)(e,{store:this.props.blockStore,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),t]}):t}return t}return(0,y.jsx)(mt,{message:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"})})}return t.length?t.map(((e,t,s)=>(0,y.jsx)(g.LazyDiscussion,{store:e,format:f.O2.Menu,isFirst:0===t,isOnly:1===s.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:Ye.LZ},e.id))):(0,y.jsx)(mt,{message:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"})})}}ct.displayName="BlockDiscussionMenu";const ut=ct;function mt(e){let{message:t}=e;window.__c={n:"EmptyStateComponent"};const s=(0,et.Fg)(),n=(0,i.O7)(),{device:o}=n;return(0,y.jsx)("div",{style:{textAlign:"center",padding:o.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:s.mediumTextColor},children:t})}function pt(e){const t=Xe.Z.state;t.open&&Xe.Z.setState({...t,tab:dt[e]})}function gt(e){null==e||e.preventDefault(),Ye.LZ()}const ht=function(){window.__c={n:"BlockDiscussionMenuPopup"};const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>Xe.Z.state.rect),[]),a=(0,o.VK)((()=>!(0,Je.Sx)(e)&&Xe.Z.state.open&&!(0,$e.az)(e,Xe.Z.state.blockStore)),[e]),r=(0,n.useCallback)((()=>{if(Xe.Z.state.open&&!(0,Je.Sx)(e))return(0,y.jsx)(ut,{rect:Xe.Z.state.rect,tab:Xe.Z.state.tab,blockStore:Xe.Z.state.blockStore,discussionIds:Xe.Z.state.discussionIds,recursivelyLoadAllDiscussions:Xe.Z.state.recursivelyLoadAllDiscussions})}),[e]);return(0,y.jsx)(u.ZP,{popupType:t.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:a,originRect:s,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:r,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:Ye.LZ})};var ft=s(62965),xt=s(79554),yt=s(61207),St=s(27724),vt=s(52275);const bt=(0,l.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});class Mt extends b.Z{UNSAFE_willMountOrUpdate(){const e=yt.Z.state;if(e.open){const{stores:t,phase:s}=St.default.state;(0,ft.Z)(t,e.blocks)&&s===St.SelectionPhase.Selected||xt.xv()}}renderComponent(){const{device:e}=this.environment,t=yt.Z.state;return(0,y.jsx)(u.ZP,{popupType:e.isMobileNative&&!e.isTablet?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,y.jsx)(Ct,{}),onDismiss:wt})}}Mt.displayName="BlockPasteMenu";const jt=Mt;function wt(){xt.xv()}function Ct(){window.__c={n:"MenuComponent"};const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>{const t=yt.Z.state;return t.open?function(e,t){const{blocks:s}=e,{currentSpaceStore:n}=ae.default.state,i=[];if("blocks"===e.type){const{copiedStores:o,pageSource:a}=e;xt.H8({currentSpaceId:null==n?void 0:n.id,blocks:s,copiedStores:o})&&i.push({name:U.default.formatMessage(bt.createTransclusion),action:async()=>{await xt.ry({environment:t,blocks:s,copiedBlockIds:o.map((e=>e.id))})}}),xt.wK({blocks:s})&&i.push({name:U.default.formatMessage(bt.linkToPage),action:async()=>xt.Dq({environment:t,blocks:s,source:{type:"blocks",copiedStores:o,pageSource:a}})})}return"links"===e.type&&i.push({name:U.default.formatMessage(bt.linkToPage),action:async()=>xt.Dq({environment:t,blocks:s,source:{type:"links",copiedLinks:e.copiedLinks}})}),[{key:"embed section",render:e=>(0,y.jsx)(N.Z,{...e}),items:[{key:"dismiss",render:e=>(0,y.jsx)(vt.Z,{...e,title:U.default.formatMessage(bt.dismissItem)}),action:wt},...i.map((e=>{let{name:t,action:s}=e;return{key:`embed ${t}`,render:e=>(0,y.jsx)(vt.Z,{...e,title:t}),action:s}}))]}]}(t,e):null}),[e]);if(null===s)return null;let n;return n=t.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:320,maxHeight:"40vh"},(0,y.jsx)(c.Z,{...n,className:m.srZ,children:(0,y.jsx)(O.Z,{type:O.i.Vertical,sections:s,initialFocus:0})})}var kt=s(87143),Tt=s(74194),It=s(64369);const Pt=function(){window.__c={n:"ClipboardInputRenderer"};const e=(0,i.O7)(),{device:t}=e,{active:s,stringValue:n}=(0,o.VK)((()=>kt.Z.state),[]),a=window.innerWidth/2-150,r=window.innerHeight/2,d=t.isMobileNative?(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,y.jsx)(u.ZP,{popupType:t.isMobileNative?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:s,originRect:{top:r,left:a},onDismiss:Zt,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Start,originGap:0,render:()=>(0,y.jsx)(X.Z,{capture:!0,onEnter:M.yR,onCommandEnter:M.yR,onCommandShiftEnter:M.yR,onCommandSlash:M.yR,onDelete:M.yR,onBackspace:M.yR,onEsc:M.yR,onLeft:M.yR,onRight:M.yR,onUntab:M.yR,onTab:M.yR,onSelectAll:M.yR,onRedo:M.yR,onUndo:M.yR,onToggleBold:M.yR,onToggleItalics:M.yR,onToggleStrike:M.yR,onToggleCode:M.yR,onCut:M.yR,onCopy:M.yR,onPaste:M.yR,onKeypress:M.yR,children:(0,y.jsxs)("div",{style:{padding:8,width:300},children:[(0,y.jsx)(Tt.Z,{style:{width:"100%",fontSize:12},value:n,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,y.jsx)(It.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:d})]})})})};function Zt(e){kt.Z.setState({...kt.Z.state,active:!1,stringValue:""})}var Ft=s(11977),_t=s(14131),At=s(7337),Rt=s(40506),Dt=s(82798),Bt=s(67133),Lt=s(993),Ot=s(28020),Et=s(28748);const Nt=function(){window.__c={n:"DateMentionMenu"};const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>Et.Z.state),[]);return(0,y.jsx)(u.ZP,{popupType:t.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:s.open,originRect:s.originRect,onDismiss:Bt.x,render:()=>(0,y.jsx)(Vt,{shouldShowReminder:!!s.open&&s.allowReminders})})};function Vt(e){let{shouldShowReminder:t}=e;window.__c={n:"DateMentionMenuContents"};const s=(0,i.O7)(),n=(0,o.VK)((()=>Ut()),[]);if(!n)return null;const{date_format:a,time_format:r,dateValue:l}=n;return(0,y.jsx)(g.DependencyConsumer,{dependency:g.deps.menus,children:e=>{let{DatePropertyMenu:n}=e;return(0,y.jsx)(n,{firstDayOfWeek:Ot.AK.state,value:l,canConfigureCollection:!0,onChangeValue:e=>function(e,t){if(!e)return void function(e){const t=Ut();if(!t)return;const{textStore:s,textValue:n,tokenIndex:i}=t,o=j.VrM(n.slice(0,i)),a=j.VrM(n.slice(0,i+1));k.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:e,perform:t=>{Lt.pe({environment:e,store:s,selection:{startIndex:o,endIndex:a},transaction:t})}})}(t);if(!Rt.U3(e))return;const s=Ut();if(!s)return;const{date_format:n,time_format:i}=s;Wt({date_format:n,time_format:i,...e},t)}(e,s),dateFormat:a,onChangeDateFormat:e=>function(e,t){const s=Ut();if(!s)return;const{dateValue:n,time_format:i}=s;Wt({date_format:e,time_format:i,...n},t)}(e,s),timeFormat:r,onChangeTimeFormat:e=>function(e,t){const s=Ut();if(!s)return;const{dateValue:n,date_format:i}=s;Wt({date_format:i,time_format:e,...n},t)}(e,s),onDismiss:Bt.x,disabled:!1,shouldShowReminder:t,isTemplatePage:!1})}})}function Ut(){const e=Et.Z.state;if(e.open){const{textStore:t,tokenIndex:s}=e,n=t.getValue();if(n){const e=n[s];if(e){(0,Dt.T)(j.km_(e),"Token should be a mention token");const i=j.hDy(e),o=j.K9C(i);if(o){const{date_format:a,time_format:r,...l}=j.zyO(o);return{textStore:t,textValue:n,tokenIndex:s,token:e,annotations:i,date_format:a,time_format:r,dateValue:l}}}}}}function Wt(e,t){const s=Ut();if(!s)return;const{textStore:n,textValue:i,tokenIndex:o,token:a,annotations:r}=s,l=r.map((t=>j.fpG(t)?["d",e]:t)),d=j.V3y(a[0],l),c=j.VrM(i.slice(0,o)),u=j.VrM(i.slice(0,o+1));k.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:t,perform:e=>{Lt.pe({environment:t,store:n,selection:{startIndex:c,endIndex:u},transaction:e}),Lt.mM({environment:t,store:n,tokens:[d],index:c,transaction:e})}})}s(30541);var Kt=s(95538),zt=s(99405),qt=s(21202),Gt=s(63143),Ht=s(89951),Qt=s(95477),Yt=s(64233),$t=s(26136);const Jt=(0,l.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),Xt=(0,l.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),es={image:U.default.formatMessage(Jt.image),video:U.default.formatMessage(Jt.video),tweet:U.default.formatMessage(Jt.tweet),drive:U.default.formatMessage(Jt.drive),gist:U.default.formatMessage(Jt.gist),figma:U.default.formatMessage(Jt.figma),invision:U.default.formatMessage(Jt.invision),abstract:U.default.formatMessage(Jt.abstract),framer:U.default.formatMessage(Jt.framer),whimsical:U.default.formatMessage(Jt.whimsical),mixpanel:U.default.formatMessage(Jt.mixpanel),miro:U.default.formatMessage(Jt.miro),sketch:U.default.formatMessage(Jt.sketch),excalidraw:U.default.formatMessage(Jt.excalidraw),replit:U.default.formatMessage(Jt.replit),audio:U.default.formatMessage(Jt.audio),maps:U.default.formatMessage(Jt.maps),loom:U.default.formatMessage(Jt.loom),typeform:U.default.formatMessage(Jt.typeform),codepen:U.default.formatMessage(Jt.codepen),pdf:U.default.formatMessage(Jt.pdf),embed:U.default.formatMessage(Jt.embed),hex:U.default.formatMessage(Jt.hex),deepnote:U.default.formatMessage(Jt.deepnote),drawing:U.default.formatMessage(Jt.drawing)};class ts extends b.Z{UNSAFE_willMountOrUpdate(){const e=Yt.Z.state;if(e.open){const t=P.default.state;if("editing"===t.mode){const{multiSelection:s}=t;(0,T.qS)(s)&&s.start.store.id===e.textStore.id&&s.end.index===e.urlSelection.endIndex||Ht.xv()}}}renderComponent(){const{device:e}=this.environment,t=Yt.Z.state;return(0,y.jsx)(u.ZP,{popupType:e.isMobileNative&&!e.isTablet?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:()=>(0,y.jsx)(as,{}),onDismiss:()=>is(this.environment)})}}ts.displayName="EmbedMenu";const ss=ts;function ns(e){const t=e.getRecordStoreAtRootPath();return t instanceof $t.G&&void 0!==t.getParentCollectionStore()}function is(e){const t=Yt.Z.state,{url:s}=t;w.X0y(e,{url:s,type:"close"}),Ht.xv()}function os(e,t){const{device:s}=t,{url:n,textStore:i}=e,{currentSpaceStore:o}=ae.default.state,a=[],r=(0,zt.Wj)({url:n,baseUrl:Qt.default.domainBaseUrl,publicDomainName:Qt.default.publicDomainName,isMobile:s.isMobile,protocol:Qt.default.protocol,currentUrl:window.location.href});if("page"===r.name){const e=$t.G.createChildStore(i,{table:qt.iU,id:r.blockId}),t=r.scrollToBlockId?$t.G.createChildStore(i,{table:qt.iU,id:r.scrollToBlockId}):void 0;a.push({name:U.default.formatMessage(Xt.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!ns(i)&&(!e.isCollectionViewPageWithContent()||!function(e,t){const s=e.getCollectionViewStores(),n=M.sE(s,(e=>e.id===t&&"page"===e.getType()));return Boolean(n)}(e,r.collectionViewId))&&(null==o?void 0:o.id)===e.getSpaceId()&&!(0,Ot.qG)(e.id),type:tt.Ti.collectionView}),a.push({name:U.default.formatMessage(void 0===t?Xt.mentionPage:Xt.mentionBlock),validator:()=>!0,type:"mention-page"}),a.push({name:U.default.formatMessage(Xt.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!ns(i)&&!t.isLocked()&&!t.isNavigableAncestorLocked()&&t.canEdit()&&t.getSpaceId()===(null==o?void 0:o.id)),type:"create-transclusion"}),a.push({name:U.default.formatMessage(Xt.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!ns(i),type:tt.Ti.page})}const l=Gt.XP(es);for(const u of l)"embed"!==u&&a.push({name:es[u],validator:Kt.Wb[u],type:u});a.push({name:U.default.formatMessage(Xt.bookmarkMenuItem),validator:e=>!ns(i)&&Kt.Cm(e),type:tt.Ti.bookmark}),a.push({name:es.embed,validator:e=>!ns(i)&&Kt.Wb.embed(e),type:"embed"});const d=M.oA(a.map((e=>{let{name:s,validator:i,type:o}=e;if(i({url:n,baseUrl:Qt.default.domainBaseUrl,publicDomainName:Qt.default.publicDomainName})){return{key:`embed ${s}`,render:e=>(0,y.jsx)(vt.Z,{...e,title:s}),action:()=>function(e,t){const s=Yt.Z.state,{url:n}=s;Ht.RL({environment:t,type:e}),w.X0y(t,{url:n,type:e})}(o,t)}}}))),c={key:"dismiss",render:e=>(0,y.jsx)(vt.Z,{...e,title:U.default.formatMessage(Xt.dismissItem)}),action:()=>is(t)};if(0===d.length)return[];"page"===r.name?d.push(c):d.unshift(c);return[{key:"embed section",render:e=>(0,y.jsx)(N.Z,{...e}),items:d}]}function as(){window.__c={n:"MenuComponent"};const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>{const t=Yt.Z.state;return t.open?os(t,e):null}),[e]);if(null===s)return null;let n;return 0===s.length&&Ht.xv(),n=t.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:320,maxHeight:"40vh"},(0,y.jsx)(c.Z,{...n,className:m.srZ,children:(0,y.jsx)(O.Z,{type:O.i.Vertical,sections:s,initialFocus:0})})}var rs=s(43593),ls=s(37652),ds=s(33907),cs=s(59822),us=s(64330),ms=s(80342),ps=s(47453),gs=s(51454),hs=s(54604),fs=s(42858),xs=s(24677),ys=s(17504),Ss=s(58202),vs=s(38302),bs=s(23063),Ms=s(68785),js=s(4827),ws=s(89728);const Cs={background:"rgba(255, 255, 255, 0.055)"},ks={padding:"6px 10px 6px 6px"},Ts={padding:"6px 6px 6px 10px"},Is={display:"flex",borderRadius:4,background:_.ZP.blackWithAlpha(.65)},Ps=.25,Zs=.5,Fs=.5,_s=-.002,As=-.004;class Rs extends b.Z{constructor(){var e;super(...arguments),e=this,this.isListeningToWheel=!1,this.hideControlsTimeout=void 0,this.isMovingToPrevOrNextTimeout=void 0,this.isEditingZoom=q.default.createValue(!1),this.contentDimensions=q.default.createValue(void 0),this.showControls=q.default.createValue(!1),this.responsiveSettings=this.createComputedStore((()=>{const e=this.environment.WindowSizeStore.state.width;return{edgePadding:hs.zp(e),backgroundOpacity:.8}})),this.renderOverlay=()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:s,contentAspectRatio:n,zoomScale:i,panOffset:o,skipAnimations:a}=vs.Z.state;if(!s)return;e&&!this.isListeningToWheel?(window.addEventListener("wheel",this.handleWheel,{passive:!1}),this.isListeningToWheel=!0):!e&&this.isListeningToWheel&&(window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1);const{edgePadding:r,backgroundOpacity:l}=this.responsiveSettings.state,d=window.innerWidth,c=window.innerHeight-2*r;let u=d-2*r;const m=n||s.height/s.width;let p=u*m;if(p>c){const e=p/c;p/=e,u/=e}const g={opacity:0},h={scale:i,opacity:1,translateX:o.x,translateY:o.y,width:"100%",height:"100%"};let f,x;return t&&(f=t()),x=this.showControls.state?i>=1.5?"zoom-out":"zoom-in":"none",(0,ys.Z)((t=>(0,y.jsx)(X.Z,{capture:e,onEsc:()=>{this.handleClose(!0)},onEnter:M.yR,onSpace:()=>this.handleClose(!0),onCommandEnter:()=>this.handleClose(!0),onCommandShiftEnter:M.yR,onCommandSlash:M.yR,onUp:M.yR,onDown:M.yR,onDelete:M.yR,onBackspace:M.yR,onLeft:()=>this.handlePrevious(!0),onRight:()=>this.handleNext(!0),onUntab:M.yR,onTab:M.yR,onSelectAll:M.yR,onRedo:M.yR,onUndo:M.yR,onToggleBold:M.yR,onToggleItalics:M.yR,onToggleStrike:M.yR,onToggleCode:M.yR,onCut:M.yR,onCopy:M.yR,onPaste:M.yR,onKeypress:this.handleKeypress,children:(0,y.jsx)(st.Z,{capture:e,preventType:it.Z.All,children:(0,y.jsxs)("div",{style:this.getStyle({isOpen:e}),...t,onClick:this.handleBackgroundClick,onMouseMove:this.resetHideControlsTimeout,children:[(0,y.jsx)(bs.Z,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:l},render:()=>(0,y.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:_.ZP.black}}),onAnimationEnd:Gs}),(0,y.jsx)(bs.Z,{isVisible:e,enterAnimationStyle:g,exitAnimationStyle:g,animationStyle:h,skipAnimation:a,forceTransformStyle:!0,springConfig:{scale:{stiffness:100,damping:10,precision:.001},translateX:{stiffness:100,damping:10,precision:.001},translateY:{stiffness:100,damping:10,precision:.001}},render:()=>(0,y.jsx)("div",{style:{display:"flex",cursor:x,maxWidth:u,maxHeight:p,justifyContent:"center"},ref:e=>{e&&this.contentDimensions.setState({width:e.clientWidth,height:e.clientHeight})},onClick:this.handleContentClick,onMouseDown:Qs,onMouseUp:Ys,onMouseLeave:Ys,onMouseMove:this.handleMouseMove,children:f}),onAnimationEnd:Hs}),this.renderBottomBar()]})})})))},this.clearHideControlsTimeout=()=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout)},this.resetHideControlsTimeout=()=>{const{isSaving:e}=vs.Z.state;this.showControls.setState(!0),this.clearHideControlsTimeout(),this.isEditingZoom.state||e||(this.hideControlsTimeout=setTimeout((()=>this.showControls.setState(!1)),2e3))},this.enableZoomEditing=()=>{this.isEditingZoom.setState(!0),this.clearHideControlsTimeout()},this.disableZoomEditing=()=>{this.isEditingZoom.setState(!1),this.resetHideControlsTimeout()},this.handleBackgroundClick=e=>{(0,_e.uG)(e)||this.handleClose()},this.handleContentClick=e=>{const{zoomScale:t,panOffset:s}=vs.Z.state;if(e.stopPropagation(),(0,_e.uG)(e))return;let n,i;n=t<1?1:t<1.5?1.5:1,i=n<=1?{x:0,y:0}:this.clampPanOffset({x:(window.innerWidth/2-e.clientX)/(n/(n-1)),y:(window.innerHeight/2-e.clientY)/(n/(n-1))})??s,vs.Z.setState({...vs.Z.state,zoomScale:n,panOffset:i}),this.resetHideControlsTimeout(),this.disableZoomEditing()},this.handleClose=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];hs.xv(),e.resetControls(),w.Lfx(e.environment,{type:"close",triggered_by:t?"keypress":"click"}),xs.ZH(e.environment),Ys()},this.handleResize=()=>{const{isOpen:e}=vs.Z.state;e&&this.enqueueForceUpdate()},this.handlePrevious=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(-1,t)},this.handleNext=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(1,t)},this.handleZoomInputSubmit=e=>{const t=e.target,s=parseInt(t.value);if(!isNaN(s)){const e=s/100;w.Lfx(this.environment,{type:"set_zoom",new_zoom:e}),this.setZoomScale(e)}this.disableZoomEditing()},this.handleZoomOut=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=vs.Z.state;let n=Math.ceil(2*(s-Zs))/2;s-n<Ps&&(n-=Zs),w.Lfx(e.environment,{type:"zoom_out",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.handleZoomIn=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=vs.Z.state;let n=Math.floor(2*(s+Zs))/2;n-s<Ps&&(n+=Zs),w.Lfx(e.environment,{type:"zoom_in",new_zoom:n,triggered_by:t?"keypress":"click"}),e.setZoomScale(n)},this.addDeltaToZoomScale=e=>{const{zoomScale:t}=vs.Z.state;this.setZoomScale(t+e)},this.setZoomScale=e=>{const{panOffset:t}=vs.Z.state;this.resetHideControlsTimeout();const s=Math.max(Math.min(e,2),Fs),n=s<=1?{x:0,y:0}:t;vs.Z.setState({...vs.Z.state,zoomScale:s,panOffset:n})},this.handleWheel=e=>{const{isOpen:t,panOffset:s}=vs.Z.state;t&&(e.preventDefault(),e.ctrlKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*As):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*As):e.metaKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*_s):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*_s):Os()&&this.setPanOffset({x:s.x-e.deltaX,y:s.y-e.deltaY}))},this.handleMouseMove=e=>{const{panStartPosition:t,zoomScale:s}=vs.Z.state;this.contentDimensions.state&&1===e.buttons&&Os()&&this.setPanOffset({x:e.clientX/s-t.x,y:e.clientY/s-t.y})},this.handleDownload=e=>{const{block:t,imageUrl:s}=vs.Z.state;if(!t||!Es())return;vs.Z.setState({...vs.Z.state,isSaving:!0}),this.clearHideControlsTimeout();const n=null==t?void 0:t.getProperties();let i;if(i=s||j.QaF(null==n?void 0:n.source),!i)return;const o=j.QaF(null==n?void 0:n.caption);(0,rs.GN)(i,null==t?void 0:t.pointer,Qt.default.domainBaseUrl,this.environment.currentUser.id,o).then((()=>{vs.Z.setState({...vs.Z.state,isSaving:!1}),w.Lfx(this.environment,{type:"download",triggered_by:"click"}),this.resetHideControlsTimeout()}))},this.handleKeypress=e=>{switch(e.key){case"+":case"=":this.handleZoomIn(!0);break;case"-":case"_":this.handleZoomOut(!0)}}}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize)}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:s}=vs.Z.state;return(0,y.jsx)(js.Z,{open:e||!t||!s,children:this.renderOverlay()})}renderBottomBar(){const{isOpen:e}=vs.Z.state;if(!this.environment.device.isMobile)return(0,y.jsx)(bs.Z,{isVisible:this.showControls.state,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>(0,y.jsxs)("div",{style:Ns(e),onClick:e=>{!function(e){e.stopPropagation()}(e),this.resetHideControlsTimeout(),this.disableZoomEditing()},children:[(0,y.jsx)("div",{style:{...Is,marginRight:10},children:this.renderPrevNextButtons()}),(0,y.jsxs)("div",{style:Is,children:[this.renderZoomControls(),(0,y.jsx)(qs,{}),Es()?(0,y.jsxs)(y.Fragment,{children:[this.renderDownloadButton(),(0,y.jsx)(qs,{})]}):void 0,this.renderCloseButton()]})]})})}renderZoomControls(){const{zoomScale:e}=vs.Z.state,t=(100*e).toFixed(0);return(0,y.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(zs,{primaryText:(0,y.jsx)(l.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:e<=Fs,render:t=>(0,y.jsx)(ws.Z,{...t,disabled:e<=Fs,style:{...Ws(e<=Fs),...Ts},onClick:()=>this.handleZoomOut(),icon:e=>(0,ms.$)({...e,fill:Vs(),height:16,margin:0,width:16})})}),this.isEditingZoom.state?(0,y.jsx)(Ds,{initialValue:t,onSubmit:this.handleZoomInputSubmit,onCancel:this.disableZoomEditing,primaryColor:Vs(),secondaryColor:Us()}):(0,y.jsx)(ws.Z,{onClick:e=>{e.stopPropagation(),this.enableZoomEditing()},style:{color:Us(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${t}%`}),(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(zs,{primaryText:(0,y.jsx)(l.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:e>=2,render:t=>(0,y.jsx)(ws.Z,{...t,disabled:e>=2,style:Ws(e>=2),onClick:()=>this.handleZoomIn(),icon:e=>(0,ps.R)({...e,fill:Vs(),height:16,margin:0,width:16})})})]})}renderPrevNextButtons(){const{block:e}=vs.Z.state,t=Ls(),s=(null==t?void 0:t.length)??0,n=(null==t?void 0:t.findIndex((t=>t===e)))??-1;return s<=1||n<0?(0,y.jsx)("div",{}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(zs,{primaryText:(0,y.jsx)(l.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:(0,y.jsx)(Ks,{imageIndex:n-1,totalImageCount:s})}),disableTooltip:0===n,render:e=>(0,y.jsx)(ws.Z,{...e,disabled:n<=0,style:{...Ws(n<=0),...Ts},hoveredStyle:Cs,onClick:()=>this.handlePrevious(),icon:e=>(0,ls.V)({...e,fill:Vs(),height:16,margin:0,width:16})})}),(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(zs,{primaryText:(0,y.jsx)(l.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:(0,y.jsx)(Ks,{imageIndex:n-1,totalImageCount:s})}),disableTooltip:n+1===s,render:e=>(0,y.jsx)(ws.Z,{...e,disabled:n>=s-1,style:{...Ws(n>=s-1),...ks},hoveredStyle:Cs,onClick:()=>this.handleNext(),icon:e=>(0,ds.n)({...e,fill:Vs(),height:16,margin:0,width:16})})})]})}renderDownloadButton(){const{isSaving:e}=vs.Z.state;return(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(zs,{primaryText:(0,y.jsx)(l.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:t=>(0,y.jsx)(ws.Z,{...t,disabled:e,onClick:this.handleDownload,style:Ws(!1),hoveredStyle:Cs,children:e?(0,y.jsx)(Ms.Z,{style:{width:16}}):(0,us.a)({fill:Vs(),width:16})})})}renderCloseButton(){return(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(zs,{primaryText:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,y.jsx)(ws.Z,{...e,onClick:()=>this.handleClose(),style:{...Ws(!1),...ks},hoveredStyle:Cs,icon:e=>(0,cs.J)({...e,fill:Vs(),height:16,margin:0,width:16})})})}resetControls(){this.isEditingZoom.setState(!1),vs.Z.setState({...vs.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}clampPanOffset(e){const t=this.contentDimensions.state;if(!t)return;let s,n;s=2*t.width>window.innerWidth?(2*t.width-window.innerWidth)/4:(window.innerWidth-2*t.width)/4,n=2*t.height>window.innerHeight?(2*t.height-window.innerHeight)/4:(window.innerHeight-2*t.height)/4;return{x:Math.min(Math.max(e.x,-1*s),s),y:Math.min(Math.max(e.y,-1*n),n)}}setPanOffset(e){const{panStartPosition:t}=vs.Z.state,s=this.clampPanOffset(e);s&&(e.x!==s.x&&(t.x=t.x+(e.x-s.x)),e.y!==s.y&&(t.y=t.y+(e.y-s.y)),vs.Z.setState({...vs.Z.state,panOffset:s,panStartPosition:t}))}moveToImageOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{block:s}=vs.Z.state,n=Ls();if(!n)return;const i=n.findIndex((e=>e===s));if(i+e<0||i+e>=n.length)return;w.Lfx(this.environment,{type:e>0?"next":"previous",image_count:n.length,image_index:i+e,triggered_by:t?"keypress":"click"}),vs.Z.setState({...vs.Z.state,skipAnimations:!0}),this.isMovingToPrevOrNextTimeout&&clearTimeout(this.isMovingToPrevOrNextTimeout),this.isMovingToPrevOrNextTimeout=setTimeout((()=>{vs.Z.setState({...vs.Z.state,skipAnimations:!1})}),250);const o=n[i+e];fs.dK({blocks:[o]}),this.resetControls()}getStyle(e){const{isOpen:t}=e;return{zIndex:gs.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:this.showControls.state?void 0:"none"}}}function Ds(e){window.__c={n:"ZoomInput"};const[t,s]=(0,n.useState)(e.initialValue);return(0,y.jsx)(Tt.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:4,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;s(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:Tt.B.Transparent,right:(0,y.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}Rs.displayName="FullScreenRenderer";const Bs=Rs;function Ls(){const e=St.default.getCurrentRootStore();return Ss.R.getMembersByDOMOrder({filter:t=>"image"===t.renderedType&&Boolean(t.getBlockStore().findRecordStoreUIAncestor((t=>Boolean(e&&t===e))).ancestor)}).map((e=>e.getBlockStore())).filter((e=>Boolean(e.getProperties().source)))}function Os(){const{zoomScale:e}=vs.Z.state;return e>1}function Es(){var e;const{block:t,imageUrl:s}=vs.Z.state;return t&&(s||(null===(e=t.getProperties())||void 0===e?void 0:e.source)&&j.QaF(t.getProperties().source))}function Ns(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}function Vs(){return _.ZP.white}function Us(){return _.ZP.whiteWithAlpha(.5)}function Ws(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}function Ks(e){let{imageIndex:t,totalImageCount:s}=e;return(0,y.jsx)(l.FormattedMessage,{values:{currentIndex:t+1,totalCount:s},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}function zs(e){const{primaryText:t,secondaryText:s}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{style:{marginRight:s?4:void 0},children:t}),s?(0,y.jsx)("span",{style:{color:Us()},children:s}):void 0]})}function qs(){return(0,y.jsx)("span",{style:{borderLeft:`1px solid ${_.ZP.whiteWithAlpha(.25)}`,height:"100%"}})}function Gs(){const{isOpen:e}=vs.Z.state;e||vs.Z.setState({...vs.Z.state,backgroundAnimationComplete:!0})}function Hs(){const{isOpen:e}=vs.Z.state;e||vs.Z.setState({...vs.Z.state,fullscreenNodeAnimationComplete:!0})}function Qs(e){const{panOffset:t,zoomScale:s}=vs.Z.state;vs.Z.setState({...vs.Z.state,panStartPosition:{x:e.clientX/s-t.x,y:e.clientY/s-t.y},skipAnimations:!0})}function Ys(){vs.Z.setState({...vs.Z.state,skipAnimations:!1})}var $s=s(98567),Js=s(70279),Xs=s(23867),en=s(19889),tn=s(36280),sn=s(73959),nn=s(89086),on=s(66949),an=s(3702);class rn extends b.Z{constructor(){super(...arguments),this.input=n.createRef(),this.handleLeft=e=>{if(!this.input.current)return;const t=this.input.current.getSelection();t&&"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===t.startIndex&&0===t.endIndex&&(un(this.environment),tn.Wj(on.P.Backward))},this.handleRight=e=>{if(!on.Z.isOpen())return;if(!this.input.current)return;const t=this.input.current.getSelection();if(!t)return;const s=on.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&t.startIndex===s&&t.endIndex===s&&(un(this.environment),tn.Wj())}}renderComponent(){if(!on.Z.isOpen())return;const e=!on.Z.isOpen(),t=function(){var e;if("editing"!==P.default.state.mode&&!on.Z.isOpen())return!0;const t=on.Z.isOpen()?null===(e=(0,T.QY)(on.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,sn.J2)(t);if(e&&e.isLocked())return!0}if(t&&t.table===Js.x_){const e=$t.T5.createChildStore(t,{table:Js.x_,id:t.id,spaceId:(0,Xs.C)(t.pointer.spaceId)}),s=e.isDefined(),{currentUserStore:n}=ae.default.state;if(!s||!n)return!0;const i=e.getCreatedByTable(),o=e.getCreatedById();if(i!==en.KJ||n.id!==o)return!0}const s={[j.GKr.User]:j.GKr.User,[j.GKr.Page]:j.GKr.Page,[j.GKr.Comment]:j.GKr.Comment,[j.GKr.Bot]:j.GKr.Bot,[j.GKr.Date]:j.GKr.Date,[j.GKr.ExternalObjectInstance]:j.GKr.ExternalObjectInstance,[j.GKr.TemporaryPage]:j.GKr.TemporaryPage,[j.GKr.TemplateVariable]:j.GKr.TemplateVariable,[j.GKr.FormulaPageProperty]:j.GKr.FormulaPageProperty,[j.GKr.FormulaContextValue]:j.GKr.FormulaContextValue,[j.GKr.Group]:j.GKr.Group,[j.GKr.Citation]:j.GKr.Citation};for(const n of Object.values(s))if((0,nn.J6)(n))return!0;return!1}(),s=function(){if(!on.Z.isOpen())return;return on.Z.state.savedTextSelectionRect}(),n=on.Z.state.value,i=on.Z.state.error;return(0,y.jsx)(g.DependencyConsumer,{dependency:g.deps.prismjs,children:o=>{if(!e)return(0,y.jsx)(an.Z,{Prism:o,ref:this.input,isOpen:!0,equationValue:n,error:i,displayMode:"inline",disabled:t,originRect:s,originGap:8,onDismiss:cn,onChange:dn,onSubmit:()=>un(this.environment),onLeft:this.handleLeft,onRight:this.handleRight})}})}}rn.displayName="InlineEquationOverlay";const ln=rn;function dn(e,t){on.Z.isOpen()&&on.Z.setState({...on.Z.state,value:e,error:t})}function cn(){tn.Wj()}function un(e){k.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:e,perform:t=>{tn.gt({environment:e,equationStore:on.Z,transaction:t})}})}var mn=s(73935),pn=s(96313),gn=s(12457),hn=s(73744),fn=s(70726),xn=s(48863);function yn(e){switch(e){case fn.Z.Preview:return(0,y.jsx)(l.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"});case fn.Z.Mention:return(0,y.jsx)(l.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"});case fn.Z.Link:return(0,y.jsx)(l.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"});default:(0,B.t1)(e)}}const Sn=function(){window.__c={n:"InternalUnfurlingMenu"};const e=(0,i.O7)(),t=(0,n.useRef)(null),[s]=(0,o.AF)(xn.Z),a=(0,n.useCallback)((t=>{if(s.open){var n;if(!t)pn.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(n=s.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!1});xn.Z.setState({open:!1})}}),[e,s]),r=(0,n.useCallback)((e=>{s.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&a(void 0)}),[a,s.open]),l=(0,n.useCallback)((e=>{const n=t.current;if(!s.open||!e.target||!n)return;const i=mn.findDOMNode(n);i&&(i.contains(e.target)||a(void 0))}),[a,s.open]);(0,n.useEffect)((()=>((0,hn.lj)(window,"keydown",r),(0,hn.lj)(window,"mousedown",l),()=>{(0,hn.ZV)(window,"keydown",r),(0,hn.ZV)(window,"mousedown",l)})),[r,l]);const d=(0,n.useRef)(!1);function g(t){var n;s.open&&void 0!==t.indexGlobal&&(xn.Z.setState({...s,focusedIndex:t.indexGlobal}),pn.pg({actionType:t.indexGlobal,environment:e,commentStore:null===(n=s.args.commentStore)||void 0===n?void 0:n.state,useTempStores:!0}))}(0,o.VK)((()=>{var t,n;const i=(s.open&&(null===(t=s.args.commentStore)||void 0===t?void 0:t.state)&&(null===(n=s.args.commentStore.state)||void 0===n?void 0:n.isReady()))??!1;var o;i&&!d.current&&s.open&&pn.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(o=s.args.commentStore)||void 0===o?void 0:o.state,useTempStores:!0});d.current=i}),[e,s]);const h=(0,o.VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),f=e.device.isMobile;return(0,y.jsx)(u.ZP,{popupType:h?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:s.open,originRect:s.open?s.selectionRect:void 0,placementToOrigin:u.ZP.Placement.Top,alignmentToOrigin:u.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:f,keepFocus:f,render:function(){var n;const{device:i}=e;if(!s.open)return;const o=function(t){const{url:s,args:n}=t,i=[];i.push({title:yn(fn.Z.Preview),validator:()=>!0,type:fn.Z.Preview}),i.push({title:yn(fn.Z.Mention),validator:()=>!0,type:fn.Z.Mention}),i.push({title:yn(fn.Z.Link),validator:()=>!0,type:fn.Z.Link});return[{key:"menu section",render:e=>(0,y.jsx)(N.Z,{...e}),items:M.oA(i.map((t=>{let{title:i,validator:o,type:a}=t;if(o({url:s,baseUrl:Qt.default.domainBaseUrl,publicDomainName:Qt.default.publicDomainName})){return{key:`item ${a}`,render:t=>(0,y.jsx)(vt.Z,{...t,title:i,onMouseEnter:s=>{var i;t.onMouseEnter(s),pn.pg({actionType:a,environment:e,commentStore:null===(i=n.commentStore)||void 0===i?void 0:i.state,useTempStores:!0})}}),action:()=>{var t;return pn.pg({actionType:a,environment:e,commentStore:null===(t=n.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(s);let a;return a=i.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:320,maxHeight:"40vh"},null!==(n=s.args.commentStore)&&void 0!==n&&n.state&&s.args.commentStore.state.isReady()?(0,y.jsx)(c.Z,{...a,className:m.srZ,ref:t,children:(0,y.jsx)(O.Z,{type:O.i.Vertical,sections:o,onKeyboardArrow:g,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,y.jsx)(gn.Z,{show:!0,showDelay:500,showHold:0,render:()=>(0,y.jsx)(c.Z,{...a,className:m.srZ,ref:t,children:(0,y.jsx)(N.Z,{style:{display:"flex",justifyContent:"center"},children:(0,y.jsx)(Ms.Z,{})})})})},onDismiss:()=>a(void 0)})};var vn=s(64572),bn=s(88295),Mn=s(45990),jn=s(48709),wn=s(40462),Cn=s(23210),kn=s(57549),Tn=s(54882),In=s(23178);function Pn(e){window.__c={n:"LinkMenuInput"};const{state:t,focusInitial:s,defaultValue:n,onBlur:o,onKeyDown:a,style:r}=e,d=(0,i.MO)(),c=(0,l.useIntl)(),u=c.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder"}),m=c.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder"}),p=!d||!t.showCreateIn,g=d?void 0:!t.showCreateIn&&t.focusLinkInput,h=t.editingToken?m:u;return p?(0,y.jsx)(oe.ZP,{onFocus:jn.FV,placeholder:h,value:n||t.url,onChange:Zn,onBlur:o,onKeyDown:a,focus:g,focusInitial:s,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0,style:r}):null}const Zn=e=>{const t=In.Z.state;t.open&&In.Z.setState({...t,url:e.target.value,focusLinkInput:!0})};function Fn(e){window.__c={n:"LinkMenuInputWithPreview"};const{state:t,showPreview:s,store:n}=e,o=(0,i.MO)(),a=(0,jn.Fs)(t),{editingToken:r,focusTitleInput:l}=t;return s&&n?(0,y.jsx)(Tn.B,{store:n,onClick:jn.FV}):(0,y.jsx)(Pn,{state:t,onBlur:jn.cX,onKeyDown:_n,defaultValue:s?a:void 0,style:r?void 0:{marginTop:6},focusInitial:!Boolean(r)||o&&!l})}const _n=e=>{"Escape"===e.key&&(e.stopPropagation(),(0,jn.hy)())};function An(e){window.__c={n:"LinkMenuTitleInput"};const{title:t,focus:s,defaultTitle:o}=e,a=(0,i.O7)(),r=(0,i.MO)(),[l,d]=(0,n.useState)(),c=(0,n.useRef)(!1),u=(0,n.useMemo)((()=>({environment:a,defaultTitle:o,setPlaceholder:d,hasTitleChanged:c})),[o,a]);return(0,n.useEffect)((()=>{const e=c.current;return()=>{e&&kn.pZ(a)}}),[c,a]),(0,y.jsx)(oe.ZP,{focus:s,focusInitial:r,onFocus:Bn,onBlur:()=>Ln(u),onChange:e=>Rn(e,u),onKeyDown:e=>On(e,u),value:l?"":t,placeholder:l,preventCaptureArrowShortcuts:!0,style:{paddingBottom:8}})}const Rn=(e,t)=>{Dn(e.target.value,t)},Dn=(e,t)=>{const s=In.Z.state;if(!s.open)return;const{editingToken:n,savedTextSelectionState:i}=s;if(!n)return;if(!e)return void In.Z.setState({...s,title:""});const{environment:o,setPlaceholder:a,hasTitleChanged:r}=t;k.createAndCommit({userAction:"LinkMenu.updateTitle",environment:o,perform:t=>{const l=Mn.iX({environment:o,title:e,transaction:t,editingToken:n,savedTextSelectionState:i});l&&In.Z.setState({...s,...l,title:e}),a(void 0),r.current=!0}})},Bn=()=>{(0,jn.ZG)(!0)},Ln=e=>{En(e),(0,jn.ZG)(!1)},On=(e,t)=>{"Enter"!==e.key&&"Escape"!==e.key||(e.stopPropagation(),Ln(t))},En=e=>{const t=In.Z.state;if(!t.open)return;const{defaultTitle:s,setPlaceholder:n}=e;t.title||(Dn(s,e),n(s))};var Nn=s(88632),Vn=s(18466),Un=s(11470),Wn=s(15447);var Kn=s(37612);function zn(e){const{state:t}=e,s=(0,n.useMemo)((()=>(0,jn.uP)(t)),[t]),a=(0,n.useMemo)((()=>(0,jn.dY)(s)),[s]),r=function(e){const{state:t,inputUrl:s,query:a,handleLinkSelection:r}=e,{url:d}=t,c=(0,i.O7)(),u=(0,i.MO)(),m=(0,o.VK)((()=>Nn.Z.state.online),[]),p=!!d;return(0,n.useMemo)((()=>{let e,n=!1;if(!s&&p)e=(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl"}),n=!0;else{if(!s)return;if("notion"===s.type&&m)return;"web"===s.type?e=(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===s.type?e=(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===s.type?e=(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,B.t1)(s.type)}return{key:"link to url",action:()=>r(c,t,a,u),render:t=>(0,y.jsx)(vt.Z,{...t,title:d,caption:e,icon:(0,wn.o)({width:16,paddingTop:4}),disabled:n})}}),[t,a,c,u,m,s,r,p,d])}({state:t,inputUrl:a,query:s,handleLinkSelection:qn}),d=function(e){const{state:t,inputUrl:s,query:a,additionalItem:r}=e,{editingToken:d}=t,c=function(e){const{state:t,inputUrl:s,query:a,handleLinkSelection:r,disableEmptyQueryResults:d}=e,{savedTextSelectionState:c}=t,u=(0,i.O7)(),m=(0,i.MO)(),[{online:p}]=(0,o.AF)(Nn.Z),h=(0,n.useMemo)((()=>{var e;const t=null===(e=(0,T.QY)(c.multiSelection))||void 0===e?void 0:e.store;if(t&&(0,nt.OY)(t))return t}),[c]),f=(0,g.useDependency)(g.deps.searchActions),[{value:x,status:S}]=(0,Le.r5)((async()=>{if(!p||"resolved"!==f.status)return[];if(!a)return d?[]:Wn.X4.state.map((e=>e.pageId));const e=f.value;return(await e.searchMentionablePages({nearBlock:h,environment:u,query:a,source:"mention_menu",limit:10})).map((e=>e.id))}),[a,h,u,p,d,f.status,f.value]),v=(0,n.useMemo)((()=>{if(s&&"notion"===s.type){const e=x?M.zu(x,s.notionPage.blockId):[];return[s,...e]}return x}),[x,s]);return(0,n.useMemo)((()=>{if(!v||0===v.length)return;if(s&&"web"===s.type&&s.url===a)return;const e=Vn.Z.withListenerIgnored(Ot.RM);if(!e)return;const n=t.url?5:3,i=(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block"}),o=(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:v.map(((s,n)=>{const o="object"==typeof s?s.notionPage.peekViewBlockId||s.notionPage.blockId:s,a=$t.G.createChildStore(e,{table:qt.iU,id:o});return{key:n,action:()=>{if("object"==typeof s){const e=(0,vn.nR)({pageId:s.notionPage.blockId,peekViewBlockId:s.notionPage.peekViewBlockId,peekMode:s.notionPage.peekMode,discussionId:s.notionPage.discussionId,collectionViewId:s.notionPage.collectionViewId,scrollToBlockId:s.notionPage.scrollToBlockId});r(u,t,e,m)}else r(u,t,(0,vn.nR)({pageId:o}),m)},render:e=>{const t="object"==typeof s&&s.notionPage.scrollToBlockId;return(0,y.jsx)(Un.Z,{...e,store:a,caption:t?i:void 0,placeholder:(0,y.jsx)(gn.Z,{showHold:300,showDelay:300,show:"resolved"===S,render:e=>e?(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}):(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})})}}})).slice(0,n),title:v.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?i:o}}),[v,t,u,m,a,s,S,r])}({state:t,inputUrl:s,query:a,handleLinkSelection:qn,disableEmptyQueryResults:!!d});return(0,n.useMemo)((()=>{if(c||r){return{key:"results",items:M.oA([...(null==c?void 0:c.items)||[],r]),render:e=>(0,y.jsx)(N.Z,{...e,title:d||a?void 0:(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.recents.title",defaultMessage:"Recents"})})}}}),[c,r,d,a])}({state:t,inputUrl:a,query:s,additionalItem:r}),c=(0,jn.Fs)(t),u=c&&(0,vn.A5)({url:c,baseUrl:Qt.default.domainBaseUrl,publicDomainName:Qt.default.publicDomainName}),m=(0,o.VK)((()=>{if(!u)return;const e=(0,Ot.RM)();return e?$t.G.createChildStore(e,{table:qt.iU,id:u}):void 0}),[u]),p=function(e){const{state:t,url:s,isEmptyResults:i,pageStore:o}=e;return(0,n.useMemo)((()=>{let e=(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.currentInfo.pageOrUrl"});const n=!t.focusLinkInput&&i;let a;return o?a={key:"link to page",action:()=>{},render:()=>(0,y.jsx)(Fn,{state:t,showPreview:n,store:o})}:s?a={key:"link to web",action:()=>{},render:()=>(0,y.jsx)(Fn,{state:t,showPreview:!0})}:(e=void 0,a={key:"create link",action:()=>{},render:()=>(0,y.jsx)(Fn,{state:t,showPreview:n})}),{key:"page or url",render:t=>(0,y.jsx)(N.Z,{title:e,...t}),items:[a]}}),[t,s,i,o])}({state:t,url:c,isEmptyResults:!Boolean(d),pageStore:m}),h=function(e){const{state:t,url:s,pageStore:i}=e,{editingToken:a,title:r,focusTitleInput:d}=t,c=(0,o.VK)((()=>i?j.QaF(i.getTitleValue()):void 0),[i]);return(0,n.useMemo)((()=>{if(a)return{key:"link title",render:e=>(0,y.jsx)(N.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link title",id:"selectionLinkButton.currentInfo.linkTitle"}),...e}),items:[{key:"update title",action:()=>{},render:()=>(0,y.jsx)(An,{title:r,defaultTitle:c??s,focus:d})}]}}),[a,r,d,s,c])}({state:t,url:c,pageStore:m}),f=function(e){const{state:t}=e,s=function(e){const{state:t}=e,s=(0,i.O7)();return(0,n.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>{Mn.PP(s);const e=(0,jn.Fs)(t);kn.oS(s,{type:"remove_link",url:e})},render:e=>(0,y.jsx)(vt.Z,{...e,title:(0,y.jsx)(l.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:(0,Kn.y)({width:16})})}}),[t,s])}({state:t});return(0,n.useMemo)((()=>{const e=M.oA([s]);if(0!==e.length)return{key:"link actions",render:e=>(0,y.jsx)(N.Z,{topBorder:!0,...e}),items:e}}),[s])}({state:t});let x,S;return d?(S=1,x=M.oA([p,d])):(S=void 0,x=M.oA([p,h,f])),{initialFocus:S,sections:x}}function qn(e,t,s,n){const i=(0,Cn.D)(s);if(!i)return;const{editingToken:o,savedTextSelectionState:a,title:r}=t;k.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:s=>{const l=Mn.gp({environment:e,transaction:s,url:i,title:r,editingToken:o,savedTextSelectionState:a});l?(kn.oS(e,{type:"edit_link",url:i}),In.Z.setState({...t,...l,url:"",focusLinkInput:!1,focusTitleInput:Boolean(n)})):(kn.oS(e,{type:"create_link",url:i}),In.Z.reset())}})}var Gn=s(16566),Hn=s(34583),Qn=s(56940);function Yn(){window.__c={n:"LinkMenu"};const e=(0,o.VK)((()=>In.Z.state),[]),t=(0,i.Fy)(),s=(0,o.VK)(Ae.bq,[]),a=(0,o.VK)((()=>{if(!e.open)return!1;if(e.focusLinkInput||e.focusTitleInput)return!1;const t=P.default.state;if("editing"!==t.mode)return!0;const s=(0,T.QY)(t.multiSelection);if(!s)return!0;const{store:n,selection:i}=s;return(0,nn.wd)(i)?!j.oP(n.getValue(),i.startIndex,i.endIndex,j.GKr.Link):!(0,T._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,n.useEffect)((()=>{a&&Mn.F5()}),[a]),(0,y.jsx)(u.ZP,{popupType:t.isMobile?t.isTablet?u.ZP.PopupType.Popup:u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,style:{width:si(s)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:Mn.F5,render:()=>e.open?(0,y.jsx)($n,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function $n(e){window.__c={n:"LinkMenuContent"};const{state:t}=e,s=(0,i.MO)(),[o,a]=(0,n.useState)(!0);if((0,n.useEffect)((()=>a(!1)),[]),t.showCreateIn&&!s)return(0,y.jsx)(Xn,{state:t});let r;return r=s?{menuType:p.og.Modal,title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:(0,y.jsx)(at.CancelMenuText,{}),onClickRight:Mn.F5,footer:(0,y.jsx)(u.ZP,{popupType:u.ZP.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>(0,y.jsx)(Xn,{state:t})})}:{menuType:p.og.Popup},(0,y.jsxs)(J.Z,{capture:t.open&&(o||t.focusLinkInput||t.focusTitleInput),allowEsc:!0,children:[(0,y.jsx)(c.Z,{...r,children:(0,y.jsx)(Qn.Z,{capture:s&&!t.focusLinkInput&&!t.focusTitleInput,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!0,render:()=>(0,y.jsx)(Jn,{state:t,useMenuList:zn})})}),(0,y.jsx)(X.Z,{capture:!0,onCommandSlash:jn.FV})]})}function Jn(e){window.__c={n:"LinkMenuList"};const{state:t,useMenuList:s}=e,{initialFocus:n,sections:i}=s({state:t});return(0,y.jsx)(O.Z,{type:O.i.Vertical,initialFocus:n,sections:i})}function Xn(e){var t;window.__c={n:"LinkCreateInMenu"};const{state:s}=e,a=(0,i.O7)(),r=(0,n.useCallback)((async e=>{var t;if(!Hn.M_(a))return;const n=null===(t=(0,T.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!n)return;const{performResult:{createInState:i}}=await k.createAndCommitAsync({environment:a,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const i=bn.f8({environment:a,transaction:t,titleText:s.url||"",createInValue:e,recordStoreParent:n}),[o]=i.createdPages;return o&&(Mn.gp({environment:a,url:(0,vn.nR)({pageId:o.id}),transaction:t,editingToken:s.editingToken,savedTextSelectionState:s.savedTextSelectionState}),In.Z.reset()),await i.moveToStorePromise,{createInState:i}}});await bn.c_({analyticsFrom:"link_menu",createInState:i})}),[s,a]),l=null===(t=(0,T.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,d=l&&"block"===l.table?l.id:void 0,c=(0,o.VK)(Ae.bq,[]);return(0,y.jsx)(Gn.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:r,captureSelection:!1,restoreSelection:!1,parentBlockId:d,onAutocompleteQueryChange:ei,autocompleteQuery:s.createInQuery||"",desktopWidth:si(c),onCancel:ti})}function ei(e){const t=In.Z.state;t.open&&In.Z.setState({...t,createInQuery:e})}function ti(){const e=In.Z.state;e.open&&In.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function si(e){return e?400:330}var ni=s(27153),ii=s(84939),oi=s(79362),ai=s(39901),ri=s(35840),li=s(47691),di=s(11751),ci=s(89078),ui=s(91584),mi=s(96802),pi=s(64964),gi=s(53471),hi=s(17809),fi=s(65187);function xi(e){window.__c={n:"AiSourcePickerQueryInput"};const{placeholder:t,onSubmit:s}=e,i=(0,et.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:60},placeholder:{minHeight:60}})),[]),o=(0,n.useCallback)((e=>{if(s&&!e.shiftKey)s();else{if("editing"!==P.default.state.mode)return}}),[s]);return(0,y.jsx)("div",{style:i.wrap,className:m.Wh_,children:(0,y.jsx)(fi.Z,{placeholder:t,disabled:!1,store:e.store,style:i.text,placeholderStyle:i.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:o,disableMobileActionBar:!1,disableDateReminderMentions:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0})})}var yi=s(6202);function Si(e){window.__c={n:"AiSourcePickerInputWrapper"};const{tab:t}=e,s=(0,i.O7)(),{store:o}=(0,hi.Cl)({initialValue:void 0,onChange:M.yR}),a=(0,et.yK)((e=>({desktopStyle:{marginTop:8,marginBottom:6},sparkleStyle:{width:16,height:16,marginRight:4},captionStyle:{textAlign:s.device.isMobile?"left":"center"}})),[s.device.isMobile]),r=(0,n.useCallback)((async()=>{const s=o.getValue();if(!s)return;const n=[];for(const e of s){var i;if("‣"===e[0]&&null!==(i=e[1])&&void 0!==i&&i.length){if("d"===e[1][0][0]){const t=e[1][0][1].start_date;n.push(t)}else if("u"===e[1][0][0]){const t=e[1][0][1],{currentSpaceStore:s}=ae.default.state;if(!s)return{users:[],bots:[]};const i=$t.U6.createChildStore(s,{table:en.KJ,id:t});await i.load();const o=i.getEmail();n.push(o||"")}}else n.push(e[0])}const a=n.join(""),r=t.integration;if(a){e.store.setState({...e.store.state,loading:!0});const s=await t.getResults(a,r);e.store.setState({...e.store.state,loading:!1,result:s.results})}}),[o,e.store,t]);return(0,y.jsxs)("div",{children:[(0,y.jsx)(N.Z,{desktopStyle:a.desktopStyle,children:(0,y.jsx)(xi,{placeholder:e.placeholder,onSubmit:r,store:o})}),(0,y.jsx)(N.Z,{children:(0,y.jsx)(yi.Z,{onClick:r,title:t.buttonText||(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Ask",id:"mediaPicker.aiSourcePickerTab.askButtonText"}),(0,y.jsx)("div",{children:(0,di.t)(a.sparkleStyle)})]}),fullWidth:e.isSmallWidth})}),t.caption&&(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:t.caption,style:a.captionStyle})]})}var vi=s(42922),bi=s(949),Mi=s(51077),ji=s(91839),wi=s(63296),Ci=s(30506),ki=s(2520),Ti=s(50265),Ii=s(73063),Pi=s(86825);const Zi=(0,l.defineMessages)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor"}});function Fi(){window.__c={n:"IconPickerColorPicker"};const e=(0,o.VK)((()=>{var e;return null===(e=ae.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),t=(0,l.useIntl)(),s=(0,i.O7)(),n=(0,et.Fg)(),a=(0,i.Fy)(),r=(0,o.qz)(void 0,se.Z);return(0,y.jsx)(ee.ZP,{renderTooltip:()=>t.formatMessage(Zi.selectIconColor),placement:ee.ug.Bottom,render:i=>(0,y.jsx)($.ZP,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:r,popupType:$.Z4.Popup,renderOrigin:s=>(0,y.jsx)(oe.DO,{ariaLabel:t.formatMessage(Zi.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?oi.RR[e]:Zi.noIconColor)}),icon:t=>(0,Ti.U)({...t,stroke:e?oi.Lr[n.mode][e]:oi.Lr[n.mode].lightgray,fill:e?oi.Lr[n.mode][e]:n.lightIconColor}),...(0,te.Z)(s,i)}),render:i=>function(e){const{parent:t,environment:s,currentIconPickerColor:n,theme:i,device:o,intl:a}=e,r=oi.Oe.map((e=>({key:e,action:n=>{t.close(),_i({environment:s,color:e})},render:t=>(0,y.jsx)(ee.ZP,{renderTooltip:()=>a.formatMessage(oi.RR[e]),placement:ee.ug.Bottom,render:s=>(0,y.jsx)(Ii.Z,{...(0,te.Z)(s,t),ariaLabel:a.formatMessage(Zi.selectSpecificIconColor,{iconColor:a.formatMessage(oi.RR[e])}),style:{...o.isMobile?{width:Z.mz,height:Z.mz}:{width:Z.T8,height:Z.T8}},icon:t=>(0,Ti.U)({...t,height:o.isMobile?18:14,width:o.isMobile?18:14,stroke:oi.Lr[i.mode][e],fill:oi.Lr[i.mode][e]})})})})));return r.push({key:"askEveryTime",action:()=>{t.close(),_i({environment:s,color:void 0})},render:e=>(0,y.jsx)(Pi.Z,{...e,title:(0,y.jsx)(l.FormattedMessage,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time"}),onClick:()=>{_i(void 0!==n?{environment:s,color:void 0}:{environment:s,color:"gray"})},on:void 0===n,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:o.isMobile?10:6},rightStyle:{marginRight:4}})}),(0,y.jsx)(J.Z,{capture:!0,allowEsc:!0,children:(0,y.jsx)(O.Z,{type:O.i.Grid,itemsPerRow:5,initialFocus:n?Math.max(oi.Oe.indexOf(n),0):10,sections:[{key:"variations",render:e=>(0,y.jsx)("div",{...e}),items:r}],renderRow:(e,t)=>(0,y.jsx)("div",{style:{display:"flex",padding:4,...t<2&&void 0===n&&{opacity:.5},...2===t&&{padding:"0 0 4px 0",flexDirection:"row-reverse"}},children:e},t)})})}({parent:i,environment:s,currentIconPickerColor:e,theme:n,device:a,intl:t})})})}function _i(e){const{environment:t,color:s}=e,{currentUserSettingsStore:n}=ae.default.state;n&&k.createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,perform:e=>{const t=void 0!==s?s:null;ie.d2({userSettingsStore:n,transaction:e,data:{icon_picker_color:t}})}})}var Ai=s(78948),Ri=s(23586),Di=s(92658),Bi=s(5385),Li=s(45567);class Oi extends q.default{getInitialState(){return{inputValue:"",focus:!1,result:void 0,loading:!1,hover:""}}}const Ei=Oi;var Ni=s(4391),Vi=s(91390),Ui=s(91694),Wi=s(88893),Ki=s(88280),zi=s(3403),qi=s(12981),Gi=s(16354),Hi=s(81865),Qi=s(62385);function Yi(){const{device:e,WindowSizeStore:t}=(0,i.O7)(),s=(0,o.VK)((()=>e.isPhone),[e]),{phonePaddingLeft:n,phonePaddingRight:a}=(0,o.VK)((()=>({phonePaddingLeft:t.getSafePaddingLeftCSS(14),phonePaddingRight:t.getSafePaddingRightCSS(14)})),[t]);return(0,et.yK)((e=>({galleryWrap:{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:e.popoverBackground,paddingTop:s?12:0,paddingBottom:s?12:0,paddingLeft:s?n:12,paddingRight:s?a:12,boxShadow:s?`0 1px 0 ${e.regularDividerColor}`:""}})),[s,n,a])}function $i(e){let{pageCover:t,tab:s}=e;window.__c={n:"GalleryItem"};const{coverUrl:i,title:o,subtitle:a,position:r}=t,l=(0,et.yK)((e=>({container:{width:"25%",padding:3},tooltip:{maxWidth:180,whiteSpace:"normal"},title:{color:e.regularInvertedTextColor},subtitle:{color:e.mediumInvertedTextColor},buttonHover:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(r||0)}%`,borderRadius:4}})),[r]),d=(0,n.useCallback)((()=>{s.onChange({url:i,position:r})}),[s,i,r]);return(0,y.jsx)("div",{style:l.container,children:(0,y.jsx)(ee.ZP,{originGap:0,placement:ee.ug.Bottom,delayThreshold:600,renderTooltip:()=>(0,y.jsxs)("div",{style:l.tooltip,children:[(0,y.jsx)("span",{style:l.title,children:U.default.formatMessage(o)})," ",(0,y.jsx)("span",{style:l.subtitle,children:a&&U.default.formatMessage(a)})]}),render:e=>(0,y.jsx)(Y.Z,{hoveredStyle:l.buttonHover,...e,onClick:d,children:(0,y.jsx)(Hi.Z,{url:i,width:200,isAuthenticated:!1,render:(e,t)=>t&&(0,y.jsx)(qi.Z,{src:t,style:l.imageBox})})})})})}const Ji=function(e){let{tab:t}=e;window.__c={n:"GalleryMediaPickerTab"};const[s,i]=(0,n.useState)({}),[o,a]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async()=>{a(!0),await g.deps.pageCovers.loader().then((e=>{i(e.default),a(!1)}))})()}),[]);const r=Yi(),l=(0,et.yK)((e=>({container:{paddingBottom:8},groupTitle:{marginLeft:-5},loader:{height:300}})),[]);return o?(0,y.jsx)("div",{style:l.loader,children:(0,y.jsx)(zi.Z,{})}):(0,y.jsx)("div",{style:l.container,children:M.UI(s,((e,s)=>(0,y.jsx)(N.Z,{title:(0,y.jsx)(Gi.Z,{style:l.groupTitle,href:e.url,external:!0,children:(0,y.jsx)(Qi.Z,{children:U.default.formatMessage(e.title)})}),isTitleUppercase:!0,noTextOverflow:!0,children:(0,y.jsx)("div",{style:r.galleryWrap,children:e.items.map(((e,s)=>(0,y.jsx)($i,{pageCover:e,tab:t},s)))})},s)))})};var Xi=s(42402),eo=s(75822);const to=(0,l.defineMessages)({giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",defaultMessage:"Search GIPHY"}});function so(e){window.__c={n:"GiphyResults"};const{tab:t,results:s,ready:i,isSmallWidth:o,giphyRandomId:a}=e,r=(0,et.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:o?"left":"center",color:e.mediumTextColor}})),[o]);return i?!s||s&&!s.length?(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.giphy.noResultsText"}),style:r.captionMenuItem}):(0,y.jsxs)(n.Fragment,{children:[s.map(((e,s)=>(0,y.jsx)(no,{tab:t,image:e,giphyRandomId:a},s))),(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.giphy.searchText"}),style:r.captionMenuItem})]}):(0,y.jsx)("div",{style:r.loading,children:(0,y.jsx)(Ms.Z,{})})}function no(e){var t;let{tab:s,image:o,giphyRandomId:a}=e;window.__c={n:"RenderedGiphyImage"};const r=(0,i.O7)(),{device:d}=r,c=(0,et.yK)((e=>({container:{width:d.isMobile?"33%":"25%",padding:3},hoveredButton:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4},label:{marginTop:2,marginBottom:4}})),[d.isMobile]),u=(0,n.useCallback)((async()=>{var e;if(s.onChange({url:o.imageUrl}),null!==(e=o.analytics)&&void 0!==e&&e.onclick)try{var t;await Oe.postGiphyAnalytics(r,{url:null===(t=o.analytics)||void 0===t?void 0:t.onclick.url,timestamp:Date.now(),random_id:a})}catch(n){}}),[r,a,o.imageUrl,s,null===(t=o.analytics)||void 0===t?void 0:t.onclick]);return(0,y.jsxs)("div",{style:c.container,children:[(0,y.jsx)(Y.Z,{hoveredStyle:c.hoveredButton,onClick:u,children:(0,y.jsx)(qi.Z,{src:o.thumbUrl,style:c.imageBox})}),(0,y.jsx)(It.Z,{isSmall:!0,isSecondaryColor:!0,style:c.label,children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",values:{authorName:o.authorName||"GIPHY",inlinetextlink:e=>(0,y.jsx)(Xi.Z,{external:!0,href:o.imageUrl,children:e})}})})]},o.id)}const io=function(e){let{tab:t,isSmallWidth:s}=e;window.__c={n:"GiphyMediaPickerTab"};const[o,a]=(0,n.useState)(""),[r,l]=(0,n.useState)(""),d=(0,i.O7)(),{device:c}=d,u=Yi(),m=(0,n.useCallback)((async()=>{if(!M.xb(o))return o;const e=await Oe.getGiphyRandomId(d,{});return"success"===e.type?(a(e.data.random_id),e.data.random_id):void 0}),[d,o]);return(0,y.jsxs)("div",{style:{paddingBottom:8},children:[(0,y.jsx)(N.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,y.jsx)(oe.ZP,{value:r,placeholder:U.default.formatMessage(to.giphyPlaceholder),showClearButton:!0,focus:!c.isMobile||void 0,onChange:e=>l(e.target.value)})}),(0,y.jsx)("div",{style:u.galleryWrap,children:(0,y.jsx)(Ri.Z,{request:r,debounce:eo.vp,performRequest:async e=>{await m();const t=await Oe.searchGiphyImages(d,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,n,i)=>(0,y.jsx)(so,{tab:t,results:n,ready:i,isSmallWidth:s,giphyRandomId:o})})})]})};var oo=s(24608);const ao=(0,l.defineMessages)({unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"}});function ro(e){window.__c={n:"UnsplashResults"};const{tab:t,results:s,ready:i,isSmallWidth:o}=e,a=(0,et.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:o?"left":"center",color:e.mediumTextColor}})),[o]);return i?!s||s&&!s.length?(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:a.captionMenuItem}):(0,y.jsxs)(n.Fragment,{children:[s.map(((e,s)=>(0,y.jsx)(lo,{tab:t,image:e},s))),(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:a.captionMenuItem})]}):(0,y.jsx)("div",{style:a.loading,children:(0,y.jsx)(Ms.Z,{})})}function lo(e){let{tab:t,image:s}=e;window.__c={n:"RenderedUnsplashImage"};const o=(0,i.O7)(),{device:a}=o,r=(0,n.useCallback)((async()=>{const e=await(0,oo.ZP)({environment:o,url:s.downloadUrl,method:"GET",format:"json"});"success"===e.type&&t.onChange({url:e.data.url})}),[o,s.downloadUrl,t]);return(0,y.jsxs)("div",{style:{width:a.isMobile?"33%":"25%",padding:3},children:[(0,y.jsx)(Y.Z,{hoveredStyle:{opacity:.85},onClick:r,children:(0,y.jsx)(qi.Z,{src:s.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:4}})}),(0,y.jsx)(It.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",values:{authorName:s.authorName,inlinetextlink:e=>(0,y.jsx)(Xi.Z,{external:!0,href:s.unsplashUrl,children:e})}})})]},s.id)}const co=function(e){let{tab:t,isSmallWidth:s}=e;window.__c={n:"UnsplashMediaPickerTab"};const[o,a]=(0,n.useState)(""),r=(0,i.O7)(),{device:l}=r,d=Yi();return(0,y.jsxs)("div",{style:{paddingBottom:8},children:[(0,y.jsx)(N.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,y.jsx)(oe.ZP,{value:o,placeholder:U.default.formatMessage(ao.unsplashPlaceholder),showClearButton:!0,focus:!l.isMobile||void 0,onChange:e=>a(e.target.value)})}),(0,y.jsx)("div",{style:d.galleryWrap,children:(0,y.jsx)(Ri.Z,{request:o,debounce:eo.vp,performRequest:async e=>{const t=await Oe.searchUnsplashImages(r,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,n,i)=>(0,y.jsx)(ro,{tab:t,results:n,ready:i,isSmallWidth:s})})})]})},uo=(0,l.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},aiSourcePickerPlaceholder:{id:"mediaPicker.githubPlaceholder.text",defaultMessage:"Ask query here"},aiIsFetchingLoader:{id:"mediaPicker.aiIsFetchingLoader.text",defaultMessage:"Ai is fetching"}});class mo extends b.Z{constructor(){super(...arguments),this.menuRef=n.createRef(),this.storeTypes={embedInputStore:Di.Z,emojiInputStore:Di.Z,iconInputStore:Di.Z,iconPickerStore:Ni.Z,aiSourcePickerStore:Ei},this.handleEmbedSubmit=e=>()=>{const t=this.stores.embedInputStore.state.inputValue;if(t){const s=(0,rs.Wv)(t,Qt.default.secureFileS3.url,Qt.default.secureFileS3V2.url,Qt.default.secureFileConfig.rootPath,Qt.default.secureFileConfig.hostname),n=s?s.link:t;e.onChange(n),kn.bO(this.environment,{pastedText:n,source:"media_picker"})}},this.handleRandomIconClick=()=>{const{device:e}=this.environment,{iconPickerStore:t}=this.stores,s=this.props.tabs.find((e=>e.type===this.props.currentTab));if(s&&"icon"===s.type){const n=s.enforceIconColor??Bi.x(),i=`/icons/${M.UP(Object.keys(t.getState().allIcons))}_${n??M.UP(oi.Oe)}.svg`;s.onChange(i,{keepVisible:!e.isMobile})}},this.handleFilterChange=e=>{const{emojiInputStore:t,iconInputStore:s,iconPickerStore:n}=this.stores,i=this.getNumIconPerRow()*(this.environment.device.isMobile?Z.pq:Z.II),o=this.getNumIconPerRow()*(this.environment.device.isMobile?ki.L6:ki.OF);t.setState({...t.state,inputValue:e.currentTarget.value}),Q.setState({...Q.state,loadEmojiCount:i}),s.setState({...s.state,inputValue:e.currentTarget.value}),n.setState({...n.state,loadIconCount:o})}}renderComponent(){const{device:e}=this.environment,t=(0,y.jsx)(jo,{tabs:this.props.tabs,onDelete:this.props.onDelete,currentTab:this.props.currentTab}),s=this.renderInputHeader(),i=(t||s)&&(0,y.jsxs)(n.Fragment,{children:[t,s]});let o;if(e.isMobile)o={menuType:p.og.Modal,title:this.props.title,header:i,right:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:this.props.onCancel,left:this.props.onDelete&&(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:this.props.onDelete};else{o={menuType:p.og.Popup,header:i};const e=this.props.tabs.find((e=>e.type===this.props.currentTab)),t=e&&"custom"===e.type?e.tabHeight:void 0;o.width=this.props.popupWidth||300,o.height=t||this.props.popupHeight,o.maxHeight=this.props.maxHeight,o.maxWidth=this.props.maxWidth}return(0,y.jsx)(Ci.Z,{onSwipeLeft:()=>function(e,t){if(!Vi.Z.state.isActive)return;const s=e.map((e=>e.type)).indexOf(Vi.Z.state.currentTab),n=e[s+1];void 0!==n&&Mo(n.type,t)}(this.props.tabs,this.environment),onSwipeRight:()=>function(e,t){if(!Vi.Z.state.isActive)return;const s=e.map((e=>e.type)).indexOf(Vi.Z.state.currentTab),n=e[s-1];void 0!==n&&Mo(n.type,t)}(this.props.tabs,this.environment),render:e=>(0,y.jsx)(c.Z,{...o,...e,className:m.tQh,innerRef:this.menuRef,children:this.renderCurrentTab()})})}renderInputHeader(){const{isPhone:e,isMobile:t,isAndroid:s}=this.environment.device,n=this.props.tabs.find((e=>e.type===this.props.currentTab));if(n&&("emoji"===n.type||"icon"===n.type)){const i="emoji"===n.type?this.stores.emojiInputStore.state.inputValue:this.stores.iconInputStore.state.inputValue,o="emoji"===n.type?()=>function(e,t,s){const{device:n}=s,i=e.find((e=>e.type===t));if(i&&"emoji"===i.type){const e=mi.zM();i.onChange(e,{keepVisible:!n.isMobile})}}(this.props.tabs,this.props.currentTab,this.environment):this.handleRandomIconClick,a=(0,y.jsx)(fo,{tabs:this.props.tabs,currentTab:this.props.currentTab,hasRandomButtonOnLeft:!n.hideRandomButton});return(0,y.jsx)("div",{style:{display:"flex",...e?{}:{marginTop:16,marginBottom:10}},children:(0,y.jsx)(oe.ZP,{value:i,placeholder:U.default.formatMessage(uo.filterPlaceholder),autoFocus:!t||void 0,focus:!t||void 0,showClearButton:!0,inputLeft:(0,y.jsx)(oe.f_,{icon:ri.R}),onChange:this.handleFilterChange,right:(0,y.jsxs)("div",{style:{display:"flex"},children:[null!=n&&n.hideRandomButton?void 0:(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:ee.ug.Bottom,render:e=>(0,y.jsx)(oe.DO,{icon:li.I,onClick:o,...e})}),a]}),isRightLastElementOfInput:!0,style:{...s&&{borderBottom:"none"}}})})}}renderCurrentTab(){const e=this.props.tabs.find((e=>e.type===this.props.currentTab));if(!e)return(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(e.type){case"embed":return this.renderEmbedTab(e);case"file":return(0,y.jsx)(yo,{isSmallWidth:this.props.isSmallWidth,onCancel:this.props.onCancel,tab:e});case"emoji":return this.renderEmojiTab(e);case"icon":return this.renderIconTab(e);case"gallery":return(0,y.jsx)(Ji,{tab:e});case"unsplash":return(0,y.jsx)(co,{tab:e,isSmallWidth:this.props.isSmallWidth});case"giphy":return(0,y.jsx)(io,{tab:e,isSmallWidth:this.props.isSmallWidth});case"drive":return(0,y.jsx)(Co,{tab:e});case"box":return(0,y.jsx)(vo,{tab:e});case"aiSourcePicker":return this.renderAiSourcePickerTab(e);case"custom":return this.renderCustomEmbedUploadTab(e)}}renderEmojiTab(e){return(0,y.jsx)(ye,{onSubmit:e.onChange,filter:this.stores.emojiInputStore.state.inputValue||"",isCallout:this.props.isCallout,iconLoggingData:this.props.recordIconLoggingData,menuRef:this.menuRef})}renderIconTab(e){return(0,y.jsx)(ki.ZP,{store:this.stores.iconPickerStore,filter:this.stores.iconInputStore.state.inputValue||"",onSubmit:e.onChange,iconLoggingData:this.props.recordIconLoggingData,enforceIconColor:e.enforceIconColor,menuRef:this.menuRef})}renderCustomEmbedUploadTab(e){const{device:t}=this.environment,s=Ki.subscriptionDataStoreInstance.state,n=(0,y.jsx)(vi.Z,{onClick:this.handleEmbedSubmit(e),disabled:0===this.stores.embedInputStore.state.inputValue.length,hovered:!1,children:e.buttonText||(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})}),i=(0,y.jsx)(N.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12},children:(0,y.jsx)(oe.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||U.default.formatMessage(uo.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})},inputRight:t.isPhone?n:void 0,right:t.isPhone?void 0:n,isRightLastElementOfInput:!0})}),o=(0,y.jsx)(bi.Q,{type:go(e)??Li.gU,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):pi.oV({label:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,_.fn)([_.ZP.blueWithAlpha(.14),(0,ii.Fq)(this.theme.contentBackground,.5)])},children:(0,y.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[e.fileUpload&&(0,y.jsx)(N.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24},children:(0,y.jsx)(yi.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>ho(e),fullWidth:this.props.isSmallWidth})}),(0,y.jsx)(xo,{isSmallWidth:this.props.isSmallWidth,tab:e}),e.caption&&(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||s&&Wi.YK(s)&&(0,y.jsx)("div",{style:{height:8}}),s&&!e.preventUploadLimitFreeFileSize&&!Wi.YK(s)&&(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"},children:[(0,y.jsx)("div",{style:{marginRight:6,color:this.theme.mediumTextColor},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:gi.K_}})}),!Be.default.isOnboarding.state&&(0,y.jsx)(Ui.Z,{subscriptionTier:Wi.M9(this.environment)||"plus",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})});return(0,y.jsxs)(y.Fragment,{children:[i,o]})}renderEmbedTab(e){const{device:t}=this.environment;return(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(N.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,y.jsx)(oe.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||U.default.formatMessage(uo.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}})}),(0,y.jsx)(N.Z,{children:(0,y.jsx)(yi.Z,{onClick:this.handleEmbedSubmit(e),title:e.buttonText||(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:this.props.isSmallWidth})}),e.caption&&(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:t.isMobile?"left":"center"}})]})}renderAiSourcePickerTab(e){var t,s;return(0,y.jsxs)(n.Fragment,{children:[this.stores.aiSourcePickerStore.state.result&&!1===this.stores.aiSourcePickerStore.state.loading&&(0===(null===(t=this.stores.aiSourcePickerStore.state.result)||void 0===t?void 0:t.length)?(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.aiSourcePicker.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):null===(s=this.stores.aiSourcePickerStore.state.result)||void 0===s?void 0:s.map((t=>(0,y.jsxs)("div",{style:{cursor:"pointer",color:this.theme.mediumTextColor,textAlign:"left",hyphens:"auto",padding:"10px 8px",backgroundColor:this.stores.aiSourcePickerStore.state.hover===t.url?"rgba(55,53,47,0.08)":"",display:"flex",flexDirection:"row"},onClick:bo(t.url,e),onMouseEnter:()=>{this.stores.aiSourcePickerStore.setState({...this.stores.aiSourcePickerStore.state,hover:t.url})},children:[(0,y.jsx)(Mi.Z,{imageURL:"NONE"===t.avatar?e.defaultAvatar:t.avatar,size:24,imageStyle:{borderRadius:34,boxShadow:"0 2px 4px rgba(15, 15, 15, 0.1)"},type:"image_url"}),(0,y.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"rgb(55, 53, 47)",fontWeight:500,fontSize:"14px",paddingLeft:8},children:t.title})]},t.url)))),this.stores.aiSourcePickerStore.state.loading&&(0,y.jsxs)("div",{style:{flex:1,color:this.theme.accentColors.purple[400],fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center",padding:"12px 12px",marginLeft:10},children:[U.default.formatMessage(uo.aiIsFetchingLoader),(0,y.jsx)(ji.Z,{style:{backgroundColor:this.theme.accentColors.purple[400]}})]}),!this.stores.aiSourcePickerStore.state.result&&!this.stores.aiSourcePickerStore.state.loading&&(0,y.jsx)(Si,{tab:e,placeholder:e.inputPlaceholder||U.default.formatMessage(uo.aiSourcePickerPlaceholder),store:this.stores.aiSourcePickerStore,isSmallWidth:this.props.isSmallWidth})]})}getNumIconPerRow(){var e,t;return null!==(e=this.menuRef)&&void 0!==e&&null!==(e=e.current)&&void 0!==e&&e.offsetWidth?((null===(t=this.menuRef)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.offsetWidth)-24)/32:12}}mo.displayName="MediaPicker";const po=mo;function go(e){return e.fileUpload?Li.jo:e.imageUpload?Li.LR:e.videoUpload?Li.G7:void 0}async function ho(e,t){const s=await gi.y({multiple:!1,accept:t});s.length&&e.onUpload(s[0])}function fo(e){let{hasRandomButtonOnLeft:t,tabs:s,currentTab:n}=e;const i=s.find((e=>e.type===n));if(!i)return null;let o;return"emoji"===(null==i?void 0:i.type)?o=(0,y.jsx)(re,{}):"icon"===(null==i?void 0:i.type)&&void 0===i.enforceIconColor&&(o=(0,y.jsx)(Fi,{})),t&&o?(0,y.jsx)("div",{style:{marginLeft:6},children:o}):o??null}function xo(e){let{tab:t,isSmallWidth:s}=e;return t.imageUpload||t.videoUpload?(0,y.jsxs)(N.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12},children:[t.imageUpload&&(0,y.jsx)(wi.Z,{isLarge:!0,onClick:()=>ho(t,"image/*"),style:{width:"100%"},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})}),t.videoUpload&&(0,y.jsx)(yi.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>ho(t,"video/*"),fullWidth:s})]}):null}function yo(e){let{tab:t,isSmallWidth:s,onCancel:n}=e;window.__c={n:"UploadTabComponent"};const a=(0,et.Fg)(),r=(0,i.O7)(),d=(0,o.VK)((()=>Ki.subscriptionDataStoreInstance.state),[]),c=(0,o.VK)((()=>Be.default.isOnboarding.state),[]),u=(0,o.VK)((()=>Wi.M9(r)||"plus"),[r]);return(0,y.jsx)(bi.Q,{type:go(t)??Li.gU,dropTargetKey:"uploadTab",onDropFile:e=>{if("invalidFileDrop"===e.type)return pi.oV({label:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})}),null;t.onUpload(e.file)},dropzoneStyle:{background:(0,_.fn)([_.ZP.blueWithAlpha(.14),(0,ii.Fq)(a.contentBackground,.5)])},children:(0,y.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[t.fileUpload&&(0,y.jsx)(N.Z,{desktopStyle:{marginTop:s?8:24},children:(0,y.jsx)(yi.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>ho(t),fullWidth:s})}),(0,y.jsx)(xo,{isSmallWidth:s,tab:t}),t.caption&&(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:t.caption,style:{textAlign:s?"left":"center",color:a.mediumTextColor}}),t.preventUploadLimitFreeFileSize||d&&Wi.YK(d)&&(0,y.jsx)("div",{style:{height:8}}),d&&!t.preventUploadLimitFreeFileSize&&!Wi.YK(d)&&(0,y.jsx)(L.Z,{shouldWrapCaption:!0,caption:(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:s?"flex-start":"center"},children:[(0,y.jsx)("div",{style:{marginRight:6,color:a.mediumTextColor},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:gi.K_}})}),!c&&(0,y.jsx)(Ui.Z,{subscriptionTier:u,onClick:()=>{n&&n()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})})}function So(e){let{tab:t}=e;window.__c={n:"GoogleDriveConnectAccountOptionComponent"};const s=(0,et.Fg)();return(0,y.jsxs)(N.Z,{children:[(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:{color:s.blueColor}}),(0,y.jsx)(L.Z,{shouldWrapCaption:!1,caption:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})]})}function vo(e){let{tab:t}=e;window.__c={n:"BoxTabComponent"};const s=(0,et.Fg)(),{accounts:n}=t;return 0===n.length?(0,y.jsxs)(N.Z,{children:[(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label"}),onClick:()=>t.onSelect(),focused:!1,style:{color:s.blueColor}}),(0,y.jsx)(L.Z,{shouldWrapCaption:!1,caption:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption"})})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(N.Z,{children:n.map((e=>(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,y.jsx)(N.Z,{topBorder:!0,children:(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label"}),onClick:()=>t.onSelect(),style:{color:s.mediumTextColor},focused:!1})})]})}function bo(e,t){return()=>{e&&t.onChange(e)}}function Mo(e,t){Vi.Z.state.isActive&&(Vi.Z.setState({...Vi.Z.state,currentTab:e}),"icon"===e&&Vi.Z.state.recordIconLoggingData&&w.kz9(t,"select_icon_tab",Vi.Z.state.recordIconLoggingData))}function jo(e){let{tabs:t,onDelete:s,currentTab:o}=e;window.__c={n:"TabsHeaderComponent"};const a=(0,et.Fg)(),r=(0,i.O7)(),{device:d}=r;if(t.length<=1&&!s)return null;{const e={gallery:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon"}),custom:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom"}),unsplash:(0,y.jsxs)(n.Fragment,{children:[(0,ci.i)({width:12,marginRight:4,height:12}),(0,y.jsx)("span",{children:"Unsplash"})]}),giphy:(0,y.jsxs)(n.Fragment,{children:[(0,ai.z)({width:12,marginRight:4,height:12}),(0,y.jsx)("span",{children:"GIPHY"})]}),drive:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),aiSourcePicker:(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.ask",defaultMessage:"Ask"}),(0,di.t)({width:16,height:16,marginRight:4,color:a.accentColors.purple[400]})]})},i=t.findIndex((e=>e.type===o)),c=t.map((t=>t.title||e[t.type])),u=t.find((e=>e.type===o)),m=u&&"emoji"!==u.type&&d.isAndroid;return(0,y.jsx)(lt.Z,{tabs:c,selectedIndex:i,onChange:e=>{Mo(t[e].type,r)},right:s&&!d.isMobile&&(0,y.jsx)(ws.Z,{isGray:!0,onClick:s,children:(0,y.jsx)(l.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})}),style:{...m&&{borderBottom:"none"}}})}}function wo(e){let{tab:t,accounts:s}=e;window.__c={n:"GoogleDriveAccountsComponent"};const i=(0,et.Fg)();return"accounts"in t?t.accounts&&0===t.accounts.length?(0,y.jsx)(So,{tab:t}):(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(N.Z,{children:t.accounts.map(((e,s)=>(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.account_name}}),onClick:()=>t.onSelect(e),focused:!1},e.account_key)))}),(0,y.jsx)(N.Z,{topBorder:!0,children:(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:{color:i.mediumTextColor},focused:!1})})]}):s?0===s.length?(0,y.jsx)(So,{tab:t}):(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(N.Z,{children:s.map(((e,s)=>(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:e.accountName}}),onClick:()=>t.onSelect(e),focused:!1},e.accountId)))}),(0,y.jsx)(N.Z,{topBorder:!0,children:(0,y.jsx)(vt.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>t.onSelect(),style:{color:i.mediumTextColor},focused:!1})})]}):null}function Co(e){let{tab:t}=e;window.__c={n:"GoogleDriveTabComponent"};const s=(0,i.O7)();return"accounts"in t?(0,y.jsx)(wo,{tab:t}):(0,y.jsx)(Ri.Z,{request:s,performRequest:ui.vQ,render:(e,s,n)=>{if(!n)return(0,y.jsx)(N.Z,{children:(0,y.jsx)(Ai.Z,{})});const i=s&&s.accounts?s.accounts:[];return(0,y.jsx)(wo,{tab:t,accounts:i})}})}const ko=function(){window.__c={n:"MediaMenu"};const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>Vi.Z.state),[]);return(0,y.jsx)(u.ZP,{popupType:t.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:s.isActive,originRect:s.isActive?s.originRect:void 0,originGap:s.isActive?s.originGap:void 0,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:To,render:()=>{if(s.isActive)return(0,y.jsx)(X.Z,{capture:!0,onUp:M.yR,onDown:M.yR,children:(0,y.jsx)(po,{...s,onCancel:To})})}})};function To(){ni.Z()}var Io=s(66897),Po=s(15145),Zo=s(41892),Fo=s(7057),_o=s(53877),Ao=s(84795),Ro=s(33728),Do=s(58573),Bo=s(42875),Lo=s(47612),Oo=s(9999),Eo=s(82114),No=s(56666),Vo=s(26056),Uo=s(6746),Wo=s(92338),Ko=s(85031),zo=s(44805),qo=s(7928),Go=s(81918),Ho=s(67060),Qo=s(75754),Yo=s(97638),$o=s(83089),Jo=s(7314),Xo=s(13394),ea=s(18245),ta=s(14568),sa=s(49038),na=s(85019),ia=s(77080),oa=s(63334),aa=s(55899),ra=s(84166),la=s(19111),da=s(69454),ca=s(88923),ua=s(72087),ma=s(65613),pa=s(43765),ga=s(82990);const ha={...ga.Z.textOverflowStyle,fontWeight:ga.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function fa(e){const{pageTitle:t}=e;return t?(0,y.jsx)(l.FormattedMessage,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,y.jsx)("span",{style:ha,children:t})}}):(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function xa(e){const{pageTitle:t}=e;return t?(0,y.jsx)(l.FormattedMessage,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,y.jsx)("span",{style:ha,children:t})}}):(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var ya=s(85215),Sa=s(60442),va=s(97680);function ba(e){window.__c={n:"SvgWorkaroundForChromiumBug"};const{svg:t,viewBox:s,fill:i}=e,o=(0,n.useMemo)((()=>{const e=Uo.Z.renderToString((0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:s,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,s]);return(0,y.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:i,WebkitMaskImage:o,maskImage:o,WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat"}})}const Ma=(0,l.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),ja=(0,l.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"},groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});class wa extends b.Z{constructor(){super(...arguments),this.storeTypes={ignoreSelectionAreaStore:oa.Z,localPageMentionRequestStore:ua.Z,localCachePageMentionRequestStore:ua.Z,inviteTargetsStore:aa.ZP,personPropertyInviteStore:Xo.Z},this.renderMentionResult=(e,t)=>{const{intl:s}=this.props,n=la.Z.state,i=n.open&&n.insertionType,o=this.shouldPrioritizeUserSection(t),a={sections:[],nextSectionShouldHaveTopBorder:()=>a.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===i&&a.addSection(this.getCreatePageMenuSection(a.nextSectionShouldHaveTopBorder())),a.addSection(this.getDateResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),o&&a.addSection(this.getUserResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),a.addSection(this.getGroupResultsMenuSection(t,a.nextSectionShouldHaveTopBorder(),this.props.intl)),a.addSection(this.getHeaderResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),a.addSection(this.getPageResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),o||a.addSection(this.getUserResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),("@"===i&&this.filterStore.state||"[["===i)&&a.addSection(this.getCreatePageMenuSection(a.nextSectionShouldHaveTopBorder()));const{sections:r}=a;let d,u;if(Nn.Z.state.online){const e=n.mentionTypes.user,t=n.mentionTypes.page,i=n.mentionTypes.date;let o="";const a=Ma;e&&t&&i?o=s.formatMessage(a.mentionAll):e&&t?o=s.formatMessage(a.mentionPersonPage):e&&i?o=s.formatMessage(a.mentionPersonDate):t&&i?o=s.formatMessage(a.mentionPageDate):e?o=s.formatMessage(a.mentionPerson):i?o=s.formatMessage(a.mentionDate):t&&n&&(o=n.open&&"+"===n.insertionType?s.formatMessage(Ma.addPage):s.formatMessage(a.mentionPage)),this.setTemporaryInputData({title:o,icon:Ea(this.theme),allowTabCompletion:!1}),d=void 0}else d=(0,y.jsx)(pa.Z,{title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===r.length&&(u=(0,y.jsx)(N.Z,{children:(0,y.jsx)(pa.Z,{title:(0,y.jsx)(l.FormattedMessage,{...ja.noResults})})}));const{device:m}=this.environment;let g;return g=Za(this.environment)?{menuType:p.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${da.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:p.og.Popup,width:Ia(),maxHeight:m.isMobile?"30vh":"40vh",onClickOutside:this.makeHandleCancelCallback()},(0,y.jsxs)(c.Z,{...g,header:d,children:[(0,y.jsx)(X.Z,{capture:la.Z.state.open,onBackspace:this.shouldCaptureBackspace()?this.handleEmptyBackspace:void 0,onTab:this.handleTab}),(0,y.jsx)(O.Z,{type:O.i.Vertical,initialFocus:this.getMenuInitialFocus(),sections:r,onEmptyEnter:this.makeHandleCancelCallback(),resetInitialFocusOnSectionChange:!0}),u]})},this.renderCreateInMenu=()=>{const e=la.Z.state;if(!e.open)return;const t="block"===e.textStore.table?e.textStore.id:void 0;return(0,y.jsx)(Gn.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{Ho.Br({environment:this.environment,titleText:this.getNormalizedFilter(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:t,onAutocompleteQueryChange:Ba,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,autocompleteQuery:e.createInQuery,desktopWidth:Ia(),onCancel:Oa})},this.renderInviteMenu=()=>{const e=Ot.np();if(e)return(0,y.jsx)(Qn.Z,{store:this.stores.ignoreSelectionAreaStore,capture:!0,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>(0,y.jsx)(Jo.Z,{inviteOrigin:Ta(),store:e,onInviteCompleteFn:e=>{if(!e.success)return void this.handleInviteCancel();const{invitedUsers:t,requestedUsers:s}=e,n=M.zo(Object.values(t),Object.values(s));n.length?k.createAndCommit({userAction:"MentionMenu.inviteMenu",environment:this.environment,perform:e=>{Ho.RL({environment:this.environment,annotations:n.map((e=>(0,j.tEo)(e))),transaction:e,menuListItemAction:void 0,query:this.getNormalizedFilter(),mentionType:"user"})}}):this.handleInviteCancel()},handleBackButtonClick:this.handleInviteCancel,inviteTargetsStore:this.stores.inviteTargetsStore,personPropertyInviteStore:this.stores.personPropertyInviteStore})})},this.handleInviteStart=()=>{const e=la.Z.state;this.stores.inviteTargetsStore.reset(),this.stores.personPropertyInviteStore.reset(),e.open&&(this.stores.inviteTargetsStore.setState({...this.stores.inviteTargetsStore.state,tokenQuery:this.getNormalizedFilter()}),this.stores.personPropertyInviteStore.setState({...this.stores.personPropertyInviteStore.state,flowId:e.flowId}),Go.P0(this.environment,{origin:Ta(),invite_flow_id:e.flowId}),ka({showInvite:!0}))},this.handleInviteCancel=()=>{const e=la.Z.state;e.open&&(Go.Zv(this.environment,{origin:Ta(),invite_flow_id:e.flowId}),this.stores.inviteTargetsStore.setState({tokenQuery:"",inviteTargets:[]}),this.stores.personPropertyInviteStore.setState({...this.stores.personPropertyInviteStore.state,emailMessage:""}),ka({showInvite:!1}))},this.handleEmptyBackspace=e=>{this.shouldCaptureBackspace()&&e.preventDefault(),this.makeHandleCancelCallback()()},this.makeHandleCancelCallback=()=>{const e=la.Z.state,t=this.getNormalizedFilter(),s=Ho.WI();let n,i=Date.now();return e.open&&(i=e.openTime,n=e.flowId),()=>{w.ewV(this.environment,{timeToAbandonInMs:Date.now()-i,queryLength:t.length,analyticsFrom:s,flowId:n}),e.open&&e.showInvite&&Go.Zv(this.environment,{origin:Ta(),invite_flow_id:e.flowId}),Ho.xv()}},this.handleTab=e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const s=P.default.state;if("editing"!==s.mode)return;const n=(0,T.QY)(s.multiSelection);if(!n)return;const i=la.Z.state;i.open&&i.textStore===n.store&&k.createAndCommit({userAction:"MentionMenu.handleTab",environment:this.environment,perform:e=>{Lt.hJ({environment:this.environment,transaction:e,string:t,store:n.store,selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})},this.tabCompletionString=void 0,this.pageHeaderIdsStore=this.createComputedStore(_a),this.inputSelectionsStore=this.createComputedStore((()=>{const e=la.Z.state;if(e.open)return I.O2(e.textStore,e.oldTextValue,e.isEmptyPageTitle?"":e.insertionType)})),this.filterStore=this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=la.Z.state;if(e&&t.open)return I.ug(t.textStore,e)})),this.popupOpenStore=this.createComputedStore((()=>{const e=la.Z.state;return!!e.open&&("+"!==e.insertionType||""!==this.getNormalizedFilter())})),this.performLocalPageMentionRequest=async e=>{const{localCachePageMentionRequestStore:t}=this.stores,s=t.state.result;if(!s)return;const n=Ot.RM();return n&&this.getNormalizedFilter()?Promise.resolve((0,sa.Y)({query:e,localCachedPages:s,parentStore:n,isOnline:Nn.Z.state.online,environment:this.environment,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0,canUseLtr:!1})):void 0},this.performServerPageMentionRequest=async e=>{const t=la.Z.state;return t.open&&this.getNormalizedFilter()&&t.mentionTypes.page?await async function(e,t){if(!Nn.Z.state.online)return[];const s=la.Z.state,n=s.open&&(0,nt.OY)(s.textStore)&&s.textStore,i=await g.deps.searchActions.loader();return await i.searchMentionablePages({nearBlock:n||void 0,environment:t,query:e,source:"mention_menu",limit:20})}(e,this.environment):[]}}UNSAFE_willMountOrUpdate(){const e=la.Z.state,t=this.filterStore.state;if(e.open){var s;const n=P.default.state,i="editing"===n.mode?(0,T.QY)(n.multiSelection):void 0,o=(null==i?void 0:i.store)===e.textStore,a=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=a&&"editing"===a.mode&&(null===(s=(0,T.QY)(a.multiSelection))||void 0===s?void 0:s.store)===e.textStore;if(!o&&!r)return void Ho.xv();const l=o&&(null==i?void 0:i.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void Ho.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match($o.Ff))return void Ho.xv();if(void 0===t&&!e.isEmptyPageTitle)return void Ho.xv()}}renderComponent(){const{device:e}=this.environment,t=la.Z.state,s=ta.Z.find((e=>e.props.capture)),n=this.popupOpenStore.state;let i;if(s&&e.isMobile){var o;const e=null===(o=s.stores.store.state.node)||void 0===o?void 0:o.getBoundingClientRect();e&&(i={height:`calc(100vh - ${e.height}px)`})}const a=t.open&&t.showCreateIn,r=t.open&&t.showInvite;return(0,y.jsx)(u.ZP,{popupType:Za(this.environment)?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:n,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:i,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Start,originGap:8,disableMouseCapture:!r,disableContentScroll:!0,onDismiss:this.makeHandleCancelCallback(),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?(0,y.jsxs)(y.Fragment,{children:[this.renderMentionSearch(),(0,y.jsx)(u.ZP,{popupType:u.ZP.PopupType.SlideUp,render:this.renderCreateInMenu,open:a,keepFocus:!0}),(0,y.jsx)(u.ZP,{popupType:u.ZP.PopupType.SlideUp,render:this.renderInviteMenu,open:r,keepFocus:!0})]}):a?this.renderCreateInMenu():r?this.renderInviteMenu():this.renderMentionSearch()})}renderMentionSearch(){const e=this.getNormalizedFilter(),t=la.Z.state,s=ea.default.mark("rum.mention_menu_ready"),n={field:"relevance"};return(0,y.jsx)(Ri.Z,{requestStore:t.userRequestStore,request:e,performRequest:e=>async function(e,t){const s=la.Z.state;if(!s.open)return;const n=s.mentionTypes.user?await async function(e,t){if(Nn.Z.state.online){const s=await g.deps.searchActions.loader();return await s.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1})}return[]}(e,t):[];return""===e?n.slice(0,2):n.slice(0,20)}(e,this.environment),render:i=>(0,y.jsx)(Ri.Z,{requestStore:t.pageRequestStore,request:e,performRequest:this.performServerPageMentionRequest,debounce:eo.vp,render:t=>(0,y.jsx)(Ri.Z,{requestStore:this.stores.localCachePageMentionRequestStore,request:ae.default.state.currentSpaceStore&&ae.default.state.currentSpaceStore.id,performRequest:()=>async function(e){const{currentSpaceStore:t,currentSpaceViewStore:s}=ae.default.state;if(!t)return;if("on"===ia.default.getEligibleGroup({experimentId:"use_global_local_search_cache"}))return ra.Z.state.localSearchableBlocksCache;return(0,na.S)({environment:e,currentSpaceStore:t,currentSpaceViewStore:s,excludeCurrentPage:!0})}(this.environment),render:o=>(0,y.jsx)(Ri.Z,{requestStore:this.stores.localPageMentionRequestStore,debounce:eo.E5,request:{query:{text:e,filters:Wo.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:n},limit:5},performRequest:this.performLocalPageMentionRequest,render:e=>this.renderMentionResult(i||t||e,this.getCurrentMentionResults(s))})})})})}getDateResultsMenuSection(e,t){const{dateResults:s}=e,{intl:n}=this.props,i=this.getNormalizedFilter(),o=this.getTemplateVariableMenuItems(e,"date");if(0===s.length&&0===o.length)return;const a=s.map((e=>{let{label:t,value:s}=e;return{key:t,render:e=>{if(e.focused&&this.setTemporaryInputData({title:t,icon:Da(this.theme.mediumIconColor),allowTabCompletion:!0}),Ao.parseRelativeDate(t,n)){const i=(0,Fo.ZV)({value:s(),userTimeZone:(0,Bo.r)(),intl:n,allowRelativeDates:!1});return(0,y.jsx)(vt.Z,{...e,title:t,caption:i,inline:!0})}return(0,y.jsx)(vt.Z,{...e,title:t})},action:e=>{k.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:t=>{const n=s();Ho.RL({environment:this.environment,annotations:[["d",{...n,date_format:"relative"}]],transaction:t,menuListItemAction:e,query:i,mentionType:n.reminder?"reminder":"date"})}})}}}));return Fa("date",{key:"date results",render:e=>(0,y.jsx)(N.Z,{...e,title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0}),items:o.concat(a)},this.environment,this.theme)}getTemplateVariableMenuItems(e,t){const{templateVariableResults:s}=e,{intl:n}=this.props,i=this.getNormalizedFilter();return s.filter((e=>j.i6A(e,t))).map((e=>({key:e,render:t=>{const s=j.U$y(e,n),i=j.Z08(e,n);return t.focused&&this.setTemporaryInputData({title:s,icon:Da(this.theme.mediumIconColor),allowTabCompletion:!0}),(0,y.jsx)(vt.Z,{...t,title:s,caption:i,inline:!0})},action:t=>{k.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{Ho.RL({environment:this.environment,annotations:[j.WBu({type:e})],transaction:s,menuListItemAction:t,query:i,mentionType:"templateVariable"})}})}})))}getUserResultsMenuSection(e,t){const{userResults:s}=e,n=this.getNormalizedFilter(),i=this.getTemplateVariableMenuItems(e,"user"),o=!s.find((e=>e.email===n))&&la.Z.state.mentionTypes.inviteUser;if(!o&&0===s.length&&0===i.length)return;const a=M.oA(s.map((e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:(0,qo.Nz)(this.props.intl,e),icon:Da(this.theme.mediumIconColor),allowTabCompletion:!0}),(0,y.jsx)(va.Z,{...t,actor:(0,Io.dp)(e),useEmailAsTooltip:!0})),action:t=>{k.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{Ho.RL({environment:this.environment,annotations:[(0,j.tEo)(e.id)],transaction:s,menuListItemAction:t,query:n,mentionType:"user"})}})}})))).concat(o?[{key:"__invite",action:this.handleInviteStart,render:e=>(e.focused&&this.setTemporaryInputData({title:"",icon:Da(this.theme.mediumIconColor),allowTabCompletion:!1}),(0,y.jsx)(vt.Z,{...e,icon:(0,Lo.C)({width:20}),title:n.length>0?(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Invite ”{query}”…",id:"mentionMenu.peopleSection.invitePrompt",values:{query:n}}):(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Invite…",id:"mentionMenu.peopleSection.invitePrompt.empty"})}))}]:[]);return Fa("user",{key:"user results",render:e=>(0,y.jsx)(N.Z,{...e,title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0}),items:i.concat(a)},this.environment,this.theme)}shouldPrioritizeUserSection(e){const{userResults:t}=e,s=this.getNormalizedFilter(),n=this.getTemplateVariableMenuItems(e,"user");return""===s||(t.length>0&&n.length>0||!!(0,Ro.BZ)(s))}getGroupResultsMenuSection(e,t,s){const{groupResults:n}=e;if(0===n.length)return;const i=this.getNormalizedFilter();return Fa("group",{key:"group results",render:e=>(0,y.jsx)(N.Z,{...e,title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:t,isTitleUppercase:!0}),items:M.oA(n.map((e=>{var t;const n=s.formatMessage(ja.groupMentionCaption,{numMembersInGroup:(null===(t=e.user_ids)||void 0===t?void 0:t.length)||0});return{key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:e.name||"",icon:Da(this.theme.mediumIconColor),allowTabCompletion:!0}),(0,y.jsx)(ya.l,{menuListItemProps:{...t,caption:n},group:e})),action:t=>{var s;const n=null===(s=ae.default.state.currentSpaceStore)||void 0===s?void 0:s.id;n&&k.createAndCommit({userAction:"MentionMenu.groupMention",environment:this.environment,perform:s=>{Ho.RL({environment:this.environment,annotations:[j.XIB(e.id,n)],transaction:s,menuListItemAction:t,query:i,mentionType:"group"})}})}}})))},this.environment,this.theme)}getHeaderResultsMenuSection(e,t){const{headingResults:s}=e,n=this.getNormalizedFilter();if(0===s.length)return;const i=(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link to heading",id:"mentionMenu.headerSection.title"})});return Fa("heading",{key:"heading results",render:e=>(0,y.jsx)(N.Z,{...e,title:i,topBorder:t,isTitleUppercase:!0}),items:M.oA(s.map((e=>{const t=Ot.RM();if(!t)return;const s=$t.G.createChildStore(t,{table:qt.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=s.getModel();if(e){const n=e.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Bo.r)(),intl:this.props.intl});this.setTemporaryInputData({title:n||"",icon:(t=this.theme.mediumIconColor,(0,y.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,y.jsx)(ba,{svg:Vo.T,viewBox:Vo.f.__iconViewBox,fill:t})})),allowTabCompletion:!0})}}var t;return(0,y.jsx)(ma.h,{...e,store:s})},action:t=>{k.createAndCommit({userAction:"MentionMenu.getHeaderResultsMenuSection",environment:this.environment,perform:s=>{Ho.RL({environment:this.environment,annotations:[["p",e]],transaction:s,menuListItemAction:t,query:n,mentionType:"heading"})}})}}})))},this.environment,this.theme)}getPageResultsMenuSection(e,t){const{pageResults:s}=e,n=this.getNormalizedFilter(),{device:i}=this.environment,o=i.isSafari||i.isIOS,a=this.environment.currentUser.id,r=(0,y.jsxs)(y.Fragment,{children:[0===s.length?(0,y.jsx)(l.FormattedMessage,{...ja.noResults}):(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}),(0,y.jsx)(Pa,{show:la.Z.state.pageRequestStore.state.loading})]});return 0===s.length?{key:"no page results",render:e=>(0,y.jsx)(N.Z,{...e,title:r,topBorder:t,isTitleUppercase:!0}),items:[]}:Fa("page",{key:"page results",render:e=>(0,y.jsx)(N.Z,{...e,title:r,topBorder:t,isTitleUppercase:!0}),items:M.oA(s.map((e=>{const t=Ot.RF();if(!t)return;const s=$t.G.createChildStore(t,{table:qt.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=s.getModel();if(e){const t=e.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Bo.r)(),intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:Ra(s,this.theme,o,(0,K.e_)(this.environment),a),allowTabCompletion:!0})}}return(0,y.jsx)(Un.Z,{...e,store:s})},action:t=>{k.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:this.environment,perform:s=>{Ho.RL({environment:this.environment,annotations:[["p",e]],transaction:s,menuListItemAction:t,query:n,mentionType:"page"})}})}}})))},this.environment,this.theme)}getCreatePageMenuSection(e){if(!function(){if(!la.Z.state.mentionTypes.createPage)return!1;return!0}())return;const t=la.Z.state;if(!t.open)return;const{intl:s}=this.props,n=this.getNormalizedFilter(),i="@"===t.insertionType?(0,y.jsx)(l.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>(0,y.jsx)(N.Z,{title:i,isTitleUppercase:!0,...t,topBorder:e}),items:[{key:"add new subpage",action:async e=>{const s=bn.gt(t.textStore);s&&await Ho.Br({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:this.getNormalizedFilter(),createInValue:s.createInValue,onPageCreated:e=>{e&&""===j.QaF(e.getTitleValue())&&Qo._({environment:this.environment,store:e,pageVisitSource:Po.tY.Create})},menuListItemAction:e})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?s.formatMessage(Ma.addPage):"",icon:Aa(this.theme.mediumIconColor),allowTabCompletion:!1});const t=t=>(0,y.jsx)(vt.Z,{...(0,te.Z)(t||{},e),icon:(0,ps.R)({width:16}),title:(0,y.jsx)(xa,{pageTitle:this.getNormalizedFilter()})});return this.environment.device.isMobile?t():(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(Sa.Z,{imageURL:Zo.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,y.jsx)(l.FormattedMessage,{...Gn.s.createSubpage})}),placement:ee.ug.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:La,render:e=>{e.focused&&this.setTemporaryInputData({title:0===n.length?s.formatMessage(Ma.addPage):"",icon:Aa(this.theme.mediumIconColor),allowTabCompletion:!1});const t=(0,y.jsx)(fa,{pageTitle:this.getNormalizedFilter()}),i=s=>(0,y.jsx)(vt.Z,{...(0,te.Z)(s||{},e),icon:(0,Oo.J)({width:16}),title:t});return this.environment.device.isMobile?i():(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsx)(Sa.Z,{imageURL:Zo.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,y.jsx)(l.FormattedMessage,{...Gn.s.newPageIn})}),placement:ee.ug.Right,delayThreshold:0,render:e=>i(e)})}}]}}getNormalizedFilter(){const e=this.filterStore.state;return e?la.Z.state.open&&"@"===la.Z.state.insertionType&&this.environment.device.isAndroid&&e.startsWith("@")?e.slice(1).trim():la.Z.state.open&&"[["===la.Z.state.insertionType&&e.endsWith("]]")?e.slice(0,-2).trim():e.trim():""}setTemporaryInputData(e){const t=la.Z.state;if(!t.open)return;if(!e)return void t.temporaryInputData.setState(void 0);const{device:s}=this.environment,{title:n,icon:i,allowTabCompletion:o}=e,a=this.filterStore.state||"",r=n.toLowerCase().startsWith(a)?n.slice(a.length):"";this.tabCompletionString=o?r:void 0;const l=s.isFirefox?void 0:i;t.temporaryInputData.setState({prefix:t.insertionType,suffix:"[["===t.insertionType&&a.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}getCurrentMentionResults(e){const t=la.Z.state,s=t.userRequestStore.state.result||[],n=t.pageRequestStore.state.result||[],i=function(e,t){const s=la.Z.state;if(!s.open)return[];const n=s.mentionTypes.reminder;return s.mentionTypes.date?function(e,t,s){if(0===e.length)return M.oA([{label:s.formatMessage(ja.autocompleteToday),value:()=>_o.Lg((0,Bo.r)())},t?void 0:{label:s.formatMessage(ja.autocompleteNextTuesday),value:()=>{const e=_o.Uu((0,Bo.r)()),t=e.set({weekday:2,hour:15}),s=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:s.toFormat(_o.Iq),start_time:s.toFormat(Rt.jK),time_zone:(0,Bo.r)()}}},t?{label:s.formatMessage(ja.autocompleteReminder),value:()=>({type:"datetime",start_date:_o.Ro((0,Bo.r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:Rt.HZ,defaultTimeZone:(0,Bo.r)()},time_zone:(0,Bo.r)()})}:void 0]);const n=e.normalize("NFKD"),i=t?Ao.parsePersistedDateWithOptionalReminder(n,s):Ao.parsePersistedDate(n,s);if(i){let e=(0,Fo.ZV)({value:i,date_format:"relative",userTimeZone:(0,Bo.r)(),intl:s,allowRelativeDates:!0});return i.reminder&&(e=s.formatMessage(ja.reminder,{dateTime:e})),[{label:e,value:()=>i}]}return[]}(e,n,t).slice(0,6):[]}(this.getNormalizedFilter(),this.props.intl),o=function(e,t,s){const n=Ot.RM();if(!n)return[];const i=e.toLowerCase();return M.oA(s.state.map((e=>{const s=$t.G.createChildStore(n,{table:qt.iU,id:e}),o=s.getModel();if(!o)return;const a=o.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,Bo.r)(),intl:t});return a&&a.toLowerCase().includes(i)?e:void 0})))}(this.getNormalizedFilter(),this.props.intl,this.pageHeaderIdsStore),a=function(e,t){const s=la.Z.state;if(!s.open)return[];if(!s.mentionTypes.templateVariable)return[];return j.XVI(e,t)}(this.getNormalizedFilter(),this.props.intl),r=t.mentionTypes.group?function(e){var t;if(!la.Z.state.open)return[];const s=(null===(t=ae.default.state.currentSpaceStore)||void 0===t?void 0:t.getPermissionGroups())||[];return(0,Do.ZP)(e,s,(e=>e.name||""))}(this.getNormalizedFilter()):[];let l=n;const{result:d}=this.stores.localPageMentionRequestStore.state;if(d&&!d.error){const e=d.value.results,t=Ot.RM();l=t?Yo.oO({localResults:e,serverResults:n.map(((e,s)=>({...e,serverEventProperties:void 0,originalPosition:s,store:$t.G.createChildStore(t,{table:qt.iU,id:e.id})})))})||[]:e}let c;c=this.getNormalizedFilter()?l.map((e=>e.id)):Wn.X4.state.map((e=>e.pageId));const u=t.userRequestStore.state.ready&&t.pageRequestStore.state.ready;return u&&ea.default.measure(e,{environment:this.environment}),{headingResults:o,userResults:s,groupResults:r,pageResults:c,dateResults:i,templateVariableResults:a,ready:u}}shouldCaptureBackspace(){return""===this.filterStore.state}getMenuInitialFocus(){if(""!==this.getNormalizedFilter())return 0}}wa.displayName="MentionMenu";const Ca=(0,l.injectIntl)(wa);function ka(e){const t=la.Z.state;t.open&&la.Z.setState({...t,...e})}function Ta(){return"comment"===Ho.WI()?"comment_mention":"inline_mention"}function Ia(){return(0,Ae.bq)()?400:330}function Pa(e){let{show:t}=e;return(0,y.jsx)(gn.Z,{show:t,showDelay:500,showHold:300,render:e=>(0,y.jsx)(Ms.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}function Za(e){const{device:t}=e;return t.isMobileNative&&!t.isTablet}function Fa(e,t,s,n){const i=la.Z.state;if(!i.open)return t;if(i.expandSection&&i.expandSection===e)return t;const{items:o}=t,a=s.device.isPhone||"heading"===e?3:5;if(o.length<=a)return t;const r=[...o.slice(0,a),{key:"show more",render:e=>(0,y.jsx)(vt.Z,{...e,icon:(0,No.o)({width:16,fill:n.mediumTextColor}),title:(0,y.jsx)("span",{style:{color:n.mediumTextColor},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:o.length-a}})})}),action:()=>{ka({expandSection:e})}}];return{...t,items:r}}function _a(){if(!ia.default.checkGate("mention_menu_page_headings"))return[];const e=function(){const e=Ot.RM();if(!e)return;const{mainEditorCurrentBlockStore:t}=ae.default.state;return e===t?t:ca.default.peekTarget.state===e?ca.default.peekTarget.state:void 0}();if(!e)return[];const t=ia.default.checkGate("toc_nested_headings");return Ko.Q(e.id,e.getRecordModel,t)}function Aa(e){return(0,y.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,y.jsx)(ba,{svg:ps.s,viewBox:ps.R.__iconViewBox,fill:e})})}function Ra(e,t,s,n,i){return(0,zo.tp)({pageModel:e.getModel(),pageRole:e.getRole(),showEmojiInline:!0,emojiType:n,baseUrl:Qt.default.domainBaseUrl,getRecordModel:e.getRecordModel,isClient:!0,isSafariOrIOS:s,currentUserId:i,theme:t,emojiData:z.Z.state})}function Da(e){return(0,y.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,y.jsx)(ba,{svg:Eo.Q,viewBox:Eo.p.__iconViewBox,fill:e})})}function Ba(e){ka({createInQuery:e})}function La(){ka({showCreateIn:!0})}function Oa(){ka({showCreateIn:!1,createInQuery:""})}function Ea(e){const t=la.Z.state;if(t.open)return"+"===t.insertionType?Aa(e.mediumIconColor):(0,y.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,y.jsx)(ba,{svg:ri.T,viewBox:ri.R.__iconViewBox,fill:e.mediumIconColor})})}var Na=s(42239);class Va extends b.Z{constructor(){super(...arguments),this.cancelDragTimeout=void 0,this.handleDragOver=e=>{e.preventDefault(),function(e,t){Na.f$(t,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0})&&xs.ZH(t)}(e,this.environment),this.continueDragThrottled(e)},this.continueDrag=e=>{this.cancelDragTimeout&&window.clearTimeout(this.cancelDragTimeout),this.cancelDragTimeout=window.setTimeout(Ka,function(e){const{device:t}=e;return t.isLinux?2e3:200}(this.environment),this.environment),Na.td(this.environment,{currentX:e.clientX,currentY:e.clientY})},this.continueDragThrottled=M.P2(this.continueDrag,Wa)}didMount(){super.didMount(),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",(e=>za(e,this.environment)))}willUnmount(){super.willUnmount(),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",(e=>za(e,this.environment)))}}Va.displayName="NativeDragHandler";const Ua=Va,Wa=62.5;function Ka(e){Na.cQ(e)}function za(e,t){e.preventDefault();const s=Array.from(e.dataTransfer.files);s.length>0&&Na._4({environment:t,files:s,analyticsFrom:"native_drag"})}var qa=s(40902),Ga=s(65311),Ha=s(19719),Qa=s(8055),Ya=s(50770),$a=s(19034),Ja=s(12252);class Xa extends b.Z{constructor(){super(...arguments),this.lastEmitValue=-1,this.lastSentBadgeNumber=void 0,this.lastSentCurrentSpaceBadgeNumber=void 0,this.handleNotificationEmit=async(e,t)=>{if(t===this.lastEmitValue)return;if(this.lastEmitValue=t,!function(e){if(0===$a.Z.state.results.length)return!0;if(!document.hasFocus())return!0;if(!e.includes("unreadCount"))return!0;return!1}(String(t)))return;const s=(0,Ya.H)(),n=await Oe.getUserNotifications(this.environment,{size:1e3,isInboxV2:s});if("failed"===n.type)return;const{results:i}=n.data;$a.Z.setState({results:i}),this.syncInitialBadgeNumber();const o=M.G0.apply(null,i.map((e=>e.unreceived.notificationIds)));for(const a of o)sr(a,this.props.rootStore,this.props.intl,this.environment)},this.handleNotificationEmitThrottled=M.P2(this.handleNotificationEmit,1e3),this.handleNotificationEmitWhenActive=(e,t)=>{Ja.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))},this.listenerReference=void 0,this.updateBadgeNumbers=()=>{const{mobileNative:e}=this.environment,{allSpaces:t,currentSpace:s}=tr();e&&(t===this.lastSentBadgeNumber&&s===this.lastSentCurrentSpaceBadgeNumber||e.setBadgeNumber(t,s),this.lastSentCurrentSpaceBadgeNumber=s),t!==this.lastSentBadgeNumber&&(t>0?a.setBadge(`${t}`):a.setBadge("")),this.lastSentBadgeNumber=t},this.syncInitialBadgeNumber=M.IH(this.updateBadgeNumbers)}UNSAFE_willMount(){this.startMessageListeners(),$a.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&ae.default.addListener(this.updateBadgeNumbers)}didUpdate(e){e.rootStore.userId!==this.props.rootStore.userId&&(this.stopMessageListeners(),this.startMessageListeners(),this.handleNotificationEmit("initializeListener",-1))}willUnmount(){this.stopMessageListeners(),$a.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&ae.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=ae.default.state;if(e){const t=(0,Ke.Lp)(e.id);this.listenerReference=ze.Z.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&ze.Z.removeListener(this.listenerReference,this.environment)}}Xa.displayName="NotificationListener";const er=(0,l.injectIntl)(Xa);function tr(){return{allSpaces:$a.Z.getTotalUnreadMentionsCount(),currentSpace:$a.Z.getUnreadCountForCurrentSpace().mentions}}async function sr(e,t,s,n){const i=(0,$t.Kv)(t,{table:Ga.uX,id:e});await i.load();const o=i.getValue();if(!o)return;const r=(0,nt.No)(i,o.activity_id,o.space_id);await r.load();const l=r.getModel(),{currentUserStore:d,currentSpaceViewStore:c}=ae.default.state;if(d&&c&&l&&!l.invalid&&!qa.BX(l,d.id)&&await a.isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await c.load(),!c.isDefined())return;if(!l.isMentionType())return;if(!c.getNotifyDesktop())return;if(!n.device.isDesktop)return;const e=(0,(await g.deps.desktop.loader()).Notification)({activity:l,getRecordValue:i.getRecordValue,userTimeZone:(0,Bo.r)(),intl:s,pageVisitSource:Po.tY.PushNotification});if(!e)return;const{subject:t,body:o}=e,a=new Notification(t,{body:o,silent:!0}),d=qa.Fb(l.type),u={medium:"desktop_push",type:d,badge_number:tr().allSpaces,notification_id:i.id,activity_id:r.id},m=e=>Ha.b2({environment:n,args:u,action:e});m("sent"),a.addEventListener("show",(()=>m("shown"))),a.addEventListener("close",(()=>m("closed"))),a.addEventListener("click",(()=>{const e=qa.hY({activity:l,getRecordModel:i.getRecordModel,baseUrl:Qt.default.domainBaseUrl,pageVisitSource:Po.tY.PushNotification}),t=(0,Po.k6)(e,[d,"desktop_push"],Po.tY.PushNotification);Qa.c4({environment:n,url:t}),m("clicked")}))}}var nr=s(35683),ir=s(89224),or=s(58261);class ar extends b.Z{constructor(){super(...arguments),this.renderTooltip=()=>(0,y.jsx)(X.Z,{capture:!0,onEnter:this.handleEnter,onCommandEnter:this.handleCommandEnter,children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,y.jsx)("div",{children:(0,y.jsx)(or.Z,{onlyShowFirst:!0,name:"enter",style:{color:this.theme.mediumInvertedTextColor}})})]})}),this.handleEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:s,store:n}=t;if(!s)return;e.preventDefault&&e.preventDefault();const i=$t.G.createChildStore(n,{table:qt.iU,id:s});Qo._({store:i,environment:this.environment,visitType:nr.vu.Link,pageVisitSource:Po.tY.MentionInPage})},this.handleCommandEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:s,store:n}=t;if(!s)return;e.preventDefault();const i=$t.G.createChildStore(n,{table:qt.iU,id:s});Qo._({store:i,environment:this.environment,visitType:nr.vu.Link,openInNew:"tab",pageVisitSource:Po.tY.MentionInPage})},this.pageMentionTokenStore=this.createComputedStore((()=>{const e=P.default.state;if("editing"!==e.mode)return;const t=(0,T.QY)(e.multiSelection);if(!t)return;const{store:s,selection:n}=t;if(n.endIndex!==n.startIndex+1)return;const i=s.getValue(),o=j.b1T(i,n.startIndex);if(!o||!j.eOb(o))return;const[a]=j.jDe([o]);return{pageId:a,store:s}}))}renderComponent(){if(this.environment.device.isMobile)return;const e=ir.getSelectionRect(),t=this.pageMentionTokenStore.state;return(0,y.jsx)(ee.ZP,{render:()=>{},renderTooltip:this.renderTooltip,originRect:e,forceVisibleState:Boolean(t&&e),placement:ee.ug.Bottom})}}ar.displayName="PageMentionOverlay";const rr=ar;var lr=s(43008),dr=s(98104),cr=s(64951);class ur extends b.Z{renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:s}=cr.Z.state;return(0,y.jsx)(u.ZP,{popupType:e.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:Boolean(t),originRect:s,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Center,originGap:4,onDismiss:()=>lr.x(this.environment),render:()=>(0,y.jsx)(pr,{})})}}ur.displayName="RenameFileMenuPopup";class mr extends b.Z{didMount(){const{blockStore:e}=cr.Z.state;if(!e)return;const t=e.getTitleStore();t&&dr.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=cr.Z.state;if(!t)return;const s=t.getTitleStore();if(!s)return;let n;return n=e.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:380},(0,y.jsx)(c.Z,{...n,children:(0,y.jsx)("div",{style:(i=this.theme,{display:"flex",alignItems:"center",color:i.regularTextColor,fontSize:"13px",padding:"4px 8px"}),children:(0,y.jsx)(fi.Z,{store:s,disabled:!t.canEdit(),onEsc:()=>lr.x(this.environment),onEnter:()=>lr.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:hr(this.theme),pasteBehavior:"inline"})})});var i}}mr.displayName="LocalizableRenameFileMenu";const pr=(0,l.injectIntl)(mr),gr=ur;function hr(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}var fr=s(9953),xr=s(52771),yr=s(82187),Sr=s(31278);class vr extends b.Z{renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t,originRect:s}=yr.Z.state;return(0,y.jsx)(u.ZP,{popupType:e.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:Boolean(t),originRect:s,placementToOrigin:u.ZP.Placement.Bottom,alignmentToOrigin:u.ZP.Alignment.Center,originGap:4,onDismiss:()=>xr.x(this.environment),render:()=>(0,y.jsx)(kr,{})})}}vr.displayName="RenamePageMenuPopup";class br extends b.Z{didMount(){const{clonedBlockStore:e}=yr.Z.state;if(!e)return;const t=e.getTitleStore();t&&dr.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t}=yr.Z.state;if(!t)return;const s=t.getTitleStore();if(!s)return;const{renderDelete:n}=this.props;let i;return i=e.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:380},(0,y.jsx)(c.Z,{...i,children:(0,y.jsxs)("div",{style:(o=this.theme,{display:"flex",alignItems:"center",color:o.regularTextColor,fontSize:"13px",padding:"4px 8px"}),children:[(0,y.jsx)(Ir,{blockStore:t}),(0,y.jsx)(fi.Z,{store:s,disabled:!t.canEdit(),onEsc:()=>xr.x(this.environment),onEnter:()=>xr.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,placeholder:wr(this.props.intl),style:Tr(this.theme),pasteBehavior:"inline"}),n&&t.canEdit()&&(0,y.jsx)(Cr,{})]})});var o}}br.displayName="LocalizableRenamePageMenu";const Mr=(0,l.injectIntl)(br),jr=vr;function wr(e){const{clonedBlockStore:t}=yr.Z.state;if(null!=t&&t.isDefined())return t.getModel().getEmptyTitlePlaceholder({getRecordModel:t.getRecordModel,userTimeZone:(0,Bo.r)(),intl:e})}function Cr(){window.__c={n:"DeleteButton"};const e=(0,i.O7)();return(0,y.jsx)(Ii.Z,{icon:e=>(0,Kn.y)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:t}=yr.Z.state;t&&await fs.Qw({environment:e,blocks:[t]}),xr.x(e)}})}function kr(){window.__c={n:"PopupContentComponent"};const{renderDelete:e}=(0,o.VK)((()=>yr.Z.state),[]);return(0,y.jsx)(Mr,{renderDelete:Boolean(e)})}function Tr(e){return{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}function Ir(e){let{blockStore:t}=e;window.__c={n:"IconComponent"};const s=(0,et.Fg)(),n=(0,i.O7)(),a={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${s.darkDividerColor}`},r=(0,o.VK)((()=>t.canEdit()),[t]),l=(0,o.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.table}),[t]),d=(0,o.VK)((()=>{var e;return null===(e=t.getIconStore())||void 0===e?void 0:e.id}),[t]),c=(0,o.VK)((()=>t.getIcon()),[t]),u=(0,o.VK)((()=>t.isEmptyPage()),[t]),m=(0,o.VK)((()=>t.getType()),[t]);return r?(0,y.jsx)(Sr.Z,{disabled:!1,bucket:"secure",store:t,icon:c,isEmptyPage:u,size:18,style:a,iconLoggingData:{recordTable:l,source:"breadcrumb",block_type:m,collection_id:"collection"===l?d:void 0},onChange:e=>function(e,t){const{clonedBlockStore:s}=yr.Z.state;if(s){const n=s.getIconStore();n&&k.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:t,perform:t=>{fr.sO({store:n,value:e,transaction:t})}})}}(e,n)}):(0,y.jsx)(Sr.Z,{disabled:!0,icon:c,isEmptyPage:u,size:18,style:a})}var Pr=s(42853),Zr=s(9107),Fr=s(69634),_r=s(22962),Ar=s(6287),Rr=s(80503),Dr=s(11732),Br=s(56863),Lr=s(92022),Or=s(49117),Er=s(19124),Nr=s(40959),Vr=s(87078),Ur=s(45162),Wr=s(67669),Kr=s(35328),zr=s(15723),qr=s(45214),Gr=s(17903),Hr=s(4548),Qr=s(42057),Yr=s(49557),$r=s(4935),Jr=s(99757),Xr=s(13966),el=s(48019),tl=s(64131),sl=s(82945),nl=s(40464),il=s(32404),ol=s(73383);const al={[tt.Ti.code]:new Set(["showMention","showCode","showCompletions"]),[tt.Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[tt.Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},rl={[tt.Ti.factory]:!0};class ll extends b.Z{constructor(){super(...arguments),this.mouseIsDownExternally=!1,this.lastRenderState=void 0,this.completionContextOnOpen=void 0,this.renderOverlay=()=>{const{isActive:e}=Yr.Z.state;return(0,y.jsx)(bs.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:{stiffness:100,damping:10,precision:1e-4}},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})},this.renderAnimated=()=>{const{top:e,left:t}=Yr.Z.state,s=this.canOnlyDiscussStore.state,n=Math.max(s?t:t-60,0),i=s?"12px 0":12;return(0,y.jsxs)("div",{className:m.Qcf,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"},children:[(0,y.jsx)("div",{style:{flexShrink:1,width:n,minWidth:24}}),(0,ys.Z)((e=>(0,y.jsx)("div",{style:{pointerEvents:"none",padding:i},...e,children:this.lastRenderState&&(0,y.jsx)(jl,{renderState:this.lastRenderState})}))),(0,y.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})},this.updateRichTextState=()=>{const e=Yr.Z.state;if(In.Z.state.open||$r.Z.state.open)return;if(Jr.n.state)return Br.w();const t=P.default.state;if("empty"===t.mode)return Br.w();const s=(0,Ur.L5)(t.multiSelection);if(0===s.length)return Br.w();if(!s.every((e=>{let{store:t}=e;return t.table===qt.iU||t.table===Js.x_||t.table===Ar.v})))return Br.w();if(!this.environment.currentUser.isLoggedIn()||!s.every((e=>{let{store:t}=e;return t.canComment()})))return;const n=ir.get();if(Ot.JE())return Br.w();if(s.some((e=>{let{editable:t}=e;return t.props.disableStyleAnnotations})))return Br.w();const i=s.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(i.some(((e,t)=>{const n=s[t].store.canComment(),i=s[t].store.table===Js.x_&&s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!n||i})))return Br.w();if(this.mouseIsDownExternally&&e.blockTarget!==i[0])return Br.w();const o=s.some((e=>{let{store:t}=e;const s=t.getRecordStoreAtRootPath();if(!(s instanceof $t.G))return!1;const n=s.getValue();return!!n&&rl[n.type]}));if(o)return Br.w();const a=n?ir.getRect(n):void 0;if(a&&!zr.kK(a,(0,Vr.Z)()))return Br.w();if(yr.Z.isActive()||cr.Z.isActive()||on.Z.isOpen()||o||!n||!function(){const e=ir.get();return!!e&&!e.collapsed&&"empty"!==P.default.state.mode&&!(0,T.iG)(P.default.state.multiSelection)}()||qr.Z.state.open)return Br.w();let r=0,l=0;if(a){r=a.left;const e=25,t=a.top-32-e,s=Rr.R6(this.environment.device.isElectronMac),n=this.environment.WindowSizeStore.state.height-32-e;l=Math.min(Math.max(t,s),n)}0===Math.abs(Yr.Z.state.top-l)&&Math.abs(Yr.Z.state.left-r)<10&&(l=Yr.Z.state.top,r=Yr.Z.state.left),Yr.Z.setState({...Yr.Z.state,isActive:!0,isAnimatingClosed:!1,top:l,left:r,blockTarget:St.default.state.stores[0]})},this.updateRichTextStateThrottled=M.P2(this.updateRichTextState,200,{leading:!1}),this.handleAnimationEnd=()=>{Yr.Z.state.isActive||Yr.Z.setState({...Yr.Z.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state},this.renderStateStore=this.createComputedStore((()=>{const{isActive:e,blockTarget:t}=Yr.Z.state,s=P.default.state;if(!e||"empty"===s.mode)return;const{multiSelection:n}=s,i=(0,Ur.L5)(n),o=i.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),a=(0,T.qS)(n),r=P.default.isEditingComment(),l=P.default.isEditingCaption(),d=t&&t.getParentTable()===Ar.v,c=a&&t&&n.start.store===t.getCollectionViewSourceDescriptionStore(),u=this.pageContext&&this.pageContext.publicEditModeStore.state,m=!(0,Wr.YF)(u)&&(n.start.store.canEdit()&&n.end.store.canEdit()),p=o.some(((e,t)=>{const s=i[t].store.table===Js.x_&&!i[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!s})),g=m&&!p,h=t&&t.getType(),f=h&&al[h],x=null==t?void 0:t.isType("button"),y=(0,Or.td)(n.start.store)||(0,Or.td)(n.end.store),S={isSingleStoreSelection:a,showTurnInto:Boolean(a&&!r&&!d&&!c&&!l&&t&&g&&!x),showBold:Boolean(g),showItalic:Boolean(g),showStrikethrough:Boolean(g),showUnderline:Boolean(g),showCode:Boolean(g),showLink:Boolean(a&&g),showHighlight:Boolean(g),showDiscuss:Boolean(!r&&t&&!d&&!c&&!y),showEquation:Boolean(a&&g),showMention:Boolean(a&&!r&&t&&!d&&g),showActionButton:Boolean(a&&!r&&!l&&t&&!d),blockTarget:t,isComment:r,showCompletions:Boolean((0,Er.GD)(u)&&g&&!r&&!l&&t&&!d&&!c&&!x&&!y)};if(f&&f.size>0)for(const v of f)S[v]=!1;return S})),this.canOnlyDiscussStore=this.createComputedStore((()=>{const e=this.renderStateStore.state;return e&&e.showDiscuss&&!e.showBold}))}didMount(){St.default.addListener(this.updateRichTextStateThrottled),P.default.addListener(this.updateRichTextStateThrottled),Gr.Z.addListener(this.updateRichTextState),Qr.Z.addListener(this.updateRichTextState),Hr.Z.addListener(this.updateRichTextState)}willUnmount(){P.default.removeListener(this.updateRichTextStateThrottled),St.default.removeListener(this.updateRichTextStateThrottled),Gr.Z.removeListener(this.updateRichTextState),Qr.Z.removeListener(this.updateRichTextState),Hr.Z.removeListener(this.updateRichTextState)}UNSAFE_willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=Yr.Z.state;return(0,y.jsx)(js.Z,{open:e||t,children:this.renderOverlay()})}}ll.displayName="RichTextMenu";const dl=(0,l.injectIntl)(ll);function cl(e){return{boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1}}function ul(e){let{blockStore:t}=e;window.__c={n:"TurnIntoComponent"};const s=(0,et.Fg)(),n=(0,i.O7)(),a=(0,l.useIntl)();let r=(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const d=(0,o.VK)((()=>t.getType()),[t]);if(d){const e=Nr.Hc[d];r=e&&e.displayName||r}return(0,y.jsx)($.ZP,{popupType:$.Z4.Popup,buttonPopupStore:$r.Z,originGap:4,renderOrigin:e=>(0,y.jsx)(ee.ZP,{renderTooltip:()=>a.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:t=>(0,y.jsxs)(Y.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...cl(s)},...(0,te.Z)(e,t),children:[r,(0,Pr.i)({width:10,marginLeft:4,fill:s.lightIconColor})]})}),render:()=>(0,y.jsx)(c.Z,{menuType:p.og.Popup,children:(0,y.jsx)(el.Z,{context:{blocks:[t],environment:n,publicEditMode:void 0},sections:[Dr.g],onAccept:e=>{const s=t.getType(),i=t.getFormat();Br.w(),w.dhV(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"rich_text_menu",block_id:t.id,block_type:s,is_toggleable:s?(0,Kr._A)(s,i):void 0})}})}),onClick:()=>{w.mt_(n,{action:"turn_into"})}})}function ml(){window.__c={n:"BoldButtonComponent"};const e=(0,et.Fg)();return(0,y.jsx)(nl.Z,{type:"b",tooltipLabel:(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(or.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleBold"})})]}),children:(0,y.jsx)("span",{style:{fontWeight:ga.Z.fontWeight.semibold},children:"B"})})}function pl(){window.__c={n:"ItalicButtonComponent"};const e=(0,et.Fg)();return(0,y.jsx)(nl.Z,{type:"i",tooltipLabel:(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(or.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleItalics"})})]}),children:(0,y.jsx)("span",{style:{fontStyle:"italic"},children:"i"})})}function gl(){window.__c={n:"StrikethroughButtonComponent"};const e=(0,et.Fg)();return(0,y.jsx)(nl.Z,{type:"s",tooltipLabel:(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(or.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleStrike"})})]}),children:(0,y.jsx)("span",{style:{textDecoration:"line-through"},children:"S"})})}function hl(){window.__c={n:"UnderlineButtonComponent"};const e=(0,et.Fg)();return(0,y.jsx)(nl.Z,{type:"_",tooltipLabel:(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(or.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleUnderline"})})]}),children:(0,y.jsx)("span",{style:{textDecoration:"underline"},children:"U"})})}function fl(){window.__c={n:"CodeButtonComponent"};const e=(0,et.Fg)();return(0,y.jsx)(nl.Z,{type:"c",style:{padding:"0 6px"},tooltipLabel:(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(or.Z,{style:{color:e.mediumInvertedTextColor},name:"toggleCode"})})]}),children:(0,Zr.z)({width:15,height:15})})}function xl(e){let{enableInlinePageCreationFeature:t}=e;window.__c={n:"LinkButtonComponent"};const s=(0,et.Fg)(),n=(0,i.O7)().device.isMobile;return(0,y.jsxs)(ol.Z,{style:cl(s),children:[t&&(0,Oo.J)({width:n?18:16,height:n?18:16,marginRight:4,fill:s.regularIconColor}),(0,y.jsx)("span",{style:{borderBottom:`1px solid ${s.linkDecorationColor}`},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})})]})}function yl(e){let{intl:t}=e;window.__c={n:"CompletionsButtonComponent"};const s=(0,et.Fg)(),n=(0,i.O7)();return(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{children:t.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(or.Z,{style:{color:s.mediumInvertedTextColor},name:"commandJ"})})]}),render:e=>(0,y.jsxs)(Y.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...cl(s)},...e,onClick:()=>{(0,Lr.toggleInitialPrompt)({from:"rich_text_menu",environment:n}),w.mt_(n,{action:"completions"})},children:[(0,di.t)({width:16,height:16,fill:_.FN.light.purple[400],marginRight:4}),(0,y.jsx)("span",{style:{color:_.FN.light.purple[400],fontWeight:500},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})}function Sl(){window.__c={n:"EquationButtonComponent"};const e=(0,et.Fg)(),t=(0,i.O7)();return(0,y.jsx)(il.Z,{style:cl(e),onClick:()=>{w.mt_(t,{action:"e"}),Br.w()},children:(0,Fr.G)({width:16,height:16})})}function vl(){window.__c={n:"MentionComponent"};const e=(0,et.Fg)(),t=(0,i.O7)();return(0,y.jsx)(ee.ZP,{renderTooltip:()=>(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:(0,y.jsx)("br",{})}})}),(0,y.jsx)("div",{style:{color:e.mediumInvertedTextColor},children:"@"})]}),render:s=>(0,y.jsx)(Y.Z,{style:{...cl(e),padding:"0 8px"},...s,onClick:()=>{Ho.lZ(t,{page:!0,heading:!0,createPage:!0,user:!0,inviteUser:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}),w.mt_(t,{action:"mention"})},children:(0,_r.O)({width:14,fill:e.regularTextColor})})})}function bl(e){let{blockTarget:t}=e;window.__c={n:"CommentButtonComponent"};const s=(0,et.Fg)();return(0,y.jsx)(sl.Z,{style:cl(s),blockStore:t})}function Ml(e){let{target:t}=e;window.__c={n:"ActionButtonComponent"};const s=(0,et.Fg)(),n=(0,i.O7)();return(0,y.jsx)(Xr.Z,{store:t,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:s.regularTextColor},fadeIn:!1,onClick:()=>{w.mt_(n,{action:"more"})}})}function jl(e){let{renderState:t}=e;window.__c={n:"MenuComponent"};const s=(0,l.useIntl)(),n=(0,et.Fg)(),{isActive:i}=(0,o.VK)((()=>Yr.Z.state),[]);return(0,y.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:32,background:n.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:5,boxShadow:n.mediumBoxShadow,pointerEvents:i?"auto":"none"},onMouseDown:e=>e.preventDefault(),children:[t.showCompletions&&(0,y.jsx)(yl,{intl:s}),t.showTurnInto&&t.blockTarget&&(0,y.jsx)(ul,{blockStore:t.blockTarget}),t.showLink&&(0,y.jsx)(xl,{enableInlinePageCreationFeature:!0}),t.showDiscuss&&t.blockTarget&&(0,y.jsx)(bl,{blockTarget:t.blockTarget}),(0,y.jsxs)("div",{style:{display:"flex"},children:[t.showBold&&(0,y.jsx)(ml,{}),t.showItalic&&(0,y.jsx)(pl,{}),t.showUnderline&&(0,y.jsx)(hl,{}),t.showStrikethrough&&(0,y.jsx)(gl,{}),t.showCode&&(0,y.jsx)(fl,{}),t.showEquation&&(0,y.jsx)(Sl,{})]}),t.showHighlight&&(0,y.jsx)(tl.Z,{style:cl(n)}),t.showMention&&(0,y.jsx)(vl,{}),t.showActionButton&&t.blockTarget&&(0,y.jsx)(Ml,{target:t.blockTarget})]})}s(21703);var wl=s(1302),Cl=s(14248),kl=s(14714),Tl=s(29369),Il=s(40663),Pl=s(19037),Zl=s(78316),Fl=s(79954),_l=s(55367),Al=s(12211),Rl=s(50628);const Dl=200;var Bl=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(Bl||{});function Ll(e){return e.type===Bl.Selectable?{type:_l.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:_l.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function Ol(e){const{target:t,device:s,direction:n,points:i}=e;return n===_l.vh.Onto||!s.isPhone||t.props.dropzoneShouldNeverUseOrigin?i.mousePoint:{x:i.originPoint.x,y:i.mousePoint.y}}function El(e){return e instanceof Fl.Z?{type:Bl.Selectable,target:e}:{type:Bl.DropTarget,target:e}}function Nl(e){if(!(e&&e instanceof Fl.Z))return!1;let t=e;const s=_l.ZP.state;if(!s.isDragging)return!1;const{draggedStores:n}=s;for(;t;){if(n.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Vl(e){const{dropzoneMustBeWithinHorizontalBound:t,device:s}=e;return t?0:s.isPhone?9999:0}function Ul(e){switch(e.direction){case _l.vh.Onto:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,canAcceptDrop:r}=e,l=_l.vh.Onto,d=Ol({device:t,target:i,direction:l,points:o});if((s?i.props.canNativeDropOnto:i.props.canDropOnto)&&Kl(d,n)&&!Nl(i)&&r(i,l))return{...El(i),direction:l,left:n.left,top:n.top,width:n.width,height:n.height,priority:a}}(e);case _l.vh.Left:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=_l.vh.Left,c=Ol({device:t,target:i,direction:d,points:o});if((s?i.props.canNativeDropLeft:i.props.canDropLeft)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.left)<=200&&(r||!Nl(i))&&l(i,d))return{...El(i),direction:d,left:n.left,top:n.top,width:0,height:n.height,priority:a}}(e);case _l.vh.Right:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=_l.vh.Right,c=Ol({device:t,target:i,direction:d,points:o});if((s?i.props.canNativeDropRight:i.props.canDropRight)&&n&&c.y>=n.top&&c.y<=n.bottom&&Math.abs(c.x-n.right)<=Dl&&(r||!Nl(i))&&l(i,d))return{...El(i),direction:d,left:n.right,top:n.top,width:0,height:n.height,priority:a}}(e);case _l.vh.Above:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Vl({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=_l.vh.Above,u=Ol({device:t,target:i,direction:c,points:o});if((s?i.props.canNativeDropAbove:i.props.canDropAbove)&&n&&u.x>=n.left-14-d&&u.x<=n.right+d&&(r||!Nl(i))&&l(i,c))return{...El(i),direction:c,left:n.left,top:n.top,width:n.width,height:0,priority:a}}(e);case _l.vh.Below:return function(e){const{device:t,isNativeDrag:s,rect:n,target:i,points:o,priority:a,optionKeyDown:r,canAcceptDrop:l}=e,d=Vl({dropzoneMustBeWithinHorizontalBound:i.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=_l.vh.Below,u=Ol({device:t,target:i,direction:c,points:o});if((s?i.props.canNativeDropBelow:i.props.canDropBelow)&&n&&u.x>=n.left-14-d&&u.x<=n.right+d&&(r||!Nl(i))&&l(i,_l.vh.Below))return{...El(i),direction:_l.vh.Below,left:n.left,top:n.bottom,width:n.width,height:0,priority:a}}(e)}}function Wl(e){const{device:t,rect:s,target:n,points:i,optionKeyDown:o}=e;return Kl(Ol({device:t,target:n,direction:_l.vh.Onto,points:i}),s)&&Nl(n)&&!o}function Kl(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var zl=s(28314),ql=s(75770),Gl=s(35026),Hl=s(17031),Ql=s(27406),Yl=s(81844),$l=s(16339),Jl=s(95802),Xl=s(91681),ed=s(86486);class td extends b.Z{constructor(){super(...arguments),this.isUpdatingDragState=!1,this.didTouchEnd=!1,this.lastMouseInfo=void 0,this.handleWindowMouseMove=e=>{const t=ed.default.state;if(!e||t.isOpen&&t.menuIsOpen||(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY}),this.didTouchEnd)return void(this.didTouchEnd=!1);const{isDragging:s}=_l.ZP.state;if(s)this.updateDragState();else{if(!this.lastMouseInfo)return;od(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}},this.handleDragBlockStoreChange=()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)},this.handleWindowMouseMoveThrottled=M.P2((e=>Vn.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60),this.handleSelectionChange=()=>{const{isDragging:e}=_l.ZP.state;wl.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&od(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))},this.handleSelectionChangeThrottled=M.P2(this.handleSelectionChange,60),this.handleWindowKeyEvent=()=>{const{isDragging:e}=_l.ZP.state;e&&this.updateDragState()},this.handleWindowTouchEnd=()=>{this.didTouchEnd=!0},this.memoizedCanDragCache=new WeakMap,this.memoizedCanDrag=e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const s=(0,Pl.OO)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,s),s}}didMount(){super.didMount();const{device:e}=this.environment;hn.lj(window,"mousemove",this.handleWindowMouseMoveThrottled),St.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&hn.lj(window,"touchend",this.handleWindowTouchEnd),hn.lj(window,"keydown",this.handleWindowKeyEvent),hn.lj(window,"keyup",this.handleWindowKeyEvent),_l.ZP.addListener(this.handleDragBlockStoreChange),hn.lj(window,"scroll",ld,!0),hn.lj(window,"resize",dd),Ot.kw.addListener(cd),xs.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;hn.ZV(window,"mousemove",this.handleWindowMouseMoveThrottled),St.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&hn.ZV(window,"touchend",this.handleWindowTouchEnd),hn.ZV(window,"keydown",this.handleWindowKeyEvent),hn.ZV(window,"keyup",this.handleWindowKeyEvent),_l.ZP.removeListener(this.handleDragBlockStoreChange),hn.ZV(window,"scroll",ld,!0),hn.ZV(window,"resize",dd),Ot.kw.removeListener(cd)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=_l.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:s,currentY:n,offsetX:i,offsetY:o,isNativeDrag:a}=e,r={x:s,y:n},l={x:s-i,y:n-o},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],a);if(d.ontoDropZone)_l.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)_l.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],s=M.Gb(d.horizontalDropZones);if(t.type===_l.Dl.Selectable){const n=Jl.C.findSelectableFromStore(t.store);if(n){const i=n.getContextClosestSelectable();let o;return i&&i.props.store!==t.store&&i.props.shouldShowParentHalo&&(o=i.props.store),void _l.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:o})}}else{if(Ql.Z.findDropTargetFromKey(t.key))return void _l.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:void 0})}}_l.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}findNearbyDropZones(e,t,s){const{device:n}=this.environment,i=zl.yA(),o=function(){const{selectableRectMap:e}=Rl.Z.state,{dropTargetRectMap:t}=Al.Z.state,s=new Map;return e.forEach(((e,t)=>{s.set(t,e)})),t.forEach(((e,t)=>{s.set(t,e)})),s}(),a=o.keys();let r=a.next();const l=Jl.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=a.next();const l=o.get(t),u=t.getContextSelectableContainer();if(n.isPhone&&u!==d)continue;if(!u||u.props.disable)continue;const m=id(u),p={device:this.environment.device,isNativeDrag:s,rect:l,target:t,points:e,priority:m,optionKeyDown:i.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t,i.option)};if(Wl(p))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...M.oA([Ul({...p,direction:_l.vh.Onto}),Ul({...p,direction:_l.vh.Left}),Ul({...p,direction:_l.vh.Right}),Ul({...p,direction:_l.vh.Above}),Ul({...p,direction:_l.vh.Below})]))}c=function(e){const t=rd(M.UT(e,rd));return e.filter((e=>rd(e)===t))}(c);const u=c.filter((e=>e.direction===_l.vh.Above||e.direction===_l.vh.Below)),m=M.F(u,(t=>Math.abs(t.top-ad(t,e,this.environment).y)));let p=u.filter((e=>{let{top:t}=e;return Math.abs(t-(m?m.top:0))<=2}));if(p.length>1){p=p.filter((t=>{const s=ad(t,e,this.environment).x,n=Vl({device:this.environment.device});return s>=t.left-n&&s<=t.left+t.width+n})),p=M.MR(p,(e=>{let{left:t}=e;return t}));let t=0;for(;t<p.length-1;t++){const s=p[t+1],n=ad(s,e,this.environment).x;if(s.left>n)break}p=p.slice(0,t+1),p.reverse()}const g=p.map(Ll);let h;const f=c.filter((e=>e.direction===_l.vh.Onto)),x=M.F(f,(e=>e.height));if(x){u.some((t=>{const s=ad(t,e,this.environment).y;return Math.abs(t.top-s)<7}))||(h=Ll(x))}let y;const S=c.filter((e=>e.direction===_l.vh.Left||e.direction===_l.vh.Right));let v=M.F(S,(t=>{const s=ad(t,e,this.environment).x;return Math.abs(t.left-s)}));if(v){const e=v,t=S.filter((t=>Math.abs(t.left-e.left)<20));t.length>0&&(v=M.F(t,(e=>e.left)))}if(v){const e=v;u.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(y=Ll(v))}return{ontoDropZone:h,verticalDropZone:y,horizontalDropZones:g}}selectableCanAcceptDrop(e,t,s){if(Ve.Z.state.isOpen&&!ca.default.state.open)return!1;if(Ue.Z.state.isOpen)return!1;const n=_l.ZP.state,i=n.isDragging?n.draggedStores:[],o=!!n.isDragging&&n.isNativeDrag;let a,r,l,d=!1,c=!1;i.find((e=>{const t=Yl.Z.findOutlinerItemFromStore(e);return!!t&&(a=t,r=t.type,d=t.isTopLevelItem,!0)}));const u=e instanceof Fl.Z?Yl.Z.findOutlinerItemFromStore(e.props.store):void 0,m=null==u?void 0:u.parentStore;var p;u&&(l=u.type,c=u.isTopLevelItem||"team"===(null===(p=u.parentStore)||void 0===p?void 0:p.table));if(function(e){var t;const{draggingOutlinerItem:s,selectableOutlinerItemParent:n,direction:i}=e;if(s&&"team"===s.type&&s.isTopLevelItem&&(null===(t=s.parentStore)||void 0===t?void 0:t.pointer.table)===Tl.e0){const e=s.parentStore;if(!(s.store.getParentId()===e.pointer.id||n&&n.pointer.id===e.pointer.id&&i!==_l.vh.Onto))return!0}return!1}({draggingOutlinerItem:a,selectableOutlinerItemParent:m,direction:t}))return!1;if(!(e instanceof Fl.Z))return e.props.canAcceptDrop({direction:t,draggingStores:i,isNativeDrag:o});const g=e.props.store,h=g.getAssociatedCollectionStore();if(t===_l.vh.Onto&&h){const e=h.id,t=(0,Zl.fm)(g),s=null==t?void 0:t.collectionViewStore();if(s&&"page"!==s.getType()){if(i.find((s=>{const n=s.getAssociatedCollectionStore(),i=(0,Zl.fm)(s);return Boolean(s instanceof $t.G&&n&&n.id===e)||i===t})))return!1}}if(e.props.groupsPointer){var f;const t=null===(f=g.getCollectionViewCollectionStore())||void 0===f?void 0:f.getSchema();if(Boolean(e.props.groupsPointer.find((e=>!(0,Cl.WL)(e,(null==h?void 0:h.getSchema())??t))))){if(i.find((t=>{var s;const n=Jl.C.findSelectableFromStore(t);return(null==n||null===(s=n.props)||void 0===s?void 0:s.groupsPointer)&&e.props.groupsPointer&&!(0,kl.HH)(n.props.groupsPointer,e.props.groupsPointer)})))return!1}}if((0,ql.ru)({targets:i,destination:g,direction:t,draggingOutlinerType:r}))return!1;if(s&&i.find((e=>e.isTypedCollectionViewBlock()||(0,Il.h7)(e))))return!1;if(u&&t!==_l.vh.Onto&&!c&&!(0,Pl.M)({environment:this.environment,blocks:[u.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(l&&o)return!1;if("bookmarks"===r&&d&&("bookmarks"!==l||!c||t===_l.vh.Onto))return!1;if("bookmarks"===l&&c&&t!==_l.vh.Onto&&("bookmarks"!==r||!d))return!1;if(a&&a.isTopLevelItem&&"team"===a.type&&a.parentStore&&a.parentStore.table===Tl.e0){const e=a.parentStore,t=$t.zX.createChildStore(e,{...e.pointer,table:Tl.e0});if(t&&!(0,Gl.si)({teamStore:t,environment:this.environment}))return!1}if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===Tl.e0){const e=u.parentStore,t=$t.zX.createChildStore(e,{...e.pointer,table:Tl.e0});if(t&&!(0,Gl.si)({teamStore:t,environment:this.environment}))return!1}if("shared"===l&&c&&("shared"!==r||!d))return!1;if(l&&c&&t!==_l.vh.Onto){if(i.find((e=>{const t=e.getType();return Boolean(!t||!tt.Z7[t])})))return!1}const{device:x}=this.environment;if(l&&x.isMobile&&t===_l.vh.Onto&&c)return!1;if(i.find((e=>Boolean(e instanceof $t.G&&e.isInlineCollectionView())))&&(t===_l.vh.Left||t===_l.vh.Right))return!1;if(i.some((e=>Boolean(Hl.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Hl.Z.findCollectionTemplatePickerItemFromStore(g)))return!1;if(t===_l.vh.Onto&&g&&!(0,Pl.J5)({environment:this.environment,blocks:[g],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(i))return!1;if(i.some((e=>e.isTransclusionType()))){if(g.findRecordStoreUIAncestor((e=>{if(e===g)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getValue();return Boolean(t&&(0,tt.nq)(t.type))})).ancestor)return!1}return!0}}td.displayName="SelectableOrDropTargetListener";const sd=td;function nd(){const e=ed.default.state;e.isOpen&&!e.menuIsOpen&&ed.default.reset()}function id(e){return(St.default.state.droppableContainerStack||[]).indexOf(e)}function od(e,t,s){const n=ed.default.state;if(!n.isOpen||!n.menuIsOpen){const i=function(e,t,s){if(Xl.Z.state.isResizing||_l.ZP.state.isDragging||We.default.state.isActive||Ot.kw.state)return;const{selectableRectMap:n}=Rl.Z.state,i=$l.Z.getMembersByDOMOrder({filter:t=>{const s=t.getNode();return Boolean(s&&s.contains(e))}})[0],o=St.default.getCurrentDefaultContainer(),a=i||o;if(!a)return;const r=n.keys();let l=r.next();const d=[];for(;!l.done;){const e=l.value,i=n.get(e),o=150;(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===a&&i&&s>=i.top&&s<=i.bottom&&t>=i.left-o&&t<=i.right&&d.push(e),l=r.next()}const c=M.MR(d,(e=>{const t=n.get(e);return t?-t.left:1/0})),u=c.find((e=>{const t=e.getNode();return!t||!c.find((s=>{if(s!==e){const e=s.getNode();return Boolean(e&&t.contains(e))}return!1}))}));return u?{selectable:u,container:a}:void 0}(e,t,s);i?n.isOpen&&i.selectable.props.store===n.currentStore||ed.default.setState({isOpen:!0,currentStore:i.selectable.props.store,container:i.container,menuIsOpen:!1}):ed.default.reset()}}function ad(e,t,s){return Ol({device:s.device,target:e.target,points:t})}function rd(e){return(null==e?void 0:e.priority)??0}function ld(){xs.Ch(),nd()}function dd(){xs.Ch(),nd()}function cd(){const e=ed.default.state,t=Ot.kw.state;e.isOpen&&!e.menuIsOpen&&t&&ed.default.reset()}var ud=s(49427),md=s(74948),pd=s(38676);class gd extends b.Z{constructor(){super(...arguments),this.cachedPageViewRect=void 0,this.previousMousePosition=void 0,this.mouseSpeed=1/0,this.timerId=void 0,this.setPreviousMousePosition=(e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.previousMousePosition=void 0}),100)},this.handleWindowMouseMove=e=>{(0,Fe.ZP)({event:e,context:Fe.Af.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const t=pd.sidebarOpenStore.state,s=e.clientX,n=this.cachedPageViewRect.left,i=Math.max(.38*n,18,pd.sidebarMousePeekXStore.state);s<i&&!ca.default.isCenterPeekOpen()&&this.mouseSpeed<5&&0!==this.mouseSpeed&&!t&&md.open(),s>(0,Je.qG)(this.environment)&&s>i&&t&&md.close()}}})},this.handleWindowResize=e=>{this.environment.WindowSizeStore.state.width<md.OnlyOneSidebarVisibleWidthThreshold&&(0,Je.Sx)(this.environment)&&(0,Je.in)(this.environment)&&md.setExpand({environment:this.environment,isExpanded:!1,from:"sidebar_listener"})},this.updatePageViewRectThrottled=M.P2(this.updatePageViewRect,500)}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",fd),window.addEventListener("resize",this.handleWindowResize)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",fd),window.removeEventListener("resize",this.handleWindowResize)}updatePageViewRect(){const e=function(){const{mainEditorCurrentBlockStore:e}=ae.default.state,t=ud.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}}gd.displayName="SidebarListener";const hd=gd;function fd(e){e.toElement||e.relatedTarget||md.close()}var xd=s(84169),yd=s(1310),Sd=s(9612),vd=s(84076);class bd extends b.Z{constructor(){super(...arguments),this.showingAnimatedList=q.default.createValue(!1),this.handleShow=()=>{this.showingAnimatedList.setState(!0)},this.handleHide=()=>{this.showingAnimatedList.setState(!1)}}renderComponent(){const{currentItem:e}=yd.ZP.state,t=Boolean(e||this.showingAnimatedList.state);return(0,y.jsx)(js.Z,{open:t,zIndex:201,children:(0,y.jsx)(Sd.Z,{items:e?[e]:[],renderItem:(e,t,s)=>(0,y.jsx)(jd,{item:e,isVisible:t,onAnimationEnd:s},e.key),onShow:this.handleShow,onHide:this.handleHide})})}}bd.displayName="SnackbarRenderer";const Md=bd;function jd(e){window.__c={n:"ItemComponent"};const{item:t,isVisible:s,onAnimationEnd:a}=e,r=(0,et.Fg)(),l=(0,i.O7)(),{WindowSizeStore:d,device:c}=l,u=(0,o.VK)((()=>da.Z.state.estimatedKeyboardWebViewOverlap),[]),m=(0,o.VK)((()=>da.Z.estimatedNativeWebBottomOverlap()),[]),p=(0,o.VK)((()=>d.getSafePaddingBottomCSS(24+m)),[24,m,d]),g=(null==t?void 0:t.position)??"bottom";let h=24;c.isMobileNative&&c.isIOS&&(h=u>0?24+m:p);const f="top"===g?{top:24}:{bottom:h},x=(0,n.useCallback)((()=>{a(t)}),[a,t]);return(0,y.jsx)(bs.Z,{isVisible:s,onAnimationEnd:x,enterAnimationStyle:{translateY:"top"===g?-50:50,opacity:1,scale:1},animationStyle:{translateY:0,opacity:1,scale:1},exitAnimationStyle:{translateY:0,opacity:0,scale:.95},render:()=>(0,y.jsx)("div",{"aria-live":"polite",style:{...f,position:"fixed",left:0,width:"100%",display:"flex",zIndex:gs.E,padding:4,pointerEvents:"none"},children:(0,y.jsxs)("div",{style:{background:r.tooltipBackground,color:r.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:r.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",pointerEvents:"auto",...null==t?void 0:t.style},children:[t.label,t.helpUrl&&(0,y.jsx)(vd.Z,{href:t.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:r.regularInvertedTextColor},children:(0,xd.m)({fill:r.mediumInvertedTextColor})}),(0,y.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:t.right})]})})})}var wd=s(13991),Cd=s(6906),kd=s(76994),Td=s(65965),Id=s(47425),Pd=s(37834),Zd=s(83420),Fd=s(52533),_d=s(18514),Ad=s(46096),Rd=s(44041),Dd=s(35057),Bd=s(84787),Ld=s(50506),Od=s(76798),Ed=s(53336),Nd=s(83182),Vd=s(46247),Ud=s(26263),Wd=s(16691),Kd=s(4615),zd=s(45953),qd=s(606),Gd=s(13493),Hd=s(66213),Qd=s(82136),Yd=s(31192),$d=s(55095);class Jd extends b.Z{getChildContext(){return{...this.context,overrideLinkClick:e=>ec(e,this.environment)}}renderComponent(){const e=this.props.blockStore.id,t=this.props.timestamp,s={request:{block:{id:e,spaceId:(0,Xs.C)(this.props.blockStore.pointer.spaceId)},timestamp:t},performRequest:e=>async function(e,t,s){const{timestamp:n}=e,i=e.block.id,o=await Oe.getSnapshotContents(s,e);if("failed"===o.type)throw o.error;const a=zd.PF.create(o.data.contentMap),r=s.currentUser.id,l=new Ud.Z({name:"PageSnapshotPreview"});for(const{pointer:p,model:g}of a)g&&l.setModelAndRole({pointer:p,userId:r},g,"reader");l.snapshotData={blockId:i,timestamp:n};const d=new Map,c=e=>{const s=l.getRecord({pointer:e,userId:r}),n=(0,Wd.dn)(e);s||!(0,Kd.e)(e.id)||d.has(n)||d.set(n,(0,$t.Kv)(t,e))};for(const{model:p}of a)if(p)if(p.table===qt.iU){const e=p,t=e.getProperties(),s=qd.dr.uniq(M.xH(Object.keys(t).map((e=>t[e])).map(j.cCA)));for(const l of s)c(l);const n=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const l of n)c({table:qt.iU,id:l});const i=e.getCollectionPointer();i&&c(i);const o=M.jj(M.xH(Object.keys(t).map((e=>t[e])).map(j.lcG)));for(const l of o)c({table:en.KJ,id:l});const a=p.getCreatedByPointer();a&&c(a);const r=p.getLastEditedByPointer();r&&c(r)}else if(p.table===Gd.n){var u;const e=null===(u=p.getFormat())||void 0===u?void 0:u.collection_pointer;e&&c(e)}else if(p.table===Js.x_){const e=p.getCreatedByPointer();e&&c(e)}const m=Array.from(d.values());return await Promise.all(m.map((async e=>{await e.load();const t=e.getValue();t&&l.setRecord({pointer:e.pointer,userId:r},{role:"reader",value:t})}))),{blockStore:new $t.G(s,{table:qt.iU,id:i},{inMemoryRecordCache:l}),timestamp:n}}(e,this.props.blockStore,this.environment),render:(e,t,s)=>(0,y.jsx)(gn.Z,{show:!s||!t,showDelay:400,showHold:400,render:s=>s?(0,y.jsx)("div",{style:{padding:32,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,y.jsx)(Ms.Z,{})}):e?(0,y.jsx)("div",{style:{padding:32},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})}):t?(0,y.jsx)(rt.Z,{store:t.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:s}=e;return(0,y.jsx)(Ed.Z,{style:{background:this.theme.contentBackground,zIndex:1,flexGrow:1},type:(0,Ot.Zy)({environment:this.environment,store:t.blockStore}),...s,children:ia.default.checkGate("page_view_block_refactor")?(0,y.jsx)(Yd.ZP,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:Qd.S.InPageSnapShot,paddingBottom:Yd.ZP.paddingBottom(this.environment),paddingLeft:(0,Ot.ui)(this.environment),paddingRight:(0,Ot.ui)(this.environment),pageCoverHeight:Yd.ZP.defaultPageCoverHeight(this.environment)}):(0,y.jsx)($d.Z,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:Qd.S.InPageSnapShot,paddingBottom:Yd.ZP.paddingBottom(this.environment),paddingLeft:(0,Ot.ui)(this.environment),paddingRight:(0,Ot.ui)(this.environment),pageCoverHeight:Yd.ZP.defaultPageCoverHeight(this.environment)})})}},t.timestamp):void 0})};return(0,y.jsx)(Hd.LF,{value:e=>ec(e,this.environment),children:(0,y.jsx)(Ri.Z,{...s})})}}Jd.displayName="PageSnapshotPreview",Jd.contextTypes=b.w,Jd.childContextTypes={...Hd.wK,...b.w};const Xd=Jd;function ec(e,t){Pd.U4(),Qa.c4({environment:t,url:e})}var tc=s(5595);const sc={display:"flex",justifyContent:"center",padding:32};const nc=(0,l.injectIntl)((function(){window.__c={n:"SnapshotHistoryModal"};const e=(0,l.useIntl)(),t=(0,i.O7)(),{device:s}=t,n=(0,o.VK)((()=>Ad.Z.state),[]);return s.isMobile?(0,y.jsx)(u.ZP,{ariaLabel:cc(e),popupType:u.ZP.PopupType.SlideUp,open:n.open,render:()=>(0,y.jsx)(Mc,{}),onDismiss:Pd.U4}):(0,y.jsx)(Ld.Z,{ariaLabel:cc(e),open:n.open,innerStyle:{height:`${tc._Y}vh`,width:`${tc.rp}vw`,overflow:"hidden",display:"flex"},onDismiss:Pd.U4,render:()=>(0,y.jsx)(Mc,{}),className:m.Nn$})})),ic=(0,y.jsx)(l.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"});function oc(){return Td.sb.filter((e=>"personal"!==e.tier))}function ac(e){const t=oc(),s=t.findIndex((t=>t.tier===e));if(!(s<=0))return t[s-1]}function rc(e){var t;if(Qt.default.isAdminMode)return;const{nextFutureSnapshot:s}=e;if(!s)return;const n=(i=s,(Date.now()-parseInt(i.timestamp))/Gt.A0);var i;if((0,Dd.Aw)()&&n<=Td.hy.plus.days)return;const o=function(e){return oc().filter((t=>t.days>e)).map((e=>e.tier))}(n);if((0,Dd.p4)(o))return;const a=o[0]??"enterprise";return(0,Id.QM)(a)?void 0:{tier:a,message:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,Cd.Z)((0,Id.eR)(a)?"plus":a),snapshotLimitDays:(null===(t=ac(a))||void 0===t?void 0:t.days)??Math.floor(n)}})}}function lc(){return(0,y.jsx)(Vd.Z,{href:(0,_d.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}function dc(e,t){const{device:s}=t;return!s.isMobile||"personal"===e&&(0,Fd.S$)({environment:t})}function cc(e){return e.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"})}function uc(e){const{device:t}=e;return t.isMobile?24:20}function mc(e){let{menuState:t}=e;window.__c={n:"DesktopSnapshotPreviewComponent"};const s=(0,i.O7)(),a=(0,o.VK)((()=>t.blockStore.getIcon()),[t.blockStore]),r=(0,o.VK)((()=>t.blockStore.isEmptyPage()),[t.blockStore]);return t.snapshot?(0,y.jsxs)(n.Fragment,{children:[(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14},children:[a&&(0,y.jsx)(Sr.Z,{disabled:!0,icon:a,isEmptyPage:r,size:uc(s),style:{marginRight:6}}),(0,y.jsx)(Od.Z,{store:t.blockStore})]}),(0,y.jsx)(Xd,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp})]}):null}function pc(e,t){const{device:s}=e;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...s.isMobile?{position:"relative",zIndex:1,background:t.popoverBackground,boxShadow:`\n                        0 -1px 0 ${t.regularDividerColor},\n                        0 1px 0 ${t.regularDividerColor}\n                    `}:{height:"100%"}}}function gc(){window.__c={n:"VersionHistoryIconComponent"};const e=(0,et.Fg)();return(0,kd.w)({width:64,height:"auto",fill:e.lightIconColor,marginBottom:12})}function hc(e,t){Rd.y(t,{from:"history_modal",for:e})}function fc(e){let{message:t,showUpgradeButtonForTier:s}=e;window.__c={n:"UnavailableMessageComponent"};const n=(0,et.Fg)(),a=(0,i.O7)(),{device:r}=a,d=(0,o.VK)((()=>Wi.GJ(Ki.subscriptionDataStoreInstance.state)),[]);let c=dc(s,a);return c&&(0,Fd.S$)({environment:a})&&"personal"===s&&!d&&(c=!1),(0,y.jsxs)("div",{style:pc(a,n),children:[dc(s,a)&&(0,y.jsx)(gc,{}),(0,y.jsx)("div",{style:{...!r.isMobile&&{maxWidth:340}},children:t}),c&&s&&(0,y.jsx)(vi.Z,{isLarge:!0,onClick:()=>hc(s,a),style:{marginTop:16},children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})})]})}function xc(e){window.__c={n:"SnapshotsMenuListComponent"};const t=(0,i.O7)(),s=(0,l.useIntl)(),{device:o}=t,{menuState:a,loadingMore:r}=e,d=M.oA(e.snapshotValues.map(((n,i)=>{const r=i>0?e.snapshotValues[i-1]:void 0,d=rc({snapshot:n,nextFutureSnapshot:r}),c=!d;return{key:n.id,action:()=>{Pd.gs({environment:t,snapshot:n,nextFutureSnapshot:r})},render:e=>{const i=n.authors||[],r=s.formatList(M.oA(i.map((e=>(0,Zd.nc)({parentStore:a.blockStore,pointer:e}).getDisplayName(s)))),{type:"conjunction",style:"narrow"}),u=(0,y.jsx)("div",{style:{...ga.Z.textOverflowStyle},children:r}),m=Boolean(a.snapshot&&a.snapshot.id===n.id),p=parseInt(n.timestamp),g=p>Date.now()-6*Gt.A0?(0,Fo.$b)(p,wd.SP,s):(0,Fo.Yx)(p,"medium",wd.SP),h=(0,Fo.Yx)(p,"medium_with_time",wd.SP);return c?(0,y.jsx)(ee.ZP,{render:t=>(0,y.jsx)(vt.Z,{...(0,te.Z)(e,t),title:g,focused:!o.isMobile&&m,caption:u}),renderTooltip:()=>(0,y.jsxs)("div",{style:{maxWidth:270,whiteSpace:"normal"},children:[(0,y.jsx)("div",{children:h}),(0,y.jsx)("div",{children:r})]})},e.key):(0,y.jsx)(ee.ZP,{render:s=>(0,y.jsx)(vt.Z,{...(0,te.Z)(s,e),title:(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,y.jsx)("div",{style:{...o.isMobile&&{display:"flex",flex:1},...ga.Z.textOverflowStyle},children:g}),(0,y.jsx)(Ui.Z,{subscriptionTier:d.tier,analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>hc(d.tier,t)})]}),focused:!o.isMobile&&m,caption:u}),renderTooltip:()=>(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!Id.QM},e.key)}}}))),c=a.snapshot&&a.snapshot.id,u=d.findIndex((e=>c===e.key)),m=[{key:"snapshots",render:e=>(0,y.jsx)(N.Z,{...e}),items:d}];return(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(O.Z,{type:O.i.Vertical,initialFocus:u,sections:m}),(0,y.jsx)(Bd.Z,{loading:r,fetchSize:a.size,resultSize:e.snapshotValues.length,onLoadMore:Pd.FF}),(0,y.jsx)(gn.Z,{show:r,showDelay:300,showHold:100,render:e=>e&&(0,y.jsx)("div",{style:sc,children:(0,y.jsx)(Ms.Z,{})})})]})}function yc(e){let{menuState:t}=e;window.__c={n:"MobileSnapshotPreviewComponent"};const s=(0,i.O7)();return(0,y.jsx)(u.ZP,{popupType:u.ZP.PopupType.SlideUp,open:Boolean(t.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!t.snapshot)return null;const e=rc({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot}),n=!e,i=n?(0,y.jsx)(Xd,{blockStore:t.blockStore,timestamp:t.snapshot.timestamp}):(0,y.jsx)(fc,{message:e.message,showUpgradeButtonForTier:e.tier});return(0,y.jsx)(c.Z,{menuType:p.og.Modal,title:(0,Fo.$b)(parseInt(t.snapshot.timestamp),wd.SP,U.default.getIntl()),right:(0,y.jsx)(at.DoneMenuText,{}),onClickRight:Pd.zb,leftDisabled:!n,left:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>Pd.xx(s),whiteBackground:n,forceFullScreenSlideUp:!0,children:i})}})}function Sc(e){window.__c={n:"DesktopSidebarComponent"};const t=(0,et.Fg)(),s=(0,i.O7)(),{menuState:n}=e,o=Boolean(n.snapshot&&!rc({snapshot:n.snapshot,nextFutureSnapshot:n.nextFutureSnapshot})&&function(e,t){return(0,Pl.k5)({environment:t,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}(n,s));return(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexShrink:0,width:tc.mD},children:[(0,y.jsx)(Ed.Z,{type:it.Z.Y,style:{flex:1},children:(0,y.jsx)(xc,{...e})}),(0,y.jsxs)("div",{style:{display:"flex",padding:14,borderTop:`\n                        1px solid ${t.regularDividerColor}\n                    `},children:[(0,y.jsx)(ee.ZP,{disableTooltip:o,renderTooltip:()=>(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>(0,y.jsx)(vi.Z,{isLarge:!0,onClick:()=>Pd.xx(s),disabled:!o,...e,children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"})})}),(0,y.jsx)(wi.Z,{isLarge:!0,style:{marginLeft:12},onClick:Pd.U4,children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"})})]}),(0,y.jsx)(N.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,y.jsx)(Nd.Z,{title:(0,y.jsx)(l.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,_d.UY)("guides.pageHistory"),analyticsFrom:"page_history"})})]})}function vc(e){let t,s;return e.loadingMore||0!==e.snapshotValues.length||(t=(0,y.jsx)(fc,{message:ic,showUpgradeButtonForTier:!1})),s=e.error?(0,y.jsx)("div",{style:sc,children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,y.jsx)("div",{style:sc,children:(0,y.jsx)(Ms.Z,{})}):(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(Ed.Z,{type:it.Z.Y,children:(0,y.jsx)(xc,{...e})}),(0,y.jsx)(yc,{menuState:e.menuState})]}),(0,y.jsx)(c.Z,{menuType:p.og.Modal,title:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:(0,y.jsx)(lc,{}),right:(0,y.jsx)(at.DoneMenuText,{}),onClickRight:Pd.U4,header:t,children:s})}function bc(e){window.__c={n:"DesktopHistoryComponent"};const t=(0,et.Fg)();let s;if(e.error)s=(0,y.jsx)("div",{style:sc,children:(0,y.jsx)(l.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})});else if(e.initialLoading)s=(0,y.jsx)("div",{style:sc,children:(0,y.jsx)(Ms.Z,{})});else{const t=e.menuState.snapshot&&rc({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot});s=t?(0,y.jsx)(fc,{message:t.message,showUpgradeButtonForTier:t.tier}):e.loadingMore||0!==e.snapshotValues.length?(0,y.jsx)(mc,{menuState:e.menuState}):(0,y.jsx)(fc,{message:ic,showUpgradeButtonForTier:!1})}return(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)("div",{style:{display:"flex",flexDirection:"column",width:`calc(100% - ${tc.mD}px)`,boxShadow:`1px 0 0 ${t.regularDividerColor}`},children:s}),(0,y.jsx)(Sc,{...e})]})}function Mc(){window.__c={n:"SnapshotsListRequestComponent"};const e=(0,i.O7)(),{device:t}=e,s=(0,o.VK)((()=>Ad.Z.state),[]);if(!s.open)return null;const n={request:{block:{id:s.blockStore.id,spaceId:(0,Xs.C)(s.blockStore.pointer.spaceId)},size:s.size},performRequest:t=>async function(e,t,s){const{device:n}=s,i=await Oe.getSnapshotsList(s,e);if("failed"===i.type)throw i.error;const{snapshots:o}=i.data;if(t.pageHasCollection=o.some((e=>{var t;const s="collection"===e.parent_table,n=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return s||n&&0!==n})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),n=o.findIndex((t=>parseInt(t.timestamp)<e));0===o.length||(0===n?Pd.gs({environment:s,snapshot:o[n],nextFutureSnapshot:void 0}):n>0?Pd.gs({environment:s,snapshot:o[n-1],nextFutureSnapshot:n>1?o[n-2]:void 0}):o.length<t.size?Pd.gs({environment:s,snapshot:o[o.length-1],nextFutureSnapshot:o.length>1?o[o.length-2]:void 0}):Pd.FF())}else Boolean(t.snapshot)||n.isMobile||Ad.Z.setState({...t,snapshot:o[0],nextFutureSnapshot:void 0});return i.data}(t,s,e),render:(e,n,i)=>(0,y.jsx)(gn.Z,{show:Boolean(!n||n.snapshots.length>=s.size&&s.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:o=>t.isMobile?(0,y.jsx)(vc,{snapshotValues:n?n.snapshots:[],menuState:s,error:e,initialLoading:o,loadingMore:!i}):(0,y.jsx)(bc,{snapshotValues:n?n.snapshots:[],menuState:s,error:e,initialLoading:o,loadingMore:!i})})};return(0,y.jsx)(Ri.Z,{...n})}var jc=s(30397);const wc=function(){window.__c={n:"TeamsInSpaceListener"};const e=(0,i.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,o.Kw)(ae.default),[,a,r]=(0,o.AF)(jc.Z),l=null==s?void 0:s.id;return(0,n.useEffect)((()=>{if(!t||!l)return;const s=ze.Z.addListener((0,Ke.je)(t.id),(async(s,n)=>{if(!r.shouldRefetchTeamsInSpace({currentUserId:l,currentSpaceId:t.id,emitValue:n}))return;const i=await(0,Ae.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:l});a({teams:i,lastEmitData:{spaceId:t.id,userId:l,value:n}})}),void 0,e);return function(){s&&ze.Z.removeListener(s,e)}}),[t,l,e,a,r]),null};var Cc=s(13148),kc=s(89475),Tc=s(4926),Ic=s(1634);const Pc=function(){window.__c={n:"UnfurlingInformationPopup"};const e=(0,et.Fg)(),t=(0,i.O7)(),s=(0,o.VK)((()=>Ic.Z.state),[]),n=(0,o.VK)((()=>Tc.Z.state),[]);if(!s.open)return null;const a=s.integration.info.icon;return a?(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:e.popoverBackground,borderRadius:4,boxShadow:e.lightBoxShadow,position:"absolute",bottom:65+n,right:16+n,width:240,zIndex:gs.hT,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,y.jsx)(Mi.Z,{type:"image_url",imageURL:a,size:38,style:{marginBottom:6}}),(0,y.jsx)("div",{style:{color:e.regularTextColor,fontSize:14,fontWeight:ga.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"},children:(0,y.jsx)(l.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:s.integration.name}})}),(0,y.jsxs)("div",{style:{color:e.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,y.jsx)(l.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,y.jsx)(Xi.Z,{href:(0,_d.UY)("guides.unfurling"),external:!0,children:(0,y.jsx)(l.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,y.jsx)(vi.Z,{onClick:()=>async function(e){const t=Ic.Z.state,{currentSpaceStore:s}=ae.default.state;if(!t.open||!s)return;await kc.hM({environment:e,integration:t.integration,spaceId:s.id,unfurlUrl:t.unfurlUrl,externalObjectInstanceBlockId:t.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),Zc(t.integration.id,e),Ic.Z.reset()}(t),style:{width:"100%"},children:(0,y.jsx)(l.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,y.jsx)(Ii.Z,{icon:Cc.U,onClick:()=>function(e){const t=Ic.Z.state;t.open&&Zc(t.integration.id,e);Ic.Z.reset()}(t),style:{position:"absolute",top:6,right:6}})]}):null};function Zc(e,t){const{currentUserSettingsStore:s}=ae.default.state;s&&k.createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:t,perform:t=>{ie.GK({transaction:t,userSettingsStore:s,integrationId:e})}})}var Fc=s(12170),_c=s(80064);class Ac extends b.Z{constructor(){super(...arguments),this.menuRef=(0,n.createRef)(),this.renderMenu=()=>{const{device:e}=this.environment,t=_c.Z.state;if(!t.open)return;const{allOptionTypes:s}=t,n={key:"embed section",render:e=>(0,y.jsx)(N.Z,{...e}),items:s.map((e=>({key:e,render:t=>(0,y.jsx)(vt.Z,{...t,title:(0,y.jsx)(Dc,{optionType:e}),onMouseEnter:s=>{t.onMouseEnter(s),Bc(e,this.props.intl,this.environment)}}),action:()=>Lc(e,this.environment)})))};let i;return i=e.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:320,maxHeight:"40vh"},(0,y.jsx)(c.Z,{...i,className:m.b_f,ref:this.menuRef,children:(0,y.jsx)(O.Z,{type:O.i.Vertical,sections:[n],initialFocus:0,onKeyboardArrow:e=>function(e,t,s){const n=_c.Z.state;if(!n.open||void 0===e.indexGlobal)return;const i=n.allOptionTypes[e.indexGlobal];if(!i)return;Bc(i,t,s)}(e,this.props.intl,this.environment),priority:1,disallowBackspace:!0})})},this.handleWindowKeydown=e=>{_c.Z.state.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&Lc(void 0,this.environment)},this.handleWindowMousedown=e=>{const t=_c.Z.state,s=this.menuRef.current;if(!t.open||!e.target||!s)return;const n=mn.findDOMNode(s);n&&(n.contains(e.target)||Lc(void 0,this.environment))}}UNSAFE_willMount(){(0,hn.lj)(window,"keydown",this.handleWindowKeydown),(0,hn.lj)(window,"mousedown",this.handleWindowMousedown)}willUnmount(){(0,hn.ZV)(window,"keydown",this.handleWindowKeydown),(0,hn.ZV)(window,"mousedown",this.handleWindowMousedown)}renderComponent(){const{device:e}=this.environment,t=_c.Z.state;return(0,y.jsx)(u.ZP,{popupType:e.isMobileNative&&!e.isTablet?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,open:Boolean(t.open&&t.renderRect),originRect:t.open?t.renderRect:void 0,placementToOrigin:u.ZP.Placement.Top,alignmentToOrigin:u.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:()=>{Lc(void 0,this.environment)}})}}Ac.displayName="UnfurlingMenu";const Rc=(0,l.injectIntl)(Ac);function Dc(e){let{optionType:t}=e;return"preview"===t?(0,y.jsx)(l.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===t?(0,y.jsx)(l.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===t?(0,y.jsx)(l.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"collection"===t?(0,y.jsx)(l.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):void(0,B.t1)(t)}function Bc(e,t,s){k.createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:s,perform:n=>{Fc.hJ({environment:s,type:e,useTemporaryRecordCache:!0,transaction:n,intl:t})}})}function Lc(e,t){k.createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:t,perform:s=>{Fc.xv({environment:t,setType:e,transaction:s})}})}const Oc=function(){window.__c={n:"AppComponents"};const e=(0,i.Fy)(),t=(0,i.O7)(),{isMobile:s,isElectron:l}=e;(0,n.useEffect)((()=>{if(s){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[s]);const{currentSpaceStore:d,teamsEnabled:c}=(0,o.VK)((()=>({currentSpaceStore:ae.default.state.currentSpaceStore,teamsEnabled:(0,Ae.bq)()})),[]);(0,n.useEffect)((()=>{function e(){Ne.Z.setState({open:!0})}function t(){Ne.Z.setState({open:!1})}return a.inPageSearch.started.addListener(e),a.inPageSearch.stopped.addListener(t),()=>{a.inPageSearch.started.removeListener(e),a.inPageSearch.stopped.removeListener(t)}}),[]),(0,n.useEffect)((()=>{function s(s){e.isAndroid||Be.default.isOnboarding||(0,Fe.ZP)({event:s,context:Fe.Af.EditorContextMenu,callback:()=>{e.isElectron||t.currentUser.isLoggedIn()&&s.preventDefault()}})}return window.addEventListener("contextmenu",s),()=>{window.removeEventListener("contextmenu",s)}}),[e.isAndroid,e.isElectron,t.currentUser]),(0,n.useEffect)((()=>{function e(e){e.preventDefault()}return window.addEventListener("dragstart",e),()=>{window.removeEventListener("dragstart",e)}}),[]),(0,n.useEffect)((()=>{function e(e){We.default.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:We.default.state.currentX,currentY:We.default.state.currentY,toggle:e.shiftKey}))}function s(e){We.default.state.isActive&&(e.preventDefault(),r.MZ({environment:t,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))}function n(e){We.default.state.isActive&&((0,_e.N9)(e)||e.preventDefault(),r.qw(t))}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("mousemove",s),window.addEventListener("mouseup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",e),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",n)}}),[t]);const u=t.currentUser.isLoggedIn();return(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(ht,{}),(0,y.jsx)(g.LazyNewDiscussionMenu,{}),(0,y.jsx)(S,{}),(0,y.jsx)(De,{}),(0,y.jsx)(Qe.Z,{priority:-1,capture:!0}),(0,y.jsx)(sd,{}),u&&!s&&(0,y.jsx)(hd,{}),u&&d&&(0,y.jsx)(er,{rootStore:d}),u&&(0,y.jsx)(wc,{}),u&&c&&(0,y.jsx)(He,{}),u&&(0,y.jsx)(Ee,{}),(0,y.jsx)(At.Z,{}),(0,y.jsx)(Ua,{}),(0,y.jsx)(g.LazyBlockMenu,{}),(0,y.jsx)(jr,{}),(0,y.jsx)(gr,{}),(0,y.jsx)(Bs,{}),(0,y.jsx)(Pt,{}),!s&&(0,y.jsx)(dl,{}),(0,y.jsx)(ln,{}),(0,y.jsx)(rr,{}),(0,y.jsx)(ko,{}),(0,y.jsx)(Ft.Z,{store:Ve.Z}),(0,y.jsx)(Ft.Z,{store:Ue.Z}),(0,y.jsx)(Ca,{}),(0,y.jsx)(g.LazySlashMenu,{}),(0,y.jsx)(Ie,{}),(0,y.jsx)(ss,{}),(0,y.jsx)(Rc,{}),(0,y.jsx)(Sn,{}),(0,y.jsx)(Pc,{}),(0,y.jsx)(jt,{}),(0,y.jsx)(Md,{}),(0,y.jsx)(Yn,{}),l&&(0,y.jsx)(g.LazyElectronContextMenu,{}),(0,y.jsx)(Nt,{}),(0,y.jsx)(_t.Z,{}),u&&(0,y.jsx)(nc,{}),(0,y.jsx)($s.s6,{})]})}},13713:(e,t,s)=>{s.d(t,{B:()=>S,Z:()=>v});s(67294);var n=s(13991),i=s(480),o=s(86628),a=s(24405),r=s(66897),l=s(7057),d=s(9291),c=s(83420),u=s(33929),m=s(4023),p=s(16011),g=s(28992),h=s(72495),f=s(26388),x=s(64369),y=s(85893);function S(e){const t=e.getCreatedByPointer(),s=e.getCreatedTime(),i=e.getLastEditedByPointer(),o=e.getLastEditedTime(),a=u.default.getIntl();if(t&&s&&o&&i){const r=(0,c.ue)({parentStore:e,pointer:t}),d=(0,l.$b)(s,n.SP,a),u=(0,c.ue)({parentStore:e,pointer:i}),m=(0,l.$b)(o,n.SP,a);if(!u)return;return{createdBy:r,createdTime:d,lastEditedBy:u,lastEditedTime:m}}}const v=function(e){let{isPageMoreButton:t,hideTopBorder:s,store:n}=e;window.__c={n:"BlockAuthorInfo"};const l=(0,o.VK)((()=>S(n)),[n]),{device:c}=(0,i.O7)(),v=(0,o.VK)((()=>c.isPhone),[c]),b=u.default.getIntl(),M=(0,a.yK)((()=>({menuItem:{paddingTop:v?8:s?0:6,paddingBottom:v?8:16}})),[s,v]);return(0,y.jsx)(h.Z,{topBorder:!t&&!s,style:{paddingTop:t?0:8,paddingBottom:8},children:(0,y.jsx)(g.Z,{style:l?void 0:M.menuItem,shouldWrapTitle:!0,title:l?(0,y.jsx)(f.ZP,{placement:m.u.Right,render:e=>(0,y.jsxs)("div",{...e,children:[(0,y.jsx)(x.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,y.jsx)(d.FormattedMessage,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:l.lastEditedBy.asActor?(0,r.$4)(b,l.lastEditedBy):void 0}})}),(0,y.jsx)(x.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,children:l.lastEditedTime})]}),renderTooltip:()=>(0,y.jsx)(p.Z,{store:n,compactFormat:!0})}):void 0,loading:!l})})}},99662:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ie});s(67294);var n=s(480),i=s(86628),o=s(72126),a=s(29369),r=s(97880),l=s(9291),d=s(41363),c=s(72495),u=s(35067),m=s(85893);const p=[{key:"block in comment menu primary",render:e=>(0,m.jsx)(c.Z,{...e}),actions:[u.G,d.yN,d.TH]}];var g=s(24212),h=s(82763),f=s(34658);const x=[{key:"page mention context menu primary",render:e=>(0,m.jsx)(c.Z,{isTitleUppercase:!1,...e}),actions:[f.sN,f.Jw,f.KB,f.oL,h.K,h.H]}];var y=s(50906),S=s(6404),v=s(28020),b=s(75079),M=s(87279),j=s(18514),w=s(35328),C=s(94841),k=s(8848),T=s(40745),I=s(37652),P=s(33907),Z=s(8597),F=s(80988),_=s(53465),A=s(88437),R=s(77734),D=s(73599),B=s(37612),L=s(62967),O=s(82530),E=s(41216),N=s(19037),V=s(80025),U=s(33929),W=s(98794);const K=(0,l.defineMessages)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),z=(0,L.wL)({key:"simple table header column",displayName:K.simpleTableHeaderColumn,label:U.default.formatMessage(K.simpleTableHeaderColumn),property:"table_block_row_header",svg:R.s,validators:[N.J5,N.ff(N.b4),N.W5,N.p4],afterAction:(e,t)=>{}}),q=(0,L.wL)({key:"simple table header row",displayName:K.simpleTableHeaderRow,label:U.default.formatMessage(K.simpleTableHeaderRow),property:"table_block_column_header",svg:D.f,validators:[N.J5,N.ff(N.b4),N.W5,N.zO],afterAction:(e,t)=>{}}),G=(0,L.cN)({key:"insert column left",displayName:K.simpleTableInsertColumnLeft,analyticsName:K.simpleTableInsertColumnLeft.defaultMessage,svg:I.V,validators:[N.J5,N.ff(N.fI),N.W5,N.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,perform:e=>{W.insertColumnLeft({environment:t,transaction:e})}})}}),H=(0,L.cN)({key:"insert column right",displayName:K.simpleTableInsertColumnRight,analyticsName:K.simpleTableInsertColumnRight.defaultMessage,svg:P.n,validators:[N.J5,N.ff(N.fI),N.W5,N.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,perform:e=>{W.insertColumnRight({environment:t,transaction:e})}})}}),Q=(0,L.cs)({key:"duplicate columns",displayName:L.RE.duplicateName,analyticsName:L.RE.duplicateName.defaultMessage,svg:A.a,validators:[N.J5,N.ff(N.fI),N.W5,N.z2],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,perform:e=>{W.duplicateColumns({transaction:e})}})}}),Y=(0,L.cs)({key:"delete columns",displayName:L.RE.deleteName,analyticsName:L.RE.deleteName.defaultMessage,svg:B.y,validators:[N.J5,N.ff(N.fI),N.W5,N.OT,N.z2],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,perform:e=>{W.deleteColumns({environment:t,transaction:e})}})}}),$=(0,L.cN)({key:"clear column contents",displayName:K.simpleTableClearContents,analyticsName:K.simpleTableClearContents.defaultMessage,svg:_.X,validators:[N.J5,N.ff(N.fI),N.W5,N.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,perform:e=>{W.clearSelectionContents({environment:t,transaction:e})}}),W.clearSelection()}}),J=(0,L.cN)({key:"insert row above",displayName:K.simpleTableInsertRowAbove,analyticsName:K.simpleTableInsertRowAbove.defaultMessage,svg:Z.Z,validators:[N.J5,N.ff(N.fI),N.W5,N.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,perform:e=>{W.insertRowAbove({environment:t,transaction:e})}})}}),X=(0,L.cN)({key:"insert row below",displayName:K.simpleTableInsertRowBelow,analyticsName:K.simpleTableInsertRowBelow.defaultMessage,svg:T.M,validators:[N.J5,N.ff(N.fI),N.W5,N.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,perform:e=>{W.insertRowBelow({environment:t,transaction:e})}})}}),ee=(0,L.cs)({key:"duplicate rows",displayName:L.RE.duplicateName,analyticsName:L.RE.duplicateName.defaultMessage,svg:A.a,validators:[N.J5,N.ff(N.fI),N.W5,N.EJ],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,perform:e=>{W.duplicateRows({environment:t,transaction:e})}})}}),te=(0,L.cs)({key:"delete rows",displayName:L.RE.deleteName,analyticsName:L.RE.deleteName.defaultMessage,svg:B.y,validators:[N.J5,N.ff(N.fI),N.W5,N.W3,N.EJ],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,perform:e=>{W.deleteRows({environment:t,transaction:e})}})}}),se=(0,L.cN)({key:"clear row contents",displayName:K.simpleTableClearContents,analyticsName:K.simpleTableClearContents.defaultMessage,svg:_.X,validators:[N.J5,N.ff(N.fI),N.W5,N.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;O.createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,perform:e=>{W.clearSelectionContents({environment:t,transaction:e})}}),W.clearSelection()}}),ne=[N.J5,N.ff(N.fI),N.W5,N.z2],ie=[N.J5,N.ff(N.fI),N.W5,N.EJ];function oe(e,t,s,n){const i=n||(0,V.qf)(e),o=(0,L.cN)({key:`color ${s||e}`,displayName:i,analyticsName:i.defaultMessage,fuzzySearchKeywords:(0,L.CJ)(e),validators:"column"===t?ne:ie,action:t=>{let{blocks:s,environment:n}=t;O.createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:n,perform:t=>{W.setColor(n,e,t)}})},closeParentMenu:!0,render:t=>(0,m.jsx)(E.Z,{...t,color:e,overrideDisplayName:o.displayName}),nativeRender:t=>{let{environment:n}=t;return(0,L.fi)(n,e,s)}});return o}const ae=(0,L.$J)({key:"simple table column background color actions",title:L.RE.backgroundSection,overrideSearchTitle:L.RE.backgroundSectionKeywords,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[oe("default","column","default background",V.mF.backgroundColorDefault),...k._K.map((e=>oe(e,"column")))]}),re=(0,L.$J)({key:"simple table column text color actions",title:L.RE.colorSection,overrideSearchTitle:L.RE.colorSection,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[...k.CY.map((e=>oe(e,"column")))]}),le=(0,L.$J)({key:"simple table row background color actions",title:L.RE.backgroundSection,overrideSearchTitle:L.RE.backgroundSectionKeywords,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[oe("default","row","default background",V.mF.backgroundColorDefault),...k._K.map((e=>oe(e,"row")))]}),de=(0,L.$J)({key:"simple table row text color actions",title:L.RE.colorSection,overrideSearchTitle:L.RE.colorSection,render:e=>(0,m.jsx)(c.Z,{...e}),actions:[...k.CY.map((e=>oe(e,"row")))]}),ce=(0,L.MV)({key:"set column color",displayName:L.RE.colorName,analyticsName:L.RE.colorName.defaultMessage,svg:F.U,validators:ne,subActions:()=>[{key:0,title:U.default.formatMessage(K.textColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:re.actions},{key:1,title:U.default.formatMessage(K.backgroundColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:ae.actions}]}),ue=(0,L.MV)({key:"set row color",displayName:L.RE.colorName,analyticsName:L.RE.colorName.defaultMessage,svg:F.U,validators:ie,subActions:()=>[{key:0,title:U.default.formatMessage(K.textColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:de.actions},{key:1,title:U.default.formatMessage(K.backgroundColorSection),render:e=>(0,m.jsx)(c.Z,{...e}),actions:le.actions}]}),me=[(0,L.$J)({key:"column section",render:e=>(0,m.jsx)(c.Z,{...e}),actions:[z,ce,G,H,Q,$,Y]}),(0,L.$J)({key:"row section",render:e=>(0,m.jsx)(c.Z,{...e}),actions:[q,ue,J,X,ee,se,te]})];var pe=s(80444),ge=s(8949),he=s(26136),fe=s(27724),xe=s(13713),ye=s(80209),Se=s(48019),ve=s(56940),be=s(68894),Me=s(3386),je=s(78140),we=s(40721),Ce=s(53437),ke=s(83182);function Te(){window.__c={n:"BlockMenuContent"};const e=(0,n.Fy)(),t=(0,i.VK)((()=>ge.Z.state),[]);return(0,m.jsx)(Ce.ZP,{popupType:e.isPhone?Ce.ZP.PopupType.SlideUp:Ce.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:Fe,placementToOrigin:Ce.ZP.Placement.Bottom,alignmentToOrigin:Ce.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:()=>(0,m.jsx)(Re,{}),preventBlockRenderQueueOnEnter:e.isMobile})}const Ie=(0,l.injectIntl)((function(){window.__c={n:"BlockMenu"};const e=(0,n.Fy)();return e.isMobileNative&&e.isIOS&&e.isPhone?function(){window.__c={n:"BlockMenuContentWithIgnoreSelectionArea"};const e=(0,i.VK)((()=>ge.Z.state),[]);return(0,m.jsx)(ve.Z,{capture:e.isActive,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>(0,m.jsx)(Te,{})})}():Te()}));function Pe(){window.__c={n:"CollectionHelpButton"};const[e,t]=(0,i.VK)((()=>{const e=ge.Z.state;if(!e.isActive)return[!1,!1];const t=e.stores[0];return[!0,(0,v.qG)(t.id)]}),[]);return e?t?(0,m.jsx)(c.Z,{topBorder:!0,children:(0,m.jsx)(ke.Z,{title:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Learn about tasks",id:"myTasks.helpTooltip.title"}),href:C.h5,analyticsFrom:"block_menu"})}):(0,m.jsx)(c.Z,{topBorder:!0,children:(0,m.jsx)(ke.Z,{title:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,j.UY)("guides.database"),analyticsFrom:"block_menu"})}):null}function Ze(){window.__c={n:"BlockAuthorInfoWrapper"};const e=(0,n.O7)(),t=(0,i.VK)((()=>ge.Z.state),[]),s=(0,i.VK)((()=>e.currentUser.isLoggedIn()),[e]),o=(0,i.VK)((()=>t.isActive&&1===t.stores.length&&(0,v.qG)(t.stores[0].id)),[t]);return s?!t.isActive||t.stores.length>1||o?null:(0,m.jsx)(xe.Z,{store:t.stores[0],isPageMoreButton:!1}):null}function Fe(){S.xv()}function _e(e){ge.Z.state.isActive&&ge.Z.setState({...ge.Z.state,inputValue:e.target.value})}function Ae(){window.__c={n:"InputSectionComponent"};const e=(0,l.useIntl)(),t=(0,n.MO)(),s=(0,i.VK)((()=>ge.Z.state),[]);if(!s.isActive||t)return null;const{inputValue:o}=s;return(0,m.jsx)(c.Z,{isInput:!0,children:(0,m.jsx)(be.ZP,{value:o,onChange:_e,focus:!0,focusAfterAnimation:!0,placeholder:e.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0})})}function Re(){var e;window.__c={n:"OverlayComponent"};const t=(0,n.O7)(),s=(0,n.MO)(),c=(0,i.VK)((()=>ge.Z.state),[]),u=null===(e=c.stores)||void 0===e?void 0:e[0],h=(0,i.VK)((()=>null==u?void 0:u.isCollectionView()),[u]),f=(0,i.VK)((()=>c.isActive?function(e){switch(e){case"default":return d.Qi;case"simple_table":return me;case"page_mention":return x;case"sidebar_outliner":return g.Oq;case"comment_media":return p;default:(0,r.t1)(e)}}(null==c?void 0:c.actionSectionGroupKey):[]),[c]);if(!c.isActive||!u)return null;const{originBlockRect:v,inputValue:j,publicEditMode:C}=c||{},k={environment:t,blocks:c.stores,originRect:v,publicEditMode:C},T=c.showInput&&(0,m.jsx)(Ae,{});let I;return I=s?{menuType:M.og.Modal,title:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:(0,m.jsx)(we.DoneMenuText,{}),onClickRight:Fe,header:T}:{menuType:M.og.Popup,width:265,header:T},(0,m.jsx)(Me.Z,{capture:!0,onBackspace:o.yR,children:(0,m.jsxs)(je.Z,{...I,children:[(0,m.jsx)(Se.Z,{filter:j,context:k,sections:f,onAccept:e=>function(e,t){const s=ge.Z.state;if(!s.isActive)return;const{stores:n}=fe.default.state,{analyticsFrom:i,collectionContextStore:o}=s,r=n[0];if(r){const s=r.getParentTable(),n=r.getType();if(n&&s){let l;if(s===a.e0){const e=r.getParentId(),{currentSpaceStore:t}=pe.default.getState();t&&void 0!==e&&(l=he.zX.createChildStore(t,{table:a.e0,id:e}))}const d=(0,b.Pn)(o)||{};y.dhV(t,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:i,block_id:r.id,block_type:n,parentTeamStore:l,is_toggleable:(0,w._A)(n,r.getFormat()),...d})}}e.closeParentMenu&&S.xv()}(e,t),initialFocus:j?0:void 0}),!j&&(0,m.jsx)(Ze,{}),!j&&(0,m.jsx)(ye.Z,{store:u}),!j&&h&&(0,m.jsx)(Pe,{})]})})}},80209:(e,t,s)=>{s.d(t,{Z:()=>y});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(86517),l=s(82990),d=s(9291),c=s(47307),u=s(76464),m=s(18878),p=s(19037),g=s(98165),h=s(64921),f=s(64369),x=s(85893);const y=function(e){let{store:t}=e;window.__c={n:"BlockMenuRestrictedMessage"};const s=(0,a.Fg)(),y=(0,i.O7)(),S=(0,n.useMemo)((()=>({environment:y,blocks:[t],publicEditMode:void 0})),[y,t]),v=(0,o.VK)((()=>p.xD([p.X,p.ff(p.J5)])(S)),[S]),b=(0,o.VK)((()=>p.xD([p.c2,p.ff(p.zz)])(S)),[S]);if(v){const{device:e}=y;return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{style:{backgroundColor:s.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${s.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,x.jsxs)(h.Z,{disabled:!b,style:{padding:12},onClick:()=>async function(e,t){const s=e.getPermissionItems(),n=g.Om(e),i=n?r.Wo(g.fJ(n)):[],o={type:"restore",permissionChanges:r.Xr(s,i)};await c.confirmUserAction({message:(0,m.mX)(o),acceptLabel:(0,m.nH)(o),cancelLabel:(0,x.jsx)(d.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,x.jsx)(m.mo,{openState:o})})&&u.hs({environment:t,store:e})}(t,y),children:[(0,x.jsx)(f.Z,{isMultiline:!0,isSmall:!0,children:(0,x.jsx)(d.FormattedMessage,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),b&&(0,x.jsx)(f.Z,{style:{marginTop:6,fontWeight:l.Z.fontWeight.semibold},children:(0,x.jsx)(d.FormattedMessage,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})})}return null}},81870:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var n=s(480),i=s(24405),o=s(84169),a=s(25888),r=s(73063),l=s(16354),d=s(85893);const c=function(e){window.__c={n:"CollectionMenuHelpButton"};const t=(0,n.O7)(),s=(0,i.Fg)();return(0,d.jsx)(l.Z,{href:e.href,external:!0,onClick:()=>a.Fs(t,{from:e.helpButtonContext}),children:(0,d.jsx)(r.Z,{icon:o.m,style:{height:24,width:24,marginRight:-6,fill:s.mediumIconColor}})})}},8895:(e,t,s)=>{s.r(t),s.d(t,{CollectionTypedDatabaseMigrationModal:()=>te});var n=s(67294),i=s(86628),o=s(92996),a=s(52489),r=s(24405),l=s(41892),d=s(6926),c=s(81570),u=s(9291),m=s(33929),p=s(84198),g=s(44731),h=s(51077),f=s(64369),x=s(85893);const y=(0,u.defineMessages)({dummyTask1:{id:"MyTasksWidgetPreview.dummyTask1",defaultMessage:"Set up sync with Lisa"},dummyTask2:{id:"MyTasksWidgetPreview.dummyTask2",defaultMessage:"Review design docs"},dummyTask3:{id:"MyTasksWidgetPreview.dummyTask3",defaultMessage:"Create color palette"},dummyTask4:{id:"MyTasksWidgetPreview.dummyTask4",defaultMessage:"Book flight to New York"},dummyTask5:{id:"MyTasksWidgetPreview.dummyTask5",defaultMessage:"Fix broken links"},dummyTask6:{id:"MyTasksWidgetPreview.dummyTask6",defaultMessage:"Upgrade database"},Blocked:{id:"MyTasksWidgetPreview.blockedStatus",defaultMessage:"Blocked"},"In Progress":{id:"MyTasksWidgetPreview.inProgressStatus",defaultMessage:"In Progress"},"Not Started":{id:"MyTasksWidgetPreview.notStartedStatus",defaultMessage:"Not Started"},locationIndicator:{id:"MyTasksWidgetPreview.locationIndicator",defaultMessage:"In"}}),S=[{icon:"📅",taskName:m.default.formatMessage(y.dummyTask1),status:"Blocked",teamspace:"Eng",location:(0,c.T)({width:13,fill:"#448361"})},{icon:"📚",taskName:m.default.formatMessage(y.dummyTask2),status:"In Progress",teamspace:"Design",location:(0,d.s)({width:13,fill:"#CB912F"})},{icon:"🎨",taskName:m.default.formatMessage(y.dummyTask3),status:"In Progress",teamspace:"Design",location:(0,d.s)({width:13,fill:"#CB912F"})},{icon:"🛫",taskName:m.default.formatMessage(y.dummyTask4),status:"Not Started",teamspace:"Eng",location:(0,c.T)({width:13,fill:"#448361"})},{icon:"🚧",taskName:m.default.formatMessage(y.dummyTask5),status:"Not Started",teamspace:"Design",location:(0,d.s)({width:13,fill:"#CB912F"})},{icon:"👩‍💻",taskName:m.default.formatMessage(y.dummyTask6),status:"Not Started",teamspace:"Eng",location:(0,c.T)({width:13,fill:"#448361"})}],v={Blocked:"red","In Progress":"blue","Not Started":"gray"};function b(){window.__c={n:"MyTasksWidgetPreview"};const e=w();return(0,x.jsxs)("div",{style:e.fullBackgroundColor,children:[(0,x.jsxs)("div",{style:e.fullPreviewSection,children:[(0,x.jsx)("span",{style:e.emojiTitle,children:"📋"}),(0,x.jsx)(f.Z,{isMultiline:!0,style:e.previewTitle,children:(0,x.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Description",defaultMessage:"See all your tasks across multiple databases in your personal Home."})})]}),(0,x.jsx)(p.Z,{title:(0,x.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.AssignedToMePreview.Title",defaultMessage:"My tasks"}),icon:(0,x.jsx)("div",{style:{paddingLeft:4},children:(0,x.jsx)(h.Z,{type:"app_package_asset",size:18,icon:l.Z.images.appPackages.taskDbIconSvg})}),panelStyle:e.panelSection,children:(0,x.jsx)("div",{style:e.dummyAssignedToMe,children:(0,x.jsx)(M,{})})})]})}function M(){const e=S.map(((e,t)=>(0,x.jsx)(j,{row:e},t)));return(0,x.jsx)("div",{style:{display:"flex",marginTop:4,paddingRight:16,flexDirection:"column"},children:e})}function j(e){let{row:t}=e;window.__c={n:"ListItem"};const s=w();return(0,x.jsxs)("div",{style:s.eachTask,children:[(0,x.jsxs)("div",{style:s.taskName,children:[(0,x.jsx)("span",{style:s.taskIcon,children:t.icon}),(0,x.jsx)(f.Z,{style:s.taskTitle,children:t.taskName})]}),(0,x.jsx)("div",{style:s.taskStatus,children:(0,x.jsx)(g.J,{type:"status",value:m.default.formatMessage(y[t.status]),color:v[t.status],groupColor:void 0})}),(0,x.jsxs)("div",{style:s.location,children:[(0,x.jsx)("span",{style:s.locationIndicator,children:m.default.formatMessage(y.locationIndicator)}),(0,x.jsx)("div",{style:{...s.locationIcon,..."Design"===t.teamspace?{...s.designTeamspace}:{...s.engTeamspace}},children:t.location})]})]})}function w(){return(0,r.yK)((e=>({fullBackgroundColor:{backgroundColor:e.cardBackground},fullPreviewSection:{display:"flex",alignItems:"center",margin:"32px 48px",marginBottom:30},emojiTitle:{fontSize:36,marginRight:16},previewTitle:{color:e.regularTextColor,width:350,fontSize:17,fontWeight:500},panelSection:{paddingBottom:0,paddingRight:0,marginLeft:48,background:e.migrationMyTasksPreviewBackground},dummyAssignedToMe:{width:"100%",maxHeight:270,minHeight:90,paddingBottom:10},eachTask:{display:"flex",alignItems:"center",padding:4},taskName:{width:253,display:"flex"},taskIcon:{fontSize:14,marginRight:8},taskTitle:{color:e.regularTextColor,fontSize:14,fontWeight:500},taskStatus:{display:"flex",width:152},location:{display:"flex",alignItems:"center"},locationIndicator:{color:e.mediumTextColor,marginRight:4},locationIcon:{display:"flex",justifyContent:"center",fontSize:14,height:18,width:18,borderRadius:4},designTeamspace:{backgroundColor:"light"===e.mode?"#FBF3DB":"#5c3b23"},engTeamspace:{backgroundColor:"light"===e.mode?"#E5F2E2":"#243d30"}})),[])}var C=s(480),k=s(15145),T=s(8848),I=s(39068),P=s(42853),Z=s(47453),F=s(72126),_=s(8406),A=s(64964),R=s(82530),D=s(91851),B=s(34517),L=s(40663),O=s(51592),E=s(27383),N=s(87279),V=s(94841),U=s(31194),W=s(1310),K=s(42922),z=s(52275),q=s(31945),G=s(78140),H=s(32163),Q=s(72495),Y=s(74523);function $(e){window.__c={n:"PropertyMappingForm"};const t=(0,C.O7)(),s=(0,u.useIntl)(),l=(0,r.yK)((e=>({propertyMappingForm:{width:350,padding:32,backgroundColor:e.whiteButtonBackground,zIndex:1,borderRadius:"0px 6px 6px 0px",borderStyle:"hidden hidden hidden solid",borderColor:e.regularDividerColor},perPropertyInstruction:{color:e.mediumTextColor,fontSize:12,marginBottom:8},requiredPropertyError:{color:T.ZP.red,fontSize:12},learnMore:{display:"flex",justifyContent:"center",marginTop:8,marginLeft:0,width:"100%"},submitMigrationButton:{display:"flex",height:32},propertyMappingInstructions:{marginTop:6,marginBottom:24},propertyMappingDropdown:{display:"flex",alignItems:"center"},chevronDownIconEnabled:{width:10,fill:e.lightIconColor},propertyMappingTitle:{color:e.lightTextColor},propertyMappingMenu:{borderRadius:4,borderWidth:2,border:"solid",borderColor:e.stroke.deemphasized},checkboxMappingInfo:{display:"flex",alignItems:"center",marginLeft:4,marginTop:3,color:e.lightTextColor},a:{color:"white",cursor:"pointer"},propertyIcon:{fill:e.darkTextColor}})),[]),d=(0,r.Fg)(),{databaseType:c,collectionContextStore:m}=e,[p,g]=(0,n.useState)(!1),h=(0,i.VK)((()=>{var e;return null===(e=m.collectionStore())||void 0===e?void 0:e.getSchema()}),[m]),y=(0,i.VK)((()=>L.ck((0,B.appConfigs)(),c)),[c]),S=(0,i.VK)((()=>{if(h&&y)return L.Au(y,h)}),[y,h]),v=(0,i.VK)((()=>{const e={};return Object.keys(y||{}).filter((e=>void 0!==(null==y?void 0:y[e])&&e.startsWith("notion://"))).forEach((t=>{e[t]=void 0})),Object.entries(S||{}).forEach((t=>{let[s,n]=t;e[s]=n})),e}),[y,S]),[b,M]=(0,n.useState)(v),j=(0,n.useMemo)((()=>Object.entries(b).some((e=>{let[t,s]=e;if(t===o.Es.Status){const e=null==h?void 0:h[s||""];if("checkbox"===(null==e?void 0:e.type))return!0}}))),[h,b]),w=(0,i.VK)((()=>(0,V.J2)("main")),[]),$=(0,i.VK)((()=>{var e;return null==w||null===(e=w.getModel())||void 0===e?void 0:e.getRenderUrl({getRecordModel:null==w?void 0:w.getRecordModel,pageVisitSource:k.tY.TypedDBConversionToast})}),[w]),ee=(0,n.useCallback)(((e,t)=>{const s=t.type;return L.fm(e,t,h??{}).map((e=>{let[t,n]=e;return{key:t,title:null==n?void 0:n.name,icon:(0,x.jsx)(I.ZP,{size:16,style:l.propertyIcon,theme:d,icon:null==n?void 0:n.icon,type:(null==n?void 0:n.type)||s})}}))}),[d,l.propertyIcon,h]),te=(0,n.useCallback)((e=>{const t=null==y?void 0:y[e],n={width:16,height:16,marginRight:10};if(!t)return null;const i=[...ee(e,t),{key:o.bK,title:s.formatMessage(J.createNew),icon:(0,Z.R)({width:n.width,fill:l.propertyIcon.fill}),type:void 0}],a=b[e],r=null==h?void 0:h[a||""],d=!a&&p,c=e===o.Es.Status;let m=null;return a===o.bK?m=(0,Z.R)(n):r&&(m=I.wG[null==r?void 0:r.type](n)),(0,x.jsx)(q.ZP,{popupType:q.Z4.Popup,renderOrigin:t=>(0,x.jsxs)("div",{style:{marginBottom:24},children:[(0,x.jsx)(f.Z,{style:l.perPropertyInstruction,children:(0,x.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.PerPropertyInstructions",defaultMessage:"Pick the property that represents {propertyDescription}",values:{propertyDescription:s.formatMessage(X[e])}})}),(0,x.jsx)(z.Z,{focused:!1,right:(0,x.jsxs)("div",{style:l.propertyMappingDropdown,children:[d?(0,x.jsx)("span",{style:l.requiredPropertyError,children:(0,x.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.RequiredPropertyError",defaultMessage:"Required"})}):void 0,(0,P.i)({...l.chevronDownIconEnabled,...d?{fill:T.ZP.red}:{}})]}),title:(0,x.jsxs)("span",{style:{display:"inline-flex",alignItems:"center"},children:[m,a===o.bK?s.formatMessage(J.createNew):r?r.name:s.formatMessage(J.select)]}),titleStyle:a?{display:"flex",alignItems:"center"}:l.propertyMappingTitle,itemMarginLeft:8,style:{...l.propertyMappingMenu,...d?{borderColor:T.ZP.red}:{}},buttonStyle:{margin:0,width:"100%"},...t}),c&&j&&(0,x.jsx)(f.Z,{isSmall:!0,isMultiline:!0,children:(0,x.jsx)("div",{style:l.checkboxMappingInfo,children:(0,x.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxMappingInfo",defaultMessage:"{checkboxPropertyName} will be converted to a Status property type.",values:{checkboxPropertyName:(null==r?void 0:r.name)||s.formatMessage(J.checkboxPropertyType)}})})})]}),placementToOrigin:U.Iw.Bottom,alignmentToOrigin:U.lU.Start,render:t=>{const s=[{key:"propertyOptions",render:e=>(0,x.jsx)(Q.Z,{...e,topBorder:0!==e.index}),items:i.map((s=>({key:s.key,render:t=>(0,x.jsx)(z.Z,{...t,icon:s.icon,title:s.title,checkState:b[e]===s.key}),action:()=>{M({...b,[e]:s.key}),g(!1),t.close()}})))}],n={menuType:N.og.Popup,width:280};return(0,x.jsx)(G.Z,{...n,children:(0,x.jsx)(H.Z,{type:H.i.Vertical,initialFocus:void 0,sections:s})})}},e)}),[s,l,b,p,y,h,ee,j]),se=(0,x.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Title",defaultMessage:"{databaseType} databases require status, assignee, and due date properties.",values:{databaseType:(0,F.kC)((0,O.sN)(c))}}),ne=(0,n.useCallback)((()=>{const e=m.collectionStore(),n=m.collectionViewBlockStore();e&&n&&(!function(e){return!Object.values(e).includes(void 0)}(b)?g(!0):R.createAndCommit({userAction:"CollectionTypedDatabaseMigrationModal.migrateDatabase",environment:t,perform:i=>{D.vD({environment:t,collectionViewBlockStore:n,collectionStore:e,databaseType:c,propertyMapping:{...b},typedPropertySchemas:{...y},transaction:i}),a.Z.setState({isModalOpen:!1,collectionContextStore:void 0}),c===o.iS&&(E.y.locallyMutatedTasksDatabase=!0),_.g2({environment:t,database_type:c,property_mapping:b,collectionContextStore:m}),A.d4({item:{label:(0,x.jsx)(u.FormattedMessage,{defaultMessage:"{databaseName} has been turned into a {singularType} database. You will now be able to see your assigned tasks in <a>Home</a>.",id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.SuccessfulTypingToastMessage",values:{singularType:(0,O.sN)(c),databaseName:e.getName()||s.formatMessage(J.defaultCollectionName),a:e=>(0,x.jsx)("a",{style:l.a,href:$,children:e})}}),durationMs:W.JY},undoFunc:()=>{R.createAndCommit({environment:t,userAction:"CollectionTypedDatabaseMigrationModal.TypedDBConversionToast.Undo",perform:e=>{D.RQ({environment:t,collectionContextStore:m,transaction:e})}})}})}}))}),[$,s,l.a,t,c,y,b,m]);return(0,x.jsxs)("div",{style:l.propertyMappingForm,children:[(0,x.jsx)(f.Z,{style:l.propertyMappingInstructions,isMultiline:!0,children:se}),(0,x.jsx)("div",{children:Object.entries(v).map((e=>{let[t,s]=e;return te(t)}))}),(0,x.jsx)(K.Z,{style:l.submitMigrationButton,onClick:ne,children:(0,x.jsx)(u.FormattedMessage,{defaultMessage:"Turn into {type} database",id:"CollectionTypedDatabaseMigrationModal.ConfirmMigration.Title",values:{type:(0,O.sN)(c)}})}),(0,x.jsx)(Y.Z,{title:(0,x.jsx)(u.FormattedMessage,{id:"CollectionTypedDatabaseMigrationModal.Info",defaultMessage:"Learn about {type} databases",values:{type:(0,O.sN)(c)}}),analyticsFrom:"set_database_type",href:V.h5,style:l.learnMore,buttonStyle:{display:"inline-flex",justifyContent:"center",width:"100%",height:32}})]})}const J=(0,u.defineMessages)({createNew:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CreateNew",defaultMessage:"Create new"},select:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.Select",defaultMessage:"Select..."},defaultCollectionName:{id:"CollectionTypedDatabaseMigrationModal.PropertyMappingToastSuccess.DefaultCollectionName",defaultMessage:"This database"},checkboxPropertyType:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.CheckboxPropertyType",defaultMessage:"Checkbox"},taskStatus:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskStatus",defaultMessage:"status"},taskAssignee:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskAssignee",defaultMessage:"assignee"},taskDueDate:{id:"CollectionTypedDatabaseMigrationModal.PropertyMapping.TaskDueDate",defaultMessage:"due date"}}),X={[o.Es.Status]:J.taskStatus,[o.Es.Assign]:J.taskAssignee,[o.Es.DueDate]:J.taskDueDate};var ee=s(50506);function te(){window.__c={n:"CollectionTypedDatabaseMigrationModal"};const e=(0,i.VK)((()=>a.Z.state),[]),t=e.isModalOpen;return t?(0,x.jsx)(ee.Z,{open:t,onDismiss:()=>a.Z.reset(),render:()=>t?(0,x.jsxs)("div",{style:{display:"flex"},children:[(0,x.jsx)(b,{}),(0,x.jsx)($,{databaseType:o.iS,collectionContextStore:e.collectionContextStore})]}):null}):null}},44514:(e,t,s)=>{s.d(t,{Q:()=>l});s(67294);var n=s(82990),i=s(52821),o=s(85893);const a={...n.Z.textOverflowStyle,position:"absolute",left:0,right:0,top:0,bottom:0},r={marginLeft:4,fontWeight:n.Z.fontWeight.semibold};function l(e){const{prefix:t,viewName:s,viewType:n}=e;return(0,o.jsxs)("div",{style:{position:"relative",width:"100%"},children:[" ",(0,o.jsxs)("div",{style:a,children:[t,n&&i.aW[n]({marginLeft:8,marginRight:2,width:"1em",display:"inline",verticalAlign:"bottom"}),(0,o.jsx)("span",{style:r,children:s})]})]})}},81933:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});s(67294);var n=s(83355),i=s(480),o=s(24405),a=s(41892),r=s(8848),l=s(64275),d=s(45137),c=s(30845),u=s(72126),m=s(82990),p=s(9291),g=s(86572),h=s(33929),f=s(49085);class x extends f.default{getInitialState(){return{step:"initial"}}}const y=x;var S=s(73796),v=s(37240),b=s(52275),M=s(63296),j=s(14871),w=s(85893);const C=(0,p.injectIntl)((function(e){window.__c={n:"ContactModalQuestionSelect"};const t=(0,i.O7)(),s=(0,o.Fg)(),{inputStyle:n}=(0,o.yK)((e=>{const{device:s}=t;return{inputStyle:{backgroundColor:e.whiteButtonBackground,height:31,...s.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:4,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${e.outlineButtonBorder}`,background:e.buttonBackground}}}),[t]),{intl:a,question:l}=e,d={setup_trial:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_enterprise_trial:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_business_trial:(0,w.jsx)(p.FormattedMessage,{id:"contactModalQuestionSelect.question.setup_business_trial",defaultMessage:"Setup a business trial"}),live_demo:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"}),plan_help:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"}),other:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"})},c={menuTitle:a.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:["setup_enterprise_trial","setup_business_trial","live_demo","plan_help","other"],width:"auto",minWidth:280,getKey:e=>e,selectedItem:l,originGap:4,onSelect:t=>{e.onSelect(t)},renderItem:e=>(0,w.jsx)(b.Z,{title:d[e.key],...e}),renderOrigin:t=>(0,w.jsxs)(M.Z,{...t,isLarge:!0,style:{...n,...e.invalid&&{border:`1px solid ${r.ZP.red}`}},children:[(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",color:l?s.regularTextColor:s.lightTextColor},children:l?d[l]:(0,w.jsx)(p.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})}),(0,v.s)({width:10,fill:s.lightIconColor})]})};return(0,w.jsx)(j.Z,{...c},"onboarding")}));var k=s(23063),T=s(42922),I=s(64921),P=s(74194),Z=s(3386),F=s(50506),_=s(89728),A=s(26388),R=s(29551);const D=(0,p.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});class B extends n.Z{constructor(){super(...arguments),this.storeTypes={store:y},this.renderMenu=()=>{return(0,w.jsxs)("div",{style:(e=this.theme,{background:e.popoverBackground,borderRadius:5,boxShadow:e.mediumBoxShadow}),children:[(0,w.jsx)(z,{}),(0,w.jsx)(R.gq,{style:{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"},alignItems:"center",alignContent:"center",children:this.renderStep()})]});var e},this.renderInitial=()=>{const{invalidField:e}=this.stores.store.state;if(S.Z.state.open)return(0,w.jsxs)("div",{style:{...this.getSlideUpStyle(),padding:20},children:[(0,d.o)({width:"100%",height:24}),(0,w.jsx)("div",{style:{fontSize:14,fontWeight:m.Z.fontWeight.semibold,paddingTop:6,paddingBottom:4},children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})}),(0,w.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:200,margin:"0 auto"},children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})}),(0,w.jsx)("div",{style:{...V(this.theme),marginTop:24},children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})}),(0,w.jsx)(P.Z,{focusInitial:!0,value:this.getName(),placeholder:"Ada Lovelace",style:{marginRight:4,...U(this.theme),..."name"===e&&O()},onChange:e=>{S.Z.setState({...S.Z.state,open:!0,name:void 0}),this.stores.store.setState({...this.stores.store.state,name:e.target.value}),g.QO(this.environment,{contactFieldType:"name",contactFieldValue:e.target.value})}}),(0,w.jsx)("div",{style:V(this.theme),children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})}),(0,w.jsx)(P.Z,{value:this.getEmail(),placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...U(this.theme),..."email"===e&&O()},onChange:e=>{S.Z.setState({...S.Z.state,open:!0,email:void 0}),this.stores.store.setState({...this.stores.store.state,email:e.target.value}),g.QO(this.environment,{contactFieldType:"email",contactFieldValue:e.target.value})}}),(0,w.jsx)("div",{style:V(this.theme),children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})}),(0,w.jsx)(R.gq,{children:[{type:"1_100",message:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}].map((e=>{let{type:t,message:s,style:n}=e;return(0,w.jsx)(_.Z,{isLightGray:!0,isLarge:!0,style:{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center",...this.stores.store.state.companySize===t&&{color:r.ZP.blue,border:`1px solid ${r.ZP.blue}`},...n},onClick:()=>{this.stores.store.setState({...this.stores.store.state,companySize:t}),g.QO(this.environment,{contactFieldType:"companySize",contactFieldValue:t})},children:s},t)}))}),(0,w.jsx)("div",{style:V(this.theme),children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})}),(0,w.jsx)(C,{question:this.getQuestion(),invalid:"question"===e,onSelect:e=>{this.stores.store.setState({...this.stores.store.state,question:e,step:"other"===e?"additional_input":"initial"}),g.QO(this.environment,{contactFieldType:"question",contactFieldValue:"other"===e?"additional_input":"initial"})}}),(0,w.jsx)(P.Z,{textarea:!0,textareaElementAttributes:{style:{width:"100%",height:"100%",background:"none",border:"none",resize:"none"}},style:this.getTextAreaStyle(),focus:"additional_input"===this.stores.store.state.step,value:this.stores.store.state.additionalFeedback,placeholder:h.default.formatMessage(D.additionalFeedbackPlaceholder),onChange:e=>{this.stores.store.setState({...this.stores.store.state,additionalFeedback:e.target.value}),g.QO(this.environment,{contactFieldType:"additionalFeedback",contactFieldValue:e.target.value})}})]})}}renderComponent(){return(0,w.jsx)(F.Z,{preventHideChildrenWhileOpening:!0,open:S.Z.state.open,render:this.renderMenu,onDismiss:K})}renderStep(){const{step:e,companySize:t}=this.stores.store.state,s="1_100"===t;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(k.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,w.jsx)(Z.Z,{capture:!0,onBackspace:u.yR,onLeft:u.yR,onRight:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:u.yR,onDelete:u.yR,onTab:u.yR,children:this.renderInitial()})}),(0,w.jsx)(k.Z,{isVisible:"thanks"===e,animationStyle:(n="thanks"===e,{opacity:n?1:0,scale:n?1:.96}),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:()=>(0,w.jsx)(W,{})}),(0,w.jsx)(k.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,w.jsx)(A.ZP,{style:{width:"auto"},textWrap:!0,renderTooltip:()=>s?(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.companySize.error.label",defaultMessage:"The company size selected is not eligible for a sales assisted plan. Please message support if you have any questions."}):null,render:e=>(0,w.jsx)(T.Z,{...e,disabled:s,isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=this.getInvalidField();if(e){const{question:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,step:"initial",invalidField:e,question:"other"===t?this.getQuestion():t})}else this.stores.store.setState({...this.stores.store.state,invalidField:void 0,step:"thanks"}),S.Z.state.open&&g.Ls(this.environment,{email:S.Z.state.email,name:S.Z.state.name,question:S.Z.state.question,...this.stores.store.state}),u.gw((()=>{S.Z.reset(),u.gw((()=>{this.stores.store.reset()}),1e3)}),2e3)},children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"})})})})]});var n}getName(){if(S.Z.state.open)return this.stores.store.state.name||S.Z.state.name}getEmail(){if(S.Z.state.open)return this.stores.store.state.email||S.Z.state.email}getQuestion(){if(S.Z.state.open)return this.stores.store.state.question||S.Z.state.question}getInvalidField(){const e=this.getEmail(),t=this.getName(),{companySize:s}=this.stores.store.state;return t?e&&c.B(e,"email")?s?this.getQuestion()?void 0:"question":"company_size":"email":"name"}getSlideUpStyle(){const{step:e}=this.stores.store.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(153px)":"translateY(-180px)"}}getTextAreaStyle(){return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===this.stores.store.state.step?1:.001}}}B.displayName="ContactModal";const L=B;function O(){return{border:`1px solid ${r.ZP.red}`}}function E(e){return{color:e.regularTextColor,fontWeight:m.Z.fontWeight.semibold,fontSize:14}}function N(e){return{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}function V(e){return{marginTop:17,fontSize:12,color:e.mediumTextColor,fontWeight:m.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}function U(e){return{backgroundColor:e.whiteButtonBackground,height:31}}function W(){window.__c={n:"ThanksComponent"};const e=(0,o.Fg)();return(0,w.jsxs)("div",{children:[(0,w.jsx)("img",{style:{width:165,height:80},src:a.Z.images.feedbackThankYouPng}),(0,w.jsx)("div",{style:E(e),children:(0,w.jsx)(p.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."})})]})}function K(){S.Z.setState({open:!1})}function z(){window.__c={n:"CancelComponent"};const e=(0,o.Fg)(),t=(0,i.O7)();return(0,w.jsx)(I.Z,{onClick:()=>{g.g3(t),K()},style:N(e),hoveredStyle:{background:e.buttonPressedBackground},children:(0,l.D)({width:14,fill:e.mediumTextColor})})}},85324:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(67294),i=s(480),o=s(24405),a=s(41892),r=s(86658),l=s(82990),d=s(63143),c=s(9291),u=s(50950),m=s(36867),p=s(45293),g=s(10182),h=s(42922),f=s(89728),x=s(92660),y=s(29551),S=s(85893);function v(){window.__c={n:"SaveAllButton"};const e=(0,o.yK)(j,[]),t=(0,i.O7)();return(0,S.jsx)(h.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),p.Z.setState({open:!1}),u.qo()},children:(0,S.jsx)(c.FormattedMessage,{...r.ze.acceptAllButtonLabel})})}function b(){window.__c={n:"RejectAllButton"};const e=(0,o.yK)(j,[]),t=(0,i.O7)();return(0,S.jsx)(f.Z,{isLarge:!0,isGray:!0,style:e.moreOptionsButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),p.Z.setState({open:!1}),u.qo()},children:(0,S.jsx)(c.FormattedMessage,{...r.ze.rejectAllButtonLabel})})}function M(){window.__c={n:"MoreOptionsButton"};const e=(0,o.yK)(j,[]);return(0,S.jsx)(g.Z,{hasDismissButton:!0,onDismiss:()=>{p.Z.setState({open:!1})},renderOrigin:t=>(0,S.jsx)(f.Z,{...t,isLarge:!0,isGray:!0,style:e.moreOptionsButton,children:(0,S.jsx)(c.FormattedMessage,{...r.ze.moreOptionsButtonLabel})})})}function j(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:l.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const w=(0,c.injectIntl)((function(){window.__c={n:"CookieModal"};const e=(0,i.O7)().currentUser.id;(0,n.useEffect)((()=>{if(!e)return;(0,m._)(e);const t=window.setInterval((()=>{(0,m._)(e)}),d.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,o.yK)(j,[]);return(0,S.jsx)(x.Z,{onDismiss:()=>{},render:()=>(0,S.jsx)("div",{style:t.modal,children:(0,S.jsxs)(y.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,S.jsx)("img",{style:t.image,src:a.Z.images.feedbackThankYouPng}),(0,S.jsx)("div",{style:t.title,children:(0,S.jsx)(c.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,S.jsx)("div",{style:t.description,children:(0,r.Fd)(u.Tz,"banner")}),(0,S.jsx)(v,{}),(0,S.jsx)(b,{}),(0,S.jsx)(M,{})]})}),requireOnline:!0,modalStore:p.Z})}))},49788:(e,t,s)=>{s.r(t),s.d(t,{default:()=>K});s(67294);var n=s(83355),i=s(18466),o=s(480),a=s(86628),r=s(24405),l=s(41892),d=s(64275),c=s(60651),u=s(91427),m=s(95094),p=s(72126),g=s(82990),h=s(51454),f=s(9291),x=s(54642),y=s(73409),S=s(62992);function v(e,t,s){if(s){const{templateId:n}=s;return e.some((e=>e.milestone===t&&e.template_id===n))}return e.some((e=>e.milestone===t))}var b=s(33929),M=s(38755),j=s(80444),w=s(4926),C=s(49085);const k="rate",T="send",I="thanks";class P extends C.default{getInitialState(){return{starRating:void 0,step:k}}}const Z=P;var F=s(5188),_=s(35057),A=s(23063),R=s(42922),D=s(64921),B=s(74194),L=s(3386),O=s(31278),E=s(29551),N=s(85893);const V={display:"flex",alignItems:"center",flexDirection:"column"},U=(0,f.defineMessages)({additionalFeedbackPlaceholder:{id:"csatPopup.additionalFeedback.placeholder",defaultMessage:"Tell us more..."}});class W extends n.Z{constructor(){super(...arguments),this.storeTypes={csatPopupStore:Z},this.renderStep=()=>{const{step:e}=this.stores.csatPopupStore.state,{currentSpaceStore:t}=j.default.state;let s;if(t){const e=t.getInitialUseCases();e&&(s=p.UP(e))}return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(A.Z,{isVisible:e===k,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0,translateY:-120},render:()=>(0,N.jsxs)("div",{style:{paddingBottom:40},children:[(0,N.jsx)(G,{}),(0,N.jsx)(ee,{useCase:s})]})}),(0,N.jsx)(A.Z,{isVisible:e===k||e===T,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,N.jsxs)("div",{style:this.getSlideContainerStyle(),children:[this.renderStars(s),this.renderInput(),this.renderSendButton()]})}),(0,N.jsx)(A.Z,{isVisible:e===I,animationStyle:q(e===I),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:()=>(0,N.jsx)(X,{})})]})},this.renderInput=()=>{const{step:e,additionalFeedback:t}=this.stores.csatPopupStore.state;return(0,N.jsx)(L.Z,{capture:!0,onBackspace:p.yR,onLeft:p.yR,onRight:p.yR,onSelectAll:p.yR,onRedo:p.yR,onUndo:p.yR,onCut:p.yR,onCopy:p.yR,onPaste:p.yR,onKeypress:p.yR,onDelete:p.yR,onTab:p.yR,children:(0,N.jsx)(B.Z,{textarea:!0,style:this.getInputContainerStyle(),focus:e===T,value:t,placeholder:b.default.formatMessage(U.additionalFeedbackPlaceholder),onChange:e=>{this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,additionalFeedback:e.target.value})}})})},this.renderSendButton=()=>(0,N.jsx)(R.Z,{isLarge:!0,style:{width:"calc(100% - 30px)"},onClick:this.handleSend,children:(0,N.jsx)(f.FormattedMessage,{id:"csatPopup.sendButton.label",defaultMessage:"Send"})}),this.renderStars=e=>{const{starRating:t,step:s}=this.stores.csatPopupStore.state,n=e=>{let{rating:n}=e;return(0,N.jsxs)("div",{style:{display:"inline-flex",position:"relative",width:20,height:20,marginRight:3},onMouseEnter:()=>{s===k&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:n})},onClick:()=>{this.stores.csatPopupStore.setState({starRating:n,step:T})},children:[(0,u.e)({width:18,fill:this.theme.mediumIconColor,position:"absolute",opacity:t&&t>=n?0:1}),(0,m.p)({width:18,fill:"#F6C050",position:"absolute",opacity:t&&t>=n?1:0})]})},i=()=>{const s=z(e);switch(t){case 1:return s?(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Very unlikely",id:"csatPopup.stars.1StarLabelNps"}):(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Very dissatisfied",id:"csatPopup.stars.1StarLabel"});case 2:return s?(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Somewhat unlikely",id:"csatPopup.stars.2StarLabelNps"}):(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Somewhat dissatisfied",id:"csatPopup.stars.2StarLabel"});case 3:return s?(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Not likely nor unlikely",id:"csatPopup.stars.3StarLabelNps"}):(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Not dissatisfied nor satisfied",id:"csatPopup.stars.3StarLabel"});case 4:return s?(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Somewhat likely",id:"csatPopup.stars.4StarLabelNps"}):(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Somewhat satisfied",id:"csatPopup.stars.4StarLabel"});case 5:return s?(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Very likely",id:"csatPopup.stars.5StarLabelNps"}):(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Very satisfied",id:"csatPopup.stars.5StarLabel"});default:return(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Select an option",id:"csatPopup.stars.notSpecifiedLabel"})}};return(0,N.jsxs)("div",{onMouseLeave:()=>{p.gw((()=>{this.stores.csatPopupStore.state.step===k&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:void 0})}),500)},style:{width:"100%",...V},children:[(0,N.jsxs)("div",{style:{display:"flex",cursor:"pointer"},children:[(0,N.jsx)(n,{rating:1}),(0,N.jsx)(n,{rating:2}),(0,N.jsx)(n,{rating:3}),(0,N.jsx)(n,{rating:4}),(0,N.jsx)(n,{rating:5})]}),(0,N.jsx)("div",{style:(o=this.theme,{fontSize:12,color:o.mediumTextColor,paddingTop:4}),children:(0,N.jsx)(i,{})})]});var o},this.handleSend=async()=>{const{additionalFeedback:e,starRating:t}=this.stores.csatPopupStore.state,{currentSpaceStore:s}=j.default.state;if(!s||!t)return;const{state:n}=F.Z;if(!n.open)return;const{open:i,...o}=n,a="passive"===o.type?await x.submitCsatFeedback(this.environment,{spaceId:s.id,rating:t,additionalFeedback:e,type:o.type,milestone:void 0,templateId:void 0}):await x.submitCsatFeedback(this.environment,{spaceId:s.id,rating:t,additionalFeedback:e,templateId:void 0,...o});if("success"!==a.type)throw a.error;this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,step:I}),p.gw((()=>{F.Z.setState({...F.Z.state,open:!1}),p.gw((()=>{this.stores.csatPopupStore.reset()}),1e3)}),2e3)}}UNSAFE_willMount(){const{userSettingsStore:e,blockStore:t,spaceStore:s}=this.props;if(e&&t&&s){const n=this.environment;if("CsatMilestoneStore"in n){const o=i.Z.withListenerIgnored((()=>function(e,t){const{userSettingsStore:s,blockStore:n,spaceStore:i}=t,o=s.getSettings(),a=null==o?void 0:o.signup_time,{CsatMilestoneStore:r}=e,{data:l}=r.state,d=864e5,c=e=>Math.floor((Date.now()-e)/d);if(!i.isDefined()||!l)return;const{milestones:u}=l;if(!u)return;if(Math.max(...u.map((e=>e.created_time)))>Date.now()-24192e5)return;if(a){const e=c(a),t=p.UP(i.getInitialUseCases())||"legacy";if(e>=180){if(!v(u,y.Hf))return{milestone:y.Hf,useCase:t}}else if(e>=90){if(!v(u,y.Vx))return{milestone:y.Vx,useCase:t}}else if(e>=28){if(!v(u,y.Sh))return{milestone:y.Sh,useCase:t}}else if(e>=7&&!v(u,y.zK))return{milestone:y.zK,useCase:t}}const m=n.getCopiedFromPointer();return n.isDefined()&&m&&(0,S.J)(m)&&c(n.getCreatedTime())>=7&&!v(u,y.a0,{templateId:m.id})?{milestone:y.a0,useCase:"legacy",templateId:m.id}:void 0}(n,{userSettingsStore:e,blockStore:t,spaceStore:s})));if(o){const{milestone:e,useCase:t,templateId:s}=o;p.gw((()=>{F.Z.setState({open:!0,milestone:e,type:"trigger",useCase:t,templateId:s})}),2e3)}}}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const{currentSpaceStore:t}=j.default.state,s=w.Z.state;return t&&!(0,M.Cx)(t)?(0,N.jsx)(A.Z,{isVisible:F.Z.state.open,animationStyle:q(F.Z.state.open),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},springConfig:{scale:{stiffness:58,damping:4.3}},render:()=>(0,N.jsxs)("div",{style:$(this.theme,s),children:[(0,N.jsx)(te,{}),(0,N.jsx)("div",{style:{...V,width:240,height:195,overflow:"hidden",position:"relative",padding:12,cursor:"default",textAlign:"center",justifyContent:"center"},children:this.renderStep()})]})}):void 0}getInputContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{width:"calc(100% - 30px)",display:"block",background:this.theme.popoverBackground,height:80,marginTop:10,marginBottom:10,opacity:e===k?0:1}}getSlideContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{...V,position:"absolute",transition:"transform 200ms ease",width:240,transform:e===k?"translateY(120px)":"translateY(0px)"}}}W.displayName="CsatPopup";const K=(0,f.injectIntl)(W);function z(e){const t=(0,_.zt)(),{state:s}=F.Z,n=s.open&&"trigger"===s.type;return"enterprise"===t&&!e&&n}function q(e){return{opacity:e?1:0,scale:e?1:.96}}function G(){window.__c={n:"IconComponent"};const e=(0,a.VK)((()=>{var e;return null===(e=j.default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.getIcon()}),[]);return e?(0,N.jsx)(E.gq,{justifyContent:"center",alignItems:"center",children:(0,N.jsx)(O.Z,{icon:e,isEmptyPage:!1,size:32,disabled:!0})}):(0,N.jsx)(E.gq,{justifyContent:"center",alignItems:"center",children:(0,c.h)({width:32,height:32})})}function H(e){return{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14}}function Q(e){return{color:e.mediumTextColor,fontSize:12}}function Y(e){return{paddingTop:12,paddingBottom:12,color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14,lineHeight:1.4,width:188}}function $(e,t){return{background:e.popoverBackground,borderRadius:5,boxShadow:e.mediumBoxShadow,position:"absolute",bottom:65+t,right:16+t,zIndex:h.hT}}function J(e){return{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}function X(){window.__c={n:"ThanksComponent"};const e=(0,r.Fg)();return(0,N.jsxs)("div",{children:[(0,N.jsx)("img",{style:{width:165,height:80},src:l.Z.images.feedbackThankYouPng}),(0,N.jsx)("div",{style:H(e),children:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Thanks for your feedback!",id:"csatPopup.thanks.header"})}),(0,N.jsx)("div",{style:Q(e),children:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"Your feedback will help us make Notion better.",id:"csatPopup.thanks.description"})})]})}function ee(e){let{useCase:t}=e;window.__c={n:"FeedbackPromptComponent"};const s=(0,r.Fg)();switch(t){case"doc_notes":return(0,N.jsx)("div",{style:Y(s),children:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for notes & docs?",id:"csatPopup.feedbackPrompt.docNotesLabel"})},"feedback-prompt");case"project_management":return(0,N.jsx)("div",{style:Y(s),children:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"How satisfied are you with managing projects and tasks in Notion?",id:"csatPopup.feedbackPrompt.projManagementLabel"})},"feedback-prompt");case"wiki":return(0,N.jsx)("div",{style:Y(s),children:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for team wikis?",id:"csatPopup.feedbackPrompt.wikiLabel"})},"feedback-prompt");default:return z(t)?(0,N.jsx)("div",{style:Y(s),children:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"How likely are you to recommend Notion to a friend?",id:"csatPopup.feedbackPrompt.enterpriseDefaultLabel"})},"feedback-prompt"):(0,N.jsx)("div",{style:Y(s),children:(0,N.jsx)(f.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion? ",id:"csatPopup.feedbackPrompt.defaultlabel"})},"feedback-prompt")}return null}function te(){window.__c={n:"CancelComponent"};const e=(0,r.Fg)(),t=(0,o.O7)();return(0,N.jsx)(D.Z,{onClick:()=>async function(e){const{state:t}=F.Z;if(!t.open)return;const{open:s,...n}=t;if(s&&"trigger"===n.type){const{currentSpaceStore:t}=j.default.state;if(!t)return;await x.submitCsatFeedback(e,{spaceId:t.id,rating:void 0,additionalFeedback:void 0,templateId:void 0,...n})}F.Z.setState({...F.Z.state,open:!1})}(t),style:J(e),hoveredStyle:{background:e.buttonPressedBackground},children:(0,d.D)({width:14,fill:e.mediumTextColor})})}},42607:(e,t,s)=>{s.r(t),s.d(t,{default:()=>re});s(67294);var n=s(480),i=s(86628),o=s(9291),a=s(79257),r=s(11599),l=s(80444),d=s(85680),c=s(88923),u=s(53437),m=s(83355),p=s(24405),g=s(15145),h=s(6695),f=s(9999),x=s(90199),y=s(98634),S=s(92607),v=s(37888),b=s(72126),M=s(82990),j=s(50906),w=s(96802),C=s(82530),k=s(84210),T=s(87279),I=s(18514),P=s(92547),Z=s(26136),F=s(81870),_=s(26909),A=s(44514),R=s(79131),D=s(84076),B=s(78140),L=s(28992),O=s(40721),E=s(89728),N=s(31278),V=s(76798),U=s(72495),W=s(49085),K=s(61766),z=s(43700),q=s(69872),G=s(85893);class H extends m.Z{constructor(){super(...arguments),this.storeTypes={hovered:W.default.createClass(!1),buttonPopupStore:W.default.createClass(new K.Z)}}renderComponent(){const{schema:e,property:t,format:s,showAsSectionMenu:n,handlePageSectionClick:i}=this.props,o=e[t];if(!o)return;const l=function(e,t){switch(t){case"hide_if_empty":return r.kq({propertySchema:e})?"hide_if_empty":"show";default:return t}}(o,this.props.visibility);return(0,G.jsx)(q.Z,{onMouseEnter:()=>this.stores.hovered.setState(!0),onMouseLeave:()=>this.stores.hovered.setState(!1),focused:this.stores.hovered.state,showDragHandle:!this.environment.device.isMobile,showExtensionArrow:!1,propertySchema:o,format:q.L.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:this.props.locked,onClick:()=>{if(!this.props.locked){const e=this.stores.buttonPopupStore.state;e.setState({open:!e.state.open})}},right:n&&i?(0,G.jsx)(z.Z,{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:l,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:this.props.locked,onSelect:e=>i(e,t,s),onClose:()=>this.stores.hovered.setState(!1),type:"relation_property",propertySchema:o,showAsMenu:!0}):(0,G.jsx)(z.Z,{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:l,locked:this.props.locked,onSelect:e=>function(e,t,s,n,i){C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:i,perform:i=>{a.M0({property:t,visibility:e,format:s,store:n,transaction:i})}})}(e,this.props.property,this.props.format,this.props.store,this.environment),onClose:()=>this.stores.hovered.setState(!1),type:"property",propertySchema:o})},t)}}H.displayName="CustomizePageMenuPropertyMenuItem";const Q=H;class Y extends m.Z{constructor(){super(...arguments),this.storeTypes={lockStore:P.Z},this.handleToggleLockClick=()=>{const e=r.$0();if(!e)return!1;const t=e.getParentBlockStore();t&&(C.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:this.environment,perform:e=>{w.Wq({environment:this.environment,store:t,isLocked:!r.p1(),transaction:e})}}),this.stores.lockStore.setState({justUnlocked:!this.stores.lockStore.state.justUnlocked}))}}renderComponent(){const{device:e}=this.environment,t=this.createComputedStore((()=>"page"===this.props.type?this.props.store.isExternalObjectInstancePageBlockStore():this.props.store.isSyncedCollection()));let s;s=e.isMobile?{menuType:T.og.Modal,right:(0,G.jsx)(O.DoneMenuText,{}),onClickRight:a.xv,title:this.props.intl.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:T.og.Popup,minWidth:400};const n=ee(this.props.store,X({store:this.props.store,type:this.props.type}));return(0,G.jsxs)(B.Z,{...s,header:(0,G.jsx)(se,{store:this.props.store,type:this.props.type}),children:[(this.props.locked||this.stores.lockStore.state.justUnlocked)&&this.renderLockControls(),this.renderPageSectionsSectionMenuItem(n,t.state),(0,G.jsx)(ae,{type:this.props.type,locked:this.props.locked,store:this.props.store,format:n})]})}renderLockControls(){return(0,G.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${this.theme.regularDividerColor}`,borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.sidebarBackground,color:this.theme.mediumTextColor,paddingTop:6,paddingBottom:6},children:[(0,G.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:this.stores.lockStore.state.justUnlocked?(0,v.U)({height:12,width:12,fill:this.theme.mediumIconColor}):(0,x.b)({height:12,width:12,fill:this.theme.mediumIconColor})}),this.stores.lockStore.state.justUnlocked?(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),(0,G.jsx)(E.Z,{style:{fontSize:12,color:this.theme.mediumTextColor,fontWeight:M.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:this.handleToggleLockClick,children:this.stores.lockStore.state.justUnlocked?(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})})]})}renderPageSectionsSectionMenuItem(e,t){const s=this.props.store,n=X(this.props);if(!n||!s)return;const i=J(e);if(!i)return;const{pageSectionVisibility:l}=i;if(!l)return;const d=te(this.props),c=d.map((e=>e.section)),u={topLevelDiscussions:!t,backLinks:!0,pageComments:!t};return(0,G.jsx)(G.Fragment,{children:(0,G.jsx)(U.Z,{style:{opacity:this.props.locked?.5:1},title:(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:!this.props.locked&&!this.stores.lockStore.state.justUnlocked,children:(0,G.jsxs)("div",{style:{marginLeft:8},children:[c.length>0&&(0,G.jsxs)(U.Z,{style:{opacity:this.props.locked?.5:1,width:"100%",paddingBottom:0,paddingTop:0},children:[(0,G.jsx)(R.ZP,{direction:"vertical",keys:c,renderKey:t=>{if("collection"===this.props.type&&"inline"===(0,r.ab)(void 0,t))return(0,G.jsx)(ie,{locked:this.props.locked,schema:n,property:t,format:e})},onDrop:e=>ne(e,this.props.store,this.environment,d)}),(0,G.jsx)(R.ZP,{direction:"vertical",keys:c,renderKey:t=>{if("collection"===this.props.type&&"minimal"===(0,r.ab)(void 0,t))return(0,G.jsx)(ie,{locked:this.props.locked,schema:n,property:t,format:e})},onDrop:e=>ne(e,this.props.store,this.environment,d)})]}),u.topLevelDiscussions&&(0,G.jsx)(L.Z,{title:(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:(0,y.r)({height:16,width:16}),right:(0,G.jsx)(z.Z,{visibility:l.comments,visibilityLevels:["section_show","section_hide"],locked:this.props.locked,onSelect:t=>{a.W4({environment:this.environment,pageSection:"comments",visibility:t,store:s,format:e})},type:"page"})}),u.backLinks&&(0,G.jsx)(L.Z,{title:(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:(0,f.J)({height:16,width:16,transform:"rotate(180deg)"}),right:(0,G.jsx)(z.Z,{visibility:l.backlinks,locked:this.props.locked,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:t=>{a.W4({environment:this.environment,pageSection:"backlinks",visibility:t,store:s,format:e})},type:"page"})}),u.pageComments&&(0,G.jsx)(L.Z,{title:(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:(0,y.r)({height:16,width:16}),right:(0,G.jsx)(z.Z,{visibility:(0,r.ab)(l,"margin_comments"),visibilityLevels:["inline","minimal"],locked:this.props.locked,onSelect:t=>{a.W4({environment:this.environment,pageSection:"margin_comments",visibility:t,store:s,format:e})},type:"page"})})]})})})}}Y.displayName="CustomizePageMenu";const $=Y;function J(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}function X(e){let{type:t,store:s}=e;return s.getSchema()}function ee(e,t){const s=e.getFormat();if(!t)return{};return h.iB(s,t,void 0,h.j5.Collection)}function te(e){let{type:t,store:s}=e;if("collection"!==t)return[];return ee(s,X({type:t,store:s})).collection_page_sections||[]}function se(e){let{store:t,type:s}=e;window.__c={n:"Header"};const r=(0,n.O7)(),l=(0,i.VK)((()=>t&&t.getIcon()),[t]),d=(0,i.VK)((()=>"collection"===s?t.getParentBlockStore():void 0),[t,s]),c=(0,i.VK)((()=>{if(d)return(0,k.ZP)({store:d,fullyQualified:!1,pageVisitSource:g.tY.Breadcrumb})}),[d]);if(r.device.isMobile)return null;if(t){const e=l&&(0,G.jsx)(N.Z,{icon:l,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),s=(0,G.jsx)(V.Z,{store:t,style:{display:"inline"}}),n=d?(0,G.jsx)(A.Q,{prefix:(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in"}),viewName:d?(0,G.jsx)(G.Fragment,{children:(0,G.jsxs)(D.Z,{onClick:a.xv,href:c,inline:!0,children:[e,s]})}):(0,G.jsxs)(G.Fragment,{children:[e,s]})}):(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view"});return(0,G.jsx)(L.Z,{style:_.oq,title:n,right:(0,G.jsx)(F.Z,{helpButtonContext:"customize_page_menu",href:(0,I.UY)("guides.customizePageView")})})}return null}function ne(e,t,s,n){if(n){const i=e.map((e=>n.find((t=>t.section===e))));n&&C.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:s,perform:e=>{a.Do({environment:s,pageSectionFormats:i,store:t,transaction:e})}})}}function ie(e){var t;let{schema:s,property:o,format:l,locked:d}=e;window.__c={n:"RelationSectionMenuItemComponent"};const c=(0,p.Fg)(),u=(0,n.O7)(),m=(0,i.VK)((()=>(0,r.ab)(void 0,o)),[o]);return(0,G.jsx)("div",{style:{display:"inline-flex",width:"100%"},children:(0,G.jsx)(L.Z,{title:null===(t=s[o])||void 0===t?void 0:t.name,icon:(0,S.v)({height:14,width:14,color:c.mediumIconColor,fill:c.mediumIconColor,fontWeight:M.Z.fontWeight.medium}),disabled:d,showDragHandle:!u.device.isMobile,right:(0,G.jsx)(z.Z,{visibility:m,visibilityLevels:["section_hide","inline","minimal"],locked:d,onSelect:e=>{!function(e,t,s,n,i){const o=r.$0();if(!o)return!1;let l=n.collection_page_sections?b.Xh(n.collection_page_sections):[];if(!s[t])return;const d=l.findIndex((e=>e.section===t));-1!==d?l[d]={section:t,visibility:e}:l=[...l,{section:t,visibility:e}];const c="inline"===e||"minimal"===e?"section":"show";l&&(C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:i,perform:e=>{a.Do({environment:i,pageSectionFormats:l,store:o,transaction:e}),a.M0({property:t,visibility:c,store:o,format:n,transaction:e})}}),j.K1b(i,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))}(e,o,s,l,u)},type:"page",showAsMenu:!0})})})}function oe(e){let{keys:t,visibilityMap:s,format:o,onDrop:l,locked:d,store:c,type:u}=e;window.__c={n:"DraggablePagePropertiesComponent"};const m=(0,n.O7)(),p=(0,i.VK)((()=>X({store:c,type:u})),[c,u]);return c instanceof Z.NW?(0,G.jsx)(R.ZP,{direction:"vertical",keys:t,renderKey:e=>{var t;const n=null===(t=p[e])||void 0===t?void 0:t.type;if("collection"===u)return"relation"===n?(0,G.jsx)(Q,{schema:p,visibility:s[e],property:e,format:o,store:c,locked:d,showAsSectionMenu:!0,handlePageSectionClick:(e,t,s)=>function(e,t,s,n){const i=r.$0();if(!i)return;let o=s.collection_page_sections?b.Xh(s.collection_page_sections):[];if("inline"===e||"minimal"===e){const r=o.findIndex((e=>e.section===t));-1!==r?o[r]={section:t,visibility:e}:o=[...o,{section:t,visibility:e}];const l="inline"===e||"minimal"===e?"section":"show";o&&(C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:n,perform:e=>{a.Do({environment:n,pageSectionFormats:o,store:i,transaction:e}),a.M0({property:t,visibility:l,store:i,format:s,transaction:e})}}),j.K1b(n,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const o=h.AX.find((t=>t===e));if(!o)return;C.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:n,perform:e=>{a.M0({property:t,visibility:o,store:i,format:s,transaction:e})}}),j.K1b(n,{from:"page_properties",mode:"property"})}}(e,t,s,m)}):(0,G.jsx)(Q,{schema:p,visibility:s[e],property:e,format:o,store:c,locked:d})},onDrop:l}):null}function ae(e){let{format:t,type:s,locked:r,store:l}=e;window.__c={n:"PropertiesSectionMenuItemComponent"};const d=(0,n.O7)(),c=(0,i.VK)((()=>X({store:l,type:s})),[l,s]),u=(0,i.VK)((()=>te({store:l,type:s}).filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section))),[l,s]),m=(0,i.VK)((()=>function(e){let{type:t,store:s}=e;return"collection"!==t?[]:ee(s,X({type:t,store:s})).collection_page_properties||[]}({store:l,type:s})),[l,s]);if(!c||"page"===s)return null;const p=J(t);if(!p)return null;const{propertyVisibility:g}=p;if(!g)return null;const h=g.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),f=b.e5(m.map((e=>e.property)),u);return(0,G.jsx)(U.Z,{style:{opacity:r?.5:1},title:(0,G.jsx)(o.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"}),children:(0,G.jsx)(oe,{keys:f,visibilityMap:h,format:t,onDrop:e=>function(e,t,s,n){if(n){const i=e.map((e=>n.find((t=>t.property===e))));a.D2({environment:s,properties:i,store:t})}}(e,l,d,m),store:l,type:s,locked:r})})}const re=(0,o.injectIntl)((function(){window.__c={n:"CustomizePageMenuRenderer"};const e=(0,n.O7)(),{device:t}=e,s=(0,i.VK)((()=>d.Z.state),[]);return(0,G.jsx)(u.ZP,{popupType:t.isMobile?u.ZP.PopupType.SlideUp:u.ZP.PopupType.Popup,alignmentToOrigin:u.ZP.Alignment.Center,open:s.isOpen,render:()=>(0,G.jsx)(le,{}),originRect:s.isOpen?s.rect:void 0,onDismiss:()=>a.xv()})}));function le(){window.__c={n:"ModalComponent"};const e=(0,o.useIntl)(),t=(0,i.VK)((()=>d.Z.state),[]),s=(0,i.VK)((()=>r.$0()),[]),n=(0,i.VK)((()=>c.default.state.open&&c.default.state.target||l.default.state.mainEditorCurrentBlockStore),[]),a=(0,i.VK)((()=>r.p1()),[]);return t.isOpen?s?(0,G.jsx)($,{store:s,type:"collection",intl:e,locked:a}):n?(0,G.jsx)($,{store:n,type:"page",intl:e,locked:!1}):null:null}},43700:(e,t,s)=>{s.d(t,{P:()=>h,Z:()=>g});s(67294);var n=s(83355),i=s(42853),o=s(9291),a=s(61766),r=s(31194),l=s(31945),d=s(89728),c=s(6318),u=s(85893);const m=(0,o.defineMessages)({hideSimpleLabel:{id:"customizePageMenuVisibilitySelect.hideSimple.label",defaultMessage:"Hide"},hideLabel:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hidePageLabel:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"},showLabel:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},showPageLabel:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},hideIfEmptyLabel:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},collapsedLabel:{id:"customizePageMenuVisibilitySelect.collapsed.label",defaultMessage:"Show in popover"},defaultLabel:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimalLabel:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"},sectionLabel:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},propertyLabel:{id:"customizePageMenuVisibilitySelect.property.label",defaultMessage:"As property"}});class p extends n.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:a.Z}}renderComponent(){const{device:e}=this.environment;return(0,u.jsx)(l.ZP,{popupType:e.isMobile?l.Z4.SlideUp:l.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>(0,u.jsxs)(d.Z,{style:{color:this.theme.mediumTextColor,paddingRight:0,height:this.environment.device.isMobile?32:22},disabled:this.props.locked,...e,children:[h(this.props.visibility,this.props.showAsMenu),(0,i.i)({width:10,marginLeft:4,marginRight:4,fill:this.theme.lightIconColor})]}),placementToOrigin:r.Iw.Bottom,onClose:this.props.onClose,render:e=>(0,u.jsx)(c.Z,{...this.props,onClose:e.close})})}}p.displayName="CustomizePageMenuVisibilitySelect";const g=p;function h(e,t){switch(e){case"hide":return(0,u.jsx)(o.FormattedMessage,{...m.hideLabel});case"show":return(0,u.jsx)(o.FormattedMessage,{...m.showLabel});case"hide_if_empty":return(0,u.jsx)(o.FormattedMessage,{...m.hideIfEmptyLabel});case"section_hide":return t?(0,u.jsx)(o.FormattedMessage,{...m.propertyLabel}):(0,u.jsx)(o.FormattedMessage,{...m.hidePageLabel});case"section_show":return(0,u.jsx)(o.FormattedMessage,{...m.showPageLabel});case"section_collapsed":return(0,u.jsx)(o.FormattedMessage,{...m.collapsedLabel});case"inline":return t?(0,u.jsx)(o.FormattedMessage,{...m.sectionLabel}):(0,u.jsx)(o.FormattedMessage,{...m.defaultLabel});case"minimal":return(0,u.jsx)(o.FormattedMessage,{...m.minimalLabel})}}},6318:(e,t,s)=>{s.d(t,{Z:()=>h});s(67294);var n=s(480),i=s(6695),o=s(36591),a=s(9291),r=s(11599),l=s(87279),d=s(52275),c=s(78140),u=s(32163),m=s(72495),p=s(43700),g=s(85893);const h=function(e){let{type:t,visibilityLevels:s,showAsMenu:o,visibility:d,onSelect:p,onClose:h,propertySchema:y}=e;window.__c={n:"CustomizePageMenuVisibilitySelectMenuItem"};const S=(0,n.O7)(),{device:v}=S,b=[{key:"visibilityLevels",render:e=>(0,g.jsx)(m.Z,{...e,topBorder:0!==e.index}),items:"page"===t||"relation_property"===t?f(t,s).map((e=>x(e,o,d,t,p,h,S))):i.AX.filter((e=>"property"!==t||"hide_if_empty"!==e||r.kq({propertySchema:y}))).map((e=>x(e,o,d,t,p,h,S)))}];let M;return M=v.isMobile?{menuType:l.og.Modal,title:(0,g.jsx)(a.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,g.jsx)(a.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>h&&h()}:{menuType:l.og.Popup,width:"auto",maxWidth:360},(0,g.jsx)(c.Z,{...M,children:(0,g.jsx)(u.Z,{type:u.i.Vertical,initialFocus:void 0,sections:b})})};function f(e,t){return"page"!==e&&"relation_property"!==e?[]:t||i.Sn}function x(e,t,s,n,i,a,r){const{device:l}=r;return{key:e,render:n=>(0,g.jsx)(d.Z,{...n,textWrapperStyle:{marginRight:0},title:(0,g.jsx)("div",{style:{display:"flex",alignItems:"center",width:150},children:(0,g.jsx)("div",{children:(0,p.P)(e,t)})}),right:s===e?(0,g.jsx)("div",{style:{width:l.isMobile?16:14},children:(0,o.e)()}):void 0}),action:()=>{if("page"===n){i(e)}if("relation_property"===n){i(e)}else if("property"===n){i(e)}a&&a()}}}},81070:(e,t,s)=>{s.r(t),s.d(t,{default:()=>J});var n=s(30120),i=s(67294),o=s(83355),a=s(13991),r=s(480),l=s(49085),d=s(8848),c=s(41797),u=s(9291),m=s(40506);const p=(0,u.defineMessages)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function g(e){const{reminder:t,shouldShowTime:s,intl:n,formatTime:i}=e;if(!t)return n.formatMessage(p.none);if(m.vJ(t)){const{unit:e,value:o,time:a}=t,r=i({start_time:a,time_format:"LT",humanReadable:!0,intl:n}),l=s?`(${r})`:"";return 0===o?n.formatMessage(p.onTheDay,{formattedTimeText:l}):"day"===e?n.formatMessage(p.daysBefore,{formattedTimeText:l,numberOfDays:o}):"year"===e?n.formatMessage(p.yearsBefore,{formattedTimeText:l,numberOfYears:o}):"month"===e?n.formatMessage(p.monthsBefore,{formattedTimeText:l,numberOfMonths:o}):n.formatMessage(p.weeksBefore,{formattedTimeText:l,numberOfWeeks:o})}{const{unit:e,value:s}=t;return 0===s?n.formatMessage(p.atTimeOf):"hour"===e?n.formatMessage(p.hoursBefore,{numberOfHours:s}):n.formatMessage(p.minutesBefore,{numberOfMinutes:s})}}var h=s(7057),f=s(53877),x=s(84795),y=s(42875),S=s(11843),v=s(36700),b=s(16001),M=s(72126),j=s(70203),w=s(97880),C=s(63143),k=s(50906),T=s(87279),I=s(18514),P=s(77907),Z=s(76150),F=s(69582),_=s(52275),A=s(31945),R=s(37601),D=s(88359),B=s(1743),L=s(74194),O=s(78140),E=s(32163),N=s(72495),V=s(14871),U=s(24006),W=s(26388),K=s(64369),z=s(83182),q=s(46247),G=s(62069),H=s(85893);const Q={backgroundColor:d.ZP.blueWithAlpha(.15)};class Y extends o.Z{constructor(){super(...arguments),this.storeTypes={store:Z.ZP,timezoneQuery:l.default.createClass("")},this.handleWindowKeyDown=e=>{"Escape"===e.key&&this.maybePreEmptivelyBlurInput()},this.handleWindowMouseDown=e=>{e.target instanceof HTMLInputElement&&e.target===document.activeElement||this.maybePreEmptivelyBlurInput()},this.handleChangeReminder=e=>{const t=this.getDateValue();var s,n;if(e){if(m.vJ(e)){var i,o;null===(i=(o=this.props).onChangeValue)||void 0===i||i.call(o,{...t,reminder:{...e,defaultTimeZone:(0,y.r)()}})}else if("datetime"===t.type||"datetimerange"===t.type){var a,r;null===(a=(r=this.props).onChangeValue)||void 0===a||a.call(r,{...t,reminder:e})}}else null===(s=(n=this.props).onChangeValue)||void 0===s||s.call(n,{...t,reminder:e});k.IMD(this.environment,{date:t,reminder:e})},this.handleInputChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,inputTemporaryValue:{...s.state.inputTemporaryValue,[s.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()},this.handleStartDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const s=ae(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!s)return Z.pd.InvalidDate;const n={...this.getDateValue(),start_date:s},i=f.XI(n);if(!i)return Z.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:i.start,resetField:Z.Hv.StartDate})},this.handleStartTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const s=oe(t,this.props.timeFormat,this.props.intl);if(!s)return Z.pd.InvalidTime;const n=this.getDateValue();if(m.qg(n)){const{newDate:e,currentMonth:t}=f.vz({previous:n,updatedStartTime:s});this.applyValidDateState({newDate:e,currentMonth:t,resetField:Z.Hv.StartTime}),this.resetInputState(Z.Hv.EndDate),this.resetInputState(Z.Hv.EndTime)}else{const e={...n,start_time:s},t=f.XI(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:Z.Hv.StartTime})}},this.handleEndDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const s=ae(t,this.props.intl,this.props.dateFormat,this.environment,this.props.locale);if(!s)return Z.pd.InvalidDate;const n={...this.getDateValue(),end_date:s},i=f.XI(n);if(!i)return Z.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:i.end,resetField:Z.Hv.EndDate})},this.handleEndTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const s=oe(t,this.props.timeFormat,this.props.intl);if(!s)return Z.pd.InvalidTime;const n={...this.getDateValue(),end_time:s},i=f.XI(n);if(!i)return Z.pd.InvalidRange;this.applyValidDateState({newDate:n,currentMonth:i.end,resetField:Z.Hv.EndTime})},this.handleInputBlur=e=>{const{focus:t}=this.stores.store.state;let s;t===Z.Hv.StartDate?s=this.handleStartDateInputChange():t===Z.Hv.StartTime?s=this.handleStartTimeInputChange():t===Z.Hv.EndDate?s=this.handleEndDateInputChange():t===Z.Hv.EndTime&&(s=this.handleEndTimeInputChange()),s?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:s}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleInputSubmit=()=>{const{focus:e}=this.stores.store.state;let t;e===Z.Hv.StartDate?t=this.handleStartDateInputChange():e===Z.Hv.StartTime?t=this.handleStartTimeInputChange():e===Z.Hv.EndDate?t=this.handleEndDateInputChange():e===Z.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleDayPickerDayClick=(e,t,s)=>{if(this.props.disabled)return;let i=M.Xh(this.getDateValue());const{focus:o}=this.stores.store.state,a=n.ou.fromJSDate(e).setLocale(m.ah).toFormat(f.Iq);if(!s.shiftKey||"date"!==i.type&&"datetime"!==i.type)if("daterange"===i.type||"datetimerange"===i.type){var r,l;o===Z.Hv.StartDate||o===Z.Hv.StartTime?i={...i,start_date:a}:o!==Z.Hv.EndDate&&o!==Z.Hv.EndTime||(i={...i,end_date:a});const e=f.NK(i,(0,y.r)());if(e.end&&e.end<e.start){if("datetimerange"===i.type){const{start_date:e,start_time:t,end_date:s,end_time:n}=i;i={...i,start_date:s,start_time:n,end_date:e,end_time:t}}else{const{start_date:e,end_date:t}=i;i={...i,start_date:t,end_date:e}}this.stores.store.setState({...this.stores.store.state,focus:o===Z.Hv.StartDate||o===Z.Hv.StartTime?Z.Hv.EndDate:Z.Hv.StartDate})}null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,i),this.resetInputState(o);const t=o===Z.Hv.StartDate||o===Z.Hv.StartTime?Z.Hv.EndDate:Z.Hv.StartDate;this.stores.store.setState({...this.stores.store.state,focus:t})}else{var d,c;const e={...i,start_date:a};null===(d=(c=this.props).onChangeValue)||void 0===d||d.call(c,e),this.resetInputState(o)}else this.enableEndDate({dateValue:i,endDate:a})},this.handleDayPickerMonthChange=e=>{this.stores.store.setState({...this.stores.store.state,currentMonth:n.ou.fromJSDate(e)})},this.handleEndDateControlChange=()=>{const e=this.getDateValue();if("datetimerange"===e.type){var t,s;const n={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,n)}else if("daterange"===e.type){var n,i;const t={type:"date",start_date:e.start_date,reminder:e.reminder};null===(n=(i=this.props).onChangeValue)||void 0===n||n.call(i,t)}else this.enableEndDate({dateValue:e})},this.handleAllDayChange=()=>{const e=this.getDateValue();if("date"===e.type){var t,s;const n={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,y.r)(),reminder:e.reminder&&m.AE(e.reminder)};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,n)}else if("daterange"===e.type){var n,i;const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:(0,y.r)(),reminder:e.reminder&&m.AE(e.reminder)};null===(n=(i=this.props).onChangeValue)||void 0===n||n.call(i,t)}else if("datetime"===e.type){var o,a;const t={type:"date",start_date:e.start_date,reminder:e.reminder&&m.wg(e.reminder,(0,y.r)())};null===(o=(a=this.props).onChangeValue)||void 0===o||o.call(a,t)}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&m.wg(e.reminder,(0,y.r)())};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t)}},this.handleTimeZoneChange=e=>{const t=this.getDateValue();if("datetime"===t.type||"datetimerange"===t.type){var s,n;const i={...t,time_zone:e};null===(s=(n=this.props).onChangeValue)||void 0===s||s.call(n,i)}},this.handleStartInputDateFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,y.r)());this.stores.store.setState({...this.stores.store.state,focus:Z.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})},this.handleStartInputTimeFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,y.r)());this.stores.store.setState({...this.stores.store.state,focus:Z.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})},this.handleEndInputDateFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,y.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:Z.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})},this.handleEndInputTimeFocus=()=>{const e=this.getDateValue(),t=f.NK(e,(0,y.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:Z.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.openTimeFormat=f.Lg((0,y.r)()),window.addEventListener("mousedown",this.handleWindowMouseDown),window.addEventListener("keydown",this.handleWindowKeyDown,!0)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}maybePreEmptivelyBlurInput(){const{inputIsFocused:e}=this.stores.store.state;e&&this.handleInputBlur()}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:s,canConfigureCollection:n,shouldShowReminder:i,header:o,isTemplatePage:a}=this.props,{inputIsFocused:r}=this.stores.store.state,l=this.getDateValue(),d="datetime"===l.type||"datetimerange"===l.type,c="daterange"===l.type||"datetimerange"===l.type,m=(0,H.jsxs)("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:d?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0},children:[this.renderStartInput(),c&&(0,H.jsx)("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone()]});let p;return p=e.isMobile?{menuType:T.og.Modal,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:i?(0,H.jsx)(re,{}):void 0,onClickRight:this.props.onDismiss,header:m}:{menuType:T.og.Popup,maxHeight:"none",width:270,header:o},(0,H.jsx)(B.Z,{capture:r,allowEsc:!0,children:(0,H.jsx)(B.Z,{capture:!0,allowUndo:!0,allowEsc:!0,children:(0,H.jsxs)(O.Z,{...p,children:[(0,H.jsx)(R.Z,{show:r}),a&&(0,H.jsx)($,{onChangeValue:this.props.onChangeValue}),(0,H.jsxs)(N.Z,{topBorder:!0,children:[!e.isMobile&&m,(0,H.jsx)("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}},children:this.renderCalendar()})]}),!s&&this.renderControls(),!s&&n&&(0,H.jsx)(N.Z,{topBorder:!0,children:this.renderFormatPopup()}),!s&&(0,H.jsx)(N.Z,{topBorder:!0,children:(0,H.jsx)(he,{onChangeValue:this.props.onChangeValue})}),!s&&!e.isMobile&&i&&(0,H.jsx)(N.Z,{topBorder:!0,children:(0,H.jsx)(re,{})})]})})})}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:s,inputTemporaryValue:n,error:i}=this.stores.store.state,o=this.getDateValue(),a=f.NK(o,(0,y.r)(),te(this.props.locale,this.props.intl)),r=Boolean(i.startDate||i.startTime),l="datetime"===o.type||"datetimerange"===o.type,d="daterange"===o.type||"datetimerange"===o.type,c=s===Z.Hv.StartDate||s===Z.Hv.StartTime,u=(0,C.z4)(n.startDate)?a.start.toFormat(ie(this.props.dateFormat,this.props.intl,this.props.locale)):n.startDate,p=(0,C.z4)(n.startTime)?a.start.toFormat(se(this.props.timeFormat)):n.startTime,g=(0,C.z4)(n.startDate)?a.start.toFormat(f.Iq):n.startDate,h=(0,C.z4)(n.startTime)?a.start.toFormat(m.jK):n.startTime;return(0,H.jsxs)("div",{style:{...r?me(this.theme):c&&d?pe(this.theme):ue(this.theme),fontSize:e.isMobile?16:14},children:[(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(i.startDate,this.props.intl),originGap:12,forceVisibleState:Boolean(i.startDate),placement:W.ug.Left,render:()=>e.isMobile?(0,H.jsx)(L.Z,{type:"date",format:L.B.Transparent,value:g,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):(0,H.jsx)(L.Z,{selectAll:!0,format:L.B.Transparent,value:u,focusInitial:s===Z.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),l&&de(this.theme),l&&(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(i.startTime,this.props.intl),originGap:12,forceVisibleState:Boolean(i.startTime),placement:W.ug.Right,render:()=>e.isMobile?(0,H.jsx)(L.Z,{type:"time",format:L.B.Transparent,value:h,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,H.jsx)(L.Z,{format:L.B.Transparent,value:p,focusInitial:s===Z.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,s=this.getDateValue(),n=f.NK(s,(0,y.r)(),te(this.props.locale,this.props.intl)),i="datetime"===s.type||"datetimerange"===s.type;if(n.end){const{focus:s,error:o,inputTemporaryValue:a}=this.stores.store.state,r=Boolean(o.endDate||o.endTime),l=s===Z.Hv.EndDate||s===Z.Hv.EndTime,d=(0,C.z4)(a.endDate)?n.end.toFormat(ie(this.props.dateFormat,this.props.intl,this.props.locale)):a.endDate,c=(0,C.z4)(a.endTime)?n.end.toFormat(se(this.props.timeFormat)):a.endTime,u=(0,C.z4)(a.endDate)?n.end.toFormat(f.Iq):a.endDate,p=(0,C.z4)(a.endTime)?n.end.toFormat(m.jK):a.endTime,g=this.getDateRangeBounds(),h=g&&g.earliestValidEnd;return(0,H.jsxs)("div",{style:{...r?me(this.theme):l?pe(this.theme):ue(this.theme),fontSize:e.isMobile?16:14},children:[(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(o.endDate,this.props.intl),originGap:12,forceVisibleState:Boolean(o.endDate),placement:W.ug.Left,render:()=>e.isMobile?(0,H.jsx)(L.Z,{type:"date",format:L.B.Transparent,value:u,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:h}}):(0,H.jsx)(L.Z,{format:L.B.Transparent,value:d,focusInitial:s===Z.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),i&&de(this.theme),i&&(0,H.jsx)(W.ZP,{renderTooltip:()=>ne(o.endTime,this.props.intl),originGap:12,forceVisibleState:Boolean(o.endTime),placement:W.ug.Right,render:()=>e.isMobile?(0,H.jsx)(L.Z,{type:"time",format:L.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,H.jsx)(L.Z,{format:L.B.Transparent,value:c,focusInitial:s===Z.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}}renderTimeZone(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();if(("datetime"===s.type||"datetimerange"===s.type)&&s.time_zone!==(0,y.r)())return(0,H.jsx)(K.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8},children:(0,c.E)(t)[s.time_zone]})}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),s=f.NK(t,(0,y.r)()),n=this.stores.store.state.currentMonth||s.start,{focus:i}=this.stores.store.state;if(s.end){const t=s.start.toJSDate(),o=s.end.toJSDate(),r=i===Z.Hv.StartDate||i===Z.Hv.StartTime;return(0,H.jsx)(P.LazyDayPicker,{className:"notion-date-property-menu notranslate",weekStartsOn:e,numberOfMonths:1,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:a.SP,modifiers:{range:{from:t,to:o},...r?{end:o,start:t}:{start:t,end:o}},modifiersStyles:{range:Q,start:r?X():ee(),end:r?ee():X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}{const t=s.start.toJSDate();return(0,H.jsx)(P.LazyDayPicker,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:e,defaultMonth:n.toJSDate(),month:n.toJSDate(),locale:a.SP,selected:[t],modifiers:{start:t},modifiersStyles:{start:X()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?(0,H.jsxs)(N.Z,{topBorder:!0,children:[t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()]}):(0,H.jsxs)(i.Fragment,{children:[t&&(0,H.jsx)(N.Z,{topBorder:!0,children:this.renderReminderControl()}),(0,H.jsxs)(N.Z,{topBorder:!0,children:[this.renderEndDateControl(),this.renderAllDayControl()]})]})}renderEndDateControl(){const e=this.getDateValue();return(0,H.jsx)(_.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,H.jsx)(U.Z,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:this.handleEndDateControlChange})})}renderAllDayControl(){const e=this.getDateValue();return(0,H.jsx)(_.Z,{focused:!1,onClick:this.handleAllDayChange,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,H.jsx)(U.Z,{on:"date"!==e.type&&"daterange"!==e.type,onClick:this.handleAllDayChange})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();return(0,H.jsx)(A.ZP,{popupType:e.isMobile?A.Z4.SlideUp:A.Z4.Popup,placementToOrigin:A.pO.Right,renderOrigin:n=>(0,H.jsx)(D.Z,{...n,icon:(0,v.m)({width:14}),title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:g({reminder:s.reminder,intl:t,formatTime:h.mr})}),render:n=>{let i;i=e.isMobile?{menuType:T.og.Modal,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:n.close}:{menuType:T.og.Popup,width:250};const o=("date"===s.type||"daterange"===s.type?m.PI:m.dG).map((e=>{const s=g({reminder:e,shouldShowTime:!0,intl:t,formatTime:h.mr});return{key:s,action:t=>{this.handleChangeReminder(e),n.close()},render:(e,t)=>(0,H.jsx)(_.Z,{...e,title:s})}}));return(0,H.jsx)(O.Z,{...i,children:(0,H.jsx)(E.Z,{type:E.i.Vertical,sections:[{key:"reminder section",render:e=>(0,H.jsx)(N.Z,{...e}),items:o}],initialFocus:void 0})})}})}renderFormatPopup(){const{device:e}=this.environment;return(0,H.jsx)(A.ZP,{popupType:e.isMobile?A.Z4.SlideUp:A.Z4.Popup,placementToOrigin:A.pO.Right,renderOrigin:t=>(0,H.jsx)(_.Z,{...t,icon:(0,b.r)({width:14}),title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Date format & timezone",id:"LuxonDatePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile}),render:t=>{let s;return s=e.isMobile?{menuType:T.og.Modal,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),right:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:T.og.Popup,width:250},(0,H.jsx)(O.Z,{...s,children:(0,H.jsxs)(N.Z,{children:[(0,H.jsx)(ge,{dateFormat:this.props.dateFormat,onChangeDateFormat:this.props.onChangeDateFormat}),!S.S.includes(a.SP)&&this.renderTimeFormatControl(),this.renderTimeZoneControl()]})})}})}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=se(this.props.timeFormat),{intl:n}=this.props,i=function(e){const t=se(e),s=le();for(const n in s)if(s[n]===t)return n;return"12h"}(this.props.timeFormat),o={menuTitle:n.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:m.L7,getKey:e=>e,selectedItem:i,onSelect:e=>function(e,t){const s=le()[e];null==t||t(s)}(e,this.props.onChangeTimeFormat),renderItem:e=>(0,H.jsx)(_.Z,{...e,title:n.formatMessage(m.Fi[e.value])}),disabled:t,renderOrigin:e=>(0,H.jsx)(D.Z,{focused:!1,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(s?n.formatMessage(m.Fi[i]):(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"})),...e})};return(0,H.jsx)(V.Z,{...o})}renderTimeZoneControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=this.getTimeZone();return(0,H.jsx)(G.Z,{renderOrigin:e=>(0,H.jsx)(D.Z,{...e,focused:!1,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:t,right:!t&&f.er(s)}),onSelect:e=>this.handleTimeZoneChange(e)})}enableEndDate(e){const{dateValue:t,endDate:s,endTime:n}=e;if("datetime"===t.type){var i,o;const e={type:"datetimerange",start_date:t.start_date,start_time:t.start_time,end_date:s||t.start_date,end_time:n||t.start_time,time_zone:t.time_zone,reminder:t.reminder};null===(i=(o=this.props).onChangeValue)||void 0===i||i.call(o,e),this.stores.store.setState({...this.stores.store.state,focus:Z.Hv.EndDate})}else if("date"===t.type){var a,r;const e={type:"daterange",start_date:t.start_date,end_date:s||t.start_date,reminder:t.reminder};null===(a=(r=this.props).onChangeValue)||void 0===a||a.call(r,e),this.stores.store.setState({...this.stores.store.state,focus:Z.Hv.EndDate})}else(0,w.t1)(t)}getDateValue(){const{value:e}=this.props;return e&&!M.i2(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(m.h(e)||m.qg(e)){const t=f.NK(e,(0,y.r)());return{earliestValidEnd:t.start.toFormat(f.Iq),latestValidStart:t.end.toFormat(f.Iq)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!M.i2(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:(0,y.r)()}:e:this.openTimeFormat}getTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:(0,y.r)()}applyValidDateState(e){var t,s;const{newDate:n,currentMonth:i,resetField:o}=e;null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,n),this.stores.store.setState({...this.stores.store.state,currentMonth:i}),this.resetInputState(o)}resetInputState(e){const{state:t}=this.stores.store;this.stores.store.setState({...t,error:{...t.error,[t.focus]:void 0},inputTemporaryValue:{...t.inputTemporaryValue,[t.focus]:void 0}})}}function $(e){window.__c={n:"RelativeDateShortcutsSection"};const{onChangeValue:t}=e,s=(0,u.useIntl)();return(0,H.jsx)(N.Z,{title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,H.jsx)(_.Z,{title:(0,H.jsx)(F.w,{templateVariableType:e}),caption:j.Z08(e,s),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}Y.displayName="DatePropertyMenu";const J=(0,u.injectIntl)(Y);function X(){return{backgroundColor:d.ZP.blue,color:d.ZP.white}}function ee(){return{backgroundColor:d.ZP.blueWithAlpha(.43)}}function te(e,t){return e||t.locale}function se(e){return e?m._F(e):m.Sc}function ne(e,t){switch(e){case Z.pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case Z.pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case Z.pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}function ie(e,t,s){return void 0===e||"relative"===e||"ll"===e?m.oq(te(s,t)):m.jG(e)}function oe(e,t,s){return(0,x.parseTimeValueWithInputFormat)(e,se(t),s)}function ae(e,t,s,n,i){return n.device.isMobile?(0,x.parseDateValueWithInputFormat)(e,f.Iq,t):(0,x.parseDateValueWithInputFormat)(e,ie(s,t,i),t)}function re(){window.__c={n:"RemindersHelp"};const e=(0,r.O7)(),{device:t}=e;return t.isMobile?(0,H.jsx)(q.Z,{href:(0,I.UY)("guides.reminders"),analyticsFrom:"date_selector"}):(0,H.jsx)(z.Z,{title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,I.UY)("guides.reminders"),analyticsFrom:"date_selector"})}function le(){return(0,S.E)(a.SP).time}function de(e){return(0,H.jsx)("div",{style:{height:14,width:1,background:e.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}function ce(e){return{display:"flex",alignItems:"center",borderRadius:4,height:28,lineHeight:1.2,background:e.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}function ue(e){return{...ce(e),boxShadow:e.inputBoxShadow,flexGrow:1}}function me(e){return{...ce(e),boxShadow:`inset 0 0 0 2px ${d.ZP.red}`,background:d.ZP.redWithAlpha(.15),flexGrow:1}}function pe(e){return{...ce(e),boxShadow:`inset 0 0 0 2px ${d.ZP.blue}`,background:d.ZP.blueWithAlpha(.15),flexGrow:1}}function ge(e){let{dateFormat:t,onChangeDateFormat:s}=e;window.__c={n:"DateFormatControlComponent"};const n=(0,u.useIntl)(),i=t||m.sF,o={menuTitle:n.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:m.Zy,getKey:e=>e,selectedItem:i,onSelect:e=>function(e,t){null==t||t(e)}(e,s),renderItem:e=>(0,H.jsx)(_.Z,{...e,title:n.formatMessage(m.fy[e.value])}),renderOrigin:e=>(0,H.jsx)(D.Z,{focused:!1,title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:i?n.formatMessage(m.fy[i]):(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"}),...e})};return(0,H.jsx)(V.Z,{...o})}function he(e){let{onChangeValue:t}=e;return(0,H.jsx)(_.Z,{focused:!1,onClick:()=>function(e){null==e||e(void 0)}(t),title:(0,H.jsx)(u.FormattedMessage,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}},46945:(e,t,s)=>{s.d(t,{Z:()=>h});s(67294);var n=s(83355),i=s(13991),o=s(8848),a=s(53877),r=s(42875),l=s(82990),d=s(28020),c=s(77907),u=s(13854),m=s(85893);const p={monthControl:{position:"absolute",top:0,right:0,display:"flex"},selectedRange:{backgroundColor:o.ZP.blueWithAlpha(.15)},active:{backgroundColor:o.ZP.blue,color:o.ZP.white},inactive:{backgroundColor:o.ZP.blueWithAlpha(.43)},disabled:{pointerEvents:"none"},today:{fontWeight:l.Z.fontWeight.regular}};class g extends n.Z{constructor(){super(...arguments),this.currentDate=void 0}renderComponent(){const{readonly:e}=this.props,t=this.getDisplayMonth();return(0,m.jsx)(c.LazyDayPicker,{className:"notion-calendar-picker",defaultMonth:t,month:t,numberOfMonths:1,weekStartsOn:d.AK.state,locale:i.SP,showOutsideDays:!0,fixedWeeks:!0,onDayClick:e=>function(e,t,s,n,i,o,r,l){if(o||l)return;const d=t.getFocus(),c=a.OQ.toPersistedDate(e.valueOf()),m=n(d,{value:c}),p=m.error?m:{value:{[d]:m.value[d]}};i(p),t.setState({...t.state,hovered:void 0}),r&&r.setState({...r.state,hovered:void 0});if(m.error)return;"starting"!==d||s.ending||(t.setState({...t.state,focus:"ending"}),r&&r.setState({...r.state,focus:u.yO.ending}));const g="starting"===d?"ending":"starting";t.setState({...t.state,focus:g}),r&&r.setState({...r.state,focus:u.yO[g]})}(e,this.props.store,this.props.value,this.props.validate,this.props.onUpdate,this.props.disabled,this.props.dateTimeStore,this.props.readonly),onDayMouseEnter:e=>function(e,t,s,n,i,o){const r=t.getFocus(),l=a.OQ.jsDateToLuxon(e);if(n||o)return;if("starting"===r&&s.ending&&!s.starting){a.OQ.notionDateToLuxon(s.ending)>=l&&(t.setState({...t.state,hovered:e}),i&&i.setState({...i.state,hovered:e}))}else if("ending"===r&&s.starting&&!s.ending){a.OQ.notionDateToLuxon(s.starting)<=l&&(t.setState({...t.state,hovered:e}),i&&i.setState({...i.state,hovered:e}))}}(e,this.props.store,this.props.value,this.props.disabled,this.props.dateTimeStore,this.props.readonly),onMonthSelected:e=>function(e,t,s){t.setState({...t.state,displayMonth:a.OQ.jsDateToLuxon(e)}),s&&s.setState({...s.state,displayMonth:a.OQ.jsDateToLuxon(e)})}(e,this.props.store,this.props.dateTimeStore),modifiers:f(this.props.store,this.props.value,this.props.disabled),modifiersStyles:x(this.props.store,this.theme),disabled:!!e||void 0})}getCurrentDate(){if(!this.currentDate){const e=a.Lg((0,r.r)());this.currentDate=a.OQ.notionDateToJsDate(e)}return this.currentDate}getDisplayMonth(){const{value:e,store:t}=this.props;if(t.state.displayMonth)return t.state.displayMonth.toJSDate();if("starting"===t.getFocus()){if(e.starting)return a.OQ.notionDateToJsDate(e.starting);if(e.ending)return a.OQ.notionDateToJsDate(e.ending)}if("ending"===t.getFocus()){if(e.ending)return a.OQ.notionDateToJsDate(e.ending);if(e.starting)return a.OQ.notionDateToJsDate(e.starting)}return this.getCurrentDate()}}g.displayName="DateRangePicker";const h=g;function f(e,t,s){const n=function(e,t,s){if(t)return e=>!0;const n=e=>"ending"===s.getFocus()&&{before:e},i=e=>"starting"===s.getFocus()&&{after:e};if(e.starting&&e.ending){const t=a.OQ.notionDateToJsDate(e.starting),s=a.OQ.notionDateToJsDate(e.ending);return n(t)||i(s)}if(e.starting)return n(a.OQ.notionDateToJsDate(e.starting));if(e.ending)return i(a.OQ.notionDateToJsDate(e.ending));return!1}(t,s,e),{hovered:i}=e.state;if(s)return{disabled:n};if(t.starting&&t.ending){const e=a.OQ.notionDateToJsDate(t.starting),s=a.OQ.notionDateToJsDate(t.ending);return{range:{from:e,to:s},start:e,end:s,disabled:n}}if(t.starting){const e=a.OQ.notionDateToJsDate(t.starting);return{range:i&&{from:e,to:i},start:e,end:i,disabled:n,selected:[e,i]}}if(t.ending){const e=a.OQ.notionDateToJsDate(t.ending);return{range:i&&{from:i,to:e},start:i,end:e,disabled:n,selected:[e,i]}}}function x(e,t){const s=p,n=function(e){return{disabled:{color:e.lightTextColor},today:{color:o.ZP.white}}}(t),i=e.getFocus(),a=s.selectedRange,r={...s.disabled,...n.disabled},l={...s.today,...n.today};return{range:a,start:"starting"===i?s.active:s.inactive,end:"ending"===i?s.active:s.inactive,disabled:r,today:l}}},86249:(e,t,s)=>{s.d(t,{ZP:()=>$,UV:()=>Y,f4:()=>Q});s(57658);var n=s(67294),i=s(24405),o=s(56666),a=s(44495),r=s(37612),l=s(97880),d=s(9291),c=s(47307),u=s(40394),m=s(42922),p=s(52275),g=s(53695),h=s(64369),f=s(480),x=s(86628),y=s(50906),S=s(54642),v=s(33954),b=s(52507),M=s(50506),j=s(13991),w=s(82990),C=s(74194),k=s(68785),T=s(85893);const I=(0,d.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.addNewDomain.samlConfig.subtitle",defaultMessage:"Users with a verified domain can log in {br}using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.addNewDomain.integration.subtitle",defaultMessage:"Link preview integrations must verify {br}domains before they are published."}});const P=function(e){let{handleAddNewDomain:t,loading:s,verificationType:o}=e;window.__c={n:"AddNewDomain"};const[a,r]=(0,n.useState)(""),c=!Boolean(a),u=(0,n.useCallback)((e=>{r(e.target.value)}),[]),p=(0,i.yK)((()=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},input:{marginTop:22,marginBottom:14},button:{width:"100%",opacity:c?.5:1}})),[c]);let g;switch(o){case"integration":g=I.integrationSubtitle;break;case"saml_config":g=I.samlConfigSubtitle;break;default:(0,l.t1)(o)}return(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(h.Z,{style:p.title,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.addNewDomain.title",defaultMessage:"Add new domain"})}),(0,T.jsx)(h.Z,{style:p.subtitle,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{...g,values:{br:(0,T.jsx)("br",{})}})}),(0,T.jsx)(C.Z,{value:a,style:p.input,placeholder:"notion.so",onChange:u}),(0,T.jsx)(m.Z,{onClick:()=>t(a),style:p.button,isLarge:!0,disabled:c,children:s?(0,T.jsx)(k.Z,{}):(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.addNewDomain.next",defaultMessage:"Next"})})]})};var Z=s(63296);const F=function(e){let{domain:t,isExpired:s,onClose:o}=e;window.__c={n:"InvalidDomain"};const a=(0,i.yK)((e=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);return(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(h.Z,{style:a.title,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.title",defaultMessage:"Unable to verify {domain}",values:{domain:t}})}),(0,T.jsx)(h.Z,{style:a.subtitle,isMultiline:!0,children:s?(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.expired",defaultMessage:"The code for this domain's verification has expired."}):(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.invalid",defaultMessage:"You are unable to verify this domain because it has already been verified by another workspace."})}),(0,T.jsx)(Z.Z,{onClick:o,style:{width:"100%"},children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.invalidDomain.okay",defaultMessage:"Okay"})})]})},_=(0,d.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.verifiedDomain.samlConfig.subtitle",defaultMessage:"Users are able to use this email domain to{br}log in using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.verifiedDomain.integration.subtitle",defaultMessage:"This integration can unfurl URLs containing this domain."}});const A=function(e){let{domain:t,onClose:s,verificationType:o}=e;window.__c={n:"VerifyDomain"};const a=(0,i.yK)((()=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);let r;switch(o){case"saml_config":r=_.samlConfigSubtitle;break;case"integration":r=_.integrationSubtitle;break;default:(0,l.t1)(o)}return(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(h.Z,{style:a.title,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.title",defaultMessage:"Successfully verified {domain}",values:{domain:t}})}),(0,T.jsx)(h.Z,{style:a.subtitle,isMultiline:!0,children:(0,T.jsx)(d.FormattedMessage,{...r,values:{br:(0,T.jsx)("br",{})}})}),(0,T.jsx)(Z.Z,{onClick:s,style:{width:"100%"},children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.okay",defaultMessage:"Okay"})})]})};var R=s(75553),D=s(63143),B=s(893),L=s(16402),O=s(64921);const E=function(e){let{handleVerifyDomain:t,domainVerification:s,loading:o}=e;window.__c={n:"VerifyExistingDomain"};const a=(0,f.O7)(),r=s.expiresAt-Date.now()<2*D.U6,l=(0,i.yK)((e=>({title:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},list:{paddingInlineStart:22,margin:"24px 0"},listItem:{fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",marginBottom:12},expiresSoonText:{color:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500]},copyButton:{borderRadius:4,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:w.Z.getCompositeFontFamily(j.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},code:{width:"100%",color:e.mediumTextColor,fontFamily:w.Z.getCompositeFontFamily(j.SP).mono,fontSize:14,fontWeight:400,lineHeight:"18px"},codeContainer:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:4,marginTop:4,marginBottom:8}})),[]);return(0,T.jsxs)(n.Fragment,{children:[(0,T.jsx)(h.Z,{style:l.title,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.title",defaultMessage:"Verify your domain"})}),(0,T.jsx)(h.Z,{style:l.subtitle,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.subtitle",defaultMessage:"Follow these steps to finalize verification."})}),(0,T.jsx)(h.Z,{isSmall:!0,style:{marginTop:22},children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeLabel",defaultMessage:"Verification code"})}),(0,T.jsxs)("div",{style:l.codeContainer,children:[(0,T.jsx)(h.Z,{style:l.code,children:`notion-domain-verification=${s.verificationCode}`}),(0,T.jsxs)(O.Z,{onClick:function(){B.RD({environment:a,stringValue:`notion-domain-verification=${s.verificationCode}`,copiedMessage:B.tq.copiedLinkToClipboard})},style:l.copyButton,children:[(0,R.U)(l.copyIcon),(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.copy",defaultMessage:"Copy"})]})]}),(0,T.jsx)(h.Z,{style:r?l.expiresSoonText:void 0,isSmall:!0,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeExpiresAt",defaultMessage:"Expires on {timeLeft}",values:{timeLeft:(0,L.gs)(s.expiresAt)}})}),(0,T.jsxs)("ol",{style:l.list,children:[(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsDNS",defaultMessage:"Navigate to the DNS record section of your domain host."})}),(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsTXT",defaultMessage:"Create a new TXT record and paste in the code above as the value."})}),(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsHangTight",defaultMessage:"Typically, this change takes only minutes to occur, however, there are cases where it may take up to 72 hours for the DNS record to propagate."})}),(0,T.jsx)("li",{style:l.listItem,children:(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsVerify",defaultMessage:'Click "Verify" to notify Notion to check your DNS record.'})})]}),(0,T.jsx)(Z.Z,{style:{width:"100%"},onClick:()=>t(s),disabled:o,children:o?(0,T.jsx)(k.Z,{}):(0,T.jsx)(d.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verify",defaultMessage:"Verify"})})]})};const N=function(e){window.__c={n:"VerifyDomainModal"};const t=(0,f.O7)(),s=(0,d.useIntl)(),o=(0,i.Fg)(),[a,r]=(0,x.AF)(e.store,b.ZP),{verificationType:u,verificationTargetId:m,refreshDomains:p}=e,g=(0,n.useCallback)((()=>{r((e=>({...e,loading:!1,modalOpen:!1})))}),[r]),h=(0,n.useCallback)((async e=>{r((e=>({...e,loading:!0})));const n="integration"===u?{type:u,integrationId:m,domain:e}:{type:u,spaceId:m,domain:e},i=await S.createDomainVerificationCode(t,n);if("success"===i.type){p(),y.G7$(t,{type:u});const e=i.data.domainVerification,s=(0,b.Hs)(e);r((e=>({...e,domainVerification:s,loading:!1})))}else c.showErrorMessage((0,v.wf)(s,i)),r((e=>({...e,loading:!1})))}),[t,r,m,p,u,s]),j=(0,n.useCallback)((async e=>{r((e=>({...e,loading:!0})));const n=await S.verifyDomain(t,{verificationId:e.id});if(y.DoK(t,{type:u}),"success"===n.type){p(),y.aOs(t,{type:u});const s={type:"verified",domain:e.domain};r((e=>({...e,domainVerification:s,loading:!1})))}else c.showErrorMessage((0,v.wf)(s,n)),r((e=>({...e,loading:!1})))}),[t,s,r,p,u]),w=(0,n.useCallback)((()=>{if(!a.domainVerification)return(0,T.jsx)(P,{handleAddNewDomain:h,loading:a.loading,verificationType:u});switch(a.domainVerification.type){case"invalid":return(0,T.jsx)(F,{domain:a.domainVerification.domain,isExpired:Date.now()>a.domainVerification.expiresAt,onClose:g});case"unverified":return(0,T.jsx)(E,{handleVerifyDomain:j,domainVerification:a.domainVerification,loading:a.loading});case"verified":return(0,T.jsx)(A,{domain:a.domainVerification.domain,onClose:g,verificationType:u});default:(0,l.t1)(a.domainVerification)}}),[a.domainVerification,a.loading,j,h,g,u]);return(0,T.jsx)(M.Z,{open:a.modalOpen,preventHideChildrenWhileOpening:!0,onDismiss:g,render:()=>(0,T.jsx)("div",{style:{background:o.popoverBackground,width:410,padding:24,borderRadius:4},children:w()})})};var V=s(5478);const U=[{id:"domain",headerTitle:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationTable.table.header.domain",defaultMessage:"Domain"}),renderCell:e=>(0,T.jsx)(h.Z,{children:e.domain}),widthData:{width:100},sortable:!1},{id:"status",headerTitle:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationTable.table.header.status",defaultMessage:"Status"}),renderCell:e=>(0,T.jsx)(q,{status:e.status}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:null,renderCell:e=>(0,T.jsx)(G,{onShowDetails:e.onShowDetails,onRemove:e.onRemove}),widthData:{width:20},sortable:!1}],W=(0,d.defineMessages)({verifiedSAMLWarning:{defaultMessage:"Deleting this domain will prevent others with this email from logging in using SAML SSO.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.description"},verifiedIntegrationsWarning:{defaultMessage:"Deleting this domain will prevent integrations from unfurling urls that contain this domain.",id:"domainVerificationInput.myIntegrations.emailDomainsSection.removeDomain.description"},unverifiedDomainWarning:{defaultMessage:"Deleting this domain will restart its verification process. A new verification code will be generated for this domain in the next verification attempt.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.pending.description"}}),K={fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},z={fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"};function q(e){let{status:t}=e;window.__c={n:"VerificationToken"};const s=(0,i.yK)((e=>{const s={[V.YF.Success]:e.statusTokenBackground.green,[V.YF.Pending]:e.statusTokenBackground.yellow,[V.YF.Failure]:e.statusTokenBackground.red},n={[V.YF.Success]:e.statusTokenIndicator.green,[V.YF.Pending]:e.statusTokenIndicator.yellow,[V.YF.Failure]:e.statusTokenIndicator.red},i={[V.YF.Success]:e.statusTokenText.green,[V.YF.Pending]:e.statusTokenText.yellow,[V.YF.Failure]:e.statusTokenText.red};return{container:{background:s[t],color:i[t],display:"flex",justifyContent:"center",alignItems:"center",gap:6,borderRadius:18,height:20,paddingLeft:7,paddingRight:9},dot:{background:n[t],width:10,height:10,borderRadius:"100%"}}}),[t]);return(0,T.jsxs)("div",{style:s.container,children:[(0,T.jsx)("div",{style:s.dot}),H(t)]})}function G(e){let{onShowDetails:t,onRemove:s}=e;window.__c={n:"DropdownMenu"};const n=(0,i.yK)((e=>({primaryIcon:{width:14,height:14,color:e.mediumIconColor,fill:"currentColor"},menuItem:{width:250},menuIcon:{width:14,height:14,color:e.regularIconColor,fill:"currentColor"}})),[]),l=[];return t&&l.push({key:"details",action:()=>t(),render:e=>(0,T.jsx)(p.Z,{...e,style:n.menuItem,focused:!1,icon:(0,a.D)(n.menuIcon),title:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"View details",id:"securitySAMLSettings.emailDomainsSection.details"}),caption:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"See more information about the state of this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.detailsCaption"}),shouldWrapCaption:!0})}),s&&l.push({key:"remove",action:()=>s(),render:e=>(0,T.jsx)(p.Z,{...e,style:n.menuItem,focused:!1,icon:(0,r.y)(n.menuIcon),title:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Remove domain",id:"securitySAMLSettings.emailDomainsSection.remove"}),caption:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Delete this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.removeCaption"}),shouldWrapCaption:!0})}),0===l.length?null:(0,T.jsx)(g.N,{hideDropdownIcon:!0,title:(0,o.o)(n.primaryIcon),items:l})}function H(e){switch(e){case V.YF.Success:return(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Verified",id:"domainVerificationInput.emailDomainsSection.statusToken.verified"});case V.YF.Pending:return(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Pending",id:"domainVerificationInput.emailDomainsSection.statusToken.pending"});case V.YF.Failure:return(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Failed",id:"domainVerificationInput.emailDomainsSection.statusToken.failed"});default:(0,l.t1)(e)}}function Q(e){return{domain:e,status:V.YF.Success,data:{type:"verified",domain:e}}}function Y(e){return Date.now()>e.expiresAt||Boolean(e.invalidatedAt)?{domain:e.domain,status:V.YF.Failure,data:{type:"invalid",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}:{domain:e.domain,status:V.YF.Pending,data:{type:"unverified",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}}const $=function(e){window.__c={n:"DomainVerificationTable"};const{disabled:t,domains:s,domainVerificationStore:o,verificationType:a,verificationTargetId:r,refreshDomains:p,onRemoveDomain:g,onClickAddDomain:f,renderOverrideAddDomainButton:x}=e,y=(0,i.yK)((e=>(0,u.b)({columnRenderInfo:U,theme:e,containerMarginTop:0})),[]);function S(){t||(f&&f(),o.setState({domainVerification:void 0,loading:!1,modalOpen:!0}))}const v=s.map((e=>{let{domain:s,status:n,data:i}=e;return{id:"verified"===i.type?s:i.id,isClickable:!1,domain:s,status:n,onShowDetails:t?void 0:()=>function(e){t||o.setState({domainVerification:e,loading:!1,modalOpen:!0})}(i),onRemove:t?void 0:()=>async function(e,t){let s;if(t===V.YF.Failure)return void g(e);t===V.YF.Pending?s=W.unverifiedDomainWarning:t===V.YF.Success?s="saml_config"===a?W.verifiedSAMLWarning:W.verifiedIntegrationsWarning:(0,l.t1)(t),await c.confirmUserAction({message:(0,T.jsx)("div",{style:K,children:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Are you sure you want to delete this domain?",id:"domainVerificationInput.emailDomainsSection.removeDomain.message"})}),description:(0,T.jsx)("div",{style:z,children:(0,T.jsx)(d.FormattedMessage,{...s})}),acceptLabel:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.accept",defaultMessage:"Delete domain"}),cancelLabel:(0,T.jsx)(d.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.cancel",defaultMessage:"Cancel"})})&&g(e)}(i,n)}}));return(0,T.jsxs)(n.Fragment,{children:[x?x(S):(0,T.jsx)(m.Z,{isLarge:!0,disabled:t,onClick:S,style:{margin:"4px 0px 16px",width:"fit-content"},children:(0,T.jsx)(d.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})}),(0,T.jsx)(u.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:U,rows:v,styles:y,renderNoRowsComponent:()=>(0,T.jsx)(h.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,T.jsx)(d.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.emptyTable",defaultMessage:"No domains configured."})})}),(0,T.jsx)(N,{store:o,verificationTargetId:r,verificationType:a,refreshDomains:p})]})}},1176:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$});var n=s(67294),i=s(83355),o=s(480),a=s(86628),r=s(24405),l=s(41892),d=s(43593),c=s(72126),u=s(38737),m=s(23867),p=s(15047),g=s(9291),h=s(61652),f=s(12457),x=s(77080);var y=s(33929),S=s(87279),v=s(98742),b=s(5691),M=s(61766),j=s(88632),w=s(71071),C=s(44041),k=s(54669),T=s(42922),I=s(52275),P=s(1743),Z=s(74194),F=s(78140),_=s(32163),A=s(89728),R=s(72495),D=s(7931),B=s(24006),L=s(87968),O=s(26388),E=s(64369),N=s(92660),V=s(6202),U=s(60442),W=s(85893);const K=["pdf","html","markdown"],z=["currentView","all"],q=e=>e>.1&&e<2,G=["everything","no_files"],H=(0,g.defineMessages)({dialogLabel:{id:"exportModal.dialogLabel",defaultMessage:"Export"}});class Q extends i.Z{constructor(){super(...arguments),this.storeTypes={includeContentsPopupStore:M.Z,exportTypePopupStore:M.Z,pdfFormatPopupStore:M.Z,collectionViewExportTypePopupStore:M.Z},this.renderMenu=()=>{const{device:e}=this.environment;if(!j.Z.state.online)return(0,W.jsx)(oe,{});const t=w.ZP.state;return t.open&&e.isMobile?this.renderMobileModal(t):t.open?this.renderDesktopModal(t):void 0}}renderComponent(){return(0,W.jsx)(N.Z,{ariaLabel:y.default.formatMessage(H.dialogLabel),onDismiss:ae,render:this.renderMenu,requireOnline:!0,modalStore:w.ZP})}renderMobileModal(e){const t={menuType:S.og.Modal,title:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:ae};return(0,W.jsx)(F.Z,{...t,children:(0,W.jsx)(_.Z,{type:_.i.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>(0,W.jsx)(R.Z,{...e}),items:this.getMobileExportOptionsMenuItems(e)},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,W.jsx)(R.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,W.jsx)(V.Z,{...s,onClick:t||(()=>le(this.environment)),disabled:!ne(),title:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})})},action:()=>le(this.environment)}]}]})})}renderDesktopModal(e){const{device:t,currentUser:s}=this.environment,n=w.Sw(e)&&!h.y1(this.environment)&&"business",i=this.environment.device.isWindows;return(0,W.jsxs)("div",{style:{width:320,padding:24,fontSize:14},children:[(0,W.jsx)(D.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:J(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,W.jsx)(R.Z,{...e}),items:K.map((t=>de(t,e,s.id,this.environment)))}]}),e.exportOptions.collectionViewExportType&&(0,W.jsx)(D.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.collectionViewExportTypePopupStore,label:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases"}),selectedTitle:ee(e.exportOptions.collectionViewExportType||"currentView"),renderMenuSections:e=>[{key:"exportCollection",render:e=>(0,W.jsx)(R.Z,{...e}),items:z.map((t=>function(e,t,s){return{key:e,action:()=>{t.close(),function(e,t){const s=w.ZP.state;if(!s.open)return;h.BO(t,{...s,exportOptions:{...s.exportOptions,collectionViewExportType:e}})}(e,s)},render:t=>(0,W.jsx)(I.Z,{...t,title:ee(e)})}}(t,e,this.environment)))}]}),(0,W.jsx)(D.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.includeContentsPopupStore,label:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:X(e.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>(0,W.jsx)(R.Z,{...e}),items:G.map((t=>function(e,t,s){return{key:e,action:()=>{t.close(),function(e,t){const s=w.ZP.state;if(!s.open)return;h.BO(t,{...s,exportOptions:{...s.exportOptions,includeContents:e}})}(e,s)},render:t=>(0,W.jsx)(I.Z,{...t,title:X(e)})}}(t,e,this.environment)))}]}),w.Sw(e)&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(D.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:te(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,W.jsx)(R.Z,{...e}),items:d.lJ.map((t=>ce(t,e,this.environment)))},{key:"otherPaperFormats",render:e=>(0,W.jsx)(R.Z,{topBorder:!0,...e}),items:d.bY.map((t=>ce(t,e,this.environment)))}]}),(0,W.jsx)(ue,{})]}),"space"!==e.root.table&&(0,W.jsx)(k.Z,{requireUpgradeToTier:n,analyticsName:"export_modal",onClick:()=>re(this.environment),render:(t,s)=>(0,W.jsxs)("div",{...t,style:{display:"flex",alignItems:"center",height:32},children:[(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:this.theme.lightTextColor,fontSize:14},children:[(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,W.jsx)("div",{style:{marginLeft:8},children:s})]}),(0,W.jsx)(B.Z,{on:e.recursive,disabled:Boolean(n)})]}),renderUpgradeTooltip:()=>(0,W.jsx)(U.Z,{imageURL:l.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:O.ug.Left,upgradeButtonDesktopStyle:{marginTop:2}}),(0,W.jsx)(L.Z,{title:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===e.exportOptions.flattenExportFiletree?!i:!e.exportOptions.flattenExportFiletree,disabled:!e.recursive,onChange:()=>function(e){const t=w.ZP.state;if(!t.open)return;h.BO(e,{...t,exportOptions:{...t.exportOptions,flattenExportFiletree:!t.exportOptions.flattenExportFiletree}})}(this.environment)}),"on"===x.default.getEligibleGroup({experimentId:"export_comments",defaultGroup:"control"})&&"html"===e.exportOptions.exportType?(0,W.jsx)(L.Z,{title:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.shouldExportComments.description",defaultMessage:"Export comments"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:e.shouldExportComments,onChange:()=>function(e){const t=w.ZP.state;if(!t.open)return;h.BO(e,{...t,shouldExportComments:!t.shouldExportComments})}(this.environment)}):null,(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:16},children:[(0,W.jsx)(A.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:ae,children:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})}),(0,W.jsx)(T.Z,{onClick:()=>le(this.environment),disabled:!ne(),children:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"})})]})]})}getMobileExportOptionsMenuItems(e){const{currentUser:t,device:s}=this.environment;return c.oA([{key:"export type",render:n=>(0,W.jsx)(D.Z,{...n,isMenuItem:s.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:J(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,W.jsx)(R.Z,{...e}),items:K.map((s=>de(s,e,t.id,this.environment)))}]}),action:()=>{this.stores.exportTypePopupStore.setState({open:!0})}},w.Sw(e)&&{key:"pdf format",render:t=>(0,W.jsx)(D.Z,{...t,isMenuItem:s.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:te(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,W.jsx)(R.Z,{...e}),items:d.lJ.map((t=>ce(t,e,this.environment)))},{key:"otherPaperFormats",render:e=>(0,W.jsx)(R.Z,{topBorder:!0,...e}),items:d.bY.map((t=>ce(t,e,this.environment)))}]}),action:()=>{this.stores.pdfFormatPopupStore.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:t=>{let{onClick:s,key:n,...i}=t;const o=w.Sw(e)&&!h.y1(this.environment)&&"business";return(0,W.jsx)(k.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:s,render:(t,s)=>{const n=(0,v.Z)(i,t);return(0,W.jsx)(I.Z,{...n,title:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,W.jsx)("div",{style:{marginLeft:8},children:s})]}),right:(0,W.jsx)(B.Z,{...n,on:e.recursive,disabled:Boolean(o)})})},renderUpgradeTooltip:()=>(0,W.jsx)(U.Z,{imageURL:l.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:O.ug.Left,upgradeButtonDesktopStyle:{marginTop:2}},n)},action:()=>re(this.environment)}])}}function Y(e){let{value:t,onChange:s}=e;window.__c={n:"PercentInput"};const i=(0,g.useIntl)(),o=n.useCallback((e=>{const t=e.target.value,n=(0,u._g)(t)||(0,b.m)(t,i);let o;"object"==typeof n?o="percent"===n.format?n.value:n.value/100:"number"==typeof n&&(o=n/100),void 0!==o&&s(o)}),[s,i]),[a,r]=n.useState(!1),l=n.useMemo((()=>(0,u.uf)(Math.round(100*t),"number",i)),[t,i]);return(0,W.jsx)(P.Z,{capture:a,children:(0,W.jsx)(Z.Z,{value:l,onChange:o,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}})})}Q.displayName="ExportModal";const $=Q;function J(e){switch(e){case"pdf":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}function X(e){switch(e){case"everything":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}function ee(e){switch(e){case"all":return x.default.checkGate("export_collections_v1")?(0,W.jsx)(g.FormattedMessage,{id:"exportModal.includeDatabases.all.label.defaultView",defaultMessage:"Default View"}):(0,W.jsx)(g.FormattedMessage,{id:"exportModal.includeDatabases.all.label.everything",defaultMessage:"Everything"});case"currentView":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view"})}}function te(e){switch(e){case"Letter":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}function se(){const e=w.ZP.state;return e.open&&w.Sw(e)?void 0===e.exportOptions.scale?1:e.exportOptions.scale:1}function ne(){return q(se())}function ie(e){return{width:320,padding:24,fontSize:14,color:e.mediumTextColor}}function oe(){window.__c={n:"OfflineComponent"};const e=(0,r.Fg)();return(0,W.jsx)("div",{style:ie(e),children:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"})})}function ae(){h.Qr()}function re(e){const t=w.ZP.state;if(t.open){if(w.Sw(t)&&!h.y1(e))return void C.y(e,{from:"export_modal",for:"enterprise"});h.BO(e,{...t,recursive:!t.recursive})}}function le(e){if(!ne())return;const t=w.ZP.state;t.open&&(h.Qr(),t.root.table===p.bx?h.AW(e,{spaceId:t.root.id,exportOptions:t.exportOptions,shouldExportComments:t.shouldExportComments}):h.ZO(e,{block:{id:t.root.id,spaceId:(0,m.C)(t.root.spaceId)},recursive:t.recursive,exportOptions:t.exportOptions,shouldExportComments:t.shouldExportComments}))}function de(e,t,s,n){const i=w.ZP.state,o=i.open&&"pdf"===e&&"space"===i.root.table&&!h.y1(n)&&"business";return{key:e,action:()=>{t.close(),o?C.y(n,{from:"export_modal",for:o}):function(e,t,s){const n=w.ZP.state;if(!n.open)return;const{exportOptions:i}=n;if(e===i.exportType)return;let o;o="pdf"===e?{...i,exportType:"pdf",pdfFormat:h.GI(t)}:{...i,exportType:e},h.BO(s,{...n,exportOptions:o})}(e,s,n)},render:t=>{let{onClick:s,key:n,...i}=t;return(0,W.jsx)(k.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:s,render:(t,s)=>(0,W.jsx)(I.Z,{...(0,v.Z)(i,t),title:J(e),right:s}),renderUpgradeTooltip:()=>(0,W.jsx)(U.Z,{imageURL:l.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:(0,W.jsx)(g.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:O.ug.Left,upgradeButtonDesktopStyle:{marginTop:2}},n)}}}function ce(e,t,s){return{key:e,action:()=>{t.close(),function(e,t){const s=w.ZP.state;s.open&&w.Sw(s)&&h.BO(t,{...s,exportOptions:{...s.exportOptions,pdfFormat:e}})}(e,s)},render:t=>(0,W.jsx)(I.Z,{...t,title:te(e)})}}function ue(){window.__c={n:"ScalePercentComponent"};const e=(0,r.Fg)(),t=(0,o.O7)(),s=(0,a.VK)((()=>se()),[]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32},children:[(0,W.jsx)(E.Z,{style:{color:e.lightTextColor},children:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})}),(0,W.jsx)(Y,{value:s,onChange:e=>function(e,t){const s=w.ZP.state;s.open&&w.Sw(s)&&h.BO(t,{...s,exportOptions:{...s.exportOptions,scale:e}})}(e,t)})]}),!q(s)&&(0,W.jsx)(f.Z,{show:!0,showDelay:500,showHold:100,render:t=>t&&(0,W.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"},children:(0,W.jsx)(E.Z,{isSmall:!0,isMultiline:!0,style:{color:e.errorText},children:(0,W.jsx)(g.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200"})})})})]})}},16972:(e,t,s)=>{s.d(t,{Z:()=>Y});var n=s(67294),i=s(73935),o=s(83355),a=s(480),r=s(72126),l=s(9291),d=s(47307),c=s(27153),u=s(53471),m=s(33929),p=s(87279),g=s(83279),h=s(13401),f=s(79131),x=s(1743),y=s(78140),S=s(40721),v=s(72495),b=(s(57658),s(95538)),M=s(43593),j=s(50066),w=s(50906),C=s(99813),k=s(54604),T=s(95477),I=s(49085);class P extends I.default{getInitialState(){return{open:!1}}}const Z=P;var F=s(24736),_=s(52275),A=s(31945),R=s(74194),D=s(32163),B=s(53437),L=s(81865),O=s(85893);const E={flex:"auto",overflow:"hidden"},N={display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"};class V extends o.Z{constructor(){super(...arguments),this.storeTypes={filePropertyMenuItemStore:Z},this.imageNode=void 0,this.renderRenameMenu=()=>{const{device:e}=this.environment,t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;let s;return s=e.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:380},(0,O.jsx)(y.Z,{...s,children:(0,O.jsx)("div",{style:(n=this.theme,{display:"flex",alignItems:"center",color:n.regularTextColor,fontSize:"13px",padding:"4px 8px"}),children:(0,O.jsx)(R.Z,{style:W(this.theme),value:t.inputValue,placeholder:M.w2(this.props.url),onChange:this.handleRenameInputChange,onSubmit:this.handleCloseRename,focusInitial:!0,selectAll:!0})})});var n},this.handleFullScreen=()=>{k.ui({environment:this.environment,renderFullScreenNode:()=>(0,O.jsx)(L.Z,{url:this.props.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,O.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:this.imageNode.getBoundingClientRect(),block:this.props.store,imageUrl:this.props.url})},this.handleRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!0,inputValue:this.props.name})},this.handleCloseRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!1})},this.handleRenameInputChange=e=>{const t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;const s=e.target.value;this.stores.filePropertyMenuItemStore.setState({...t,inputValue:s});const n=M.rF({title:s,source:this.props.url});this.props.onChange({url:this.props.url,name:n})}}renderComponent(){const{url:e}=this.props;return b.SR({url:e})?this.renderImage(e):this.renderFile()}renderImage(e){const{device:t}=this.environment,{disabled:s}=this.props;return(0,O.jsx)(_.Z,{focused:!1,showDragHandle:!s&&!t.isMobile,style:{paddingTop:t.isMobile?12:8,paddingBottom:t.isMobile?12:8,alignItems:"flex-start"},title:(0,O.jsx)(L.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,O.jsx)("div",{style:E,children:(0,O.jsx)("img",{src:t,style:N,onClick:this.handleFullScreen,ref:e=>this.imageNode=e})})}),right:this.renderActionMenu(!0),dontShrinkRight:!0})}renderFile(){const{device:e}=this.environment,{disabled:t}=this.props,{name:s}=this.props;return(0,O.jsx)(B.GI,{open:this.stores.filePropertyMenuItemStore.state.open,popupType:e.isMobile?A.Z4.SlideUp:A.Z4.Popup,origin:(0,O.jsx)(_.Z,{focused:!1,showDragHandle:!t&&!e.isMobile,onClick:()=>K(this.props.url,this.props.name,this.props.store,this.environment),title:s,icon:(0,O.jsx)("div",{style:{width:e.isMobile?16:14},children:(0,j.R)()}),right:this.renderActionMenu(!1),dontShrinkRight:!0}),render:this.renderRenameMenu,onDismiss:this.handleCloseRename})}getActionMenuItems(e){const{device:t}=this.environment,{url:s,disabled:n}=this.props,i=[];return e&&i.push({key:"fullscreen",render:e=>(0,O.jsx)(_.Z,{...e,title:(0,O.jsx)(l.FormattedMessage,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:this.handleFullScreen}),(M.E$(s,[T.default.secureFileS3.url,T.default.secureFileS3V2.url])||t.isNative)&&i.push({key:"download",render:e=>(0,O.jsx)(_.Z,{...e,title:(0,O.jsx)(l.FormattedMessage,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:()=>function(e,t,s,n){w.Uk(n,{url:e,fileName:t,from:"FilePropertyMenuItem"}),C.ji(n,{url:e,download:!0,downloadName:t,permissionRecord:s.pointer})}(this.props.url,this.props.name,this.props.store,this.environment)}),i.push({key:"original",render:e=>(0,O.jsx)(_.Z,{...e,title:(0,O.jsx)(l.FormattedMessage,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:()=>K(this.props.url,this.props.name,this.props.store,this.environment)}),n||e||i.push({key:"rename",render:e=>(0,O.jsx)(_.Z,{...e,title:(0,O.jsx)(l.FormattedMessage,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:this.handleRename}),n||i.push({key:"delete",render:e=>(0,O.jsx)(_.Z,{...e,title:(0,O.jsx)(l.FormattedMessage,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:()=>function(e,t){e(t)}(this.props.onDelete,this.props.url)}),i}renderActionMenu(e){const{device:t}=this.environment;return(0,O.jsx)(A.ZP,{popupType:t.isMobile?A.Z4.SlideUp:A.Z4.Popup,renderOrigin:e=>(0,O.jsx)(F.Z,{isMobile:t.isMobile,...e}),render:s=>{let n;return n=t.isMobile?{menuType:p.og.ActionSheet}:{menuType:p.og.Popup,width:200},(0,O.jsx)(y.Z,{...n,children:(0,O.jsx)(D.Z,{type:D.i.Vertical,initialFocus:0,onAccept:s.close,sections:[{key:"section",render:e=>(0,O.jsx)(v.Z,{...e}),items:this.getActionMenuItems(e)}]})})}})}}V.displayName="FilePropertyMenuItem";const U=V;function W(e){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:4,boxShadow:e.inputBoxShadow,background:e.inputBackground,cursor:"text",position:"relative"}}function K(e,t,s,n){C.Wl(n,{url:e,type:"file",from:"view_original",downloadName:t,permissionRecord:s.pointer})}var z=s(68785),q=s(28992),G=s(32854);const H=function(e){return(0,O.jsx)(q.Z,{title:(0,O.jsxs)("div",{style:{display:"flex"},children:[(0,O.jsx)(z.Z,{style:{marginTop:1,marginRight:6}}),(0,O.jsx)(G.Z,{percentage:e.progressPercent})]})})};class Q extends o.Z{constructor(){super(...arguments),this.uploadingFiles=void 0,this.storeTypes={fileUploadStore:g.Z},this.handleAddFileMount=e=>{e&&(this.addFileButton=e)},this.handleAddFileClick=e=>{this.showMediaPicker()},this.handleMediaPickerUploadStart=e=>{c.Z(),this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=[e]},this.handleMediaPickerUploadComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;const n=this.uploadingFiles[0];if(!n)return;s({value:[...t,{name:n.name||e,url:e}]}),this.stores.fileUploadStore.reset(),c.Z()},this.handleMediaPickerEmbedComplete=e=>{const{value:t,onChange:s}=this.props;s({value:[...t,{name:e,url:e}]}),this.stores.fileUploadStore.reset(),c.Z()},this.handleUploadFilesStart=e=>{this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=e},this.handleUploadFilesComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;s({value:[...this.uploadingFiles.map(((t,s)=>{const n=e[s];return{name:t.name||n,url:n}})),...t]}),this.stores.fileUploadStore.reset()},this.handleUploadProgress=e=>{const{progressPercent:t}=e;this.stores.fileUploadStore.setState({...this.stores.fileUploadStore.state,progressPercent:t})},this.handleUploadError=()=>{this.stores.fileUploadStore.reset(),d.showErrorMessage((0,O.jsx)(l.FormattedMessage,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))}}didMount(){const{device:e}=this.environment,{uploadFiles:t,store:s}=this.props;t?u.IL({environment:this.environment,files:t,bucket:"secure",record:s.pointer,onBatchStart:this.handleUploadFilesStart,onBatchProgress:this.handleUploadProgress,onBatchComplete:this.handleUploadFilesComplete,onBatchError:this.handleUploadError}):$(this.props.value)&&!e.isMobile&&this.showMediaPicker()}willUnmount(){c.Z()}renderComponent(){const{device:e}=this.environment,{disabled:t}=this.props,s=$(this.props.value),{isLoading:n,progressPercent:i}=this.stores.fileUploadStore.state;let o;return o=e.isMobile?{menuType:p.og.Modal,title:(0,O.jsx)(l.FormattedMessage,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,O.jsx)(S.DoneMenuText,{}),onClickRight:this.props.onDismiss}:{menuType:p.og.Popup},(0,O.jsx)(x.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,O.jsxs)(y.Z,{...o,children:[(0,O.jsx)(te,{value:this.props.value,disabled:this.props.disabled,store:this.props.store,onChange:this.props.onChange}),(0,O.jsxs)(v.Z,{topBorder:!s&&!t,desktopStyle:{...s&&{paddingTop:3,paddingBottom:3}},children:[n&&(0,O.jsx)(H,{progressPercent:i}),!n&&!t&&(0,O.jsx)(h.Z,{focused:!1,onClick:this.handleAddFileClick,title:(0,O.jsx)(l.FormattedMessage,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:this.handleAddFileMount})]})]})})}showMediaPicker(){const{store:e}=this.props,t=i.findDOMNode(this.addFileButton);if(!t)return;if(!(t instanceof Element))return;const s=m.default.getIntl();c.$(this.environment,{originRect:t.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:s.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:t=>{u.cT({environment:this.environment,file:t,bucket:"secure",record:e.pointer,onStart:this.handleMediaPickerUploadStart,onProgress:this.handleUploadProgress,onComplete:this.handleMediaPickerUploadComplete,onError:this.handleUploadError})}},{type:"embed",onChange:this.handleMediaPickerEmbedComplete}]})}}Q.displayName="FilePropertyMenu";const Y=Q;function $(e){return 0===e.length}function J(e,t,s){s({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})}function X(e,t,s){s({value:t.filter((t=>t.url!==e))})}function ee(e){let{url:t,value:s,disabled:n,store:i,onChange:o}=e;window.__c={n:"FileComponent"};const r=(0,a.O7)(),{device:l}=r,d=s.find((e=>e.url===t));if(d){const e=d.url,t=d.name;return l.isMobile?(0,O.jsx)(v.Z,{children:(0,O.jsx)(U,{store:i,name:t,url:e,onDelete:e=>X(e,s,o),onChange:e=>J(e,s,o),disabled:n})}):(0,O.jsx)(U,{store:i,name:t,url:e,onDelete:e=>X(e,s,o),onChange:e=>J(e,s,o),disabled:n})}return null}function te(e){let{value:t,disabled:s,store:i,onChange:o}=e;window.__c={n:"FilesComponent"};const l=(0,a.O7)(),{device:d}=l,c=r.oA(t.map((e=>e.url)));return 0===c.length?null:d.isMobile||s?(0,O.jsx)(n.Fragment,{children:c.map((e=>(0,O.jsx)(ee,{url:e,value:t,disabled:s,store:i,onChange:o},e)))}):(0,O.jsx)(v.Z,{children:(0,O.jsx)(f.ZP,{direction:"vertical",keys:c,renderKey:e=>(0,O.jsx)(ee,{url:e,value:t,disabled:s,store:i,onChange:o}),onDrop:e=>function(e,t,s){t({value:r.MR(s,(t=>{const s=t.url;return s?e.indexOf(s):1/0}))})}(e,o,t)})})}},79027:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(41892),l=s(82990),d=s(9291),c=s(91376),u=s(17311),m=s(7844),p=s(42922),g=s(50506),h=s(62385),f=s(85893);function x(){window.__c={n:"GoogleAuthPromptModal"};const e=(0,i.Fy)(),t=(0,o.VK)((()=>m.Z.state.open),[]),s=()=>{m.Z.state.open&&m.Z.state.onDecline&&m.Z.state.onDecline(),m.Z.setState({open:!1})},x=()=>{m.Z.state.open&&m.Z.state.onConfirm(),m.Z.setState({open:!1})},y=()=>{s(),c.r$({currentTab:"connected_apps"})},S=(0,a.yK)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return(0,f.jsx)(g.Z,{open:t,innerStyle:S.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsx)(n.Fragment,{children:(0,f.jsxs)("div",{style:S.modalHeaderWrap,children:[(0,f.jsx)("img",{src:r.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:S.modalMessage,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:S.modalMessage,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(p.Z,{isLarge:!0,onClick:x,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:u.Z.vertical.tiny},children:(0,f.jsx)(h.Z,{underlined:!0,onClick:y,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]})}),onDismiss:s})}},7523:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var n=s(67294),i=s(480),o=s(86628),a=s(15145),r=s(84169),l=s(82990),d=s(9291),c=s(25888),u=s(75754),m=s(18514),p=s(80444),g=s(47593),h=s(16354),f=s(50506),x=s(89728),y=s(3666),S=s(85893);const v={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:l.Z.fontWeight.bold,marginRight:"auto"},b={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},M={padding:"24px 36px 24px",minWidth:300};const j=function(){window.__c={n:"ImportModal"};const e=(0,o.VK)((()=>g.Z.state),[]);return(0,S.jsx)(f.Z,{open:e.open,innerStyle:M,preventHideChildrenWhileOpening:!0,render:()=>(0,S.jsxs)(n.Fragment,{children:[(0,S.jsxs)("div",{style:b,children:[(0,S.jsx)("div",{style:v,children:(0,S.jsx)(d.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})}),(0,S.jsx)(w,{})]}),(0,S.jsx)("div",{children:(0,S.jsx)(k,{modalState:e})})]}),onDismiss:C})};function w(){window.__c={n:"HelpButton"};const e=(0,i.O7)();return(0,S.jsx)(h.Z,{href:(0,m.UY)("guides.import"),onClick:()=>c.Fs(e,{from:"import"}),external:!0,children:(0,S.jsx)(x.Z,{isSmall:!0,icon:r.m,isGray:!0,children:(0,S.jsx)(d.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}function C(){g.Z.setState({open:!1})}function k(e){let{modalState:t}=e;window.__c={n:"ImportOptionsComponent"};const s=(0,i.O7)(),{mainEditorCurrentBlockStore:n,currentSpaceStore:r,currentSpaceViewStore:l,currentUserSettingsStore:d}=(0,o.VK)((()=>p.default.state),[]);return n&&r&&l&&d?(0,S.jsx)(y.Z,{pageStore:t.open&&t.pageStore?t.pageStore:n,spaceStore:r,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>function(e,t){g.Z.setState({open:!1}),u._({environment:t,store:e,pageVisitSource:a.tY.Import})}(e,s),readOnlyCreditButton:!1}):null}},3666:(e,t,s)=>{s.d(t,{Z:()=>wt});var n=s(67294),i=s(83355),o=s(480),a=s(86628),r=s(41892),l=s(56666),d=s(84169),c=s(82356),u=s(63079),m=s(68838),p=s(39370),g=s(4615),h=s(9291),f=s(50906),x=s(57549),y=s(47307),S=s(49085);class v extends S.default{getInitialState(){return{}}}const b=new v;var M=s(54642),j=s(92625);async function w(e){const{environment:t,spaceId:s,requestStore:n}=e;if(!t.currentUser.id)return y.showMessage({message:"Invalid details"}),void j.x();b.setState({...b.state,[s]:{...b.state[s],showLoader:!0}});const i=await M.getConfluenceSpaces(t,{spaceId:s});if(await(null==n?void 0:n.refresh()),b.setState({...b.state,[s]:{...b.state[s],showLoader:!1}}),"failed"!==i.type)return b.setState({...b.state,[s]:{...b.state[s],spacesResult:i.data}}),i.data;console.error(i.error),y.showError(i),j.x()}var C=s(43181),k=s(23586),T=s(68821),I=s(72340),P=s(8989),Z=s(22756),F=s(69122);async function _(e){const t=await M.getTrelloAccount(e,{});return"success"===t.type?t.data:(console.error(t.error),{})}async function A(e){Z.Z.setState({...Z.Z.state,isFetchingAsanaAccount:!0});const t=await M.getAsanaAccount(e,{});if("success"===t.type){const{account:e}=t.data;return Z.Z.setState({...Z.Z.state,account:e,isFetchingAsanaAccount:!1}),e?t.data:{}}return console.error(t.error),Z.Z.setState({...Z.Z.state,isFetchingAsanaAccount:!1}),{}}async function R(e){try{const t=await M.getEvernoteAccount(e,{});if("success"===t.type){const{userInfo:e}=t.data;return{userInfo:e}}return console.error(t.error),{userInfo:void 0}}catch(t){return console.error(t),{userInfo:void 0}}}var D=s(77080);var B=s(87279);var L=s(18514),O=s(88632),E=s(67940),N=s(72087),V=s(8848),U=s(41311),W=s(80444);const K=new(s(61766).Z);var z=s(93405),q=s(31945),G=s(73063),H=s(16354),Q=s(68785),Y=s(78140),$=s(32163),J=s(53437),X=s(72495),ee=s(26388),te=s(64369),se=s(24405),ne=s(82990),ie=s(64921),oe=s(85893);const ae={fontSize:16,fontWeight:ne.Z.fontWeight.medium},re=28,le={flexShrink:0,width:re,height:re,borderRadius:4,marginRight:10,background:V.O9.white};const de=function(e){let{title:t,actionButton:s,onClick:n,tooltipEvents:i,icon:o,logo:a,caption:r,shouldWrapCaption:l}=e;window.__c={n:"ImportOptionsItem"};const d=(0,se.Fg)();return(0,oe.jsxs)(ie.Z,{...i,onClick:n,style:ce(d),children:[(0,oe.jsx)(pe,{icon:o,logo:a}),(0,oe.jsxs)("div",{style:{minWidth:0,width:"100%"},children:[(0,oe.jsxs)("div",{style:{display:"flex"},children:[(0,oe.jsx)("div",{style:ae,children:t}),(0,oe.jsx)("div",{style:{marginLeft:"auto"},children:s})]}),(0,oe.jsx)(ge,{caption:r,shouldWrapCaption:l})]})]})};function ce(e){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:4,marginBottom:12,cursor:"pointer",boxShadow:e.lightBoxShadow,transition:"background 200ms ease-out",background:e.importOptionsButtonBackground}}function ue(e){return{display:"flex",alignItems:"center",justifyContent:"center",width:re,height:re,borderRadius:4,marginRight:8,color:e.mediumTextColor,background:e.importOptionsIconWrapBackground}}function me(e,t){return{fontSize:12,color:e.mediumTextColor,wordBreak:"keep-all",...!t&&{...ne.Z.textOverflowStyle}}}function pe(e){let{icon:t,logo:s}=e;window.__c={n:"IconComponent"};const n=(0,se.Fg)();return s?(0,oe.jsx)("img",{style:le,src:s}):t?(0,oe.jsx)("div",{style:ue(n),children:t({flexShrink:0,width:re,height:re})}):null}function ge(e){let{caption:t,shouldWrapCaption:s}=e;window.__c={n:"CaptionComponent"};const n=(0,se.Fg)();return t?(0,oe.jsx)("div",{style:me(n,s),children:t}):null}const he={whiteSpace:"pre-wrap"};function fe(e,t){return(0,oe.jsx)(ee.ZP,{renderTooltip:()=>(0,oe.jsx)(te.Z,{style:{color:V.ZP.white},isSmall:!0,children:(0,oe.jsx)(h.FormattedMessage,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import"})}),render:s=>(0,oe.jsx)(H.Z,{...s,external:!0,href:e,style:{marginLeft:"auto"},children:(0,oe.jsx)(G.Z,{icon:d.m,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon"})})})})}const xe=function(){window.__c={n:"AsanaV2ImportOption"};const e=(0,a.VK)((()=>Z.Z.state),[]),{account:t,isLoadingAsanaWorkspaces:s,isAccountDelinkingInProgress:i,isAccountLinkingInProgress:d}=e,c=(0,o.O7)(),u=(0,h.useIntl)(),{device:m}=c,p=(0,a.VK)((()=>E.Z.state),[]),f=p.flowId||(0,g.ZP)();(0,n.useEffect)((()=>{p.flowId||E.Z.setState({flowId:f})}),[f,p]);const y={title:u.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana"}),logo:r.Z.images.import.asanaPng,caption:d?u.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating..."}):i?u.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account..."}):t,actionButton:t?(S=[{name:u.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),captionText:u.formatMessage({id:"asanaImportOption.connectAnotherAccount.captionText",defaultMessage:"Ensure you are logged into the new Asana account in your browser"}),action:()=>U.w1({environment:c,flowId:f}).catch((()=>{}))},{name:u.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>U.XP({environment:c})}],(0,oe.jsx)(q.ZP,{popupType:J.kQ.Popup,renderOrigin:e=>s?(0,oe.jsx)(Q.Z,{}):(0,oe.jsx)(G.Z,{ariaLabel:u.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button"}),icon:l.o,...e}),render:e=>{const t={key:"section",render:e=>(0,oe.jsx)(X.Z,{...e}),items:S.map((t=>{let{name:s,captionText:n,action:i}=t;return{key:s,render:e=>(0,oe.jsx)(z.Z,{...e,title:s,caption:n,captionStyle:n?he:void 0}),action:()=>{i(),e.close()}}}))};return(0,oe.jsx)(Y.Z,{menuType:B.og.Popup,width:200,children:(0,oe.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:[t]})})}})):fe((0,L.UY)("guides.importAsana"),u),onClick:()=>{}};var S;return(0,oe.jsx)(q.ZP,{onClick:async()=>{var e;Z.Z.resetImport(),s||d||i||(t?(x.ay(c,{import_source:"asana",from:"settings_modal",userId:c.currentUser.id,spaceId:null===(e=W.default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:f}),await U.bA({environment:c}),U.h7()):U.w1({environment:c,flowId:f}).catch((()=>{})))},popupType:m.isMobile?q.Z4.SlideUp:q.Z4.Popup,buttonPopupStore:K,renderOrigin:e=>{let{onClick:t}=e;return(0,oe.jsx)(de,{...y,onClick:t})},render:()=>null})};var ye=s(36591),Se=s(42853),ve=s(44495),be=s(22711),Me=s(78900),je=s(42922),we=s(52275),Ce=s(61519),ke=s(1743),Te=s(74194),Ie=s(50506),Pe=s(63296),Ze=s(89728),Fe=s(74523),_e=s(58573);class Ae extends S.default{getInitialState(){return{searchQuery:"",selection:new Set}}}const Re=Ae;var De=s(68894),Be=s(43765),Le=s(29551);class Oe extends i.Z{constructor(){super(...arguments),this.storeTypes={store:Re}}UNSAFE_willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,oe.jsx)(Y.Z,{menuType:B.og.Popup,header:this.renderMenuHeader(),width:280,maxHeight:350,children:this.renderMenuList()})}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state;return(0,oe.jsx)(X.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:(0,oe.jsx)(De.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e})})}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:s}=this.stores,{searchQuery:n}=s.state,i=e.map((e=>{const t=(0,_e.ZP)(n,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===i.length)return(0,oe.jsx)(X.Z,{children:(0,oe.jsx)(Be.Z,{title:t})});const o=i.map((t=>{const s=t.items.map((e=>e.name)),n={};return s.forEach((e=>{n[e]=n[e]?n[e]+1:1})),{key:t.name,render:s=>(0,oe.jsx)(X.Z,{...s,title:e.length>1?t.name:void 0}),items:t.items.map((e=>({key:e.key,render:t=>(0,oe.jsx)(we.Z,{...t,title:(0,oe.jsxs)(Le.gq,{gap:2,alignItems:"center",children:[e.name,n[e.name]>1&&(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>e.key,render:t=>(0,oe.jsx)(G.Z,{ariaLabel:`Associated space key is ${e.key}`,disableBackground:!0,icon:ve.D,...t})})]}),right:void 0!==e.count&&(0,oe.jsx)(te.Z,{isSmall:!0,children:e.count})}),action:()=>{this.props.handleClickImportConfluenceWorkspace(e.key,e.name),function(e,t){t(e)}(e,this.props.onComplete)}})))}}));return(0,oe.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:o})}}Oe.displayName="IntegrationConfluenceImportPopup";const Ee=Oe;const Ne={whiteSpace:"pre-wrap"};function Ve(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:n,currentOption:i}=e,o=null===(t=n.find((e=>{let{key:t}=e;return t===i})))||void 0===t?void 0:t.label,a=(0,se.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,oe.jsx)(q.ZP,{popupType:q.Z4.Popup,placementToOrigin:q.pO.Left,renderOrigin:e=>(0,oe.jsxs)(Ze.Z,{...e,isLarge:!0,style:{opacity:1},disabled:!1,children:[o,(0,Se.i)(a.icon)]}),render:e=>{const t={menuType:B.og.Popup,width:250,left:50},i=[{key:"settings-item-section",render:e=>(0,oe.jsx)(X.Z,{...e}),items:n.map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,oe.jsx)(we.Z,{...e,title:i,shouldWrapCaption:!0,right:o===i?(0,oe.jsx)("div",{style:{width:14},children:(0,ye.e)()}):void 0})}}))}];return(0,oe.jsx)(Y.Z,{...t,children:(0,oe.jsx)($.Z,{type:$.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}async function Ue(e){await async function(e){const{environment:t,requestStore:s,userEmail:n,site:i,access_token:o,instance:a,spaceId:r,username:l,password:d,flowId:c}=e;if(!t.currentUser.id)return y.showMessage({message:"Invalid details"}),void j.x();const u=await M.authenticateConfluenceUser(t,{userEmail:n,site:i,access_token:o,instance:a,userId:t.currentUser.id,spaceId:r,username:l,password:d});await s.refresh(),"failed"===u.type?(x.a1(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:u.error},flowId:c}),console.error(u.error),y.showError(u)):(x.a1(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:c}),y.showMessage({message:"Successfully connected confluence instance."}),await w({environment:t,requestStore:s,spaceId:r})),j.x()}(e)}function We(e){let{environment:t,title:s,email:i,accountType:o,site:a,APIToken:r,personalAccessToken:l,confluenceVersion:d,username:c,password:u,hidePopup:m,spaceId:p,flowId:g,requestStore:f}=e;window.__c={n:"ModalContent"};const[x,y]=(0,n.useState)(""),[S,v]=(0,n.useState)("Cloud"),[b,M]=(0,n.useState)(""),[j,w]=(0,n.useState)(""),[C,k]=(0,n.useState)("OAuth2.0"),[T,I]=(0,n.useState)(""),[P,Z]=(0,n.useState)(""),F=(0,se.yK)((e=>({title:{fontWeight:ne.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,oe.jsx)(ke.Z,{capture:!0,children:(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,oe.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,oe.jsxs)("div",{style:{marginBottom:24},children:[(0,oe.jsx)("div",{style:F.title,children:s}),(0,oe.jsx)(Fe.Z,{title:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence"}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8}})]}),(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,oe.jsx)("label",{htmlFor:"accountType",style:{...F.inputLabels},children:o}),(0,oe.jsx)(Ve,{onSelectOption:v,options:[{key:"Cloud",label:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})},{key:"Server",label:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise"})}],currentOption:S})]}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),(0,oe.jsx)("div",{children:"Server"===S?(0,oe.jsxs)("div",{children:[(0,oe.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"},children:[(0,oe.jsx)("label",{htmlFor:"confluenceVersion",style:{...F.inputLabels},children:d}),(0,oe.jsx)(Ve,{onSelectOption:k,options:[{key:"OAuth2.0",label:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later"})},{key:"Basic",label:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9"})}],currentOption:C})]}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0})]}):void 0}),(0,oe.jsx)("label",{htmlFor:"email",style:{...F.inputLabels},children:i}),(0,oe.jsx)(Te.Z,{id:"email",value:x,autoComplete:"off",autoCapitalize:"off",onChange:e=>{y(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"site",style:{...F.inputLabels},children:a}),(0,oe.jsx)(Te.Z,{id:"site",value:b,onChange:e=>M(e.target.value),showClearButton:!0,placeholder:"Cloud"===S?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),"Cloud"===S?(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"APIToken",style:{...F.inputLabels},children:r}),(0,oe.jsx)(Te.Z,{id:"AccessToken",type:"password",value:j,onChange:e=>{w(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]}):(0,oe.jsx)("div",{children:(0,oe.jsx)("div",{children:"Basic"===C?(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"username",style:{...F.inputLabels},children:c}),(0,oe.jsx)(Te.Z,{id:"username",value:T,onChange:e=>{I(e.target.value)},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),(0,oe.jsx)("label",{htmlFor:"password",style:{...F.inputLabels},children:u}),(0,oe.jsx)(Te.Z,{type:"password",id:"password",value:P,onChange:e=>{Z(e.target.value)},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})]}):(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"},children:l}),(0,oe.jsx)(Te.Z,{id:"AccessToken",type:"password",value:j,onChange:e=>{w(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABCi7h",inputElementAttributes:{minLength:4}})]})})})]})]})]}),(0,oe.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,oe.jsx)(Ce.Z,{size:24}),(0,oe.jsx)(je.Z,{isLarge:!0,onClick:async()=>{await Ue({environment:t,userEmail:x,site:b,access_token:"Server"===S&&"Basic"===C?void 0:j,instance:S,username:"Basic"===C?T:void 0,password:"Basic"===C?P:void 0,spaceId:p,flowId:g,requestStore:f}),m()},children:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,oe.jsx)(Pe.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{m()},children:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const Ke=(0,h.injectIntl)((function(e){var t;window.__c={n:"ConfluenceImportOption"};const[s,i]=(0,n.useState)(!1),l=(0,a.VK)((()=>b.getState()),[]),{spaceStore:d,flowId:c}=e,u=[{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience"}),action:()=>{e.handleApiImportClick("confluence",c),i(!0)}},{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content"}),action:()=>e.handleFileUploadClick("confluence",c)}],m=(0,o.O7)(),{device:p}=m,{confluenceResult:f,onComplete:y,intl:S,requestStore:v,spaceViewStore:M}=e,{account:j}=f,k={spacesResult:void 0,showLoader:!1},{showLoader:T}=l[d.id]||k;function I(e,t){x.qy(m,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:c})}function P(e){return(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"},children:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import"})}),(0,oe.jsx)(Ee,{searchInputPlaceholder:S.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space"}),noSearchResultsPlaceholder:S.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces"}),sections:[e],onComplete:async e=>{await async function(e){const{environment:t,onComplete:s,selectedSpace:n,spaceStore:i,spaceViewStore:o,flowId:a}=e,r=await C.A1({environment:t,spaceStore:i,spaceViewStore:o,space:n,flowId:a||(0,g.ZP)()});s(r)}({environment:m,onComplete:y,selectedSpace:e,spaceStore:d,spaceViewStore:M,flowId:c})},handleClickImportConfluenceWorkspace:I})]})}const Z={title:"Confluence",logo:r.Z.images.import.confluencePng,caption:j,actionButton:j&&T?(0,oe.jsx)(Q.Z,{}):j&&e.renderItemActionsButton([{name:S.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),action:()=>e.handleFileUploadClick("confluence",c)},{name:S.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{e.handleApiImportClick("confluence",c),i(!0)}},{name:S.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:s,requestStore:n}=e;b.setState({...b.state,[s]:{...b.state[s],showLoader:!1}}),await be.DP(t,n,s)}({environment:m,spaceId:d.id,requestStore:v})}]),onClick:()=>{}},F=(null===(t=l[d.id])||void 0===t||null===(t=t.spacesResult)||void 0===t?void 0:t.spaces)||[],_={key:"default",name:S.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces"}),items:F.map((e=>({id:e.id,key:e.key,name:e.name})))},A={key:"section",render:e=>(0,oe.jsx)(X.Z,{...e}),items:u.map((e=>{let{name:t,captionText:s,action:n}=e;return{key:t,render:e=>(0,oe.jsx)(z.Z,{...e,title:t,caption:s,captionStyle:s?Ne:void 0}),action:n}}))};return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(q.ZP,{popupType:p.isMobile?q.Z4.SlideUp:q.Z4.Popup,onClick:()=>{j&&w({environment:m,requestStore:v,spaceId:d.id}).catch((()=>{}))},buttonPopupStore:Me.Z,render:e=>j?function(e){return T?(0,oe.jsx)(oe.Fragment,{}):P(e)}(_):(0,oe.jsx)(Y.Z,{menuType:B.og.Popup,width:200,children:(0,oe.jsx)($.Z,{onAccept:e.close,type:$.i.Vertical,initialFocus:void 0,sections:[A]})}),renderOrigin:e=>{let{onClick:t}=e;return(0,oe.jsx)(de,{...Z,onClick:t})}}),(0,oe.jsx)(Ie.Z,{open:s,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{i(!1)},render:()=>(0,oe.jsx)(We,{hidePopup:()=>{i(!1)},environment:m,title:(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Email help text button",disableBackground:!0,icon:ve.D,...e})})]}),accountType:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance"}),(0,oe.jsx)(ee.ZP,{style:{width:300,whiteSpace:"normal"},placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Confluence instance type help text button",disableBackground:!0,icon:ve.D,...e})})]}),site:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site"}),(0,oe.jsx)(ee.ZP,{style:{width:300,whiteSpace:"normal"},placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Confluence site help text button",disableBackground:!0,icon:ve.D,...e})})]}),APIToken:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Confluence access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:ve.D,...e})})]}),personalAccessToken:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Confluence personal access token help text button",onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:ve.D,...e})})]}),confluenceVersion:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version"}),(0,oe.jsx)(ee.ZP,{style:{width:300,whiteSpace:"normal"},placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Confluence version help text button",onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:ve.D,...e})})]}),username:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.username",defaultMessage:"Username"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Confluence user's username help text button",disableBackground:!0,icon:ve.D,...e})})]}),password:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.password",defaultMessage:"Password"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data"}),render:e=>(0,oe.jsx)(G.Z,{ariaLabel:"Confluence user's password help text button",disableBackground:!0,icon:ve.D,...e})})]}),spaceId:d.id,flowId:c,requestStore:v})})]})}));var ze=s(72126),qe=s(23867),Ge=s(83805),He=s(12714),Qe=s(53833),Ye=s(90365),$e=(s(57658),s(60458)),Je=s(28992),Xe=s(62385);const et=function(e){window.__c={n:"DotSeparator"};const{style:t}=(0,se.yK)((t=>({style:{display:"inline-block",textAlign:"center",color:e.disabled?t.lightTextColor:t.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}})),[e]);return(0,oe.jsx)("div",{style:t,children:"·"})};class tt extends i.Z{constructor(){super(...arguments),this.storeTypes={store:Re},this.handleSelectAllClick=()=>{const{sections:e,analyticsName:t}=this.props,{store:s}=this.stores,{selection:n}=s.state;for(const i of e)for(const e of i.items)n.add(e.key);s.emit(),x.Vf(this.environment,{integration_name:t})},this.handleDeselectAllClick=()=>{const{analyticsName:e}=this.props,{store:t}=this.stores,{selection:s}=t.state;s.clear(),t.emit(),x.FI(this.environment,{integration_name:e})},this.handleToggleItem=e=>{const{analyticsName:t}=this.props,{store:s}=this.stores,{selection:n}=s.state;n.has(e.key)?(n.delete(e.key),x.Z3(this.environment,{integration_name:t})):(n.add(e.key),x.Gl(this.environment,{integration_name:t})),s.emit()},this.handleImport=()=>{const{sections:e}=this.props,{selection:t}=this.stores.store.state,s=ze.xH(e.map((e=>e.items))),n=[];t.forEach((e=>{const t=s.find((t=>t.key===e));t&&n.push(t)})),this.props.onComplete(n)}}UNSAFE_willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,oe.jsx)(Y.Z,{menuType:B.og.Popup,header:this.renderMenuHeader(),footer:this.renderMenuFooter(),width:280,maxHeight:350,children:this.renderMenuList()})}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state,s=Boolean(t);return(0,oe.jsxs)(X.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:[(0,oe.jsx)(De.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}),(0,oe.jsx)(Je.Z,{isTokenTitle:!0,style:{marginTop:2},title:(0,oe.jsxs)("div",{style:{marginLeft:-3},children:[(0,oe.jsx)(Xe.Z,{onClick:this.handleSelectAllClick,disabled:s,disabledFeedback:!0,children:(0,oe.jsx)(h.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})}),(0,oe.jsx)(et,{disabled:s}),(0,oe.jsx)(Xe.Z,{onClick:this.handleDeselectAllClick,disabled:s,disabledFeedback:!0,children:(0,oe.jsx)(h.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})})]})})]})}renderMenuFooter(){const e=0===this.stores.store.state.selection.size;return(0,oe.jsx)(X.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8},children:(0,oe.jsx)(Je.Z,{title:(0,oe.jsx)(je.Z,{disabled:e,onClick:this.handleImport,children:(0,oe.jsx)(h.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"})})})})}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:s}=this.stores,{searchQuery:n,selection:i}=s.state,o=e.map((e=>{const t=(0,_e.ZP)(n,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===o.length)return(0,oe.jsx)(X.Z,{children:(0,oe.jsx)(Be.Z,{title:t})});const a=o.map((t=>({key:t.name,render:s=>(0,oe.jsx)(X.Z,{...s,title:e.length>1?t.name:void 0}),items:t.items.map((e=>{const t=()=>this.handleToggleItem(e);return{key:e.key,render:s=>(0,oe.jsx)(we.Z,{...s,title:e.name,icon:(0,oe.jsx)($e.Z,{checked:i.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&(0,oe.jsx)(te.Z,{isSmall:!0,children:e.count})}),action:t}}))})));return(0,oe.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:a})}}tt.displayName="IntegrationImportPopup";const st=tt;class nt extends i.Z{constructor(){super(...arguments),this.evernoteStoreState=this.createComputedStore((()=>Qe.Z.getState())),this.handleClickImportEvernote=async()=>{var e;const{isFetchingNotebooks:t}=this.evernoteStoreState.state;t&&await Ge.B({environment:this.environment,requestStore:this.props.requestStore});const s=E.Z.getOrCreateFlowId();x.ay(this.environment,{import_source:"evernote",from:this.props.analyticsFrom,flowId:s,userId:this.environment.currentUser.id,spaceId:null===(e=W.default.state.currentSpaceStore)||void 0===e?void 0:e.id})}}renderComponent(){const{device:e}=this.environment,{evernoteResult:t,intl:s}=this.props,{userInfo:n}=t,{notebooksResponse:i,showLoader:o}=this.evernoteStoreState.state,a=(null==i?void 0:i.notebooks)||[],l=ze.vM(a,(e=>e.stack||"")),d=Object.keys(l).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(l[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),c={title:"Evernote",logo:r.Z.images.import.evernotePng,shouldWrapCaption:!n,caption:n?n.name||n.username||n.email:void 0,actionButton:n&&o?(0,oe.jsx)(Q.Z,{}):n?this.props.renderItemActionsButton([{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:()=>{return e=this.environment,void He.D({environment:e,url:(0,L.UY)("guides.importEvernote")});var e}},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>Ye.Z.setState({open:!0})},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>ot(this.props.requestStore,this.environment)},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await M.disconnectEvernote(t,{}),Qe.Z.setState({notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1}),await e.refresh(),x.qJ(t,{integration_name:"evernote"})}(this.props.requestStore,this.environment)}]):this.props.defaultActionButton,onClick:()=>{}};return(0,oe.jsx)(q.ZP,{popupType:e.isMobile?q.Z4.SlideUp:q.Z4.Popup,buttonPopupStore:Ye.Z,onClick:this.handleClickImportEvernote,render:()=>o?(0,oe.jsx)(oe.Fragment,{}):(0,oe.jsx)(st,{searchInputPlaceholder:s.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…"}),noSearchResultsPlaceholder:s.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks"}),analyticsName:"evernote",sections:d,onComplete:e=>async function(e,t,s,n,i,o,a){const{notebooks:r}=e,l=r.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));x.G7(a,{integration_name:"evernote",count:t.length});const d=await C.am({environment:a,spaceStore:s,spaceViewStore:n,userSettingsStore:i,notebooks:l});x.qy(a,{import_source:"evernote",data:{notebooks:l.map((e=>e.guid)),userId:a.currentUser.id,spaceId:(0,qe.C)(s.id)},flowId:E.Z.getOrCreateFlowId()}),o(d)}(i,e,this.props.spaceStore,this.props.spaceViewStore,this.props.userSettingsStore,this.props.onComplete,this.environment)}),renderOrigin:e=>{let{onClick:t}=e;return(0,oe.jsx)(de,{...c,onClick:n?t:()=>ot(this.props.requestStore,this.environment)})}})}}nt.displayName="EvernoteImportOption";const it=(0,h.injectIntl)(nt);async function ot(e,t){await Ge.e({environment:t,requestStore:e})}var at=s(33929);const rt=(0,h.defineMessages)({JiraAuthorizationError:{id:"jiraImport.unauthorizedAccess",defaultMessage:"Unauthorized Error: API key does not belong to Jira Admin."},JiraAuthenticationSuccess:{id:"jiraImport.successfulAuth",defaultMessage:"Successfully established Jira connection"},JiraAuthenticationInvalidDetails:{id:"jiraImport.invalidDetails",defaultMessage:"Invalid Details"}});function lt(e){let{environment:t,title:s,email:i,site:o,APIToken:a,hidePopup:r,handleAuthentication:l}=e;window.__c={n:"ModalContent"};const[d,c]=(0,n.useState)(""),[u,m]=(0,n.useState)(""),[p,g]=(0,n.useState)(""),f=(0,se.yK)((e=>({title:{fontWeight:ne.Z.fontWeight.semibold},inputLabels:{fontSize:ne.Z.fontSize.UIRegular.desktop,fontWeight:ne.Z.fontWeight.regular},helpText:{textAlign:"center",marginTop:"5px",lineHeight:ne.Z.lineHeight.UISmall.desktop,fontSize:ne.Z.fontSize.UISmall.desktop,color:e.lightTextColor}})),[]);return(0,oe.jsx)(ke.Z,{capture:!0,children:(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,oe.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,oe.jsx)("div",{style:{marginBottom:24},children:(0,oe.jsx)("div",{style:f.title,children:s})}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),(0,oe.jsx)("label",{htmlFor:"email",style:{...f.inputLabels},children:i}),(0,oe.jsx)(Te.Z,{id:"email",value:d,autoComplete:"off",autoCapitalize:"off",onChange:e=>{c(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"site",style:{...f.inputLabels},children:o}),(0,oe.jsx)(Te.Z,{id:"site",value:u,onChange:e=>m(e.target.value),showClearButton:!0,placeholder:"https://jira.atlassian.net",inputElementAttributes:{minLength:4}}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"APIToken",style:{...f.inputLabels},children:a}),(0,oe.jsx)(Te.Z,{id:"AccessToken",type:"password",value:p,onChange:e=>{g(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]})]})]})]}),(0,oe.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,oe.jsx)(Ce.Z,{size:24}),(0,oe.jsx)(je.Z,{isLarge:!0,onClick:()=>{l({email:d,site:u,apiToken:p}),r()},children:(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,oe.jsx)(Pe.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{r()},children:(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const dt=function(e){const{showPopup:t,hidePopup:s,environment:n,handleAuthentication:i}=e;return(0,oe.jsx)(Ie.Z,{open:t,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:s,render:()=>(0,oe.jsx)(lt,{hidePopup:s,environment:n,title:(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.emailMessage",defaultMessage:"Email"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.emailHelpText",defaultMessage:"Email address of the Atlassian user importing the data"}),render:e=>(0,oe.jsx)(G.Z,{...e,ariaLabel:"Email help text button",disableBackground:!0,icon:ve.D})})]}),site:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.siteMessage",defaultMessage:"Site"}),(0,oe.jsx)(ee.ZP,{style:{width:300,whiteSpace:"normal"},placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Atlassian app. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>(0,oe.jsx)(G.Z,{...e,ariaLabel:"Atlassian API token site help text button",disableBackground:!0,icon:ve.D})})]}),APIToken:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"AtlassianApiTokenAuthentication.stepsToGetAPIToken.captions",defaultMessage:"Click to learn how to get access token from Atlassian account"}),render:e=>(0,oe.jsx)(G.Z,{...e,ariaLabel:"Atlassian access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account/#Create-an-API-token","_blank")},icon:ve.D})})]}),handleAuthentication:e=>i(e)})})};const ct=function(e){window.__c={n:"JiraImportOption"};const{requestStore:t,spaceStore:s,flowId:i}=e,a=(0,o.O7)(),{device:l}=a,[d,c]=(0,n.useState)(!1),u={title:"Jira",logo:r.Z.images.externalIntegrations.jiraIconPng,onClick:()=>{}},m=async e=>{await async function(e){const{environment:t,userEmail:s,site:n,apiToken:i,spaceId:o,flowId:a}=e;if(!t.currentUser.id)return y.showMessage({message:at.default.formatMessage(rt.JiraAuthenticationInvalidDetails)}),void j.x();const r=await M.authenticateJiraUser(t,{userEmail:s,site:n,apiKey:i,userId:t.currentUser.id,spaceId:o});var l;"failed"===r.type?(x.a1(t,{import_source:"jira",data:{import_type:"api",status:"failure",error:r.error},flowId:a}),console.error(r.error),y.showError(r)):null!=r&&null!==(l=r.data)&&void 0!==l&&l.isAdmin?(x.a1(t,{import_source:"jira",data:{import_type:"api",status:"success"},flowId:a}),y.showMessage({message:at.default.formatMessage(rt.JiraAuthenticationSuccess)})):(x.a1(t,{import_source:"jira",data:{import_type:"api",status:"failure"},flowId:a}),y.showErrorMessage(at.default.formatMessage(rt.JiraAuthorizationError))),j.x()}({environment:a,requestStore:t,userEmail:e.email,site:e.site,apiToken:e.apiToken,spaceId:s.id,flowId:i})};return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(q.ZP,{renderOrigin:e=>{let{onClick:t}=e;return(0,oe.jsx)(de,{...u,onClick:()=>c(!0)})},popupType:l.isMobile?q.Z4.SlideUp:q.Z4.Popup,render:()=>(0,oe.jsx)(oe.Fragment,{})}),(0,oe.jsx)(dt,{showPopup:d,hidePopup:()=>c(!1),environment:a,handleAuthentication:async e=>await m(e)})]})};var ut=s(61397);const mt={whiteSpace:"pre-wrap"};const pt=e=>{window.__c={n:"MondayPopup"};const t=(0,a.VK)((()=>F.Z.state),[]),{environment:s,spaceStore:n,flowId:i}=e;return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsx)(Ie.Z,{open:t.showAuthPopup,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{F.Z.setState({...F.Z.state,showAuthPopup:!1})},render:()=>(0,oe.jsx)(gt,{hidePopup:()=>{F.Z.setState({...F.Z.state,showAuthPopup:!1})},environment:s,title:(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.emailMessage",defaultMessage:"Email"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.emailHelpText",defaultMessage:"Email address of the Monday.com user importing the data"}),render:e=>(0,oe.jsx)(G.Z,{...e,ariaLabel:"Email help text button",disableBackground:!0,icon:ve.D})})]}),APIToken:(0,oe.jsxs)(Le.gq,{style:{alignItems:"center",gap:2},children:[(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,oe.jsx)(ee.ZP,{placement:ee.ug.Right,renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.stepsToGetMondayAPIToken.captions",defaultMessage:"Click to learn how to get API token from Monday.com"}),render:e=>(0,oe.jsx)(G.Z,{...e,ariaLabel:"Monday.com API token help text button",onClick:()=>{window.open("https://developer.monday.com/api-reference/docs/authentication#accessing-api-tokens","_blank")},icon:ve.D})})]}),flowId:i,spaceStore:n})})})};function gt(e){let{environment:t,title:s,email:n,APIToken:i,hidePopup:o,flowId:r,spaceStore:l}=e;window.__c={n:"ModalContent"};const d=(0,a.VK)((()=>F.Z.state),[]),c=(0,se.yK)((e=>({title:{fontWeight:ne.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,oe.jsx)(ke.Z,{capture:!0,children:(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,oe.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,oe.jsxs)("div",{style:{marginBottom:24},children:[(0,oe.jsx)("div",{style:c.title,children:s}),(0,oe.jsx)(Fe.Z,{title:(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Monday.com"}),href:"https://notion.notion.site/Monday-com-Importer-Beta-Overview-cd8d35a92eed452cbef1829a10e30fe5",analyticsFrom:"import",style:{marginTop:8}})]}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"email",style:{...c.inputLabels},children:n}),(0,oe.jsx)(Te.Z,{id:"email",value:d.email,autoComplete:"off",autoCapitalize:"off",onChange:e=>{F.Z.setState({...F.Z.state,email:e.target.value})},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,oe.jsx)(Ce.Z,{size:12,isHidden:!0}),(0,oe.jsxs)("div",{children:[(0,oe.jsx)("label",{htmlFor:"APIToken",style:{...c.inputLabels},children:i}),(0,oe.jsx)(Te.Z,{id:"AccessToken",type:"password",value:d.APIToken,onChange:e=>{F.Z.setState({...F.Z.state,APIToken:e.target.value})},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]})]})]}),(0,oe.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,oe.jsx)(Ce.Z,{size:24}),(0,oe.jsx)(je.Z,{isLarge:!0,onClick:async()=>{await ut.qF({environment:t,userEmail:d.email,APIToken:d.APIToken,flowId:r,spaceId:l.id}),o()},children:(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,oe.jsx)(Pe.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{o()},children:(0,oe.jsx)(h.FormattedMessage,{id:"mondayAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const ht=function(e){window.__c={n:"MondayImportOption"};const t=(0,a.VK)((()=>F.Z.state),[]),s=(0,a.VK)((()=>E.Z.state),[]),{account:i,isLoadingMondayWorkspaces:d}=t,{spaceStore:c}=e,u=(0,o.O7)(),m=(0,h.useIntl)(),{device:p}=u,f=s.flowId||(0,g.ZP)();(0,n.useEffect)((()=>{s.flowId||E.Z.setState({flowId:f})}),[f,s]);const y={title:m.formatMessage({id:"mondayImportOption.mondayButton.title",defaultMessage:"Monday.com"}),logo:r.Z.images.import.mondayPng,caption:i,actionButton:i?(S=[{name:m.formatMessage({id:"mondayImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{F.Z.setState({...F.Z.state,showAuthPopup:!0})}},{name:m.formatMessage({id:"mondayImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>ut.sC({environment:u,spaceId:c.id})}],(0,oe.jsx)(q.ZP,{popupType:J.kQ.Popup,renderOrigin:e=>d?(0,oe.jsx)(Q.Z,{}):(0,oe.jsx)(G.Z,{ariaLabel:m.formatMessage({id:"mondayImportOption.mondayButton.ariaLabel",defaultMessage:"Import from Monday.com button"}),icon:l.o,...e}),render:e=>{const t={key:"section",render:e=>(0,oe.jsx)(X.Z,{...e}),items:S.map((t=>{let{name:s,captionText:n,action:i}=t;return{key:s,render:e=>(0,oe.jsx)(z.Z,{...e,title:s,caption:n,captionStyle:n?mt:void 0}),action:()=>{i(),e.close()}}}))};return(0,oe.jsx)(Y.Z,{menuType:B.og.Popup,width:200,children:(0,oe.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:[t]})})}})):void 0,onClick:()=>{}};var S;return(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsx)(q.ZP,{onClick:async()=>{F.Z.resetImport(),i?(x.ay(u,{import_source:"monday.com",from:e.analyticsFrom,userId:u.currentUser.id,spaceId:c.id,flowId:f}),await ut.FM({environment:u,spaceId:c.id}),ut.h7()):F.Z.setState({...F.Z.state,showAuthPopup:!0})},popupType:p.isMobile?q.Z4.SlideUp:q.Z4.Popup,buttonPopupStore:K,renderOrigin:e=>{let{onClick:t}=e;return(0,oe.jsx)(de,{...y,onClick:t})},render:()=>null}),(0,oe.jsx)(pt,{environment:u,spaceStore:c,flowId:f})]})};var ft=s(52192),xt=s(82066),yt=s(81676);class St extends i.Z{constructor(){super(...arguments),this.trelloStoreState=this.createComputedStore((()=>yt.Z.getState())),this.handleClickImportTrello=async()=>{this.trelloStoreState.state.isFetchingBoards&&await ft.u(this.environment,this.props.requestStore),x.ay(this.environment,{import_source:"trello",from:this.props.analyticsFrom})}}renderComponent(){const{device:e}=this.environment,{trelloResult:t,intl:s}=this.props,{account:n}=t,{boardsResponse:i,showLoader:o}=this.trelloStoreState.state,a=i.boards,l={key:"default",name:s.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:a.map((e=>({key:e.id,name:e.name})))},d={title:"Trello",logo:r.Z.images.import.trelloPng,actionButton:n&&o?(0,oe.jsx)(Q.Z,{}):n&&this.props.renderItemActionsButton([{name:s.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>xt.Z.setState({open:!0})},{name:s.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>bt(this.props.requestStore,this.environment)},{name:s.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e,t){await M.disconnectTrello(t,{}),yt.Z.setState({boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}),await e.refresh(),x.qJ(t,{integration_name:"trello"})}(this.props.requestStore,this.environment)}]),onClick:()=>{}};return(0,oe.jsx)(q.ZP,{popupType:e.isMobile?q.Z4.SlideUp:q.Z4.Popup,buttonPopupStore:xt.Z,onClick:this.handleClickImportTrello,render:()=>o?(0,oe.jsx)(oe.Fragment,{}):(0,oe.jsx)(st,{searchInputPlaceholder:s.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…"}),noSearchResultsPlaceholder:s.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards found."}),analyticsName:"trello",sections:[l],onComplete:e=>async function(e,t,s,n,i,o){const{boards:a}=e,r=a.filter((e=>Boolean(t.find((t=>t.key===e.id)))));x.G7(o,{integration_name:"trello",count:t.length});const l=await C.su({environment:o,spaceStore:s,spaceViewStore:n,boards:r});i(l)}(i,e,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment)}),renderOrigin:e=>{let{onClick:t}=e;return(0,oe.jsx)(de,{...d,onClick:n?t:()=>bt(this.props.requestStore,this.environment)})}})}}St.displayName="TrelloImportOption";const vt=(0,h.injectIntl)(St);async function bt(e,t){await ft.M({environment:t,requestStore:e})}const Mt={display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240};class jt extends i.Z{constructor(){super(...arguments),this.storeTypes={trelloRequestStore:N.Z,asanaRequestStore:N.Z,evernoteRequestStore:N.Z,confluenceRequestStore:N.Z,mondayRequestStore:N.Z,jiraRequestStore:N.Z}}renderComponent(){if(!O.Z.state.online)return(0,oe.jsx)("div",{style:{...Mt,fontSize:14,color:this.theme.mediumTextColor},children:(0,oe.jsx)(h.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."})});const{analyticsFrom:e}=this.props;return this.renderRequests((t=>t?(0,oe.jsx)("div",{style:Mt,children:this.renderOptions(t)}):(0,oe.jsx)("div",{style:"onboarding"===e?{}:Mt,children:(0,oe.jsx)(Q.Z,{})})))}renderOptions(e){const t=E.Z.state.flowId||(0,g.ZP)();return(0,oe.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,oe.jsx)(Ct,{asanaResult:e.asanaResult}),(0,I.Tc)(this.environment)?this.renderConfluenceImportViaAPIOption(e.confluenceResult,t):(0,oe.jsx)(Pt,{analyticsFrom:this.props.analyticsFrom,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,onComplete:this.props.onComplete,pageStore:this.props.pageStore,flowId:t}),(0,oe.jsx)(de,{title:"Google Docs",logo:r.Z.images.import.googleDocsPng,actionButton:(0,oe.jsx)(kt,{url:(0,L.UY)("guides.importGoogleDocs")}),onClick:()=>It("gdocs",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore)}),(0,oe.jsx)(Zt,{analyticsFrom:this.props.analyticsFrom,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,onComplete:this.props.onComplete,pageStore:this.props.pageStore}),(0,oe.jsx)(de,{title:(0,oe.jsx)(h.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown"}),icon:p.S,onClick:()=>It("markdown",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore)}),(0,oe.jsx)(de,{title:"HTML",icon:m.S,onClick:()=>It("html",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore)}),(0,oe.jsx)(de,{title:"Word",logo:r.Z.images.import.wordPng,onClick:()=>It("docx",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore)}),(0,oe.jsx)(de,{title:"Dropbox Paper",logo:r.Z.images.import.dropboxPaperPng,actionButton:(0,oe.jsx)(kt,{url:(0,L.UY)("guides.importDropboxPaper")}),onClick:()=>It("dropbox",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore)}),this.renderTrelloImportOption(e.trelloResult),this.renderEvernoteImportOption(e.evernoteResult),"on"===D.default.getEligibleGroup({experimentId:"monday_importer",defaultGroup:"control"})&&(0,oe.jsx)(ht,{spaceStore:this.props.spaceStore,analyticsFrom:this.props.analyticsFrom,flowId:t}),(0,oe.jsx)(de,{title:"Quip",logo:r.Z.images.import.quipPng,actionButton:(0,oe.jsx)(kt,{url:(0,L.UY)("guides.importQuip")}),onClick:()=>It("quip",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore)}),(0,oe.jsx)(de,{title:"Workflowy",logo:r.Z.images.import.workflowyPng,actionButton:(0,oe.jsx)(kt,{url:(0,L.UY)("guides.importWorkflowy")}),onClick:()=>It("workflowy",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore)}),(0,P.t)()&&(0,oe.jsx)(de,{title:(0,oe.jsx)(h.FormattedMessage,{id:"importOptions.genericImporter.title",defaultMessage:"Universal import"}),icon:c.l,onClick:()=>It("genericImporter",this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore,t),actionButton:(0,oe.jsx)(kt,{url:"",helpButtonMessage:(0,oe.jsx)(h.FormattedMessage,{id:"importOptions.universalImport.tooltip",defaultMessage:"Import any ZIP file that contains text, Markdown, CSV, HTML, and other files"}),helpMessageWidth:240,disableBackground:!0})}),"on"===D.default.getEligibleGroup({experimentId:"jira_import_and_sync",defaultGroup:"control"})&&this.renderJiraImportOption(t)]})}renderRequests(e){return(0,oe.jsx)(k.Z,{request:this.environment,performRequest:_,requestStore:this.stores.trelloRequestStore,render:(t,s)=>(0,oe.jsx)(k.Z,{request:this.environment,performRequest:A,requestStore:this.stores.asanaRequestStore,render:(t,n)=>(0,oe.jsx)(k.Z,{request:this.environment,performRequest:R,requestStore:this.stores.evernoteRequestStore,render:(t,i)=>(0,oe.jsx)(k.Z,{request:this.environment,performRequest:()=>async function(e,t){const s=await M.getConfluenceAccount(e,{spaceId:t});return"success"===s.type?s.data:(console.error(s.error),{})}(this.environment,this.props.spaceStore.id),requestStore:this.stores.confluenceRequestStore,render:(t,o)=>(0,oe.jsx)(k.Z,{request:this.environment,performRequest:()=>async function(e,t){F.Z.setState({...F.Z.state,isFetchingMondayAccount:!0});const s=await M.getMondayUser(e,{spaceId:t});var n,i;return"success"===s.type?null!==(n=s.data.user)&&void 0!==n&&n.email?(F.Z.setState({...F.Z.state,isFetchingMondayAccount:!1,account:null===(i=s.data.user)||void 0===i?void 0:i.email}),s.data):{user:void 0}:(F.Z.setState({...F.Z.state,isFetchingMondayAccount:!1}),console.error(s.error),{user:void 0})}(this.environment,this.props.spaceStore.id),requestStore:this.stores.mondayRequestStore,render:(t,a)=>e(s&&n&&i&&o&&a?{trelloResult:s,asanaResult:n,evernoteResult:i,confluenceResult:o,mondayResult:a}:void 0)})})})})})}renderTrelloImportOption(e){return(0,oe.jsx)(vt,{trelloResult:e,analyticsFrom:this.props.analyticsFrom,renderItemActionsButton:e=>(0,oe.jsx)(Tt,{actions:e}),onComplete:this.props.onComplete,requestStore:this.stores.trelloRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderConfluenceImportViaAPIOption(e,t){const{analyticsFrom:s,onComplete:n,spaceStore:i,spaceViewStore:o,userSettingsStore:a}=this.props;return(0,oe.jsx)(Ke,{confluenceResult:e,analyticsFrom:s,flowId:t,renderItemActionsButton:e=>(0,oe.jsx)(Tt,{actions:e}),onComplete:n,spaceStore:i,requestStore:this.stores.confluenceRequestStore,spaceViewStore:o,userSettingsStore:a,handleFileUploadClick:(e,t)=>It(e,this.props.analyticsFrom,this.props.spaceStore,this.props.spaceViewStore,this.props.onComplete,this.environment,this.props.pageStore,t),handleApiImportClick:(e,t)=>function(e,t,s,n,i,o){w({environment:i,requestStore:t,spaceId:s.id}).catch((()=>{})),x.ay(i,{import_source:e,from:n,import_type:"api",flowId:o})}(e,this.props.confluenceRequestStore,this.props.spaceStore,this.props.analyticsFrom,this.environment,t)})}renderJiraImportOption(e){const{spaceStore:t}=this.props;return(0,oe.jsx)(ct,{flowId:e,spaceStore:t,requestStore:this.stores.jiraRequestStore})}renderEvernoteImportOption(e){return(0,oe.jsx)(it,{evernoteResult:e,analyticsFrom:"onboarding",renderItemActionsButton:e=>(0,oe.jsx)(Tt,{actions:e}),defaultActionButton:(0,oe.jsx)(kt,{url:(0,L.UY)("guides.importEvernote")}),onComplete:this.props.onComplete,requestStore:this.stores.evernoteRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}}jt.displayName="ImportOptions";const wt=jt;function Ct(e){let{asanaResult:t}=e;window.__c={n:"AsanaImportOption"};return(0,a.VK)((()=>(0,T.c)()),[])?(0,oe.jsx)(xe,{}):null}function kt(e){let{url:t,helpButtonMessage:s,helpMessageWidth:n,disableBackground:i}=e;return(0,oe.jsx)(ee.ZP,{renderTooltip:()=>s??(0,oe.jsx)(h.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),style:{width:n??170},textWrap:!0,render:e=>(0,oe.jsx)(H.Z,{external:!0,href:t,style:{marginLeft:"auto"},...e,children:(0,oe.jsx)(G.Z,{icon:d.m,disableBackground:i??!1})})})}function Tt(e){let{actions:t}=e;return(0,oe.jsx)(q.ZP,{popupType:J.kQ.Popup,renderOrigin:e=>(0,oe.jsx)(G.Z,{icon:l.o,...e}),render:e=>{const s={key:"section",render:e=>(0,oe.jsx)(X.Z,{...e}),items:t.map((t=>{let{name:s,action:n}=t;return{key:s,render:e=>(0,oe.jsx)(we.Z,{...e,title:s}),action:()=>{n(),e.close()}}}))};return(0,oe.jsx)(Y.Z,{menuType:B.og.Popup,width:200,children:(0,oe.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:[s]})})}})}async function It(e,t,s,n,i,o,a,r){x.ay(o,{import_source:e,from:t,import_type:"file",flowId:r});const l=await C.ro({environment:o,pageStore:a,spaceStore:s,spaceViewStore:n,uploadType:e,flowId:r});l&&(f.W2j(o,{from:"import",type:"page",new_page_id:l.id,creating_block_id:l.id}),i(l))}function Pt(e){let{flowId:t,analyticsFrom:s,spaceStore:n,spaceViewStore:i,onComplete:a,pageStore:l}=e;window.__c={n:"ConfluenceImportViaFileOptionComponent"};const d=(0,o.O7)();return(0,oe.jsx)(de,{title:"Confluence",logo:r.Z.images.import.confluencePng,onClick:()=>It("confluence",s,n,i,a,d,l,t),actionButton:(0,oe.jsx)(kt,{url:(0,L.UY)("guides.importConfluence")})})}function Zt(e){let{analyticsFrom:t,spaceStore:s,spaceViewStore:n,onComplete:i,pageStore:a}=e;window.__c={n:"CsvImportWithTooltipComponent"};const r=(0,o.O7)();return(0,oe.jsx)(ee.ZP,{placement:ee.ug.Bottom,render:e=>(0,oe.jsx)(de,{tooltipEvents:e,title:"CSV",icon:u.Y,onClick:()=>It("csv",t,s,n,i,r,a)}),renderTooltip:()=>(0,oe.jsx)(h.FormattedMessage,{id:"importOptions.csvImport.tooltip",defaultMessage:"Ensure first row in the CSV is the header"})})}},15474:(e,t,s)=>{s.r(t),s.d(t,{IntegrationGalleryModal:()=>Z});s(57658);var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(58573),l=s(2585),d=s(5257),c=s(35840),u=s(74181),m=s(72126),p=s(9291),g=s(89475),h=s(12170),f=s(80444),x=s(30874),y=s(49900),S=s(35878),v=s(42922),b=s(52275),M=s(73063),j=s(74194),w=s(3386),C=s(32163),k=s(50506),T=s(74136),I=s(72495),P=s(85893);function Z(){window.__c={n:"IntegrationGalleryModal"};const e=(0,o.VK)((()=>y.d.state.open),[]),t=(0,i.Fy)(),s=(0,a.yK)((e=>({modal:{width:t.isMobile?"auto":"90vw",height:t.isMobile?"auto":"90vh",borderRadius:8}})),[t.isMobile]);return(0,P.jsx)(k.Z,{open:e,innerStyle:s.modal,onDismiss:()=>{y.d.setState({open:!1})},render:()=>(0,P.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,P.jsx)(A,{}),(0,P.jsx)(F,{})]})})}function F(){window.__c={n:"GalleryModalDetail"};const e=(0,i.O7)(),t=(0,a.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor,padding:20},text:{color:e.darkTextColor}})),[]),s=(0,o.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return null==e?void 0:e.id}),[]),n=(0,o.VK)((()=>{if(y.d.state.open)return y.d.state.selectedIntegration}),[]),r=(0,o.VK)((()=>n?x.Z.externalAuthentications.state.filter((e=>e.integration_id===n.id)):[]),[n]);if(!n||!s)return null;const l=n.info.icon,d=n.name,c=n.info.developer_name,m=n.info.description,b=[];(0,u.mo)(n)&&b.push("linkPreview"),(0,u.zc)(n)&&b.push("databaseSync");const M=n.info.screenshots,j=M?(0,P.jsx)(_,{imageUrls:M},n.id):null;return(0,P.jsx)(P.Fragment,{children:(0,P.jsxs)("div",{style:t.container,children:[j,(0,P.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingBottom:20},children:[(0,P.jsxs)("div",{style:{display:"flex"},children:[(0,P.jsx)("img",{src:l,style:{width:50,marginRight:10}}),(0,P.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,P.jsx)("span",{children:(0,P.jsx)("b",{style:{fontSize:18},children:d})}),(0,P.jsx)("span",{style:t.text,children:(0,P.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.madeBy.name",defaultMessage:"By {name}",values:{name:c}})})]})]}),(0,P.jsx)(v.Z,{style:{width:120},onClick:()=>(async t=>{await g.hM({environment:e,integration:t,spaceId:s,from:"integration_gallery"}),h.pJ({environment:e})})(n),children:r.length>0?(0,P.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.button.installAnother",defaultMessage:"Install another"}):(0,P.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.button.install",defaultMessage:"Install"})})]}),(0,P.jsx)("span",{style:{...t.text,fontSize:14},children:m}),(0,P.jsx)("div",{style:{display:"flex",marginTop:10},children:b.map(((e,t)=>e&&(0,P.jsx)(T.Z,{desktopStyle:{marginLeft:4},innerStyle:{fontSize:12},children:S.a_[e]},t)))})]})})}function _(e){window.__c={n:"ImageCarousel"};const{imageUrls:t}=e,[s,i]=(0,n.useState)(0),o=(0,a.yK)((e=>({heroImg:{width:"100%",objectFit:"contain",objectPosition:"top",paddingBottom:30},arrows:{fill:"#000"}})),[]),r=e=>{let n="right"===e?s+1:s-1;n<0&&(n=t.length-1),n>t.length-1&&(n=0),i(n)},c=t.length>0;return(0,P.jsxs)("div",{style:{width:"100%",position:"relative"},children:[c&&(0,P.jsx)(M.Z,{style:{position:"absolute",top:"50%",left:10},iconStyle:o.arrows,icon:l.f,onClick:()=>r("left")}),(0,P.jsx)("img",{style:o.heroImg,src:t[s]}),c&&(0,P.jsx)(M.Z,{style:{position:"absolute",top:"50%",right:10},iconStyle:o.arrows,icon:d.o,onClick:()=>r("right")})]})}function A(){window.__c={n:"GalleryModalSidebar"};const e=(0,p.useIntl)(),t=(0,a.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500}})),[]),[s,i]=(0,n.useState)(""),l=(0,o.VK)((()=>x.Z.integrations.state),[]),d=(0,o.VK)((()=>m.vM(x.Z.externalAuthentications.state,(e=>e.integration_id))),[]),u=(0,o.VK)((()=>{if(y.d.state.open)return y.d.state.selectedIntegration}),[]),g=(0,r.ZP)(s,l,(e=>e.name)),h=g.filter((e=>{var t;return null===(t=d[e.id])||void 0===t?void 0:t.length})),f=g.filter((e=>{var t;return!(null!==(t=d[e.id])&&void 0!==t&&t.length)})),S=[{key:"installed",render:e=>(0,P.jsx)(I.Z,{...e,title:"Installed"}),items:h.map((e=>({key:e.id,action:()=>{y.d.state.open&&y.d.setState({...y.d.state,selectedIntegration:e})},render:s=>(0,P.jsx)(b.Z,{...s,title:e.name,icon:(0,P.jsx)("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==u?void 0:u.id)?t.selectedItem:void 0}})})))},{key:"not_installed",render:e=>(0,P.jsx)(I.Z,{...e,title:"Not Installed"}),items:f.map((e=>({key:e.id,action:()=>{y.d.state.open&&y.d.setState({...y.d.state,selectedIntegration:e})},render:s=>(0,P.jsx)(b.Z,{...s,title:e.name,icon:(0,P.jsx)("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==u?void 0:u.id)?t.selectedItem:void 0}})})))}];return(0,P.jsxs)("div",{style:t.sidebar,children:[(0,P.jsx)("div",{style:t.header,children:(0,P.jsx)(w.Z,{capture:!0,onBackspace:m.yR,onLeft:m.yR,onRight:m.yR,onSelectAll:m.yR,onRedo:m.yR,onUndo:m.yR,onCut:m.yR,onCopy:m.yR,onPaste:m.yR,onKeypress:m.yR,onDelete:m.yR,onTab:m.yR,children:(0,P.jsx)(j.Z,{placeholder:e.formatMessage({id:"integrationGallery.sidebar.searchbar.placeholder",defaultMessage:"Search integrations"}),left:(0,c.R)(t.searchIcon),showClearButton:!0,format:j.B.Small,value:s,style:t.searchBar,onChange:e=>{i(e.target.value)}})})}),(0,P.jsx)(C.Z,{type:C.i.Vertical,initialFocus:0,sections:S})]})}},74661:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(66673),l=s(88145),d=s(64275),c=s(99405),u=s(89101),m=s(82990),p=s(9291),g=s(50906),h=s(54642),f=s(8055),x=s(21969),y=s(4023),S=s(45946),v=s(42922),b=s(60458),M=s(73063),j=s(16354),w=s(53437),C=s(62385),k=s(64369),T=s(85893);function I(){window.__c={n:"OpenInDesktopAppPopup"};const e=(0,i.O7)(),t=(0,p.useIntl)(),[s,I]=(0,n.useState)(!0),{isDesktopBrowser:P,os:Z}=(0,i.Fy)(),F=(0,o.VK)((()=>e.RouterStore.state.route.name in c.c$),[e]),_=e.currentUser.isLoggedIn(),A=(0,o.VK)((()=>S.Z.state),[]),[R,D]=(0,n.useState)(!1),B=(0,o.VK)((()=>S.Z.canPersistToLocalStorage()),[]),L=!R&&_&&void 0===A&&P&&("mac"===Z||"windows"===Z)&&F&&B,[O,E]=(0,n.useState)(!1),N=L&&O,V=(0,n.useRef)(!1);(0,n.useEffect)((()=>{L&&!V.current&&(async function(e,t){const s=await h.getDesktopAppRegistration(e,{os:t});return"data"in s&&s.data.isRegistered}(e,Z).then((e=>{E(e)})),V.current=!0)}),[L,E,e,Z]);const U=(0,r.D9)(N);(0,n.useEffect)((()=>{N&&!U&&g.wWx(e)}),[N,U,e]);const W=(0,a.yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",width:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:m.Z.fontWeight.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34}})),[]);return(0,T.jsx)(w.ZP,{popupType:w.kQ.Popup,placementToOrigin:y.u.Bottom,origin:(0,T.jsx)("div",{style:W.origin}),disableMouseCapture:!0,open:N,style:W.container,render:()=>(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{style:W.header,children:[(0,T.jsx)(k.Z,{style:W.headerText,children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,T.jsx)(M.Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:d.D,onClick:()=>{S.Z.setState("never"),D(!0),g.ZyU(e)}})]}),(0,T.jsx)(j.Z,{href:u.AR.desktop,external:!0,onClick:()=>{g.iDe(e)},children:(0,T.jsxs)(C.Z,{style:W.appDownloadButton,children:[(0,l.E)(W.appDownloadIcon),(0,T.jsx)("span",{children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,T.jsxs)("div",{style:W.actions,children:[(0,T.jsxs)("div",{style:W.alwaysOpenLinks,children:[(0,T.jsx)(b.Z,{checked:s,size:16,onClick:()=>{I(!s)}}),(0,T.jsx)(k.Z,{isInline:!0,style:W.alwaysOpenLinksLabel,children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,T.jsx)("strong",{children:e})}})})]}),(0,T.jsx)(v.Z,{style:W.alwaysOpenLinksButton,onClick:()=>{S.Z.setState(s?"always":"never"),D(!0),f.RX({url:(0,x.W)(window.location.href),environment:e}),g.LC7(e,{always_open_in_app:s})},children:(0,T.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,T.jsx)("strong",{children:e})}})})]})]})})}},73085:(e,t,s)=>{s.r(t),s.d(t,{default:()=>J});s(67294);var n=s(83355),i=s(9291),o=s(54564),a=s(47307),r=s(86282),l=s(82530),d=s(80444),c=s(56638),u=s(88923),m=s(26263),p=s(49085);class g extends p.default{getInitialState(){return{inMemoryRecordCache:new m.Z({name:"TemplateRecordCacheStore"})}}}var h=s(68785),f=s(40721),x=s(53437),y=s(45953),S=s(99405),v=s(21202),b=s(77420),M=s(23867),j=s(19889),w=s(70203),C=s(54642),k=s(61045),T=s(95477),I=s(66213),P=s(23586),Z=s(28020),F=s(88632),_=s(77080),A=s(4548);class R extends p.default{getInitialState(){return{}}}const D=R;var B=s(82136),L=s(26136),O=s(88893),E=s(88280),N=s(53336),V=s(64369),U=s(81059),W=s(31192),K=s(55095),z=s(34541),q=s(85893);class G extends n.Z{constructor(){super(...arguments),this.storeTypes={store:D,templateRecordCacheStore:g},this.renderResult=(e,t)=>{const{navigatedRootId:s}=this.stores.store.state;if(t){let e;return e=s?L.G.createChildStore(t,{table:v.iU,id:s}):t,(0,q.jsx)("div",{style:this.props.style,children:(0,q.jsx)(z.Z,{store:e,isDefaultContainer:!0,droppable:!0,render:s=>{let{selectableEvents:n,selectableHoverMenuOverlay:i}=s;return(0,q.jsxs)(N.Z,{style:Q(this.environment),type:(0,Z.Zy)({environment:this.environment,store:t}),store:A.Z,preventType:k.Q7(this.environment),...n,children:[i,_.default.checkGate("page_view_block_refactor")?(0,q.jsx)(W.ZP,{store:e,loadingContainerStore:void 0,context:B.S.InAppTemplatePreview,paddingBottom:W.ZP.paddingBottom(this.environment),paddingLeft:(0,Z.ui)(this.environment),paddingRight:(0,Z.ui)(this.environment),pageCoverHeight:W.ZP.defaultPageCoverHeight(this.environment),disabled:this.props.disabled}):(0,q.jsx)(K.Z,{store:e,loadingContainerStore:void 0,context:B.S.InAppTemplatePreview,paddingBottom:W.ZP.paddingBottom(this.environment),paddingLeft:(0,Z.ui)(this.environment),paddingRight:(0,Z.ui)(this.environment),pageCoverHeight:W.ZP.defaultPageCoverHeight(this.environment),disabled:this.props.disabled})]},e.id)}},e.id)})}return(0,q.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...this.props.style},children:(0,q.jsx)(h.Z,{style:{width:U.T,height:U.T}})})},this.handleOverrideLinkClick=e=>{const{device:t}=this.environment,s=(0,S.Wj)({url:e,isMobile:t.isMobile,baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName,protocol:T.default.protocol,currentUrl:window.location.href});"page"===s.name&&(s.peekViewBlockId?this.stores.store.setState({...this.stores.store.state,navigatedRootId:s.peekViewBlockId}):this.stores.store.setState({...this.stores.store.state,navigatedRootId:s.blockId}))},this.performRequest=async e=>{const t=await C.loadBlockSubtree(this.environment,{block:{id:e,spaceId:(0,M.C)(void 0)},shallow:!1});if("failed"===t.type)throw t.error;const{currentSpaceStore:s}=d.default.state,n=E.subscriptionDataStoreInstance.state,{inMemoryRecordCache:i}=this.stores.templateRecordCacheStore.state;i.clearCache(),i.isTemplatePreview=!0;const o=new Set,a=new Set,r=y.PF.create(t.data.subtreeRecordMap);for(const d of r){const{pointer:e,model:t,role:s}=d;if(!s)return;if(i.setModelAndRole({pointer:e,userId:this.environment.currentUser.id},t,"editor"),(null==t?void 0:t.table)===v.iU){const e=t.getProperties();for(const t of Object.keys(e)){const s=(0,w.lcG)(e[t]);for(const e of s)o.add(e);const n=(0,w.zyy)(e[t]);for(const e of n)a.add(e)}t.created_by_table&&t.created_by_id&&(t.created_by_table===j.KJ?o.add(t.created_by_id):a.add(t.created_by_id)),t.last_edited_by_table&&t.last_edited_by_id&&(t.last_edited_by_table===j.KJ?o.add(t.last_edited_by_id):a.add(t.last_edited_by_id))}}if(n)for(const d of(0,O.CM)(n))o.add(d.userId);const l=await Promise.all(Array.from(o).map((async e=>{if(s){const t=L.U6.createChildStore(s,{table:j.KJ,id:e});await t.load();return t.getValue()}{const t=await C.syncRecordValue(this.environment,{pointer:{table:j.KJ,id:e},userId:this.environment.currentUser.id,version:-1});return t&&t.value}})));for(const d of l)d&&i.setRecord({pointer:{table:j.KJ,id:d.id},userId:this.environment.currentUser.id},{role:"reader",value:d});const c=await Promise.all(Array.from(a).map((async e=>{if(s){const t=(0,L.Kv)(s,{table:b.cZ,id:e,spaceId:s.id});await t.load();return t.getValue()}{const t=await C.syncRecordValue(this.environment,{pointer:{table:b.cZ,id:e},userId:this.environment.currentUser.id,version:-1});return t&&t.value}})));for(const d of c)d&&i.setRecord({pointer:{table:b.cZ,id:d.id,spaceId:d.space_id},userId:this.environment.currentUser.id},{role:"reader",value:d});const{currentUserStore:u}=d.default.state;u&&(await u.load(),i.setRecord({pointer:u.pointer,userId:this.environment.currentUser.id},{role:"editor",value:u.getValue()}));return new L.G(this.environment,{table:v.iU,id:e},{inMemoryRecordCache:i})}}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){return F.Z.state.online?(0,q.jsx)(I.LF,{value:this.handleOverrideLinkClick,children:(0,q.jsx)(P.Z,{request:this.props.previewRootId,performRequest:this.performRequest,render:this.renderResult})}):(0,q.jsx)(I.LF,{value:this.handleOverrideLinkClick,children:(0,q.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",...this.props.style},children:(0,q.jsx)(V.Z,{isSmall:!0,children:(0,q.jsx)(i.FormattedMessage,{defaultMessage:"Please go online to view this template.",id:"pageTemplatePreview.offline.message"})})})})}}G.displayName="PageTemplatePreview",G.contextTypes=n.w,G.childContextTypes={...I.wK,...n.w};const H=G;function Q(e){const{device:t}=e;return{flex:1,...t.isSafari&&{zIndex:1}}}const Y={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"};class $ extends n.Z{constructor(){super(...arguments),this.storeTypes={templateRecordCacheStore:g},this.renderMobilePopup=()=>{const e=c.Z.state;if(e.open)return(0,q.jsx)(f.default,{title:(0,q.jsx)(i.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:(0,q.jsx)(f.CancelMenuText,{}),onClickLeft:this.handleDismiss,right:e.isLoading?(0,q.jsx)(h.Z,{}):(0,q.jsx)(i.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label"}),onClickRight:this.handleUseTemplateClick,forceFullScreenSlideUp:!0,children:this.renderPreview(e)})},this.handleDismiss=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await X()?this.accept(!0):ee(this.environment)}else ee(this.environment)},this.handleUseTemplateClick=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await X()?this.accept(!0):this.accept(!1)}else this.accept(!1)}}UNSAFE_willMountOrUpdate(){const e=c.Z.state,{currentSpaceViewStore:t}=d.default.state;e.open&&t&&l.createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:this.environment,perform:s=>{r.GF({item:e.item,spaceViewStore:t,transaction:s})}})}renderComponent(){const{device:e}=this.environment,t=c.Z.state;if(e.isMobile)return(0,q.jsx)(x.GI,{open:t.open,render:this.renderMobilePopup,forceFullScreenSlideUp:!0,onDismiss:this.handleDismiss,popupType:x.GI.PopupType.SlideUp})}renderPreview(e){return(0,q.jsx)(H,{previewRootId:e.item.previewRootId,style:Y,templateRecordCacheStore:this.stores.templateRecordCacheStore,disabled:!0},e.item.previewRootId)}accept(e){const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state,s=c.Z.state,{currentSpaceViewStore:n,currentSpaceStore:i,mainEditorCurrentBlockStore:o}=d.default.state;if(s.open&&n&&i){const a=o&&o.isEmptyPage()?o:void 0,l=u.default.state.open&&u.default.state.target&&u.default.state.target.isEmptyPage()?u.default.state.target:void 0;r.RL({environment:this.environment,item:s.item,spaceStore:i,spaceViewStore:n,useRecordCache:e?t:void 0,initializeStore:s.createNewPage?void 0:a||l,isPrivate:s.isPrivate,from:s.createNewPage?"sidebar":"newPage"})}}}$.displayName="PageTemplateModal";const J=(0,i.injectIntl)($);function X(){return new Promise(((e,t)=>{a.showDialog({message:(0,q.jsx)(i.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,q.jsx)(i.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,q.jsx)(i.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}function ee(e){r.xv(e),o.LZ()}},57806:(e,t,s)=>{s.r(t),s.d(t,{PermissionsInviteBase:()=>A,default:()=>R});s(67294);var n=s(83355),i=s(8848),o=s(72126),a=s(94044),r=s(9291),l=s(91219),d=s(95209),c=s(43250),u=s(87279),m=s(45101),p=s(65598),g=s(18514),h=s(38755),f=s(95697),x=s(18245),y=s(85834),S=s(1903),v=s(29677),b=s(26136),M=s(34583),j=s(35057),w=s(78140),C=s(40721),k=s(72495),T=s(83182),I=s(7567),P=s(44385),Z=s(24145),F=s(43579),_=s(85893);class A extends n.Z{constructor(){super(...arguments),this.renderInShareMenu=this.createComputedStore((()=>Boolean(this.props.renderInShareMenu&&!this.environment.device.isMobile))),this.inviteOrigin=this.createComputedStore((()=>this.props.store instanceof b.G?this.renderInShareMenu.state?"page_share_modal":"page_permission_modal":"space_share_modal")),this.defaultRoleForSpaceBot=this.createComputedStore((()=>"editor")),this.defaultRoleForNonBot=this.createComputedStore((()=>{const{store:e,isSubscribed:t}=this.props;return m.xT({environment:this.environment,store:e,isSubscribed:t})})),this.inputDebounce=void 0,this.storeTypes={permissionsInviteStore:S.Z,contextualInviteStore:y.ZP},this.handleModalDismiss=async()=>{await d.kL({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,from:"share_menu"})},this.handleInputChange=async e=>{var t;null===(t=this.inputDebounce)||void 0===t||t.cancel(),this.inputDebounce=o.Ds((()=>{l.UW(this.environment,{invite_flow_id:this.stores.permissionsInviteStore.state.flowId,subscription_tier:(0,j.zt)(),invite_origin:this.inviteOrigin.state})}),1e3),this.inputDebounce(),await d.jC({environment:this.environment,event:e,permissionsInviteStore:this.stores.permissionsInviteStore})},this.handleClickRemoveToken=e=>{d.PV({targetToRemove:e,permissionsInviteStore:this.stores.permissionsInviteStore,defaultRoleForNonBot:this.defaultRoleForNonBot.state})}}async UNSAFE_willMount(){await M.bi(this.environment)}willUnmount(){var e;null===(e=this.inputDebounce)||void 0===e||e.flush()}renderComponent(){if(this.renderInShareMenu.state)return this.renderComponentInShareMenu();const e=this.renderHeader(),t=this.renderSearchRequest();return this.renderComponentOriginal(e,t)}renderHeader(){const{permissionsInviteStore:e}=this.stores,{device:t}=this.environment;return(0,_.jsx)(Z.Z,{permissionsInviteStore:e,store:this.props.store,handleClickRemoveToken:e=>{this.handleClickRemoveToken(e)},handleInputChange:async e=>{await this.handleInputChange(e)},handleInputSubmit:async()=>{await this.handleInviteInputSubmit()},origin:Boolean(this.renderInShareMenu.state)?"share_menu":"share_modal",defaultRoleForNonBot:this.defaultRoleForNonBot.state,isTeamsEnabled:(0,f.bq)(),right:!t.isMobile&&this.renderDesktopInputRightInner(),focus:"invitee"===e.state.inputFocus||"invitee-popup-closed"===e.state.inputFocus,handleFocus:()=>{t.isMobile||e.setState({...e.state,inputFocus:"invitee"})}})}renderSearchRequest(){const{permissionsInviteStore:e}=this.stores,t=(0,p.OY)(this.props.store),s=(0,p.OY)(this.props.store),n=this.props.store instanceof b.G&&(0,h.Q6)(this.props.store.getSpaceStore());return(0,_.jsx)(F.Z,{permissionsInviteStore:e,store:this.props.store,defaultRoleForSpaceBot:this.defaultRoleForSpaceBot.state,shouldShowBots:t,shouldShowGroups:s,sectionRenderLimit:this.renderInShareMenu.state?5:10,membersOnly:this.props.membersOnly,guestsMustBeRequested:n})}renderComponentOriginal(e,t){const{device:s}=this.environment;let n;return n=s.isMobile?{menuType:u.og.Modal,title:(0,p.Mm)(this.props.store)?(0,_.jsx)(r.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,_.jsx)(r.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,_.jsx)("div",{style:{color:i.ZP.blue},children:(0,_.jsx)(r.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,_.jsx)(C.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:async()=>{await this.handleInviteClick()},header:e}:{menuType:u.og.Popup,width:480,height:"60vh",header:e,tokenInputHeader:!0,footer:this.renderHelpButton(),disableScroller:!1},(0,_.jsxs)(w.Z,{...n,className:c.FJA,children:[s.isMobile&&(0,_.jsx)(k.Z,{title:(0,_.jsx)(r.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:this.renderDesktopInputRightInnerSelect()}),(0,_.jsx)("div",{children:t}),s.isMobile&&this.renderHelpButton()]})}renderHelpButton(){return this.renderInShareMenu.state?null:(0,_.jsx)(k.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,_.jsx)(T.Z,{title:(0,_.jsx)(r.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,g.UY)("guides.invitePerson"),analyticsFrom:"invite_person"})})}renderDesktopInputRightInner(){return(0,_.jsxs)("div",{style:{marginLeft:a.p_,display:"flex",alignItems:"center"},children:[this.renderDesktopInputRightInnerSelect(),!this.renderInShareMenu.state&&this.renderDesktopInputRightInnerButton({isLarge:!0})]})}renderDesktopInputRightInnerButton(e){const{isLarge:t}=e;return(0,_.jsx)(P.Z,{store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,handleUpgradeClick:()=>{return e=this.props.upgradeButtonName,t=this.environment,s=this.props.onUpgradeButtonClick,void d.Vu({environment:t,upgradeButtonName:e,onUpgradeButtonClick:s});var e,t,s},handleInviteClick:()=>this.handleInviteClick(),disabled:this.props.disabled,isLarge:t})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{store:t}=this.props,{permissionsInviteStore:s}=this.stores;if(s.state.isInviteTargetsEmpty||!(0,v.ow)(s.state))return(0,_.jsx)(I.ZP,{disabled:(0,p.Mm)(t)&&!t.canAdmin(),role:s.state.inviteRole,table:s.state.table,type:"user_permission",blockType:(0,p.OY)(t)?t.getType():void 0,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",height:26,color:i.ZP.uiGray,...this.renderInShareMenu.state&&{marginTop:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginBottom:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginRight:0}},isMenuItem:e.isMobile,onChange:e=>{d.XC({environment:this.environment,newRole:e,permissionsInviteStore:this.stores.permissionsInviteStore})}})}renderComponentInShareMenu(){const e={menuType:u.og.Popup,header:(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"top",marginLeft:12,marginRight:12,gap:10},children:[this.renderHeader(),this.renderDesktopInputRightInnerButton({isLarge:!0})]}),footer:this.renderHelpButton(),disableScroller:!1};return(0,_.jsx)("div",{style:{paddingTop:14,paddingBottom:14,paddingLeft:2,paddingRight:2},children:(0,_.jsx)(w.Z,{...e,children:this.renderSearchRequest()})})}async handleInviteInputSubmit(){await this.handleInviteClick()}async handleInviteClick(){const e=x.default.mark("share_menu.invite_user_lag");await d.qg({environment:this.environment,store:this.props.store,sudoModeStore:this.props.sudoModeStore,permissionsInviteStore:this.stores.permissionsInviteStore,contextualInviteStore:this.stores.contextualInviteStore,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,inviteOrigin:this.inviteOrigin.state,intl:this.props.intl}),x.default.measure(e,{environment:this.environment})}}A.displayName="PermissionsInviteBase";const R=(0,r.injectIntl)(A)},44385:(e,t,s)=>{s.d(t,{Z:()=>y,e:()=>x});s(67294);var n=s(480),i=s(86628),o=s(94044),a=s(47425),r=s(9291),l=s(67669),d=s(45101),c=s(65598),u=s(26781),m=s(4023),p=s(35057),g=s(42922),h=s(26388),f=s(85893);function x(){window.__c={n:"GuestLimitTooltip"};const e=(0,i.VK)((()=>(0,a.tP)((0,p.zt)())),[]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{children:(0,f.jsx)(r.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {guestLimit} unique guests.",values:{guestLimit:e}})}),(0,f.jsx)("div",{children:(0,f.jsx)(r.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited."})})]})}const y=function(e){window.__c={n:"PermissionsInviteButton"};const{store:t,permissionsInviteStore:s,handleUpgradeClick:a,handleInviteClick:p,isLarge:y}=e,S=(0,n.O7)(),[v]=(0,i.AF)(s),b=(0,i.VK)((()=>v.inviteTargets.some((e=>d.OA(e)))),[v]),M=(0,u.S)(t),j=(0,i.VK)((()=>{const e=v.inviteTargets,s=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),n=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return!(0,c.Mm)(t)&&l.dA(S,[...s,...n])}),[S,v,t]),w=b?M:void 0;return(0,f.jsx)(h.ZP,{alignment:m.v.Center,disableTooltip:!(j||w),renderTooltip:()=>j?(0,f.jsx)(x,{}):w,render:e=>(0,f.jsx)(g.Z,{isLarge:y,style:{minWidth:o.UF},disabled:Boolean(w),onClick:j?a:p,...e,children:j?(0,f.jsx)(r.FormattedMessage,{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}):(0,f.jsx)(r.FormattedMessage,{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"})})})}},13904:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var n=s(67294),i=s(83355),o=s(41892),a=s(9291),r=s(91536),l=s(45101),d=s(65598),c=s(1903),u=s(34583),m=s(44041),p=s(35057),g=s(88280),h=s(42922),f=s(31945),x=s(9019),y=s(53437),S=s(26388),v=s(57806),b=s(95691),M=s(86628),j=s(24405),w=s(84169),C=s(87279),k=s(18514),T=s(77907),I=s(29798),P=s(51077),Z=s(16354),F=s(78140),_=s(32163),A=s(89728),R=s(72495),D=s(85893);function B(e){window.__c={n:"InviteDropdownMenu"};const{onInviteClick:t,onInviteComplete:s}=e,i=(0,M.qz)(void 0,I.Z),r=(0,j.yK)((e=>({InviteDropdownMenu:{background:e.cardContentBackground,width:265,borderRadius:8},slackTitle:{display:"flex",fontSize:14,color:e.text.primary},integrationIcon:{marginRight:8},slackButtonContainer:{padding:"0 6px",alignItems:"center"},slackButton:{height:28,borderRadius:4,border:void 0,width:"100%"},helpIcon:{width:16,height:16,fill:e.icon.secondary},helpSection:{color:e.text.secondary,fontSize:12,padding:"0 8px",width:"100%"}})),[]),l=(0,n.useMemo)((()=>(0,D.jsxs)("div",{style:r.slackTitle,children:[(0,D.jsx)(P.Z,{type:"image_url",imageURL:o.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:r.integrationIcon}),(0,D.jsx)(a.FormattedMessage,{defaultMessage:"Slack",id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.slackButtonLabel"})]})),[r]),d={key:"all_import_sections",render:e=>(0,D.jsx)(R.Z,{...e,title:(0,D.jsx)(a.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.title",defaultMessage:"Import from"})}),items:[{key:"slack_imports",render:e=>(0,D.jsx)(T.LazySlackImportsInviteWithModal,{inviteOrigin:"space_setting_slack_dropdown",canEditPermission:!0,onInviteClick:t,onInviteComplete:s,slackButtonLabel:l,slackButtonStyle:r.slackButton,slackButtonContainerStyle:r.slackButtonContainer}),action:()=>{}}]},c={key:"help_section",render:e=>(0,D.jsx)(R.Z,{...e,topBorder:!0}),items:[{key:"help_section",render:e=>u,action:()=>{}}]},u=(0,D.jsx)(Z.Z,{style:{display:"flex",padding:"0 4px"},className:"notion-print-ignore",href:(0,k.UY)("guides.publicAPI"),external:!0,children:(0,D.jsx)(A.Z,{icon:w.m,iconStyle:r.helpIcon,style:r.helpSection,children:(0,D.jsx)(a.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.inviteDropdownMenu.learnMore",defaultMessage:"Learn more"})})});return(0,D.jsx)(F.Z,{menuType:C.og.Popup,children:(0,D.jsx)(_.Z,{type:_.i.Vertical,store:i,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,sections:[d,c],style:r.InviteDropdownMenu})})}var L=s(60442);class O extends i.Z{constructor(){super(...arguments),this.storeTypes={permissionsInviteStore:c.Z},this.renderInviteButton=(e,t,s)=>this.props.enableInviteDropdown?(0,D.jsx)(f.ZP,{popupType:y.kQ.Popup,alignmentToOrigin:f.vR.End,placementToOrigin:f.pO.Bottom,render:e=>(0,D.jsx)(B,{onInviteClick:this.props.onInviteClick}),originGap:12,renderOrigin:n=>(0,D.jsx)(b.Z,{onClick:t?()=>N(this.props.upgradeButtonName,this.environment,this.props.onUpgradeButtonClick):this.handleButtonClick,disabled:!s&&!t,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle},title:(0,D.jsx)(a.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"}),dropdownEvents:n,color:"blue",...e})}):(0,D.jsx)(h.Z,{isLarge:!0,onClick:t?()=>N(this.props.upgradeButtonName,this.environment,this.props.onUpgradeButtonClick):this.handleButtonClick,disabled:!s&&!t,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle},...e,children:(0,D.jsx)(a.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})}),this.renderOverlay=()=>(0,D.jsx)(v.default,{...this.props,permissionsInviteStore:this.stores.permissionsInviteStore}),this.handleButtonClick=()=>{(0,l.z5)({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,store:this.props.store,renderInShareModal:!1,isSubscribed:this.props.isSubscribed}),r.L7(this.environment,{type:"invite"})},this.handleModalDismiss=async()=>{const{permissionsInviteStore:e}=this.stores;await(0,l.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:(0,d.Mm)(this.props.store)?"space_share_modal":"page_share_modal"})||e.reset()}}async UNSAFE_willMount(){await u.bi(this.environment)}renderComponent(){const{store:e}=this.props,{modalOpen:t}=this.stores.permissionsInviteStore.state;let s,n,i=!1;return e.canEditMembership()?e.canEditMembership()&&(0,d.Mm)(e)&&g.subscriptionDataStoreInstance.state&&!p.Mk()?(s=!1,i=!0,n=(0,D.jsx)(L.Z,{imageURL:o.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,D.jsx)(a.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,D.jsx)(a.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):s=!0:(s=!1,n=(0,d.Mm)(e)?(0,D.jsx)(a.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):(0,D.jsx)(a.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),(0,D.jsx)("div",{children:(0,d.Mm)(e)?(0,D.jsx)(x.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:(0,D.jsx)(S.ZP,{renderTooltip:()=>n,disableTooltip:s,render:e=>this.renderInviteButton(e,i,s)})}):(0,D.jsx)(x.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:null})})}}O.displayName="PermissionsInviteWithModal";const E=(0,a.injectIntl)(O);function N(e,t,s){m.y(t,{from:e,for:"plus"}),s&&s(),r.L7(t,{type:"upgrade"})}},35229:(e,t,s)=>{s.d(t,{Z:()=>q});s(57658);var n=s(67294),i=s(83355),o=s(49085),a=s(66897),r=s(72126),l=s(19889),d=s(70203),c=s(97880),u=s(9291),m=s(23586),p=s(87279),g=s(77907),h=s(480),f=s(86628),x=s(24405),y=s(33728),S=s(47612),v=s(10020),b=s(81918),M=s(49068),j=s(52275),w=s(31945),C=s(96525),k=s(43765),T=s(72495),I=s(80444),P=s(77080),Z=s(55899),F=s(35057),_=s(22508),A=s(13394),R=s(7314),D=s(85893);function B(e){window.__c={n:"PersonPropertyInviteMenuItem"};const t=(0,f.qz)(void 0,Z.ZP),s=(0,f.qz)(void 0,A.Z),{store:i,inputValue:o,intl:a,propertySchemaLimit:r,isLoading:d,handlePersonPropertyMenuChange:c}=e,m=(0,h.O7)(),p=(0,x.yK)((e=>({moreBarTitleStyle:{color:e.text.secondary,fontSize:11},inviteIconStyle:{width:20,height:20,fill:e.icon.primary},rightIconStyle:{width:20,height:20,fill:e.icon.secondary},desktopTitleStyle:{color:e.text.secondary,fontSize:11},messageBodyStyle:{color:e.text.tertiary,paddingLeft:2},messageTitleStyle:{color:e.text.tertiary},inviteBodyStyle:{color:e.text.primary}})),[]),{isMobile:g}=(0,h.Fy)(),B=(0,f.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),L=(0,f.VK)((()=>s.state.flowId),[s]),{email:O,isEmail:E,inviteButtonTitle:N}=(0,n.useMemo)((()=>{const e=(0,y.H3)(o),t=(0,y.oH)(e),s=a.formatMessage({id:"invite.person_property.button.invite_people",defaultMessage:"Invite people"}),n=a.formatMessage({id:"invite.person_property.button.invite_email",defaultMessage:"Invite ”{email}”"},{email:e});return{email:e,isEmail:t,inviteButtonTitle:t?n:s}}),[o,a]),V=(0,n.useCallback)((()=>{E&&O&&_.Co({email:O,inviteTargetsStore:t}),b.P0(m,{origin:"person_property_invite",invite_flow_id:L})}),[E,L,O,m,t]),U=(0,n.useCallback)((()=>{b.Zv(m,{origin:"person_property_invite",invite_flow_id:L})}),[L,m]);return(0,f.VK)((()=>{const e=function(e){const{canAddPermissions:t,isMobile:s}=e,n="enterprise"===e.subscriptionTier;if(s||n||!t)return!1;return"on"===P.default.getEligibleGroup({experimentId:"acq_person_property_invite_v1",defaultGroup:"control"})}({canAddPermissions:i.canEditMembership(),isMobile:g,subscriptionTier:(0,F.zt)()});return e&&b.x8(m,{origin:"person_property_invite",invite_flow_id:L}),e}),[i,L,g,m])?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(T.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"People",id:"database.personPropertyValue.selectPerson.noSearchResults.resultsTitle"}),desktopTitleStyle:p.desktopTitleStyle,loading:d,desktopStyle:{paddingBottom:4},children:(0,D.jsx)(k.Z,{title:(0,D.jsx)("span",{style:p.messageBodyStyle,children:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"No matches in {spaceName}",id:"database.personPropertyMenu.noSearchResults.messageWithSpaceName",values:{spaceName:B}})}),titleStyle:p.messageTitleStyle})}),(0,D.jsx)(T.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"More",id:"database.personPropertyValue.selectPerson.noSearchResults.suggestionTitle"}),desktopTitleStyle:p.moreBarTitleStyle,topBorder:!0,desktopStyle:{marginTop:0,paddingTop:10},children:(0,D.jsx)(C.Z,{focused:!1,stopClickPropagation:!0,popupType:w.Z4.Popup,renderOrigin:e=>(0,D.jsx)(j.Z,{...e,focused:!1,icon:(0,S.C)(p.inviteIconStyle),title:N,right:(0,v.C)(p.rightIconStyle),textWrapperStyle:p.inviteBodyStyle}),onClick:V,onClose:U,borderRadius:8,render:e=>(0,D.jsx)(R.Z,{inviteOrigin:"person_property_invite",store:i,handleBackButtonClick:()=>e.close(),inviteTargetsStore:t,personPropertyInviteStore:s,onInviteCompleteFn:t=>{e.close();const s=(t.success?Object.values(t.invitedUsers):[]).map((e=>({table:l.KJ,id:e})));c(s)}})})})]}):(0,D.jsx)(T.Z,{title:(0,M.$)(r),loading:d,children:(0,D.jsx)(k.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})})})}var L=s(69582),O=s(78140),E=s(32163),N=s(40721),V=s(92864),U=s(47082),W=s(97680);const K=(0,u.defineMessages)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"}});class z extends i.Z{constructor(){super(...arguments),this.inputValue=o.default.createValue(""),this.handlePersonPropertyMenuChange=e=>{const{schema:t,property:s}=this.props,n=t[s];if(!n||"person"!==n.type)return;let i;i=1===n.limit?e.length>0?[e[e.length-1]]:[]:e,this.props.onChange({value:i}),this.inputValue.setState("")}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),e.insertChar&&this.inputValue.setState(e.insertChar)}renderComponent(){const{device:e}=this.environment,{disabled:t,intl:s,schema:i,property:o,isTemplatePage:h}=this.props,f=i[o];if(!f||"person"!==f.type)return;const x=[],y=this.props.value.map((s=>{if((0,d.D4X)(s))return x.push(s),(0,D.jsx)(L.w,{templateVariableType:s,showRemoveButton:!t,onRemove:()=>{const e=this.props.value.filter((e=>(0,a.Wk)(e)));this.props.onChange({value:e})},style:{margin:"0px 6px 6px 0px"}},s);if((0,a.Wk)(s)){const n=(0,a.Hl)({pointer:s,getRecordValue:this.props.parentStore.getRecordValue});return(0,D.jsx)(V.ZP,{actor:n,format:e.isMobile?V.ZP.Format.Large:V.ZP.Format.Medium,showRemoveButton:!t,onClickRemove:()=>{const e=this.props.value.filter((e=>(0,d.D4X)(e)||(0,a.Wk)(e)&&e.id!==s.id));this.props.onChange({value:e})},shouldShrink:!0,isSingle:!1},s.id)}(0,c.t1)(s)})),S=d.s8k.filter((e=>!x.includes(e))),v={request:{query:this.inputValue.state,actors:r.hX(this.props.value,a.Wk)},performRequest:async e=>{let{query:t,actors:s}=e;const n=await g.deps.searchActions.loader(),{users:i}=await n.searchSpaceActors({environment:this.environment,query:t,membersOnly:!1});return{users:i.filter((e=>!s.some((t=>t.id===e.id)))).slice(0,20)}},render:(e,t,n)=>{if(e)return(0,D.jsx)(T.Z,{title:(0,M.$)(f.limit),loading:!n,children:(0,D.jsx)(k.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"})})});if(t&&0===t.users.length)return(0,D.jsx)(B,{store:this.props.parentStore,inputValue:this.inputValue.state,intl:s,propertySchemaLimit:f.limit,isLoading:!n,handlePersonPropertyMenuChange:e=>{this.handlePersonPropertyMenuChange([...this.props.value,...e])}});const i=r.oA((t&&t.users||[]).map((e=>({key:e.id,render:t=>(0,D.jsx)(W.Z,{...t,actor:(0,a.dp)(e)}),action:()=>{this.handlePersonPropertyMenuChange([...this.props.value,{table:l.KJ,id:e.id}])}})))),o=r.oA([i.length>0?{key:"person section",render:e=>(0,D.jsx)(T.Z,{...e,title:(0,M.$)(f.limit),loading:!n}),items:i}:void 0]);return(0,D.jsx)(E.Z,{type:E.i.Vertical,initialFocus:this.inputValue.state.length>0?0:void 0,sections:o})}},b=(0,D.jsx)(U.Z,{focus:!e.isMobile||void 0,focusAfterAnimation:!0,format:U.U.Person,tokens:y,placeholder:s.formatMessage(K.searchForPerson),hideInput:t,onRemoveLastToken:()=>{this.props.onChange({value:this.props.value.slice(0,this.props.value.length-1)})},value:this.inputValue.state,onChange:e=>this.inputValue.setState(e.target.value),dontShowBorderBottom:e.isAndroid});let w;return w=e.isMobile?{menuType:p.og.Modal,title:f.name,right:(0,D.jsx)(N.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:b}:{menuType:p.og.Popup,header:b,tokenInputHeader:!0,maxHeight:333},t?(0,D.jsx)(O.Z,{...w}):(0,D.jsxs)(O.Z,{...w,children:[h&&(0,D.jsx)(T.Z,{title:(0,D.jsx)(u.FormattedMessage,{defaultMessage:"Shortcuts",id:"PersonPropertyMenu.menuItem.shortcuts.label"}),children:S.length>0?(0,D.jsx)(n.Fragment,{children:S.map((e=>(0,D.jsx)(j.Z,{focused:!1,title:(0,D.jsx)(L.w,{templateVariableType:e}),caption:(0,d.Z08)(e,s),inline:!0,onClick:()=>{this.handlePersonPropertyMenuChange([...this.props.value,e])}},`relative-person-shortcut-${e}`)))}):(0,D.jsx)(k.Z,{title:(0,D.jsx)(u.FormattedMessage,{id:"database.personPropertyMenu.noShorcuts.message",defaultMessage:"No shortcuts"})})}),(0,D.jsx)(m.Z,{...v})]})}}z.displayName="PersonPropertyMenu";const q=(0,u.injectIntl)(z)},1244:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var n=s(67294),i=s(83355),o=s(480),a=s(86628),r=s(24405),l=s(41892),d=s(8848),c=s(64275),u=s(72126),m=s(89101),p=s(60949),g=s(82990),h=s(9291),f=s(50906),x=s(29974),y=s(97627),S=s(82530),v=s(37181),b=s(36867),M=s(75538),j=s(80444),w=s(4926),C=s(77080),k=s(5188),T=s(49085);class I extends T.default{getInitialState(){return{open:!1,step:"prompt"}}}const P=new I;var Z=s(23063),F=s(42922),_=s(64921),A=s(28451),R=s(3386),D=s(89728),B=s(53437),L=s(42402),O=s(29551),E=s(38294),N=s(85893);class V extends i.Z{constructor(){super(...arguments),this.hasSeenInitial=!1,this.renderMenu=()=>{return(0,N.jsx)(A.P,{calloutId:"persona_collection",children:(0,N.jsxs)("div",{style:(e=this.theme,{background:e.popoverBackground,borderRadius:5,boxShadow:e.mediumBoxShadow,position:"fixed",bottom:65+w.Z.state,right:16+w.Z.state}),children:[(0,N.jsx)(J,{}),(0,N.jsx)(O.gq,{style:{width:320,height:"prompt"===P.state.step||"thanks"===P.state.step?200:450,overflow:"hidden",position:"relative",right:"auto",padding:30,paddingTop:0,cursor:"default",textAlign:"center",justifyContent:"center"},alignItems:"center",alignContent:"center",children:this.renderStep()})]})});var e},this.renderInitial=()=>{const e=this.environment.currentUser.id;if(!P.state.open||!e)return;this.hasSeenInitial||(f.q5U(this.environment,{user_id:e,event:"initial"}),this.hasSeenInitial=!0);const{invalidField:t}=P.state;return(0,N.jsxs)("div",{style:{...q(),padding:8},children:[(0,N.jsx)("img",{style:{width:40,height:32},src:l.Z.images.chatButtonSmallPng}),(0,N.jsx)("div",{style:{fontSize:14,fontWeight:g.Z.fontWeight.semibold,paddingTop:0,paddingBottom:8},children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.header",defaultMessage:"Tell us more about yourself"})}),(0,N.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:270,margin:"0 auto"},children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})}),(0,N.jsx)("div",{style:{...Y(this.theme),marginTop:10},children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.roleLabel",defaultMessage:"What is your role?"})}),(0,N.jsx)(E.Z,{questionType:"role",title:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.roleLabel",defaultMessage:"Role"}),question:P.state.role,invalid:"role"===t,onSelect:e=>{P.state.open&&P.setState({...P.state,role:e,step:"initial"})}}),(0,N.jsx)("div",{style:Y(this.theme),children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.workLabel",defaultMessage:"What kind of work do you do?"})}),(0,N.jsx)(E.Z,{questionType:"work",title:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.workLabel",defaultMessage:"Work"}),question:P.state.work,invalid:"work"===t,onSelect:e=>{P.state.open&&P.setState({...P.state,work:e,step:"initial"})}}),(0,N.jsx)("div",{style:Y(this.theme),children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.questionLabel",defaultMessage:"What are you planning to use Notion for?"})}),(0,N.jsx)(E.Z,{questionType:"use",title:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.useLabel",defaultMessage:"Use"}),question:P.state.use,invalid:"use"===t,onSelect:e=>{P.state.open&&P.setState({...P.state,use:e,step:"initial"})}}),(0,N.jsx)("div",{style:Y(this.theme),children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.companySizeLabel",defaultMessage:"Company size"})}),(0,N.jsx)(O.gq,{children:[{type:"1_100",message:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}].map((e=>{let{type:t,message:s,style:n}=e;return(0,N.jsx)(D.Z,{isLightGray:!0,isLarge:!0,style:{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center",...P.state.open&&P.state.companySize===t&&{color:d.ZP.blue,border:`1px solid ${d.ZP.blue}`},...n},onClick:()=>{P.state.open&&P.setState({...P.state,companySize:t,step:"initial"})},children:s},t)}))})]})}}UNSAFE_willMountOrUpdate(){var e;if(P.state.open)return;const t=this.environment,s=t.currentUser.id,n=(0,b.g)(s),{currentUserSettingsStore:i,inAppCalloutStore:o}=j.default.state;if(!i||t.device.isMobile)return;if(n<3)return;const a=i.getSettings();if(!a)return;Boolean(a.seen_persona_collection||(null===(e=a.persona_version)||void 0===e?void 0:e.version))||!M.default.state.isOnboarding&&"closed"!==P.state.step&&!1===k.Z.state.open&&o.canShow("persona_collection")&&P.setState({...P.state,open:!0})}renderComponent(){return(0,N.jsx)(B.GI,{keepFocus:!1,open:P.state.open,render:this.renderMenu,onDismiss:()=>$(this.environment),popupType:B.kQ.Popup,disableDarkOverlayBackground:!0,disableMouseCapture:!0})}renderStep(){if(!1===P.state.open)return;const{step:e}=P.state;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(Z.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,N.jsx)(R.Z,{capture:!0,onBackspace:u.yR,onLeft:u.yR,onRight:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:u.yR,onDelete:u.yR,onTab:u.yR,children:this.renderInitial()})}),(0,N.jsx)(Z.Z,{isVisible:"prompt"===e,animationStyle:z("prompt"===e),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:()=>(0,N.jsx)(H,{})}),(0,N.jsx)(Z.Z,{isVisible:"thanks"===e,animationStyle:z("thanks"===e),enterAnimationStyle:{opacity:0,scale:.96},exitAnimationStyle:{opacity:0,scale:.96},render:()=>(0,N.jsx)(G,{})}),(0,N.jsx)(Z.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,N.jsx)(F.Z,{isLarge:!0,style:{marginTop:17,width:270,position:"absolute",bottom:20},onClick:()=>function(e){const t=e.currentUser.id;if(!P.state.open||!t)return;const s=function(){if(!P.state.open)return"closed";const{use:e,role:t,work:s,companySize:n}=P.state;if(!n)return"company_size";if(!e)return"use";if(!t)return"role";if(!s)return"work"}();if(s)return void P.setState({...P.state,step:"initial",invalidField:s});f.jPN(e,{user_id:t,event:"submit"});const{currentUserSettingsStore:n}=j.default.state;if(n&&P.state.open){const t=P.state;if(S.createAndCommit({userAction:"PersonaCollectionModal.handleSubmitClick",environment:e,perform:e=>{v.d2({userSettingsStore:n,data:{seen_persona_collection:!0,persona:t.work,team_role:t.role,use_case:t.use,source:"persona_collection",persona_version:{version:"V3",timestamp:(new Date).getTime()}},transaction:e})}}),C.default.checkGate("survey_data_writes")){const s=(new Date).getTime(),n=p.Dh({maybeFunction:t.work,guessedFunctionVersion:4,maybeRole:t.role,guessedRoleVersion:2,collectedFrom:"inapp_modal",collectedAt:s});void 0!==n&&y.Q1(e,n);const i=p.K0({maybeCompanySize:t.companySize,guessedCompanySizeVersion:1,maybeUseCases:[t.use],guessedUseCasesVersion:3,collectedFrom:"inapp_modal",collectedAt:s});void 0!==i&&x.wg(e,i)}}return P.setState({...P.state,invalidField:void 0,step:"thanks"}),void u.gw((()=>{P.reset()}),6e3)}(this.environment),children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.sendLabel",defaultMessage:"Submit"})})})]})}}V.displayName="PersonaCollectionModal";const U=V;function W(e){window.__c={n:"PersonaCollectionPrompt"};const[t,s]=(0,a.AF)(P),i=(0,r.yK)((e=>({promptHeaderStyle:{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14},promptTextStyle:{fontSize:12,color:e.mediumTextColor,width:270,margin:"0 auto"}})),[]),d=(0,o.O7)();return(0,n.useEffect)((()=>{f.q5U(d,{user_id:e.userId,event:"prompt"})}),[d,e.userId]),(0,N.jsxs)("div",{style:{paddingTop:24},children:[(0,N.jsx)("img",{style:{width:40,height:56,paddingTop:24},src:l.Z.images.chatButtonSmallPng}),(0,N.jsx)("div",{style:i.promptHeaderStyle,children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.header",defaultMessage:"Tell us more about yourself"})}),(0,N.jsx)("div",{style:i.promptTextStyle,children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})}),(0,N.jsx)(F.Z,{isLarge:!0,style:{marginTop:6,width:260,bottom:20},onClick:()=>{!0===t.open&&s({...t,step:"initial"});const{currentUserSettingsStore:e}=j.default.state;e&&S.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:d,perform:t=>{v.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}})},children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.survey",defaultMessage:"Take the 20 second survey"})}),(0,N.jsx)(D.Z,{isLightGray:!0,isLarge:!0,onClick:()=>{const{currentUserSettingsStore:t}=j.default.state;t&&e.userId&&(S.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:d,perform:e=>{v.d2({userSettingsStore:t,data:{seen_persona_collection:!0},transaction:e})}}),f.jPN(d,{user_id:e.userId,event:"skip"}),P.setState({open:!1,step:"closed"}))},children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.skipLabel",defaultMessage:"Skip"})})]})}function K(e){window.__c={n:"PersonaCollectionThanks"};const t=(0,r.yK)((e=>({thanksHeaderStyle:{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14}})),[]),s=(0,o.O7)();return(0,n.useEffect)((()=>{f.q5U(s,{user_id:e.userId,event:"thanks"})}),[s,e.userId]),(0,N.jsxs)("div",{children:[(0,N.jsx)("img",{style:{width:208,height:89,paddingTop:30},src:l.Z.images.heroIllustrationPng}),(0,N.jsx)("div",{style:t.thanksHeaderStyle,children:(0,N.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.thanks.caption",defaultMessage:"Thank you! Discover new ways to use Notion in the <textlink>Template Gallery</textlink>",values:{textlink:t=>(0,N.jsx)(L.Z,{disableUnderline:!0,disableHover:!0,href:m._j.templates,external:!0,style:{color:d.ZP.blue,fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:500},onClick:()=>{e.userId&&f.jPN(s,{user_id:e.userId,event:"template_gallery"})},children:t})}})})]})}function z(e){return{opacity:e?1:0,scale:e?1:.96}}function q(){if(!P.state.open)return{};const{step:e}=P.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(0px)":"translateY(-180px)"}}function G(){window.__c={n:"ThanksComponent"};const e=(0,o.O7)().currentUser.id;return e?(0,N.jsx)(K,{userId:e}):null}function H(){window.__c={n:"PromptComponent"};const e=(0,o.O7)().currentUser.id;return e?(0,N.jsx)(W,{userId:e}):null}function Q(e){return{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}function Y(e){return{marginTop:10,fontSize:12,color:e.mediumTextColor,fontWeight:g.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}function $(e){const{currentUserSettingsStore:t}=j.default.state,s=e.currentUser.id;t&&s&&(f.jPN(e,{user_id:s,event:"cancel"}),S.createAndCommit({userAction:"PersonaCollectionModal.handleCancel",environment:e,perform:e=>{v.d2({userSettingsStore:t,data:{seen_persona_collection:!0},transaction:e})}}),P.reset())}function J(){window.__c={n:"CancelComponent"};const e=(0,r.Fg)(),t=(0,o.O7)();return(0,N.jsx)(_.Z,{onClick:()=>$(t),style:Q(e),hoveredStyle:{background:e.buttonPressedBackground},children:(0,c.D)({width:14,fill:e.mediumTextColor})})}},38294:(e,t,s)=>{s.d(t,{Z:()=>v});s(67294);var n=s(480),i=s(24405),o=s(8848),a=s(37240),r=s(29091),l=s(9291),d=s(52275),c=s(63296),u=s(14871),m=s(64369),p=s(85893);const g="other",h={exec:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.exec",defaultMessage:"Executive (C-level / VP)"}),dept_lead:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.dept_lead",defaultMessage:"Department lead"}),team_manager:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.team_manager",defaultMessage:"Team manager"}),member:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.member",defaultMessage:"Team member"}),solo:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.solo",defaultMessage:"Solo-preneur / Freelancer"}),personal:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.personal",defaultMessage:"Using Notion just for myself"})},f={creative:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.creative",defaultMessage:"Creative"}),founderCeo:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.founderCeo",defaultMessage:"Founder / CEO"}),internalCommunication:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.internalCommunication",defaultMessage:"Internal Communication"}),eng:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.eng",defaultMessage:"Engineering"}),productDesign:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.productDesign",defaultMessage:"Product Design"}),projectProgramMgmt:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.projectProgramMgmt",defaultMessage:"Project / Program Management"}),product:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.product",defaultMessage:"Product Management"}),marketing:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.marketing",defaultMessage:"Marketing"}),sales:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.sales",defaultMessage:"Sales"}),support:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.support",defaultMessage:"Customer Service"}),finance:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.finance",defaultMessage:"Finance"}),hr:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.hr",defaultMessage:"Human Resources"}),itAdmin:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.itAdmin",defaultMessage:"IT Admin"}),knowledgeManagement:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.knowledgeManagement",defaultMessage:"Knowledge Management"}),operations:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.operations",defaultMessage:"Operations"}),educator:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.educator",defaultMessage:"Educator"}),other:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.other",defaultMessage:"Other"}),student:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.student",defaultMessage:"Student"})},x={student:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.student",defaultMessage:"Student"}),educator:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.educator",defaultMessage:"Educator"}),other:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.other",defaultMessage:"Other"})},y={docs:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.docs",defaultMessage:"Collaborate with others in docs"}),wikis:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.wikis",defaultMessage:"Create a knowledge base / wiki"}),notes:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.notes",defaultMessage:"Write notes"}),project:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.project",defaultMessage:"Manage projects"}),goals:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.goals",defaultMessage:"Track company goals and OKRs"}),ai:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.question.ai",defaultMessage:"Write with AI"}),other:(0,p.jsx)(l.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.other",defaultMessage:"Other"})},S={"1_49":(0,p.jsx)(l.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1_49",defaultMessage:"1-49"}),"50_99":(0,p.jsx)(l.FormattedMessage,{id:"OnboardingSurvey.companySize.question.50_99",defaultMessage:"50-99"}),"100_299":(0,p.jsx)(l.FormattedMessage,{id:"OnboardingSurvey.companySize.question.100_299",defaultMessage:"100-299"}),"300_999":(0,p.jsx)(l.FormattedMessage,{id:"OnboardingSurvey.companySize.question.300_999",defaultMessage:"300-999"}),"1000_5000":(0,p.jsx)(l.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1000_5000",defaultMessage:"1000-5000"}),"5000+":(0,p.jsx)(l.FormattedMessage,{id:"OnboardingSurvey.companySize.question.5000+",defaultMessage:"5000+"})};const v=(0,l.injectIntl)((function(e){let{question:t,questionType:s,title:r,randomizeSelectionOrder:g,className:v,width:j,placeholder:w,disabled:C,onSelect:k,invalid:T,styles:I,focus:P}=e;window.__c={n:"PersonaCollectionModalQuestionSelect"};const Z=(0,i.Fg)(),F=(0,n.O7)(),{device:_}=F;let A={};"role"===s&&(A=h),"school"===s&&(A=x),"work"===s&&(A=f),"use"===s&&(A=y),"companySize"===s&&(A=S);const R={menuTitle:r,items:b(A,g,F.currentUser.id),width:j||280,disabled:C||!1,getKey:e=>e,selectedItem:s,originGap:4,onSelect:e=>{k(e)},renderItem:e=>(0,p.jsx)(d.Z,{title:A[e.key],...e,className:`${v}-${e.key}`}),renderOrigin:e=>(0,p.jsxs)(c.Z,{...e,isLarge:!0,style:{...M(F,Z),...T&&{border:`1px solid ${o.ZP.red}`},...I},className:v,focused:P,children:[(0,p.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,p.jsx)(m.Z,{isMobile:_.isMobile,isSecondaryColor:!Boolean(t),children:t?A[t]:w||(0,p.jsx)(l.FormattedMessage,{defaultMessage:"Select response",id:"PersonaCollectionModal.selectQuestion.label"})})}),(0,a.s)({width:10,fill:Z.lightIconColor})]})};return(0,p.jsx)(u.Z,{...R},"persona")}));function b(e,t,s){const n=Object.keys(e);if(!t)return n;const i=(0,r.yH)(s);return n.filter((e=>e!==g)).sort((()=>i()-.5)).concat(n.filter((e=>e===g)))}function M(e,t){const{device:s}=e;return{backgroundColor:t.whiteButtonBackground,height:s.isMobile?44:32,padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:4,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${t.outlineButtonBorder}`,background:t.buttonBackground}}},46471:(e,t,s)=>{s.r(t),s.d(t,{default:()=>de});var n=s(67294),i=s(480),o=s(86628),a=s(15145),r=s(86658),l=s(15769),d=s(88437),c=s(43876),u=s(27714),m=s(73942),p=s(60651),g=s(25651),h=s(18442),f=s(45137),x=s(89101),y=s(64002),S=s(9291),v=s(893),b=s(47307),M=s(3297),j=s(40277),w=s(69915),C=s(8055),k=s(29974),T=s(10182),I=s(93405),P=s(72495),Z=s(19037),F=s(28020),_=s(84210),A=s(33929),R=s(80444),D=s(83212),B=s(82763),L=s(62967),O=s(81267),E=s(62466),N=s(85893);const V=(0,S.defineMessages)({whatIsNotionName:{id:"action.whatIsNotion.name",defaultMessage:"What is Notion?"},createNotionPageName:{id:"action.createNotionPage.name",defaultMessage:"Create your own Notion page"},signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},loginName:{id:"action.logIn.name",defaultMessage:"Log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate page"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"}}),U=(0,y.SK)(x._j.signup,{try_notion_cta:"mobile"}),W=(0,L.cN)({key:"Create Notion Page",displayName:V.createNotionPageName,analyticsName:V.createNotionPageName.defaultMessage,svg:p.h,validators:[Z.ff(Z.Z8),Z.ff(Z.jl),Z.ff(Z.tY)],closeParentMenu:!0,action:e=>{let{environment:t}=e;C.Li({environment:t,url:U})}}),K=(0,L.cN)({key:"log in",displayName:V.signUpOrLogInName,analyticsName:V.signUpOrLogInName.defaultMessage,svg:m.H,validators:[Z.ff(Z.jl)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;await w.yF(t,{utmContent:"sign_up_or_log_in",nextRoute:x._j.login})}}),z=(0,L.cN)({key:"log in",displayName:V.loginName,analyticsName:V.loginName.defaultMessage,svg:m.H,validators:[Z.ff(Z.jl)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;C.Li({environment:t,url:x._j.login,extraSearchParams:await w.tc(t)})}}),q=(0,L.cN)({key:"ios share link",displayName:V.shareLinkName,analyticsName:V.shareLinkName.defaultMessage,svg:c.s,validators:[Z.U7,Z.Fx,Z.gn],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const n=t[0],i=n.getNavigableBlockStore();if(i){const e=(0,_.ZP)({store:i,scrollToBlockId:i.id===n.id?void 0:n.id,fullyQualified:!0,pageVisitSource:a.tY.NativeShareLink});s.mobileNative&&s.mobileNative.share(e)}}}),G=(0,L.cN)({key:"android share link",displayName:V.shareLinkName,analyticsName:V.shareLinkName.defaultMessage,svg:l.Q,validators:[Z.U7,Z.Fx,Z.Dt],closeParentMenu:q.closeParentMenu,action:q.action}),H=(0,L.cs)({key:"copy link",displayName:L.RE.copyLinkName,analyticsName:L.RE.copyLinkName.defaultMessage,svg:u.N,shortcuts:["copyLinkToBlock"],validators:[Z.jl,Z.U7,Z.ff(Z.Fx),Z.ff(Z.DF)],closeParentMenu:!0,action:(e,t)=>{v.Hs({...e,event:t})}}),Q=(0,L.cN)({key:"edit page",displayName:V.editPageName,analyticsName:V.editPageName.defaultMessage,svg:g.R,validators:[Z.U7,Z.DF,Z.Zk,Z.ff(Z.eM)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;const{RouterStore:n}=t,i=n.state.route,o=F.np();if("page"===i.name&&i.requestedOnPublicDomain&&o){const e=(0,_.ZP)({store:o,preferPublicLink:!1,pageVisitSource:a.tY.EditPublicPage});C.Li({environment:t,url:e})}else t.currentUser.isLoggedIn()?b.showDialog({showCancel:!0,keepFocus:!1,message:(0,N.jsx)(S.FormattedMessage,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"action.startPublicEditDialog.message"}),items:[{label:(0,N.jsx)(S.FormattedMessage,{defaultMessage:"Continue",id:"action.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){D.Z.setState({editing:!0,commenting:!0})}}]}):(j.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),C.Li({environment:t,url:x._j.login}))}}),Y=(0,L.cN)({key:"comment page",displayName:V.commentPageName,analyticsName:V.commentPageName.defaultMessage,svg:f.o,validators:[Z.U7,Z.DF,Z.RF,Z.ff(Z.jl)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;const{RouterStore:n}=t,i=n.state.route,o=F.np();if("page"===i.name&&i.requestedOnPublicDomain&&o){const e=(0,_.ZP)({store:o,preferPublicLink:!1,pageVisitSource:a.tY.CommentPublicPage});C.Li({environment:t,url:e})}else j.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),C.Li({environment:t,url:x._j.login})}}),$=(0,L.cN)({key:"fork page",displayName:V.duplicatePageName,analyticsName:V.duplicatePageName.defaultMessage,svg:d.a,validators:[Z.U7,Z.tq,Z.DF,Z.S4],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:s,environment:n}=e;M.S({environment:n,store:t[0],originRect:s})}}),J=(0,L.cN)({key:"back to my content",displayName:V.backtoNotionName,analyticsName:V.backtoNotionName.defaultMessage,svg:p.h,validators:[Z.jl,Z.tq],closeParentMenu:!0,action:(e,t)=>{let{environment:s}=e;const{currentUserRootStore:n,currentUserSettingsStore:i}=R.default.state;n&&i&&k.L5({environment:s,userRootStore:n,userSettingsStore:i,pageVisitSource:a.tY.SwitchSpace})}}),X=(0,L.cN)({key:"cookie settings",displayName:r.ze.cookieSettingsLabel,analyticsName:r.ze.cookieSettingsLabel.defaultMessage,validators:[Z.ff(Z.tY)],closeParentMenu:!1,render:e=>(0,N.jsx)(T.Z,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:s,...n}=e;return(0,N.jsx)(I.Z,{...n,...t,title:A.default.formatMessage(r.ze.cookieSettingsLabel),svg:h.H})}}),action:()=>{}}),ee=(0,L.cN)({key:"What is Notion?",displayName:V.whatIsNotionName,analyticsName:V.whatIsNotionName.defaultMessage,svg:p.h,validators:[Z.ff(Z.Z8),Z.ff(Z.jl),Z.ff(Z.tY)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;await w.yF(t,{utmContent:"what_is_notion",nextRoute:x._j.product})}}),te=[(0,L.$J)({key:"page",render:e=>(0,N.jsx)(P.Z,{...e}),actions:[W,E.y,z,Q,Y,$,H,B.K,q,G,J,O.l,X]})],se=[(0,L.$J)({key:"page",render:e=>(0,N.jsx)(P.Z,{...e}),actions:[ee,Q,Y,$,H,B.K,q,G]}),(0,L.$J)({key:"user",render:e=>(0,N.jsx)(P.Z,{...e}),actions:[J,K]}),(0,L.$J)({key:"report page actions",render:e=>(0,N.jsx)(P.Z,{...e}),actions:[O.l,X]})];var ne=s(50906),ie=s(87279),oe=s(35328),ae=s(11540),re=s(48019),le=s(78140);const de=function(e){let{block:t,onDismiss:s}=e;window.__c={n:"PublicTopbarMoreMenu"};const a=(0,i.O7)(),{currentUser:r,device:l}=a,d=Boolean(r.isLoggedIn()||a.publicDomainUserId),c=(0,o.VK)((()=>D.Z.getMode(a,t)),[a,t]),u=(0,o.VK)((()=>!d&&(0,ae.R)().startsWith("on")),[d]),m={environment:a,blocks:[t],publicEditMode:c};let p;p=l.isMobile?{menuType:ie.og.ActionSheet}:{menuType:ie.og.Popup,width:210,maxHeight:"80vh"};const g=(0,n.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=R.default.state;if(t){const s=t.getType();s&&ne.dhV(a,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"public_topbar_more_menu",block_id:t.id,block_type:s,is_toggleable:(0,oe._A)(s,t.getFormat())})}e.closeParentMenu&&s()}),[a,s]),h=d||!l.isMobile||u?se:te;return(0,N.jsx)(le.Z,{...p,children:(0,N.jsx)(re.Z,{sections:h,onAccept:g,context:m})})}},76351:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(8848),r=s(66226),l=s(9291);const d=(0,l.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var c=s(7250),u=s(82990),m=s(54642),p=s(47307),g=s(360),h=s(28020),f=s(33929),x=s(87279),y=s(18514),S=s(88632),v=s(25399),b=s(36488),M=s(74194),j=s(78140),w=s(28992),C=s(32163),k=s(17293),T=s(63296),I=s(72495),P=s(92660),Z=s(74523),F=s(6202),_=s(85893);const A={fontSize:16,marginBottom:12,fontWeight:u.Z.fontWeight.medium},R=(0,l.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});const D=function(){return(0,_.jsx)(P.Z,{ariaLabel:f.default.formatMessage(R.dialogLabel),onDismiss:U,render:()=>(0,_.jsx)(z,{}),requireOnline:!0,modalStore:v.Z})};function B(){const{state:e}=v.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}function L(e){let{modalState:t}=e;const{reason:s}=t;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(k.Z,{title:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===s,onClick:()=>v.Z.setState({...t,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,_.jsx)(k.Z,{title:f.default.formatMessage(d.inappropriate_content),isSelected:"inappropriate_content"===s,onClick:()=>v.Z.setState({...t,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,_.jsx)(k.Z,{title:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===s,onClick:()=>v.Z.setState({...t,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}async function O(e){const t=v.Z.getState();if(!t.open)return;const{additionalInformation:s,reason:n}=t,i=(0,h.Fv)();if(!n||null==i||!i.id)return void p.showErrorMessage((0,_.jsx)(l.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const o=await(a=(0,c.OP)(),m.reportPage(e,{reason:n,page:i,intercomVisitorId:a,additionalInformation:s}));var a;"failed"===o.type?p.showError(o):(v.Z.setState({open:!1}),p.showMessage({message:(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.X)({width:40}),(0,_.jsx)("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"},children:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})})}))}function E(e){return{width:360,padding:24,fontSize:14,color:e.mediumTextColor}}function N(e,t){const{device:s}=e;return{width:"100%",background:t.popoverBackground,display:"block",padding:s.isMobile?16:"10px 12px",height:s.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:s.isMobile?16:14}}function V(){window.__c={n:"OfflineComponent"};const e=(0,o.Fg)();return(0,_.jsx)("div",{style:E(e),children:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}function U(){g.q()}function W(e){let{modalState:t}=e;window.__c={n:"MobileModalComponent"};const s=(0,o.Fg)(),i=(0,n.O7)();if(!t.open)return null;const{reason:r}=t,d={menuType:x.og.Modal,title:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:U};return(0,_.jsx)(j.Z,{...d,children:(0,_.jsx)(C.Z,{type:C.i.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...s}=e;return(0,_.jsx)(I.Z,{...s,children:t})},items:[{key:"help",render:()=>(0,_.jsx)(w.Z,{title:(0,_.jsx)(Z.Z,{title:(0,_.jsx)(l.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,y.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:(0,_.jsx)(_.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...s}=e;return(0,_.jsx)(I.Z,{...s,children:t})},items:[{key:"options",render:()=>(0,_.jsx)(L,{modalState:t}),action:()=>{}},{key:"additionalInfo",render:()=>r&&(0,_.jsx)(M.Z,{textarea:!0,style:N(i,s),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:f.default.formatMessage(R.additionalInformationPlaceholder),onChange:e=>{v.Z.setState({...t,additionalInformation:e.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,_.jsx)(I.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,_.jsx)(F.Z,{...s,disabled:!B(),title:(0,_.jsx)("div",{style:{color:a.ZP.red},children:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||O})},action:()=>O(i)}]}]},"main list")})}function K(e){let{modalState:t}=e;window.__c={n:"DesktopModalComponent"};const s=(0,o.Fg)(),i=(0,n.O7)();if(!t.open)return null;const{reason:a}=t;return(0,_.jsx)(b.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,_.jsxs)("div",{style:{width:360,padding:24,fontSize:14},children:[(0,_.jsx)("div",{style:A,children:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,_.jsx)("div",{style:{paddingBottom:12},children:(0,_.jsx)(Z.Z,{title:(0,_.jsx)(l.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,y.UY)("contentPolicy"),analyticsFrom:"report_page"})}),(0,_.jsx)("div",{children:(0,_.jsx)(L,{modalState:t})}),a&&(0,_.jsx)(M.Z,{textarea:!0,style:N(i,s),focus:Boolean(t.reason),value:t.additionalInformation,placeholder:f.default.formatMessage(R.additionalInformationPlaceholder),onChange:e=>{v.Z.setState({...t,additionalInformation:e.target.value})}}),(0,_.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,_.jsx)(T.Z,{isLarge:!0,onClick:U,style:{marginRight:12},children:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,_.jsx)(T.Z,{isRed:!0,isLarge:!0,onClick:()=>O(i),disabled:!B(),disabledFeedback:!0,children:(0,_.jsx)(l.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}function z(){window.__c={n:"ContentComponent"};const e=(0,n.O7)(),{device:t}=e,s=(0,i.VK)((()=>S.Z.state.online),[]),o=(0,i.VK)((()=>v.Z.state),[]);return s?o.open?t.isMobile?(0,_.jsx)(W,{modalState:o}):(0,_.jsx)(K,{modalState:o}):null:(0,_.jsx)(V,{})}},18168:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var n=s(24405),i=s(64921),o=s(85893);function a(e){window.__c={n:"SegmentedItemView"};const{isFirst:t,isLast:s,isSelected:a,item:r,itemStyle:l,innerStyle:d,children:c,colors:u,onClick:m}=e,{isDisabled:p}=r,g=(0,n.yK)((e=>{const n=(null==u?void 0:u.selectedOutline)??e.blueColor,i=(null==u?void 0:u.unselectedOutline)??e.accentColors.gray[100];return{SegmentedItem:{alignItems:"center",background:a?null==u?void 0:u.selectedBackground:void 0,borderBottomLeftRadius:t?3:0,borderBottomRightRadius:s?3:0,borderColor:a?n:i,borderStyle:"solid",borderTopLeftRadius:t?3:0,borderTopRightRadius:s?3:0,borderWidth:1,cursor:p?void 0:"pointer",display:"flex",flexBasis:"50%",marginLeft:t?0:-1,padding:0,userSelect:"none",zIndex:a?10:0,...l},Inner:{borderBottomLeftRadius:t?2:0,borderBottomRightRadius:s?2:0,borderColor:a?n:"transparent",borderStyle:"solid",borderTopLeftRadius:t?2:0,borderTopRightRadius:s?2:0,borderWidth:1,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",padding:"12px 20px",textAlign:"center",width:"100%",...d}}}),[null==u?void 0:u.selectedBackground,null==u?void 0:u.selectedOutline,null==u?void 0:u.unselectedOutline,t,s,a,p,l,d]);return(0,o.jsx)(i.Z,{ariaLabel:r.ariaLabel,"aria-pressed":a,onClick:()=>{m&&m(r.key)},style:g.SegmentedItem,disabled:p,children:(0,o.jsx)("div",{style:g.Inner,children:c})})}function r(e){window.__c={n:"SegmentedButton"};const{items:t=[],itemStyle:s,innerStyle:i,value:r,onChange:l,colors:d}=e,c=(0,n.yK)((e=>({SegmentedButton:{background:e.cardContentBackground,display:"flex",width:"100%"}})),[]);return 0===t.length?null:(0,o.jsx)("div",{style:c.SegmentedButton,children:t.map(((e,n)=>(0,o.jsx)(a,{isFirst:0===n,isLast:n===t.length-1,isSelected:e.key===r,item:e,itemStyle:s,innerStyle:i,colors:d,onClick:l,children:e.render()},e.key)))})}},40424:(e,t,s)=>{s.d(t,{Z:()=>ae});s(57658);var n=s(43261),i=s.n(n),o=s(67294),a=s(83355),r=s(480),l=s(99036),d=s(80951),c=s(84619),u=s(72126),m=s(4615),p=s(71644),g=s(6287),h=s(3791),f=s(9291),x=s(50906),y=s(66890),S=s(75079),v=s(78316),b=s(19124),M=s(87279),j=s(77080),w=s(29798),C=s(49085);class k extends C.default{getInitialState(){return{inputValue:"",openPropertyActionMenu:void 0}}}const T=k;var I=s(88280),P=s(86628),Z=s(24405),F=s(11751),_=s(54642),A=s(99417),R=s(4023),D=s(64921),B=s(36596),L=s(72495),O=s(22084),E=s(85893);function N(e){window.__c={n:"SelectPropertyMenuAiSuggestionSection"};const{menuArgs:t,environment:s,store:n,property:i,propertySchema:a,addNewTokens:r}=e,[l,d]=(0,o.useState)(!1),[p,g]=(0,o.useState)([]),h=(0,Z.Fg)();(0,o.useEffect)((()=>{if(0===p.length){d(!0);const e=(0,m.ZP)();_.publishAiSession(s,{inference_type:"autofill",id:e,metadata:{is_select_property_menu:!0}}),_.getCompletionForSelectOption(s,{blockPropertyPointer:{...n.pointer,spaceId:n.getSpaceId(),propertyId:i},collectionId:n.getParentId()??"",model:(0,A.jq)(),aiSessionId:e}).then((e=>{"success"===e.type&&"success"===e.data.type&&(d(!1),g(e.data.completion.split(",")))}))}}),[s,i,a,n,p.length]);const x=(0,P.VK)((()=>(0,u.oA)(p.map((e=>{var t;return null===(t=a.options)||void 0===t?void 0:t.find((t=>t.value===e))})))),[a.options,p]),y=()=>(0,E.jsxs)("div",{style:{display:"flex",flexDirection:"row",width:"100%",color:h.accentColors.purple[400]},children:[(0,F.t)({width:16,height:16,fill:h.accentColors.purple[400],marginRight:5}),(0,E.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.aiSuggestionSectionTitle",defaultMessage:"AI suggested"})]});return l?(0,E.jsx)(L.Z,{...t,title:y(),children:(0,E.jsx)("div",{style:{display:"flex",flexDirection:"row",maxWidth:"100%",overflow:"clip"},children:[...Array("select"===a.type?1:4)].map(((e,t)=>(0,E.jsx)(B.Z,{style:{width:100,height:24,marginLeft:0===t?20:10,borderRadius:4}},t)))})}):x.length>0?(0,E.jsx)(L.Z,{...t,title:y(),right:x.length>1?(0,E.jsx)(D.Z,{style:{color:h.blueColor},onClick:()=>{r(p)},children:(0,E.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.aiSuggestionSectionTitle.addAllButton",defaultMessage:"Add all"})}):null,children:(0,E.jsx)("div",{className:"hide-scrollbar",style:{display:"flex",flexDirection:"row",maxWidth:"100%",overflow:"scroll"},children:x.map(((e,t)=>(0,E.jsx)(D.Z,{style:{display:"flex",marginLeft:0===t?20:10,textAlign:"center",borderRadius:4},hoveredStyle:{display:"flex"},onClick:()=>{r([e.value])},children:(0,E.jsx)(O.a,{format:s.device.isMobile?c.lo.Large:c.lo.Medium,value:e.value,color:e.color,descriptionTooltip:e.description,tooltipPlacement:R.u.Left,showRemoveButton:!1,isSingle:!0,showEllipsis:!0})},t)))})}):(0,E.jsx)(E.Fragment,{})}var V=s(52275),U=s(79131),W=s(78140),K=s(32163),z=s(43765),q=s(40721),G=s(92658),H=s(43224),Q=s(12534),Y=s(98742),$=s(24736),J=s(3386),X=s(26388),ee=s(73456);class te extends a.Z{constructor(){super(...arguments),this.storeTypes={renameInputStore:G.Z}}UNSAFE_willMountOrUpdate(e){e.actionMenuOpen&&!this.props.actionMenuOpen&&this.stores.renameInputStore.setState({...this.stores.renameInputStore.state,inputValue:this.props.option.value})}renderComponent(){var e;const{locked:t,option:s}=this.props;return(0,E.jsx)(J.Z,{capture:this.props.actionMenuOpen,onEnter:u.yR,children:(0,E.jsx)(X.ZP,{renderTooltip:e=>(0,E.jsxs)("div",{...e,style:H.F6,children:[(0,E.jsx)("div",{children:s.value}),(0,E.jsx)("div",{style:{color:this.theme.mediumInvertedTextColor},children:s.description})]}),placement:R.u.Left,disableTooltip:!(null!==(e=s.description)&&void 0!==e&&e.length),render:e=>(0,E.jsx)(V.Z,{...(0,Y.Z)(e,this.props),title:(0,E.jsx)(O.a,{format:this.environment.device.isMobile?c.lo.Large:c.lo.Medium,value:s.value,color:s.color,hideTooltip:!0,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!t&&(0,E.jsx)(ne,{property:this.props.property,collectionId:this.props.collectionId,analyticsFrom:this.props.analyticsFrom,onChange:this.props.onChange,onCloseActionMenu:this.props.onCloseActionMenu,actionMenuOpen:this.props.actionMenuOpen,focused:this.props.focused,option:this.props.option,propertySchema:this.props.propertySchema,onOpenActionMenu:this.props.onOpenActionMenu})})})})}}te.displayName="SelectPropertyMenuItem";const se=te;function ne(e){let{property:t,collectionId:s,analyticsFrom:n,onChange:i,onCloseActionMenu:o,actionMenuOpen:a,focused:l,option:d,propertySchema:c,onOpenActionMenu:u}=e;window.__c={n:"ActionMenuButtonComponent"};const m=(0,r.O7)(),{device:p}=m;return(0,E.jsx)(ee.Z,{open:a,origin:(0,E.jsx)($.Z,{onClick:e=>function(e,t,s){(0,Q.ZP)({event:e,context:Q.Af.MenuListClick,callback:()=>t(s.value)})}(e,u,d),isMobile:p.isMobile,style:{opacity:l||p.isMobile?1:0}}),option:d,propertySchema:c,property:t,collectionId:s,analyticsFrom:n,onChange:i,onClose:o})}var ie=s(47082);class oe extends a.Z{constructor(){super(...arguments),this.storeTypes={store:T,menuListStore:w.Z},this.handleCloseActionMenu=()=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:void 0})},this.handleOpenActionMenu=e=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:e})},this.handleTokenInputChange=e=>{this.stores.store.setState({...this.stores.store.state,inputValue:""});const{collectionId:t,allowMultiple:s,property:n,schema:i,onChange:o,analyticsFrom:a}=this.props,r=i[n];if(!r)return;if(!l.cu(r))return;const d=r.options||[];let c;c=s?e:e.length>0?[e[e.length-1]]:[];const p=u.jj(u.oA(c.map((e=>{const t=d.find((t=>t.value===e));if(t)return t.value})))),h=c.find((e=>!d.find((t=>t.value===e)))),f={value:p.concat(u.oA([h]))};if(h){const e={id:(0,m.ZP)(),value:h,color:this.createSelectColor};let s;s="alphabetical"!==r.auto_sort_options&&"reverse_alphabetical"!==r.auto_sort_options||!j.default.checkGate("collection_properties_select_auto_sort_options")?[{pointer:{table:g.v,id:t},command:"keyedObjectListAfter",path:["schema",n,"options"],args:{value:e}}]:[(0,v.Ch)({collectionId:t,property:n,propertySchema:r,newOption:e,isAscending:"alphabetical"===r.auto_sort_options})],f.operations=s,this.setRandomCreateSelectColor(),x.$qu(this.environment,{...(0,S.Pn)(this.context.collectionContextStore),property_type:r.type,action:"select_add_option",from:a})}o(f)},this.handleDraggableListDrop=e=>{const{collectionId:t,property:s,schema:n,onChange:i}=this.props,o=(0,v.YL)({newOptions:e,collectionId:t,property:s,schema:n});if(o){const e=n[s];if(e&&l.cu(e)){"manual"!==(e.auto_sort_options||"manual")&&o.push({pointer:{table:g.v,id:t},command:"update",path:["schema",s],args:{auto_sort_options:"manual"}})}i({operations:o})}this.stores.menuListStore.reset()}}UNSAFE_willMount(e){if(this.setRandomCreateSelectColor(),e.insertChar){const t=e.insertChar;this.stores.store.setState({...this.stores.store.state,inputValue:t})}}renderComponent(){const{device:e}=this.environment,{disabled:t,canConfigureCollection:s}=this.props,n=this.props.schema[this.props.property];if(!n)return;if(!l.cu(n))return;const o=n.options||[],a=this.renderCurrentTokens(o),r=function(e,t,s){const n=t.map((e=>e.value));let o;if(e){o=i().filter(e,n).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&s&&o.push(e.trim().replace(/,/g,""))}else o=n;return o}(this.stores.store.state.inputValue,o,this.props.canConfigureCollection),d=0===r.length,c=(0,E.jsx)(ie.Z,{focus:e.isMobile?void 0:!this.stores.store.state.openPropertyActionMenu,focusAfterAnimation:!0,format:ie.U.Select,tokens:a,placeholder:this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{this.handleTokenInputChange(this.props.value.slice(0,this.props.value.length-1))},value:this.stores.store.state.inputValue,disabled:t,hideInput:t,onChange:e=>this.stores.store.setState({...this.stores.store.state,inputValue:e.target.value}),dontShowBorderBottom:e.isAndroid});let u;return u=e.isMobile?{menuType:M.og.Modal,title:n.name,right:(0,E.jsx)(q.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:c}:{menuType:M.og.Popup,header:c,tokenInputHeader:!0},t?(0,E.jsx)(W.Z,{...u}):(0,E.jsx)(W.Z,{...u,children:d?(0,E.jsx)(L.Z,{title:s?(0,E.jsx)(de,{}):(0,E.jsx)(re,{}),children:e.isMobileNative&&(0,E.jsx)(z.Z,{title:(0,E.jsx)(re,{})})}):(0,E.jsx)(K.Z,{type:K.i.Vertical,initialFocus:this.stores.store.state.inputValue.length>0?0:void 0,sections:[{key:0,render:e=>this.renderAiSuggestionSection(e),items:[]},{key:1,render:e=>this.renderMenuListSection(e,r),items:this.getSelectMenuListItems(r,o)}],onAccept:(e,t,s)=>{this.props.onAccept(s)},store:this.stores.menuListStore})})}renderAiSuggestionSection(e){var t;const s=(null===(t=I.subscriptionDataStoreInstance.state)||void 0===t?void 0:t.addOns)??[];if(!(0,h.de)(s)||!(0,b.KZ)()||!(0,b.q)())return;const n=this.props.schema[this.props.property];return n&&l.cu(n)?(0,E.jsx)(N,{menuArgs:e,environment:this.environment,property:this.props.property,propertySchema:n,store:this.props.blockStore,addNewTokens:e=>{this.handleTokenInputChange([...this.props.value,...e])}}):void 0}renderMenuListSection(e,t){const{canConfigureCollection:s}=this.props;return s?(0,E.jsx)(L.Z,{...e,title:(0,E.jsx)(de,{}),children:(0,E.jsx)(U.ZP,{direction:"vertical",keys:t,renderKey:s=>e.children[t.indexOf(s)],onDrop:this.handleDraggableListDrop})}):(0,E.jsx)(L.Z,{...e,title:(0,E.jsx)(le,{}),children:e.children})}renderFoundSelectPropertyMenuItem(e,t){const{schema:s,property:n}=this.props,i=s[n];if(i&&l.cu(i))return(0,E.jsx)(se,{...e,option:t,showDragHandle:this.props.canConfigureCollection,locked:!this.props.canConfigureCollection,property:this.props.property,analyticsFrom:this.props.analyticsFrom,collectionId:this.props.collectionId,onChange:e=>function(e,t,s,n,i){const o=s[t];if(!o)return;if(!l.cu(o))return;const a=o.options||[],r=[...a],d={},c=n.filter((e=>{const t=a.find((t=>t.value===e));return!t||r.some((e=>e.id===t.id))}));d.operations=e,u.Xy(c,n)||(d.value=c);i(d)}(e,this.props.property,this.props.schema,this.props.value,this.props.onChange),actionMenuOpen:this.stores.store.state.openPropertyActionMenu===t.value,propertySchema:i,onCloseActionMenu:this.handleCloseActionMenu,onOpenActionMenu:this.handleOpenActionMenu})}getSelectMenuListItems(e,t){return e.map((e=>{const s=t.find((t=>t.value===e));return{key:e,render:t=>{if(s)return this.renderFoundSelectPropertyMenuItem(t,s);{const s={id:(0,p.ZP)(),value:e,color:this.createSelectColor};return(0,E.jsx)(ce,{props:t,newOption:s,token:e})}},action:()=>{this.handleTokenInputChange([...this.props.value,e])}}}))}renderCurrentTokens(e){const{disabled:t}=this.props,{device:s}=this.environment;return u.oA(this.props.value.map((n=>{const i=(0,d.i7)(e,n);if(i)return(0,E.jsx)(O.a,{value:i.value,color:i.color,showRemoveButton:!t,isSingle:!1,format:s.isMobile?c.lo.Large:c.lo.Medium,shouldShrink:!0,onClickRemove:()=>{this.handleTokenInputChange(this.props.value.filter((e=>e!==n)))},showEllipsis:!0},i.id)})))}setRandomCreateSelectColor(){const{schema:e,property:t}=this.props,s=e[t];if(!s)return;if(!l.cu(s))return;const n=s.options||[],i=(0,l.TL)(n);this.createSelectColor=i}}oe.displayName="SelectPropertyMenu",oe.contextTypes={...a.w,...y.xm};const ae=(0,f.injectIntl)(oe);function re(){return(0,E.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}function le(){return(0,E.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}function de(){return(0,E.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}function ce(e){let{props:t,newOption:s,token:n}=e;window.__c={n:"CreateSelectPropertyMenuItem"};const i=(0,r.O7)(),{device:o}=i;return(0,E.jsx)(V.Z,{...t,title:(0,E.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,E.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,E.jsx)(f.FormattedMessage,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,E.jsx)(O.a,{value:s.value,color:s.color,showRemoveButton:!1,isSingle:!0,format:o.isMobile?c.lo.Large:c.lo.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}},34541:(e,t,s)=>{s.d(t,{Z:()=>_e});var n=s(67294),i=s(73935),o=s(83355),a=s(18466),r=s(1302),l=s(86628),d=s(24405),c=s(8848),u=s(72126),m=s(14900),p=s(99553),g=s(52989),h=s(24677),f=s(98104),x=s(82530),y=s(84064),S=s(43250),v=s(12534),b=s(39500),M=s(16339),j=s(41662),w=s(69784),C=s(50628),k=s(27724),T=s(4827),I=s(86486),P=s(23063),Z=s(9612),F=s(51454),_=s(28020),A=s(73744),R=s(17504),D=s(77546),B=s(49271),L=s(41432),O=s(92650),E=s(16472),N=s(26136),V=s(49117),U=s(98165);function W(e,t,s){if(s.isQuoteBlockChild())return t+E.nr+E.NE+B.ZD.paddingLeft;if(s.isTransclusionType()||s.isInsideTransclusion()||"ai_block"===s.getType()||s.isInsideAiBlock())return t+4;if(s.getType()===L.Ti.table){const n=j.g$.getNumberOfUnresolvedComments({simpleTableStore:s,environment:e,includeInline:!(0,O.fg)(e,s)}),i=s.isImmediateColumnChild();return 0!==n||i?t+8:t}const n=U.qA(s).filter((e=>e instanceof N.zq&&e.isType("duplicate_blocks"))).length;return n>0?t+V.pZ*n:t}function K(e,t){return t.isTransclusionType()?e+5:"ai_block"===t.getType()?t.hasContent()?e+9:e+15:t.getType()===L.Ti.button?e+3:e}function z(e){const t=e.getType(),s=e.getNavigableAncestorFormat(),n=Boolean(s.page_small_text);return t===L.Ti.divider?-6:t===L.Ti.header?n?7:10:t===L.Ti.subHeader?n?4:6:t===L.Ti.collectionView?8:t===L.Ti.table?14:3}var q=s(38755),G=s(95802),H=s(480),Q=s(47453),Y=s(9291),$=s(50906),J=s(42858),X=s(84084),ee=s(28314),te=s(65598),se=s(64921),ne=s(26388),ie=s(77907),oe=s(69454),ae=s(31945),re=s(50478),le=s(53437),de=s(79954),ce=s(85893);const ue=re.C$,me=re.GN;function pe(e){window.__c={n:"SelectableHoverMenu"};const{store:t,disableDrag:s,hasEditorPermissions:i,isWorkspaceAdmin:o,offsetTop:a}=e,r=!s,c=(0,H.O7)(),u=(0,H.MO)(),m=(0,n.useRef)(null),p=ue,g=me,f=(0,l.VK)((()=>K(a,t)),[a,t]),x=(0,l.VK)((()=>W(c,p+2,t)),[c,p,t]),y=(0,d.yK)((()=>({div:{position:"absolute",top:f,left:-x,width:p,height:g,pointerEvents:"auto",cursor:r?"-webkit-grab":void 0},popup:{width:265,overflow:"hidden"}})),[r,x,f,g,p]),[S,v]=(0,n.useState)(""),b=(0,l.VK)((()=>{const e=I.default.state;return e.isOpen&&e.menuIsOpen&&e.currentStore===t}),[t]);(0,n.useEffect)((()=>()=>{b&&I.default.reset()}),[]);const M=(0,n.useCallback)((()=>{const e=I.default.state,s=oe.Z.state;if(e.isOpen){v(""),u&&s.phase===oe.i.shown?oe.Z.onHide((()=>I.default.setState({...e,menuIsOpen:!0}))):I.default.setState({...e,menuIsOpen:!0}),h.Ys({environment:c,store:t});const n=t.getType();n&&$.YMV(c,{blockType:n})}}),[c,u,t]),j=(0,n.useCallback)((()=>I.default.reset()),[]),w=(0,l.VK)((()=>t.isNavigableAncestorLocked()),[t]);return u?null:(0,ce.jsx)("div",{style:y.div,ref:m,children:(0,ce.jsx)(le.ZP,{popupType:u?ae.Z4.SlideUp:ae.Z4.Popup,open:b,placementToOrigin:ae.pO.Left,alignmentToOrigin:ae.vR.Center,onDismiss:j,originGap:5,forceInitialInbound:!0,style:y.popup,render:()=>(0,ce.jsx)(ie.LazySelectableHoverMenuPopup,{hasEditorPermissions:i,isWorkspaceAdmin:o,store:t,onDismiss:j,containerRef:m,query:S,setQuery:v}),origin:(0,ce.jsx)(de.Z,{store:t,isHoverMenu:!0,canDrag:r,canSelect:!1,analyticsName:"selection_menu",disableForceTouch:!0,disableHorizontalDragEdgeScroll:!0,children:(0,ce.jsx)(re.ZP,{width:p,height:g,disallowTabbing:!0,onClick:M,disableDrag:!r||!i||w})}),trapFocus:b})})}pe.width=ue,pe.height=me;const ge=pe,he=(0,Y.defineMessages)({ariaLabelApple:{id:"block.selectableAddMenu.ariaLabel.apple",defaultMessage:"Click to add below. Option-click to add a block above"},ariaLabelWindows:{id:"block.selectableAddMenu.ariaLabel.windows",defaultMessage:"Click to add below. Alt-click to add a block above"}});const fe=function(e){let{store:t,offsetTop:s}=e;window.__c={n:"SelectableAddMenu"};const n=(0,Y.useIntl)(),i=(0,d.Fg)(),o=(0,H.O7)();return(0,H.MO)()?null:(0,ce.jsx)(ne.ZP,{placement:ne.ug.Bottom,delayThreshold:300,renderTooltip:()=>(0,ce.jsx)(ye,{}),render:e=>(0,ce.jsx)(se.Z,{disallowTabbing:!0,onClick:()=>function(e,t){const s=ee.lF.state.option,n=G.C.findSelectablesFromStore(t).find((e=>Boolean(e.props.onInsertRowBelow)));s?n&&n.props.onInsertRowAbove?x.createAndCommit({userAction:"SelectableAddMenu.handleClick.onInsertRowBelow",environment:e,perform:e=>{n.props.onInsertRowAbove&&n.props.onInsertRowAbove({transaction:e})}}):x.createAndCommit({environment:e,userAction:"SelectableAddMenu.handleClick.addAbove",perform:s=>{J.uE({environment:e,blocks:[t],transaction:s})}}):te.PF(t)?X.hb({environment:e,blockStore:t}):n&&n.props.onInsertRowBelow?x.createAndCommit({userAction:"SelectableAddMenu.handleClick.onInsertRowBelow",environment:e,perform:e=>{n.props.onInsertRowBelow&&n.props.onInsertRowBelow({transaction:e})}}):x.createAndCommit({environment:e,userAction:"SelectableAddMenu.handleClick.addBelow",perform:s=>{J.ZJ({environment:e,blocks:[t],transaction:s})}});$.eT_(e),I.default.reset()}(o,t),style:xe(s,t,o,i),ariaLabel:n.formatMessage(o.device.isApple?he.ariaLabelApple:he.ariaLabelWindows),...e,children:(0,Q.R)({width:16})})})};function xe(e,t,s,n){const i=K(e,t),o=W(s,26+ge.width,t);return{display:"flex",alignItems:"center",justifyContent:"center",fill:n.lightIconColor,position:"absolute",top:i,left:-o,width:24,height:24,borderRadius:4,pointerEvents:"auto",cursor:"-webkit-grab"}}function ye(){window.__c={n:"TooltipComponent"};const e=(0,d.Fg)(),t=(0,H.O7)(),s={color:e.mediumInvertedTextColor};return(0,ce.jsxs)("div",{style:{textAlign:"center"},children:[(0,ce.jsx)(Y.FormattedMessage,{defaultMessage:"Click <mediumcolor>to add below</mediumcolor>",id:"block.selectableAddMenu.tooltip.addBlockBelow",values:{mediumcolor:e=>(0,ce.jsx)("span",{style:s,children:e})}}),(0,ce.jsx)("div",{children:t.device.isApple?(0,ce.jsx)(Y.FormattedMessage,{defaultMessage:"Option-click <mediumcolor>to add above</mediumcolor>",id:"block.selectableAddMenu.tooltip.addAbove",values:{mediumcolor:e=>(0,ce.jsx)("span",{style:s,children:e})}}):(0,ce.jsx)(Y.FormattedMessage,{defaultMessage:"Alt-click <mediumcolor>to add a block above</mediumcolor>",id:"block.selectableAddMenu.tooltip.addAbove.windows",values:{mediumcolor:e=>(0,ce.jsx)("span",{style:s,children:e})}})})]})}var Se=s(95855),ve=s(18821),be=s(73063);const Me=function(e){window.__c={n:"SelectableCommentMenu"};const t=(0,H.O7)(),s=(0,H.Fy)(),{mediumInvertedTextColor:i}=(0,d.Fg)(),o=(0,Y.useIntl)(),{store:a,shouldOffsetLeft:r}=e,c=(0,l.VK)((()=>r?W(t,26+ge.width,a):32),[t,a,r]),u=(0,n.useCallback)((()=>{ve.yw({environment:t,blockStore:a})}),[t,a]);return s.isMobile?null:(0,ce.jsx)("div",{style:je(e.offsetTop,c),onMouseDown:v.$0,children:(0,ce.jsx)(ne.ZP,{placement:ne.ug.Bottom,delayThreshold:300,renderTooltip:()=>(0,ce.jsx)(Y.FormattedMessage,{defaultMessage:"Click <invertedcolor>to add a comment</invertedcolor>",id:"selectableCommentMenu.addCommentPrompt.tooltip",values:{invertedcolor:e=>(0,ce.jsx)("span",{style:{color:i},children:e})}}),render:e=>(0,ce.jsx)(be.Z,{ariaLabel:o.formatMessage({id:"selectableCommentMenu.iconButton",defaultMessage:"Comment"}),disallowTabbing:!0,icon:Se.z,onClick:u,isLightIconColor:!0,...e})})})};function je(e,t){return{position:"absolute",top:e,left:-t}}class we extends o.Z{constructor(){super(...arguments),this.verticalScrollableAncestor=void 0,this.horizontalScrollableAncestor=void 0,this.isCommentMenu=!1,this.showHoverMenu=!1,this.disableHoverMenuDrag=!1,this.targetSelectableStore=this.createComputedStore((()=>{const{target:e}=this.props;return G.C.findSelectablesFromStore(e).find((e=>Boolean(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)))})),this.targetRectStore=this.createComputedStore((()=>{var e;return null===(e=this.targetSelectableStore.state)||void 0===e||null===(e=e.getNode())||void 0===e?void 0:e.getBoundingClientRect()})),this.handleScroll=()=>{this.targetRectStore.enqueueRecompute()}}UNSAFE_willMount(e){super.UNSAFE_willMount(e);const t=this.targetSelectableStore.state;if(!t)return;this.isCommentMenu=Boolean(t.props.shouldShowCommentMenu),this.showHoverMenu=Boolean(t.props.shouldShowHoverMenu);const s=t.getNode();s&&(this.verticalScrollableAncestor=(0,D.VW)(s),this.verticalScrollableAncestor&&(0,A.lj)(this.verticalScrollableAncestor,"scroll",this.handleScroll),this.horizontalScrollableAncestor=(0,D.xH)(s),this.horizontalScrollableAncestor&&this.horizontalScrollableAncestor!==this.verticalScrollableAncestor&&(0,A.lj)(this.horizontalScrollableAncestor,"scroll",this.handleScroll),this.handleScroll())}willUnmount(){super.willUnmount(),this.verticalScrollableAncestor&&(0,A.ZV)(this.verticalScrollableAncestor,"scroll",this.handleScroll),this.horizontalScrollableAncestor&&(0,A.ZV)(this.horizontalScrollableAncestor,"scroll",this.handleScroll)}renderComponent(){var e;const{target:t,container:s}=this.props,n=s?s.getBoundingClientRect():void 0,i=this.targetRectStore.state,o=i?i.top-(n?n.top:0):void 0,a=i?i.left-(n?n.left:0):void 0,r=(0,q.Fn)(this.environment),l="editor"===this.props.target.getRole()||"read_and_write"===this.props.target.getRole()||"edit"===(null===(e=this.pageContext)||void 0===e||null===(e=e.publicEditModeStore.state)||void 0===e?void 0:e.permission),d="external_object_instance_page"===t.getType(),c=!!this.pageContext&&(0,_.qG)(this.pageContext.pageStore.id);return(0,R.Z)((e=>{var s;return(0,ce.jsxs)("div",{style:{position:"absolute",left:a,top:o,zIndex:F.Mo},...e,children:[this.isCommentMenu&&!t.isNavigableAncestorLocked()&&(0,ce.jsx)(Me,{store:t,offsetTop:z(t),shouldOffsetLeft:this.showHoverMenu||r}),this.showHoverMenu&&(0,ce.jsx)(ge,{store:t,offsetTop:z(t),disableDrag:this.disableHoverMenuDrag,isWorkspaceAdmin:r,hasEditorPermissions:l}),(!t.isNavigableAncestorLocked()||"collection"===(null===(s=t.getParentStore())||void 0===s?void 0:s.table))&&!this.isCommentMenu&&l&&!d&&!c&&(0,ce.jsx)(fe,{store:t,offsetTop:z(t)})]})}))}}we.displayName="SelectableHoverMenuOverlayItem";const Ce=we,ke={position:"absolute",top:0,left:0};class Te extends o.Z{constructor(){super(...arguments),this.container=void 0,this.currentItem=this.createComputedStore((()=>{const e=I.default.state;if(e.isOpen&&e.container===this.props.selectableContainer&&e.currentStore){return{key:e.currentStore.id,store:e.currentStore}}})),this.renderItem=(e,t,s)=>(0,ce.jsx)(P.Z,{isVisible:t,animationStyle:{opacity:1},enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,ce.jsx)(Ce,{container:this.container,target:e.store}),onAnimationEnd:()=>s(e)},e.key),this.handleContainerMount=e=>{e&&(this.container=e)}}renderComponent(){const e=this.currentItem.state;return(0,ce.jsx)("div",{style:ke,ref:this.handleContainerMount,children:(0,ce.jsx)(Z.Z,{items:e?[e]:[],renderItem:this.renderItem})})}}Te.displayName="SelectableHoverMenuOverlay";const Ie=Te;class Pe extends o.Z{constructor(){super(...arguments),this.observer=void 0,this.handleMouseDown=e=>{const{device:t}=this.environment;this.props.disableRectangularSelection||(t.isPhone?(0,v.ZP)({event:e,context:v.Af.EditorMouseDown,callback:()=>{h.ZH(this.environment),m.wG(),j.HM.clearSelection()}}):(0,v.ZP)({event:e,context:v.Af.EditorMouseDown,callback:()=>{1!==e.button&&(e.preventDefault(),g.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1}))}}))},this.handleClick=e=>{(function(e){return C.Z.hasBeenUpdatedSince(e.timeStamp)})(e)||this.props.store.canEdit()&&(0,v.ZP)({event:e,context:v.Af.EditorClick,callback:()=>{var t;if(null!==(t=k.default.getDefaultContainerFromTarget(e.target))&&void 0!==t&&t.isPeekRenderer()||p.E5(this.environment),!b.X9()&&!this.props.disableEditNearestBlock){const{clientX:t,clientY:s,target:n}=e;r.default.afterNextFlush((()=>{x.createAndCommit({userAction:"SelectableContainer.click",environment:this.environment,perform:e=>f.jh(this.environment,{x:t,y:s,target:n instanceof Element?n:void 0},e)})}))}}})},this.shouldRenderRectangularSelectionRectStore=this.createComputedStore((()=>Boolean(w.default.state.isActive&&w.default.state.defaultContainer===this)))}get registries(){return[M.Z]}didMount(){if(super.didMount(),this.props.isDefaultContainer){const e=this.props.isRootContainer?u.G0([this],k.default.state.defaultContainerStack||[]):u.G0(k.default.state.defaultContainerStack||[],[this]);k.default.setState({...k.default.state,defaultContainerStack:e,pivot:void 0,anchor:void 0,anchorContainer:void 0})}if(this.props.droppable){const e=this.props.isRootContainer?u.G0([this],k.default.state.droppableContainerStack||[]):u.G0(k.default.state.droppableContainerStack||[],[this]);k.default.setState({...k.default.state,droppableContainerStack:e})}h.Jy();const e=i.findDOMNode(this);e&&(this.observer=new MutationObserver(Ze),this.observer.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))}willUnmount(){if(super.willUnmount(),this.props.isDefaultContainer){const e=u.zu(k.default.state.defaultContainerStack||[],this);k.default.setState({...k.default.state,defaultContainerStack:e,pivot:void 0,anchor:void 0,anchorContainer:void 0})}if(this.props.droppable){const e=u.zu(k.default.state.droppableContainerStack||[],this);k.default.setState({...k.default.state,droppableContainerStack:e})}this.observer&&this.observer.disconnect()}renderComponent(){var e;const{render:t}=this.props;return(0,ce.jsx)(y.ld,{value:{selectableContainer:this,closestSelectable:null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable},children:(0,ce.jsx)(T.Z,{open:this.shouldRenderRectangularSelectionRectStore.state,origin:t({selectableEvents:{onMouseDown:this.handleMouseDown,onClick:this.handleClick},selectableHoverMenuOverlay:(0,ce.jsx)(Ie,{selectableContainer:this})}),children:(0,ce.jsx)(Fe,{isDefaultContainer:this.props.isDefaultContainer})})})}isPeekRenderer(){return this.props.isPeekRenderer}}Pe.displayName="SelectableContainer",Pe.contextTypes={...y.Tf,...o.w};const Ze=e=>{let t=!0;if(e.length<=10){const{selectableElementRectMap:s}=a.Z.withListenerIgnored((()=>C.Z.getState()));t=e.some((e=>function(e,t){const s=t.target instanceof Element?t.target:t.target.parentElement;if(!s)return!0;const n=s.closest(`.${S.euV}`);if(!n)return!0;const i=e.get(n);if(!i)return!0;const o=n.getBoundingClientRect();return!(i.x===o.x&&i.y===o.y&&i.width===o.width&&i.height===o.height)}(s,e)))}t&&h.Ch()};function Fe(e){window.__c={n:"RectangularSelectionRect"};const{isDefaultContainer:t}=e,{currentRect:s,isActive:n,showSelectionRect:i}=(0,l.VK)((()=>w.default.state.isActive?w.default.state:{currentRect:void 0,isActive:!1,showSelectionRect:!1}),[]),o=(0,d.yK)((()=>({selection:{position:"absolute",pointerEvents:"none",backgroundColor:c.ZP.blueWithAlpha(.14),border:"1px solid transparent",left:null==s?void 0:s.left,top:null==s?void 0:s.top,width:s?s.right-s.left:0,height:s?s.bottom-s.top:0}})),[s]);return n&&i&&t?(0,ce.jsx)("div",{style:o.selection}):null}const _e=Pe},77376:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(67294),i=s(480),o=s(86628),a=s(9291),r=s(41363),l=s(50906),d=s(75079),c=s(78316),u=s(87279),m=s(18514),p=s(35328),g=s(27724),h=s(13713),f=s(80209),x=s(48019),y=s(68894),S=s(78140),v=s(72495),b=s(83182),M=s(85893);const j=(0,a.defineMessages)({filterActions:{defaultMessage:"Search actions…",id:"selectableHoverMenu.filterActions.placeholder"}});function w(e){window.__c={n:"SelectableHoverMenuPopup"};const{hasEditorPermissions:t,isWorkspaceAdmin:s,store:a,onDismiss:m,containerRef:y,query:v,setQuery:b}=e,j=(0,i.O7)(),w=(0,i.MO)(),T=(0,o.VK)((()=>{var e;return{environment:j,blocks:g.default.state.stores.length?g.default.state.stores:[a],originRect:null===(e=y.current)||void 0===e?void 0:e.getBoundingClientRect(),publicEditMode:void 0}}),[j,a,y]),I=(0,o.VK)((()=>a.isNavigableAncestorLocked()),[a]),[P,Z]=(0,n.useState)(void 0),F=(0,n.useCallback)((e=>{const t=g.default.state.stores[0],s=t.getType();if(s){const n=(0,c.fm)(t),i=(0,d.Pn)(n)||{};l.dhV(j,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"selection_menu",block_id:t.id,block_type:s,is_toggleable:(0,p._A)(s,t.getFormat()),...i})}e.closeParentMenu&&m()}),[j,m]),_=(0,o.VK)((()=>a.isCollectionView()),[a]),A=!w&&t&&!I&&(0,M.jsx)(C,{filter:v,setQuery:b,comboboxAriaProps:P});let R;return R=w?{menuType:u.og.ActionSheet,header:A}:{menuType:u.og.Popup,width:265,header:A},(0,M.jsxs)(S.Z,{...R,children:[(0,M.jsx)(x.Z,{filter:v,initialFocus:v?0:void 0,sections:r.Qi,context:T,onAccept:F,setComboboxAriaProps:Z}),!v&&(t||s)&&(0,M.jsx)(h.Z,{store:a,isPageMoreButton:!1,hideTopBorder:!1}),!v&&(0,M.jsx)(f.Z,{store:a}),!v&&_&&(0,M.jsx)(k,{})]})}function C(e){window.__c={n:"SelectableHoverMenuHeader"};const{filter:t,setQuery:s,comboboxAriaProps:n}=e,o=(0,i.Fy)(),r=(0,a.useIntl)();return(0,M.jsx)(v.Z,{isInput:!0,children:(0,M.jsx)(y.ZP,{value:t,onChange:e=>s(e.target.value),focus:!o.isMobile||void 0,focusAfterAnimation:!0,placeholder:r.formatMessage(j.filterActions),preventCaptureDeleteWhenEmpty:!0,preventCaptureClipboardShortcuts:!0,...n})})}function k(){return(0,M.jsx)(v.Z,{topBorder:!0,children:(0,M.jsx)(b.Z,{title:(0,M.jsx)(a.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.hoverBlockMenu.collectionHelpButton"}),href:(0,m.UY)("guides.database"),analyticsFrom:"selectable_hover_menu"})})}},30761:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});s(67294);var n=s(480),i=s(24405),o=s(50506),a=s(38493),r=s(85893);function l(e){window.__c={n:"SidebarConnectionsModal"};const t=(0,n.Fy)(),s=(0,i.yK)((e=>({modal:{width:t.isMobile?"auto":890,height:t.isMobile?"auto":606,borderRadius:8}})),[t.isMobile]);return(0,r.jsx)(o.Z,{open:e.modalOpened,innerStyle:s.modal,onDismiss:e.onModalClose,render:()=>(0,r.jsx)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:(0,r.jsx)(a.Z,{location:"sidebar-modal"})})})}},51779:(e,t,s)=>{s.r(t),s.d(t,{MembersTabTitle:()=>cs,PeopleRow:()=>ls,SettingToggle:()=>us,SidebarTeamModal:()=>ds});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(72126),l=s(97880),d=s(82990),c=s(9291),u=s(50906),m=s(43250),p=s(95697),g=s(55838),h=s(34859),f=s(80444),x=s(26136),y=s(44041),S=s(86232),v=s(43488),b=(s(57658),s(8848)),M=s(10254),j=s(64964),w=s(82530),C=s(42922),k=s(36488),T=s(74194),I=s(26388),P=s(64369),Z=s(33929),F=s(78122),_=s(4023),A=s(9867),R=s(73365),D=s(56187);function B(e){return!(0,D.q)(e)}var L=s(97082),O=s(64552),E=s(8787),N=s(80068),V=s(74016),U=s(80993),W=s(38755),K=s(60701),z=s(85893);const q=(0,c.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),G=(0,c.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function H(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsPermissionCard"};const s=(0,a.yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),[n,i]=(0,o.AF)(g.Z),r=g.a.Members,l=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:s.spacer}),(0,z.jsx)(U.Ph,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,z.jsx)(K._,{currentAccessLevel:l,teamStore:t,disabledWithRightChevron:!0,style:s.accessLevelButton},"visibility"),(0,z.jsx)(Q,{teamStore:t},"permissions")],onClick:()=>{n.open&&i({...n,tab:r})},itemStyle:s.listItem})]})}function Q(e){let{teamStore:t}=e;window.__c={n:"PermissionsRow"};const s=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),n=(0,i.O7)(),r=(0,a.yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,o.VK)((()=>t.getTeamPermission()||{type:"team_permission",role:"none"}),[t]),d=(0,o.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,o.VK)((()=>{if(!s)return{spaceIcon:void 0,spaceName:void 0};const e=(0,W.rn)(n,s);return{spaceIcon:(0,z.jsx)(V.p,{disabled:!0,store:s,size:20,style:r.icon}),spaceName:e}}),[s,n,r.icon]),m=(0,o.VK)((()=>(0,z.jsx)(V.p,{disabled:!0,store:t,size:20,style:r.icon})),[t,r.icon]),p=!(l.role===d.role),g=p?m:c,h=Z.default.formatMessage(G[d.role],{showTeam:p,spaceName:u}),x=Z.default.formatMessage(q[l.role]);return(0,z.jsxs)("div",{style:r.row,children:[g,(0,z.jsxs)(P.Z,{isSmall:!0,style:r.label,children:[p&&(0,z.jsxs)(z.Fragment,{children:[x,(0,z.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),h]})]})}var Y=s(52867),$=s(89728),J=s(91694),X=s(11628),ee=s(42853),te=s(72141),se=(s(59730),s(86517));const ne=["none","reader","comment_only","read_and_write","editor"],ie=["reader","comment_only","read_and_write"],oe=["reader","comment_only","read_and_write","editor"],ae=["editor"];function re(e){const t=function(e){var t,s;let{teamId:n,permissions:i}=e;const o=(null===(t=i.find((e=>(0,te.ix)(e))))||void 0===t?void 0:t.role)??"none",a=(null===(s=i.find((e=>(0,te.zU)(e)&&e.team_id===n)))||void 0===s?void 0:s.role)??o,r=i.find((e=>(0,te.bm)(e)));return{spacePermission:{type:"space_permission",role:o},teamMemberPermission:{type:"explicit_team_permission",team_id:n,role:a},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:n,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:n,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:s,teamMemberPermission:n}=t,i={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},o={spacePermission:de({roles:ne,currentRole:n.role}),teamGuestPermission:ie,teamMemberPermission:le({roles:oe,currentRole:s.role}),teamOwnerPermission:ae},{visibility:a,space_member_join_access:r}=e.settings;return"team_members"===a&&(i.space_member_join_access=["invite_only"],o.spacePermission=["none"]),"self_join"===r&&(i.visibility=["space_members"],i.invite_access=["team_members"],o.spacePermission=o.spacePermission.filter((e=>"none"!==e))),e.is_default&&(o.teamMemberPermission=[n.role],o.spacePermission=[n.role]),{settingsOptions:i,permissionItemRoleOptions:o,currentTeamPermissionItems:t}}function le(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,se.IF)(e,s)))}function de(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,se.SL)(e,s)))}var ce=s(52275),ue=s(31945),me=s(78140),pe=s(32163),ge=s(72495),he=s(24006),fe=s(4708),xe=s(87279),ye=s(98742);function Se(e){let{teamStore:t}=e;window.__c={n:"TeamSecuritySection"};const{teamSettings:s,isInviteToggleVisible:n}=(0,o.VK)((()=>({teamSettings:t.getSettingsStore().getValue(),isInviteToggleVisible:(0,fe.s$)()})),[t]),i=(0,o.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return re({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!s||!i)return null;const a=[(0,z.jsx)(be,{teamStore:t,hasMultiInviteAccessOptions:1===i.settingsOptions.invite_access.length,inviteAccess:s.invite_access},"invite"),(0,z.jsx)(ve,{teamStore:t,disablePageEdits:s.disable_team_page_edits},"editSidebar")];return n&&a.push((0,z.jsx)(Me,{teamStore:t},"toggleInviteLink")),(0,z.jsx)(U.Ph,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:a,hideDividers:!0})}function ve(e){window.__c={n:"EditSidebarPermissionRow"};const{teamStore:t,disablePageEdits:s}=e,a=(0,i.O7)(),r=B(t),l=(0,o.VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),d=(0,n.useCallback)((e=>{w.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:a,perform:s=>{A.$x({environment:a,store:t,update:{disable_team_page_edits:e},transaction:s})}})}),[a,t]),u=(0,te.J5)(l),m=[{option:!0,label:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d(!0)}];return u&&m.push({option:!1,label:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d(!1)}),(0,z.jsx)(je,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:r||!u,currentOption:!u||Boolean(s),allOptions:m,optionTooltip:u?void 0:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function be(e){window.__c={n:"InvitePermissionRow"};const{teamStore:t,hasMultiInviteAccessOptions:s,inviteAccess:o}=e,a=(0,D.q)(t),r=(0,i.O7)(),l=(0,n.useCallback)((e=>{w.createAndCommit({userAction:"team.setInviteAccess",environment:r,perform:s=>{A.$x({environment:r,store:t,update:{invite_access:e},transaction:s})}})}),[r,t]),d=!a||s;return(0,z.jsx)(je,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members"}),disabled:d,optionTooltip:d&&a&&(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:o,allOptions:[{option:"team_members",label:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>l("team_members")},{option:"team_owners",label:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>l("team_owners")}]})}function Me(e){window.__c={n:"ToggleInviteLinkRow"};const{teamStore:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>p.U2(t)),[t]),r=B(t),l=(0,a.yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,z.jsxs)("div",{style:l.container,children:[(0,z.jsxs)("div",{children:[(0,z.jsx)(P.Z,{children:(0,z.jsx)(c.FormattedMessage,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,z.jsx)(P.Z,{isSmall:!0,style:l.subtitle,children:(0,z.jsx)(c.FormattedMessage,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,z.jsx)("div",{style:l.switcher,children:(0,z.jsx)(he.Z,{disabled:r,on:!n,onClick:()=>{w.createAndCommit({userAction:"team.setInviteAccess",environment:s,perform:e=>{A.$x({environment:s,store:t,update:{disable_invite_link:!n},transaction:e})}})}})})]})}function je(e){window.__c={n:"SettingSelect"};const{title:t,caption:s,currentOption:n,allOptions:o,disabled:r,optionTooltip:l}=e,d=(0,i.Fy)(),c=(0,a.yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),u=o.find((e=>e.option===n));return u?(0,z.jsxs)("div",{style:c.root,children:[(0,z.jsxs)("div",{style:c.title,children:[t,s&&(0,z.jsx)(P.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:s})]}),(0,z.jsx)(I.ZP,{style:c.tooltipWidth,placement:_.u.Top,alignment:_.v.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,z.jsx)(ue.ZP,{...e,disablePopup:r,popupType:d.isMobile?ue.Z4.SlideUp:ue.Z4.Popup,alignmentToOrigin:ue.vR.End,renderOrigin:t=>(0,z.jsxs)($.Z,{style:c.buttonStyle,disabled:r,...(0,ye.Z)(e,t),children:[u.label,!r&&(0,ee.i)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:xe.og.ActionSheet}:{menuType:xe.og.Popup,minWidth:150};const s=[{key:"options",render:e=>(0,z.jsx)(ge.Z,{...e}),items:o.map((t=>({key:t.option.toString(),render:e=>(0,z.jsx)(ce.Z,{...e,title:t.label,caption:t.caption,checkState:n===t.option}),action:()=>{t.action(),e.close()}})))}];return(0,z.jsx)(me.Z,{...t,children:(0,z.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:s})})}})})]}):null}function we(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsSecurity"};const{currentSpaceStore:s}=(0,o.Kw)(f.default),n=(0,i.O7)(),a=(0,X.z)(),r="enterprise",l=n.currentUser.id,d=(0,o.VK)((()=>({disable_public_access:{spaceIsDisabled:(null==s?void 0:s.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess()},disable_export:{spaceIsDisabled:(null==s?void 0:s.getDisableExport())??!1,teamIsDisabled:t.getDisableExport()},disable_guests:{spaceIsDisabled:(null==s?void 0:s.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests()},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits()}})),[s,t]),u=(0,D.q)(t),m=(0,o.VK)((()=>(null==s?void 0:s.canAdmin())??!1),[s]);if(!s)return null;if(!l)return null;const p=e=>a||d[e].teamIsDisabled,g=e=>{if(!p(e))return!1;if(!u)return!1;return!(e=>d[e].spaceIsDisabled&&d[e].teamIsDisabled)(e)||m},h=e=>!p(e)&&m,x=e=>{const{teamIsDisabled:s,spaceIsDisabled:i}=d[e],o=!s;A.d({environment:n,store:t,settingName:e,newTeamSettingValue:Ie(o),spaceSettingValue:void 0===i?void 0:Ie(i)})},y=e=>{if((e=>d[e].spaceIsDisabled)(e))return(e=>d[e].teamIsDisabled)(e)?(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,z.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,z.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},S=(0,z.jsx)(J.Z,{subscriptionTier:r,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),v=(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.enterpriseGateToggleTooltip",defaultMessage:"Upgrade to Enterprise Plan to change security settings"}),b=[(0,z.jsx)(us,{upsellTier:r,on:d.disable_public_access.teamIsDisabled,disabled:!g("disable_public_access"),onChange:()=>x("disable_public_access"),shouldTriggerUpsell:h("disable_public_access"),secondCaption:y("disable_public_access"),title:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing"}),!p("disable_public_access")&&S]}),tooltip:!p("disable_public_access")&&v}),(0,z.jsx)(us,{upsellTier:r,on:d.disable_guests.teamIsDisabled,disabled:!g("disable_guests"),onChange:()=>x("disable_guests"),shouldTriggerUpsell:h("disable_guests"),secondCaption:y("disable_guests"),title:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),!p("disable_guests")&&S]}),tooltip:!p("disable_guests")&&v}),(0,z.jsx)(us,{upsellTier:r,on:d.disable_export.teamIsDisabled,disabled:!g("disable_export"),onChange:()=>x("disable_export"),shouldTriggerUpsell:h("disable_export"),secondCaption:y("disable_export"),title:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),!p("disable_export")&&S]}),tooltip:!p("disable_export")&&v})];return(0,z.jsx)(Ce,{teamStore:t,toggles:b})}function Ce(e){let{teamStore:t,toggles:s}=e;window.__c={n:"TeamsSettingsSecurity"};const n=(0,a.yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]),i=(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Se,{teamStore:t}),(0,z.jsx)("div",{style:n.spacer}),(0,z.jsx)(U.Ph,{title:i,rows:s,hideDividers:!0}),(0,z.jsx)(N.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:n.learnMoreLinkContainer,message:(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function ke(e){window.__c={n:"RestoreTeamButton"};const t=(0,i.O7)();return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)($.Z,{style:e.style,icon:e=>(0,Y.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:()=>(e=>{let{teamStore:s,teamName:n}=e;return A.YH({environment:t,teamStore:s,teamName:n,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStoreInstance}),children:(0,z.jsxs)("div",{children:[(0,z.jsx)(P.Z,{children:(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,z.jsx)(P.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})})}function Te(e){window.__c={n:"ArchiveTeamButton"};const t=(0,i.O7)(),s=(0,a.yK)((()=>({archiveLabel:{color:b.ZP.red}})),[]);return(0,z.jsx)($.Z,{style:e.style,isRed:!0,icon:e=>(0,Y.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:s}=e;await A.aQ({environment:s,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStoreInstance}),...e.tooltipEvents,children:(0,z.jsxs)("div",{children:[(0,z.jsx)(P.Z,{style:s.archiveLabel,children:(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,z.jsx)(P.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Ie(e){return e?"disable":"allow"}const Pe=(0,c.defineMessages)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Ze(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsGeneral"};const s=(0,i.O7)(),r=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),l=B(t),[d,u]=(0,n.useState)(void 0),[m,p]=(0,n.useState)(void 0),g=(0,a.yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[h,x]=(0,o.VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===h)return null;const y=h||"",S=x??"",v=S.length>0,b=null==d?void 0:d.trim(),M=null==m?void 0:m.trim(),k=""===b||(void 0===m||M===S.trim())&&(void 0===d||b===y.trim()),T=(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),I=(0,z.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,z.jsx)(V.p,{disabled:l,store:t,style:g.icon,size:20,onChange:e=>{w.createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:s,perform:s=>{A.fs({store:t,update:{icon:e},transaction:s})}})}}),l?(0,z.jsx)(P.Z,{children:y}):(0,z.jsx)(Fe,{value:d??y,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:l,placeholder:"Acme Labs"})]}),_=(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),R=Z.default.formatMessage(Pe.noDescription),D=l?(0,z.jsx)(P.Z,{isMultiline:!0,isSecondaryColor:!v,children:v?S:R}):(0,z.jsx)(Fe,{value:void 0===m?S:m,onBlur:e=>{p(e)},onChange:e=>{p(e)},disabled:l,textarea:!0,autosize:!0,placeholder:R,style:g.description}),L=[(0,z.jsxs)(n.Fragment,{children:[(0,z.jsx)(P.Z,{isSmall:!0,children:T}),I]},"name"),(0,z.jsxs)(n.Fragment,{children:[(0,z.jsx)(P.Z,{isSmall:!0,children:_}),D]},"description")];return(0,z.jsxs)("div",{style:g.container,children:[(0,z.jsx)(U.Ph,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:L}),!l&&(0,z.jsx)(C.Z,{style:g.updateButton,disabled:k,isLarge:!0,onClick:async()=>{if(k)return;if(b&&b!==y.trim()){if(!(await(0,F.Xg)({environment:s,spaceStore:r,teamName:b})))return}const{performResult:e,serverCommitResult:n}=w.createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:s,perform:e=>{A.fs({store:t,update:{name:b??y,description:M??S},transaction:e})}});try{await Promise.all([e,n])}catch(i){return}j.oV({label:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,z.jsx)(c.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,z.jsx)("br",{}),(0,z.jsx)(H,{teamStore:t}),(0,z.jsx)(_e,{teamStore:t}),(0,z.jsx)(N.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Fe(e){window.__c={n:"EditableInput"};const{value:t,style:s,onBlur:i,onChange:o,placeholder:a,disabled:r}=e,[l,d]=(0,n.useState)(!1),c=(0,n.useRef)(null);return(0,z.jsx)(k.Z,{capture:l,render:n=>(0,z.jsx)(T.Z,{textarea:e.textarea,autosize:e.autosize,ref:c,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),i(e.target.value)},onChange:e=>{d(!1),o&&o(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:a,disabled:r,value:t,style:s,...n})})}function _e(e){let{teamStore:t}=e;window.__c={n:"MaybeDangerZone"};const s=(0,a.yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:U.MQ,paddingBottom:U.MQ,paddingLeft:U.oM,paddingRight:U.oM}})),[]),[n,i]=(0,o.VK)((()=>[t.getName(),t.isArchived()]),[t]),r=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),l=(0,D.q)(t),d=(0,O.e)(t),u=(0,L.y)(t.id),m=(0,R.n)(r),p=u&&!m;if(void 0===n||!d)return null;const g=[],h=(0,z.jsx)(E.Z,{buttonInternals:(0,z.jsx)(Ae,{isTeamOwner:l}),teamStore:t,placement:_.u.Bottom,alignment:_.v.Start,from:"sidebar_team_modal",style:s.buttonStyle,icon:e=>(0,M.q)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!l});if(g.push(h),l)if(i)g.push((0,z.jsx)(ke,{teamStoreInstance:t,teamName:n,style:s.buttonStyle}));else{const e=(0,z.jsx)(I.ZP,{disableTooltip:!p,placement:_.u.Bottom,alignment:_.v.Start,renderTooltip:()=>(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,z.jsx)(Te,{disabled:p,teamStoreInstance:t,tooltipEvents:e,style:s.buttonStyle})});g.push(e)}return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{style:{height:20,width:"100%"}}),(0,z.jsx)(U.Ph,{title:(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:g,itemStyle:{padding:0,margin:0}})]})}function Ae(e){let{isTeamOwner:t}=e;window.__c={n:"LeaveTeamButton"};const s=(0,a.yK)((()=>({label:{color:t?"inherit":b.ZP.red}})),[t]);return(0,z.jsxs)("div",{children:[(0,z.jsx)(P.Z,{style:s.label,children:(0,z.jsx)(c.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,z.jsx)(P.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,z.jsx)(c.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Re=s(35840),De=s(77907),Be=s(33052),Le=s(82740),Oe=s(38078);function Ee(e){let{teamStore:t}=e;window.__c={n:"TeamFilterAndAddMemberRow"};const s=(0,a.yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),n=(0,c.useIntl)(),[i,r]=(0,o.AF)(g.Z),[l,d,u]=(0,o.AF)(void 0,Be.Z),m=(0,Le.e)(t),h=(0,o.VK)((()=>(0,fe.s$)()&&!p.U2(t)),[t]);return(0,z.jsxs)("div",{style:s.container,children:[(0,z.jsxs)("div",{children:[(0,z.jsx)(De.LazyTeamPermissionsInviteWithModal,{store:t,permissionsInviteStore:u,origin:(0,z.jsx)(I.ZP,{placement:I.ug.Left,alignment:I.v2.Start,textWrap:!0,renderTooltip:()=>m?(0,z.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,z.jsx)("div",{style:{width:220},children:(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,z.jsx)(C.Z,{disabled:!m,isLarge:!0,onClick:()=>{d({...l,modalOpen:!0})},...e,children:(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),h&&(0,z.jsx)(Oe.u,{store:t,isSmall:!0})]}),(0,z.jsx)(T.Z,{placeholder:n.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:s.input,value:i.memberFilterQuery,onChange:e=>{r({...i,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Re.R)(s.searchIcon),showClearButton:!0,format:T.B.Small})]})}var Ne=s(58573),Ve=s(59054),Ue=s(62385),We=s(15047),Ke=s(64684),ze=s(7928),qe=s(86125),Ge=s(12793),He=s(31278),Qe=s(45653),Ye=s(25735),$e=s(67669),Je=(s(21703),s(36591)),Xe=s(47307),et=s(61519),tt=s(61766),st=s(31194),nt=s(29369),it=s(7567);function ot(e){window.__c={n:"TeamMemberPermissionRoleSelect"};const{teamStore:t,memberInfo:s,permissionItem:r,memberName:l,style:d,onMenuItemClicked:u,isPermissionOverridden:m}=e,p=(0,i.O7)(),g=(0,c.useIntl)(),h=(0,a.Fg)(),x=(0,n.useMemo)((()=>new tt.Z),[]),y=(0,a.yK)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor}})),[]),S=(0,o.VK)((()=>t.getTeamPermission()),[t]),v=(0,o.VK)((()=>{if(null==t||!t.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),s=(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});function n(s){return(0,se.bk)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:s})?{isDisabled:!0,disabledMessage:e}:void 0}return["editor","read_and_write","comment_only","reader"].map((e=>({role:e,disabledInfo:n(e),tag:(null==S?void 0:S.role)===e?s:void 0})))}),[S,g,t]);const b=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),M=(0,o.VK)((()=>!("enterprise"===(null==b?void 0:b.getSubscriptionTier()))&&!m),[b,m]),j=(0,z.jsxs)("div",{style:y.overrideTitle,children:[(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),M?(0,z.jsx)(J.Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,z.jsx)(it.ZP,{role:"owner"===s.type?"none":r.role,table:nt.e0,type:"user"===s.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===s.entity_type?"user_permission_item":"group_permission_item",buttonStyle:{marginRight:0,fontSize:12,color:h.mediumTextColor,visibility:m?void 0:"hidden"},availableRoleItems:v,header:(0,z.jsx)(P.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){Xe.showDialog({message:(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:l,role:(0,$e.r_)(e).toLowerCase()}}),description:(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:n}=w.createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:p,perform:n=>{A.jg({memberInfo:s,teamStore:t,transaction:n,environment:p,permissionRole:e})}});await n,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,Ke.ah)(e,s)))||await A.Uj({environment:p,teamStore:t,teamMemberInfos:[s],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:x,placementToOrigin:st.Iw.Right,alignmentToOrigin:st.lU.End})]});return(0,z.jsx)(I.ZP,{placement:I.ug.Left,textWrap:!0,renderTooltip:()=>(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,z.jsx)(ce.Z,{...e,focused:!1,style:d,textWrapperStyle:{marginRight:0},disabled:M,onClick:()=>x.setState({open:!0}),title:j,icon:m?(0,z.jsx)("div",{style:{marginTop:8},children:(0,Je.e)({width:14})}):void 0})})}function at(e){let{teamStore:t,memberInfo:s,permissionItem:n,memberName:a,isPermissionOverridden:r,disabled:d}=e;window.__c={n:"TeamMemberOwnerSelect"};const u=(0,o.qz)(void 0,tt.Z),[m,g]=(0,o.AF)(u),h=(0,i.O7)(),x=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),y=(0,o.VK)((()=>f.default.state.currentUserStore),[]),S=(0,o.VK)((()=>{const e=null==y?void 0:y.userId;return"user"===s.entity_type&&s.user_id===e}),[null==y?void 0:y.userId,s]),v=()=>g({...m,open:!1}),b=async e=>{v();const n="owner"===e?(0,z.jsx)(c.FormattedMessage,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,z.jsx)(c.FormattedMessage,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==s.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===s.entity_type){const{serverCommitResult:e}=w.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:e=>{A.W8({environment:h,userId:s.user_id,teamStore:t,transaction:e})}});await e}}else S?Xe.showDialog({message:(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:M}]}):await M();else{const i=(0,p.Mf)(s.user_id).length;Xe.showDialog({message:(0,z.jsx)(z.Fragment,{children:i>1?(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:n,numberOfOtherTeams:i-1}}):(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:n}})}),showCancel:!0,keepFocus:!1,handleCancel:Xe.dismissDialog,items:[{label:(0,z.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(x){const{serverCommitResult:n}=w.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:n=>{A.Ce({environment:h,userId:s.user_id,teamStore:t,transaction:n,spaceStore:x,newTeamRole:e})}});await n}}}]})}},M=async()=>{if("owner"===s.type&&"user"===s.entity_type){const{serverCommitResult:e}=w.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{A.mX({userId:s.user_id,teamStore:t,transaction:e,environment:h})}});await e}else if("member"===s.type){const{serverCommitResult:e}=w.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{A.X0({environment:h,memberInfo:s,teamStore:t,transaction:e})}});await e}},j=async()=>{const{entity_type:e}=s;switch(v(),e){case"group":const n=(0,W.TC)({spaceStore:x,groupId:s.group_id});if(!n)throw new Error("Permission group not found in space.");A.mN({environment:h,teamStore:t,group:n});break;case"user":await A.WO({environment:h,teamStore:t,currentSpaceStore:x,userId:s.user_id,from:"team_settings_member_table"});break;default:(0,l.t1)(e)}};return(0,z.jsx)(ue.ZP,{buttonPopupStore:u,placementToOrigin:st.Iw.Bottom,renderOrigin:e=>(0,z.jsx)(lt,{buttonPopupEvents:e,isPermissionOverridden:r,permissionItem:n,memberInfo:s,disabled:d}),render:()=>(0,z.jsx)(rt,{teamStore:t,isPermissionOverridden:r,memberInfo:s,permissionItem:n,memberName:a,onMenuItemClicked:b,onRemoveClicked:j,onSubMenuItemClicked:v}),popupType:ue.Z4.Popup})}function rt(e){let{teamStore:t,isPermissionOverridden:s,memberInfo:n,permissionItem:i,memberName:l,onRemoveClicked:u,onMenuItemClicked:g,onSubMenuItemClicked:h}=e;window.__c={n:"OwnerMemberMenuList"};const x=(0,o.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,fe.F$)()}),[]),y=(0,o.VK)((()=>t.isDefault()),[t]),S=(0,o.VK)((()=>(0,p.Hu)({membership:t.getKeyStore("membership").getValue()})),[t]),v=(0,o.VK)((()=>1===t.getMembers().filter((e=>"owner"===e.type)).length),[t]),b=(0,a.yK)((e=>{const t={paddingTop:5,paddingBottom:5},s={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:s,indentedMenuItem:{...s,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:d.Z.fontWeight.regular}}}),[]),M=(e,t)=>{const n=("owner"===e||"team_level_guest"===e)&&"group"===t.entity_type,o="member"===e&&"owner"===t.type&&v,a="team_level_guest"===e&&("owner"===t.type||"member"===t.type),r=n||o||a;return{key:e,action:()=>g(e),render:l=>{const d=!s&&t.type===e;return(0,z.jsx)(I.ZP,{disableTooltip:!r,placement:I.ug.Right,textWrap:!0,renderTooltip:()=>n?"owner"===e?(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableOwnerForGroupsTooltip",defaultMessage:"Groups can't be teamspace owners"}):(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableTeamGuestForGroupsTooltip",defaultMessage:"Groups can't be teamspace guests"}):o?(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableWithOnlyOneOwnerTooltip",defaultMessage:"Add another teamspace owner to downgrade yourself to member"}):a?(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableDowngradeToGuestTooltip",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."}):void 0,render:t=>(0,z.jsx)("span",{...t,children:(0,z.jsx)(ce.Z,{...l,style:d?b.menuItem:b.indentedMenuItem,disabled:r,disabledFeedback:r,title:(0,z.jsx)(dt,{isPermissionOverridden:s,type:e,permissionItem:i}),caption:ut(e),shouldWrapCaption:!0,icon:d?(0,Je.e)({width:14}):void 0})})})}}},j=y&&"user"===n.entity_type,w="group"!==n.entity_type,C="group"!==n.entity_type&&x,k=[{key:"teamRoles",items:r.oA([w?M("owner",n):void 0,M("member",n),C?M("team_level_guest",n):void 0,mt({onRemoveClicked:u,styles:b,isMemberInDefaultTeam:j}),..."owner"===n.type||S?[]:[{key:"divider",action:()=>{},render:()=>(0,z.jsx)(et.Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,z.jsx)("span",{...e,children:(0,z.jsx)(ot,{teamStore:t,memberInfo:n,permissionItem:i,memberName:l,onMenuItemClicked:h,isPermissionOverridden:s,style:s?b.menuItem:b.indentedMenuItem})})}]]),render:e=>(0,z.jsx)(ge.Z,{...e,topBorder:0!==e.index})}];return(0,z.jsx)(me.Z,{className:m.a6i,menuType:xe.og.Popup,children:(0,z.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:k})})}function lt(e){let{buttonPopupEvents:t,disabled:s,isPermissionOverridden:n,permissionItem:i,memberInfo:o}=e;window.__c={n:"SelectButton"};const r=(0,a.yK)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:d.Z.fontWeight.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:d.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,s){if(t&&s)return function(e){switch(e){case"none":return(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,l.t1)(e)}}(s);return ct(e)}(o.type,n,i.role);return(0,z.jsxs)($.Z,{disabled:s,...t,children:[n&&(0,z.jsxs)("span",{style:r.overrideLabel,children:[(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,z.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,z.jsx)("span",{style:r.label,children:u}),!s&&(0,ee.i)(r.chevron)]})}function dt(e){let{isPermissionOverridden:t,permissionItem:s,type:n}=e;const i=ct(n);return(0,z.jsx)("div",{children:(0,z.jsx)("span",{children:i})})}function ct(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,z.jsx)(c.FormattedMessage,{...p.q9[e].label});case"none":return;default:(0,l.t1)(e)}}function ut(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,z.jsx)(c.FormattedMessage,{...p.q9[e].caption});case"none":return;default:(0,l.t1)(e)}}function mt(e){let{styles:t,onRemoveClicked:s,isMemberInDefaultTeam:n}=e;const i=n?(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.remove.disabledTooltip.cannotRemoveFromDefault",defaultMessage:"Members cannot be removed from a default teamspace."}):void 0;return{key:"remove",action:s,render:e=>(0,z.jsx)(I.ZP,{disableTooltip:!i,placement:I.ug.Right,textWrap:!1,renderTooltip:()=>i,render:s=>(0,z.jsx)("span",{...s,children:(0,z.jsx)(ce.Z,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:Boolean(i),disabledFeedback:!0,title:(0,z.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var pt=s(30765);function gt(e){window.__c={n:"TeamPermissionRowAvatar"};const{icon:t,label:s,name:n,tag:i,style:o}=e,r=(0,a.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...o},labelContainer:{display:"flex",flexDirection:"column",...d.Z.textOverflowStyle,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[o]);return(0,z.jsxs)("div",{style:r.container,children:[t,(0,z.jsxs)("div",{style:r.labelContainer,children:[(0,z.jsxs)("div",{style:r.nameContainer,children:[(0,z.jsx)(pt.s,{style:r.name,children:n}),i]}),s&&(0,z.jsx)(P.Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,z.jsx)(pt.s,{children:s})})]})]})}function ht(e){window.__c={n:"TeamPermissionRowItem"};const{iconComponent:t,label:s,name:n,permissionRoleSelectComponent:i,tag:o,tooltip:r,style:l}=e,d=(0,a.yK)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,z.jsxs)("div",{style:d.permissionRow,children:[(0,z.jsx)(gt,{icon:t,name:n,tag:o,label:s,style:{minWidth:200,marginRight:6}}),(0,z.jsx)(I.ZP,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:I.ug.Left,renderTooltip:()=>r,render:e=>(0,z.jsx)("span",{...e,children:i})})]})}function ft(e){window.__c={n:"SpecificTeamMemberPermissionRow"};const{type:t,store:s,permissionItem:n,memberInfo:r}=e,d=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),u=(0,c.useIntl)(),m=(0,o.VK)((()=>{switch(t){case"group":return"none";case"user":return null!=d&&d.isDefined()?(0,$e.su)(null==d?void 0:d.getPermissionItems(),e.memberInfo.user_id):"none";default:(0,l.t1)(t)}}),[d,t,e]),p=(0,D.q)(s),g=(0,o.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return null==e?void 0:e.canEditMembership()}),[]),h=(0,i.O7)(),x=(0,o.VK)((()=>{const e=h.currentUser.id,t=s.getSettingsStore().getValue();return!!(null!=d&&d.isDefined()&&s.isDefined()&&t&&e)&&(0,Ke.W9)({membership:s.getMembers(),settings:t,is_default:s.isDefault()},e,{permissions:d.getPermissionItems(),subscription_tier:d.getSubscriptionTier(),permission_groups:d.getPermissionGroups()})}),[h.currentUser.id,d,s]),y=(0,o.VK)((()=>{const e=s.getPermissionItems()||[];switch(r.entity_type){case"group":return!!e.find((e=>(0,te.hV)(e)&&e.group_id===r.group_id));case"user":return!!e.find((e=>(0,te.jg)(e)&&e.user_id===r.user_id));default:return!1}}),[r,s]),{name:S,label:v,icon:b}=(0,o.VK)((()=>{switch(t){case"group":return yt({permissionGroup:e.permissionGroup,spaceId:null==d?void 0:d.id});case"user":return function(e){let{intl:t,userStore:s}=e;return{name:(0,ze.Nz)(t,null==s?void 0:s.getModel()),label:null==s?void 0:s.getEmail(),icon:(0,z.jsx)(Qe.Z,{avatarShouldShowShadow:!0,userStore:s,size:32})}}({intl:u,userStore:e.userStore});default:(0,l.t1)(t)}}),[t,e,u,null==d?void 0:d.id]),M=(0,z.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,z.jsx)(at,{teamStore:s,memberInfo:r,memberName:S,permissionItem:n,isPermissionOverridden:y,disabled:!p&&!x||"team_level_guest"===r.type&&!g})}),j=(0,a.yK)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17}})),[]);return(0,z.jsx)(ht,{style:j.row,tag:(0,te.Bc)(m)?(0,z.jsx)(qe.Z,{desktopStyle:j.pill,mobileStyle:j.pill,role:xt(m)}):"group"===t?(0,z.jsx)("div",{style:j.pill,children:b}):void 0,permissionRoleSelectComponent:M,iconComponent:"group"===t?(0,z.jsx)(Ge.Z,{size:32}):b,name:S,label:v})}function xt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,l.t1)(e)}}function yt(e){let{spaceId:t,permissionGroup:s}=e;const{name:n,user_ids:i,icon:o}=s,a=(null==i?void 0:i.length)??0;return{name:n??(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.unknownGroup",defaultMessage:"Unknown Group"}),label:(0,z.jsx)(I.ZP,{placement:I.ug.Bottom,alignment:I.v2.Start,disableTooltip:0===a,renderTooltip:()=>(0,z.jsx)(Ye.Y,{group:s,limit:10,noMembersMessage:void 0}),render:e=>(0,z.jsxs)("div",{...e,children:[(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:a}})]})}),icon:o&&(0,z.jsx)(He.Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:n,size:18,icon:o&&t?{icon:o,pointer:{table:We.bx,id:t}}:void 0})}}var St=s(47453),vt=s(34583);function bt(e){let{teamStore:t,...s}=e;window.__c={n:"SpecificTeamMemberToAddRow"};const r=(0,i.O7)(),l=(0,o.VK)((()=>{var e;return null===(e=f.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),d=(0,c.useIntl)(),u=(0,a.yK)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),m=(0,n.useCallback)((e=>{j.oV({label:(0,z.jsx)(c.FormattedMessage,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),p=(0,n.useCallback)((async(e,s)=>{await A.Uj({environment:r,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await vt.bi(r):m(s)}),[r,m,t]),g=(0,n.useCallback)(((e,t)=>p({type:"member",entity_type:"user",user_id:e.id},t)),[p]),h=(0,n.useCallback)(((e,t)=>p({type:"member",entity_type:"group",group_id:e.id},t)),[p]);if("memberToAdd"in s){const{memberToAdd:e}=s,t=(0,ze.Nz)(d,e);return(0,z.jsxs)("div",{style:u.container,children:[(0,z.jsx)(gt,{icon:(0,z.jsx)(Qe.Z,{userValue:e,size:32}),name:t,label:e.email}),Mt((()=>{g(e,t)}))]})}{if(!l)return(0,z.jsx)(z.Fragment,{});const{groupToAdd:e}=s,t=yt({spaceId:l,permissionGroup:e});return(0,z.jsxs)("div",{style:u.container,children:[(0,z.jsx)(gt,{icon:(0,z.jsx)(Ge.Z,{size:32}),name:t.name,label:t.label,tag:(0,z.jsx)("div",{style:u.pill,children:t.icon})}),Mt((()=>{h(e,t.name)}))]})}}const Mt=e=>(0,z.jsx)($.Z,{isBlue:!0,onClick:e,icon:St.R,children:(0,z.jsx)(c.FormattedMessage,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})});var jt=s(40745),wt=s(8597);function Ct(e){let{sortType:t,onChangeSortType:s}=e;window.__c={n:"TeamPermissionsListHeader"};const n=(0,a.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),i=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",o=e=>{const n=e===t.column&&!t.sortedAscending;s({column:e,sortedAscending:n})};return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{style:n.container,children:[(0,z.jsx)(kt,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:i("name"),onClick:()=>o("name")}),(0,z.jsx)(kt,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:i("role"),onClick:()=>o("role")})]})})}function kt(e){let{sortedType:t,title:s,onClick:n}=e;window.__c={n:"HeaderLabel"};const i=(0,a.yK)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,z.jsxs)($.Z,{style:i.button,hoveredStyle:i.buttonHover,onClick:n,children:["ascending"===t&&(0,wt.Z)(i.sortIcon),"descending"===t&&(0,jt.M)(i.sortIcon),s]})}function Tt(e){var t;let{store:s}=e;window.__c={n:"TeamPermissionsList"};const r=(0,i.O7)(),u=(0,a.yK)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:d.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),m=(0,c.useIntl)(),[h,x]=(0,n.useState)({column:"role",sortedAscending:!1}),[y]=(0,o.AF)(g.Z),S=(0,Le.e)(s),v=(0,o.VK)((()=>s.getMembers()),[s]),b=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),M=(0,o.VK)((()=>f.default.state.currentUserStore),[]),{permissionRowInfos:j,numNotShown:w}=(0,o.VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:s,intl:n}=e;if(""===s)return t;return(0,Ne.ZP)(s,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name??"";case"user":const{userStore:s}=e;return s.getSearchName(n);default:(0,l.t1)(t)}}))}({permissionRowInfos:(0,p.tu)({currentUserStore:M,currentSpaceStore:b,teamStore:s,members:v}),memberFilterQuery:y.memberFilterQuery,intl:m}),t=function(e){let{permissionRowInfos:t,sortType:s,intl:n}=e;const{column:i,sortedAscending:o}=s,a={permissionRowInfos:t,sortedAscending:o};if("role"===i)return function(e){let{permissionRowInfos:t,sortedAscending:s}=e;const n=["owner","member","team_level_guest"],i=["group","user"];return[...t].sort(((e,t)=>{const s=e.memberInfo.entity_type,n=t.memberInfo.entity_type;return i.indexOf(s)-i.indexOf(n)})).sort(((e,t)=>{const i=e.memberInfo.type,o=t.memberInfo.type,a=n.indexOf(i)-n.indexOf(o);return s?-a:a}))}(a);if("name"===i)return function(e){let{permissionRowInfos:t,sortedAscending:s,intl:n}=e;return[...t].sort(((e,t)=>{const i=It(e,n)??"",o=It(t,n)??"";if(i===o)return 0;const a=i<o?-1:1;return s?-a:a}))}({...a,intl:n});(0,l.t1)(i)}({permissionRowInfos:e,sortType:h,intl:m}),n=y.limitMembers?t.slice(0,50):t;return{permissionRowInfos:n,numNotShown:e.length-n.length}}),[b,M,v,s,h,y.memberFilterQuery,y.limitMembers,m]),C=(0,De.useDependency)(De.deps.searchActions),[k]=(0,Ve.r5)((async()=>{var e;if(!S||null===(e=y.memberFilterQuery)||void 0===e||!e.trim().length||"resolved"!==C.status)return[];const t=C.value,s=(await t.searchVisibleSpaceUsers({environment:r,query:y.memberFilterQuery,membersOnly:!0})).map((e=>({type:"user",value:e}))),n=t.searchSpaceGroups({query:y.memberFilterQuery,intl:m}).map((e=>({type:"group",value:e}))),i=new Set(j.map(Zt));return[...s,...n].filter((e=>!i.has(e.value.id))).slice(0,5)}),[S,y.memberFilterQuery,r,m,j,C.status,C.value]),T=Boolean(null===(t=y.memberFilterQuery)||void 0===t?void 0:t.trim().length),I=j.length>0,P="resolved"===k.status?k.value:[];return(0,z.jsxs)("div",{style:u.container,children:[(0,z.jsx)(Pt,{title:T?(0,z.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this teamspace"}):(0,z.jsx)(Ct,{sortType:h,onChangeSortType:x}),rows:j,renderRow:e=>(0,z.jsx)(ft,{store:s,...e})}),w>0&&(0,z.jsx)(Ue.Z,{style:u.showMore,onClick:()=>{g.Z.setState({...y,limitMembers:!1})},children:(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:w}})}),P.length>0&&(0,z.jsx)(Pt,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in teamspace"}),rows:P,renderRow:e=>"user"===e.type?(0,z.jsx)(bt,{teamStore:s,memberToAdd:e.value}):(0,z.jsx)(bt,{teamStore:s,groupToAdd:e.value})}),!I&&0===P.length&&(0,z.jsx)("div",{style:u.noResult,children:(0,z.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function It(e,t){const{type:s}=e;if("user"===s){const{userStore:s}=e;return s.getDisplayName(t)}if("group"===s){const{permissionGroup:t}=e;return t.name}(0,l.t1)(s)}function Pt(e){let{rows:t,renderRow:s,title:i}=e;window.__c={n:"TeamPermissionListInner"};const o=(0,a.yK)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,z.jsxs)(z.Fragment,{children:[i&&(0,z.jsx)(P.Z,{isSmall:!0,children:i}),(0,z.jsx)("div",{style:o.membersList,children:t.map(((e,t)=>(0,z.jsxs)(n.Fragment,{children:[t>0&&(0,z.jsx)("div",{style:o.memberDivider}),s(e)]},t)))})]}):null}function Zt(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,l.t1)(e)}}function Ft(e){let{teamStore:t}=e;window.__c={n:"TeamMembersListSection"};const s=(0,a.yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,z.jsxs)("div",{style:s.content,children:[(0,z.jsx)(Ee,{teamStore:t}),(0,z.jsx)(Tt,{store:t})]})}var _t=s(79362);function At(e){window.__c={n:"TeamGuestsPermissionRow"};const{teamStore:t}=e,s=(0,i.O7)(),n=(0,c.useIntl)(),{teamGuestPermissionItem:r,teamPermissions:l}=(0,o.VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),d=B(t),u=(0,o.VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:n.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[n]),m=(0,a.yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),p=r&&(0,z.jsx)(it.ZP,{role:r.role,table:nt.e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:d,buttonStyle:m.button,availableRoleItems:u,onChange:async e=>{if(l.filter((t=>((0,te.jg)(t)||(0,te.hV)(t))&&(0,se.xO)(e,t.role))).length>0){if(!(await(0,F.Bt)()))return}w.createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:s,perform:n=>{A.$J({environment:s,teamStore:t,newRole:e,transaction:n,permissionsToClear:[]})}})}}),g=(0,o.VK)((()=>t.getName()),[t]),h=(0,o.VK)((()=>t.getIcon()),[t]),f=h&&_t.V2(h.icon)?_t.mk(h.icon):"gray",x=h?{...h,icon:`/icons/user-circle_${f}.svg`}:void 0,y=(0,z.jsx)(V.p,{disabled:!0,store:t,size:U.Kt,icon:x});return p?(0,z.jsx)(ht,{permissionRoleSelectComponent:p,iconComponent:y,name:Rt(g)}):null}function Rt(e){return e?(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function Dt(e){window.__c={n:"TeamMembersPermissionRow"};const{teamStore:t}=e,s=(0,i.O7)(),n=(0,a.Fg)(),r=(0,c.useIntl)(),{teamPermissionItem:l,teamPermissions:d}=(0,o.VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=B(t),m=(0,o.VK)((()=>{var e;const s=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),n=r.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function i(e){return s&&e!==s.role&&(0,se.nl)(e,s.role)===s.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:n}:void 0}return[{role:"editor",disabledInfo:i("editor")},{role:"read_and_write",disabledInfo:i("read_and_write")},{role:"comment_only",disabledInfo:i("comment_only")},{role:"reader",disabledInfo:i("reader")}]}),[r,t]),p=l&&(0,z.jsx)(it.ZP,{role:l.role,table:nt.e0,type:(0,te.zU)(l)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:m,onChange:async e=>{const n=d.filter((t=>((0,te.jg)(t)||(0,te.hV)(t))&&(0,se.xO)(e,t.role)));if(n.length>0){if(!(await(0,F.Bt)()))return}w.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:s,perform:i=>{A.xI({environment:s,teamStore:t,newRole:e,transaction:i,permissionsToClear:n})}})}}),{teamName:g}=(0,o.VK)((()=>({teamName:t.getName()})),[t]),h=(0,z.jsx)(V.p,{disabled:!0,store:t,size:U.Kt});return(0,z.jsx)(ht,{permissionRoleSelectComponent:p,iconComponent:h,name:Bt(g)})}function Bt(e){return e?(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Lt=s(19889),Ot=s(79414);function Et(e){window.__c={n:"TeamOwnersPermissionRow"};const{teamStore:t,teamOwnerIds:s}=e,n=(0,a.Fg)(),i=(0,o.VK)((()=>t.getName()),[t]),r=(0,o.VK)((()=>t.getTeamOwnerPermission()),[t]),l=(0,o.VK)((()=>f.default.state.currentUserStore),[]),d=(0,o.VK)((()=>l?s.map((e=>x.U6.createChildStore(l,{table:Lt.KJ,id:e}))):[]),[l,s]);return(0,z.jsx)(ht,{tooltip:(0,z.jsx)(c.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,z.jsx)(it.ZP,{role:"editor",table:nt.e0,type:r&&(0,te.LW)(r)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:n.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:(0,z.jsx)(Ot.n,{teamStore:t,ownerStores:d,isSmall:!0}),name:Nt(i)})}function Nt(e){return e?(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Vt=s(16184),Ut=s(76464);function Wt(e){window.__c={n:"TeamSpacePermissionRow"};const{teamStore:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),{iconComponent:a,spaceName:r}=(0,o.VK)((()=>{if(!n)return{iconComponent:void 0,spaceName:void 0};const e=(0,W.rn)(s,n);return{iconComponent:(0,z.jsx)(V.p,{disabled:!0,store:n,size:U.Kt}),spaceName:e}}),[n,s]);return(0,z.jsx)(ht,{permissionRoleSelectComponent:(0,z.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,z.jsx)(zt,{teamStore:t})}),iconComponent:a,name:Kt(r)})}function Kt(e){return e?(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function zt(e){window.__c={n:"TeamPermissionRoleSelect"};const{teamStore:t}=e,s=(0,i.O7)(),n=(0,a.Fg)(),l=(0,o.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),d=B(t),u=(0,o.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return re({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const m=u.permissionItemRoleOptions.spacePermission;if(1===m.length&&"none"===m[0])return(0,z.jsx)(I.ZP,{renderTooltip:()=>(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,z.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Vt.Q)({width:14,height:14,fill:n.timelineRed,marginRight:4}),(0,z.jsx)("div",{style:{fontSize:12.5,color:n.timelineRed,marginRight:8},children:(0,z.jsx)(c.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=r.MR(m,(e=>-te.xm[e])).map((e=>({role:e})));return(0,z.jsx)(it.ZP,{role:l.role,table:nt.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:d||1===m.length,buttonStyle:{fontSize:12.5,marginRight:0,color:n.mediumTextColor},availableRoleItems:e,onChange:e=>{const n={...l,role:e};w.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:s,perform:e=>{Ut.ep({environment:s,store:t,permissionItems:[n],transaction:e})}})}})}}function qt(e){let{teamStore:t}=e;window.__c={n:"TeamPermissionRowsSection"};const s=(0,o.VK)((()=>t.isDefault()),[t]),n=(0,o.VK)((()=>(0,Ke.XO)({membership:t.getMembers()})),[t]),i=(0,o.VK)((()=>{const e=f.default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!s&&(0,fe.F$)())}),[s]),r=(0,a.yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,z.jsxs)("div",{style:r.container,children:[(0,z.jsx)(Et,{teamStore:t,teamOwnerIds:n},"0"),(0,z.jsx)(Dt,{teamStore:t},"1"),i&&(0,z.jsx)(At,{teamStore:t},"2"),!s&&(0,z.jsx)(Wt,{teamStore:t},"3")]})}var Gt=s(14465);function Ht(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsMembers"};const s=(0,a.yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Qt,{teamStore:t}),(0,z.jsx)("div",{style:s.spacer}),(0,z.jsx)(Gt.z,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:s.heading}),(0,z.jsx)(Ft,{teamStore:t})]})}function Qt(e){let{teamStore:t}=e;window.__c={n:"PermissionsCard"};const s=(0,i.O7)(),r=(0,o.VK)((()=>t.getName()),[t]),l=(0,a.yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),d=(0,n.useCallback)(((e,n)=>{A.Ju({environment:s,accessLevel:e,isDefault:n,store:t,teamName:r,from:"sidebar_team_modal"})}),[s,t,r]),u=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),m=[(0,z.jsx)(K._,{teamStore:t,currentAccessLevel:u,onChange:d,style:l.accessButton},"visibility"),(0,z.jsx)(qt,{teamStore:t},"permissions")];return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(U.Ph,{title:(0,z.jsx)(c.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:m,itemStyle:l.teamSettingsListItems}),(0,z.jsx)(N.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,z.jsx)(c.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:l.learnMoreLinkContainer})]})}var Yt=s(22487),$t=s(3386),Jt=s(50506),Xt=s(76798),es=s(53336),ts=s(29302),ss=s(13490),ns=s(66957),is=s(74136);function os(e){return(0,z.jsx)(is.Z,{...e,children:(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function as(e){window.__c={n:"ModalContent"};const{teamStore:t}=e,s=(0,o.VK)((()=>g.Z.state.tab),[]);if(void 0===s)return null;switch(s){case g.a.General:return(0,z.jsx)(Ze,{teamStore:t});case g.a.Members:return(0,z.jsx)(Ht,{teamStore:t});case g.a.Security:return(0,z.jsx)(we,{teamStore:t});default:(0,l.t1)(s)}}function rs(e){window.__c={n:"UserWithAvatar"};const{userId:t,currentSpaceStore:s}=e,{userStore:n,isDefined:i}=(0,o.VK)((()=>{const e=x.U6.createChildStore(s,{table:"notion_user",id:t,spaceId:s.id});return{userStore:e,isDefined:e.isDefined()}}),[s,t]);return i?(0,z.jsx)(ts.Z,{avatarShouldShowShadow:!0,userStore:n,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function ls(e){window.__c={n:"PeopleRow"};const{userIds:t,label:s,hasMarginTop:n}=e,i=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]);return i?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ss.Z,{hasMarginTop:n,children:s}),t.map((e=>(0,z.jsx)(rs,{userId:e,currentSpaceStore:i},e)))]}):null}function ds(){window.__c={n:"SidebarTeamModal"};const e=(0,i.O7)(),t=(0,o.VK)((()=>f.default.state.currentSpaceStore),[]),s=(0,o.VK)((()=>f.default.state.currentSpaceViewStore),[]),n=(0,i.Fy)(),x=(0,a.yK)((e=>({modal:{width:n.isMobile?"auto":630,height:n.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:d.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:d.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[n.isMobile]),{open:y,tab:b,teamStore:M}=(0,o.VK)((()=>{const{open:e,tab:t}=g.Z.state;return{open:e,tab:t,teamStore:g.Z.getTeamStore()}}),[]),j=(0,o.VK)((()=>null==M?void 0:M.getSettings()),[M]),w=(0,D.q)(M);if(!t||!s||!M)return null;const C=[g.a.General,g.a.Members,g.a.Security];return(0,z.jsx)(Jt.Z,{open:y,innerStyle:x.modal,onDismiss:()=>{g.Z.reset()},render:()=>y?(0,z.jsx)("div",{className:m.rIj,style:{height:"100%"},children:(0,z.jsx)("div",{style:x.modalWrap,children:(0,z.jsx)($t.Z,{capture:!0,onBackspace:r.yR,onLeft:r.yR,onRight:r.yR,onSelectAll:r.yR,onRedo:r.yR,onUndo:r.yR,onCut:r.yR,onCopy:r.yR,onPaste:r.yR,onKeypress:r.yR,onDelete:r.yR,onTab:r.yR,children:(0,z.jsxs)("div",{style:x.innerWrap,children:[(0,z.jsxs)("div",{style:x.header,children:[(0,z.jsx)(V.p,{disabled:!0,store:M,size:24,style:x.icon}),(0,z.jsx)(Xt.Z,{store:M,style:{fontSize:16,fontWeight:d.Z.fontWeight.semibold}}),(0,p.C2)(j)&&(0,z.jsx)(v.Z,{iconStyle:x.lockIcon}),(0,p.Hu)({membership:M.getRawMembership()})&&(0,z.jsx)("div",{style:{gap:5,display:"flex"},children:(0,z.jsx)(os,{desktopStyle:x.unownedPill,mobileStyle:x.unownedPill,innerStyle:x.unownedPillInner})}),(0,z.jsx)("div",{style:{flexGrow:1}}),(0,z.jsx)(S.M,{teamStore:M,onLeavingTeam:()=>g.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,z.jsx)(ns.Z,{tabs:C.map((e=>function(e,t){switch(e){case g.a.General:return(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case g.a.Members:return(0,z.jsx)(cs,{teamStore:t});case g.a.Security:return(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,l.t1)(e)}}(e,M))),selectedIndex:(0,l.$K)(b)?C.indexOf(b):1,onChange:t=>{y&&(u.rFP(e,{store:M,tab_old_value:b??g.a.General,tab_new_value:C[t]}),g.Z.update((e=>e.open?{...e,tab:C[t]}:e)))},tabStyle:{marginLeft:-8},style:x.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,z.jsx)(es.Z,{type:h.Z.Y,style:x.scroller,children:(0,z.jsx)("div",{style:x.contentWrap,children:(0,z.jsx)(as,{currentSpaceStore:t,teamStore:M,userIsTeamOwner:w})})})]})})})}):null})}function cs(e){let{teamStore:t}=e;window.__c={n:"MembersTabTitle"};const s=(0,Yt.K)(t),n=(0,a.Fg)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,z.jsx)("span",{children:" "}),(0,z.jsx)("div",{style:{color:n.lightTextColor},children:s})]})}function us(e){let{title:t,caption:s,secondCaption:n,on:o,disabled:r,tooltip:l,style:d,onChange:c,shouldTriggerUpsell:u,upsellTier:m}=e;window.__c={n:"SettingToggle"};const p=(0,i.O7)(),g=(0,a.yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:u?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[d,u]);return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{style:g.root,onClick:()=>{if(u)return y.y(p,{from:"team_security_settings",for:m,dontOpenPlansOnCancel:!0})},children:[(0,z.jsxs)("div",{style:g.title,children:[t,s&&(0,z.jsx)(P.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:s}),n&&(0,z.jsx)(P.Z,{isSmall:!0,children:n})]}),(0,z.jsx)("div",{style:g.switcherWrap,children:(0,z.jsx)(I.ZP,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,z.jsx)("div",{...e,children:(0,z.jsx)(he.Z,{on:o,disabled:r,onClick:c})})})})]})})}},636:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});s(67294);var n=s(83355),i=s(13991),o=s(480),a=s(86628),r=s(46225),l=s(50906),d=s(15944),c=s(84084),u=s(82530),m=s(68204),p=s(64286),g=s(87279),h=s(68056),f=s(31352),x=s(35328),y=s(80444),S=s(27724),v=s(10743),b=s(24666),M=s(48019),j=s(78140),w=s(53437),C=s(85893);class k extends n.Z{UNSAFE_willMountOrUpdate(){let e=v.Z.state;if(e.open){var t;const s=b.default.state;if("editing"!==s.mode)return!1;const n=I(e),i=(0,m.sG)({sections:P(e),context:{blocks:S.default.state.stores,environment:this.environment,publicEditMode:void 0},query:n||""});let o=0;if(n)if(0===i.length)o=n.length-e.lettersAtLastResult;else{const t={...e,lettersAtLastResult:(null==n?void 0:n.length)??0,filter:n};v.Z.setState(t),e=t}const{currentUserSettingsStore:a}=y.default.state;!a||null!==(t=a.getSettings())&&void 0!==t&&t.pressed_slash_tooltip||!(0,p.u)(this.environment)||d.q(this.environment);const{multiSelection:r}=s;(0,h.qS)(r)&&r.start.store===e.textStore&&!f.Ye(n,!0,i.length,o,e.textStore)||c.xv()}}renderComponent(){const{device:e}=this.environment,t=v.Z.state;return(0,C.jsx)(w.ZP,{popupType:e.isMobileNative&&!e.isTablet?w.ZP.PopupType.SlideUp:w.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:w.ZP.Placement.Bottom,alignmentToOrigin:w.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:F,render:()=>(0,C.jsx)(_,{})})}}k.displayName="SlashMenu";const T=k;function I(e){return f.zK(e.textStore,e.oldTextValue,!e.isAddMenu)}function P(e){const{insertActions:t,slashActions:s}=r.w.state;return e.isAddMenu?t:s}function Z(){const e=v.Z.state;return e.open?e.filter.length:0}function F(){c.xv()}function _(){window.__c={n:"MenuComponent"};const e=(0,o.O7)(),{device:t}=e,s=(0,a.VK)((()=>v.Z.state),[]),n=(0,a.VK)((()=>s.open?P(s):[]),[s]),r=(0,a.VK)((()=>s.open?I(s):void 0),[s]),d=(0,a.VK)((()=>S.default.state.stores),[]);if(!s.open)return null;let m;return m=t.isMobileNative&&!t.isTablet?{menuType:g.og.ActionSheet}:{menuType:g.og.Popup,width:"fr-FR"===i.SP?375:324,maxHeight:"40vh",onClickOutside:c.xv},(0,C.jsx)(j.Z,{...m,children:(0,C.jsx)(M.Z,{sections:n,onAccept:(t,s,n,i)=>function(e,t,s,n,i){const o=S.default.state.stores[0];if(o){const t=o.getType(),s=o.getFormat();l.dhV(n,{analyticsName:e.analyticsName,action_type:e.analyticsActionType,from:"slash_menu",block_id:o.id,block_type:t,is_toggleable:t?(0,x._A)(t,s):void 0,slash_menu_filter_length:Z(),slash_menu_section:i})}u.createAndCommit({userAction:"SlashMenu.handleAccept",environment:n,perform:e=>{c.RL({environment:n,transaction:e})}})}(t,0,0,e,i),context:{environment:e,blocks:d,originRect:s.selectionRect,publicEditMode:void 0},filter:r,initialFocus:0,onEmptyEnter:F,useLimit:!0})})}},53460:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Uy});s(21703);var n=s(67294),i=s(83355),o=s(480),a=s(86628),r=s(24405),l=s(16184),d=s(31980),c=s(72126),u=s(4615),m=s(3791),p=s(47425),g=s(82990),h=s(9291),f=s(48298),x=s(7512),y=s(50906),S=s(57549),v=s(47307),b=s(91376),M=s(12714),j=s(29974),w=s(71119),C=s(54642);async function k(e,t){const s=await C.getEmailDomainSettings(e,{});"success"===s.type&&t.setState({...t.state,emailDomainSettings:s.data});try{const s=await(0,w.pu)(e);t.setState({...t.state,accountSettings:{...s,error:void 0}})}catch(n){t.setState({...t.state,accountSettings:{...t.state.accountSettings,error:n}})}}var T=s(97627),I=s(82530),P=s(37181),Z=s(53877),F=s(59730),_=s(80085),A=s(77420),R=s(19889),D=s(33954),B=s(33929),L=s(77907),O=s(22326),E=s(40396),N=s(49085);class V extends N.default{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,s){if(s<=1||this.state.spaceId!==e)return;const n=(0,O.r)(t);if(this.state.filterStr!==n)return;const i=this.state.cachedResponses[s-1];return"success"===i.status?null==i?void 0:i.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,s){this.updateResultHelper(e,t,{...s,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,s){const n=(0,O.r)(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===n?this.setState({spaceId:e,filterStr:n,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...s}}}):this.setState({spaceId:e,filterStr:n,cachedResponses:{[t.pageNum||1]:{...s}}})}}const U=new V,W=(0,h.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}}),K=async e=>{const{environment:t,spaceId:s}=e,n=await C.getHistoricalAuditLogUsers(t,{spaceId:s});return"success"!==n.type?[]:n.data.results},z=async e=>{const{environment:t,spaceId:s}=e;if(E.Z.getState().spaceId!==s&&E.Z.reset(),!s)return;const n=await L.deps.searchActions.loader(),[i,o]=await Promise.all([n.searchSpaceActorIds({environment:t,membersOnly:!1}),K({environment:t,spaceId:s})]),a={spaceId:s,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};i.userIds.forEach((e=>{a.allUserIds.add(e)})),i.botIds.forEach((e=>{a.allBotIds.add(e)})),o.forEach((e=>{var t;(t=e.actorId)!==A._H.id&&t!==R.s$.id&&t!==R.el.id||a.allUserIds.has(e.actorId)?e.actorType!==R.KJ||a.allUserIds.has(e.actorId)?e.actorType!==A.cZ||a.allBotIds.has(e.actorId)||(a.allBotIds.add(e.actorId),a.removedBotIds.add(e.actorId)):(a.allUserIds.add(e.actorId),a.removedUserIds.add(e.actorId)):a.allUserIds.add(e.actorId)})),E.Z.setState(a)};var q=s(23399),G=s(69651),H=s(23096),Q=s(8319),Y=s(27330),$=s(86100),J=s(85893);const X=(0,h.injectIntl)((function(e){window.__c={n:"AuditLogFilterContainer"};const{spaceStore:t}=e,[s,n]=(0,a.AF)(O.Z),[i,o,r]=(0,a.AF)(E.Z);return(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:[(0,J.jsx)(H.Z,{mode:Q.z.Pill,focused:!1,title:(0,J.jsx)(h.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:G.C,value:s.timeRange,showButtons:"footer",onChange:e=>{n({...s,timeRange:e,pageNum:1})}}),(0,J.jsx)(Y.Z,{parentStore:t,auditLogHistoricalUserStore:r,selectedActors:s.actors,onChange:e=>{n({...s,actors:e,pageNum:1})}}),(0,J.jsx)($.Z,{parentStore:t,selectedEvents:s.actions,onChange:e=>{n({...s,actions:e,pageNum:1})}})]})}));var ee=s(84665),te=s(81549),se=s(61275),ne=s(75553),ie=s(893),oe=s(40394),ae=s(64921),re=s(26388),le=s(64369),de=s(4708),ce=s(77080),ue=s(21752),me=s(26136);function pe(e){window.__c={n:"AuditLogColumnActor"};const{auditLogEntry:t,spaceStore:s,id:i}=e,o=(0,h.useIntl)(),l=(0,a.VK)((()=>{if(t.actor.actorType===R.KJ){const e=me.U6.createChildStore(s,{id:t.actor.actorId,table:R.KJ});if(e.isDefined()&&!e.getIsDeleted())return{actorStore:e};if(t.actor.email)return{avatar:{name:t.actor.name,email:t.actor.email}}}else if(t.actor.actorType===A.cZ){const e=me.Qx.createChildStore(s,{id:t.actor.actorId,table:A.cZ});return e.isDefined()?{actorStore:e}:{avatar:{name:t.actor.name,email:t.actor.actorId}}}return{actorStore:void 0}}),[s,t]),d=(0,a.VK)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDisplayName(o))??(null===(t=l.avatar)||void 0===t?void 0:t.name)}),[l,o]),c=(0,a.VK)((()=>{var e,t;if(l)return(null===(e=l.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=l.avatar)||void 0===t?void 0:t.email)}),[l]),u=(0,n.useMemo)((()=>{var e;if(t.actor.actorType===R.KJ)return(0,ue.K)(null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole)}),[t]),m=(0,r.yK)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),p=(0,n.createRef)();return(0,J.jsx)(re.ZP,{disableTooltip:ge(p.current),renderTooltip:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{children:d}),(0,J.jsx)("div",{children:c})]}),placement:re.ug.Bottom,render:e=>(0,J.jsx)("div",{...e,style:m.container,children:(0,J.jsx)(ue.Z,{id:i,...l,spaceRole:u})})})}function ge(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var he=s(19044),fe=s(33581),xe=s(58015);const ye={id:"actor",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return(0,J.jsx)(pe,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},Se={id:"event",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return(0,J.jsx)(fe.p,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},ve={id:"dateTimeAndMenu",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,s=`event-${e.auditLogEntry.actionName}-${e.id}`,n=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(he.t,{auditLogEntry:e.auditLogEntry,id:n}),(0,J.jsx)(je,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:s,dateTimeColumnId:n}})]})},widthData:{width:25},sortable:!0},be=[ye,Se,ve];function Me(){return(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"},children:[(0,J.jsx)("div",{children:(0,J.jsx)(le.Z,{isSecondaryColor:!0,style:{fontWeight:500},children:(0,J.jsx)(h.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"})})}),(0,J.jsx)(le.Z,{isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})})]})}function je(e){window.__c={n:"AuditLogColumnMenu"};const{auditLogEntry:t,ids:s}=e,n=(0,a.VK)((()=>(0,de.F$)()),[]),i=(0,a.VK)((()=>ce.default.checkGate("audit_log_event_name_column")?se.pz:se.C9),[]),l=(0,h.useIntl)(),d=(0,o.O7)(),c=(0,r.Fg)(),u=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:4}})),[]);return(0,J.jsx)(re.ZP,{delayThreshold:80,placement:re.ug.Bottom,render:e=>(0,J.jsx)("div",{style:u.container,...e,children:(0,J.jsx)(ae.Z,{style:u.button,onClick:()=>{var e;ie.RD({environment:d,stringValue:(0,se.eA)({auditLogEntry:t,intl:l,getAuditLogEventText:(e=s.eventColumnId,t=>{var s;return null===(s=document.getElementById(e))||void 0===s?void 0:s.textContent}),isTeamGuestsEnabled:n,csvColumnNames:i}),copiedMessage:ie.tq.copiedToClipboard})},children:(0,ne.U)({width:16,height:16,fill:c.mediumIconColor})})}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}const we=(0,h.injectIntl)((function(e){window.__c={n:"AuditLogPaginatedTable"};const{searchResponse:t,spaceStore:s}=e,[i,o]=(0,a.AF)(O.Z),l=t.results||[],d=t.hasMoreResults,c=Boolean(l.length),u=e=>{const t={...i,pageNum:e};o(t)},m=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:be,theme:e,containerMarginTop:0})),[]),p=l.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:s,isClickable:!1}))),g=(0,n.useCallback)((()=>{const e=i.sortOrder===_.NQ.CreatedOldest?_.NQ.CreatedNewest:_.NQ.CreatedOldest;o({...i,sortOrder:e,pageNum:1})}),[i,o]),f=(0,n.useMemo)((()=>({column:ve,sortAscending:i.sortOrder===_.NQ.CreatedOldest})),[i]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:be,rows:p,sortState:f,onSortStateChanged:g,renderNoRowsComponent:Me,styles:m}),c?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:[(0,J.jsx)(xe.v,{onClick:()=>{u(i.pageNum-1)},disabled:1===i.pageNum,children:(0,J.jsx)(h.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})}),(0,J.jsx)(xe.v,{disabled:!d,onClick:()=>{u(i.pageNum+1)},children:(0,J.jsx)(h.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"})})]}):null]})}));const Ce=(0,h.injectIntl)((function(e){window.__c={n:"AuditLogSettingsImpl"};const{spaceStore:t}=e,s=(0,o.O7)(),i=null==t?void 0:t.id,[r]=(0,a.AF)(U),[l]=(0,a.AF)(O.Z),d=(0,O.r)(l)!==r.filterStr?void 0:r.cachedResponses[l.pageNum];return(0,n.useEffect)((()=>{i&&(async e=>{var t,s;const{environment:n,spaceId:i}=e,o=O.Z.getState();U.startLoading(i,o);const{sortOrder:a,pageSize:r,pageNum:l}=o,d={spaceId:i,limit:r,cursor:U.getCursor(i,o,l),filters:{timeRange:{starting:o.timeRange.starting?Z.OQ.toUnixMs(o.timeRange.starting):void 0,ending:o.timeRange.ending?Z.OQ.toUnixMs(o.timeRange.ending):void 0},...(null===(t=o.actors)||void 0===t?void 0:t.length)>0?{actors:o.actors}:void 0,...(null===(s=o.actions)||void 0===s?void 0:s.length)>0?{actions:o.actions}:void 0},sort:a||_.NQ.CreatedNewest},c=await C.searchAuditLog(n,d);if("success"!==c.type)if(U.updateError(i,o),(0,F.Jx)(c.body)){const e=(0,D.wf)(B.default.getIntl(),c);v.showErrorMessage(e)}else v.showErrorMessage(B.default.formatMessage(W.loadCurrentAuditLogError));else U.updateLoadedResult(i,o,c.data)})({environment:s,spaceId:i})}),[s,i,l]),(0,n.useEffect)((()=>{z({environment:s,spaceId:i})}),[s,i]),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ee.e,{}),(0,J.jsxs)("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12},children:[(0,J.jsx)(X,{spaceStore:t}),(0,J.jsx)(q.Z,{})]}),"loading"===(null==d?void 0:d.status)&&(0,J.jsx)(te.Z,{}),"success"===(null==d?void 0:d.status)&&(0,J.jsx)(we,{searchResponse:d,spaceStore:t})]})}));var ke=s(28020),Te=s(68821),Ie=s(43250),Pe=s(8989),Ze=s(18514),Fe=s(95697),_e=s(80444),Ae=s(67940);class Re extends N.default{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaces:[],createAccount:!1,useMetadataUrl:!0}}}const De=Re;var Be=s(53680);class Le extends N.default{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const Oe=new Le;var Ee=s(24026);class Ne extends N.default{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getPublicContentDomain(),s=e.getPublicHomePage();if(e.isDefined())return{name:e.getName()||"",domain:t||"",emailDomains:e.getEmailDomains(),domainState:"current-space",publicHomePage:s}}}const Ve=Ne;class Ue extends N.default{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:s,store:n}=e,i=await C.getEmailDomainsForSpace(t,{spaceId:s});if("failed"===i.type)return void v.showError(i);const{data:o}=i,a=Object.keys(o);return 0!==a.length?n.setState({emailDomains:a,spaceCreation:o[a[0]].spaceCreationEnum,settings:o[a[0]].settings}):n.setState(this.getInitialState()),n.state}}const We=Ue;class Ke extends N.default{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,Z.aN)(),accountSettings:{hasPassword:!1,canConfigurePassword:!1,isSamlEnforced:!1,mfaStatus:"loading",numMfaSettings:0,regenerateBackupCodes:!1,error:void 0}}}getValueForUser(e,t,s){if(e.isDefined()){const n=e.getFullName(s),i=e.getProfilePhoto(),o=t.getSettings();return{...this.state,uploadingProfilePhoto:!1,profilePhoto:i,name:n||"",startDayOfWeek:void 0===(null==o?void 0:o.start_day_of_week)?(0,Z.aN)():null==o?void 0:o.start_day_of_week}}}}const ze=Ke;var qe=s(92083),Ge=s(98905),He=s(85703),Qe=s(34583),Ye=s(67742),$e=s(38449),Je=s(53336),Xe=s(27386),et=s(23189),tt=s(93108),st=s(82356),nt=s(47409),it=s(18442),ot=s(15967),at=s(1436),rt=s(36312),lt=s(87393),dt=s(72569),ct=s(5108),ut=s(38400),mt=s(64530),pt=s(5517),gt=s(62397),ht=s(94157),ft=s(72263),xt=s(73039),yt=s(85354),St=s(11751),vt=s(46783),bt=s(69196),Mt=s(88893),jt=s(35057),wt=s(88280),Ct=s(74420),kt=s(39849),Tt=s(59054),It=s(63143);class Pt extends N.default{getInitialState(){return{recentRecoverableUsers:[],searchQuery:void 0,unreadMemberRequestsCount:0,unreadGuestRequestsCount:0}}}const Zt=new Pt;function Ft(e){let{spaceStore:t,requestType:s}=e;const i=_t({spaceStore:t}),r=(0,o.O7)(),[{value:l}]=(0,Tt.r5)((async()=>{if(!i)return;const e=await C.getAccessRequests(r,{parentTable:"space",parentId:t.id,size:100,status:"pending"});if("failed"===e.type)throw e.error;const n=e.data.accessRequestIds;return(await f.Vy(t,n)).filter((e=>e.requestType===s))}),[t,r,s,i]),d=(0,a.VK)((()=>null==l?void 0:l.filter((e=>"pending"===e.accessRequestStore.getKeyStore("status").getValue()))),[l]);return(0,n.useEffect)((()=>{if(!d)return;const{currentSpaceViewStore:e}=_e.default.state;if(!e)return;const t=d.filter((t=>function(e){var t,s;let{requestType:n,currentSpaceViewStore:i}=e;const o=Date.now()-10*It._I;return("member"===n?null===(t=i.getSettings())||void 0===t?void 0:t.last_opened_member_request_tab:null===(s=i.getSettings())||void 0===s?void 0:s.last_opened_guest_request_tab)??o}({requestType:s,currentSpaceViewStore:e})<t.accessRequest.created_time)).length;"member"===s&&Zt.setState({...Zt.state,unreadMemberRequestsCount:t}),"guest"===s&&Zt.setState({...Zt.state,unreadGuestRequestsCount:t})}),[d,s]),{requests:d??[]}}function _t(e){let{spaceStore:t}=e;return(0,a.VK)((()=>t.canEditMembership()&&(0,de.p1)()),[t])}function At(e){let{requestType:t,spaceStore:s}=e;const i=(0,o.O7)(),a=_t({spaceStore:s});(0,n.useEffect)((()=>{const{currentSpaceViewStore:e}=_e.default.state;e&&a&&"member"!==t&&I.createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:i,perform:t=>{I.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_guest_request_tab"],command:"set",args:Date.now()},transaction:t})}})}),[t,i,a]),(0,n.useEffect)((()=>()=>{const{currentSpaceViewStore:e}=_e.default.state;e&&a&&"guest"!==t&&(I.createAndCommit({userAction:"SpaceSettingsRequests.updateLastOpened",environment:i,perform:t=>{I.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings","last_opened_member_request_tab"],command:"set",args:Date.now()},transaction:t})}}),Zt.setState({...Zt.state,unreadMemberRequestsCount:0}))}),[t,i,a])}function Rt(){window.__c={n:"SpaceSettingsPeopleSectionBadge"};const{currentSpaceStore:e}=(0,a.VK)((()=>_e.default.state),[]);return e?(0,J.jsx)(Dt,{spaceStore:e}):null}function Dt(e){let{spaceStore:t}=e;window.__c={n:"SpaceSettingsPeopleSectionBadgeInternal"},Ft({spaceStore:t,requestType:"guest"}),Ft({spaceStore:t,requestType:"member"});const{count:s,styles:n}=function(){const e=(0,a.VK)((()=>{const{unreadMemberRequestsCount:e,unreadGuestRequestsCount:t}=Zt.state;return e+t}),[]),t=(0,r.yK)((e=>({container:{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",right:6,top:6},badge:{top:-3,right:-5}})),[]);return{count:e,styles:t}}();return 0===s?null:(0,J.jsx)("div",{style:n.container,children:(0,J.jsx)(kt.Z,{count:s,style:n.badge,color:kt.N.Red})})}const Bt=(0,h.defineMessages)({accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People"},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},plansTab:{id:"spaceSettingsSidebar.plansTab.title",defaultMessage:"Plans"},upgradeTab:{id:"spaceSettingsSidebar.upgradeTab.title",defaultMessage:"Upgrade"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections"},securitySAMLTab:{id:"spaceSettingsSidebar.securityAndSAMLTab.title",defaultMessage:"Security & identity"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning"},sitesTab:{id:"spaceSettingsSidebar.sites.title",defaultMessage:"Sites"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},mySettings:{id:"spaceSettingsSidebar.mySettings.title",defaultMessage:"My settings"},myNotifications:{id:"spaceSettingsSidebar.myNotifications.title",defaultMessage:"My notifications"},debugZoneTab:{id:"spaceSettingsSidebar.debugZoneTab.title",defaultMessage:"Debug Zone"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import"}}),Lt={width:20,height:20},Ot={profile:e=>(0,bt.H)(Lt),notifications_and_settings:()=>(0,mt.y)(Lt),user_settings:()=>(0,mt.y)(Lt),notifications:()=>(0,ut.V)(Lt),connected_apps:()=>(0,at.g)(Lt),language_and_region:()=>(0,dt.f)(Lt),settings:()=>(0,it.H)(Lt),teams:()=>(0,xt.K)(Lt),members:()=>(0,ct.n)(Lt),plans:()=>{const e=wt.subscriptionDataStoreInstance.state;return e&&Mt.YK(e)?(0,pt.q)(Lt):(0,ft._)(Lt)},billing:()=>(0,ot.J)(Lt),subscription:()=>(0,ht.t)(Lt),security:()=>(0,gt.I)(Lt),identity_provisioning:()=>(0,rt.o)(Lt),admin_content_search:()=>(0,tt.p)(Lt),integrations:()=>(0,lt.L)(Lt),experiments:()=>(0,St.t)(Lt),audit_log:()=>(0,nt.N)(Lt),debug_zone:()=>(0,vt.w)(Lt),analytics:()=>(0,d.v)(Lt),imports:()=>(0,st.l)(Lt),sites:()=>(0,yt.u)(Lt)},Et={profile:()=>`${B.default.formatMessage(Bt.accountTab)}`,notifications_and_settings:()=>B.default.formatMessage(Bt.notificationsAndSettings),user_settings:()=>B.default.formatMessage(Bt.mySettings),notifications:()=>B.default.formatMessage(Bt.myNotifications),connected_apps:()=>B.default.formatMessage(Bt.userConnectionsTab),language_and_region:()=>B.default.formatMessage(Bt.languageAndRegionTab),settings:()=>B.default.formatMessage(Bt.settingsTab),teams:()=>B.default.formatMessage(Bt.teamsTab),members:e=>(0,de.F$)()||(0,de.wE)(e)?B.default.formatMessage(Bt.peopleTab):B.default.formatMessage(Bt.membersTab),plans:()=>{const e=wt.subscriptionDataStoreInstance.state;return e&&Mt.YK(e)?B.default.formatMessage(Bt.plansTab):B.default.formatMessage(Bt.upgradeTab)},billing:()=>B.default.formatMessage(Bt.billingTab),subscription:()=>B.default.formatMessage(Bt.subscriptionTab),security:()=>B.default.formatMessage(Bt.securityTab),identity_provisioning:()=>B.default.formatMessage(Bt.identityProvisioningTab),admin_content_search:()=>B.default.formatMessage(Bt.adminContentSearchTab),integrations:()=>B.default.formatMessage(Bt.spaceConnectionsTab),experiments:()=>B.default.formatMessage(Bt.experimentsTab),audit_log:()=>B.default.formatMessage(Bt.auditLogTab),debug_zone:()=>B.default.formatMessage(Bt.debugZoneTab),analytics:()=>B.default.formatMessage(Bt.analyticsTab),imports:()=>B.default.formatMessage(Bt.importTab),sites:()=>B.default.formatMessage(Bt.sitesTab)},Nt={profile:()=>null,notifications_and_settings:()=>null,user_settings:()=>null,notifications:()=>null,connected_apps:()=>null,language_and_region:()=>null,settings:()=>null,teams:()=>null,members:e=>(0,de.wE)(e)&&(0,J.jsx)(Rt,{}),plans:()=>null,billing:()=>null,subscription:()=>null,security:()=>null,identity_provisioning:()=>null,sites:()=>(0,J.jsx)(Ct.Z,{}),admin_content_search:()=>null,integrations:()=>(0,de.T2)()?ce.default.checkGate("webhooks_beta")&&jt.Rs()?(0,J.jsx)(Ct.Z,{}):null:ce.default.checkGate("webhooks_beta")?(0,J.jsx)(Ct.Z,{}):null,experiments:()=>null,audit_log:()=>null,debug_zone:()=>null,analytics:()=>null,imports:()=>null};var Vt=s(89728);const Ut=(0,h.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});const Wt=(0,h.injectIntl)((function(e){window.__c={n:"SubscriptionBillingSettingOption"};const t=(0,r.Fg)(),s={marginLeft:18,marginRight:-4,fontWeight:g.Z.fontWeight.medium},{title:n,caption:i,buttonArgs:o}=e,a=(0,J.jsx)(h.FormattedMessage,{...Ut[o.buttonPurpose]});return(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14},children:[(0,J.jsx)("div",{style:{marginRight:"auto"},children:n}),(0,J.jsx)("div",{style:{color:t.mediumTextColor},children:i}),(0,J.jsx)("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"},children:o.showButton&&(0,J.jsx)(Vt.Z,{isBlue:!0,onClick:o.onClick,style:s,children:a})})]})}));var Kt=s(34859),zt=s(88632),qt=s(93349);const Gt={workspaceBalance:(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var Ht=s(31796),Qt=s(27533),Yt=s(78780);const $t={height:"100%",padding:"36px 60px"},Jt={display:"flex",flexDirection:"column",height:"100%"};class Xt extends i.Z{constructor(){super(...arguments),this.storeTypes={store:qt.Z}}UNSAFE_willMount(){Qe.bi(this.environment),Qe.zb(this.environment,this.stores.store)}renderComponent(){const{data:e}=this.props;return zt.Z.state.online?(0,J.jsx)("div",{style:Jt,children:(0,J.jsxs)(Je.Z,{style:$t,type:Kt.Z.Y,children:[(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{...Bt.billingTab})}),(0,J.jsx)(ts,{data:e}),(0,J.jsx)(ss,{}),(0,J.jsx)(Ht.V,{spaceStore:this.props.spaceStore,events:this.stores.store.state.billingEvents,upcomingInvoiceData:void 0})]})}):Xt.renderOfflineMessage()}static renderOfflineMessage(){return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:Yt.s.offline})})}}Xt.displayName="SpaceSubscriptionBillingUnsubscribed";const es=Xt;function ts(e){var t;let{data:s}=e;const n=null===(t=s.customerData)||void 0===t?void 0:t.stripe.currencyCode;if(!n)return null;const i=-Math.min(0,s.accountBalance);return(0,J.jsx)(Wt,{title:Gt.workspaceBalance,caption:(0,J.jsx)("div",{children:(0,J.jsx)(Qt.W,{cost:{amount:i,currencyCode:n},trailingZeroDisplay:"stripIfInteger"})}),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:c.ZT}})}function ss(){return(0,J.jsx)("div",{style:{flex:"none",marginTop:30}})}var ns=s(70060),is=s(32689),os=s(40745),as=s(18174),rs=s(89024),ls=s(7124),ds=s(64251),cs=s(88269),us=s(96935);var ms=s(22387),ps=s(33493),gs=s(53578),hs=s(42165),fs=s(96130),xs=s(97710),ys=s(29170),Ss=s(56896);function vs(e){let{availability:t}=e;window.__c={n:"AICard"};const s=(0,r.yK)((e=>({innerCard:{flex:"1 0 0",maxWidth:360,background:e.surface.wash,borderRadius:8,padding:"14px 16px"},innerCardCta:{display:"flex",justifyContent:"center",alignItems:"center",fontSize:13,fontWeight:510,lineHeight:16,color:e.text.uiBluePrimary,height:28,padding:"0px 8px",borderRadius:4,background:e.tint.uiBlue},innerCardCtaHovered:{background:e.tint.uiBlueHover},innerCardCtaPressed:{background:e.tint.uiBluePressed},aiIcon:{width:13,height:12}})),[]),n=(0,h.useIntl)();return(0,J.jsx)("div",{style:s.innerCard,children:(0,J.jsxs)(rs.jX,{gap:6,direction:"row",align:"center",children:[(0,J.jsxs)(rs.jX,{gap:6,children:[(0,J.jsxs)(rs.jX,{direction:"row",align:"center-left",gap:2,children:[(0,J.jsx)(ls.q,{styleName:"Body-14px/Semibold",children:n.formatMessage(gs.oy.heading)}),(0,St.t)(s.aiIcon)]}),(0,J.jsx)(ls.q,{styleName:"Caption-12px/Regular",colorName:"secondary",children:n.formatMessage(gs.oy.description)})]}),"limited"===t.type?(0,J.jsx)(ae.Z,{style:s.innerCardCta,hoveredStyle:s.innerCardCtaHovered,pressedStyle:s.innerCardCtaPressed,onClick:t.onClickAddAI,children:n.formatMessage(gs.oy.ctaMessage)}):null]})})}function bs(e){let{product:t,aiAvailability:s,asyncPrice:n}=e;window.__c={n:"ActivePlan"};const i=(0,r.yK)((e=>({card:{borderRadius:12,border:`1px solid ${e.stroke.deemphasized}`,background:e.surface.elevated,padding:"18px 20px",boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, 0.04)",backdropFilter:"blur(20px)"}})),[]),o=(0,h.useIntl)(),l=(0,a.VK)((()=>ps.Z.selectedCurrencyCode),[]),d=(0,Ss.F)({asyncPrice:n})||{amount:0,currencyCode:l};if("free"!==t)return null;const c=gs.i$[t];return(0,J.jsxs)(rs.jX,{gap:20,children:[(0,J.jsx)(ys.M,{title:o.formatMessage(gs.j2.activePlan)}),(0,J.jsxs)(rs.jX,{gap:28,style:i.card,direction:"row",children:[(0,J.jsxs)(rs.jX,{gap:6,children:[(0,J.jsx)(ls.q,{styleName:"Title-22px/Semibold",children:o.formatMessage(c.label)}),(0,J.jsx)(ls.q,{styleName:"Body-14px/Regular",children:o.formatMessage(c.description)}),(0,J.jsx)(ls.q,{styleName:"iOS/Caption-12px/Regular",colorName:"secondary",children:o.formatMessage(c.price,{money:(0,J.jsx)(Qt.W,{cost:d,trailingZeroDisplay:"stripIfInteger"})})})]}),s?(0,J.jsx)(vs,{availability:s}):null]})]})}var Ms=s(61519),js=s(42402),ws=s(63296),Cs=s(859);function ks(){window.__c={n:"EducationPlanInfo"};const e=(0,r.yK)((()=>({inline:{display:"inline"}})),[]),t=(0,o.O7)(),s=(0,Cs.r)();return(0,J.jsxs)(rs.jX,{gap:8,direction:"column",children:[(0,J.jsx)(ys.M,{title:(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.title",defaultMessage:"Students & educators"}),description:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.description",defaultMessage:"<p>Students and educators can get access to the Plus Plan features (with a 1-member limit) for free! Just sign up with your school email address, or change your existing email in the 'My account' tab.</p>",values:{p:t=>(0,J.jsxs)("span",{style:e.inline,children:[t," "]})}}),(0,J.jsx)(js.Z,{external:!0,href:(0,Ze.UY)("guides.students"),children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionPlans.studentSection.link",defaultMessage:"For more info, go to notion.com/students."})})]})}),(0,J.jsx)("div",{style:e.inline,children:(0,J.jsx)(ws.Z,{onClick:()=>{s&&(0,Qe.r7)({environment:t,spaceStore:s})},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Get the Education Plan",id:"sidebarStudentPlanPrompt.eligible.getFreePromptPlus"})})})]})}function Ts(e){let{showEducationPlan:t}=e;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Ms.Z,{size:0}),t&&(0,J.jsx)(ks,{}),(0,J.jsx)(ys.M,{title:(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.title",defaultMessage:"FAQ"}),description:(0,J.jsx)(js.Z,{external:!0,href:(0,Ze.UY)("guides.billingAndPaymentRevised"),children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.link",defaultMessage:"Plans, Billing & Payment"})})})]})}function Is(){window.__c={n:"Plans"};const e=(0,o.O7)();(0,n.useEffect)((()=>{Qe.bi(e),Qe.px(e)}),[e]);const t=(0,n.useMemo)((()=>new ds.Z),[]);return(0,a.VK)((()=>zt.Z.state.online),[])?(0,J.jsx)(Ps,{spaceSubscriptionPlansStore:t,subscriptionDataStore:wt.subscriptionDataStoreInstance}):(0,J.jsx)(xs.L,{})}function Ps(e){let{subscriptionDataStore:t,spaceSubscriptionPlansStore:s}=e;window.__c={n:"PlansContent"};const n=(0,r.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",padding:"34px 48px",alignItems:"flex-start",gap:56},compareAllIcon:{width:13,color:e.icon.secondary},compareAllWrapper:{display:"flex",paddingTop:20,justifyContent:"center",alignSelf:"stretch",alignItems:"center"}})),[]),i=(0,h.useIntl)(),o=(0,a.VK)((()=>(0,jt.zt)()),[]),l=(0,as.KE)(o),d=(0,cs.T)(t),c=as.$3.filter((e=>e!==o)),u=(0,fs.O)({billingInterval:d,priceStore:ps.Z,products:c}),m=(0,us.e)(t),p=(0,ms.r)(t),g=m&&!p,f=function(e){return(0,a.VK)((()=>{const t=e.state;if(!t)return!1;const s=(0,jt.zt)(),n=Mt.Nf({subscriptionData:t,spaceStore:_e.default.state.currentSpaceStore}),i=Mt.wl(t),o=Mt.su(t);return n&&!i&&1===o&&("free"===s||"personal"===s)}),[e])}(t),x=(0,hs.H)({billingInterval:d,canClick:g,subscriptionDataStore:t,source:"plans_top_section"});return x?(0,J.jsxs)("div",{style:n.wrapper,children:[(0,J.jsx)(bs,{product:l,asyncPrice:u[l],aiAvailability:x}),(0,J.jsx)("div",{style:n.compareAllWrapper,children:(0,J.jsx)(Vt.Z,{onClick:()=>{},children:(0,J.jsxs)(rs.jX,{direction:"row",gap:4,align:"center",children:[(0,J.jsx)(ls.q,{styleName:"Body-14px/Medium",colorName:"primary",children:i.formatMessage(gs.re.label)}),(0,os.M)(n.compareAllIcon)]})})}),(0,J.jsx)(Ts,{showEducationPlan:f})]}):null}var Zs=s(5220),Fs=s(97880),_s=s(60396);class As extends N.default{getInitialState(){return{loadingState:"uninitialized"}}}const Rs=new As;async function Ds(e){let{environment:t,messageStoreEmitValue:s}=e;if(!function(e){const t=Rs.state;if("loading"===t.loadingState)return!1;if(("uninitialized"===t.loadingState?void 0:t.messageStoreEmitValue)===e)return!1;return!0}(s))return!1;const{currentSpaceStore:n,currentUserStore:i}=_e.default.state;if(!n||!i)return!1;"uninitialized"===Rs.state.loadingState&&Rs.setState({loadingState:"loading"});const o=await async function(e){let{environment:t,currentSpaceStore:s,currentUserStore:n}=e;const i=s.getModel();if(!i)return;if((0,Zs.Hx)({userId:n.id,spaceModel:i})){return await(0,Fe.sj)({environment:t,spaceStore:s,includeArchived:!0,currentUserId:n.id,minRoleOnTeamStores:"reader"})}return await(0,Fe.qX)({environment:t,spaceStore:s,includeArchived:!0,currentUserId:n.id})}({environment:t,currentSpaceStore:n,currentUserStore:i});if(!(0,Fs.$K)(o))return Rs.setState({loadingState:"uninitialized"}),!1;const{archivedTeams:a,unarchivedTeams:r}=(0,Fe.tV)(o);return Rs.setState({loadingState:"loaded",archivedTeamIds:a.map((e=>e.id)),unarchivedTeamIds:r.map((e=>e.id)),messageStoreEmitValue:s}),!0}var Bs=s(61652);function Ls(e){let{spaceId:t,filters:s,disabled:i}=e;window.__c={n:"AdminContentSearchExportButton"};const[a,l]=(0,n.useState)(!1),d=(0,o.O7)(),c=i||a,u=(0,r.yK)((e=>({button:{opacity:c?.5:1}})),[c]);return(0,J.jsx)(ws.Z,{style:u.button,disabled:c,onClick:async function(){l(!0),y.j_p(d,{filters:s}),await Bs.gJ(d,{spaceId:t,filters:s}),l(!1)},children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.export",defaultMessage:"Export results"})})}var Os=s(98165),Es=s(68785),Ns=s(71291),Vs=s(44678),Us=s(44495),Ws=s(42922);function Ks(e){window.__c={n:"AdminContentSearchAcknowledgement"};const t=(0,o.O7)(),s=(0,r.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:36,height:36,color:e.lightTextColor,fill:"currentColor"},disclaimerTitle:{margin:"12px auto",fontWeight:g.Z.fontWeight.medium,fontSize:16},disclaimer:{fontWeight:g.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:432,margin:"0 auto 16px"},acknowledgeButton:{width:195,margin:"8px auto 0"},learnMoreButton:{width:195,margin:"8px auto 0",justifyContent:"center",color:e.lightTextColor},learnMoreButtonIcon:{width:12,height:12,marginRight:4}})),[]),i=(0,n.useCallback)((()=>{y.vN5(t),T.NY(t)}),[t]);return(0,J.jsxs)("div",{style:s.container,children:[(0,l.Q)(s.headerIcon),(0,J.jsx)("h1",{style:s.disclaimerTitle,children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimerTitle",defaultMessage:"Before using this feature"})}),(0,J.jsx)("p",{style:s.disclaimer,children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimer",defaultMessage:"As a workspace owner, you can use content search to find pages that you don't have access to, including the private pages of other workspace members. Consult with your organization's legal department on how to use this feature. Actions taken here will be recorded in the audit log."})}),(0,J.jsx)(Ws.Z,{style:s.acknowledgeButton,onClick:i,children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.confirm",defaultMessage:"Acknowledge"})}),(0,J.jsxs)(Vt.Z,{style:s.learnMoreButton,onClick:()=>{const e=(0,Ze.UY)("adminContentSearch");M.D({environment:t,url:e})},children:[(0,Us.D)(s.learnMoreButtonIcon),(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.learnMore",defaultMessage:"Learn more"})]})]})}var zs=s(73075),qs=s(80721),Gs=s(26774),Hs=s(87279),Qs=s(29798),Ys=s(33338),$s=s(52275),Js=s(60458),Xs=s(78140),en=s(32163),tn=s(53437),sn=s(72495),nn=s(91642);function on(e){let{selectedAudience:t,setSelectedAudience:s,onMenuClose:i,setPillTitleToActiveSelection:o}=e;window.__c={n:"AudienceFilter"};const l=(0,a.qz)(void 0,Qs.Z),d=(0,r.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8}})),[]),[c,u]=(0,n.useState)(!1),m=["private","shared_internally","shared_externally","shared_to_web"];function p(){u(!1),i&&i()}function g(){s&&s([])}function f(e){const n=t.includes(e)?[...t.filter((t=>t!==e))]:[...t,e];s&&s(n)}const x=(0,J.jsx)(Ys.Z,{on:t.length>0,icon:(0,Gs.O)(d.icon),title:o&&t[0]?an(t[0]):(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.title",defaultMessage:"Audience"}),onClick:()=>u(!0),disabled:!s,hideChevron:!s});return s?(0,J.jsx)(nn.Z,{children:(0,J.jsx)(tn.ZP,{popupType:tn.ZP.PopupType.Popup,placementToOrigin:tn.ZP.Placement.Bottom,alignmentToOrigin:tn.ZP.Alignment.Start,open:c,render:function(){const e={key:"teamOptions",items:m.map((e=>({key:e,action:()=>f(e),render:s=>(0,J.jsx)($s.Z,{...s,icon:(0,J.jsx)(Js.Z,{checked:t.includes(e),onClick:()=>f(e),size:16}),focused:!1,title:an(e),caption:rn(e),shouldWrapCaption:!0})}))),render:e=>(0,J.jsx)(sn.Z,{...e,title:null,loading:!1})};return(0,J.jsxs)("div",{style:d.container,children:[(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,header:null,maxHeight:250,width:300,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,store:l,initialFocus:0,sections:[e]})}),(0,J.jsxs)(sn.Z,{topBorder:!0,style:d.footer,children:[(0,J.jsx)(Vt.Z,{onClick:g,children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.clearButton",defaultMessage:"Clear"})}),(0,J.jsx)(Ws.Z,{onClick:p,children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.doneButton",defaultMessage:"Done"})})]})]})},onDismiss:p,keepFocus:!0,origin:x,preventScaleTransition:!0})}):x}function an(e){switch(e){case"private":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.private",defaultMessage:"Private"});case"shared_externally":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.external",defaultMessage:"Shared externally"});case"shared_internally":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.internal",defaultMessage:"Shared internally"});case"shared_to_web":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.publishedToWeb",defaultMessage:"Shared to web"});default:(0,Fs.t1)(e)}}function rn(e){switch(e){case"private":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.private",defaultMessage:"Pages that only a single workspace member has access to."});case"shared_externally":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.external",defaultMessage:"Pages that are shared with guests or connections."});case"shared_internally":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.internal",defaultMessage:"Pages that are shared with other workspace members."});case"shared_to_web":return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.publishedToWeb",defaultMessage:"Pages that are available for anyone to see on the web."});default:(0,Fs.t1)(e)}}function ln(e){let{filters:t,setFilters:s}=e;window.__c={n:"AdminContentSearchSuggestions"};const n=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},title:{margin:"12px auto",fontWeight:g.Z.fontWeight.medium,fontSize:16},description:{fontWeight:g.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:386,margin:"0 auto 16px"},suggestion:{position:"relative",height:38,width:440,margin:"12px auto 0",justifyContent:"center",color:e.darkTextColor,boxShadow:e.borderBoxShadow},filterContainer:{margin:"0 8px",display:"flex",alignItems:"center",justifyContent:"center"},arrowIconContainer:{position:"absolute",right:12,transform:"rotate(180deg)"},arrowIcon:{width:18,height:18,opacity:.5,color:e.lightTextColor,fill:"currentColor"}})),[]);return(0,J.jsxs)("div",{style:n.container,children:[(0,J.jsx)("h1",{style:n.title,children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.title",defaultMessage:"Search pages in your workspace"})}),(0,J.jsx)("p",{style:n.description,children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.description",defaultMessage:"Use filters to find pages with specific sharing and permissions settings, such as:"})}),(0,J.jsxs)(Vt.Z,{style:n.suggestion,onClick:function(){s({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_externally"],teamIds:[]},{runSearchAfter:!0})},children:[(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>(0,J.jsx)("div",{style:n.filterContainer,children:(0,J.jsx)(on,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_externally"]})})}}),(0,J.jsx)("div",{style:n.arrowIconContainer,children:(0,qs.W)(n.arrowIcon)})]}),(0,J.jsxs)(Vt.Z,{style:n.suggestion,onClick:function(){s({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_to_web"],teamIds:[]},{runSearchAfter:!0})},children:[(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>(0,J.jsx)("div",{style:n.filterContainer,children:(0,J.jsx)(on,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_to_web"]})})}}),(0,J.jsx)("div",{style:n.arrowIconContainer,children:(0,qs.W)(n.arrowIcon)})]})]})}var dn=s(53855),cn=s(34690),un=s(15145),mn=s(56666),pn=s(27714),gn=s(84210),hn=s(28578),fn=s(61766),xn=s(55899),yn=s(8675),Sn=s(31945),vn=s(73063);function bn(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const s=(0,o.O7)(),i=(0,a.qz)(void 0,fn.Z),l=(0,a.qz)(void 0,yn.Z),d=(0,a.qz)(void 0,xn.ZP),c=(0,r.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"}})),[]),[u,m]=(0,n.useState)(!1);(0,n.useEffect)((()=>{l.setState({...l.state,privatePageStore:t,changePermissionsEnabled:!0,loading:!1,error:void 0})}),[t,l]);const p={key:"actions",render:e=>(0,J.jsx)(sn.Z,{...e}),items:[{key:"change-permissions",render:e=>(0,J.jsx)($s.Z,{...e,icon:(0,gt.I)(c.changePermissionsIcon),title:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.changePermissions",defaultMessage:"Change permissions"})}),action:function(){m(!0)}},{key:"copy-link",render:e=>(0,J.jsx)($s.Z,{...e,icon:(0,pn.N)(c.copyLinkIcon),title:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})}),action:async function(){const e=(0,gn.ZP)({store:t,pageVisitSource:un.tY.CopyLink});await ie.RD({environment:s,stringValue:e,copiedMessage:ie.tq.copiedLinkToClipboard}),i.setState({open:!1})}}]};return(0,J.jsx)(Sn.ZP,{popupType:tn.kQ.Popup,alignmentToOrigin:tn.ZP.Alignment.Center,placementToOrigin:tn.ZP.Placement.Right,style:{width:u?450:248},render:()=>u?(0,J.jsx)(L.LazyShareMenuContainer,{store:t,sudoModeStore:l,inviteTargetsStore:d,location:"admin_content_search"}):(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,width:248,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[p]})}),onClose:()=>{m(!1),hn.ZP.reset()},buttonPopupStore:i,renderOrigin:e=>(0,J.jsx)(vn.Z,{icon:mn.o,...e})})}s(57658);var Mn=s(53695),jn=s(36596),wn=s(28992),Cn=s(70301);function kn(e){let{botId:t}=e;window.__c={n:"BotMenuItem"};const s=(0,h.useIntl)(),n=(0,o.O7)(),i=(0,a.VK)((()=>me.t1.createUniqueRootStore(n,{table:A.cZ,id:t})),[t,n]),l=(0,a.VK)((()=>i.getDisplayName(s)),[i,s]),d=(0,a.VK)((()=>i.getParentStore()),[i]),c=(0,a.VK)((()=>{if(d){if(d instanceof me.U6)return d.getDisplayName(s);if(d instanceof me.H2)return d.getName()}}),[d,s]),u=(0,r.yK)((()=>({desktopIconStyle:{alignSelf:"center",width:24,fontSize:18}})),[]);return l?(0,J.jsx)(wn.Z,{desktopIconStyle:u.desktopIconStyle,icon:(0,J.jsx)(Cn.Z,{botStore:i,size:24}),title:l,caption:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.botMenuItem.createdBy",defaultMessage:"Created by {creatorName}",values:{creatorName:c}})}):(0,J.jsx)(Tn,{})}function Tn(){window.__c={n:"ShimmerLoader"};const e=(0,r.yK)((e=>({container:{userSelect:"none",minHeight:45,fontSize:14,padding:"4px 8px",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},textContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",gap:6},icon:{flexGrow:0,flexShrink:0,width:24,height:24,borderRadius:"0.25em",marginRight:4,marginTop:1},title:{flexGrow:0,flexShrink:0,width:80,height:14,borderRadius:"0.25em",marginLeft:4},byline:{flexGrow:0,flexShrink:0,width:150,height:10,borderRadius:"0.25em",marginLeft:4}})),[]);return(0,J.jsxs)("div",{style:e.container,children:[(0,J.jsx)(jn.Z,{style:e.icon}),(0,J.jsxs)("div",{style:e.textContainer,children:[(0,J.jsx)(jn.Z,{emphasized:!1,style:e.title}),(0,J.jsx)(jn.Z,{emphasized:!1,style:e.byline})]})]})}var In=s(31278);const Pn=(0,h.defineMessages)({editor:{id:"adminContentSearchTab.sharedWith.permissions.editor",defaultMessage:"Full access"},readAndWrite:{id:"adminContentSearchTab.sharedWith.permissions.readAndWrite",defaultMessage:"Can edit"},commentOnly:{id:"adminContentSearchTab.sharedWith.permissions.commentOnly",defaultMessage:"Can comment"},reader:{id:"adminContentSearchTab.sharedWith.permissions.reader",defaultMessage:"Can view"},none:{id:"adminContentSearchTab.sharedWith.permissions.none",defaultMessage:"None"}});function Zn(e,t){switch(t){case"editor":return e.formatMessage(Pn.editor);case"read_and_write":return e.formatMessage(Pn.readAndWrite);case"comment_only":return e.formatMessage(Pn.commentOnly);case"reader":return e.formatMessage(Pn.reader);case"none":return e.formatMessage(Pn.none)}}function Fn(e){let{name:t,icon:s,role:n}=e;window.__c={n:"GroupMenuItem"};const i=(0,h.useIntl)(),o=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),l=Zn(i,n),d=(0,r.yK)((e=>({defaultIcon:{height:18,width:18,color:e.lightTextColor,fill:"currentColor"},defaultGroupIcon:{height:20,width:20,color:e.lightTextColor,fill:"currentColor"}})),[]);return(0,J.jsx)(wn.Z,{desktopIconStyle:{alignSelf:"center",width:24,fontSize:18},icon:(0,J.jsx)(In.Z,{disabled:!0,icon:s&&o?{pointer:o.pointer,icon:s}:void 0,size:20,isEmptyPage:!1,title:t,defaultIcon:(0,Gs.O)(d.defaultGroupIcon)}),title:t||(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.untitledPage",defaultMessage:"Untitled{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}}),caption:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.group",defaultMessage:"Group{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}})})}var _n=s(72141),An=s(74016);function Rn(e){let{permissionItem:t}=e;window.__c={n:"SpaceMenuItem"};const s=(0,h.useIntl)(),n=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),i=(0,a.VK)((()=>{var e;return null===(e=_e.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),o=null==t?void 0:t.role,r=(0,_n.iC)(o)?Zn(s,o):void 0;return(0,J.jsx)(wn.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:n?(0,J.jsx)(An.p,{disabled:!0,store:n,size:24}):void 0,title:i,caption:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.spaceMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:r?` · ${r}`:""}})})}var Dn=s(91192),Bn=s(29369);function Ln(e){let{teamId:t,role:s,onlyOwners:n}=e;window.__c={n:"TeamMenuItem"};const i=(0,o.O7)(),r=(0,h.useIntl)(),l=(0,a.VK)((()=>new me.zX(i,{table:Bn.e0,id:t})),[i,t]),d=Zn(r,s),c=(0,a.VK)((()=>l.getName()),[l]),u=c||(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.unknownTeamName",defaultMessage:"Private teamspace"});return(0,J.jsx)(wn.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:c?(0,J.jsx)(An.p,{disabled:!0,store:l,size:24}):(0,Dn.x)(),title:u,caption:n?(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamOwners",defaultMessage:"Owners{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}}):(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}})})}var On=s(64684),En=s(67669);var Nn=s(7928),Vn=s(45653);function Un(e){let{userId:t,role:s,isGuest:n}=e;window.__c={n:"UserMenuItem"};const i=(0,h.useIntl)(),r=(0,o.O7)(),{userStore:l,userName:d}=(0,a.VK)((()=>{const e=new me.U6(r,{table:R.KJ,id:t}),s=(0,Nn.Nz)(i,e.getModel());return{userStore:e,userName:s}}),[r,t,i]),c=Zn(i,s);return(0,J.jsx)(wn.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:(0,J.jsx)(Vn.Z,{userStore:l,size:24}),title:d,caption:n?(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.guest",defaultMessage:"Guest{maybeRoleString}",values:{maybeRoleString:c?` · ${c}`:""}}):(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.member",defaultMessage:"Member{maybeRoleString}",values:{maybeRoleString:c?` · ${c}`:""}})})}const Wn=(0,h.defineMessages)({sharedWithWorkspaceMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWorkspaceMembers",defaultMessage:"Workspace members"},sharedWithTeamOwners:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamOwners",defaultMessage:"Teamspace owners"},sharedWithTeamMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamMembers",defaultMessage:"Teamspace members"},sharedWithMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithMembers",defaultMessage:"{numMembers, plural, one {# member} other {# members}}"},sharedWithGroups:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGroups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},sharedWithGuests:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGuests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}"},sharedWithBots:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithBots",defaultMessage:"{numBots, plural, one {# connection} other {# connections}}"},separator:{defaultMessage:", ",id:"adminContentSearchTab.pagesTable.sharedWithCell.separator"}});function Kn(e){let{blockStore:t}=e;window.__c={n:"SharedWithCellImpl"};const s=function(e){return(0,a.VK)((()=>{const t=wt.subscriptionDataStoreInstance.state,s=t?(0,Mt.CM)(t):[],n=_e.default.state.currentSpaceStore,i=(0,En.YO)(e),o=(null==n?void 0:n.getPermissionGroups())||[],a=(0,Os.VP)(e),r=i.find((e=>{let{permissionItem:t}=e;return _n.$D(t)})),l=i.find((e=>{let{permissionItem:t}=e;return _n.ix(t)})),d=a?i.find((e=>{let{permissionItem:t}=e;return(0,On.J2)(t,a.id)})):void 0,c=i.map((e=>{let{permissionItem:t}=e;return t})).filter(_n.zU),u=i.map((e=>{let{permissionItem:t}=e;return t})).filter(_n.LW),m=i.map((e=>{let{permissionItem:t}=e;return t})).filter(_n.hV).reduce(((e,t)=>{const s=t.group_id,n=t.role,i=o.find((e=>e.id===s));if(i){const t={...i,role:n};e.push(t)}return e}),[]),[p,g]=i.map((e=>{let{permissionItem:t}=e;return t})).filter(_n.jg).reduce(((e,t)=>{const n=s.find((e=>e.userId===t.user_id));return Boolean(n&&!_n.zz(n.role)&&!_n.J5(n.role))?[e[0].concat(t),e[1]]:[e[0],e[1].concat(t)]}),[[],[]]);return{groupPermissions:m,mostPermissivePublicItem:r,spacePermission:l,teamPermission:d,teamSharePermissions:c,teamOwnerSharePermissions:u,guestUserPermissions:p,memberUserPermissions:g,botPermissions:i.map((e=>{let{permissionItem:t}=e;return t})).filter((e=>(0,_n.FB)(e)))}}),[e])}(t),n=(0,h.useIntl)(),i=function(e,t){const{mostPermissivePublicItem:s,spacePermission:n,groupPermissions:i,guestUserPermissions:o,memberUserPermissions:a,teamSharePermissions:r,teamOwnerSharePermissions:l,botPermissions:d}=e,c=n&&"none"!==n.permissionItem.role;if(s&&"none"!==s.permissionItem.role)return(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWeb",defaultMessage:"Shared to web"});if(!c&&0===i.length&&0===o.length&&0===a.length&&0===r.length&&0===l.length&&0===d.length)return(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage",defaultMessage:"Nobody"}),(0,J.jsx)(re.ZP,{render:e=>(0,J.jsx)("div",{...e,children:(0,Us.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage.tooltip",defaultMessage:"No person, group, or teamspace has any access to this page."})})]});const u=[];c?u.push(t.formatMessage(Wn.sharedWithWorkspaceMembers)):(l.length>0&&0===r.length?u.push(t.formatMessage(Wn.sharedWithTeamOwners)):r.length>0&&u.push(t.formatMessage(Wn.sharedWithTeamMembers)),a.length>0&&u.push(t.formatMessage(Wn.sharedWithMembers,{numMembers:a.length})),i.length>0&&u.push(t.formatMessage(Wn.sharedWithGroups,{numGroups:i.length})));o.length>0&&u.push(t.formatMessage(Wn.sharedWithGuests,{numGuests:o.length}));d.length>0&&u.push(t.formatMessage(Wn.sharedWithBots,{numBots:d.length}));return u.join(t.formatMessage(Wn.separator))}(s,n),o=[...s.spacePermission?[{key:"space-permission",render:e=>{var t;return(0,J.jsx)(Rn,{...e,permissionItem:null===(t=s.spacePermission)||void 0===t?void 0:t.permissionItem})},action:()=>{}}]:[],...s.teamOwnerSharePermissions.map((e=>({key:`${e.team_id}-owners`,render:t=>(0,J.jsx)(Ln,{...t,onlyOwners:!0,teamId:e.team_id,role:e.role}),action:()=>{}}))),...s.teamSharePermissions.map((e=>({key:`${e.team_id}-members`,render:t=>(0,J.jsx)(Ln,{...t,teamId:e.team_id,role:e.role}),action:()=>{}}))),...s.groupPermissions.map((e=>({key:e.id,render:t=>(0,J.jsx)(Fn,{...t,name:e.name,icon:e.icon,role:e.role}),action:()=>{}}))),...s.memberUserPermissions.map((e=>({key:e.user_id,render:t=>(0,J.jsx)(Un,{...t,userId:e.user_id,role:e.role}),action:()=>{}}))),...s.guestUserPermissions.map((e=>({key:e.user_id,render:t=>(0,J.jsx)(Un,{...t,isGuest:!0,userId:e.user_id,role:e.role}),action:()=>{}}))),...s.botPermissions.map((e=>({key:e.bot_id,render:t=>(0,J.jsx)(kn,{...t,botId:e.bot_id}),action:()=>{}})))];return(0,J.jsx)(Mn.N,{title:i,items:o,disabled:0===o.length})}const zn=n.memo(Kn);var qn=s(77883);const Gn={id:"page",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.name",defaultMessage:"Page"}),renderCell:e=>(0,J.jsx)(Vs.o,{blockStore:e.pageStore,rightIcon:(0,J.jsx)(bn,{blockStore:e.pageStore})}),widthData:{width:320,maxWidth:320},sortable:!1},Hn={id:"location",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.location.name",defaultMessage:"Location"}),renderCell:e=>(0,J.jsx)(cn.N,{blockStore:e.pageStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},Qn={id:"createdTime",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdTime.name",defaultMessage:"Created on"}),renderCell:e=>(0,J.jsx)(Ns.T,{dateTs:e.createdTime}),widthData:{width:140},sortable:!1},Yn={id:"lastEditedTime",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedTime.name",defaultMessage:"Last edited on"}),renderCell:e=>(0,J.jsx)(Ns.T,{dateTs:e.lastEditedTime}),widthData:{width:140},sortable:!1},$n={id:"createdBy",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdBy.name",defaultMessage:"Created by"}),renderCell:e=>e.createdById?(0,J.jsx)(qn.t,{blockStore:e.pageStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},Jn={id:"lastEditedBy",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedBy.name",defaultMessage:"Last edited by"}),renderCell:e=>e.lastEditedById?(0,J.jsx)(qn.t,{blockStore:e.pageStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},Xn=[Gn,Hn,{id:"audience",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audience.name",defaultMessage:"Audience"}),renderCell:e=>(0,J.jsx)(dn.A,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},{id:"sharedWith",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWith.name",defaultMessage:"Shared with"}),renderCell:e=>(0,J.jsx)(zn,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},Jn,Yn,$n,Qn];function ei(e){let{loading:t,error:s,loadNextPage:n,filters:i,setFilters:o,pageStores:l,showSuggestions:d,runNewSearch:c,hasUserConfirmedAcknowledgement:u}=e;window.__c={n:"AdminContentSearchTable"};const m=u&&!t&&!d,p=u&&!d,g=(0,a.VK)((()=>l.map((e=>({id:e.id,isClickable:!1,pageStore:e,teamStore:(0,Os.VP)(e),createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById()})))),[l]),f=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:Xn,theme:e,containerMarginTop:0})),[]);return s?(0,J.jsx)(zs.q,{runNewSearch:c,error:s}):u?d&&0===g.length?(0,J.jsx)(ln,{filters:i,setFilters:o}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(oe.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:400,columnRenderInfo:Xn,rows:g,onLoadMore:p?n:void 0,renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:m&&(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.empty",defaultMessage:"No pages found with your query."})}),styles:f}),t?(0,J.jsx)(Es.Z,{style:{margin:"24px auto 24px"}}):null]}):(0,J.jsx)(Ks,{})}var ti=s(21697),si=s(36550),ni=s(79782),ii=s(66994),oi=s(89665),ai=s(57702);function ri(e){let{spaceStore:t,sharedWithFilterItems:s,setSharedWithFilter:i,runNewSearch:o,includeGroups:a,includeGuests:r}=e;window.__c={n:"SharedWithFilter"};const l=(0,oi.R)({spaceStore:t}),d=(0,n.useMemo)((()=>l.loading?[]:r?[...l.members,...l.guests]:l.members),[l,r]),c=(0,n.useMemo)((()=>l.loading?new Set:new Set(l.guests.map((e=>e.id)))),[l]);return(0,J.jsx)(ai.B,{isMultiSelect:!0,includePermissionGroups:a,userStores:d,title:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.sharedWith.title",defaultMessage:"Shared with"}),selectedItems:s??[],setSelectedItems:function(e){const t=e.map((e=>{let{id:t,type:s}=e;return{type:s,id:t}}));i(t.length>0?t:void 0)},onMenuClose:o,guestUserIdSet:c})}var li=s(35389);function di(e){let{spaceStore:t,filters:s,runNewSearch:n,setFilters:i,hasUserConfirmedAcknowledgement:o}=e;window.__c={n:"FiltersSection"};const a=(0,ti.x)(),l=(0,r.yK)((e=>({container:{margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItemsCenter:"center"}})),[]);return(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsx)(ii.O,{mode:ii.p.Button,query:s.query,setQueryFilter:function(e){i({query:e},{runSearchAfter:!0})},disabled:!o}),o?(0,J.jsxs)("div",{style:l.filterPillsContainer,children:[(0,J.jsx)(ni.f,{lastEditedTime:s.lastEditedTime,createdTime:s.createdTime,setLastEditedTime:function(e){i({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){i({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}}),(0,J.jsx)(li.p,{selectedTeamIds:s.teamIds,setSelectedTeamIds:function(e){i({teamIds:e})},onMenuClose:n,teamStores:a}),(0,J.jsx)(ri,{spaceStore:t,sharedWithFilterItems:s.sharedWith,setSharedWithFilter:function(e){i({sharedWith:e})},runNewSearch:n,includeGroups:!0,includeGuests:!0}),(0,J.jsx)(on,{selectedAudience:s.audience,setSelectedAudience:function(e){i({audience:e})},onMenuClose:n}),(0,J.jsx)(si.y,{spaceStore:t,createdByFilterIds:s.createdBy,setCreatedByFilter:function(e){i({createdBy:e})},runNewSearch:n,includeGuests:!0})]}):null]})}var ci=s(26263),ui=s(65958),mi=s(7406),pi=s(59753),gi=s(45953),hi=s(21202),fi=s(66504),xi=s(27617);const yi={query:"",createdBy:[],sharedWith:void 0,audience:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},Si={...yi,audience:["shared_externally","shared_internally","shared_to_web"]},vi={filters:yi,pageStores:[],numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0,shouldReRunSearch:!1,showSuggestions:!0},bi={...vi,filters:Si};function Mi(e){let{spaceStore:t,userStore:s,hasUserConfirmedAcknowledgement:i}=e;const r=(0,a.VK)((()=>ce.default.checkGate("enabled_bev_default_audience_filter")),[])?bi:vi,l=(0,o.O7)(),[d,u]=(0,n.useState)(r),m=(0,n.useRef)(r.filters),p=(0,n.useCallback)((async e=>{let{restartSearch:n,ignoreFilterComparison:o}=e;if(!i)return;if(!o&&c.Xy(d.filters,m.current))return;m.current=d.filters;let a=d.loading,r=d.error,p=d.hasNextPage,g=d.numPagesLoaded,h=d.paginationToken;if(n&&(u((e=>({...vi,showSuggestions:e.showSuggestions,filters:e.filters}))),a=vi.loading,r=vi.error,p=vi.hasNextPage,g=vi.numPagesLoaded,h=vi.paginationToken),p&&!a&&!r){u((e=>({...e,showSuggestions:!1,loading:!0})));try{const e=await C.adminContentSearch(l,{spaceId:t.id,sort:{field:"relevance",direction:"desc"},limit:20,paginationToken:h,query:d.filters.query,audience:d.filters.audience,lastEditedTime:(0,xi.Hq)(d.filters.lastEditedTime),createdTime:(0,xi.Hq)(d.filters.createdTime),createdBy:d.filters.createdBy,sharedWith:d.filters.sharedWith,teamspaceIds:d.filters.teamIds});if("failed"===e.type)throw e.error;y.jdc(l,{filters:d.filters,pageNumber:g});const n=e.data.paginationToken,i=e.data.recordIds,o=function(e){const{recordMapWithRoleJson:t}=e,s=gi.PF.create(t),n=gi.PF.create();for(const{pointer:i,model:o}of s)if(o){const e=pi.kk.fromValue(i.table,c.Xh(o.__IM_SORRY__getValue()));n.setModelAndRole(i,e,"editor")}return n}({recordMapWithRoleJson:e.data.recordMap}),a=new ci.Z({name:ui.bv,data:new fi.o({[s.id]:o})});a.addCacheFallback(l.defaultRecordCache.inMemoryRecordCache),u((e=>{const t=[],s=new Set(e.pageStores.map((e=>e.id)));for(const n of i)if(!s.has(n)){const e=new me.G(l,{table:hi.iU,id:n},{inMemoryRecordCache:a});t.push(e)}const o=[...e.pageStores,...t];return{...e,pageStores:o,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:n,hasNextPage:Boolean(n)}}))}catch(f){const e=(0,mi.tg)(f);u((t=>({...t,loading:!1,error:e})))}}}),[l,t,s,i,d.filters,d.loading,d.error,d.hasNextPage,d.numPagesLoaded,d.paginationToken]);(0,n.useEffect)((()=>{d.shouldReRunSearch&&(u((e=>({...e,shouldReRunSearch:!1}))),p({restartSearch:!0,ignoreFilterComparison:!1}))}),[d.shouldReRunSearch,p]);const g=(0,n.useCallback)((async()=>{d.shouldReRunSearch||await p({restartSearch:!1,ignoreFilterComparison:!0})}),[d.shouldReRunSearch,p]),h=(0,n.useCallback)((async e=>{await p({restartSearch:!0,ignoreFilterComparison:e||!1})}),[p]),f=(0,n.useCallback)(((e,t)=>{y.gL0(l,{newFilters:e}),u((s=>({...s,filters:{...s.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})))}),[l]);return{showSuggestions:d.showSuggestions,filters:d.filters,pageStores:d.pageStores,loading:d.loading,error:d.error,hasNextPage:d.hasNextPage,loadNextPage:g,runNewSearch:h,setFilters:f}}const ji=function(e){let{spaceStore:t,userStore:s}=e;window.__c={n:"AdminContentSearchTab"};const n=(0,o.O7)(),i=(0,a.VK)((()=>zt.Z.state.online),[]),r=(0,a.VK)((()=>{const e=_e.default.state.currentSpaceViewStore,t=null==e?void 0:e.getSettings();return(null==t?void 0:t.admin_content_search_acknowledgement)??!1}),[]),{showSuggestions:l,loadNextPage:d,pageStores:c,loading:u,error:m,runNewSearch:p,filters:g,setFilters:f}=Mi({spaceStore:t,userStore:s,hasUserConfirmedAcknowledgement:r});return i?(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(et.Z,{large:!n.device.isMobile||void 0,divider:n.device.isMobile?void 0:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.title",defaultMessage:"Content Search"})}),(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:24},children:[(0,J.jsx)(le.Z,{isMultiline:!0,style:{marginBottom:20},children:(0,J.jsx)(h.FormattedMessage,{id:"adminContentSearchTab.description",defaultMessage:"Search and filter for any page in the workspace, including private pages. Only workspace owners can use content search."})}),(0,J.jsx)(Ls,{spaceId:t.id,disabled:0===c.length||!r,filters:g})]}),(0,J.jsx)(di,{spaceStore:t,runNewSearch:p,setFilters:f,filters:g,hasUserConfirmedAcknowledgement:r}),(0,J.jsx)(ei,{loading:u,error:m,pageStores:c,loadNextPage:d,filters:g,setFilters:f,showSuggestions:l,runNewSearch:p,hasUserConfirmedAcknowledgement:r})]}):(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Please go online to access content search.",id:"adminContentSearchTab.offline.message"})})})};var wi=s(15047),Ci=s(76463),ki=s(98688),Ti=s(12170),Ii=s(23586),Pi=s(38755),Zi=s(72087),Fi=s(9999),_i=s(80920),Ai=s(74181),Ri=s(90965),Di=s(94826),Bi=s(9953),Li=s(72371),Oi=s(74021),Ei=s(17549),Ni=s(30874),Vi=s(20454),Ui=s(22616),Wi=s(44041),Ki=s(8848),zi=s(47453),qi=s(77657),Gi=s(9844),Hi=s(95477),Qi=s(75822),Yi=s(74136),$i=s(78948);function Ji(e){window.__c={n:"AdminIntegrationSettingsSearchResults"};const{query:t}=e,s=(0,o.O7)(),i=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),r=(0,a.VK)((()=>null==i?void 0:i.getBotSettingsStore().getValue()),[i]),l="approved_or_built_by_notion"===(null==r?void 0:r.integration_restrictions),d=(0,a.VK)((()=>null!=r&&r.integration_approval_statuses?Object.keys(r.integration_approval_statuses):[]),[r]),c=(0,a.VK)((()=>Object.keys(qi.u2).map((e=>{const t=null==i?void 0:i.getRecordModel({id:e,table:Gi.K2});if("published"===(null==t?void 0:t.status))return e})).filter(Fs.$K)),[i]),m=(0,n.useMemo)((()=>c.some((e=>e===qi.f3))),[c]),p=(0,a.VK)((()=>c.filter((e=>!d.includes(e))).slice(0,5)),[d,c]);return(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,width:255,header:to(t,p,l),children:(0,J.jsx)(Ii.Z,{request:t,performRequest:e=>async function(e){const{query:t,integrationType:s,environment:n,spaceId:i,approvedIntegrationIds:o,popularIntegrationIds:a,autoApproveBuiltByNotion:r}=e;if(!zt.Z.state.online||!i)return[];if((0,u.e)(t)||(0,u.qn)(t))return[t];if(""===t&&!r)return a;const l=await C.searchIntegrations(n,{query:t,type:s,spaceId:i});if("success"===l.type){const e=l.data.integrationIds.filter((e=>!o.includes(e))),t="production";if(!r){return e.sort(((e,s)=>(0,qi.BP)({integrationId:e,env:t})===(0,qi.BP)({integrationId:s,env:t})?0:(0,qi.BP)({integrationId:e,env:t})?-1:1)).slice(0,5)}return e.filter((e=>!(0,qi.BP)({integrationId:e,env:t}))).slice(0,5)}if("failed"===l.type)throw l.error;return(0,Fs.t1)(l)}({query:e,environment:s,spaceId:null==i?void 0:i.id,approvedIntegrationIds:d,popularIntegrationIds:p,autoApproveBuiltByNotion:l}),debounce:Qi.vp,render:(n,o,a)=>{if(!o||!a)return(0,J.jsx)(sn.Z,{children:(0,J.jsx)($i.Z,{})});const l=Ai.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!d.includes(e.id)&&(e.id!==Ai._o||!m))),c=[];if(0===o.length&&0===l.length)c.push({key:"no_results",render:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginLeft:8},children:(0,J.jsx)(h.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=o.map((t=>{var n;const o={table:Gi.K2,id:t};if(!i)return;const a=me.y2.createChildStore(i,o),l=null===(n=a.getInfo())||void 0===n?void 0:n.icon;return{key:`${t}`,render:e=>{var t;return(0,J.jsx)($s.Z,{...e,title:(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold},children:a.getName()}),icon:l&&(0,J.jsx)(In.Z,{disabled:!0,icon:{pointer:o,icon:l},isEmptyPage:!1,size:20}),style:l?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,J.jsx)(so,{tagline:null===(t=a.getInfo())||void 0===t?void 0:t.tagline,isNotionIntegration:(0,qi.BP)({integrationId:a.id,env:"production"})}),className:"notranslate"})},action:()=>{e.closeDropdown(),eo({environment:s,currentSpaceStore:i,botSettings:r,integrationId:t})}}})).filter(Fs.$K),n=l.map((t=>({key:`${t.id}`,render:e=>(0,J.jsx)($s.Z,{...e,title:(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold},children:t.name}),icon:(0,J.jsx)("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"}),action:()=>{e.closeDropdown(),eo({environment:s,currentSpaceStore:i,botSettings:r,integrationId:t.id})}}))).filter(Fs.$K);c.push(...t,...n)}return(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,J.jsx)(sn.Z,{...e}),items:c}]})}})})}function Xi(e){window.__c={n:"AdminComplianceIntegrationSettingsSearchResults"};const{query:t}=e,s=(0,o.O7)(),n=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]);return n?(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,width:255,header:to(t,[],!1),children:(0,J.jsx)(Ii.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:s,spaceId:n}=e;if(!zt.Z.state.online||!n)return[];if((0,u.e)(t)||(0,u.qn)(t))return[t];const i=await C.searchIntegrations(s,{query:t,type:"compliance",spaceId:n});if("success"===i.type)return i.data.integrationIds;if("failed"===i.type)throw i.error;return(0,Fs.t1)(i)}({query:e,environment:s,spaceId:null==n?void 0:n.id}),debounce:Qi.vp,render:(t,s,i)=>{if(!s||!i)return(0,J.jsx)(sn.Z,{children:(0,J.jsx)($i.Z,{})});const o=[];if(0===s.length)o.push({key:"no_results",render:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginLeft:8},children:(0,J.jsx)(h.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=Li.Z.state.loaded&&Ni.Z.state.loaded?Li.Z.state.webhookSubscriptions.map((e=>{var t;return null===(t=Ni.Z.getBotsAsRecordMap().getValue({table:A.cZ,id:e.bot_id}))||void 0===t?void 0:t.integration_id})):[],i=s.map((s=>{var i;const o=me.y2.createChildStore(n,{id:s,table:Gi.K2});if(t.includes(s))return;const a={table:Gi.K2,id:s},r=me.y2.createChildStore(n,a),l=null===(i=r.getInfo())||void 0===i?void 0:i.icon,d=(0,Di.I$)(r.id);return{key:`${s}`,render:e=>(0,J.jsx)($s.Z,{...e,title:(0,J.jsxs)("div",{style:{display:"flex",float:"left",alignItems:"center"},children:[(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold},children:r.getName()}),(null==d?void 0:d.type)&&(0,J.jsx)("div",{style:{marginLeft:4},children:(0,J.jsx)(Yi.Z,{children:d.type})})]}),icon:l&&(0,J.jsx)(In.Z,{disabled:!0,icon:{pointer:a,icon:l},isEmptyPage:!1,size:20}),style:null!=d&&d.icon?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,J.jsx)(so,{tagline:null!=d&&d.tagline?B.default.formatMessage(null==d?void 0:d.tagline):"A SIEM or DLP partner",isNotionIntegration:!1})}),action:()=>{var t;e.closeDropdown();o.getModel()&&(null!=d&&null!==(t=d.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==d?void 0:d.type))?Ei.Z.setState({open:!0,integrationId:r.id}):Oi.Z.setState({open:!0,integrationId:r.id})}}})).filter(Fs.$K);o.push(...i)}return(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,J.jsx)(sn.Z,{...e}),items:o}]})}})}):null}function eo(e){const{environment:t,currentSpaceStore:s,botSettings:n,integrationId:i}=e;if(s&&!(0,Di.z6)(i)){const e={...null==n?void 0:n.integration_approval_statuses,[i]:{type:"integration",status:"approved"}};I.createAndCommit({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{Bi.sW({store:s,data:{bot_settings:{...n,integration_approval_statuses:e}},transaction:t})}})}}const to=(e,t,s)=>!e&&!s&&t.length>0&&(0,J.jsx)(wn.Z,{title:(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:4,fontWeight:g.Z.fontWeight.medium},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"})})}),so=e=>{window.__c={n:"IntegrationCaption"};const{tagline:t,isNotionIntegration:s}=e,n=(0,r.Fg)(),i=s?{}:{maxHeight:52,overflow:"auto"};return t?(0,J.jsxs)("div",{style:i,children:[t,s&&(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:8},children:[(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),(0,_i.X)({marginLeft:3,width:12,height:12,fill:n.invoiceGreen})]})]}):null};var no=s(74194);const io=(0,h.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID"},complianceIntegrationSearchInputPlaceholder:{id:"adminConnectionsSettings.search.input.complianceIntegrationPlaceholder",defaultMessage:"Add by name"}});function oo(){window.__c={n:"AdminConnectionsSettingsAddMenu"};const e=(0,o.O7)(),t=(0,r.Fg)(),[s,i]=(0,n.useState)(!0),[a,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(""),u=n.createRef();return s?(0,J.jsx)(ae.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:g.Z.fontWeight.medium,fontSize:g.Z.fontSize.UIRegular.desktop,color:Ki.ZP.blue,padding:"0px 6px"},onClick:()=>{i(!1)},children:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",values:{plusIcon:(0,zi.R)({fill:Ki.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,J.jsx)(tn.ZP,{alignmentToOrigin:tn.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=u.current)||void 0===e||e.handleBlur(),i(!0),l(!1)},origin:(0,J.jsx)(no.Z,{type:"text",style:{width:255},left:(0,zi.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:u,value:d,onFocus:()=>{l(!0)},placeholder:B.default.formatMessage(io.searchInputPlaceholder),onChange:e=>c(e.target.value)}),open:a,popupType:tn.ZP.PopupType.Popup,style:{width:255},render:()=>(0,J.jsx)(Ji,{query:d,closeDropdown:()=>l(!1)})})}function ao(){window.__c={n:"AdminConnectionsSettingsAddComplianceMenu"};const e=(0,o.O7)(),t=(0,r.Fg)(),[s,i]=(0,n.useState)(!0),[a,l]=(0,n.useState)(!1),[d,c]=(0,n.useState)(""),u=n.createRef();return s?(0,J.jsx)(Vt.Z,{isBlue:!0,style:{display:"flex",alignItems:"center",height:28,fontWeight:g.Z.fontWeight.medium,fontSize:g.Z.fontSize.UIRegular.desktop,color:Ki.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;i(!1),null===(e=u.current)||void 0===e||e.focusInput()},children:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettingsAddComplianceMenu.search.button.label",defaultMessage:"{plusIcon} Add connection",values:{plusIcon:(0,zi.R)({fill:Ki.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,J.jsx)(tn.ZP,{alignmentToOrigin:tn.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=u.current)||void 0===e||e.handleBlur(),i(!0),l(!1)},origin:(0,J.jsx)(no.Z,{type:"text",style:{width:255},left:(0,zi.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),focus:!0,ref:u,value:d,onFocus:()=>{l(!0)},placeholder:B.default.formatMessage(io.complianceIntegrationSearchInputPlaceholder),onChange:e=>c(e.target.value)}),open:a,popupType:tn.ZP.PopupType.Popup,style:{width:255},render:()=>(0,J.jsx)(Xi,{query:d,closeDropdown:()=>{i(!0),l(!1)}})})}var ro=s(35878),lo=s(94512),co=s(70578),uo=s(11066),mo=s(55422),po=s(66957);const go=["member_connections","workspace_connections"];function ho(e){window.__c={n:"AdminConnectionsSettings"};const t=(0,o.O7)(),{isMobile:s}=t.device,{guestBotIds:i}=e,l=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>Li.Z.webhookSubscriptions.state.reduce(((e,t)=>{const s=t.getBotId();return s&&(e[s]=t.id),e}),{})),[]),u=(0,a.VK)((()=>ce.default.checkGate("webhooks_beta")||ce.default.checkGate("e_discovery")),[]),m=(0,a.VK)((()=>l?(0,c.jj)([...i,...Ni.Z.bots.state.map((e=>e.id))]).map((e=>{const t=me.Qx.createChildStore(l,{table:A.cZ,id:e,spaceId:l.id});return t.getAlive()?t:void 0})).filter(Fs.$K):[]),[l,i]),p=(0,a.VK)((()=>function(e){return e.reduce(((e,t)=>{const s=t.getIntegrationId();if(!s)return e;return(0,Di.EY)(s)?(s in e.compliance||(e.compliance[s]=[]),e.compliance[s].push(t.id)):(s in e.nonCompliance||(e.nonCompliance[s]=[]),e.nonCompliance[s].push(t.id)),e}),{compliance:{},nonCompliance:{}})}(m)),[m]),f=(0,a.VK)((()=>function(e){return e.filter((e=>!e.getIntegrationId())).map((e=>e.id))}(m)),[m]),x=(0,a.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,s)=>{const n=Vi.U.createChildStore(t,{table:R.KJ,id:s.getCreatedById()}),i=s.getIntegrationId();return i?e[i]=i in e?[...e[i],n]:[n]:e[s.id]=[n],e}),{})}(m,l)),[m,l]),y=(0,a.VK)((()=>null==l?void 0:l.getBotSettingsStore().getValue()),[l]),S=(0,a.VK)((()=>Object.keys(p.nonCompliance).length+f.length),[p.nonCompliance,f]),v=(0,a.VK)((()=>Object.values(p.compliance).flat().length),[p.compliance]),b=(0,a.VK)((()=>null!=y&&y.integration_approval_statuses?Object.keys(y.integration_approval_statuses).length+f.length:f.length),[y,f]),j={member_connections:(0,J.jsx)(h.FormattedMessage,{id:"admin.connections.tabs.member_connections",defaultMessage:"Member{numberOfIntegrations}",values:{numberOfIntegrations:0!==S&&(0,J.jsx)(le.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:S+Ai.T2.length})}}),workspace_connections:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(h.FormattedMessage,{id:"admin.connections.tabs.workspace_connections",defaultMessage:"Workspace{numberOfIntegrations}",values:{numberOfIntegrations:0!==v&&(0,J.jsx)(le.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:v})}}),(0,J.jsx)(Ct.Z,{})]})},w=go.map((e=>j[e])),C=(0,a.VK)((()=>"integrations"===qe.Z.state.currentTab?qe.Z.state.defaultSubtab:void 0),[]),k=(0,a.VK)((()=>Li.Z.integrations.state),[]),[T,I]=(0,n.useState)(C||"member_connections"),P=(0,a.VK)((()=>(0,jt.wP)()),[]),Z=(0,r.yK)((e=>({connectedSection:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"relative"},connectedSectionDescription:{fontSize:14,marginRight:8,color:e.lightTextColor,fontWeight:400,marginBottom:12},addMenu:{position:"absolute",right:0,top:0},discoverSectionUpsell:{backgroundColor:e.accentColors.uiBlue[100],padding:16,borderRadius:4},discoverSectionHeader:{display:"flex",justifyContent:"space-between",marginBottom:8},discoverSectionTitle:{fontSize:16,fontWeight:510},discoverSectionButtons:{display:"flex"},learnMoreButton:{padding:"0px 8px",borderRadius:4,display:"flex",alignItems:"center",color:e.blueColor},upgradeButton:{marginLeft:12,padding:"0px 14px"},alias:{marginLeft:6,width:"0.9em",height:"0.9em",padding:1,border:"1px solid",borderRadius:2}})),[]),F={member_connections:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(fo,{}),(null==y?void 0:y.integration_restrictions)&&(0,J.jsx)("div",{style:{marginTop:"19px"},children:(0,J.jsx)(xo,{})}),(0,J.jsx)(Ms.Z,{size:s?32:18,isHidden:!s}),Boolean(null==y?void 0:y.integration_restrictions)?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19},children:[(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28},children:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==b&&(0,J.jsx)(le.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:b})}})}),(0,J.jsx)(oo,{})]}):(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"},children:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==S&&(0,J.jsx)(le.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:S+Ai.T2.length})}})}),(0,J.jsx)(ro.ZP,{integrationIdToBotIds:p.nonCompliance,internalIntegrationIds:f,integrationIdToUsers:x}),(0,J.jsx)("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4},children:(0,J.jsx)(co.Z,{})})]}),workspace_connections:()=>{const e=Object.keys(p.compliance),s=e.length>0,n=function(e){const{allIntegrations:t,connectedIntegrationIds:s,isEnterprise:n}=e,i=[];for(const o of t)if(!s.includes(o.id)){const e=(0,Di.I$)(o.id);if(!e)continue;i.push({id:o.id,appName:o.name,account:void 0,caption:o.getInfo().tagline,logo:o.getInfo().icon,shouldHideInDiscover:!1,shouldShowNewBadge:!1,shouldHideConnectAccount:!0,shouldShowUpsell:!n,integrationTypes:[e.type],capabilities:(0,J.jsx)(J.Fragment,{}),canSelectPageAccess:!1,onConnect:()=>{var t;null!=e&&null!==(t=e.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==e?void 0:e.type)||"ediscovery"===(null==e?void 0:e.type)?Ei.Z.setState({open:!0,integrationId:o.id}):Oi.Z.setState({open:!0,integrationId:o.id})},onDisconnect:()=>{}})}return i}({allIntegrations:k,connectedIntegrationIds:e,isEnterprise:P}),i=n.length>0;return(0,J.jsx)(J.Fragment,{children:u?(0,J.jsxs)(J.Fragment,{children:[s&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("span",{style:Z.connectedSectionDescription,children:(0,J.jsx)(h.FormattedMessage,{id:"admin.connections.tab.workspace_connections.description",defaultMessage:"These integrations connect your workspace to external apps, or improve security and compliance. Only workspace owners can install them"})}),(0,J.jsxs)("div",{style:Z.connectedSection,children:[(0,J.jsx)("div",{style:Z.addMenu,children:(0,J.jsx)(ao,{})}),(0,J.jsx)(ro.cP,{botIdToWebhookSubscriptionId:d,complianceIntegrationsIdToBotIds:p.compliance})]})]}),i&&(0,J.jsx)("div",{style:{...P?{}:Z.discoverSectionUpsell,marginTop:s?32:void 0},children:(0,J.jsx)(lo.Z,{apps:n,numberOfConnectedApps:e.length,numberOfDisplayRows:2,title:(0,J.jsxs)("div",{style:Z.discoverSectionHeader,children:[(0,J.jsx)("div",{style:Z.discoverSectionTitle,children:P?(0,J.jsx)(h.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.title",defaultMessage:"Discover new connections"}):(0,J.jsx)(h.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.titleUpsell",defaultMessage:"Upgrade to Enterprise to use these connections"})}),!P&&(0,J.jsxs)("div",{style:Z.discoverSectionButtons,children:[(0,J.jsxs)(uo.Z,{onClick:()=>{M.D({environment:t,url:"https://www.notion.so/integrations/collections/security-and-compliance"})},style:Z.learnMoreButton,children:[(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Learn more",id:"connectionsSettings.discoverNewConnectionsSection.learnMore"}),(0,Fi.J)(Z.alias)]}),(0,J.jsx)(Ws.Z,{style:Z.upgradeButton,onClick:async()=>{l&&(Ui.Zz({environment:t,spaceId:l.id}),await ps.Z.waitUntilReady()),Wi.y(t,{from:"workspace_connections",for:"enterprise",dontOpenPlansOnCancel:!0})},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Upgrade",id:"connectionsSettings.discoverNewConnectionsSection.upgrade"})})]})]})})})]}):null})}},_=e=>F[e];return u?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(po.Z,{tabs:w,selectedIndex:go.findIndex((e=>e===T)),onChange:e=>(e=>{I(go[e])})(e),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),_(T)()]}):_("member_connections")()}const fo=()=>{window.__c={n:"RequireApprovalDropdown"};const e=(0,o.O7)(),t=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),{isMobile:s}=e.device,n=(0,a.VK)((()=>(0,jt.wP)()),[]),i=(0,a.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]);return(0,J.jsx)(mo.Z,{isMobile:s,title:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections"}),caption:(0,Ri.CJ)(i)?(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners."}):(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection."}),upsellOptions:{shouldUpsell:!n,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,Ri.CJ)(i)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:(0,J.jsx)(h.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"No restrictions"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection."})},{key:"allow_list",label:(0,J.jsx)(h.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"Only from approved list"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by a workspace owner."})}],onSelectOption:s=>{!function(e){const{environment:t,currentSpaceStore:s,botSettings:n,setting:i}=e;if(s){if("allow_list"===i&&(0,Ri.CJ)(n))return;const e="allow_list"===i?"approved_only":void 0;I.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{Bi.sW({store:s,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:i,setting:s})},info:[{key:"learn_more",label:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Workspace owners can always install and approve new connections."})}]})};const xo=()=>{window.__c={n:"AutoApproveBuiltByNotionToggle"};const e=(0,o.O7)(),t=(0,r.Fg)(),s=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),{isMobile:n}=e.device,i=(0,a.VK)((()=>(0,jt.wP)()),[]),l=(0,a.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]);return(0,J.jsx)(mo.Z,{isMobile:n,title:(0,J.jsx)(h.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:e=>(0,J.jsxs)("span",{style:{color:t.invoiceGreen,marginRight:4,marginLeft:4},children:[(0,_i.X)({width:14,display:"inline",verticalAlign:"bottom",marginRight:2}),e]})}}),caption:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",values:{helpcenterlink:e=>(0,J.jsx)(js.Z,{href:(0,Ze.UY)("guides.enterpriseIntegrationSettings"),children:e})}}),upsellOptions:{shouldUpsell:!i,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==l?void 0:l.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:s,botSettings:n}=e;if(s){const e="approved_or_built_by_notion"===(null==n?void 0:n.integration_restrictions)?"approved_only":"approved_or_built_by_notion";I.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{Bi.sW({store:s,data:{bot_settings:{...n,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:s,botSettings:l})})};var yo=s(25777);class So extends i.Z{constructor(){super(...arguments),this.storeTypes={requestStore:Zi.Z}}renderComponent(){const{device:e}=this.environment;if((0,Pi.Fn)(this.environment))return(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(et.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",style:{paddingBottom:12},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"})}),this.renderRequest()]});b.r$({currentTab:"members"})}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return(0,J.jsx)(Ii.Z,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:e=>async function(e,t){let{spaceId:s}=e;return{guestBotIds:(await Promise.all([Ci.Yw({environment:t,table:wi.bx,id:s,type:"guest"}),Ci.Yw({environment:t,table:wi.bx,id:s,type:"external"}),Ti.pJ({environment:t}),ki.v({environment:t})]))[0].botIds}}(e,this.environment),render:(e,t,s)=>(0,J.jsx)(bo,{error:e,result:t,ready:s})})}}So.displayName="IntegrationSettings";const vo=(0,h.injectIntl)(So);function bo(e){let{error:t,result:s,ready:n}=e;window.__c={n:"ResultComponent"};const{currentSpaceStore:i}=(0,a.VK)((()=>_e.default.state),[]);return i?(0,J.jsxs)(yo.Z,{loaded:n,spinnerSize:16,showSpinnerTimeout:600,children:[t&&(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})}),s&&(0,J.jsx)(ho,{...s})]}):null}var Mo=s(36488),jo=s(56940),wo=s(50506),Co=s(79603),ko=s(53770);const To=[50,100,200,500,1e3];function Io(e){let{spaceStore:t,samlConfigStore:s,memberCountFilter:i,isPrimarySpace:r}=e;const l=(0,o.O7)(),d=(0,a.VK)((()=>s.state.emailDomains),[s]),[c,u]=(0,n.useState)({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),m=(0,a.VK)((()=>(0,jt.wP)()),[]),p=(0,n.useCallback)((async e=>{if(m&&0!==d.length&&r&&c.nextEarliestCreatedAt&&!c.loading&&!(e&&c.numPagesLoaded>0||c.error)){u((e=>({...e,loading:!0})));try{const{spaces:e,earliestCreatedAt:s,hasMoreSpaces:n}=await(0,ko.XD)({fn:async()=>await async function(e,t,s,n,i){const o=await C.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:s,spacesLimit:10,memberCountFilter:i,spaceCreatedTimeUpperBound:n});if("failed"===o.type)throw o.error;return{spaces:o.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,spaceRequest:e.spaceRequest,isDelinquent:e.isDelinquent,isPendingBilling:e.isPendingBilling,isActorInSpace:e.isActorInSpace}))),earliestCreatedAt:o.data.hasMoreSpaces?o.data.earliestCreatedAt:void 0,hasMoreSpaces:o.data.hasMoreSpaces}}(l,t.id,d,c.nextEarliestCreatedAt?c.nextEarliestCreatedAt-1:Date.now(),i),handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:To,retryAttemptRandomOffsetMS:50,initialInput:void 0});u((t=>{const i=[...t.spaces],o=new Set(t.spaces.map((e=>e.id)));for(const s of e)o.has(s.id)||i.push(s);return{spaces:i,nextEarliestCreatedAt:s,numPagesLoaded:t.numPagesLoaded+1,hasNextPage:n,loading:!1,error:void 0}}))}catch(s){const e=(0,mi.tg)(s);u((t=>({...t,loading:!1,error:e})))}}}),[l,m,i,r,t,d,c.nextEarliestCreatedAt,c.numPagesLoaded,c.loading,c.error]);const g=(0,n.useCallback)((async()=>{await p(!1)}),[p]),h=(0,n.useCallback)((async()=>{await p(!0)}),[p]),f=(0,n.useCallback)((async()=>{u({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),await p(!0)}),[p]);return{claimableSpaces:c.spaces,loading:c.loading,error:c.error,hasNextPage:c.hasNextPage,loadFirstPage:h,loadNextPage:g,resetFirstPage:f,setSpaceRequest:function(e,t){u((s=>{const n=s.spaces.map((s=>s.id===e?{...s,spaceRequest:t}:s));return{...s,spaces:n}}))},removeClaimableSpace:function(e){u((t=>{const s=t.spaces.filter((t=>t.id!==e));return{...t,spaces:s}}))}}}async function Po(e){const{environment:t,spaceId:s,store:n}=e;if(!(0,jt.Rs)())return n.reset(),{};const i=await C.getSamlConfigForSpace(t,{spaceId:s});if("failed"===i.type)v.showError(i);else if(i.data&&i.data.samlConfig){const e={...i.data.samlConfig,useMetadataUrl:!Boolean(i.data.samlConfig.idpMetadata)};return n.setState(e),i.data}return n.reset(),{}}const Zo="settings-page",Fo="workspaces-page",_o="managed-users-page";let Ao=function(e){return e[e.Single=0]="Single",e[e.Multi=1]="Multi",e}({});const Ro=(0,n.createContext)(null),Do=e=>{let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i,children:r}=e;window.__c={n:"PageProvider"};const l=(0,o.O7)(),[d,c]=(0,n.useState)(Zo),[u,m]=(0,n.useState)(Ao.Single),g=(0,a.VK)((()=>s.state.emailDomains),[s]),h=(0,a.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),{loading:f,error:x,loaded:S}=function(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;const i=(0,o.O7)(),[{status:a,error:r}]=(0,Tt.r5)((async()=>{const e=await Po({environment:i,spaceId:t.id,store:s});return(0,F.Zw)(e)?e:e.samlConfig?{samlResponse:e,domainResponse:await n.updateValueForSpace({environment:i,spaceId:t.id,store:n})}:{samlResponse:e,domainResponse:void 0}}),[i,s,t,n]);return{loading:"pending"===a,loaded:"resolved"===a,error:r}}({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),{loading:v,error:b,claimableSpaces:M,setSpaceRequest:j,removeClaimableSpace:w,hasNextPage:k,loadNextPage:T,loadFirstPage:I,resetFirstPage:P}=Io({spaceStore:t,samlConfigStore:s,isPrimarySpace:h,memberCountFilter:"single"}),{loading:Z,error:_,claimableSpaces:A,setSpaceRequest:R,removeClaimableSpace:D,hasNextPage:B,loadNextPage:L,loadFirstPage:O,resetFirstPage:E}=Io({spaceStore:t,samlConfigStore:s,isPrimarySpace:h,memberCountFilter:"multi"}),N=M.length+A.length>0,[V,U,W,K,z,q,G,H]=u===Ao.Single?[v,b,M,j,w,k,T,I,P]:[Z,_,A,R,D,B,L,O,E],{loading:Q,error:Y,domainVerifications:$}=function(e){let{spaceStore:t}=e;const s=(0,o.O7)(),[i,a]=(0,n.useState)([]),[{status:r,error:l}]=(0,Tt.r5)((async()=>{if(!(0,p.Rs)(t.getSubscriptionTier()))return void a([]);const e=await C.getDomainVerificationCodesForSpace(s,{spaceId:t.id,verifiedOnly:!0});"success"===e.type?a(e.data.domainVerifications):a([])}),[s,t]);return{loading:"pending"===r,domainVerifications:"resolved"===r?i:[],error:l}}({spaceStore:t,emailDomains:g});(0,n.useEffect)((()=>{I(),O()}),[W,I,O]);const X={page:d,navigateTo:function(e){c(e),0===M.length&&A.length>0&&m(Ao.Multi),"workspaces-page"===e&&y.Cez(l,{verifiedDomains:g,tab:u===Ao.Single?"single":"multi"})},loadingSaml:f,loadingSpaces:V,loadingVerifications:Q,errorSaml:x,errorClaimableSpaces:U,errorVerifications:Y,loadedSaml:S,domainVerifications:$,hasBrowsableSpaces:N,claimableSpaces:W,setSpaceRequest:K,removeClaimableSpace:z,resetInitialClaimableSpaces:H,hasMoreClaimableSpaces:q,loadMoreClaimableSpaces:G,tab:u,setSelectedTab:function(e){m(e),"workspaces-page"===d&&y.Cez(l,{verifiedDomains:g,tab:e===Ao.Single?"single":"multi"})},verifiedDomains:g};return(0,J.jsx)(Ro.Provider,{value:X,children:r})};var Bo=s(84169),Lo=s(19981),Oo=s(66466),Eo=s(25651),No=s(29851),Vo=s(2356),Uo=s(37612);let Wo=function(e){return e.User="user",e.Domains="domains",e}({});var Ko=s(81918),zo=s(64964);const qo={managedUsers:[],filters:{query:"",multiFactorStatus:void 0,workspaceId:void 0},numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0};function Go(e){let{spaceStore:t,samlConfigStore:s,userStatus:i}=e;const r=(0,o.O7)(),[l,d]=(0,n.useState)(qo),u=(0,n.useRef)(l.filters),m=(0,a.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),p=(0,a.VK)((()=>s.state.emailDomains),[s]),g=(0,n.useCallback)((async e=>{if(0===p.length)return;if(!m)return;let s=l.loading,n=l.error,o=l.hasNextPage,a=l.paginationToken;if(e.restartSearch&&(d((e=>({...qo,filters:e.filters}))),s=qo.loading,n=qo.error,o=qo.hasNextPage,a=qo.paginationToken),o&&!s&&!n){d((e=>({...e,loading:!0}))),u.current=l.filters;try{var c;const e=await C.getManagedUsers(r,{spaceId:t.id,emailDomains:p,query:l.filters.query,multiFactorStatus:l.filters.multiFactorStatus,workspaceId:l.filters.workspaceId,paginationToken:a,userStatus:i});if(Ko.HH(r,{filters:{multiFactorStatus:l.filters.multiFactorStatus,workspaceId:l.filters.workspaceId},query_length:(null===(c=l.filters.query)||void 0===c?void 0:c.length)??0,current_page:a,user_status:i}),"failed"===e.type)throw e.error;const s=e.data.nextPaginationToken,n=e.data.results;d((e=>{const t=[...e.managedUsers],i=new Set(e.managedUsers.map((e=>e.userId)));for(const s of n)i.has(s.userId)||t.push(s);return{...e,managedUsers:t,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:s,hasNextPage:Boolean(s)}}))}catch(g){const e=(0,mi.tg)(g);d((t=>({...t,loading:!1,error:e})))}}}),[r,t,p,m,l.loading,l.error,l.hasNextPage,l.paginationToken,l.filters,i]);(0,n.useEffect)((()=>{c.Xy(u.current,l.filters)||g({restartSearch:!0})}),[l.filters,g]);const h=(0,n.useCallback)((()=>g({restartSearch:!1})),[g]),f=(0,n.useCallback)((e=>{d((t=>({...t,filters:{...t.filters,...e}})))}),[]),x=(0,n.useCallback)(((e,t)=>{d((s=>({...s,managedUsers:s.managedUsers.map((s=>s.userId===e?{...s,workspaces:s.workspaces.filter((e=>e.id!==t))}:s))})))}),[]),y=(0,n.useCallback)((e=>{d((t=>({...t,managedUsers:[...t.managedUsers,e]})))}),[]),S=(0,n.useCallback)((e=>{d((t=>({...t,managedUsers:t.managedUsers.filter((t=>t.userId!==e))})))}),[]);return{managedUsers:l.managedUsers,filters:l.filters,loading:l.loading,error:l.error,removeWorkspaceFromUser:x,addUserToManagedUsers:y,removeUserFromManagedUsers:S,setFilters:f,hasNextPage:l.hasNextPage,loadNextPage:h}}let Ho=function(e){return e[e.NotSuspended=0]="NotSuspended",e[e.Suspended=1]="Suspended",e}({});function Qo(e){switch(e){case Ho.Suspended:return"suspended";case Ho.NotSuspended:return"notSuspended";default:(0,Fs.t1)(e)}}function Yo(e){let{lastActiveAt:t}=e;window.__c={n:"LastActiveDate"};const s=(0,r.yK)((e=>({container:{opacity:.5}})),[]);return(0,J.jsx)("div",{style:s.container,children:t?(0,J.jsx)(Ns.T,{dateTs:t}):(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.unknown",defaultMessage:"No activity"})})})}var $o=s(19639);const Jo={defaultMessage:"External workspace",id:"managedUsers.externalWorkspaceName",description:"A generic name to replace the real name of an external workspace."};function Xo(e){return e.formatMessage(Jo)}function ea(e){if(!e)return;const t=Object.entries($o.nb).find((t=>{let[s,n]=t;return n===e}));if(t){return t[0]}}function ta(e){let{workspace:t}=e;window.__c={n:"WorkspaceSummaryName"};const s=(0,h.useIntl)(),n=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}})),[]);return(0,J.jsxs)("div",{style:n.container,children:[t.name??Xo(s),t.isExternal?(0,J.jsx)(sa,{}):null]})}function sa(){window.__c={n:"ExternalWorkspaceInfoIcon"};const e=(0,r.yK)((e=>({icon:{marginLeft:4,height:14,width:14,opacity:.5}})),[]);return(0,J.jsx)(re.ZP,{render:t=>(0,J.jsx)("div",{...t,children:(0,Us.D)(e.icon)}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.userAccess.externalSpaceNameTooltipText",defaultMessage:"This is an external workspace that does not belong to this user."})})}function na(e){let{workspaceSummaries:t}=e;window.__c={n:"UserAccess"};const s=(0,h.useIntl)(),n=(0,r.yK)((e=>({title:{marginRight:8},noWorkspaces:{paddingInline:8,opacity:.5},workspaceName:{maxWidth:"80%"},plusMore:{opacity:.5,marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",marginLeft:4}})),[]);if(t.length<=0)return(0,J.jsx)(le.Z,{style:n.noWorkspaces,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.noWorkspaces",defaultMessage:"No workspaces"})});const i=t.find((e=>e.name)),o=i?i.name:Xo(s),a=t.length-1;return(0,J.jsxs)("div",{style:n.titleContainer,children:[(0,J.jsx)(le.Z,{isInline:!0,style:n.workspaceName,children:o}),!i||i.isExternal?(0,J.jsx)(sa,{}):null,a>0?(0,J.jsxs)(le.Z,{isInline:!0,style:n.plusMore,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.additionalCount",defaultMessage:"+{numRemainingWorkspaces}",values:{numRemainingWorkspaces:a}}),""]}):null]})}var ia=s(93405),oa=s(83182);const aa=(0,h.defineMessages)({menuAriaLabel:{defaultMessage:"Open action menu for this user.",id:"identityAndProvisioning.managedUsers.table.menu.ariaLabel"}});function ra(e){let{managedUser:t,managedUserActionSections:s}=e;window.__c={n:"UserActionsMenu"};const n=(0,a.qz)(void 0,fn.Z),i=(0,h.useIntl)(),o=(0,r.yK)((()=>({container:{minWidth:265}})),[]);return(0,J.jsx)(Sn.ZP,{popupType:tn.kQ.Popup,style:o.container,buttonPopupStore:n,renderOrigin:e=>(0,J.jsx)(vn.Z,{ariaLabel:i.formatMessage(aa.menuAriaLabel),icon:mn.o,...e}),render:()=>(0,J.jsx)(la,{managedUser:t,popupStore:n,managedUserActionSections:s})})}function la(e){let{managedUser:t,popupStore:s,managedUserActionSections:n}=e;window.__c={n:"ActionsMenu"};const i=[],o=(0,r.yK)((()=>({destructiveIcon:{fill:Ki.ZP.red,color:Ki.ZP.red}})),[]);for(const[a,r]of n.entries()){const e=r.map(((e,s)=>({key:s,render:s=>{var n,i;return(0,J.jsx)(ia.Z,{...s,shouldWrapCaption:!0,svg:t=>e.icon(e.isDestructive?{...t,...o.destructiveIcon}:t),title:e.title,style:{paddingTop:8,paddingBottom:8,...e.isDestructive?o.destructiveIcon:{}},disabled:null===(n=e.getDisabledState)||void 0===n?void 0:n.call(e,t),disabledFeedback:null===(i=e.getDisabledState)||void 0===i?void 0:i.call(e,t)})},action:()=>e.onClick(t)}))),s={key:`section-${a}`,render:e=>(0,J.jsx)(sn.Z,{topBorder:a>0,...e}),items:e};i.push(s)}return(0,J.jsxs)(Xs.Z,{menuType:Hs.og.Popup,children:[(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:i,onAccept:()=>{s.setState({open:!1})}}),(0,J.jsx)(sn.Z,{topBorder:!0,children:(0,J.jsx)(oa.Z,{title:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Learn about user suspension",id:"managedUsersDashboard.userActionsMenu.helpButton"}),href:(0,Ze.UY)("guides.managedUsers"),analyticsFrom:"managed_users_dashboard_user_actions_menu"})})]})}var da=s(69219);function ca(e){let{userId:t}=e;window.__c={n:"UserSummary"};const s=(0,h.useIntl)(),n=(0,r.yK)((e=>({iconStyle:{color:e.lightTextColor,fontWeight:500}})),[]),i=(0,a.VK)((()=>{const e=_e.default.state.currentSpaceStore;if(!e)return;const n=me.U6.createChildStore(e,{table:R.KJ,id:t});return{userStore:n,isReady:n.isReady(),userName:n.getDisplayName(s),userEmail:n.getEmail()}}),[t,s]);return null!=i&&i.isReady?(0,J.jsx)(da.i,{useThinTitle:!0,title:i.userName,byline:i.userEmail,icon:(0,J.jsx)(Vn.Z,{size:28,userStore:i.userStore,iconStyle:n.iconStyle})}):(0,J.jsx)(ua,{})}function ua(){window.__c={n:"LoadingUserSummary"};const e=(0,r.yK)((()=>({icon:{borderRadius:"100%",height:28,width:28,marginLeft:-4}})),[]);return(0,J.jsx)(da.H,{includeByline:!0,includeIcon:!0,iconStyles:e.icon})}var ma=function(e){return e.ManagedUser="managed-user",e.Loading="loading",e}(ma||{});const pa={marginLeft:4,height:14,width:14,opacity:.5},ga=[{id:"user",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.user",defaultMessage:"Users"}),renderCell:e=>e.type===ma.ManagedUser?(0,J.jsx)(ca,{userId:e.managedUser.userId}):(0,J.jsx)(ua,{}),widthData:{width:70},sortable:!1},{id:"access",headerTitle:(0,J.jsx)("span",{style:{paddingInline:8},children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.access",defaultMessage:"Workspaces"})}),renderCell:e=>e.type===ma.ManagedUser?(0,J.jsx)(na,{workspaceSummaries:e.managedUser.workspaces}):(0,J.jsx)(Mn.z,{}),widthData:{width:60},sortable:!1},{id:"lastActive",headerTitle:(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive",defaultMessage:"Last active"}),(0,J.jsx)(re.ZP,{render:e=>(0,J.jsx)("div",{...e,children:(0,Us.D)(pa)}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.tooltip",defaultMessage:"This may be delayed by several hours."})})]}),renderCell:e=>e.type===ma.ManagedUser?(0,J.jsx)(Yo,{lastActiveAt:e.managedUser.lastActiveAt}):(0,J.jsx)(Ns.I,{}),widthData:{width:60},sortable:!1},{id:"menu",headerTitle:null,renderCell:e=>e.type===ma.ManagedUser?(0,J.jsx)(ra,{managedUser:e.managedUser,managedUserActionSections:e.managedUserActionSections}):null,widthData:{width:15},sortable:!1,hasClickableContents:!0}],ha=[{id:"1",isClickable:!1,type:ma.Loading},{id:"2",isClickable:!1,type:ma.Loading},{id:"3",isClickable:!1,type:ma.Loading}];function fa(e){let{managedUsers:t,loadMoreManagedUsers:s,onEditDetails:n,loading:i,managedUserActionSections:o}=e;window.__c={n:"ManagedUsersTable"};const a=t.map((e=>({id:e.userId,type:ma.ManagedUser,managedUser:e,isClickable:!0,managedUserActionSections:o}))),l=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:ga,theme:e,containerMarginTop:0})),[]);const d=i?[...a,...ha]:a;return(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:ga,rows:d,onRowClick:function(e){e.type===ma.ManagedUser&&n(e.managedUser)},renderNoRowsComponent:()=>(0,J.jsx)(xa,{loading:i}),styles:l,onLoadMore:s})})}function xa(e){window.__c={n:"EmptyState"};const t=(0,r.yK)((()=>({text:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]);return(0,J.jsx)(le.Z,{isSmall:!0,style:t.text,children:!e.loading&&(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.empty",defaultMessage:"No users found."})})}var ya=s(33679),Sa=s(93667);function va(e){let{selectedMfaMethod:t,setSelectedMfaMethod:s}=e;return(0,J.jsx)(Sa.u,{pillTitle:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.title",defaultMessage:"2-step verification method"}),pillIcon:ya.j,selectedItem:t,setSelectedItem:s,items:ba})}const ba=[{key:"totp",value:"totp",title:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp",defaultMessage:"Authenticator"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp.caption",defaultMessage:"Users who have enabled 2-step verification through an authenticator app"}),wrapCaption:!0},{key:"sms",value:"sms",title:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms",defaultMessage:"Phone number"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms.caption",defaultMessage:"Users who have enabled 2-step verification through their phone number"}),wrapCaption:!0},{key:"backup_code",value:"backup_code",title:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backupCode",defaultMessage:"Backup code"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backup_code.caption",defaultMessage:"Users who have enabled 2-step verification with active backup codes."}),wrapCaption:!0}];var Ma=s(7057),ja=s(24211),wa=s(16402),Ca=s(23063),ka=s(65252),Ta=s(13490),Ia=s(24006);function Pa(e){let{title:t,byline:s,settingItem:n}=e;window.__c={n:"GenericSetting"};const i=(0,r.yK)((e=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},settingLeft:{width:"60%"},settingTitle:{fontWeight:g.Z.fontWeight.regular},settingByline:{marginBottom:4}})),[]);return(0,J.jsxs)("div",{style:i.settingContainer,children:[(0,J.jsxs)("div",{style:i.settingLeft,children:[(0,J.jsx)(et.Z,{smallMarginBottom:!0,style:i.settingTitle,children:t}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:i.settingByline,children:s})]}),n]})}function Za(e){let{title:t,byline:s,isOn:n,onToggle:i,disabled:o,tooltipForDisabled:a}=e;function r(){o||i()}return(0,J.jsx)(re.ZP,{placement:re.ug.Top,alignment:re.v2.End,disableTooltip:!a||!o,renderTooltip:()=>a,render:e=>(0,J.jsx)("div",{...e,children:(0,J.jsx)(Pa,{title:t,byline:s,settingItem:(0,J.jsx)(Ia.Z,{on:n,disabled:o,onClick:r})})})})}var Fa=s(53471);const _a=(0,h.defineMessages)({uploadFailed:{defaultMessage:"Upload failed.",id:"identityAndProvisioning.managedUsers.modal.failedUpload"}});var Aa=s(50501);const Ra=(0,h.defineMessages)({getSupportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.getSupportAccessFailed"},setSupportAccessFailed:{defaultMessage:"Failed to update user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.setSupportAccessFailed"},toastDisabled:{id:"managedUsers.toastMessage.supportAccessDisabled",defaultMessage:"Successfully disabled user's support access status"},toastEnabled:{id:"managedUsers.toastMessage.supportAccessEnabled",defaultMessage:"Successfully enabled user's support access status"}});function Da(e){const{spaceId:t,userId:s}=e,i=(0,h.useIntl)(),a=(0,o.O7)(),[r,l]=(0,n.useState)({loading:!1,error:void 0}),[d,c]=(0,n.useState)(void 0);(0,n.useEffect)((()=>{!async function(){const e=await async function(){l({loading:!0,error:void 0});const e=await C.getDataAccessConsentForManagedUser(a,{spaceId:t,userId:s});return"failed"===e.type?(l({loading:!1,error:e.error}),void v.deprecatedShowErrorMessage(i.formatMessage(Ra.getSupportAccessFailed))):(l({loading:!1,error:void 0}),e.data.expiryTime)}();c(e)}()}),[a,i,t,s]);const u=(0,n.useMemo)((()=>Boolean(d&&Number(d)>Date.now())),[d]),m=(0,n.useCallback)((async()=>{l({loading:!0,error:void 0});const e=u?void 0:Date.now()+Aa.g,n=await C.setDataAccessConsentForManagedUser(a,{spaceId:t,userId:s,expiryTime:e});if(Ko.Ef(a,{new_value:Boolean(e)}),"failed"===n.type)return l({loading:!1,error:n.error}),void v.deprecatedShowErrorMessage(i.formatMessage(Ra.setSupportAccessFailed));c(e),e?zo.oV({label:i.formatMessage(Ra.toastEnabled)}):zo.oV({label:i.formatMessage(Ra.toastDisabled)}),l({loading:!1,error:void 0})}),[a,i,t,s,u]);return{isAccessGranted:u,toggleDataAccessConsent:m,loading:r.loading,error:r.error}}function Ba(e){window.__c={n:"WorkspacesOverview"};const{userId:t,workspaces:s,spaceStore:i,removeWorkspaceFromUser:o}=e,a=(0,r.yK)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",gap:8,marginTop:12}})),[]);return(0,J.jsx)("div",{style:a.container,children:s.map(((e,a)=>(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(La,{userId:t,spaceStore:i,workspace:e,removeWorkspaceFromUser:o}),a<s.length-1?(0,J.jsx)(Ms.Z,{size:8}):null]},e.id)))})}function La(e){window.__c={n:"WorkspaceOverview"};const{userId:t,spaceStore:s,workspace:n,removeWorkspaceFromUser:i}=e,a=(0,h.useIntl)(),l=(0,o.O7)(),d=(0,r.yK)((()=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",gap:12,overflow:"hidden"},workspaceContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",gap:12,overflow:"hidden"},iconContainer:{alignSelf:"center"},textContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},name:{fontSize:14,fontWeight:500},nameUntitled:{fontSize:14,fontWeight:500,opacity:.25},byline:{lineHeight:1.3,fontSize:12,opacity:.5}})),[]);const c=n.icon?{pointer:{table:wi.bx,id:n.id,spaceId:n.id},icon:n.icon}:void 0;return(0,J.jsx)("div",{style:d.container,children:(0,J.jsxs)("div",{style:d.workspaceContainer,children:[(0,J.jsx)("div",{style:d.iconContainer,children:(0,J.jsx)(In.Z,{disabled:!0,icon:c,isEmptyPage:!1,size:28,title:n.name,isLarge:!0,emojiSize:24,isRaw:!1})}),(0,J.jsxs)("div",{style:d.textContainer,children:[(0,J.jsx)(le.Z,{style:d.name,isMultiline:!0,children:(0,J.jsx)(ta,{workspace:n})}),(0,J.jsx)(le.Z,{style:d.byline,children:Array.isArray(n.membersCount)?1===n.membersCount.length?(0,J.jsx)(h.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd}+ members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersLowerEndRange",values:{plan:(0,Mt.t1)(n.plan,a),lowerEnd:n.membersCount[0]}}):(0,J.jsx)(h.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd} - {higherEnd} members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersRange",values:{plan:(0,Mt.t1)(n.plan,a),lowerEnd:n.membersCount[0],higherEnd:n.membersCount[1]}}):(0,J.jsx)(h.FormattedMessage,{defaultMessage:"{plan} · {numMembers} {numMembers, plural, one {member} other {members}}",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembers",values:{plan:(0,Mt.t1)(n.plan,a),numMembers:n.membersCount}})})]}),(0,J.jsx)("div",{children:(0,J.jsx)(Vt.Z,{isRed:!0,onClick:async function(){Ko.wV(l,{external_space_id:n.id});const e="number"==typeof n.membersCount?n.membersCount:n.membersCount[0],{accept:o}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.message",defaultMessage:"Remove user from workspace?"})}),description:(0,J.jsx)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:e>1?(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.description",defaultMessage:"This user will no longer have access to the workspace you are removing them from. This action is not reversible."}):(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.descriptionWithDeletion",defaultMessage:"This user will no longer have access to the workspace you are removing them from. <b>The workspace will be deleted</b> since this user is the only member. This action is not reversible.",values:{b:e=>(0,J.jsx)("b",{children:e})}})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.acceptLabel",defaultMessage:"Remove"}),cancelLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!o)return;const a=await C.removeManagedUserFromSpace(l,{userId:t,targetSpaceId:n.id,requestingSpaceId:s.id});Ko.dw(l,{external_space_id:n.id}),"success"===a.type?(i(t,n.id),zo.oV({label:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Successfully removed user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceConfirmation",values:{workspaceName:n.name}})})):zo.oV({label:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Failed to remove user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceFailure",values:{workspaceName:n.name}})})},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Remove",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspace"})})})]})})}const Oa=(0,h.defineMessages)({namePlaceholder:{defaultMessage:"Display name",id:"identityAndProvisioning.managedUsers.table.userAccess.namePlaceholder"},emailPlaceholder:{defaultMessage:"Email",id:"identityAndProvisioning.managedUsers.table.userAccess.emailPlaceholder"},supportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.supportAccessFailed"}});function Ea(e){let{spaceStore:t,managedUser:s,onClose:n,removeWorkspaceFromUser:i}=e;const o=Boolean(s);return(0,J.jsx)(wo.Z,{open:o,onDismiss:n,preventHideChildrenWhileOpening:!0,render:()=>s?(0,J.jsx)(Na,{spaceStore:t,managedUser:s,removeWorkspaceFromUser:i}):null})}function Na(e){let{spaceStore:t,managedUser:s,removeWorkspaceFromUser:i}=e;window.__c={n:"ManagedUserDetailsScene"};const l=(0,h.useIntl)(),d=(0,o.O7)(),c=(0,a.VK)((()=>new me.U6(d,{id:s.userId,table:R.KJ})),[s,d]),u=(0,a.VK)((()=>t.id),[t]),{hasStagedChanges:m,resetState:p,saveChanges:g,loading:f,profilePhoto:x,name:y,email:S}=function(e){const{userStore:t}=e,s=(0,h.useIntl)(),i=(0,o.O7)(),{userProfilePhoto:r,userName:l,userEmail:d,isSuspended:c}=(0,a.VK)((()=>({userProfilePhoto:t.getProfilePhoto(),userName:t.getFullName(s),userEmail:t.getEmail(),isSuspended:t.getIsSuspended()})),[t,s]),[u,m]=(0,n.useState)({loading:!1,error:void 0}),[p,g]=(0,n.useState)({value:r,loading:!1}),[f,x]=(0,n.useState)(l),[y,S]=(0,n.useState)(d);return{hasStagedChanges:p.value!==r||f!==l||y!==d,saveChanges:async function(){var e;const n=null===(e=_e.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(!n)return;const o=[];p.value!==r&&o.push("profile_photo"),f!==l&&o.push("name"),y!==d&&o.push("email"),Ko.am(i,{user_status:c?"suspended":"notSuspended",edited_fields:o});const{accept:a}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.message",defaultMessage:"Confirm changes"})}),description:(0,J.jsxs)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.description",defaultMessage:"Changes made to this user's account will be reflected across all workspaces they have access to."}),(0,J.jsx)("br",{}),(0,J.jsx)("br",{}),(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.descriptionForScim",defaultMessage:"If this user is being provisioned through SCIM, your changes be later overwritten by the next SCIM sync."})]}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.acceptLabel",defaultMessage:"Save changes"}),cancelLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!a)return;m({loading:!0,error:void 0});const u=await C.updateUserProfile(i,{userId:t.id,spaceId:n,name:f,email:y,profilePhoto:p.value});if(Ko.$B(i,{user_status:c?"suspended":"notSuspended",edited_fields:o}),"failed"===u.type)return v.showErrorMessage((0,D.wf)(s,u)),void m({loading:!1,error:u.error});zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"managedUsers.toastMessage.updateProfileData.success",defaultMessage:"Successfully updated user's profile"})}),setTimeout((()=>{m({loading:!1,error:void 0})}),500)},resetState:function(){g({value:r,loading:!1}),x(l),S(d)},loading:u.loading,error:u.error,profilePhoto:{value:p.value,loading:p.loading,set:function(){Fa.cR({environment:i,onStart:()=>{g((e=>({...e,loading:!0})))},bucket:"public",onError:()=>{g((e=>({...e,loading:!1}))),v.showErrorMessage(s.formatMessage(_a.uploadFailed))},onComplete:e=>{const t=e[0];g({value:t,loading:!1})},accept:"image/*"})},remove:function(){g({value:"",loading:!1})}},name:{value:f,set:x},email:{value:y,set:S}}}({userStore:c}),{isAccessGranted:b,toggleDataAccessConsent:M,loading:j}=Da({userId:s.userId,spaceId:u}),k=(0,a.VK)((()=>c.getIsSuspended()?{type:"suspended"}:(0,ka.os)({profilePhoto:x.value,name:y.value,email:S.value})),[c,x.value,y.value,S.value]),T=function(e){const{loadingSupportAccess:t}=e;return(0,r.yK)((e=>({container:{position:"relative",display:"flex",flexDirection:"column",background:e.popoverBackground,width:420,maxHeight:520,overflow:"hidden",borderRadius:8},innerContainer:{position:"relative",display:"flex",flexDirection:"column",width:"100%",height:"100%",overflowY:"auto",padding:"36px 24px",gap:16},label:{color:e.mediumTextColor},horizontalLabel:{color:e.mediumTextColor,display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:4},value:{color:e.regularTextColor},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground},avatarContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500},inputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%",gap:8},inputRow:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},icon:{color:e.lightIconColor,fill:"currentColor",width:14,height:14},supportAccessRow:{position:"relative",width:"100%",opacity:t?.5:1},infoContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},infoRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},footer:{position:"absolute",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingInline:4,boxShadow:e.borderBoxShadow,background:e.popoverBackground,left:0,right:0,bottom:0,height:48},button:{height:30,marginInline:4}})),[t])}({loadingSupportAccess:j}),I=(0,ja.E2)(l),P=(0,a.VK)((()=>!zt.Z.state.online),[]),Z=s.mfaMethods.filter((e=>"backup_code"!==e)),F=l.formatList(Z.map((e=>(0,w.cR)(e))),{type:"conjunction"});return(0,J.jsxs)("div",{style:T.container,children:[(0,J.jsxs)("div",{style:T.innerContainer,children:[(0,J.jsx)("div",{style:T.avatarContainer,children:(0,J.jsx)(ka.ZP,{size:56,avatarType:k,isOffline:P,loading:x.loading,onUploadProfilePhoto:x.set,onRemoveProfilePhoto:x.remove})}),(0,J.jsxs)("div",{style:T.inputContainer,children:[(0,J.jsxs)("div",{style:T.inputRow,children:[(0,J.jsx)(Ta.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.nameLabel",defaultMessage:"Name"})}),(0,J.jsx)(no.Z,{style:T.input,disabled:f,value:y.value,placeholder:l.formatMessage(Oa.namePlaceholder),onChange:e=>{y.set(e.target.value)}})]}),(0,J.jsxs)("div",{style:T.inputRow,children:[(0,J.jsx)(Ta.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emailLabel",defaultMessage:"Email"})}),(0,J.jsx)(no.Z,{style:T.input,disabled:f,value:S.value,placeholder:l.formatMessage(Oa.emailPlaceholder),onChange:e=>{S.set(e.target.value)}})]})]}),(0,J.jsxs)("div",{style:T.infoContainer,children:[(0,J.jsxs)("div",{style:T.infoRow,children:[(0,J.jsx)(le.Z,{style:T.label,isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.accountCreatedLabel",defaultMessage:"Account created"})}),s.accountCreatedAt?(0,J.jsx)(le.Z,{isSmall:!0,style:T.value,children:(0,Ma.Yx)(s.accountCreatedAt,"medium",I)}):(0,J.jsx)(le.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyAccountCreated",defaultMessage:"Incomplete"})})]}),(0,J.jsx)(Ms.Z,{size:16}),(0,J.jsxs)("div",{style:T.infoRow,children:[(0,J.jsx)(le.Z,{style:T.label,isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.lastActiveLabel",defaultMessage:"Last active"})}),s.lastActiveAt?(0,J.jsx)(le.Z,{isSmall:!0,style:T.value,children:(0,wa.gs)(s.lastActiveAt)}):(0,J.jsx)(le.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyLastActive",defaultMessage:"No activity"})})]}),(0,J.jsx)(Ms.Z,{size:16}),(0,J.jsxs)("div",{style:T.infoRow,children:[(0,J.jsx)(le.Z,{style:T.label,isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.mfaLabel",defaultMessage:"2-step verification method"})}),Z.length>0?(0,J.jsx)(le.Z,{isSmall:!0,style:T.value,children:F}):(0,J.jsx)(le.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyMfa",defaultMessage:"Not configured"})})]}),(0,J.jsx)(Ms.Z,{size:16}),(0,J.jsx)("div",{style:T.supportAccessRow,children:(0,J.jsx)(Za,{title:(0,J.jsxs)(le.Z,{style:T.horizontalLabel,isSmall:!0,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage",defaultMessage:"Support access"}),(0,J.jsx)(re.ZP,{placement:re.ug.Bottom,render:e=>(0,J.jsx)("div",{...e,children:(0,Bo.m)(T.icon)}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage.tooltip",defaultMessage:"Grant Notion support temporary access to this account so we can troubleshoot problems or recover content on its behalf"})})]}),byline:null,isOn:b,onToggle:M,disabled:j})})]}),(0,J.jsx)("div",{children:s.workspaces.length>0?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Ta.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.workspacesLabel",defaultMessage:"Workspaces"})}),(0,J.jsx)(Ba,{userId:s.userId,workspaces:s.workspaces,spaceStore:t,removeWorkspaceFromUser:i})]}):null})]}),(0,J.jsx)(Ca.Z,{isVisible:m||f,enterAnimationStyle:{translateY:48,opacity:0},animationStyle:{opacity:1,translateY:0},exitAnimationStyle:{translateY:48,opacity:0},render:()=>(0,J.jsxs)("div",{style:T.footer,children:[(0,J.jsx)(ws.Z,{isRed:!0,disabled:f,style:T.button,onClick:p,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.cancelButton",defaultMessage:"Cancel"})}),(0,J.jsx)(Ws.Z,{disabled:f,style:T.button,onClick:g,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.saveButton",defaultMessage:"Save changes"})})]})})]})}function Va(e){let{selectedSpaceId:t,setSelectedSpaceId:s,spaceData:n}=e;window.__c={n:"WorkspacesFilter"};const i=(0,h.useIntl)(),o=(0,r.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"},container:{padding:"6px 0 6px"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:6,fill:"currentColor"}})),[]),l=(0,a.VK)((()=>n.map((e=>{const t=e.name,s=e.icon?{pointer:{table:wi.bx,id:e.id,spaceId:e.id},icon:e.icon}:void 0;return{key:e.id,value:e.id,title:(0,J.jsxs)("div",{style:o.optionContainer,children:[(0,J.jsx)(In.Z,{disabled:!0,icon:s,isEmptyPage:!1,size:24,title:t,isLarge:!0,emojiSize:24,isRaw:!1}),(0,J.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,J.jsx)(le.Z,{style:o.optionTitle,children:t}),(0,J.jsx)(le.Z,{style:o.optionCaption,children:(0,Mt.t1)(e.subscriptionTier,i)})]})]})}}))),[n,i,o]);return(0,J.jsx)(Sa.u,{pillTitle:(0,J.jsx)(h.FormattedMessage,{id:"managedUsersTab.table.filters.workspaces.title",defaultMessage:"Workspace"}),pillIcon:xt.K,selectedItem:t,setSelectedItem:s,items:l})}const Ua=(0,h.defineMessages)({placeholder:{id:"identityProvisioningSettings.managedUsers.searchInput.placeholder",defaultMessage:"Search name, email, or user ID"}});function Wa(e){let{spaceStore:t,samlConfigStore:s}=e;window.__c={n:"ManagedUsersPage"};const{navigateTo:i}=(0,n.useContext)(Ro),l=(0,o.O7)(),d=(0,h.useIntl)(),c=(0,r.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:g.Z.fontWeight.semibold,fontSize:17,display:"flex",justifyContent:"flex-start",alignItems:"center"},byline:{fontSize:14,fontWeight:g.Z.fontWeight.regular,color:e.mediumTextColor,paddingBottom:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"},filters:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",margin:"0 auto 12px"}})),[]),u=(0,a.VK)((()=>s.state.spaces),[s]),{managedUsers:m,filters:p,loadNextPage:f,setFilters:x,removeWorkspaceFromUser:y,loading:S,selectedTab:b,setSelectedTab:j,onOpenDetailsModal:w,onCloseDetailsModal:k,selectedUser:T,managedUserActionSections:I}=function(e){let{spaceStore:t,samlConfigStore:s}=e;const i=(0,o.O7)(),r=(0,h.useIntl)(),[l,d]=(0,n.useState)(),[c,u]=(0,n.useState)(Ho.NotSuspended),m=(0,a.VK)((()=>i.currentUser.id),[i]),p=(0,n.useCallback)(((e,t)=>{Ko.JX(i,{user_status:Qo(c),from:t}),d(e.userId)}),[i,c]),g=Go({userStatus:"notSuspended",spaceStore:t,samlConfigStore:s}),f=Go({userStatus:"suspended",spaceStore:t,samlConfigStore:s});let x;x=c===Ho.NotSuspended?g:f;const y=(0,n.useCallback)((async e=>{Ko.rZ(i);const{accept:s}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Suspend this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.title"})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.acceptLabel"}),description:(0,J.jsx)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"This user will not be able to log into Notion and their Notion integrations will stop working. They can be unsuspended at any time from the Managed Users dashboard.",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.description"})})});if(!s)return;const n=await C.updateUserSuspension(i,{userId:e.userId,spaceId:t.id,suspend:!0});Ko.rv(i),"failed"===n.type&&v.showErrorMessage((0,D.wf)(B.default.getIntl(),n)),f.addUserToManagedUsers(e),g.removeUserFromManagedUsers(e.userId)}),[i,t.id,f,g]),S=(0,n.useCallback)((async e=>{Ko.NF(i);const{accept:s}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Log out this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.title"})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Log out user",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.acceptLabel"}),description:(0,J.jsx)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.description",defaultMessage:"You are about to log out this user from their current session. They will need to re-authenticate to log back into Notion."})})});if(!s)return;const n=await C.logoutManagedUsers(i,{spaceId:t.id,target:{type:Wo.User,userId:e.userId}});if(Ko._m(i),"failed"===n.type)return v.showErrorMessage((0,D.wf)(B.default.getIntl(),n)),void zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"managedUsers.toastMessage.logout.failed",defaultMessage:"Failed to logged out user"})});zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"managedUsers.toastMessage.logout.success",defaultMessage:"Successfully logged out user"})})}),[i,t.id]),b=(0,n.useCallback)((async e=>{Ko.Zm(i);const{accept:s}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Reset password for this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.title"})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.acceptLabel",defaultMessage:"Reset passwords for user"}),description:(0,J.jsx)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.description",defaultMessage:"You are about to reset the password for this user. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}This user will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,J.jsx)("br",{})}})})});if(!s)return;const n=await C.resetPasswordsForManagedUsers(i,{spaceId:t.id,target:{type:Wo.User,userId:e.userId}});if(Ko.vC(i),"failed"===n.type)return v.showErrorMessage((0,D.wf)(r,n)),void zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.fail",defaultMessage:"Failed to reset password for user"})});zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.success",defaultMessage:"Successfully reset password for user"})})}),[i,r,t.id]),M=(0,n.useCallback)((async e=>{const s=await C.updateUserSuspension(i,{userId:e.userId,spaceId:t.id,suspend:!1});Ko.Ci(i),"failed"===s.type&&v.deprecatedShowErrorMessage(s.error.message),f.removeUserFromManagedUsers(e.userId),g.addUserToManagedUsers(e)}),[i,t.id,f,g]),j=(0,n.useCallback)((async e=>{Ko.P1(i,{user_status:Qo(c)});const{accept:s}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Delete this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.title"})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.acceptLabel"}),description:(0,J.jsx)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"This action cannot be undone. This will permanently delete the user's entire account. All private workspaces will be deleted, and they will be removed from all shared workspaces.",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.description"})})});if(!s)return;const n=await C.deleteManagedUser(i,{userId:e.userId,spaceId:t.id});Ko.j7(i,{user_status:Qo(c)}),"failed"===n.type&&v.deprecatedShowErrorMessage(n.error.message),f.removeUserFromManagedUsers(e.userId),g.removeUserFromManagedUsers(e.userId)}),[i,c,t.id,f,g]),w=(0,n.useMemo)((()=>x.managedUsers.find((e=>{let{userId:t}=e;return t===l}))),[l,x.managedUsers]),k=(0,n.useMemo)((()=>{let e;const t={onClick:e=>p(e,"dropdown_menu"),icon:Eo.R,title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.userDetails",defaultMessage:"Edit details"})},s={onClick:e=>j(e),icon:Uo.y,title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser",defaultMessage:"Delete user"}),isDestructive:!0};switch(c){case Ho.NotSuspended:e=[[t,{onClick:S,icon:Oo.S,title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logout",defaultMessage:"Log out"})},{onClick:b,icon:No.z,title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.passwordReset",defaultMessage:"Reset password"})}],[{onClick:y,icon:Lo.V,title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser",defaultMessage:"Suspend user"}),getDisabledState:e=>e.userId===m},s]];break;case Ho.Suspended:e=[[t],[{onClick:e=>M(e),icon:Vo.u,title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.unSuspendUser",defaultMessage:"Reactivate user"})},s]];break;default:(0,Fs.t1)(c)}return e.filter((e=>e.length>0))}),[p,m,c,j,y,M,S,b]);return{...x,selectedTab:c,setSelectedTab:u,selectedUser:w,managedUserActionSections:k,onOpenDetailsModal:p,onCloseDetailsModal:function(){d(void 0)}}}({spaceStore:t,samlConfigStore:s}),P=(0,n.useCallback)((e=>w(e,"row_click")),[w]);return(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(js.Z,{style:c.link,onClick:()=>i(Zo),children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,J.jsxs)(et.Z,{large:!0,style:c.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.title",defaultMessage:"User management"}),(0,J.jsx)(vn.Z,{icon:Bo.m,ariaLabel:d.formatMessage({defaultMessage:"Managed users settings help button",id:"identityProvisioningSettings.managedUsers.helpButton.label"}),onClick:()=>M.D({environment:l,url:(0,Ze.UY)("guides.managedUsers")})})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:c.byline,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.byline",defaultMessage:"Manage and view users that are using your verified domains"})}),(0,J.jsx)(po.Z,{tabs:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.notSuspendedTab.title",defaultMessage:"Active"},"notSuspended.title"),(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.suspendedTab.title",defaultMessage:"Suspended"},"suspended")],selectedIndex:b,onChange:e=>j(e),style:c.tabBarMenu}),(0,J.jsx)(ii.O,{mode:ii.p.Button,query:p.query,setQueryFilter:e=>{x({query:e})},placeholderText:B.default.formatMessage(Ua.placeholder)}),(0,J.jsxs)("div",{style:c.filters,children:[(0,J.jsx)(Va,{selectedSpaceId:p.workspaceId,setSelectedSpaceId:e=>{x({workspaceId:e})},spaceData:u}),(0,J.jsx)(va,{selectedMfaMethod:p.multiFactorStatus,setSelectedMfaMethod:e=>{x({multiFactorStatus:e})}})]}),(0,J.jsx)(fa,{managedUsers:m,loading:S,loadMoreManagedUsers:f,onEditDetails:P,managedUserActionSections:I},b),(0,J.jsx)(Ea,{spaceStore:t,managedUser:T,onClose:k,removeWorkspaceFromUser:y})]})}function Ka(e){let{environment:t,samlConfigStore:s}=e;const n=s.state.emailDomains.length>0,i=(0,jt.zt)();return n||("business"===i||"enterprise"===i)}var za=s(81236);async function qa(e){let{onRequest:t,onSuccess:s}=e;const n=await t();switch(n.type){case"success":s&&await s(n);break;case"failed":v.showErrorMessage((0,D.wf)(B.default.getIntl(),n));break;default:(0,Fs.t1)(n)}}function Ga(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;const r=(0,o.O7)(),l=(0,a.VK)((()=>s.state.emailDomains),[s]),d=(0,a.VK)((()=>"disabled"!==s.state.status&&"unconfigured"!==s.state.status),[s]),c=(0,a.VK)((()=>Ka({environment:r,samlConfigStore:s})),[s,r]),u=(0,a.VK)((()=>c&&(!s.state.id||s.state.id===t.id)),[c,s,t]),m=(0,a.VK)((()=>i.state.emailDomains.length>0&&(0,jt.wP)()),[i]),p=(0,a.VK)((()=>l.length>0),[l]),g=(0,n.useCallback)((async()=>{if(s.state.emailDomains.length>0)return qa({onRequest:()=>C.updateWorkspaceCreationForEmailDomains(r,{emailDomains:s.state.emailDomains,workspaceCreationEnum:i.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{i.setState({...i.state,emailDomains:s.state.emailDomains})}})}),[r,t,i,s]),h=(0,n.useCallback)((async()=>{if(s.state.emailDomains.length>0)return qa({onRequest:()=>C.updateEmailDomainSettings(r,{emailDomains:s.state.emailDomains,spaceId:t.id,preventProfileEdits:i.state.settings.prevent_profile_edits,preventMembersJoiningExternalWorkspace:i.state.settings.prevent_members_joining_external_workspace,customSessionDuration:ea(i.state.settings.custom_session_duration),preventGrantingSupportAccess:i.state.settings.prevent_granting_support_access}),onSuccess:()=>{i.setState({...i.state,emailDomains:s.state.emailDomains})}})}),[r,t,i,s]),f=(0,a.VK)((()=>c&&(0,jt.wP)()),[c]);return{verifiedDomains:l,isSamlStatusEnabled:d,isSamlAvailable:c,isSamlEditable:u,isDomainSettingsAvailable:m,isClaimSpacesAvailable:f,canSaveWorkspaceCreationSetting:p,saveWorkspaceCreationSetting:g,saveEmailDomainSettings:h}}var Ha=s(91694);function Qa(e){let{title:t,byline:s,targetTier:i}=e;window.__c={n:"Upsell"};const a=(0,o.O7)(),r=(0,n.useCallback)((()=>Wi.y(a,{from:"space_saml",for:i})),[a,i]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(et.Z,{smallMarginBottom:!0,style:{fontWeight:g.Z.fontWeight.regular,display:"flex",alignItems:"center"},children:[(0,J.jsx)("span",{style:{marginRight:8},children:t}),(0,J.jsx)(Ha.Z,{subscriptionTier:i,analyticsName:"space_saml",onClick:r})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:s})]})}const Ya={browseWorkspaces:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Browse workspaces",id:"identityAndProvisioning.claimWorkspaces.button"}),noWorkspaces:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty"}),loadingError:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Error loading workspaces.",id:"identityAndProvisioning.claimWorkspaces.errorByline"})};function $a(e){let{promptUpgrade:t}=e;window.__c={n:"ClaimSpaces"};const{navigateTo:s,loadingSpaces:i,hasBrowsableSpaces:o,errorClaimableSpaces:a}=(0,n.useContext)(Ro),l=Boolean(a),d=!o||i,c=!o&&!i,u=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"}),m=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain."}),p=(0,r.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:d?.5:1,minWidth:160},settingErrorByline:{color:e.errorText,marginTop:8,fontSize:13}})),[d]);if(t)return(0,J.jsx)(Qa,{title:u,byline:m,targetTier:"enterprise"});let g;return g=i?(0,J.jsx)(Es.Z,{}):o?Ya.browseWorkspaces:Ya.noWorkspaces,(0,J.jsx)("div",{style:p.settingContainer,children:(0,J.jsx)(Pa,{title:u,byline:m,settingItem:(0,J.jsxs)("div",{style:p.buttonAndErrorContainer,children:[(0,J.jsx)(re.ZP,{placement:re.ug.Top,alignment:re.v2.End,render:e=>(0,J.jsx)(ws.Z,{disabled:d,isLarge:!0,style:p.button,onClick:()=>s(Fo),...e,children:g}),disableTooltip:!c,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim"})}),l?(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:p.settingErrorByline,children:Ya.loadingError}):null]})})})}var Ja=s(52507),Xa=s(86249);function er(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:i,disabled:l,saveWorkspaceCreationSetting:d}=e;window.__c={n:"EmailDomains"};const c=(0,o.O7)(),u=(0,a.qz)(void 0,Ja.ZP),m=(0,r.yK)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginLeft:"auto",marginRight:0,opacity:l?.5:1},plusIcon:{width:14,height:14,fill:"inherit",marginRight:"6px"}})),[l]),p=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),f=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on."}),x=[...(0,a.VK)((()=>s.state.emailDomains.map(Xa.f4)),[s]),...(0,a.VK)((()=>s.state.domainVerifications.filter((e=>!s.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(Xa.UV)),[s])],y=(0,n.useCallback)((async()=>{await Po({environment:c,spaceId:t.id,store:s})}),[c,t,s]),{resetInitialClaimableSpaces:S}=(0,n.useContext)(Ro),v=(0,n.useCallback)((async e=>{switch(e.type){case"verified":return qa({onRequest:()=>C.setSamlConfig(c,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:async()=>{await y(),S()}});case"unverified":case"invalid":return qa({onRequest:()=>C.deleteDomainVerificationCode(c,{id:e.id}),onSuccess:()=>y()})}}),[c,t,y,S]),b=(0,n.useCallback)((()=>qa({onRequest:()=>C.setSamlConfig(c,{spaceId:t.id}),onSuccess:()=>y()})),[c,y,t]),M=(0,n.useCallback)((async()=>{await y(),await d()}),[d,y]);return i?(0,J.jsx)(Qa,{title:p,byline:f,targetTier:"business"}):(0,J.jsx)(Xa.ZP,{disabled:l,domains:x,onRemoveDomain:v,domainVerificationStore:u,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:M,onClickAddDomain:b,renderOverrideAddDomainButton:e=>(0,J.jsxs)("div",{style:m.flex,children:[(0,J.jsxs)("div",{children:[(0,J.jsx)(et.Z,{smallMarginBottom:!0,style:{fontWeight:g.Z.fontWeight.medium},children:p}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4},children:f})]}),(0,J.jsx)("div",{children:(0,J.jsx)(Vt.Z,{isBlue:!0,style:m.button,icon:e=>(0,zi.R)({...e,...m.plusIcon}),disabled:l,onClick:e,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})})})]})})}function tr(e){let{domainSettingsStore:t,samlConfigStore:s,disabled:i,promptUpgrade:l,verifiedDomains:d,tooltip:c,saveWorkspaceCreationSetting:u}=e;window.__c={n:"WorkspaceCreation"};const m=(0,o.O7)(),p=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),g=(0,a.VK)((()=>{const e=s.state.id;if(!e)return;return new me.H2(m,{table:wi.bx,id:e}).getName()}),[m,s]),f=(0,n.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await u(),y.tir(m,{workspace_creation:e})}),[t,u,m]),x=(0,a.VK)((()=>d.length>0?t.state.spaceCreation:"admins_only"),[t,d]),S=(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"}),v=(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces."}),b=(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",values:{primaryWorkspaceName:g}}),M=(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners"});return l?(0,J.jsx)("div",{style:p.settingContainer,children:(0,J.jsx)(Qa,{title:S,byline:v,targetTier:"enterprise"})}):(0,J.jsx)(re.ZP,{placement:re.ug.Top,alignment:re.v2.End,render:e=>(0,J.jsx)("div",{...e,style:p.settingContainer,children:(0,J.jsx)(mo.Z,{isMobile:m.device.isMobile,disabled:i,title:S,caption:v,type:"dropdown",currentOption:x,options:[{key:"unrestricted",label:(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces."})},{key:"admins_only",label:g?b:M,caption:(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces."})}],onSelectOption:f})}),disableTooltip:!c,renderTooltip:()=>c})}function sr(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n,isCurrentSpaceEnterprise:i}=e;window.__c={n:"DomainSection"};const{verifiedDomains:o,isSamlAvailable:a,saveWorkspaceCreationSetting:r,isSamlEditable:l,isDomainSettingsAvailable:d,canSaveWorkspaceCreationSetting:c,isClaimSpacesAvailable:u}=Ga({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),m=d&&l;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(er,{disabled:!l,promptUpgrade:!a,spaceStore:t,samlConfigStore:s,saveWorkspaceCreationSetting:r}),(0,J.jsx)(tr,{disabled:!m||!c,promptUpgrade:!i,verifiedDomains:o,samlConfigStore:s,domainSettingsStore:n,tooltip:0===o.length?(0,J.jsx)(h.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting."}):void 0,saveWorkspaceCreationSetting:r}),(0,J.jsx)($a,{promptUpgrade:!u})]})}var nr=s(74523);function ir(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,disabled:l}=e;window.__c={n:"CustomSessionDurationSetting"};const d=(0,o.O7)(),c=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),u=(0,n.useMemo)((()=>Object.entries($o.nb).map((e=>{let[t,s]=e;return{key:t,label:(0,J.jsx)(le.Z,{children:(0,wa.hH)(0,s)})}}))),[]),m=(0,a.VK)((()=>ea(t.state.settings.custom_session_duration)??$o.gl),[t]),p=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"}),g=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.message",defaultMessage:"Control how long your managed users can be logged in for before they must re-authenticate."});return i?(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Qa,{title:p,byline:g,targetTier:"enterprise"})}):(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(mo.Z,{isMobile:d.device.isMobile,disabled:l,title:p,caption:g,type:"dropdown",currentOption:m,options:u,onSelectOption:async function(e){const n=t.state.settings.custom_session_duration??$o.nb[$o.gl],i=$o.nb[e];if(void 0===i)return;Ko.LO(d,{custom_session_duration_ms:n});const{accept:o}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.message",defaultMessage:"Confirm change"})}),description:(0,J.jsxs)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.description",defaultMessage:"You are about to change the session duration for all of your managed users from <b>{oldDuration}</b> to <b>{newDuration}.</b>",values:{oldDuration:(0,wa.hH)(0,n),newDuration:(0,wa.hH)(0,i),b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,J.jsx)("b",{children:t})}}}),(0,J.jsx)("br",{}),(0,J.jsx)("br",{}),(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.secondDescription",defaultMessage:"This may log some users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})]}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.acceptLabel",defaultMessage:"Confirm change"}),cancelLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.cancelLabel",defaultMessage:"Cancel"})});o&&(t.setState({...t.state,settings:{...t.state.settings,custom_session_duration:i}}),Ko.l0(d,{new_session_duration_ms:i}),await s())}})})}function or(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:n,verifiedDomains:i,disabled:a}=e;window.__c={n:"ForcePasswordResetSetting"};const l=i.length>0,d=(0,o.O7)(),c=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&l?1:.5}})),[a,l]),u=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"}),m=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.message",defaultMessage:"Force reset the passwords for all managed users and require them to create a new one the next time they log in."});async function p(){Ko.Jo(d,{email_domains:i});const{accept:e}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.message",defaultMessage:"Reset passwords for your managed users?"})}),description:(0,J.jsx)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.description",defaultMessage:"You are about to reset the passwords for of your managed users, including you. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}The affected users will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,J.jsx)("br",{})}})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.acceptLabel",defaultMessage:"Reset passwords for all managed users"}),cancelLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const n=s.state.emailDomains;await C.resetPasswordsForManagedUsers(d,{spaceId:t,target:{type:Wo.Domains,emailDomains:n}}),zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.all.success",defaultMessage:"Successfully reset passwords for all managed users"})}),Ko.aT(d,{email_domains:n})}return n?(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Qa,{title:u,byline:m,targetTier:"enterprise"})}):(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Pa,{title:u,byline:m,settingItem:(0,J.jsx)("div",{style:c.buttonAndErrorContainer,children:(0,J.jsx)(re.ZP,{placement:re.ug.Top,alignment:re.v2.End,render:e=>(0,J.jsx)(Vt.Z,{isRed:!0,disabled:a||!l,style:c.button,onClick:p,...e,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.logoutButton",defaultMessage:"Reset passwords for all users"})}),disableTooltip:l,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function ar(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:n,verifiedDomains:i,disabled:a}=e;window.__c={n:"LogoutUsersSetting"};const l=i.length>0,d=(0,o.O7)(),c=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&l?1:.5}})),[a,l]),u=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"}),m=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.message",defaultMessage:"Force log out all managed users and require them to re-authenticate."});async function p(){Ko.KF(d,{email_domains:i});const{accept:e}=await v.confirmUserActionV2({message:(0,J.jsx)(le.Z,{style:v.dialogStyles.title,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.message",defaultMessage:"Log out all of your managed users?"})}),description:(0,J.jsx)(le.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.description",defaultMessage:"You are about to log all of your managed users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.acceptLabel",defaultMessage:"Log out all managed users"}),cancelLabel:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const n=s.state.emailDomains;await C.logoutManagedUsers(d,{spaceId:t,target:{type:Wo.Domains,emailDomains:n}}),zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"managedUsers.toastMessage.logout.all.success",defaultMessage:"Successfully logged out all managed users"})}),Ko._6(d,{email_domains:n})}return n?(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Qa,{title:u,byline:m,targetTier:"enterprise"})}):(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Pa,{title:u,byline:m,settingItem:(0,J.jsx)("div",{style:c.buttonAndErrorContainer,children:(0,J.jsx)(re.ZP,{placement:re.ug.Top,alignment:re.v2.End,render:e=>(0,J.jsx)(Vt.Z,{isRed:!0,disabled:a||!l,style:c.button,onClick:p,...e,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.logoutButton",defaultMessage:"Log out all users"})}),disableTooltip:l,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function rr(e){let{promptUpgrade:t,hasVerifiedDomains:s,disabled:i}=e;window.__c={n:"ManageUsersButton"};const{navigateTo:a}=(0,n.useContext)(Ro),l=(0,o.O7)(),d=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"}),c=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage and view users that are using your verified domains"}),u=(0,r.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!i&&s?1:.5}})),[s,i]);return t?(0,J.jsx)("div",{style:u.settingContainer,children:(0,J.jsx)(Qa,{title:d,byline:c,targetTier:"enterprise"})}):(0,J.jsx)("div",{style:u.settingContainer,children:(0,J.jsx)(Pa,{title:d,byline:c,settingItem:(0,J.jsx)("div",{style:u.buttonAndErrorContainer,children:(0,J.jsx)(re.ZP,{placement:re.ug.Top,alignment:re.v2.End,render:e=>(0,J.jsx)(ws.Z,{disabled:i||!s,isLarge:!0,style:u.button,onClick:()=>{Ko.pC(l),a(_o)},...e,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"View dashboard",id:"identityAndProvisioning.managedUsers.button"})}),disableTooltip:s,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function lr(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,verifiedDomains:i,disabled:l}=e;window.__c={n:"PreventGrantingSupportAccessSetting"};const d=(0,o.O7)(),c=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),u=i.length>0,m=(0,a.VK)((()=>Boolean(t.state.settings.prevent_granting_support_access)),[t]),p=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"}),g=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.message",defaultMessage:"Control if managed users can enable support access on their accounts."});return n?(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Qa,{title:p,byline:g,targetTier:"enterprise"})}):(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Za,{title:(0,J.jsx)("div",{style:c.settingsTitle,children:p}),byline:g,isOn:m,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_granting_support_access);t.setState({...t.state,settings:{...t.state.settings,prevent_granting_support_access:e}}),Ko.Dn(d,{new_value:e}),await s()},disabled:l||!u})})}function dr(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,disabled:i}=e;window.__c={n:"PreventMembersJoiningExternalSpaces"};const l=(0,o.O7)(),d=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),c=(0,a.VK)((()=>Boolean(t.state.settings.prevent_members_joining_external_workspace)),[t]),u=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"}),m=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed users are able to join workspaces that aren't owned by your organization."});if(n)return(0,J.jsx)("div",{style:d.settingContainer,children:(0,J.jsx)(Qa,{title:u,byline:m,targetTier:"enterprise"})});const p=c?"on":"off";return(0,J.jsx)("div",{style:d.settingContainer,children:(0,J.jsx)(mo.Z,{isMobile:l.device.isMobile,disabled:i,title:u,caption:m,type:"dropdown",currentOption:p,options:[{key:"on",label:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleGeneric",defaultMessage:"Only workspace owners"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.caption",defaultMessage:"Only workspace owners of your connected workspaces can join external workspaces."})},{key:"off",label:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.titleWithSpaceName",defaultMessage:"Anyone"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.caption",defaultMessage:"All users can join any workspace."})}],onSelectOption:async function(){const e=Boolean(!t.state.settings.prevent_members_joining_external_workspace);t.setState({...t.state,settings:{...t.state.settings,prevent_members_joining_external_workspace:e}}),Ko.T4(l,{new_value:e}),await s()}})})}function cr(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,hasVerifiedDomains:i,disabled:l}=e;window.__c={n:"PreventProfileEditsSetting"};const d=(0,o.O7)(),c=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),u=(0,a.VK)((()=>Boolean(t.state.settings.prevent_profile_edits)),[t]),m=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"}),p=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed users can change their preferred name, email address, and profile photo."});return n?(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Qa,{title:m,byline:p,targetTier:"enterprise"})}):(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Za,{title:(0,J.jsx)("div",{style:c.settingsTitle,children:m}),byline:p,isOn:!u,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_profile_edits);t.setState({...t.state,settings:{...t.state.settings,prevent_profile_edits:e}}),Ko.Dn(d,{new_value:e}),await s()},disabled:l||!i})})}function ur(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;window.__c={n:"ManagedUsersSection"};const{verifiedDomains:i,isDomainSettingsAvailable:o,isSamlEditable:l,saveEmailDomainSettings:d}=Ga({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),c=(0,r.yK)((e=>({byline:{fontSize:14,fontWeight:g.Z.fontWeight.regular,color:e.mediumTextColor},helpButton:{marginTop:18,marginBottom:16}})),[]),u=o&&l,m=(0,a.VK)((()=>t.id),[t]),p=(0,a.VK)((()=>(0,jt.wP)()),[]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:c.byline,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."})})}),(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,Ze.UY)("guides.managedUsers"),style:c.helpButton,analyticsFrom:"managed_users_section"}),(0,J.jsx)(rr,{promptUpgrade:!p,hasVerifiedDomains:i.length>0,disabled:!u}),(0,J.jsx)(cr,{promptUpgrade:!p,hasVerifiedDomains:i.length>0,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!u}),(0,J.jsx)(dr,{promptUpgrade:!p,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!u}),(0,J.jsx)(lr,{promptUpgrade:!p,verifiedDomains:i,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!u}),(0,J.jsx)(ir,{promptUpgrade:!p,domainSettingsStore:n,saveEmailDomainSettings:d,disabled:!u}),(0,J.jsx)(ar,{spaceId:m,promptUpgrade:!p,domainSettingsStore:n,verifiedDomains:i,disabled:!u}),(0,J.jsx)(or,{spaceId:m,promptUpgrade:!p,domainSettingsStore:n,verifiedDomains:i,disabled:!u})]})}function mr(e){let{spaceStore:t,samlConfigStore:s}=e;const i=(0,o.O7)();return{updateSamlIdpUrl:(0,n.useCallback)((async e=>{let n=!1;return await qa({onRequest:()=>C.setSamlConfig(i,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{n=!0,s.setState({...s.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),n}),[s,t,i]),updateSamlIdpXml:(0,n.useCallback)((async e=>{let n=!1;return await qa({onRequest:()=>C.setSamlConfig(i,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{n=!0,s.setState({...s.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),n}),[s,t,i]),updateStatus:(0,n.useCallback)((e=>qa({onRequest:()=>C.setSamlConfig(i,{spaceId:t.id,status:e}),onSuccess:()=>{s.setState({...s.state,status:e})}})),[s,t,i]),updateCreateAccount:(0,n.useCallback)((e=>qa({onRequest:()=>C.setSamlConfig(i,{spaceId:t.id,createAccount:e}),onSuccess:()=>{s.setState({...s.state,createAccount:e})}})),[s,t,i])}}function pr(e){let{spaceStore:t,samlConfigStore:s,disabled:n}=e;window.__c={n:"CreateAccountSetting"};const{updateCreateAccount:i}=mr({samlConfigStore:s,spaceStore:t}),l=(0,o.O7)(),d=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),c=(0,a.VK)((()=>s.state.createAccount),[s]);return(0,J.jsx)("div",{style:d.settingContainer,children:(0,J.jsx)(Za,{title:(0,J.jsxs)("div",{style:d.settingsTitle,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),(0,J.jsx)(vn.Z,{icon:Bo.m,onClick:()=>M.D({environment:l,url:(0,Ze.UY)("guides.samlJIT")})})]}),byline:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO."}),isOn:c,onToggle:async function(){await i(!s.state.createAccount)},disabled:n})})}function gr(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:n,disabled:i}=e;window.__c={n:"SamlEnforceSetting"};const l=(0,o.O7)(),{updateStatus:d}=mr({samlConfigStore:s,spaceStore:t}),c=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),u=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),m=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access SAML SSO-enabled workspaces."}),p=(0,a.VK)((()=>"enforced"===s.state.status?"enforced":"not_enforced"),[s]);return n?(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(Qa,{title:u,byline:m,targetTier:"business"})}):(0,J.jsx)("div",{style:c.settingContainer,children:(0,J.jsx)(mo.Z,{isMobile:l.device.isMobile,disabled:i,title:u,caption:m,type:"dropdown",currentOption:p,options:[{key:"enforced",label:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}],onSelectOption:async function(){"enforced"===s.state.status?await d("configured"):await d("enforced")}})})}var hr=s(13991),fr=s(54497),xr=s(5228),yr=s(46978);function Sr(e){let{isOpen:t,...s}=e;window.__c={n:"SamlConfigModal"};const n=(0,a.VK)((()=>({active:s.samlConfigStore.state.useMetadataUrl?"url":"xml",url:s.samlConfigStore.state.idpMetadataUrl||"",xml:s.samlConfigStore.state.idpMetadata||""})),[s.samlConfigStore]);return(0,J.jsx)(wo.Z,{open:t,onDismiss:s.onClose,render:()=>(0,J.jsx)(vr,{...s,initialConfiguration:n})})}function vr(e){let{onSaveChanges:t,initialConfiguration:s,samlConfigStore:i,spaceStore:l,onClose:d}=e;window.__c={n:"SamlConfigSettings"};const[c,u]=(0,n.useState)(s),m=(0,o.O7)(),p=(0,r.yK)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:4,transition:"all 500ms ease"},title:{fontFamily:g.Z.getCompositeFontFamily(hr.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:g.Z.getCompositeFontFamily(hr.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:4,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:g.Z.getCompositeFontFamily(hr.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:g.Z.getCompositeFontFamily(hr.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:4},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),f=(0,n.useMemo)((()=>Mr(c)),[c]),x=(0,a.VK)((()=>"unconfigured"===i.state.status),[i]),y=(0,a.VK)((()=>(0,xr.v9)(l.id,Hi.default.domainBaseUrl)),[l]),S=(0,n.useCallback)((()=>{ie.RD({environment:m,stringValue:y,copiedMessage:ie.tq.copiedLinkToClipboard})}),[m,y]),v=(0,n.useCallback)((()=>{u((e=>({...e,active:"url"})))}),[]),b=(0,n.useCallback)((()=>{u((e=>({...e,active:"xml"})))}),[]),M=(0,r.yK)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:`1px solid ${e.outlineButtonBorder}`}})),[]),j=(0,n.useMemo)((()=>"url"===c.active?{placeholder:"https://...",value:c.url,onChange:e=>{const t=e.target.value;u((e=>({...e,url:t})))},style:{height:32,...M.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:c.xml,onChange:e=>{const t=e.target.value;u((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...M.input},inputStyle:{width:"100%",height:"100%"}}),[c,M]),w=(0,n.useCallback)((()=>{t(c)}),[t,c]);return(0,J.jsxs)("div",{style:p.container,children:[(0,J.jsx)(le.Z,{style:p.title,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration"})}),(0,J.jsx)(le.Z,{isSmall:!0,style:p.centeredCaption,isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>(0,J.jsx)(js.Z,{href:(0,Ze.UY)("guides.samlSettings"),external:!0,children:e})}})}),(0,J.jsx)(le.Z,{style:p.subtitle,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL"})}),(0,J.jsx)(le.Z,{isSmall:!0,style:p.caption,isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration."})}),(0,J.jsxs)("div",{style:p.readonlyInput,children:[(0,J.jsx)(le.Z,{style:p.url,children:y}),(0,J.jsxs)(ae.Z,{onClick:S,style:p.copyButton,children:[(0,ne.U)(p.copyIcon),(0,J.jsx)(h.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy"})]})]}),(0,J.jsx)(le.Z,{style:p.subtitle,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details"})}),(0,J.jsx)(le.Z,{isSmall:!0,style:p.caption,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP."})}),(0,J.jsxs)("div",{style:p.radioContainer,children:[(0,J.jsxs)(Vt.Z,{style:p.radioOption,onClick:v,children:[(0,J.jsx)(yr.Z,{isSelected:"url"===c.active}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL"})})]}),(0,J.jsxs)(Vt.Z,{style:p.radioOption,onClick:b,children:[(0,J.jsx)(yr.Z,{isSelected:"xml"===c.active}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML"})})]})]}),(0,J.jsx)(no.Z,{...j}),(0,J.jsx)("div",{style:p.feedback,children:(0,J.jsx)(br,{validation:f})}),(0,J.jsxs)("div",{style:p.buttonContainer,children:[(0,J.jsx)(ws.Z,{isLarge:!0,style:p.buttonSpacing,onClick:d,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel"})}),(0,J.jsx)(Ws.Z,{isLarge:!0,disabled:"invalid"===f.type,onClick:w,children:x?(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}):(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"})})]})]})}function br(e){let t,{validation:s}=e;if("valid"===s.type)return null;switch(s.reason){case"empty":t=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank"});break;case"signed_request":t=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed"})}return(0,J.jsxs)(J.Fragment,{children:[(0,fr.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,J.jsx)("span",{children:t})]})}function Mr(e){return"url"===e.active?(0,xr.jY)(e.url):"xml"===e.active?(0,xr.a7)(e.xml):void(0,Fs.t1)(e.active)}function jr(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i,isSamlStatusEnabled:o,promptUpgrade:a,disabled:l}=e;window.__c={n:"SamlToggle"};const[d,c]=(0,n.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:u,updateSamlIdpUrl:m,updateSamlIdpXml:p}=mr({samlConfigStore:s,spaceStore:t}),{verifiedDomains:f}=Ga({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),x=(0,r.yK)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:l?"default":"pointer"},settingTitle:{fontWeight:g.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14}})),[l]),y=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),S=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."});return a?(0,J.jsx)(Qa,{title:y,byline:S,targetTier:"business"}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Za,{title:y,byline:S,isOn:o,disabled:l,tooltipForDisabled:0===f.length?(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:function(){if(l)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:n}=s.state,i=e&&n||!e&&t;switch(s.state.status){case"disabled":i?u("configured"):c({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":c({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":u("disabled")}}}),(0,J.jsx)(ws.Z,{disabled:l,disabledFeedback:l,isLarge:!0,style:x.configButton,onClick:function(){l||c({isOpened:!0,enableSamlOnSave:!1})},children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})}),(0,J.jsx)(Sr,{isOpen:d.isOpened,onClose:()=>c({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===Mr(e).type)return;let t=!1;switch(e.active){case"url":t=await m(e.url);break;case"xml":t=await p(e.xml)}t&&(d.enableSamlOnSave&&await u("configured"),c({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:s})]})}var wr=s(39634);const Cr={id:"name",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>(0,J.jsx)(Fr,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},kr={id:"memberCount",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:e.space.memberCount}})}),widthData:{width:20},sortable:!0},Tr={id:"createdAt",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=e.space.createdTime;return(0,J.jsx)(le.Z,{children:t&&(0,Ma.Yx)(t,"medium",hr.SP)})},widthData:{width:20},sortable:!0},Ir=[Cr,kr,Tr];function Pr(e){let{spaceStore:t,spaces:s}=e;window.__c={n:"WorkspacesTable"};const[i,o]=(0,n.useState)({column:Cr,sortAscending:!1}),l=(0,a.VK)((()=>s.map((e=>({id:e.id,isClickable:!1,isCurrentSpace:t.id===e.id,space:e})))),[s,t]),d=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:Ir,theme:e,containerMarginTop:12})),[]);return(0,J.jsx)(oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Ir,rows:Zr(l,i),sortState:i,onSortStateChanged:o,renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:d})}function Zr(e,t){let{column:s,sortAscending:n}=t,i=[];switch(s.id){case"name":i=c.MR(e,(e=>e.space.name));break;case"createdAt":i=c.MR(e,(e=>e.space.createdTime));break;case"memberCount":i=c.MR(e,(e=>e.space.memberCount))}return n?i:i.reverse()}function Fr(e){window.__c={n:"WorkspaceNameCell"};const t=(0,r.yK)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return(0,J.jsxs)(le.Z,{style:t.container,children:[e.space.name,e.isCurrentSpace?(0,J.jsx)(Yi.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})}):null]})}function _r(e){let{spaceStore:t,spaces:s}=e;window.__c={n:"SecondaryWorkspaces"};const i=(0,o.O7)(),a=(0,r.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),l=(0,n.useCallback)((()=>{wr.j({environment:i,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML Single Sign-on on workspace ${t.id}.`})}),[t,i]);return(0,J.jsxs)("div",{style:a.settingContainer,children:[(0,J.jsx)(Pa,{title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>(0,J.jsx)(js.Z,{onClick:l,children:e})}}),settingItem:null}),(0,J.jsx)(Pr,{spaceStore:t,spaces:s})]})}function Ar(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;window.__c={n:"SamlSection"};const{verifiedDomains:i,isSamlAvailable:o,isSamlEditable:r,isSamlStatusEnabled:l}=Ga({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),d=!r||!o||!l,c=(0,a.VK)((()=>s.state.spaces),[s]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,Ze.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),(0,J.jsx)(jr,{disabled:!r||0===i.length,promptUpgrade:!o,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),(0,J.jsx)(gr,{disabled:d,promptUpgrade:!o,spaceStore:t,samlConfigStore:s}),(0,J.jsx)(pr,{disabled:d,spaceStore:t,samlConfigStore:s}),(0,J.jsx)(_r,{spaceStore:t,spaces:c})]})}const Rr=(0,h.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later."}});function Dr(e){window.__c={n:"NewScimTokenButton"};const[t,s]=(0,n.useState)(!1),i=(0,o.O7)();const a=!t&&"Able"===e.tokenCreationAbility,r=t||"Able"!==e.tokenCreationAbility,l=(0,J.jsx)(Vt.Z,{isBlue:a,isLightGray:r,disabled:r,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>(0,zi.R)({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){s(!0);try{const t=await async function(e){let{environment:t,spaceStore:s,userStore:n}=e;const{botStore:i,transactionPromise:o}=Ci.lz({environment:t,spaceStore:s,name:"SCIM",userId:n.id,spaceRole:"editor",type:"scim"});return await o,i.id}({...e,environment:i});e.onNewScimToken(t)}catch(t){v.showErrorMessage(B.default.formatMessage(Rr.failedCreatingNewScimToken))}s(!1)},children:(0,J.jsx)(h.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token"})});let d;switch(e.tokenCreationAbility){case"Able":return l;case"Undefined":d=(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined"});break;case"SpaceHasExistingToken":d=(0,J.jsx)(h.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken"});break;case"UserHasExistingToken":d=(0,J.jsx)(h.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken"});break;default:(0,Fs.t1)(e.tokenCreationAbility)}return(0,J.jsx)(re.ZP,{textWrap:!1,renderTooltip:()=>d,placement:re.ug.Right,render:e=>(0,J.jsx)("div",{...e,style:{paddingLeft:"4px"},children:l})})}var Br=s(15070);function Lr(e){let{userId:t,currentSpaceStore:s}=e;return me.U6.createChildStore(s,{table:R.KJ,id:t})}var Or=s(62385),Er=s(17290);const Nr={container:{display:"flex",alignItems:"center",fontSize:g.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...g.Z.textOverflowStyle}};function Vr(e,t){const s=pi.kk.fromValue(A.cZ,e);return s.getCreatedByTable()===R.KJ&&s.getCreatedById()===t}const Ur={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function Wr(e){let{onRevokeToken:t}=e;window.__c={n:"RevokeTokenButton"};const s=(0,r.Fg)();return(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(re.ZP,{textWrap:!1,renderTooltip:()=>(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})}),placement:re.ug.Right,render:e=>(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,placementToOrigin:Sn.pO.Right,renderOrigin:t=>(0,J.jsx)(ae.Z,{className:Ie.TAd,style:Ur.buttonStyle,mobileFeedback:!1,...e,...t,children:(0,Uo.y)({fill:s.mediumIconColor,width:12,height:12})}),onClick:()=>{v.confirmUserAction({message:(0,J.jsx)(h.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?"}),description:(0,J.jsx)(h.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token."}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token"}),cancelLabel:(0,J.jsx)(h.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel"})}).then((e=>e&&t()))},render:e=>(e.close(),(0,J.jsx)(J.Fragment,{}))})})})}const Kr=()=>{window.__c={n:"OutdatedWarningIcon"};const e=(0,r.Fg)();return(0,J.jsx)(re.ZP,{textWrap:!1,renderTooltip:()=>(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})}),placement:re.ug.Right,render:t=>(0,J.jsx)("div",{...t,style:{paddingLeft:"4px"},children:(0,fr.t)({fill:(0,Ki.fi)("orange",e).fill,width:12,height:12})})})};function zr(e){let{clipboardTextFn:t}=e;window.__c={n:"RenderCopyToClipboardButton"};const s=(0,o.O7)();const n=(0,r.Fg)(),i={height:25,background:n.whiteButtonBackground,color:n.regularTextColor,fontWeight:g.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,J.jsxs)(Or.Z,{onClick:async function(){const e=await t();void 0!==e&&ie.RD({environment:s,stringValue:e,copiedMessage:ie.tq.copiedTokenToClipboard,showCopyModal:!!s.device.isSafari||void 0})},style:i,children:[(0,ne.U)({height:16,width:16,paddingRight:4}),(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]})}const qr="•••••••••••";function Gr(){return(0,J.jsx)(re.ZP,{textWrap:!1,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:re.ug.Right,render:e=>(0,J.jsx)("div",{...e,children:qr})})}function Hr(e){let{row:t}=e;window.__c={n:"BotTokenCell"};const s=(0,o.O7)();return t.legacy?(0,J.jsxs)(J.Fragment,{children:[qr,(0,J.jsx)(Kr,{})]}):t.ownedByCurrentUser?(0,J.jsxs)(J.Fragment,{children:[qr,(0,J.jsx)(zr,{clipboardTextFn:()=>Ci.VG({environment:s,botId:t.id})})]}):(0,J.jsx)(Gr,{})}const Qr={id:"token",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",defaultMessage:"Token"}),renderCell:e=>(0,J.jsx)(Hr,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0},Yr=()=>{const e=Nr;return(0,J.jsx)(re.ZP,{textWrap:!1,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:re.ug.Right,render:t=>(0,J.jsx)("div",{...t,children:(0,J.jsxs)("div",{style:e.container,children:[(0,J.jsx)(Vn.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),(0,J.jsx)("div",{style:e.userName,children:(0,J.jsx)("i",{children:"Deactivated user"})})]})})})},$r={id:"addedBy",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return(0,J.jsx)(Yr,{});{const t=e.ownedByCurrentUser?(0,J.jsx)(le.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)"})}):(0,J.jsx)(J.Fragment,{});return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Er.G,{isClickable:!1,userStores:[e.ownerUserStore]}),t]})}},widthData:{width:40},sortable:!1,hasClickableContents:!1},Jr={id:"created",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",defaultMessage:"Created"}),renderCell:e=>(0,J.jsx)(Ns.T,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},Xr=[Qr,$r,Jr,{id:"revokeToken",headerTitle:void 0,renderCell:e=>(0,J.jsx)(Wr,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function el(e,t){let{column:s,sortAscending:n}=t;const i=null==s?void 0:s.id;let o=e=>e.id;switch(i){case"name":o=e=>e.name;break;case"created":o=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,Fs.t1)(i)}const a=c.MR(e,o);return n||a.reverse(),a}function tl(e){let{botStores:t,onRevokeToken:s}=e;window.__c={n:"ManageScimTokenTable"};const i=(0,a.VK)((()=>_e.default.state.currentUserStore),[]),o=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),l=(0,h.useIntl)(),d=(0,a.VK)((()=>{if(!o)return[];const e=null==i?void 0:i.id;return c.oA(t.map((t=>{const n=t.getModel();if(!n||!(0,Br.xe)(n))return;const i={id:n.id,isClickable:!1,createdAt:n.getCreatedAt(),userLocale:l.locale,name:n.getName(),onRevokeToken:()=>{s(n.id)}},a=function(e){const t=pi.kk.fromValue(A.cZ,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===R.s$.id}(n);return a?{...i,legacy:a}:{...i,legacy:a,ownedByCurrentUser:Vr(n,e),ownerUserStore:"notion_user"===n.getCreatedByTable()?Lr({userId:n.getCreatedById(),currentSpaceStore:o}):void 0}})))}),[t,o,i,l.locale,s]),[u,m]=(0,n.useState)({column:Jr,sortAscending:!1}),p=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:Xr,theme:e,containerMarginTop:0})),[]);return(0,J.jsx)(oe.D,{columnRenderInfo:Xr,rows:el(d,u),sortState:u,onSortStateChanged:m,onRowClick:()=>(0,J.jsx)(J.Fragment,{}),renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens."})}),styles:p})}async function sl(e){let{environment:t,spaceId:s}=e;return(await Ci.Yw({environment:t,table:wi.bx,id:s,type:"scim"})).botIds}const nl=function(e){let{botIds:t,setBotIds:s,spaceStore:i}=e;window.__c={n:"ScimTokenSettings"};const a=(0,o.O7)(),r=i.id;if((0,n.useEffect)((()=>{void 0===t&&sl({environment:a,spaceId:r}).then(s)}),[t,a,s,r]),t){const e=t.map((e=>me.t1.createChildStore(i,{table:A.cZ,id:e,spaceId:r})));return(0,J.jsx)(tl,{botStores:e,onRevokeToken:e=>{Ci.P0({environment:a,botId:e,onSuccess:()=>{sl({environment:a,spaceId:r}).then(s)}})}})}return(0,J.jsx)(Es.Z,{})};function il(e){let{userStore:t,spaceStore:s,promptUpgrade:i}=e;window.__c={n:"ScimTokens"};const[r,l]=(0,n.useState)(void 0),d=(0,o.O7)(),c=(0,a.VK)((()=>function(e){let{botIds:t,spaceStore:s,environment:n}=e;if(void 0===t)return"Undefined";const i=t.map((e=>me.t1.createChildStore(s,{table:A.cZ,id:e,spaceId:s.id}))).filter((e=>e.isDefined()));if(i.some((e=>e.getCreatedByTable()===R.KJ&&e.getCreatedById()===R.s$.id)))return"SpaceHasExistingToken";if(i.some((e=>e.getCreatedByTable()===R.KJ&&e.getCreatedById()===n.currentUser.id)))return"UserHasExistingToken";return"Able"}({botIds:r,spaceStore:s,environment:d})),[r,d,s]),u=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),m=(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return i?(0,J.jsx)(Qa,{title:u,byline:m,targetTier:"enterprise"}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Pa,{title:u,byline:m,settingItem:(0,J.jsx)(Dr,{onNewScimToken:e=>l((t=>[...t??[],e])),spaceStore:s,userStore:t,tokenCreationAbility:c})}),(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,Ze.UY)("guides.scim"),analyticsFrom:"scim_settings"}),(0,J.jsx)(nl,{spaceStore:s,userStore:t,botIds:r,setBotIds:l})]})}function ol(e){let{userStore:t,spaceStore:s}=e;window.__c={n:"ScimSection"};const n=(0,a.VK)((()=>(0,jt.wP)()),[]);return(0,J.jsx)(il,{promptUpgrade:!n,userStore:t,spaceStore:s})}function al(e){let{primarySpaceName:t}=e;window.__c={n:"SecondaryWorkspaceNotice"};const s=(0,r.yK)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return(0,J.jsxs)("div",{style:s.container,children:[(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",values:{primaryWorkspaceName:t,bold:e=>(0,J.jsx)("span",{style:{fontWeight:g.Z.fontWeight.semibold},children:e})}})}),(0,J.jsx)("br",{}),(0,J.jsx)(le.Z,{isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The domain management settings and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",values:{primaryWorkspaceName:t,bold:e=>(0,J.jsx)("span",{style:{fontWeight:g.Z.fontWeight.semibold},children:e})}})})]})}var rl=s(89101),ll=s(23124);function dl(e){let{spaceStore:t,isEnterprise:s}=e;window.__c={n:"SetupInformation"};const n=(0,h.useIntl)(),i=(0,a.VK)((()=>t.id),[t]);return(0,J.jsxs)(ll.rj,{gap:8,children:[(0,J.jsx)(ll.r8,{row:1,col:1,children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.workspaceId",defaultMessage:"Workspace ID"})})}),(0,J.jsx)(ll.r8,{row:1,col:2,children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:(0,J.jsx)(cl,{text:i,tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.workspaceId.copyTooltip",defaultMessage:"Click to copy ID"})})})}),s?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ll.r8,{row:2,col:1,children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityIDLink",defaultMessage:"SAML SSO/SAML Entity ID"})})}),(0,J.jsx)(ll.r8,{row:2,col:2,children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:(0,J.jsx)(cl,{text:(0,xr.AE)(Hi.default.domainBaseUrl),tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID.copyTooltip",defaultMessage:"Click to copy link"})})})}),(0,J.jsx)(ll.r8,{row:3,col:1,children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl",defaultMessage:"SCIM base URL"})})}),(0,J.jsx)(ll.r8,{row:3,col:2,children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:(0,J.jsx)(cl,{text:Hi.default.domainBaseUrl+rl._j.scimApiBasePath,tooltip:n.formatMessage({id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl.copyTooltip",defaultMessage:"Click to copy link"})})})})]}):null]})}function cl(e){let{tooltip:t,text:s}=e;window.__c={n:"CopyableText"};const n=(0,o.O7)();return(0,J.jsx)(re.ZP,{delayThreshold:0,renderTooltip:()=>t,render:e=>(0,J.jsx)(js.Z,{onClick:()=>{ie.RD({environment:n,stringValue:s,copiedMessage:ie.tq.copiedPropertyToClipboard})},...e,children:s})})}function ul(e){let{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:l}=e;window.__c={n:"SettingsPage"};const d=(0,o.O7)(),c=(0,a.VK)((()=>zt.Z.state.online),[]),{loadingSaml:u,loadedSaml:m,errorSaml:p}=(0,n.useContext)(Ro),g=(0,a.VK)((()=>function(e){let{environment:t,samlConfigStore:s,spaceStore:n}=e;const i=Ka({environment:t,samlConfigStore:s}),o=!s.state.id||s.state.id===n.id;return i&&o}({environment:d,samlConfigStore:i,spaceStore:s})),[d,i,s]),f=(0,a.VK)((()=>i.state.id?za.Z.getPublicSpaceData(d,i.state.id):void 0),[d,i]),x=(0,r.yK)((()=>({header:{marginTop:48}})),[]),y=(0,a.VK)((()=>(0,jt.wP)()),[]);return c?u?(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(Es.Z,{style:{margin:"0 auto"}})}):p?(v.deprecatedShowErrorMessage(p.message),null):m?(0,J.jsxs)(Xe.ZP,{children:[!g&&f?(0,J.jsx)(al,{primarySpaceName:f.name}):null,(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})}),(0,J.jsx)(sr,{spaceStore:s,samlConfigStore:i,domainSettingsStore:l,isCurrentSpaceEnterprise:y}),(0,J.jsx)(et.Z,{large:!0,divider:"full",style:x.header,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})}),(0,J.jsx)(ur,{spaceStore:s,samlConfigStore:i,domainSettingsStore:l}),(0,J.jsx)(et.Z,{large:!0,divider:"full",style:x.header,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)"})}),(0,J.jsx)(Ar,{spaceStore:s,samlConfigStore:i,domainSettingsStore:l}),(0,J.jsx)(et.Z,{large:!0,divider:"full",style:x.header,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,J.jsx)(ol,{userStore:t,spaceStore:s}),(0,J.jsx)(et.Z,{large:!0,divider:"full",style:x.header,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information"})}),(0,J.jsx)(dl,{spaceStore:s,isEnterprise:y})]}):null:(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})})})}function ml(e,t){return(void 0===e||!(0,Ri.XR)(e))&&(!(void 0===e||!(0,Ri.TZ)(e)||0!==t)||1===t)}var pl=s(92595),gl=s(92165),hl=s(94400),fl=s(99622),xl=s(27242);var yl=s(73420);function Sl(){return(0,J.jsx)(re.ZP,{renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceClaim.Explanation",defaultMessage:"Workspace claim request is being processed."}),render:e=>(0,J.jsx)(le.Z,{...e,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingClaim",defaultMessage:"Pending"})})})}function vl(e){let{admin:t}=e;window.__c={n:"PendingSpaceTransferMessage"};const s=(0,h.useIntl)();return(0,J.jsx)(re.ZP,{renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceTransferExplanation",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",values:{name:(0,Nn.Nz)(s,t)}}),render:e=>(0,J.jsx)(le.Z,{...e,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingTransfer",defaultMessage:"Pending"})})})}let bl=function(e){return e.Single="single",e.Multi="multi",e}({});function Ml(e){window.__c={n:"SpaceActionsMenu"};const{space:t,mode:s}=e,n=(0,a.qz)(void 0,fn.Z),i=(0,r.yK)((()=>({container:{minWidth:325}})),[]);return s===bl.Single?(0,J.jsx)(wl,{action:e.action,space:t}):(0,J.jsx)(Sn.ZP,{popupType:tn.kQ.Popup,style:i.container,buttonPopupStore:n,renderOrigin:e=>(0,J.jsx)(vn.Z,{icon:mn.o,...e}),render:()=>(0,J.jsx)(jl,{space:t,actions:e.actions,popupStore:n})})}function jl(e){let{space:t,actions:s,popupStore:n}=e;const i={key:"workspace-actions",render:e=>(0,J.jsx)(sn.Z,{...e}),items:s.map((e=>{const s=!!e.getDisabledState&&e.getDisabledState(t),n=e.getTooltip?e.getTooltip(t):null;return{key:e.id,render:t=>(0,J.jsx)(re.ZP,{render:n=>(0,J.jsx)(ia.Z,{...t,...n,shouldWrapCaption:!0,svg:t=>e.getIcon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8,opacity:s?.5:1},disabled:s}),renderTooltip:()=>n,disableTooltip:!Boolean(n),placement:re.ug.Left}),action:()=>e.onAction(t)}}))};return(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[i],onAccept:()=>{n.setState({open:!1})}})})}function wl(e){window.__c={n:"SingleSpaceActionButton"};const{action:t,space:s}=e,i=(0,r.yK)((e=>({button:{paddingLeft:5,paddingRight:5}})),[]),o=n.useCallback((()=>{t.onAction(s)}),[t,s]);return(0,J.jsx)(Vt.Z,{isSmall:!0,style:i.button,onClick:o,children:t.name})}var Cl=s(33941);function kl(e){let{id:t,name:s,icon:n,subscriptionTier:i,memberCount:o,highlightIconContainer:a}=e;window.__c={n:"SpaceSummary"};const l=(0,h.useIntl)(),d=n?{pointer:{table:wi.bx,id:t,spaceId:t},icon:n}:void 0,c=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - 38px)"},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:a?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[a]);return(0,J.jsxs)("div",{style:c.container,children:[(0,J.jsx)("div",{style:c.iconContainer,children:(0,J.jsx)(In.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:32,title:s,isLarge:!0,emojiSize:28,isRaw:!1})}),(0,J.jsxs)("div",{style:c.summaryContainer,children:[(0,J.jsx)(le.Z,{style:c.name,showTooltipWhenTruncated:!0,children:s}),(0,J.jsx)(le.Z,{style:c.byline,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",values:{subscriptionTier:Tl(i,l),memberCount:o}})})]})]})}function Tl(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(Cl.a.free);case"personal":return t.formatMessage(Cl.a.personal);case"plus":return t.formatMessage(Cl.a.plusPlan);case"business":return t.formatMessage(Cl.a.business);default:(0,Fs.t1)(e)}}var Il=s(3556);function Pl(e){let{users:t,deletedUserEmailDomain:s}=e;window.__c={n:"SpaceUsers"};const n=(0,a.qz)(void 0,fn.Z),i=(0,r.yK)((()=>({container:{minWidth:275}})),[]);return(0,J.jsx)(Sn.ZP,{popupType:tn.kQ.Popup,style:i.container,buttonPopupStore:n,renderOrigin:e=>(0,J.jsx)(_l,{users:t,deletedUserEmailDomain:s,...e}),render:()=>(0,J.jsx)(Zl,{users:t,popupStore:n})})}function Zl(e){let{users:t,popupStore:s}=e;window.__c={n:"WorkspaceUsersMenu"};const n=(0,o.O7)(),i={key:"workspace-users-menu",render:e=>(0,J.jsx)(sn.Z,{...e}),items:t.map((e=>({key:e.id,render:t=>(0,J.jsx)(Fl,{user:e,...t}),action:()=>M.D({environment:n,url:`mailto:${e.email}`})})))};return(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:0,sections:[i],onAccept:()=>{s.setState({open:!1})}})})}function Fl(e){let{user:t,...s}=e;window.__c={n:"EmailableUserSummary"};const n=(0,h.useIntl)(),i=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return(0,J.jsxs)(Vt.Z,{style:i.container,...s,children:[(0,J.jsx)("div",{style:i.avatarContainer,children:(0,J.jsx)(Vn.Z,{userValue:t,size:24})}),(0,J.jsxs)("div",{style:i.nameContainer,children:[(0,J.jsx)(le.Z,{style:i.name,children:(0,Nn.Nz)(n,t)}),(0,J.jsx)(le.Z,{style:i.email,children:t.email})]}),(0,J.jsx)("div",{style:i.copyContainer,children:(0,Il.Z)({height:18,width:18})})]})}function _l(e){let{users:t,deletedUserEmailDomain:s,...n}=e;window.__c={n:"MultiUsersDisplay"};const i=(0,h.useIntl)(),o=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?(0,J.jsx)(re.ZP,{render:e=>(0,J.jsx)(Vt.Z,{style:o.container,disabled:!0,...n,...e,children:(0,J.jsx)(le.Z,{style:o.empty,children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user"})})}),disableTooltip:!s,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",values:{domain:`@${s}`}})}):(0,J.jsx)(Vt.Z,{style:o.container,...n,children:(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",values:{firstUser:(0,Nn.Nz)(i,t[0]),remainingCount:t.length-1,gray:e=>(0,J.jsx)(le.Z,{style:o.plusMore,children:e})}})})})}const Al=[{id:"spaces",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces"}),renderCell:e=>(0,J.jsx)(kl,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!1},{id:"admins",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners"}),renderCell:e=>(0,J.jsx)(Pl,{users:e.space.admins}),widthData:{width:40},sortable:!1},{id:"createdBy",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by"}),renderCell:e=>e.space.creator?(0,J.jsx)(Pl,{users:[e.space.creator]}):(0,J.jsx)(Pl,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!1},{id:"createdAt",headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created date"}),renderCell:e=>(0,J.jsx)(le.Z,{style:{opacity:.5},children:(0,wa.gs)(e.space.createdAt)}),widthData:{width:30},sortable:!1},{id:"action",headerTitle:null,renderCell:e=>{if((0,Ri.DI)(e.space.spaceRequest))return(0,J.jsx)(vl,{admin:e.space.admins[0]});if((0,Ri.XR)(e.space.spaceRequest))return(0,J.jsx)(Sl,{});if((0,Ri.TZ)(e.space.spaceRequest)){const t=e.actions.find((e=>"recover-space"===e.id));return t&&(0,J.jsx)(Ml,{space:e.space,action:t,mode:bl.Single})}return e.actions.length>0?(0,J.jsx)(Ml,{space:e.space,actions:e.actions.filter((e=>"recover-space"!==e.id)),mode:bl.Multi}):null},widthData:{width:15},sortable:!1}];function Rl(e){let{claimableSpaces:t,spaceActions:s,loadMoreClaimableSpaces:n,loading:i}=e;window.__c={n:"ClaimableSpacesTable"};const o=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:s}))),a=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:Al,theme:e,containerMarginTop:0})),[]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(oe.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Al,rows:o,renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:!i&&(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces."})}),styles:a,getStyleForRow:function(e){if((0,Ri.DI)(e.space.spaceRequest)||(0,Ri.XR)(e.space.spaceRequest)||(0,Ri.TZ)(e.space.spaceRequest))return{opacity:.5}},onLoadMore:n}),i&&(0,J.jsx)(Es.Z,{style:{margin:"24px auto 24px"}})]})}var Dl=s(33728),Bl=s(64275),Ll=s(36329),Ol=s(98519),El=s(16354);const Nl=(0,h.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),Vl=e=>{let{onDismiss:t,spaceQueuedForTransfer:s,currentSpaceId:i}=e;window.__c={n:"PersonalTransferSpaceConfirmationModal"};const[a,l]=(0,n.useState)(),[d,c]=(0,n.useState)(!1),{setSpaceRequest:u}=(0,n.useContext)(Ro),m=(0,o.O7)(),p=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:g.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},dividerContainer:{marginTop:20},dividerInner:{borderBottomColor:e.regularDividerColor},contactEmailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},contactEmailTitle:{fontWeight:g.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},primaryButton:{width:"100%",marginTop:32},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:g.Z.fontWeight.medium,color:e.lightTextColor},buttonCaptionError:{color:e.errorText,marginTop:8,fontSize:13}})),[]),f=Boolean(s);return(0,J.jsx)(wo.Z,{open:f,innerStyle:p.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:p.closeIconContainer,children:(0,J.jsx)(Vt.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Bl.D)(p.closeIcon)})}),(0,J.jsx)("div",{children:(0,Ll._)(p.modalIcon)}),(0,J.jsxs)(le.Z,{style:p.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.selfServe.title",defaultMessage:"Require account change"}),(0,J.jsx)(El.Z,{href:(0,Ze.UY)("guides.domainManagement"),children:(0,J.jsx)(vn.Z,{icon:Bo.m})})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:p.description,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.byline",defaultMessage:"You’re about to require the Workspace Owner of 1 workspace to use an external Notion accounts. They will be unable to use the workspace until the change is made."})}),(0,J.jsxs)("div",{style:p.workspaceContainer,children:[s?(0,J.jsx)(kl,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,J.jsx)("div",{style:p.checkContainer,children:(0,Ol.k)(p.check)})]}),(0,J.jsx)(Ms.Z,{size:"100%",innerStyle:p.dividerInner,style:p.dividerContainer}),(0,J.jsxs)("div",{style:p.contactEmailContainer,children:[(0,J.jsxs)(le.Z,{style:p.contactEmailTitle,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.title",defaultMessage:"Send request from"}),(0,J.jsx)(re.ZP,{renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplanation",defaultMessage:"The Workspace Owner can contact this email for inquiries"}),render:e=>(0,J.jsx)("span",{...e,children:(0,Bo.m)(p.helpIcon)})})]}),(0,J.jsx)(no.Z,{value:a,placeholder:B.default.formatMessage(Nl.emailPlaceholder),onChange:e=>{c(!1),l(e.target.value)}}),d&&(0,J.jsx)(le.Z,{isSmall:!0,style:p.buttonCaptionError,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.error",defaultMessage:"Invalid email address"})})]}),(0,J.jsx)(Ws.Z,{isLarge:!0,style:p.primaryButton,onClick:async()=>{const e=(0,Dl.H3)(a);var n;if((0,Dl.oH)(e)){if(s&&e){const o=await C.initiateWorkspaceTransfer(m,{requestingSpaceId:i,targetSpaceId:s.id,contactEmail:e});if("failed"===o.type)v.showErrorMessage((0,D.wf)(B.default.getIntl(),o));else{const i=o.data.workspaceTransfer;u(s.id,i),y.azK(m,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,subscriptionTier:s.subscriptionTier}),t(),n=s.name,zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.toast",defaultMessage:"Account change successfully requested for “{spaceName}“",values:{spaceName:n}})})}}}else c(!0)},children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.confirm",defaultMessage:"Confirm change"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:p.buttonCaption,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.buttonCaption",defaultMessage:"This cannot be undone"})}),(0,J.jsx)(Vt.Z,{style:p.secondaryButton,onClick:t,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.cancel",defaultMessage:"Cancel"})})]})})};const Ul=e=>{let{onDismiss:t,spaceQueuedForClaiming:s,requestingSpaceId:i}=e;window.__c={n:"SalesAssistedClaimSpaceConfirmationModal"};const a=(0,o.O7)(),{setSpaceRequest:l}=(0,n.useContext)(Ro),d=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:g.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:g.Z.fontWeight.medium,color:e.lightTextColor},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12}})),[]),c=Boolean(s),u=async()=>{if(!s)return;const e=await C.requestClaimAndUpgrade(a,{requestingSpaceId:i,targetSpaceId:s.id});var n;"failed"===e.type?v.showError(e):(y.eO1(a,{currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,memberCount:s.memberCount}),l(s.id,e.data.spaceRequest),n=s.name,zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.toast",defaultMessage:"Workspace claim successfully requested for “{spaceName}“",values:{spaceName:n}})})),t()};return(0,J.jsx)(wo.Z,{open:c,innerStyle:d.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:d.closeIconContainer,children:(0,J.jsx)(Vt.Z,{isSmall:!0,onClick:t,children:(0,Bl.D)(d.closeIcon)})}),(0,J.jsxs)(le.Z,{style:d.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.title",defaultMessage:"Request workspace claim"}),(0,J.jsx)(El.Z,{href:(0,Ze.UY)("guides.domainManagement"),children:(0,J.jsx)(vn.Z,{icon:Bo.m})})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:d.description,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,J.jsxs)("div",{style:d.workspaceContainer,children:[s?(0,J.jsx)(kl,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,J.jsx)("div",{style:d.checkContainer,children:(0,Ol.k)(d.check)})]}),(0,J.jsx)(Ws.Z,{isLarge:!0,style:d.primaryButton,onClick:u,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.sendRequest",defaultMessage:"Send request"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:d.buttonCaption,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.buttonCaption",defaultMessage:"This request may take a few days to process. For more information, contact your <accountmanageremail>Account Management team</accountmanageremail>.",values:{accountmanageremail:e=>(0,J.jsx)(js.Z,{href:"mailto:am@makenotion.com",children:e})}})}),(0,J.jsx)(Vt.Z,{style:d.secondaryButton,onClick:t,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.cancel",defaultMessage:"Cancel"})})]})})};const Wl=e=>{let{onDismiss:t,spaceQueuedForClaiming:s}=e;window.__c={n:"SelfServeClaimSpaceConfirmationModal"};const n=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:g.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:g.Z.fontWeight.medium,color:e.lightTextColor}})),[]),i=Boolean(s);return(0,J.jsx)(wo.Z,{open:i,innerStyle:n.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:n.closeIconContainer,children:(0,J.jsx)(Vt.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Bl.D)(n.closeIcon)})}),(0,J.jsx)("div",{children:(0,hl.l)(n.modalIcon)}),(0,J.jsxs)(le.Z,{style:n.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.title",defaultMessage:"Claim workspace"}),(0,J.jsx)(El.Z,{href:(0,Ze.UY)("guides.domainManagement"),children:(0,J.jsx)(vn.Z,{icon:Bo.m})})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:n.description,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,J.jsxs)("div",{style:n.workspaceContainer,children:[s?(0,J.jsx)(kl,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,J.jsx)("div",{style:n.checkContainer,children:(0,Ol.k)(n.check)})]}),(0,J.jsx)(Ws.Z,{isLarge:!0,style:n.primaryButton,onClick:()=>{s&&Qe.Xb(s)},children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.reviewAndPay",defaultMessage:"Review and pay"})}),(0,J.jsx)(Vt.Z,{style:n.secondaryButton,onClick:t,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.cancel",defaultMessage:"Cancel"})})]})})};var Kl=s(84939);const zl=(0,h.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),ql=e=>{let{onDismiss:t,spaceQueuedForDeletion:s,currentSpaceId:i}=e;window.__c={n:"SpaceDeletionConfirmationModal"};const[a,l]=(0,n.useState)({email:void 0,didError:!1}),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),{setSpaceRequest:p}=(0,n.useContext)(Ro),f=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],height:24,width:24},title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:g.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},checkboxContainer:{display:"inline-flex",marginTop:8,alignItems:"center"},checkbox:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[200],marginRight:8},primaryButton:{width:"100%",marginTop:32,background:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],justifyContent:"center",fontWeight:g.Z.fontWeight.medium,color:Ki.ZP.white},primaryButtonHovered:{background:"dark"===e.mode?(0,Kl._j)(e.accentColors.red[700],.3):(0,Kl._j)(e.accentColors.red[500],.3)},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:g.Z.fontWeight.medium,color:e.lightTextColor},checkboxCaption:{color:e.mediumTextColor,textAlign:"center",fontSize:12},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),x=(0,o.O7)(),S=(0,n.useCallback)((()=>{l({email:void 0,didError:!1}),c(!1),m(!1),t()}),[t]),b=(0,n.useCallback)((e=>{l({didError:!1,email:e.target.value})}),[]),M=(0,n.useCallback)((()=>c((e=>!e))),[]),j=(0,n.useCallback)((async()=>{const e=(0,Dl.H3)(a.email);if(!(0,Dl.oH)(e))return void l({...a,didError:!0});if(!s)return;m(!0);const t=await C.deleteSpaceForDomain(x,{requestingSpaceId:i,targetSpaceId:s.id,contactEmail:e});if("failed"===t.type)m(!1),v.showErrorMessage((0,D.wf)(B.default.getIntl(),t));else{const i=t.data.spaceDeletion;p(s.id,i),y.QFO(x,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,targetSubscriptionTier:s.subscriptionTier}),S(),n=s.name,zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.toast",defaultMessage:"Successfully deleted “{spaceName}“",values:{spaceName:n}})})}var n}),[S,a,i,x,p,s]),w=Boolean(s);return(0,J.jsx)(wo.Z,{open:w,innerStyle:f.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:S,render:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:f.closeIconContainer,children:(0,J.jsx)(Vt.Z,{isSmall:!0,onClick:S,ignoreLocalHoverState:!0,children:(0,Bl.D)(f.closeIcon)})}),(0,J.jsx)("div",{children:(0,Uo.y)(f.modalIcon)}),(0,J.jsxs)(le.Z,{style:f.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.title",defaultMessage:"Delete workspace"}),(0,J.jsx)(El.Z,{href:(0,Ze.UY)("guides.domainManagement"),children:(0,J.jsx)(vn.Z,{icon:Bo.m})})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:f.description,children:s?(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.byline",defaultMessage:"You’re about to permanently delete {currentWorkspaceName} and all of its contents. The workspace owner will be notified.",values:{currentWorkspaceName:s.name}}):void 0}),(0,J.jsxs)("div",{style:f.workspaceContainer,children:[s?(0,J.jsx)(kl,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):void 0,(0,J.jsx)("div",{style:f.checkContainer,children:(0,Ol.k)(f.check)})]}),(0,J.jsx)(Ms.Z,{size:0,style:f.dividerContainer,innerStyle:f.divider}),(0,J.jsx)(Gl,{value:a.email,placeholder:B.default.formatMessage(zl.emailPlaceholder),onChange:b,labelMessage:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.title",defaultMessage:"Contact email"}),helpMessage:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.deleteWorkspaces.deletionModal.tooltipExplanation",defaultMessage:"The Workspace Owner of the deleted workspace can contact this email for inquiries"}),errorMessage:a.didError?(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.error",defaultMessage:"Invalid email address"}):void 0}),(0,J.jsx)(Vt.Z,{disabled:!d||!a.email||u,disabledFeedback:!0,isLarge:!0,style:f.primaryButton,hoveredStyle:f.primaryButtonHovered,onClick:j,children:u?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.deleteButton",defaultMessage:"Delete workspace"})}),(0,J.jsxs)("div",{style:f.checkboxContainer,children:[(0,J.jsx)(Js.Z,{style:f.checkbox,size:14,checked:d,onClick:M}),(0,J.jsx)(le.Z,{isSmall:!0,style:f.checkboxCaption,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.checkboxLabel",defaultMessage:"I'm sure I want to delete this workspace"})})]}),(0,J.jsx)(Vt.Z,{style:f.secondaryButton,onClick:S,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.cancel",defaultMessage:"Cancel"})})]})})};function Gl(e){window.__c={n:"EmailInput"};const t=(0,r.yK)((e=>({emailInputTitle:{fontWeight:g.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},emailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},inputCaptionError:{color:e.errorText,marginTop:8,fontSize:13},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16}})),[]);return(0,J.jsxs)("div",{style:t.emailContainer,children:[(0,J.jsxs)(le.Z,{style:t.emailInputTitle,children:[e.labelMessage,e.helpMessage&&(0,J.jsx)(re.ZP,{renderTooltip:()=>e.helpMessage,render:e=>(0,J.jsx)("span",{...e,children:(0,Bo.m)(t.helpIcon)})})]}),(0,J.jsx)(no.Z,{value:e.value,placeholder:e.placeholder,onChange:e.onChange}),e.errorMessage&&(0,J.jsx)(le.Z,{isSmall:!0,style:t.inputCaptionError,children:e.errorMessage})]})}const Hl=e=>{let{onDismiss:t,onAccept:s,spaceQueued:n,descriptionMessage:i,divider:o,modalIcon:a,title:l,acceptMessage:d,isLoading:c}=e;window.__c={n:"ClaimableSpaceConfirmationModal"};const u=(0,r.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{height:24,width:24,fill:e.mediumIconColor},title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:g.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32,justifyContent:"center",fontWeight:g.Z.fontWeight.medium},secondaryButton:{margin:"8px auto 0",width:"100%",justifyContent:"center",fontWeight:g.Z.fontWeight.medium,color:e.lightTextColor},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),m=Boolean(n);return(0,J.jsx)(wo.Z,{open:m,innerStyle:u.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:u.closeIconContainer,children:(0,J.jsx)(Vt.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Bl.D)(u.closeIcon)})}),a&&(0,J.jsx)("div",{children:a(u.modalIcon)}),(0,J.jsxs)(le.Z,{style:u.title,children:[l,(0,J.jsx)(El.Z,{href:(0,Ze.UY)("guides.domainManagement"),children:(0,J.jsx)(vn.Z,{icon:Bo.m})})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:u.description,children:i}),(0,J.jsxs)("div",{style:u.workspaceContainer,children:[n?(0,J.jsx)(kl,{id:n.id,name:n.name,icon:n.icon,subscriptionTier:n.subscriptionTier,memberCount:n.memberCount}):void 0,(0,J.jsx)("div",{style:u.checkContainer,children:(0,Ol.k)(u.check)})]}),o&&(0,J.jsx)(Ms.Z,{size:0,style:u.dividerContainer,innerStyle:u.divider}),(0,J.jsx)(Ws.Z,{isLarge:!0,style:u.primaryButton,onClick:s,disabled:c,children:c?(0,J.jsx)(Es.Z,{}):d}),(0,J.jsx)(Vt.Z,{style:u.secondaryButton,onClick:t,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimableSpaceConfirmationModal.cancel",defaultMessage:"Cancel"})})]})})};const Ql=e=>{let{onDismiss:t,spaceQueuedForRecovery:s,currentSpaceId:i}=e;window.__c={n:"SpaceRecoveryConfirmationModal"};const{setSpaceRequest:a}=(0,n.useContext)(Ro),r=(0,o.O7)(),[l,d]=(0,n.useState)(!1),c=(0,n.useCallback)((()=>{d(!1),t()}),[t]),u=(0,n.useCallback)((async()=>{if(!i||!s)return;d(!0);const e=await C.cancelSpaceDeletionForDomain(r,{requestingSpaceId:i,targetSpaceId:s.id});if("failed"===e.type)return d(!1),void v.showErrorMessage((0,D.wf)(B.default.getIntl(),e));var t;a(s.id,void 0),y.JvT(r,{targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain}),c(),t=s.name,zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.table.recoverSpace.toast",defaultMessage:"Successfully recovered “{spaceName}“",values:{spaceName:t}})})}),[a,i,r,s,c]);return(0,J.jsx)(Hl,{onDismiss:c,onAccept:u,spaceQueued:s,modalIcon:Vo.u,title:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.title",defaultMessage:"Recover workspace"}),descriptionMessage:s?(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.byline",defaultMessage:"Restore workspace content and the workspace owner's access.",values:{currentWorkspaceName:s.name}}):void 0,acceptMessage:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.deleteButton",defaultMessage:"Recover"}),isLoading:l,divider:!1})};let Yl=!1;function $l(e){let{spaceStore:t,subscriptionDataStore:s}=e;window.__c={n:"WorkspacesPage"};const{claimableSpaces:i,domainVerifications:l,loadingSpaces:d,errorClaimableSpaces:c,errorVerifications:u,navigateTo:m,removeClaimableSpace:f,loadMoreClaimableSpaces:x,tab:y,setSelectedTab:S,verifiedDomains:b}=(0,n.useContext)(Ro),M=(0,o.O7)(),j=(0,a.VK)((()=>!xl.Z.state.open&&Boolean(xl.Z.state.succeeded)),[]),[w,C]=(0,n.useState)(),[k,T]=(0,n.useState)(),[I,P]=(0,n.useState)(),[Z,F]=(0,n.useState)(),_=(0,fl.Y)(wt.subscriptionDataStoreInstance);function A(){C(void 0),T(void 0),P(void 0),F(void 0)}(0,n.useEffect)((()=>{j&&w&&(f(w.id),C(void 0),xl.Z.reset())}),[j,w,f,C]);const R="verifying"===function(e){return(0,a.VK)((()=>(0,Mt.AY)(e.state)),[e])}(s),D=(0,r.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:g.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:g.Z.fontWeight.regular,color:e.mediumTextColor,marginRight:"auto",paddingRight:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"}})),[]);if(c)return v.deprecatedShowErrorMessage(c.message),null;if(u)return v.deprecatedShowErrorMessage(u.message),null;const B=i.filter((e=>ml(e.spaceRequest,e.memberCount))),L=i.filter((e=>!ml(e.spaceRequest,e.memberCount))),O=[{id:"external-transfer",getIcon:e=>(0,gl.Z)({...e,height:14,width:14}),name:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Require account change"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Owner will be prompted to change workspace ownership to a personal account."}),onAction:e=>T(e)},{id:"space-deletion",getIcon:e=>(0,Uo.y)({...e,height:14,width:14}),name:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace",defaultMessage:"Delete workspace"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpaceCaption",defaultMessage:"Owner will lose access to the workspace immediately."}),onAction:e=>P(e),getDisabledState:e=>{const{isEligible:t}=Jl(l,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling||!(0,p.QM)(e.subscriptionTier)},getTooltip:e=>{const t=Jl(l,e.creatorEmailDomain);return t.isEligible?!(0,p.QM)(e.subscriptionTier)||e.isDelinquent||e.isPendingBilling?(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for deletion."}):void 0:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,J.jsx)("br",{})}})}},{id:"recover-space",getIcon:()=>{},name:(0,J.jsx)(h.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actions.recoverSpace",defaultMessage:"Recover"}),caption:void 0,onAction:e=>F(e)}],E=[{id:"claim-and-upgrade",getIcon:e=>(0,hl.l)({...e,height:14,width:14}),name:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership of the workspace and upgrade it to an Enterprise plan"}),onAction:e=>C(e),getDisabledState:e=>{const{isEligible:t}=Jl(l,e.creatorEmailDomain);return R||!t||e.isDelinquent||e.isPendingBilling},getTooltip:e=>{const t=Jl(l,e.creatorEmailDomain);return e.isDelinquent||e.isPendingBilling?(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for claiming."}):t.isEligible?void 0:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,J.jsx)("br",{})}})}}];return(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(js.Z,{style:D.link,onClick:()=>m(Zo),children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,J.jsx)(et.Z,{large:!0,style:D.title,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Manage workspaces"})}),(0,J.jsxs)(yl.X2,{children:[(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:D.byline,children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain."})}),(0,J.jsx)(ws.Z,{isLarge:!0,onClick:()=>{Bs.g({environment:M,data:{spaceId:t.id,emailDomains:b}})},children:(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.exportClaimableWorkspaces.button",defaultMessage:"Export to CSV"})})]}),(0,J.jsx)(po.Z,{tabs:[(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.singleSpaces",defaultMessage:"Single-member"},"single"),(0,J.jsx)(h.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.multiSpaces",defaultMessage:"Multi-member"},"multi")],selectedIndex:y,onChange:e=>S(e),style:D.tabBarMenu}),(0,J.jsx)(Vl,{onDismiss:A,spaceQueuedForTransfer:k,currentSpaceId:t.id}),y===Ao.Single?(0,J.jsx)(Rl,{claimableSpaces:B,spaceActions:O,loadMoreClaimableSpaces:x,loading:d},"single"):(0,J.jsx)(Rl,{claimableSpaces:L,spaceActions:E,loadMoreClaimableSpaces:x,loading:d},"multi"),_?(0,J.jsx)(Ul,{onDismiss:A,spaceQueuedForClaiming:w,requestingSpaceId:t.id}):(0,J.jsx)(Wl,{onDismiss:A,spaceQueuedForClaiming:w}),(0,J.jsx)(ql,{onDismiss:A,spaceQueuedForDeletion:I,currentSpaceId:t.id}),(0,J.jsx)(Ql,{onDismiss:A,spaceQueuedForRecovery:Z,currentSpaceId:t.id})]})}function Jl(e,t){if(Yl)return{isEligible:!0};const s=e.find((e=>{let{domain:s}=e;return t===s}));if(!s||!s.verified_at)return{isEligible:!0};const n=(Date.now()-s.verified_at)/It.A0;return n>=14?{isEligible:!0}:{isEligible:!1,daysUntilEligible:Math.ceil(14-n)}}function Xl(e){let{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:o}=e;window.__c={n:"PageRouter"};const{page:a}=(0,n.useContext)(Ro);switch(a){case Zo:return(0,J.jsx)(ul,{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:o});case Fo:return(0,J.jsx)($l,{spaceStore:s,subscriptionDataStore:wt.subscriptionDataStoreInstance});case _o:return(0,J.jsx)(Wa,{spaceStore:s,samlConfigStore:i})}}["local","development","staging"].includes("production")&&(0,pl.exposeDebugValue)("bypassDomainVerificationWaitingPeriod",(function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Yl=e}));const ed=function(e){let{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:i}=e;return(0,J.jsx)(Do,{spaceStore:s,samlConfigStore:n,domainSettingsStore:i,children:(0,J.jsx)(Xl,{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:i})})};var td=s(84619),sd=s(75754),nd=s(22756),id=s(41892),od=s(1800),ad=s(36060),rd=s(26139),ld=s(50063),dd=s(41311),cd=s(8055),ud=s(30397),md=s(33907),pd=s(36591),gd=s(42853),hd=s(75071),fd=s(91),xd=s(9867),yd=s(29551),Sd=s(93963),vd=s(40235);const bd=function(){window.__c={n:"AsanaImportStepChooseWorkspaceTab"};const e=(0,o.O7)(),t=(0,h.useIntl)(),s=(0,a.VK)((()=>nd.Z.getState()),[]),{isLoadingProjects:i,selectedWorkspace:r,teamsAndProjects:l,workspaces:d}=s;return(0,n.useEffect)((()=>{r&&dd.y2({selectedWorkspace:r,environment:e}).catch((()=>{}))}),[r,e]),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,J.jsx)("img",{src:id.Z.images.import.asanaPng,width:16,height:16}),(0,J.jsx)(jd,{onSelectOption:e=>{nd.Z.setState({...s,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:d.map((e=>({key:e.gid,label:e.name}))),currentOption:r,placeHolder:t.formatMessage({id:"asanaImporter.chooseWorkspace.chooseWorkspacePlaceholder",defaultMessage:"Choose a workspace"})})]}),r?(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold,marginTop:18},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.selectProjects",defaultMessage:"Select projects"})}):(0,J.jsx)(J.Fragment,{}),i?(0,J.jsxs)(yd.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,J.jsx)(Es.Z,{style:{fontSize:12}}),(0,J.jsx)(le.Z,{isSmall:!0,style:{color:Ki.FN.light.gray[400]},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):l.filter((e=>0!==e.projects.length)).map((e=>(0,J.jsx)(Md,{team:e,selectedWorkspace:r},`${e.gid}-table`)))]})};function Md(e){var t;let{team:s,selectedWorkspace:i}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const d=(0,o.O7)(),c=(0,h.useIntl)(),u=(0,r.Fg)(),[m,p]=(0,n.useState)(!1),[f,x]=(0,n.useState)(!1),[y,S]=(0,n.useState)(),v=(0,a.VK)((()=>nd.Z.getState()),[]),b=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),M=(0,a.VK)((()=>{const e=null==b?void 0:b.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,J.jsx)(An.p,{disabled:!0,store:e})})))}),[b]);(0,n.useEffect)((()=>{if(!M||!b)return;if(!v.selectedProjectsAndTeamspaces[s.gid]){S("private"),dd.B3({teamId:s.gid,spaceId:null==b?void 0:b.id});for(const n of M){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())){S(n.id),dd.B3({teamId:s.gid,spaceId:n.id});break}}}}),[M,s,b,v]);const j=(0,n.useCallback)((e=>{dd.B3({teamId:s.gid,spaceId:e}),S(e)}),[s.gid]),w=(0,n.useCallback)((e=>{if("create"===e)return void xd.lo("asana_importer",{onClose:j});let t;if("private"===e){if(null==b||!b.id)return;t=b.id}else t=e;dd.B3({teamId:s.gid,spaceId:t}),S(e)}),[null==b?void 0:b.id,s.gid,j]),{importCompletedTasks:k,loadMoreClicks:T,selectedProjectsAndTeamspaces:I}=v,P=[{key:"private",searchTerm:"private",label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:8},children:[(0,J.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:Ki.FN.light.gray[75]},children:(0,l.Q)({color:u.mediumIconColor,width:12.5,height:12.5})}),(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.regular},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.privateSpaceTitle",defaultMessage:"Private"})})]})}];return M&&P.push(...M.map((e=>({key:e.id,searchTerm:e.name,label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),P.push({key:"create",searchTerm:"New teamspace",label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:4},children:[(0,hd.f)({color:u.mediumIconColor,width:16,height:16}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,J.jsxs)(yd.gq,{children:[(0,J.jsx)(vn.Z,{ariaLabel:"collapse toggle",icon:fd.L,onClick:()=>p((e=>!e)),style:{transform:m?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,J.jsx)(vd.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,J.jsxs)(yd.gq,{alignItems:"center",gap:2,children:[(0,J.jsx)(wd,{onSelectOption:e=>{var t;nd.Z.setState({...v,selectedProjectsAndTeamspaces:{...I,[s.gid]:{notionTeamspaceId:null===(t=I[s.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=I[s.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,J.jsx)(le.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.name})]}),style:{width:300}},{key:"importInto",header:(0,J.jsxs)(yd.gq,{style:{alignItems:"center"},children:[(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.importInto",defaultMessage:"Import into"})}),(0,J.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,md.n)({width:12})}),(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:8},children:[(0,J.jsx)("img",{src:id.Z.emails.notionLogoBlackSmallPng,height:18}),(0,J.jsx)(jd,{options:P,onSelectOption:w,currentOption:null===(t=P.find((e=>e.key===y)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:c.formatMessage({id:"asanaImport.importsTab.chooseWorkspace.selectATeamspace",defaultMessage:"Select a teamspace"}),width:250})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const n=s.projects.map((e=>({key:e.gid,columns:[(0,J.jsxs)(yd.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,J.jsx)(Js.Z,{style:{marginRight:2},onClick:()=>{const t={...I[s.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o="all"===i||"in_complete"===i?[]:i.includes(e.gid)?i.filter((t=>t!==e.gid)):i.concat(e.gid),nd.Z.setState({...v,selectedProjectsAndTeamspaces:{...I,[s.gid]:{notionTeamspaceId:n,projects:o}}})},checked:(()=>{const t={...I[s.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,J.jsx)(Sd.z,{color:e.color,size:6}),(0,J.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,J.jsxs)(le.Z,{isMultiline:!0,style:{color:u.lightTextColor},children:[e.name,(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.completedHelperText",defaultMessage:" (Completed)"})]}):(0,J.jsx)(le.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,J.jsxs)(le.Z,{isSmall:!0,children:[k?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tasksHelperText",defaultMessage:" tasks"})]},`${s.gid}-tasks-count`)]})));return s.nextPage&&n.push({key:"loadMore",columns:[(0,J.jsx)(uo.Z,{disabled:f,style:{marginLeft:20,color:Ki.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!i)return;x(!0);const e=await C.getTeamsAndProjectsInAsanaWorkspace(d,{workspaceId:i,teamId:s.gid,size:5,nextPage:s.nextPage}),{teamsAndProjects:t}={...v},n=t.find((e=>e.gid===s.gid));if(n){if("success"===e.type){const i=e.data.find((e=>e.gid===s.gid));if(!i)return;n.projects.push(...i.projects),n.nextPage=i.nextPage,nd.Z.setState({...v,teamsAndProjects:t,loadMoreClicks:T+1})}x(!1)}},children:f?(0,J.jsxs)(yd.gq,{alignItems:"center",gap:8,children:[(0,J.jsx)(Es.Z,{style:{fontSize:12}}),(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.loadMoreProjects",defaultMessage:"Load more projects..."})},`${s.gid}-loadmore`)]}),n}({collapsed:m})})]})}function jd(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d,width:c}=e,u=(0,h.useIntl)(),[m,p]=(0,n.useState)(""),f=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,x=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,placementToOrigin:Sn.pO.Bottom,renderOrigin:e=>(0,J.jsxs)(Vt.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:c??376,border:`1px solid ${Ki.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,color:o?void 0:Ki.FN.light.gray[300]},disabled:!1,children:[(0,J.jsx)(le.Z,{style:{textOverflow:"ellipsis",fontSize:"14px",font:"SF Pro Text",color:o?void 0:"#ACABA9",lineHeight:"19.6px"},children:f||a}),(0,gd.i)(x.icon)]}),render:e=>{const t={menuType:Hs.og.Popup,width:376,left:50},n=[{key:"asanaImport.dropdown.menuList",render:e=>(0,J.jsx)(sn.Z,{...e}),items:(m.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(m.toLowerCase())})):i).map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,J.jsx)($s.Z,{...e,title:i,shouldWrapCaption:!0,right:f===i?(0,J.jsx)("div",{style:{width:14},children:(0,pd.e)()}):void 0})}}))}];return(0,J.jsxs)(J.Fragment,{children:[d?(0,J.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:Ki.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${Ki.FN.light.gray[100]}`,justifyContent:"space-between",background:Ki.FN.light.gray[50],fontSize:g.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:u.formatMessage({id:"asanaImport.importsTab.chooseWorkspace.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>p(e.target.value),value:m}):(0,J.jsx)(J.Fragment,{}),(0,J.jsx)(Xs.Z,{...t,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function wd(e){var t;window.__c={n:"CheckboxDropdown"};const{onSelectOption:s,options:i,currentOption:o}=e,a=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,r=(0,n.useMemo)((()=>void 0!==o&&"specific"!==o&&("all"===o||"partial")),[o]);return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,placementToOrigin:Sn.pO.Bottom,alignmentToOrigin:Sn.vR.Start,renderOrigin:e=>(0,J.jsx)(Vt.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,J.jsx)(Js.Z,{checked:r,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,J.jsx)(sn.Z,{...e}),items:i.map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,J.jsx)($s.Z,{...e,title:i,shouldWrapCaption:!0,right:a===i?(0,J.jsx)("div",{style:{width:14},children:(0,pd.e)()}):void 0})}}))}];return(0,J.jsx)(Xs.Z,{...t,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var Cd=s(91315);const kd=function(){window.__c={n:"AsanaImportStepConfirmTab"};const e=(0,a.VK)((()=>nd.Z.state),[]);return e.result?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(le.Z,{isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,J.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,J.jsx)(Td,{importStatus:e},e.asanaTeamId)))})]}):(0,J.jsx)(J.Fragment,{})};function Td(e){let{importStatus:t}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const s=(0,r.Fg)(),[i,o]=(0,n.useState)(!1),d=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),c=(0,a.VK)((()=>nd.Z.state.teamsAndProjects),[]),u=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),m=(0,a.VK)((()=>{if(!u)return;const e=u.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,J.jsx)(An.p,{disabled:!0,store:e})})));return d?(e||[]).concat({id:u.id,name:"Private",icon:(0,J.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:Ki.FN.light.gray[75]},children:(0,l.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[u,d,s]),{notionTeamspaceName:p,notionTeamspaceIcon:g}=(0,n.useMemo)((()=>{const e=null==m?void 0:m.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[m,t]),f=(0,n.useMemo)((()=>{const e=c.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[c,t]);return(0,J.jsxs)(yd.gq,{style:{marginTop:16},children:[(0,J.jsx)(vn.Z,{ariaLabel:"collapse toggle",icon:fd.L,onClick:()=>o((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,J.jsx)(vd.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,J.jsx)(yd.gq,{alignItems:"center",gap:2,children:(0,J.jsx)(le.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:f})}),style:{width:300}},{key:"importedInto",header:(0,J.jsxs)(yd.gq,{gap:4,children:[(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:4},children:[(0,J.jsx)(le.Z,{isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,md.n)({width:12})]}),(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:4},children:[g,p]})]}),style:{width:300}}],rows:function(e){let{collapsed:s}=e;return s?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,J.jsxs)(yd.gq,{gap:8,alignItems:"center",children:[(0,Cd.r)({width:12,color:Ki.FN.dark.green[600]}),(0,J.jsx)(le.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId),(0,J.jsxs)(le.Z,{isSmall:!0,children:[e.numberOfTasks,(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})))}({collapsed:i})})]})}var Id=s(86793),Pd=s(92607);const Zd=function(){window.__c={n:"AsanaImportStepImportCompleteTab"};const e=(0,a.VK)((()=>nd.Z.state),[]);if(!e.result)return(0,J.jsx)(J.Fragment,{});const t=e.result;let s=0;return t.forEach((e=>{s+=e.numberOfProjects})),(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:2},children:[(0,J.jsx)(le.Z,{isMultiline:!0,style:{font:"SF Pro",fontWeight:g.Z.fontWeight.semibold,fontSize:g.Z.fontSize.UIRegular.mobile,paddingTop:8},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.importComplete.subtitle",defaultMessage:"Imported {projectCount} projects into Notion",values:{projectCount:s}})}),(0,J.jsx)("div",{style:{marginTop:20},children:e.result.map((e=>(0,J.jsx)(Fd,{importStatus:e},e.asanaTeamId)))})]})};function Fd(e){let{importStatus:t}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const s=(0,r.Fg)(),i=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),o=(0,a.VK)((()=>nd.Z.state.teamsAndProjects),[]),d=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),c=(0,a.VK)((()=>{if(!d)return;const e=d.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,J.jsx)(An.p,{disabled:!0,store:e})})));return i?(e||[]).concat({id:d.id,name:"Private",icon:(0,J.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:Ki.FN.light.gray[75]},children:(0,l.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[d,i,s]),{notionTeamspaceName:u,notionTeamspaceIcon:m}=(0,n.useMemo)((()=>{const e=null==c?void 0:c.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[c,t]),p=(0,n.useMemo)((()=>{const e=o.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[o,t]);return(0,J.jsx)(yd.gq,{style:{marginTop:16},children:(0,J.jsx)(vd.Z,{tableStyle:{borderTop:0,gap:10},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,J.jsx)(yd.gq,{children:(0,J.jsx)(yd.gq,{alignItems:"center",gap:2,children:(0,J.jsx)(le.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis",font:"SF Pro",fontWeight:g.Z.fontWeight.regular,fontSize:g.Z.fontSize.UIRegular.desktop},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.importComplete.importFrom",defaultMessage:"From {asanaTeamName} in Asana",values:{asanaTeamName:p}})})})}),style:{width:300}},{key:"seperator",header:(0,J.jsx)(yd.gq,{style:{alignItems:"center",gap:4},children:(0,J.jsx)(le.Z,{isMultiline:!0,style:{fontWeight:g.Z.fontWeight.regular,font:"SF Pro",fontSize:g.Z.fontSize.UIRegular.desktop,color:"rgba(172, 171, 169, 1)"},children:"→"})}),style:{width:13,height:18,paddingRight:20}},{key:"importedInto",header:(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:4},children:[m,(0,J.jsx)(le.Z,{style:{font:"SF Pro",fontWeight:g.Z.fontWeight.medium,fontSize:g.Z.fontSize.UIRegular.desktop},children:u}),(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.regular,fontSize:g.Z.fontSize.UIRegular.desktop,font:"SF Pro Text",color:"rgba(172, 171, 169, 1)"},children:"/"}),(0,J.jsx)(J.Fragment,{children:(0,Id.D)({width:"16px",height:"16px",color:s.mediumIconColor})}),(0,J.jsx)(le.Z,{style:{font:"SF Pro",fontWeight:g.Z.fontWeight.medium,fontSize:g.Z.fontSize.UIRegular.desktop},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.importComplete.projectLabel",defaultMessage:"Projects"})})]}),style:{width:300}}],rows:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,J.jsxs)(yd.gq,{gap:8,alignItems:"start",flexDirection:"column",children:[(0,J.jsx)(le.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300,fontWeight:g.Z.fontWeight.medium,font:"SF Pro",fontSize:g.Z.fontSize.UIRegular.desktop},children:e.name}),(0,J.jsxs)(le.Z,{isSmall:!0,children:[e.numberOfTasks,(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]},e.projectId),(0,J.jsx)(yd.gq,{},`${e.projectId}-seperator`),(0,J.jsx)(yd.gq,{children:(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",gap:4,paddingBottom:6},children:[(0,Id.D)({width:20,height:20,color:s.mediumIconColor}),(0,J.jsx)(js.Z,{href:e.notionProjectId?(0,od.Z)({pageId:e.notionProjectId,pageModel:(0,ad.lA)({table:hi.iU,id:e.notionProjectId}),baseUrl:Hi.default.domainBaseUrl,pageVisitSource:un.tY.Import}):void 0,style:{wordWrap:"break-word",fontWeight:g.Z.fontWeight.medium,font:"SF Pro",fontSize:g.Z.fontSize.UIRegular.desktop,textDecorationLine:"underline",textDecorationColor:"rgba(227, 226, 224, 1)"},disableHover:!0,children:e.name})]}),(0,J.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,Pd.v)({width:14,height:14,color:s.mediumIconColor}),(0,J.jsxs)(js.Z,{href:e.notionProjectId?(0,od.Z)({pageId:e.notionProjectId,pageModel:(0,ad.lA)({table:hi.iU,id:e.notionProjectId}),baseUrl:Hi.default.domainBaseUrl,pageVisitSource:un.tY.Import}):void 0,style:{color:"rgba(120, 119, 116, 1)",font:"SF Pro",fontSize:g.Z.fontSize.UISmall.desktop,fontWeight:g.Z.fontWeight.regular},disableUnderline:!0,disableHover:!0,children:[e.numberOfTasks,(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.importConfir,.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})]})},`${e.projectId}-notionProjects`)]})))})})}const _d=function(){window.__c={n:"AsanaImportStepSelectDataTab"};const e=(0,o.O7)(),t=(0,h.useIntl)(),s=(0,a.VK)((()=>nd.Z.getState()),[]),{isLoadingProjects:i,workspaces:r,selectedWorkspace:l,teamsAndProjects:d}=s;return(0,n.useEffect)((()=>{l&&dd.y2({selectedWorkspace:l,environment:e}).catch((()=>{}))}),[l,e]),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(le.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,J.jsx)(Rd,{onSelectOption:e=>{nd.Z.setState({...s,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:r.map((e=>({key:e.gid,label:e.name}))),currentOption:l,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),l?(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold,marginTop:18},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,J.jsx)(J.Fragment,{}),i?(0,J.jsxs)(yd.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,J.jsx)(Es.Z,{style:{fontSize:12}}),(0,J.jsx)(le.Z,{isSmall:!0,style:{color:Ki.FN.light.gray[400]},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):d.filter((e=>0!==e.projects.length)).map((e=>(0,J.jsx)(Ad,{team:e,selectedWorkspace:l},`${e.gid}-table`)))]})};function Ad(e){var t;let{team:s,selectedWorkspace:i}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const d=(0,o.O7)(),c=(0,h.useIntl)(),u=(0,r.Fg)(),[m,p]=(0,n.useState)(!1),[f,x]=(0,n.useState)(!1),[y,S]=(0,n.useState)(),v=(0,a.VK)((()=>nd.Z.getState()),[]),{importCompletedTasks:b,loadMoreClicks:M,selectedProjectsAndTeamspaces:j}=v,w=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),k=(0,a.VK)((()=>{const e=null==w?void 0:w.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,J.jsx)(An.p,{disabled:!0,store:e})})))}),[w]);(0,n.useEffect)((()=>{if(!k||!w)return;if(!j[s.gid]){S("private"),dd.B3({teamId:s.gid,spaceId:null==w?void 0:w.id});for(const n of k){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())){S(n.id),dd.B3({teamId:s.gid,spaceId:n.id});break}}}}),[k,s,w,j]);const T=(0,n.useCallback)((e=>{dd.B3({teamId:s.gid,spaceId:e}),S(e)}),[s.gid]),I=(0,n.useCallback)((e=>{if("create"===e)return void xd.lo("asana_importer",{onClose:T});let t;if("private"===e){if(null==w||!w.id)return;t=w.id}else t=e;dd.B3({teamId:s.gid,spaceId:t}),S(e)}),[null==w?void 0:w.id,s.gid,T]),P=[{key:"private",searchTerm:"private",label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:8},children:[(0,J.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:Ki.FN.light.gray[75]},children:(0,l.Q)({color:u.mediumIconColor,width:12.5,height:12.5})}),(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.regular},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return k&&P.push(...k.map((e=>({key:e.id,searchTerm:e.name,label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),P.push({key:"create",searchTerm:"New teamspace",label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:4},children:[(0,hd.f)({color:u.mediumIconColor,width:16,height:16}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,J.jsxs)(yd.gq,{style:{marginLeft:-18},children:[(0,J.jsx)(vn.Z,{ariaLabel:"collapse toggle",icon:fd.L,onClick:()=>p((e=>!e)),style:{transform:m?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,J.jsx)(vd.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,J.jsxs)(yd.gq,{alignItems:"center",gap:2,children:[(0,J.jsx)(Dd,{onSelectOption:e=>{var t;nd.Z.setState({...v,selectedProjectsAndTeamspaces:{...j,[s.gid]:{notionTeamspaceId:null===(t=j[s.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=j[s.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,J.jsx)(le.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.name})]}),style:{width:300}},{key:"importInto",header:(0,J.jsxs)(yd.gq,{style:{alignItems:"center"},children:[(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,J.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,md.n)({width:12})}),(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:8},children:[(0,J.jsx)("img",{src:id.Z.emails.notionLogoBlackSmallPng,height:18}),(0,J.jsx)(Rd,{options:P,onSelectOption:I,currentOption:null===(t=P.find((e=>e.key===y)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:c.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const n=s.projects.map((e=>({key:e.gid,columns:[(0,J.jsxs)(yd.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,J.jsx)(Js.Z,{style:{marginRight:2},onClick:()=>{const t={...j[s.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o="all"===i||"in_complete"===i?[]:i.includes(e.gid)?i.filter((t=>t!==e.gid)):i.concat(e.gid),nd.Z.setState({...v,selectedProjectsAndTeamspaces:{...j,[s.gid]:{notionTeamspaceId:n,projects:o}}})},checked:(()=>{const t={...j[s.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,J.jsx)(Sd.z,{color:e.color,size:6}),(0,J.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,J.jsxs)(le.Z,{isMultiline:!0,style:{color:u.lightTextColor},children:[e.name,(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)"})]}):(0,J.jsx)(le.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,J.jsxs)(le.Z,{isSmall:!0,children:[b?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${s.gid}-tasks-count`)]})));return s.nextPage&&n.push({key:"loadMore",columns:[(0,J.jsx)(uo.Z,{disabled:f,style:{marginLeft:20,color:Ki.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!i)return;x(!0);const e=await C.getTeamsAndProjectsInAsanaWorkspace(d,{workspaceId:i,teamId:s.gid,size:5,nextPage:s.nextPage}),{teamsAndProjects:t}={...v},n=t.find((e=>e.gid===s.gid));if(n){if("success"===e.type){const i=e.data.find((e=>e.gid===s.gid));if(!i)return;n.projects.push(...i.projects),n.nextPage=i.nextPage,nd.Z.setState({...v,teamsAndProjects:t,loadMoreClicks:M+1})}x(!1)}},children:f?(0,J.jsxs)(yd.gq,{alignItems:"center",gap:8,children:[(0,J.jsx)(Es.Z,{style:{fontSize:12}}),(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects..."})},`${s.gid}-loadmore`)]}),n}({collapsed:m})})]})}function Rd(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d}=e,c=(0,h.useIntl)(),[u,m]=(0,n.useState)(""),p=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,f=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,placementToOrigin:Sn.pO.Bottom,renderOrigin:e=>(0,J.jsxs)(Vt.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${Ki.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:Ki.FN.light.gray[50],color:o?void 0:Ki.FN.light.gray[300]},disabled:!1,children:[(0,J.jsx)(le.Z,{style:{textOverflow:"ellipsis"},children:p||a}),(0,gd.i)(f.icon)]}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"asanaImport.dropdown.menuList",render:e=>(0,J.jsx)(sn.Z,{...e}),items:(u.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase())})):i).map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,J.jsx)($s.Z,{...e,title:i,shouldWrapCaption:!0,right:p===i?(0,J.jsx)("div",{style:{width:14},children:(0,pd.e)()}):void 0})}}))}];return(0,J.jsxs)(J.Fragment,{children:[d?(0,J.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:Ki.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${Ki.FN.light.gray[100]}`,justifyContent:"space-between",background:Ki.FN.light.gray[50],fontSize:g.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:c.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>m(e.target.value),value:u}):(0,J.jsx)(J.Fragment,{}),(0,J.jsx)(Xs.Z,{...t,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function Dd(e){var t;window.__c={n:"CheckboxDropdown"};const{onSelectOption:s,options:i,currentOption:o}=e,a=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,r=(0,n.useMemo)((()=>void 0!==o&&"specific"!==o&&("all"===o||"partial")),[o]);return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,placementToOrigin:Sn.pO.Bottom,alignmentToOrigin:Sn.vR.Start,renderOrigin:e=>(0,J.jsx)(Vt.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,J.jsx)(Js.Z,{checked:r,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,J.jsx)(sn.Z,{...e}),items:i.map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,J.jsx)($s.Z,{...e,title:i,shouldWrapCaption:!0,right:a===i?(0,J.jsx)("div",{style:{width:14},children:(0,pd.e)()}):void 0})}}))}];return(0,J.jsx)(Xs.Z,{...t,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}var Bd=s(53465),Ld=s(64878);const Od=function(e){var t;window.__c={n:"ImportStepImportingDataFailedTab"};const s=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.lightTextColor}})),[]);return(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,J.jsxs)(yd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,J.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,Ld.h)(s.iconStyle),(0,Ld.h)(s.iconStyle),(0,Ld.h)(s.iconStyle),(0,Bd.X)(s.closeIconStyle),(0,Ld.h)(s.iconStyle),(0,Ld.h)(s.iconStyle),(0,Ld.h)(s.iconStyle),(0,J.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:id.Z.images.notionLogoPng})]}),(0,J.jsx)(le.Z,{style:s.lightText,children:e.failedMessage}),(0,J.jsx)(le.Z,{style:s.lightText,children:(0,J.jsx)(h.FormattedMessage,{id:"import.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",values:{link:(0,J.jsx)("a",{style:{color:Ki.ZP.black,cursor:"pointer"},href:`/${null===(t=e.loggerPageId)||void 0===t?void 0:t.replaceAll("-","")}`,children:(0,J.jsx)(h.FormattedMessage,{id:"import.importingData.failed.linkText",defaultMessage:"import logs"})})}})})]})};const Ed=function(e){window.__c={n:"LoaderWithDots"};const{dotCount:t=6,speed:s=800}=e,[i,o]=(0,n.useState)(1),a=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,n.useEffect)((()=>{const e=setInterval((()=>o((e=>e<t?e+1:1))),s);return()=>clearInterval(e)}),[t,s]),(0,J.jsx)(yd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:Array.from({length:t},((e,t)=>t+1)).map((e=>(0,J.jsx)("div",{children:(0,Ld.h)(i===e?a.iconStyleBold:a.iconStyle)},e)))})};const Nd=function(e){window.__c={n:"ImportStepImportingDataTab"};const t=(0,r.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},iconStyleBold:{width:8,height:8,fill:e.mediumIconColor},lightText:{color:e.lightTextColor}})),[]);return(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,J.jsxs)(yd.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,J.jsx)("img",{style:{width:32,height:32,marginRight:8},src:e.assetSrc}),(0,J.jsx)(Ed,{}),(0,J.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:id.Z.images.notionLogoPng})]}),(0,J.jsx)(yd.gq,{children:(0,J.jsx)(le.Z,{style:t.lightText,children:(0,J.jsx)(h.FormattedMessage,{id:"import.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window."})})}),(0,J.jsx)(yd.gq,{children:(0,J.jsx)(le.Z,{style:t.lightText,children:(0,J.jsx)(h.FormattedMessage,{id:"import.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur."})})})]})},Vd=(0,h.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Asana workspace.",id:"Asanaimport.importingData.failed.problemsOccured"}});function Ud(e){switch(e){case"selectData":return(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.selectData.tabTitle",defaultMessage:"Select Asana workspace"})});case"chooseWorkspace":return(0,J.jsx)(le.Z,{style:{font:"SF Pro",fontWeight:"590",fontSize:"17px",lineHeight:"22px"},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tabTitle",defaultMessage:"Choose Asana workspace"})});default:return(0,J.jsx)(J.Fragment,{})}}function Wd(e){switch(e){case"chooseWorkspace":return(0,J.jsx)(le.Z,{style:{font:"SF Pro",fontWeight:g.Z.fontWeight.regular,fontSize:g.Z.fontSize.UIRegular.desktop,lineHeight:"19.6px",whiteSpace:"normal",wordWrap:"break-word",paddingBottom:20},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.chooseWorkspace.tabContext",defaultMessage:"Import your Asana projects and tasks into Notion. Assignees, due dates, attachments, and more will be kept, and you can use Notion’s database features to customize your projects and tasks for your team’s needs"})});default:return(0,J.jsx)(J.Fragment,{})}}function Kd(e){window.__c={n:"GetStepIndicator"};const t="chooseWorkspace",s=(0,r.yK)((e=>({stepIndicator:{font:"SF Pro",alignItems:"center",fontWeight:510,fontSize:g.Z.fontSize.UIRegular.desktop,lineHeight:"18px"},stepIndicatorContainer:{display:"flex",height:32,padding:6,gap:"8px",borderRadius:4,justifyContent:"center",alignItems:"center"},verificationCheck:{width:16,height:16,padding:"0.5px, 0px, 0px, 0px",gap:"10px",color:Ki.ZP.lightIconColor}})),[]),n=(0,a.VK)((()=>nd.Z.getState()),[]),{choosingWorkspacesCompleted:i}=n;return(0,J.jsxs)("div",{style:{paddingBottom:20,display:"flex",gap:"12px",padding:"12px",alignItems:"center",alignContent:"center",paddingLeft:0},children:[(0,J.jsxs)("div",{style:{...s.stepIndicatorContainer,width:i?191:165,background:e===t?"rgba(0, 0, 0, 0.05)":void 0},children:[i?(0,ld.X)(s.verificationCheck):(0,J.jsx)(J.Fragment,{}),(0,J.jsx)(le.Z,{style:{...s.stepIndicator,color:i?Ki.ZP.lightTextColor:e===t?Ki.ZP.regularTextColor:Ki.ZP.mediumTextColor},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.chooseWorkspaceTab",defaultMessage:"Choose what to import"})})]}),(0,J.jsxs)("div",{style:{...s.stepIndicatorContainer,width:"confirm"===e?83:57,background:"importingData"===e?"rgba(0, 0, 0, 0.05)":void 0},children:["confirm"===e?(0,ld.X)(s.verificationCheck):(0,J.jsx)(J.Fragment,{}),(0,J.jsx)(le.Z,{style:{...s.stepIndicator,color:"confirm"===e?Ki.ZP.lightTextColor:"importingData"===e?Ki.ZP.regularTextColor:Ki.ZP.mediumTextColor},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.importsTab.stepIndicator.importTab",defaultMessage:"Import"})})]})]})}const zd=function(e){let{tab:t,fetchActiveImportTasks:s}=e;window.__c={n:"AsanaImportStepTab"};const i=B.default.getIntl(),l=(0,o.O7)(),d=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),c=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),m=(0,a.VK)((()=>ud.Z.state.teams),[]),p=(0,a.VK)((()=>nd.Z.state),[]),f=(0,a.VK)((()=>ce.default.checkGate("improved_asana_importer_screens")),[]),x=(0,a.VK)((()=>Ae.Z.state),[]).flowId||(0,u.ZP)(),{importCompletedTasks:y,loggerPageId:S,selectedProjectsAndTeamspaces:v,selectedWorkspace:b,templateCreationInProgress:M,result:j,workspaces:w}=p,C=(0,n.useCallback)((()=>Object.values(v).some((e=>0!==e.projects.length))),[v]),k=(0,r.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},helpCenterButtonStytles:{display:"flex",alignItems:"baseline",justifyContent:"center",alignContent:"center",fontSize:g.Z.fontSize.UIRegular.desktop,padding:"6px, 0px, 0px, 0px",borderRadius:4,color:e.mediumTextColor,marginTop:2,width:298,height:28,gap:"4px",lineHeight:"18px"},externalLinkIcon:{width:"16px",height:"16px",padding:"0.5px, 0px, 0px, 0px",gap:"8px"}})),[]);function T(){return(0,J.jsx)(uo.Z,{style:k.helpCenterButtonStytles,onClick:()=>{cd.c4({url:(0,Ze.UY)("guides.importAsana"),environment:l})},hoveredStyle:{background:"none"},children:(0,J.jsxs)("div",{style:{width:282,height:18,display:"flex",justifyContent:"center",alignItems:"start"},children:[(0,J.jsx)("div",{style:{width:264,height:18,font:"SF Pro",fontWeight:g.Z.fontWeight.medium,fontSize:g.Z.fontSize.UIRegular.desktop,lineHeight:"18px"},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.confirm.helpCenter",defaultMessage:"Learn more about importing from Asana"})}),(0,rd.K)(k.externalLinkIcon)]})})}let I=t;return f&&("selectData"===t?I="chooseWorkspace":"confirm"===t&&(I="importComplete")),(0,J.jsxs)(Xe.ZP,{controlRow:(e=>"selectData"===e?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,J.jsx)(ws.Z,{style:{border:0},disabled:!w.length,onClick:()=>{s(),nd.Z.resetImport()},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,J.jsxs)(yd.gq,{alignItems:"center",gap:8,children:[b?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Ia.Z,{on:y,onClick:()=>nd.Z.setState({...p,importCompletedTasks:!y})}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,J.jsx)(J.Fragment,{}),(0,J.jsx)("div",{style:{gap:2},children:(0,J.jsx)(Ws.Z,{style:{marginLeft:16},disabled:!C()||M,onClick:()=>{d&&c&&dd.T_({environment:l,currentSpaceViewStore:c,spaceStore:d,teamsStores:m,flowId:x}).catch((()=>{}))},children:M?(0,J.jsxs)(yd.gq,{alignItems:"center",gap:2,children:[(0,J.jsx)(Es.Z,{isWhite:!0}),(0,J.jsx)(h.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,J.jsx)(h.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]})]}):"chooseWorkspace"===e?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[T(),(0,J.jsxs)(yd.gq,{alignItems:"center",gap:8,children:[b?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Ia.Z,{on:y,onClick:()=>nd.Z.setState({...p,importCompletedTasks:!y})}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.chooseWorkspace.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,J.jsx)(J.Fragment,{}),(0,J.jsxs)("div",{style:{gap:2},children:[(0,J.jsx)(ws.Z,{style:{border:0},disabled:!w.length,onClick:()=>{s(),nd.Z.resetImport()},children:(0,J.jsx)(h.FormattedMessage,{id:"asanaImport.chooseWorkspace.backButtonText",defaultMessage:"Back"})}),(0,J.jsx)(Ws.Z,{style:{marginLeft:16},disabled:!C()||M,onClick:()=>{d&&c&&dd.T_({environment:l,currentSpaceViewStore:c,spaceStore:d,teamsStores:m,flowId:x}).catch((()=>{}))},children:M?(0,J.jsxs)(yd.gq,{alignItems:"center",gap:2,children:[(0,J.jsx)(Es.Z,{isWhite:!0}),(0,J.jsx)(h.FormattedMessage,{id:"importsTab.chooseWorkspace.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,J.jsx)(h.FormattedMessage,{id:"importsTab.chooseWorkspace.nextButtonText",defaultMessage:"Next"})})]})]})]}):"importingData"===e?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:f?"space-between":"right"},children:[f?T():(0,J.jsx)(J.Fragment,{}),(0,J.jsx)(ws.Z,{disabled:!w.length,onClick:()=>{s(),nd.Z.resetImport()},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})]}):"confirm"===e?(0,J.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,J.jsx)(Ws.Z,{onClick:()=>{S&&cd.c4({url:(0,od.Z)({pageId:S,pageModel:(0,ad.lA)({table:hi.iU,id:S}),baseUrl:Hi.default.domainBaseUrl,pageVisitSource:un.tY.Import}),environment:l}),nd.Z.resetImport(),qe.Z.reset()},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,J.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,J.jsx)(ws.Z,{disabled:!w.length,onClick:()=>{s(),nd.Z.resetImport()},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"importComplete"===e?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",height:48,paddingTop:35,paddingBottom:28,border:"1px, 0px, 0px, 0px"},children:[T(),(0,J.jsx)(Ws.Z,{style:{width:"181px",height:"32px",padding:"0px, 0px, 0px, 8px",borderRadius:"4px",gap:"4px"},onClick:()=>{if(null!=j&&j.length&&S){const e=j.find((e=>void 0!==e.projectCollectionPageId));cd.c4({url:(0,od.Z)({pageId:(null==e?void 0:e.projectCollectionPageId)||S,pageModel:(0,ad.lA)({table:hi.iU,id:(null==e?void 0:e.projectCollectionPageId)||S}),baseUrl:Hi.default.domainBaseUrl,pageVisitSource:un.tY.Import}),environment:l})}nd.Z.resetImport(),qe.Z.reset()},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.confirm.viewImportedProjects",defaultMessage:"View imported projects"})})]}):void 0)(I),controlRowPaddingTopBottom:"confirm"===t&&f?0:f?10:20,removeBoxShadow:"confirm"===t&&f,contentPaddingLeftRight:f?25:void 0,controlRowPaddingLeftRight:f?15:void 0,getPaddingTopBottom:f?()=>2:void 0,children:[(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[f?Kd(I):(0,J.jsx)(J.Fragment,{}),(0,J.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,J.jsx)(uo.Z,{onClick:()=>{s(),nd.Z.resetImport()},style:k.closeButton,hoveredStyle:k.closeButtonHover,children:(0,Bl.D)(k.closeButtonIcon)})})]}),Wd(I),(0,J.jsx)(le.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:g.Z.fontWeight.medium,width:"100%"},children:Ud(I)}),(e=>"selectData"===e?(0,J.jsx)(_d,{}):"importingData"===e?(0,J.jsx)(Nd,{assetSrc:id.Z.images.import.asanaPng}):"confirm"===e?(0,J.jsx)(kd,{}):"failure"===e?(0,J.jsx)(Od,{assetSrc:id.Z.images.import.asanaPng,loggerPageId:S,failedMessage:i.formatMessage(Vd.failed)}):"chooseWorkspace"===e?(0,J.jsx)(bd,{}):"importComplete"===e?(0,J.jsx)(Zd,{}):void 0)(I)]})};const qd=function(e){let{fetchActiveImportTasks:t}=e;window.__c={n:"AsanaImportModal"};const s=(0,a.VK)((()=>nd.Z.state),[]),{isModalOpen:i}=s,o=(0,n.useCallback)((()=>{nd.Z.resetImport()}),[]),r=(0,n.useCallback)((()=>{const{currentTab:e}=s;return(0,J.jsx)(zd,{fetchActiveImportTasks:t,tab:e})}),[s,t]);return(0,J.jsx)(wo.Z,{open:i,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,J.jsx)(Mo.Z,{capture:!0,allowEsc:!0,render:()=>(0,J.jsx)(jo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>r()})}),onDismiss:o})};var Gd=s(3666),Hd=s(69122),Qd=s(61397);const Yd=function(){window.__c={n:"MondayImportStepConfirmTab"};const e=(0,a.VK)((()=>Hd.Z.state),[]);return e.result?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(le.Z,{isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,J.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,J.jsx)($d,{importStatus:e},e.mondayFolderId)))})]}):(0,J.jsx)(J.Fragment,{})};function $d(e){let{importStatus:t}=e;window.__c={n:"CollapsibleMondayProjectsTable"};const s=(0,r.Fg)(),[i,o]=(0,n.useState)(!1),d=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),c=(0,a.VK)((()=>Hd.Z.state.mondayFoldersAndBoards),[]),u=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),m=(0,a.VK)((()=>{if(!u)return;const e=u.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,J.jsx)(An.p,{disabled:!0,store:e})})));return d?(e||[]).concat({id:u.id,name:"Private",icon:(0,J.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:Ki.FN.light.gray[75]},children:(0,l.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[u,d,s]),{notionTeamspaceName:p,notionTeamspaceIcon:g}=(0,n.useMemo)((()=>{const e=null==m?void 0:m.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[m,t]),f=(0,n.useMemo)((()=>{const e=c.find((e=>e.folderId===t.mondayFolderId));return null==e?void 0:e.folderName}),[c,t]);return(0,J.jsxs)(yd.gq,{style:{marginTop:16},children:[(0,J.jsx)(vn.Z,{ariaLabel:"collapse toggle",icon:fd.L,onClick:()=>o((e=>!e)),style:{transform:i?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,J.jsx)(vd.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,J.jsx)(yd.gq,{alignItems:"center",gap:2,children:(0,J.jsx)(le.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:f})}),style:{width:300}},{key:"importedInto",header:(0,J.jsxs)(yd.gq,{gap:4,children:[(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:4},children:[(0,J.jsx)(le.Z,{isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,md.n)({width:12})]}),(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:4},children:[g,p]})]}),style:{width:300}}],rows:function(e){let{collapsed:s}=e;return s?[]:t.projects.map((e=>({key:e.projectId,columns:[(0,J.jsxs)(yd.gq,{gap:8,alignItems:"center",children:[(0,Cd.r)({width:12,color:Ki.FN.dark.green[600]}),(0,J.jsx)(le.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId)]})))}({collapsed:i})})]})}const Jd=function(){window.__c={n:"MondayImportStepSelectDataTab"};const e=(0,o.O7)(),t=(0,h.useIntl)(),s=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),i=(0,a.VK)((()=>Hd.Z.getState()),[]),{workspaces:r,selectedWorkspace:l,mondayFoldersAndBoards:d}=i;return(0,n.useEffect)((()=>{l&&Qd.IO({environment:e,spaceId:null==s?void 0:s.id,selectedWorkspace:l}).catch((()=>{}))}),[l,e,null==s?void 0:s.id]),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(le.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,J.jsx)(ec,{onSelectOption:e=>{Hd.Z.setState({...i,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:r.map((e=>({key:e.id,label:e.name}))),currentOption:i.selectedWorkspace,placeHolder:t.formatMessage({id:"mondayImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),i.selectedWorkspace?(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold,marginTop:18},children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,J.jsx)(J.Fragment,{}),i.isLoadingProjects?(0,J.jsxs)(yd.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,J.jsx)(Es.Z,{style:{fontSize:12}}),(0,J.jsx)(le.Z,{isSmall:!0,style:{color:Ki.FN.light.gray[400]},children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):d.map((e=>(0,J.jsx)(Xd,{mondayFolderAndBoards:e},`${e.folderId}-table`)))]})};function Xd(e){var t;let{mondayFolderAndBoards:s}=e;window.__c={n:"CollapsibleMondayProjectsTable"};const i=(0,h.useIntl)(),o=(0,r.Fg)(),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)(),p=(0,a.VK)((()=>Hd.Z.getState()),[]),f=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),x=(0,a.VK)((()=>{const e=null==f?void 0:f.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,J.jsx)(An.p,{disabled:!0,store:e})})))}),[f]);(0,n.useEffect)((()=>{if(!x||!f)return;if(!p.selectedProjectsAndTeamspaces[s.folderId]){m("private"),Qd.eL({folderId:s.folderId,spaceId:null==f?void 0:f.id});for(const n of x){var e,t;if((null===(e=n.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.folderName)||void 0===t?void 0:t.toLowerCase())){m(n.id),Qd.eL({folderId:s.folderId,spaceId:n.id});break}}}}),[x,s,f,p.selectedProjectsAndTeamspaces]);const y=(0,n.useCallback)((e=>{Qd.eL({folderId:s.folderId,spaceId:e}),m(e)}),[s.folderId]),S=(0,n.useCallback)((e=>{if("create"===e)return void xd.lo("monday_importer",{onClose:y});let t;if("private"===e){if(null==f||!f.id)return;t=f.id}else t=e;Qd.eL({folderId:s.folderId,spaceId:t}),m(e)}),[null==f?void 0:f.id,s.folderId,y]),v=[{key:"private",searchTerm:"private",label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:8},children:[(0,J.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:Ki.FN.light.gray[75]},children:(0,l.Q)({color:o.mediumIconColor,width:12.5,height:12.5})}),(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.regular},children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return x&&v.push(...x.map((e=>({key:e.id,searchTerm:e.name,label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),v.push({key:"create",searchTerm:"New teamspace",label:(0,J.jsxs)(yd.gq,{alignItems:"center",style:{gap:4},children:[(0,hd.f)({color:o.mediumIconColor,width:16,height:16}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,J.jsxs)(yd.gq,{style:{marginLeft:-18},children:[(0,J.jsx)(vn.Z,{ariaLabel:"collapse toggle",icon:fd.L,onClick:()=>c((e=>!e)),style:{transform:d?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,J.jsx)(vd.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,J.jsxs)(yd.gq,{alignItems:"center",gap:2,children:[(0,J.jsx)(Js.Z,{style:{marginRight:4,height:14},checked:(()=>{const e={...p.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}};return Boolean(e.isEntireFolderSelected)})(),size:14,checkSize:8,onClick:()=>{const e={...p.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0,isEntireFolderSelected:void 0}},{notionTeamspaceId:t,isEntireFolderSelected:n}=e;let i,o;if(n)i=[],o=!1;else{i=[...s.projects.map((e=>({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}))),...s.taskBoards.map((e=>({name:e.name,mondayProjectId:e.id,collectionType:"tasks"})))],o=!0}Hd.Z.setState({...p,selectedProjectsAndTeamspaces:{...p.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:t,projects:i,isEntireFolderSelected:o}}})}}),(0,J.jsx)(le.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.folderName})]}),style:{width:300}},{key:"importInto",header:(0,J.jsxs)(yd.gq,{style:{alignItems:"center"},children:[(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,J.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,md.n)({width:12})}),(0,J.jsxs)(yd.gq,{style:{alignItems:"center",gap:8},children:[(0,J.jsx)("img",{src:id.Z.emails.notionLogoBlackSmallPng,height:18}),(0,J.jsx)(ec,{options:v,onSelectOption:S,currentOption:null===(t=v.find((e=>e.key===u)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:i.formatMessage({id:"mondayImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const n=s.projects.map((e=>({key:e.id,columns:[(0,J.jsxs)(yd.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,J.jsx)(Js.Z,{style:{marginRight:2},onClick:()=>{const t={...p.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o=i.find((t=>t.mondayProjectId===e.id))?i.filter((t=>t.mondayProjectId!==e.id)):i.concat({name:e.name,mondayProjectId:e.id,mondayBoardId:e.boardId,collectionType:"projects"}),Hd.Z.setState({...p,selectedProjectsAndTeamspaces:{...p.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:n,projects:o}}})},checked:{...p.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,J.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,J.jsx)(le.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]}))),i=s.taskBoards.map((e=>({key:e.id,columns:[(0,J.jsxs)(yd.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,J.jsx)(Js.Z,{style:{marginRight:2},onClick:()=>{const t={...p.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:n,projects:i}=t;let o;o=i.find((t=>t.mondayProjectId===e.id))?i.filter((t=>t.mondayProjectId!==e.id)):i.concat({name:e.name,mondayProjectId:e.id,collectionType:"tasks"}),Hd.Z.setState({...p,selectedProjectsAndTeamspaces:{...p.selectedProjectsAndTeamspaces,[s.folderId]:{notionTeamspaceId:n,projects:o}}})},checked:{...p.selectedProjectsAndTeamspaces[s.folderId]||{projects:[],notionTeamspaceId:void 0}}.projects.some((t=>t.mondayProjectId===e.id)),size:14,checkSize:8}),(0,J.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:(0,J.jsx)(le.Z,{isMultiline:!0,children:e.name})})]},`${e.id}-container`)]})));return[...n,...i]}({collapsed:d})})]})}function ec(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:i,currentOption:o,placeHolder:a,narrow:l,allowSearch:d}=e,c=(0,h.useIntl)(),[u,m]=(0,n.useState)(""),p=null===(t=i.find((e=>{let{key:t}=e;return t===o})))||void 0===t?void 0:t.label,f=(0,r.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,placementToOrigin:Sn.pO.Bottom,renderOrigin:e=>(0,J.jsxs)(Vt.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${Ki.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:o?void 0:Ki.FN.light.gray[50],color:o?void 0:Ki.FN.light.gray[300]},disabled:!1,children:[(0,J.jsx)(le.Z,{style:{textOverflow:"ellipsis"},children:p||a}),(0,gd.i)(f.icon)]}),render:e=>{const t={menuType:Hs.og.Popup,width:250,left:50},n=[{key:"mondayImport.dropdown.menuList",render:e=>(0,J.jsx)(sn.Z,{...e}),items:(u.trim()?i.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase())})):i).map((t=>{let{key:n,label:i}=t;return{key:n,action:()=>{s(n),e.close()},render:e=>(0,J.jsx)($s.Z,{...e,title:i,shouldWrapCaption:!0,right:p===i?(0,J.jsx)("div",{style:{width:14},children:(0,pd.e)()}):void 0})}}))}];return(0,J.jsxs)(J.Fragment,{children:[d?(0,J.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:Ki.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${Ki.FN.light.gray[100]}`,justifyContent:"space-between",background:Ki.FN.light.gray[50],fontSize:g.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:c.formatMessage({id:"mondayImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>m(e.target.value),value:u}):(0,J.jsx)(J.Fragment,{}),(0,J.jsx)(Xs.Z,{...t,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}const tc=(0,h.defineMessages)({failed:{defaultMessage:"Some problems occurred while importing data from your Monday workspace.",id:"Mondayimport.importingData.failed.problemsOccured"}});function sc(e){switch(e){case"selectData":return(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.semibold},children:(0,J.jsx)(h.FormattedMessage,{id:"MondayImport.importsTab.selectData.tabTitle",defaultMessage:"Select Monday.com workspace"})});default:return(0,J.jsx)(J.Fragment,{})}}const nc=function(e){let{tab:t,fetchActiveImportTasks:s}=e;window.__c={n:"MondayImportStepTab"};const i=B.default.getIntl(),l=(0,o.O7)(),d=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),c=(0,a.VK)((()=>_e.default.state.currentSpaceViewStore),[]),m=(0,a.VK)((()=>ud.Z.state.teams),[]),p=(0,a.VK)((()=>Hd.Z.state),[]),f=(0,a.VK)((()=>Ae.Z.state),[]).flowId||(0,u.ZP)(),{workspaces:x}=p,y=(0,n.useCallback)((()=>Object.values(p.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[p.selectedProjectsAndTeamspaces]),S=(0,r.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,J.jsxs)(Xe.ZP,{controlRow:(e=>"selectData"===e?(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,J.jsx)(ws.Z,{style:{border:0},disabled:!x.length,onClick:()=>{s(),Hd.Z.resetImport()},children:(0,J.jsx)(h.FormattedMessage,{id:"mondayImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,J.jsx)(yd.gq,{alignItems:"center",gap:8,children:(0,J.jsx)(Ws.Z,{style:{marginLeft:16},disabled:!y()||p.templateCreationInProgress,onClick:()=>{d&&c&&Qd.C8({environment:l,spaceStore:d,currentSpaceViewStore:c,teamsStores:m,flowId:f}).catch((()=>{}))},children:p.templateCreationInProgress?(0,J.jsxs)(yd.gq,{alignItems:"center",gap:2,children:[(0,J.jsx)(Es.Z,{isWhite:!0}),(0,J.jsx)(h.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,J.jsx)(h.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})})]}):"importingData"===e?(0,J.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,J.jsx)(ws.Z,{disabled:!x.length,onClick:()=>{s(),Hd.Z.resetImport()},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"confirm"===e?(0,J.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,J.jsx)(Ws.Z,{onClick:()=>{var e;if(null!==(e=p.result)&&void 0!==e&&e.length&&p.loggerPageId){const e=p.result.find((e=>void 0!==e.projectCollectionPageId));cd.c4({url:(0,od.Z)({pageId:(null==e?void 0:e.projectCollectionPageId)||p.loggerPageId,pageModel:(0,ad.lA)({table:hi.iU,id:(null==e?void 0:e.projectCollectionPageId)||p.loggerPageId}),baseUrl:Hi.default.domainBaseUrl,pageVisitSource:un.tY.Import}),environment:l})}Hd.Z.resetImport(),qe.Z.reset()},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,J.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,J.jsx)(ws.Z,{disabled:!x.length,onClick:()=>{s(),Hd.Z.resetImport()},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):void 0)(t),controlRowPaddingTopBottom:20,children:[(0,J.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,J.jsx)(uo.Z,{onClick:()=>{s(),Hd.Z.resetImport()},style:S.closeButton,hoveredStyle:S.closeButtonHover,children:(0,Bl.D)(S.closeButtonIcon)})}),(0,J.jsx)(le.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:g.Z.fontWeight.medium,width:"100%"},children:sc(t)}),(e=>"selectData"===e?(0,J.jsx)(Jd,{}):"importingData"===e?(0,J.jsx)(Nd,{assetSrc:id.Z.images.import.mondayPng}):"confirm"===e?(0,J.jsx)(Yd,{}):"failure"===e?(0,J.jsx)(Od,{assetSrc:id.Z.images.import.mondayPng,loggerPageId:p.loggerPageId,failedMessage:i.formatMessage(tc.failed)}):void 0)(t)]})};const ic=function(e){let{fetchActiveImportTasks:t}=e;window.__c={n:"MondayImportModal"};const s=(0,a.VK)((()=>Hd.Z.state),[]),i=(0,n.useCallback)((()=>{Hd.Z.resetImport()}),[]),o=(0,n.useCallback)((()=>{const{currentTab:e}=s;return(0,J.jsx)(nc,{fetchActiveImportTasks:t,tab:e})}),[t,s]);return(0,J.jsx)(wo.Z,{open:s.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,J.jsx)(Mo.Z,{capture:!0,allowEsc:!0,render:()=>(0,J.jsx)(jo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>o()})}),onDismiss:i})};var oc=s(85567);const ac=function(e){window.__c={n:"ImportsTab"};const t=(0,a.VK)((()=>_e.default.state),[]),s=(0,a.VK)((()=>nd.Z.state),[]),{currentSpaceStore:i,mainEditorCurrentBlockStore:r,currentSpaceViewStore:l,currentUserSettingsStore:d}=t,u=(0,o.O7)(),{device:m}=(0,o.O7)(),[p,g]=(0,n.useState)([]),f=(0,n.useCallback)((async()=>{if(null==i||!i.id)return;const e=await C.getActiveImportTasks(u,{spaceId:i.id});"success"===e.type&&g(e.data)}),[i,u]);return(0,n.useEffect)((()=>{f().catch((()=>{}));const e=setInterval(f,6e4);return()=>clearInterval(e)}),[i,u,f]),(0,n.useEffect)((()=>{let e;const t=async s=>{const i=await C.getAsanaWorkspacesNames(u,{});if(s+=1,"success"===i.type)if(null!=i&&i.data.account)nd.Z.setState({...nd.Z.state,account:i.data.account,workspaces:i.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1,currentTab:"selectData",isModalOpen:!0});else{if(s>n)return;e=setTimeout((()=>t(s)),2e3)}},n=180;if(s.isAccountLinkingInProgress){t(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[s.isAccountLinkingInProgress,u]),i&&l&&l&&d?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(et.Z,{large:!m.isMobile||void 0,divider:m.isMobile?void 0:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.title",defaultMessage:"Import data"})}),(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.subtitle",defaultMessage:"Import data from other apps and files into Notion"})}),(0,J.jsx)(le.Z,{isSmall:!0,children:e.genericImporterEnabled?(0,J.jsx)(h.FormattedMessage,{id:"importsTab.unsupportedImportsHelperTextForUniversalImport",defaultMessage:"If the app you’re using isn’t listed below, try the <boldtext>Universal import</boldtext> ",values:{boldtext:e=>(0,J.jsx)("span",{style:{fontWeight:600},children:e})}}):(0,J.jsx)(h.FormattedMessage,{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we don't support yet, you can try importing it via CSV file."})}),(0,J.jsxs)("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,J.jsx)(Gd.Z,{pageStore:r,spaceStore:i,spaceViewStore:l,userSettingsStore:d,analyticsFrom:"modal",onComplete:e=>{sd._({environment:u,store:e,pageVisitSource:un.tY.Import}),qe.Z.reset()},readOnlyCreditButton:!1}),(0,J.jsx)(qd,{fetchActiveImportTasks:f}),(0,J.jsx)(ic,{fetchActiveImportTasks:f})]}),(0,J.jsxs)("div",{style:{marginTop:32},children:[(0,J.jsx)(le.Z,{isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"})}),(0,J.jsx)(vd.Z,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.activeImports.importTime",defaultMessage:"Import time"})},{key:"importFrom",header:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.activeImports.importFrom",defaultMessage:"Import from"})},{key:"importStatus",header:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.activeImports.importStatus",defaultMessage:"Status"})}],rows:p.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,Ma.Yx)(e.startedAt,"long",B.default.getIntl().locale)} ${(0,Ma.Yx)(e.startedAt,"time",B.default.getIntl().locale)}`:"",(0,c.kC)(e.source),(0,J.jsx)(oc.Z,{isRound:!0,showRemoveButton:!1,value:(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"activeImports.status.inProgress",defaultMessage:"In progress"})}),backgroundColor:Ki.FN.light.blue[200],showColoredDot:"blue",format:td.lo.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),p.length?(0,J.jsx)(J.Fragment,{}):(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:16},children:(0,J.jsx)(h.FormattedMessage,{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account."})})]})]}):(0,J.jsx)(J.Fragment,{})};var rc=s(79092),lc=s(54153),dc=s(47839),cc=s(53730),uc=s(57222),mc=s(65680),pc=s(31194);class gc extends i.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:fn.Z}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const t="ja-JP"===this.props.currentLocale&&ce.default.checkGate("japan_full_launch");return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>(0,J.jsx)(J.Fragment,{children:(0,J.jsxs)(Vt.Z,{style:{marginLeft:-8,paddingLeft:8,paddingRight:8},...e,children:[this.props.pickerLabel?this.props.pickerLabel:fc(this.props.currentLocale,this.props.intl).label,(0,mc.ay)(this.props.currentLocale)&&!t&&(0,J.jsx)(Yi.Z,{desktopStyle:{marginLeft:4},children:(0,J.jsx)(h.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})}),(0,gd.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]})}),placementToOrigin:pc.Iw.Bottom,alignmentToOrigin:pc.lU.Start,render:e=>{let t;t=ce.default.checkGate("polyglot")?[...mc.tp,...mc.is]:[...mc.tp];const s=[{key:"languages",render:e=>(0,J.jsx)(sn.Z,{...e,topBorder:0!==e.index}),items:t.map((t=>({key:t,render:e=>function(e,t,s,n){const{label:i,caption:o}=fc(e,n);return(0,J.jsx)(xc,{label:i,caption:o,focused:t,props:s,locale:e})}(t,e.focused,e,this.props.intl),action:()=>{!function(e,t,s,n,i){t!==e&&function(e,t,s,n){const{label:i}=fc(e,t);if(s){const t=()=>{n(e)};v.showDialog({showCancel:!0,keepFocus:!1,message:(0,J.jsx)(h.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:i}}),items:[{label:(0,J.jsx)(h.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:t}]})}else n(e)}(e,s,n,i)}(t,this.props.currentLocale,this.props.intl,this.props.confirm,this.props.onChange),e.close()}})))}],n={menuType:Hs.og.Popup,width:240};return(0,J.jsx)(Xs.Z,{className:Ie.hKO,...n,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:s})})}})}}gc.displayName="LanguagePicker";const hc=(0,h.injectIntl)(gc);function fc(e,t){return(0,uc.t)(t)[e]}function xc(e){window.__c={n:"ItemComponent"};const{locale:t}=e,s=(0,r.Fg)(),n=(0,a.VK)((()=>"ja-JP"===t&&ce.default.checkGate("japan_full_launch")),[t]);return(0,J.jsx)($s.Z,{...e.props,title:(0,J.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,J.jsx)("div",{style:{...e.style,marginRight:0},children:e.label})}),caption:e.caption&&(0,J.jsx)("span",{style:{color:s.mediumTextColor},children:e.caption}),shouldWrapCaption:!0,right:(0,mc.ay)(e.locale)&&!n&&(0,J.jsx)(Yi.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})})})}const yc=function(e){window.__c={n:"LanguageSettings"};const t=(0,o.O7)(),{device:s,WindowSizeStore:n}=t,i=(0,a.VK)((()=>n.state.paddingLeftCSS),[n]),r=(0,a.VK)((()=>n.state.paddingRightCSS),[n]);return(0,J.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:s.isMobile?i:0,paddingRight:s.isMobile?r:0},children:(0,J.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,J.jsxs)("div",{style:{flex:1},children:[(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."})})]}),(0,J.jsx)(hc,{confirm:!0,onChange:async e=>{y.A01(t,{locale:e});const s=await C.setLocale(t,{locale:e});"success"===s.type?(lc.Z.set("preferredLocale",e),await cc.transactionQueue.drain(),t.device.isElectron?dc.refreshAll({includeFocusedWindow:!0}):window.location.reload(!0)):v.showError(s)},currentLocale:e.locale})]})})};var Sc=s(38737);function vc(e){var t;return(null==e||null===(t=e.getSettingsStore())||void 0===t||null===(t=t.getKeyStore("regional_format_settings"))||void 0===t?void 0:t.getKeyStore("region").getValue())||"US"}function bc(e,t){var s;const n=null==e||null===(s=e.getKeyStore("settings"))||void 0===s||null===(s=s.getKeyStore("regional_format_settings"))||void 0===s?void 0:s.getValue();return"full_date"===t?null!=n&&n.use_default_region_settings?Mc(vc(e)):(null==n?void 0:n.full_date)||Mc(vc(e)):"short_date"===t?null!=n&&n.use_default_region_settings?{type:"short"}:(null==n?void 0:n.short_date)||{type:"short"}:"number"===t?null!=n&&n.use_default_region_settings?"number":(null==n?void 0:n.number)||"number":"week_start_on"===t?null!=n&&n.use_default_region_settings?"sunday":(null==n?void 0:n.week_start_on)||"sunday":(0,Fs.t1)(t)}function Mc(e){return"JP"===e?{type:"short"}:{type:"long"}}const jc={full_date:(0,h.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,h.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,h.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,h.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},wc=(0,h.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function Cc(e,t){if("full_date"===t){return jc[t][bc(e,t).type]}if("short_date"===t){return jc[t][bc(e,t).type]}if("number"===t){return jc[t][bc(e,t)]}if("week_start_on"===t){return jc[t][bc(e,t)]}return(0,Fs.t1)(t)}function kc(e,t){return(0,Sc.uf)(1234567,e,t)}const Tc=(0,h.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function Ic(e,t){const s=e.type;return"short"===s||"long"===s||"medium"===s?(0,Ma.Yx)(Date.now(),s,(0,ja.E2)(t)):"iso"===s?(0,Ma.$6)(Date.now()):(0,Ma.Yx)(Date.now(),"long",(0,ja.E2)(t))}function Pc(e,t){const s=e.type;return"iso"===s?(0,Ma.$6)(Date.now()):"short"===s?(0,Ma.Yx)(Date.now(),s,(0,ja.E2)(t)):(0,Ma.Yx)(Date.now(),"short",(0,ja.E2)(t))}var Zc=s(68894),Fc=s(42782);const _c={full_date:(0,h.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,h.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,h.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,h.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function Ac(e){window.__c={n:"CustomRegionalFormatSettingPicker"};const[,,t]=(0,a.AF)(void 0,fn.Z),s=(0,r.Fg)(),[n,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),Cc(e.userSettingsStore,e.option)]),[e.option,e.userSettingsStore]);return n?(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,J.jsxs)(Vt.Z,{...e,children:[B.default.formatMessage(i),(0,gd.i)({width:10,marginLeft:4,fill:s.lightIconColor})]}),placementToOrigin:pc.Iw.Bottom,alignmentToOrigin:pc.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?(0,J.jsx)(Rc,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?(0,J.jsx)(Dc,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,Fs.t1)(e.option)}):(0,J.jsx)(Es.Z,{})}function Rc(e){window.__c={n:"SimpleFormatPicker"};const t=(0,o.O7)(),s=(0,h.useIntl)();return(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,width:216,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,J.jsx)(sn.Z,{...e,topBorder:0!==e.index}),items:(0,Fs.Yd)(_c[e.option]).map((n=>({key:n,render:t=>{const i="number"===e.option?kc(n,s):void 0;return(0,J.jsx)($s.Z,{...t,title:B.default.formatMessage(_c[e.option][n]),caption:i})},action:()=>{I.createAndCommit({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{P.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:vc(e.userSettingsStore),[e.option]:n}},transaction:t})}}),e.onAccept()}})))}]})})}function Dc(e){window.__c={n:"CustomizableFormatPicker"};const t=(0,o.O7)(),[s,i]=(0,n.useState)((()=>{})),a=(0,h.useIntl)(),r=(0,Fs.Yd)(_c[e.option]),l=n=>{const i="custom"===n?{type:n,format:s}:{type:n};I.createAndCommit({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{P.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:vc(e.userSettingsStore),[e.option]:i}},transaction:t})}}),e.onAccept()};return(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,width:216,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,J.jsx)(sn.Z,{...e,topBorder:0!==e.index}),items:r.map((t=>({key:t,render:n=>{if("custom"===t)return(0,J.jsx)(Fc.Z,{...n,renderOrigin:s=>(0,J.jsx)($s.Z,{...s,title:B.default.formatMessage(_c[e.option][t])}),onFocus:()=>{},renderExtension:()=>(0,J.jsx)(Bc,{customFormat:s,onChange:e=>{i(e)},onAccept:()=>{l(t)}}),title:B.default.formatMessage(_c[e.option][t])});{const s="full_date"===e.option?Ic({type:t},a):Pc({type:t},a);return(0,J.jsx)($s.Z,{...n,title:B.default.formatMessage(_c[e.option][t]),caption:s})}},action:()=>{l(t)}})))}]})})}function Bc(e){window.__c={n:"CustomDateFormatExtension"};const t=(0,r.yK)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:g.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return(0,J.jsxs)("div",{style:t.container,children:[(0,J.jsx)("div",{children:(0,J.jsx)(le.Z,{isSmall:!0,style:t.label,children:(0,J.jsx)(h.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"})})}),(0,J.jsx)(Zc.ZP,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),(0,J.jsx)($s.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:(0,J.jsx)(h.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})})]})}function Lc(e){window.__c={n:"RegionalFormatSettings"};const t=(0,r.yK)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),s=(0,a.VK)((()=>e.userSettingsStore.isReady()),[e.userSettingsStore]),n=(0,a.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),i=(0,o.O7)();return s?(0,J.jsxs)("div",{style:t.container,children:[(0,J.jsxs)("div",{style:t.controlRow,children:[(0,J.jsxs)("div",{style:t.label,children:[(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,J.jsx)(h.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"})})]}),(0,J.jsx)(Ia.Z,{on:n,onClick:()=>{I.createAndCommit({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:i,perform:t=>{const s=n?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};P.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:vc(e.userSettingsStore),...s}},transaction:t})}})}})]}),(0,J.jsx)("div",{children:n?(0,J.jsx)(Oc,{userSettingsStore:e.userSettingsStore}):(0,J.jsx)(Uc,{userSettingsStore:e.userSettingsStore})})]}):(0,J.jsx)(Es.Z,{})}function Oc(e){window.__c={n:"DefaultRegionalFormatSettings"};const t=(0,r.yK)((()=>({container:{marginTop:12}})),[]);return(0,J.jsx)("div",{style:t.container,children:Vc.map((t=>(0,J.jsx)(Ec,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Ec(e){window.__c={n:"DefaultRegionalFormatSetting"};const t=(0,r.yK)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:g.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:g.Z.fontSize.UIRegular.desktop}})),[]),s=(0,h.useIntl)(),[n,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),Nc(e.userSettingsStore,s,e.option)]),[s,e.option,e.userSettingsStore]);return n?(0,J.jsxs)("div",{style:t.container,children:[(0,J.jsx)("div",{style:t.option,children:B.default.formatMessage(wc[e.option])}),(0,J.jsx)("div",{style:t.example,children:i})]}):(0,J.jsx)(Es.Z,{})}function Nc(e,t,s){if("full_date"===s){return Ic(bc(e,s),t)}if("short_date"===s){return Pc(bc(e,s),t)}if("number"===s){return kc(bc(e,s),t)}if("week_start_on"===s){return function(e){return"sunday"===e?B.default.formatMessage(Tc.sunday):"monday"===e?B.default.formatMessage(Tc.monday):(0,Fs.t1)(e)}(bc(e,s))}return(0,Fs.t1)(s)}const Vc=["full_date","short_date","number","week_start_on"];function Uc(e){return(0,J.jsx)("div",{children:Vc.map((t=>(0,J.jsx)(Wc,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Wc(e){window.__c={n:"CustomRegionalFormatSetting"};const t=(0,h.useIntl)(),[s,n,i]=(0,a.VK)((()=>[e.userSettingsStore.isDefined(),vc(e.userSettingsStore),Nc(e.userSettingsStore,t,e.option)]),[t,e.option,e.userSettingsStore]),o=(0,r.yK)(Kc,[]);return s?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Ms.Z,{size:24}),(0,J.jsx)("div",{style:o.container,children:(0,J.jsxs)("div",{style:o.controlRow,children:[(0,J.jsxs)("div",{style:o.label,children:[(0,J.jsx)(le.Z,{children:B.default.formatMessage(wc[e.option])}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:o.subtitle,children:i})]}),(0,J.jsx)(Ac,{userSettingsStore:e.userSettingsStore,region:n,option:e.option})]})})]}):(0,J.jsx)(Es.Z,{})}function Kc(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}var zc=s(80994),qc=s(58573);function Gc(e){window.__c={n:"RegionSettings"};const t=(0,r.yK)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return(0,J.jsxs)("div",{style:t.container,children:[(0,J.jsxs)("div",{style:t.label,children:[(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,J.jsx)(h.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"})})]}),(0,J.jsx)(Hc,{userSettingsStore:e.userSettingsStore,onChange:e.onChange,pickerLabel:e.pickerLabel})]})}function Hc(e){window.__c={n:"RegionPicker"};const t=(0,r.Fg)(),[,,s]=(0,a.AF)(void 0,fn.Z),i=(0,a.VK)((()=>vc(e.userSettingsStore)),[e.userSettingsStore]),[o,l]=n.useState("");return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,buttonPopupStore:s,renderOrigin:s=>(0,J.jsxs)(Vt.Z,{...s,children:[e.userSettingsStore?i:e.pickerLabel,(0,gd.i)({width:10,marginLeft:4,fill:t.lightIconColor})]}),placementToOrigin:pc.Iw.Bottom,alignmentToOrigin:pc.lU.Start,render:t=>(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,width:216,header:(0,J.jsx)(Yc,{value:o,onChange:e=>l(e)}),children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>(0,J.jsx)(sn.Z,{...e,topBorder:0!==e.index}),items:(0,qc.ZP)(o,zc.hW,(e=>e.name)).map((s=>({key:s.countryCode,render:e=>(0,J.jsx)($s.Z,{...e,title:s.name}),action:()=>{e.onChange(s.countryCode),t.close(),l("")}})))}]})})})}const Qc=(0,h.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function Yc(e){return(0,J.jsx)(sn.Z,{isInput:!0,children:(0,J.jsx)(Zc.ZP,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:B.default.formatMessage(Qc.regionSearchPlaceholder),focusAfterAnimation:!0})})}var $c=s(758),Jc=s(68626),Xc=s(77058),eu=s(91155);const tu=function(e){window.__c={n:"SpellcheckerLanguagesPicker"};const[t,s]=n.useState([]),[i,l]=n.useState([]),d=(0,o.O7)(),c=(0,a.qz)(void 0,fn.Z),u=(0,r.yK)((e=>({span:{color:e.mediumTextColor},plainButton:{paddingLeft:8,paddingRight:8,marginLeft:-8},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function m(e){return i.some((t=>t.code===e.code))}(0,n.useEffect)((()=>{const e=d.SpellCheckStore;e&&!(0,$c.x)(e)&&(e.getAvailableLanguages().then(s).catch((e=>{Jc.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,eu.Ui)(e)})})),e.getLanguages().then(l).catch((e=>{Jc.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,eu.Ui)(e)})})))}),[d]),(0,n.useEffect)((()=>{const e=d.SpellCheckStore;if(!e||(0,$c.x)(e))return;const t=i.map((e=>{let{code:t}=e;return t}));e.setLanguages(t)}),[i,d.SpellCheckStore]);const p=i.length>0?i.slice(0,3).map((e=>{let{name:t}=e;return t})).join(", ")+(i.length>3?"…":""):(0,J.jsx)(h.FormattedMessage,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,buttonPopupStore:c,renderOrigin:e=>(0,J.jsx)(J.Fragment,{children:(0,J.jsxs)(Vt.Z,{style:u.plainButton,...e,children:[p,(0,gd.i)(u.icon)]})}),placementToOrigin:pc.Iw.Bottom,alignmentToOrigin:pc.lU.Start,render:e=>{const s=[{key:"spellcheckerlanguages",render:e=>(0,J.jsx)(sn.Z,{...e,topBorder:0!==e.index}),items:t.map((e=>({key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return(0,J.jsx)($s.Z,{...e.props,title:(0,J.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,J.jsx)("div",{style:{marginRight:0},children:t})}),shouldWrapCaption:!0,right:m(e.language)?(0,Xc.$)({width:12,height:12}):void 0})}({language:e,props:t}),action:()=>{m(e)?l(i.filter((t=>t.code!==e.code))):l([...i,e])}})))}],n={menuType:Hs.og.Popup,width:240};return(0,J.jsx)(Xs.Z,{className:Ie.hKO,...n,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:s})})}})};const su=function(e){window.__c={n:"SpellcheckerSettings"};const t=(0,o.O7)();return t.device.isElectron&&t.device.isWindows&&!(0,$c.x)(t.SpellCheckStore)?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Ms.Z,{size:24,isHidden:!0}),(0,J.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"},children:(0,J.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,J.jsxs)("div",{style:{flex:1},children:[(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."})})]}),(0,J.jsx)(tu,{})]})})]}):null};const nu=function(){return window.__c={n:"LanguageRegionSettings"},(0,a.VK)((()=>zt.Z.state.online),[])?(0,J.jsx)(ou,{}):(0,J.jsx)(iu,{})};function iu(){return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})})})}function ou(){window.__c={n:"Settings"};const e=(0,a.VK)((()=>_e.default.state.currentUserSettingsStore),[]),t=(0,a.VK)((()=>{var t;return(null==e||null===(t=e.getSettings())||void 0===t?void 0:t.preferred_locale)||ja.al}),[e]),s=(0,a.VK)((()=>"on"===ce.default.getGroup("aloha")),[]);return e?(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})}),(0,J.jsx)(yc,{locale:t,userSettingsStore:e}),(0,J.jsx)(su,{}),(0,J.jsx)(Ms.Z,{size:24}),s?(0,J.jsxs)("div",{style:{marginTop:12},children:[(0,J.jsx)(Gc,{locale:t,userSettingsStore:e,onChange:e=>{}}),(0,J.jsx)(Ms.Z,{size:24}),(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})}),(0,J.jsx)(Lc,{locale:t,userSettingsStore:e}),(0,J.jsx)(Ms.Z,{size:24})]}):(0,J.jsx)(rc.Z,{})]}):null}var au=s(15311),ru=s(28187),lu=s(21291),du=s(51124),cu=s(97876);function uu(){window.__c={n:"NotificationSettings"};const{isElectron:e,isMobile:t}=(0,o.Fy)(),s=(0,o.O7)(),n=(0,a.VK)((()=>zt.Z.state.online),[]),i=(0,a.VK)((()=>{const s=(0,ru.kC)();return function(e){const{isMobile:t,isElectron:s,showSlackNotificationSetting:n}=e;return[{key:"notify_mobile",renderSettingsItem:()=>(0,J.jsx)(lu.A,{target:"notify_mobile"})},!t&&s?{key:"notify_desktop",renderSettingsItem:()=>(0,J.jsx)(lu.A,{target:"notify_desktop"})}:void 0,n?{key:"notify_slack",renderSettingsItem:()=>(0,J.jsx)(cu.O,{target:"notify_slack"})}:void 0].filter(Fs.$K)}({isMobile:t,isElectron:e,showSlackNotificationSetting:s})}),[t,e]),r=(0,a.VK)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>(0,J.jsx)(lu.A,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>(0,J.jsx)(lu.A,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>(0,J.jsx)(lu.A,{target:"notify_email_digest"})},{key:"marketing_emails",renderSettingsItem:()=>(0,J.jsx)(lu.A,{target:"marketing_emails"})}].filter(Fs.$K)}({showNotifyEmailAlwaysSetting:(null===(e=_e.default.state.currentSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),l=(0,a.VK)((()=>s.WindowSizeStore.state.paddingBottomCSS),[s.WindowSizeStore]);return n?(0,J.jsxs)(Xe.ZP,{disableScroller:t,children:[(0,J.jsx)(et.Z,{large:!t,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"notificationSettings.notificationsSection.title",defaultMessage:"My notifications"})}),(0,J.jsx)(du.O,{items:i}),(0,J.jsx)(Ms.Z,{size:48,isHidden:!0}),(0,J.jsx)(et.Z,{large:!t,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})}),(0,J.jsx)(du.O,{items:r}),(0,J.jsx)(Ms.Z,{size:48,isHidden:!0}),(0,J.jsx)("div",{style:{marginTop:4,marginBottom:t?l:void 0},children:(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,Ze.UY)("guides.notificationSettings"),analyticsFrom:"notifications_settings"})})]}):(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Please go online to manage your notification settings.",id:"myNotificationsSettings.goOnline.prompt"})})})}var mu=s(2438),pu=s(5851),gu=s(78730),hu=s(98481),fu=s(64404),xu=s(1564),yu=function(e){return e[e.Keep=0]="Keep",e[e.Remove=1]="Remove",e}(yu||{});function Su(e){return(0,J.jsx)(wo.Z,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,J.jsx)(vu,{...e})})}function vu(e){window.__c={n:"DisableGuestsConfig"};const{onDismiss:t,onSave:s,guestCount:i}=e,[o,a]=(0,n.useState)(yu.Keep),l=(0,r.yK)((e=>({container:{width:350,padding:30,borderRadius:5,height:400,alignItems:"center"},title:{fontFamily:g.Z.getCompositeFontFamily(hr.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:g.Z.getCompositeFontFamily(hr.SP).sans,fontSize:14,fontWeight:300,lineHeight:"19px",margin:10,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column"},button:{justifyContent:"space-between",marginTop:10,height:70,borderRadius:5},buttonText:{display:"flex",flexDirection:"column"},optionSubtitle:{whiteSpace:"break-spaces"},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{justifyContent:"center",margin:"8px auto 0"}})),[]),d=(0,n.useCallback)((()=>{const e=o===yu.Keep;s(e)}),[s,o]);return(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsx)(le.Z,{style:l.title,children:(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsConfig.title",defaultMessage:"Disable inviting guests?"})}),(0,J.jsx)(le.Z,{isSmall:!0,style:l.subtitle,isMultiline:!0,children:(0,Fs.$K)(i)?(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsConfig.description",defaultMessage:"Your workspace currently has {guestCount, plural, one {1 guest} other {{guestCount} guests}}. You can choose to:",values:{guestCount:i}}):(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsConfig.description.noGuestCount",defaultMessage:"You are turning off guests in this workspace. You can choose to:"})}),(0,J.jsxs)("div",{style:l.radioContainer,children:[(0,J.jsxs)(ws.Z,{isLarge:!0,onClick:()=>a(yu.Keep),style:l.button,children:[(0,J.jsx)(yr.Z,{isSelected:o===yu.Keep}),(0,J.jsxs)("div",{style:l.buttonText,children:[(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.title",defaultMessage:"Keep existing guests"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:l.optionSubtitle,children:(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.description",defaultMessage:"Guests will still be able to access the pages they've been invited to"})})]})]}),(0,J.jsxs)(ws.Z,{isLarge:!0,onClick:()=>a(yu.Remove),style:l.button,children:[(0,J.jsx)(yr.Z,{isSelected:o===yu.Remove}),(0,J.jsxs)("div",{style:l.buttonText,children:[(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.title",defaultMessage:"Remove existing guests"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:l.optionSubtitle,children:(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.description",defaultMessage:"All guests will be removed from your workspace"})})]})]})]}),(0,J.jsxs)("div",{style:l.actionButtonsContainer,children:[(0,J.jsx)(Ws.Z,{isLarge:!0,onClick:d,children:(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsModal.saveChanges",defaultMessage:"Disable inviting guests"})}),(0,J.jsx)(Vt.Z,{onClick:t,style:l.cancelButton,children:(0,J.jsx)(h.FormattedMessage,{id:"disableGuestsModal.cancel",defaultMessage:"Cancel"})})]})]})}var bu=s(64768);const Mu=.5;class ju extends i.Z{constructor(){super(...arguments),this.storeTypes={tokenOptionsButtonPopupStore:fn.Z,domainVerificationStore:Ja.ZP}}renderComponent(){return zt.Z.state.online?(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(Wu,{securitySettingsStore:this.props.securitySettingsStore,spaceStore:this.props.spaceStore})}):(0,J.jsx)(Cu,{})}}ju.displayName="SecuritySettings";const wu=(0,h.injectIntl)(ju);function Cu(){return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})})})}function ku(e,t,s,n){pu.y(n,{spaceStore:s,securitySettingsStore:t,fields:e})}function Tu(e){return{fontWeight:g.Z.fontWeight.medium,fontSize:18,borderBottom:`1px solid ${e.regularDividerColor}`,paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}function Iu(){window.__c={n:"UpsellComponent"};const e=(0,r.Fg)(),t=(0,o.O7)(),s=(0,a.VK)((()=>(0,hu.J)({environment:t})),[t]),n=(0,a.VK)((()=>(0,jt.Rs)()),[]);return s?null:(0,J.jsxs)("div",{style:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,padding:16,marginTop:void 0,marginBottom:24},children:[!n&&(0,J.jsx)(xu.Z,{subscriptionTier:"business",from:"space_saml",upgradeMessage:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.upsell.button.business",defaultMessage:"Upgrade to Business"}),title:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.upsell.title.business",defaultMessage:"Upgrade for SAML SSO & more admin tools"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.business",defaultMessage:"The Business Plan includes single sign-on to manage employee access at scale, private teamspaces to collaborate on sensitive docs, and more."}),learnMoreRoute:"guides.securitySettings",style:{marginBottom:"20px"}}),(0,J.jsx)(xu.Z,{subscriptionTier:"enterprise",from:"space_saml",upgradeMessage:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.upsell.button.enterprise",defaultMessage:"Upgrade to Enterprise"}),title:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.upsell.title.enterprise",defaultMessage:"Upgrade for SCIM, advanced security & more"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.enterprise",defaultMessage:"The Enterprise Plan allows you to automatically provision users and groups, and gain more visibility and controls across the workspace."}),learnMoreRoute:"guides.securitySettings"})]})}function Pu(e){Wi.y(e,{from:"space_saml",for:"enterprise"})}async function Zu(e,t,s){const n=e.state.disableGuests,i=e.state.enableGuestInviteRequests;if(n)ku({disableGuests:!n,...i&&{enableGuestInviteRequests:!i}},e,t,s);else{if(ce.default.checkGate("show_keep_existing_guests_modal"))return void e.setState({...e.state,disableGuestsModalOpen:!0});if(!(await v.confirmUserAction({message:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;ku({disableGuests:!n},e,t,s)}}function Fu(e,t,s,n){const{name:i,isToggleEnabled:o,showUpgradeIfDisabled:a}=e;if(!o)return a?Pu(n):void 0;ku({[i]:!t.state[i]},t,s,n)}function _u(e){let{style:t}=e;window.__c={n:"UpsellButtonComponent"};const s=(0,o.O7)();return(0,J.jsx)(Ha.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:()=>Pu(s),desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3,...t}})}function Au(e){let{requestTogglesAvailableForTier:t,spaceStore:s,securitySettingsStore:n}=e;window.__c={n:"MembershipRequestTogglesComponent"};const i=(0,o.O7)(),r=(0,a.VK)((()=>(0,gu.U)(s,i)),[s,i]),l=(0,a.VK)((()=>(0,de.Or)()),[]),d=(0,a.VK)((()=>t&&!Boolean(n.state.disableMembershipRequests)),[t,n]),c=(0,a.VK)((()=>t&&!Boolean(n.state.disableExternalMembershipRequests)),[t,n]),u=(0,a.VK)((()=>t&&!Boolean(n.state.disableGuestMembershipRequests)),[t,n]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(bu.dy,{environment:i,toggleOn:d,onClick:()=>Fu({name:"disableMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},n,s,i),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t}),l&&(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(bu.ms,{environment:i,toggleOn:c,onClick:()=>Fu({name:"disableExternalMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},n,s,i),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t})}),r&&(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(bu.Xr,{environment:i,toggleOn:u,onClick:()=>Fu({name:"disableGuestMembershipRequests",isToggleEnabled:t,showUpgradeIfDisabled:!1},n,s,i),isReadOnly:!1,upsellOrigin:"space_saml",style:{marginBottom:24},shouldShowUpsell:!t})})]})}function Ru(e){let{toggleAvailableForTier:t,guestCount:s,securitySettingsStore:n,spaceStore:i}=e;window.__c={n:"DisableGuestsV2Component"};const r=(0,o.O7)(),l=(0,a.VK)((()=>n.state),[n]);return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.label",defaultMessage:"Disable members inviting guests to pages"}),!t&&(0,J.jsx)(_u,{}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.caption",defaultMessage:"Your workspace currently has <gueststablink> {guestCount, plural, one {1 guest} other {{guestCount} guests}}</gueststablink>",values:{gueststablink:e=>(0,J.jsx)(js.Z,{onClick:()=>{Ko.jk(r,{source_tab:qe.Z.state.currentTab,destination_tab:"members",destination_subtab:fu.Q.Guests}),qe.Z.setState({...qe.Z.state,currentTab:"members",defaultSubtab:fu.Q.Guests})},children:e}),guestCount:s}})})]}),(0,J.jsx)("div",{onClick:t?()=>Zu(n,i,r):()=>Pu(r),style:{marginTop:5,opacity:t?void 0:Mu},children:(0,J.jsx)(Ia.Z,{on:l.disableGuests,disabled:!t})})]}),(0,J.jsx)(Ms.Z,{size:24,style:{opacity:0}}),(0,J.jsx)(Su,{isOpen:Boolean(l.disableGuestsModalOpen),onDismiss:()=>{n.setState({...n.state,disableGuestsModalOpen:!1})},onSave:e=>{ku({disableGuests:!0,keepExistingGuests:e},n,i,r),n.setState({...n.state,disableGuestsModalOpen:!1})},guestCount:s})]})}function Du(e){let{toggleAvailableForTier:t,securitySettingsStore:s,spaceStore:n}=e;window.__c={n:"EnableGuestInviteRequestsComponent"};const i=(0,o.O7)(),r=(0,a.VK)((()=>t&&!s.state.disableGuests?()=>{}:()=>Fu({name:"enableGuestInviteRequests",isToggleEnabled:t,showUpgradeIfDisabled:!0},s,n,i)),[i,t,s,n]),l=(0,a.VK)((()=>!t||!s.state.disableGuests),[s,t]),d=(0,a.VK)((()=>(0,de.p1)()),[]),c=(0,a.VK)((()=>!t||s.state.disableGuests),[s,t]);return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.label",defaultMessage:"Allow members to request adding guests"}),t&&(0,J.jsx)(nr.Z,{style:{marginLeft:0},href:(0,Ze.UY)("guides.guestRequests"),analyticsFrom:"space_saml"}),!t&&(0,J.jsx)(_u,{style:{marginTop:0}})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.caption",defaultMessage:"{hasRequestTab, select, true {Requests must be approved by a workspace owner. You can view all requests <requeststablink>here</requeststablink>} other {Requests must be approved by a workspace owner}}",values:{hasRequestTab:d,requeststablink:e=>(0,J.jsx)(js.Z,{onClick:()=>{Ko.jk(i,{source_tab:qe.Z.state.currentTab,destination_tab:"members",destination_subtab:fu.Q.Requests}),qe.Z.setState({...qe.Z.state,currentTab:"members",defaultSubtab:fu.Q.Requests})},children:e})}})})]}),(0,J.jsx)(re.ZP,{render:e=>(0,J.jsx)("div",{onClick:r,style:{marginTop:5,opacity:t&&s.state.disableGuests?void 0:Mu},...e,children:(0,J.jsx)(Ia.Z,{on:s.state.enableGuestInviteRequests,disabled:l})}),renderTooltip:()=>(0,J.jsx)("div",{style:{},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.disabled.label",defaultMessage:"Disable inviting guests to use this feature"})}),disableTooltip:c,placement:re.ug.Top})]}),(0,J.jsx)(Ms.Z,{size:24,style:{opacity:0}})]})}function Bu(e){let{disableGuestsAvailableForTier:t,enableGuestInviteRequestAvailableForTier:s,securitySettingsStore:n,spaceStore:i}=e;window.__c={n:"GuestAndRequestSectionComponent"};const o=(0,a.VK)((()=>wt.subscriptionDataStoreInstance.state),[]),r=(0,a.VK)((()=>(0,de.p1)()),[]);if(!o)return(0,J.jsx)(Es.Z,{});const l=Mt.CM(o).filter(mu.du).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.guestsSection.title",defaultMessage:"Inviting members & guests"})}),(0,J.jsx)(Ru,{securitySettingsStore:n,spaceStore:i,toggleAvailableForTier:t,guestCount:l}),(0,J.jsx)(Du,{securitySettingsStore:n,spaceStore:i,toggleAvailableForTier:s}),(0,J.jsx)(Au,{spaceStore:i,securitySettingsStore:n,requestTogglesAvailableForTier:r})]})}function Lu(e){let{enable:t,featureUpsellButton:s,securitySettingsStore:n,spaceStore:i}=e;window.__c={n:"DisablePublicAccess"};const r=(0,o.O7)(),l=(0,a.VK)((()=>n.state.disablePublicAccess),[n]);return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?()=>async function(e,t,s){const n=e.state.disablePublicAccess;if(!n&&!(await v.confirmUserAction({message:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;ku({disablePublicAccess:!n},e,t,s)}(n,i,r):()=>Pu(r),children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!t&&s,(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."})})]}),(0,J.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Mu},children:(0,J.jsx)(Ia.Z,{on:l,disabled:!t})})]}),(0,J.jsx)(Ms.Z,{size:24,style:{opacity:0}})]})}function Ou(e){let{enable:t,featureUpsellButton:s,securitySettingsStore:n,spaceStore:i}=e;window.__c={n:"DisableSpacePageEdits"};const r=(0,o.O7)(),l=(0,a.VK)((()=>n.state.disableSpacePageEdits),[n]);return(0,a.VK)((()=>(0,Fe.bq)()),[])?null:(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>Fu({name:"disableSpacePageEdits",isToggleEnabled:t,showUpgradeIfDisabled:!0},n,i,r),children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!t&&s,(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."})})]}),(0,J.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Mu},children:(0,J.jsx)(Ia.Z,{on:l,disabled:!t})})]}),(0,J.jsx)(Ms.Z,{size:24,style:{opacity:0}})]})}function Eu(e){let{enable:t,featureUpsellButton:s,securitySettingsStore:n,spaceStore:i}=e;window.__c={n:"DisableGuests"};const r=(0,o.O7)(),{disableGuests:l,disableGuestsModalOpen:d}=(0,a.VK)((()=>n.state),[n]);return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?()=>Zu(n,i,r):()=>Pu(r),children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!t&&s,(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"Prevent anyone from inviting people outside the workspace to pages."})})]}),(0,J.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Mu},children:(0,J.jsx)(Ia.Z,{on:l,disabled:!t})})]}),(0,J.jsx)(Ms.Z,{size:24,style:{opacity:0}}),(0,J.jsx)(Su,{isOpen:Boolean(d),onDismiss:()=>{n.setState({...n.state,disableGuestsModalOpen:!1})},onSave:e=>{ku({disableGuests:!0,keepExistingGuests:e},n,i,r),n.setState({...n.state,disableGuestsModalOpen:!1})},guestCount:void 0})]})}function Nu(e){let{enable:t,spaceStore:s,securitySettingsStore:n,featureUpsellButton:i}=e;window.__c={n:"DisableMoveTo"};const r=(0,o.O7)(),l=(0,a.VK)((()=>n.state.disableMoveToSpace),[n]);return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>Fu({name:"disableMoveToSpace",isToggleEnabled:t,showUpgradeIfDisabled:!0},n,s,r),children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),!t&&i,(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."})})]}),(0,J.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Mu},children:(0,J.jsx)(Ia.Z,{on:l,disabled:!t})})]}),(0,J.jsx)(Ms.Z,{size:24,style:{opacity:0}})]})}function Vu(e){let{enable:t,securitySettingsStore:s,spaceStore:n,featureUpsellButton:i}=e;window.__c={n:"DisableExport"};const r=(0,o.O7)(),l=(0,a.VK)((()=>s.state.disableExport),[s]);return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>Fu({name:"disableExport",isToggleEnabled:t,showUpgradeIfDisabled:!0},s,n,r),children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!t&&i,(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."})})]}),(0,J.jsx)("div",{style:{marginTop:5,opacity:t?void 0:Mu},children:(0,J.jsx)(Ia.Z,{on:l,disabled:!t})})]}),(0,J.jsx)(Ms.Z,{size:24,style:{opacity:0}})]})}function Uu(e){let{enable:t,securitySettingsStore:s,spaceStore:n,featureUpsellButton:i}=e;window.__c={n:"DisablePublicAccessRequests"};(0,o.O7)(),(0,a.VK)((()=>s.state.disablePublicAccessRequests),[s]);return null}function Wu(e){let{securitySettingsStore:t,spaceStore:s}=e;window.__c={n:"SecuritySettingsComponent"};const i=(0,r.Fg)(),l=(0,o.O7)(),d=(0,a.VK)((()=>(0,de.wd)()),[]),c=(0,a.VK)((()=>(0,hu.J)({environment:l})),[l]),u=(0,a.VK)((()=>t.state),[t]),m=(0,a.VK)((()=>(0,jt.wP)()),[]),p=(0,J.jsx)(_u,{});return c?(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(et.Z,{large:!0,divider:"full",children:d?(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})}),(0,J.jsx)(Uu,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Lu,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Ou,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),!d&&(0,J.jsx)(Eu,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Nu,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Vu,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),d&&(0,J.jsx)(Bu,{securitySettingsStore:t,spaceStore:s,disableGuestsAvailableForTier:!0,enableGuestInviteRequestAvailableForTier:m}),(0,J.jsx)("div",{style:{height:36}})]}):(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(Iu,{}),(0,J.jsx)("div",{style:Tu(i),children:(0,J.jsx)("span",{style:{marginRight:8},children:d?(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,J.jsx)(h.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})})}),(0,J.jsx)(Uu,{enable:!0,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Lu,{enable:u.disablePublicAccess,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Ou,{enable:u.disableSpacePageEdits,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),!d&&(0,J.jsx)(Eu,{enable:u.disableGuests,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Nu,{enable:u.disableMoveToSpace,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),(0,J.jsx)(Vu,{enable:u.disableExport,spaceStore:s,securitySettingsStore:t,featureUpsellButton:p}),d&&(0,J.jsx)(Bu,{securitySettingsStore:t,spaceStore:s,disableGuestsAvailableForTier:u.disableGuests,enableGuestInviteRequestAvailableForTier:u.enableGuestInviteRequests}),(0,J.jsx)("div",{style:{height:32}})]})}var Ku=s(58047);function zu(e){window.__c={n:"SettingsPrompt"};const t=(0,o.O7)(),{onView:s}=e;return(0,n.useEffect)((()=>{s(t)}),[t,s]),(0,J.jsxs)("div",{children:[(0,J.jsx)(Ms.Z,{size:0}),(0,J.jsx)(Ku.N,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t))},secondaryAction:{icon:e=>(0,Bo.m)(e),text:(0,J.jsx)(h.FormattedMessage,{id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"}),onClick:e.onClickLearnMore}})]})}const qu=function(e){window.__c={n:"SidebarBox"};const t=(0,r.yK)((t=>({style:{display:"flex",height:"100%",flexDirection:e.isReversed?"row-reverse":"row"},sidebarStyle:{height:"100%",background:t.cardSidebarBackground,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"},childrenStyle:{flexGrow:1,position:"relative",zIndex:1,height:"100%"}})),[e]);return(0,J.jsxs)("div",{style:t.style,onMouseDown:e.onMouseDown,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,children:[(0,J.jsx)("div",{style:t.sidebarStyle,children:e.sidebar}),(0,J.jsx)("div",{style:t.childrenStyle,children:e.children})]})};var Gu=s(83726),Hu=s(4023);const Qu={pageViews:0,uniquePageViews:0,pagesCreated:0,pageEdits:0,topPages:[]};const Yu={activeMembersCount:0,previousActiveMembersCount:0,activeGuestsCount:0,previousActiveGuestsCount:0,topTeamspaces:[],topViewers:[],topEditors:[]};var $u=s(35238),Ju=s(42485),Xu=s(50780),em=s(55964),tm=s(28495),sm=s(73123),nm=s(35314),im=s(66661),om=s(43568),am=s(76798);function rm(e){let{title:t,items:s,loading:n,error:i}=e;window.__c={n:"AnalyticsCardList"};const o=(0,r.yK)((e=>({title:{fontWeight:g.Z.fontWeight.semibold,marginBottom:8},container:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",height:"100%",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,padding:12}})),[]);return(0,J.jsxs)("div",{style:o.container,children:[(0,J.jsx)(le.Z,{style:o.title,children:t}),n?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(dm,{}),(0,J.jsx)(dm,{}),(0,J.jsx)(dm,{}),(0,J.jsx)(dm,{}),(0,J.jsx)(dm,{})]}):i?(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(cm,{})}):s.map(((e,t)=>(0,J.jsx)(lm,{item:e},t)))]})}function lm(e){let{item:t}=e;window.__c={n:"CardListItem"};const{store:s,caption:n}=t,i=(0,h.useIntl)(),o=um(),r=(0,a.VK)((()=>{switch(s.table){case"block":return(0,J.jsxs)("div",{style:o.nameAndIconContainer,children:[(0,J.jsx)(In.Z,{icon:s.getIcon(),size:18,isEmptyPage:!1,disabled:!0}),(0,J.jsx)(am.Z,{store:s})]});case"notion_user":return(0,J.jsxs)("div",{style:o.nameAndIconContainer,children:[(0,J.jsx)(Vn.Z,{userStore:s,size:18}),(0,J.jsx)(le.Z,{children:s.getDisplayName(i)})]});case"team":const e=s.getName();return(0,J.jsxs)("div",{style:o.nameAndIconContainer,children:[(0,J.jsx)(An.p,{disabled:!0,store:s,size:20}),(0,J.jsx)(le.Z,{children:e})]});default:(0,Fs.t1)(s)}}),[s,o.nameAndIconContainer,i]);return(0,J.jsxs)("div",{style:o.container,children:[(0,J.jsx)(le.Z,{style:o.label,children:r}),(0,J.jsx)("div",{style:o.caption,children:(0,J.jsx)(le.Z,{isSecondaryColor:!0,isSmall:!0,children:n})})]})}function dm(){window.__c={n:"LoadingCardListItem"};const e=um();return(0,J.jsxs)("div",{style:e.container,children:[(0,J.jsx)(le.Z,{style:e.label,children:(0,J.jsx)(om.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})}),(0,J.jsx)("div",{style:e.loadingCaption,children:(0,J.jsx)(om.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})})]})}function cm(){window.__c={n:"ErrorCardListItem"};const e=um();return(0,J.jsx)("div",{style:e.container,children:(0,J.jsx)(le.Z,{style:e.errorLabel,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",values:{br:(0,J.jsx)("br",{})}})})})}function um(){return(0,r.yK)((e=>({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBlock:4,gap:4},nameAndIconContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"},label:{width:"100%"},caption:{display:"flex",justifyContent:"center",alignItems:"center"},loadingCaption:{display:"block",width:"50%"},errorLabel:{width:"100%",textAlign:"center",color:Ki.ZP.red}})),[])}var mm=s(97706),pm=s(67579);function gm(e){let{data:t,loading:s,error:i,daysFilter:l,setDaysFilter:d}=e;window.__c={n:"ContentEngagement"};const c=(0,o.O7)(),u=(0,r.yK)((e=>({title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,marginBlock:"9px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},overviewCard:{width:"fit-content"}})),[]),[m,p]=(0,nm.e)(),{pageViews:f,uniquePageViews:x,pageEdits:S,topPages:v}=t,b=(0,a.VK)((()=>v.map((e=>{let{pageId:t,pageViews:s}=e;return{store:new me.G(c,{id:t,table:hi.iU}),caption:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,J.jsx)(im.e,{abbreviateNumber:!1,num:s})}})}}))),[c,v]),M=(0,n.useCallback)((e=>{d(e),y.m0A(c,{filter:"content_engagement",daysFilter:e})}),[c,d]);return(0,J.jsxs)("div",{style:u.container,ref:m,children:[(0,J.jsxs)("div",{style:u.titleContainer,children:[(0,J.jsxs)(le.Z,{style:u.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.title",defaultMessage:"Content engagement"}),(0,J.jsx)(re.ZP,{placement:Hu.u.Bottom,render:e=>(0,J.jsx)(nr.Z,{...e,href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.helpInfo}),renderTooltip:()=>"all_time"!==l?(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all pages in the workspace over the {dateRange}",values:{dateRange:B.default.formatMessage(sm.xX[l])}}):(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace"})})]}),(0,J.jsx)(pm.f,{currentFilter:l,onChangeFilter:M})]}),(0,J.jsxs)(ll.rj,{gap:16,children:[(0,J.jsx)(ll.r8,{row:1,col:1,colEnd:3,children:(0,J.jsx)(mm.q,{loading:s,error:i,icon:em.N,textStyles:u.overviewCard,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.views",defaultMessage:"{pageViews} total views",values:{pageViews:(0,J.jsx)(im.e,{abbreviateNumber:p<640,num:f})}})})}),(0,J.jsx)(ll.r8,{row:2,col:1,colEnd:3,children:(0,J.jsx)(mm.q,{loading:s,error:i,icon:tm.v,textStyles:u.overviewCard,iconStyles:{height:18,width:18},title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",values:{uniquePageViews:(0,J.jsx)(im.e,{abbreviateNumber:p<640,num:x})}})})}),(0,J.jsx)(ll.r8,{row:3,col:1,colEnd:3,children:(0,J.jsx)(mm.q,{loading:s,error:i,icon:Xu.E,textStyles:u.overviewCard,iconStyles:{height:18,width:18},title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,J.jsx)(im.e,{abbreviateNumber:p<640,num:S})}})})}),(0,J.jsx)(ll.r8,{row:1,rowEnd:4,col:3,colEnd:5,children:(0,J.jsx)(rm,{loading:s,error:i,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.popularPages",defaultMessage:"Most popular pages"}),items:b})})]})]})}function hm(e){let{data:t,loading:s,error:i,daysFilter:l,setDaysFilter:d}=e;window.__c={n:"UserEngagement"};const c=(0,o.O7)(),{activeMembersCount:u,previousActiveMembersCount:m,activeGuestsCount:p,previousActiveGuestsCount:f,topTeamspaces:x,topViewers:S,topEditors:v}=t,b=(0,r.yK)((e=>({title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},summaryCard:{height:70},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16}})),[]),[M,j]=(0,nm.e)(),w=(0,n.useCallback)((e=>{y.m0A(c,{filter:"user_engagement",daysFilter:e}),d(e)}),[c,d]),C=(0,a.VK)((()=>x.map((e=>{let{teamspaceId:t,pageViews:s}=e;return{store:new me.zX(c,{id:t,table:Bn.e0}),caption:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageViews",defaultMessage:"{pageViews} views",values:{pageViews:(0,J.jsx)(im.e,{abbreviateNumber:!0,num:s})}})}})).filter((e=>e.store.canRead())).slice(0,5)),[c,x]),k=(0,a.VK)((()=>S.map((e=>{let{userId:t,pageViews:s}=e;return{store:new me.U6(c,{id:t,table:R.KJ}),caption:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,J.jsx)(im.e,{abbreviateNumber:!0,num:s})}})}})).slice(0,5)),[c,S]),T=(0,a.VK)((()=>v.map((e=>{let{userId:t,pageEdits:s}=e;return{store:new me.U6(c,{id:t,table:R.KJ}),caption:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,J.jsx)(im.e,{abbreviateNumber:!0,num:s})}})}})).slice(0,5)),[c,v]);return(0,J.jsxs)("div",{style:b.container,ref:M,children:[(0,J.jsxs)("div",{style:b.titleContainer,children:[(0,J.jsxs)(le.Z,{style:b.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.title",defaultMessage:"User engagement"}),(0,J.jsx)(re.ZP,{placement:Hu.u.Bottom,render:e=>(0,J.jsx)(nr.Z,{...e,href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:b.helpInfo}),renderTooltip:()=>"all_time"!==l?(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:B.default.formatMessage(sm.xX[l])}}):(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})]}),(0,J.jsx)(pm.f,{currentFilter:l,onChangeFilter:w})]}),(0,J.jsxs)(ll.rj,{gap:16,children:[(0,J.jsx)(ll.r8,{row:1,col:1,children:(0,J.jsx)(mm.q,{style:b.summaryCard,loading:s,error:i,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:(0,J.jsx)(im.e,{abbreviateNumber:j<640,num:u})}}),byline:void 0!==m?(0,J.jsx)(fm,{userType:"members",daysFilter:l,count:u,previousCount:m}):null})}),(0,J.jsx)(ll.r8,{row:1,col:2,children:(0,J.jsx)(mm.q,{style:b.summaryCard,loading:s,error:i,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:(0,J.jsx)(im.e,{abbreviateNumber:j<640,num:p})}}),byline:void 0!==f?(0,J.jsx)(fm,{userType:"guests",daysFilter:l,count:p,previousCount:f}):null})})]}),(0,J.jsxs)(ll.rj,{gap:16,children:[(0,J.jsx)(ll.r8,{row:1,col:1,children:(0,J.jsx)(rm,{loading:s,error:i,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeTeamspaces",defaultMessage:"Most active teamspaces"}),items:C})}),(0,J.jsx)(ll.r8,{row:1,col:2,children:(0,J.jsx)(rm,{loading:s,error:i,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeViewers",defaultMessage:"Most active viewers"}),items:k})}),(0,J.jsx)(ll.r8,{row:1,col:3,children:(0,J.jsx)(rm,{loading:s,error:i,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeEditors",defaultMessage:"Most active editors"}),items:T})})]})]})}function fm(e){let{userType:t,daysFilter:s,count:n,previousCount:i}=e;window.__c={n:"MetricsChangeMessage"};const o=0===n&&0===i?0:Math.round((n-i)/i*100);let a;a=o===1/0?function(e,t,s){if("all_time"===s)return(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"});return"guests"===e?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.guests.positive",defaultMessage:"{changeValue} more guests than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:sm.ez[s].toLocaleString()}}):(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.members.positive",defaultMessage:"{changeValue} more members than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:sm.ez[s].toLocaleString()}})}(t,n,s):function(e,t){switch(t){case"all_time":return 0===e?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"}):e>0?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.positive",defaultMessage:"{changeInPercentage}% more since the start",values:{changeInPercentage:Math.abs(e)}}):(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.negative",defaultMessage:"{changeInPercentage}% less since the start",values:{changeInPercentage:Math.abs(e)}});case"last_90_days":return 0===e?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.none",defaultMessage:"No changes in previous 90 days"}):e>0?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.positive",defaultMessage:"{changeInPercentage}% more than previous 90 days",values:{changeInPercentage:Math.abs(e)}}):(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.negative",defaultMessage:"{changeInPercentage}% less than previous 90 days",values:{changeInPercentage:Math.abs(e)}});case"last_28_days":return 0===e?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.none",defaultMessage:"No changes in previous 28 days"}):e>0?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.positive",defaultMessage:"{changeInPercentage}% more than previous 28 days",values:{changeInPercentage:Math.abs(e)}}):(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.negative",defaultMessage:"{changeInPercentage}% less than previous 28 days",values:{changeInPercentage:Math.abs(e)}});case"last_7_days":return 0===e?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.none",defaultMessage:"No changes in previous 7 days"}):e>0?(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.positive",defaultMessage:"{changeInPercentage}% more than previous 7 days",values:{changeInPercentage:Math.abs(e)}}):(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.negative",defaultMessage:"{changeInPercentage}% less than previous 7 days",values:{changeInPercentage:Math.abs(e)}});default:(0,Fs.t1)(t)}}(o,s);const l=o>0?(0,Fi.J)({height:12,width:12,fill:"currentColor"}):o<0?(0,Fi.J)({height:12,width:12,transform:"rotate(90deg)",fill:"currentColor"}):void 0,d=(0,r.yK)((e=>({text:{color:o>0?e.accentColors.green[500]:o<0?e.accentColors.red[500]:e.lightTextColor,display:"flex",alignItems:"center",gap:4}})),[o]);return(0,J.jsxs)("span",{style:d.text,children:[l,a]})}function xm(e){var t,s;let{onUserTabFilterChange:n,spaceStore:i,contentEngagement:o,userEngagement:l}=e;window.__c={n:"SpaceAnalyticsOverviewTab"};const d=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:24}})),[]),c=(0,a.VK)((()=>i.getName()),[i]);if("NotFoundError"===(null===(t=o.error)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(s=l.error)||void 0===s?void 0:s.name))return(0,J.jsx)(Ju.y,{type:"empty",spaceName:c});return(0,J.jsxs)("div",{style:d.container,children:[(0,J.jsx)(hm,{data:l.data,loading:l.loading,error:l.error,daysFilter:l.daysFilter,setDaysFilter:function(e){n({graphFilter:"all_time"===e?"last_90_days":e}),l.setDaysFilter(e)}}),(0,J.jsx)(gm,{data:o.data,loading:o.loading,error:o.error,daysFilter:o.daysFilter,setDaysFilter:o.setDaysFilter})]})}const ym={field:"num_searches",direction:"desc"},Sm=Gu.D2,vm={sort:ym,timeRange:Sm,searchAnalyticsDataList:[],numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};var bm=s(98569);const Mm=(0,h.defineMessages)({numSearches:{id:"workspaceAnalytics.searchTab.searchTable.searches.tooltip",defaultMessage:"Number of times users in the workspace have searched the query"},numUniqueUsers:{id:"workspaceAnalytics.searchTab.searchTable.uniqueSearches.tooltip",defaultMessage:"Total number of users that have searched the query"},ctr:{id:"workspaceAnalytics.searchTab.searchTable.ctr.tooltip",defaultMessage:"Percentage of times users have opened page from results of this query"}}),jm=(0,h.defineMessages)({queryText:{id:"spaceAnalyticsSearchTable.column.query",defaultMessage:"Query"},numSearches:{id:"spaceAnalyticsSearchTable.column.searches",defaultMessage:"Searches"},numUniqueUsers:{id:"spaceAnalyticsSearchTable.column.uniqueSearches",defaultMessage:"Unique searches"},ctr:{id:"spaceAnalyticsSearchTable.column.ctr",defaultMessage:"Click-through rate"}}),wm={queryText:{id:"queryText",headerTitle:B.default.formatMessage(jm.queryText),renderCell:e=>(0,J.jsx)(le.Z,{children:e.queryText}),widthData:{width:200,maxWidth:300},sortable:!1},numSearches:{id:"numSearches",headerTitle:(0,J.jsx)(bm.r,{tooltipMessageDescriptor:Mm.numSearches,columnHeader:jm.numSearches}),renderCell:e=>(0,J.jsx)(Tm,{value:e.numSearches}),widthData:{width:120,maxWidth:120},sortable:!0},numUniqueUsers:{id:"numUniqueUsers",headerTitle:(0,J.jsx)(bm.r,{tooltipMessageDescriptor:Mm.numUniqueUsers,columnHeader:jm.numUniqueUsers}),renderCell:e=>(0,J.jsx)(Tm,{value:e.numUniqueUsers}),widthData:{width:120,maxWidth:120},sortable:!0},ctr:{id:"ctr",headerTitle:(0,J.jsx)(bm.r,{tooltipMessageDescriptor:Mm.ctr,columnHeader:jm.ctr}),renderCell:e=>(0,J.jsx)(Tm,{value:Math.round(1e3*e.ctr)/1e3,isPercentage:!0}),widthData:{width:120,maxWidth:120},sortable:!0}},Cm=(0,Fs.Yd)(wm).map((e=>wm[e]));function km(e){let{searchAnalyticsDataList:t,runNewSearch:s,sort:i,setSort:o,loadNextPage:l,loading:d,error:c}=e;window.__c={n:"SpaceAnalyticsTable"};const u=(0,a.VK)((()=>t.map((e=>({id:e.queryText,isClickable:!1,...e})))),[t]),m=(0,n.useMemo)((()=>function(e){const t=sm.Fi[e.field];if(!t)return;return{column:wm[t],sortAscending:"asc"===e.direction}}(i)),[i]),p=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:Cm,theme:e,containerMarginTop:0})),[]),g=(0,r.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return c?(0,J.jsx)(zs.q,{error:c,runNewSearch:s}):(0,J.jsxs)("div",{children:[(0,J.jsx)(oe.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Cm,rows:u,sortState:m,onSortStateChanged:e=>{o(function(e){const t=sm.hx[e.column.id],s=e.sortAscending?"asc":"desc";if(!t)return{field:"num_searches",direction:s};return{field:t,direction:s}}(e))},onLoadMore:l,renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:g.emptyQuery,children:!d&&0===t.length&&(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.searchTable.table.empty",defaultMessage:"No search query analytics to display."})}),styles:p}),d?(0,J.jsx)(Es.Z,{style:g.loadingSpinner}):null]})}function Tm(e){let{value:t,isPercentage:s}=e;window.__c={n:"CenteredNumericCell"};const n=(0,r.yK)((e=>({centered:{width:"100%",textAlign:"center"}})),[]),i=s?`${t}%`:t;return(0,J.jsx)(le.Z,{style:n.centered,children:i})}function Im(e){window.__c={n:"SpaceAnalyticsSearchTab"};const{spaceStore:t}=e,s=(0,r.yK)((()=>({header:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontWeight:g.Z.fontWeight.semibold,fontSize:16,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4}})),[]),i=(0,n.useRef)(!1),{searchAnalyticsDataList:l,timeRange:d,sort:u,loading:m,error:p,loadNextPage:f,runNewSearch:x,setTimeRange:S,setSort:v}=function(e){let{spaceStore:t}=e;const s=(0,o.O7)(),[i,a]=(0,n.useState)(vm),r=(0,n.useRef)(ym),l=(0,n.useRef)(Sm),d=(0,h.useIntl)(),u=(0,n.useCallback)((async e=>{let{fetchFromFirstPage:n,ignoreSearchInputComparison:o}=e;const d=!c.Xy(i.sort,r.current)||!c.Xy(i.timeRange,l.current);if(!o&&!d)return;r.current=i.sort,l.current=i.timeRange;let u=i.loading,m=i.error,p=i.hasNextPage,g=i.paginationToken;if(n&&(a((e=>({...vm,timeRange:e.timeRange,sort:e.sort}))),u=vm.loading,m=vm.error,p=vm.hasNextPage,g=vm.paginationToken),!p||u)return;if(m)return;a((e=>({...e,loading:!0})));const h=await C.loadSearchAnalytics(s,{spaceId:t.id,sort:i.sort,timeRange:i.timeRange,startCursor:g});if("failed"===h.type)return void a((e=>({...e,loading:!1,error:h})));const f=h.data.results;a((e=>{const t=[],s=new Set(e.searchAnalyticsDataList.map((e=>e.queryText)));for(const i of f){const e=i.queryText;s.has(e)||(t.push(i),s.add(e))}const n=[...e.searchAnalyticsDataList,...t];return{...e,searchAnalyticsDataList:n,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:h.data.nextCursor,hasNextPage:Boolean(h.data.nextCursor)}}))}),[s,t,i.sort,i.timeRange,i.loading,i.error,i.hasNextPage,i.paginationToken]);(0,n.useEffect)((()=>{i.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),u({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[i.shouldReRunSearch,u]);const m=(0,n.useCallback)((async()=>{i.shouldReRunSearch||await u({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[i.shouldReRunSearch,u]),p=(0,n.useCallback)((async e=>{await u({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[u]),g=(0,n.useCallback)((e=>{"all_time"!==e&&(a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),y.yef(s,{daysFilter:e}))}),[s]),f=(0,n.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),y.$fF(s,{column:e.field,isAscending:"asc"===e.direction})}),[s]),x=(0,n.useMemo)((()=>{if(i.error)return 404===i.error.status?new F.dR({message:(0,D.wf)(d,i.error)}):new Error((0,D.wf)(d,i.error))}),[i.error,d]);return{...i,error:x,loadNextPage:m,runNewSearch:p,setTimeRange:g,setSort:f}}({spaceStore:t});(0,n.useEffect)((()=>{i.current||(x(!0),i.current=!0)}),[x]);const b=(0,a.VK)((()=>t.getName()),[t]);return"NotFoundError"===(null==p?void 0:p.name)?(0,J.jsx)(Ju.y,{type:"empty",spaceName:b}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("div",{style:s.header,children:[(0,J.jsxs)(le.Z,{style:s.sectionTitle,children:[(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.title",defaultMessage:"Search queries"}),(0,J.jsx)(re.ZP,{placement:re.ug.Bottom,render:e=>(0,J.jsx)(nr.Z,{...e,href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:s.helpInfo}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.tooltip",defaultMessage:"Displays popular search queries in the workspace from the {dateRange}",values:{dateRange:B.default.formatMessage(sm.xX[d])}})})]}),(0,J.jsx)(pm.f,{currentFilter:d,onChangeFilter:S,hideAllTime:!0})]}),(0,J.jsx)(km,{searchAnalyticsDataList:l,runNewSearch:x,sort:u,setSort:v,loadNextPage:f,loading:m,error:p})]})}var Pm=s(30251),Zm=s(8840);function Fm(e){let{data:t,loading:s,error:n,daysFilter:i,setDaysFilter:o}=e;window.__c={n:"UsersAnalyticsSummaries"};const[a,l]=(0,nm.e)(),d=(0,r.yK)((e=>({title:{fontWeight:g.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},container:{display:"flex",flexDirection:"column",gap:16},helpInfo:{marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},summaryCard:{height:70},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{activeMembersCount:c,previousActiveMembersCount:u,activeGuestsCount:m,previousActiveGuestsCount:p}=t;return(0,J.jsxs)("div",{style:d.container,ref:a,children:[(0,J.jsxs)("div",{style:d.titleContainer,children:[(0,J.jsxs)(le.Z,{style:d.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.title",defaultMessage:"User engagement"}),(0,J.jsx)(re.ZP,{placement:Hu.u.Bottom,render:e=>(0,J.jsx)(nr.Z,{...e,href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:d.helpInfo}),renderTooltip:()=>"all_time"!==i?(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:B.default.formatMessage(sm.xX[i])}}):(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})]}),(0,J.jsx)(pm.f,{currentFilter:i,onChangeFilter:o})]}),(0,J.jsxs)(ll.rj,{gap:16,children:[(0,J.jsx)(ll.r8,{row:1,col:1,children:(0,J.jsx)(mm.q,{style:d.summaryCard,loading:s,error:n,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:(0,J.jsx)(im.e,{abbreviateNumber:l<640,num:c})}}),byline:void 0!==u?(0,J.jsx)(fm,{userType:"members",daysFilter:i,count:c,previousCount:u}):null})}),(0,J.jsx)(ll.r8,{row:1,col:2,children:(0,J.jsx)(mm.q,{style:d.summaryCard,loading:s,error:n,title:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:(0,J.jsx)(im.e,{abbreviateNumber:l<640,num:m})}}),byline:void 0!==p?(0,J.jsx)(fm,{userType:"guests",daysFilter:i,count:m,previousCount:p}):null})})]})]})}var _m=s(44643),Am=s(88775);const Rm=(0,h.defineMessages)({page_views:{id:"workspaceAnalytics.usersTab.usersTable.pageViews.tooltip",defaultMessage:"Total number of page views for the user across all pages in the workspace"},page_edits:{id:"workspaceAnalytics.usersTab.usersTable.pageEdits.tooltip",defaultMessage:"Total number of page edits for the user across all pages in the workspace"}}),Dm=(0,h.defineMessages)({user:{id:"spaceAnalyticsUsersTab.column.user",defaultMessage:"User"},page_views:{id:"spaceAnalyticsUsersTab.column.pageViews",defaultMessage:"Page views"},page_edits:{id:"spaceAnalyticsUsersTab.column.pageEdits",defaultMessage:"Page edits"},last_active:{id:"spaceAnalyticsUsersTab.column.lastActive",defaultMessage:"Last active"},teams:{id:"spaceAnalyticsUsersTab.column.teams",defaultMessage:"Teamspaces"}}),Bm={user:{id:"user",renderCell:function(e){window.__c={n:"UserCell"};const t=(0,r.yK)((e=>({container:{height:52}})),[]);return(0,J.jsx)(ue.Z,{containerStyle:t.container,actorStore:e.userStore,spaceRole:e.role&&(0,ue.K)(e.role)})},headerTitle:B.default.formatMessage(Dm.user),widthData:{width:100},sortable:!1},page_views:{id:"page_views",renderCell:function(e){window.__c={n:"PageViewsCell"};const{page_views:t}=e,s=(0,r.yK)((e=>({eyeHideIcon:{width:20,height:20,color:e.lightIconColor},cell:{marginLeft:10}})),[]);if(void 0===t)return(0,J.jsx)(re.ZP,{placement:re.ug.Bottom,render:e=>(0,J.jsx)("div",{...e,children:(0,_m.L)(s.eyeHideIcon)}),renderTooltip:e=>(0,J.jsx)(h.FormattedMessage,{id:"spaceAnalyticsUsersTab.optedOutUser.icon.tooltip",defaultMessage:"User has disabled page view tracking"})});return(0,J.jsx)(le.Z,{children:t})},headerTitle:(0,J.jsx)(bm.r,{tooltipMessageDescriptor:Rm.page_views,columnHeader:Dm.page_views}),widthData:{width:80},sortable:!0},page_edits:{id:"page_edits",renderCell:function(e){const{page_edits:t}=e;return(0,J.jsx)(le.Z,{children:t})},headerTitle:(0,J.jsx)(bm.r,{tooltipMessageDescriptor:Rm.page_edits,columnHeader:Dm.page_edits}),widthData:{width:80},sortable:!0},last_active:{id:"last_active",renderCell:function(e){const t=e.last_active;let s;s=t?(0,J.jsx)(Ns.T,{dateTs:t}):(0,J.jsx)(le.Z,{isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userTable.lastActiveTimestamp.noLastActive",defaultMessage:"No activity"})});return(0,J.jsx)("div",{children:s})},headerTitle:B.default.formatMessage(Dm.last_active),widthData:{width:50},sortable:!0},teams:{id:"teams",renderCell:function(e){const{userStore:t,role:s}=e;if(!s)return(0,J.jsx)(le.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.teamsColumn.guest",defaultMessage:"None"})});return(0,J.jsx)(Am.ZP,{member:{userId:t.id,role:s}})},headerTitle:B.default.formatMessage(Dm.teams),widthData:{width:50},sortable:!1}};const Lm=(0,Fs.Yd)(Bm).map((e=>Bm[e]));function Om(e){window.__c={n:"UsersTable"};const t=(0,o.O7)(),[s,i]=(0,n.useState)(25),{usersAndStats:l,filter:d,onUserTabFilterChange:c,usersAndStatsError:u}=e,m=(0,a.VK)((()=>{const{currentSpaceStore:e}=_e.default.state,t=(null==e?void 0:e.getPermissionItems().filter(_n.jg))||[],s={};for(const n of t)s[n.user_id]=n.role;return s}),[]),[p,g]=(0,n.useState)({column:Bm.last_active,sortAscending:!1}),f=(0,n.useCallback)((e=>{y.gEE(t,{column:e.column.id,isAscending:e.sortAscending}),g(e)}),[g,t]),x=l.map((e=>{let{userStore:t,stats:s}=e;return{id:s.userId,userStore:t,isClickable:!1,last_active:s.lastActive,page_views:s.numPageViews,page_edits:s.numPageEdits,role:m[s.userId]}})).sort(function(e){switch(e.column.id){case"last_active":return(t,s)=>(0,sm.Zj)(t.last_active,s.last_active,e.sortAscending);case"page_views":return(t,s)=>(0,sm.yM)(t.page_views,s.page_views,e.sortAscending);case"page_edits":return(t,s)=>e.sortAscending?t.page_edits-s.page_edits:s.page_edits-t.page_edits;default:return(e,t)=>0}}(p)),S=(0,n.useMemo)((()=>x.slice(0,s)),[x,s]),v=(0,r.yK)((e=>({error:{color:Ki.ZP.red},dateFilterPill:{display:"flex",marginTop:10,marginBottom:15,flexFlow:"row",alignItems:"center"},timeFilterDescription:{marginRight:5}})),[]);const b=(0,n.useCallback)((e=>{y.IwD(t,{daysFilter:e}),c({tableFilter:e})}),[t,c]),M=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:Lm,theme:e,containerMarginTop:0})),[]);return(0,J.jsxs)(J.Fragment,{children:[u&&(0,J.jsx)(le.Z,{isMultiline:!1,style:v.error,children:u}),(0,J.jsxs)("div",{style:v.dateFilterPill,children:[(0,J.jsx)(le.Z,{isSecondaryColor:!0,style:v.timeFilterDescription,children:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.timeFilter.description",defaultMessage:"Views and edits from"})}),(0,J.jsx)(pm.f,{currentFilter:d,onChangeFilter:b})]}),(0,J.jsx)(oe.D,{allowHorizontalScroll:!0,hideHeaderRowPadding:!0,setStickyHeaderRow:!0,maxHeight:500,sortState:p,onSortStateChanged:f,columnRenderInfo:Lm,rows:S,renderNoRowsComponent:()=>(0,J.jsx)("div",{children:"N/A"}),styles:M,onLoadMore:function(){s<l.length&&i(s+25)}})]})}function Em(e){var t,s;let{spaceStore:i,usersTabData:l,onUserTabFilterChange:d,userEngagement:c}=e;window.__c={n:"SpaceAnalyticsUsersTab"};const[u,m]=(0,nm.e)(),p=(0,r.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},sectionTitle:{fontWeight:g.Z.fontWeight.medium,fontSize:16},sectionTitleLeft:{marginBlock:"8px 4px",marginBottom:5,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-around"},numUsersCaption:{display:"flex"},overviewText:{textAlign:"center"},error:{color:Ki.ZP.red},tableHeader:{marginTop:20,flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"end"},tooltip:{marginLeft:3},infoIcon:{height:14,width:14,color:e.mediumTextColor}})),[]),f=(0,o.O7)(),x=(0,h.useIntl)(),S=(0,n.useCallback)((e=>{y.KCu(f,{daysFilter:e});d({graphFilter:"all_time"===e?"last_90_days":e}),c.setDaysFilter(e)}),[d,c,f]),v=(0,a.VK)((()=>i.getName()),[i]);if("NotFoundError"===(null==l||null===(t=l.usersAndStatsError)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(s=c.error)||void 0===s?void 0:s.name))return(0,J.jsx)(Ju.y,{type:"empty",spaceName:v});const b=Math.floor(m-8);return(0,J.jsxs)("div",{style:p.container,children:[(0,J.jsx)(Fm,{data:c.data,loading:c.loading,error:c.error,daysFilter:c.daysFilter,setDaysFilter:S}),(0,J.jsx)(Nm,{children:(0,J.jsx)("div",{ref:u,children:l?(0,J.jsx)(Vm,{width:b,dailyUsersData:l.dailyUsersData,userEngagementDaysFilter:c.daysFilter,daysFilter:l.graphFilter,dailyUsersError:l.dailyUsersError&&Gu.Uk(l.dailyUsersError,x)}):(0,J.jsx)(Um,{})})}),(0,J.jsxs)("div",{style:p.tableHeader,children:[(0,J.jsxs)("div",{style:p.sectionTitleLeft,children:[(0,J.jsx)(le.Z,{style:p.sectionTitle,children:(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.allUsers.title",defaultMessage:"All members in Notion"})}),(0,J.jsx)(re.ZP,{placement:Hu.u.Bottom,render:e=>(0,J.jsx)(nr.Z,{...e,href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:p.helpInfo}),renderTooltip:()=>l&&"all_time"!==l.tableFilter?(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.lastDays",defaultMessage:"Per member workspace activity over the {dateRange}",values:{dateRange:B.default.formatMessage(sm.xX[l.tableFilter])}}):(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.allTime",defaultMessage:"All time per member workspace activity"})})]}),(0,J.jsx)(Zm.f,{analyticsType:Ee.x.Users})]}),l?(0,J.jsx)(Om,{filter:l.tableFilter,usersAndStats:l.usersAndStats,onUserTabFilterChange:d,usersAndStatsError:l.usersAndStatsError&&Gu.Uk(l.usersAndStatsError,x)}):null]})}function Nm(e){window.__c={n:"DisplayBox"};const t=(0,r.yK)((e=>({border:{borderRadius:4,overflow:"hidden",border:`1px solid ${e.regularDividerColor}`,backgroundColor:e.contentBackground,color:e.regularTextColor,padding:20}})),[]);return(0,J.jsx)("div",{style:t.border,children:e.children})}function Vm(e){window.__c={n:"UsersOverTimeGraph"};const{width:t,dailyUsersData:s,userEngagementDaysFilter:n,daysFilter:i,dailyUsersError:o}=e,l=(0,r.yK)((e=>({graphHeader:{marginBottom:10,display:"flex",justifyContent:"space-between"},graphTitle:{fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:"bolder",display:"flex",alignItems:"center",height:24},graphCaption:{fontSize:g.Z.fontSize.UISmall.desktop},graphTooltip:{marginLeft:5,width:14,height:14},helpInfo:{marginLeft:4},emptyGraphBody:{textAlign:"center",paddingTop:50,paddingBottom:50},error:{color:Ki.ZP.red},graphSubLabel:{paddingTop:4,color:"grey"}})),[]),{blueLayer:d}=(0,Pm.useTimeSeriesPalette)(),c=(0,a.VK)((()=>{if(0===s.length)return;return{startDate:s[0].ds,endDate:s[s.length-1].ds}}),[s]),u=(0,a.VK)((()=>s.map((e=>({ds:e.ds,values:{active_members:e.active_members||0}})))),[s]);let m;return m=!c||s.length<3?(0,J.jsx)("div",{style:l.emptyGraphBody,children:(0,J.jsx)(le.Z,{isSecondaryColor:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.emptyGraph",defaultMessage:"Not enough data to display graph"})})}):(0,J.jsx)(L.LazyTimeSeries,{startDate:c.startDate,endDate:c.endDate,width:t,data:u,height:300,layers:[{key:"active_members",...d,renderLabel:e=>(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers",defaultMessage:"{activeMembers, plural, one {1 active member} other {{activeMembers} active members}}",values:{activeMembers:e}})}],renderTooltipSubLabel:()=>(0,J.jsx)("div",{style:l.graphSubLabel,children:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers.sublabel",defaultMessage:"Viewed a page in the {dateRange}",values:{dateRange:B.default.formatMessage(sm.xX[i])}})})}),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:l.graphHeader,children:(0,J.jsxs)(le.Z,{style:l.graphTitle,children:[(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.membersOverTime.title",defaultMessage:"Active members over time"}),"all_time"===n&&(0,J.jsx)(re.ZP,{placement:Hu.u.Bottom,render:e=>(0,J.jsx)(nr.Z,{...e,href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:l.helpInfo}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.membersOverTime.allTimeTooltip",defaultMessage:"All Time selection shows members who have viewed a page in the last 90 days."})})]})}),o&&(0,J.jsx)(le.Z,{isMultiline:!1,style:l.error,children:o}),m]})}function Um(){return(0,J.jsxs)("div",{children:[(0,J.jsx)(om.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]}),(0,J.jsx)(om.Z,{paragraphs:[{lineHeight:300,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:12}]})]})}const Wm={[Ee.x.Overview]:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[Ee.x.Users]:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[Ee.x.Content]:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[Ee.x.Search]:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"})};function Km(e){const{currentTab:t,spaceAnalyticsStore:s,onUserTabFilterChange:n,spaceStore:i}=e;switch(t){case Ee.x.Content:return(0,J.jsx)($u.Z,{spaceStore:i,contentEngagement:e.contentEngagementData});case Ee.x.Users:return(0,J.jsx)(Em,{spaceStore:i,usersTabData:s.usersTabData,onUserTabFilterChange:n,userEngagement:e.userEngagementData});case Ee.x.Overview:return(0,J.jsx)(xm,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:i,onUserTabFilterChange:n});case Ee.x.Search:return(0,J.jsx)(Im,{spaceStore:i});default:(0,Fs.t1)(t)}}const zm=function(e){let{spaceStore:t}=e;window.__c={n:"SpaceAnalytics"};const s=(0,r.yK)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:g.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),i=(0,o.O7)(),l=(0,a.VK)((()=>{var e;return null===(e=_e.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),d=function(e){let{spaceId:t}=e;const s=(0,o.O7)(),[i,a]=(0,n.useState)("last_90_days"),[{status:r,value:l,error:d}]=(0,Tt.r5)((async()=>{const e=await C.getContentEngagementAnalytics(s,{spaceId:t,daysFilter:i});switch(e.type){case"success":return{pageViews:e.data.pageViews,uniquePageViews:e.data.uniquePageViews,pagesCreated:e.data.pagesCreated,pageEdits:e.data.pageEdits,topPages:e.data.topPages};case"failed":throw e.body;default:(0,Fs.t1)(e)}}),[s,t,i]);return{data:(0,n.useMemo)((()=>l||Qu),[l]),loading:"pending"===r||"idle"===r,error:d,daysFilter:i,setDaysFilter:a}}({spaceId:t.id}),c=function(e){let{spaceStore:t,userId:s}=e;const i=(0,o.O7)(),[a,r]=(0,n.useState)("last_90_days"),[{status:l,value:d,error:c}]=(0,Tt.r5)((async()=>{if(!s||!(0,Ri.wv)({permissions:t.getPermissionItems()},s))return Yu;const e=await C.getUserEngagementAnalytics(i,{spaceId:t.id,daysFilter:a});switch(e.type){case"success":return{activeMembersCount:e.data.activeMembersCount,previousActiveMembersCount:e.data.previousActiveMembersCount,activeGuestsCount:e.data.activeGuestsCount,previousActiveGuestsCount:e.data.previousActiveGuestsCount,topTeamspaces:e.data.topTeamspaces,topViewers:e.data.topViewers,topEditors:e.data.topEditors};case"failed":throw e.body;default:(0,Fs.t1)(e)}}),[i,t,s,a]);return{data:(0,n.useMemo)((()=>d||Yu),[d]),loading:"pending"===l||"idle"===l,error:c,daysFilter:a,setDaysFilter:r}}({spaceStore:t,userId:l}),[u,m]=(0,a.AF)(Ee.Z),p=(0,a.VK)((()=>Boolean(null==t?void 0:t.getSettings().disable_page_analytics)),[t]),f=(0,a.VK)((()=>null==t?void 0:t.getName()),[t]),x=(0,n.useCallback)((async e=>{await Gu.Pr({environment:i,spaceStore:t,spaceAnalyticsStore:u,setState:m,graphFilter:e.graphFilter,tableFilter:e.tableFilter})}),[i,t,u,m]),S=(0,n.useCallback)((e=>{y.nKJ(i,{tab:e}),m({...u,currentTab:e})}),[m,u,i]),v=(0,a.VK)((()=>{const e=[];return function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(Ee.x.Overview),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(Ee.x.Users),e.push(Ee.x.Content),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(Ee.x.Search),e}),[t]),b=(0,a.VK)((()=>v.length>1),[v]),j=u.currentTab||v[0];(0,n.useEffect)((()=>{!async function(){const e=t.id;e&&Ee.Z.shouldRefreshState(e)&&(j===Ee.x.Users?await x({graphFilter:"last_90_days",tableFilter:"last_90_days"}):j===Ee.x.Content||j===Ee.x.Overview||j===Ee.x.Search||(0,Fs.t1)(j))}()}));const w=(0,n.useCallback)((()=>{M.D({environment:i,url:(0,Ze.UY)("guides.workspaceAnalytics")})}),[i]),k=(0,a.VK)((()=>t.getCreatedTime()<16593264e5),[t]),T=v.map((e=>Wm[e])),I=p?(0,J.jsx)(Ju.y,{type:"disabled",spaceName:f}):(0,J.jsxs)(J.Fragment,{children:[b&&(0,J.jsx)(po.Z,{tabs:T,selectedIndex:v.indexOf(j),onChange:e=>{S(v[e])},style:s.tabsStyle}),Km({currentTab:j,spaceAnalyticsStore:u,onUserTabFilterChange:x,spaceStore:t,contentEngagementData:d,userEngagementData:c})]});return(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsxs)(et.Z,{large:!0,style:s.headingStyle,children:[(0,J.jsxs)("div",{style:s.title,children:[(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),k&&(0,J.jsx)(re.ZP,{placement:Hu.u.Right,render:e=>(0,J.jsx)(nr.Z,{...e,href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:s.helpInfo}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from August 1, 2022 onwards"})})]}),(0,J.jsx)(ws.Z,{isSmall:!0,onClick:w,icon:Bo.m,children:(0,J.jsx)(h.FormattedMessage,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"})})]}),(0,Xe.Um)(),I]})};var qm=s(86080);var Gm=s(77472),Hm=s(33293),Qm=s(49),Ym=s(25976);const $m=function(e){let{handleExportClick:t}=e;window.__c={n:"ExportSpaceTab"};const s=(0,a.VK)((()=>_e.default.state),[]),{currentSpaceStore:i}=s,r=(0,a.VK)((()=>Ym.Z.state),[]),l=(0,o.O7)();return(0,n.useEffect)((()=>{Bs.zh({environment:l,spaceId:null==i?void 0:i.id})}),[null==i?void 0:i.id,l]),(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})}),(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,J.jsx)(ws.Z,{disabled:!!r.count,isLarge:!0,onClick:t,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"})}),r.count?(0,J.jsxs)(yd.gq,{gap:4,children:[(0,J.jsx)(Es.Z,{}),(0,J.jsx)(le.Z,{isSmall:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportInProgress",defaultMessage:"Export in progress"})})]}):(0,J.jsx)(J.Fragment,{})]}),(0,J.jsx)("div",{style:{height:12}}),(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,Ze.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),(0,Xe.Um)()]})};var Jm=s(44071),Xm=s(12457);const ep=(0,h.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettingsDomain.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain"},copyDomainTooltip:{id:"spaceBasicSettingsDomain.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}}),tp=(e,t)=>{const s=t=>(0,J.jsx)(re.ZP,{delayThreshold:0,renderTooltip:()=>B.default.formatMessage(ep.copyDomainTooltip),render:s=>(0,J.jsx)(js.Z,{onClick:()=>{ie.RD({environment:e,stringValue:t,copiedMessage:ie.tq.copiedLinkToClipboard})},...s,children:t})});return(0,J.jsxs)("div",{style:{paddingTop:8},children:[(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:s(`${t}.${Hi.default.publicDomainName}`)}}),(0,J.jsx)("div",{style:{paddingTop:6}}),(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:s(`${window.location.host}/${t}`)}})]})},sp=()=>{window.__c={n:"AvailableField"};const e=(0,r.Fg)();return(0,J.jsxs)("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,Cd.r)({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),(0,J.jsx)("span",{children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Available",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})})]})},np=()=>(0,J.jsxs)("div",{style:{color:Ki.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,fr.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,J.jsx)("span",{children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Used",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"})})]}),ip=()=>(0,J.jsxs)("div",{style:{color:Ki.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,fr.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,J.jsx)("span",{children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Not allowed",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"})})]}),op=()=>(0,J.jsx)(Xm.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,J.jsx)(Es.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),ap=e=>{window.__c={n:"SpaceBasicSettingsDomain"};const[t,s]=(0,a.AF)(e.spaceBasicSettingsStore),{domain:i,domainState:l}=t,d=(0,o.O7)(),c=(0,r.Fg)(),[u,m]=(0,n.useState)(!0),p=n.createRef();return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})}),(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,J.jsx)("div",{style:{background:c.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"},children:(0,J.jsx)(no.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:p,value:i,placeholder:B.default.formatMessage(ep.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{m(!1),e.target.select()}})}),u&&e.domainIsAutogenerated&&(0,J.jsx)("div",{style:{color:Ki.ZP.blue,fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=p.current)||void 0===e||e.focusInput(),m(!1),s({...t,domain:""})},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own"})}),i&&"available"===l&&(0,J.jsx)(sp,{}),"inuse"===l&&(0,J.jsx)(np,{}),"disallowed"===l&&(0,J.jsx)(ip,{}),"loading"===l&&op()]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:tp(d,i)})]})};var rp=s(35840);const lp=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageInputMenu"};const t=(0,h.useIntl)(),s=(0,r.Fg)(),n=(0,o.O7)(),i=(0,a.VK)((()=>(0,Mt.M9)(n)),[n]),l=!Boolean(i),[d,c]=(0,a.AF)(Oe);return(0,J.jsx)("div",{onClick:()=>{i&&Wi.y(n,{from:"public_domain_home_page",for:i})},children:(0,J.jsx)(no.Z,{type:"text",ref:e.textInputRef,style:{background:s.inputBackground,borderRadius:4,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:d.query,onChange:e=>{c({...d,query:e.target.value})},onFocus:()=>{l&&c({...d,openDropdown:!0})},disabled:!l,left:(0,rp.R)({fill:s.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})})})};var dp=s(3096),cp=s(11470);const up=()=>(0,J.jsx)(Xm.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,J.jsx)(Es.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),mp=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSearchResults"};const t=(0,o.O7)(),[s,n]=(0,a.AF)(e.spaceBasicSettingsStore,Ve),[i,r]=(0,a.AF)(Oe),{query:l}=i,[{value:d,status:c}]=(0,Tt.r5)((()=>dp.a2(l,t)),[l,t]),u=(0,a.VK)((()=>(0,ke.RM)()),[]);if(!(l||d&&0!==d.length))return null;return(0,J.jsx)("div",{style:{marginTop:2,marginBottom:2},children:(0,J.jsx)(en.Z,{type:en.i.Vertical,sections:[{key:"recent public pages section",render:e=>(0,J.jsx)(sn.Z,{...e}),items:"idle"===c||"pending"===c?[{key:"loading spinner",render:up,action:()=>{}}]:u&&d&&0!==d.length?[...d.map((e=>{const t=me.G.createChildStore(u,{table:hi.iU,id:e.id});return{key:`${e.id} page`,render:e=>(0,J.jsx)(cp.Z,{store:t,...e}),action:()=>{n({...s,publicHomePage:e.id}),r({...i,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginLeft:8},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})}),action:()=>{}}]}],initialFocus:void 0})})},pp=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSummary"};const[t,s]=(0,a.AF)(e.spaceBasicSettingsStore,Ve),[n,i]=(0,a.AF)(Oe),[o,r]=(0,a.VK)((()=>{const e=(0,ke.RM)();if(!e||!t.publicHomePage)return[];const s=me.G.createChildStore(e,{table:hi.iU,id:t.publicHomePage});return[s,s.getIcon()]}),[t]);return o?(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,J.jsxs)("div",{style:{display:"flex",paddingRight:8,alignItems:"center"},children:[r&&(0,J.jsx)(In.Z,{icon:r,isEmptyPage:!1,size:18,disabled:!0,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),(0,J.jsx)(am.Z,{store:o,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(r)?3:0,wordBreak:"break-word"}})]}),(0,J.jsx)(ws.Z,{onClick:()=>{i({...n,displaySummary:!1}),s({...t,publicHomePage:void 0})},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"})})]}):null},gp=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePage"};const t=(0,o.O7)(),s=n.createRef(),[i,r]=(0,a.AF)(Oe),[l]=(0,a.AF)(e.spaceBasicSettingsStore),{openDropdown:d,displaySummary:c}=i,{publicHomePage:u,domain:m}=l,p=`${m}.${Hi.default.publicDomainName}`,g=(0,a.VK)((()=>(0,Mt.M9)(t)),[t]),f=!Boolean(g);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(et.Z,{style:{display:"flex",alignItems:"center"},children:[(0,J.jsx)("span",{style:{marginRight:8},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})}),g&&(0,J.jsx)(Ha.Z,{subscriptionTier:g,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})]}),f&&u&&c?(0,J.jsx)(pp,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):(0,J.jsx)(tn.ZP,{alignmentToOrigin:tn.ZP.Alignment.Start,keepFocus:t.device.isPhone,onDismiss:()=>{var e;null===(e=s.current)||void 0===e||e.handleBlur(),r({...i,openDropdown:!1,displaySummary:!0})},origin:(0,J.jsx)(lp,{textInputRef:s}),open:d,popupType:tn.ZP.PopupType.Popup,style:{width:250},render:()=>(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,width:250,children:(0,J.jsx)(mp,{spaceBasicSettingsStore:e.spaceBasicSettingsStore})})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:(0,J.jsx)(re.ZP,{delayThreshold:0,renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>(0,J.jsx)(js.Z,{onClick:()=>{ie.RD({environment:t,stringValue:p,copiedMessage:ie.tq.copiedLinkToClipboard})},...e,children:p})})}})})]})};var hp=s(719);function fp(){return(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple."})}const xp=(0,h.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"},turnOffAiWhenSubscribedToAiWarning:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAiWarning",defaultMessage:"Your current plan includes Notion AI. You can turn off access to AI, but you will continue to be billed for it."},turnOffAiWhenSubscribedToAccept:{id:"spaceBasicSettings.aiFeature.turnOffAiWhenSubscribedToAccept",defaultMessage:"Turn off AI"}});class yp extends i.Z{constructor(){super(...arguments),this.storeTypes={spaceBasicSettingsStore:Ve,securitySettingsStore:Be.Z,store:ds.Z,tokenQuery:N.default.createClass("")},this.handleSpaceNameChange=e=>{this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,name:e.target.value})},this.handleCheckDomainAvailability=e=>{const{spaceBasicSettingsStore:t}=this.stores,{spaceStore:s}=this.props;j._u({environment:this.environment,spaceStore:s,domain:e}).then((e=>{if("success"!==e.type)this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:"loading"});else{const s=e.data.domain===t.state.domain;this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:s?e.data.domainState:t.state.domainState})}}))},this.checkSpaceDomainAvailabilityDebounced=c.Ds(this.handleCheckDomainAvailability,250),this.handleSpaceUrlChange=e=>{const t=(0,Pi.$U)(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()},this.handleConfirm=async()=>{const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t,securitySettingsStore:s}=this.stores;await j.Y5({environment:this.environment,spaceId:e.id,domain:t.state.domain})&&(await j.OF({environment:this.environment,spaceStore:e,spaceBasicSettingsStore:t,securitySettingsStore:s}),Oe.setState(Oe.getInitialState()),qe.Z.setState({...qe.Z.state,open:!1}))},this.renderChurnSurveyModal=()=>{const e=wt.subscriptionDataStoreInstance.state,t=this.stores.store.state,s=Mt.XX(e);if(s&&t.churnSurveyModalOpen)return(0,J.jsx)(Qm.Z,{churnType:t.churnType,currentPlan:t.churnType,isWorkspaceDeletion:!0,periodEnd:s.periodEnd,hasAI:m.de(s.addOns),hasPendingChanges:Boolean(s.schedule||s.willCancelAt),customerId:s.customerId,onAccept:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onAccept()},onClose:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}})},this.handleDeleteClick=async()=>{const e=(0,jt.zt)();if(!e)return;const t=wt.subscriptionDataStoreInstance.state,s=Mt.XX(t);if(y.YO0(this.environment),s){if(!(await new Promise((t=>{const{store:s}=this.stores;s.setState({...s.state,churnType:e,churnSurveyModalOpen:!0,onAccept:async()=>{t(!0),await wp(this.props.spaceStore,this.props.intl,this.environment)},onClose:()=>t(!1)})}))))return}await wp(this.props.spaceStore,this.props.intl,this.environment)}}UNSAFE_willMount(e){super.UNSAFE_willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,n=s.getValueForSpace(t);n&&s.setState(n)}renderComponent(){return zt.Z.state.online?this.renderSettings():(0,J.jsx)(vp,{})}validateDomain(){const{spaceBasicSettingsStore:e}=this.stores,{domain:t,domainState:s}=e.state;return!!t&&("available"===s||"current-space"===s)}renderSettings(){const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores,{name:s}=t.state,i=wt.subscriptionDataStoreInstance.state,{device:o}=this.environment;if(!i)return;const a=e.canAdmin(),r=(0,Pi.Cx)(e),l=(0,Pi.jv)(e),d=Mt.qF(this.environment),c=a&&!e.getDisableExport(),u=a,m=(0,jt.zt)(),p="subscribed_admin"===i.type&&("enterprise"===m||"business"===m),g=e.getSettings().disable_page_analytics,f=za.Z.getPublicSpaceData(this.environment,e.id),x=!((0,de.T2)()&&(0,de.$d)());return(0,J.jsxs)(Xe.ZP,{controlRow:a&&this.renderControlRow(),children:[a&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(jp,{}),(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})}),(0,J.jsx)(no.Z,{value:s,placeholder:B.default.formatMessage(xp.nameInputPlaceholder),readOnly:!a,onChange:this.handleSpaceNameChange}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,J.jsx)(fp,{})}),(0,Xe.Um)(),(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})}),(0,J.jsx)("div",{style:{width:72,height:72,border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,J.jsx)(In.Z,{bucket:"public",disabled:!1,icon:(0,Pi.Wd)(this.environment,e),isEmptyPage:!1,title:s,size:64,iconLoggingData:{recordTable:e.table,source:"workspace_settings"},onChange:e=>function(e,t,s){I.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:s,perform:s=>{Bi.sO({store:t.getIconStore(),value:e,transaction:s})}})}(e,this.props.spaceStore,this.environment)})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})}),(0,Xe.Um)()]}),(y=this.environment,!(null===(S=_e.default.state.currentSpaceStore)||void 0===S||!S.canAdmin())&&(0,Mt.qb)(y,"enterprise")&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Mp,{}),(0,J.jsx)(kp,{securitySettingsStore:this.props.securitySettingsStore,spaceStore:this.props.spaceStore}),(0,Xe.Um)()]})),(0,J.jsx)(bp,{}),r&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages."})}),(0,Xe.Um)()]}),x&&a&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ap,{canAdminSpaceStore:a,domainIsAutogenerated:null==f?void 0:f.domainIsAutogenerated,spaceStore:e,spaceBasicSettingsStore:t,handleSpaceUrlChange:this.handleSpaceUrlChange}),(0,Xe.Um)()]}),a&&d&&(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})}),this.renderAllowedEmailDomains(),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})}),(0,Xe.Um)()]}),x&&a&&(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(gp,{spaceBasicSettingsStore:t}),(0,Xe.Um)()]}),c&&(0,J.jsx)($m,{handleExportClick:()=>function(e){const{currentSpaceStore:t}=_e.default.state;t&&Bs.q$({environment:e,root:{table:"space",id:t.id,spaceId:t.id},isCollectionViewExportTypeSupported:!0})}(this.environment)}),u&&(0,J.jsxs)(n.Fragment,{children:[(0,J.jsxs)(et.Z,{style:{display:"flex",alignItems:"center"},children:[(0,J.jsx)("span",{style:{marginRight:8},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})}),!p&&(0,J.jsx)(Ha.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})]}),(0,J.jsx)("div",{style:{display:"flex"},children:(0,J.jsx)(ws.Z,{isLarge:!0,disabled:!p,onClick:()=>function(e,t){const{currentSpaceStore:s}=_e.default.state,n=wt.subscriptionDataStoreInstance.state;s&&n&&"subscribed_admin"===n.type&&Bs.$G(t,{spaceStore:s,subscriptionData:n,intl:e})}(this.props.intl,this.environment),disabledFeedback:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"})})}),(0,J.jsx)("div",{style:{height:12}}),(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,Ze.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),(0,Xe.Um)()]}),a&&(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics"})}),(0,J.jsxs)("div",{style:{display:"flex",gap:12,flexDirection:"column"},children:[(0,J.jsx)(mo.Z,{isMobile:o.isMobile,title:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",values:{workspaceName:s}}),type:"toggle",isOn:!g,onToggle:()=>{const t=!g;I.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:this.environment,perform:s=>{Bi.sW({store:e,data:{settings:{...e.getSettings(),disable_page_analytics:t}},transaction:s})}}),Gm.j(this.environment,t?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}}),(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption"}),href:(0,Ze.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})]}),(0,Xe.Um)()]}),(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})}),(0,J.jsxs)("div",{style:{display:"flex"},children:[(l.length>1||r)&&(0,J.jsx)(ws.Z,{isLarge:!0,onClick:()=>function(e,t){const{currentUserSettingsStore:s}=_e.default.state;s&&v.showDialog({message:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await j.bf({environment:t,spaceId:e.id,userSettingsStore:s})&&(Ko.z0(t),qe.Z.setState({...qe.Z.state,open:!1}))}}]})}(this.props.spaceStore,this.environment),style:{marginRight:a?12:void 0},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})}),a&&(0,J.jsxs)(J.Fragment,{children:[this.renderModal(),(0,J.jsx)(ws.Z,{isLarge:!0,isRed:!0,onClick:this.handleDeleteClick,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})})]})]}),a&&(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)("div",{style:{height:12}}),(0,J.jsx)(nr.Z,{title:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,Ze.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})]})]});var y,S}renderControlRow(){return(0,J.jsxs)("div",{style:{display:"flex"},children:[(0,J.jsx)(Ws.Z,{isLarge:!0,onClick:this.handleConfirm,disabled:!this.validateDomain(),children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})}),(0,J.jsx)(ws.Z,{isLarge:!0,style:{marginLeft:12},onClick:Cp,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})})]})}renderAllowedEmailDomains(){const{device:e}=this.environment,{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,{emailDomains:n}=s.state,i=t.canAdmin();return(0,J.jsx)(tn.ZP,{popupType:e.isMobile?tn.ZP.PopupType.SlideUp:tn.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:this.stores.tokenQuery.state.length>0,origin:(0,J.jsx)(hp.Z,{placeholder:B.default.formatMessage(xp.allowedEmailDomainsInputPlaceholder),value:this.stores.tokenQuery.state,onChange:e=>this.stores.tokenQuery.setState(e.target.value),readOnly:!i,onRemoveLastToken:()=>{const e=n.slice(0,n.length-1);s.setState({...s.state,emailDomains:e})},tokens:n.map((e=>(0,J.jsx)(oc.Z,{showRemoveButton:!0,isSingle:!1,format:td.lo.Medium,onClickRemove:()=>{const t=n.filter((t=>t!==e));s.setState({...s.state,emailDomains:t})},value:e},e)))}),render:()=>{const t=this.stores.tokenQuery.state.trim(),i=wt.subscriptionDataStoreInstance.state,{spaceStore:o}=this.props,a=(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),r=(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),l=i?Mt.hn(i).map((e=>{if(("unsubscribed_admin"===i.type||"unsubscribed_member"===i.type||"subscribed_admin"===i.type)&&i.joinedMemberIds.includes(e.userId)){const t=me.U6.createChildStore(o,{table:R.KJ,id:e.userId}).getEmail();return t&&(0,Dl.Gd)(t)}})).filter(((e,t,s)=>Boolean(e&&t===s.indexOf(e)&&!n.includes(e)))):[],d=(0,qc.ZP)(t,l,(e=>e)).map(((e,t)=>({key:t,render:t=>(0,J.jsx)($s.Z,{...t,title:e}),action:()=>{const t=[...n,e];s.setState({...s.state,emailDomains:t}),this.stores.tokenQuery.setState("")}})));let c;return c=e.isMobile?{menuType:Hs.og.ActionSheet}:{menuType:Hs.og.Popup,width:"100%"},(0,J.jsx)(Xs.Z,{...c,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:d.length>0?0:void 0,sections:[{key:0,render:e=>(0,J.jsx)(sn.Z,{...e,disableDesktopPadding:!0,title:d.length>0?a:r}),items:d}]})})},onDismiss:()=>{this.stores.tokenQuery.setState("")}})}renderModal(){const{churnSurveyModalOpen:e}=this.stores.store.state;return(0,J.jsx)(Hm.q,{isOpen:e,dismissUsing:"onlyEscape",onDismiss:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()},children:this.renderChurnSurveyModal()})}}yp.displayName="SpaceBasicSettings";const Sp=(0,h.injectIntl)(yp);function vp(){return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})})})}function bp(){return(0,J.jsx)(et.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings"})})}function Mp(){return(0,J.jsx)(et.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings"})})}function jp(){return(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"})})}async function wp(e,t,s){const{currentUserSettingsStore:n}=_e.default.state;if(!n)return;const i=(0,Pi.rn)(s,e)||t.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),o=(0,mc.Bd)(hr.SP)?(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Jm.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})});await qm.b({message:(0,J.jsx)("div",{children:(0,J.jsx)("div",{children:o})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:i})&&(j.Ns({environment:s,spaceId:e.id,userSettingsStore:n}),Ko.BP(s),qe.Z.setState({...qe.Z.state,open:!1}))}function Cp(){qe.Z.setState({...qe.Z.state,open:!1}),Oe.setState(Oe.getInitialState())}function kp(e){let{securitySettingsStore:t,spaceStore:s}=e;window.__c={n:"AiFeatureComponent"};const n=(0,a.VK)((()=>(0,Pi.CV)(s)),[s]),i=(0,a.VK)((()=>!n&&Boolean(null==t?void 0:t.state.enableAiFeature)),[n,t]);return(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(re.ZP,{placement:re.ug.Bottom,alignment:re.v2.Start,textWrap:!0,style:{maxWidth:240},disableTooltip:!n,renderTooltip:()=>n?(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.aiFeature.hipaaTooltip",defaultMessage:"Notion AI is not currently available for HIPAA compliant workspaces."}):void 0,render:e=>(0,J.jsx)("div",{children:(0,J.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",cursor:n?"not-allowed":"pointer"},onClick:()=>{!async function(e,t){var s;const n=(null===(s=wt.subscriptionDataStoreInstance.state)||void 0===s?void 0:s.addOns)??[],i=m.de(n),o=!t.state.enableAiFeature;if(!o&&i&&!(await v.confirmUserActionV2({message:B.default.formatMessage(xp.turnOffAiWhenSubscribedToAiWarning),acceptLabel:B.default.formatMessage(xp.turnOffAiWhenSubscribedToAccept)})).accept)return;t&&!e&&t.setState({...t.state,enableAiFeature:o})}(n,t)},children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,St.t)({width:16,height:16,marginRight:6}),(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI"})]}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",values:{br:(0,J.jsx)("br",{}),inlinelink:e=>(0,J.jsx)(js.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,J.jsx)("div",{style:{marginTop:5},children:(0,J.jsx)(Ia.Z,{on:i,disabled:n})})]})})})})}var Tp=s(44625),Ip=s(97832),Pp=s(90403),Zp=s(78873);let Fp=function(e){return e.Password="Password",e.CurrentEmail="TemporaryPasscode",e}({});class _p extends N.default{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const Ap=_p;var Rp=s(83785);const Dp={modal:{width:460,padding:32,borderRadius:4,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:Ki.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:g.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14,width:"100%"},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14},claimedEmailDomainWarning:{marginTop:14,marginBottom:14}},Bp=(0,h.defineMessages)({dialogLabel:{id:"profileSettings.accountSecuritySection.emailSetting.dialogLabel",defaultMessage:"Change email"}});class Lp extends i.Z{constructor(){super(...arguments),this.storeTypes={store:Ap},this.renderModalContent=()=>{const{store:e}=this.stores,{state:t}=e;return(0,J.jsx)("div",{style:{...Dp.modal,...Vp(this.theme).modal},children:(0,J.jsx)(Rp.Z,{fetch:this.getAuthorizationType,loading:e=>e&&(0,J.jsx)("div",{style:Dp.loadingSpinner,children:(0,J.jsx)(Es.Z,{})}),render:()=>(0,J.jsxs)(n.Fragment,{children:[t.authorizationType===Fp.Password?this.renderVerifyPassword(t):t.authorizationType===Fp.CurrentEmail?this.renderVerifyCurrentEmail(t):void 0,t.authorized&&this.renderSetNewEmail(t)]})})})},this.renderSetNewEmail=e=>{const{store:t}=this.stores,{userValue:s}=this.props;if(t.state.authorized)return(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)("p",{style:Dp.paragraph,children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})}),(0,J.jsx)("div",{children:this.renderNewEmailInput()}),t.state.newEmailContainsVerifiedDomain&&(0,Dl.Gd)(t.state.newEmail)!==(0,Dl.Gd)((null==s?void 0:s.email)||"")&&(0,J.jsx)(Np,{state:e}),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):this.renderSendNewEmailPasscodeButton(e),(0,J.jsx)(Up,{hasEducationPlan:this.props.hasEducationPlan})]})},this.handleSendCurrentEmailVerification=async()=>{const{userValue:e}=this.props,{store:t}=this.stores;if(!e)return;t.setState({...t.state,loading:!0});const s=await C.sendEmailVerification(this.environment,{email:e.email});"success"===s.type?t.setState({...t.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0,loading:!1}):t.setState({...t.state,currentEmailPasscodeSent:!0,loading:!1,error:(0,D.wf)(this.props.intl,s)})},this.handleChangeCurrentEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})},this.handleChangePassword=e=>{const{store:t}=this.stores;t.setState({open:!0,authorized:!1,authorizationType:Fp.Password,password:e.currentTarget.value,error:void 0})},this.handleClearPassword=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:Fp.Password,password:""})},this.handleSubmitAuthorization=async()=>{const{store:e}=this.stores;if(!e.state.authorized)if(e.state.authorizationType===Fp.Password){if(!this.getUserCurrentEmail())return;e.setState({...e.state,loading:!0});const t=await C.authVerifyPassword(this.environment,{password:e.state.password});if("failed"===t.type)return void e.setState({...e.state,loading:!1,error:(0,D.wf)(this.props.intl,t)});e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}else e.state.authorizationType===Fp.CurrentEmail&&e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})},this.handleChangeNewEmail=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})},this.handleClearNewEmail=()=>{const{store:e}=this.stores;e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0})},this.handleSendNewEmailVerification=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=(0,Dl.Gd)(e.state.newEmail);e.setState({...e.state,loading:!0});const[s,n]=await Promise.all([await C.sendEmailVerification(this.environment,{email:e.state.newEmail}),t?await C.getVerifiedEmailDomain(this.environment,{emailDomain:t}):void 0]);if("success"===s.type){const t=(0,Fs.$K)(n)&&"failed"===n.type?(0,D.wf)(this.props.intl,n):void 0;e.setState({...e.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:t,loading:!1,newEmailContainsVerifiedDomain:(0,Fs.$K)(n)&&"success"===n.type&&void 0!==n.data.id})}else e.setState({...e.state,loading:!1,error:(0,D.wf)(this.props.intl,s)})},this.handleChangeNewEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})},this.handleSubmit=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=e.state.authorizationType===Fp.Password?{type:"Password",password:e.state.password,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:e.state.currentEmailPasscode,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode};e.setState({...e.state,loading:!0});const s=await C.changeEmail(this.environment,t);if("success"===s.type)y.txh(this.environment,{new_email:e.state.newEmail,error:void 0}),e.setState({...e.state,loading:!1}),await this.closeModal();else{var n;const t=(0,D.wf)(this.props.intl,s);if(y.txh(this.environment,{new_email:e.state.newEmail,error:t}),"IntercomError"===(null===(n=s.body)||void 0===n?void 0:n.name))return e.setState({...e.state,loading:!1}),void(await this.closeModal());e.setState({...e.state,loading:!1,error:t})}},this.openModal=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:void 0})},this.closeModal=async()=>{const{store:e}=this.stores,{hasEducationPlan:t}=this.props;e.reset(),t&&await Qe.bi(this.environment)},this.getAuthorizationType=async()=>{const{store:e}=this.stores,{intl:t}=this.props,s=this.getUserCurrentEmail();if(!s)return;const n=await Zp.c({environment:this.environment,userEmail:s});n.error?e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:s})}):n.value.isSamlEnforced||!n.value.hasPassword?e.setState({open:!0,authorized:!1,authorizationType:Fp.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):e.setState({open:!0,authorized:!1,authorizationType:Fp.Password,password:""})}}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(mo.Z,{type:"custom",isMobile:!1,title:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.label",defaultMessage:"Email"}),caption:e&&e.email,customButton:this.renderChangeEmailButton()}),(0,J.jsx)(wo.Z,{ariaLabel:B.default.formatMessage(Bp.dialogLabel),open:t.state.open,onDismiss:this.closeModal,render:this.renderModalContent})]})}renderChangeEmailButton(){const{userValue:e,areProfileEditsDisabled:t}=this.props,s=(0,J.jsx)(ws.Z,{isLarge:!0,onClick:t?()=>{}:this.openModal,disabled:t,disabledFeedback:t,children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"})});return t?(0,J.jsx)(re.ZP,{renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:e?(0,Dl.Gd)(e.email):""}}),placement:re.ug.Bottom,alignment:re.v2.Center,render:e=>(0,J.jsx)("div",{...e,children:s})}):s}renderVerifyPassword(e){const{userValue:t}=this.props;if(t)return(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)("p",{style:{margin:0},children:(0,J.jsx)(Ep,{userValue:this.props.userValue})}),(0,J.jsx)("p",{style:Dp.paragraph,children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})}),(0,J.jsx)(no.Z,{style:{display:"none"},type:"text",value:t.email,autoComplete:"username",disabled:!0}),(0,J.jsx)(no.Z,{type:"password",disabled:e.authorized,value:e.password,onChange:this.handleChangePassword,showClearButton:!0,onClearButtonClick:this.handleClearPassword,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:Dp.input,focusInitial:!0,autoComplete:"current-password"}),!e.authorized&&e.error&&(0,J.jsx)("div",{style:Dp.error,children:e.error}),!e.authorized&&(0,J.jsx)(Ws.Z,{isLarge:!0,style:Dp.button,onClick:this.handleSubmitAuthorization,disabled:e.loading,children:e.loading?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}renderVerifyCurrentEmail(e){return(0,J.jsxs)(n.Fragment,{children:[(0,J.jsxs)("p",{style:{...Dp.paragraph,marginTop:0},children:[(0,J.jsx)(Ep,{userValue:this.props.userValue})," ",e.currentEmailPasscodeSent?(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})]}),e.currentEmailPasscodeSent?this.renderCurrentEmailPasscodeInput(e):this.renderSendCurrentEmailPasscodeButton()]})}renderSendCurrentEmailPasscodeButton(){return(0,J.jsx)(Ws.Z,{isLarge:!0,onClick:this.handleSendCurrentEmailVerification,disabled:this.stores.store.state.loading,children:this.stores.store.state.loading?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code"})})}renderCurrentEmailPasscodeInput(e){return(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)(no.Z,{value:e.currentEmailPasscode,onChange:this.handleChangeCurrentEmailPasscode,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:Dp.input}),!e.authorized&&(0,J.jsx)(Ws.Z,{isLarge:!0,style:Dp.button,onClick:this.handleSubmitAuthorization,disabled:e.loading,children:e.loading?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}renderNewEmailInput(){const{store:e}=this.stores;if(e.state.authorized)return(0,J.jsx)(no.Z,{value:e.state.newEmail,onChange:this.handleChangeNewEmail,onSubmit:this.handleSendNewEmailVerification,showClearButton:!0,onClearButtonClick:this.handleClearNewEmail,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:Dp.input,focusInitial:!0})}renderSendNewEmailPasscodeButton(e){return(0,J.jsxs)(n.Fragment,{children:[e.error&&(0,J.jsx)("div",{style:Dp.error,children:e.error}),(0,J.jsx)(Ws.Z,{isLarge:!0,style:Dp.button,onClick:this.handleSendNewEmailVerification,disabled:e.loading,children:e.loading?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})})]})}renderNewEmailPasscodeInput(e){const t=this.getSubmitHandler();return(0,J.jsxs)(n.Fragment,{children:[(0,J.jsx)("p",{style:Dp.paragraph,children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:(0,J.jsx)("span",{style:Dp.bold,children:e.newEmail})}})}),(0,J.jsx)(no.Z,{value:e.newEmailPasscode,onChange:this.handleChangeNewEmailPasscode,onSubmit:t,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:Dp.input}),e.error&&(0,J.jsx)("div",{style:Dp.error,children:e.error}),(0,J.jsx)(Ws.Z,{isLarge:!0,style:Dp.button,onClick:t,disabled:e.loading,children:e.loading?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})})]})}getUserCurrentEmail(){const{store:e}=this.stores,{userValue:t,intl:s}=this.props;if(t)return t.email;e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:s.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}getSubmitHandler(){const{store:e}=this.stores,{userValue:t}=this.props;if(!e.state.authorized)return()=>{};if(e.state.newEmailContainsVerifiedDomain&&(0,Dl.Gd)(e.state.newEmail)!==(0,Dl.Gd)((null==t?void 0:t.email)||"")){const t=e.state.newEmail;return async()=>{await function(e){return v.confirmUserAction({message:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.title",defaultMessage:"Are you sure you want to change your email?"}),description:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.description",defaultMessage:"If you continue changing this email address to this domain, any workspaces created by this account can be managed by the organization.",values:{verifiedDomain:(0,Dl.Gd)(e)}}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.acceptButton.label",defaultMessage:"Change email"}),cancelLabel:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.cancelButton.label",defaultMessage:"Go back"})})}(t)&&await this.handleSubmit()}}return this.handleSubmit}}Lp.displayName="EmailChangeSettings";const Op=(0,h.injectIntl)(Lp);function Ep(e){let{userValue:t}=e;return t?(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:(0,J.jsx)("span",{style:Dp.bold,children:t&&t.email})}}):null}function Np(e){let{state:t}=e;return(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:Dp.claimedEmailDomainWarning,children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.changeEmailModal.claimedEmailDomainWarning",defaultMessage:"The email domain {newEmailDomain} has been claimed by an organization. If you continue with changing this email address, any workspaces created by this account can be managed by the organization. See <domainclaimlink>this page</domainclaimlink> for more info.",values:{newEmailDomain:(0,Dl.Gd)(t.newEmail)??t.newEmail,domainclaimlink:e=>(0,J.jsx)(js.Z,{href:(0,Ze.UY)("guides.domainManagement"),external:!0,children:e})}})})}function Vp(e){return{modal:{background:e.contentBackground},educationPlanWarning:{color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`}}}function Up(e){let{hasEducationPlan:t}=e;window.__c={n:"EducationPlanDowngradeWarningComponent"};const s=(0,r.Fg)(),n=(0,o.O7)();return t?(0,J.jsxs)("div",{style:{...Dp.educationPlanWarning,...Vp(s).educationPlanWarning},children:[(0,Bo.m)({width:14,marginTop:4,marginRight:6,fill:s.lightIconColor})," ",(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:e=>(0,J.jsx)(js.Z,{onClick:()=>function(e){wr.j({environment:e,from:"change_email_student"})}(n),children:e})}})})]}):null}var Wp=s(10020);class Kp extends N.default{getInitialState(){return{open:!1}}}const zp=new Kp;const qp=function(){window.__c={n:"ManageActiveSessions"};const e=(0,o.O7)(),{iconStyle:t}=(0,r.yK)((e=>({iconStyle:{width:20,height:20,fill:e.lightIconColor}})),[]),s=(0,J.jsx)(h.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"}),n=(0,J.jsx)(h.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"Log out of all other active sessions on other devices besides this one."});return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(mo.Z,{type:"custom",isMobile:!1,title:s,caption:n,customButton:(0,J.jsx)(ae.Z,{style:{borderRadius:"0.25em"},onClick:async()=>{y.AQD(e),await C.logoutActiveSessions(e,{}),zp.setState({...zp.state,open:!0})},children:(0,Wp.C)(t)})}),(0,J.jsx)(Hp,{})]})};function Gp(){zp.setState({...zp.state,open:!1})}function Hp(){window.__c={n:"ManageActiveSessionsModal"};const e=(0,a.VK)((()=>zp.state.open),[]),t=(0,a.VK)((()=>function(){let e;const{currentUserStore:t}=_e.default.state;return t&&(e=t.getEmail()),e}()),[]);return(0,J.jsx)(wo.Z,{open:e,onDismiss:Gp,innerStyle:{width:350,padding:24,display:"flex",flexDirection:"column"},render:()=>(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:{marginBottom:24},children:t?(0,J.jsx)(h.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:t}}):(0,J.jsx)(h.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})}),(0,J.jsx)(Ws.Z,{onClick:Gp,children:(0,J.jsx)(h.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})})]})})}var Qp=s(1799),Yp=s(16010);class $p extends N.default{getInitialState(){return{step:"backupCodesUninitialized"}}}class Jp extends Yp.o{constructor(e,t){super(e,"backupCodes"),this.service=void 0,this.service=t}backupCodesInitialSetup(e){if(!this.checkStep("backupCodesUninitialized"))return;const{onLoadingComplete:t,onComplete:s}=e;this.store.setState({step:"backupCodesLoading"}),this.doCreateBackupCodes({forceRecreate:!1,onComplete:s,onLoadingComplete:t}).catch(this.handleUnexpectedError)}backupCodesShowCreate(){this.checkStep("backupCodesUninitialized")&&this.store.setState({step:"backupCodesRegenerateCodes"})}backupCodesRegenerateCodes(){this.checkStep("backupCodesRegenerateCodes")&&(this.store.setState({step:"backupCodesRegenerateCodes",isLoading:!0}),this.doCreateBackupCodes({forceRecreate:!0,onComplete:()=>{},onLoadingComplete:()=>{}}).catch(this.handleUnexpectedError))}exit(){this.store.setState({step:"backupCodesUninitialized"})}async doCreateBackupCodes(e){const{forceRecreate:t,onComplete:s,onLoadingComplete:n}=e,i=await this.withStep(["backupCodesLoading","backupCodesRegenerateCodes"],(()=>this.service.createBackupCodes(t)));if(!i)return;const{result:o}=i;if("already-exists"===o.status)s();else{const e=function(e){const t=B.default.getIntl(),s=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.title",defaultMessage:"Notion Backup Codes"}),n=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.createdAt",defaultMessage:"Created at {createdAt}"},{createdAt:`${new Date}`}),i=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.warningMessage",defaultMessage:"Please store these in a secure location and mark off codes as they are used."}),o=`${s}\n${n}\n\n${e.map(Qp.K).join("\n")}\n\n${i}\n`;return encodeURIComponent(o)}(o.backupCodes);this.store.setState({step:"backupCodesShowCodes",backupCodes:o.backupCodes,mfaSettingId:o.mfaSettingId,backupCodesFile:e}),n()}}}var Xp=s(75752),eg=s(88175);function tg(e){let{errorMessage:t,isLoading:s,onDisplayBackupCodes:n,onCancel:i,onDismiss:o}=e;const a=(0,J.jsx)(h.FormattedMessage,{id:"mfa.regenerateBackupCodes.title",defaultMessage:"Regenerate backup codes"}),r=(0,J.jsx)(h.FormattedMessage,{id:"mfa.regenerateBackupCodes.message",defaultMessage:"Backup codes are used to log in if you lose access to your password and second factors. <boldtext>Your existing codes won't work after regenerating new ones.</boldtext>",values:{boldtext:e=>(0,J.jsx)("span",{style:{fontWeight:g.Z.fontWeight.semibold},children:e})}}),l={text:s?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"mfa.regenerateBackupCodes.regenerateBackupCodes.button.message",defaultMessage:"Generate new backup codes"}),onClick:n,view:"outline",disabled:s,isRed:!0},d=[{text:(0,J.jsx)(h.FormattedMessage,{id:"mfa.regenerateBackupCodes.cancel.button.message",defaultMessage:"Cancel"}),onClick:i,view:"outline",type:"button"}];return(0,J.jsx)(eg.Z,{title:a,header:r,errorMessage:t,primaryAction:l,secondaryActions:d,onDismiss:o})}var sg=s(457);function ng(e){let{backupCodes:t,backupCodeDownload:s,backupCodeFileName:n,errorMessage:i,onNoted:o,onDownload:a}=e;const r=(0,J.jsx)(h.FormattedMessage,{id:"mfa.showBackupCodes.title",defaultMessage:"Save your backup codes"}),l=(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(h.FormattedMessage,{id:"mfa.showBackupCodes.message",defaultMessage:"<boldtext>You can only see this once</boldtext>, so be sure to keep them to avoid getting locked out of your account.",values:{boldtext:e=>(0,J.jsx)("span",{style:{fontWeight:g.Z.fontWeight.semibold},children:e})}})}),d={text:(0,J.jsx)(h.FormattedMessage,{id:"mfa.showBackupCodes.codesNotedDown.button.message",defaultMessage:"I've saved them"}),onClick:o},c=[{text:(0,J.jsx)(h.FormattedMessage,{id:"mfa.showBackupCodes.downloadAsTextFile.button.message",defaultMessage:"Download as text file"}),href:`data:text/plain;charset=UTF-8,${s}`,saveAs:n,view:"outline",type:"link",onClick:a}];return(0,J.jsx)(eg.Z,{title:r,header:l,errorMessage:i,primaryAction:d,secondaryActions:c,children:(0,J.jsx)(sg.Z,{type:"unencryptedCodes",backupCodes:t})})}function ig(e){const{backupCodesStateMachine:t,onGoToSettings:s,onDismiss:n}=e,i=t.useCurrentStep(),o=()=>t.backupCodesRegenerateCodes();switch(i.step){case"backupCodesUninitialized":case"backupCodesLoading":return null;case"backupCodesRegenerateCodes":return(0,J.jsx)(tg,{isLoading:i.isLoading,errorMessage:i.error,onDisplayBackupCodes:o,onDismiss:n,onCancel:s});case"backupCodesShowCodes":return(0,J.jsx)(ng,{errorMessage:i.error,backupCodes:i.backupCodes,backupCodeDownload:i.backupCodesFile,backupCodeFileName:"Notion Backup Codes.txt",onNoted:s});default:return(0,Fs.t1)(i)}}var og=s(88606),ag=s(3338);function rg(e){let{type:t,errorMessage:s,onDismiss:n,onAddMethod:i}=e;window.__c={n:"MFAPromptSetupComplete"};const o=(0,r.yK)(lg,[]),a=(0,J.jsx)(h.FormattedMessage,{id:"mfa.setupComplete.confirmation.header",defaultMessage:"Every time you enter your password, Notion will ask you for a verification code to confirm your identity."}),l=[{text:(0,J.jsx)(h.FormattedMessage,{id:"mfa.setupComplete.confirmation.viewTwoStepMethods.button.message",defaultMessage:"View 2-step methods"}),onClick:i,type:"button",view:"outline"}];return(0,J.jsx)(eg.Z,{title:"totp"===t?(0,J.jsx)(h.FormattedMessage,{id:"mfa.totp.setupComplete.confirmation.title",defaultMessage:"2-step verification with authenticator is turned on"}):"sms"===t?(0,J.jsx)(h.FormattedMessage,{id:"mfa.sms.setupComplete.confirmation.title",defaultMessage:"2-step verification with phone number is turned on"}):(0,Fs.t1)(t),header:a,errorMessage:s,icon:(0,ag.p)(o.confirmationIcon),secondaryActions:l,onDismiss:n})}function lg(e){return(0,r.EM)({confirmationIcon:{width:30,fill:"green"}})}s(30541);var dg=s(4387);const cg={name:"United States",countryCode:"1",regionCode:"US"};function ug(e){let{isLoading:t,phoneNumber:s,country:i,errorMessage:o,onDismiss:l,onBack:d,onContinue:c}=e;window.__c={n:"MFAPromptSMSAddPhone"};const u=(0,r.yK)(mg,[]),m=(0,h.useIntl)(),[p,g]=(0,n.useState)(s??""),[f,x]=(0,n.useState)([]),[y,S]=(0,n.useState)(""),[v,b]=(0,n.useState)(i??cg),M=(0,a.qz)(void 0,fn.Z),j=(0,n.useMemo)((()=>(0,dg.PG)(v.regionCode)),[v.regionCode]),C=(0,n.useCallback)((e=>{const t=e.target.value.replace(/\D/g,"");g(j.reset(t))}),[j]);(0,n.useEffect)((()=>{g(i!==v?j.reset(p??""):j.reset(s??""));const e=new Intl.DisplayNames(["en"],{type:"region"}),t=(0,dg.wJ)();let n=-1;const o=t.map(((t,s)=>{const i=(0,dg.t7)(t).toString(),o=e.of(t);return t===v.regionCode&&(n=s),{name:o??t,countryCode:i,regionCode:t}}));-1!==n&&o.unshift(o.splice(n,1)[0]),x(o)}),[v]);const k=(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneTitle",defaultMessage:"Add a phone number"}),T=(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneHeader",defaultMessage:"Enter your phone number to receive a 2-step verification code."}),I={text:t?(0,J.jsx)(Es.Z,{}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.sms.continueButton",defaultMessage:"Continue"}),onClick:()=>c(v,p.trim()),disabled:t||""===p},P=[{text:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneNeedHelp",defaultMessage:"Need help?"}),href:(0,Ze.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}],Z=m.formatMessage({id:"profileSettings.mfa.sms.phoneNumberInput.placeholder",defaultMessage:"Enter phone number"}),F=m.formatMessage({defaultMessage:"Search country code",id:"profileSettings.mfa.sms.countryCodeSelect.placeholder"}),_=e=>(0,J.jsxs)("div",{style:u.countryCodeSelectTitle,children:[e.name,(0,J.jsx)(le.Z,{isSmall:!0,children:`+${e.countryCode}`})]}),A=(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,placementToOrigin:pc.Iw.Bottom,alignmentToOrigin:pc.lU.Start,buttonPopupStore:M,renderOrigin:e=>(0,J.jsx)(ws.Z,{...e,children:`+${v.countryCode}`}),render:e=>(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,minWidth:280,maxHeight:"30vh",header:(0,J.jsx)(sn.Z,{isInput:!0,children:(0,J.jsx)(Zc.ZP,{value:y,onChange:e=>S(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:F})}),children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:0,sections:[{key:"countries",render:e=>(0,J.jsx)(sn.Z,{...e}),items:(0,qc.ZP)(y,f,(e=>/\d/.test(y)?`${e.countryCode}`:e.name)).map((t=>({key:t.regionCode,render:e=>(0,J.jsx)($s.Z,{...e,title:_(t),right:t.name===v.name?(0,Ol.k)(u.selectedCountryCodeIcon):void 0}),action:()=>{S(""),b(t),e.close()}})))}]})})});return(0,J.jsx)(eg.Z,{onDismiss:l,onBack:d,title:k,header:T,errorMessage:o,primaryAction:I,secondaryActions:P,children:(0,J.jsxs)("div",{style:u.container,children:[(0,J.jsx)("div",{style:u.countryCodeDropdownMenu,children:A}),(0,J.jsx)(no.Z,{autoFocus:!0,value:p,placeholder:Z,spellCheck:!1,style:u.phoneNumberInput,onChange:C,disabled:t,customElementAttributes:w.pf})]})})}function mg(e){return(0,r.EM)({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:4},countryCodeDropdownMenu:{marginRight:5},selectedCountryCodeIcon:{width:15,height:15},countryCodeSelectTitle:{paddingTop:8,paddingBottom:8},phoneNumberInput:{background:"light"===e.mode?Ki.ZP.transparent:e.inputBackground}})}var pg=s(56839);function gg(e){const{smsStateMachine:t,onGoToSettings:s,onDismiss:n,onStartBackupCodes:i}=e,o=t.useCurrentStep();switch(o.step){case"smsUninitialized":return null;case"smsSendingSMS":case"smsSetPhoneNumber":return(0,J.jsx)(ug,{phoneNumber:o.phoneNumber,country:o.country,isLoading:"smsSendingSMS"===o.step,errorMessage:o.error,onDismiss:n,onBack:s,onContinue:(e,s)=>t.smsCreateSMS(e,s)});case"smsVerifyCode":case"smsResendSMS":case"smsBackupCodesLoading":case"smsVerifying":return(0,J.jsx)(pg.ZP,{isLoading:"smsVerifying"===o.step||"smsBackupCodesLoading"===o.step,errorMessage:o.error,phoneNumber:`+${o.country.countryCode} ${o.phoneNumber}`,onDismiss:n,onBack:()=>t.smsRestart(),onVerifyCode:e=>t.smsVerifyCode({code:e,onVerified:i}),resentStatus:"smsResendSMS"===o.step?"resending":"resentAt"in o&&void 0!==o.resentAt?"resent":"not-resent",resentAt:"resentAt"in o&&o.resentAt?o.resentAt:0,onResendLink:()=>t.smsResendSMS()});case"smsVerified":return null;case"smsComplete":return(0,J.jsx)(rg,{type:"sms",errorMessage:o.error,onAddMethod:s,onDismiss:n});default:return(0,Fs.t1)(o)}}function hg(e){window.__c={n:"MFAAuthenticatorNameInput"};const{placeholder:t,value:s,maxlength:n,style:i,onChange:o}=e,a=(0,r.yK)((e=>(0,r.EM)({input:{background:Ki.ZP.transparent,color:e.darkTextColor,...i}})),[i]);return(0,J.jsx)(no.Z,{value:s,placeholder:t,maxlength:n,style:a.input,inputStyle:g.Z.textOverflowStyle,autoFocus:!0,spellCheck:!1,onChange:o,autoComplete:"off",customElementAttributes:w.pf})}function fg(e){let{isLoading:t,qrCode:s,friendlyName:i,errorMessage:o,onDismiss:a,onBack:l,onCantScanCode:d,onContinue:c}=e;window.__c={n:"MFAPromptTOTPScanQRCode"};const u=(0,r.yK)(xg,[]),m=(0,h.useIntl)(),[p,g]=(0,n.useState)(i??""),f=(0,n.useCallback)((e=>{g(e.target.value)}),[g]),x=(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeTitle",defaultMessage:"Scan code in authenticator app"}),y=(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeHeader",defaultMessage:"Generate a verification code with an authenticator app, then enter a name to remember it by."}),S={text:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>c(p),disabled:!s||t||0===p.length},v=[{text:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.cantScanCodeButton",defaultMessage:"Can't scan code?"}),onClick:d,type:"button",view:"plain",disabled:t}],b=m.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput.placeholder",defaultMessage:"Enter authenticator name"});return(0,J.jsx)(eg.Z,{onDismiss:a,onBack:l,title:x,header:y,errorMessage:o,primaryAction:S,secondaryActions:v,children:(0,J.jsxs)("div",{style:u.body,children:[(0,J.jsx)("div",{style:u.qrCodeContainer,children:s?(0,J.jsx)("img",{style:u.qrCode,src:s}):(0,J.jsx)(Es.Z,{})}),(0,J.jsx)(hg,{placeholder:b,value:p,maxlength:30,onChange:f})]})})}function xg(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},qrCodeContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:116,height:116,marginBottom:15},qrCode:{width:"100%"}})}function yg(e){let{textCode:t,friendlyName:s,errorMessage:i,isLoading:o,onDismiss:a,onBack:l,onUseQrCode:d,onContinue:c}=e;window.__c={n:"MFAPromptTOTPTypeTextCode"};const u=(0,r.yK)(Sg,[]),[m,p]=(0,n.useState)(s??""),g=(0,h.useIntl)(),f=(0,n.useCallback)((e=>{p(e.target.value)}),[p]),x=(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.typeTextCodeTitle",defaultMessage:"Type code from authenticator app"}),y=(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.typeText.message",defaultMessage:"Input this setup key in your authenticator app, then enter a name to remember it by.",values:{authenticatorlink:e=>(0,J.jsx)(js.Z,{external:!0,href:(0,Ze.UY)("guides.mfa"),children:e})}}),S={text:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>c(m),disabled:o||0===m.length},v=[{text:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeButton",defaultMessage:"Scan QR code"}),onClick:d,type:"button",view:"plain",disabled:o}],b=g.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput",defaultMessage:"Enter authenticator name"});return(0,J.jsx)(eg.Z,{onDismiss:a,onBack:l,title:x,header:y,errorMessage:i,primaryAction:S,secondaryActions:v,children:(0,J.jsxs)("div",{style:u.body,children:[(0,J.jsx)("div",{style:u.content,children:(0,J.jsx)("div",{style:u.textCode,children:t})}),(0,J.jsx)(hg,{placeholder:b,value:m,maxlength:30,onChange:f})]})})}function Sg(e){return(0,r.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},textCode:{fontWeight:g.Z.fontWeight.medium,fontSize:g.Z.fontSize.UIRegular.desktop,color:e.darkTextColor,textAlign:"center",verticalAlign:"middle"},content:{display:"flex",flexDirection:"column",justifyContent:"center",height:50,marginBottom:15}})}var vg=s(18469);function bg(e){const{totpStateMachine:t,onGoToSettings:s,onStartBackupCodes:n,onDismiss:i}=e,o=t.useCurrentStep();switch(o.step){case"totpUninitialized":return null;case"totpLoadingQRCode":case"totpDisplayQRCode":const e="totpLoadingQRCode"===o.step?{isLoading:!0,qrCode:void 0}:{isLoading:o.isLoading,qrCode:o.qrCode};return(0,J.jsx)(fg,{...e,friendlyName:"totpDisplayQRCode"===o.step?o.friendlyName:void 0,errorMessage:o.error,onDismiss:i,onBack:s,onCantScanCode:()=>t.totpDisplayTextCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpDisplayTextCode":return(0,J.jsx)(yg,{textCode:o.rawString,friendlyName:o.friendlyName,errorMessage:o.error,isLoading:o.isLoading,onDismiss:i,onBack:s,onUseQrCode:()=>t.totpDisplayQRCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpVerifyCode":case"totpBackupCodesLoading":case"totpVerifying":return(0,J.jsx)(vg.ZP,{isLoading:"totpVerifying"===o.step||"totpBackupCodesLoading"===o.step,errorMessage:o.error,onDismiss:i,onBack:()=>t.totpDisplayQRCode(),onVerifyCode:e=>t.totpVerifyCode({code:e,onVerified:n})});case"totpVerified":return null;case"totpComplete":return(0,J.jsx)(rg,{type:"totp",errorMessage:o.error,onDismiss:i,onAddMethod:s});default:return(0,Fs.t1)(o)}}function Mg(e){window.__c={n:"RootRouter"};const{rootStateMachine:t,settingsStateMachine:s,totpStateMachine:i,smsStateMachine:o,backupCodesStateMachine:a,onReloadSettings:r}=e,l=t.useCurrentStep(),[{showSettings:d,onRootExit:c}]=(0,n.useState)((()=>({onRootExit:()=>t.exit((()=>{s.exit(),i.exit(),o.exit(),a.exit(),r&&r()})),showSettings:()=>t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{s.settingsConfirmIdentityForSettings()}})}))),u=()=>t.rootCloseSettings((()=>{s.exit(),r&&r()})),m=()=>t.rootStartTOTP((()=>i.totpStart())),p=()=>t.rootStartSMS((()=>o.smsStart())),g=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{i.exit(),s.settingsShow({refresh:!0})}})},h=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{o.exit(),s.settingsShow({refresh:!0})}})},f=()=>{a.exit(),t.rootEndBackupCodes({completeTotp:()=>{i.totpComplete()},completeSMS:()=>{o.smsComplete()},showSettings:d})},x=()=>{a.backupCodesInitialSetup({onLoadingComplete:()=>{i.totpBackupCodesComplete(),t.rootShowBackupCodesFromTOTP()},onComplete:()=>{i.totpBackupCodesComplete(),i.totpComplete(),f()}})},y=()=>{a.backupCodesInitialSetup({onLoadingComplete:()=>{o.smsBackupCodesComplete(),t.rootShowBackupCodesFromSMS()},onComplete:()=>{o.smsBackupCodesComplete(),o.smsComplete(),f()}})},S=()=>{t.rootStartBackupCodesFromSettings((()=>a.backupCodesShowCreate()))},v=s.useCurrentStep(),b=i.useCurrentStep(),M=o.useCurrentStep(),j=a.useCurrentStep();let w;switch(l.step){case"rootUninitialized":break;case"rootSettings":w={open:"settingsUninitialized"!==v.step,onDismiss:c,render:()=>(0,J.jsx)(og.Z,{settingsStateMachine:s,onDismiss:u,onStartTOTP:m,onStartSMS:p,onStartBackupCodes:S})};break;case"rootTOTP":w={open:"totpUninitialized"!==b.step,onDismiss:c,render:()=>(0,J.jsx)(bg,{totpStateMachine:i,onGoToSettings:g,onStartBackupCodes:x,onDismiss:c})};break;case"rootSMS":w={open:"smsUninitialized"!==M.step,onDismiss:c,render:()=>(0,J.jsx)(gg,{smsStateMachine:o,onGoToSettings:h,onStartBackupCodes:y,onDismiss:c})};break;case"rootBackupCodes":w={open:"backupCodesUninitialized"!==j.step,onDismiss:"backupCodesRegenerateCodes"===j.step?c:void 0,render:()=>(0,J.jsx)(ig,{backupCodesStateMachine:a,onGoToSettings:f,onDismiss:c})};break;default:throw(0,Fs.t1)(l)}return w?(0,J.jsx)(wo.Z,{...w,preventHideChildrenWhileOpening:!0}):null}class jg extends N.default{getInitialState(){return{step:"rootUninitialized"}}}class wg extends Yp.o{constructor(e){super(e,"root")}rootShowSettings(e){const{refresh:t,startConfirmIdentity:s}=e;if(this.checkStep("rootSettings")){if(!t)return}else this.store.setState({step:"rootSettings"});s()}rootStartBackupCodesFromSettings(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootBackupCodes",source:"settings"}),e())}rootStartTOTP(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootTOTP"}),e())}rootShowBackupCodesFromTOTP(){this.checkStep("rootTOTP")&&this.store.setState({step:"rootBackupCodes",source:"totp"})}rootStartSMS(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootSMS"}),e())}rootShowBackupCodesFromSMS(){this.checkStep("rootSMS")&&this.store.setState({step:"rootBackupCodes",source:"sms"})}rootEndBackupCodes(e){const t=this.checkStep("rootBackupCodes");if(t)switch(t.source){case"settings":return this.store.setState({step:"rootSettings"}),e.showSettings();case"sms":return this.store.setState({step:"rootSMS"}),e.completeSMS();case"totp":return this.store.setState({step:"rootTOTP"}),e.completeTotp();default:(0,Fs.t1)(t.source)}}rootCloseSettings(e){e(),this.store.setState({step:"rootUninitialized"})}exit(e){this.store.setState({step:"rootUninitialized"}),e()}}var Cg=s(24173),kg=s(49682);class Tg extends N.default{getInitialState(){return{step:"smsUninitialized"}}}class Ig extends Yp.o{constructor(e,t){super(e,"sms"),this.service=void 0,this.service=t}smsStart(){this.checkStep("smsUninitialized")&&this.store.setState({step:"smsSetPhoneNumber"})}smsRestart(){const e=this.checkStep(["smsResendSMS","smsVerifyCode","smsVerifying"]);e&&this.store.setState({step:"smsSetPhoneNumber",country:e.country,phoneNumber:e.phoneNumber,error:void 0})}smsCreateSMS(e,t){this.checkStep("smsSetPhoneNumber")&&(this.store.setState({country:e,phoneNumber:t,step:"smsSendingSMS"}),this.doCreateSMS().catch(this.handleUnexpectedError))}smsResendSMS(){const e=this.checkStep(["smsVerifyCode","smsVerifying"]);e&&(this.store.setState({...e,step:"smsResendSMS",error:void 0}),this.doResendSMS().catch(this.handleUnexpectedError))}smsVerifyCode(e){const{code:t,onVerified:s}=e,n=this.checkStep("smsVerifyCode");n&&(this.store.setState({...n,step:"smsVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}smsBackupCodesComplete(){this.checkStep("smsBackupCodesLoading")&&this.store.setState({step:"smsVerified"})}smsComplete(){this.checkStep("smsVerified")&&this.store.setState({step:"smsComplete"})}exit(){this.store.setState({step:"smsUninitialized"})}async doCreateSMS(){const e=await this.withStep("smsSendingSMS",(e=>this.service.createSMS(e.country.countryCode,e.phoneNumber)));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"created":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:t.mfaSettingId,error:void 0});break;case"already_verified_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:kg.Qj.smsAlreadyVerifiedPhoneNumber});break;case"invalid_country_code":this.store.setState({step:"smsSetPhoneNumber",error:kg.Qj.smsInvalidCountryCode});break;case"invalid_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:kg.Qj.smsInvalidPhoneCode});break;case"sms_unsupported_country_code_for_enrollment":this.store.setState({step:"smsSetPhoneNumber",error:kg.Qj.smsUnsupportedCountryCodeForEnrollment});break;default:return(0,Fs.t1)(t)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,n=await this.withStep("smsVerifying",(e=>this.service.verifySMS({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:i,state:o}=n;switch(i.status){case"match":this.store.setState({step:"smsBackupCodesLoading",country:o.country,phoneNumber:o.phoneNumber}),s();break;case"error":this.store.setState({...o,step:"smsVerifyCode",error:kg.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"smsVerifyCode",error:kg.Qj.smsIncorrectCode});break;default:return(0,Fs.t1)(i.status)}}async doResendSMS(){const e=await this.withStep("smsResendSMS",(e=>this.service.sendSMS({mfaSettingId:e.mfaSettingId})));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"ok":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:void 0,resentAt:Date.now()});break;case"error":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:kg.Qj.unexpectedError});break;default:return(0,Fs.t1)(t.status)}}}class Pg extends N.default{getInitialState(){return{step:"totpUninitialized"}}}class Zg extends Yp.o{constructor(e,t){super(e,"totp"),this.service=void 0,this.service=t}totpStart(){this.checkStep("totpUninitialized")&&(this.store.setState({step:"totpLoadingQRCode"}),this.doCreateTOTP().catch(this.handleUnexpectedError))}totpDisplayTextCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayQRCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayTextCode",error:void 0,isLoading:!1})}}totpDisplayQRCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayTextCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayQRCode",error:void 0,isLoading:!1})}}totpDisplayVerification(e){this.checkStep(["totpDisplayQRCode","totpDisplayTextCode"])&&this.doRenameTOTP(e).catch(this.handleUnexpectedError)}totpVerifyCode(e){const{code:t,onVerified:s}=e,n=this.checkStep("totpVerifyCode");n&&(this.store.setState({...n,step:"totpVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}totpBackupCodesComplete(){this.checkStep("totpBackupCodesLoading")&&this.store.setState({step:"totpVerified"})}totpComplete(){this.checkStep("totpVerified")&&this.store.setState({step:"totpComplete"})}exit(){this.store.setState({step:"totpUninitialized"})}async doCreateTOTP(){const e=await this.withStep("totpLoadingQRCode",(()=>this.service.createTOTP()));if(!e)return;const{result:t}=e;this.store.setState({step:"totpDisplayQRCode",qrCode:t.qrCode,rawString:t.secret,mfaSettingId:t.mfaSettingId,isLoading:!1})}async doRenameTOTP(e){const t=await this.withStep(["totpDisplayQRCode","totpDisplayTextCode"],(t=>this.service.renameSettings({mfaSettingId:t.mfaSettingId,friendlyName:e})));if(!t)return;const{result:s,state:n}=t;switch(s.status){case"saved":this.store.setState({...n,step:"totpVerifyCode",friendlyName:e,error:void 0});break;case"duplicate":this.store.setState({...n,isLoading:!1,error:kg.Qj.totpDuplicateFriendlyName});break;case"empty":this.store.setState({...n,isLoading:!1,error:kg.Qj.totpEmptyFriendlyName});break;case"bad_friendly_name":this.store.setState({...n,isLoading:!1,error:kg.Qj.totpBadFriendlyName});break;default:return(0,Fs.t1)(s)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,n=await this.withStep("totpVerifying",(e=>this.service.verifyTOTP({mfaSettingId:e.mfaSettingId,code:t})));if(!n)return;const{result:i,state:o}=n;switch(i.status){case"match":this.store.setState({step:"totpBackupCodesLoading"}),s();break;case"error":this.store.setState({...o,step:"totpVerifyCode",error:kg.Qj.unexpectedError});break;case"incorrect":this.store.setState({...o,step:"totpVerifyCode",error:kg.Qj.totpIncorrectCode});break;default:return(0,Fs.t1)(i.status)}}}function Fg(e){let{status:t,numMfaSettings:s,onReloadSettings:i,regenerateBackupCodes:l}=e;window.__c={n:"MFASettings"};const d=(0,o.O7)(),[{rootStateMachine:c,settingsStateMachine:u,totpStateMachine:m,smsStateMachine:p,backupCodesStateMachine:f}]=(0,n.useState)((()=>{const e=new Xp.r(d),t={totpStore:new Pg,settingsStore:new Cg.c,smsStore:new Tg,backupCodesStore:new $p,rootStore:new jg};return{mfaService:e,rootStateMachine:new wg(t.rootStore),settingsStateMachine:new Cg.W(t.settingsStore,e),totpStateMachine:new Zg(t.totpStore,e),smsStateMachine:new Ig(t.smsStore,e),backupCodesStateMachine:new Jp(t.backupCodesStore,e)}})),x=d.device.isMobile,y=(0,r.yK)((e=>({configureButton:{marginTop:x?12:0,marginBottom:x?4:0},regenerateBackupCodesBadge:{fontWeight:g.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?Ki.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[x]),S=(0,a.VK)((()=>qe.Z.state.highlightedSetting===qe.R.TwoStepVerification),[]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(mo.Z,{type:"toggleToButton",isMobile:!1,title:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.label",defaultMessage:"2-step verification"}),caption:"on"===t?(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.settingConfigured.message",defaultMessage:"You have {numMfaSettings} verification methods turned on.",values:{numMfaSettings:s}}):(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.message",defaultMessage:"Add an additional layer of security to your account during login."}),isOn:"on"===t,buttonStyle:y.configureButton,buttonLabel:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.label",defaultMessage:"Change verification methods"}),onClick:()=>{!function(e){let{rootStateMachine:t,settingsStateMachine:s}=e;t.rootShowSettings({refresh:!1,startConfirmIdentity:()=>s.settingsConfirmIdentityForSettings()})}({rootStateMachine:c,settingsStateMachine:u})},tooltipLabel:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.tooltip",defaultMessage:"A password is required to enable 2-step verification"}),disableTooltip:"disabled"!==t,disabled:"disabled"===t,badge:l&&(0,J.jsx)(Pp.Z,{style:y.regenerateBackupCodesBadge,content:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.regenerateBackupCodes.badge",defaultMessage:"Regenerate backup codes"})}),shouldHighlight:S}),(0,J.jsx)(Mg,{onReloadSettings:i,rootStateMachine:c,settingsStateMachine:u,totpStateMachine:m,smsStateMachine:p,backupCodesStateMachine:f})]})}var _g=s(1548),Ag=s(30045);class Rg extends i.Z{constructor(){super(...arguments),this.storeTypes={isEducationStore:N.default.createClass(!1)}}async UNSAFE_willMount(e){super.UNSAFE_willMount(e);const{isEducationStore:t}=this.stores,{spaceProfileSettingsStore:s}=this.props,{currentUserStore:n,currentUserSettingsStore:i,currentUserRootStore:o,currentSpaceStore:a}=_e.default.state;if(n&&i){const t=s.getValueForUser(n,i,e.intl);t&&s.setState({...s.state,...t})}if(o&&a){const e=await(0,Mt.Gh)({environment:this.environment,userRootStore:o}),s=a.canAdmin()&&(e||[]).some((e=>e===Hi.default.pricing.student.productId));t.setState(s)}await k(this.environment,s)}willUnmount(){qe.Z.state.highlightedSetting&&qe.Z.setState({...qe.Z.state,highlightedSetting:void 0}),super.willUnmount()}renderComponent(){return zt.Z.state.online?this.renderSettings():(0,J.jsx)(Bg,{})}renderSettings(){const{currentUserStore:e}=_e.default.state;if(!e)return;const t=e.getValue();if(!t)return;const{name:s}=this.props.spaceProfileSettingsStore.state;return(0,J.jsx)(Xe.ZP,{children:this.renderPersonalSettings({currentUserStore:e,currentUserValue:t,userName:s})})}renderPersonalSettings(e){var t;const{userName:s,currentUserStore:n,currentUserValue:i}=e,o=B.default.getIntl(),a=(0,ka.N5)(n,o),r=(0,Dl.Gd)(i.email),l=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Lg,{spaceProfileSettingsStore:this.props.spaceProfileSettingsStore,emailDomainForUser:r,areProfileEditsDisabled:l}),(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,J.jsx)(ka.ZP,{size:60,avatarType:a,isOffline:!zt.Z.state.online,onUploadProfilePhoto:()=>{return e=this.props.spaceProfileSettingsStore,t=this.environment,y.Her(t),void Fa.cR({environment:t,onStart:()=>function(e){e.setState({...e.state,uploadingProfilePhoto:!0})}(e),bucket:"public",onError:()=>function(e){e.setState({...e.state,uploadingProfilePhoto:!1}),v.showErrorMessage((0,J.jsx)(h.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))}(e),onComplete:s=>function(e,t,s){const n=e[0];t.setState({...t.state,profilePhoto:n,uploadingProfilePhoto:!1}),I.createAndCommit({userAction:"SpaceProfileSettings.handleUploadComplete",environment:s,perform:e=>{const{currentUserStore:t}=_e.default.state;t&&x.A({userStore:t,data:{profilePhoto:n},transaction:e})}})}(s,e,t),accept:"image/*"});var e,t},onRemoveProfilePhoto:()=>{return e=this.props.spaceProfileSettingsStore,t=this.environment,e.setState({...e.state,profilePhoto:void 0}),void I.createAndCommit({userAction:"SpaceProfileSettings.handleRemoveProfilePhoto",environment:t,perform:e=>{const{currentUserStore:t}=_e.default.state;t&&x.A({userStore:t,data:{profilePhoto:null},transaction:e})}});var e,t},disabled:l,disabledTooltipMessage:(0,J.jsx)(h.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:r}})}),(0,J.jsxs)("div",{style:{marginLeft:20,width:250},children:[(0,J.jsx)(Ta.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name"})}),(0,J.jsx)(Eg,{spaceProfileSettingsStore:this.props.spaceProfileSettingsStore,userName:s,emailDomainForUser:r,areProfileEditsDisabled:l})]})]}),"photo"!==a.type&&!l&&(0,J.jsx)("div",{style:{color:this.theme.mediumIconColor,fontSize:14,marginTop:8},children:(0,J.jsx)(h.FormattedMessage,{id:"editableUserAvatar.profilePhoto.addPhoto",defaultMessage:"Add photo"})})]}),(0,J.jsx)(Ms.Z,{size:48,isHidden:!0}),this.renderAccountSecuritySection({currentUserValue:i}),(0,J.jsx)(Ms.Z,{size:48,isHidden:!0}),(0,J.jsx)(Og,{spaceProfileSettingsStore:this.props.spaceProfileSettingsStore})]})}renderAccountSecuritySection(e){var t;const{currentUserValue:s}=e,n=this.props.spaceProfileSettingsStore.state.accountSettings,i=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits),o=()=>{k(this.environment,this.props.spaceProfileSettingsStore)};return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.accountSecurity.title",defaultMessage:"Account security"})}),(0,J.jsx)(Op,{userValue:s,hasEducationPlan:this.stores.isEducationStore.state,areProfileEditsDisabled:i}),(0,J.jsx)(Ms.Z,{size:18,isHidden:!0}),(0,J.jsx)(_g.Z,{hasPassword:n.hasPassword,hasPasswordActions:n.canConfigurePassword,isEducationPlan:this.props.isEducationPlan,samlEnforced:n.isSamlEnforced,email:s.email,isError:Boolean(n.error),onReloadSettings:o,mfaStatus:n.mfaStatus}),(0,J.jsx)(Ms.Z,{size:18,isHidden:!0}),(0,J.jsx)(Fg,{status:n.mfaStatus,numMfaSettings:n.numMfaSettings,onReloadSettings:o,regenerateBackupCodes:n.regenerateBackupCodes})]})}}Rg.displayName="SpaceProfileSettings";const Dg=(0,h.injectIntl)(Rg);function Bg(){return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})})})}function Lg(e){window.__c={n:"MyProfileHeader"};const{emailDomainForUser:t,spaceProfileSettingsStore:s,areProfileEditsDisabled:n}=e,i=(0,a.VK)((()=>{var e;return Boolean(null===(e=s.state.emailDomainSettings)||void 0===e?void 0:e.isDomainVerified)}),[s]);return(0,J.jsxs)(et.Z,{large:!0,divider:"full",children:[i?(0,J.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",margin:"0 0 8px"},children:[(0,J.jsx)(Pp.Z,{style:{fontWeight:g.Z.fontWeight.medium,letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",margin:0},content:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.myProfile.managedByline",defaultMessage:"Your account is managed by {domain}",values:{domain:t}})}),n?(0,J.jsx)(re.ZP,{render:e=>(0,J.jsx)("div",{...e,children:(0,Us.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.myProfile.managedByTooltip",defaultMessage:"Contact your organization's administrator to change your profile information."})}):null]}):null,(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.myProfile.title",defaultMessage:"My profile"})]})}function Og(e){let{spaceProfileSettingsStore:t}=e;window.__c={n:"AccountSupportSection"};const[s,n]=(0,a.VK)((()=>{var e;return[(null===(e=t.state.emailDomainSettings)||void 0===e?void 0:e.settings)??{},t.state.emailDomainSettings]}),[t]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(et.Z,{large:!0,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"profileSettings.support.title",defaultMessage:"Support"})}),(0,J.jsx)(Ag.Z,{emailDomainSettings:s}),(0,J.jsx)(Ms.Z,{size:18,isHidden:!0}),(0,J.jsx)(qp,{}),(0,J.jsx)(Ms.Z,{size:18,isHidden:!0}),(0,J.jsx)(Ip.Z,{userEmailDomainSettings:n})]})}function Eg(e){window.__c={n:"UserNameDisplayComponent"};const t=(0,o.O7)(),{userName:s,emailDomainForUser:n,areProfileEditsDisabled:i,spaceProfileSettingsStore:a}=e;return i?(0,J.jsx)(re.ZP,{renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:n}}),placement:re.ug.Bottom,alignment:re.v2.Center,render:e=>(0,J.jsx)("div",{...e,style:{opacity:.4},children:(0,J.jsx)(no.Z,{disabled:!0,value:s})})}):(0,J.jsx)(no.Z,{value:s,onChange:e=>function(e,t,s){const n=e.target.value;y.O$H(s,{from:t.state.name,to:n}),t.setState({...t.state,name:n}),I.createAndCommit({userAction:"SpaceProfileSettings.handleNameChange",environment:s,perform:e=>{const{currentUserStore:t}=_e.default.state;t&&x.A({userStore:t,data:{name:n},transaction:e})}})}(e,a,t)})}var Ng=s(91536);function Vg(e){let{spaceStore:t,subscriptionData:s}=e;return(0,a.VK)((()=>t.canAdmin()&&p.wP(s.subscriptionTier)),[s,t])}function Ug(e){let{spaceStore:t}=e;return(0,a.VK)((()=>t.canAdmin()),[t])}function Wg(e){let{spaceStore:t}=e;return(0,a.VK)((()=>t.canEditMembership()),[t])}function Kg(){const e=(0,o.O7)();return(0,a.VK)((()=>{const t=wt.subscriptionDataStoreInstance.state,s=Boolean(t&&Mt.YK(t));return Mt.qF(e)&&s}),[e])}var zg=s(76781),qg=s(41977);function Gg(e){let{spaceStore:t,spacePermissionsSettingsStore:s,groups:n}=e;window.__c={n:"PeopleSectionGroupsTab"};const{isTeamsEnabled:i,canUseGroups:o,canEditGroups:r,isSpaceStoreDefined:l}=function(e){let{spaceStore:t}=e;const s=(0,Fe.Gc)(),n=Kg(),{canEditMembership:i,isSpaceStoreDefined:o}=(0,a.VK)((()=>({canEditMembership:t.canEditMembership(),isSpaceStoreDefined:t.isDefined()})),[t]),r=(0,a.VK)((()=>i&&n),[i,n]);return{isTeamsEnabled:s,canUseGroups:n,canEditMembership:i,canEditGroups:r,isSpaceStoreDefined:o}}({spaceStore:t});return l?(0,J.jsxs)("div",{children:[o?(0,J.jsx)(le.Z,{isMultiline:!0,children:i?(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.captionWithTeamsV2",defaultMessage:"Set up groups to streamline page permissions from the share menu and manage teamspace members in bulk."}):(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.caption",defaultMessage:"Set up groups to conveniently control page permissions from the share menu."})}):(0,J.jsx)(xu.Z,{subscriptionTier:"plus",from:"permission_groups",icon:zg.x,title:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeTitle",defaultMessage:"Upgrade to create groups"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.upgradeCaption.plus",defaultMessage:"Upgrade to the Plus Plan to set up groups and control permissions from the share menu."}),learnMoreRoute:"guides.groups"}),n.length>0&&(0,J.jsx)(qg.Z,{spaceStore:t,permissionsSettingsStore:s,groups:n,canEdit:r})]}):null}var Hg=s(79362),Qg=s(80136),Yg=s(87011),$g=s(90334);class Jg extends N.default{getInitialState(){return{isModalOpen:!1,guests:[],handleClickDecline:()=>{}}}}const Xg=new Jg;function eh(e){let{guest:t,spaceStore:s,shouldDisableInteraction:i}=e;window.__c={n:"GuestActionsCell"};const{environment:l,styles:d,isSubscribed:c,handleConvertToMemberClick:u,handleRemoveClick:m}=function(e){let{guest:t,spaceStore:s,shouldDisableInteraction:i}=e;const l=(0,r.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"flex-end",opacity:i?.5:1},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},upgradeButton:{padding:"0px 6px 0px 8px",width:257},removeMenuDivider:{paddingTop:4,paddingBottom:4,borderTop:`1px solid ${e.v2.stroke.deemphasized}`},removeButton:{width:257,padding:"0px 6px 0px 8px",color:Hg.Lr[e.mode].red},upgradeIcon:{width:17,height:17}})),[i]),d=(0,a.VK)((()=>{const e=wt.subscriptionDataStoreInstance.state;return Boolean(e&&Mt.YK(e))}),[]),c=(0,o.O7)(),u=(0,n.useCallback)((()=>{const e=me.U6.createChildStore(s,{table:R.KJ,id:t.userId}),n=d?"read_and_write":"editor";Qg.s({environment:c,guestUserStore:e,role:n,store:s,isConvertToAdmin:!d,origin:"guest_pages_popup"})}),[d,s,c,t.userId]),m=(0,n.useCallback)((()=>{Xg.setState({...Xg.state,isModalOpen:!0,guests:[t.userId],handleClickDecline:()=>{Ng.b4(c,{from:"guest",button_name:"confirm_in_dialog",count:1});const e=me.U6.createChildStore(s,{table:R.KJ,id:t.userId});Qg.w({environment:c,guestUserStore:e,store:s})}})}),[s,c,t]);return{environment:c,styles:l,isSubscribed:d,handleConvertToMemberClick:u,handleRemoveClick:m}}({guest:t,spaceStore:s,shouldDisableInteraction:i});return(0,J.jsx)("div",{style:d.container,children:(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,renderOrigin:e=>(0,J.jsx)(Vt.Z,{style:d.button,...e,children:(0,J.jsx)(J.Fragment,{children:(0,$g.O)(d.buttonIcon)})}),onClick:()=>{Ng.b4(l,{from:"guest",button_name:"actions"})},disabled:i,render:()=>(0,J.jsx)("div",{children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[{key:"upgrade",render:e=>(0,J.jsx)(sn.Z,{...e}),items:[{key:"upgrade",render:e=>(0,J.jsx)($s.Z,{...e,buttonStyle:d.upgradeButton,icon:(0,Yg.Mnh)(d.upgradeIcon),title:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionguestsTab.upgradeToAdmin",defaultMessage:"Upgrade to {isSubscribed, select, true {member} other {admin}}",values:{isSubscribed:c}})}),action:()=>{u(),Ng.b4(l,{from:"guest",button_name:"upgrade"})}}]},{key:"remove",render:e=>(0,J.jsx)(sn.Z,{...e,style:d.removeMenuDivider}),items:[{key:"remove",render:e=>(0,J.jsx)($s.Z,{...e,buttonStyle:d.removeButton,icon:(0,Yg.ISU)(d.upgradeIcon),title:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionguestsTab.remove",defaultMessage:"Remove from workspace"})}),action:()=>{m(),Ng.b4(l,{from:"guest",button_name:"remove"})}}]}]})})})})}var th=s(20586);function sh(e){let{isModalOpen:t,handleDismiss:s,handleConfirm:n,title:i,description:o,ctaText:a}=e;window.__c={n:"BulkDeclineConfirmationDialog"};const{styles:l}={styles:(0,r.yK)((e=>({modal:{width:300,overflow:"hidden",borderRadius:5},container:{display:"flex",padding:"20px 20px 12px 20px",flexDirection:"column",width:299,justifyContent:"center",alignItems:"flex-start",gap:20},iconAndTitle:{display:"flex",flexDirection:"column",alignItems:"center",gap:9,width:"100%"},iconContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:36,height:36},icon:{color:e.v2.icon.secondary,fontSize:24,fontWeight:510},title:{color:e.v2.text.primary,textAlign:"center",fontSize:17,fontWeight:590,lineBreak:"anywhere"},description:{color:e.v2.text.secondary,textAlign:"center"},footer:{display:"flex",flexDirection:"column",gap:8,alignItems:"center",width:"100%"},declineButton:{height:32,padding:"0 12px",borderRadius:6,width:"100%",textAlign:"center",alignItems:"center",justifyContent:"center",background:Hg.Lr[e.mode].red},declineButtonHovered:{background:e.v2.text.ui.red.pressed},declineText:{fontWeight:590,color:e.v2.text.contrast},cancelButton:{display:"flex",height:24,padding:"0px 6px",justifyContent:"center",alignItems:"center",gap:4,textAlign:"center"}})),[])};return(0,J.jsx)(wo.Z,{open:t,innerStyle:l.modal,showCloseIcon:!0,onDismiss:s,render:()=>(0,J.jsx)(Mo.Z,{capture:!0,allowEsc:!0,render:()=>(0,J.jsx)(jo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsxs)("div",{style:l.iconAndTitle,children:[(0,J.jsx)("div",{style:l.iconContainer,children:(0,J.jsx)("div",{style:l.icon,children:(0,th.$)({width:24,height:24})})}),(0,J.jsx)("div",{style:l.title,children:i})]}),(0,J.jsx)("div",{style:l.description,children:o}),(0,J.jsxs)("div",{style:l.footer,children:[(0,J.jsx)(Vt.Z,{style:l.declineButton,onClick:()=>{n(),s()},hoveredStyle:l.declineButtonHovered,children:(0,J.jsx)("div",{style:l.declineText,children:a})}),(0,J.jsx)(Vt.Z,{style:l.cancelButton,onClick:s,children:(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{id:"BulkDeclineConfirmationDialog.cancel",defaultMessage:"Cancel"})})})]})]})})})})}function nh(){window.__c={n:"GuestBulkRemoveConfirmationDialog"};const{isModalOpen:e,handleClickDecline:t,handleDismiss:s,guests:i,firstGuestName:r}=function(){const{isModalOpen:e,guests:t,handleClickDecline:s}=(0,a.VK)((()=>Xg.state),[]),i=(0,h.useIntl)(),r=(0,a.VK)((()=>{const{currentSpaceStore:e}=_e.default.state;if(0===t.length||!e)return;return me.U6.createChildStore(e,{table:R.KJ,id:t[0]}).getDisplayName(i)}),[t,i]),l=(0,o.O7)(),d=(0,n.useCallback)((()=>{Xg.reset(),Ng.b4(l,{from:"guest",button_name:"confirm_in_dialog",count:t.length})}),[l,t]);return{isModalOpen:e,guests:t,firstGuestName:r,handleClickDecline:s,handleDismiss:d}}();return 0===i.length?null:(0,J.jsx)(sh,{isModalOpen:e,handleDismiss:s,handleConfirm:t,title:(0,J.jsx)(h.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.title",defaultMessage:"Remove {numberOfGuests, plural, one {{firstGuestName}} other {{numberOfGuests} guests}} from the workspace?",values:{numberOfGuests:i.length,firstGuestName:r}}),description:(0,J.jsx)(h.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.description",defaultMessage:"They will lose access to all shared pages. To add them as a guest in the future, a request must be submitted, or an admin must invite them."}),ctaText:(0,J.jsx)(h.FormattedMessage,{id:"GuestBulkRemoveConfirmationDialog.remove",defaultMessage:"Remove"})})}var ih=s(86517);function oh(e){let{guestUserId:t,pageIds:s,spaceStore:n}=e;window.__c={n:"GuestPagesContent"};const{menuListItems:i,styles:l}=function(e){let{guestUserId:t,pageIds:s,spaceStore:n}=e;const i=(0,r.yK)((()=>({container:{width:256},chevron:{marginLeft:8,width:16,height:16}})),[]),l=(0,o.O7)(),d=(0,h.useIntl)();return{menuListItems:(0,a.VK)((()=>s.map((e=>{var s;const i=me.G.createChildStore(n,{table:hi.iU,id:e}),o=null===(s=i.getPermissionItems().find((e=>"user_permission"===e.type&&e.user_id===t)))||void 0===s?void 0:s.role;return{key:e,render:e=>(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(cp.Z,{...e,store:i,placeholder:(0,J.jsx)(h.FormattedMessage,{id:"guestPagesPopup.privatePagePlaceholder",defaultMessage:"Private page"}),caption:o?d.formatMessage((0,ih.kD)(o,"block")):void 0})}),action:()=>{const e=(0,gn.ZP)({store:i,fullyQualified:!1,pageVisitSource:un.tY.LinkInPage});cd.c4({environment:l,url:e,openInNew:"tab"})}}}))),[n,s,t,l,d]),styles:i}}({guestUserId:t,pageIds:s,spaceStore:n});return(0,J.jsx)("div",{style:l.container,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[{key:"pages",render:e=>(0,J.jsx)(sn.Z,{...e}),items:i}]})})}function ah(e){let{from:t,guestUserId:s,pageIds:n,spaceStore:i,shouldDisableInteraction:a}=e;window.__c={n:"GuestPagesButton"};const{styles:l}=function(e){let{shouldDisableInteraction:t}=e;return{styles:(0,r.yK)((e=>({button:{opacity:t?.5:1,color:e.v2.text.secondary},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[t])}}({shouldDisableInteraction:a}),d=(0,o.O7)(),c=n.length;return 0===c?(0,J.jsx)(Vt.Z,{disabled:!0,style:l.button,children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionguestsTab.GuestPagesButton.noPages",defaultMessage:"No pages"})}):(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,onClick:()=>{Ng.b4(d,{from:t,button_name:"open_pages"})},renderOrigin:e=>(0,J.jsxs)(Vt.Z,{...e,style:l.button,children:[(0,J.jsx)(h.FormattedMessage,{id:"GuestPagesButton.button",defaultMessage:"{numOfPages, plural, one {{numOfPages} page} other {{numOfPages} pages}}",values:{numOfPages:c}}),(0,gd.i)(l.chevron)]}),disabled:a,render:()=>(0,J.jsx)(oh,{pageIds:n,guestUserId:s,spaceStore:i})})}function rh(e){let{guest:t,spaceStore:s,shouldDisableInteraction:n}=e;window.__c={n:"GuestPagesCell"};const{pageIds:i,guestUserId:o}=function(e){let{guest:t,spaceStore:s}=e;return{pageIds:t.guestPageIds,guestUserId:t.userId}}({guest:t,spaceStore:s});return(0,J.jsx)(ah,{pageIds:i,guestUserId:o,spaceStore:s,shouldDisableInteraction:n,from:"guest"})}function lh(e){let{userId:t,spaceStore:s}=e;window.__c={n:"UserCell"};const{name:n,email:i,userStore:o,styles:l}=function(e){let{userId:t,spaceStore:s}=e;const n=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:g.Z.fontSize.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},titleContainer:{maxWidth:163},userAvatar:{},userName:{height:17,alignSelf:"stretch",fontSize:g.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",...g.Z.textOverflowStyle},userEmail:{height:17,alignSelf:"stretch",fontSize:g.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:e.v2.text.secondary,...g.Z.textOverflowStyle}})),[]),i=(0,h.useIntl)(),o=me.U6.createChildStore(s,{table:R.KJ,id:t}),{name:l,email:d}=(0,a.VK)((()=>({name:o.getDisplayName(i),email:o.getEmail()})),[o,i]);return{name:l,email:d,styles:n,userStore:o}}({userId:t,spaceStore:s});return(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsx)(Vn.Z,{style:l.userAvatar,userStore:o,size:28}),(0,J.jsxs)("div",{style:l.titleContainer,children:[(0,J.jsx)("div",{style:l.userName,title:n,children:n}),(0,J.jsx)("div",{style:l.userEmail,title:i,children:i})]})]})}function dh(e){let{guests:t,spaceStore:s}=e;window.__c={n:"GuestsTable"};const{environment:i,tableStyles:l,styles:d,sortState:c,setSortState:u,selectedRowIds:m,setSelectedRowIds:p,rows:g,searchQuery:f,onClickApprove:x,onClickDecline:y,isApproveButtonLoading:S,canEditMembership:v,columnRenderInfo:b,isSubscribed:M,shouldHideActions:j,shouldShowRequest:w,canAdmin:C,guestsCount:k,shouldShowLoadMore:T,onLoadMore:I}=function(e){let{guests:t,spaceStore:s}=e;const i=_t({spaceStore:s}),l=Ug({spaceStore:s}),d=(0,r.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.v2.text.tertiary},emptyMessage:{marginTop:15,marginBottom:40,textAlign:"center"},headerContainer:{display:"flex",justifyContent:i&&l?"space-between":"flex-end"},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.v2.stroke.regular}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:10,paddingRight:0,height:30},buttonContainerApprove:{display:"flex",padding:"0px 12px 0px 0px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.ui.blue.primary},buttonContainerDecline:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:Hg.Lr[e.mode].red},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:e.v2.stroke.deemphasized},actionRightButton:{borderRadius:"0px 4px 4px 0px",paddingLeft:0,paddingRight:0,height:30}})),[i,l]),c=Wg({spaceStore:s}),u=(0,a.VK)((()=>c?[ch,uh,mh]:[ch]),[c]),m=(0,r.yK)((e=>({...(0,oe.b)({columnRenderInfo:u,theme:e,containerMarginTop:0})})),[u]),p=(0,a.VK)((()=>u[0]),[u]),[g,f]=(0,n.useState)({column:p,sortAscending:!0}),[x,y]=(0,n.useState)([]),S=(0,h.useIntl)(),v=(0,a.VK)((()=>Zt.state.searchQuery),[]),b=(0,a.VK)((()=>t.map((e=>{const t=me.U6.createChildStore(s,{table:R.KJ,id:e.userId});return{spaceStore:s,user:e,email:t.getEmail(),userName:t.getDisplayName(S),id:e.userId,shouldDisableInteraction:x.includes(e.userId),isClickable:!1}})).filter((e=>{var t,s;return void 0===v||(((null===(t=e.email)||void 0===t?void 0:t.includes(v))||(null===(s=e.userName)||void 0===s?void 0:s.includes(v)))??!1)}))),[s,t,S,v,x]),M=(0,o.O7)(),j=(0,a.VK)((()=>{const e=wt.subscriptionDataStoreInstance.state;return Boolean(e&&Mt.YK(e))}),[]),w=(0,n.useCallback)((()=>{Ng.b4(M,{from:"guest",button_name:"bulk_upgrade",count:x.length}),x.forEach((e=>{const t=me.U6.createChildStore(s,{table:R.KJ,id:e}),n=j?"read_and_write":"editor";Qg.s({environment:M,guestUserStore:t,role:n,store:s,isConvertToAdmin:!j,origin:"guest_actions"}),y([])}))}),[x,M,j,s]),C=(0,n.useCallback)((()=>{Ng.b4(M,{from:"guest",button_name:"bulk_remove",count:x.length}),Xg.setState({...Xg.state,isModalOpen:!0,guests:x,handleClickDecline:()=>{Ng.b4(M,{from:"guest",button_name:"confirm_in_dialog",count:x.length}),x.forEach((e=>{const t=me.U6.createChildStore(s,{table:R.KJ,id:e});Qg.w({environment:M,guestUserStore:t,store:s})})),y([])}})}),[x,M,s]),k=!b.some((e=>x.includes(e.id))),[T,I]=(0,n.useState)(10),P=(0,n.useCallback)((()=>{I(T+10)}),[T]),Z=T<b.length,F=b.slice(0,T);return{environment:M,tableStyles:m,styles:d,sortState:g,setSortState:f,selectedRowIds:x,setSelectedRowIds:y,rows:F,searchQuery:v,onClickApprove:w,onClickDecline:C,isApproveButtonLoading:!1,canEditMembership:c,columnRenderInfo:u,isSubscribed:j,shouldHideActions:k,shouldShowRequest:i,canAdmin:l,guestsCount:b.length,shouldShowLoadMore:Z,onLoadMore:P}}({guests:t,spaceStore:s});return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:d.headerContainer,children:[w&&C&&(0,J.jsxs)("div",{style:d.titleContainer,children:[(0,J.jsx)("span",{children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionguestsTab.activeguests.title",defaultMessage:"Active"})}),(0,J.jsx)("span",{style:d.titleNumber,children:k})]}),m.length>0&&!j&&(0,J.jsxs)("div",{style:d.actionsContainer,children:[(0,J.jsx)(Vt.Z,{style:d.actionLeftButton,onClick:x,isLoading:S,children:(0,J.jsxs)("div",{style:d.buttonContainerApprove,children:[(0,J.jsx)("div",{style:d.buttonIcon,children:(0,Yg.Mnh)({width:20,height:16})}),(0,J.jsx)("div",{style:d.buttonText,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.peopleSection.guestsTable.bulkUpgrade",defaultMessage:"Upgrade {numberOfRequests, plural, one {1 guest} other {{numberOfRequests} guests}} to {isSubscribed, select, true {member} other {admin}}",values:{numberOfRequests:m.length,isSubscribed:M}})})]})}),(0,J.jsx)("div",{style:d.buttonDivider}),(0,J.jsx)(Vt.Z,{style:d.actionRightButton,onClick:y,children:(0,J.jsxs)("div",{style:d.buttonContainerDecline,children:[(0,J.jsx)("div",{style:{...d.buttonIcon,paddingTop:3},children:(0,Yg.ISU)({width:20,height:16})}),(0,J.jsx)("div",{style:d.buttonText,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.peopleSection.guestsTable.bulkDecline",defaultMessage:"Remove from workspace"})})]})})]})]}),(0,J.jsxs)("div",{style:{marginTop:w&&C?4:-1},children:[(0,J.jsx)(oe.D,{allowHorizontalScroll:v,setStickyHeaderRow:!0,columnRenderInfo:b,rows:ph(g,c),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:c,onSortStateChanged:u,loadMoreType:"button",onLoadMore:T?I:void 0,renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:d.emptyMessage,children:f?(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionGuestsTab.emptySearch",defaultMessage:"No search results."}):(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionGuestsTab.emptyRow",defaultMessage:"No guests."})}),styles:l,multiselect:v?{header:{isDisabled:0===g.length,isSelected:m.length>0&&m.length===g.length,onClick:()=>{m.length===g.length?(p([]),Ng.pZ(i,{from:"guests",action:"deselect_all",row_count:m.length})):(p(g.map((e=>e.id))),Ng.pZ(i,{from:"guests",action:"select_all",row_count:g.length}))}},row:{getDisabledState:()=>!1,getSelectedState:e=>m.includes(e.id),onClick:e=>{p((t=>t.includes(e.id)?(Ng.pZ(i,{from:"guests",action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(Ng.pZ(i,{from:"guests",action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0}),(0,J.jsx)(nh,{})]})]})}const ch={id:"user",headerTitle:(0,J.jsx)("div",{style:{fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionGuestsTab.user",defaultMessage:"User"})}),renderCell:e=>(0,J.jsx)(lh,{userId:e.user.userId,spaceStore:e.spaceStore}),widthData:{width:210},sortable:!0},uh={id:"access",headerTitle:(0,J.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionGuestsTab.access",defaultMessage:"Access"})}),renderCell:e=>(0,J.jsx)(rh,{guest:e.user,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:180},sortable:!1},mh={id:"actions",headerTitle:(0,J.jsx)(J.Fragment,{}),renderCell:e=>(0,J.jsx)(eh,{guest:e.user,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:300},sortable:!1};function ph(e,t){let{sortAscending:s}=t;const n=c.MR(e,(e=>e.email));return s||n.reverse(),n}var gh=s(5705),hh=s(85740);class fh extends N.default{getInitialState(){return{isModalOpen:!1,requests:[],requestType:"member",handleClickDecline:()=>{}}}}const xh=new fh;function yh(e){let{request:t,spaceStore:s,shouldDisableInteraction:i,requestType:a}=e;window.__c={n:"RequestActionsCell"};const{styles:l,handleApprove:d,handleDecline:c,isApproveButtonLoading:u}=function(e){let{request:t,spaceStore:s,shouldDisableInteraction:i,requestType:a}=e;const l=(0,r.yK)((e=>({approveButton:{background:e.outlineBlueButtonHoveredBackground,color:e.blueColor,fontWeight:510,fontSize:14,borderRadius:4,paddingLeft:10,paddingRight:10},declineButton:{marginRight:10,borderRadius:4,paddingLeft:10,paddingRight:10,color:e.v2.text.secondary},container:{opacity:i?.5:1,display:"flex",width:"100%",justifyContent:"flex-end"}})),[i]),d=(0,o.O7)(),c=(0,n.useMemo)((()=>pi.kk.fromAccessRequest(t.accessRequest)),[t]),[u,m]=(0,n.useState)(!1),{forActor:p,accessRequestStore:g}=t,x=(0,n.useCallback)((()=>{m(!0),Ng.b4(d,{from:`${a}_request`,button_name:"approve"}),c.isGuestInviteRequest()?f.yW({environment:d,accessRequest:c,status:"approved",from:"requests_center",forActor:pi.kk.fromUser(p),onResolveComplete:e=>{m(!1),e?zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveGuestInvite.success",defaultMessage:"Invited {actorEmail} as guest",values:{actorEmail:p.email}})}):zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveGuestInvite.failure",defaultMessage:"Failed to invite {actorEmail} as a guest",values:{actorEmail:p.email}})})}}):c.isSpaceMembershipRequest()&&f.kn({environment:d,store:s,accessRequestStore:g,forActor:p,status:"approved",from:"requests_center",onResolveComplete:e=>{m(!1),e?zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveSpaceMembership.success",defaultMessage:"Added {actorEmail} as a member",values:{actorEmail:p.email}})}):zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettingsRequestRow.requestRowActions.toast.approveSpaceMembership.failure",defaultMessage:"Failed to add {actorEmail} as a member",values:{actorEmail:p.email}})})}})}),[c,d,g,p,s,a]),y=(0,n.useCallback)((()=>{Ng.b4(d,{from:`${a}_request`,button_name:"decline"}),xh.setState({...xh.state,isModalOpen:!0,requests:[t],requestType:a,handleClickDecline:()=>{c.isGuestInviteRequest()?f.yW({environment:d,accessRequest:c,status:"rejected",from:"requests_center",forActor:pi.kk.fromUser(p),onResolveComplete:()=>{}}):c.isSpaceMembershipRequest()&&f.kn({environment:d,store:s,accessRequestStore:g,forActor:p,status:"rejected",from:"requests_center",onResolveComplete:()=>{}})}})}),[c,d,g,p,s,a,t]);return{styles:l,handleApprove:x,handleDecline:y,isApproveButtonLoading:u}}({request:t,spaceStore:s,shouldDisableInteraction:i,requestType:a});return(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsx)("div",{children:(0,J.jsx)(Vt.Z,{style:l.declineButton,onClick:c,disabled:i,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.Decline",defaultMessage:"Decline"})})}),(0,J.jsx)("div",{children:(0,J.jsx)(Vt.Z,{style:l.approveButton,onClick:d,isLoading:u,disabled:i,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.approve",defaultMessage:"Approve"})})})]})}function Sh(){window.__c={n:"RequestBulkDeclineConfirmationDialog"};const{isModalOpen:e,handleClickDecline:t,handleDismiss:s,requestType:i,requests:r}=function(){const{isModalOpen:e,requestType:t,requests:s,handleClickDecline:i}=(0,a.VK)((()=>xh.state),[]),r=(0,o.O7)(),l=(0,n.useCallback)((()=>{xh.reset(),Ng.b4(r,{from:"member"===t?"member_request":"guest_request",button_name:"dismiss_in_dialog",count:s.length})}),[r,s,t]);return{isModalOpen:e,requestType:t,requests:s,handleClickDecline:i,handleDismiss:l}}();return 0===r.length?null:(0,J.jsx)(sh,{isModalOpen:e,handleDismiss:s,handleConfirm:t,title:(0,J.jsx)(h.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.title",defaultMessage:"Decline {numberOfRequests, plural, one {{requestType} request for {firstRequestEmail}} other {{numberOfRequests} {requestType} requests}}?",values:{numberOfRequests:r.length,requestType:i,firstRequestEmail:r[0].forActor.email}}),description:(0,J.jsx)(h.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.description",defaultMessage:"{numberOfRequests, plural, one {To add them as a {requestType} in the future, {inviter} must resubmit a request, or an admin must invite them} other {Requests must be resubmitted, or an admin must add them as {isMemberRequest, select, true {members} other {guests}} in the future}}.",values:{numberOfRequests:r.length,requestType:i,isMemberRequest:"member"===i,inviter:r[0].createdByActorsWithReason[0].actor.name}}),ctaText:(0,J.jsx)(h.FormattedMessage,{id:"RequestBulkDeclineConfirmationDialog.decline",defaultMessage:"Decline"})})}function vh(e){let{spaceStore:t,createdByActorsWithReason:s,latestRequestTime:n}=e;return(0,J.jsx)("div",{style:{width:241,maxHeight:600,overflowY:"auto",whiteSpace:"pre-wrap",padding:"12px 12px 12px 12px"},children:s.map((e=>(0,J.jsx)(bh,{spaceStore:t,createdByActorWithReason:e,latestRequestTime:n},e.actor.id)))})}function bh(e){let{spaceStore:t,createdByActorWithReason:s,latestRequestTime:n}=e;window.__c={n:"RequestReasonContentInternal"};const{requestorName:i,reason:o,actor:l,styles:d}=function(e){let{spaceStore:t,createdByActorWithReason:s}=e;const{actor:n,reason:i}=s,o=(0,h.useIntl)(),l=(0,a.VK)((()=>me.U6.createChildStore(t,{table:R.KJ,id:n.id}).getDisplayName(o)),[o,n,t]),d=(0,r.yK)((e=>({avatar:{width:24,height:24},metadata:{display:"flex",alignItems:"center",gap:6,flex:"1 0 0"},userName:{textOverflow:"ellipsis",fontSize:14,fontWeight:510,overflow:"hidden",width:100,whiteSpace:"nowrap"},timestamp:{color:e.v2.text.tertiary,textAlign:"right",fontSize:12,fontWeight:400,lineHeight:"15px"},header:{display:"flex",alignItems:"center",gap:10},reason:{paddingLeft:30,fontSize:14,fontWeight:400,color:e.v2.text.primary,letterSpacing:"-0.154px",display:"inline-block",overflowWrap:"break-word",inlineSize:200},noReason:{color:e.v2.text.quaternary}})),[]);return{requestorName:l,reason:i,actor:n,styles:d}}({spaceStore:t,createdByActorWithReason:s});return(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:d.header,children:[(0,J.jsx)(Vn.Z,{hasTooltip:!0,userValue:l,style:d.avatar,size:24,avatarShouldShowShadow:!1}),(0,J.jsxs)("div",{style:d.metadata,children:[(0,J.jsx)("div",{style:d.userName,children:i}),(0,J.jsx)(le.Z,{isSmall:!0,isSecondaryColor:!0,isMultiline:!0,style:d.timestamp,children:(0,wa.IS)(n)})]})]}),(0,J.jsx)("span",{style:d.reason,children:o||(0,J.jsx)("div",{style:d.noReason,children:(0,J.jsx)(h.FormattedMessage,{id:"requestReasonContent.noReason",defaultMessage:"No message"})})})]})}function Mh(e){let{request:t,spaceStore:s,shouldDisableInteraction:n,requestType:i}=e;window.__c={n:"RequestedByCell"};const{styles:l,firstRequestorName:d,numberOfRequestors:c}=function(e){let{request:t,spaceStore:s,shouldDisableInteraction:n}=e;const i=(0,r.yK)((e=>({firstRequestorName:{color:e.v2.text.secondary,opacity:n?.5:1,maxWidth:118,...g.Z.textOverflowStyle},buttonSuffix:{color:e.v2.text.tertiary,paddingLeft:4},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[n]),o=(0,h.useIntl)(),{firstRequestorName:l}=(0,a.VK)((()=>{if(0===t.createdByActorsWithReason.length)return{firstRequestorName:void 0};return{firstRequestorName:me.U6.createChildStore(s,{table:R.KJ,id:t.createdByActorsWithReason[0].actor.id}).getDisplayName(o)}}),[o,t.createdByActorsWithReason,s]);return{styles:i,firstRequestorName:l,numberOfRequestors:t.createdByActorsWithReason?t.createdByActorsWithReason.length:0}}({request:t,spaceStore:s,shouldDisableInteraction:n}),u=(0,o.O7)();return void 0===d||0===c?null:(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,onClick:()=>{Ng.b4(u,{from:`${i}_request`,button_name:"open_requested_by"})},renderOrigin:e=>(0,J.jsx)(Vt.Z,{...e,disabled:n,children:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("span",{style:l.firstRequestorName,title:d,children:d}),(0,J.jsx)("span",{style:l.buttonSuffix,children:c>1?(0,J.jsxs)("div",{children:["+",c-1]}):null}),(0,gd.i)(l.chevron)]})}),render:()=>(0,J.jsx)(vh,{spaceStore:s,createdByActorsWithReason:t.createdByActorsWithReason,latestRequestTime:t.latestRequestTime})})}function jh(e){let{request:t,spaceStore:s,shouldDisableInteraction:n}=e;window.__c={n:"RequestPagesCell"};const{pageIds:i,guestUserId:o}=function(e){let{request:t,spaceStore:s}=e;return{pageIds:"guest_invite_request"===t.accessRequest.type?t.accessRequest.attributes.permission_records_and_roles.map((e=>e.id)):[],guestUserId:t.forActor.id}}({request:t,spaceStore:s});return(0,J.jsx)(ah,{pageIds:i,guestUserId:o,spaceStore:s,shouldDisableInteraction:n,from:"guest_request"})}var wh=s(55838),Ch=s(48019);const kh=(0,h.defineMessages)({filterTeams:{defaultMessage:"Filter teamspaces…",id:"teamsDropdownForMember.filterForTeams.placeholder"},privateTeamspace:{defaultMessage:"Private teamspace",id:"teamsDropdownForMember.privateTeamspace"}});function Th(e){window.__c={n:"TeamspacesMenuItems"};const t=(0,o.O7)(),[s,i]=(0,n.useState)(""),l=(0,n.useCallback)((e=>xd.RF({environment:t,teamId:e,tab:wh.a.Members,from:"teams_dropdown_space_settings_people"})),[t]),d=(0,r.yK)((e=>({teamName:{color:e.v2.text.primary,fontSize:14},teamMemberCount:{color:e.v2.text.secondary,fontSize:12}})),[]),c=(0,a.VK)((()=>[{key:"teams for member",render:e=>(0,J.jsx)(sn.Z,{...e}),actions:e.teamStores.map((e=>({key:e.id,displayName:e.getName()??B.default.formatMessage(kh.privateTeamspace),analyticsName:e.getName()||"team_unknown",searchName:e.getName(),render:t=>(0,J.jsx)($s.Z,{style:{padding:4},textWrapperStyle:{marginLeft:0,marginRight:0},title:(0,J.jsxs)("div",{style:{display:"flex",padding:"4px 6px 4px 8px",alignItems:"flex-start",gap:8,alignSelf:"stretch"},children:[(0,J.jsx)(An.p,{disabled:!0,store:e,size:20,style:{borderRadius:4}}),(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{style:d.teamName,children:e.getName()??B.default.formatMessage(kh.privateTeamspace)}),(0,J.jsx)("div",{style:d.teamMemberCount,children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"{numMembers} {numMembers, plural, one {member} other {members}}",id:"teamsDropdownForMember.numMembers",values:{numMembers:e.getUserIdsInTeam().length}})})]})]}),disabled:!Boolean(e.getName()),inline:!0,...t}),action:()=>{l(e.id)},closeParentMenu:!1})))}]),[e.teamStores,l,d.teamMemberCount,d.teamName]),u=s,m=(0,J.jsx)(sn.Z,{isInput:!0,children:(0,J.jsx)(Zc.ZP,{value:u,onChange:(0,n.useCallback)((e=>{i(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:B.default.formatMessage(kh.filterTeams)})}),p={menuType:Hs.og.Popup,maxWidth:350,maxHeight:300,header:e.teamStores.length>5?m:void 0};return(0,J.jsx)(Xs.Z,{...p,children:(0,J.jsx)(Ch.Z,{filter:u,context:{blocks:[],environment:t,publicEditMode:void 0},initialFocus:void 0,sections:c})})}function Ih(e){let{from:t,teamStores:s}=e;window.__c={n:"UserTeamspacesPopupButton"};const{styles:i,onClickButton:a}=function(e){let{from:t}=e;const s=(0,r.yK)((e=>({button:{marginRight:8},noTeams:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},teamspaceName:{color:e.v2.text.secondary,maxWidth:70,...g.Z.textOverflowStyle},teamspaceNameSuffix:{color:e.v2.text.tertiary,paddingLeft:4}})),[]),i=(0,o.O7)(),a=(0,n.useCallback)((()=>{Ng.b4(i,{from:t,button_name:"open_teamspaces"})}),[i,t]);return{styles:s,onClickButton:a}}({from:t}),l=s.length;return(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,onClick:a,renderOrigin:e=>(0,J.jsx)(Vt.Z,{disabled:0===l,style:0===l?i.noTeams:i.button,...e,children:0===l?(0,J.jsx)(h.FormattedMessage,{id:"teamsDropdownForMember.teamsCountNone.label",defaultMessage:"No access"}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("span",{style:i.teamspaceName,title:s[0].getName(),children:s[0].getName()}),(0,J.jsx)("span",{style:i.teamspaceNameSuffix,children:l>1?(0,J.jsxs)("div",{children:["+",l-1]}):null}),(0,gd.i)(i.chevron)]})}),render:()=>(0,J.jsx)(Th,{teamStores:s})})}function Ph(e){let{spaceStore:t,request:s}=e;window.__c={n:"RequestTeamspacesCell"};const{teamStores:n}=function(e){let{request:t,spaceStore:s}=e;return{teamStores:(0,a.VK)((()=>{var e,n;const i=ud.Z.state.teams.filter((e=>e.isDefault()));if((null===(e=t.accessRequest.attributes)||void 0===e?void 0:e.origin_table)===Bn.e0&&null!==(n=t.accessRequest.attributes)&&void 0!==n&&n.origin_id){var o;const e=me.zX.createChildStore(s,{table:Bn.e0,id:null===(o=t.accessRequest.attributes)||void 0===o?void 0:o.origin_id});i.includes(e)||i.push(e)}return i}),[t,s])}}({request:s,spaceStore:t});return(0,J.jsx)(Ih,{teamStores:n,from:"member_request"})}var Zh=s(42875);function Fh(e){let{request:t,spaceStore:s}=e;window.__c={n:"RequestUserCell"};const{relativeDate:n,email:i,userStore:o,styles:l}=function(e){let{request:t,spaceStore:s}=e;const n=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:g.Z.fontSize.UIRegular.desktop,gap:10,flex:"1 0 0",maxWidth:50},userAvatar:{},title:{height:17,alignSelf:"stretch",fontSize:g.Z.fontSize.UIRegular.desktop,fontStyle:"normal",fontWeight:510,lineHeight:"18px",maxWidth:160,...g.Z.textOverflowStyle},subtitle:{height:17,alignSelf:"stretch",fontSize:g.Z.fontSize.UISmall.desktop,fontStyle:"normal",fontWeight:400,lineHeight:"15px",color:e.v2.text.secondary,maxWidth:160,...g.Z.textOverflowStyle}})),[]),i=me.U6.createChildStore(s,{table:R.KJ,id:t.forActor.id}),{email:o}=(0,a.VK)((()=>({email:i.getEmail()})),[i]),l=(0,h.useIntl)(),d=Z.CQ(t.latestRequestTime,(0,Zh.r)()),c=(0,Ma.ZV)({value:d,date_format:"relative",userTimeZone:(0,Zh.r)(),intl:l,allowRelativeDates:!0});return{email:o,styles:n,userStore:i,relativeDate:c}}({request:t,spaceStore:s});return(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsx)(Vn.Z,{style:l.userAvatar,userStore:o,size:28}),(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{style:l.title,title:i,children:i}),(0,J.jsx)("div",{style:l.subtitle,title:n,children:n})]})]})}function _h(e){let{spaceStore:t,requests:s,requestType:i}=e;window.__c={n:"PeopleSectionRequestsTable"};const{environment:l,columnRenderInfo:d,tableStyles:u,styles:m,sortState:p,setSortState:g,selectedRowIds:x,setSelectedRowIds:y,pagedRows:S,isDeclineButtonLoading:v,isApproveButtonLoading:b,onClickApprove:M,onClickDecline:j,shouldShowLoadMore:w,requestsCount:C,onLoadMore:k,isTableEmpty:T,shouldHideActions:I}=function(e){let{spaceStore:t,requests:s,requestType:i}=e;const l=(0,a.VK)((()=>"member"===i?[Ah,Rh,Bh,Lh]:[Ah,Dh,Bh,Lh]),[i]),d=(0,r.yK)((e=>({...(0,oe.b)({columnRenderInfo:l,theme:e,containerMarginTop:0})})),[l]),u=(0,r.yK)((e=>({container:{paddingBottom:30},headerContainer:{display:"flex",justifyContent:"space-between"},titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,minHeight:30,paddingTop:10},titleNumber:{color:e.v2.text.tertiary},actionsContainer:{display:"flex",borderRadius:6,border:`1px solid ${e.v2.stroke.regular}`,boxShadow:"0px 2px 12px 0px rgba(29, 27, 22, 0.06)"},actionLeftButton:{borderRadius:"4px 0px 0px 4px",paddingLeft:10,paddingRight:0,height:30},buttonContainerApprove:{display:"flex",padding:"0px 12px 0px 0px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.ui.blue.primary},buttonContainerDecline:{display:"flex",padding:"0px 12px 0px 10px",justifyContent:"center",alignItems:"center",gap:4,alignSelf:"stretch",color:e.v2.text.secondary},buttonIcon:{width:20,height:20,paddingTop:1,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:10},buttonText:{fontSize:14,fontWeight:510},buttonDivider:{width:1,background:e.v2.stroke.deemphasized},actionRightButton:{borderRadius:"0px 4px 4px 0px",paddingLeft:0,paddingRight:0,height:30},noRowContainer:{display:"flex",height:32,padding:"0px 4px",alignItems:"center",borderBottom:`1px solid ${e.v2.stroke.regular}`},noRowText:{color:e.v2.text.secondary,fontSize:14,fontWeight:400,textAlign:"center"}})),[]),[m,p]=(0,n.useState)({column:l[0],sortAscending:!0}),[g,x]=(0,n.useState)([]),y=(0,a.VK)((()=>Zt.state.searchQuery),[]),S=(0,a.VK)((()=>s.map((e=>{const s=me.U6.createChildStore(t,{table:R.KJ,id:e.forActor.id});return{spaceStore:t,request:e,requestType:i,email:s.getEmail(),id:e.accessRequest.id,isClickable:!1,shouldDisableInteraction:g.includes(e.accessRequest.id)}})).filter((e=>{var t;return void 0===y||((null===(t=e.email)||void 0===t?void 0:t.includes(y))??!1)}))),[t,s,g,y,i]),v=S.length,b=(0,a.VK)((()=>function(e,t){let{sortAscending:s}=t;const n=c.MR(e,(e=>e.email));s||n.reverse();return n}(S,m)),[S,m]),[M,j]=(0,n.useState)(5),w=(0,n.useCallback)((()=>{j(M+5)}),[M]),C=M<b.length,k=b.slice(0,M),T=(0,a.VK)((()=>S.filter((e=>g.includes(e.id))).map((e=>e.request))),[g,S]),[I,P]=(0,n.useState)(!1),[Z,F]=(0,n.useState)(!1),_=(0,o.O7)(),A=(0,n.useCallback)((()=>{if(Ng.b4(_,{from:`${i}_request`,button_name:"bulk_approve",count:T.length}),0===T.length)return;F(!0);const e=pi.kk.fromAccessRequest(T[0].accessRequest);e.isGuestInviteRequest()?f.mY({environment:_,requests:T,status:"approved",from:"requests_center",onResolveComplete:(e,t)=>{F(!1),x([]),e.length>0?zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests",defaultMessage:"Approved {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:e.length,userEmail:e[0].email}})}):t.length>0&&zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.guests.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {guest request for {userEmail}} other {{numberOfRequests} guest requests}}, please try again.",values:{numberOfRequests:t.length,userEmail:t[0].email}})})}}):e.isSpaceMembershipRequest()&&f.YN({environment:_,store:t,requests:T,status:"approved",from:"requests_center",onResolveComplete:e=>{F(!1),x([]),e?zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.success",defaultMessage:"Approved {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:T.length,userEmail:T[0].forActor.email}})}):zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkApproveToast.members.failed",defaultMessage:"Failed approve {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:T.length,userEmail:T[0].forActor.email}})})}})}),[T,_,t,i]),D=(0,n.useCallback)((()=>{Ng.b4(_,{from:`${i}_request`,button_name:"bulk_decline",count:T.length}),xh.setState({...xh.state,isModalOpen:!0,requests:T,requestType:i,handleClickDecline:()=>{Ng.b4(_,{from:`${i}_request`,button_name:"confirm_in_dialog",count:T.length});const e=pi.kk.fromAccessRequest(T[0].accessRequest);e.isGuestInviteRequest()?f.mY({environment:_,requests:T,status:"rejected",from:"requests_center",onResolveComplete:(e,t)=>{P(!1),x([]),e.length>0?zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.success",defaultMessage:"Declined {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}",values:{numberOfSuccesses:e.length,userEmail:e[0].email}})}):t.length>0&&zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.guests.failed",defaultMessage:"Failed decline {numberOfSuccesses, plural, one {guest request for {userEmail}} other {{numberOfSuccesses} guest requests}}, please try again.",values:{numberOfSuccesses:t.length,userEmail:t[0].email}})})}}):e.isSpaceMembershipRequest()&&f.YN({environment:_,store:t,requests:T,status:"rejected",from:"requests_center",onResolveComplete:e=>{P(!1),x([]),e?zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.success",defaultMessage:"Declined {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}",values:{numberOfRequests:T.length,userEmail:T[0].forActor.email}})}):zo.oV({label:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionRequestsTable.bulkDeclineToast.members.failed",defaultMessage:"Failed decline {numberOfRequests, plural, one {member request for {userEmail}} other {{numberOfRequests} member requests}}, please try again.",values:{numberOfRequests:T.length,userEmail:T[0].forActor.email}})})}})}})}),[T,_,t,i]),B=0===s.length,L=!S.some((e=>g.includes(e.id)));return{environment:_,columnRenderInfo:l,tableStyles:d,styles:u,sortState:m,setSortState:p,selectedRowIds:g,setSelectedRowIds:x,pagedRows:k,selectedRequests:T,isDeclineButtonLoading:I,isApproveButtonLoading:Z,onClickApprove:A,onClickDecline:D,requestsCount:v,onLoadMore:w,shouldShowLoadMore:C,isTableEmpty:B,shouldHideActions:L}}({spaceStore:t,requests:s,requestType:i});return T?null:(0,J.jsxs)("div",{style:m.container,children:[(0,J.jsxs)("div",{style:m.headerContainer,children:[(0,J.jsxs)("div",{style:m.titleContainer,children:[(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionMembersTab.memberRequests.title",defaultMessage:"Requests"})}),(0,J.jsx)("span",{style:m.titleNumber,children:C})]}),x.length>0&&!I&&(0,J.jsxs)("div",{style:m.actionsContainer,children:[(0,J.jsx)(hh.Z,{style:m.actionLeftButton,onClick:M,isLoading:b,children:(0,J.jsxs)("div",{style:m.buttonContainerApprove,children:[(0,J.jsx)("div",{style:m.buttonIcon,children:(0,gh.M)({width:20,height:20})}),(0,J.jsx)("div",{style:m.buttonText,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkApprove",defaultMessage:"Approve {numberOfRequests, plural, one {1 request} other {{numberOfRequests} requests}}",values:{numberOfRequests:x.length}})})]})}),(0,J.jsx)("div",{style:m.buttonDivider}),(0,J.jsx)(hh.Z,{style:m.actionRightButton,onClick:j,isLoading:v,children:(0,J.jsxs)("div",{style:m.buttonContainerDecline,children:[(0,J.jsx)("div",{style:{...m.buttonIcon,paddingTop:3},children:(0,th.$)({width:20,height:20})}),(0,J.jsx)("div",{style:m.buttonText,children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.peopleSection.requestsTable.bulkDecline",defaultMessage:"Decline"})})]})})]})]}),(0,J.jsx)("div",{style:{marginTop:4},children:(0,J.jsx)(oe.D,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:d,rows:S,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:p,onSortStateChanged:g,renderNoRowsComponent:()=>(0,J.jsx)("div",{style:m.noRowContainer,children:(0,J.jsx)("div",{style:m.noRowText,children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionRequestTable.emptySearch",defaultMessage:"No result."})})}),styles:u,getStyleForRow:e=>{if(e.shouldDisableInteraction)return{backgroundColor:"rgba(35, 131, 226, 0.07)"}},loadMoreType:"button",onLoadMore:w?k:void 0,multiselect:C>0?{header:{isDisabled:0===S.length,isSelected:x.length>0&&x.length===S.length,onClick:()=>{x.length===S.length?(y([]),Ng.pZ(l,{from:`${i}_request`,action:"deselect_all",row_count:x.length})):(y(S.map((e=>e.id))),Ng.pZ(l,{from:`${i}_request`,action:"select_all",row_count:S.length}))}},row:{getDisabledState:e=>!1,getSelectedState:e=>x.includes(e.id),onClick:e=>{y((t=>t.includes(e.id)?(Ng.pZ(l,{from:`${i}_request`,action:"deselect_row",row_count:1}),t.filter((t=>t!==e.id))):(Ng.pZ(l,{from:`${i}_request`,action:"select_row",row_count:1}),t.concat(e.id))))}}}:void 0})}),(0,J.jsx)(Sh,{})]})}const Ah={id:"user",headerTitle:(0,J.jsx)("div",{style:{fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionRequestsTable.user",defaultMessage:"User"})}),renderCell:e=>(0,J.jsx)(Fh,{request:e.request,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},Rh={id:"teamspaces",headerTitle:(0,J.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionRequestsTable.teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,J.jsx)(Ph,{spaceStore:e.spaceStore,request:e.request}),widthData:{width:175},sortable:!1},Dh={id:"pages",headerTitle:(0,J.jsx)("div",{style:{paddingLeft:8,fontSize:14,minWidth:175,textAlign:"left"},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionRequestsTable.pages",defaultMessage:"Access"})}),renderCell:e=>(0,J.jsx)(jh,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction}),widthData:{width:175},sortable:!1},Bh={id:"requestBy",headerTitle:(0,J.jsx)("div",{style:{paddingLeft:8,fontSize:14,minWidth:160,textAlign:"left"},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionRequestsTable.requestBy",defaultMessage:"Requested by"})}),renderCell:e=>(0,J.jsx)(Mh,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType}),widthData:{width:120},sortable:!1},Lh={id:"actions",headerTitle:(0,J.jsx)("div",{style:{minWidth:155}}),renderCell:e=>(0,J.jsx)(yh,{request:e.request,spaceStore:e.spaceStore,shouldDisableInteraction:e.shouldDisableInteraction,requestType:e.requestType}),widthData:{width:100},sortable:!1};var Oh=s(47612),Eh=s(32566);function Nh(e){let{currentTab:t}=e;window.__c={n:"PeopleSectionSecurityBanner"};const s=(0,r.yK)((e=>({container:{display:"flex",width:"100%",padding:8,justifyContent:"flex-start",alignItems:"center",borderRadius:8,background:e.v2.surface.washDesktop},iconContainer:{display:"flex",width:20,height:20,paddingTop:1,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:10},icon:{fontSize:14,fontWeight:510,fill:e.v2.icon.secondary},title:{display:"flex",fontSize:14,fontWeight:500,color:e.v2.text.secondary,paddingLeft:6,paddingRight:2,height:18},ctaIconContainer:{display:"flex",width:16,height:16,paddingTop:1,flexDirection:"column",alignItems:"center",gap:10,paddingLeft:2,paddingRight:0},ctaIcon:{fontSize:12,fill:e.v2.icon.secondary,fontWeight:510}})),[]),i=(0,o.O7)(),a=(0,n.useCallback)((()=>{qe.Z.setState({...qe.Z.state,currentTab:"security",defaultSubtab:void 0}),Ng.kx(i,{current_tab:t})}),[i,t]);return(0,n.useEffect)((()=>{Ng.Ad(i,{current_tab:t})}),[i,t]),(0,J.jsxs)("div",{style:s.container,children:[(0,J.jsx)("div",{style:s.iconContainer,children:(0,Oh.C)(s.icon)}),(0,J.jsx)("div",{style:s.title,children:(0,J.jsx)(h.FormattedMessage,{id:"PeopleSectionSecurityBanner.title",defaultMessage:"Some invite settings have moved, make changes in <bold>Security</bold> tab",values:{bold:e=>(0,J.jsx)("div",{style:{fontWeight:g.Z.fontWeight.semibold,paddingRight:2,paddingLeft:2,cursor:"pointer"},onClick:a,children:e})}})}),(0,J.jsx)(Vt.Z,{style:s.ctaIconContainer,onClick:a,icon:()=>(0,Eh.k)(s.ctaIcon),ignoreLocalHoverState:!0})]})}function Vh(e){let{spaceStore:t,guests:s}=e;window.__c={n:"PeopleSectionGuestsTab"};const n=_t({spaceStore:t}),i=Ug({spaceStore:t}),{requests:o}=Ft({spaceStore:t,requestType:"guest"});return At({requestType:"guest",spaceStore:t}),(0,J.jsxs)(J.Fragment,{children:[n&&i&&(0,J.jsxs)("div",{style:{paddingTop:14},children:[(0,J.jsx)(Nh,{currentTab:"guests"}),(0,J.jsx)(_h,{requests:o,spaceStore:t,requestType:"guest"})]}),(0,J.jsx)(dh,{guests:s,spaceStore:t})]})}function Uh(e){let{spaceStore:t,spacePermissionsSettingsStore:s}=e;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Wh,{}),(0,J.jsx)(Kh,{spaceStore:t,spacePermissionsSettingsStore:s})]})}function Wh(){window.__c={n:"PeopleSettingHeader"};const e=Gh(),t=(0,o.O7)(),s=(0,n.useCallback)((()=>{M.D({environment:t,url:(0,Ze.UY)("guides.invitePerson")})}),[t]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)(et.Z,{large:!0,style:e.headingStyle,children:[(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.people.common.title",defaultMessage:"People"}),(0,J.jsx)(ws.Z,{isSmall:!0,onClick:s,icon:Bo.m,children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSection.title.helpButton",defaultMessage:"Learn more"})})]}),(0,Xe.Um)()]})}function Kh(e){let{spaceStore:t,spacePermissionsSettingsStore:s}=e;window.__c={n:"SpaceInviteLink"};const n=(0,o.O7)(),i=(0,a.VK)((()=>{const e=wt.subscriptionDataStoreInstance.state;return function(e){let{environment:t,spaceStore:s,subscriptionData:n}=e;if(!s.canEditMembership())return;const i=s.id,o=n&&("subscribed_admin"===n.type||"unsubscribed_admin"===n.type||"subscribed_membership_admin"===n.type)&&n.inviteLinkCode;if(!o)return;return(0,Pi.cJ)(t,i,o)}({spaceStore:t,environment:n,subscriptionData:e})}),[t,n]),r=function(e){let{spaceStore:t}=e;const s=(0,o.O7)();return(0,a.VK)((()=>t.canEditMembership()&&Mt.qF(s)),[s,t])}({spaceStore:t}),l=(0,a.VK)((()=>Boolean(t.getInviteLinkEnabled())),[t]),d=Gh();return r&&i?(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{style:d.inviteLinkSection,children:[(0,J.jsxs)("div",{style:{marginRight:8,flexGrow:1},children:[(0,J.jsx)(et.Z,{children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.title",defaultMessage:"Invite link"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.caption.v2",defaultMessage:"Enable a secret link for Workspace Owners and Membership Admins to invite new members."})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:s&&l&&i&&(0,J.jsx)(qh,{spaceStore:t})})]}),(0,J.jsx)("div",{style:{marginTop:28},children:(0,J.jsx)(Ia.Z,{on:l,onClick:()=>{!function(e){let{environment:t,spaceStore:s,inviteLinkEnabled:n}=e;const i=!n;y.eoz(t,{enabled:i}),I.createAndCommit({userAction:"SpacePermissionsSettings.handleInviteLinkClick",environment:t,perform:e=>{j.ys({transaction:e,spaceStore:s,inviteLinkEnabled:Boolean(i)})}})}({environment:n,spaceStore:t,inviteLinkEnabled:l})}})})]}),s&&l&&i&&(0,J.jsx)(zh,{inviteLinkUrl:i}),(0,J.jsx)(Ms.Z,{size:40})]}):null}function zh(e){let{inviteLinkUrl:t}=e;window.__c={n:"InviteLinkUrl"};const s=(0,r.yK)((e=>({input:{height:32,padding:"0px 4px 0px 8px",alignItems:"center",gap:"8px",flex:"1 0 0",borderRadius:"6px",border:e.v2.stroke.deemphasized,background:e.v2.surface.wash},button:{display:"flex",height:"32px",padding:"0px 12px",justifyContent:"center",alignItems:"center",borderRadius:"6px",border:`1px solid ${e.v2.stroke.regular}`,paddingLeft:12,paddingRight:12},buttonText:{fontSize:"14px",fontWeight:"510",lineHeight:"18px",textAlign:"center",fontStyle:"normal",color:e.v2.text.primary}})),[]),n=(0,o.O7)();return(0,J.jsx)("div",{children:(0,J.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",alignSelf:"stretch",paddingBottom:"0px"},children:[(0,J.jsx)(no.Z,{type:"text",format:no.B.Default,value:t,disabled:!0,style:s.input}),(0,J.jsx)(ae.Z,{onClick:()=>{!function(e){let{environment:t,inviteLinkUrl:s}=e;ie.RD({environment:t,stringValue:s,copiedMessage:ie.tq.copiedLinkToClipboard}),y.nlj(t)}({environment:n,inviteLinkUrl:t})},style:s.button,children:(0,J.jsx)("div",{style:s.buttonText,children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.spaceMembers.inviteLink.copyButton",defaultMessage:"Copy link"})})})]})})}function qh(e){let{spaceStore:t}=e;window.__c={n:"InviteLinkReset"};const s=(0,o.O7)();return(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionSettings.spaceMembers.inviteLink.resetLink.v2",defaultMessage:"You can also <resetlink>generate a new link</resetlink>",values:{resetlink:e=>(0,J.jsx)(js.Z,{onClick:()=>{v.showDialog({message:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.description",defaultMessage:"Are you sure you want to reset the invite link for all space members? Your old one will no longer be able to be used."}),showCancel:!0,keepFocus:!1,handleCancel:v.dismissDialog,items:[{label:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.inviteLinkRefreshModal.accept",defaultMessage:"Reset"}),color:"red",onAccept:async()=>{await C.refreshInviteLink(s,{spaceId:t.id}),Qe.bi(s)}}]})},children:e})}})}function Gh(){return(0,r.yK)((e=>({commonTitle:{display:"flex",alignItems:"center"},commonTitleText:{fontSize:"17px",lineHeight:"22px",fontWeight:590,color:e.v2.text.primary,fontStyle:"normal"},commonHelpButton:{paddingLeft:"1px"},inviteLinkSection:{paddingTop:"16px",paddingBottom:"16px",display:"flex",alignItems:"flex-start"},headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:g.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"}})),[])}var Hh=s(24665);function Qh(e){let{user:t,spaceStore:s,shouldDisableAction:i}=e;window.__c={n:"MemberActionsCell"};const{styles:l,handleRemoveMemberFromWorkspace:d,environment:c,isCurrentUser:u}=function(e){let{user:t,spaceStore:s}=e;const i=(0,r.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},upgradeButton:{},removeMenuDivider:{borderTop:e.v2.stroke.deemphasized},removeButton:{color:Hg.Lr[e.mode].red},upgradeIcon:{width:17,height:17}})),[]),l=(0,o.O7)(),d=(0,n.useCallback)((async()=>{const{currentUserSettingsStore:e}=_e.default.state;return e?await(0,Hh.$A)({user:t,spaceStore:s,environment:l,userSettingStore:e}):()=>{}}),[s,l,t]),c=(0,a.VK)((()=>{var e;return(null===(e=_e.default.state.currentUserStore)||void 0===e?void 0:e.id)===t.userId}),[t]);return{styles:i,handleRemoveMemberFromWorkspace:d,environment:l,isCurrentUser:c}}({user:t,spaceStore:s});return(0,J.jsx)("div",{style:l.container,children:(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,renderOrigin:e=>(0,J.jsx)(Vt.Z,{style:l.button,...e,children:(0,J.jsx)(J.Fragment,{children:(0,$g.O)(l.buttonIcon)})}),onClick:()=>{Ng.b4(c,{from:"member",button_name:"actions"})},disabled:i,render:()=>(0,J.jsx)("div",{children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[{key:"remove",render:e=>(0,J.jsx)(sn.Z,{...e,style:l.removeMenuDivider}),items:[{key:"remove",render:e=>(0,J.jsx)($s.Z,{...e,buttonStyle:l.removeButton,icon:(0,Yg.ISU)(l.upgradeIcon),title:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionmembersTab.removeMember",defaultMessage:"{isCurrentUser, select, true {Leave workspace} other {Remove from workspace}} ",values:{isCurrentUser:u}})}),action:async()=>{await d(),Ng.b4(c,{from:"member",button_name:"remove"})}}]}]})})})})}var Yh=s(16639);function $h(e){let{shouldShowSearchHeader:t,sections:s,filterPlaceholder:i}=e;window.__c={n:"SearchableMenuItems"};const a=(0,o.O7)(),[r,l]=(0,n.useState)(""),d=r,c=(0,J.jsx)(sn.Z,{isInput:!0,children:(0,J.jsx)(Zc.ZP,{value:d,onChange:(0,n.useCallback)((e=>{l(e.target.value)}),[]),focus:!0,focusAfterAnimation:!0,placeholder:i&&B.default.formatMessage(i)})}),u={menuType:Hs.og.Popup,maxWidth:350,maxHeight:300,header:t?c:void 0};return(0,J.jsx)(Xs.Z,{...u,children:(0,J.jsx)(Ch.Z,{filter:d,context:{blocks:[],environment:a,publicEditMode:void 0},initialFocus:0,sections:s})})}const Jh=(0,h.defineMessages)({filterGroups:{defaultMessage:"Filter groups...",id:"GroupPopupContent.filterGroups"}});function Xh(e){let{groups:t,spaceStore:s,spacePermissionsSettingsStore:n}=e;window.__c={n:"GroupsPopupContent"};const i=(0,a.VK)((()=>t.map((e=>({group:e,numberOfGroupMembers:(0,Yh.kQ)({group:e,spaceStore:s}).length})))),[t,s]),o=(0,r.yK)((e=>({buttonTitle:{display:"flex",padding:"4px 6px 4px 8px",alignItems:"flex-start",gap:8,alignSelf:"stretch"},groupName:{color:e.v2.text.primary,fontSize:14},groupMemberCount:{color:e.v2.text.secondary,fontSize:12}})),[]),l=t.length>5;return(0,J.jsx)($h,{shouldShowSearchHeader:l,sections:[{key:"groups for member",render:e=>(0,J.jsx)(sn.Z,{...e}),actions:i.map((e=>{const{group:t,numberOfGroupMembers:i}=e;return{key:t.id,displayName:t.name,analyticsName:t.name??"unknown group",searchName:t.name,render:e=>(0,J.jsx)($s.Z,{style:{padding:4},textWrapperStyle:{marginLeft:0,marginRight:0},title:(0,J.jsxs)("div",{style:o.buttonTitle,children:[(0,J.jsx)(In.Z,{disabled:!0,bucket:"public",icon:t.icon?{pointer:s.pointer,icon:t.icon}:void 0,size:20,isEmptyPage:!1,title:t.name}),(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{style:o.groupName,children:t.name}),(0,J.jsx)("div",{style:o.groupMemberCount,children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.userGroup.memberCount",defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} member} other {{numberOfGroupMembers} members}}",values:{numberOfGroupMembers:i}})})]})]}),...e}),action:()=>{n.setState({...n.state,currentTab:fu.Q.Groups})},closeParentMenu:!1}}))}],filterPlaceholder:Jh.filterGroups})}function ef(e){let{user:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;window.__c={n:"UserGroupsCell"};const{styles:l,groups:d,numberOfGroups:c,firstGroupName:u,onClick:m}=function(e){let{user:t,spaceStore:s}=e;const i=(0,a.VK)((()=>s.getPermissionGroups().filter((e=>(0,Yh.kQ)({group:e,spaceStore:s}).includes(t.userId)))),[s,t.userId]),l=(0,o.O7)(),d=(0,n.useCallback)((()=>{Ng.b4(l,{from:"member",button_name:"open_groups"})}),[l]),c=(0,r.yK)((e=>({button:{marginRight:8},noGroups:{marginRight:8,color:e.lightTextColor},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},noneGroupText:{color:e.v2.text.tertiary},groupNameText:{color:e.v2.text.secondary,maxWidth:100,...g.Z.textOverflowStyle},groupNumberText:{color:e.v2.text.secondary}})),[]),u=(0,h.useIntl)(),m=i.length,p=m>0?(0,Yh.kF)({group:i[0],intl:u}):void 0;return{styles:c,groups:i,numberOfGroups:m,firstGroupName:p,onClick:d}}({user:t,spaceStore:s});return(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,onClick:m,renderOrigin:e=>(0,J.jsx)(Vt.Z,{disabled:0===c,style:0===c?l.noGroups:l.button,...e,children:0===c?(0,J.jsx)("span",{style:l.noneGroupText,children:(0,J.jsx)(h.FormattedMessage,{id:"userGroupsCell.noGroups",defaultMessage:"None"})}):1===c?(0,J.jsx)("span",{style:l.groupNameText,title:u,children:u}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:l.groupNumberText,children:c}),(0,gd.i)(l.chevron)]})}),render:()=>(0,J.jsx)(Xh,{groups:d,spaceStore:s,spacePermissionsSettingsStore:i})})})}var tf=s(7567);function sf(e){let{user:t,spaceStore:s}=e;window.__c={n:"UserAccessLevelButton"};const n=(0,r.yK)((e=>({button:{color:e.v2.text.secondary}})),[]),i=(0,o.O7)(),{isPermissionSelectDisabled:l,currentUserId:d}=(0,a.VK)((()=>{let e=!0;return(s.canAdmin()||s.canEditMembership()&&(_n.RN(t.role)||t.userId===i.currentUser.id))&&(e=!1),{isPermissionSelectDisabled:e,currentUserId:i.currentUser.id}}),[s,i,t.role,t.userId]),u=(0,a.VK)((()=>_e.default.state.currentUserSettingsStore),[]),m=(0,h.useIntl)(),p=(0,a.VK)((()=>{const e=m.formatMessage({id:"spacePermissionSettings.memberRoleSelect.permissionitem.roleUpgradeDisabled",defaultMessage:"Cannot upgrade to a higher role than member"}),t="enterprise"===s.getSubscriptionTier();return c.oA(_n.an.filter((e=>"none"!==e)).map((n=>{if(t||"membership_admin"!==n)return{role:n,disabledInfo:!s.canAdmin()&&_n.Bc(n)?{isDisabled:!0,disabledMessage:e}:void 0}})))}),[m,s]);return u?(0,J.jsx)(tf.ZP,{role:t.role,table:wi.bx,type:"user_permission",disabled:l,isUserPermission:t.userId===d,upgradeButtonName:"space_permission_item",availableRoleItems:p,buttonStyle:n.button,onChange:async e=>{await Hh.Vu({member:t,newRole:e,currentUserSettingsStore:u,spaceStore:s,environment:i})},onClick:()=>{Ng.b4(i,{from:"member",button_name:"open_role"})}}):null}function nf(e){let{user:t,spaceStore:s}=e;return(0,J.jsx)("div",{style:{maxWidth:118.5},children:(0,J.jsx)(sf,{user:t,spaceStore:s})})}function of(e){let{user:t}=e;window.__c={n:"UserTeamspacesCell"};const{userTeamStores:s}=function(e){let{user:t}=e;return{userTeamStores:(0,a.VK)((()=>ud.Z.state.teams.filter((e=>e.getMembers().some((e=>"user"===e.entity_type&&e.user_id===t.userId))))),[t.userId])}}({user:t});return(0,J.jsx)(Ih,{teamStores:s,from:"member"})}function af(e){let{members:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;window.__c={n:"PeopleSectionMembersTable"};const{tableStyles:o,styles:l,sortState:d,setSortState:u,rows:m,membersCount:p,searchQuery:g,columnRenderInfo:f,shouldShowRequest:x,shouldShowLoadMore:y,onLoadMore:S}=function(e){let{members:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;const o=Wg({spaceStore:s}),l=(0,a.VK)((()=>s.canAdmin()),[s]),d=(0,a.VK)((()=>o?[rf,lf,df,cf,uf]:[rf,lf,df,cf]),[o]),u=(0,r.yK)((e=>({...(0,oe.b)({columnRenderInfo:d,theme:e,containerMarginTop:0})})),[d]),m=(0,r.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:"14px",fontStyle:"normal",fontWeight:510,height:32},titleNumber:{color:e.v2.text.tertiary},emptyMessage:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),[p,g]=(0,n.useState)({column:cf,sortAscending:!1}),f=(0,h.useIntl)(),x=(0,a.VK)((()=>Zt.state.searchQuery),[]),y=(0,a.VK)((()=>t.map((e=>{const t=me.U6.createChildStore(s,{table:R.KJ,id:e.userId});return{spaceStore:s,user:e,email:t.getEmail(),userName:t.getDisplayName(f),id:e.userId,isClickable:!1,userRole:e.role,spacePermissionsSettingsStore:i,shouldDisableAction:!(l||!o||"editor"!==e.role&&"membership_admin"!==e.role)}})).filter((e=>{var t,s;return void 0===x||(((null===(t=e.email)||void 0===t?void 0:t.includes(x))||(null===(s=e.userName)||void 0===s?void 0:s.includes(x)))??!1)}))),[s,t,f,x,l,o,i]),S=y.length,v=(0,a.VK)((()=>function(e,t){let{sortAscending:s,column:n}=t,i=e;switch(n.id){case"user":i=c.MR(e,(e=>e.email));break;case"roles":i=c.MR(e,(e=>_n.xm[e.userRole]))}s||i.reverse();return i}(y,p)),[y,p]),b=_t({spaceStore:s}),[M,j]=(0,n.useState)(10),w=(0,n.useCallback)((()=>{j(M+10)}),[M]),C=M<v.length,k=v.slice(0,M);return{tableStyles:u,styles:m,sortState:p,setSortState:g,rows:k,searchQuery:x,membersCount:S,columnRenderInfo:d,shouldShowRequest:b,onLoadMore:w,shouldShowLoadMore:C}}({members:t,spaceStore:s,spacePermissionsSettingsStore:i});return(0,J.jsxs)(J.Fragment,{children:[x&&(0,J.jsxs)("div",{style:l.titleContainer,children:[(0,J.jsx)("span",{children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionMembersTab.activeMembers.title",defaultMessage:"Active"})}),(0,J.jsx)("span",{style:l.titleNumber,children:p})]}),(0,J.jsx)("div",{style:{marginTop:x?4:-1},children:(0,J.jsx)(oe.D,{allowHorizontalScroll:!0,setStickyHeaderRow:!0,columnRenderInfo:f,rows:m,showRowBorders:!0,hideHeaderRowPadding:!0,sortState:d,onSortStateChanged:u,loadMoreType:"button",onLoadMore:y?S:void 0,renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:l.emptyMessage,children:g?(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionMembersTab.emptySearch",defaultMessage:"No search results."}):(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionMembersTab.emptyRow",defaultMessage:"No members."})}),styles:o})})]})}const rf={id:"user",headerTitle:(0,J.jsx)("div",{style:{fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionMembersTab.user",defaultMessage:"User"})}),renderCell:e=>(0,J.jsx)(lh,{userId:e.user.userId,spaceStore:e.spaceStore}),widthData:{width:219},sortable:!0},lf={id:"teamspaces",headerTitle:(0,J.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"teamspaces",defaultMessage:"Teamspaces"})}),renderCell:e=>(0,J.jsx)(of,{user:e.user}),widthData:{width:175},sortable:!1},df={id:"groups",headerTitle:(0,J.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"groups",defaultMessage:"Groups"})}),renderCell:e=>(0,J.jsx)(ef,{user:e.user,spaceStore:e.spaceStore,spacePermissionsSettingsStore:e.spacePermissionsSettingsStore}),widthData:{width:118.5},sortable:!1},cf={id:"roles",headerTitle:(0,J.jsx)("div",{style:{paddingLeft:8,fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"role",defaultMessage:"Role"})}),renderCell:e=>(0,J.jsx)(nf,{user:e.user,spaceStore:e.spaceStore}),widthData:{width:118.5},sortable:!0},uf={id:"actions",headerTitle:(0,J.jsx)(J.Fragment,{}),renderCell:e=>(0,J.jsx)(Qh,{user:e.user,spaceStore:e.spaceStore,shouldDisableAction:e.shouldDisableAction}),widthData:{width:51},sortable:!1};function mf(e){let{spaceStore:t,members:s,spacePermissionsSettingsStore:n}=e;window.__c={n:"PeopleSectionMembersTab"};const i=_t({spaceStore:t}),o=Ug({spaceStore:t}),{requests:a}=Ft({spaceStore:t,requestType:"member"});return At({requestType:"member",spaceStore:t}),(0,J.jsxs)(J.Fragment,{children:[i&&(0,J.jsxs)("div",{style:{paddingTop:14},children:[o&&(0,J.jsx)(Nh,{currentTab:"members"}),(0,J.jsx)(_h,{requests:a,spaceStore:t,requestType:"member"})]}),(0,J.jsx)(af,{members:s,spaceStore:t,spacePermissionsSettingsStore:n})]})}var pf=s(51221),gf=s(83890);function hf(e){let{recentRecoverableUser:t,spaceStore:s}=e;const{environment:i,styles:a,handleReprovisionToUserChange:l,userId:d,selectedTransferToUser:c}=function(e){let{recentRecoverableUser:t,spaceStore:s}=e;window.__c={n:"UseReprovisioningActionData"};const i=(0,r.yK)((e=>({container:{display:"flex",width:"100%",justifyContent:"flex-end"},button:{display:"flex",width:24,height:24,justifyContent:"center",alignItems:"center",gap:10,paddingLeft:0,paddingRight:0},buttonIcon:{width:20,height:20,fill:e.v2.icon.secondary},removeMenuDivider:{borderTop:e.v2.stroke.deemphasized},upgradeIcon:{width:17,height:17}})),[]),a=(0,o.O7)(),[l,d]=(0,n.useState)(),c=(0,n.useCallback)((async(e,n)=>{if(!(await v.confirmUserAction({message:(0,J.jsx)("span",{children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmationMessage",defaultMessage:"Are you sure you want to transfer their private pages? This action cannot be undone."})}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.reprovisionPrivatePagesConfirmationDialog.confirmButton.label",defaultMessage:"Transfer private pages"})})))return;d(n);const i=await C.transferSpaceUserContent(a,{spaceId:s.id,fromUserId:e,toUserId:n});"failed"===i.type?v.showError(i):(t.privatePagesCount=0,Zt.setState({...Zt.state,recentRecoverableUsers:[...Zt.state.recentRecoverableUsers.filter((t=>t.userId!==e)),t]}))}),[a,s,t]);return{environment:a,styles:i,handleReprovisionToUserChange:c,userId:t.userId,selectedTransferToUser:l}}({recentRecoverableUser:t,spaceStore:s});return d?(0,J.jsx)("div",{style:a.container,children:(0,J.jsx)(Sn.ZP,{popupType:Sn.Z4.Popup,onClick:()=>{Ng.b4(i,{from:"recently_left",button_name:"actions"})},renderOrigin:e=>(0,J.jsx)(Vt.Z,{style:a.button,...e,children:(0,J.jsx)(J.Fragment,{children:(0,$g.O)(a.buttonIcon)})}),render:()=>(0,J.jsx)("div",{children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:void 0,sections:[{key:"transfer",render:e=>(0,J.jsx)(sn.Z,{...e,style:a.removeMenuDivider}),items:[{key:"transfer",render:e=>(0,J.jsx)(gf.Z,{mode:Q.z.Button,focused:!1,title:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.reprovision.toUser.title",defaultMessage:"Transfer private pages"}),parentStore:s,userIds:c?[c]:[],onChange:e=>{let[t]=e;l(d,t)}}),action:()=>{Ng.b4(i,{from:"recently_left",button_name:"open_transfer_ownership"})}}]}]})})})}):null}function ff(e){let{spaceStore:t,recentRecoverableUsers:s}=e;return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(pf.Z,{icon:Us.D,title:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionReprovisioningTab.settingsDeeplinkBannerTitle",defaultMessage:"People left the workspace in the past 30 days and had private pages appear here"}),deeplinkTab:void 0}),(0,J.jsx)(xf,{recentRecoverableUsers:s,spaceStore:t})]})}function xf(e){let{spaceStore:t,recentRecoverableUsers:s}=e;window.__c={n:"ReprovisioningTable"};const{rows:i,sortState:o,setSortState:l,tableStyles:d}=function(e){let{recentRecoverableUsers:t,spaceStore:s}=e;const i=(0,r.yK)((e=>(0,oe.b)({columnRenderInfo:Sf,theme:e,containerMarginTop:0})),[]),[o,l]=(0,n.useState)({column:Sf[0],sortAscending:!0});return{rows:(0,a.VK)((()=>t.map((e=>{const t=me.U6.createChildStore(s,{table:R.KJ,id:e.userId});return{spaceStore:s,reprovisioningUser:e,email:t.getEmail(),id:e.userId,isClickable:!1}}))),[s,t]),sortState:o,setSortState:l,tableStyles:i}}({recentRecoverableUsers:s,spaceStore:t});return(0,J.jsx)("div",{style:{marginTop:4},children:(0,J.jsx)(oe.D,{setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Sf,rows:vf(i,o),showRowBorders:!0,hideHeaderRowPadding:!0,sortState:o,onSortStateChanged:l,renderNoRowsComponent:()=>(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionReprovisioningTab.noUser",defaultMessage:"No recent left user."})}),styles:d})})}function yf(e){let{userLeftTime:t}=e;window.__c={n:"UserLeftTimeCell"};const s=(0,h.useIntl)(),n=(0,a.VK)((()=>{const e=Z.CQ(t,(0,Zh.r)());return(0,Ma.ZV)({value:e,date_format:"relative",userTimeZone:(0,Zh.r)(),intl:s,allowRelativeDates:!0})}),[t,s]);return(0,J.jsx)(le.Z,{isSmall:!0,children:n})}const Sf=[{id:"user",headerTitle:(0,J.jsx)("div",{style:{fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{id:"peopleSectionReprovisioningTab.user",defaultMessage:"User"})}),renderCell:e=>(0,J.jsx)(lh,{userId:e.reprovisioningUser.userId,spaceStore:e.spaceStore}),widthData:{width:220},sortable:!0},{id:"pageCount",headerTitle:(0,J.jsx)("div",{style:{fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Private pages",id:"peopleSectionReprovisioningTab.privatePages"})}),renderCell:e=>(0,J.jsx)(le.Z,{isSmall:!0,children:e.reprovisioningUser.privatePagesCount}),widthData:{width:100},sortable:!1},{id:"leftTime",headerTitle:(0,J.jsx)("div",{style:{fontSize:14},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Left workspace",id:"peopleSectionReprovisioningTab.leftTime"})}),renderCell:e=>(0,J.jsx)(yf,{userLeftTime:e.reprovisioningUser.userLeftTime}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:"",renderCell:e=>(0,J.jsx)(hf,{recentRecoverableUser:e.reprovisioningUser,spaceStore:e.spaceStore}),widthData:{width:100},sortable:!1}];function vf(e,t){let{sortAscending:s}=t;const n=c.MR(e,(e=>e.email));return s||n.reverse(),n}var bf=s(49019),Mf=s(12534);function jf(e){let{handleSearchQueryChange:t,currentTab:s}=e;window.__c={n:"AnimatedSearchButton"};const{styles:i,isSearchOpen:a,intl:l,handleSearchButtonClick:d,handleSearchDismiss:c,searchQuery:u,setSearchQuery:m}=function(e){let{handleSearchQueryChange:t,currentTab:s}=e;const i=(0,r.yK)((e=>({searchIcon:{width:14,height:void 0,fill:e.mediumTextColor},topbarIconButton:{display:"flex",alignItems:"center",fontSize:14,height:28,width:28,padding:6,color:e.mediumTextColor,fill:e.mediumIconColor,fontWeight:g.Z.fontWeight.regular,lineHeight:1,borderRadius:4},searchInput:{fontSize:14,lineHeight:1,paddingRight:4,color:e.regularTextColor,marginBottom:1}})),[]),a=(0,o.O7)(),[l,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(void 0),m=(0,n.useCallback)((()=>{d(!0),Ng.RP(a,{current_tab:s})}),[a,s]),p=(0,n.useCallback)((()=>{d(!1),u(void 0),t(void 0)}),[t]),f=(0,h.useIntl)();return{styles:i,isSearchOpen:l,intl:f,handleSearchButtonClick:m,handleSearchDismiss:p,searchQuery:c,setSearchQuery:u}}({handleSearchQueryChange:t,currentTab:s});return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(vn.Z,{ariaLabel:l.formatMessage({id:"searchPlaceholder",defaultMessage:"Type to search..."}),icon:bf.e,iconStyle:i.searchIcon,style:i.topbarIconButton,onClick:d}),(0,J.jsx)(Ca.Z,{isVisible:a,animationStyle:{width:150,opacity:1},enterAnimationStyle:{width:0,opacity:0},exitAnimationStyle:{width:0,opacity:0},render:()=>(0,J.jsx)(Mo.Z,{capture:a,allowEsc:!0,render:e=>(0,J.jsx)("div",{...e,children:(0,J.jsx)("div",{style:{display:"flex",alignItems:"center",overflow:"hidden"},children:(0,J.jsx)(no.Z,{style:i.searchInput,format:no.B.Transparent,value:u,onChange:e=>{const s=e.target.value;m(s),t(s)},placeholder:l.formatMessage({id:"searchPlaceholder",defaultMessage:"Type to search..."}),focusInitial:a,showClearButton:!0,onCancel:c,onClick:Mf.Wi,onClearButtonClick:c,onKeyDown:e=>{27===e.keyCode&&c()},onBlur:()=>{!u&&c()}})})})})})]})}var wf=s(13296);function Cf(e){let{spaceStore:t,guests:s}=e;window.__c={n:"DownloadGuestListButton"};const{styles:i,shouldEnableExportGuests:l,handleExportGuestsClick:d}=function(e){let{spaceStore:t,guests:s}=e;const i=(0,r.yK)((e=>({button:{display:"flex",width:28,height:28,justifyContent:"center",gap:10,alignItems:"center"},buttonIcon:{width:20,height:20,fontSize:16,fontStyle:"normal",flexDirection:"column",flexShrink:0,fontWeight:510,fill:e.v2.icon.secondary}})),[]),l=(0,a.VK)((()=>{const{currentSpaceStore:e}=_e.default.state,t=wt.subscriptionDataStoreInstance.state;return Boolean(e&&t&&"subscribed_admin"===t.type&&ce.default.checkGate("enable_guest_export"))}),[]),d=(0,o.O7)(),c=(0,h.useIntl)(),u=(0,n.useCallback)((()=>{const e=wt.subscriptionDataStoreInstance.state;t&&e&&"subscribed_admin"===e.type&&Bs.Mj(d,{intl:c,spaceStore:t,guests:s})}),[s,d,c,t]);return{styles:i,shouldEnableExportGuests:l,handleExportGuestsClick:u}}({spaceStore:t,guests:s});return l?(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(re.ZP,{render:e=>(0,J.jsx)(Vt.Z,{style:i.button,onClick:d,...e,children:(0,wf.z)(i.buttonIcon)}),renderTooltip:()=>(0,J.jsx)(h.FormattedMessage,{id:"exportGuestsButton.label",defaultMessage:"Export guests as CSV"})})}):null}var kf=s(92625),Tf=s(35691),If=s(29825);function Pf(e){let{spaceStore:t}=e;window.__c={n:"SpaceSettingsInviteButton"};const{shouldShowRequestMemberButtion:s,canEditMembership:i}=(0,a.VK)((()=>({shouldShowRequestMemberButtion:!t.canEditMembership()&&!t.getDisableMembershipRequests()&&(0,de.p1)(),canEditMembership:t.canEditMembership()})),[t]),r=(0,a.VK)((()=>{const e=wt.subscriptionDataStoreInstance.state;return Boolean(e&&Mt.YK(e))}),[]),{isMobile:l}=(0,o.Fy)(),d=(0,a.VK)((()=>(0,Tf.shouldEnableSlackImportsInvite)({canEditPermission:i,isMobile:l,subscriptionTier:(0,jt.zt)()})),[i,l]),c=(0,n.useCallback)((()=>{const e=(0,h.defineMessages)({updatingPermissions:{id:"spacePermissionsSettings.updatePermissionsMessage",defaultMessage:"Updating…"}});kf.j({message:e.updatingPermissions})}),[]),u=(0,n.useCallback)((()=>{kf.x()}),[]),m=(0,o.O7)(),p=(0,n.useCallback)((()=>{Ng.L7(m,{type:"request"})}),[m]);return s?(0,J.jsx)(If.Z,{store:t,analyticsFrom:"space_settings_add_members",origin:(0,J.jsx)(Ws.Z,{isLarge:!0,onClick:p,children:(0,J.jsx)(h.FormattedMessage,{id:"inviteUserButton.requestMemberLabel",defaultMessage:"Add members"})})}):(0,J.jsx)(L.LazyPermissionsInviteWithModal,{disabled:!i,store:t,onInviteClick:c,onInviteComplete:u,isSubscribed:r,membersOnly:!1,upgradeButtonName:"space_permission_settings",shouldGrow:!1,enableInviteDropdown:d})}function Zf(e){let{spaceStore:t,guests:s,currentTab:i,spacePermissionsSettingsStore:o}=e;return window.__c={n:"PeopleSectionTabsRightContent"},(0,n.useEffect)((()=>()=>{Zt.reset()}),[]),(0,J.jsxs)("div",{style:{display:"flex",height:34,paddingBottom:0,justifyContent:"flex-end",alignItems:"center",gap:10},children:[(0,J.jsxs)("div",{style:{display:"flex",height:28,justifyContent:"flex-end",alignItems:"center",gap:4},children:[(0,J.jsx)(jf,{handleSearchQueryChange:e=>{Zt.setState({...Zt.state,searchQuery:e}),i===fu.Q.Groups&&o.setState({...o.state,groupsFilter:e??""})},currentTab:i}),i===fu.Q.Guests?(0,J.jsx)(Cf,{spaceStore:t,guests:s}):null]}),(0,J.jsx)("div",{style:{paddingBottom:2},children:(0,J.jsx)(Ff,{spaceStore:t,currentTab:i,spacePermissionsSettingsStore:o})})]})}function Ff(e){let{spaceStore:t,currentTab:s,spacePermissionsSettingsStore:i}=e;window.__c={n:"SpaceSettingsButton"};const{canUseGroups:r,canCreateGroups:l,handleCreateGroupClick:d,shouldShowRequestMemberButtion:c,canEditMembership:u}=function(e){let{spaceStore:t,currentTab:s,spacePermissionsSettingsStore:i}=e;const r=Kg(),l=Wg({spaceStore:t}),d=(0,o.O7)(),c=(0,n.useCallback)((()=>{I.createAndCommit({userAction:"PeopleSectionGroupsTab.handleCreateGroupClick",environment:d,perform:e=>{const s=j.mo({environment:d,spaceStore:t,transaction:e});s&&i.setState({...i.state,editingNameGroupId:s.id,groupNameInputValue:""})}})}),[d,t,i]),u=(0,a.VK)((()=>!t.canEditMembership()&&!t.getDisableMembershipRequests()&&(0,de.p1)()),[t]),m=Wg({spaceStore:t});return{canUseGroups:r,canCreateGroups:l,shouldShowRequestMemberButtion:u,canEditMembership:m,handleCreateGroupClick:c}}({spaceStore:t,currentTab:s,spacePermissionsSettingsStore:i});return s===fu.Q.Groups&&r?l?(0,J.jsx)(re.ZP,{renderTooltip:()=>!l&&(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.groupCreationInsufficientPermissions",defaultMessage:"Only membership admins and workspace owners can add a permission group."}),render:e=>(0,J.jsx)(Ws.Z,{isLarge:!0,onClick:d,...e,children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.groupsTab.createGroupButton.label",defaultMessage:"Create a group"})})}):null:c||u?(0,J.jsx)(Pf,{spaceStore:t}):null}function _f(){window.__c={n:"SpaceSettingsPeopleSection"};const e=(0,a.VK)((()=>{const e=_e.default.state.currentSpaceStore;if(null!=e&&e.isDefined())return e}),[]),t=(0,a.VK)((()=>zt.Z.state.online),[]),s=(0,a.VK)((()=>wt.subscriptionDataStoreInstance.state),[]),n=(0,a.qz)(void 0,fu.Z);return e&&s?t?(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(Uh,{spaceStore:e,spacePermissionsSettingsStore:n}),(0,J.jsx)(Rf,{subscriptionData:s,spaceStore:e,spacePermissionsSettingsStore:n})]}):(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})})}):(0,J.jsx)(Af,{})}function Af(){return(0,J.jsx)(Es.Z,{style:{margin:"calc(50% - 1em) auto"}})}function Rf(e){let{subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:i}=e;window.__c={n:"PeopleSectionContent"},(0,n.useEffect)((()=>{if(qe.Z.state.open&&"members"===qe.Z.state.currentTab&&qe.Z.state.defaultSubtab){const e=qe.Z.state.defaultSubtab!==fu.Q.Requests?qe.Z.state.defaultSubtab:fu.Q.Members;i.setState({...i.state,currentTab:e})}}),[i]);const{visibleUsersLoaded:l,members:d,guests:u,groups:m,recentRecoverableUsers:p,currentTab:g,canReprovisionContent:f,tabs:x,currentTabs:y,environment:S}=function(e){let{subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:n}=e;const{visibleUsersLoaded:i,members:l,guests:d,numberOfGuests:u}=(0,a.VK)((()=>{const e=Mt.CM(t);return{visibleUsersLoaded:c.yW(e.map((e=>me.U6.createChildStore(s,{table:R.KJ,id:e.userId}).isReady()))),members:e.filter(mu.CF),guests:e.filter(mu.du),numberOfGuests:e.filter(mu.du).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length}}),[t,s]),m=(0,a.VK)((()=>s.getPermissionGroups()),[s]);!function(e){let{spaceStore:t,subscriptionData:s}=e;const n=Vg({spaceStore:t,subscriptionData:s}),i=(0,o.O7)();(0,Tt.r5)((async()=>{if(!n)return;const e=await C.getRecoverableSpaceUserContent(i,{spaceId:t.id});if("failed"===e.type)throw v.showError(e),e;const s=e.data.recentSpaceRecoverPages;return Zt.setState({...Zt.state,recentRecoverableUsers:s}),s}),[t,i,n])}({spaceStore:s,subscriptionData:t});const p=(0,a.VK)((()=>{const{recentRecoverableUsers:e}=Zt.state;return e.filter((e=>e.privatePagesCount>0))}),[]),g=(0,a.VK)((()=>n.state.currentTab),[n]),f=Vg({spaceStore:s,subscriptionData:t}),{unreadMemberRequestsCount:x,unreadGuestRequestsCount:y}=(0,a.VK)((()=>Zt.state),[]),S=(0,o.O7)(),b=(0,r.yK)((e=>({activeTabStyle:{color:e.regularTextColor},inactiveTabStyle:{color:e.lightTextColor},redDot:{background:e.redBadgeBackground,marginLeft:6,marginTop:6}})),[]),M=(0,a.VK)((()=>l?{[fu.Q.Members]:(0,J.jsx)(Lf,{text:(0,J.jsx)("div",{children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.membersTab.title",defaultMessage:"Members"})}),number:l.length,isCurrentTab:g===fu.Q.Members,styles:b,unread:x>0}),[fu.Q.Guests]:(0,J.jsx)(Lf,{text:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.guestsTab.title",defaultMessage:"Guests"}),number:u,isCurrentTab:g===fu.Q.Guests,styles:b,unread:y>0}),[fu.Q.Groups]:(0,J.jsx)(Lf,{text:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.groupsTab.title",defaultMessage:"Groups"}),number:m.length,isCurrentTab:g===fu.Q.Groups,styles:b}),[fu.Q.Reprovisioning]:(0,J.jsx)(Lf,{text:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.reprovisioningTab.title",defaultMessage:"Recently left"}),number:p.length,isCurrentTab:g===fu.Q.Reprovisioning,styles:b}),[fu.Q.Requests]:(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(h.FormattedMessage,{id:"spaceBasicSettings.requestsTab.title",defaultMessage:"Requests"})})}:{}),[l,m,u,p,g,b,x,y]),j=Bf(f),w=j.map((e=>M[e]));return{visibleUsersLoaded:i,members:l,guests:d,groups:m,numberOfGuests:u,recentRecoverableUsers:p,currentTab:g,canReprovisionContent:f,tabs:w,currentTabs:j,environment:S}}({subscriptionData:t,spaceStore:s,spacePermissionsSettingsStore:i});return l?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(po.Z,{tabs:x,selectedIndex:y.indexOf(g),onChange:e=>function(e){let{newSelectedIndex:t,environment:s,spacePermissionsSettingsStore:n,currentTab:i,canReprovisionContent:o}=e;const a=Bf(o)[t];switch(a){case fu.Q.Members:Ng.qT(s,{tab:"members"});break;case fu.Q.Groups:Ng.qT(s,{tab:"groups"});break;case fu.Q.Guests:Ng.qT(s,{tab:"guests"});break;case fu.Q.Reprovisioning:Ng.qT(s,{tab:"reprovisioning"});break;case fu.Q.Requests:Ng.qT(s,{tab:"requests"});break;default:(0,Fs.t1)(a)}i===fu.Q.Requests&&a!==fu.Q.Requests&&Ge.Z.reset();n.setState({...n.state,currentTab:a})}({newSelectedIndex:e,environment:S,spacePermissionsSettingsStore:i,currentTab:g,canReprovisionContent:f}),style:{paddingLeft:0,paddingRight:0,marginTop:-6},tabTitleStyle:{fontSize:16,fontWeight:400},right:(0,J.jsx)(Zf,{spaceStore:s,guests:u,currentTab:g,spacePermissionsSettingsStore:i})}),(0,J.jsx)(Df,{currentTab:g,spaceStore:s,members:d,guests:u,groups:m,spacePermissionsSettingsStore:i,recentRecoverableUsers:p})]}):(0,J.jsx)(Af,{})}function Df(e){let{currentTab:t,spaceStore:s,members:n,guests:i,groups:o,spacePermissionsSettingsStore:a,recentRecoverableUsers:r}=e;switch(t){case fu.Q.Members:return(0,J.jsx)(mf,{spaceStore:s,members:n,spacePermissionsSettingsStore:a});case fu.Q.Guests:return(0,J.jsx)(Vh,{spaceStore:s,guests:i});case fu.Q.Groups:return(0,J.jsx)(Gg,{spaceStore:s,spacePermissionsSettingsStore:a,groups:o});case fu.Q.Reprovisioning:return(0,J.jsx)(ff,{spaceStore:s,recentRecoverableUsers:r});default:return null}}function Bf(e){return[fu.Q.Members,fu.Q.Guests,fu.Q.Groups,...e?[fu.Q.Reprovisioning]:[]]}function Lf(e){let{text:t,number:s,isCurrentTab:n,unread:i,styles:o}=e;return(0,J.jsxs)("div",{style:{display:"flex",fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:n?510:400,lineHeight:"18px",...n?o.activeTabStyle:o.inactiveTabStyle},children:[t,s&&s>0?(0,J.jsx)("div",{style:{fontSize:g.Z.fontSize.UIRegular.desktop,lineHeight:"18px",paddingLeft:4,...o.inactiveTabStyle},children:s}):void 0,i&&(0,J.jsx)(Sd.z,{style:o.redDot,size:6})]})}var Of=s(76117),Ef=s(7189);function Nf(e){const{up:t}=e,s={width:10,height:10,marginLeft:4};return t?(0,Ef.K)({...s,transform:"rotate(180deg)"}):(0,Ef.K)(s)}function Vf(e){let{users:t,store:s,extraColumns:i,initialSort:o}=e;window.__c={n:"UserTableBox"};const[r,l]=(0,n.useState)(o),d=(0,h.useIntl)();function u(e,t){return(0,J.jsxs)(ae.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){l({column:e,asc:(null==r?void 0:r.column)===e&&!(null!=r&&r.asc)})}(e)},style:{display:"flex",alignItems:"center"},children:[t.title,t.sortable&&r&&r.column===e&&Nf({up:r.asc})]},e)}const m=(0,n.useMemo)((()=>({title:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>(0,J.jsx)(ue.Z,{actorStore:e}),getValue:e=>e.getDisplayName(d)})),[d]),p=(0,n.useMemo)((()=>({name:m,...i})),[i,m]),g=c.XP(p).map((e=>({key:e,header:u(e,p[e]),style:p[e].style}))),f=(0,a.VK)((()=>{const e=t.map((e=>me.U6.createChildStore(s,{table:R.KJ,id:e.userId}))).filter((e=>e.isDefined()));return r?e.sort(((e,t)=>{const s=p[r.column].getValue(e),n=p[r.column].getValue(t);var i=s<n?-1:s>n?1:0;return r.asc?i:-1*i})):e}),[t,s,p,r]);return(0,J.jsx)(vd.Z,{columns:g,rows:f.map((e=>{const t=Object.values(p).map(((t,s)=>t.renderer?t.renderer(e):(0,J.jsx)(n.Fragment,{children:t.getValue(e)},s)));return{key:e.id,columns:t}}))})}var Uf=function(e){return e[e.UserUserSimilarity=0]="UserUserSimilarity",e}(Uf||{});const Wf={[Uf.UserUserSimilarity]:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity"})};function Kf(){const e=(0,Co.mS)();return["on"===ce.default.getGroup("user_similarity_debugging")||e?Uf.UserUserSimilarity:void 0].filter(Fs.$K)}function zf(e){let{store:t}=e;window.__c={n:"DebugZoneUserUserSimilarityTab"};const{isOnline:s,subscriptionDataStoreData:n,userSimilarityData:i,visibleUsersLoaded:o,visibleUsers:r}=(0,a.VK)((()=>{const e=wt.subscriptionDataStoreInstance.state,s=e?Mt.CM(e):[],n=c.yW(s.map((e=>me.U6.createChildStore(t,{table:R.KJ,id:e.userId}).isReady())));return{isOnline:zt.Z.state.online,subscriptionDataStoreData:e,userSimilarityData:Of.p.state||{},visibleUsersLoaded:n,visibleUsers:s}}),[t]);if(!s)return(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})});if(!n)return(0,J.jsx)(Es.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!o)return(0,J.jsx)(Es.Z,{style:{margin:"calc(50% - 1em) auto"}});const l={style:{},title:(0,J.jsx)(J.Fragment,{children:"Similarity Score"}),sortable:!0,renderer:e=>{var t;return(0,J.jsx)(J.Fragment,{children:(null===(t=i[e.id])||void 0===t?void 0:t.toFixed(3))||0})},getValue:e=>i[e.id]||0};return(0,J.jsx)(Vf,{users:r,store:t,extraColumns:{similarityColumn:l},initialSort:{column:"similarityColumn",asc:!1}})}function qf(e){let{store:t}=e;window.__c={n:"SpaceSettingsDebugZone"};const{tabs:s}=(0,a.VK)((()=>({tabs:Kf()})),[]),[i,o]=(0,n.useState)(s[0]);return(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(po.Z,{tabs:s.map((e=>Wf[e])),selectedIndex:s.indexOf(i),onChange:e=>o(s[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),i===Uf.UserUserSimilarity&&(0,J.jsx)(zf,{store:t})]})}var Gf=s(42982);const Hf="teamColumn",Qf="ownersColumn",Yf="membersColumn",$f="AccessLevelColumn",Jf="lastUpdatedColumn",Xf="contextMenuColumn",ex=[Hf,Yf,$f,Jf],tx="filterAccessAny",sx="filterAccessOnlyOpen",nx="filterAccessOnlyClosed",ix="filterAccessOnlyPrivate",ox="filterOwnerAny",ax="filterOwnerShowOrphaned",rx="filterOwnerById";class lx extends N.default{getInitialState(){return{searchQuery:"",sortColumn:Jf,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:ox},filterAccess:tx,showTeamsWithSecurityOverrides:!1}}}const dx=new lx;function cx(e){let{environment:t,teamIds:s}=e;const{currentSpaceStore:n,currentUserStore:i}=_e.default.state;return n&&i?s.map((e=>{const s=me.zX.createChildStore(n,{table:Bn.e0,id:e,spaceId:n.id});if(s.canRead())return s;const i=n&&xd.Dv({environment:t,teamId:s.id,spaceStore:n,from:"manage_teams_table"});return null!=i&&i.canRead()?i:void 0})).filter(Fs.$K):[]}var ux=s(80068);class mx extends N.default{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const px=new mx;function gx(e){var t;let{team:s}=e;return null===(t=px.state.defaultTeams[s.id])||void 0===t?void 0:t.state}function hx(e){let{team:t,persistedDefaultTeams:s}=e;if(s.includes(t))fx({store:t,state:"current-default"});else{const e={...px.state.defaultTeams};delete e[t.id],px.setState({...px.state,defaultTeams:e})}}function fx(e){const t=px.state;px.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var xx=s(30676),yx=s(47082),Sx=s(75024);function vx(e){let{}=e;window.__c={n:"DefaultTeamsInput"};const t=(0,o.Fy)(),s=(0,h.useIntl)(),i=(0,o.O7)(),{allTeams:l,loaded:d}=(0,a.VK)((()=>{const e=Rs.state;return"loaded"!==e.loadingState?{allTeams:[],loaded:!1}:{allTeams:cx({environment:i,teamIds:e.unarchivedTeamIds}),loaded:!0}}),[i]),[u,m]=(0,n.useState)(!1),p=(0,a.qz)(px),g=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),{defaultTeams:f,tokenQuery:x}=(0,a.VK)((()=>{const{defaultTeams:e,tokenQuery:t}=p.state;return{defaultTeams:e,tokenQuery:t}}),[p]),y=!x,{addedTeams:S,removedTeams:v,addedAndCurrentTeams:b}=(0,a.VK)((()=>({addedAndCurrentTeams:p.addedAndCurrentTeams(),addedTeams:p.addedTeams(),removedTeams:p.removedTeams()})),[p]),M=(0,a.VK)((()=>l.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[l]),j=(0,a.VK)((()=>l.filter((e=>e.isDefault()))),[l]);(0,n.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const s=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),n=px.state;px.setState({...n,defaultTeams:s})}({persistedDefaultTeams:j})),[j]);const w=S.length>0||v.length>0,C=e=>function(e){let{team:t,persistedDefaultTeams:s}=e;"add-default"===gx({team:t})?hx({team:t,persistedDefaultTeams:s}):fx({store:t,state:"remove-default"})}({team:e,persistedDefaultTeams:j}),k=e=>{!function(e){let{team:t,persistedDefaultTeams:s}=e;"remove-default"===gx({team:t})?hx({team:t,persistedDefaultTeams:s}):fx({store:t,state:"add-default"})}({team:e,persistedDefaultTeams:j}),p.update((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},T=new Set(v.map((e=>e.store.id))),I=i.currentUser.id,P=(0,a.VK)((()=>I?l.filter((e=>{const t=e.getMembers(),s=e.getSettingsStore().getValue();return!!s&&((0,On.pd)({membership:t},I)&&"open"===(0,On.B5)(s))})):[]),[l,I]),Z=function(e){let{query:t,addedAndCurrentTeams:s,eligibleDefaultTeams:n,teamIdsToNames:i}=e;const o=new Set;for(const a of s)o.add(a.store.id);return(0,qc.ZP)(t,n,(e=>i[e.id]??""))}({query:x,addedAndCurrentTeams:b,teamIdsToNames:M,eligibleDefaultTeams:P}),F=[];Z.length>0&&!y&&F.push({key:"default-teams-list",render:e=>(0,J.jsx)(sn.Z,{...e,title:(0,J.jsx)(h.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",defaultMessage:"Teamspaces"}),loading:!1}),items:Z.map((e=>({key:e.id,render:t=>(0,J.jsx)(xx.F,{...t,teamStore:e}),action:()=>k(e)})))});const _=(0,a.VK)((()=>p.state.showAutoCompletePopup&&F.length>0),[p,F.length]),A=(0,r.yK)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:_?jx:Mx,margin:0},menuList:{maxHeight:300,border:`1px solid ${e.regularDividerColor}`,borderTop:0,borderRadius:wx},updateButton:{marginLeft:10,height:35}})),[_]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:A.defaultTeamsHeader,children:(0,J.jsx)(h.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})}),(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,children:(0,J.jsx)(h.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})}),(0,J.jsxs)("div",{style:A.inputAndButtonContainer,children:[(0,J.jsx)("div",{style:A.inputContainer,children:(0,J.jsx)(tn.ZP,{popupType:tn.ZP.PopupType.Popup,placementToOrigin:tn.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:_,borderRadius:wx,onDismiss:()=>p.update((e=>({...e,showAutoCompletePopup:!1}))),origin:(0,J.jsx)(yx.Z,{disabled:!d||u,style:A.tokenInputMenu,focusInitial:t.isMobile,focusAfterAnimation:!0,format:yx.U.Share,inputDivStyle:{alignItems:"center"},value:x,onChange:e=>p.update((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(f).filter((e=>!T.has(e.store.id))).map((e=>(0,J.jsx)(bx,{teamStore:e.store,onClickRemove:C},e.store.id))),placeholder:s.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=b,t=c.Z$(e);t&&C(t.store)},onEmptySubmit:c.yR,showBorder:!0}),render:()=>(0,J.jsx)(Xs.Z,{menuType:Hs.og.Popup,tokenInputHeader:!0,disableHeaderBorder:!0,children:(0,J.jsx)("div",{style:A.menuList,children:(0,J.jsx)(en.Z,{type:en.i.Vertical,initialFocus:0,sections:F})})})})}),(0,J.jsx)(Ws.Z,{style:A.updateButton,disabled:!w||u,isLarge:!0,onClick:async()=>{if(g){m(!0);try{await async function(e){let{addedTeams:t,removedTeams:s,environment:n,spaceStore:i}=e;if(!i.isDefined())return!1;const o=i.getPermissionItems();return await xd.lH({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:s.map((e=>{let{store:t}=e;return t})),environment:n,spaceValue:{permissions:o},createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:i,addedTeams:S,removedTeams:v,spaceStore:g})}finally{m(!1)}}},children:(0,J.jsx)(h.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})})]})]})}function bx(e){window.__c={n:"DefaultTeamsToken"};const t=(0,o.Fy)(),{teamStore:s,onClickRemove:n}=e,{name:i}=(0,a.VK)((()=>({name:s.getName()})),[s]);return(0,J.jsx)(oc.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?td.lo.Large:td.lo.Medium,style:{marginLeft:6},onClickRemove:()=>n(s),value:(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,J.jsx)(An.p,{disabled:!0,store:s,size:14,style:{marginRight:4}}),i]})})}const Mx=3,jx=(0,Sx.wK)({topLeft:Mx,topRight:Mx,bottomLeft:0,bottomRight:0}),wx=(0,Sx.wK)({topLeft:0,topRight:0,bottomLeft:Mx,bottomRight:Mx});var Cx=s(43121),kx=s(17224),Tx=s(14871);function Ix(e){let{selectItems:t,currentSelectedItem:s,onChange:n,icon:i}=e;return(0,J.jsx)(Tx.Z,{items:t,getKey:e=>e.key,selectedItem:s,onSelect:n,renderItem:e=>(0,J.jsx)($s.Z,{title:e.value.name,...e,checkState:s.key===e.value.key}),renderOrigin:e=>(0,J.jsx)(Ys.Z,{...e,title:s.originName??s.name,on:!s.showFilterAsOffWhenSelected,icon:i})})}const Px={[tx]:{key:tx,name:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[sx]:{key:sx,name:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[nx]:{key:nx,name:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[ix]:{key:ix,name:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},Zx=c.oA([Px.filterAccessAny,Px.filterAccessOnlyOpen,Px.filterAccessOnlyClosed,Px.filterAccessOnlyPrivate]);function Fx(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsAccessFilter"};const s=(0,o.O7)(),i=(0,a.VK)((()=>t.state.filterAccess),[t]),l=(0,r.yK)((e=>({keyIcon:{width:18,height:18,...i!==tx?{fill:Ki.ZP.blue}:{fill:e.mediumIconColor}}})),[i]),d=(0,n.useCallback)((e=>{t.update((t=>({...t,filterAccess:e.key}))),kx.GZ(s,{filter:"access",value:e.key})}),[t,s]),c=Px[i];return(0,J.jsx)(Ix,{selectItems:Zx,currentSelectedItem:c,onChange:d,icon:(0,Cx.f)(l.keyIcon)})}var _x=s(66474);const Ax="showArchived",Rx="hideArchived",Dx={[Rx]:{key:Rx,name:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived"}),showFilterAsOffWhenSelected:!0},[Ax]:{key:Ax,name:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function Bx(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsArchivedFilter"};const s=(0,o.O7)(),i=(0,a.VK)((()=>t.state.showOnlyArchivedTeams),[t]),l=(0,r.yK)((e=>({archiveIcon:{width:16,height:16,marginRight:5,...i?{fill:Ki.ZP.blue}:{fill:e.mediumIconColor}}})),[i]),d=[Dx.hideArchived,Dx.showArchived],c=(0,n.useCallback)((e=>{t.update((t=>({...t,showOnlyArchivedTeams:e.key===Ax}))),kx.GZ(s,{filter:"archived",value:e.key})}),[t,s]),u=Dx[i?Ax:Rx];return(0,J.jsx)(Ix,{selectItems:d,currentSelectedItem:u,onChange:c,icon:(0,_x.c)(l.archiveIcon)})}var Lx=s(66897),Ox=s(22686),Ex=s(97680);const Nx="ShowTeamsWithNoOwnersId";function Vx(e){let{teamStores:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsOwnerFilter"};const i=(0,o.O7)(),l=(0,a.VK)((()=>s.state.filterByOwner),[s]),d=function(e){switch(e.type){case ox:return;case rx:return e.id;case ax:return Nx;default:(0,Fs.t1)(e)}}(l),u=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),m=(0,h.useIntl)(),p=(0,a.VK)((()=>{const e=t.flatMap((e=>(0,On.XO)({membership:e.getMembers()})));return c.jj(e)}),[t]),g=(0,r.yK)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:Ki.ZP.blue}})),[]),f=(0,n.useCallback)((e=>{if(u)return Lr({userId:e,currentSpaceStore:u}).getValue()}),[u]),x=(0,n.useCallback)((e=>{const t=e[e.length-1];let n;n=t===d||void 0===t?{type:ox}:t===Nx?{type:ax}:{type:rx,id:t},s.update((e=>({...e,filterByOwner:n}))),kx.GZ(i,{filter:"owner",value:n.type})}),[d,s,i]),y=(0,L.useDependency)(L.deps.searchActions),S=(0,n.useCallback)((async e=>{let{query:t}=e;if(!u||"resolved"!==y.status)return[];const s=y.value,n=(await s.searchUsers({query:t,currentSpaceStore:u,userIds:p})).map((e=>e.id));return""===t?[Nx,...n]:n}),[u,p,y.status,y.value]),v=(0,n.useCallback)(((e,t)=>{if(!u)return null;if(e===Nx)return(0,J.jsx)($s.Z,{...t,title:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),checkState:l.type===ax,className:"notranslate"});const s=f(e);return s?(0,n.createElement)(Ex.Z,{...t,key:e,actor:(0,Lx.m3)(s),checkState:d===e}):null}),[u,f,d,l.type]),b=(0,a.VK)((()=>{if(l.type!==rx)return;const e=f(l.id);return e?(0,Nn.Nz)(m,e):void 0}),[l,f,m]);let M;return M=l.type===ax?(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):b?(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:b}}):(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),(0,J.jsx)(Q.Z,{mode:Q.z.Pill,title:M,disabled:0===t.length,icon:Ox.f,iconStyles:{...g.icon,...l.type!==ox&&g.blueFill},items:c.oA([d]),hasItemsSelected:(0,Fs.$K)(d),onChange:x,labelText:{title:M,tokenInputPlaceholder:m.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:m.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:S,renderResultMenuItem:v,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const Ux="showAll",Wx="showTeamsWithSecurityOverrides",Kx={[Ux]:{key:Ux,name:(0,J.jsx)(h.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:(0,J.jsx)(h.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[Wx]:{key:Wx,name:(0,J.jsx)(h.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function zx(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsSecurityOverridesFilter"};const s=(0,o.O7)(),i=(0,a.VK)((()=>t.state.showTeamsWithSecurityOverrides),[t]),l=(0,r.yK)((e=>({securityIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:Ki.ZP.blue}})),[]),d=[Kx.showAll,Kx[Wx]],c=(0,n.useCallback)((e=>{t.setState({...t.state,showTeamsWithSecurityOverrides:e.key===Wx}),kx.GZ(s,{filter:"securityOverrides",value:e.key})}),[t,s]),u=Kx[i?Wx:Ux];return(0,J.jsx)(Ix,{selectItems:d,currentSelectedItem:u,onChange:c,icon:(0,_i.X)({...l.securityIcon,...i&&l.blueFill})})}function qx(e){let{manageTeamsStore:t,teamStores:s}=e;window.__c={n:"ManageTeamsFilterRow"};const i=(0,r.yK)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),o=(0,a.VK)((()=>t.state.searchQuery),[t]),l=(0,n.useCallback)((e=>{t.update((t=>({...t,searchQuery:e})))}),[t]);return(0,J.jsxs)("div",{style:i.container,children:[(0,J.jsx)(Gx,{style:i.searchContainer,onChange:l,value:o}),(0,J.jsxs)("div",{style:i.dropdownContainer,children:[(0,J.jsx)(Bx,{manageTeamsStore:t}),(0,J.jsx)(Vx,{teamStores:s,manageTeamsStore:t}),(0,J.jsx)(Fx,{manageTeamsStore:t}),(0,J.jsx)(zx,{manageTeamsStore:t})]})]})}function Gx(e){let{style:t,value:s,onChange:i}=e;window.__c={n:"Search"};const o=(0,h.useIntl)(),a=(0,r.yK)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),l=(0,n.useCallback)((e=>i(e.target.value)),[i]);return(0,J.jsx)(no.Z,{placeholder:o.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...a.input,...t},value:s,onChange:l,left:(0,rp.R)(a.searchIcon),format:no.B.Small,showClearButton:!0})}var Hx=s(64552),Qx=s(73343),Yx=s(98742),$x=s(11628);var Jx=s(26160),Xx=s(30765);function ey(e){let{teamStore:t,accessLevel:s,isTeamOwner:n,onChangeAccessLevel:i,width:l}=e;window.__c={n:"ManageTeamsAccessCell"};const d=(0,o.O7)(),c=function(e){return(0,a.VK)((()=>e.isDefault()),[e])}(t),u=(0,Jx.U)({teamStore:t,onChange:i,isDefault:c}),m=c?"default":s,p=u.find((e=>e.key===m)),f=!n||Boolean(null==p?void 0:p.disableAllOptionsTooltip),x=(null==p?void 0:p.disableAllOptionsTooltip)||f&&!n&&(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}),y=(0,$x.P)(),S=(0,r.yK)((e=>{const t=e.lightTextColor;return{selectButton:{paddingLeft:8,marginLeft:-8,maxWidth:l},label:{...f&&{color:t},fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:g.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.mediumIconColor,...f&&{fill:t}},tooltip:{width:200}}}),[f,l]);if(!p)throw new Error(`Selected access level is not an option found in team access level option: ${m}`);return(0,J.jsx)(Tx.Z,{items:u,getKey:e=>e.key,selectedItem:p,onSelect:e=>"private"!==e.key||y?e.onSelect():Wi.y(d,{from:"team_security_settings",for:"business"}),renderItem:e=>(0,J.jsx)(re.ZP,{textWrap:!0,style:S.tooltip,placement:Hu.u.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>(0,J.jsx)($s.Z,{title:e.value.title,...(0,Yx.Z)(e,t)})}),disabled:f,renderOrigin:e=>(0,J.jsx)(re.ZP,{textWrap:!0,style:S.tooltip,disableTooltip:!x,renderTooltip:()=>x,alignment:Hu.v.Center,placement:Hu.u.Left,render:t=>(0,J.jsxs)(Vt.Z,{style:S.selectButton,disabled:f,...(0,Yx.Z)(e,t),children:[(0,J.jsx)(Xx.s,{style:S.label,children:p.level}),(0,gd.i)(S.chevron)]})})})}function ty(e){let{teamOwners:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsOwnersCell"};const n=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),i=(0,h.useIntl)(),o=(0,a.VK)((()=>{if(!n)return;const{filterByOwner:e}=s.state;let i=t[0];if(e.type===rx){const s=e.id;t.includes(s)&&(i=s)}return i?Lr({userId:i,currentSpaceStore:n}):void 0}),[n,s,t]),l=(0,a.VK)((()=>{if(null!=o&&o.isDefined())return(0,Nn.Nz)(i,o.getModel())}),[o,i]),d=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:g.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?(0,J.jsx)("div",{style:d.noOwners,children:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})}):(0,J.jsxs)("div",{style:d.container,children:[(0,J.jsx)(Vn.Z,{style:d.userAvatar,avatarShouldShowShadow:!0,userStore:o,size:20}),(0,J.jsx)(Xx.s,{style:d.userName,children:l}),t.length>1&&(0,J.jsx)("div",{style:d.nMoreOwnersText,children:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})})]})}const sy=[Hf,Qf,$f,Jf,Xf],ny={[$f]:{headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:s}=e;return(0,J.jsx)(ey,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:(e,n)=>xd.Ju({environment:s,store:t.store,accessLevel:e,isDefault:n,teamName:t.name,from:"manage_teams_table"}),width:90})},colWidth:{width:90},hasClickableContents:!0},[Hf]:{headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return(0,J.jsx)(iy,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[Qf]:{headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:s}=e;return(0,J.jsx)(ty,{teamOwners:t.owners,manageTeamsStore:s})},colWidth:{minWidth:60,widthPercent:25}},[Yf]:{headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return(0,J.jsx)(Xx.s,{children:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.numMembersCell",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}})})},colWidth:{minWidth:40,widthPercent:15}},[Jf]:{headerTitle:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return t.lastUpdated&&(0,J.jsx)(oy,{lastUpdatedMillis:t.lastUpdated})},colWidth:{minWidth:50,widthPercent:15}},[Xf]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return(0,J.jsx)(Qx.OutlinerTeamOverflow,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function iy(e){let{teamStore:t,name:s,isArchivedTeam:n}=e;window.__c={n:"TeamCell"};const i=(0,o.O7)(),l=(0,h.useIntl)(),d=(0,Hx.e)(t),u=(0,r.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:g.Z.fontWeight.regular},smallText:{fontSize:(0,Sx.yv)(i,"UISmall"),color:e.mediumTextColor,fontWeight:g.Z.fontWeight.regular},archivedTag:{marginLeft:5}})),[i]),m=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),p=(0,a.VK)((()=>{if(!m)return;const e=(0,Fe.tO)({teamStore:t,spaceStore:m}).length;return(0,Sc.uf)(e,"compact",l)}),[m,l,t]),f=(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:p}}),x=d?(0,J.jsxs)(J.Fragment,{children:[" • ",(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})]}):void 0,y=c.oA([f,x]);return(0,J.jsxs)("div",{style:u.container,children:[(0,J.jsx)(An.p,{style:u.teamIcon,size:28,store:t,disabled:!0}),(0,J.jsxs)("div",{style:u.nameAndMembersContainer,children:[(0,J.jsxs)("div",{style:u.nameAndArchivedPillContainer,children:[(0,J.jsx)(Xx.s,{style:u.nameText,children:s}),n&&(0,J.jsx)(Yi.Z,{desktopStyle:u.archivedTag,mobileStyle:u.archivedTag,children:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"})})]}),(0,J.jsx)(Xx.s,{style:u.smallText,children:y})]})]})}function oy(e){let{lastUpdatedMillis:t}=e;return(0,J.jsx)(Xx.s,{children:(0,Ma.Yx)(t,"very_short",hr.SP)})}function ay(e){let{teamStores:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsTable"};const i=(0,o.O7)(),l=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>_e.default.state.currentUserStore),[]),{sortAscending:u,sortColumn:m}=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return{sortAscending:e,sortColumn:t}}),[s]),p=(0,a.VK)((()=>{const e=null==d?void 0:d.id;return e?c.oA(t.map((t=>{if(!t.canRead()||!t.isReady())return;const s=t.getMembers(),n=(0,On.XO)({membership:s});return{store:t,name:t.getName()??"",owners:n,isCurrentUserOwnerOfTeam:n.includes(e),members:(0,Fe.tO)({teamStore:t,spaceStore:l}),hasSecurityOverrides:t.hasSecurityOverrides(),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,On.m4)({archived_by:t.getArchivedBy()}),lastUpdated:t.getLastEditedTime()}}))):[]}),[l,null==d?void 0:d.id,t]),g=(0,a.VK)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:t,showTeamsWithSecurityOverrides:n,filterAccess:i}=s.state;return p.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!n||e.hasSecurityOverrides)).filter((e=>{if(i===sx&&"open"!==e.accessLevel)return!1;if(i===nx&&"closed"!==e.accessLevel)return!1;if(i===ix&&"private"!==e.accessLevel)return!1;switch(t.type){case ax:return 0===e.owners.length;case rx:return e.owners.includes(t.id);case ox:return!0;default:(0,Fs.t1)(t)}}))}),[s,p]),h=(0,a.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return function(e){let{data:t,sortColumn:s,sortAscending:n}=e;const i=[n?"asc":"desc"],o=[n?"desc":"asc"];switch(s){case Hf:return c.Xo(t,(e=>e.name),o);case Yf:return c.Xo(t,(e=>e.members.length),i);case $f:return c.Xo(t,(e=>Bn.bx.indexOf(e.accessLevel)),i);case Jf:return c.Xo(t,(e=>e.lastUpdated),i);default:(0,Fs.t1)(s)}}({data:g,sortAscending:e,sortColumn:t})}),[s,g]),f=(0,a.VK)((()=>(0,qc.ZP)(s.state.searchQuery,h,(e=>e.name))),[s,h]),x=(0,n.useCallback)((e=>xd.RF({environment:i,teamId:e,tab:wh.a.Members,from:"manage_teams_table"})),[i]),y=(0,r.yK)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:sy.reduce(((e,t)=>e+gy(ny[t].colWidth)+my),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),S=(0,n.useCallback)((e=>{const{sortColumn:t,sortAscending:n}=s.state,o=e===t&&!n;s.setState({...s.state,sortAscending:o,sortColumn:e}),kx.dw(i,{sortBy:e,sortOrder:n?"ascending":"descending"})}),[s,i]),v=(0,n.useCallback)((()=>{s.reset()}),[s]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("table",{style:y.container,children:[(0,J.jsx)("tr",{style:y.tableHeaderRow,children:sy.map((e=>(0,J.jsx)(ly,{column:e,onSortableColumnClick:S,sortAscending:u,sortColumn:m},`header_${e}`)))}),(0,J.jsx)("tr",{children:sy.map((e=>(0,J.jsx)("td",{},`padding_row_${e}`)))}),f.map((e=>(0,J.jsx)(ry,{onShowTeamSettings:x,teamData:e,manageTeamsStore:s},`${e.store.id}_row`)))]}),(0,J.jsx)(cy,{style:y.noTeamsLabel,numItemsAfterFilter:f.length,numItemsBeforeFilter:t.length,onResetFilters:v})]})}function ry(e){let{teamData:t,manageTeamsStore:s,onShowTeamSettings:i}=e;window.__c={n:"TeamRow"};const[o,a]=(0,n.useState)(!1),l=(0,n.useCallback)((()=>a(!0)),[]),d=(0,n.useCallback)((()=>a(!1)),[]),c=(0,n.useCallback)((e=>{uy(e,(()=>i(t.store.id)))}),[i,t.store.id]),u=(0,r.yK)((e=>({teamRow:{cursor:"pointer",borderBottom:`1px solid ${e.tableDividerColor}`}})),[]);return(0,J.jsx)("tr",{onMouseLeave:d,onMouseEnter:l,style:u.teamRow,onClick:c,children:sy.map((e=>(0,J.jsx)(dy,{isRowHovered:o,teamData:t,columnData:ny[e],manageTeamsStore:s},`${t.store.id}_${e}`)))})}function ly(e){let{column:t,onSortableColumnClick:s,sortColumn:n,sortAscending:i}=e;window.__c={n:"HeaderCell"};const o=ny[t],a=(0,r.yK)((e=>({th:hy(o),innerDiv:{display:"flex",alignItems:"center",minWidth:gy(o.colWidth),height:32},text:{fontSize:g.Z.fontSize.UISmall.desktop,fontWeight:g.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[o]),l=(0,J.jsx)(Xx.s,{style:a.text,children:o.headerTitle}),d=(c=t,ex.includes(c)?(0,J.jsxs)(Vt.Z,{style:a.sortButton,onClick:()=>s(t),children:[l,(()=>{if(t===n)return(0,Ef.K)({...a.sortIcon,...i&&{transform:"rotate(180deg)"}})})()]}):l);var c;return(0,J.jsx)("th",{style:a.th,children:(0,J.jsx)("div",{style:a.innerDiv,children:d})})}function dy(e){let{teamData:t,columnData:s,isRowHovered:n,manageTeamsStore:i}=e;window.__c={n:"Cell"};const a=(0,o.O7)(),l=(0,r.yK)((e=>({td:{...hy(s),...n&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:gy(s.colWidth),fontSize:g.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:56,display:"flex",alignItems:"center"}})),[s,n]),d=uy,c=Boolean(s.hasClickableContents);return(0,J.jsx)("td",{style:l.td,children:(0,J.jsx)("div",{style:l.innerDiv,onClick:c?d:void 0,children:s.renderCell({environment:a,data:t,manageTeamsStore:i})})})}function cy(e){let{style:t,numItemsBeforeFilter:s,numItemsAfterFilter:n,onResetFilters:i}=e;if(0!==n)return null;let o;return o=0!==s?(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>(0,J.jsx)(js.Z,{onClick:i,children:e})}}):(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),(0,J.jsx)(le.Z,{isSmall:!0,style:t,children:o})}function uy(e,t){(0,Mf.ZP)({event:e,context:Mf.Af.ManageTeamsRowClick,callback:t})}const my=10,py={paddingLeft:my/2,paddingRight:my/2};function gy(e){return"minWidth"in e?e.minWidth:e.width}function hy(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...py,...t}}function fy(e){let{}=e;window.__c={n:"ManageTeamsBrowser"};const{isMobile:t=!1}=(0,o.Fy)(),s=(0,o.O7)(),i=(0,a.qz)(dx),l=(0,r.yK)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),{unarchivedTeamIds:d,archivedTeamIds:c,isLoading:u}=(0,a.VK)((()=>{const e=Rs.state;return"loaded"!==e.loadingState?{unarchivedTeamIds:[],archivedTeamIds:[],isLoading:!0}:{unarchivedTeamIds:e.unarchivedTeamIds,archivedTeamIds:e.archivedTeamIds,isLoading:!1}}),[]),m=(0,a.VK)((()=>u?[]:cx({environment:s,teamIds:[...d,...c]})),[c,s,u,d]),p=(0,n.useCallback)((()=>xd.lo("workspace_settings")),[]);return(0,J.jsxs)("div",{style:l.container,children:[(0,J.jsxs)(et.Z,{large:!t,style:l.header,small:!0,children:[(0,J.jsxs)("div",{style:l.subheader,children:[(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),(0,J.jsx)(le.Z,{isSmall:!0,style:{marginTop:3},children:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access here"})})]}),(0,J.jsx)(Ws.Z,{onClick:p,isLarge:!0,className:Ie.myM,children:(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"})})]}),u?(0,J.jsx)(Es.Z,{}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(qx,{teamStores:m,manageTeamsStore:i}),(0,J.jsx)(ay,{teamStores:m,manageTeamsStore:i})]})]})}var xy=s(44615),yy=s(2688);function Sy(){window.__c={n:"ManageTeamsListener"};const e=(0,o.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,a.VK)((()=>{const{currentSpaceStore:e,currentUserStore:t}=_e.default.state;return{currentSpaceStore:e,currentUserStore:t}}),[]);return(0,n.useEffect)((()=>{if("loading"===Rs.state.loadingState||!t||!s)return;const n=yy.Z.addListener((0,xy.pD)({userId:s.id,spaceId:t.id}),((t,s)=>{Ds({environment:e,messageStoreEmitValue:s})}),void 0,e);return function(){n&&yy.Z.removeListener(n,e)}}),[t,s,e]),null}const vy=n.memo(Sy);function by(e){let{title:t,description:s,disabled:n=!1,selected:i,onChange:o=(()=>{})}=e;return(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!n&&o(!i),children:[(0,J.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[t,s&&(0,J.jsx)(le.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:s})]}),(0,J.jsx)("div",{style:{marginTop:5},children:(0,J.jsx)(Ia.Z,{on:i,disabled:n})})]})}function My(){window.__c={n:"Header"};const e=(0,o.Fy)();return(0,J.jsx)(et.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"})})}function jy(){window.__c={n:"TeamSecuritySettings"};const e=(0,o.O7)(),t=(0,a.VK)((()=>_e.default.state.currentSpaceStore),[]),s=(0,a.qz)(void 0,Be.Z),i=(0,a.VK)((()=>t&&s.getValueForSpace(t)),[t,s]),r=(0,a.VK)((()=>(0,de.F$)()),[]),l=(null==i?void 0:i.disableTeamCreation)??!1,d=(null==i?void 0:i.disableTeamGuests)??!1,c=void 0===i,u=(0,n.useCallback)((()=>{t&&i&&async function(e){let{newSettingValue:t,environment:s,workspaceSecuritySettings:n,spaceStore:i}=e;const o="allowTeamCreation"===t?(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want to allow all members of this workspace to create teamspaces?"}):(0,J.jsx)(h.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?"});!!(await v.confirmUserAction({message:o}))&&pu.n(s,{securitySettingsState:{...n,disableTeamCreation:"disableTeamCreation"===t},spaceStore:i})}({newSettingValue:l?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:i})}),[t,l,e,i]);return(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(Ms.Z,{size:34}),(0,J.jsx)(by,{disabled:c,onChange:u,title:(0,J.jsx)(h.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:(0,J.jsx)(h.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:l}),(0,J.jsx)(Ms.Z,{size:34}),r&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(by,{disabled:c,onChange:async function(){if(t&&i){if(!Boolean(i.disableTeamGuests)){if(!(await v.confirmUserAction({message:(0,J.jsx)(h.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:(0,J.jsx)(h.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:(0,J.jsx)(h.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})})))return}pu.n(e,{securitySettingsState:{...i,disableTeamGuests:!i.disableTeamGuests},spaceStore:t})}},title:(0,J.jsx)(h.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:(0,J.jsx)(h.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!d}),(0,J.jsx)(Ms.Z,{size:34})]})]})}function wy(e){let{}=e;window.__c={n:"TeamsWorkspaceSettings"};const t=(0,r.yK)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]);return(0,J.jsxs)(Xe.ZP,{children:[(0,J.jsx)(My,{}),(0,J.jsx)(ux.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),(0,J.jsx)(vx,{}),(0,J.jsx)(jy,{}),(0,J.jsx)(fy,{}),(0,J.jsx)(vy,{})]})}var Cy=s(38493),ky=s(3924),Ty=s(39675),Iy=s(67729),Py=s(75493),Zy=s(2832),Fy=s(73966);function _y(e){let{isMobile:t}=e;window.__c={n:"ManualUpdateTimezoneSetting"};const s=(0,o.O7)(),n=B.default.getIntl(),i=(0,a.VK)((()=>_e.default.state.currentUserSettingsStore),[]),{currentTimeZone:r,auto_update_disabled:l}=(0,a.VK)((()=>{const e=null==i?void 0:i.getSettings();return{currentTimeZone:null==e?void 0:e.time_zone,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[i]),d=(0,a.VK)((()=>Zy.S.map((e=>({key:e,label:(0,Py.Z)(n,e)})))),[n]);return(i&&(0,J.jsx)(mo.Z,{isMobile:t,disabled:!l,title:(0,J.jsx)(h.FormattedMessage,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Time Zone"}),caption:(0,J.jsx)(h.FormattedMessage,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current time zone setting."}),type:"dropdown",currentOption:r??"error_fetch_timezone",options:d,onSelectOption:e=>{Fy.l6({environment:s,userSettingsStore:i,timeZone:e})}}))??null}function Ay(e){let{isMobile:t}=e;window.__c={n:"AutoUpdateTimezoneSetting"};const s=(0,o.O7)(),i=(0,a.VK)((()=>_e.default.state.currentUserSettingsStore),[]),r=(0,a.VK)((()=>{var e;return null==i||null===(e=i.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[i])??!1,l=(0,n.useCallback)((e=>{const t=!r;Fy.k2({environment:s,userSettingsStore:e,disableAutoSetTimezone:t}),t||Fy.wk({environment:s,userSettingsStore:e})}),[s,r]),d=(0,J.jsx)(h.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),c=(0,J.jsx)(h.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(i&&(0,J.jsx)(mo.Z,{isMobile:t,title:d,caption:c,type:"toggle",isOn:!r,onToggle:()=>l(i)}))??null}var Ry=s(16347);const Dy=(0,ky.M)((function(e){let{passwordRequestStore:t,userEmailDomainSettings:s}=e;window.__c={n:"UserSettings"};const{isPhone:n,isIOS:i,isMobile:r}=(0,o.Fy)(),l=(0,o.O7)(),d=(0,a.VK)((()=>zt.Z.state.online),[]),c=(0,a.VK)((()=>r&&t?(0,Ty.E)({isPhone:n,isIOS:i,passwordRequestStore:t,userEmailDomainSettings:s}):(0,Ty.Z)({environment:l})),[l,r,n,i,t,s]),u=[{key:"timezone-auto",renderSettingsItem:()=>(0,J.jsx)(Ay,{isMobile:r})},{key:"timezone-manual",renderSettingsItem:()=>(0,J.jsx)(_y,{isMobile:r})}].filter(Fs.$K),m=[(0,a.VK)((()=>(0,Iy.h)(l)),[l])?{key:"cookies",renderSettingsItem:()=>(0,J.jsx)(Iy.Z,{isMobile:r})}:void 0,{key:"view-history",renderSettingsItem:()=>(0,J.jsx)(Ry.H,{isMobile:r})}].filter(Fs.$K);return d?(0,J.jsxs)(Xe.ZP,{disableScroller:r,children:[(0,J.jsx)(et.Z,{large:!r,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"mySettings.settingsSection.title",defaultMessage:"My settings"})}),(0,J.jsx)(du.O,{items:c}),(0,J.jsx)(Ms.Z,{size:48,isHidden:!0}),(0,J.jsx)(et.Z,{large:!r,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"notificationAndPersonalSettings.dateAndTimeSection.title",defaultMessage:"Date & time"})}),(0,J.jsx)(du.O,{items:u}),(0,J.jsx)(Ms.Z,{size:48,isHidden:!0}),(0,J.jsx)(et.Z,{large:!r,divider:"full",children:(0,J.jsx)(h.FormattedMessage,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})}),(0,J.jsx)(du.O,{items:m})]}):(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(le.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,J.jsx)(h.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"mySettings.goOnline.prompt"})})})})),By={overflow:"auto",paddingBottom:12},Ly={display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10,paddingLeft:4,paddingRight:4},Oy={user_settings:{},profile:{},notifications:{},notifications_and_settings:{},connected_apps:{},language_and_region:{},debug_zone:{},settings:{},teams:{adminOnly:!0,membersOnly:!0},members:{membersOnly:!0},analytics:{membersOnly:!0,enterpriseOnly:!0},plans:{membersOnly:!0},billing:{},subscription:{},security:{adminOnly:!0},identity_provisioning:{adminOnly:!0},admin_content_search:{adminOnly:!0,enterpriseOnly:!0},integrations:{adminOnly:!0},imports:{},audit_log:{adminOnly:!0,enterpriseOnly:!0},experiments:{},sites:{membersOnly:!0}},Ey=(0,h.defineMessages)({dialogLabel:{id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}});class Ny extends i.Z{constructor(){super(...arguments),this.lastSpaceSettingsStoreState=void 0,this.lastSpaceSettingsModalStoreOpen=!1,this.storeTypes={spaceBasicSettingsStore:Ve,spaceProfileSettingsStore:ze,securitySettingsStore:Be.Z,samlSettingsStore:De,spaceDomainSettingsStore:We},this.renderContent=()=>{const e=qe.Z.state.currentTab,t=this.getTabRenderer(e);return(0,J.jsx)(Mo.Z,{capture:!0,allowEsc:!0,render:e=>(0,J.jsx)(jo.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(0,J.jsx)(qu,{sidebar:this.renderSidebar(),...e,children:t()})})})},this.renderProfile=()=>(0,J.jsx)(Dg,{isEducationPlan:Mt.wl(wt.subscriptionDataStoreInstance.state),spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore}),this.renderSettings=()=>(0,J.jsx)(Sp,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,securitySettingsStore:this.stores.securitySettingsStore}),this.shouldRenderMfaPrompt=()=>{var e,t;const{currentSpaceViewStore:s,currentSpaceStore:n,currentUserStore:i}=_e.default.state;if(null==i||!i.id)return!1;if(null==n||!n.isDefined())return!1;const o=null==s?void 0:s.getSettings();return"dismissed"!==(null==o||null===(e=o.mfa_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==o||null===(t=o.mfa_settings_prompt)||void 0===t?void 0:t.status)&&("off"===this.stores.spaceProfileSettingsStore.state.accountSettings.mfaStatus&&(T.GZ(this.environment),!0))},this.renderSecurity=()=>(0,J.jsx)(wu,{spaceStore:this.props.spaceStore,securitySettingsStore:this.stores.securitySettingsStore,userStore:this.props.userStore}),this.renderIdentityProvisioning=()=>(0,J.jsx)(ed,{spaceStore:this.props.spaceStore,samlConfigStore:this.stores.samlSettingsStore,domainSettingsStore:this.stores.spaceDomainSettingsStore,userStore:this.props.userStore}),this.renderNewFeaturePrompt=()=>{if(function(e){var t,s;const{currentSpaceViewStore:n,currentSpaceStore:i,currentUserStore:o}=_e.default.state;if(!i||!Vy("analytics",i))return!1;if(null==o||!o.id)return!1;if(null==i||!i.isDefined())return!1;const a=null==n?void 0:n.getSettings();if("dismissed"===(null==a||null===(t=a.space_analytics_settings_prompt)||void 0===t?void 0:t.status)||"hidden"===(null==a||null===(s=a.space_analytics_settings_prompt)||void 0===s?void 0:s.status))return!1;return T.lo(e),!0}(this.environment)){const{currentSpaceStore:e}=_e.default.state,t=null!=e&&e.canAdmin()?(0,J.jsx)(h.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):(0,J.jsx)(h.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return(0,J.jsx)(zu,{onDismiss:()=>T.TY(this.environment),onClick:()=>{this.attemptCloseCurrentTab((()=>{qe.Z.setState({...qe.Z.state,currentTab:"analytics",defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),y.XI1(this.environment,{tab:"analytics"}),T.pE(this.environment)}))},onView:t=>{"enterprise"===(null==e?void 0:e.getSubscriptionTier())&&T.pE(t)},onClickLearnMore:()=>{const e=(0,Ze.UY)("guides.workspaceAnalytics");M.D({environment:this.environment,url:e})},descriptionMessage:t,title:(0,J.jsx)(h.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:(0,J.jsx)(h.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:(0,d.v)(mS(this.theme))})}if(this.shouldRenderMfaPrompt())return(0,J.jsx)(zu,{onClick:()=>{this.attemptCloseCurrentTab((()=>{qe.Z.setState({...qe.Z.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:qe.R.TwoStepVerification}),y.XI1(this.environment,{tab:"profile"})}))},onView:T.E6,onDismiss:()=>T.ZJ(this.environment),onClickLearnMore:()=>{const e=(0,Ze.UY)("guides.mfa");M.D({environment:this.environment,url:e})},descriptionMessage:(0,J.jsx)(h.FormattedMessage,{id:"mfaSettingsPrompt.description",defaultMessage:"2-step verification, also known as 2FA or MFA, is now available. Add a secondary method of verification used during login."}),title:(0,J.jsx)(h.FormattedMessage,{id:"mfaSettingsPrompt.title",defaultMessage:"Add an extra layer of security to your account."}),buttonText:(0,J.jsx)(h.FormattedMessage,{id:"mfaSettingsPrompt.button.label",defaultMessage:"Enable 2-step verification"}),icon:(0,l.Q)(mS(this.theme))})},this.handleModalDismiss=()=>this.attemptCloseCurrentTab((()=>{qe.Z.setState({...qe.Z.state,open:!1}),Oe.reset(),this.stores.spaceDomainSettingsStore.reset(),Wy(),Ge.Z.reset()}))}async UNSAFE_willMount(e){super.UNSAFE_willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:s}=this.stores,n=s.getValueForSpace(t);n&&s.setState(n),await k(this.environment,this.stores.spaceProfileSettingsStore)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{open:t}=qe.Z.state,s=qe.Z.state;this.lastSpaceSettingsModalStoreOpen===t&&c.Xy(this.lastSpaceSettingsStoreState,s)||t&&y.SUq(this.environment,{tab:s.currentTab,from:s.openedFrom}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=c.d9(s)}renderComponent(){const{open:e}=qe.Z.state;return(0,J.jsx)(wo.Z,{ariaLabel:B.default.formatMessage(Ey.dialogLabel),open:e,innerStyle:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:12,maxHeight:715},onOpen:()=>{return e=this.props.spaceStore,t=this.environment,Qe.bi(t),Wy(),void f.kj({environment:t,spaceId:e.id,canAdmin:e.canAdmin()});var e,t},onDismiss:this.handleModalDismiss,render:this.renderContent,className:Ie.zYS})}getTabRenderer(e){const t={profile:this.renderProfile,notifications_and_settings:()=>(0,J.jsx)(Gy,{}),user_settings:()=>(0,J.jsx)(Qy,{}),notifications:()=>(0,J.jsx)(Yy,{}),language_and_region:()=>(0,J.jsx)(Hy,{}),connected_apps:()=>(0,J.jsx)(oS,{}),debug_zone:()=>(0,J.jsx)(aS,{spaceStore:this.props.spaceStore}),settings:this.renderSettings,teams:()=>(0,J.jsx)($y,{}),members:()=>(0,J.jsx)(Jy,{spaceStore:this.props.spaceStore}),analytics:()=>(0,J.jsx)(Xy,{spaceStore:this.props.spaceStore}),plans:()=>(0,ns.i4)()?(0,J.jsx)(Is,{}):(0,J.jsx)(is.SpaceSubscriptionPlans,{}),billing:()=>(0,J.jsx)(eS,{spaceStore:this.props.spaceStore}),subscription:()=>(0,J.jsx)(nS,{}),security:this.renderSecurity,identity_provisioning:this.renderIdentityProvisioning,admin_content_search:()=>(0,J.jsx)(rS,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),integrations:()=>(0,J.jsx)(lS,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),experiments:()=>(0,J.jsx)(tS,{}),audit_log:()=>(0,J.jsx)(sS,{spaceStore:this.props.spaceStore}),imports:()=>(0,J.jsx)(iS,{}),sites:()=>(0,J.jsx)(dS,{spaceStore:this.props.spaceStore})},{spaceStore:s}=this.props;if(Vy(e,s))return t[e];{const e=b.CT(s);return b.r$({currentTab:e}),t[e]}}renderSidebar(){const{spaceStore:e}=this.props,t=wt.subscriptionDataStoreInstance.state,s=qe.Z.state.currentTab,n=Mt.wY(t),i=(0,Co.mS)(),o=Kf().length>0;return(0,J.jsxs)("div",{style:Ly,children:[(0,J.jsx)("div",{style:By,children:(0,J.jsxs)("div",{children:[(0,J.jsx)("div",{style:cS(this.theme),children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})}),(0,J.jsx)(pS,{}),this.renderTabButton("profile",e),this.renderTabButton("user_settings",e),this.renderTabButton("notifications",e),this.renderTabButton("connected_apps",e),this.renderTabButton("language_and_region",e),o&&this.renderTabButton("debug_zone",e),(0,J.jsx)(Ms.Z,{size:18,isHidden:!0}),(0,J.jsx)("div",{style:cS(this.theme),children:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})}),this.renderTabButton("settings",e),(0,Fe.bq)()&&this.renderTabButton("teams",e),this.renderTabButton("members",e),!this.environment.device.isMobile&&this.renderTabButton("analytics",e),this.renderTabButton("plans",e),zy(n,this.props.spaceStore)&&this.renderTabButton("billing",e),n&&this.renderTabButton("subscription",e),this.renderTabButton("sites",e),this.renderTabButton("security",e),this.renderTabButton("identity_provisioning",e),!this.environment.device.isMobile&&this.renderTabButton("admin_content_search",e),this.renderTabButton("integrations",e),(0,Te.c)()&&!this.environment.device.isMobile&&(0,J.jsx)("span",{onClick:()=>{const e=(0,u.ZP)();Ae.Z.setState({flowId:e}),S.Sy(this.environment,{from:"settings",flowId:e})},children:this.renderTabButton("imports",e)}),!this.environment.device.isMobile&&this.renderTabButton("audit_log",e),i&&this.renderTabButton("experiments",e)]})}),e.canRead()&&(0,J.jsx)($e.Z,{source:"settings",isButtonDisabled:"plans"===s}),e.canRead()&&!(0,m.E3)(null==t?void 0:t.addOns)&&(0,J.jsx)(Ye.Z,{source:"settings"}),this.renderNewFeaturePrompt()]})}renderTabButton(e,t){if(!Vy(e,t))return null;const s=qe.Z.state.currentTab===e,n=Ot[e](this.environment),i=Et[e](this.environment),o=Nt[e](this.environment);return(0,J.jsxs)(ae.Z,{hovered:s,style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:12,paddingRight:12,borderRadius:4,marginTop:1,marginBottom:1,minHeight:27,position:"relative"},onClick:t=>{s||this.attemptCloseCurrentTab((()=>{qe.Z.setState({...qe.Z.state,currentTab:e,defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),y.XI1(this.environment,{tab:e})}))},children:[(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",...s&&{fontWeight:g.Z.fontWeight.semibold}},children:[(0,J.jsx)("div",{style:uS(this.theme),children:n}),(0,J.jsx)(le.Z,{isMultiline:!0,children:i}),o]}),(0,J.jsx)(gS,{tab:e})]})}async attemptCloseCurrentTab(e){const{spaceStore:t}=this.props,{spaceProfileSettingsStore:s}=this.stores,{currentUserStore:n,currentUserSettingsStore:i}=_e.default.state;if(!n||!i)throw new Error("No user or settings store.");const o=(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),a=(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),r=(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:l}=qe.Z.state;if("profile"===l){if(!c.Xy(s.state,s.getValueForUser(n,i,B.default.getIntl()))){const{profilePhoto:t,name:n,startDayOfWeek:a}=s.state;return n?v.showDialog({message:o,showCancel:!0,keepFocus:!0,items:[{label:(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{I.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{const{currentUserStore:s}=_e.default.state;if(s&&x.A({userStore:s,data:{name:n,profilePhoto:t},transaction:e}),i){const t=i.getSettings();(null==t?void 0:t.start_day_of_week)!==a&&P.d2({userSettingsStore:i,data:{start_day_of_week:a},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):v.showErrorMessage((0,J.jsx)(h.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===l&&t.canEdit()){const{spaceBasicSettingsStore:s}=this.stores,{securitySettingsStore:n}=this.stores,i=!c.Xy(n.state,n.getValueForSpace(t)),l=!c.Xy(s.state,s.getValueForSpace(t));if(i||l){if(await v.confirmUserAction({message:o,acceptLabel:a,cancelLabel:r})){if(!(await j.Y5({environment:this.environment,spaceId:t.id,domain:s.state.domain})))return!1;l&&j.OF({environment:this.environment,spaceStore:this.props.spaceStore,spaceBasicSettingsStore:s}),i&&qy(n,this.props.spaceStore,this.environment),e()}else e();return!0}e()}else if("audit_log"===l)Wy(),e();else if("analytics"===l)Ee.Z.reset(),e();else if("plans"===l&&t.canAdmin()){const{securitySettingsStore:s}=this.stores,n=s.getValueForSpace(t);!c.Xy(s.state,s.getValueForSpace(t))&&n&&(s.setState(n),qy(s,this.props.spaceStore,this.environment)),e()}else"teams"===l?(_s.Z.reset(),Rs.reset(),e()):e();return!1}}function Vy(e,t){const s=Oy[e];return!(s.adminOnly&&!t.canAdmin())&&(!(s.membersOnly&&!t.canRead())&&(!(s.enterpriseOnly&&!(0,p.wP)(t.getSubscriptionTier()))&&("sites"!==e||(0,de.T2)())))}Ny.displayName="SpaceSettings",Ny.theme=void 0;const Uy=Ny;function Wy(){O.Z.reset(),U.reset()}function Ky(e){let{userStore:t}=e;window.__c={n:"UserName"};const s=(0,h.useIntl)(),n=(0,a.VK)((()=>t.getFullName(s)),[s,t]);return n?(0,J.jsx)(le.Z,{style:{fontWeight:g.Z.fontWeight.medium},children:n}):null}function zy(e,t){var s;const n=wt.subscriptionDataStoreInstance.state;return!(!n||e||!t.canAdmin())&&("subscribed_admin"===n.type||(!("unsubscribed_admin"!==n.type||!(0,m.E3)(null===(s=n.customerData)||void 0===s?void 0:s.stripe.addOns))||!!(0,Mt.MM)(n)))}function qy(e,t,s){const{disablePublicAccess:n,disableGuests:i,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:m,enableAiFeature:p,disableTeamGuests:g,enableGuestInviteRequests:h}=e.state;I.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:s,perform:e=>{j.Xr({environment:s,disablePublicAccess:n,disableGuests:i,disableMoveToSpace:o,disableExport:a,disableSpacePageEdits:r,disablePublicAccessRequests:l,transaction:e,spaceStore:t,disableTeamCreation:d,disableMembershipRequests:c,disableExternalMembershipRequests:u,disableGuestMembershipRequests:m,enableAiFeature:Boolean(p),disableTeamGuests:g,enableGuestInviteRequests:h})}})}function Gy(){return(0,J.jsx)(au.Z,{isMobile:!1})}function Hy(){return(0,J.jsx)(nu,{})}function Qy(){return(0,J.jsx)(Dy,{})}function Yy(){return(0,J.jsx)(uu,{})}function $y(){return(0,J.jsx)(wy,{})}function Jy(e){let{spaceStore:t}=e;window.__c={n:"MembersComponent"};const s=(0,o.O7)(),n=(0,a.VK)((()=>(0,de.wE)(s)),[s]),i=(0,a.VK)((()=>Ge.Z.state.count),[]);return n?(0,J.jsx)(_f,{}):(0,J.jsx)(Tp.Z,{store:t,unreadAccessRequests:i})}function Xy(e){let{spaceStore:t}=e;return(0,J.jsx)(zm,{spaceStore:t})}function eS(e){let{spaceStore:t}=e;window.__c={n:"BillingComponent"};const s=(0,a.VK)((()=>wt.subscriptionDataStoreInstance.state),[]),{data:n}=(0,a.VK)((()=>He.Z.state),[]);if(!s)return null;const i="unsubscribed_admin"===s.type&&s.customerData&&(0,m.E3)(s.customerData.stripe.addOns);if("subscribed_admin"===s.type||i){var o;const e=null===(o=s.customerData)||void 0===o?void 0:o.stripe;return e?(0,J.jsx)(Yt.Z,{spaceStore:t,subscriptionData:s,upcomingInvoiceData:n,customerData:e}):null}return s&&"unsubscribed_admin"===s.type?(0,J.jsx)(es,{spaceStore:t,data:s}):null}function tS(){return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(Co.Ub,{})})}function sS(e){let{spaceStore:t}=e;return(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(Ce,{spaceStore:t})})})}function nS(){return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(Gf.Z,{})})}function iS(){window.__c={n:"ImportsComponent"};const e=(0,a.VK)((()=>(0,Pe.t)()),[]);return(0,J.jsx)(Xe.ZP,{children:(0,J.jsx)(ac,{genericImporterEnabled:e})})}function oS(){return(0,J.jsx)(Cy.Z,{location:"settings-page"})}function aS(e){let{spaceStore:t}=e;return(0,J.jsx)(qf,{store:t})}function rS(e){let{spaceStore:t,userStore:s}=e;return(0,J.jsx)(ji,{spaceStore:t,userStore:s})}function lS(e){let{spaceStore:t,userStore:s}=e;return(0,J.jsx)(vo,{spaceStore:t,userStore:s})}function dS(e){let{spaceStore:t}=e;return(0,J.jsx)(L.LazySitesSettingsTab,{spaceStore:t})}function cS(e){return{fontSize:12,lineHeight:1,marginBottom:1,color:e.mediumTextColor,fontWeight:g.Z.fontWeight.semibold,alignItems:"center",display:"flex",height:24,paddingLeft:12,paddingRight:11,textOverflow:"ellipsis",overflow:"hidden"}}function uS(e){return{width:20,height:20,marginRight:8,color:e.regularIconColor,fill:e.regularIconColor}}function mS(e){return{width:14,height:14,color:e.regularIconColor}}function pS(){window.__c={n:"UserDetailsComponent"};const e=(0,r.Fg)(),t=(0,o.O7)(),s=(0,a.VK)((()=>(0,ke.B7)(t)),[t]),n=(0,a.VK)((()=>null==s?void 0:s.getEmail()),[s]),i={size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:s};return(0,J.jsxs)("div",{style:{display:"flex",alignItems:"center",height:44,paddingLeft:12,paddingRight:12},children:[(0,J.jsx)("div",{style:uS(e),children:(0,J.jsx)(Vn.Z,{...i})}),s?(0,J.jsxs)("div",{children:[(0,J.jsx)(Ky,{userStore:s}),n&&(0,J.jsx)(le.Z,{isSmall:!0,children:n})]}):(0,J.jsx)(h.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"})]})}function gS(e){let{tab:t}=e;window.__c={n:"TabDotComponent"};const s=(0,r.Fg)(),n=(0,o.O7)(),{currentSpaceStore:i}=(0,a.VK)((()=>_e.default.state),[]);return(0,a.VK)((()=>"members"===t&&n.device.isDesktop&&(null==i?void 0:i.canEditMembership())&&(0,de.p1)()&&!(0,de.wE)(n)&&Ge.Z.state.count>0),[t,n,i])?(0,J.jsx)(Sd.z,{color:s.redBadgeBackground}):null}},56633:(e,t,s)=>{s.d(t,{G:()=>x});var n=s(67294),i=s(480),o=s(86628),a=s(92996),r=s(72621),l=s(42875),d=s(59054),c=s(96367),u=s(9291),m=s(54642),p=s(66890),g=s(56596),h=s(85893);const f=(0,u.defineMessages)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"},cannotSetSprintToLastTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToLastTooltip",defaultMessage:"Last sprint already exists"}});function x(e){window.__c={n:"SprintStatusPropertyMenu"};const{blockPropertyValueOverlayStore:t}=e,s=(0,i.O7)(),x=(0,p.Y$)(),y=(0,o.VK)((()=>x.normalizedSchemaStore.state),[x.normalizedSchemaStore]),S=function(e){let{sprintCollectionStore:t,environment:s,normalizedBlockSchema:n}=e;const[{value:i,status:o}]=(0,d.r5)((async()=>{var e;if(!t)return;const i=t.getSchema(),o=t.getFormat().app_config_uri;if(!o||o!==r.p$)return;const d=(0,c.Zv)(i,o).includes("last"),u=c.qB[o],p=u.current.reducer.get(n),g=u.next.reducer.get(n),h=u.last.reducer.get(n);if(!p||!g)return;const f={type:"reducer",userId:s.currentUser.id,userTimeZone:(0,l.r)(),searchQuery:void 0,reducers:{[a.SF]:p,[a.YE]:g,...d&&h?{[a.Rw]:h}:{}}},x=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],y=t.getSpaceId();if(!x)return;const S=await m.queryCollection(s,{source:{type:"collection",id:t.id,spaceId:y},collectionView:{id:x.id,spaceId:y},loader:f},void 0,{src:"sprint_status_overlay_check"});if("success"!==S.type)return;const v=S.data.result.reducerResults[a.SF],b=S.data.result.reducerResults[a.YE];if("results"!==v.type||"results"!==b.type)return;const M=v.blockIds.length>0,j=b.blockIds.length>0;if(!d)return{hasCurrentSprint:M,hasNextSprint:j,hasLastSprint:!1};const w=S.data.result.reducerResults[a.Rw];if("results"!==w.type)return;return{hasCurrentSprint:M,hasNextSprint:j,hasLastSprint:w.blockIds.length>0}}),[s,n,t]);if("resolved"!==o||!i)return;return i}({sprintCollectionStore:(0,o.VK)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:s,normalizedBlockSchema:y}),v=(0,u.useIntl)(),b=(0,n.useCallback)((e=>void 0===S&&[a.YE,a.SF,a.Rw].includes(e)?{disabled:!0}:e===a.YE&&null!=S&&S.hasNextSprint?{disabled:!0,disableReasonMessage:v.formatMessage(f.cannotSetSprintToNextTooltip)}:e===a.SF&&null!=S&&S.hasCurrentSprint?{disabled:!0,disableReasonMessage:v.formatMessage(f.cannotSetSprintToCurrentTooltip)}:e===a.Rw&&null!=S&&S.hasLastSprint?{disabled:!0,disableReasonMessage:v.formatMessage(f.cannotSetSprintToLastTooltip)}:{disabled:!1}),[S,v]);return(0,h.jsx)(g.x,{...e,shouldDisableOption:b})}},56596:(e,t,s)=>{s.d(t,{x:()=>_});var n=s(43261),i=s.n(n),o=s(67294),a=s(480),r=s(86628),l=s(24405),d=s(80951),c=s(84619),u=s(4635),m=s(72126),p=s(97880),g=s(9291),h=s(5149),f=s(14900),x=s(49616),y=s(43224),S=s(87279),v=s(98742),b=s(4023),M=s(97180),j=s(52275),w=s(78140),C=s(32163),k=s(40721),T=s(72495),I=s(26388),P=s(22084),Z=s(47082),F=s(85893);function _(e){var t;window.__c={n:"StatusPropertyMenu"};const{propertySchema:s,blockPropertyValueOverlayStore:n,onChange:_}=e,{device:A}=(0,a.O7)(),[R,D]=o.useState(e.initialValue??""),[B,L]=o.useState(""),O=(0,l.Fg)(),E=(0,g.useIntl)(),N=(0,r.VK)((()=>{const e=n.state;if(e.isOpen)return e.collectionContextStore}),[n]),V=(0,r.VK)((()=>(null==N?void 0:N.permissionScopes.state.canConfigureCollection)&&"collectionPage"!==(null==N?void 0:N.contextType)),[N]),U=(0,r.VK)((()=>{const e=n.state;return!!e.isOpen&&(0,x.aJ)({store:e.store,additionalStores:e.additionalStores,collectionContextStore:e.collectionContextStore})}),[n]),W=U?[]:s.options??[],K=(0,d.i7)(W,R),z=s.groups??[],q=K&&z.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(K.id)})),G=K?[(0,F.jsx)(P.F,{value:K.value,color:K.color,groupColor:null==q?void 0:q.color,isSingle:!1,format:A.isMobile?c.lo.Large:c.lo.Medium,onClickRemove:()=>{D(""),_(void 0,void 0)},showRemoveButton:void 0===s.defaultOption,shouldShrink:!0,showEllipsis:!0,tooltipPlacement:b.u.Left,hideTooltip:!(null===(t=K.description)||void 0===t||!t.length)},"status")]:[],H=U?null:(0,F.jsx)(Z.Z,{focus:!A.isMobile||void 0,focusAfterAnimation:!0,format:Z.U.Select,tokens:G,placeholder:E.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:()=>{},value:B,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{L(e.target.value)},dontShowBorderBottom:A.isAndroid});let Q;if(Q=A.isMobile?{menuType:S.og.Modal,title:s.name,right:(0,F.jsx)(k.DoneMenuText,{}),onClickRight:e.onDismiss,header:H}:{menuType:S.og.Popup,header:H,tokenInputHeader:!0},e.disabled)return(0,F.jsx)(w.Z,{...Q});let Y=W;if(""!==B){const e=i().filter(B,W.map((e=>e.value))).map((e=>e.original));Y=W.filter((t=>e.includes(t.value)))}const $=z.map((e=>{const t=Y.filter((t=>{var s;return null===(s=e.optionIds)||void 0===s?void 0:s.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(p.$K),J=$.length>1,X=U?[{items:z.map((t=>({key:t.name,render:e=>(0,F.jsx)(j.Z,{...e,disabledFeedback:!0,focused:e.focused,title:(0,F.jsx)(M.r_,{style:{fontWeight:500,marginTop:2},group:t,showIcon:!0,showColor:!0})}),action:()=>{e.onChange(void 0,t.name)}}))),key:"all-groups",render:e=>(0,F.jsx)(T.Z,{...e})}]:$.map(((t,s)=>{let{group:n,groupOptions:i}=t;return{items:i.map((t=>{const s=e.shouldDisableOption?e.shouldDisableOption(t.id):{disabled:!1};return{key:t.value,render:e=>{var i;return(0,F.jsx)(I.ZP,{disableTooltip:s.disabled&&!(null!==(i=t.description)&&void 0!==i&&i.length),placement:b.u.Left,renderTooltip:e=>s.disabled?s.disableReasonMessage:(0,F.jsxs)("div",{...e,style:y.F6,children:[(0,F.jsx)("div",{children:t.value}),(0,F.jsx)("div",{style:{color:O.mediumInvertedTextColor},children:t.description})]}),render:i=>{var o;return(0,F.jsx)(j.Z,{...(0,v.Z)(i,e),disabled:s.disabled,disabledFeedback:!0,focused:e.focused,title:(0,F.jsx)(P.F,{...i,value:t.value,color:t.color,hideTooltip:!(null===(o=t.description)||void 0===o||!o.length),tooltipPlacement:b.u.Left,groupColor:n.color,showRemoveButton:!1,isSingle:!0,format:A.isMobile?c.lo.Large:c.lo.Medium}),isTokenTitle:!0})}})},action:()=>{e.onChange(t.value,void 0)}}})),key:`group-${s}`,render:e=>(0,F.jsx)(T.Z,{...e,topBorder:e.index>0,title:J&&(0,F.jsx)(M.r_,{group:n,showColor:!1,style:{fontSize:12}})})}})),ee=N&&V?{items:[{key:"edit property",render:e=>(0,F.jsx)(j.Z,{...e,title:(0,F.jsx)(g.FormattedMessage,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,u.W)({width:14})}),action:()=>{const t=N.settingsStore;N.collectionStore()&&(e.onDismiss(),f.n1({collectionContextStore:N}),h.r$({collectionContextStore:N,collectionSettingsStore:t}),h.H4({collectionSettingsStore:t,item:{type:"property",formatKey:N.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,F.jsx)(T.Z,{...e,topBorder:e.index>0})}:void 0;return(0,F.jsx)(w.Z,{...Q,children:(0,F.jsx)(C.Z,{type:C.i.Vertical,initialFocus:B.length>0?0:void 0,sections:m.oA([...X,ee]),onAccept:(t,s,n)=>{e.onAccept(n)}})})}},5478:(e,t,s)=>{s.d(t,{YF:()=>l,ZP:()=>c});s(67294);var n=s(24405),i=s(4023),o=s(26388),a=s(85567),r=s(85893);const l={Success:"success",Pending:"pending",Failure:"failure"};const d={display:"flex",justifyContent:"center",alignItems:"baseline"},c=function(e){let{status:t,value:s,renderTooltip:c,...u}=e;window.__c={n:"StatusToken"};const m=(0,n.Fg)(),p={[l.Success]:m.statusTokenBackground.green,[l.Pending]:m.statusTokenBackground.yellow,[l.Failure]:m.statusTokenBackground.red},g={[l.Success]:m.statusTokenIndicator.green,[l.Pending]:m.statusTokenIndicator.yellow,[l.Failure]:m.statusTokenIndicator.red},h={[l.Success]:m.statusTokenText.green,[l.Pending]:m.statusTokenText.yellow,[l.Failure]:m.statusTokenText.red};return c?(0,r.jsx)(a.Z,{...u,backgroundColor:p[t],color:h[t],value:(0,r.jsx)(o.ZP,{placement:i.u.Bottom,alignment:i.v.Start,renderTooltip:c,render:e=>(0,r.jsxs)("div",{style:d,...e,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),s]})})}):(0,r.jsx)(a.Z,{...u,backgroundColor:p[t],color:h[t],value:(0,r.jsxs)("div",{style:d,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),s]})})}},13787:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var n=s(67294),i=s(83355),o=s(480),a=s(86628),r=s(24405),l=s(49085),d=s(8848),c=s(84169),u=s(89101),m=s(82990),p=s(9291),g=s(54642),h=s(92658),f=s(28020),x=s(92083),y=s(9209),S=s(42922),v=s(74194),b=s(50506),M=s(42402),j=s(85893);const w={padding:"24px 36px 24px",minWidth:300,maxWidth:400};class C extends i.Z{constructor(){super(...arguments),this.storeTypes={promoCodeStore:h.Z,promoError:l.default.createClass(void 0)},this.handleInputChange=e=>{this.stores.promoCodeStore.setState({...this.stores.promoCodeStore.state,inputValue:e.target.value.toUpperCase()}),this.stores.promoError.setState(void 0)},this.handleSubmitPromoCode=async()=>{const e=this.stores.promoCodeStore.state.inputValue;if(e){const t=await g.getPromoCode(this.environment,{code:e});"failed"!==t.type&&t.data.promo?y.Z.state.open&&(await y.Z.state.handlePromoCode(this.stores.promoCodeStore.state.inputValue),I()):this.stores.promoError.setState(this.props.intl.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:e}))}}}renderComponent(){const{open:e}=y.Z.state;return(0,j.jsx)(b.Z,{open:e,innerStyle:w,preventHideChildrenWhileOpening:!0,render:()=>this.renderModalContents(),onDismiss:I})}renderModalContents(){return(0,j.jsxs)("div",{style:{fontSize:14},children:[(0,j.jsx)("div",{children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,j.jsx)("br",{}),p:e=>(0,j.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:n.Children.toArray(e)}),pricinglink:e=>(0,j.jsx)(M.Z,{external:!0,href:u.AR.pricing,children:e})}})}),(0,j.jsx)(Z,{}),this.renderPromoCode(),(0,j.jsx)(T,{})]})}renderPromoCode(){const e=this.stores.promoError.state,t=this.props.intl.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,j.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,j.jsx)("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor},children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,j.jsxs)("div",{style:{flexGrow:1},children:[(0,j.jsx)("div",{style:{color:this.theme.mediumTextColor},children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,j.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,j.jsx)(v.Z,{style:{marginRight:8,height:32},value:this.stores.promoCodeStore.state.inputValue,onChange:this.handleInputChange,onSubmit:this.handleSubmitPromoCode,placeholder:t}),(0,j.jsx)(S.Z,{onClick:this.handleSubmitPromoCode,disabled:!this.stores.promoCodeStore.state.inputValue,isLarge:!0,children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,j.jsx)("div",{style:{color:d.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:e})]})]})}}C.displayName="StudentNotEligibleModal";const k=(0,p.injectIntl)(C);function T(){window.__c={n:"ContactUsComponent"};const e=(0,r.Fg)();return(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",color:e.lightTextColor,borderTop:`1px solid ${e.regularDividerColor}`,paddingTop:14},children:[(0,c.m)({width:14,marginTop:1,marginRight:6,fill:e.lightIconColor})," ",(0,j.jsx)("div",{children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,j.jsx)(M.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}function I(){y.Z.setState({open:!1})}function P(){I(),x.Z.setState({open:!0,openedFrom:"upsell",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})}function Z(){window.__c={n:"SchoolEmailCodePromptComponent"};const e=(0,r.Fg)(),t=(0,o.O7)(),s=(0,a.VK)((()=>(0,f.B7)(t)),[t]),n=(0,a.VK)((()=>null==s?void 0:s.getEmail()),[s]);return(0,j.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,j.jsx)("div",{style:{width:18,flexShrink:0,color:e.mediumTextColor},children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,j.jsxs)("div",{style:{flexGrow:1},children:[(0,j.jsx)("div",{style:{color:e.mediumTextColor},children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,j.jsx)("div",{style:{fontWeight:m.Z.fontWeight.medium,marginTop:0},children:n}),(0,j.jsx)("div",{style:{color:e.mediumTextColor,marginTop:4},children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,j.jsx)(S.Z,{style:{marginTop:12},onClick:P,isLarge:!0,children:(0,j.jsx)(p.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}},6202:(e,t,s)=>{s.d(t,{Z:()=>d});s(67294);var n=s(480),i=s(8848),o=s(42922),a=s(64921),r=s(28992),l=s(85893);const d=function(e){let{onClick:t,disabled:s,title:n}=e;return(0,l.jsx)(r.Z,{title:(0,l.jsx)(c,{onClick:t,disabled:s,title:n})})};function c(e){let{onClick:t,disabled:s,title:r}=e;window.__c={n:"SubmitButtonMenuItemButton"};const d=(0,n.O7)(),{isMobile:c}=d.device,u={width:"100%",color:i.ZP.blue};return c?(0,l.jsx)(a.Z,{onClick:t,mobileFeedback:!0,disabled:s,style:u,children:r}):(0,l.jsx)(o.Z,{onClick:t,disabled:s,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"},children:r})}},70268:(e,t,s)=>{s.d(t,{B:()=>a});s(67294);var n=s(24405),i=s(36596),o=s(85893);function a(e){window.__c={n:"UpdateSidebarLoadingSkeleton"};let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const s=(0,n.yK)((e=>({skeletonRect:{height:8,borderRadius:4,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),a=[...Array(t)].map(((e,t)=>(0,o.jsxs)("div",{style:s.skeletonSection,children:[(0,o.jsx)(i.Z,{style:s.skeletonCircle}),(0,o.jsxs)("div",{style:{width:"80%"},children:[(0,o.jsx)(i.Z,{style:{width:"80%",...s.skeletonRect,marginTop:0}}),(0,o.jsx)(i.Z,{style:{width:"50%",...s.skeletonRect}}),(0,o.jsx)(i.Z,{style:{width:"60%",...s.skeletonRect}}),(0,o.jsx)(i.Z,{style:{width:"50%",...s.skeletonRect}})]})]},t)));return(0,o.jsx)("div",{children:a})}},71145:(e,t,s)=>{s.r(t),s.d(t,{default:()=>K});s(57658),s(82801);var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(36591),l=s(59822),d=s(88437),c=s(25942),u=s(20669),m=s(74229),p=s(4615),g=s(70203),h=s(97880),f=s(82990),x=s(54642),y=(s(21703),s(58016)),S=s(27967),v=s(41747),b=s(80444),M=s(98180);const j={context_summarize:{title:"At a glance",placeholder:"Key properties + summary",isDefaultExpanded:!1},context_find_topics:{title:"Jump to topics",placeholder:"Sections and topics on the page",isDefaultExpanded:!0},context_suggest_qna:{title:"Q&A",placeholder:"Questions you might want to ask about the page, with an input to go open Q&A",isDefaultExpanded:!0},context_suggest_qna_with_search:{title:"Q&A (Search Enabled)",placeholder:"Questions you might want to ask about the page, with an input to go open Q&A",isDefaultExpanded:!0},context_suggest_related:{title:"Related",placeholder:"Related pages, people, and links with commentary",isDefaultExpanded:!0},context_topic_brief:{title:"Topic Brief",placeholder:"More about this topic",isDefaultExpanded:!1},context_multi_topic_brief:{title:"Multi-topic Brief",placeholder:"Key ideas, takeaways, and questions covered on this page",isDefaultExpanded:!0}};function w(e,t){const s=e=>{v.Z.update((t=>({...t,skillRunStates:e(t.skillRunStates)})))},n=t.map((t=>{const n=(0,p.ZP)(),i=e=>{s((t=>{const s=t[n];return{...t,[n]:{...s,aiSessionId:e}}}))},o=e=>{s((t=>{const s=t[n];return{...t,[n]:{...s,isEmpty:e}}}))},a=e=>{s((t=>{const s=t[n];return{...t,[n]:{...s,isGenerating:e}}}))},r={aiSessionId:void 0,skillType:t.skillType,title:t.humanMessage||j[t.skillType].title,placeholder:j[t.skillType].placeholder,isEmpty:!0,isGenerating:!1,handleGenerate:async()=>{var s;o(!1),a(!0);const{sessionId:n}=await(0,y.resetAndInitializeAssistantSession)({environment:e,clientSkill:(0,S.createClientGlobalSkill)(t.skillType),skillSettings:{},makeActiveSession:!1});if(i(n),await x.publishAiSession(e,{inference_type:"context",spaceId:null===(s=b.default.state.currentSpaceStore)||void 0===s?void 0:s.id,id:n,metadata:{}}),M.Z.setActiveSessionId(n),t.humanMessage){var r;const s=null===(r=M.Z.getSessionContextOrThrow(n).assistantRuntimeStore.state)||void 0===r?void 0:r.evaluator;if(!s)throw new Error("No evaluator!");const i=s.createHumanStep(`The topic is: "${t.humanMessage}"`);await(0,y.simulateOrCommitStep)({environment:e,step:i,commit:!0,isStreaming:!1,sessionId:n})}await(0,y.sampleNextAssistantSteps)({environment:e,inferenceId:(0,p.ZP)(),sessionId:n}),a(!1)},handleReset:()=>{i(void 0),o(!0),a(!1)},getTranscript:()=>{var e;const{aiSessionId:t}=v.Z.state.skillRunStates[n];if(!t)return[];const{assistantRuntimeStore:s}=M.Z.getSessionContextOrThrow(t);return(null===(e=s.state)||void 0===e?void 0:e.evaluator.getTranscript())??[]},step:void 0,isDefaultExpanded:j[t.skillType].isDefaultExpanded};return[n,r]}));s((()=>Object.fromEntries(n)))}var C=s(57819),k=s(26382),T=s(23388),I=s(84969),P=s(33871),Z=s(87279),F=s(34859),_=s(64921),A=s(52275),R=s(31945),D=s(73420),B=s(73063),L=s(91839),O=s(78140),E=s(32163),N=s(89728),V=s(53336),U=s(72495),W=s(85893);function K(){window.__c={n:"UpdateSidebarTabAiContext"};const e=(0,o.VK)((()=>v.Z.getSubTab()),[]);return"by_type"===e?(0,W.jsx)(q,{}):"by_topic"===e?(0,W.jsx)(G,{}):void(0,h.t1)(e)}function z(e){let{sections:t,handleRunAll:s,handleResetAll:a,renderEmpty:r}=e;window.__c={n:"AiContextSidebarContent"};const l=(0,n.useMemo)((()=>t.length>0&&t.every((e=>e.isGenerating))),[t]),d=(0,i.O7)(),c=(0,o.VK)((()=>b.default.state.mainEditorCurrentBlockStore),[]),[u,m]=(0,n.useState)(void 0),p=(0,o.VK)((()=>{var e;return null==c||null===(e=c.getModel())||void 0===e?void 0:e.id}),[c]),g=(0,n.useCallback)((()=>{if(!c)return;const{content:e}=(0,C.yR)(d,c);e.length>1500&&(s(),v.Z.setUnreadAIContext(!0))}),[d,c,s]);(0,n.useEffect)((()=>{if(!p||u===p)return;const e=setTimeout((()=>{m(p),a(),g()}),1e4);return()=>{clearTimeout(e),a()}}),[p,u,a,g]);const h=Y();return(0,W.jsxs)("div",{style:h.UpdateSidebarTabAiContext,children:[(0,W.jsxs)("div",{style:h.header,children:[(0,W.jsxs)("span",{style:h.label,children:["AI Context",(0,W.jsx)(H,{})]}),(0,W.jsx)(D.LZ,{}),!l&&(0,W.jsx)(N.Z,{onClick:s,children:"Run all"})]}),(0,W.jsxs)(V.Z,{type:F.Z.Y,style:h.Scroller,children:[0===t.length&&r&&(0,W.jsx)("div",{style:h.Empty,children:r()}),t.map((e=>(0,W.jsx)(Q,{...e},e.title)))]})]})}function q(){window.__c={n:"AiContextByTypeSidebar"};const e=(0,i.O7)();(0,n.useEffect)((()=>{w(e,[{skillType:"context_summarize"},{skillType:"context_find_topics"},{skillType:"context_suggest_qna"},{skillType:"context_suggest_qna_with_search"},{skillType:"context_suggest_related"}])}),[e]);const t=(0,o.VK)((()=>v.Z.getSkillRunStatesWithSteps()),[]),s=(0,n.useCallback)((()=>{for(const e of t)e.isGenerating||e.handleGenerate()}),[t]),a=(0,n.useCallback)((()=>{for(const e of t)e.handleReset()}),[t]);return(0,W.jsx)(z,{sections:t,handleRunAll:s,handleResetAll:a})}function G(){window.__c={n:"AiContextByTopicSidebar"};const e=(0,i.O7)(),t=(0,o.VK)((()=>b.default.state.currentSpaceStore),[]),s=(0,o.VK)((()=>b.default.state.mainEditorCurrentBlockStore),[]),a=(0,o.VK)((()=>v.Z.getSkillRunStatesWithSteps()),[]),[r,l]=(0,n.useState)(!1);(0,n.useEffect)((()=>{w(e,[])}),[e]);const d=(0,n.useCallback)((async()=>{if(!t||!s)return;if(r)return;l(!0);const{title:n,content:i}=(0,C.yR)(e,s),o=await x.getCompletion(e,{id:(0,p.ZP)(),aiSessionId:(0,p.ZP)(),context:{type:"findPageTopics",pageTitle:n,selectedText:i},model:"openai-7",metadata:{},spaceId:t.id,isSpacePermission:!1});if("success"!==o.type)return;function a(){const t=d.join("").split(";").map((e=>e.trim()));r&&l(!1),w(e,t.map((e=>({skillType:"context_topic_brief",humanMessage:e}))))}const d=[];if(m.H1.is(o.data))for await(const e of o.data){if("success"!==e.type)return;d.push(e.completion),a()}a()}),[e,s,t,r]),c=(0,n.useCallback)((async()=>{await d();const e=v.Z.getSkillRunStatesWithSteps();for(const t of e)t.isGenerating||t.handleGenerate()}),[d]),g=(0,n.useCallback)((()=>{for(const e of a)e.handleReset()}),[a]);return(0,W.jsx)(z,{sections:a,handleRunAll:c,handleResetAll:g,renderEmpty:()=>(0,W.jsx)(W.Fragment,{children:r?(0,W.jsx)(L.Z,{isTriColored:!0}):(0,W.jsxs)(N.Z,{onClick:c,children:[(0,u.y)({width:16,height:16,marginRight:6}),"Generate"]})})})}function H(){window.__c={n:"AiContextSubTabBadge"};const{isMobile:e}=(0,i.Fy)(),t=(0,o.VK)((()=>v.Z.getSubTab()),[]),s=["by_type","by_topic"],n={by_type:"by Type",by_topic:"by Topic"},a=Y();return(0,W.jsx)(R.ZP,{popupType:e?R.Z4.SlideUp:R.Z4.Popup,placementToOrigin:R.pO.Bottom,alignmentToOrigin:R.vR.Start,renderOrigin:e=>(0,W.jsx)(_.Z,{...e,style:a.sublabel,children:n[t]}),render:e=>(0,W.jsx)(O.Z,{menuType:Z.og.Popup,width:300,children:(0,W.jsx)(E.Z,{type:E.i.Vertical,initialFocus:0,sections:[{key:"ai_context_sub_tab",render:e=>(0,W.jsx)(U.Z,{...e,title:"Mode"}),items:s.map((s=>({key:s,render:e=>(0,W.jsx)(A.Z,{...e,title:n[s],right:s===t?(0,r.e)({width:12,height:"auto"}):void 0}),action:()=>{v.Z.setSubTab(s),e.close()}})))}]})})})}function Q(e){let{title:t,placeholder:s,isEmpty:a,isGenerating:r,handleGenerate:m,getTranscript:p,step:h,isDefaultExpanded:f}=e;window.__c={n:"AiContextSection"};const x=(0,i.O7)(),[y,S]=(0,n.useState)(f),v=(0,o.VK)((()=>b.default.state.currentSpaceStore),[]),M=(0,n.useCallback)((()=>{S(!y)}),[y,S]),j=(0,n.useCallback)((async e=>{await k.assistantActions.resetAndInitializeAssistantSession({environment:x}),await(0,T.AF)({newValue:(0,g.TPx)(e),environment:x,isSlackMode:!1,slackModeState:void 0,currentSkill:void 0,source:"ai_context_suggested_question"}),k.assistantOriginElementStore.setState({...k.assistantOriginElementStore.state,currentState:"default"}),k.assistantMenuActions.openAssistantRightHandSideMenu({environment:x,from:"question_click"})}),[x]),w=(0,n.useCallback)((async e=>{const t=e.target;if("SPAN"!==t.tagName||!t.closest('a[href="qna"]'))return;const s=t.closest('a[href="qna"]').textContent;s&&await j(s)}),[j]),C=void 0!==(null==h?void 0:h.inferenceId),Z=Y({isSectionExpanded:y});return(0,W.jsxs)("div",{style:Z.AiContextSection,children:[(0,W.jsxs)(D.X2,{alignItems:"center",justifyContent:"space-between",gap:4,children:[(0,W.jsxs)(N.Z,{style:Z.AiContextSectionTitle,onClick:M,children:[y?(0,l.J)(Z.expandIcon):(0,c.P)(Z.expandIcon),t]}),(0,W.jsx)(D.LZ,{}),(0,W.jsx)(B.Z,{icon:d.a,iconStyle:{width:16,height:16},ariaLabel:"Copy debug data\\nAlt+Click to open in JSONL viewer",onClick:e=>{const t=p();if(!t)return;const s=JSON.stringify(t);if(e.altKey){const e=btoa(encodeURIComponent(s));window.open(`/design/aiJsonRenderer#jsonl=${e}`,"_blank")}else navigator.clipboard.writeText(s)}}),C&&(0,W.jsx)(P.x,{configurationState:void 0,environment:x,clientAssistantChatStep:h,isVisible:C,style:{marginTop:0}}),r?(0,W.jsx)(L.Z,{isTriColored:!0}):(0,W.jsx)(B.Z,{onClick:m,icon:u.y,isPurple:!0,ariaLabel:"Generate AI Context section"})]}),(0,W.jsx)("div",{style:Z.AiContextSectionBody,onClick:w,children:a?(0,W.jsx)("div",{style:Z.AiContextSectionPlaceholder,children:s}):v&&h&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(I.m,{clientStep:h,parentStore:v,configurationState:void 0,fakeSlackUser:void 0,isLatestStep:!1,isQuickSearchMode:!1,renderAsFullPage:!1,priorSearchResultsStep:void 0,citationHoverStore:void 0,disableWrap:!0}),!y&&(0,W.jsx)("div",{style:Z.AiContextSectionOverlay,onClick:M,children:(0,W.jsx)(N.Z,{style:Z.AiContextOverlayButton,hoveredStyle:Z.AiContextOverlayButtonHovered,pressedStyle:Z.AiContextOverlayButtonPressed,children:"more"})})]})})]})}function Y(){let{isSectionExpanded:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.yK)((t=>({UpdateSidebarTabAiContext:{position:"relative",minHeight:0,display:"flex",flexDirection:"column",background:t.contentBackground,pointerEvents:"auto",height:"100%"},AiContextSection:{margin:"8px 0",padding:"0 12px 8px 12px",borderBottom:`1px solid ${t.accentColors.gray[100]}`},AiContextSectionTitle:{fontSize:14,fontWeight:500,color:t.mediumTextColor,marginLeft:-4,whiteSpace:"normal",flexShrink:1,height:"auto",padding:"6px 8px"},AiContextSectionGeneratebutton:{fill:t.aiPurpleColor},AiContextSectionBody:{fontSize:14,margin:"8px 2px 4px 2px",position:"relative",...e?{}:{maxHeight:64,overflow:"hidden"}},AiContextSectionPlaceholder:{color:t.mediumTextColor},AiContextSectionOverlay:{position:"absolute",bottom:0,left:0,right:0,height:32,background:"linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 1))",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},AiContextOverlayButton:{color:t.mediumTextColor,background:t.contentBackground,borderRadius:6,border:`1px solid ${t.regularDividerColor}`,fontSize:12,padding:"0 8px",height:22},AiContextOverlayButtonHovered:{background:t.accentColors.gray[50]},AiContextOverlayButtonPressed:{background:t.accentColors.gray[100]},Scroller:{flexGrow:1,minHeight:0,transform:"translateZ(0px)",zIndex:1,overflow:"hidden auto",marginBottom:0},Empty:{display:"flex",alignItems:"center",justifyContent:"center",marginTop:32},header:{display:"flex",borderBottom:`1px solid ${t.accentColors.gray[100]}`,alignItems:"center",pointerEvents:"auto",fontSize:14,padding:"8px 12px 8px 16px"},label:{color:t.regularTextColor,fontWeight:f.Z.fontWeight.medium},sublabel:{display:"inline-block",color:t.mediumTextColor,fontWeight:f.Z.fontWeight.medium,cursor:"pointer",marginLeft:2,padding:"0 2px",borderRadius:3},expandIcon:{width:16,marginLeft:-2,paddingRight:6}})),[e])}},6175:(e,t,s)=>{s.d(t,{W:()=>l,Z:()=>c});var n=s(67294),i=s(24405),o=s(97880),a=s(55797),r=s(85893);const l={"en-US":"en","ja-JP":"ja","ko-KR":"ko","fr-FR":"fr","de-DE":"de","pt-BR":"pt-BR","es-ES":"es-ES"};function d(e){return e.src?(0,r.jsx)("img",{style:e.style,src:e.src}):null}const c=n.forwardRef(((e,t)=>{window.__c={n:"VimeoVideoPlayer"};const s=(0,i.Fg)(),l=n.useRef(e);l.current=e,n.useEffect((()=>{const t=document.createElement("script");t.src="https://player.vimeo.com/api/player.js",document.body.appendChild(t);const s=window.Vimeo;if(!s)return()=>{};const n=document.getElementById(e.src),i=new s.Player(n);return i?(i.on("play",(e=>{var t,s;null===(t=(s=l.current).onPlay)||void 0===t||t.call(s,e)})),i.on("pause",(e=>{var t,s;null===(t=(s=l.current).onPause)||void 0===t||t.call(s,e)})),i.on("ended",(e=>{var t,s;null===(t=(s=l.current).onEnd)||void 0===t||t.call(s,e)})),()=>{i.off("play"),i.off("pause"),i.off("ended")}):()=>{}}),[e.src,l.current.src]);const c=function(e,t){const s=(0,o.qP)(t).flatMap((e=>{let[t,s]=e;return`${t}=${s}`})).join("&");return`${e}&${s}`}(l.current.src,{texttrack:l.current.defaultTextTrack,playsinline:!1,...l.current.options}),u={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderStyle:"solid",borderColor:s.tableDividerColor,borderWidth:"0 0 1px 0"};return(0,r.jsxs)(a.Z,{ratio:l.current.aspectRatioOverride??9/16,children:[(0,r.jsx)(d,{style:u,src:l.current.preloadThumbnailSrc}),(0,r.jsx)("iframe",{ref:t,id:l.current.src,className:l.current.className,allowFullScreen:!0,src:c,style:{...u,...l.current.style}})]})}))},79649:(e,t,s)=>{s.r(t),s.d(t,{default:()=>P});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(64275),l=s(26139),d=s(82990),c=s(9291),u=s(12714),m=s(37181),p=s(18514),g=s(38755),h=s(80444),f=s(77080),x=s(66309),y=s(42922),S=s(64921),v=s(61519),b=s(64369),M=(s(57658),s(41892)),j=s(8848);var w=s(90403),C=s(85893);function k(){window.__c={n:"ImageCarousel"};const[e,t]=(0,n.useState)(0),s=(0,n.useRef)(null),i=(0,a.Fg)(),o=function(e){return(0,a.yK)((t=>({container:{position:"relative",margin:"24px auto",textAlign:"center"},imageContainer:{position:"relative",height:280,borderRadius:8,overflow:"hidden",background:"dark"===t.mode?"#1D1B16":"#E3E2E0"},image:{height:280,width:497},caption:{fontWeight:d.Z.fontWeight.regular},navigation:{display:"flex",alignItems:"center",justifyContent:"center",gap:0,margin:"12px auto 8px"},activeDot:{background:t.regularTextColor},dot:{borderRadius:"100%",background:t.buttonPressedBackground,height:14,width:14,cursor:"pointer",border:`4px solid ${t.sidebarBackground}`},progress:{background:t.buttonPressedBackground,height:3,position:"absolute",left:0,right:0,bottom:0,transform:"translateX(-100%)",transition:`transform ${e}ms linear`}})),[e])}(5e3),{reset:r}=function(e,t){const s=(0,n.useRef)(),i=(0,n.useRef)(null),[o,a]=(0,n.useState)(t),r=(0,n.useCallback)((()=>a((e=>null===e?t:null))),[t]);function l(){var e;null===(e=s.current)||void 0===e||e.call(s)}const d=(0,n.useCallback)((()=>{i.current&&clearInterval(i.current)}),[]),c=(0,n.useCallback)((()=>{d(),i.current=setInterval(l,t)}),[d,t]);return(0,n.useEffect)((()=>{s.current=e}),[e]),(0,n.useEffect)((()=>(i.current&&clearInterval(i.current),null!==o&&(i.current=setInterval(l,o)),d)),[o,d]),{toggle:r,clear:d,reset:c}}((()=>{t((e=>(e+1)%I.length))}),5e3),l=(0,n.useCallback)((e=>{t(e%I.length),r()}),[r]),c=(0,n.useMemo)((()=>I[e%I.length]),[e]),u=(0,n.useMemo)((()=>{const t=[];for(let s=0;s<I.length;s++){const n=e===s?{...o.dot,...o.activeDot}:o.dot,i=(0,C.jsx)("div",{style:n,onClick:()=>l(s)});t.push(i)}return t}),[e,o,l]);return(0,n.useEffect)((()=>{s.current&&(s.current.style.transform="translateX(0)")}),[e]),(0,C.jsxs)("div",{style:o.container,children:[(0,C.jsxs)("div",{style:o.imageContainer,children:[(0,C.jsx)("img",{src:"dark"===i.mode?c.imageSrcDark:c.imageSrcLight,style:o.image,className:"notion-fadein-slow"},`img-${e}`),(0,C.jsx)("div",{ref:s,style:o.progress},`progress-${e}`)]}),(0,C.jsx)("div",{style:o.navigation,children:u}),(0,C.jsx)("div",{style:o.caption,className:"notion-fadein-slow",children:c.caption},`txt-${e}`)]})}function T(){window.__c={n:"AdminConsoleCaption"};const e=(0,a.yK)((e=>({textContainer:{display:"flex",alignItems:"center",justifyContent:"center",gap:4},badge:{fontWeight:d.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?j.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[]);return(0,C.jsxs)(b.Z,{style:e.textContainer,children:[(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Organization level controls",id:"enterpriseLaunchModal.imageScene.revampedAdminConsole"}),(0,C.jsx)(w.Z,{style:e.badge,content:(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Coming soon",id:"enterpriseLaunchModal.imageScene.comingSoon"})})]})}const I=[{imageSrcLight:M.Z.images.enterpriseModal.managedUsersLightPng,imageSrcDark:M.Z.images.enterpriseModal.managedUsersDarkPng,caption:(0,C.jsx)(b.Z,{children:(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Managed users dashboard & controls",id:"enterpriseLaunchModal.imageScene.managedUsers"})})},{imageSrcLight:M.Z.images.enterpriseModal.securityLightPng,imageSrcDark:M.Z.images.enterpriseModal.securityDarkPng,caption:(0,C.jsx)(b.Z,{children:(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Security & compliance integrations",id:"enterpriseLaunchModal.imageScene.securityAndComplianceIntegrations"})})},{imageSrcLight:M.Z.images.enterpriseModal.organizationsLightPng,imageSrcDark:M.Z.images.enterpriseModal.organizationsDarkPng,caption:(0,C.jsx)(T,{})}];const P=(0,c.injectIntl)((function(e){window.__c={n:"EnterpriseLaunchModal"};const t=(0,i.O7)(),s=(0,a.yK)((e=>({container:{maxWidth:560,padding:24},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18},closeButtonHovered:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.mediumTextColor},title:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",fontWeight:d.Z.fontWeight.semibold,fontSize:28,lineHeight:"30px",maxWidth:400,margin:"4px auto 16px",textAlign:"center"},captionContainer:{width:"100%"},caption:{textAlign:"center",margin:"0 auto",padding:"0 12px 0"},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5,marginLeft:-24,width:"calc(100% + 48px)"},learnMoreContainer:{paddingTop:24,width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},learnMoreButton:{margin:"0 auto",gap:4},externalLinkIcon:{width:18}})),[]),M=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=h.default.state;e&&m.Kq(t,{phase:"dismissed_modal",transactionUserAction:"EnterpriseLaunchModal.debug.clickCancel",userSettingsStore:e})}),[t]),j=(0,n.useCallback)((()=>{const{currentUserSettingsStore:e}=h.default.state;if(!e)return;const s=(0,p.UY)("blog.enterpriseLaunch");u.D({environment:t,url:s}),m.Kq(t,{phase:"dismissed_completely",transactionUserAction:"EnterpriseLaunchModal.debug.clickLearnMore",userSettingsStore:e})}),[t]),w=(0,o.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:s,mainEditorCurrentBlockStore:n}=h.default.state;if(t.device.isMobile)return!1;if(!e||!e.isReady())return!1;const i=e.getSettings();return!!i&&(!!(s&&n&&n.canRead())&&(!(!s.canAdmin()||!(0,g.j9)(s))&&!(void 0!==i.enterprise_launch_modal_phase||!f.default.checkGate("enterprise_launch_modal"))))}),[t.device]);return t.device.isMobile?null:(0,C.jsx)(x.default,{shouldShow:w,calloutId:"enterprise_launch_promo",desktopRenderInner:()=>(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(S.Z,{onClick:M,style:s.closeButton,hoveredStyle:s.closeButtonHovered,children:(0,r.D)(s.closeIcon)}),(0,C.jsx)(b.Z,{isMultiline:!0,style:s.title,children:(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Meet the improved{br}Enterprise experience",id:"enterpriseLaunchModal.title",values:{br:(0,C.jsx)("br",{})}})}),(0,C.jsx)("div",{style:s.captionContainer,children:(0,C.jsx)(b.Z,{isSecondaryColor:!0,isMultiline:!0,style:s.caption,children:(0,C.jsx)(c.FormattedMessage,{defaultMessage:"The connected workspace people love is now easier to implement and checks all your admin, security & compliance needs",id:"enterpriseLaunchModal.caption"})})}),(0,C.jsx)(k,{}),(0,C.jsx)(v.Z,{size:1,style:s.divider}),(0,C.jsx)("div",{style:s.learnMoreContainer,children:(0,C.jsxs)(y.Z,{style:s.learnMoreButton,onClick:j,isLarge:!0,children:[(0,C.jsx)(c.FormattedMessage,{defaultMessage:"Learn more",id:"enterpriseLaunchModal.learnMore"}),(0,l.K)(s.externalLinkIcon)]})})]}),desktopInnerStyle:s.container,desktopOnDismiss:M,phoneRenderInner:()=>null})}))},457:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var n=s(13991),i=s(24405),o=s(8848),a=s(1799),r=s(97880),l=s(82990),d=s(85893);function c(e){window.__c={n:"MFABackupCodes"};const{type:t}=e,s=(0,i.yK)((e=>({pane:{display:"flex",whiteSpace:"pre-line",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:4,backgroundColor:o.FN.light.yellow[50],paddingTop:8,paddingBottom:8,marginBottom:10},textCode:{fontFamily:l.Z.getHeaderFontFamily({pageFont:"mono",locale:n.SP}),fontWeight:l.Z.fontWeight.regular,fontSize:l.Z.fontSize.UIRegular.desktop,font:l.Z.baseFontFamily.emailMono,color:o.FN.light.brown[500],textAlign:"center"},redactedBackupCode:{textDecoration:"line-through",opacity:.2}})),[]);return(0,d.jsx)("div",{style:s.pane,children:(0,d.jsx)("div",{style:s.textCode,children:"status"===t?e.status.map(((e,t)=>(0,d.jsx)("div",{style:e.hasBeenUsed?s.redactedBackupCode:{},children:a.A},t))):"unencryptedCodes"===t?e.backupCodes.map(a.K).join("\n"):(0,r.t1)(t)})})}},56839:(e,t,s)=>{s.d(t,{R$:()=>g,ZP:()=>h});var n=s(67294),i=s(24405),o=s(72126),a=s(82990),r=s(9291),l=s(18514),d=s(68785),c=s(88175),u=s(73602),m=s(11898),p=s(85893);const g=6;function h(e){let{isLoading:t,phoneNumber:s,errorMessage:a,resentStatus:h,resentAt:x,onDismiss:y,onBack:S,onVerifyCode:v,onResendLink:b}=e;window.__c={n:"MFAPromptSMSVerification"};const M=(0,i.yK)(f,[]),[j,w]=(0,n.useState)([]),C=(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeTitle",defaultMessage:"Verify phone number"}),k=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeHeader.default",defaultMessage:"Enter the code sent to {phoneNumber} to complete setup.",values:{phoneNumber:s}})," ",(0,p.jsx)(u.y,{resentAt:x,resentStatus:h,onResendLink:b})]}),T={text:t?(0,p.jsx)(d.Z,{}):(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>v(j.join("")),disabled:t||"resending"===h||(0,o.oA)(j).length!==g},I=[{text:(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeNeedHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,p.jsx)(c.Z,{title:C,header:k,errorMessage:a,primaryAction:T,secondaryActions:I,onDismiss:y,onBack:S,disableBackButton:t,children:(0,p.jsx)("div",{style:M.body,children:(0,p.jsx)(m.ZP,{numInputs:g,format:"settings",disabled:!1,value:j,onChange:w,autoFocus:!0,isValidKey:m.rN})})})}function f(e){return(0,i.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:a.Z.fontWeight.medium,fontSize:a.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},18469:(e,t,s)=>{s.d(t,{R$:()=>p,ZP:()=>g});var n=s(67294),i=s(24405),o=s(72126),a=s(82990),r=s(9291),l=s(18514),d=s(68785),c=s(88175),u=s(11898),m=s(85893);const p=6;function g(e){let{isLoading:t,errorMessage:s,onDismiss:a,onBack:g,onVerifyCode:f}=e;window.__c={n:"MFAPromptTOTPVerification"};const x=(0,i.yK)(h,[]),[y,S]=(0,n.useState)([]),v=(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeTitle",defaultMessage:"Verify code"}),b=(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeHeader",defaultMessage:"Enter the one-time code from authenticator to complete setup."}),M={text:t?(0,m.jsx)(d.Z,{}):(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>f(y.join("")),disabled:t||(0,o.oA)(y).length!==p},j=[{text:(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.needHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,m.jsx)(c.Z,{title:v,header:b,errorMessage:s,primaryAction:M,secondaryActions:j,onDismiss:a,onBack:g,disableBackButton:t,children:(0,m.jsx)("div",{style:x.body,children:(0,m.jsx)(u.ZP,{numInputs:p,format:"settings",disabled:t,value:y,onChange:e=>{S(e)},autoFocus:!0,isValidKey:u.rN})})})}function h(e){return(0,i.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:a.Z.fontWeight.medium,fontSize:a.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},60494:(e,t,s)=>{s.r(t),s.d(t,{TopbarMoreMenu:()=>Es});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(9291),l=s(13991),d=s(15145),c=s(41432),u=s(90792),m=s(77366),p=s(88437),g=s(50066),h=s(82356),f=s(27714),x=s(90199),y=s(60651),S=s(2356),v=s(37888),b=s(76994),M=s(23867),j=s(82990),w=s(50906),C=s(893),k=s(30188),T=s(79257),I=s(54532),P=s(61652),Z=s(96802),F=s(94419),_=s(72711),A=s(19785),R=s(75754),D=s(8055),B=s(37834),L=s(82530),O=s(93405),E=s(72495),N=s(8848),V=s(98742),U=s(64921),W=s(26388),K=s(64369),z=s(85893);function q(e,t){let{id:s,caption:n,focused:o,isActive:r,onClick:l,onMouseDown:d,onMouseEnter:c,onMouseLeave:u,role:m,style:p,tooltip:g,ignoreLocalHoverState:h,disallowTabbing:f}=e;window.__c={n:"FontMenuItem"};const x=(0,i.Fy)(),y=(0,a.yK)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...x.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:4,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:r?N.ZP.blue:"inherit"}})),[r,x]);return(0,z.jsx)(W.ZP,{renderTooltip:()=>g,placement:W.ug.Bottom,delayThreshold:80,render:e=>{const i=(0,V.Z)(e,{onMouseEnter:c,onMouseLeave:u}),{onMouseDown:a,...r}=i;return(0,z.jsx)(U.Z,{...r,id:s,role:m,ref:t,mobileFeedback:x.isMobile,onClick:l,onMouseDown:i.onMouseDown||d,hovered:o,style:y.button,ignoreLocalHoverState:h,disallowTabbing:f,className:"notranslate",children:(0,z.jsxs)("div",{style:y.optionItem,children:[(0,z.jsx)("div",{style:{...p,height:25},children:"Ag"}),(0,z.jsx)(K.Z,{isSmall:!0,style:{marginTop:4},children:n})]})})}})}const G=n.forwardRef(q);const H=function(e){window.__c={n:"FontSectionMenuItem"};const{children:t}=e,s=(0,i.O7)(),{mobileStyle:n,desktopStyle:o}=(0,a.yK)((e=>({mobileStyle:{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${e.regularDividerColor}`,background:e.popoverBackground},desktopStyle:{display:"flex",justifyContent:"space-between",marginLeft:14,marginRight:14}})),[]);return(0,z.jsx)(E.Z,{...e,children:(0,z.jsx)("div",{style:s.device.isMobile?n:o,children:t})})};s(57658);var Q=s(72141),Y=s(77420),$=s(97880),J=s(63163),X=s(18442),ee=s(39248),te=s(74181),se=s(21202),ne=s(15070),ie=s(80444),oe=s(52275),ae=s(70301);function re(e){window.__c={n:"BotMenuItem"};const{bot:t}=e,s=(0,o.VK)((()=>ie.default.state.currentUserRootStore),[]);return t&&s?(0,z.jsx)(oe.Z,{...e,icon:(0,z.jsx)(ae.Z,{botValue:t}),title:(0,ne.Mh)(t)}):null}const le=n.forwardRef(re);var de=s(68894),ce=s(68785),ue=s(28992),me=s(43765),pe=s(31278),ge=s(76798),he=s(84015),fe=s(41892),xe=s(24600),ye=s(84210),Se=s(28187),ve=s(42402),be=s(60442);function Me(e){return(0,o.VK)((()=>{var t;return{isDefined:e.isDefined(),channel:null===(t=e.getKeyStore("channel").getValue())||void 0===t?void 0:t.replace(/^#/,"")}}),[e])}function je(){return(0,z.jsx)(be.Z,{imageURL:fe.Z.images.tooltips.pageUpdates.slackPng,imageHeight:100,caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Connect a Slack channel to get updates about this page and pages within it.",id:"topbar.updatesButton.slackIntegrationButton.tooltip"})})}const we=()=>(0,z.jsx)(be.Z,{imageURL:fe.Z.images.tooltips.pageUpdates.slackPng,imageHeight:100,caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Disconnect a Slack channel to stop getting updates about this page and pages within it.",id:"topbar.updatesButton.slackIntegrationButton.disconnectTooltip"})}),Ce=(0,n.forwardRef)((function(e,t){window.__c={n:"SlackInheritedMenuItem"};const{blockStore:s,...n}=e,{blockStore:i,slackIntegrationStore:a}=(0,Se.Jk)(s),{isDefined:l,channel:c}=Me(a),u=(0,o.VK)((()=>(0,ye.ZP)({store:i,pageVisitSource:d.tY.LinkInPage})),[i]);return l?(0,z.jsx)(W.ZP,{placement:W.ug.Left,render:e=>(0,z.jsx)(O.Z,{...(0,V.Z)(e,n),svg:xe.P,title:c,caption:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Based on",id:"topbar.updatesButton.slackIntegrationButton.activeTitle"})," ",(0,z.jsx)(ve.Z,{href:u,children:(0,z.jsx)(ge.Z,{store:i,style:{display:"inline"}})})]}),ref:t}),renderTooltip:we}):null})),ke=(0,n.forwardRef)((function(e,t){window.__c={n:"SlackConnectedMenuItem"};const{blockStore:s,...n}=e,{slackIntegrationStore:i}=(0,o.VK)((()=>(0,Se.Jk)(s)),[s]),{isDefined:a,channel:l}=Me(i);return a?(0,z.jsx)(W.ZP,{placement:W.ug.Left,render:e=>(0,z.jsx)(O.Z,{svg:xe.P,title:l,caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Connected to Slack channel",id:"topbar.updatesButton.slackIntegrationButton.connectedCaption"}),...(0,V.Z)(e,n)}),renderTooltip:we,ref:t}):null}));var Te=s(86517),Ie=s(87279),Pe=s(48019),Ze=s(78140),Fe=s(40721),_e=s(42782);const Ae=(0,n.forwardRef)((function(e,t){const{context:s,parent:a,isSharedDirectly:r,botStore:l,botPermissionSourcePage:d,originConnectionLabel:c,...u}=e,m=(0,i.O7)(),p=(0,o.VK)((()=>ie.default.state.currentSpaceStore),[]),g=s.blocks[0],h=(0,o.VK)((()=>g.canAdmin()&&(null==p?void 0:p.canRead())),[g,p]),{botCapabilities:f,botName:x}=(0,o.VK)((()=>({botCapabilities:l.getCapabilities(),botName:l.getName()})),[l]);return(0,n.createElement)(_e.Z,{...u,key:l.id,renderOrigin:e=>(0,z.jsx)(oe.Z,{...e,title:c,icon:(0,z.jsx)(ae.Z,{botStore:l,showActiveDot:!0,style:{position:"relative"}})}),renderExtension:(e,t)=>{let n;return n=m.device.isPhone?{menuType:Ie.og.Modal,right:(0,z.jsx)(Fe.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:Ie.og.Popup,width:220,...e},(0,z.jsx)(Ze.Z,{...n,children:(0,z.jsx)(Pe.Z,{context:s,initialFocus:0,onAccept:a.onAccept,sections:[Re({isSharedDirectly:r,botCapabilities:f,botPermissionSourcePage:d}),...h?[De({isSharedDirectly:r,botId:l.id,botName:x})]:[]]})})},onFocus:a.onFocus,focused:u.focused,openOnFocus:!1,ref:t})}));function Re(e){const{botCapabilities:t,isSharedDirectly:s,botPermissionSourcePage:n}=e,i=(0,Te.uH)(t);return{key:"active connection capabilities section",render:e=>(0,z.jsx)(E.Z,{...e,topBorder:!1}),actions:[...s?[]:[Mt(n)],jt(i)]}}function De(e){const{isSharedDirectly:t,botId:s,botName:n}=e;return{key:"active connection disconnect section",render:e=>(0,z.jsx)(E.Z,{...e}),actions:t?[wt(s,n)]:[Ct(s)]}}var Be=s(47453),Le=s(59753),Oe=s(9844),Ee=s(41623),Ne=s(38755),Ve=s(77907),Ue=s(26136);const We=(0,n.forwardRef)((function(e,t){const{context:s,parent:a,alreadyConnectedIntegrationIds:r,alreadyConnectedBotIds:l,originButtonLabel:d,...c}=e,u=s.blocks[0],m=(0,i.O7)(),p=(0,o.VK)((()=>ie.default.state.currentSpaceStore),[]),g=(0,o.VK)((()=>null==p?void 0:p.getBotSettingsStore().getValue()),[p]),h=(0,o.VK)((()=>null!=g&&g.integration_restrictions&&null!=g&&g.integration_approval_statuses?Object.keys(g.integration_approval_statuses):[]),[g]),[f,x]=(0,n.useState)(""),[y,S]=(0,n.useState)({status:"loading"}),v=(0,Ve.useDependency)(Ve.deps.searchActions);(0,n.useEffect)((()=>{if("resolved"!==v.status)return;const e=v.value;Promise.all([async function(t){return await e.searchSpaceBots({environment:m,query:t})}(f),async function(e){const t=await Ve.deps.searchActions.loader();return await t.searchInstallableIntegrations({query:e,environment:m,spaceId:null==p?void 0:p.id,botSettings:g})}(f)]).then((e=>{let[t,s]=e;const n=new Set,i=function(e){const{alreadyConnectedBotIds:t,alreadyConnectedIntegrationIds:s,botValues:n,environment:i}=e,o=[];for(const a of n){const e=a.id,n=t.has(e)||a.integration_id&&s.has(a.integration_id),r=Le.kk.fromValue(Y.cZ,a),l=(0,Ee.Nq)(i,r)||(0,Ne.Fn)(i)&&(0,Ee.f_)(r);!n&&l&&o.push(a)}return o}({alreadyConnectedBotIds:l,alreadyConnectedIntegrationIds:r,botValues:t,environment:m}).map((e=>(e.integration_id&&n.add(e.integration_id),{table:Y.cZ,value:e})));let o=s.map((e=>{if(p){const t=Ue.t1.createChildStore(p,{id:e,table:Oe.K2}),s=t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:s}=e;return s(t)}));if(s&&!(0,te.VM)(s)){return{table:Oe.K2,value:s}}}})).filter($.$K).filter((e=>!(n.has(e.value.id)||r.has(e.value.id))));if(te.Cb.name.toLowerCase().includes(f.toLowerCase())){const e={table:"legacy_integration",value:te.Cb};o=[...o,e]}const a=[...i,...o].sort(((e,t)=>{var s,n;const i=null===(s=e.value.name)||void 0===s?void 0:s.toLowerCase(),o=null===(n=t.value.name)||void 0===n?void 0:n.toLowerCase();return i&&o?i<o?-1:i>o?1:0:0}));S({results:a,status:"ready"})})).catch((e=>S({status:"error"})))}),[f,p,l,g,h,m,r,u,v.status,v.value]);return(0,z.jsx)(_e.Z,{...c,renderOrigin:(e,t)=>(0,z.jsx)(O.Z,{...e,ref:t,title:d,svg:Be.R}),renderExtension:(e,t)=>{const n=m.device.isMobile?{menuType:Ie.og.Modal,right:(0,z.jsx)(Fe.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:Ie.og.Popup,width:220,...e},i=m.device.isMobile?{menuType:Ie.og.Modal,topbarStyle:{height:0}}:{menuType:Ie.og.Popup,width:220,maxHeight:"16vh",...e},o=Boolean(u.canAdmin()&&(null==p?void 0:p.canRead()));return(0,z.jsx)(Ze.Z,{...n,onClick:e=>{e.stopPropagation()},children:(0,z.jsx)(Pe.Z,{initialFocus:0,context:s,onAccept:()=>{w.sSR(m)},sections:[...o?[Ke(f,x),""===f?ze({searchResults:y,resultsMenuProps:i}):Ge({searchResults:y,resultsMenuProps:i})]:[],He(o,te.Cb)]})})},onFocus:a.onFocus,focused:c.focused,openOnFocus:!0,ref:t})}));function Ke(e,t){return{key:"search connections section",render:e=>(0,z.jsx)(E.Z,{...e,isInput:!0}),actions:[ht(e,t)]}}function ze(e){const{searchResults:t,resultsMenuProps:s}=e,n=new Set;return{key:"search initial connections section",render:e=>(0,z.jsx)(qe,{...e,resultsMenuProps:s}),actions:[..."ready"===t.status?t.results.map((e=>"bot"===e.table?(e.value.integration_id&&n.add(e.value.integration_id),xt(e.value)):It(e)?(0,Se.F6)()&&!(0,Se.SG)()?void 0:St(e.value):yt(e.value))).filter($.$K):"loading"===t.status?[gt()]:[ft()]]}}function qe(e){window.__c={n:"IntegrationSearchResultsSection"};const{resultsMenuProps:t,...s}=e,i=(0,n.useRef)(null),o=(0,n.useCallback)((()=>{var e;const t=null===(e=i.current)||void 0===e||null===(e=e.querySelector('[role="menuitem"]'))||void 0===e?void 0:e.clientHeight,s=window.innerHeight<600?3:7;i.current&&t&&(i.current.style.maxHeight=s*t+.5*t+"px")}),[]);return(0,n.useEffect)((()=>(o(),window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)})),[o]),(0,z.jsx)(Ze.Z,{...t,innerRef:i,children:(0,z.jsx)(E.Z,{...s,isInput:!0,topBorder:!1,style:{margin:0,paddingTop:0,paddingBottom:0}})})}function Ge(e){const{searchResults:t,resultsMenuProps:s}=e;let n=[];return n="error"===t.status?[ft()]:"loading"===t.status?[gt()]:"ready"===t.status&&t.results.length>0?t.results.map((e=>e.table===Y.cZ?xt(e.value):It(e)?(0,Se.F6)()&&!(0,Se.SG)()?void 0:St(e.value):yt(e.value))).filter($.$K):[{key:"connections search error",displayName:Ye.default.formatMessage(mt.connectionNoSearchResultsLabel),analyticsName:mt.connectionNoSearchResultsLabel.defaultMessage,searchName:mt.connectionNoSearchResultsLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,pt],render:e=>(0,z.jsx)(me.Z,{title:Ye.default.formatMessage(mt.connectionNoSearchResultsLabel)}),action:()=>{}}],{key:"connections search results",render:e=>(0,z.jsx)(qe,{...e,resultsMenuProps:s}),actions:n}}function He(e,t){const s=e,n=!(0,Se.F6)()||(0,Se.SG)();return{key:"manage connections section",render:t=>(0,z.jsx)(E.Z,{...t,style:{marginTop:e?6:0}}),actions:[...!s&&n?[St(t)]:[],{key:"manage connections",displayName:Ye.default.formatMessage(mt.manageConnectionsLabel),analyticsName:mt.manageConnectionsLabel.defaultMessage,searchName:mt.manageConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,Qe.ff(Qe.tq)],render:e=>(0,z.jsx)(O.Z,{...e,title:Ye.default.formatMessage(mt.manageConnectionsLabel),svg:X.H}),action:()=>{Xe.r$({currentTab:"connected_apps",openedFrom:"topbar"})}}]}}var Qe=s(19037),Ye=s(33929),$e=s(76463),Je=s(47307),Xe=s(91376),et=s(76464),tt=s(12714),st=s(99405),nt=s(95477),it=s(91924),ot=s(81575),at=s(47839),rt=s(15356),lt=s(9953),dt=s(31120);const ct=(0,r.defineMessages)({somethingWentWrong:{defaultMessage:"Something went wrong.",id:"slackActions.dialogError.loginWithSlack.errorMessage"},titleMessage:{defaultMessage:"Slack login",id:"slackActions.loginPopupModal.title"},removeIntegrationMessage:{id:"slackIntegrationButton.removeIntegrationConfirmationDialog.prompt",defaultMessage:"Are you sure you want to remove Slack integration?"},removeIntegrationConfirmationLabel:{id:"slackIntegrationButton.removeIntegrationConfirmationDialog.removeButton.label",defaultMessage:"Remove"}});const ut=async e=>{let{environment:t,blockId:s,intl:n}=e;ot.Mc(t),await async function(e){const{environment:t,blockId:s,intl:n}=e,i=(0,it.eC)(t);let o=(0,st.GD)(nt.default.domainBaseUrl,{blockId:s,authType:i,userId:t.currentUser.id});if(o=i.redirectToAuth?o:await(0,it.HU)(t,o),t.device.isElectron)return void at.openExternalUrl(o);const a=await rt.M(t,{width:530,height:530,url:o,titleMessage:ct.titleMessage});if(!a)return void Je.showErrorMessage(n.formatMessage(ct.somethingWentWrong));const r=(0,st.Wj)({url:a,isMobile:t.device.isMobile,baseUrl:nt.default.domainBaseUrl,publicDomainName:nt.default.publicDomainName,protocol:nt.default.protocol,currentUrl:window.location.href});"slackAuthCallback"===r.name&&dt.YU({route:r,environment:t})}({environment:t,blockId:s,intl:n})},mt=(0,r.defineMessages)({connectionLoadingLabel:{id:"topbar.connectionsSection.connectionLoading.label",defaultMessage:"Connections loading…"},connectionSearchPlaceholderLabel:{id:"topbar.connectionsSection.topbarMoreConnectionsSubMenu.label",defaultMessage:"Search for connections..."},connectionSearchErrorLabel:{id:"topbar.connectionsSection.connectionSearchError.label",defaultMessage:"Something went wrong"},connectionNoSearchResultsLabel:{id:"topbar.connectionsSection.noSearchResults.label",defaultMessage:"No results"},connectionSearchResultLabel:{id:"topbar.connectionsSection.connectionSearchResult.label",defaultMessage:"{name}"},slackEmptyLabel:{id:"topbar.connectionSection.slackEmpty.label",defaultMessage:"Slack"},slackConnectedLabel:{id:"topbar.connectionSection.slackConnected.label",defaultMessage:"Connected to Slack channel"},manageConnectionsLabel:{id:"topbar.connectionsSection.manageConnections.label",defaultMessage:"Manage connections"},addConnectionsLabel:{id:"topbar.connectionsSection.addConnections.label",defaultMessage:"Add connections"},fromParentPageLabel:{id:"topbar.connectionsSection.fromParenPage.label",defaultMessage:"From"},capabilitiesLabel:{id:"topbar.connectionsSection.capabilities.label",defaultMessage:"Capabilities"},disconnectLabel:{id:"topbar.connectionSection.disconnectIntegration.label",defaultMessage:"Disconnect"},disconnectConfirmationLabel:{id:"topbar.connectionSection.disconnectIntegrationConfirmation.label",defaultMessage:"{botName} will be removed from this page and all child pages. Continue?"},restrictionLabel:{id:"topbar.connectionSection.restrictIntegration.label",defaultMessage:"Restrict"},restrictionConfirmationLabel:{id:"topbar.connectionSection.restrictIntegrationConfirmation.label",defaultMessage:"Are you sure you want to remove this permission and restrict access? This page will no longer share settings from the parent page."},restrictionAcceptLabel:{id:"topbar.connectionSection.restrictAccept.label",defaultMessage:"Restrict access"},connectionLabel:{id:"topbar.connectionSection.connectionIntegration.label",defaultMessage:"{connectionName}"},connectionBotConfirmlabel:{id:"topbar.connectionSection.connectBotConfirmation.label",defaultMessage:"{botName} will have access to this and all child pages. Continue?"},connectionIntegrationConfirmlabel:{id:"topbar.connectionSection.connectIntegrationConfirmation.label",defaultMessage:"{integrationName} is developed by a third party partner and you will be redirected outside of Notion to authorize this connection. Continue?"}}),pt=Qe.ff(Qe.xD([Qe.tq,Qe.ff(Qe.xD([Qe.zz,Qe.J5]))]));function gt(){return{key:"connections loading",displayName:Ye.default.formatMessage(mt.connectionLoadingLabel),analyticsName:mt.connectionLoadingLabel.defaultMessage,searchName:mt.connectionLoadingLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,pt],render:e=>(0,z.jsx)(ue.Z,{...e,icon:(0,z.jsx)(ce.Z,{}),title:Ye.default.formatMessage(mt.connectionLoadingLabel)}),action:()=>{}}}function ht(e,t){return{key:"search connections input",analyticsName:mt.connectionSearchPlaceholderLabel.defaultMessage,displayName:Ye.default.formatMessage(mt.connectionSearchPlaceholderLabel),searchName:mt.connectionSearchPlaceholderLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,pt],render:()=>(0,z.jsx)(de.ZP,{value:e,onChange:e=>t(e.target.value),placeholder:Ye.default.formatMessage(mt.connectionSearchPlaceholderLabel),focus:!0}),action:()=>{}}}function ft(){return{key:"connections search error",displayName:Ye.default.formatMessage(mt.connectionSearchErrorLabel),analyticsName:mt.connectionSearchErrorLabel.defaultMessage,searchName:mt.connectionSearchErrorLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,pt],render:e=>(0,z.jsx)(me.Z,{title:Ye.default.formatMessage(mt.connectionSearchErrorLabel)}),action:()=>{}}}function xt(e){const{id:t,name:s}=e,n=Ye.default.formatMessage(mt.connectionSearchResultLabel,{name:s});return{key:`${t}`,displayName:n,analyticsName:n,searchName:s,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,pt],render:(t,s)=>(0,z.jsx)(le,{...t,bot:e,focused:t.focused,onClick:async()=>{await kt(s.blocks[0],s.environment,e)},ref:t.ref}),action:async t=>{await kt(t.blocks[0],t.environment,e)}}}function yt(e){const{id:t,name:s,info:n}=e,i=Ye.default.formatMessage(mt.connectionLabel,{connectionName:s});return{key:`${t}`,displayName:i,analyticsName:i,searchName:s,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,pt,Qe.ff(Qe.tq)],render:e=>(0,z.jsx)(oe.Z,{...e,title:i,icon:(0,z.jsx)("img",{src:n.icon,style:{width:18,height:"auto"},ref:e.ref})}),action:async t=>{let{environment:s}=t;e.id!==te.T0&&await async function(e,t){const{id:s,name:n}=e,i=await Je.confirmUserAction({message:Ye.default.formatMessage(mt.connectionIntegrationConfirmlabel,{integrationName:n})}),o=(0,ee.E)(s,n);i&&tt.D({environment:t,url:o,targetSelf:!1})}(e,s)}}}function St(e){const t=Ye.default.formatMessage(mt.slackEmptyLabel);return{key:"slack empty",displayName:t,analyticsName:mt.slackEmptyLabel.defaultMessage,searchName:t,closeParentMenu:!0,validators:[Qe.Gg,Qe.J5,Qe.YP,Qe.tJ,Qe.OF,Qe.ff(Qe.Fx)],render:s=>(0,z.jsx)(W.ZP,{placement:W.ug.Left,render:n=>(0,z.jsx)(oe.Z,{...(0,V.Z)(n,s),title:t,icon:(0,z.jsx)("img",{src:e.info.icon,style:{height:18}})}),renderTooltip:je}),action:e=>{var t;ut({environment:e.environment,blockId:null===(t=e.blocks)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.id,intl:Ye.default.getIntl()})}}}function vt(){const e=Ye.default.formatMessage(mt.slackConnectedLabel);return{key:"slack connected inherited",displayName:e,analyticsName:mt.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Qe.Gg,Qe.J5,Qe.ur,Qe.ff(Qe.Fx)],render:(e,t,s)=>(0,z.jsx)(Ce,{blockStore:t.blocks[0],...e}),action:e=>{}}}function bt(){const e=Ye.default.formatMessage(mt.slackConnectedLabel);return{key:"slack connected on block",displayName:e,analyticsName:mt.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Qe.Gg,Qe.J5,Qe.Rd,Qe.ff(Qe.Fx)],render:(e,t,s)=>(0,z.jsx)(ke,{blockStore:t.blocks[0],...e}),action:e=>{const{slackIntegrationStore:t}=(0,Se.Jk)(e.blocks[0]);((e,t,s)=>{Je.showDialog({message:s.formatMessage(ct.removeIntegrationMessage),showCancel:!0,keepFocus:!0,items:[{label:s.formatMessage(ct.removeIntegrationConfirmationLabel),color:"red",onAccept:()=>{ot.Uu(e),L.createAndCommit({userAction:"slackActions.handleRemoveSlackIntegration",environment:e,perform:e=>{lt.sW({store:t,data:{enabled:!1},transaction:e})}})}}]})})(e.environment,t,Ye.default.getIntl())}}}function Mt(e){const t=Ye.default.formatMessage(mt.fromParentPageLabel);return{key:"from parent page",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5],action:()=>{},render:(t,s)=>{let{blocks:n}=s;const i=n[0],o=Ue.G.createChildStore(i,{table:se.iU,id:e.blockId});return(0,z.jsx)(Tt,{parentBlockStore:o})}}}function jt(e){const t=Ye.default.formatMessage(mt.capabilitiesLabel);return{key:"capabilities",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5],action:()=>{},render:()=>(0,z.jsx)(he._,{role:e})}}function wt(e,t){const s=Ye.default.formatMessage(mt.disconnectLabel);return{key:"disconnect integration",displayName:s,analyticsName:s,searchName:mt.disconnectLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5],action:async s=>{let{blocks:n,environment:i}=s;const o=n[0];await async function(e,t,s,n){await Je.confirmUserAction({message:Ye.default.formatMessage(mt.disconnectConfirmationLabel,{botName:n})})&&$e.RN({botId:s,store:e,environment:t})}(o,i,e,t)},render:e=>(0,z.jsx)(O.Z,{...e,svg:J.f,title:s,focused:!0})}}function Ct(e){const t=Ye.default.formatMessage(mt.disconnectLabel),s=Ye.default.formatMessage(mt.restrictionLabel);return{key:"restrict page from permission model",displayName:s,analyticsName:s,searchName:mt.restrictionLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5],action:async t=>{let{blocks:s,environment:n}=t;const i=s[0];await async function(e,t,s){if(await Je.confirmUserAction({message:Ye.default.formatMessage(mt.restrictionConfirmationLabel),acceptLabel:Ye.default.formatMessage(mt.restrictionAcceptLabel)})){const n={type:"bot_permission",role:"none",bot_id:e};L.createAndCommit({userAction:"TopbarMoreConnections.restrictPagePermissions",environment:s,perform:e=>{et.Pk({environment:s,store:t,permissionItem:n,shouldInherit:!0,transaction:e})}})}}(e,i,n)},render:e=>(0,z.jsx)(O.Z,{...e,svg:J.f,title:t,focused:!0})}}async function kt(e,t,s){await Je.confirmUserAction({message:Ye.default.formatMessage(mt.connectionBotConfirmlabel,{botName:s.name})})&&$e.v2({botValue:s,store:e,environment:t})}function Tt(e){window.__c={n:"FromParentPageMenuItem"};const{parentBlockStore:t}=e,s=(0,o.VK)((()=>t.getIcon()),[t]),l=(0,o.VK)((()=>t.isEmptyPage()),[t]),c=(0,i.O7)(),u=(0,a.Fg)(),[m,p]=(0,n.useState)("transparent"),g=c.device.isMobile?{fontSize:14,paddingLeft:4}:{fontSize:12,paddingLeft:4};return(0,z.jsx)(me.Z,{...e,title:(0,z.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[(0,z.jsx)(r.FormattedMessage,{id:"topbar.connectionSection.parentPage.label",defaultMessage:"From"}),(0,z.jsxs)("span",{style:{display:"flex",alignItems:"center",padding:2,borderRadius:2,marginLeft:2,cursor:"pointer",backgroundColor:m,color:u.regularTextColor,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onClick:()=>{R._({environment:c,store:t,pageVisitSource:d.tY.LinkInPage})},onMouseEnter:()=>{p(u.selectLightGray[100])},onMouseLeave:()=>{p("transparent")},onMouseDown:()=>{p(u.selectLightGray[200])},onMouseUp:()=>{p(u.selectLightGray[100])},children:[(0,z.jsx)(pe.Z,{disabled:!0,icon:s,isEmptyPage:l,size:12,style:{margin:"0px 2px"}}),(0,z.jsx)(ge.Z,{store:t})]})]}),textWrapperStyle:g})}function It(e){return"legacy_integration"===e.table&&e.value.id===te.Cb.id}var Pt=s(67669);function Zt(e,t,s){const n=function(e){var t;const s=e.blocks[0],n=(0,Pt.YO)(s).filter((0,$.AO)((e=>(0,Q.FB)(e.permissionItem)?{true:{...e,permissionItem:e.permissionItem}}:{false:e})));if(0===n.length)return{status:"no bots"};const i=new Map,o=null===(t=ie.default.state.currentSpaceStore)||void 0===t?void 0:t.id,a=n.map((e=>{let{from:t,permissionItem:n}=e;const a=Ue.t1.createChildStore(s,{table:Y.cZ,id:n.bot_id,spaceId:o});if("block"===t.table)return i.set(n.bot_id,t),a})).filter($.$K);if(a.every((e=>e.isReady()))){const t=a.filter((t=>t.isDefined()&&Boolean((0,Ee.Nq)(e.environment,t.getModel()))));if((0,Ne.Fn)(e.environment)){const e=t.map((e=>e.getIntegrationId())),s=new Set(e),n=a.filter((e=>!(!e.isDefined()||s.has(e.getIntegrationId())||!Boolean((0,Ee.f_)(e.getModel()))||(s.add(e.getIntegrationId()),0))));t.push(...n)}return{status:"ready",botStores:t,botIdToSharedPageIds:i}}return{status:"loading"}}(e),{status:i}=n;if("no bots"===i||"loading"===i)return n;{const{botStores:e,botIdToSharedPageIds:i}=n;return{status:"ready",botActions:e.map((e=>{if(e.isDefined()){const n=e.getIntegrationId();n&&t.add(n);const o=i.get(e.id);if(o)return s.add(e.id),function(e){const{botStore:t,botPermissionSourcePage:s}=e,{id:n}=t,i=t.getName(),o=Ye.default.formatMessage(mt.connectionLabel,{connectionName:i});return{key:`${n}`,displayName:o,analyticsName:o,searchName:o,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5],action:()=>{},render:(e,n,i)=>{const a=n.blocks[0].id===s.blockId;return(0,z.jsx)(Ae,{...e,context:n,parent:i,isSharedDirectly:a,botStore:t,botPermissionSourcePage:s,originConnectionLabel:o})}}}({botStore:e,botPermissionSourcePage:o})}})).filter($.$K)}}}function Ft(e){const t=new Set,s=new Set,n=Zt(e,t,s),i=function(e,t){const s=Ye.default.formatMessage(mt.addConnectionsLabel);return{key:"add connections action",displayName:s,analyticsName:mt.addConnectionsLabel.defaultMessage,searchName:mt.addConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Qe.Gg,Qe.J5,pt],action:()=>{},render:(n,i,o)=>(0,z.jsx)(We,{...n,context:i,parent:o,alreadyConnectedIntegrationIds:e,alreadyConnectedBotIds:t,originButtonLabel:s})}}(t,s);if("no bots"===n.status)return{loadingAction:[],connectedActions:[],searchSubMenu:i};if("loading"===n.status)return{loadingAction:[gt()],connectedActions:[],searchSubMenu:i};{const{botActions:e}=n;return{loadingAction:[],connectedActions:e,searchSubMenu:i}}}function _t(e){const{loadingAction:t,connectedActions:s,searchSubMenu:n}=Ft(e);return{key:"topbar connections",render:e=>(0,z.jsx)(E.Z,{...e,topBorder:!0,title:(0,z.jsx)(r.FormattedMessage,{id:"topbar.connectionSection.label",defaultMessage:"Connections"})}),actions:[...t,...[vt(),bt()],...s,n]}}var At=s(48603),Rt=s(28020),Dt=s(68821),Bt=s(78316),Lt=s(77181),Ot=s(21969),Et=s(41984),Nt=s(24764),Vt=s(36896),Ut=s(44604),Wt=s(77556),Kt=s(77080),zt=s(47593),qt=s(30496),Gt=s(92083),Ht=s(34583),Qt=s(54669),Yt=s(41363),$t=s(29768),Jt=s(62967),Xt=s(42784),es=s(71247),ts=s(34658),ss=s(24212),ns=s(81267),is=s(5337),os=s(63029);const as=(0,r.defineMessages)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"Page history"},showDeletedPagesName:{id:"action.showDeletedPages.name",defaultMessage:"Show deleted pages"},importName:{id:"action.import.name",defaultMessage:"Import"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown & CSV"}});function rs(e){return(0,Jt.cN)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[Qe.or([Qe.ff(Qe.YG),Qe.f7]),Qe.J5],render:(t,s,n)=>{const i=s.blocks[0].getFormat().page_font,o=e.font===i||!e.font&&!i;return(0,z.jsx)(G,{...t,isActive:o,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption})},closeParentMenu:!1,action:(t,s)=>{let{blocks:n,environment:i}=t;L.createAndCommit({userAction:"actionRegistry.createFontAction",environment:i,perform:t=>{Z.FH({stores:n,update:{page_font:e.font},transaction:t}),w.G14(i,{type:e.font||"default"})}})}})}const ls=rs({displayName:as.fontDefaultName,caption:(0,z.jsx)(r.FormattedMessage,{...as.fontDefaultCaption}),font:void 0,tooltip:(0,z.jsx)(r.FormattedMessage,{...as.fontDefaultTooltip}),style:{fontSize:24,fontFamily:j.Z.getCompositeFontFamily(l.SP).sans,position:"relative",top:-2}}),ds=rs({displayName:as.fontSerifName,caption:(0,z.jsx)(r.FormattedMessage,{...as.fontSerifCaption}),font:"serif",tooltip:(0,z.jsx)(r.FormattedMessage,{...as.fontSerifTooltip}),style:{fontSize:25,fontFamily:j.Z.getCompositeFontFamily(l.SP).serif}}),cs=rs({displayName:as.fontMonoName,caption:(0,z.jsx)(r.FormattedMessage,{...as.fontMonoCaption}),font:"mono",tooltip:(0,z.jsx)(r.FormattedMessage,{...as.fontMonoTooltip}),style:{fontSize:26,fontFamily:j.Z.getCompositeFontFamily(l.SP).mono,position:"relative",top:-3,letterSpacing:-1}}),us=(0,Jt.$J)({key:"font section",title:as.fontStyleSection,render:e=>(0,z.jsx)(H,{...e}),actions:[ls,ds,cs]}),ms=(0,Jt.wL)({key:"small text",displayName:as.fontSmallTextKeywords,label:Ye.default.formatMessage(as.fontSmallTextLabel),property:"page_small_text",validators:[Qe.ff(Qe.tq),Qe.or([Qe.ff(Qe.YG),Qe.f7]),Qe.J5],afterAction:(e,t)=>w.DRv(t,{type:e?"small":"large"})}),ps=(0,Jt.wL)({key:"full width",displayName:as.fullWidthLabel,label:Ye.default.formatMessage(as.fullWidthLabel),property:"page_full_width",validators:[Qe.ff(Qe.Mn),Qe.ff(Qe.YG),Qe.J5],afterAction:(e,t)=>w.LDb(t,{type:e?"full_width":"default_width"})}),gs=(0,Jt.$J)({key:"page style",render:e=>(0,z.jsx)(E.Z,{...e}),actions:[ms,ps]}),hs=(0,Jt.cN)({key:"customize page",displayName:as.customizePageLabel,analyticsName:as.customizePageLabel.defaultMessage,svg:m.F,validators:[Qe.U_,Qe.ff(Qe.YG)],closeParentMenu:!0,render:e=>(0,z.jsx)(O.Z,{...e,title:(0,z.jsx)(r.FormattedMessage,{...as.customizePageLabel}),svg:m.F}),action:e=>{T.bA({originRect:e.originRect})}}),fs=(0,Jt.cN)({key:"page lock",displayName:as.lockPageName,analyticsName:as.lockPageName.defaultMessage,svg:x.b,validators:[Qe.ff(Qe.YG),Qe.J5,Qe.ff(Qe.p1)],closeParentMenu:!1,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=s[0];_.bo({environment:n,store:i,lock:!0})}}),xs=(0,Jt.cN)({key:"page unlock",displayName:as.unlockPageName,analyticsName:as.unlockPageName.defaultMessage,svg:v.U,validators:[Qe.ff(Qe.YG),Qe.J5,Qe.p1],closeParentMenu:!1,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=s[0];_.bo({environment:n,store:i,lock:!1})}}),ys=(0,Jt.cs)({key:"copy link to block non-desktop",displayName:Jt.RE.copyLinkNavigableTypeName,analyticsName:Jt.RE.copyLinkNavigableTypeName.defaultMessage,svg:f.N,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[Qe.jl,Qe.U7,Qe.ff(Qe.d)],closeParentMenu:!0,action:(e,t)=>{C.Hs({...e,event:t})}}),Ss=(0,Jt.cs)({key:"duplicate",displayName:Jt.RE.duplicateName,analyticsName:Jt.RE.duplicateName.defaultMessage,svg:p.a,validators:[Qe.DF,Qe.J5,Qe.KE,Qe.xk,Qe.ff(Qe.P9(c.Ti.externalObjectInstancePage))],shortcuts:["duplicate"],closeParentMenu:!0,action:async e=>{let{environment:t}=e;const s=Rt.np();if(!s)return;const n=s.getParentCollectionStore();if(n&&Ht.M_(t)){const e=new Wt.Z(t);e.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:n});Kt.default.checkGate("collection_subitem_nested_operations")&&(0,Lt.wP)(s,e)?await k.h5({environment:t,blocks:[s],collectionContextStore:e}):L.createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:t,perform:e=>{const[i,o]=I.Qi({environment:t,stores:[s],addCopyName:(0,Et.Z)(s),transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!s.isInsideTemplate(),targetSpaceId:(0,M.C)(n.pointer.spaceId),baseUrl:nt.default.domainBaseUrl,publicDomainName:nt.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1}),a=i[0];A.zw({childStore:a,parentStore:n,transaction:e}),s.isTemplate()&&F.R3({parent:n.getTemplatePagesStore(),append:a,transaction:e}),R._({environment:t,store:a,pageVisitSource:d.tY.Duplicate})}})}}}),vs=(0,Jt.cN)({key:"open in mac app",displayName:as.openinMacAppName,analyticsName:as.openinMacAppName.defaultMessage,svg:y.h,validators:[Qe.U7,Qe.ff(Qe.tY),Qe.ff(Qe.tq),Qe.V5],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,ye.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});D.RX({url:(0,Ot.W)(i),environment:n})}}),bs=(0,Jt.cN)({key:"open in windows app",displayName:as.openinWindowsAppName,analyticsName:as.openinWindowsAppName.defaultMessage,svg:y.h,validators:[Qe.U7,Qe.ff(Qe.tY),Qe.ff(Qe.tq),Qe.ED],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,ye.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});D.RX({url:(0,Ot.W)(i),environment:n})}}),Ms=(0,Jt.cN)({key:"open in ios app",displayName:as.openiniOSAppName,analyticsName:as.openiniOSAppName.defaultMessage,svg:y.h,validators:[Qe.U7,Qe.ff(Qe.tY),Qe.gn],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,ye.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});D.RX({url:i,environment:n})}}),js=(0,Jt.cN)({key:"open in android app",displayName:as.openinAndroidAppName,analyticsName:as.openinAndroidAppName.defaultMessage,svg:y.h,validators:[Qe.U7,Qe.ff(Qe.tY),Qe.Dt],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:n}=e;const i=(0,ye.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});D.RX({url:i,environment:n})}}),ws=(0,Jt.cN)({key:"open page updates",analyticsName:"Open page updates",displayName:as.pageUpdates,svg:u.t,validators:[Qe.RF,Qe.tq],closeParentMenu:!0,action:()=>{qt.Z.setState({open:!0})}}),Cs=(0,Jt.cN)({key:"action page history",displayName:as.pageHistoryName,analyticsName:as.pageHistoryName.defaultMessage,svg:b.w,validators:[Qe.or([Qe._T,Qe.k5]),Qe.Gg,Qe.DF,Qe.jl,Qe.ff(Qe.YO)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;return B.jN({environment:t,blockStore:s[0],from:"topbar"})},render:(e,t)=>{let{onClick:s,key:n,...i}=e,{environment:o}=t;return(0,z.jsx)(Qt.Z,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:s,alwaysAllowClick:!0,render:(e,t)=>(0,z.jsx)(O.Z,{...(0,V.Z)(i,e),title:Ye.default.formatMessage(as.pageHistoryName),svg:b.w,dontShrinkRight:!0,right:t}),renderUpgradeTooltip:()=>{}},n)}}),ks=(0,Jt.cN)({key:"open page trash",displayName:as.showDeletedPagesName,analyticsName:as.showDeletedPagesName.defaultMessage,svg:S.u,validators:[Qe.DF,Qe.J5,Qe.oY,Qe.jl,Qe.ff(Qe.nJ)],closeParentMenu:!0,action:()=>{Vt.Z.setState({open:!0}),Ut.Z.setState({...Ut.Z.state,currentTab:"in_current_page"})}}),Ts=(0,Jt.$J)({key:"pageHistory",render:e=>(0,z.jsx)(E.Z,{...e}),actions:[ws,os.Yw,Cs,At.pageAnalyticsMenu,ks,ss.Op]}),Is=(0,Jt.cN)({key:"open import modal",displayName:as.importName,analyticsName:as.importName.defaultMessage,svg:h.l,validators:[Qe.Gg,Qe.YZ,Qe.J5,Qe.ff(Qe.YG),Qe.ff(Qe.P9(c.Ti.externalObjectInstancePage))],closeParentMenu:!0,action:e=>{let{blocks:t}=e;(0,Dt.c)()?Gt.Z.setState({...Gt.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}):zt.Z.setState({open:!0,pageStore:t[0]})}}),Ps=(0,Jt.cN)({key:"export block",displayName:as.exportName,analyticsName:as.exportName.defaultMessage,validators:[Qe.Gg,Qe.jl,Qe.Kb],closeParentMenu:!0,render:e=>(0,z.jsx)(O.Z,{...e,svg:g.R,title:(0,z.jsx)(r.FormattedMessage,{...as.exportName}),caption:(0,z.jsx)(r.FormattedMessage,{...as.exportCaption})}),action:e=>{let{blocks:t,environment:s}=e;const n=t[0];if(!n.isDefined())return;let i=!0;const o=(0,Bt.fm)(t[0]);if(o){const e=null==o?void 0:o.collectionStore();null!=e&&e.isPageTreeCollection()&&(i=!1)}P.q$({environment:s,root:{id:n.id,table:"block",spaceId:n.getSpaceId()},isCollectionViewExportTypeSupported:i})}});var Zs=s(18514),Fs=s(13713),_s=s(83182),As=s(939),Rs=s.n(As),Ds=s(83355),Bs=s(49427);class Ls extends Ds.Z{constructor(){super(...arguments),this.wordCount=0}UNSAFE_willMount(){this.wordCount=function(e){const t=Bs.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return Rs()(e.innerText)}return 0}(this.props.store)}renderComponent(){return(0,z.jsx)(n.Fragment,{children:this.wordCount})}}Ls.displayName="PageWordCount";const Os=Ls;function Es(e){window.__c={n:"TopbarMoreMenu"};const{blockStore:t,onClickOriginRect:s,handleAccept:n,handleDismiss:l}=e,d=(0,i.O7)(),c=(0,i.Fy)(),m=(0,o.VK)((()=>({environment:d,blocks:[t],originRect:s,publicEditMode:void 0})),[d,t,s]),p=(0,o.VK)((()=>function(e){const{environment:t,context:s}=e,n=s.blocks[0],i=n.getFollowSettingsKey(),o=Kt.default.checkGate("property_updates_notifications"),a=(0,r.defineMessages)({getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"}}),l=o?Nt.CA({followSettingsKey:i,environment:t,blockStore:n,from:"more_menu"}):Nt.Zk({followSettingsKey:i,environment:t,blockStore:n,from:"more_menu"});return[us,gs,Xt.ww,(0,Jt.$J)({key:"topbar move or turn into actions",render:e=>(0,z.jsx)(E.Z,{...e}),actions:[is.bV,es.A]}),(0,Jt.$J)({key:"topbar database edit lock",render:e=>(0,z.jsx)(E.Z,{...e}),actions:[Yt.cO,Yt.YZ,Yt.Bj,Yt.BC,Yt.fK,Yt.MR,is.R$]}),(0,Jt.$J)({key:"topbar page edit lock",render:e=>(0,z.jsx)(E.Z,{...e}),actions:[hs,fs,xs]}),(0,Jt.$J)({key:"topbar primary actions",render:e=>(0,z.jsx)(E.Z,{...e}),actions:[Yt.q6,ss.hS,(0,Jt.MV)({key:"get notified for",displayName:a.getNotifiedFor,analyticsName:a.getNotifiedFor.defaultMessage,svg:u.t,width:300,initialFocus:l.findIndex((e=>e.isSelectedOption))??0,validators:[],subActions:()=>[(0,Jt.$J)({key:"get notified for",render:e=>(0,z.jsx)(E.Z,{...e}),actions:l.map((e=>{let{action:t}=e;return t}))})]}),os.aU,ys,Ss,$t.m7,$t.nh,$t.fI,$t.MI,ts.Jw,vs,bs,Ms,js,ns.l,Yt.GZ]}),Ts,(0,Jt.$J)({key:"topbar import actions",render:e=>(0,z.jsx)(E.Z,{...e}),actions:[Is,Ps,Yt.mS]}),_t(s)]}({environment:d,context:m})),[d,m]),g=(0,o.VK)((()=>!t.isCollectionView()&&t.canEdit()&&t.hasContent()),[t]),h=(0,o.VK)((()=>t.canEdit()),[t]),f=(0,o.VK)((()=>t.canEdit()&&t.isCollectionView()),[t]),x=(0,a.yK)((e=>({caption:{color:e.lightTextColor}})),[]),y=c.isMobile?{menuType:Ie.og.Modal,title:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),right:(0,z.jsx)(Fe.DoneMenuText,{}),onClickRight:l}:{menuType:Ie.og.Popup,maxHeight:"80vh"};return(0,z.jsxs)(Ze.Z,{...y,children:[(0,z.jsx)(Pe.Z,{sections:p,onAccept:n,context:m}),(g||h)&&(0,z.jsxs)(E.Z,{topBorder:!0,children:[g&&(0,z.jsx)(ue.Z,{caption:(0,z.jsx)("span",{style:x.caption,children:(0,z.jsx)(r.FormattedMessage,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,z.jsx)(Os,{store:t})}})})}),h&&(0,z.jsx)(Fs.Z,{store:t,isPageMoreButton:!0})]}),f&&(0,z.jsx)(Ns,{})]})}function Ns(){return(0,z.jsx)(E.Z,{topBorder:!0,children:(0,z.jsx)(_s.Z,{title:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Zs.UY)("guides.database"),analyticsFrom:"topbar_more_button"})})}},48603:(e,t,s)=>{s.r(t),s.d(t,{PageAnalyticsPageOptOut:()=>I,TopbarPageAnalyticsOptOutMenu:()=>T,TopbarPageAnalyticsOptOutMenuStore:()=>k,pageAnalyticsMenu:()=>C});s(67294);var n=s(480),i=s(86628),o=s(49085),a=s(83176),r=s(18442),l=s(9291),d=s(62967),c=s(97627),u=s(19037),m=s(18514),p=s(74948),g=s(36391),h=s(80444),f=s(73420),x=s(53437),y=s(72495),S=s(42402),v=s(55422),b=s(61881),M=s(85893);const j=(0,l.defineMessages)({pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"}}),w=e=>{const t=e.blocks[0];if(!t)return!1;return(0,b.W2)({canEditPage:t.canEdit(),device:e.environment.device})},C=(0,d.MV)({key:"page analytics menu",displayName:j.pageAnalyticsName,analyticsName:j.pageAnalyticsName.defaultMessage,validators:[u.DF],svg:a.z,subActions:e=>[{key:"view analytics",render:e=>(0,M.jsx)(y.Z,{...e}),actions:[(0,d.cN)({key:"view analytics",displayName:j.viewAnalyticsName,analyticsName:j.viewAnalyticsName.defaultMessage,svg:a.z,validators:[w],closeParentMenu:!0,action:()=>{p.handleSidebarButtonClick(e.environment,e.blocks[0],g.gY.Updates,"more_menu"),g.ZP.setState({...g.ZP.state,currentSubTab:g.uF.Analytics})}}),(0,d.cN)({key:"privacy settings",displayName:j.privacySettingsName,analyticsName:j.privacySettingsName.defaultMessage,svg:r.H,validators:[],closeParentMenu:!0,action:e=>{k.setState({isOpen:!0,rect:e.originRect})}})]}]}),k=o.default.createValue({isOpen:!1,rect:void 0}),T=()=>{window.__c={n:"TopbarPageAnalyticsOptOutMenu"};const e=(0,n.O7)(),t=(0,i.VK)((()=>k.state.isOpen),[]),s=(0,i.VK)((()=>k.state.rect),[]),o=(0,i.VK)((()=>h.default.state.mainEditorCurrentBlockStore),[]);return o?(0,M.jsx)(x.ZP,{popupType:e.device.isMobile?x.ZP.PopupType.SlideUp:x.ZP.PopupType.Popup,alignmentToOrigin:x.ZP.Alignment.Center,open:t,render:()=>(0,M.jsx)("div",{style:{minWidth:360,padding:16},children:(0,M.jsxs)(f.sg,{gap:16,children:[(0,M.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,M.jsx)(l.FormattedMessage,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,M.jsx)(I,{store:o})]})}),originRect:s,onDismiss:()=>k.setState({isOpen:!1,rect:void 0})}):null};function I(e){window.__c={n:"PageAnalyticsPageOptOut"};const t=(0,n.O7)(),s=(0,i.VK)((()=>{const e=h.default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),o=(0,i.VK)((()=>{const t=null==s?void 0:s.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[s,e.store.id]);return(0,M.jsx)(v.Z,{type:"dropdown",currentOption:o?"do_not_record":"record",options:[{key:"record",label:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:s=>{"do_not_record"===s?c.kY(t,e.store.id):c.pu(t,e.store.id)},isMobile:t.device.isMobile,title:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,M.jsx)(S.Z,{external:!0,href:(0,m.UY)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},88898:(e,t,s)=>{s.d(t,{O:()=>L});var n=s(67294),i=s(480),o=s(24405),a=s(53877),r=s(42875),l=s(19889),d=s(4308),c=s(50906),u=s(87279),m=s(78140),p=s(40721),g=s(13148),h=s(9291),f=s(52275),x=s(72495),y=s(85893);function S(e){const{onClick:t}=e;return(0,y.jsx)(x.Z,{topBorder:!0,children:(0,y.jsx)(f.Z,{focused:!1,icon:(0,g.U)({width:14,marginLeft:0}),title:(0,y.jsx)(h.FormattedMessage,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:{fontSize:14}})})}var v=s(30120),b=s(86628),M=s(28020),j=s(33929),w=s(66653),C=s(93289);const k=(0,h.defineMessages)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function T(e){window.__c={n:"VerificationCustomDatePicker"};const{onChange:t,clearCustomDatePicker:s}=e,i=(0,n.useRef)(e.today),o=(0,n.useRef)(e.today.plus({days:1})),[r,l]=(0,n.useState)(!1),d=(0,b.VK)((()=>M.AK.state),[]);return(0,y.jsxs)(x.Z,{mobileStyle:{paddingBottom:10},style:{padding:"12px 0"},children:[(0,y.jsx)(w.Z,{placeholder:j.default.formatMessage(k.placeholder),focused:r,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:a.ME(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const n=e.value&&a.XI(e.value);n?t({start:i.current,end:n.start}):s()},onFocus:()=>l(!0),onBlur:()=>l(!1),onClearButtonClick:s,hideClearButton:!0}),(0,y.jsx)(C.Z,{firstDayOfWeek:d,value:o.current.toMillis(),selectValue:!1,onChange:e=>{t({start:i.current,end:v.ou.fromMillis(e)})},disabledDays:{before:new Date(o.current.toMillis())}})]})}var I=s(36700),P=s(69651),Z=s(61768),F=s(70693);function _(e){window.__c={n:"VerificationExpiryPickerMenu"};const{verificationState:t,onChange:s,onCustomDateClick:i}=e,a=(0,h.useIntl)(),r=(0,n.useRef)(e.today),l=(0,o.yK)((e=>({title:{fontSize:14,color:e.regularTextColor},optionsContainer:{width:"100%"},clockIconStyle:{width:14,marginLeft:0,marginTop:2}})),[]),c="expired"===t.type||"none"===t.type?(0,y.jsx)(h.FormattedMessage,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,y.jsx)(h.FormattedMessage,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),u="verified"===t.type&&t.isIndefinite,m="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end;return(0,y.jsxs)(x.Z,{title:c,children:[d.Xs.map((e=>{const t=m&&d.fm({start:r.current,end:m})===e;return(0,y.jsx)(f.Z,{focused:!1,icon:(0,I.m)(l.clockIconStyle),inline:!1,title:(0,y.jsx)("span",{style:l.title,children:(0,y.jsx)(h.FormattedMessage,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:a.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:F.mb({dateTime:d.z5(e,r.current).end,intl:a,shortenDateAndRange:!0})}),checkState:!!t,onClick:()=>{return t=e,void s({start:r.current,end:r.current.plus({days:t})});var t}},e)})),(0,y.jsx)(f.Z,{focused:!1,icon:(0,Z.k)({width:14,marginLeft:0,marginTop:1}),inline:!1,title:(0,y.jsx)("span",{style:l.title,children:(0,y.jsx)(h.FormattedMessage,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>s(),checkState:u},"indefinite"),(0,y.jsx)(f.Z,{focused:!1,icon:(0,P.C)({width:14,marginLeft:0}),title:(0,y.jsx)("span",{style:l.title,children:(0,y.jsx)(h.FormattedMessage,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:i},"custom")]})}var A=s(66897),R=s(64369);function D(e){window.__c={n:"VerificationMetadata"};const{getRecordModel:t,actorPointer:s,lastVerifiedDate:n}=e,o=(0,i.Fy)(),a=(0,h.useIntl)(),r=(0,b.VK)((()=>(0,A.$4)(a,(0,A.Hl)({pointer:s,getRecordModel:t}))),[t,a,s]);return(0,y.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,y.jsx)(R.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,y.jsx)(h.FormattedMessage,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:r}})}),(0,y.jsx)(R.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:o.isMobile,children:(0,F.mb)({dateTime:n,intl:a})})]})}var B=s(11028);function L(e){window.__c={n:"VerificationPropertyOverlayMenu"};const{verificationValue:t,getRecordModel:s,onChange:g,blockId:h,propertyName:f,onClose:x}=e,v=(0,i.O7)(),b=(0,i.Fy)(),M=(0,o.Fg)(),[j,w]=(0,n.useState)(!1),C=(0,n.useMemo)((()=>d.WN(t)),[t]),k="verified"===C.type,I=(0,n.useRef)(a.Uu((0,r.r)())),P=(0,n.useRef)(a.Uu((0,r.r)()).plus({days:1})),Z=e=>{var t;const s=null===(t=v.currentUser)||void 0===t?void 0:t.id;if(!s)return;if(null!=e&&e.end&&e.end.toMillis()<P.current.toMillis())return;const n={table:l.KJ,id:s},i=e?a.OQ.toPersistedDateTimeRange(e):a.OQ.toPersistedDateTime(I.current.toMillis()),o="none"===C.type?"add":"update";c.s$$(v,{action:o,verification_page_id:h,verification_expiry:e?e.end.toMillis():void 0}),g({value:[n,i]})};let F={menuType:u.og.Popup,footer:"none"!==C.type&&(0,y.jsx)("div",{style:{borderTop:`1px solid ${M.regularDividerColor}`},children:(0,y.jsx)(D,{lastVerifiedDate:k&&C.isIndefinite?C.startDateTime:C.dateTimeRange.start,getRecordModel:s,actorPointer:C.actorPointer})})};return b.isMobile&&(F={...F,title:f,menuType:u.og.Modal,right:(0,y.jsx)(p.DoneMenuText,{}),onClickRight:x}),(0,y.jsx)(m.Z,{...F,header:!j&&"none"!==C.type&&(0,y.jsx)(y.Fragment,{children:(0,y.jsx)("div",{style:{padding:b.isMobile?10:7,paddingLeft:b.isMobile?20:7,background:b.isMobile?M.popoverBackground:M.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${M.regularDividerColor}`},children:(0,y.jsx)(B.z,{verificationValue:t})})}),children:j?(0,y.jsx)(T,{today:I.current,verificationState:C,onChange:e=>Z(e),clearCustomDatePicker:()=>w(!1)}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(_,{today:I.current,verificationState:C,onChange:e=>Z(e),onCustomDateClick:()=>w(!0)}),(k||"expired"===C.type)&&(0,y.jsx)(S,{onClick:()=>{c.s$$(v,{action:"remove",verification_page_id:h}),g({value:void 0})}})]})})}},83420:(e,t,s)=>{s.d(t,{TL:()=>u,nc:()=>c,ue:()=>d});var n=s(66897),i=s(54368),o=s(77420),a=s(19889),r=s(97880),l=s(26136);function d(e){const{parentStore:t,pointer:s}=e,i=(0,l.Kv)(t,s).getValue();if(i)return(0,n.LU)({table:s.table,value:i})}function c(e){const{parentStore:t,pointer:s}=e;return s.table===o.cZ?l.Qx.createChildStore(t,s):s.table===a.KJ?l.U6.createChildStore(t,s):s.table===i.y?l.fg.createChildStore(t,s):void(0,r.t1)(s)}function u(e){return e.table===o.cZ?(0,n.ON)(e.getValue()):e.table===a.KJ?(0,n.m3)(e.getValue()):e.table===i.y?(0,n.I4)(e.getValue()):void(0,r.t1)(e)}},76110:(e,t,s)=>{s.d(t,{Ix:()=>r,bv:()=>a});var n=s(13991);const i={"en-US":"https://player.vimeo.com/video/879544506?h=9314829857","fr-FR":"https://player.vimeo.com/video/880663447?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479","de-DE":"https://player.vimeo.com/video/879925635?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479","ja-JP":"https://player.vimeo.com/video/879925814?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479","ko-KR":"https://player.vimeo.com/video/880663466?badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479"},o="https://player.vimeo.com/video/881812861?h=55c8e40bb3";function a(){const e=i["en-US"];return i[n.SP]||e}function r(){return o}},72340:(e,t,s)=>{s.d(t,{$6:()=>a,CN:()=>i,Tc:()=>o});var n=s(77080);const i=5;function o(e){return"on"===n.default.getEligibleGroup({experimentId:"parallel_confluence_importer_via_api",defaultGroup:"control"})}function a(e){return n.default.getEligibleGroup({experimentId:"special_case_confluence_file_size",defaultGroup:i.toString()})}},8989:(e,t,s)=>{s.d(t,{b:()=>a,t:()=>o});var n=s(77080),i=s(72340);function o(){return"on"===n.default.getEligibleGroup({experimentId:"generic_importer",defaultGroup:"control"})}function a(e){const t=n.default.getEligibleGroup({experimentId:"special_case_generic_file_size",defaultGroup:i.CN.toString()});return Number(t)}},45567:(e,t,s)=>{s.d(t,{G7:()=>a,Gh:()=>l,LR:()=>o,gU:()=>r,jo:()=>i});var n=s(97880);const i="fileTypeAnyFiles",o="fileTypeImages",a="fileTypeVideos",r="fileTypeNone";function l(e){let{fileMimeType:t,allowedType:s}=e;switch(s){case i:return!0;case o:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case a:return function(e){return e.startsWith("video")}(t);case r:return!1;default:(0,n.t1)(s)}}},7314:(e,t,s)=>{s.d(t,{Z:()=>Q});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(8848),l=s(72126),d=s(9291),c=s(81918),u=s(3386),m=s(26388),p=s(7567),g=s(99273),h=s(55899),f=s(8675),x=s(22508),y=s(13394),S=(s(21703),s(72141)),v=s(82990),b=s(95209),M=s(42922),j=s(64369),w=s(44385),C=s(18168),k=s(26907),T=s(67669),I=s(53353),P=s(26781),Z=s(80444),F=s(35057),_=s(85893);function A(e){window.__c={n:"PersonPropertyInviteButton"};const{store:t,sudoModeStore:s,personPropertyInviteStore:a,onInviteCompleteFn:r,inviteOrigin:l}=e,u=(0,i.O7)(),p=L(),g=(0,o.qz)(e.inviteTargetsStore,h.ZP),f=(0,o.VK)((()=>a.state.isLoading),[a]),v=(0,n.useCallback)((e=>{a.setState({...a.state,isLoading:e,focus:y.S.NoFocus})}),[a]),[M,j]=(0,n.useState)("member"),A=(0,o.VK)((()=>{const{emailMessage:e}=a.state;return e}),[a]),O=(0,o.VK)((()=>{const{role:e}=a.state;return e}),[a]),E=(0,d.useIntl)(),N=(0,o.VK)((()=>a.state.flowId),[a]),V=(0,o.VK)((()=>Z.default.state.currentSpaceStore),[]),U=(0,o.VK)((()=>t.canEditMembership()),[t]),W=(0,o.VK)((()=>(0,k.B)({inviteTargetsStore:g})),[g]),K=(0,n.useCallback)((async()=>{await x.Uw({environment:u,inviteTargetsStore:g,personPropertyInviteStore:a,allowShowEmptyError:!0})}),[u,g,a]),z=(0,n.useCallback)((()=>{const e=(0,k.B)({inviteTargetsStore:g}),t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),s=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return T.dA(u,[...t,...s])}),[u,g]),q=(0,o.VK)((()=>z()),[z]),G=(0,o.VK)((()=>T.Z9()),[]),H=(0,I.Z)(t),Q=(0,o.VK)((()=>{if(H.isGuestRequestRequired)return!1;const e=H.isStoreInTeam&&!H.teamAllowsGuests,t=!H.isStoreInTeam&&!H.spaceAllowsGuests||H.isStoreInTeam&&!H.teamAllowsGuests&&!H.spaceAllowsGuests,s=W.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&s}),[W,H]),Y=(0,o.VK)((()=>null==V?void 0:V.getRole()),[V]),$=(0,o.VK)((()=>!(!Y||!(0,S.RN)(Y))&&!(!V||V.getDisableMembershipRequests())),[Y,V]),J=(0,o.VK)((()=>!!(Y&&(0,S.dy)(Y)&&(0,F.Mk)())||($||j("guest"),!1)),[Y,$,j]),X=(0,P.S)(t),ee=A.length>1e3,te=(0,n.useCallback)((e=>{const{response:t,shouldDoCompleteFn:s,invitedUserEmails:n,isRequestMember:i}=e;t.success?s&&(c.Y7(u,{invited_user_count:n.length,is_success:t.success,can_add_member:J,invite_option:M,origin:l,invite_flow_id:N}),x.TW({success:t.success,invitedUserEmails:n,isRequestMember:i}),v(!1),r(t)):(x.TW({success:t.success,invitedUserEmails:n}),c.Y7(u,{invited_user_count:n.length,is_success:t.success,can_add_member:J,invite_option:M,origin:l}))}),[r,N,v,u,M,J,l]),se=(0,n.useCallback)((async e=>{const{invitedUserEmails:n,shouldDoCompleteFn:i}=e;return await x.GZ({environment:u,inviteOrigin:l,role:O,emailMessage:A,inviteTargetsStore:g,blockStore:t,sudoModeStore:s,flowId:N,onInviteComplete:e=>{te({response:e,shouldDoCompleteFn:i||!1,invitedUserEmails:n})}})}),[u,O,A,t,s,N,g,te,l]),ne=(0,n.useCallback)((async e=>{const{invitedUserEmails:t,disable_invite_email:s,guestInviteResponse:n,shouldDoCompleteFn:i}=e;if(!V)return null;const o=null!=n&&n.success?n.invitedUsers:void 0;await x.E6({environment:u,spaceStore:V,flowId:N,onInviteComplete:e=>{te({response:e,shouldDoCompleteFn:i||!1,invitedUserEmails:t})},intl:E,invitedUsers:o,inviteTargetsStore:g,inviteOrigin:l,disable_invite_email:s})}),[V,u,N,g,E,te,l]),ie=(0,n.useCallback)((async e=>{const{invitedUserEmails:s,guestInviteResponse:n}=e;if(!V)return null;const i=null!=n&&n.success?n.invitedUsers:void 0;i&&await x.rw({environment:u,spaceStore:V,originType:"person_property_invite",intl:E,invitedUsers:i,reasonMessage:void 0,originId:t.id,flowId:N,onInviteComplete:e=>{te({response:e,shouldDoCompleteFn:!0,invitedUserEmails:s,isRequestMember:!0})},inviteOrigin:l})}),[u,N,V,E,te,t,l]),oe=(0,n.useCallback)((async()=>{const e="member"===M,t=g.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email));if(0===t.length)return void c.S4(u,{invite_stage:"click_invite_button",invite_flow_id:N,error:"No valid input emails"});const s=z();if(v(!0),e)if(s)await ne({invitedUserEmails:t,disable_invite_email:!1,guestInviteResponse:void 0,shouldDoCompleteFn:!0});else{const e=!J&&!$,s=await se({invitedUserEmails:t,shouldDoCompleteFn:e});J?await ne({invitedUserEmails:t,disable_invite_email:!0,guestInviteResponse:s,shouldDoCompleteFn:!0}):$&&await ie({invitedUserEmails:t,guestInviteResponse:s})}else s?c.S4(u,{invite_stage:"click_invite_button",invite_flow_id:N,error:"Invite guest with guest limitation exceed"}):await se({invitedUserEmails:t,shouldDoCompleteFn:!0});v(!1),g.reset()}),[u,J,$,M,N,z,g,se,ne,ie,v]),ae=(0,n.useCallback)((async()=>{await K();const e=(0,k.B)({inviteTargetsStore:g}).length;c.tX(u,{invited_user_count:e,invite_option:M,can_add_member:J,origin:l,inviteTargets:g.state.inviteTargets.map((e=>e.type.toString())),inviteTokenQuery:g.state.tokenQuery,invite_flow_id:N}),await oe()}),[u,N,K,oe,M,J,g,l]);let re;re=Q?X:ee?(0,_.jsx)(d.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0;const le=(0,n.useMemo)((()=>[{key:"member",render:()=>(0,_.jsx)(m.ZP,{disableTooltip:J||$,renderTooltip:()=>(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.invite_member.tooltip",defaultMessage:"You do not have permission to add or request members to this workspace"}),render:e=>(0,_.jsx)(B,{isSelected:"member"===M,inviteOption:"member",events:e})}),isDisabled:!J&&!$},{key:"guest",render:()=>(0,_.jsx)(m.ZP,{disableTooltip:!q&&G,renderTooltip:()=>(0,_.jsx)(w.e,{}),render:e=>(0,_.jsx)(B,{isSelected:"guest"===M,inviteOption:"guest",events:e})})}]),[M,q,G,$,J]);return(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,_.jsx)("div",{style:p.section,children:(0,_.jsx)(C.Z,{items:le,itemStyle:p.itemStyle,innerStyle:p.innerStyle,value:M,onChange:e=>{j(e),c.Io(u,{invite_option:e,invite_flow_id:N,origin:l})}})}),!q&&G||"guest"!==M?(0,_.jsx)(D,{tooltip:re,disabled:!U||Q||ee,onClick:ae,isLoading:f}):(0,_.jsx)(R,{onClick:()=>{c.ZA(u,{invited_user_count:W.length,invite_flow_id:N,origin:l}),b.Vu({environment:u,upgradeButtonName:"user_permission_item"})}})]})}function R(e){const{onClick:t}=e;return(0,_.jsx)(m.ZP,{disableTooltip:!1,renderTooltip:()=>(0,_.jsx)(w.e,{}),render:e=>(0,_.jsx)(M.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},onClick:t,...e,children:(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.upgrade",defaultMessage:"Upgrade"})})})}function D(e){const{tooltip:t,disabled:s,onClick:n,isLoading:i}=e;return(0,_.jsx)(m.ZP,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,_.jsx)(M.Z,{isLarge:!0,style:{margin:"0 16px 16px 16px",borderRadius:6},disabled:s,onClick:n,...e,isLoading:i,children:(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.invite",defaultMessage:"Invite"})})})}function B(e){window.__c={n:"InviteOptionBox"};const{isSelected:t,inviteOption:s,events:n}=e,i=L(),o=t?i.mainTextSelected:i.mainTextUnselected;let a,r;switch(s){case"guest":a=(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsGuest.title",defaultMessage:"Add to page only"}),r=(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsGuest.subtitle",defaultMessage:"Invite as a Guest"});break;case"member":a=(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsMember.title",defaultMessage:"Add to Workspace"}),r=(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.addAsMember.subtitle",defaultMessage:"Invite and bill as a Member"});break;default:throw new Error(`Unsupported invite option: ${s}`)}return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{style:i.row,...n,children:(0,_.jsxs)("div",{style:o,children:[a,(0,_.jsx)(j.Z,{isSmall:!0,style:i.optionSubtitle,children:r})]})})})}function L(){return(0,a.yK)((e=>({mainTextSelected:{fontWeight:v.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14,lineHeight:"14px"},mainTextUnselected:{color:e.mediumTextColor,fontSize:14,lineHeight:"14px"},row:{display:"flex",alignItems:"center",justifyContent:"center",gap:4,lineHeight:"14px"},section:{padding:"16px 11px 16px 11px"},itemStyle:{margin:5,borderRadius:8,borderWidth:2},innerStyle:{borderWidth:0},optionSubtitle:{whiteSpace:"pre-wrap",paddingTop:2,fontSize:12}})),[])}var O=s(80721),E=s(73063);function N(e){let{handleBackButtonClick:t}=e;window.__c={n:"PersonPropertyInviteHeader"};const s=(0,a.yK)((()=>({container:{display:"flex",margin:"0 12px 0px",height:40}})),[]);return(0,_.jsx)("div",{style:s.container,children:(0,_.jsx)(V,{onClick:t})})}function V(e){window.__c={n:"BackButton"};const{onClick:t}=e,s=(0,d.useIntl)(),n=(0,a.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:v.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:v.Z.fontWeight.medium}})),[]);return(0,_.jsxs)("div",{style:n.topContainer,children:[(0,_.jsx)(E.Z,{icon:O.W,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,_.jsx)(j.Z,{style:n.sendInviteLabel,children:(0,_.jsx)(d.FormattedMessage,{id:"invite.person_property.popup_title",defaultMessage:"Invite and mention"})})]})}var U=s(94044),W=s(74194),K=s(19306);const z=l.Ds((e=>{let{environment:t,flowId:s,origin:n}=e;c.KZ(t,{origin:n,invite_flow_id:s})}),1e3);function q(e){window.__c={n:"PersonPropertyInviteMessageInput"};const{inviteTargetsStore:t,personPropertyInviteStore:s,inviteOrigin:a}=e,r=(0,i.O7)(),{focus:l,emailMessage:d}=(0,o.VK)((()=>{const{focus:e,emailMessage:t}=s.state;return{focus:e,emailMessage:t}}),[s]),c=(0,o.VK)((()=>s.state.flowId),[s]),u=(0,n.useCallback)((()=>{t.reset()}),[t]),m=(0,n.useCallback)((e=>{s.setState({...s.state,focus:l,emailMessage:e.target.value}),z({environment:r,flowId:c,origin:a})}),[r,s,c,a,l]),p=(0,n.useCallback)((()=>{u()}),[u]),g=(0,n.useCallback)((()=>{s.setState({...s.state,focus:y.S.MessageInput,emailMessage:d})}),[s,d]);return(0,_.jsx)(G,{focus:l===y.S.MessageInput,value:d,onFocus:g,onChange:m,onCancel:p,maxLength:1e3,inviteTargetsStore:t})}function G(e){window.__c={n:"EmailMessageInput"};const{focus:t,value:s,maxLength:n,inviteTargetsStore:r,onFocus:l,onChange:c,onCancel:u}=e,m=(0,d.useIntl)(),p=s.length/n>=.8,g=(0,U.TQ)(s),h=p||g,f=(0,i.Fy)(),x=(0,a.yK)((e=>({container:{maxHeight:80,bottom:0,padding:"2px 16px 2px 16px",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",overflow:"hidden",zIndex:1,height:72},input:{maxHeight:80,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:2,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s",height:"100%"},inputBox:{padding:"0px 4px 0px 4px",boxShadow:e.inputBoxShadow,background:e.inputBackground,width:"auto",height:"100%",borderRadius:6,...t&&{background:"none",boxShadow:"rgba(35, 131, 226, 0.57) 0px 0px 0px 1px inset, rgba(35, 131, 226, 0.35) 0px 0px 0px 2px"}}})),[t]),y=(0,o.VK)((()=>r.state.inviteTargets.filter((e=>"newUser"===e.type||"existingUser"===e.type)).map((e=>e.value.email))),[r]),S=(0,o.VK)((()=>y.length>0?m.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.withEmails",defaultMessage:"Add a message for {users}"},{users:(0,K.W)(y)}):m.formatMessage({id:"invite.person_property.emailMessageInput.placeholder.noEmails",defaultMessage:"Add a message to your invite..."})),[m,y]);return(0,_.jsxs)("div",{style:x.container,children:[h&&(0,_.jsx)(H,{value:s,maxLength:n,shouldShowLengthWarning:p,shouldShowLinkWarning:g}),(0,_.jsx)(W.Z,{textarea:!0,focusInitial:!1,format:W.B.Transparent,placeholder:S,maxlength:n,focus:t,value:s,onFocus:l,onChange:c,inputStyle:x.input,onCancel:u,style:x.inputBox,onClick:()=>{f.isMobile||null==l||l()}})]})}function H(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:s,value:n,maxLength:i}=e,o=(0,a.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,_.jsx)("div",{style:o.container,children:(0,_.jsxs)("div",{style:o.warning,children:[t&&(0,_.jsx)(d.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:n.length,maxCharacters:i}}),t&&s&&" · ",s&&(0,_.jsx)(d.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}function Q(e){window.__c={n:"PersonPropertyInvitePopup"};const{store:t,handleBackButtonClick:s,onInviteCompleteFn:r,inviteTargetsStore:d,personPropertyInviteStore:c,inviteOrigin:m}=e,p=(0,o.qz)(void 0,f.Z),g=(0,i.O7)(),h=(0,n.useCallback)((async()=>{await x.Uw({environment:g,inviteTargetsStore:d,personPropertyInviteStore:c,allowShowEmptyError:!1})}),[g,d,c]),y=(0,a.yK)((()=>({container:{position:"relative",width:450,transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:500},searchBar:{paddingLeft:16,paddingRight:16,paddingBottom:16,paddingTop:16},horizontalLine:{margin:"0",color:"#E3E2E0",opacity:.3}})),[]);return(0,_.jsx)(u.Z,{capture:!0,onLeft:l.yR,onRight:l.yR,onSelectAll:l.yR,onRedo:l.yR,onUndo:l.yR,onCut:l.yR,onCopy:l.yR,onPaste:l.yR,onKeypress:l.yR,onDelete:l.yR,onBackspace:l.yR,onTab:l.yR,onEnter:h,children:(0,_.jsxs)("div",{style:y.container,children:[(0,_.jsx)(N,{handleBackButtonClick:s}),(0,_.jsx)("hr",{style:y.horizontalLine}),(0,_.jsx)("div",{style:y.searchBar,children:(0,_.jsx)(Y,{store:t,inviteTargetsStore:d,personPropertyInviteStore:c,inviteOrigin:m})}),(0,_.jsx)(q,{store:t,inviteTargetsStore:d,personPropertyInviteStore:c,inviteOrigin:m}),(0,_.jsx)("div",{children:(0,_.jsx)(A,{store:t,inviteTargetsStore:d,sudoModeStore:p,onInviteCompleteFn:r,personPropertyInviteStore:c,inviteOrigin:m})})]})})}function Y(e){window.__c={n:"InviteSection"};const{store:t,personPropertyInviteStore:s,inviteOrigin:n}=e,l=(0,d.useIntl)(),u=(0,i.O7)(),f=(0,o.qz)(e.inviteTargetsStore,h.ZP),{focus:x,emailMessage:S}=(0,o.VK)((()=>{const{focus:e,emailMessage:t}=s.state;return{focus:e,emailMessage:t}}),[s]),{role:v,showEmptyError:b}=(0,o.VK)((()=>{const{role:e,showEmptyError:t}=s.state;return{role:e,showEmptyError:t}}),[s]),M=(0,o.VK)((()=>t.getType()),[t]),j=(0,o.VK)((()=>s.state.flowId),[s]),w=(0,o.VK)((()=>t.canEditMembership()),[t]),C=(0,a.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:4,color:r.ZP.uiGray}})),[]);return(0,_.jsx)(m.ZP,{disableTooltip:w,renderTooltip:()=>{if(!w)return(0,_.jsx)(d.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,_.jsx)("div",{style:{display:"flex"},...e,children:(0,_.jsx)(g.Z,{store:t,inviteTargetsStore:f,disabled:!w,origin:n,flowId:j,focus:x===y.S.InviteInput,hideIconColorAndTooltips:!0,showEmptyError:b,onFocus:()=>{s.setState({...s.state,focus:y.S.InviteInput,emailMessage:S||""})},placeholder:l.formatMessage({id:"invite.person_property.inviteTargetsInput.placeholder",defaultMessage:"Add emails..."}),onInputChanged:()=>s.setState({...s.state,showEmptyError:!1}),right:(0,_.jsx)(p.ZP,{disabled:!w,role:v,table:"block",type:"user_permission",blockType:M,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:C.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>{s.setState({...s.state,role:e}),c.Om(u,{invited_role:e,invite_flow_id:j,origin:n})}})})})})}},13394:(e,t,s)=>{s.d(t,{S:()=>o,Z:()=>r});var n=s(49085),i=s(4615);let o=function(e){return e.InviteInput="invite_input",e.MessageInput="message_input",e.NoFocus="no_focus",e}({});class a extends n.default{getInitialState(){return{flowId:(0,i.ZP)(),role:"editor",focus:o.InviteInput,emailMessage:"",isLoading:!1,showEmptyError:!1}}}const r=a},35868:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},24764:(e,t,s)=>{s.d(t,{t0:()=>M,Zk:()=>v,CA:()=>S});s(67294);var n=s(92996),i=s(98519),o=s(97880),a=s(9291),r=s(62967),l=s(57883),d=s(19719),c=s(9953),u=s(82530);function m(e){const{environment:t,key:s,selectedKey:n,following:i,followSettings:o,navigableBlockId:a,userId:r,spaceId:m,from:p}=e;u.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{c.Ue({environment:e.environment,table:l.t0,args:{following:i,followSettings:o,navigableBlockId:a,userId:r,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),i?d.RJ(t,{from:"page_updates"}):d.ub(t,{from:"page_updates"}),n!==s&&d.kL(t,{from:p,navigableBlockId:a,oldSetting:n,newSetting:s})}var p=s(64964),g=s(93405),h=s(64369),f=s(80444),x=s(57538),y=s(85893);function S(e){const{followSettingsKey:t,environment:s,blockStore:i,from:o}=e,r=b({key:"none",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),environment:s,blockStore:i,from:o}),l=b({key:"comments",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),environment:s,blockStore:i,from:o}),d=b({key:"all",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),environment:s,blockStore:i,from:o}),c=i.getAssociatedCollectionStore();if(!c)return[l,r];const u=c.getDatabaseType();if(u===n.iS){return[d,b({key:"important",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),environment:s,blockStore:i,from:o}),r]}if(u===n.wW){return[d,b({key:"important",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),environment:s,blockStore:i,from:o}),r]}return[d,b({key:"comments",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),environment:s,blockStore:i,from:o}),r]}function v(e){const{followSettingsKey:t,environment:s,blockStore:n,from:i}=e;return[b({key:"important",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.label",defaultMessage:"All comments"}),caption:(0,y.jsx)(a.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.allComments.caption",defaultMessage:"Notified of all comments and @mentions"}),environment:s,blockStore:n,from:i}),b({key:"none",selectedKey:t,title:(0,y.jsx)(a.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.label",defaultMessage:"Replies and @mentions"}),caption:(0,y.jsx)(a.FormattedMessage,{id:"inAppNotificationsFollowingOptionsHelpers.mentionsAndReplies.caption",defaultMessage:"Notified of comment replies and @mentions"}),environment:s,blockStore:n,from:i})]}function b(e){const{key:t,title:s,caption:n,selectedKey:o,environment:a,blockStore:l,from:d}=e,c=M({key:t,userSelectedKey:o}),u={icon:{width:14,height:14},rightWrapper:n?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,r.cN)({key:t,displayName:void 0,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=f.default.state;if(e){const{following:s,followSettings:n}=(0,x.Z)(t),i=e.id,r=l.id,c=l.getSpaceId();m({environment:a,following:s,followSettings:n,navigableBlockId:r,spaceId:c,userId:i,from:d,key:t,selectedKey:o}),"inbox"!==d&&"more_menu"!==d||p.d4({item:{label:j(t)},undoFunc:()=>{const{following:e,followSettings:s}=(0,x.Z)(o);m({environment:a,following:e,followSettings:s,navigableBlockId:r,spaceId:c,userId:i,from:d,key:t,selectedKey:o})}})}},render:e=>(0,y.jsx)(g.Z,{...e,title:(0,y.jsx)(h.Z,{children:s}),caption:n,shouldWrapCaption:!0,right:c?(0,i.k)(u.icon):(0,y.jsx)("div",{style:u.icon}),rightStyle:u.right})}),title:s,isSelectedOption:c}}function M(e){const{key:t,userSelectedKey:s}=e;return"important"===s||"comments"===s?"important"===t||"comments"===t:t===s}function j(e){switch(e){case"none":return(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,y.jsx)(a.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,o.t1)(e)}}},84437:(e,t,s)=>{s.d(t,{WS:()=>y,fW:()=>h,sh:()=>g});var n=s(72126),i=s(4615),o=s(64002),a=s(50906),r=s(54642),l=s(47839),d=s(12714),c=s(82530),u=s(37181),m=s(95477),p=s(71574);function g(e){const{environment:t,spaceStore:s,collectionViewStore:n}=e;if(!!s&&!(0,p.tE)())return void async function(e){const{environment:t,spaceStore:s,collectionViewStore:n}=e,a=x({spaceStore:s,collectionViewStore:n}),r=(0,i.ZP)(),l=o.bf({url:m.default.cron.notionAuthUrl,query:{...a,csrf:r}});await(0,p.PQ)({environment:t,csrf:r}),d.D({environment:t,url:l})}(e);const a=n?m.default.cron.openNotionDatabaseUrl:m.default.cron.domainBaseUrl,r=x({collectionViewStore:n,spaceStore:s});!async function(e){const{environment:t,url:s,targetSelf:n}=e;if(!t.device.isElectron)return d.D({environment:t,url:s,targetSelf:n});const{desktopProtocol:i}=m.default.cron;if(!(await l.isProtocolRegistered(i)))return d.D({environment:t,url:s,targetSelf:n});const o=s.replace(/^https?:/,`${i}:`);l.openExternalUrl(o)}({environment:t,url:o.bf({url:a,query:r})})}async function h(e){const{environment:t,csrf:s,calendarCsrf:i,spaceId:o,integration:l,redirectUri:d,state:c}=e;if(!(await(0,p.Bs)({environment:t,csrf:s})))return void f({environment:t,redirectUri:d,query:n.GM({state:c},n.o8)});const u=await r.createOauthAuthorizationCode(t,{integrationId:l.id,spaceId:o,redirectUri:d,acceptedIntegrationCapabilities:l.capabilities});if("failed"===u.type)return void f({environment:t,redirectUri:d,query:n.GM({state:c},n.o8)});a.dld(t);const m={code:u.data.code,calendarCsrf:i,state:c};f({environment:t,redirectUri:d,query:n.GM(m,n.o8)})}function f(e){const{environment:t,redirectUri:s,query:n}=e,i=o.bf({url:s,query:n});d.D({environment:t,url:i,targetSelf:!0})}function x(e){const{spaceStore:t,collectionViewStore:s}=e;if(!t&&!s)return{};const i={env:"production",collection_view_id:null==s?void 0:s.id,workspace_id:null==t?void 0:t.id};return n.GM(i,n.o8)}function y(e,t){const{phase:s,transactionUserAction:n,userSettingsStore:i}=t;c.createAndCommit({environment:e,userAction:n,perform:e=>{u.d2({userSettingsStore:i,transaction:e,data:{notion_calendar_launch_modal_phase:s}})}})}},77832:(e,t,s)=>{s.r(t),s.d(t,{default:()=>B});var n=s(67294),i=s(13991),o=s(480),a=s(86628),r=s(24405),l=s(59054),d=s(32697),c=s(64275),u=s(89806),m=s(68211),p=s(1436),g=s(82990),h=s(9291),f=s(47839),x=s(12714),y=s(66309),S=s(97122),v=s(42922),b=s(64921),M=s(61519),j=s(84076),w=s(74420),C=s(64369),k=s(6175),T=s(95477),I=s(80444),P=s(77080),Z=s(84437),F=s(71574),_=s(85893);const A=(0,h.defineMessages)({continueWithGoogle:{id:"notionCalendarLaunchButton.continueWithGoogle",defaultMessage:"Continue with Google"},downloadApp:{id:"notionCalendarLaunchButton.downloadApp",defaultMessage:"Download app"},openCalendar:{id:"notionCalendarLaunchButton.openCalendar",defaultMessage:"Open Calendar"}});function R(e){window.__c={n:"PrimaryButton"};const t=(0,o.O7)(),s=D(),n=(0,a.VK)((()=>(0,F.tE)()),[]),[{value:i}]=(0,l.r5)((async()=>{var e;return!(null===(e=f.electronApi)||void 0===e||!e.isProtocolRegistered)&&f.electronApi.isProtocolRegistered(T.default.cron.desktopProtocol)}),[]);return t.device.isElectron?i?(0,_.jsx)(v.Z,{style:s.primaryButton,onClick:e.onOpenCalendarClick,children:(0,_.jsx)(h.FormattedMessage,{...A.openCalendar})}):(0,_.jsx)(v.Z,{style:s.primaryButton,onClick:e.onDownloadClick,children:(0,_.jsx)(h.FormattedMessage,{...A.downloadApp})}):n?(0,_.jsx)(v.Z,{style:s.primaryButton,onClick:e.onOpenCalendarClick,children:(0,_.jsx)(h.FormattedMessage,{...A.openCalendar})}):(0,_.jsxs)(S.h,{styles:s.primaryButton,onClick:e.onContinueWithGoogleClick,children:[(0,u.R)(s.googleLogoIcon),(0,_.jsx)(h.FormattedMessage,{...A.continueWithGoogle})]})}function D(){return(0,r.yK)((e=>({container:{maxWidth:442},closeButton:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:18,height:18},closeButtonHovered:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.mediumTextColor},content:{padding:24,display:"flex",flexDirection:"column"},newBadge:{margin:"6px 0 0 0",alignSelf:"start"},title:{fontWeight:g.Z.fontWeight.bold,fontSize:25,display:"flex",marginBottom:6},titleHighlight:{marginLeft:4,color:e.blueColor},divider:{backgroundColor:e.tableLightDividerColor,opacity:.5},footer:{padding:"20px 24px",display:"flex",alignItems:"center",justifyContent:"space-between"},learnMoreLink:{display:"flex",alignItems:"center",fontSize:12,color:e.mediumTextColor,padding:"0 4px",marginLeft:-4},externalLinkIcon:{width:14,height:14,marginLeft:2},primaryButton:{height:32,marginLeft:8,fontSize:14},googleLogoIcon:{width:14,height:14,marginRight:8},successCheckmark:{width:50,height:50,display:"flex",alignItems:"center",justifyContent:"center"},successCheckmarkIcon:{width:32,height:32,color:e.mediumTextColor},successTitle:{fontSize:25,fontWeight:g.Z.fontWeight.bold,margin:"8px 0"},downloadContainer:{display:"flex",padding:"16px 20px",marginTop:28,borderRadius:12,background:e.cardBackground},downloadContent:{display:"flex",flexDirection:"column",paddingRight:8},downloadTitle:{fontSize:16,fontWeight:g.Z.fontWeight.semibold,marginBottom:4},downloadButtonContainer:{display:"flex"},downloadButton:{height:32,marginTop:12},notionCalendarLogo:{display:"flex",alignSelf:"end"},notionCalendarLogoIcon:{width:56,height:58}})),[])}const B=function(){window.__c={n:"NotionCalendarLaunchModal"};const e=(0,o.O7)(),t=D(),s=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t}=I.default.state;t&&Z.WS(e,{phase:"dismissed_modal",transactionUserAction:"NotionCalendarLaunchModal.clickCancel",userSettingsStore:t})}),[e]),r=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:s}=I.default.state;t&&s&&(Z.sh({environment:e,spaceStore:void 0,collectionViewStore:void 0}),Z.WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.openCalendar",userSettingsStore:t}))}),[e]),l=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:s}=I.default.state;t&&s&&(Z.sh({environment:e,spaceStore:s,collectionViewStore:void 0}),Z.WS(e,{phase:"connected_notion_calendar",transactionUserAction:"NotionCalendarLaunchModal.continueWithGoogle",userSettingsStore:t}))}),[e]),u=(0,n.useCallback)((()=>{const{currentUserSettingsStore:t}=I.default.state;t&&(x.D({environment:e,url:T.default.cron.downloadUrl}),Z.WS(e,{phase:"dismissed_completely",transactionUserAction:"NotionCalendarLaunchModal.clickDownload",userSettingsStore:t}))}),[e]),g=(0,a.VK)((()=>I.default.state.currentUserSettingsStore),[]),f=(0,a.VK)((()=>{const e=null==g?void 0:g.getSettings();return null==e?void 0:e.notion_calendar_launch_modal_phase}),[g]),S=(0,a.VK)((()=>{const{currentUserSettingsStore:t,currentSpaceStore:s,mainEditorCurrentBlockStore:n}=I.default.state;if(!P.default.checkGate("notion_calendar_launch_modal"))return!1;if(e.device.isMobile)return!1;if(!t||!t.isReady())return!1;return!!t.getSettings()&&(!!(s&&n&&n.canRead())&&(e.device.isElectron?void 0===f:void 0===f||"connected_notion_calendar"===f))}),[e,f]),F=()=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(b.Z,{onClick:s,style:t.closeButton,hoveredStyle:t.closeButtonHovered,children:(0,c.D)(t.closeIcon)}),(0,_.jsxs)("div",{style:t.content,children:[(0,_.jsx)("div",{style:t.successCheckmark,children:(0,d.e)(t.successCheckmarkIcon)}),(0,_.jsx)("div",{style:t.successTitle,children:(0,_.jsx)(h.FormattedMessage,{defaultMessage:"Success!",id:"notionCalendarLaunchModal.successTitle",values:{highlight:function(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return(0,_.jsx)("div",{style:t.titleHighlight,children:s})}}})}),(0,_.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,_.jsx)(h.FormattedMessage,{defaultMessage:"You can now view Notion docs, projects, tasks, and timelines alongside calendar events on Notion Calendar",id:"notionCalendarLaunchModal.successCaption"})}),(0,_.jsxs)("div",{style:t.downloadContainer,children:[(0,_.jsxs)("div",{style:t.downloadContent,children:[(0,_.jsx)("div",{style:t.downloadTitle,children:(0,_.jsx)(h.FormattedMessage,{defaultMessage:"Get the desktop app",id:"notionCalendarLaunchModal.downloadTitle"})}),(0,_.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,_.jsx)(h.FormattedMessage,{defaultMessage:"See notifications, view your schedule, and join meetings from anywhere",id:"notionCalendarLaunchModal.downloadCaption"})}),(0,_.jsx)("div",{style:t.downloadButtonContainer,children:(0,_.jsx)(v.Z,{style:t.downloadButton,onClick:u,children:(0,_.jsx)(h.FormattedMessage,{...A.downloadApp})})})]}),(0,_.jsx)("div",{style:t.notionCalendarLogo,children:(0,m.D)(t.notionCalendarLogoIcon)})]})]})]}),B=()=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(k.Z,{src:"https://player.vimeo.com/video/879544506?h=9314829857",defaultTextTrack:k.W[i.SP]||"en",options:{muted:!0,autoplay:!0,loop:!0}}),(0,_.jsx)(b.Z,{onClick:s,style:t.closeButton,hoveredStyle:t.closeButtonHovered,children:(0,c.D)(t.closeIcon)}),(0,_.jsxs)("div",{style:t.content,children:[(0,_.jsx)(w.Z,{style:t.newBadge}),(0,_.jsx)("div",{style:t.title,children:(0,_.jsx)(h.FormattedMessage,{defaultMessage:"Meet <highlight>Notion Calendar</highlight>",id:"notionCalendarLaunchModal.title",values:{highlight:function(){for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return(0,_.jsx)("div",{style:t.titleHighlight,children:s})}}})}),(0,_.jsx)(C.Z,{isSecondaryColor:!0,isMultiline:!0,children:(0,_.jsx)(h.FormattedMessage,{defaultMessage:"The beautifully designed calendar for your life and work. Integrated and synced with all your Google Calendar events.",id:"notionCalendarLaunchModal.caption"})})]}),(0,_.jsx)(M.Z,{size:1,style:t.divider}),(0,_.jsxs)("div",{style:t.footer,children:[(0,_.jsxs)(j.Z,{external:!0,href:"https://www.notion.so/calendar",style:t.learnMoreLink,children:[(0,_.jsx)(h.FormattedMessage,{defaultMessage:"Learn more",id:"notionCalendarLaunchModal.learnMore"}),(0,p.g)(t.externalLinkIcon)]}),(0,_.jsx)(R,{onOpenCalendarClick:r,onContinueWithGoogleClick:l,onDownloadClick:u})]})]});return(0,_.jsx)(y.default,{shouldShow:S,calloutId:"notion_calendar_launch_promo",desktopRenderInner:()=>"connected_notion_calendar"===f?F():B(),desktopInnerStyle:t.container,desktopOnDismiss:s,phoneRenderInner:()=>null})}},71574:(e,t,s)=>{s.d(t,{Bs:()=>g,PQ:()=>p,ZH:()=>c,tE:()=>u});var n=s(77657),i=s(4615),o=s(95477),a=s(12955),r=s(53410),l=s(77080),d=s(30874);async function c(e){const{environment:t}=e;return!!l.default.checkGate("notion_calendar")&&(!t.device.isMobile&&(!t.device.isElectron||async function(){if(!u())return!1;if(null===r.C||void 0===r.C||!r.C.isProtocolRegistered)return!1;return await r.C.isProtocolRegistered(o.default.cron.desktopProtocol)}()))}function u(){const{bots:e,externalAuthentications:t}=d.Z,s=e.state.find((e=>e.integration_id===n.Dv));if(!s)return!1;const i=t.state.find((e=>e.parent_id===s.id));return Boolean(i)}const m="notion_calendar_csrf";async function p(e){const{environment:t,csrf:s}=e;await(0,a.setCookie)(t,{name:m,value:s})}async function g(e){const{environment:t,csrf:s}=e,n=await(0,a.getCookie)(t,m),o=!!n&&(0,i.t)(n)&&n===s;return(0,a.removeCookie)(m),o}},36214:(e,t,s)=>{s.d(t,{FI:()=>k,sM:()=>C,vY:()=>T});s(21703);var n=s(13991),i=s(72126),o=(s(4615),s(45953)),a=(s(21202),s(15047),s(11002)),r=s(27095),l=s(73314),d=s(9291),c=s(32441),u=s(54642),m=s(54532),p=s(86282),g=s(9953),h=s(4408),f=s(28014),x=s(82530),y=s(88833),S=(s(95477),s(33929)),v=s(27249),b=s(80444),M=s(88632),j=s(77080);const w=(0,d.defineMessages)({invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnCreateTemplate:{defaultMessage:"Invalid space view data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidStorage.message"},invalidUserSettings:{defaultMessage:"Invalid user settings data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidUserSettings.message"}});async function C(e){const{environment:t,spaceViewStore:s,isPrivate:o,userSettingsStore:a,redirectData:r,userRootStore:l,planType:d,spaceJoinOrCreate:u,teamStore:m,templates:h,templateType:M,personaTeamStore:C,isNewUserOnboarding:T}=e,I=s.getSpaceStore();if(!I)throw new Error(S.default.formatMessage(w.invalidSpaceStore));let P,Z=[];if(a&&I&&h&&(Z=await async function(e){const{spaceStore:t,spaceViewStore:s,userSettingsStore:n,teamStore:o}=e;if(await Promise.all(i.oA([t.load(),s.load(),n.load(),null==o?void 0:o.load()])),t.canEdit()){if(!s.isDefined())throw new Error(S.default.formatMessage(w.invalidSpaceStoreOnCreateTemplate));if(!n.isDefined())throw new Error(S.default.formatMessage(w.invalidUserSettings));if(!s.getCreatedOnboardingTemplates()){return await async function(e){var t;const{environment:s,spaceStore:n,spaceViewStore:o,isPrivate:a,teamStore:r,personaTeamStore:l,templateType:d,userSettingsStore:c}=e;let u=[];if("page_template"===d&&e.templates){const t=e.templates.map((e=>r?p.rC({environment:s,item:e,isPrivate:!1,spaceStore:n,spaceViewStore:o,useMinimalTemplates:!0,teamStore:r,type:"inTeam",from:"onboarding",isOnboarding:!0}):p.rC({environment:s,item:e,isPrivate:a,spaceStore:n,spaceViewStore:o,useMinimalTemplates:!0,type:"inSpace",isOnboarding:!0})));u=i.oA(await Promise.all(t))}else"app_template"===d&&e.templates&&r&&(u=await y.installAppsInTeam({environment:s,presets:e.templates,spaceStore:n,spaceViewStore:o,teamStore:r}));const m=null===(t=c.getSettings())||void 0===t?void 0:t.persona;if(l&&m){let e=[];if(["product","marketing","sales","eng"].includes(m)){e="on"===j.default.getEligibleGroup({defaultGroup:"control",experimentId:"persona_template_truncation"})?(0,v.OJ)(m,j.default,S.default.getIntl()):(0,v.CN)(m,j.default,S.default.getIntl())}const t=e.map((e=>p.rC({environment:s,item:e,isPrivate:!1,spaceStore:n,spaceViewStore:o,useMinimalTemplates:!0,teamStore:l,type:"inTeam",from:"onboarding",isOnboarding:!0})));u=[...u,...i.oA(await Promise.all(t))]}e.templates&&e.templates.length>0&&x.createAndCommit({userAction:"spaceActions.createOnboardingTemplatesInSpace",environment:s,perform:e=>{const t={created_onboarding_templates:!0};g.sW({store:o,data:t,transaction:e})}});return u}({...e})}}return[]}({...e,spaceStore:I,userSettingsStore:a,teamStore:m,personaTeamStore:C})),a)P=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:i,userSettingsStore:o,planType:a,spaceJoinOrCreate:r,isNewUserOnboarding:l}=e;if(await Promise.all([s.load(),i.load(),o.load()]),s.canEdit()){if(!i.isDefined())throw new Error(S.default.formatMessage(w.invalidSpaceStoreOnCreateTemplate));if(!o.isDefined())throw new Error(S.default.formatMessage(w.invalidUserSettings));const e=function(e,t){if(e.device.isMobile)return null;if("en-US"!==n.SP)return null;if(!t)return null;switch(j.default.getEligibleGroup({defaultGroup:"control",experimentId:"learn_notion_three_steps"})){case"on":return"learnNotionThreeSteps";case"control":return null}}(t,l);let d;if(d=e||(t.device.isMobile?"mobile":"personal"===a?"desktopPersonal":"create"===r?"desktopTeamCreate":"desktopTeamJoin"),!i.getCreatedGettingStarted())return k({environment:t,spaceStore:s,spaceViewStore:i,type:d,userSettingsStore:o});c.VU(t,{getting_started_page_type:d,spaceId:s.id,errorType:"createdGettingStartedPageAlreadyExists"})}}({isNewUserOnboarding:T,environment:t,spaceStore:I,spaceViewStore:s,userSettingsStore:a,planType:d,spaceJoinOrCreate:u});else{const{currentUserSettingsStore:e}=b.default.state;c.VU(t,{errorType:"userSettingsStoreNotDefined",spaceId:I.id,errorMessage:e?"currentUserSettingsStore is defined but not userSettingsStore from onboarding data":"currentUserSettingsStore is not defined as well"})}return await async function(e){const{environment:t,spaceViewStore:s,isPrivate:n,redirectData:i,userRootStore:o,templateType:a,spaceStore:r,createdTemplatePages:l,createdGettingStartedPage:d}=e;if("fork_page"===i.type){return await f.ux({environment:t,userRootStore:o,isPrivate:n,forkedPageId:i.pageId,spaceStore:r,spaceViewStore:s})}if("app_template"===a&&l.length>0){return"on"===j.default.getEligibleGroup({experimentId:"team_land_getting_started",defaultGroup:"control"})?d:l[0]}return d}({environment:t,redirectData:r,spaceViewStore:s,spaceStore:I,userRootStore:l,isPrivate:o,templateType:M,createdTemplatePages:Z,createdGettingStartedPage:P})}async function k(e){const{environment:t,type:s,spaceStore:n,spaceViewStore:i,userSettingsStore:a}=e;if(!M.Z.state.online)return;const d=function(e,t){return(0,l.G)(r.S$[e],t)}(s,S.default.getIntl()).rootId,p=await u.loadBlockSubtree(t,{block:{id:d,spaceId:n.id},shallow:!1});let y;if("failed"===p.type)return void c.VU(t,{getting_started_page_type:s,errorType:"loadBlockSubtreeFailed",spaceId:n.id,errorMessage:p.error.message,copyPageId:d});y=o.PF.create(p.data.subtreeRecordMap);const v="spaceActions.createGettingStartedPageInSpace",{performResult:b}=x.createAndCommit({userAction:v,environment:t,perform:e=>{const o=f.KE({environment:t,spaceStore:n,spaceViewStore:i,isPrivate:!0,prepend:!0,transaction:e});h.fL({environment:t,inMemoryRecordCache:o.inMemoryRecordCache,recordMap:y,debugSource:v});const r=m.K8(t,{blockId:d,inMemoryRecordCache:o.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!r)throw c.VU(t,{getting_started_page_type:s,errorType:"createAndDuplicatePageFailed",spaceId:n.id}),new Error(S.default.formatMessage(f.sY.createAndDuplicatePageError));m.E9({environment:t,sourceBlockId:d,targetBlockPointer:o.pointer,sourceBlockSubtree:r,targetInMemoryRecordCache:o.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:o.useCrdt()});const l={},u={};return"evernote"===s?u.created_evernote_getting_started=!0:l.created_getting_started=!0,Object.keys(l).length>0&&g.sW({store:i,data:l,transaction:e}),Object.keys(u).length>0&&g.sW({store:a.getSettingsStore(),data:u,transaction:e}),o}});return c.yv(t,{getting_started_page_type:s,getting_started_page_id:d,duplicated_from_page_id:d,duplicated_to_page_id:b.id}),b}function T(e,t){return"school"===e?(0,l.H)(P,t):"personal"===e?(0,l.H)(I,t):(0,l.H)(Z,t)}const I=[a.Y.quickNoteV2,a.Y.personalHomeV2,a.Y.taskList,a.Y.journalV2,a.Y.readingListV2],P=[a.Y.classNotesV2,a.Y.cornellNotesSystemV2,a.Y.clubHomepageV2,a.Y.gradeCalculatorV2],Z=[a.Y.teamMeetingNotes,a.Y.teamDocs,a.Y.teamHome,a.Y.teamTasks,a.Y.taskList]},55535:(e,t,s)=>{s.d(t,{W:()=>a,Z:()=>l});var n=s(67294),i=s(51077),o=s(85893);const a=16;function r(e){let{icon:t,style:s,size:n=a}=e;return(0,o.jsx)(i.Z,{type:"notion_icon",size:n,icon:`/icons/${t}_lightgray.svg`,largeIcon:!0,style:s})}const l=n.memo(r)},84198:(e,t,s)=>{s.d(t,{Z:()=>f});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(82990),l=s(75024),d=s(50334),c=s(94841),u=s(49085);class m extends u.default{getInitialState(){return!1}}var p=s(22863),g=s(55535),h=s(85893);const f=function(e){let{children:t,title:s,icon:u,panelStyle:f,headerStyle:x,rightStyle:y,actions:S,right:v,disableRightFadeIn:b}=e;window.__c={n:"PersonalHomePanelPreview"};const M=(0,i.MO)(),j=(0,i.O7)(),w=Boolean(v),C=(0,o.qz)(void 0,m),k=(0,n.useMemo)((()=>({isHoveredOnPanelStore:C})),[C]),T=(0,n.useCallback)((()=>C.setState(!0)),[C]),I=(0,n.useCallback)((()=>C.setState(!1)),[C]),P=(0,a.yK)((e=>({panel:{zIndex:1,position:"relative",display:"flex",flexDirection:"column",borderRadius:M?12:6,padding:c.A5,paddingBottom:20,background:e.home.tile.background,boxShadow:(0,c._U)({isPhone:M,theme:e}),...c.MI,...f},headerContainer:{flexShrink:0,display:"flex",justifyContent:"space-between",alignItems:"center",height:c.jX,marginTop:-c.A5,...x},panelTitleAndIcon:{display:"flex",alignItems:"center",fontSize:(0,l.yv)(j,"UISmall"),fontWeight:r.Z.fontWeight.medium,color:e.text.secondary,flexShrink:0,maxWidth:w?200:"100%"},title:{...r.Z.textOverflowStyle},panelIconContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:g.W,height:g.W,marginRight:8,marginTop:1},actions:{display:"flex",flexDirection:"row",paddingLeft:6}})),[M,f,x,j,w]);return(0,h.jsx)(d.L8,{value:k,children:(0,h.jsxs)("div",{style:P.panel,onMouseEnter:T,onMouseLeave:I,children:[(0,h.jsxs)("div",{style:P.headerContainer,children:[(0,h.jsxs)("div",{style:P.panelTitleAndIcon,children:[(0,h.jsx)("div",{style:P.panelIconContainer,children:u}),(0,h.jsx)("span",{style:P.title,children:s}),(0,h.jsx)(p.Z,{additionalStyles:P.actions,children:S})]}),w&&(0,h.jsx)(p.Z,{force:b?"forceShow":void 0,additionalStyles:y,children:v})]}),t]})})}},22863:(e,t,s)=>{s.d(t,{Z:()=>d});var n=s(67294),i=s(24405),o=s(97880),a=s(86628),r=s(50334);var l=s(85893);const d=function(e){let{additionalStyles:t,transitionMs:s,force:d,children:c}=e;window.__c={n:"FadeInOnPanelHoverWrapper"};const u=function(){var e;const t=null===(e=(0,n.useContext)(r.uU))||void 0===e?void 0:e.isHoveredOnPanelStore;return(0,a.VK)((()=>Boolean(null==t?void 0:t.getState())),[t])}(),m=(0,i.yK)((()=>{let e;switch(d){case"forceShow":e=1;break;case"forceHide":e=0;break;case void 0:e=u?1:0;break;default:(0,o.t1)(d)}return{hoverStyle:{opacity:e,transition:`opacity ${(0,o.$K)(s)?s:200}ms ease-in`,...t}}}),[t,d,u,s]);return(0,l.jsx)("div",{style:m.hoverStyle,children:c})}},50334:(e,t,s)=>{s.d(t,{L8:()=>o,uU:()=>i});const n=(0,s(67381).Q)({displayName:"HomePanelContext",legacyContextKey:"homePanelContext",modernContextDefaultValue:{isHoveredOnPanelStore:void 0}}),i=n.context,o=n.Provider;n.legacyPropTypes},14568:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(35431);class i extends n.Z{}const o=new i},48608:(e,t,s)=>{s.d(t,{Z:()=>U});s(67294);var n=s(83355),i=s(86628),o=s(24405),a=s(49085),r=s(79362),l=s(89036),d=s(40462),c=s(54855),u=s(19889),m=s(2438),p=s(97880),g=s(9291),h=s(91219),f=s(42922),x=s(64921),y=s(60458),S=s(63296),v=s(31278),b=s(26388),M=s(64369),j=s(29302),w=s(43250),C=s(79817),k=s(19306),T=s(38755),I=s(95697),P=s(24646),Z=s(85834),F=s(77080),_=s(26136),A=s(88893),R=s(35057),D=s(88280),B=s(73466),L=s(10039),O=s(85893);const E={padding:12,display:"flex",flexDirection:"column",gap:16};class N extends n.Z{constructor(){super(...arguments),this.storeTypes={contextualInviteStore:Z.ZP,isSpaceCardSelected:a.default.createClass(!1)}}didMount(){h.$2(this.environment,C.Oh(this.environment,this.stores.contextualInviteStore)),(0,I.$)(this.environment)&&this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:Z.uq.page_guest})}renderComponent(){var e;const{contextualInviteStore:t}=this.stores,s=D.subscriptionDataStoreInstance.state,n=(s?A.CM(s):[]).filter(m.iB).map((e=>_.U6.createChildStore(this.props.spaceStore,{table:u.KJ,id:e.userId}))),i=(null===(e=t.state)||void 0===e?void 0:e.shareModalGuestMemberConfirmationExpGroup)||"control",o=t.getGuestEmails(),a=(0,k.W)(n.map((e=>e.getDisplayName(this.props.intl))),{removeComma:!0,useAmpersand:!0});if(!o.length)return null;const r=(0,I.$)(this.environment),l=(0,T.Q6)(this.props.spaceStore),d=!(0,R.wP)()&&"on"===F.default.getEligibleGroup({experimentId:"acq_display_admin_invite_request_v1",defaultGroup:"control"});return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)("div",{className:w.B8p,style:{...E,paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18},children:(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,O.jsxs)("div",{children:[t.state.inviteStage===Z.TG.share_workspace?(0,O.jsx)(W,{useZeroTeamsExperience:r,shareModalGuestMemberConfirmationExpGroup:i,guestEmails:o,useGuestInviteRequestExperience:l}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(M.Z,{style:{fontWeight:600,marginBottom:4},children:l?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also request to add as member"}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.requestToWorkspace.title",defaultMessage:"Request to add to workspace"})}),(0,O.jsxs)(M.Z,{isMultiline:!0,isSmall:!0,children:[l?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.requestToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:o.length}}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.requestToWorkspace.subtitle",defaultMessage:"Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:o.length}}),d&&(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.requestToWorkspace.adminUsers.subtitle_followup",defaultMessage:" Requests can be approved by <withTooltip>{admins}</withTooltip>.",values:{emailCount:o.length,admins:a,withTooltip:e=>(0,O.jsx)(q,{chunks:e,adminUserStores:n,maxAdminUsers:20})}})]})]}),(0,O.jsx)("div",{style:{display:"flex",flexWrap:"wrap",marginTop:16,marginBottom:16},children:(0,O.jsx)(K,{spaceStore:this.props.spaceStore,emails:o,shareModalGuestMemberConfirmationExpGroup:i})})]})}),"control"===i?this.renderSpaceCard({showSpaceCardToggle:r}):this.renderGuestMemberCards({shareModalGuestMemberConfirmationExpGroup:i}),(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,O.jsx)(S.Z,{isLarge:!0,style:{marginRight:10},onClick:async()=>{var e,s;"control"===i?this.selectPageGuestOption():(t.setState({...t.state,selection:Z.uq.closed}),null===(e=(s=t.state).resetShareMenuFn)||void 0===e||e.call(s));await this.handleInviteClick()},children:"control"===i?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.cancel.button",defaultMessage:"Cancel"})}),(0,O.jsx)(f.Z,{isLarge:!0,disabled:r&&!this.stores.isSpaceCardSelected.state||!r&&this.stores.contextualInviteStore.state.selection===Z.uq.closed,onClick:async()=>{"control"===i&&(t.state.inviteStage===Z.TG.share_workspace&&this.selectWorkspaceMemberOption(),t.state.inviteStage===Z.TG.request_workspace&&this.selectRequestWorkspaceMemberOption()),await this.handleInviteClick()},children:(0,O.jsx)(V,{inviteStage:t.state.inviteStage,shareModalGuestMemberConfirmationExpGroup:i,useGuestInviteRequestExperience:l})})]})]})})})}renderGuestMemberCards(e){let{shareModalGuestMemberConfirmationExpGroup:t}=e;return"v1"!==t&&"v2"!==t?null:(0,O.jsxs)("div",{style:{display:"flex",gap:8,flexDirection:"column"},children:[(0,O.jsx)("div",{children:(0,O.jsx)(z,{title:"v1"===t?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v1",defaultMessage:"Guest"}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v2",defaultMessage:"Invite to Page"}),subtitle:(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.subtitle",defaultMessage:"Can access only this page"}),icon:(0,c.a)({fill:r.Lr[this.theme.mode].yellow,width:22,height:24}),selected:this.stores.contextualInviteStore.state.selection===Z.uq.page_guest,onClick:()=>{this.selectPageGuestOption()}})}),(0,O.jsx)("div",{children:(0,O.jsx)(z,{title:"v1"===t?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v1",defaultMessage:"Member"}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v2",defaultMessage:"Invite to Workspace"}),subtitle:(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.subtitle",defaultMessage:"Can access all pages in {spaceName}. This person will be billed as a member.",values:{spaceName:(0,T.rn)(this.environment,this.props.spaceStore)}}),icon:(0,d.o)({fill:r.Lr[this.theme.mode].green,width:22,height:24}),selected:this.stores.contextualInviteStore.state.selection===Z.uq.workspace_member,onClick:()=>{this.selectWorkspaceMemberOption()}})})]})}renderSpaceCard(e){let{showSpaceCardToggle:t}=e;const{spaceStore:s}=this.props,n=(0,T.Wd)(this.environment,s),i=(0,T.rn)(this.environment,this.props.spaceStore),o=s.getPublicSpaceData();let a;o&&"none"!==o.role&&(a=(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.spaceCard.subtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:this.props.intl.formatNumber(o.memberCount),planType:this.props.intl.formatMessage((0,P.em)(o.subscriptionTier))}}));const r=n||i?(0,O.jsx)(v.Z,{disabled:!0,icon:n,isEmptyPage:!1,title:i,size:30,style:{color:this.theme.regularTextColor,marginRight:12}}):(0,l.v)({width:20,height:20,fill:this.theme.lightIconColor});return(0,O.jsxs)(x.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:5,padding:12,justifyContent:"space-between",alignItems:"center"},disabled:!t,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state),children:[(0,O.jsxs)("div",{style:{display:"flex"},children:[r,(0,O.jsxs)("div",{children:[(0,O.jsx)(M.Z,{children:i}),(0,O.jsx)(M.Z,{isSmall:!0,children:a})]})]}),t&&(0,O.jsx)(y.Z,{round:!0,checked:this.stores.isSpaceCardSelected.state,fill:this.theme.contentBackground,size:20,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state)})]})}selectWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:Z.uq.workspace_member})}selectRequestWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:Z.uq.request_workspace_member})}selectPageGuestOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:Z.uq.page_guest})}async handleInviteClick(){const{contextualInviteStore:e}=this.stores,{spaceStore:t,blockStore:s,intl:n}=this.props,{shareModalGuestMemberConfirmationExpGroup:i,callbackAsyncFn:o}=e.state;if(e.state.inviteStage===Z.TG.closed||e.state.inviteStage===Z.TG.share_page)return;const{selection:a}=e.state;switch(a){case Z.uq.request_workspace_member:h.ci(this.environment,{...C.Oh(this.environment,e),from:"share_menu"}),await C.fC({environment:this.environment,spaceStore:t,originId:s.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:e,intl:n});break;case Z.uq.workspace_member:if(h.E0(this.environment,C.Oh(this.environment,e)),(0,I.$)(this.environment)){e.setState({...e.state,inviteStage:Z.TG.closed});if(!(await B.HD({environment:this.environment,flowId:e.state.flowId??"",trackCreateTeamComplete:!1})))return}"control"!==i&&await(null==o?void 0:o()),await C.j_({environment:this.environment,spaceStore:t,contextualInviteStore:e,from:"page_contextual_invite",intl:n});break;case Z.uq.page_guest:"control"!==i&&await(null==o?void 0:o()),e.reset();break;case Z.uq.closed:e.reset();break;default:(0,p.t1)(a)}}}function V(e){const{inviteStage:t,shareModalGuestMemberConfirmationExpGroup:s,useGuestInviteRequestExperience:n}=e;return t===Z.TG.share_workspace?"control"===s?n?(0,O.jsx)(g.FormattedMessage,{id:"ContextualInvite.addToWorkspace.guestInviteRequestEnabled.button",defaultMessage:"Add member to workspace"}):(0,O.jsx)(g.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button",defaultMessage:"Add to workspace"}):(0,O.jsx)(g.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button.variant",defaultMessage:"Invite"}):n?(0,O.jsx)(g.FormattedMessage,{id:"ContextualInvite.sendRequest.guestInviteRequestEnabled.button",defaultMessage:"Send member request"}):(0,O.jsx)(g.FormattedMessage,{id:"ContextualInvite.sendRequest.button",defaultMessage:"Send request"})}N.displayName="ContextualInvite";const U=(0,g.injectIntl)(N);function W(e){let{useZeroTeamsExperience:t,useGuestInviteRequestExperience:s,shareModalGuestMemberConfirmationExpGroup:n,guestEmails:o}=e;window.__c={n:"ShareWorkspace"};const a=(0,i.VK)((()=>!(0,R.QM)()),[]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(M.Z,{style:{fontWeight:600,marginBottom:4},children:["control"===n?s?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.title",defaultMessage:"Also add as member"}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.title",defaultMessage:"Add to workspace"}):void 0,"v1"===n?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v1",defaultMessage:"Invite as guest or member?"}):void 0,"v2"===n?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v2",defaultMessage:"Invite to page or workspace?"}):void 0]}),"control"===n?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(M.Z,{isMultiline:!0,isSmall:!0,style:{marginBottom:6},children:s?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.guestInviteRequestEnabled.subtitle",defaultMessage:"Guest {emailCount, plural, one {request} other {requests}} sent. Do you want to add {emailCount, plural,\none {this person}\nother {these people}\n} to the workspace in addition to the page? {isPaid, select,\ntrue {This is a billable event.}\nother {}\n}",values:{emailCount:o.length,isPaid:a}}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.subtitle",defaultMessage:"Do you want to add {emailCount, plural,\none {this person}\nother {these people}\n} to the workspace in addition to the page? {isPaid, select,\ntrue {This is a billable event.}\nother {}\n}",values:{emailCount:o.length,isPaid:a}})}),(0,O.jsx)(M.Z,{isMultiline:!0,isSmall:!0,children:t?(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle.blockLimit",defaultMessage:"Adding them as a member will auto-create a teamspace{isFreeTier, select,\nfree { and apply the 1,000 block limit to your workspace.}\nother {}\n}",values:{isFreeTier:a?"paid":"free"}}):(0,O.jsx)(g.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle",defaultMessage:"{isFreeTier, select,\nfree {This action will apply the 1,000 block limit to your workspace.}\nother {}\n}",values:{emailCount:o.length,isFreeTier:a?"paid":"free"}})})]}):void 0]})}function K(e){let{emails:t,shareModalGuestMemberConfirmationExpGroup:s,spaceStore:n}=e;window.__c={n:"EmailTokensSubtitle"};const o=(0,i.VK)((()=>(0,T.Q6)(n)),[n]);return(0,O.jsx)(O.Fragment,{children:t.map((e=>(0,O.jsx)(L.Z,{store:n,tokenType:"control"!==s?"member":o?"guestRequestRequired":"guest",showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e},spaceRole:"not_in_space"}},e)))})}function z(e){let{title:t,subtitle:s,icon:n,selected:i,onClick:a}=e;window.__c={n:"GuestMemberSelectionCardComponent"};const r=(0,o.Fg)();return(0,O.jsxs)(x.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:r.regularDividerColor,borderRadius:8,padding:12,justifyContent:"space-between",alignItems:"center"},onClick:a,children:[(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,O.jsx)("div",{style:{paddingRight:12},children:n}),(0,O.jsxs)("div",{children:[(0,O.jsx)(M.Z,{children:t}),(0,O.jsx)(M.Z,{isSmall:!0,style:{width:350,whiteSpace:"pre-wrap"},children:s})]})]}),(0,O.jsx)(y.Z,{round:!0,checked:i,fill:r.contentBackground,size:20,onClick:a})]})}function q(e){let{chunks:t,adminUserStores:s,maxAdminUsers:n}=e;return(0,O.jsx)(b.ZP,{renderTooltip:()=>(0,O.jsx)("div",{children:s.slice(0,n).map(((e,t)=>(0,O.jsx)(j.Z,{userStore:e,avatarSize:18,style:{minWidth:140,width:"100%",padding:2}},t)))}),render:e=>(0,O.jsx)("div",{style:{display:"inline",textDecoration:"underline"},...e,children:t})})}},10039:(e,t,s)=>{s.d(t,{Z:()=>F});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(8848),r=s(84619),l=s(33728),d=s(3338),c=s(40462),u=s(84169),m=s(36329),p=s(26774),g=s(97880),h=s(82990),f=s(7928),x=s(9291),y=s(26388),S=s(45653),v=s(85567),b=s(45101),M=s(16639),j=s(53353),w=s(26781),C=s(4023),k=s(80444),T=s(55899),I=s(88893),P=s(88280),Z=s(85893);const F=function(e){window.__c={n:"InviteTargetToken"};const{store:t,target:s}=e,F=(0,n.Fy)(),_=(0,x.useIntl)(),A=(0,o.yK)((()=>({verifiedDomain:{margin:2,backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:2,backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:2},guest:{margin:2,backgroundColor:"rgba(218, 163, 64, 0.2)"},error:{margin:2,backgroundColor:"rgba(195,90,75,0.2)",color:"#DE5550"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%"},tokenText:{marginLeft:4,...h.Z.textOverflowStyle}})),[]),R=(0,i.VK)((()=>{const e=P.subscriptionDataStoreInstance.state,t=e?I.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),D=(0,i.VK)((()=>{const e=k.default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),B=(0,j.Z)(t),L=(0,w.S)(t),O=(0,i.VK)((()=>{if("invalidUser"===s.type)return"invalidUser";if(e.tokenType)return e.tokenType;if("group"===s.type)return"group";if("existingUser"===s.type&&!Boolean(s.spaceRole)){const e=R[s.value.id];s.spaceRole=e?e.role:"not_in_space"}if(!(0,b.OA)(s))return"member";if(B.isGuestRequestRequired)return"guestRequestRequired";if(B.isStoreInTeam&&!B.teamAllowsGuests)return"teamGuestDisabled";if(!B.isStoreInTeam&&!B.spaceAllowsGuests||B.isStoreInTeam&&!B.teamAllowsGuests&&!B.spaceAllowsGuests)return"spaceGuestDisabled";const t=(0,l.Gd)(s.value.email);return t&&D.has(t)?"verifiedDomain":"guest"}),[e.tokenType,s,R,D,B]),E=(0,i.VK)((()=>{switch(O){case"member":case"group":return A.normal;case"invalidUser":return A.error;case"guest":case"guestRequestRequired":return A.guest;case"verifiedDomain":return A.verifiedDomain;case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return A.disabled;default:(0,g.t1)(O)}}),[O,A]);function N(){const e=(0,u.m)({height:16,width:16,color:"#D34F43"});switch(O){case"member":return(0,T.fZ)(s)?(0,Z.jsx)(S.Z,{userValue:s.value,size:16}):(0,T.KU)(s)?(0,Z.jsx)(S.Z,{size:16,avatar:s.value}):(0,Z.jsx)(S.Z,{size:16});case"guest":case"guestRequestRequired":return(0,c.o)({height:16,width:16,color:"#DAA340"});case"invalidUser":return(0,m._)({height:16,width:16,color:"#DE5550"});case"verifiedDomain":return(0,d.p)({height:16,width:16,color:"#53A83F"});case"group":return(0,Z.jsx)("div",{style:{height:16,width:16,backgroundColor:a.ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,p.O)({height:12,width:12,color:a.ZP.mediumTextColor})});case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,g.t1)(O)}}function V(t){const n=N();let i=function(){switch(s.type){case"newUser":return s.value.email.trim();case"invalidUser":return s.value.text.trim();case"existingUser":return(0,f.Nz)(_,s.value);case"group":return(0,M.kF)({intl:_,group:s.value});default:(0,g.t1)(s)}}(),o=A.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(i="Guest",o={...o,color:"#DAA340"}):(i="Member",o={...o,color:"#53A83F"})),(0,Z.jsxs)("div",{style:A.tokenContent,children:[n,(0,Z.jsx)("div",{style:o,children:i})]})}function U(t){var s;t.stopPropagation(),null===(s=e.onClickRemove)||void 0===s||s.call(e)}const W="newUser"===s.type?s.value.email:"invalidUser"===s.type?s.value.text:s.value.id,K="group"!==s.type&&"invalidUser"!==s.type?s.value.email:void 0;return(0,Z.jsx)(y.ZP,{placement:C.u.Top,renderTooltip:()=>function(e){const{tokenType:t,target:s,email:n}=e;return"guest"===t?(0,Z.jsx)(x.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:n}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t||"guestRequestRequired"===t?L:"teamGroupOwner"===t&&"group"===s.type?(0,Z.jsx)(x.FormattedMessage,{defaultMessage:"Groups cannot be added as team owners.",id:"inviteTargetToken.groupTeamOwner.tooltip"}):"invalidUser"===s.type?(0,Z.jsx)(x.FormattedMessage,{defaultMessage:"{text} is not a valid email",id:"inviteTargetToken.invalidUser.tooltip",values:{text:s.value.text}}):"verifiedDomain"===t&&"group"!==s.type?(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(x.FormattedMessage,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is a verified domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:s.value.email,br:(0,Z.jsx)("br",{}),domain:(0,l.Gd)(s.value.email)}})}):"group"===s.type?s.value.name??(0,Z.jsx)(x.FormattedMessage,{defaultMessage:"Untitled group",id:"inviteTargetToken.group.untitled"}):n}({tokenType:O,email:K,target:s}),render:t=>(0,Z.jsx)("div",{style:A.tokenSpan,...t,children:(0,Z.jsx)(v.Z,{isSingle:!1,format:F.isMobile?r.lo.Large:r.lo.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:U,disabledFeedback:!0,value:V(O),style:E,shouldWrap:!1})})},W)}},99273:(e,t,s)=>{s.d(t,{Z:()=>S});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(8848),r=s(72126),l=s(9291),d=s(33728),c=s(26907),u=s(35057),m=s(91219),p=s(95209);const g=r.Ds((e=>{let{environment:t,flowId:s,subscriptionTier:n,origin:i}=e;m.UW(t,{invite_flow_id:s,subscription_tier:n,invite_origin:i})}),1e3);var h=s(47082),f=s(55899),x=s(10039),y=s(85893);const S=function(e){window.__c={n:"InviteTargetsInput"};const{flowId:t,store:s,disabled:m,placeholder:S,right:v,focus:b,hideIconColorAndTooltips:M,showEmptyError:j,origin:w,onFocus:C,onSubmit:k,onInputChanged:T}=e,I=(0,n.O7)(),P=(0,n.Fy)(),Z=(0,i.qz)(e.inviteTargetsStore,f.ZP),F=(0,i.VK)((()=>Z.state.inviteTargets),[Z]),_=(0,i.VK)((()=>Z.state.tokenQuery),[Z]),A=F.map((e=>{const t="newUser"===e.type?e.value.email:"invalidUser"===e.type?e.value.text:e.value.id;return(0,y.jsx)(x.Z,{store:s,target:e,showRemoveButton:!0,tokenType:M?"member":void 0,onClickRemove:()=>function(e){const{targetToRemove:t,inviteTargetsStore:s}=e;if(0===s.state.inviteTargets.length)return;const n=s.state.inviteTargets.filter((e=>e!==t));0===n.length?s.setState({...s.state,inviteTargets:[]}):s.setState({...s.state,inviteTargets:n})}({inviteTargetsStore:Z,targetToRemove:e})},t)})),R=(0,o.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:A.length>0?4:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:4,minHeight:32,...b&&{background:"none"},...m&&{background:e.inputBackground,color:e.mediumTextColor,fill:a.ZP.white,opacity:.4}},inputAndTokenWrapRight:{gap:2},tokenInputMenuItemInput:{paddingTop:0},warningMessage:{color:"#DE5550"}})),[b,m,A]),D=function(e){let{invalidInvites:t,showEmptyError:s,styles:n}=e;if(s)return(0,y.jsx)("div",{style:n,children:(0,y.jsx)(l.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.noEmails",defaultMessage:"Please enter an email address"})});if(0===t.length)return null;const i=t[0].value.text;if(1===t.length)return(0,y.jsx)("div",{style:n,children:(0,y.jsx)(l.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.singleEmail",defaultMessage:"“{text}” is not a valid email",values:{text:i}})});return(0,y.jsx)("div",{style:n,children:(0,y.jsx)(l.FormattedMessage,{id:"inviteTargetsInput.invalidWarning.multipleEmails",defaultMessage:"{additionalInvalid, plural, one {“{text}” and {additionalInvalid} other are not valid emails} other {“{text}” and {additionalInvalid} others are not valid emails}}",values:{text:i,additionalInvalid:t.length-1}})})}({invalidInvites:(0,r.oA)(F.map((e=>"invalidUser"===e.type?e:void 0))),showEmptyError:j,styles:R.warningMessage});return(0,y.jsx)(h.Z,{focus:b,focusAfterAnimation:!0,onClick:()=>{P.isMobile||null==C||C()},format:h.U.Share,value:_,onChange:e=>async function(e){const{environment:t,event:s,flowId:n,inviteTargetsStore:i,inviteOrigin:o,onInputChanged:a}=e;null==a||a(),i.setState({...i.state,tokenQuery:s.target.value}),g({environment:t,flowId:n,subscriptionTier:(0,u.zt)(),origin:o});const r=s.target.value,{extractedEmails:l,invalidParts:m,newInputValue:h}=(0,d.nj)(r),f=[...await p.M5(t,l),...m.map((e=>({type:"invalidUser",value:{text:e}})))].filter((e=>!c.H({inviteTargetsStore:i,target:e}))),x=[...i.state.inviteTargets,...f];i.setState({...i.state,inviteTargets:x,tokenQuery:h})}({environment:I,event:e,inviteTargetsStore:Z,inviteOrigin:w,flowId:t,onInputChanged:T}),type:"email",tokens:A,disabled:m,autoComplete:"off",placeholder:S,onRemoveLastToken:()=>{Z.setState({...Z.state,inviteTargets:Z.state.inviteTargets.slice(0,-1)})},right:v,showBorder:!0,inputStyle:R.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:R.inputAndTokenWrapRight,style:R.tokenInputMenuItem,onSubmit:k,inputFullWidth:!0,message:D})}},71862:(e,t,s)=>{s.d(t,{Z:()=>A,C:()=>D});s(67294);var n=s(83355),i=s(15145),o=s(8848),a=s(72126),r=s(72141),l=s(21202),d=s(29369),c=s(97880),u=s(82990),m=s(9291),p=s(47307),g=s(64921),h=s(84076),f=s(31278),x=s(76798),y=s(26388),S=s(64369),v=s(7567),b=s(84210),M=s(95697),j=s(31075),w=s(55838),C=s(61766),k=s(26136),T=s(88893),I=s(88280),P=s(9867),Z=s(1951),F=s(85893);const _=function(e){const{store:t}=e;return(0,F.jsx)(m.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:(0,F.jsx)(Z.Z,{store:t,useInvertedColors:!0})}})},A=32;class R extends n.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:C.Z},this.permissionItemStore=void 0,this.handleRoleSelect=async e=>{if(B(this.props.permissionItem))return;const t=this.props.permissionItem,s=a.d9(t);s.role=e;const n=this.props.currentBlockStore.isTopLevel();if(n&&r.ix(s)){const e=I.subscriptionDataStoreInstance.state,i=e?T.su(e):1;if(!(0,M.bq)()&&r.YX(t.role)&&!r.YX(s.role)&&i>1){if(!(await p.confirmUserAction({message:(0,F.jsx)("span",{children:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:e=>(0,F.jsx)("span",{style:{fontWeight:u.Z.fontWeight.semibold},children:e})},id:"blockPermissionsSettings.confirmationDialog.private.message"})}),acceptLabel:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(!(0,M.bq)()&&n&&!r.YX(t.role)&&r.YX(s.role)){if(!(await p.confirmUserAction({message:(0,F.jsx)("span",{children:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:e=>(0,F.jsx)("span",{style:{fontWeight:u.Z.fontWeight.semibold},children:e}),memberCount:i}})}),acceptLabel:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}await(0,j.i)({oldPermissionItem:t,newPermissionItem:s,wasInherited:this.isInherited(),environment:this.environment,store:this.props.currentBlockStore,sudoModeStore:this.props.sudoModeStore,location:this.props.location,fromPermissionWrapper:this.props.fromPermissionWrapper})},this.handleUserItemClick=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})}}UNSAFE_willMountOrUpdate(){this.permissionItemStore=U(this.props.from,this.props.currentBlockStore)}renderComponent(){const{device:e}=this.environment,t=this.props.onClick?this.props.onClick:this.handleUserItemClick,s=E(this.props.permissionItem,this.props.currentBlockStore),n=this.renderTooltip();return(0,F.jsx)(y.ZP,{delayThreshold:0,renderTooltip:()=>n,textWrap:!0,disableTooltip:!Boolean(n),style:{maxWidth:240},render:n=>(0,F.jsx)(g.Z,{disabled:s,mobileFeedback:e.isMobile,ignoreLocalHoverState:this.props.ignoreLocalHoverState,style:{...s?{cursor:"not-allowed"}:{}},onClick:t,...n,children:this.renderMenuItem()}),placement:y.ug.Left})}renderMenuItem(){const{device:e}=this.environment,{showInherited:t,permissionItem:s}=this.props,n=this.isInherited();return(0,F.jsxs)("div",{className:"notranslate",style:V(this.environment,this.props.isCompact),children:[(0,F.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10,...this.props.iconStyle},children:this.props.icon}),(0,F.jsxs)("div",{style:{marginRight:"auto",minWidth:0},children:[(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,F.jsx)(S.Z,{style:{...!L(s)&&{fontWeight:400}},children:this.props.title}),this.props.tag&&(0,F.jsx)("div",{style:{marginLeft:4},children:this.props.tag})]}),this.props.subtitle&&(0,F.jsx)(S.Z,{isSmall:!0,children:this.props.subtitle}),t&&n&&this.renderInheritedRecordTitle()]}),(0,F.jsx)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8},children:this.props.permissionRoleSelect?this.props.permissionRoleSelect:!B(s)&&(0,F.jsx)(v.ZP,{role:this.role,table:l.iU,blockType:this.props.currentBlockStore.getType(),type:s.type,disabled:E(this.props.permissionItem,this.props.currentBlockStore),isUserPermission:N(s,this.environment),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-8,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:n,isRemovableOverride:this.props.isRemovableOverride})})]})}renderTooltip(){return this.isInherited()?!O(this.props.permissionItem)&&this.permissionItemStore?(0,F.jsx)(_,{store:this.permissionItemStore}):null:this.props.nonInheritedTooltip}renderInheritedRecordTitle(){const e=this.permissionItemStore||U(this.props.from,this.props.currentBlockStore),t=e.table===l.iU?(0,b.ZP)({store:e,fullyQualified:!1,pageVisitSource:i.tY.LinkInPage}):void 0,s=e.table===d.e0?()=>{e.table===d.e0&&P.RF({environment:this.environment,teamId:e.id,tab:w.a.Members,from:"permission_item"})}:void 0,{device:n}=this.environment,a=e.getIcon(),r="team"!==e.table&&e.isEmptyPage();return(0,F.jsx)(S.Z,{isSmall:!0,style:{lineHeight:1.4},children:n.isMobile?(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,F.jsx)(h.Z,{disabled:n.isMobile,underline:!n.isMobile,inline:!0,href:t,onClick:s,children:(0,F.jsx)(x.Z,{store:e,style:{display:"inline"}})})}}):(0,F.jsx)(m.FormattedMessage,{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,F.jsxs)(h.Z,{disabled:n.isMobile,underline:!1,inline:!0,href:t,onClick:s,innerStyle:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${o.ZP.mediumTextColor}`},children:[(0,F.jsx)(f.Z,{disabled:!0,style:{marginRight:4},icon:a,size:14,isEmptyPage:r}),(0,F.jsx)(x.Z,{store:e,style:{display:"inline",fontWeight:u.Z.fontWeight.semibold}})]})}})})}get role(){const{permissionItem:e,currentBlockStore:t}=this.props;if(B(e))return"none";if("content_only_editor"===e.role&&this.isInherited()){var s,n;const i=t.getParentCollectionStore(),o=null==i?void 0:i.getParentBlockStore();return o&&o.table===(null===(s=this.permissionItemStore)||void 0===s?void 0:s.table)&&o.id===(null===(n=this.permissionItemStore)||void 0===n?void 0:n.id)?e.role:"read_and_write"}return e.role}isInherited(){var e;return(null===(e=this.permissionItemStore)||void 0===e?void 0:e.id)!==this.props.currentBlockStore.id}}R.displayName="PermissionItem";const D=R;function B(e){return"team_overview_permission"===e.type||"hidden_permission"===e.type}function L(e){return"user_permission"===e.type}function O(e){return"team_overview_permission"===e.type}function E(e,t){return"hidden_permission"===e.type||!O(e)&&!t.canAdmin()}function N(e,t){const s=t.currentUser.id;return"user_permission"===e.type&&e.user_id===s}function V(e,t){const{WindowSizeStore:s}=e;return{display:"flex",alignItems:"center",minHeight:t?44:52,paddingTop:8,paddingBottom:8,paddingLeft:s.getSafePaddingLeftCSS(14),paddingRight:s.getSafePaddingRightCSS(14)}}function U(e,t){const s=e.table;return s===l.iU?k.G.createChildStore(t,{table:l.iU,id:e.blockId}):s===d.e0?k.zX.createChildStore(t,{table:d.e0,id:e.teamId}):void(0,c.t1)(s)}},91670:(e,t,s)=>{s.r(t),s.d(t,{OfflineMessage:()=>Yn,default:()=>$n});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(9291),l=s(1743),d=s(56940),c=s(78140),u=s(40721),m=s(64369),p=s(46247),g=s(43250),h=s(87279),f=s(18514),x=s(80444),y=s(88632),S=s(85834),v=s(52878),b=s(90335),M=s(28578),j=s(48608),w=s(97880),C=s(55899),k=s(41892),T=s(8848),I=s(80721),P=s(91315),Z=s(64275),F=s(11185),_=s(43876),A=s(82990),R=s(5581),D=s(51077),B=s(73063),L=s(66957),O=s(85893);function E(e){let{inviteTargetsStore:t,mostPermissivePublicItem:s}=e;window.__c={n:"ShareMenuHeader"};const{display:n,source:i}=(0,o.VK)((()=>{const{display:e}=M.ZP.state;if(e===M.wV.Invite){const{source:t}=M.ZP.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(n){case M.wV.MainShareMenu:case M.wV.Publish:return(0,O.jsx)(V,{mostPermissivePublicItem:s});case M.wV.Invite:if("notion"===i)return(0,O.jsx)(W,{inviteTargetsStore:t});if("slack"===i)return(0,O.jsx)(K,{});throw(0,w.t1)(i);default:(0,w.t1)(n)}}const N=[M.XF.Share,M.XF.Publish];function V(e){let{mostPermissivePublicItem:t}=e;window.__c={n:"ShareMenuTabs"};const s=(0,i.O7)(),l=n.useRef(null),{isMobile:d}=s.device,c=(0,o.VK)((()=>M.ZP.state.tab),[]),u=(0,a.yK)((e=>({tabStyle:{color:e.lightTextColor,...d&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:A.Z.fontWeight.medium},tabTitleStyle:{color:"inherit"},style:d?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:14}})),[d]),m=(0,a.yK)((()=>({publishTabContainer:{display:"flex",alignItems:"center"}})),[]),p=(0,n.useCallback)((e=>{const t=N[e];t!==c&&(R.Y(s,{tab:t}),t===M.XF.Share&&M.ZP.setState({...M.ZP.state,display:M.wV.MainShareMenu,tab:M.XF.Share}),t===M.XF.Publish&&M.ZP.setState({...M.ZP.state,display:M.wV.Publish,tab:M.XF.Publish}))}),[c,s]),h="none"!==t.permissionItem.role,f=[(0,O.jsx)(n.Fragment,{children:d?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,O.jsxs)("div",{ref:l,style:m.publishTabContainer,className:g.UBk,children:[(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),h&&U.publishedCheckIcon({opacity:c===M.XF.Publish?1:.5})]},"publishTab")];return(0,O.jsx)(L.Z,{...u,tabs:f,selectedIndex:N.indexOf(c),onChange:p})}const U={[M.XF.Share]:(0,_.s)({height:17,width:17,marginRight:4}),[M.XF.Publish]:(0,F.I)({height:15,width:15,marginRight:4}),publishedCheckIcon:e=>{let{opacity:t}=e;return(0,P.r)({color:T.ZP.blue,width:14,height:14,marginLeft:4.5,opacity:t})}};function W(e){let{inviteTargetsStore:t}=e;window.__c={n:"InviteFromNotionHeader"};const s=(0,a.yK)((()=>({container:{display:"flex",margin:"0 12px 6px",height:48}})),[]),i=(0,n.useCallback)((()=>{t.reset(),M.ZP.setState({...M.ZP.state,display:M.wV.MainShareMenu,tab:M.XF.Share})}),[t]);return(0,O.jsx)("div",{style:s.container,children:(0,O.jsx)(z,{onClick:i})})}function K(){window.__c={n:"InviteFromSlackHeader"};const e=(0,r.useIntl)(),t=(0,a.yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:A.Z.fontWeight.semibold}})),[]),s=(0,n.useCallback)((()=>{M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,source:M.T5.Notion,focus:M.Sw.Search,emailMessage:""})}),[]),i=(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(D.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]});return(0,O.jsxs)("div",{style:t.container,children:[(0,O.jsx)(m.Z,{style:t.titleLabel,children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:i}})}),(0,O.jsx)(B.Z,{ariaLabel:e.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow."}),icon:Z.D,style:{borderRadius:"100%"},onClick:s})]})}function z(e){window.__c={n:"BackButton"};const{onClick:t}=e,s=(0,r.useIntl)(),n=(0,a.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:A.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:A.Z.fontWeight.medium}})),[]);return(0,O.jsxs)("div",{style:n.topContainer,children:[(0,O.jsx)(B.Z,{icon:I.W,iconStyle:n.arrowIcon,style:n.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,O.jsx)(m.Z,{style:n.sendInviteLabel,children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})]})}var q=s(84169),G=s(85354),H=s(21202),Q=s(12714),Y=s(42922),$=s(98165),J=s(40134);function X(e){let{store:t}=e;return(0,o.VK)((()=>{const e=(0,J.B)({blockId:t.id,setting:"publicAccess"});if((0,w.$K)(e))return e;const s=x.default.state.currentSpaceStore,n=(0,$.VP)(t);return n?{disabled:Boolean(n.getDisablePublicAccess()),disabledBy:"team"}:!n&&null!=s&&s.getDisablePublicAccess()?{disabled:!0,disabledBy:"space"}:{disabled:!1}}),[t])}var ee=s(31075);function te(e){window.__c={n:"PublishToWeb"};const{store:t,mostPermissivePublicItem:s,permissionItemArgs:l}=e,{permissionItem:d,from:c}=s,{sudoModeStore:u,location:p}=l,h=(0,i.O7)(),f=(0,o.VK)((()=>t.canAdmin()),[t]),{disabled:y}=X({store:t}),S=!f||y,v=(0,a.yK)((e=>({container:{display:"flex",flex:1,justifyContent:"center",alignItems:"center",flexDirection:"column",padding:32,textAlign:"center",cursor:S?"not-allowed":""},icon:{height:30,width:30,marginBottom:10,fill:e.mediumIconColor},title:{fontWeight:A.Z.fontWeight.semibold,fontSize:14},caption:{display:"flex",alignItems:"center",marginLeft:26,marginRight:26,marginBottom:20},button:{display:"flex",width:"100%",padding:16,cursor:S?"not-allowed":"pointer"}})),[S]),b=(0,o.VK)((()=>{var e;return null===(e=x.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace()}),[]),M=c.table===H.iU?c.blockId:c.teamId,j=(0,n.useCallback)((()=>{const e=!b&&d.allow_duplicate;(0,ee.i)({oldPermissionItem:d,newPermissionItem:{...d,role:"reader",allow_duplicate:e},wasInherited:M!==t.id,environment:h,store:t,sudoModeStore:u,location:p})}),[h,M,p,b,d,t,u]);return(0,O.jsxs)("div",{style:v.container,children:[(0,G.u)(v.icon),(0,O.jsx)("div",{style:v.title,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.title"})}),(0,O.jsx)(m.Z,{isMultiline:!0,isSecondaryColor:!0,style:v.caption,children:(0,O.jsx)(se,{store:t})}),(0,O.jsx)(Y.Z,{style:v.button,disabled:S,onClick:j,className:g.wlU,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"publishTab.publishToWeb.button"})})]})}function se(e){let{store:t}=e;window.__c={n:"PublishToWebMessage"};const s=X({store:t}),n=(0,i.O7)(),l=(0,o.VK)((()=>t.canAdmin()),[t]),d=(0,a.yK)((e=>({helpIcon:{width:16,height:16}})),[]);return s.disabled&&"team"===s.disabledBy?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via teamspace settings.",id:"publishTab.publishToWeb.disabledByTeamspace.caption"}):s.disabled&&"space"===s.disabledBy?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via workspace settings.",id:"publishTab.publishToWeb.disabledByWorkspace.caption"}):l?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Publish a static website of this page.",id:"publishTab.publishToWeb.hasFullAccess.caption"}),(0,O.jsx)(B.Z,{iconStyle:d.helpIcon,onClick:()=>{Q.D({environment:n,url:(0,f.UY)("guides.autogeneratedDomains")})},icon:q.m,ariaLabel:"Learn more about sites"})]}):(0,O.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to this page to publish to web.",id:"publishTab.publishToWeb.noFullAccess.caption"})}var ne=s(21267);function ie(e){const{store:t,mostPermissivePublicItem:s,permissionItemArgs:n}=e,{permissionItem:i}=s;return"none"!==i.role?(0,O.jsx)(ne.Z,{store:t,mostPermissivePublicItem:s,permissionItemArgs:n,showAllPublishedSites:!0}):(0,O.jsx)(te,{store:t,mostPermissivePublicItem:s,permissionItemArgs:n})}var oe=s(77657),ae=s(94044),re=s(91219),le=s(54642),de=s(95209),ce=s(74194),ue=s(3386),me=s(53336),pe=s(26388),ge=s(7567),he=s(44385),fe=s(4708),xe=s(79817),ye=s(26907),Se=s(67669),ve=s(45101),be=s(53353),Me=s(26781),je=s(34859),we=s(30874),Ce=s(29798),ke=s(88893),Te=s(88280),Ie=s(57345),Pe=s(56678),Ze=s(99273),Fe=s(64964),_e=s(64921),Ae=s(77907),Re=s(96455);const De=function(e){window.__c={n:"PermissionsInviteEntry"};const{store:t}=e,{isMobile:s}=(0,i.Fy)(),n=(0,o.VK)((()=>t.canEditMembership()),[t]),l=(0,a.yK)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:ae.p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"},blueButton:{minWidth:ae.UF}})),[]);return(0,O.jsx)(pe.ZP,{renderTooltip:()=>(0,O.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:n,render:t=>(0,O.jsxs)("div",{style:l.buttonContainer,...t,children:[(0,O.jsx)(Re.Z,{onClick:e.onClick,disabled:!n&&!0,style:l.inputButton,children:(0,O.jsx)("div",{style:A.Z.textOverflowStyle,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!s&&(0,O.jsx)(Y.Z,{isLarge:!0,onClick:e.onClick,disabled:!n&&!0,style:l.blueButton,children:(0,O.jsx)(r.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Be(e){window.__c={n:"MobileInviteSection"};const{store:t,permissionItemArgs:s}=e,{onUpgradeButtonClick:l,sudoModeStore:d}=s,c=(0,o.qz)(void 0,v.Z),{permissionsInviteStore:u}=(0,o.VK)((()=>c.state),[c]),m=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),p=(0,o.VK)((()=>c.stage),[c]),g=(0,o.VK)((()=>u.state.modalOpen),[u]),h=(0,i.MO)(),f=(0,i.O7)(),y=(0,o.VK)((()=>t.canAdmin()),[t]),M=(0,o.VK)((()=>{const e=Te.subscriptionDataStoreInstance.state;return Boolean(e&&ke.YK(e))}),[]),j=(0,o.VK)((()=>(0,b.pR)({store:t})),[t]),w=(0,a.yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:52},buttonInner:{width:"100%"},modalButton:{height:36},requestedUsersToast:{marginBottom:96}})),[]),C=(0,n.useCallback)(((e,t)=>{e&&t>0&&Fe.oV({label:(0,O.jsx)(r.FormattedMessage,{id:"mobileInviteSection.onInviteComplete.toastMessage.requestedUsers",defaultMessage:"Sent request to invite {numRequests, plural, one {a guest} other {{numRequests} guests}}",values:{numRequests:t}}),style:h?w.requestedUsersToast:void 0})}),[h,w.requestedUsersToast]);return m?p!==S.TG.closed?(0,O.jsx)(Ae.LazyUniversalMemberInvite,{universalInviteStore:c,mode:"milestone_2",spaceStore:m,sudoModeStore:d,store:t,disabled:!y,membersOnly:j,isSubscribed:M,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:36}}):(0,O.jsx)(_e.Z,{mobileFeedback:!0,disabled:!0,style:w.button,children:(0,O.jsxs)("div",{style:w.buttonInner,children:[g&&(0,O.jsx)(Ae.LazyPermissionsInviteWithModal,{store:t,disabled:!y,membersOnly:j,isSubscribed:M,onUpgradeButtonClick:l,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:w.modalButton,permissionsInviteStore:u,onInviteComplete:C}),(0,O.jsx)(De,{store:t,onClick:()=>(0,ve.z5)({environment:f,permissionsInviteStore:u,store:t,isSubscribed:M,renderInShareModal:!1})})]})}):null}var Le=s(72126),Oe=s(72141),Ee=s(19889),Ne=s(7928),Ve=s(91536),Ue=s(64684);function We(){const e=Te.subscriptionDataStoreInstance.state,t=e?ke.CM(e):[],s=new Map;return t.forEach((e=>{s.set(e.userId,e)})),s}function Ke(e){const{spaceVisibleUserMap:t,blockStore:s,userId:n}=e,i=t.get(n);if(!i||"none"!==i.role)return;if(!i.isTeamGuest)return"guest";const o=$.VP(s);if(!o)return"guest";return(0,Ue.s8)({team:{membership:o.getRawMembership()},userId:n})?"team_level_guest":"guest"}var ze=s(65598),qe=s(16639),Ge=s(26136),He=s(12793),Qe=s(31278),Ye=s(25735),$e=s(60442),Je=s(71862);function Xe(e){window.__c={n:"GroupPermissionTooltip"};const{group:t}=e,s=(0,r.useIntl)(),n=(0,qe.kF)({intl:s,group:t});return(0,O.jsx)(Ye.Y,{group:t,limit:15,noMembersMessage:(0,O.jsx)($e.Z,{imageURL:k.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>(0,O.jsx)("span",{style:{fontWeight:A.Z.fontWeight.bold},children:e}),groupName:n},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const et=function(e){window.__c={n:"BlockGroupPermissionItem"};const{store:t,groupPermission:s,spaceId:n,fromPermissionWrapper:i}=e,a=(0,r.useIntl)(),l=(0,o.VK)((()=>{const{currentSpaceStore:e}=x.default.state;if(!e)return!1;return e.getPermissionGroups().find((e=>e.id===s.permissionItem.group_id))}),[s.permissionItem.group_id]);if(!l)return null;const d=l.user_ids||[],c=(0,qe.kF)({intl:a,group:l}),u=l.icon&&(0,O.jsx)(Qe.Z,{disabled:!0,title:c,icon:l.icon?{pointer:{table:"space",id:n},icon:l.icon}:void 0,isEmptyPage:!1,size:18});return(0,O.jsx)("div",{style:{fontWeight:400},className:g.gGc,children:(0,O.jsx)(Je.C,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,O.jsx)(He.Z,{size:Je.Z}),title:c,tag:u,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:(0,O.jsx)(Xe,{group:l}),subtitle:(0,O.jsxs)("div",{children:[(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:d.length}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:i,...e.permissionItemArgs})},l.id)};var tt=s(88198),st=s(45653);function nt(e){window.__c={n:"Icon"};const{userValue:t,shouldShowPendingInvitation:s}=e,n=(0,a.yK)((()=>({iconPlaceholder:{height:Je.Z,width:Je.Z,borderRadius:20}})),[]);return t?(0,O.jsx)(st.Z,{userValue:t,size:Je.Z,initialOverrideStyle:s?{borderStyle:"dashed"}:void 0}):(0,O.jsx)(at,{style:n.iconPlaceholder})}function it(e){window.__c={n:"Title"};const{userValue:t,guestLabel:s,shouldShowPendingInvitation:n}=e,i=(0,r.useIntl)(),o=(0,a.yK)((()=>({titlePlaceholder:{height:8,width:81,borderRadius:4},pendingInvitation:{color:T.ZP.PendingInvitationTextColor}})),[]);if(!t)return(0,O.jsx)(at,{style:o.titlePlaceholder});const l=(0,Ne.Nz)(i,t);return(0,O.jsx)(O.Fragment,{children:l?(0,O.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,O.jsx)(m.Z,{className:"notranslate",style:n?o.pendingInvitation:void 0,children:l}),s&&(0,O.jsx)(tt.b,{labelType:s})]}):(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"})})}function ot(e){window.__c={n:"Subtitle"};const{userValue:t,shouldShowPendingInvitation:s}=e,n=(0,a.yK)((()=>({uiLabel:{display:"flex"},subtitlePlaceholder:{height:8,width:139,borderRadius:4,marginTop:10},dotSeparator:{marginLeft:2,marginRight:2},pendingInvitation:{color:T.ZP.PendingInvitationTextColor}})),[]);return null!=t&&t.email?s?(0,O.jsx)(m.Z,{isSmall:!0,style:n.pendingInvitation,children:(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.invitationSent",defaultMessage:"Pending Invitation"})}):(0,O.jsx)(m.Z,{isSmall:!0,children:t.email}):(0,O.jsx)(at,{style:n.subtitlePlaceholder})}function at(e){window.__c={n:"Placeholder"};const t=(0,a.yK)((t=>({placeholder:{...e.style,background:t.lightDividerColor}})),[e.style]);return(0,O.jsx)("div",{style:t.placeholder})}const rt=function(e){window.__c={n:"BlockUserPermissionItem"};const{store:t,userPermission:s,spaceVisibleUserMap:n,fromPermissionWrapper:i}=e,a=(0,o.VK)((()=>Ge.U6.createChildStore(t,{table:Ee.KJ,id:s.permissionItem.user_id}).getValue()),[t,s.permissionItem.user_id]),r=(0,o.VK)((()=>{if(null!=a&&a.id)return Ke({spaceVisibleUserMap:n,userId:a.id,blockStore:t})}),[t,n,a]),l=(0,o.VK)((()=>!0!==(null==a?void 0:a.onboarding_completed)&&(0,fe.fJ)()),[a]);return(0,O.jsx)("div",{children:(0,O.jsx)(Je.C,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,O.jsx)(nt,{userValue:a,shouldShowPendingInvitation:l}),title:(0,O.jsx)(it,{userValue:a,guestLabel:r,shouldShowPendingInvitation:l}),subtitle:(0,O.jsx)(ot,{userValue:a,shouldShowPendingInvitation:l}),showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:i,...e.permissionItemArgs})},s.permissionItem.user_id)};var lt=s(56666);function dt(e){let{permissions:t}=e;window.__c={n:"ExpandablePermissionsList"};const[s,i]=(0,n.useState)(!1),o=(0,a.yK)((e=>({button:{display:s?"none":"inline-flex",padding:10,width:"100%"},icon:{width:14,transform:"rotate(90deg)",marginLeft:14,marginRight:18,fill:e.lightIconColor},list:{display:s?"block":"none"}})),[s]);return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(_e.Z,{onClick:()=>i(!0),style:o.button,children:[(0,O.jsx)("div",{children:(0,lt.o)(o.icon)}),(0,O.jsx)(m.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",values:{count:t.length}})})]}),(0,O.jsx)("div",{style:o.list,children:t})]})}var ct=s(50571);const ut=function(e){window.__c={n:"MorePeoplePermissionItem"};const{store:t}=e,s=(0,a.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),n={table:H.iU,blockId:t.id};return(0,O.jsx)(Je.C,{icon:(0,ct.S)(s.icon),iconStyle:s.iconContainer,title:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,O.jsx)(O.Fragment,{}),currentBlockStore:t,permissionItem:{type:"hidden_permission"},from:n,upgradeButtonName:"team_permission_item"})};var mt=s(76781),pt=s(29369),gt=s(84076),ht=s(28020),ft=s(38755),xt=s(74016),yt=s(15145),St=s(61061),vt=s(44495),bt=s(86517),Mt=s(76798),jt=s(62385),wt=s(84210),Ct=s(47307),kt=s(76464),Tt=s(82530),It=s(18878);var Pt=s(55838),Zt=s(4023),Ft=s(9867);function _t(e){window.__c={n:"PermissionsRestoreBanner"};const{showRestoreButton:t,store:s,type:n,sudoModeStore:r}=e,{isMobile:l}=(0,i.Fy)(),d=(0,o.VK)((()=>$.uJ(s)[1]),[s]),c=(0,i.O7)(),u=(0,o.VK)((()=>({paddingLeft:c.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:c.WindowSizeStore.getSafePaddingLeftCSS(14)})),[c]),p=(0,a.yK)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:u.paddingLeft,paddingRight:u.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},messageContainer:{display:"flex",flexDirection:"column"},label:{display:"inline",marginLeft:l?14:0,color:l?"#CF8807":e.mediumTextColor,fontWeight:l?A.Z.fontWeight.regular:A.Z.fontWeight.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},divider:{opacity:"75%"},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[l,u]);return l?(0,O.jsxs)("div",{style:p.mobileContainer,children:[(0,O.jsx)(m.Z,{isMultiline:!0,isSmall:!0,style:p.label,children:(0,O.jsx)(Dt,{type:n,navigableParentStore:d,showRestoreButton:t})}),t&&(0,O.jsx)(At,{store:s,type:n})]}):(0,O.jsx)("div",{style:p.container,children:(0,O.jsxs)("div",{style:p.banner,children:[(0,O.jsx)("div",{style:p.iconContainer,children:Bt[n](p.icon)}),(0,O.jsxs)("div",{children:[(0,O.jsx)(m.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:p.label,children:(0,O.jsx)(Dt,{type:n,navigableParentStore:d,showRestoreButton:t})}),t&&(0,O.jsx)("span",{style:p.buttonContainer,children:(0,O.jsx)(At,{store:s,type:n,sudoModeStore:r})})]})]})})}function At(e){window.__c={n:"PermissionsRestoreButton"};const{type:t,store:s,sudoModeStore:n}=e,{isMobile:l}=(0,i.Fy)(),d=(0,o.VK)((()=>!!n&&n.shouldSaveTransactionWithSudoMode(s)),[s,n]),c=(0,a.yK)((e=>({button:{color:l?"#CF8807":e.regularTextColor,fontWeight:A.Z.fontWeight.medium},tooltip:{width:210,whiteSpace:"initial"}})),[l]),u=(0,i.O7)();if("restore-team"===t){const e=async()=>{await async function(e){const{environment:t,useSudoMode:s,store:n}=e,i={type:"restoreTeamPermissions",permissionChanges:[]};await Ct.confirmUserAction({message:(0,It.mX)(i),acceptLabel:(0,It.nH)(i),cancelLabel:(0,O.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"})})&&Tt.createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:t,useSudoMode:s,perform:e=>{kt.Kh({environment:t,store:n,transaction:e})}})}({environment:u,useSudoMode:d,store:s})};return(0,O.jsx)(pe.ZP,{style:c.tooltip,placement:Zt.u.Bottom,renderTooltip:()=>(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions"}),render:t=>(0,O.jsx)("span",{...t,children:(0,O.jsx)(jt.Z,{style:c.button,onClick:e,children:(0,O.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset"})})})})}if("unrestrict"===t){const e=async()=>{const e=s.getPermissionItems(),t=$.Om(s),n=t?(0,bt.Wo)($.fJ(t)):[],i=(0,bt.Xr)(e,n);await async function(e){const{environment:t,useSudoMode:s,store:n,permissionChanges:i}=e,o={type:"restore",permissionChanges:i};await Ct.confirmUserAction({message:(0,It.mX)(o),acceptLabel:(0,It.nH)(o),cancelLabel:(0,O.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,O.jsx)(It.mo,{openState:o})})&&(n.getPermissionItemsStore().canAdmin()?Tt.createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:t,useSudoMode:s,perform:e=>{kt.MX({environment:t,store:n,transaction:e})}}):kt.hs({environment:t,store:n}))}({environment:u,useSudoMode:d,store:s,permissionChanges:i})};return(0,O.jsx)(jt.Z,{style:c.button,onClick:e,children:(0,O.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore"})})}(0,w.t1)(t)}function Rt(e){window.__c={n:"ClickableAttribution"};const{navigableParentStore:t,maxLength:s,showUnderline:n}=e,{isMobile:r}=(0,i.Fy)(),l=(0,i.O7)(),d=(0,a.yK)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),c=(0,o.VK)((()=>{if(t instanceof Ge.G)return(0,wt.ZP)({store:t,fullyQualified:!1,pageVisitSource:yt.tY.LinkInPage})}),[t]);if(!t)return null;const u=r&&t.table===pt.e0;return(0,O.jsx)(gt.Z,{disabled:u,style:u?void 0:d.linkBox,underline:n&&!u,inline:!0,onClick:t.table===pt.e0?()=>{t.table===pt.e0&&Ft.RF({environment:l,teamId:t.id,tab:Pt.a.Members,from:"permission_item"})}:void 0,href:c,children:(0,O.jsx)(Mt.Z,{shouldWrap:!0,maxLength:s,store:t,style:d.title})})}function Dt(e){window.__c={n:"PermissionsRestoreBannerLabel"};const{type:t,navigableParentStore:s,showRestoreButton:n}=e,{isMobile:o}=(0,i.Fy)(),a=(0,O.jsx)(Rt,{navigableParentStore:s,maxLength:o||!n?void 0:30,showUnderline:!0});switch(t){case"restore-team":return(0,O.jsx)(r.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});case"unrestrict":return o?(0,O.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",values:{linkBoxWithPageTitle:a}}):(0,O.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:a}});default:(0,w.t1)(t)}}const Bt={unrestrict:St.B,"restore-team":vt.D},Lt=(0,r.defineMessages)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function Ot(e){let{store:t}=e;window.__c={n:"PermissionLevelBanner"};const s=(0,i.O7)(),l=(0,o.VK)((()=>(0,ht.B7)(s)),[s]),d=(0,o.VK)((()=>t.canEditContentOnly()),[t]),c=(0,a.yK)((e=>({container:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},banner:{fontSize:12,display:"inline-flex"},icon:{marginLeft:14,marginRight:8},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:5}})),[]),{role:u,attribution:p}=(0,o.VK)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,Se.Dt)({userId:l.id,store:t}),n=function(e){let{environment:t,calculatedPermission:s,store:n}=e;const i=(0,$.Pj)(n)||x.default.state.currentSpaceStore;if(!i)return null;if((0,Oe.hV)(s)){const e=(0,ft.TC)({spaceStore:i,groupId:s.group_id}),t=null==e?void 0:e.name;return t?(0,O.jsxs)(O.Fragment,{children:[(0,mt.x)({width:18,marginRight:5}),t]}):null}if((0,Oe.fG)(s)){var o;const e=s.team_id||(null===(o=(0,$.VP)(n))||void 0===o?void 0:o.id);if(!e)return null;const t=Ge.zX.createChildStore(i,{table:pt.e0,id:e,spaceId:i.id});return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(xt.p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,O.jsx)(Rt,{navigableParentStore:t,showUnderline:!0})]})}if((0,Oe.ix)(s))return(0,Oe.KF)(s)?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(xt.p,{disabled:!0,store:i,size:18,style:{marginRight:5}}),(0,ft.rn)(t,i)]});if((0,Oe.$D)(s))return(0,O.jsx)(gt.Z,{underline:!0,inline:!0,onClick:()=>{M.ZP.setState({...M.ZP.state,display:M.wV.Publish,tab:M.XF.Publish})},children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:s,calculatedPermission:e,store:t});return{role:e.role,attribution:n}}),[l,t,s]);if((0,n.useEffect)((()=>{u&&Ve.hY(s,{share_menu_session_id:M.ZP.state.sessionId,role:u})}),[]),!(0,Oe.iC)(u))return null;const g=function(e){switch(e){case"editor":return Lt.fullAccess;case"read_and_write":return Lt.editor;case"content_only_editor":return Lt.contentEditor;case"comment_only":return Lt.commenter;case"reader":return Lt.reader;case"none":case"membership_admin":return null;default:(0,w.t1)(e)}}(u);return g?(0,O.jsx)(pe.ZP,{delayThreshold:0,renderTooltip:()=>(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,O.jsxs)("div",{style:c.container,...e,children:[(0,O.jsx)(st.Z,{userStore:l,size:20,style:c.icon}),(0,O.jsx)(m.Z,{style:c.banner,children:(0,O.jsx)(r.FormattedMessage,{...g,values:{hasAttribution:Boolean(p),attribution:(0,O.jsx)("span",{style:c.attribution,children:p})}})})]}),placement:pe.ug.Left}):null}function Et(){return(0,O.jsx)(Nt,{children:(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access"})})}function Nt(e){window.__c={n:"AttributionWrapper"};const{children:t}=e,{WindowSizeStore:s}=(0,i.O7)(),{paddingLeft:n,paddingRight:r}=(0,o.VK)((()=>({paddingLeft:s.getSafePaddingLeftCSS(14),paddingRight:s.getSafePaddingRightCSS(14)})),[s]),l=(0,a.yK)((e=>({label:{color:e.mediumTextColor,fontWeight:A.Z.fontWeight.medium,paddingLeft:n,paddingRight:r,paddingTop:8,paddingBottom:6}})),[n,r]);return(0,O.jsx)(m.Z,{isSmall:!0,style:l.label,children:t})}const Vt=function(e){window.__c={n:"PermissionsAttributionHeader"};const{store:t}=e,{parentStore:s,canAccessParent:n}=(0,o.VK)((()=>(0,b.HB)({store:t})),[t]);return n?(0,O.jsx)(Nt,{children:(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",values:{attribution:(0,O.jsx)(Rt,{navigableParentStore:s})}})}):(0,O.jsx)(Nt,{children:(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access"})})};var Ut=s(19037);function Wt(e){window.__c={n:"RestrictedBanner"};const{store:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>function(e){const{store:t,environment:s}=e;return Ut.or([Ut.zz,Ut.xD([Ut.c2,Ut.ff(Ut.zz)])])({environment:s,blocks:[t],publicEditMode:void 0})}({store:t,environment:s})),[t,s]);return(0,O.jsx)(_t,{type:"unrestrict",showRestoreButton:n,store:t,sudoModeStore:e.sudoModeStore})}function Kt(e){window.__c={n:"ElevatedBanner"};const{store:t}=e;return(0,o.VK)((()=>(0,b.Np)({store:t})),[t])?(0,O.jsx)(_t,{type:"restore-team",showRestoreButton:!1,store:t,sudoModeStore:e.sudoModeStore}):null}const zt=function(e){window.__c={n:"PermissionsWarningBanner"};const{store:t,showRestrictedPermissionBanner:s}=e,{canAccessParent:n}=(0,o.VK)((()=>(0,b.HB)({store:t})),[t]);return n?s?(0,O.jsx)(Wt,{store:t,sudoModeStore:e.sudoModeStore}):(0,O.jsx)(Kt,{store:t,sudoModeStore:e.sudoModeStore}):null};var qt=s(42853),Gt=s(16880),Ht=s(27714),Qt=s(16184),Yt=s(21213),$t=s(98519),Jt=s(23063),Xt=s(52275),es=s(31945),ts=s(32163),ss=s(63296),ns=s(89728),is=s(72495);function os(){const e=(0,i.O7)(),{currentSpaceStore:t}=(0,o.Kw)(x.default);return(0,o.VK)((()=>t?(0,ft.rn)(e,t):""),[e,t])}var as=s(61766),rs=s(31194);const ls=[{key:"private",title:()=>(0,O.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:(0,O.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:Qt.Q},{key:"unlisted",title:e=>(0,O.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:e}}),caption:(0,O.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"People invited and workspace members with link can access"}),icon:Ht.N},{key:"open",title:e=>(0,O.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:(0,O.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All workspace members can search and access"}),icon:Yt.T}];function ds(e){window.__c={n:"MobileLinkSharingPill"};const{store:t,spacePermission:s}=e,i=us(s.permissionItem),l=(0,o.VK)((()=>t.canAdmin()),[t]),d=os(),c=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),[u,p]=(0,n.useState)(!1),g=(0,a.yK)((e=>({chevron:{width:12,fill:e.mediumIconColor,marginLeft:"auto"},button:{height:42,color:e.mediumTextColor,marginBottom:8,padding:"0 6px",marginLeft:-6,marginRight:-6,width:"100%"},icon:{fill:e.regularIconColor,width:32,height:32,backgroundColor:e.lightDividerColor,padding:6,borderRadius:4,marginRight:12},animation:{maxHeight:220},enterAnimation:{maxHeight:0},exitAnimation:{maxHeight:0},container:{overflow:"hidden"}})),[]),h=ls.find((e=>e.key===i));return h&&c?(0,O.jsxs)("div",{style:g.container,children:[(0,O.jsxs)(ns.Z,{style:g.button,icon:h.icon,iconStyle:g.icon,disabled:!l,disabledFeedback:!0,onClick:()=>p(!u),children:[(0,O.jsxs)("div",{children:[(0,O.jsx)(m.Z,{isSmall:!0,children:(0,O.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityMobileTitle",defaultMessage:"Page visibility"})}),(0,O.jsx)(m.Z,{children:h.title(d)})]}),l&&(u?(0,qt.i)(g.chevron):(0,Gt.R)(g.chevron))]}),(0,O.jsx)(Jt.Z,{isVisible:u,animationStyle:g.animation,enterAnimationStyle:g.enterAnimation,exitAnimationStyle:g.exitAnimation,springConfig:{maxHeight:{stiffness:60,damping:12,precision:.1}},render:()=>(0,O.jsx)(cs,{...e,parentCloseCallback:()=>p(!1)})})]}):null}function cs(e){window.__c={n:"PrivacyMenu"};const{store:t,spacePermission:s,sudoModeStore:n,location:r,isRestricted:l,parentCloseCallback:d}=e,u=(0,i.O7)(),p=u.device.isMobile,g=us(s.permissionItem),f=s.from,y=f.table===H.iU?f.blockId:f.teamId,S=!(f.table===t.table&&y===t.id),v=(0,o.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return!!e&&t.isTopLevelWorkspacePage(e.id)}),[t]),M=os(),j=(0,o.VK)((()=>{const e=b.bQ({store:t});return e?us(e):"private"}),[t]),C=(0,a.yK)((e=>{const t={width:14,fill:p?e.regularIconColor:e.mediumTextColor};return{icon:{fill:p?e.regularIconColor:e.mediumTextColor,width:16},iconContainer:{alignSelf:"center",marginLeft:p?13:9},hiddencheckmark:{...t,visibility:"hidden"},selectedCheckmark:{...t,visibility:"visible"},checkmarkContainer:{marginLeft:12},selectedTitle:{fontWeight:A.Z.fontWeight.semibold},mobileScroller:{border:`1px solid ${e.regularDividerColor}`,borderRadius:8,marginBottom:24},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},caption:{whiteSpace:"normal"}}}),[p]);return(0,O.jsx)(c.Z,{menuType:h.og.Popup,disableScroller:!0,scrollerStyle:p?C.mobileScroller:{},children:(0,O.jsx)(ts.Z,{type:ts.i.Vertical,initialFocus:void 0,sections:[{key:"visibilityOptions",render:e=>(0,O.jsx)(is.Z,{...e,disableDesktopPadding:p}),items:ls.map(((e,i)=>{const o=e.key,a=g===o,c=a?C.selectedCheckmark:C.hiddencheckmark,h=i!==ls.length-1,f={...p?C.mobileButton:{},...p&&h?C.mobileButtonDivider:{}};return{key:o,render:t=>(0,O.jsx)("div",{children:(0,O.jsx)(Xt.Z,{title:e.title(M),caption:(0,O.jsx)(m.Z,{isSmall:!0,isMultiline:!0,style:C.caption,children:e.caption}),icon:e.icon(C.icon),desktopIconStyle:C.iconContainer,titleStyle:a&&!p?C.selectedTitle:void 0,right:(0,$t.k)(c),rightStyle:C.checkmarkContainer,style:f,...t})}),action:()=>{if(a)return;const e=s.permissionItem,i={type:"space_permission",role:ms(e,g,o)};"unlisted"===o&&(i.unlisted_timestamp=Date.now());const c=function(e,t){if(e===t)return!1;switch(t){case"open":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,w.t1)(t)}}(j,o)&&!l&&!v;(0,ee.i)({oldPermissionItem:e,newPermissionItem:i,wasInherited:S,environment:u,store:t,sudoModeStore:n,location:r,restrictingVisibility:c}),d()}}}))}]})})}function us(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function ms(e,t,s){return"private"===s?"none":"private"===t?"editor":e.role}const ps=function(e){window.__c={n:"LinkSharingPill"};const{store:t,spacePermission:s}=e,i=us(s.permissionItem),l=(0,o.VK)((()=>t.canAdmin()),[t]),d=os(),c=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),u=(0,o.qz)(void 0,as.Z),m=(0,n.useRef)(null),p=(0,a.yK)((e=>({chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%",minWidth:430},button:{justifyContent:"center",borderRadius:32,height:32,color:e.mediumTextColor,paddingLeft:12,maxWidth:380},title:{...A.Z.textOverflowStyle},icon:{fill:e.mediumTextColor,width:16}})),[]);return c?(0,O.jsx)(es.ZP,{buttonPopupStore:u,popupType:es.Z4.Popup,popupWrapStyle:p.popup,renderOrigin:e=>{const t=ls.find((e=>e.key===i));return t?(0,O.jsx)(pe.ZP,{placement:pe.ug.Bottom,alignment:pe.v2.Start,disableTooltip:l,renderTooltip:()=>(0,O.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to change the privacy setting",id:"linkSharingPill.disabledTooltip.message"}),render:s=>(0,O.jsxs)(ss.Z,{...e,ref:m,style:p.button,icon:t.icon,iconStyle:p.icon,disabled:!l,disabledFeedback:!0,...s,children:[(0,O.jsx)("div",{style:p.title,children:t.title(d)}),l&&(0,qt.i)(p.chevron)]})}):null},placementToOrigin:rs.Iw.Bottom,alignmentToOrigin:rs.lU.Start,sameWidthAsOrigin:!0,render:t=>(0,O.jsx)(cs,{...e,parentCloseCallback:()=>t.close()})}):null};var gs=s(32739),hs=s(50906),fs=s(893),xs=s(95477);function ys(e){window.__c={n:"MobilePageLinkButtonInner"};const{store:t,buttonPopupStore:s,events:n}=e,o=(0,i.O7)(),{device:l,mobileNative:d}=o,c=(0,a.yK)((e=>({button:{flex:1,height:36,minHeight:36}})),[]);return(0,O.jsx)(Y.Z,{onClick:()=>{l.isMobileNative?function(e){const{store:t,mobileNative:s}=e,n=(0,gs.u5)({schemeUrl:(0,wt.ZP)({store:t,pageVisitSource:yt.tY.CopyLink}),baseUrl:xs.default.domainBaseUrl});s&&s.share(n)}({store:t,mobileNative:d}):bs({store:t,buttonPopupStore:s,environment:o}),hs.V5j(o)},style:c.button,...n,children:l.isMobileNative?(0,O.jsx)(r.FormattedMessage,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,O.jsx)(r.FormattedMessage,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function Ss(e){window.__c={n:"PageLinkButtonInner"};const{store:t,buttonPopupStore:s,events:n}=e,o=(0,i.O7)(),l=(0,a.yK)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.regularTextColor,marginLeft:"auto"},icon:{width:14,height:14,fill:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.regularTextColor}})),[]);return(0,O.jsxs)(ns.Z,{isSmall:!0,onClick:()=>{bs({store:t,buttonPopupStore:s,environment:o}),hs.V5j(o)},style:l.button,...n,children:[(0,Ht.N)(l.icon),(0,O.jsx)(m.Z,{isSmall:!0,style:l.label,children:(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})})]})}function vs(e){const{calculatedPermissions:t}=e,s=t.mostPermissivePublicItem.permissionItem;if((0,Oe.YX)(s.role))return(0,O.jsx)(r.FormattedMessage,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const n=t.mostPermissiveSpaceItem.permissionItem;return(0,Oe.YX)(n.role)?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):t.permissionItemsCount>1?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function bs(e){const{store:t,buttonPopupStore:s,environment:n}=e,i=(0,wt.ZP)({store:t,pageVisitSource:yt.tY.CopyLink});await fs.RD({environment:n,stringValue:i,copiedMessage:fs.tq.copiedLinkToClipboard}),s&&s.setState({open:!1})}const Ms=function(e){window.__c={n:"PageLinkButton"};const{store:t,buttonPopupStore:s,calculatedPermissions:n}=e,{device:o}=(0,i.O7)(),r=(0,a.yK)((()=>({tooltip:{width:280}})),[]);return(0,O.jsx)(pe.ZP,{delayThreshold:0,placement:pe.ug.Bottom,renderTooltip:()=>(0,O.jsx)(vs,{calculatedPermissions:n}),textWrap:!0,style:r.tooltip,render:e=>o.isMobile?(0,O.jsx)(ys,{store:t,buttonPopupStore:s,events:e}):(0,O.jsx)(Ss,{store:t,buttonPopupStore:s,events:e})})};const js=function(e){window.__c={n:"ShareMenuFooter"};const{isMobile:t}=(0,i.Fy)(),s=(0,a.yK)((e=>({container:{display:"flex",alignItems:t?"normal":"center",boxShadow:`0 -1px 0 ${e.regularDividerColor}`,flexDirection:t?"column":"row",justifyContent:"space-between",padding:"8px 14px"}})),[t]),{mostPermissiveSpaceItem:n,showRestrictedPermissionBanner:o}=e.calculatedPermissions;return(0,O.jsx)(O.Fragment,{children:(0,O.jsxs)("div",{style:s.container,children:[t?(0,O.jsx)(ds,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:n,isRestricted:o}):(0,O.jsx)(ps,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:n,isRestricted:o}),(0,O.jsx)(Ms,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]})})};var ws=s(90965);function Cs(e){window.__c={n:"UnlistedPermissionItem"};const{store:t,spacePermission:s,fromPermissionWrapper:n}=e,i=(0,a.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]);return(0,O.jsx)(Je.C,{icon:(0,Ht.N)(i.icon),iconStyle:i.iconContainer,title:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess"}),currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,upgradeButtonName:"space_permission_item",fromPermissionWrapper:n,...e.permissionItemArgs})}function ks(e){window.__c={n:"Title"};const{spaceStore:t}=e,s=(0,i.O7)(),n=(0,o.VK)((()=>(0,ft.rn)(s,t)),[s,t]);return(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:n}})}function Ts(e){window.__c={n:"Subtitle"};const{spaceStore:t}=e,s=(0,o.VK)((()=>(0,ws.t5)((0,ft.jv)(t))),[t]);return(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:s}})}function Is(){return(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all members in your workspace.",id:"blockPermissionsSettings.spacePermission.tooltip"})}const Ps=function(e){window.__c={n:"SpacePermissionItem"};const{store:t,spacePermission:s,fromPermissionWrapper:n}=e,i=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),r=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return i?s.permissionItem.unlisted_timestamp?(0,O.jsx)(Cs,{...e}):(0,O.jsx)("div",{style:r.container,className:g.afv,children:(0,O.jsx)(Je.C,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,O.jsx)(xt.p,{disabled:!0,store:i,size:Je.Z}),title:(0,O.jsx)(ks,{spaceStore:i}),nonInheritedTooltip:(0,O.jsx)(Is,{}),subtitle:(0,O.jsx)(Ts,{spaceStore:i}),upgradeButtonName:"space_permission_item",fromPermissionWrapper:n,...e.permissionItemArgs})}):null};var Zs=s(79362),Fs=s(91192),_s=s(95697);function As(e){const{teamName:t,isCompact:s}=e;return s?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):t?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:t}}):(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function Rs(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function Ds(e){window.__c={n:"TeamGuestPermissionTooltip"};const{teamName:t}=e,s=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,O.jsx)("div",{style:s.tooltip,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const Bs=function(e){var t;window.__c={n:"TeamGuestPermissionItem"};const{store:s,blockTeamGuestPermission:n,isExternalTeam:i,fromPermissionWrapper:r}=e,{permissionItem:l}=n,d=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),c=Oe.bm(l)?l.team_id:null===(t=$.VP(s))||void 0===t?void 0:t.id,{teamStore:u,teamIsDefined:m,teamName:p,teamIcon:h,membersCount:f}=(0,o.VK)((()=>{if(!d||!c)return{};const e=Ge.zX.createChildStore(d,{table:pt.e0,id:c,spaceId:d.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName(),teamIcon:e.getIcon(),membersCount:(0,_s.xf)({teamStore:e,spaceStore:d}).length}:{}}),[d,c]),y=!i,S=(0,a.yK)((()=>({container:{width:"100%"}})),[]);if(!u)return null;const v=h&&Zs.V2(h.icon)?Zs.mk(h.icon):"gray",b=h?{...h,icon:`/icons/user-circle_${v}.svg`}:void 0;return(0,O.jsx)("div",{style:S.container,className:g.YHn,children:(0,O.jsx)(Je.C,{isCompact:y,currentBlockStore:s,permissionItem:l,icon:m?(0,O.jsx)(xt.p,{disabled:!0,store:u,size:Je.Z,icon:b}):(0,Fs.x)(),title:(0,O.jsx)(As,{teamName:p,isCompact:y}),nonInheritedTooltip:(0,O.jsx)(Ds,{teamName:p}),from:n.from,subtitle:m&&(0,O.jsx)(Rs,{membersCount:f,isCompact:y}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})})};var Ls=s(1951);function Os(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):t?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",values:{teamName:t}}):(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function Es(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function Ns(e){window.__c={n:"TeamMemberPermissionTooltip"};const{teamName:t}=e,s=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,O.jsx)("div",{style:s.tooltip,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const Vs=function(e){var t;window.__c={n:"TeamMemberPermissionItem"};const{store:s,blockTeamPermission:n,isExternalTeam:i,fromPermissionWrapper:r}=e,{permissionItem:l}=n,d=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),c=Oe.zU(l)?l.team_id:null===(t=$.VP(s))||void 0===t?void 0:t.id,{teamStore:u,teamIsDefined:m,teamName:p,membersCount:h}=(0,o.VK)((()=>{if(!d||!c)return{};const e=Ge.zX.createChildStore(d,{table:pt.e0,id:c,spaceId:d.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName(),membersCount:(0,_s.xf)({teamStore:e,spaceStore:d}).length}}),[d,c]),f=!i,y=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return u?(0,O.jsx)("div",{style:y.container,className:g.YHn,children:(0,O.jsx)(Je.C,{isCompact:f,currentBlockStore:s,permissionItem:n.permissionItem,from:n.from,icon:m?(0,O.jsx)(xt.p,{disabled:!0,store:u,size:Je.Z}):(0,Fs.x)(),title:(0,O.jsx)(Os,{teamName:p,isCompact:f}),nonInheritedTooltip:(0,O.jsx)(Ns,{teamName:(0,O.jsx)(Ls.Z,{store:u,useInvertedColors:!0})}),subtitle:m&&(0,O.jsx)(Es,{membersCount:h,isCompact:f}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})}):null};var Us=s(79414);function Ws(e){const{store:t,teamOwners:s,teamStore:n,teamName:i}=e;if(i){const e=s.map((e=>Ge.U6.createChildStore(t,{table:Ee.KJ,id:e})));return(0,O.jsx)(Us.n,{teamStore:n,ownerStores:e})}return(0,Fs.x)()}function Ks(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:t}}):t?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",values:{teamName:t}}):(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function zs(e){const{teamOwnersCount:t,isCompact:s}=e;return s||0===t?null:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:t}})}function qs(e){window.__c={n:"TeamOwnerPermissionTooltip"};const{teamName:t}=e,s=(0,a.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,O.jsx)("div",{style:s.tooltip,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:t},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const Gs=function(e){var t;window.__c={n:"TeamOwnerPermissionItem"};const{store:s,blockTeamOwnerPermission:n,isExternalTeam:i,fromPermissionWrapper:r}=e,{permissionItem:l}=n,d=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),c=Oe.LW(l)?l.team_id:null===(t=$.VP(s))||void 0===t?void 0:t.id,{teamStore:u,teamName:m,teamOwners:p}=(0,o.VK)((()=>{if(!d||!c)return{undefined:void 0};const e=Ge.zX.createChildStore(d,{table:pt.e0,id:c,spaceId:d.id});return{teamStore:e,teamName:e.getName(),teamOwners:(0,Ue.XO)({membership:e.getMembers()})}}),[d,c]),h=!i,f=(0,a.yK)((()=>({container:{width:"100%"}})),[]);return u?(0,O.jsx)("div",{style:f.container,className:g.ZmO,children:(0,O.jsx)(Je.C,{isCompact:h,currentBlockStore:s,permissionItem:n.permissionItem,from:n.from,icon:(0,O.jsx)(Ws,{store:s,teamName:m,teamStore:u,teamOwners:p}),title:(0,O.jsx)(Ks,{teamName:m,isCompact:h}),nonInheritedTooltip:(0,O.jsx)(qs,{teamName:(0,O.jsx)(Ls.Z,{store:u,useInvertedColors:!0})}),subtitle:(0,O.jsx)(zs,{teamOwnersCount:p.length,isCompact:h}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})}):null};var Hs=s(25942),Qs=s(33241),Ys=s(22487);function $s(e){const{teamName:t}=e;return t?(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",values:{teamName:t??""}}):(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden"})}function Js(e){const{membersCount:t}=e;return(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}const Xs=function(e){var t;window.__c={n:"TeamPermissionItem"};const{store:s,blockTeamMemberPermission:r,blockTeamOwnerPermission:l,blockTeamGuestPermission:d}=e,c=(0,i.O7)(),u=(0,i.Fy)(),[m,p]=(0,n.useState)(!1),{permissionItem:g}=r,h=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),f=Oe.zU(g)?g.team_id:null===(t=$.VP(s))||void 0===t?void 0:t.id,y=l.permissionItem.role,S=g.role,v={type:"team_overview_permission",role:y===S?S:"none"===S||"none"===y?"limited":"access"},{teamStore:b,teamIsDefined:j,teamName:w}=(0,o.VK)((()=>{if(!h||!f)return{undefined:void 0};const e=Ge.zX.createChildStore(h,{table:pt.e0,id:f,spaceId:h.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[h,f]),C=(0,Ys.K)(b),k=(0,o.VK)((()=>{if(!h)return!1;return!h.getDisableTeamGuests()&&((null==b||!b.isDefault())&&(0,fe.F$)())}),[h,b]),T=(0,n.useCallback)((()=>{const e=!1===m;if(p(!m),e){if(!b)return;Ve.dS(c,{share_menu_session_id:M.ZP.state.sessionId,type:"team",team_id:b.id})}}),[c,m,p,b]),I=(0,a.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:m?"block":"none"},roleButton:{marginRight:-8,color:e.mediumTextColor,fontSize:u.isMobile?14:12}})),[m,u.isMobile]),P=(0,Gt.R)(I.icon);return b?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(Je.C,{currentBlockStore:s,permissionItem:v,from:r.from,icon:j?(0,O.jsx)(xt.p,{disabled:!0,store:b,size:Je.Z}):(0,Fs.x)(),title:(0,O.jsx)($s,{teamName:w}),subtitle:j&&(0,O.jsx)(Js,{membersCount:C}),upgradeButtonName:"team_permission_item",onClick:T,permissionRoleSelect:m?P:(0,O.jsx)(Qs.d,{role:v.role,icon:Hs.P,disabled:!0,buttonStyle:I.roleButton,table:H.iU,isRemovable:!1,isCurrentUser:!1}),...e.permissionItemArgs}),(0,O.jsxs)("div",{style:I.teamPermissionsContainer,children:[l&&(0,O.jsx)(Gs,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamOwnerPermission:l,fromPermissionWrapper:"expandable_permission"}),r&&(0,O.jsx)(Vs,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamPermission:r,fromPermissionWrapper:"expandable_permission"}),k&&d&&(0,O.jsx)(Bs,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamGuestPermission:d,fromPermissionWrapper:"expandable_permission"})]})]}):null};function en(e){const{store:t,permissionItemArgs:s}=e,{showTeamPermission:n,showSpacePermission:i,mostPermissiveAncestorTeamOwnerItem:o,mostPermissiveAncestorTeamMemberItem:a,mostPermissiveAncestorTeamGuestItem:r,mostPermissiveSpaceItem:l,pagePermissionUIModel:d}=e.calculatedPermissions,c=Number(n)+Number(i);return(0,O.jsxs)(O.Fragment,{children:[n&&o&&a&&(0,O.jsx)(Xs,{store:t,blockTeamOwnerPermission:o,blockTeamMemberPermission:a,blockTeamGuestPermission:r,permissionItemArgs:s}),i&&(0,O.jsx)(Ps,{store:t,spacePermission:l,permissionItemArgs:s,fromPermissionWrapper:"permission_list"}),(0,O.jsx)(tn,{store:t,pagePermissions:d,numberPermissionsAlreadyRendered:c,permissionItemArgs:s})]})}function tn(e){window.__c={n:"PagePermissionsList"};const t=(0,r.useIntl)(),s=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:n,pagePermissions:i,numberPermissionsAlreadyRendered:a,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:u,mostPermissiveTeamPermissions:m,mostPermissiveUserPermissions:p,spacePermissionGroups:g}=i,h=(0,o.VK)((()=>We()),[]),f=(0,o.VK)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:s}=e,n={};return t.forEach((t=>{n[t.permissionItem.user_id]=(0,O.jsx)(rt,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:s,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),n}({store:n,mostPermissiveUserPermissions:p,permissionItemArgs:l,spaceVisibleUserMap:h}):[];return Le.oA(Object.keys(e).map((s=>{const i=Ge.U6.createChildStore(n,{table:Ee.KJ,id:s}),o=i.getModel();if(!i.isReady()||o)return{title:(0,Ne.Nz)(t,o),permissionItem:e[s]}})))}),[c,p,l,n,t,h]),y=s?function(e){const{spaceId:t,spacePermissionGroups:s,mostPermissiveGroupPermissions:n}=e,i={};return n.forEach((n=>{const o=n.permissionItem.group_id;s.find((e=>e.id===o))&&(i[o]=(0,O.jsx)(et,{store:e.store,groupPermission:n,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),i}({store:n,spaceId:s,spacePermissionGroups:g,mostPermissiveGroupPermissions:u,permissionItemArgs:l}):[],S=function(e){const{store:t,mostPermissiveTeamPermissions:s,permissionItemArgs:n}=e;return s.map((e=>Oe.LW(e.permissionItem)?(0,O.jsx)(Gs,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):Oe.bm(e.permissionItem)?(0,O.jsx)(Bs,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,O.jsx)(Vs,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:n,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:n,mostPermissiveTeamPermissions:m,permissionItemArgs:l}),v=[...f,...Object.keys(y).map((e=>{const s=g.find((t=>t.id===e));return{title:s?(0,qe.kF)({intl:t,group:s}):"",permissionItem:y[e]}}))];v.sort(((e,t)=>e.title.localeCompare(t.title)));const b=S.concat(v.map((e=>e.permissionItem))),M=b.length;if(0===M)return null;if(M>5-a){const e=Math.max(2-a,0);return(0,O.jsxs)(O.Fragment,{children:[d&&(0,O.jsx)(Et,{}),b.slice(0,e),(0,O.jsx)(dt,{permissions:b.slice(e,-1)}),b[M-1]]})}return(0,O.jsxs)(O.Fragment,{children:[d&&(0,O.jsx)(Et,{}),b]})}function sn(e,t){return e.from.table===H.iU&&e.from.blockId===t.id}const nn=function(e){window.__c={n:"PermissionsList"};const t=(0,i.O7)(),{device:s}=t,{store:r,permissionItemArgs:l,calculatedPermissions:d}=e,{sudoModeStore:c}=l,{permissionItemsCount:u,pagePermissionUIModel:m,showRestrictedPermissionBanner:p}=d,g=(0,o.VK)((()=>{const e=x.default.state.currentSpaceStore;if(!e)return!0;if(r.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const s=(0,$.uJ)(r);for(const n of s)if((0,ze.OY)(n)&&n.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[r,t]);let h=null;const f=(0,o.VK)((()=>(0,b.up)({store:r,showRestrictedPermissionBanner:p})),[r,p]),{canAccessParent:y}=(0,o.VK)((()=>(0,b.HB)({store:r})),[r]),S={...d};if(!f&&y){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:n,mostPermissiveUserPermissions:i}=t,[o,a]=Le.uK(s,(t=>sn(t,e))),[r,l]=Le.uK(n,(t=>sn(t,e))),[d,c]=Le.uK(i,(t=>sn(t,e))),u={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},m={...t,mostPermissiveGroupPermissions:o,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[u,m]}(r,m);S.pagePermissionUIModel=e,h=(0,O.jsx)(tn,{store:r,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:l,showHeader:!0})}const v=(0,o.VK)((()=>!(0,b.gi)({store:r})),[r]),M=s.isMobile?je.Z.None:je.Z.Y,j=(0,a.yK)((e=>({scroller:{paddingBottom:10,minHeight:s.isMobile||0===u?void 0:1===u?60:90}})),[s,u]);return(0,n.useEffect)((()=>{Ve.oE({environment:t,calculatedPermissions:d})}),[]),(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)(me.Z,{style:j.scroller,type:M,children:[!g&&(0,O.jsx)(Ot,{store:r}),(0,O.jsx)(zt,{store:r,showRestrictedPermissionBanner:p,sudoModeStore:c}),!f&&u>0&&(0,O.jsx)(Vt,{store:r}),(0,O.jsx)(en,{store:r,calculatedPermissions:S,permissionItemArgs:l}),h,v&&(0,O.jsx)(ut,{store:r})]}),!s.isMobile&&(0,O.jsx)(js,{store:r,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:S,permissionItemArgs:l})]})};s(57658);var on=s(33728),an=s(58573),rn=s(59054),ln=s(85397),dn=s(47612),cn=s(60322),un=s(36591),mn=s(36329),pn=s(21752),gn=s(43765),hn=s(69507),fn=s(70268),xn=s(98742),yn=s(35057),Sn=s(10039);function vn(e){window.__c={n:"PublicPermissionLevelBanner"};const{publicPermission:t}=e,s=(0,a.yK)((e=>({banner:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},label:{fontSize:12,display:"inline-flex",marginRight:10},icon:{height:20,width:20,marginLeft:14,marginRight:8,color:e.mediumIconColor},manageButton:{color:e.regularTextColor,fontWeight:A.Z.fontWeight.medium}})),[]),n=t.permissionItem.role;return Oe.YX(n)?(0,O.jsxs)("div",{style:s.banner,children:[(0,O.jsxs)(m.Z,{style:s.label,children:[(0,F.I)(s.icon),(0,O.jsx)(bn,{role:n})]}),(0,O.jsx)(jt.Z,{style:s.manageButton,onClick:()=>M.ZP.setState({...M.ZP.state,display:M.wV.Publish,tab:M.XF.Publish}),children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Manage"})})]}):null}function bn(e){const{role:t}=e;switch(t){case"read_and_write":return(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,w.t1)(t)}}function Mn(e){window.__c={n:"ShareMenuSearchRequestImpl"};const{store:t,shouldShowSlackOnly:s,calculatedPermissions:n,permissionItemArgs:l,tokenQuery:d,showShimmer:c,error:u,ready:m,result:p}=e,g=n.pagePermissionUIModel,h=(0,i.O7)(),f=(0,o.qz)(e.inviteTargetsStore,C.ZP),y=(0,o.qz)(e.menuListStore,Ce.Z),S=(0,o.VK)((()=>We()),[]),v=(0,o.VK)((()=>fe.Rv()),[]),b=(0,a.yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:110},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:12,height:12,marginRight:3,marginTop:3,color:e.v2.text.quaternary}})),[]),{inPageTargets:M,notInPageTargets:j,filteredImportedContacts:k}=(0,o.VK)((()=>{const{inviteUsers:e,inviteGroups:s,importedContacts:i=[]}=p??{inviteUsers:[],inviteGroups:[],importedContacts:[]},o=[...e,...s],a=[],r=[],l=new Set;o.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const s=Boolean(ve.Zp({store:t,target:e})),i=function(e){const{inviteTarget:t,blockStore:s,spacePermission:n,teamMemberPermission:i,groupPermission:o}=e,a=t.type;if("newUser"===a)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===a)return Se.uY({userId:t.value.id,store:s});if("group"===a){const e={role:"none",type:"group_permission",group_id:t.value.id},a=(0,$.VP)(s),r=null==a?void 0:a.getMembers().find((e=>(0,Ue.lF)({groupId:t.value.id,teamMember:e})));return[n,...a&&i&&r?[i]:[],o||{permissionItem:e,from:{table:H.iU,blockId:s.id}}].sort(((e,t)=>Oe.xm[t.permissionItem.role]-Oe.xm[e.permissionItem.role]))}(0,w.t1)(a)}({inviteTarget:e,blockStore:t,spacePermission:n.mostPermissiveSpaceItem,teamMemberPermission:n.mostPermissiveAncestorTeamMemberItem,groupPermission:"group"===e.type?g.mostPermissiveGroupPermissions.find((t=>t.permissionItem.group_id===e.value.id)):void 0}),o=Array.isArray(i)?i[0].permissionItem:i;if("existingUser"===e.type&&!Boolean(e.spaceRole)){const t=S.get(e.value.id);e.spaceRole=t?t.role:"not_in_space"}(s||Oe.YX(o.role??"none"))&&"newUser"!==e.type?a.push({inviteTarget:e,permissionItem:o,mostPermissivePermissions:Array.isArray(i)?i:void 0}):"newUser"!==e.type&&r.push(e)}));const d=i.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:a,notInPageTargets:r,filteredImportedContacts:d}}),[t,p,n.mostPermissiveSpaceItem,n.mostPermissiveAncestorTeamMemberItem,g.mostPermissiveGroupPermissions,S]),{isValidEmail:T,isEmailInTargets:I}=(0,o.VK)((()=>{const e=(0,on.H3)(d);return{isValidEmail:(0,on.oH)(e),isEmailInTargets:[...M.map((e=>{let{inviteTarget:t}=e;return t})),...j].some((t=>"group"!==t.type&&t.value.email===e))}}),[d,M,j]),P=T&&!I,Z=!s&&j.length>0&&0===d.length,F=!s&&d.length>0&&M.length>0,_=!s&&j.length>0&&d.length>0,A=v&&k.length>0,R={key:"imported contacts",render:e=>(0,O.jsx)(is.Z,{...e,style:b.sectionMenuItem,title:(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.importedContactsSection.title",defaultMessage:"From Slack"}),loading:!m}),items:k.map(((e,s)=>({key:e.value.email,render:s=>(0,O.jsx)(_n,{...s,invited:!1,inviteTarget:e,isInInviteTargets:ye.H({target:e,inviteTargetsStore:f}),blockStore:t,spaceVisibleUserMap:S}),action:()=>{ye.H({target:e,inviteTargetsStore:f})?f.setState({...f.state,inviteTargets:f.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(re.hE(h,{invite_token_query:d,selected_user_token:e,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,yn.zt)(),type:"slack"}),f.setState({inviteTargets:[...f.state.inviteTargets,e],tokenQuery:""}),y.unsetFocus())}})))},{shouldShowAutoFillEmail:D,showGuestVsMemberTag:B}=(0,o.VK)((()=>{if(P){return{shouldShowAutoFillEmail:"control"!==fe.uD(),showGuestVsMemberTag:!1}}if(Z||F||_||A||s)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(s&&0===R.items.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(0===d.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};return{shouldShowAutoFillEmail:"control"!==fe.uD(),showGuestVsMemberTag:!1}}),[P,Z,F,_,A,s,R.items.length,d]),L=(0,o.VK)((()=>{const e=Te.subscriptionDataStoreInstance.state,{currentSpaceStore:t}=x.default.state;return t&&e?ke.hn(e).map((s=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(s.userId)){const e=Ge.U6.createChildStore(t,{table:Ee.KJ,id:s.userId}).getEmail();return e&&(0,on.Gd)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]),E=(0,be.Z)(t);if(u)return(0,O.jsx)(hn.l,{loading:!m,children:(0,O.jsx)(gn.Z,{title:(0,O.jsx)(r.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!m&&c)return(0,O.jsx)(fn.B,{areaHeight:window.innerHeight});const N={key:"user results",render:e=>(0,O.jsx)(is.Z,{...e,style:b.sectionMenuItem,loading:!m,title:(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:Bn({tokenQuery:d,possibleDomains:L,showGuestVsMemberTag:B,shouldShowAutoFillEmail:D,isGuestInviteRequestRequired:E.isGuestRequestRequired,environment:h,inviteTargetsStore:f,menuListStore:y,store:t,styles:b})},V={key:"suggested",render:e=>(0,O.jsx)(is.Z,{...e,style:b.sectionMenuItem,title:(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!m}),items:j.map(((e,s)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>{const n=ye.H({target:e,inviteTargetsStore:f});return(0,O.jsx)(_n,{...s,invited:!1,inviteTarget:e,isInInviteTargets:n,blockStore:t,spaceVisibleUserMap:S})},action:()=>jn({inviteTarget:e,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"suggested"})})))},U={key:"in page",render:e=>(0,O.jsx)(is.Z,{...e,style:b.sectionMenuItem,title:(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!m}),items:M.map(((e,s)=>{const{inviteTarget:n,permissionItem:i,mostPermissivePermissions:o}=e,{type:a}=n;if("existingUser"===a){if(!!o&&o.length>1)return{key:n.value.id,render:e=>(0,O.jsx)(kn,{...e,blockStore:t,inviteTarget:n,permissionItem:i,mostPermissivePermissions:o,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===n.value.id));return e?{key:n.value.id,render:s=>(0,O.jsx)(Xt.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,O.jsx)(rt,{store:t,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:S,permissionItemArgs:l})}),action:()=>{}}:{key:n.value.id,render:e=>(0,O.jsx)(kn,{...e,blockStore:t,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>jn({inviteTarget:n,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"in_page"})}}}if("group"===a){if(!!o&&o.length>1)return{key:n.value.id,render:o=>(0,O.jsx)(kn,{...o,blockStore:t,inviteTarget:n,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>{}};{const e=g.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===n.value.id));return e?{key:n.value.id,render:s=>(0,O.jsx)(Xt.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,O.jsx)(et,{store:t,groupPermission:e,spaceId:t.getSpaceId(),showInherited:!0,permissionItemArgs:l})}),action:()=>{}}:{key:n.value.id,render:e=>(0,O.jsx)(kn,{...e,blockStore:t,inviteTarget:n,permissionItem:i,spaceVisibleUserMap:S,permissionItemArgs:l,rank:s,tokenQuery:d}),action:()=>jn({inviteTarget:n,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"in_page"})}}}(0,w.t1)(a)}))},W={key:"not in page",render:e=>(0,O.jsx)(is.Z,{...e,style:b.sectionMenuItem,title:d.length>0&&(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"}),loading:!m}),items:j.map(((e,s)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>(0,O.jsx)(_n,{...s,invited:!1,inviteTarget:e,isInInviteTargets:ye.H({target:e,inviteTargetsStore:f}),blockStore:t,spaceVisibleUserMap:S}),action:()=>jn({inviteTarget:e,inviteTargetsStore:f,menuListStore:y,rank:s,tokenQuery:d,environment:h,type:"not_in_page"})})))};let K=[];return P&&K.push(N),Z&&K.push(V),F&&K.push(U),_&&K.push(W),A&&K.push(R),s&&(K=[R],0===R.items.length)?(0,O.jsx)(An,{styles:b}):0===K.length&&(K=[N],0===d.length)?(0,O.jsx)(Rn,{styles:b,shouldShowSlackMessage:v}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(vn,{publicPermission:n.mostPermissivePublicItem}),(0,O.jsx)(ts.Z,{type:ts.i.Vertical,initialFocus:d.length>0?0:void 0,sections:K,store:y})]})}function jn(e){const{inviteTarget:t,inviteTargetsStore:s,menuListStore:n,rank:i,tokenQuery:o,environment:a,type:r}=e;if(ye.H({target:t,inviteTargetsStore:s})){const e=s.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type||"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return s.setState({...s.state,inviteTargets:e}),void n.unsetFocus()}re.hE(a,{invite_token_query:o,selected_user_token:t,selected_user_token_rank:i,from:"share_modal_invite",subscription_tier:(0,yn.zt)(),type:r}),s.setState({inviteTargets:[...s.state.inviteTargets,t],tokenQuery:""}),n.unsetFocus()}const wn=n.forwardRef(((e,t)=>{window.__c={n:"InPageGroupResultItem"};const{blockStore:s,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,permissionItemArgs:u}=e,p=(0,i.O7)(),g=(0,r.useIntl)(),[h,f]=(0,n.useState)(!1),y=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),S=(0,o.VK)((()=>s.getSpaceId()),[s]),v=(0,o.VK)((()=>c&&c.length>0),[c]),b=(0,o.VK)((()=>{if("group"===l.type)return(0,qe.kF)({group:l.value,intl:g})}),[l,g]),j=(0,o.VK)((()=>{if(y&&"group"===l.type&&l.value.icon)return{pointer:{table:y.table,id:y.id},icon:l.value.icon}}),[y,l]),C=(0,o.VK)((()=>y?"group"!==l.type?0:(0,qe.rm)({group:l.value,spaceStore:y,limit:void 0}).totalNumberMembers:0),[y,l]),k=(0,n.useCallback)((()=>{if(v){const e=!1===h;f(!h),e&&Ve.dS(p,{share_menu_session_id:M.ZP.state.sessionId,type:"group",group_id:l.value.id})}}),[p,v,h,f,l]),T=(0,a.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10},permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:A.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,O.jsx)(pe.ZP,{delayThreshold:0,placement:pe.ug.Left,textWrap:!0,style:T.tooltip,renderTooltip:()=>(0,O.jsx)(Tn,{blockStore:s,blockPermissionItem:d}),render:n=>(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{...n,children:(0,O.jsx)(Xt.Z,{...e,...(0,xn.Z)(e,{onClick:k}),ref:t,title:(0,O.jsxs)("div",{style:T.titleContainer,children:[(0,O.jsx)(He.Z,{size:32}),(0,O.jsxs)("div",{style:T.groupInfoContainer,children:[(0,O.jsxs)("div",{style:T.nameAndIconContainer,children:[(0,O.jsx)(m.Z,{style:T.groupNameLabel,children:b}),Boolean(null==j?void 0:j.icon)&&(0,O.jsx)(Qe.Z,{disabled:!0,bucket:"public",title:b,icon:j,size:18,isEmptyPage:!1})]}),(0,O.jsx)(m.Z,{isSmall:!0,style:T.groupMembersLabel,children:v&&h?(0,O.jsx)(In,{}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:C}})]})})]})]}),right:(0,O.jsx)(Qs.d,{table:H.iU,disabled:!0,icon:v?h?Gt.R:Hs.P:void 0,role:d.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:T.permissionRoleButton})})}),v&&h&&(0,O.jsx)("div",{style:T.expandablePermissionList,children:null==c?void 0:c.map(((e,t)=>{const n=e.permissionItem.type;let i=null;switch(n){case"space_permission":i=(0,O.jsx)(Ps,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,O.jsx)(Vs,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,O.jsx)(et,{spaceId:S,store:s,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":break;case"explicit_team_owner_permission":case"explicit_team_guest_permission":break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,w.t1)(n)}return(0,O.jsx)("div",{style:T.roundedPermissionItem,children:i},t)}))})]})})})),Cn=n.forwardRef(((e,t)=>{window.__c={n:"InPageUserResultItem"};const{blockStore:s,inviteTarget:r,permissionItem:l,mostPermissivePermissions:d,spaceVisibleUserMap:c,permissionItemArgs:u}=e,m=(0,i.O7)(),[p,g]=(0,n.useState)(!1),h="existingUser"===r.type?Ge.U6.createChildStore(s,{table:Ee.KJ,id:r.value.id}):void 0,f=(0,o.VK)((()=>"none"===r.spaceRole?Ke({spaceVisibleUserMap:c,userId:r.value.id,blockStore:s}):(0,pn.K)(r.spaceRole)),[r,c,s]),x=(0,o.VK)((()=>s.getSpaceId()),[s]),y=(0,o.VK)((()=>d&&d.length>0),[d]),S=(0,n.useCallback)((()=>{const e=!1===p;g(!p),e&&Ve.dS(m,{share_menu_session_id:M.ZP.state.sessionId,type:"user",userId:r.value.id})}),[m,p,g,r]),v=(0,a.yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:A.Z.fontWeight.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:24},roundedPermissionItem:{borderRadius:4,overflow:"hidden",marginRight:4}})),[]);return(0,O.jsx)(pe.ZP,{delayThreshold:0,placement:pe.ug.Left,textWrap:!0,style:v.tooltip,renderTooltip:()=>(0,O.jsx)(Tn,{blockStore:s,blockPermissionItem:l}),render:n=>(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{...n,children:(0,O.jsx)(Xt.Z,{...e,...(0,xn.Z)(e,{onClick:S}),ref:t,title:(0,O.jsx)(pn.Z,{isLarge:!0,actorStore:h,containerStyle:v.cellMemberAvatarContainer,spaceRole:f,caption:y&&p?(0,O.jsx)(In,{}):void 0}),right:(0,O.jsx)(Qs.d,{table:H.iU,disabled:!0,icon:y?p?Gt.R:Hs.P:void 0,role:l.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:v.permissionRoleButton})})}),y&&p&&(0,O.jsx)("div",{style:v.expandablePermissionList,children:null==d?void 0:d.map(((e,t)=>{const n=e.permissionItem.type;let i=null;switch(n){case"space_permission":i=(0,O.jsx)(Ps,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_owner_permission":i=(0,O.jsx)(Gs,{store:s,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":i=(0,O.jsx)(Vs,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":i=(0,O.jsx)(Bs,{store:s,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":i=(0,O.jsx)(et,{store:s,spaceId:x,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":i=(0,O.jsx)(rt,{store:s,userPermission:e,permissionItemArgs:u,spaceVisibleUserMap:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,w.t1)(n)}return(0,O.jsx)("div",{style:v.roundedPermissionItem,children:i},t)}))})]})})})),kn=n.forwardRef(((e,t)=>{const{inviteTarget:s}=e,n=s.type;switch(n){case"group":return(0,O.jsx)(wn,{...e,ref:t,inviteTarget:s});case"existingUser":return(0,O.jsx)(Cn,{...e,ref:t,inviteTarget:s});default:(0,w.t1)(n)}}));function Tn(e){window.__c={n:"InPageItemTooltip"};const{blockStore:t,blockPermissionItem:s}=e,n=(0,i.O7)(),l=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),d=(0,o.VK)((()=>{if(l)return(0,ft.Wd)(n,l)}),[n,l]),c=(0,o.VK)((()=>{const e=s.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return Ge.zX.createChildStore(t,{table:pt.e0,id:s.team_id})}}),[t,s]),u=(0,o.VK)((()=>null==c?void 0:c.getIcon()),[c]),m=(0,a.yK)((()=>({container:{fontWeight:A.Z.fontWeight.bold,...A.Z.textOverflowStyle},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),p=s.type;return"space_permission"===p?(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,O.jsxs)("span",{style:m.container,children:[d&&(0,O.jsx)(Qe.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:m.recordIcon}),l&&(0,O.jsx)(Mt.Z,{store:l,style:m.recordTitle})]})}}):"explicit_team_owner_permission"===p?(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,O.jsxs)("span",{style:m.container,children:[u&&(0,O.jsx)(Qe.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,O.jsx)(Mt.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_permission"===p?(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,O.jsxs)("span",{style:m.container,children:[u&&(0,O.jsx)(Qe.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,O.jsx)(Mt.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_guest_permission"===p?(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,O.jsxs)("span",{style:m.container,children:[u&&(0,O.jsx)(Qe.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,O.jsx)(Mt.Z,{store:c,style:m.recordTitle})]})}}):"group_permission"===p?(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===p||"exclusive_user_permission"===p||"public_permission"===p||"restricted_permission"===p||"deleted_permission"===p||"team_permission"===p||"team_owner_permission"===p||"bot_permission"===p?(0,O.jsx)(O.Fragment,{children:Oe.YX(s.role??"none")&&(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,w.t1)(p)}function In(){return(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function Pn(e){window.__c={n:"CircleCheckmark"};const{checked:t}=e,s=(0,a.yK)((e=>({circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,borderColor:t?T.ZP.blue:e.buttonPressedBackground,backgroundColor:t?T.ZP.blue:"transparent",marginRight:6},checkIcon:{height:12,width:12,color:"white"}})),[t]);return(0,O.jsx)("div",{style:s.circleCheckmark,children:t&&(0,un.e)(s.checkIcon)})}const Zn=n.forwardRef(((e,t)=>{window.__c={n:"NotInPageGroupResultItem"};const{inviteTarget:s,isInInviteTargets:n,disabled:i}=e,l=(0,r.useIntl)(),d=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),c=(0,o.VK)((()=>(0,qe.kF)({group:s.value,intl:l})),[s,l]),u=(0,o.VK)((()=>{if(d&&s.value.icon)return{pointer:{table:d.table,id:d.id},icon:s.value.icon}}),[d,s]),p=(0,o.VK)((()=>{if(!d)return 0;return(0,qe.rm)({group:s.value,spaceStore:d,limit:void 0}).totalNumberMembers}),[d,s]),g=(0,a.yK)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]),h=(0,O.jsxs)("div",{style:g.titleContainer,children:[(0,O.jsx)(He.Z,{size:32}),(0,O.jsxs)("div",{style:g.groupInfoContainer,children:[(0,O.jsxs)("div",{style:g.nameAndIconContainer,children:[(0,O.jsx)(m.Z,{style:g.groupNameLabel,children:c}),Boolean(null==u?void 0:u.icon)&&(0,O.jsx)(Qe.Z,{disabled:!0,bucket:"public",title:c,icon:u,size:18,isEmptyPage:!1})]}),(0,O.jsxs)(m.Z,{isSmall:!0,style:g.groupMembersLabel,children:[(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:p}})]})]})]});return(0,O.jsx)(Xt.Z,{...e,ref:t,title:h,right:(0,O.jsx)(Pn,{checked:n}),disabled:i})})),Fn=n.forwardRef(((e,t)=>{window.__c={n:"NotInPageUserResultItem"};const{inviteTarget:s,blockStore:i,isInInviteTargets:r,disabled:l,spaceVisibleUserMap:d,...c}=e,u=(0,a.yK)((()=>({cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),m=(0,o.VK)((()=>"existingUser"===s.type?Ke({spaceVisibleUserMap:d,userId:s.value.id,blockStore:i}):void 0),[s,d,i]),p=(0,n.useMemo)((()=>"existingUser"===s.type?{actorStore:Ge.U6.createChildStore(i,{table:Ee.KJ,id:s.value.id}),avatar:void 0}:"newUser"===s.type?{actorStore:void 0,avatar:{email:s.value.email,name:"slack"===s.source?s.value.name:void 0,avatarUrl:"slack"===s.source?s.value.avatar_url:void 0}}:void(0,w.t1)(s)),[s,i]);return(0,O.jsx)(Xt.Z,{...c,ref:t,title:(0,O.jsx)(pn.Z,{isLarge:!0,...p,containerStyle:u.cellMemberAvatarContainer,avatarBadge:"newUser"===s.type&&"slack"===s.source?(0,O.jsx)(D.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,style:u.iconBox,imageStyle:u.iconBoxImage}):void 0,spaceRole:m}),disabled:l,right:!l&&(0,O.jsx)(Pn,{checked:r})})})),_n=n.forwardRef(((e,t)=>{const{inviteTarget:s,blockStore:n,spaceVisibleUserMap:i}=e,o=s.type;switch(o){case"group":return(0,O.jsx)(Zn,{...e,ref:t,inviteTarget:s});case"newUser":case"existingUser":return(0,O.jsx)(Fn,{...e,ref:t,inviteTarget:s,blockStore:n,spaceVisibleUserMap:i});default:(0,w.t1)(o)}}));function An(e){const{styles:t}=e;return(0,O.jsxs)("div",{style:t.zeroState,children:[(0,mn._)(t.zeroStateIcon),(0,O.jsxs)("div",{style:t.zeroStateText,children:[(0,O.jsx)("div",{style:{fontWeight:A.Z.fontWeight.semibold,marginBottom:4},children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,O.jsx)("div",{children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different Slack workspace or typing an email address"})})]})]})}function Rn(e){const{styles:t,shouldShowSlackMessage:s}=e;return(0,O.jsxs)("div",{style:t.zeroState,children:[(0,dn.C)(t.zeroStateIcon),(0,O.jsxs)("div",{style:t.zeroStateText,children:[(0,O.jsx)("div",{style:{fontWeight:A.Z.fontWeight.semibold,marginBottom:4},children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Search or add people"})}),(0,O.jsx)("div",{children:s?(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try connecting a Slack workspace or typing an email address"}):(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.defaultText",defaultMessage:"Try typing an email address"})})]})]})}function Dn(e){let{tokenQuery:t,possibleDomains:s,shouldShowAutoFillEmail:n}=e;const i=(0,an.ZP)(t,function(e,t,s){return s?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,s)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:s}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,s,n),(e=>e.tokenQuery));return 0===i.length?[{tokenQuery:t,weight:0}]:i}function Bn(e){let{tokenQuery:t,possibleDomains:s,showGuestVsMemberTag:n,isGuestInviteRequestRequired:i,shouldShowAutoFillEmail:o,environment:a,inviteTargetsStore:l,menuListStore:d,store:c,styles:u}=e;return Dn({tokenQuery:t,possibleDomains:s,shouldShowAutoFillEmail:o}).map(((e,s)=>({key:e.tokenQuery,render:t=>(0,O.jsx)(Xt.Z,{icon:(0,ln.a)({width:24,height:24}),title:(0,O.jsx)(Ln,{tokenQuery:e.tokenQuery,shouldShowAutofillEmail:o,isGuestInviteRequestRequired:i}),caption:i?(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem.caption",defaultMessage:"Workspace owners are required to view and approve guest invites"}):void 0,right:(0,O.jsxs)(O.Fragment,{children:[o?(0,cn.y)(u.arrowUpLeftIcon):null,n?(0,O.jsx)(Sn.Z,{store:c,onlyShowTokenType:!0,showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e.tokenQuery},spaceRole:"not_in_space"}},e.tokenQuery):null]}),rightStyle:{marginRight:4},...t}),action:async()=>{const n=(0,on.H3)(e.tokenQuery);if(!(0,on.oH)(n)){const t={type:"invalidUser",value:{text:e.tokenQuery}};return void(ye.H({target:t,inviteTargetsStore:l})||l.setState({inviteTargets:[...l.state.inviteTargets,t],tokenQuery:""}))}const i=await de.M5(a,[n]);if(!i.length)return;const o=i[0];ye.H({target:o,inviteTargetsStore:l})||(re.hE(a,{invite_token_query:t,selected_user_token:o,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,yn.zt)(),type:"autofill"}),l.setState({inviteTargets:[...l.state.inviteTargets,o],tokenQuery:""}),d.unsetFocus())}})))}function Ln(e){const{tokenQuery:t,shouldShowAutofillEmail:s,isGuestInviteRequestRequired:n}=e;return n?(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.requestNewUser.buttonItem",defaultMessage:"Request {tokenQuery} as a guest",values:{tokenQuery:t}}):s?(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:t}}):(0,O.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:t}})}const On=function(e){window.__c={n:"ShareMenuSearchRequest"};const t=(0,i.O7)(),s=(0,r.useIntl)(),[a,l]=(0,n.useState)(!0),d=(0,o.VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,o.VK)((()=>{if(e.shouldShowSlackOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=we.Z.completeSlackAuthentications.state.length>0&&fe.Rv();return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly]),[{value:u,status:m}]=(0,rn.r5)((async()=>de.jL({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:s}).finally((()=>l(!1)))),[t,s,e.membersOnly,d,c],{debounce:40});return(0,O.jsx)(Mn,{...e,tokenQuery:d,showShimmer:a,ready:"pending"!==m,error:"rejected"===m,result:u})};function En(e){window.__c={n:"InviteContent"};const t=(0,i.O7)(),s=(0,o.qz)(e.inviteTargetsStore,C.ZP),l=(0,o.VK)((()=>s.state.inviteTargets),[s]),{display:d,source:c,focus:u,emailMessage:m}=(0,o.VK)((()=>{const{display:e}=M.ZP.state;return e===M.wV.Invite?M.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),p=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),g=(0,o.VK)((()=>c===M.T5.Notion&&0===l.length&&(0,fe.Rv)()),[l.length,c]),h=(0,o.VK)((()=>we.Z.completeSlackAuthentications.state),[]),f=(0,n.useCallback)((()=>{s.reset()}),[s]),[y,S]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(p&&!y&&g){for(const e of h)le.loadContacts(t,{botId:e.id,spaceId:p.id,integrationId:oe.nO}).catch((e=>{}));S(!0)}}),[g]);const v=d===M.wV.Invite&&l.length>0,b=(0,a.yK)((e=>({scroller:{flexGrow:1},integrationName:{display:"flex"},integrationIcon:{marginRight:4},importContactsContainer:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},importContactsButton:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9}})),[]);return d!==M.wV.Invite?null:(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(me.Z,{type:je.Z.Y,style:b.scroller,children:(0,O.jsx)(On,{inviteTargetsStore:s,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:c===M.T5.Slack,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})}),g&&(0,O.jsx)(Pe.Z,{onClickAuthenticated:()=>{M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:M.T5.Slack,emailMessage:m}),s.setState({...s.state,tokenQuery:""})},title:function(){const e=(0,O.jsxs)("div",{style:b.integrationName,children:[(0,O.jsx)(D.Z,{type:"image_url",imageURL:k.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:b.integrationIcon}),(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]});return(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:e}})}(),containerStyle:b.importContactsContainer,buttonStyle:b.importContactsButton,from:"share_menu",inviteOrigin:"page_share_modal",flowId:e.flowId,loadContacts:!0}),(0,O.jsx)(Wn,{open:v&&!g,focus:u===M.Sw.Message,value:m,onFocus:()=>{c&&d===M.wV.Invite&&M.ZP.setState({...M.ZP.state,focus:M.Sw.Message,tab:M.XF.Share,display:d,source:c,emailMessage:m})},onChange:e=>{M.ZP.setState({...M.ZP.state,focus:u,tab:M.XF.Share,display:d,source:c,emailMessage:e.target.value})},onCancel:async()=>{await Ie.zd({environment:t,inviteTargetsStore:s})&&(Ie.a6(t),f())},maxLength:1e3})]})}function Nn(e){window.__c={n:"InviteSection"};const{store:t,menuListStore:s,sudoModeStore:l,contextualInviteStore:d}=e,c=(0,i.O7)(),u=(0,r.useIntl)(),m=(0,o.qz)(e.inviteTargetsStore,C.ZP),{display:p,source:g,focus:h,emailMessage:f}=(0,o.VK)((()=>{const{display:e}=M.ZP.state;return e===M.wV.Invite?M.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),y=()=>{m.reset(),M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.MainShareMenu})},[v,b]=(0,n.useState)("editor"),j=(0,o.VK)((()=>t.getType()),[t]),k=(0,o.VK)((()=>d.state.flowId),[d]),I=(0,o.VK)((()=>(0,ye.B)({inviteTargetsStore:m})),[m]),P=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),Z=(0,o.VK)((()=>new Set(null==P?void 0:P.getEmailDomains())),[P]),F=(0,o.VK)((()=>{const e=Te.subscriptionDataStoreInstance.state,t=e?ke.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),_=e=>!xe.$s({contextualInviteUser:e,allowedDomains:Z}),A=(0,o.VK)((()=>t.canEditMembership()),[t]),R=(0,o.VK)((()=>{const e=I.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),t=I.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return Se.dA(c,[...e,...t])}),[c,I]),D=(0,be.Z)(t),B=(0,o.VK)((()=>{if(D.isGuestRequestRequired)return!1;const e=D.isStoreInTeam&&!D.teamAllowsGuests,t=!D.isStoreInTeam&&!D.spaceAllowsGuests||D.isStoreInTeam&&!D.teamAllowsGuests&&!D.spaceAllowsGuests,s=I.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&s}),[I,D]),L=(0,o.VK)((()=>{const e=I.some(ve.OA);return D.isGuestRequestRequired&&e}),[I,D]),E=(0,o.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return(0,fe.gp)({currentSpaceStore:e})}),[]),N=(0,n.useCallback)((e=>{const t=e.type;if("existingUser"===t){const t=F[e.value.id];if(!t)return!0;return"none"===t.role&&!t.isTeamGuest&&t.isPageGuest}return"newUser"===t||"group"!==t&&void 0}),[F]),V=(0,o.VK)((()=>{if(!P)return"control";if(!(0,xe.ch)({environment:c,spaceStore:P,contextualInviteStore:d}))return"control";return I.filter(N).length>0?(0,fe.kG)(c):"control"}),[I,c,N,P,d]),U=(0,Me.S)(t),W=f.length>1e3,K=I.length>0,z=(0,a.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:2,borderRadius:4,color:T.ZP.uiGray}})),[]);async function q(){const e=I.filter(N),s=I.filter((e=>!N(e)));"control"===V?await Ie.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:v,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{y(),(e=>{d.setState({...d.state,invitedUsers:e.filter(N).map(xe.Si).filter(w.$K).filter(_)}),P&&xe.fr({environment:c,spaceStore:P,contextualInviteStore:d})})(I)},onInviteComplete:(e,t)=>Ie.Cv({success:e,requestedUserEmails:t,inviteTargets:I})}):(s.length>0&&(m.setState({...m.state,inviteTargets:s}),await Ie.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:v,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{m.reset()},onInviteComplete:(e,t)=>Ie.Cv({success:e,requestedUserEmails:t,inviteTargets:s})})),((e,t,s,n)=>{d.setState({...d.state,invitedUsers:e.filter(N).map(xe.Si).filter(w.$K).filter(_),inviteTargets:e,shareModalGuestMemberConfirmationExpGroup:t,callbackAsyncFn:s,resetShareMenuFn:n}),P&&(xe.fr({environment:c,spaceStore:P,contextualInviteStore:d}),d.setState({...d.state,selection:S.uq.closed}))})(I,V,(async()=>(m.setState({...m.state,inviteTargets:e}),await Ie.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:v,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{y()},onInviteComplete:(t,s)=>Ie.Cv({success:t,requestedUserEmails:s,inviteTargets:e})}))),(()=>{y()})))}async function G(){void 0===s.state.focus.indexGlobal&&void 0===s.state.focus.indexLocal&&void 0===s.state.focus.section&&(I.length<1||await q())}let H;return H=B||L?U:W?(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,(0,O.jsx)(pe.ZP,{disableTooltip:A,renderTooltip:()=>{if(!A)return(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,O.jsxs)("div",{style:{display:"flex"},...e,children:[(0,O.jsx)(Ze.Z,{store:t,inviteTargetsStore:m,flowId:k,disabled:!A,origin:"page_contextual_invite",focus:h===M.Sw.Search,hideIconColorAndTooltips:"control"!==V,onFocus:()=>{M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:g||M.T5.Notion,emailMessage:f||""}),re.yE(c,{source:g||M.T5.Notion})},onSubmit:G,placeholder:E?u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}):u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder",defaultMessage:"Add people, groups, or emails..."}),right:K&&(0,O.jsx)(ge.ZP,{disabled:!A,role:v,table:"block",type:"user_permission",blockType:j,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:z.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>b(e)})}),R?(0,O.jsx)(Vn,{onClick:()=>de.Vu({environment:c,upgradeButtonName:"user_permission_item"})}):(0,O.jsx)(Un,{tooltip:H,disabled:!A||B||W,onClick:async()=>{p!==M.wV.MainShareMenu?await q():M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:M.T5.Notion,emailMessage:""})}})]})})}function Vn(e){const{onClick:t}=e;return(0,O.jsx)(pe.ZP,{disableTooltip:!1,renderTooltip:()=>(0,O.jsx)(he.e,{}),render:e=>(0,O.jsx)(Y.Z,{isLarge:!0,style:{marginLeft:8},onClick:t,...e,children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}function Un(e){const{tooltip:t,disabled:s,onClick:n}=e;return(0,O.jsx)(pe.ZP,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,O.jsx)(Y.Z,{isLarge:!0,style:{marginLeft:8},disabled:s,onClick:n,...e,children:(0,O.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}function Wn(e){window.__c={n:"EmailMessageInput"};const{open:t,focus:s,value:n,maxLength:i,onFocus:o,onChange:l,onCancel:d}=e,c=(0,r.useIntl)(),u=n.length/i>=.8,m=(0,ae.TQ)(n),p=u||m,g=(0,a.yK)((e=>({container:{maxHeight:t?100:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),h=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,O.jsxs)("div",{style:g.container,children:[p&&(0,O.jsx)(Kn,{value:n,maxLength:i,shouldShowLengthWarning:u,shouldShowLinkWarning:m}),(0,O.jsx)(ce.Z,{textarea:!0,focusInitial:!1,format:ce.B.Transparent,placeholder:h,maxlength:i,focus:s,value:n,onFocus:o,onChange:l,inputStyle:g.input,onCancel:d})]})}function Kn(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:s,value:n,maxLength:i}=e,o=(0,a.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,O.jsx)("div",{style:o.container,children:(0,O.jsxs)("div",{style:o.warning,children:[t&&(0,O.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:n.length,maxCharacters:i}}),t&&s&&" · ",s&&(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const zn=function(e){window.__c={n:"ShareMenuInviteTab"};const{store:t,permissionItemArgs:s,inviteTargetsStore:n,contextualInviteStore:r}=e,l=(0,i.Fy)(),d=(0,o.qz)(void 0,Ce.Z),{display:c}=(0,o.VK)((()=>M.ZP.state),[]),u=(0,o.VK)((()=>r.state.flowId),[r]),m=(0,a.yK)((()=>({container:{position:"relative",height:c!==M.wV.MainShareMenu?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540},searchBar:{paddingLeft:14,paddingRight:14,paddingBottom:8}})),[c]);return(0,O.jsx)(ue.Z,{capture:!0,onTab:function(e){e.preventDefault(),l.isMobile||c!==M.wV.MainShareMenu||M.ZP.setState({...M.ZP.state,tab:M.XF.Share,display:M.wV.Invite,focus:M.Sw.Search,source:M.T5.Notion,emailMessage:""})},children:(0,O.jsxs)("div",{style:m.container,children:[(0,O.jsx)("div",{style:m.searchBar,children:l.isMobile?(0,O.jsx)(Be,{store:t,permissionItemArgs:s}):(0,O.jsx)(Nn,{store:t,inviteTargetsStore:n,menuListStore:d,sudoModeStore:s.sudoModeStore,contextualInviteStore:r})}),c===M.wV.MainShareMenu&&(0,O.jsx)(nn,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:s}),c===M.wV.Invite&&!l.isMobile&&(0,O.jsx)(En,{store:t,inviteTargetsStore:n,menuListStore:d,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs,flowId:u})]})})};var qn=s(62397);const Gn=function(e){window.__c={n:"WorkspaceOwnerPermissionOverride"};const{store:t,sudoModeStore:s}=e,n=(0,o.VK)((()=>s.state.changePermissionsEnabled),[s]),i=(0,o.VK)((()=>s&&s.shouldUserHaveAccessToPrivatePageBlock()&&!s.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&s.state.privatePageStore),[s,t]),l=(0,a.yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.borderBoxShadow,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:A.Z.fontWeight.medium,justifyContent:"center",marginTop:8,opacity:n?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:n?"rotate(-90deg)":void 0}})),[n]);return i?(0,O.jsxs)("div",{style:l.container,children:[(0,O.jsx)(m.Z,{isMultiline:!0,children:(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,O.jsx)("b",{children:t})}}})}),(0,O.jsxs)(ss.Z,{disabled:n,style:l.button,onClick:()=>{s.setState({...s.state,changePermissionsEnabled:!0})},children:[(0,qn.I)(l.icon),n?(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,O.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function Hn(e){window.__c={n:"ShareMenuContent"};const t=(0,o.VK)((()=>M.ZP.state.tab),[]);switch(t){case M.XF.Share:return(0,O.jsx)(zn,{...e});case M.XF.Publish:return(0,O.jsx)(ie,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,w.t1)(t)}}const Qn=function(e){window.__c={n:"ShareMenu"};const{store:t,permissionItemArgs:s}=e,n=(0,i.Fy)(),r=(0,o.qz)(e.inviteTargetsStore,C.ZP),l=(0,a.yK)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]);return(0,O.jsxs)("div",{style:l.container,children:[s.sudoModeStore&&(0,O.jsx)(Gn,{store:t,sudoModeStore:s.sudoModeStore}),!n.isMobile&&(0,O.jsx)(E,{inviteTargetsStore:r,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),(0,O.jsx)(Hn,{inviteTargetsStore:r,...e})]})};function Yn(){window.__c={n:"OfflineMessage"};const e=(0,i.Fy)(),t=(0,a.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",height:160}})),[]);return(0,O.jsx)("div",{style:t.container,children:(0,O.jsx)(m.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})})})}const $n=function(e){window.__c={n:"ShareMenuContainer"};const{store:t,sudoModeStore:s,onUpgradeButtonClick:w,location:C}=e,k=(0,i.Fy)(),T=(0,o.qz)(void 0,v.Z),{contextualInviteStore:I}=(0,o.VK)((()=>T.state),[T]),P=(0,o.VK)((()=>x.default.state.currentSpaceStore),[]),Z=(0,o.VK)((()=>b.mk({spaceStore:P,store:t})),[P,t]),F=(0,o.VK)((()=>I.state.inviteStage),[I]),_=(0,o.VK)((()=>M.ZP.state.tab),[]),A=(0,a.yK)((()=>({title:{fontSize:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto"}})),[]),R=(0,n.useMemo)((()=>({onUpgradeButtonClick:w,sudoModeStore:s,location:C})),[w,s,C]);if(!P)return null;if(!k.isMobile&&(F===S.TG.share_workspace||F===S.TG.request_workspace))return(0,O.jsx)(j.Z,{blockStore:t,spaceStore:P,contextualInviteStore:I});const D=k.isMobile?{menuType:h.og.Modal,disableHeaderShadow:!0,title:(0,O.jsx)(m.Z,{isMobile:k.isMobile,style:A.title,children:(0,O.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,O.jsx)(V,{mostPermissivePublicItem:Z.mostPermissivePublicItem}),left:(0,O.jsx)(p.Z,{href:(0,f.UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:_===M.XF.Share&&(0,O.jsx)(js,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:Z,permissionItemArgs:R}),topbarStyle:A.topbarStyle,right:(0,O.jsx)(u.DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:h.og.Popup,maxHeight:"90vh"};return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(c.Z,{...D,className:g.B8p,children:(0,O.jsx)(l.Z,{capture:!0,allowEsc:!0,children:(0,O.jsx)(d.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,focusOffscreenInput:!1,render:()=>y.Z.state.online?(0,O.jsx)(Qn,{store:t,permissionItemArgs:R,calculatedPermissions:Z,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:I}):(0,O.jsx)(Yn,{})})})})})}},12994:(e,t,s)=>{s.r(t),s.d(t,{default:()=>O});s(67294);var n=s(83355),i=s(42875),o=s(72126),a=s(94044),r=s(9291),l=s(74194),d=s(78140),c=s(89728),u=s(53437),m=s(57806),p=s(4708),g=s(79817),h=s(87279),f=s(45101),x=s(65598),y=s(38755),S=s(95697),v=s(4023),b=s(80444),M=s(85834),j=s(52878),w=s(48608),C=s(480),k=s(86628),T=s(24405),I=s(84169),P=s(25888),Z=s(16354),F=s(64369),_=s(18514),A=s(85893);function R(e){window.__c={n:"LearnAboutSharingLink"};const t=(0,C.O7)(),{device:s,WindowSizeStore:n}=t,i=(0,k.VK)((()=>({left:n.getSafePaddingLeftCSS(8),right:n.getSafePaddingRightCSS(12)})),[n]),o=(0,k.VK)((()=>(0,S.bq)()),[]),a=(0,T.yK)((e=>({button:{display:"flex",alignItems:"center",width:s.isMobile?"100%":void 0,height:s.isMobile?44:24,paddingTop:s.isMobile?12:4,paddingBottom:s.isMobile?12:4,paddingLeft:i.left,paddingRight:i.right},helpIcon:{width:s.isMobile?16:14,height:s.isMobile?16:14,fill:s.isMobile?e.mediumIconColor:e.lightIconColor}})),[s.isMobile,i]);return(0,A.jsx)(Z.Z,{href:(0,_.UY)("guides.sharing"),onClick:()=>P.Fs(t,{from:"sharing"}),style:{width:s.isMobile?"100%":void 0},external:!0,children:(0,A.jsxs)(c.Z,{mobileFeedback:s.isMobile,isSmall:!0,style:{...a.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,A.jsx)("div",{style:{marginLeft:s.isMobile?2:0,marginRight:s.isMobile?8:6},children:(0,I.m)(a.helpIcon)}),(0,A.jsx)(F.Z,{isSmall:!0,isMobile:s.isMobile,isSecondaryColor:!s.isMobile,children:o?(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Learn more",id:"blockPermissionsSettings.learnMore.prompt"}):(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}R.displayName="LearnAboutSharingLink";const D=R;class B extends n.Z{constructor(){super(...arguments),this.storeTypes={universalInviteStore:j.Z},this.renderEmailInput=this.createComputedStore((()=>"milestone_2"===this.props.mode))}renderComponent(){const{universalInviteStore:e}=this.stores,{permissionsInviteStore:t,contextualInviteStore:s}=e.state,n=e.stage,{spaceStore:i}=this.props;if(this.environment.device.isMobile||n===M.TG.closed)return null;if(!(0,x.Mm)(this.props.store)&&(n===M.TG.share_workspace||n===M.TG.request_workspace))return(0,A.jsx)(w.Z,{blockStore:this.props.store,spaceStore:i,contextualInviteStore:s});if(n===M.TG.share_page){const n={...this.props,renderInShareMenu:!0,spaceStore:i,permissionsInviteStore:t,contextualInviteStore:s,onInviteClick:()=>{(0,S.$)(this.environment)?s.setState({...s.state,inviteStage:M.TG.closed}):g.fr({environment:this.environment,spaceStore:i,contextualInviteStore:s})},onInviteComplete:e=>{g.x5({success:e,intl:this.props.intl,contextualInviteStore:s})},onCancel:async()=>{await(0,f.Aw)({environment:this.environment,permissionsInviteStoreState:t.state,from:"share_menu"})||e.reset()}};return this.renderEmailInput.state?(0,A.jsx)(L,{...n}):(0,A.jsx)(m.default,{...n})}}}B.displayName="UniversalMemberInvite";class L extends m.PermissionsInviteBase{constructor(){super(...arguments),this.inviteTargetLength=this.createComputedStore((()=>this.stores.permissionsInviteStore.state.inviteTargets.length)),this.blockTitle=this.createComputedStore((()=>{if((0,x.Mm)(this.props.store))return"";const e=this.props.store;if(!e.isDefined())return"";const t=e.getModel().getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:this.props.intl});return t||e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:this.props.intl})})),this.handleInviteInputSubmit=async()=>{const{permissionsInviteStore:e}=this.stores;"invitee"===e.state.inputFocus?e.setState({...e.state,inputFocus:"email-content"}):await super.handleInviteInputSubmit()},this.resetFocusOnClickEmpty=e=>{const{permissionsInviteStore:t}=this.stores;e.currentTarget===e.target&&t.setState({...t.state,inputFocus:"none"})}}renderComponent(){return this.renderInShareMenu.state?this.renderUniversalInviteInner():super.renderComponent()}renderUniversalInviteInner(){const{permissionsInviteStore:e}=this.stores;return(0,A.jsxs)("div",{style:E(this.environment),onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsx)(u.ZP,{popupType:u.kQ.Popup,alignmentToOrigin:v.v.Start,placementToOrigin:v.u.Bottom,open:"invitee"===e.state.inputFocus,originGap:10,disableMouseCapture:!0,forceRemeasureStore:this.inviteTargetLength,origin:super.renderHeader(),onDismiss:()=>{e.setState({...e.state,inputFocus:"email-content"})},render:()=>{const e=super.renderSearchRequest(),t={menuType:h.og.Popup,disableScroller:!1};return(0,A.jsx)("div",{children:(0,A.jsx)(d.Z,{...t,children:e})})},style:{width:360}}),this.renderEmailMessageInput(),this.renderSinglePlayerOptions(),this.renderActions()]})}renderEmailMessageInput(){const{permissionsInviteStore:e}=this.stores,t=this.getEmailMessage(),{inputFocus:s,emailMessage:n}=e.state,i=n.length/a.vr>=.8,o=(0,a.TQ)(n),r=i||o,d=(0,p._6)(this.environment),c="email-content"===s;return(0,A.jsx)(l.Z,{textarea:!0,value:n,focus:c,focusInitial:!1,maxlength:a.vr,onFocus:()=>{e.setState({...e.state,inputFocus:"email-content"})},style:{background:c?"none":this.theme.inputBackground,alignItems:"flex-start",paddingLeft:12,paddingRight:12,paddingTop:8,paddingBottom:r?34:12},inputStyle:{minHeight:d?80:100},placeholder:t,onChange:t=>{e.setState({...e.state,emailMessage:t.target.value})},right:r&&this.renderMessageWarning({shouldShowLengthWarning:i,shouldShowLinkWarning:o}),isRightLastElementOfInput:!0,onSubmit:async()=>{await super.handleInviteClick()}})}renderSinglePlayerOptions(){if((0,x.Mm)(this.props.store))return null;const{contextualInviteStore:e,permissionsInviteStore:t}=this.stores,{currentSpaceStore:s}=b.default.state;if(!s)return null;if(!(0,S.$)(this.environment))return null;const{inviteTargets:n}=t.state;return!t.state.isInviteTargetsEmpty&&n.some((e=>f.OA(e)))?(0,A.jsx)(w.Z,{blockStore:this.props.store,spaceStore:s,contextualInviteStore:e}):null}renderActions(){return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center",width:"100%"},onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"flex-end",gap:8},children:[this.renderDesktopInputRightInnerButton({isLarge:!1}),(0,A.jsx)(c.Z,{style:{minWidth:a.UF,justifyContent:"center"},isLarge:!1,isLightGray:!0,onClick:()=>{var e,t;null===(e=(t=this.props).onCancel)||void 0===e||e.call(t)},children:(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Cancel",id:"ContextualInvite.permissions_invites.button.cancel"})})]}),(0,A.jsx)(D,{style:{paddingLeft:0,paddingRight:0},disableHover:!0})]})}renderMessageWarning(e){const{permissionsInviteStore:t}=this.stores,{shouldShowLengthWarning:s,shouldShowLinkWarning:n}=e;return(0,A.jsxs)("span",{style:{fontSize:12,color:this.theme.lightTextColor,position:"absolute",bottom:8,left:12},children:[s&&(0,A.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:t.state.emailMessage.length,maxCharacters:a.vr}}),s&&n&&" · ",n&&(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})}getEmailMessage(){const{currentUserStore:e,currentSpaceStore:t}=b.default.state,{permissionsInviteStore:s}=this.stores,{intl:n}=this.props,{inviteTargets:i}=s.state,r=!s.state.isInviteTargetsEmpty&&o.yW(i,f.OA);if(!t)return n.formatMessage(a.VX.default);const l=null==e?void 0:e.getDisplayName(n),d=(0,y.rn)(this.environment,t);if(!l||!d)return n.formatMessage(a.VX.default);return(0,a.jm)({includeOptional:!1,isGuest:r,emailProps:{userName:l,pageName:this.blockTitle.state,spaceName:d},intl:this.props.intl})}}const O=(0,r.injectIntl)(B);function E(e){const{WindowSizeStore:t}=e;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:10,paddingBottom:10,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14),flexDirection:"column",gap:10}}},35700:(e,t,s)=>{s.d(t,{J:()=>c});s(67294);var n=s(24405),i=s(89024),o=s(7124),a=s(63296),r=s(85248),l=s(79872),d=s(85893);function c(e){window.__c={n:"SidebarFooterNotification"};const{title:t,description:s,cta:c,onClick:u,onDismiss:m,progressFilledColor:p,progressPercent:g,isButtonDisabled:h}=e,f=(0,n.yK)((e=>({cardContainer:{padding:14},buttonContainer:{paddingTop:8},button:{width:"100%"},dismissButton:{position:"relative",top:0,right:0,background:"none"},cta:{textDecoration:"underline"},unfilledBar:{color:"dark"===e.mode?e.accentColors.gray[400]:void 0}})),[]),x=void 0!==g;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{style:f.cardContainer,children:[(0,d.jsxs)(i.jX,{direction:"row",gap:"auto",align:"center",children:[(0,d.jsx)(o.q,{styleName:"Body-12px/Medium",colorName:"primary",children:t}),void 0!==m&&(0,d.jsx)(l.U,{onClick:m,style:f.dismissButton})]}),(0,d.jsx)(o.q,{styleName:"Body-12px/Regular",children:(0,d.jsxs)(i.jX,{gap:x?8:0,children:[s,x&&(0,d.jsx)(r.k,{percentage:100*g,height:8,filledColor:p,unfilledColor:f.unfilledBar.color}),(0,d.jsx)("div",{style:f.buttonContainer,children:(0,d.jsx)(a.Z,{onClick:u,disabled:h,disabledFeedback:h,style:f.button,children:(0,d.jsx)(o.q,{styleName:"Body-14px/Regular",colorName:"primary",children:c})})})]})})]})})}},75546:(e,t,s)=>{s.d(t,{o:()=>c});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(82990),r=s(95697),l=s(43488),d=s(85893);function c(e){let{teamStore:t,withSelectedStyle:s}=e;window.__c={n:"TeamHeaderLabel"};const c=(0,n.Fy)(),u=(0,i.VK)((()=>{var e;return{teamName:t.getName()??"",shouldShowLock:(0,r.C2)(null==t||null===(e=t.getSettingsStore())||void 0===e?void 0:e.getValue())}}),[t]),m=(0,o.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},lockIcon:{width:15,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},labelText:{...a.Z.textOverflowStyle,...s?{color:e.regularTextColor,fontWeight:a.Z.fontWeight.semibold}:{color:e.darkTextColor,fontWeight:a.Z.fontWeight.medium},fontSize:c.isMobile?a.Z.fontSize.UIRegular.mobile:a.Z.fontSize.UIRegular.desktop}})),[c.isMobile,s]);return u?(0,d.jsxs)("div",{style:m.container,children:[(0,d.jsx)("div",{style:m.labelText,children:u.teamName}),u.shouldShowLock&&(0,d.jsx)(l.Z,{iconStyle:m.lockIcon})]}):null}},22756:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isModalOpen:!1,currentTab:"selectData",account:void 0,isAccountLinkingInProgress:!1,isAccountDelinkingInProgress:!1,workspaces:[],teamsAndProjects:[],selectedWorkspace:void 0,selectedProjectsAndTeamspaces:{},importCompletedTasks:!0,teams:void 0,loadMoreClicks:0,isLoadingProjects:!1,isLoadingAsanaWorkspaces:!1,result:void 0,isComplete:!1,loggerPageId:void 0,templateCreationInProgress:!1,isFetchingAsanaAccount:!1,choosingWorkspacesCompleted:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const o=new i},62395:(e,t,s)=>{s.d(t,{n:()=>n});const n=s(49085).default.createValue(void 0)},17549:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},85680:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isOpen:!1}}}const o=new i},67950:(e,t,s)=>{s.d(t,{B:()=>i,Z:()=>a});var n=s(49085);const i={INVALID_DATE:"Invalid date",INVALID_RANGE:"Invalid range"};class o extends n.default{getInitialState(){return{edited:!1,temporary:"",error:void 0}}}const a=o},76150:(e,t,s)=>{s.d(t,{Hv:()=>i,ZP:()=>r,pd:()=>o});var n=s(49085);let i=function(e){return e.StartDate="startDate",e.StartTime="startTime",e.EndDate="endDate",e.EndTime="endTime",e}({}),o=function(e){return e.InvalidDate="Invalid date",e.InvalidTime="Invalid time",e.InvalidRange="Invalid range",e}({});class a extends n.default{getInitialState(){return{focus:i.StartDate,inputIsFocused:!1,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}}}}const r=a},13854:(e,t,s)=>{s.d(t,{QJ:()=>o,ZP:()=>l,yO:()=>a});var n=s(49085),i=s(76150);const o={[i.Hv.StartDate]:"starting",[i.Hv.StartTime]:"starting",[i.Hv.EndDate]:"ending",[i.Hv.EndTime]:"ending"},a={starting:i.Hv.StartDate,ending:i.Hv.EndDate};class r extends n.default{getInitialState(){return{isOpen:!1,focus:i.Hv.StartDate,temporaryDateRange:{starting:void 0,ending:void 0},displayMonth:void 0,hovered:void 0,showTime:!1}}getFocus(){return this.state.focus}toggleShowTime(){this.setState({...this.state,showTime:!this.state.showTime})}clearTemporaryDateRange(){this.setState({...this.state,temporaryDateRange:{starting:void 0,ending:void 0}})}}const l=r},52507:(e,t,s)=>{s.d(t,{AS:()=>l,Hs:()=>d,ZP:()=>c});var n=s(49085),i=s(59753),o=s(44312),a=s(97880);class r extends n.default{getInitialState(){return{modalOpen:!1,loading:!1,domainVerification:void 0}}}const l=(0,a.AO)((e=>"invalid"===e.type||"unverified"===e.type?{true:e}:{false:e}));function d(e){const t=i.kk.fromValue(o.Jd,e);return{type:t.verified_at?"verified":"unverified",id:t.id,domain:t.domain,verificationCode:t.verification_code,createdAt:t.created_at,expiresAt:t.expires_at,invalidatedAt:t.getInfo().invalidated_at}}const c=r},45214:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},5188:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},46096:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},78900:(e,t,s)=>{s.d(t,{Z:()=>n});const n=new(s(61766).Z)},49900:(e,t,s)=>{s.d(t,{d:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},69122:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isModalOpen:!1,account:void 0,workspaces:[],isLoadingProjects:!1,mondayFoldersAndBoards:[],selectedProjectsAndTeamspaces:{},templateCreationInProgress:!1,currentTab:"selectData",loggerPageId:void 0,showAuthPopup:!1,email:void 0,APIToken:void 0,result:void 0,isComplete:!1,selectedWorkspace:void 0,isLoadingMondayWorkspaces:!1,isFetchingMondayAccount:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const o=new i},4548:(e,t,s)=>{s.d(t,{Z:()=>n});const n=new(s(45589).Z)},25399:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{open:!1}}}const o=new i},41558:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isOpen:!1,focus:"starting",temporaryDateRange:{starting:void 0,ending:void 0},displayMonth:void 0,hovered:void 0,dateFilterType:"lastEditedTime"}}getFocus(){return this.state.focus}clearTemporaryDateRange(){this.setState({...this.state,temporaryDateRange:{starting:void 0,ending:void 0}})}}const o=i},33052:(e,t,s)=>{s.d(t,{Z:()=>a});var n=s(49085),i=s(29369);class o extends n.default{getInitialState(){return{modalOpen:!1,tokenQuery:"",inviteTargets:[],inviteRole:"member",isInviteTargetsEmpty:!0,table:i.e0,isFocused:!0,flowId:void 0,inputFocus:"invitee",emailMessage:""}}}const a=o},52489:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(49085);class i extends n.default{getInitialState(){return{isModalOpen:!1,collectionContextStore:void 0}}}const o=new i},2924:(e,t,s)=>{s.d(t,{g:()=>y});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(72126),l=s(9291),d=s(86572),c=s(89024),u=s(74194),m=s(7124),p=s(27242),g=s(87131);function h(e,t){if(f(e,t))return t[e].message}function f(e,t){return!!t&&e in t}var x=s(85893);function y(e){window.__c={n:"BillingDetails"};const{title:t}=e,[s,i]=(0,n.useState)(""),[a,r]=(0,n.useState)(""),{validationErrors:l}=(0,o.VK)((()=>p.Z.state.open?p.Z.state:{validationErrors:void 0}),[]),d=f("name",l);return(0,n.useEffect)((()=>{d&&s&&p.Z.clearValidationErrorState("name")}),[s,d]),(0,x.jsx)(g.O,{title:t??null,childGap:8,children:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(c.jX,{gap:2,children:[(0,x.jsx)(b,{name:s,setName:i,hasInvalidInput:d}),(0,x.jsx)(v,{hasInvalidInput:d,validationErrors:l})]}),(0,x.jsx)(S,{businessName:a,setBusinessName:r})]})})}function S(e){window.__c={n:"BusinessNameField"};const{businessName:t,setBusinessName:s}=e,n=M(),o=(0,l.useIntl)(),a=(0,i.O7)();return(0,x.jsx)(u.Z,{placeholder:o.formatMessage({defaultMessage:"Business name (optional)",id:"billingDetails.businessName"}),style:n.input,onChange:e=>{!function(e,t){const s=t.target.value,n=p.Z.state;if(!n.open)return;j({environment:e,addressType:"businessName",addressUpdate:s,modal_id:n.sessionId}),p.Z.update((e=>{if(!e.open)return e;const t=e.temporaryAddress;return t.businessName=s,{...e,temporaryAddress:t}}))}(a,e),s(e.target.value)},value:t})}function v(e){const{hasInvalidInput:t,validationErrors:s}=e;return t?(0,x.jsx)(m.q,{colorName:"uiRedPrimary",styleName:"Body-12px/Regular",children:h("name",s)}):null}function b(e){window.__c={n:"NameField"};const{name:t,setName:s,hasInvalidInput:n}=e,o=(0,l.useIntl)(),a=(0,i.O7)(),r=M();return(0,x.jsx)(u.Z,{placeholder:o.formatMessage({defaultMessage:"Name",id:"billingDetails.name"}),style:n?r.invalidInput:r.input,onChange:e=>{!function(e,t){const s=t.target.value,n=p.Z.state;if(!n.open)return;j({environment:e,addressType:"name",addressUpdate:s,modal_id:n.sessionId}),p.Z.update((e=>{if(!e.open)return e;const t=e.temporaryAddress;return t.name=s,{...e,temporaryAddress:t}}))}(a,e),s(e.target.value)},value:t})}function M(){return(0,a.yK)((e=>({input:{padding:10,background:e.surface.wash,width:"100%",boxShadow:e.inputBoxShadow,transition:"box-shadow 0.3s ease-out"},invalidInput:{padding:10,background:e.surface.wash,width:"100%",boxShadow:e.outlineRedInputBoxShadow,transition:"box-shadow 0.3s ease-out"}})),[])}const j=r.Ds((e=>{let{environment:t,addressType:s,addressUpdate:n,modal_id:i}=e;d.rY(t,{addressType:s,addressUpdate:n,modal_id:i})}),1e3)},23412:(e,t,s)=>{s.d(t,{n:()=>g});var n=s(86664),i=(s(67294),s(480)),o=s(86628),a=s(9291),r=s(86572),l=s(89024),d=s(80444),c=s(27242),u=s(37014),m=s(2924),p=s(85893);function g(){window.__c={n:"PaymentFields"};const e=(0,o.VK)((()=>{const e=c.Z.state;if(e.open)return e.sessionId}),[]),t=(0,i.O7)(),s={defaultValues:{billingDetails:(0,o.VK)((()=>{const e=d.default.state.currentUserStore;return{email:null==e?void 0:e.getEmail(),name:null==e?void 0:e.getName()}}),[])}};return(0,p.jsx)(l.jX,{gap:24,children:(0,p.jsxs)(u.x,{label:(0,p.jsx)(a.FormattedMessage,{id:"checkoutPaymentField.paymentDetails.title",defaultMessage:"Payment details"}),children:[(0,p.jsx)(m.g,{}),(0,p.jsx)(n.PaymentElement,{options:s,onChange:s=>{r.Dc(t,{event:s,modal_id:e}),c.Z.update((e=>{if(!e.open)return e;const{paymentData:t,...s}=e;return s}))}})]})})}},67742:(e,t,s)=>{s.d(t,{Z:()=>M});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(53877),r=s(9291),l=s(82530),d=s(37181),c=s(89024),u=s(38755),m=s(35700),p=s(80444),g=s(44041),h=s(81886),f=s(88893),x=s(35057),y=s(28956),S=s(48905),v=s(85893);function b(e,t,s){if(s){if("warning"===t){if("settings"===e)return{disableWarningNotificationInSettings:!0,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate};if("sidebar"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:!0,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate}}if("limit_reached"===t){if("settings"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:!0,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate};if("sidebar"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:!0,expirationDate:s.expirationDate}}}return{disableWarningNotificationInSettings:"warning"===t&&"settings"===e,disableWarningNotificationInSidebar:"warning"===t&&"sidebar"===e,disableLimitNotificationInSettings:"limit_reached"===t&&"settings"===e,disableLimitNotificationInSidebar:"limit_reached"===t&&"sidebar"===e,expirationDate:(0,a.Xz)({date:Date.now(),daysToAdd:7})}}const M=function(e){window.__c={n:"AddOnLimitUsage"};const t=(0,h.MQ)(e.source),s=(0,i.VK)((()=>y.Z.state),[]),M=(0,n.O7)(),j=(0,o.yK)((()=>({aiTitle:{marginLeft:-2,marginBottom:3,minWidth:100}})),[]),{membersCount:w,spaceName:C,settings:k,currentUserSettingsStore:T}=(0,i.VK)((()=>{var e;return{membersCount:(0,f.qX)(),spaceName:p.default.state.currentSpaceStore&&(0,u.rn)(M,p.default.state.currentSpaceStore),settings:null===(e=p.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.addOnLimitNotifications,currentUserSettingsStore:p.default.state.currentUserSettingsStore}}),[M]),I=(0,i.VK)((()=>s?+s.spaceUsage/s.spaceLimit:0),[s]),{notificationType:P}=(0,i.VK)((()=>({notificationType:I>=h.Tq?"limit_reached":"warning"})),[I]);if(!T)return null;if(!t)return null;let Z;"settings"===e.source&&w>=3&&(null!=k&&k.expirationDate?Date.now()<k.expirationDate&&(Z=!0):(!function(e,t){l.createAndCommit({userAction:"addOnLimitNotifications.ai.initializeSettings",environment:e,perform:e=>{d.d2({transaction:e,userSettingsStore:t,data:{addOnLimitNotifications:{disableWarningNotificationInSettings:!1,disableWarningNotificationInSidebar:!1,disableLimitNotificationInSettings:!1,disableLimitNotificationInSidebar:!1,expirationDate:(0,a.Xz)({date:Date.now(),daysToAdd:7})}}})}})}(M,T),Z=!0));const F="limit_reached"===P?(0,v.jsx)(r.FormattedMessage,{id:"addOnLimitUsage.description.usedAllFreeResponses.admins",defaultMessage:"{spaceName} has used all their free AI responses.",values:{spaceName:C}}):(0,v.jsx)(r.FormattedMessage,{id:"addOnLimitUsage.description.approachingLimit.admins",defaultMessage:"{spaceName} has used {spaceUsage} of the {usageLimit} free responses provided to this workspace.",values:{spaceName:C,spaceUsage:(null==s?void 0:s.spaceUsage)??0,usageLimit:(null==s?void 0:s.spaceLimit)??0}});return(0,v.jsx)(m.J,{title:(0,v.jsxs)(c.jX,{direction:"row",gap:4,align:"center-left",style:j.aiTitle,children:[(0,v.jsx)(S.U,{size:24}),(0,v.jsx)("div",{children:(0,v.jsx)(r.FormattedMessage,{id:"spaceSettings.sidebar.addOnUpgradeLink",defaultMessage:"Notion AI"})})]}),description:F,cta:(0,v.jsx)(r.FormattedMessage,{id:"spaceSettings.sidebar.addOnPurchase.buttonLabel",defaultMessage:"Purchase"}),onClick:()=>function(e,t){g.y(e,{from:"sidebar"===t?"ai_limit_sidebar":"ai_limit_settings",for:(0,x.zt)(),addOnFeature:"ai"})}(M,e.source),onDismiss:Z?void 0:()=>function(e,t,s){var n;const{currentUserSettingsStore:i}=p.default.state;if(!i)return;const o={addOnLimitNotifications:b(t,s,null===(n=i.getSettings())||void 0===n?void 0:n.addOnLimitNotifications)};l.createAndCommit({userAction:"addOnLimitNotifications.ai.markNotificationAsDismissed",environment:e,perform:e=>{d.d2({transaction:e,userSettingsStore:i,data:o})}})}(M,e.source,P),progressFilledColor:"#8C69A6",progressPercent:I})}},38449:(e,t,s)=>{s.d(t,{Z:()=>S});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(84169),r=s(9291),l=s(91376),d=s(89024),c=s(7124),u=s(26388),m=s(35700),p=s(4023),g=s(44041),h=s(70060),f=s(88893),x=s(88280),y=s(85893);const S=function(e){window.__c={n:"BlockLimitUsage"};const{source:t,isButtonDisabled:s}=e,S=(0,n.O7)(),v=(0,o.yK)((e=>({tooltip:{width:"300px"},tooltipIcon:{height:14,width:14,fill:e.icon.secondary}})),[]),{isAdmin:b,isEligibleForGracePeriod:M,blockUsageData:j}=(0,i.VK)((()=>{const e=x.subscriptionDataStoreInstance.state;return{isAdmin:f.GJ(e),isEligibleForGracePeriod:(0,h.du)(),blockUsageData:e?{blockUsage:f.Lz(S,e),percentageUsed:f.zl(S,e),approachingBlockLimit:f.SX(S,e),usageDescription:f.cA(S,e)}:void 0}}),[S]);return j&&0!==j.blockUsage&&j.approachingBlockLimit?(0,y.jsx)(m.J,{title:(0,y.jsxs)(d.jX,{direction:"row",gap:4,align:"center-left",children:[(0,y.jsx)(r.FormattedMessage,{id:"spaceSettings.sidebar.upgradeLink",defaultMessage:"Upgrade to go unlimited"}),(0,y.jsx)(u.ZP,{placement:p.u.Top,style:v.tooltip,render:e=>(0,y.jsx)("div",{...e,children:(0,a.m)(v.tooltipIcon)}),renderTooltip:()=>(0,y.jsx)(r.FormattedMessage,{id:"BlockInfoTooltip.content",defaultMessage:"Every piece of content you create — whether it’s an image, table or text — is a single building block in a Notion page."}),textWrap:!0})]}),description:(0,y.jsx)(c.q,{styleName:"Body-12px/Regular",colorName:!M&&j.percentageUsed>f.Tj?"destructive":void 0,children:j.usageDescription}),cta:b?(0,y.jsx)(r.FormattedMessage,{id:"spaceSettings.sidebar.button.upgrade",defaultMessage:"Upgrade plan"}):(0,y.jsx)(r.FormattedMessage,{id:"spaceSettings.sidebar.button.contactWorkspaceOwner",defaultMessage:"Contact a workspace owner"}),onClick:()=>{b||l.r$(),g.y(S,{from:"sidebar"===t?"block_limit_sidebar":"block_limit_settings",for:"plus"})},progressPercent:M?void 0:j.percentageUsed,isButtonDisabled:s}):null}},37014:(e,t,s)=>{s.d(t,{x:()=>a});s(67294);var n=s(89024),i=s(7124),o=s(85893);function a(e){const{label:t,children:s,gap:a}=e;return(0,o.jsxs)(n.jX,{gap:void 0===a?6:a,children:[(0,o.jsx)(i.q,{as:"label",styleName:"Body-12px/Medium",colorName:"secondary",children:t}),s]})}},72983:(e,t,s)=>{s.d(t,{l:()=>a});s(67294);var n=s(97880),i=s(9291),o=s(85893);function a(e){window.__c={n:"StreetAddress"};const{layout:t,address:s}=e,a=(0,i.useIntl)();if(!s)return null;if("condensed"===t){const e=a.formatList([s.name,s.businessName,s.addressLine1,s.country].filter(Boolean),{type:"conjunction",style:"narrow"});return(0,o.jsx)("div",{children:e})}if("full"===t){const e=a.formatList([s.addressLine1,s.addressLine2].filter(Boolean),{type:"conjunction",style:"narrow"}),t=a.formatList([s.state,s.country,s.zipCode].filter(Boolean),{type:"conjunction",style:"narrow"}),n=[s.name,s.businessName,e,t].filter(Boolean);return(0,o.jsx)("div",{children:n.map(((e,t)=>(0,o.jsx)("div",{children:e},t)))})}(0,n.t1)(t)}},28833:(e,t,s)=>{s.r(t),s.d(t,{default:()=>me,isCancellationStage:()=>ce,isConfirmPurchaseStage:()=>de,isLimitReachedStage:()=>le});var n=s(67294),i=s(13991),o=s(480),a=s(86628),r=s(24405),l=s(41892),d=s(8848),c=s(7057),u=s(64275),m=s(44495),p=s(9182),g=s(896),h=s(47425),f=s(97880),x=s(82990),y=s(9291),S=s(47307),v=s(64964),b=s(42922),M=s(11066),j=s(68785),w=s(92660),C=s(42402),k=s(52533),T=s(18514),I=s(38755),P=s(80444),Z=s(80671),F=s(22616),_=s(34583),A=s(40469),R=s(44041),D=s(81886),B=s(5682),L=s(40670),O=s(70060),E=s(58333),N=s(43163),V=s(88893),U=s(35057),W=s(63423),K=s(33493),z=s(88280),q=s(27533),G=s(85893);function H(e){window.__c={n:"LimitReachedStage"};const{addOnFeature:t,canPurchaseAddOn:s,isSubscribed:n}=e,i=re(),a=(0,o.O7)();return s&&n?(0,G.jsx)(Q,{addOnFeature:t,canPurchaseAddOn:s}):(0,G.jsxs)(G.Fragment,{children:[(0,m.D)(i.icon),(0,G.jsx)($,{addOnFeature:t,canPurchaseAddOn:s}),(0,G.jsx)(J,{addOnFeature:t,canPurchaseAddOn:s}),(0,G.jsx)(b.Z,{isLarge:!0,style:i.button,onClick:async()=>s?n?Z.Cl(void 0):async function(e,t){await R.y(e,{from:"plans_page",for:t,addOnFeature:"ai"}),Z.v5()}(a,"free"):Z.v5(),children:s?(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function Q(e){var t,s;window.__c={n:"ConfirmPurchase"};const{addOnFeature:n,canPurchaseAddOn:i}=e,r=(0,o.O7)(),d=re(),c=(0,a.VK)((()=>(0,U.zt)()),[]),u=(0,a.VK)((()=>z.subscriptionDataStoreInstance.state),[]),m=(0,a.VK)((()=>W.Z.state.open?W.Z.state.coupon:null),[]),p=(0,a.VK)((()=>P.default.state.currentSpaceStore),[]);if(!p)return null;const g=(0,k.S$)({environment:r})&&(0,h.QR)(c);if(r.device.isMobileNative&&!g)return null;let x;if(!u||"unsubscribed_admin"!==u.type&&"subscribed_admin"!==u.type||(x=u),x&&"revenueCat"===(null===(t=x.customerData)||void 0===t?void 0:t.activeSubscriptionPlatform)){const e=(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return S.showErrorMessage(e),null}const v=(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,V.GJ)(u))return S.showErrorMessage(v),null;const b=null===(s=x)||void 0===s||null===(s=s.customerData)||void 0===s?void 0:s.stripe;if(!b)return null;const M=b.isSubscribed?b.interval:"month",j=m?function(e){switch(e){case"ai_fifty_percent":return(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});default:(0,f.t1)(e)}}(m):"year"===M?(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("img",{src:l.Z.images.pricing.aiLogoPng,style:d.aiLogo}),(0,G.jsx)($,{addOnFeature:n,canPurchaseAddOn:i}),(0,G.jsx)(X,{addOnFeature:n}),j?Y(j):null,(0,G.jsx)(ee,{addOnFeature:n,interval:M,stripeData:b,spaceStore:p})]})}function Y(e){window.__c={n:"DiscountBadge"};const t=re();return(0,G.jsx)(M.Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,G.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function $(e){window.__c={n:"Title"};const{addOnFeature:t,canPurchaseAddOn:s}=e,n=re();let i;switch(t){case"ai":i=s?(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.title.admin",defaultMessage:"Get more Notion AI"}):(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"});break;default:(0,f.t1)(t)}return(0,G.jsx)("h3",{style:n.title,children:i})}function J(e){window.__c={n:"Description"};const{addOnFeature:t,canPurchaseAddOn:s}=e;let n;const i=re();switch(t){case"ai":n=s?(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;default:(0,f.t1)(t)}return(0,G.jsx)("p",{style:i.paragraph,children:(0,G.jsx)("div",{style:i.text,children:n})})}function X(e){window.__c={n:"ConfirmationDescription"};const{addOnFeature:t}=e;let s;const n=(0,o.O7)(),i=re(),r=(0,a.VK)((()=>P.default.state.currentSpaceStore),[]);if(!r)return null;const l=(0,a.VK)((()=>(0,I.rn)(n,r)),[n,r]);switch(t){case"ai":s=(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.description.admins",defaultMessage:"Go unlimited with Notion AI for all members in {spaceName}.",values:{spaceName:l}});break;default:(0,f.t1)(t)}return(0,G.jsx)("p",{style:i.paragraph,children:(0,G.jsx)("div",{style:i.text,children:s})})}function ee(e){window.__c={n:"ConfirmationBillingSummary"};const{addOnFeature:t,interval:s,stripeData:i,spaceStore:r}=e,l=re(),d=(0,o.O7)(),c=(0,a.VK)((()=>(0,V.qX)()),[]),u=i.currencyCode??"USD",{tax:m,coupon:g}=(0,a.VK)((()=>({tax:W.Z.state.open?W.Z.state.tax:0,coupon:W.Z.state.open?W.Z.state.coupon:void 0})),[]),h=(0,a.VK)((()=>K.Z.getPrice(d,(e=>e.product===t&&e.billingInterval===s&&e.currencyCode===u))),[t,d,s,u]),f=(0,a.VK)((()=>K.Z.getPrice(d,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===u))),[t,u,d]);if((0,n.useEffect)((()=>{!async function(){if(h.result&&i&&i.address){const e=h.result.getCostPerBillingInterval({quantity:c,coupon:g}).amount;await A.nf({environment:d,priceForTaxCalculation:e,address:i.address,customerId:i.customerId,vatId:i.vatId})}}()}),[d,i,h,c,g]),!h.isLoaded||!f.isLoaded)return(0,G.jsx)(j.Z,{});if(!h.result||!f.result)return null;const x=h.result,S=x.getCostPerBillingInterval({quantity:c,coupon:g}).withAddedAmount(m),M=f.result,w=M.getMonthlyUnitCost();let k=M.getMonthlyCost({quantity:c});"year"===s&&(k=k.withMultipliedAmount(12));const{addOnCostItem:I,addOnCostItemWithMembers:P}=(0,D.OL)(t,c,s,(0,G.jsx)(q.W,{cost:w.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("p",{style:l.monthlyCostText,children:[(0,G.jsx)("h3",{style:l.title,children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,G.jsxs)("div",{style:l.costSectionTitle,children:[(0,G.jsx)("div",{children:I}),(0,G.jsx)("div",{style:l.rightAlign,children:(0,G.jsx)(q.W,{cost:k.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,G.jsx)("div",{style:l.costSection,children:P}),(0,G.jsx)(te,{cost:x.getCostPerBillingInterval({quantity:c}),fullCost:k}),(0,G.jsx)(se,{price:x,coupon:g,quantity:c}),(0,G.jsxs)("div",{style:l.costSection,children:[(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,G.jsx)("div",{style:l.rightAlign,children:(0,G.jsx)(q.W,{cost:{amount:m,currencyCode:u},trailingZeroDisplay:"auto"})})]}),(0,G.jsxs)("div",{style:l.totalCostSection,children:[(0,G.jsx)("h3",{style:l.title,children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,G.jsx)("div",{style:l.rightAlign,children:(0,G.jsx)("h3",{style:l.title,children:(0,G.jsx)(q.W,{cost:S.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,G.jsx)("div",{style:l.perMonth,children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:s}})})]}),(0,G.jsx)(b.Z,{isLarge:!0,style:l.button,onClick:async()=>{const e=r.id,s=await F.aQ({environment:d,spaceId:e}),n=(0,B.P)(s,i),o=(0,p.Lg)(n),a=(0,E.B)(o,x);await _.Mg({environment:d,spaceStore:r,from:"add_on_upgrade_modal",desiredState:a,inAppOffer:g}),Z.v5();const l=L.aQ({addOnFeature:t});l&&v.oV(l)},children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,G.jsx)("p",{style:l.termsOfService,children:(0,G.jsx)("div",{style:l.text,children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,G.jsx)("br",{}),fairUsePolicies:e=>(0,G.jsx)(C.Z,{href:(0,T.UY)("ai.fairUsePolicies"),children:e}),terms:e=>(0,G.jsx)(C.Z,{href:(0,T.UY)("ai.terms"),children:e})}})})})]})}function te(e){window.__c={n:"AnnualDiscount"};const t=re(),{cost:s,fullCost:n}=e;if(s.amount===n.amount)return null;const i=n.minus(s),o=Math.floor(i.amount/n.amount*100);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:t.costSectionTitle,children:[(0,G.jsx)("div",{children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,G.jsx)("b",{children:e}),discountPercent:o}})}),(0,G.jsx)("div",{style:t.greenRightAlign,children:(0,G.jsx)(q.W,{cost:i.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,G.jsx)("div",{style:t.costSection,children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function se(e){window.__c={n:"CouponDiscount"};const t=re(),{price:s,coupon:n,quantity:i}=e;if(!(0,g.pp)(n))return null;const o=s.getDiscountPerBillingInterval({quantity:i,coupon:n}).withMultipliedAmount(-1);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:t.costSectionTitle,children:[(0,G.jsx)("div",{children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,G.jsx)("b",{children:e}),percentage:(0,N.o)(n)}})}),(0,G.jsx)("div",{style:t.greenRightAlign,children:(0,G.jsx)(q.W,{cost:o,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,G.jsx)("div",{style:t.costSection,children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function ne(e){window.__c={n:"CancellationStageCTA"};const{data:t,addOnFeature:s}=e,n=re(),i=(0,o.O7)();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:n.buttonWithTopPadding,children:(0,G.jsx)(M.Z,{style:n.redButton,hoveredStyle:{background:d.ZP.redWithAlpha(.8)},onClick:async()=>{const e=(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}),n=P.default.state.currentSpaceStore;if(!n)return S.showErrorMessage(e);const o=n.id,a=await F.aQ({environment:i,spaceId:o}),r=(0,B.P)(a,t),l=(0,p.Lg)(r),d=(0,E.t4)(l,s);await _.Mg({environment:i,spaceStore:n,from:"add_on_upgrade_modal",desiredState:d}),Z.v5()},children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,G.jsx)("div",{style:n.buttonWithTopPadding,children:(0,G.jsx)(M.Z,{style:n.noButton,onClick:()=>Z.v5(),children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]})}function ie(e){window.__c={n:"CancellationStageDescription"};const{data:t}=e,s=re();let n,o=!1;const r=(0,a.VK)((()=>(0,O.bU)()),[]);if("subscribed_admin"===t.type||"unsubscribed_admin"===t.type){var l;const e=null===(l=t.customerData)||void 0===l?void 0:l.stripe;n=null==e?void 0:e.periodEnd,o=Boolean((null==e?void 0:e.schedule)||(null==e?void 0:e.willCancelAt))}return n?(0,G.jsx)("p",{style:s.paragraph,children:(0,G.jsx)("div",{style:s.text,children:o&&!r?(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellationWithPendingChanges.description",defaultMessage:"You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. This change will cancel your previous pending changes. You can resubscribe anytime.",values:{periodEnd:(0,c.Yx)(n,"long",i.SP),bold:e=>(0,G.jsx)("b",{children:e})}}):(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,c.Yx)(n,"long",i.SP),bold:e=>(0,G.jsx)("b",{children:e})}})})}):null}function oe(e){window.__c={n:"CancellationStage"};const{addOnFeature:t,canPurchaseAddOn:s,data:n}=e,i=re();if(!s)return null;let o;switch(t){case"ai":o=(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.title",defaultMessage:"Remove AI at the end of your billing period?"});break;default:(0,f.t1)(t)}return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("h3",{style:i.cancellationTitle,children:o}),(0,G.jsx)(ie,{data:n}),(0,G.jsx)(ne,{data:n,addOnFeature:t})]})}function ae(){window.__c={n:"MobileMessage"};const e=re(),t=(0,o.O7)();let s=(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(s=(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"You are out of free AI."})),(0,G.jsxs)(G.Fragment,{children:[(0,m.D)(e.icon),(0,G.jsx)("h3",{style:e.title,children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"})}),(0,G.jsx)("p",{style:e.paragraph,children:(0,G.jsx)("div",{style:e.text,children:s})}),(0,G.jsx)(b.Z,{isLarge:!0,style:e.button,onClick:()=>Z.v5(),children:(0,G.jsx)(y.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function re(){return(0,r.yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:d.ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:4,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:x.Z.fontWeight.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:4},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:4,color:e.regularTextColor,background:e.accentColors.gray[50],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function le(){return ue("limit_reached")}function de(){return ue("confirm_purchase")}function ce(){return ue("cancel_plan")}function ue(e){const t=W.Z.state;if(t.open)return t.stage===e}const me=function(e){window.__c={n:"AddOnUpgradeModal"};const{data:t}=e,s="ai",n=(0,V.GJ)(t),i=re(),a=V.YK(t);return(0,o.O7)().device.isMobile?(0,G.jsx)(w.Z,{innerStyle:i.innerStyle,requireOnline:!0,modalStore:W.Z,onDismiss:()=>Z.v5(),render:()=>(0,G.jsx)("div",{style:i.mobileModal,children:(0,G.jsx)("div",{style:i.innerModalPadding,children:(0,G.jsx)(ae,{})})})}):(0,G.jsx)(w.Z,{innerStyle:i.innerStyle,requireOnline:!0,modalStore:W.Z,onDismiss:()=>Z.v5(),render:()=>(0,G.jsx)("div",{style:de()||le()&&a&&n?i.largeModal:ce()?i.cancellationModal:i.modal,children:(0,G.jsxs)("div",{style:ce()?i.cancellationInnerModalPadding:i.innerModalPadding,children:[(0,G.jsx)(M.Z,{onClick:()=>{Z.v5()},style:i.cancelButton,hoveredStyle:i.hovered,children:(0,u.D)(i.closeIcon)}),le()&&(0,G.jsx)(H,{addOnFeature:s,canPurchaseAddOn:n,isSubscribed:a}),de()&&(0,G.jsx)(Q,{addOnFeature:s,canPurchaseAddOn:n}),ce()&&(0,G.jsx)(oe,{addOnFeature:s,canPurchaseAddOn:n,data:t})]})})})}},87131:(e,t,s)=>{s.d(t,{O:()=>a});s(67294);var n=s(89024),i=s(7124),o=s(85893);function a(e){let{title:t,children:s,titleGap:a,childGap:r}=e;return(0,o.jsxs)(n.jX,{gap:a||8,children:[(0,o.jsx)(i.q,{styleName:"Caption-12px/Semibold",colorName:"secondary",children:t}),(0,o.jsx)(n.jX,{gap:r||4,children:s})]})}},81886:(e,t,s)=>{s.d(t,{MQ:()=>x,OL:()=>f,Tq:()=>g});var n=s(67294),i=s(480),o=s(86628),a=s(97880),r=s(9291),l=s(54642),d=s(38755),c=s(80444),u=s(88280),m=s(88893),p=s(85893);const g=1;async function h(e,t,s,n){const i=u.subscriptionDataStoreInstance.state;if(!i)return!1;const o=m.SX(e,i),a=c.default.state.currentSpaceStore;if(!(a&&(0,d.rn)(e,a))||!(0,m.GJ)(i))return!1;if(!n)return!1;const r=await l.getAIUsageEligibility(e,{spaceId:n});if("failed"===r.type)return!1;const p=r.data,h=p?+p.spaceUsage/p.spaceLimit:0;return(!1!==(null==p?void 0:p.isEligible)||!p.isSalesAssisted)&&(!o&&function(e,t,s){const n=e>=g?"limit_reached":"warning";if("warning"===n){if("settings"===t&&null!=s&&s.disableWarningNotificationInSettings||"sidebar"===t&&null!=s&&s.disableWarningNotificationInSidebar)return!1}else if("limit_reached"===n&&("settings"===t&&null!=s&&s.disableLimitNotificationInSettings||"sidebar"===t&&null!=s&&s.disableLimitNotificationInSidebar))return!1;return e>=.7}(h,t,s))}function f(e,t,s,n){switch(e){case"ai":return{addOnCostItem:(0,p.jsx)("div",{children:(0,p.jsx)(r.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI",defaultMessage:"<bold>Notion AI</bold>",values:{bold:e=>(0,p.jsx)("b",{children:e})}})}),addOnCostItemWithMembers:(0,p.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:(0,p.jsx)(r.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI.memberInfo",defaultMessage:"({memberCount, plural, one {{memberCount} member} other {{memberCount} members}} x {price} per month{interval, select, month {} other { x 12 months}})",values:{memberCount:t,interval:s,price:n}})})};default:(0,a.t1)(e)}}function x(e){const t=(0,i.O7)(),s=(0,o.VK)((()=>{var e;return null===(e=c.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.addOnLimitNotifications}),[]),a=(0,o.VK)((()=>{var e;return null===(e=c.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),[r,l]=(0,n.useState)();return(0,n.useEffect)((()=>{!async function(){const n=await h(t,e,s,a);l(n)}()}),[t,e,s,a]),r}},43163:(e,t,s)=>{s.d(t,{o:()=>a});s(67294);var n=s(97880),i=s(9291),o=s(85893);function a(e){switch(e){case"ai_fifty_percent":return(0,o.jsx)(i.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscounts.fiftyPercent",defaultMessage:"50%"});default:(0,n.t1)(e)}}},95014:(e,t,s)=>{s.r(t),s.d(t,{getStripe:()=>x,injectStripe:()=>f,translateStripeError:()=>v,useElementsOptions:()=>S});var n=s(86664),i=s(97894),o=s(67294),a=s(86628),r=s(24405),l=s(24211),d=(s(2438),s(97880)),c=s(82990),u=s(86572),m=s(95477),p=s(80444),g=(s(70060),s(85893));let h=null;function f(e){return t=>{const[s]=o.useState(x);return(0,g.jsx)(n.Elements,{stripe:s,children:(0,g.jsx)(n.ElementsConsumer,{children:s=>{let{stripe:n,elements:i}=s;const o={...t,stripe:n,elements:i};return(0,g.jsx)(e,{...o})}})})}}async function x(){return h||(i.loadStripe.setLoadParameters({advancedFraudSignals:!1}),h=(0,i.loadStripe)(m.default.stripe.key)),h}function y(e){switch(e){case"en-US":return"en";case"ko-KR":return"ko";case"ja-JP":return"ja";case"fr-FR":return"fr-FR";case"de-DE":return"de";case"es-ES":return"es-ES";case"es-LA":return"es-419";case"pt-BR":return"pt-BR";case"zh-CN":return"zh";case"zh-TW":return"zh-TW";case"da-DK":return"da";case"nl-NL":return"nl";case"fi-FI":return"fi";case"nb-NO":return"nb";case"sv-SE":return"sv";default:return"auto"}}function S(e){const t=(0,r.Fg)(),{type:s}=e,n="setup"===s||"subscription"===s?e.currency:void 0,i="subscription"===s?e.amount:void 0,u=(0,a.VK)((()=>{var e;return(null===(e=p.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||l.al}),[]),m=(0,a.VK)((()=>({})),[n]);return(0,o.useMemo)((()=>{const e={appearance:function(e){return{labels:"floating",theme:"dark"===e.mode?"night":"stripe",variables:{spacingGridRow:"8px",spacingGridColumn:"8px",spacingUnit:"4px",spacingTab:"4px",colorPrimary:e.text.primary,colorPrimaryText:e.text.primary,colorText:e.text.primary,colorTextSecondary:e.text.secondary,colorTextPlaceholder:e.text.tertiary,colorIcon:e.text.primary,colorIconCheckmark:e.icon.contrast,colorDanger:e.text.uiRedPrimary,colorBackground:e.whiteButtonBackground,colorIconTabHover:e.text.primary,colorIconTabSelected:e.text.uiBluePrimary,colorIconChevronDown:e.text.primary,fontFamily:c.Z.baseFontFamily.sans,fontWeightLight:`${c.Z.fontWeight.light}`,fontWeightNormal:`${c.Z.fontWeight.regular}`,fontWeightMedium:`${c.Z.fontWeight.medium}`,fontWeightBold:`${c.Z.fontWeight.semibold}`,fontSizeBase:"14px",fontSizeSm:"12px",colorLogo:e.mode,colorLogoBlock:e.mode,colorLogoTab:e.mode,colorLogoTabSelected:e.mode,borderRadius:"4px"},rules:{".Tab":{padding:"10px 16px 10px 10px",fontSize:"13px",fontWeight:"510",lineHeight:"16px",color:e.text.primary,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",backgroundColor:e.whiteButtonBackground},".Tab:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary},".Tab:focus":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:e.outlineBlueInputBoxShadow},".Tab--selected, .Tab--selected:hover, .Tab--selected:active":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.uiBlue}`,color:e.text.primary,boxShadow:"none",outline:"none"},".Tab--selected:focus":{border:`1px solid ${e.stroke.uiBlue}`,boxShadow:e.outlineBlueInputBoxShadow},".Input":{fontSize:"14px",lineHeight:"18px",letterSpacing:"-0.154px",padding:"4px 8px",boxShadow:"none",backgroundColor:e.surface.wash,border:`1px solid ${e.stroke.regular}`,cursor:"text",color:e.text.primary},".Input--invalid":{border:"none",color:e.text.primary,boxShadow:e.outlineRedInputBoxShadow},".Label":{fontSize:"14px",lineHeight:"18px",letterSpacing:"-0.154px",color:e.text.tertiary},".Label--floating":{fontSize:"10px",fontWeight:"590",lineHeight:"13px",letterSpacing:"0.12px",marginTop:"4px",transition:"all 200ms ease",color:e.text.secondary},".Error":{fontSize:"12px",fontWeight:"400",lineHeight:"15px",color:e.text.uiRedPrimary},".CodeInput":{backgroundColor:e.surface.wash,border:`1px solid ${e.stroke.regular}`,boxShadow:"none"},".PickerItem, .PickerItem--selected":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",color:e.text.primary},".PickerItem:hover, .PickerItem--selected:hover":{backgroundColor:e.whiteButtonHoveredBackground,color:e.text.primary,border:`1px solid ${e.stroke.regular}`,boxShadow:"none"},".PickerItem--new":{fontSize:"14px",fontWeight:"500",lineHeight:"18px",color:e.text.primary},".PickerItem--highlight, .PickerItem--highlight:hover":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.uiBlue}`,boxShadow:"none"},".PickerItem--highlight:hover":{backgroundColor:e.whiteButtonHoveredBackground},".TermsText":{color:e.text.secondary,fontSize:"12px",fontWeight:"400",lineHeight:"15px"},".CheckboxLabel":{color:e.text.primary,fontSize:"12px",fontWeight:"500",lineHeight:"15px"},".Action, .MenuAction":{color:e.text.primary,fontWeight:"400"},".Action:hover, .MenuAction:hover":{backgroundColor:e.buttonHoveredBackground},".BlockAction:focus, .CodeInput:focus, .Input:focus,.CheckboxInput:focus, .PickerItem:focus, .PickerAction:focus,.MenuAction:focus, .Action:focus, .SecondaryLink:focus":{boxShadow:e.outlineBlueInputBoxShadow},".MenuIcon, .MenuIcon:hover":{fill:e.text.primary},".Block":{backgroundColor:e.whiteButtonBackground,border:`1px solid ${e.stroke.regular}`,boxShadow:"none",color:e.text.primary}}}}(t),locale:y(u)};switch(s){case"address":return e;case"setup":return{...e,...m,currency:null==n?void 0:n.toLowerCase(),mode:"setup",paymentMethodCreation:"manual"};case"subscription":return{...e,...m,amount:i,currency:null==n?void 0:n.toLowerCase(),mode:"subscription",paymentMethodCreation:"manual",setupFutureUsage:"off_session"};default:(0,d.t1)(s)}}),[t,u,s,n,i,m])}function v(e,t,s){if(!s.code)return s.message||"";switch(u._q(e,{error:s.code,stripe_decline_code:s.decline_code}),s.code){case"invalid_expiry_year_past":return t.formatMessage({id:"stripeHelpers.invalidExpiryYear.error.message",defaultMessage:"Your card's expiration year is in the past."});case"invalid_cvc":return t.formatMessage({id:"stripeHelpers.invalidCVC.error.message",defaultMessage:"Your card's security code is invalid."});case"invalid_number":return t.formatMessage({id:"stripeHelpers.invalidNumber.error.message",defaultMessage:"Your card number is not a valid credit card number."});case"card_declined":return function(e,t){switch(t){case"expired_card":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.expiredCard",defaultMessage:"Your card was declined because it is an expired card."});case"incorrect_number":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.incorrectNumber",defaultMessage:"Your card was declined because you input an incorrect number."});case"insufficient_funds":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.declinedFunds",defaultMessage:"Your card was declined because of insufficient funds."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidCvc",defaultMessage:"Your card was declined because you input an invalid CVC number"});case"invalid_amount":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidAmount",defaultMessage:"Your card was declined because payment amount exceeds the amount that's allowed."});default:return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message",defaultMessage:"Your card was declined."})}}(t,s.decline_code);default:return s.message||""}}},76088:(e,t,s)=>{s.d(t,{P:()=>a});var n=s(67294),i=s(480),o=s(54642);function a(){const e=(0,i.O7)(),[t,s]=(0,n.useState)();return(0,n.useEffect)((()=>{!async function(){const t=await o.getExternalOrgData(e,{});if("failed"===t.type)return!1;const n=t.data;s("company_employee_count"in n&&parseInt(n.company_employee_count)>99)}()}),[e]),t}},56896:(e,t,s)=>{s.d(t,{F:()=>i});var n=s(86628);function i(e){const{asyncPrice:t}=e;return(0,n.VK)((()=>{if(t&&t.isLoaded)return t.result?t.result.getMonthlyUnitCost().toMoneyValue():void 0}),[t])}},15418:(e,t,s)=>{s.r(t),s.d(t,{CreateTeamFromPageConfirmModal:()=>f});s(67294);var n=s(480),i=s(24405),o=s(62208),a=s(82990),r=s(9291),l=s(42922),d=s(63296),c=s(92660),u=s(29551),m=s(73466),p=s(66214),g=s(80068),h=s(85893);function f(){window.__c={n:"CreateTeamFromPageConfirmModal"};const e=(0,n.O7)(),t=(0,r.useIntl)(),s=(0,i.yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:a.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]);return(0,h.jsx)(c.Z,{onDismiss:()=>{p.Z.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:s.modal,children:(0,h.jsxs)(u.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,o.z)(s.loopIcon),(0,h.jsx)("div",{style:s.title,children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:s.description,children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(l.Z,{isLarge:!0,style:s.confirmButton,onClick:()=>{if(p.Z.state.open){const{pageStore:s,flowId:n}=p.Z.state;m.Sq({environment:e,intl:t,page:s,flowId:n}),p.Z.setState({open:!1})}},children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(d.Z,{isLarge:!0,style:s.cancelButton,onClick:()=>p.Z.setState({open:!1}),children:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(g.Z,{message:(0,h.jsx)(r.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),requireOnline:!0,modalStore:p.Z})}},14982:(e,t,s)=>{s.r(t),s.d(t,{SidebarCreateTeamModal:()=>te});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(41892),l=s(64275),d=s(49364),c=s(72126),u=s(97880),m=s(82990),p=s(9291),g=s(50906),h=s(64921),f=s(74194),x=s(3386),y=s(68785),S=s(50506),v=s(64369),b=s(45653),M=s(13490),j=s(33929),w=s(38755),C=s(95697),k=s(68418),T=s(80444),I=s(26136),P=s(33052),Z=s(9867),F=s(42922),_=s(78122),A=s(35057),R=s(73466),D=s(80068),B=s(85893);function L(){window.__c={n:"SidebarCreateTeamModalFooter"};const e=(0,i.O7)(),{currentSpaceStore:t,spaceViewStore:s}=(0,o.VK)((()=>({currentSpaceStore:T.default.state.currentSpaceStore,spaceViewStore:T.default.state.currentSpaceViewStore})),[]),r=(0,o.VK)((()=>k.Z.state),[]),l=(0,C.OX)(),d=function(){const e=(0,o.VK)((()=>A.Mk()&&!k.Z.state.isDefault),[]),t=k.F.Team,s=k.F.Members;return e?[t,s]:[t]}(),{screen:m,pageNumber:g,teamId:h}=r,f=""===r.name,x=(0,a.yK)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:22},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"},learnMoreLink:{overflow:"hidden"}})),[]),y=(0,n.useCallback)(((s,n)=>{t&&function(e){let{pageOrder:t,pageNumber:s,teamId:n,currentSpaceStore:i,environment:o,from:a}=e;const r=s+1;if(r<=t.length)k.Z.update((e=>({...e,loading:!1,screen:t[r-1],pageNumber:r})));else if(n){const e=I.zX.createChildStore(i,{table:"team",id:n,spaceId:i.id});Z.hI({environment:o,teamStore:e,shouldScroll:!0}),Z.ED({environment:o,from:a,teamStore:e})}}({pageOrder:d,pageNumber:g,teamId:n||h,currentSpaceStore:t,environment:e,from:s})}),[t,e,g,d,h]),S=c.Ds((async()=>{if(!t||!s)return;let n=h;switch(m){case k.F.Team:n=await async function(e){var t;let{spaceStore:s,environment:n,shouldShowZeroTeamsExperience:i,sidebarCreateTeamModalStoreState:o}=e;const{name:a,description:r,icon:l,flowId:d,accessLevel:c,isDefault:u}=o;if(!(await(0,_.Xg)({environment:n,spaceStore:s,teamName:a})))return;let m;k.Z.update((e=>({...e,loading:!0}))),m=i?await R.HD({environment:n,name:a,description:r,icon:l,flowId:d,trackCreateTeamComplete:!0}):await R.Cm({environment:n,name:a,description:r,icon:l,accessLevel:c,isDefault:u,flowId:d,createTeamHome:!0});if(!m)return;const p=null===(t=m)||void 0===t?void 0:t.id;return k.Z.update((e=>({...e,teamId:p}))),p}({spaceStore:t,environment:e,shouldShowZeroTeamsExperience:l,sidebarCreateTeamModalStoreState:r});break;case k.F.Members:break;default:(0,u.t1)(m)}n?y("success",n):k.Z.update((e=>({...e,loading:!1})))}),1e3,{leading:!0,trailing:!1}),v=(0,n.useCallback)(S,[S]);return(0,B.jsxs)("div",{style:x.box,children:[(0,B.jsx)(D.Z,{containerStyle:x.learnMoreLink,helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),(0,B.jsx)("div",{style:{display:"inline-flex"},children:(0,B.jsx)(F.Z,{isLarge:!0,onClick:v,disabled:f,style:x.button,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"})})})]})}var O=s(60701),E=s(38078),N=s(74016);const V={userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:"22px 26px"},U={createTeamContainer:{...V,width:480},addMembersContainer:{...V,width:500},full:{width:"100%"}},W=(0,p.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function K(){window.__c={n:"TeamDescriptionRow"};const[e,t]=(0,o.AF)(k.Z);return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description"})}),(0,B.jsx)(f.Z,{value:e.description,placeholder:j.default.formatMessage(W.teamDescriptionPlaceholder),textarea:!0,onChange:s=>{t({...e,description:s.target.value})}})]})}function z(e){return(0,B.jsx)("div",{id:e.titleAriaId,style:{fontSize:18,fontWeight:m.Z.fontWeight.semibold},children:(()=>{switch(e.screen){case k.F.Team:return(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace"});case k.F.Members:return(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"});default:(0,u.t1)(e.screen)}})()})}function q(e){window.__c={n:"ModalContent"};const t=(0,i.O7)(),[s]=(0,o.AF)(k.Z),a=(0,n.useCallback)(((e,s)=>{Z.ED({environment:t,from:s,teamStore:e})}),[t]),{screen:r}=s;switch(r){case k.F.Team:return(0,B.jsx)(Q,{titleAriaId:e.titleAriaId,descriptionAriaId:e.descriptionAriaId});case k.F.Members:const t=s.teamId;return t?(0,B.jsx)(J,{teamId:t,onCompleted:e=>{a(e,"success")},onCanceled:e=>{a(e,"dismiss_button")}}):null;default:(0,u.t1)(r)}}function G(){window.__c={n:"TeamIconAndNameRow"};const[e,t]=(0,o.AF)(k.Z),s=(0,o.VK)((()=>T.default.state.currentSpaceStore),[]),n=(0,a.yK)((e=>({container:{display:"inline-flex",width:"100%",verticalAlign:"middle"},icon:{marginRight:8,marginTop:1}})),[]);if(!s)return null;const i=e.icon?{icon:e.icon,pointer:{table:"space",id:s.id}}:void 0;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Icon & name"})}),(0,B.jsxs)("div",{style:n.container,children:[(0,B.jsx)(N.p,{icon:i,size:26,style:n.icon,onChange:s=>{t({...e,icon:s})},iconLoggingData:{recordTable:"team",source:"team_creation"}}),(0,B.jsx)(f.Z,{value:e.name,placeholder:j.default.formatMessage(W.teamNamePlaceholder),onChange:s=>{t({...e,name:s.target.value})},preventSafariAutofill:!0})]})]})}function H(e){window.__c={n:"Description"};const t=(0,a.yK)((()=>({})),[]);return(0,B.jsx)(v.Z,{id:e.descriptionAriaId,isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:t.description,children:(()=>{switch(e.screen){case k.F.Team:return(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case k.F.Members:return null;default:(0,u.t1)(e.screen)}})()})}function Q(e){window.__c={n:"TeamScreen"};const[t]=(0,o.AF)(k.Z),s=(0,i.O7)();return(0,n.useEffect)((()=>{if(t.open){const{from:e,flowId:n}=t;g.krX(s,{from:e,flowId:n})}}),[]),(0,B.jsxs)("div",{style:U.createTeamContainer,children:[(0,B.jsx)(z,{titleAriaId:e.titleAriaId,screen:k.F.Team}),(0,B.jsx)(H,{descriptionAriaId:e.descriptionAriaId,screen:k.F.Team}),(0,B.jsxs)("div",{style:U.full,children:[(0,B.jsx)(G,{}),(0,B.jsx)(K,{}),(0,B.jsx)($,{})]}),(0,B.jsx)(L,{})]})}function Y(){window.__c={n:"ScreenLoadingSpinner"};const e=(0,o.VK)((()=>k.Z.state.loading),[]),t=(0,a.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return(0,B.jsx)(B.Fragment,{children:e&&(0,B.jsx)("div",{style:t.spinner,children:(0,B.jsx)(y.Z,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function $(){window.__c={n:"AccessLevelSection"};const e=(0,a.yK)((e=>({openAccessMessage:{fontSize:13,color:e.mediumTextColor,marginTop:20,lineHeight:1.4,display:"flex"},iconContainer:{marginRight:8},openTeamIcon:{width:24,fill:e.mediumIconColor},teamAccessPopupContainer:{marginTop:20}})),[]),[t,s]=(0,o.AF)(k.Z),n=(0,C.OX)(),r=(0,i.O7)(),l=(0,o.VK)((()=>{const e=T.default.state.currentSpaceStore;return e?(0,w.rn)(r,e):"this workspace"}),[r]);return n?(0,B.jsxs)("div",{style:e.openAccessMessage,children:[(0,B.jsx)("div",{style:e.iconContainer,children:(0,d.R)(e.openTeamIcon)}),(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.openAccessLabel",defaultMessage:"Everyone at {spaceName} and new members will have access to this teamspace",values:{spaceName:l}})]}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(M.Z,{hasMarginTop:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions"})}),(0,B.jsx)(O._,{currentAccessLevel:t.accessLevel,currentIsDefault:t.isDefault,onChange:(e,n)=>{s(n?{...t,accessLevel:"open",isDefault:n}:{...t,accessLevel:e,isDefault:n})}})]})}function J(e){window.__c={n:"MemberScreen"};const t=(0,i.O7)(),[,,s]=(0,o.AF)(k.Z),[,,n]=(0,o.AF)(void 0,P.Z);(0,o.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=s.state;n.setState({...n.state,flowId:t}),e&&n.setState({...n.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[s,n]);const a=(0,o.VK)((()=>T.default.state.currentSpaceStore),[]);if(!a)return null;const r=I.zX.createChildStore(a,{table:"team",id:e.teamId,spaceId:a.id});return(0,B.jsx)("div",{style:U.full,children:(0,B.jsx)("div",{style:U.addMembersContainer,children:(0,B.jsx)(E.Z,{store:r,permissionsInviteStore:n,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{e.onCompleted(r),Z.hI({environment:t,teamStore:r,shouldScroll:!0})},onDismiss:()=>{e.onCanceled(r)}})})})}const X=[r.Z.images.avatars.avatar1Png,r.Z.images.avatars.avatar2Png,r.Z.images.avatars.avatar3Png];function ee(e){let{handleModalClose:t}=e;window.__c={n:"FirstTeamHeader"};const s=(0,a.yK)((e=>({container:{borderTopLeftRadius:5,borderTopRightRadius:5,background:e.inputBackground,boxShadow:e.inputBoxShadow},header:{display:"flex",padding:14,fontWeight:m.Z.fontWeight.medium},avatarGroup:{display:"flex",width:"100",marginLeft:4,alignSelf:"center"},avatar:{marginLeft:-4},message:{paddingLeft:14,paddingRight:14},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,B.jsx)("div",{style:s.container,children:(0,B.jsxs)("div",{style:s.header,children:[(0,B.jsx)("div",{style:s.avatarGroup,children:X.map(((e,t)=>(0,B.jsx)(b.Z,{avatarShouldShowShadow:!0,style:s.avatar,size:28,avatar:{avatarUrl:e}},t)))}),(0,B.jsx)(v.Z,{style:s.message,isMultiline:!0,isSmall:!0,children:(0,B.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.firstTeamHeader",defaultMessage:"Create your first teamspace to start using Notion with your teammates"})}),(0,B.jsx)(h.Z,{onClick:t,style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,l.D)(s.closeButtonIcon)})]})})}function te(){window.__c={n:"SidebarCreateTeamModal"};const e=(0,i.O7)(),[t,,]=(0,o.AF)(k.Z),s=(0,n.useId)(),r=(0,n.useId)(),d=(0,a.yK)((e=>({modal:{maxWidth:500,borderRadius:5,overflow:"visible"},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),u=(0,n.useCallback)((t=>{Z.ED({environment:e,from:t})}),[e]),{open:m,loading:p,screen:g}=t,f=(0,C.OX)(),y=(0,n.useRef)(f);return(0,n.useEffect)((()=>{p||(y.current=f&&g===k.F.Team)}),[p,g,f]),m?(0,B.jsx)(S.Z,{ariaLabelledBy:s,ariaDescribedBy:r,open:m,innerStyle:d.modal,onDismiss:()=>{u("modal")},render:()=>{const{device:t}=e;return(0,B.jsxs)("div",{style:{height:"100%"},children:[!t.isMobile&&(y.current?(0,B.jsx)(ee,{handleModalClose:()=>{u("close_button")}}):(0,B.jsx)(h.Z,{onClick:()=>{u("close_button")},style:d.closeButton,hoveredStyle:d.closeButtonHover,children:(0,l.D)(d.closeButtonIcon)})),(0,B.jsx)("div",{style:d.wrapper,children:(0,B.jsx)(x.Z,{capture:!0,onBackspace:c.yR,onLeft:c.yR,onRight:c.yR,onSelectAll:c.yR,onRedo:c.yR,onUndo:c.yR,onCut:c.yR,onCopy:c.yR,onPaste:c.yR,onKeypress:c.yR,onDelete:c.yR,onTab:c.yR,children:(0,B.jsx)(q,{titleAriaId:s,descriptionAriaId:r})})}),(0,B.jsx)(Y,{})]})}}):null}},60701:(e,t,s)=>{s.d(t,{_:()=>M});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(36591),r=s(42853),l=s(5257),d=s(52275),c=s(31945),u=s(78140),m=s(32163),p=s(72495),g=s(26388),h=s(87279),f=s(98742),x=s(4023),y=s(31194),S=s(56187),v=s(26160),b=s(85893);function M(e){let{currentAccessLevel:t,currentIsDefault:s=!1,onChange:M,teamStore:j,disabledWithRightChevron:w=!1,style:C}=e;window.__c={n:"TeamAccessLevelButtonPopup"};const{device:k}=(0,n.O7)(),T=(0,S.q)(j),I=(0,o.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`,...C},selectedCheckmark:{width:k.isMobile?16:14},icon:{alignSelf:"center",marginTop:0}})),[k.isMobile,C]),P=(0,i.VK)((()=>(null==j?void 0:j.isDefault())??s),[j,s]),Z=P?"default":t,F=(0,v.U)({teamStore:j,onChange:M,isDefault:P});return(0,b.jsx)(c.ZP,{popupType:k.isMobile?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:e=>{const t=F.find((e=>e.key===Z));if(!t)return null;const s=t.disableAllOptionsTooltip,n=w||Boolean(s)||Boolean(j)&&!T;return(0,b.jsx)(g.ZP,{placement:x.u.Bottom,alignment:x.v.Start,disableTooltip:!s||!T,renderTooltip:()=>s,style:{width:350},textWrap:!0,render:s=>(0,b.jsx)(d.Z,{...(0,f.Z)(e,s),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:I.icon,disabled:n,right:w?(0,l.o)(I.chevron):n?void 0:(0,r.i)(I.chevron),focused:!1,shouldWrapCaption:!0,buttonStyle:I.selectedButton})})},placementToOrigin:y.Iw.Bottom,alignmentToOrigin:y.lU.Start,sameWidthAsOrigin:!0,render:e=>{const t=[{key:"access levels",render:e=>(0,b.jsx)(p.Z,{...e,topBorder:0!==e.index}),items:F.map((t=>{const s=t.key===Z;return{key:t.key,render:e=>(0,b.jsx)(g.ZP,{placement:x.u.Top,disableTooltip:!t.tooltip,renderTooltip:()=>t.tooltip,render:n=>(0,b.jsx)(d.Z,{...(0,f.Z)(e,n),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:I.icon,right:s?(0,b.jsx)("div",{style:I.selectedCheckmark,children:(0,a.e)()}):void 0,disabled:t.disabled,shouldWrapCaption:!0})}),action:()=>{t.onSelect(),e.close()}}}))}];return(0,b.jsx)(u.Z,{menuType:h.og.Popup,children:(0,b.jsx)(m.Z,{type:m.i.Vertical,initialFocus:void 0,sections:t})})}})}},86232:(e,t,s)=>{s.d(t,{M:()=>b});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(82990),l=s(38755),d=s(95697),c=s(1083),u=s(64552),m=s(9291),p=s(89728),g=s(80444),h=s(9867),f=s(85893);const x=function(e){window.__c={n:"TeamJoinButton"};const{teamStore:t,from:s,navigateToTeamHomeOnJoin:a,onJoinedTeam:r,style:l,hoveredStyle:d,icon:c,isRed:u}=e,x=(0,i.O7)(),y=(0,o.VK)((()=>g.default.state.currentSpaceStore),[]),S=(0,n.useCallback)((async()=>{y&&(await h.um({environment:x,teamStore:t,currentSpaceStore:y,from:s,andNavigateToTeamHome:a??!1}),null==r||r())}),[y,x,t,s,a,r]);return(0,f.jsx)(p.Z,{style:l,hoveredStyle:d,onClick:S,icon:c,isRed:u,children:(0,f.jsx)(m.FormattedMessage,{id:"outlinerTeamToggleButton.joinTeamButton",defaultMessage:"Join"})})};var y=s(8787),S=s(14889);const v=function(e){window.__c={n:"TeamRequestButton"};const{teamStore:t,style:s,hoveredStyle:i}=e,[a,r]=(0,n.useState)(!1),l=(0,o.VK)((()=>t.getName()),[t]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(p.Z,{style:s,hoveredStyle:i,onClick:()=>r(!0),children:(0,f.jsx)(m.FormattedMessage,{id:"teamRequestButton.requestButton.label",defaultMessage:"Request"})}),(0,f.jsx)(S.Z,{teamStore:t,teamName:l,teamId:t.id,isModalOpen:a,onDismiss:()=>r(!1)})]})};function b(e){window.__c={n:"TeamJoinLeaveButton"};const{teamStore:t,style:s,hoveredStyle:n}=e,m=(0,i.O7)(),p=(0,c.Q)(),g=(0,u.e)(t),h=(0,o.VK)((()=>t.getTeamAccessLevel()),[t]),S=(0,a.yK)((e=>({joinTeamButton:{maxHeight:26,marginLeft:10,paddingLeft:10,paddingRight:10,borderRadius:100,fontSize:13,fontWeight:r.Z.fontWeight.semibold,background:e.buttonHoveredBackground,alignSelf:"center",...s},joinTeamButtonHoveredStyle:{background:e.buttonPressedBackground,...n}})),[s,n]),b=(0,o.VK)((()=>(0,d.Hu)({membership:t.getRawMembership()})&&(0,l.Fn)(m)),[m,t]),M=!g&&"open"===h||b,j=!g&&"closed"===h;return p?null:g?(0,f.jsx)(y.Z,{...e,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):M?(0,f.jsx)(x,{...e,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):j?(0,f.jsx)(v,{teamStore:t,style:S.joinTeamButton,hoveredStyle:S.joinTeamButtonHoveredStyle}):null}},8787:(e,t,s)=>{s.d(t,{Z:()=>h});var n=s(67294),i=s(480),o=s(86628),a=s(36591),r=s(72126),l=s(64684),d=s(9291),c=s(89728),u=s(26388),m=s(80444),p=s(9867);var g=s(85893);const h=function(e){window.__c={n:"TeamLeaveButton"};const{teamStore:t,from:s,onLeavingTeam:h,style:f,hoveredStyle:x,icon:y,isRed:S,placement:v,alignment:b,buttonInternals:M}=e,j=(0,i.O7)(),w=(0,o.VK)((()=>m.default.state.currentSpaceStore),[]),C=(0,n.useCallback)((async()=>{if(!w)return;await p.s({environment:j,teamStore:t,currentSpaceStore:w,from:s})&&(null==h||h())}),[w,j,t,s,h]),k=(0,g.jsx)(d.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.enabledTooltip",defaultMessage:"Click to leave teamspace"}),T=function(e){let{teamStore:t}=e;const s=(0,i.O7)().currentUser.id,{isDefaultTeam:n}=(0,o.VK)((()=>({isDefaultTeam:t.isDefault()})),[t]),a=function(e){const t=(0,o.VK)((()=>m.default.state.currentSpaceStore),[]);return(0,o.VK)((()=>e.isDefined()&&null!=t&&t.isDefined()?(0,l.x4)({members:e.getMembers(),groups:(null==t?void 0:t.getPermissionGroups())??[]}):[]),[e,t])}(t),c=(0,o.VK)((()=>s?a.filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(s)})):[]),[a,s]),u=(0,o.VK)((()=>{if(!t.isReady())return!1;const e=(0,l.XO)({membership:t.getMembers()});return 1===e.length&&e[0]===s}),[t,s]);return function(e){let{isDefaultTeam:t,isOnlyTeamOwner:s,userGroups:n}=e;if(t)return(0,g.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.defaultTeamTooltip",defaultMessage:"You can’t leave this teamspace because everyone in the workspace must be a member"});if(s)return(0,g.jsx)(d.FormattedMessage,{id:"teamJoinLeaveButton.leaveTeam.onlyOwnerTooltip",defaultMessage:"Invite another teamspace owner to leave this teamspace"});if(n.length>0)return(0,g.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.leaveTeam.groupTooltip",defaultMessage:"{groupNames, plural, one {You can't leave this teamspace because you're a member of multiple groups, {groupNames}.} other {You can't leave this teamspace because you're a member of the group, {groupNames}.}}",values:{groupNames:r.oA(n.map((e=>e.name))).join()}})}({isDefaultTeam:n,isOnlyTeamOwner:u,userGroups:c})}({teamStore:t}),I=Boolean(T),P=I?T:k;return(0,g.jsx)(u.ZP,{style:I?{width:240}:void 0,disableTooltip:!Boolean(P),renderTooltip:e=>(0,g.jsx)("div",{...e,children:P}),textWrap:I,placement:v,alignment:b,render:e=>(0,g.jsx)(c.Z,{...e,style:f,hoveredStyle:x,onClick:C,disabled:I,disabledFeedback:I,icon:y,isRed:S,children:M||(0,g.jsxs)(g.Fragment,{children:[(0,a.e)({width:12.5,marginRight:4}),(0,g.jsx)(d.FormattedMessage,{id:"teamBrowser.teamCard.button.joined",defaultMessage:"Joined"})]})})})}},43488:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var n=s(16184),i=s(9291),o=s(26388),a=s(85893);function r(e){let{iconStyle:t}=e;return(0,a.jsx)(o.ZP,{textWrap:!0,style:{width:210},placement:o.ug.Bottom,renderTooltip:()=>(0,a.jsx)(i.FormattedMessage,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,a.jsx)("div",{...e,children:(0,n.Q)(t)})})}},38680:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(33728),r=s(59054),l=s(9291),d=s(78140),c=s(43579),u=s(91487),m=s(47082),p=s(4708),g=s(87279),h=s(45101),f=s(95697),x=s(80444),y=s(33052),S=s(34583),v=s(42853),b=s(72126),M=s(52275),j=s(31945),w=s(32163),C=s(89728),k=s(72495),T=s(26388),I=s(31194),P=s(56187),Z=s(85893);function F(e){window.__c={n:"TeamRoleSelect"};const{disabled:t,selectedRole:s,allRoles:a,onChange:r,store:c,labelStyle:u}=e,{device:m}=(0,n.O7)(),p=(0,o.Fg)(),h=(0,P.q)(c),y=(0,i.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return null==e?void 0:e.canEditMembership()}),[]),S=(0,i.VK)((()=>c.isDefault()),[c]);return(0,Z.jsx)(j.ZP,{popupType:m.isMobile?j.Z4.SlideUp:j.Z4.Popup,renderOrigin:e=>(0,Z.jsxs)(C.Z,{style:u,disabled:t,disabledFeedback:!0,...e,children:[(0,Z.jsx)(l.FormattedMessage,{...f.q9[s].label}),(0,v.i)({width:10,marginLeft:4,fill:p.lightIconColor})]}),placementToOrigin:I.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>(0,Z.jsx)(k.Z,{...e,topBorder:0!==e.index}),items:a.map((t=>{const n=!h&&"owner"===t,i=S&&"team_level_guest"===t,o=!y&&"team_level_guest"===t,a=!h&&"team_level_guest"===t,d=n||i||o||a;return{key:t,render:e=>(0,Z.jsx)(T.ZP,{disableTooltip:!d,placement:T.ug.Right,textWrap:!0,renderTooltip:()=>n?(0,Z.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingOwnerForMembers",defaultMessage:"Teamspace members can't add owners"}):i?(0,Z.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestsInDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"}):o||a?(0,Z.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestForNonSpaceAdminsOrNonTeamOwners",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"}):void 0,render:n=>(0,Z.jsx)("span",{...n,children:(0,Z.jsx)(M.Z,{...e,focused:!1,checkState:b.Xy(t,s),disabled:d,disabledFeedback:d,title:(0,Z.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,Z.jsx)(l.FormattedMessage,{...f.q9[t].label})}),caption:(0,Z.jsx)("span",{style:{color:p.mediumTextColor},children:(0,Z.jsx)(l.FormattedMessage,{...f.q9[t].caption})}),shouldWrapCaption:!0})})}),action:()=>{r(t),e.close()}}}))}];let n;return n=m.isMobile?{menuType:g.og.Modal,title:(0,Z.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,Z.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:g.og.Popup,width:264},(0,Z.jsx)(d.Z,{...n,children:(0,Z.jsx)(w.Z,{type:w.i.Vertical,initialFocus:void 0,sections:t})})}})}const _="member";function A(e){window.__c={n:"TeamPermissionsInviteInput"};const{store:t,permissionsInviteStore:s,onEmptySubmit:n}=e,r=(0,l.useIntl)(),d=(0,i.VK)((()=>Boolean(s.state.isFocused)),[s]),c=(0,i.VK)((()=>s.state.tokenQuery),[s]),p=(0,i.VK)((()=>s.state.inviteRole),[s]),g=(0,i.VK)((()=>s.state.inviteTargets),[s]),f=(0,o.yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:4,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:d?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[d]);function x(e){if(s.state.isInviteTargetsEmpty)return;const t=s.state.inviteTargets.filter((t=>t!==e));0===g.length?s.setState({...s.state,inviteTargets:[],inviteRole:_,isInviteTargetsEmpty:!0}):s.setState({...s.state,inviteTargets:t})}function y(e){s.setState({...s.state,isFocused:e})}const S=g.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,Z.jsx)(u.Z,{target:e,onClickRemove:x,role:p,shouldWrap:!0,style:f.inputTokenVerticalMargin,backgroundColor:(0,h.gQ)(e)},t)}));return(0,Z.jsx)(m.Z,{focus:d,onClick:()=>y(!0),format:m.U.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:n,newInputValue:i}=(0,a.zI)(t),o=n.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,h.Nd)({target:e,permissionsInviteStore:s}))),r=[...s.state.inviteTargets,...o];r.length>0?(s.setState({...s.state,inviteTargets:r,isInviteTargetsEmpty:!1,tokenQuery:i}),y(!(o.length>0))):s.setState({...s.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:i})},onEmptySubmit:n,type:"email",placeholder:r.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:S,onRemoveLastToken:function(){const e={...s.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=_),s.setState(e)},focusAfterAnimation:!0,right:(0,Z.jsx)(R,{store:t,permissionsInviteStore:s}),style:f.tokenMenuItem,inputStyle:f.inputTokenVerticalMargin,inputDivStyle:f.inputDiv,inputFullWidth:!0})}function R(e){window.__c={n:"TeamPermissionsInviteRoleSelect"};const{store:t,permissionsInviteStore:s}=e,n=(0,i.VK)((()=>{const e=x.default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,p.F$)()}),[]),a=(0,i.VK)((()=>s.state.inviteRole),[s]),r=(0,o.yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){s.setState({...s.state,inviteRole:e})}return n?(0,Z.jsx)(F,{store:t,selectedRole:a,allRoles:f.ZN,onChange:l,labelStyle:r.teamRoleLabel}):(0,Z.jsx)(F,{store:t,selectedRole:a,allRoles:f.$r,onChange:l,labelStyle:r.teamRoleLabel})}const D=function(e){window.__c={n:"TeamPermissionsInvite"};const{store:t,onEmptySubmit:s}=e,a=(0,n.O7)();(0,r.r5)((async()=>{await S.bi(a)}),[]);const l=(0,i.qz)(e.permissionsInviteStore,y.Z),u=(0,i.VK)((()=>Boolean(l.state.isFocused)),[l]),m=(0,i.VK)((()=>l.state.tokenQuery),[l]),p=(0,i.VK)((()=>u&&m.length>0),[u,m]),h=(0,o.yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:4,backgroundColor:e.contentBackground,boxShadow:e.largeBoxShadow,marginTop:4},scroller:{zIndex:1}})),[]);function f(e){l.setState({...l.state,isFocused:e})}return(0,Z.jsx)("div",{onFocus:()=>f(!0),onBlur:()=>f(!1),children:(0,Z.jsx)(d.Z,{menuType:g.og.Popup,header:(0,Z.jsx)(A,{store:t,permissionsInviteStore:l,onEmptySubmit:s}),scrollerStyle:h.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:p&&(0,Z.jsx)("div",{style:h.permissionsInviteSearchRequest,children:(0,Z.jsx)(c.Z,{permissionsInviteStore:l,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}},38078:(e,t,s)=>{s.d(t,{Z:()=>B,u:()=>D});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(33728),l=s(27714),d=s(82990),c=s(9291),u=s(50906),m=s(893),p=s(95209),g=s(64964),h=s(42922),f=s(68785),x=s(63296),y=s(89728),S=s(26388),v=s(64369),b=s(43250),M=s(4708),j=s(45101),w=s(95697),C=s(77907),k=s(80444),T=s(35057),I=s(9867),P=s(74016),Z=s(30765),F=s(85893);const _={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},multiButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"space-between"},singleButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"right"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},containerLeftAligned:{display:"flex",alignItems:"left",justifyContent:"left",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:d.Z.fontWeight.medium,...d.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250},subtitle:{paddingTop:16}};function A(e){var t;let{isLoading:s,isNewlyCreatedTeam:n,onDismiss:i,onSubmit:a,inviteTargets:r,includesGroups:l,inviteRole:d,canEditSpaceMembership:u,membershipRequestsDisabled:m,spaceAllowedDomains:p,hasTeamGuestsMatchAllowedDomain:g}=e;window.__c={n:"InviteSubmitButton"};const y=r.length>0,v=l&&"owner"===d,b=r.filter((e=>(0,j.OA)(e))).length>0&&m&&!u,w=(0,o.VK)((()=>(0,M.F$)()&&"team_level_guest"===d&&r.some((e=>"group"===e.type||"existingUser"===e.type&&"none"!==e.spaceRole&&"not_in_space"!==e.spaceRole))),[d,r]),C=v||w||b||g;if(s)return(0,F.jsx)(h.Z,{style:{..._.button,minWidth:80},disabled:!0,children:(0,F.jsx)(f.Z,{isWhite:!0})});if(n&&!y)return(0,F.jsx)(x.Z,{style:_.button,onClick:i,disabled:s,children:(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now"})});const k=v?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue."}):w?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.memberOrGroupInvitedAsTeamGuestTooltip",defaultMessage:"Cannot add space members or groups as teamspace guests. Remove them to continue."}):g?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.hasTeamGuestsMatchAllowedDomain",defaultMessage:"Cannot add users with {emailDomains} as teamspace guests. Remove them to continue.",values:{emailDomains:null==p||null===(t=p.map((e=>`@${e}`)))||void 0===t?void 0:t.join(", ")}}):null;return(0,F.jsx)(S.ZP,{textWrap:!0,style:_.submitTooltip,disableTooltip:!k,renderTooltip:()=>k,render:e=>(0,F.jsx)(h.Z,{style:_.button,onClick:a,disabled:!y||s||C,...e,children:(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlayV2.inviteButton.label",defaultMessage:"Invite"})})})}function R(e){let{inviteTargets:t,workspaceName:s,canEditSpaceMembership:n,membershipRequestsDisabled:i,isFreeTier:o,inviteRole:a,hasTeamGuestsMatchAllowedDomain:r}=e;if(void 0===n)return null;if(!t||0===t.length)return null;const l=t.map((e=>{if("group"!==e.type&&(0,j.OA)(e))return e.value.email})).filter((e=>e));if(!l||0===l.length)return null;const d=e=>(0,F.jsx)("b",{children:e}),u=s??"this workspace";return n?o?(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingularOwner.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a workspace owner.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPluralOwners.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as workspace owners.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):"team_level_guest"===a?r?null:(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.teamGuest.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed teamspace guest.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.teamGuest.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed teamspace guests.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed workspace member.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed workspace members.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):i?(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipDisabled.subtitle",defaultMessage:"You can't add workspace guests to a teamspace. Ask your admin to add them as workspace members first."})}):(0,F.jsx)(v.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipSingular.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{guestEmail}</b> as a member to {workspaceName}.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipPlural.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> as members to {workspaceName}.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})})}function D(e){window.__c={n:"InviteLink"};const{store:t,isSmall:s}=e,n=(0,i.O7)(),o=(0,a.yK)((e=>({button:{marginRight:5,marginLeft:5,height:32,fontSize:s?12:14},icon:{width:s?12:14,height:s?12:14}})),[s]);return(0,F.jsx)(y.Z,{onClick:()=>{m.RD({environment:n,stringValue:w.W8(t.id),copiedMessage:m.tq.copiedLinkToClipboard}),u.XTk(n,{store:t})},icon:l.N,style:o.button,iconStyle:o.icon,isBlue:!0,children:s?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkCondensedButton.label",defaultMessage:"Copy link"}):(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkButton.label",defaultMessage:"Copy invite link"})})}const B=function(e){let{store:t,permissionsInviteStore:s,isNewlyCreatedTeam:a,onSubmitSuccessful:l,onDismiss:d}=e;window.__c={n:"TeamPermissionsInviteOverlay"};const u=(0,i.O7)(),{teamName:m,workspaceName:h,canEditSpaceMembership:f,membershipRequestsDisabled:x,teamAccessLevel:y,spaceAllowedDomains:S}=(0,o.VK)((()=>{const{currentSpaceStore:e}=k.default.state;return{teamName:t.getName(),workspaceName:null==e?void 0:e.getName(),canEditSpaceMembership:null==e?void 0:e.canEditMembership(),membershipRequestsDisabled:null==e?void 0:e.getDisableMembershipRequests(),teamAccessLevel:t.getTeamAccessLevel(),spaceAllowedDomains:null==e?void 0:e.getEmailDomains()}}),[t]);(0,n.useEffect)((()=>()=>{a&&I.hI({environment:u,teamStore:t,shouldScroll:!0})}),[a,t,u]);const[v,B]=(0,n.useState)(!1),L=(0,o.VK)((()=>s.state.inviteTargets),[s]),O=(0,o.VK)((()=>s.state.inviteTargets.length),[s]),E=(0,o.VK)((()=>s.state.inviteRole),[s]),N=(0,o.VK)((()=>{if(s.state.isInviteTargetsEmpty)return!1;return Boolean(s.state.inviteTargets.find((e=>"group"===e.type)))}),[s]),V=(0,o.VK)((()=>T.QM()),[]),U=(0,o.VK)((()=>!(null==S||!S.length||"team_level_guest"!==E||!(0,M.F$)())&&L.some((e=>"group"!==e.type&&(0,r.dy)(S,e.value.email)))),[S,E,L]),W=(0,o.VK)((()=>(0,M.s$)()?!V&&!w.U2(t):"open"===y&&(0,M.u3)()),[t,y,V]),K=async()=>{if(B(!0),O>0){const e=s.state.inviteTargets,{success:n}=await p.zK({environment:u,store:t,permissionsInviteStore:s,inviteOrigin:"team_invite_overlay"});if(void 0!==f)if(n){const s=(0,j.t0)({inviteTargets:e,recordStore:t,canEditSpaceMembership:f});if(!s)return;setTimeout((()=>{g.oV({label:s})}))}else setTimeout((()=>{g.oV({label:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlay.inviteMembersFailure.message",defaultMessage:"Failed to send invites"})})}))}p.Mr({permissionsInviteStore:s}),B(!1),null==l||l()};return(0,F.jsx)("div",{className:b.D$4,style:{..._.full},children:(0,F.jsxs)("div",{style:_.containerLeftAligned,children:[(0,F.jsxs)("div",{style:_.titleAndIcon,children:[(0,F.jsx)("div",{style:_.addMembersTo,children:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.membersTitle.label",defaultMessage:"Invite people to"})}),(0,F.jsx)("div",{style:_.icon,children:(0,F.jsx)(P.p,{disabled:!0,store:t,size:20})}),(0,F.jsx)(Z.s,{style:_.teamName,children:m})]}),(0,F.jsxs)("div",{style:_.full,children:[(0,F.jsx)(C.LazyTeamPermissionsInvite,{store:t,permissionsInviteStore:s,onEmptySubmit:K}),(0,F.jsx)("div",{style:_.subtitle,children:(0,F.jsx)(R,{inviteTargets:L,workspaceName:h,canEditSpaceMembership:f,membershipRequestsDisabled:x,isFreeTier:V,inviteRole:E,hasTeamGuestsMatchAllowedDomain:U})})]}),(0,F.jsx)("div",{style:W?_.multiButtonContainer:_.singleButtonContainer,children:(0,F.jsxs)("div",{style:W?_.multiButtonContainer:{},children:[W&&(0,F.jsx)(D,{store:t}),(0,F.jsx)(A,{isLoading:v,onSubmit:K,onDismiss:()=>{p.Mr({permissionsInviteStore:s}),null==d||d()},isNewlyCreatedTeam:a,inviteTargets:L,includesGroups:N,inviteRole:E,canEditSpaceMembership:f,membershipRequestsDisabled:x,spaceAllowedDomains:S,hasTeamGuestsMatchAllowedDomain:U})]})})]})})}},71015:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});s(67294);var n=s(86628),i=s(9019),o=s(38078),a=s(85893);const r=function(e){window.__c={n:"TeamPermissionsInviteWithModal"};const[t,,s]=(0,n.AF)(e.permissionsInviteStore),r=()=>{s.reset()};return(0,a.jsx)(i.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:r,renderContent:()=>(0,a.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22},children:(0,a.jsx)(o.Z,{store:e.store,permissionsInviteStore:s,isNewlyCreatedTeam:!1,onSubmitSuccessful:r,onDismiss:r})}),origin:e.origin})}},43119:(e,t,s)=>{s.d(t,{C:()=>b,Z:()=>M});s(57658);var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(16184),l=s(9291),d=s(52275),c=s(31945),u=s(78140),m=s(32163),p=s(72495),g=s(45653),h=s(87279),f=s(75546),x=s(80444),y=s(14034),S=s(74016),v=s(85893);function b(e){window.__c={n:"TeamPickerButton"};const{renderOrigin:t,onTeamAccept:s,sectionTitle:n,showMemberCount:a,right:f,showPrivate:S,onPrivateAccept:b,captionItem:w}=e,C=(0,i.Fy)().isMobile,k=j(),T=(0,y.E)(),I=(0,o.VK)((()=>T.filter((e=>e.canAddOrRemoveTopLevelPages()))),[T]),P=(0,o.VK)((()=>x.default.state.currentUserStore),[]),Z=[];if(w){const e={key:"caption",render:e=>(0,v.jsx)(p.Z,{...e,topBorder:!0}),items:[w]};Z.push(e)}const F=I.map((e=>({key:e.id,action:()=>{s(e)},render:t=>(0,v.jsx)(M,{...t,team:e,onAccept:s,showMemberCount:a,right:f})}))),_={key:"teams",render:e=>(0,v.jsx)(p.Z,{...e,title:n}),items:F};if(Z.push(_),S){const e={key:"private",render:e=>(0,v.jsx)(p.Z,{...e,topBorder:F.length>0}),items:[{key:"private",action:()=>{},render:e=>(0,v.jsx)(d.Z,{...e,icon:(0,v.jsxs)("div",{style:{position:"relative"},children:[(0,v.jsx)(g.Z,{hasTooltip:!1,userStore:P}),(0,r.Q)(k.privateItemLockIcon)]}),title:(0,v.jsx)(l.FormattedMessage,{id:"teamPickerButton.addToPrivate",defaultMessage:"Add to Private"}),onClick:()=>{null==b||b()}})}]};Z.push(e)}return(0,v.jsx)(c.ZP,{...e,popupType:C?c.Z4.SlideUp:c.Z4.Popup,renderOrigin:t,render:e=>{let t;return t=C?{menuType:h.og.ActionSheet}:{menuType:h.og.Popup,width:"100%"},(0,v.jsx)(u.Z,{...t,children:(0,v.jsx)(m.Z,{style:{width:C?void 0:256},type:m.i.Vertical,initialFocus:void 0,sections:Z})})}})}const M=n.forwardRef(((e,t)=>{window.__c={n:"TeamItem"};const{team:s,onAccept:n,showMemberCount:i,right:a,...r}=e,c=j(),u=(0,o.VK)((()=>s.getUserIdsInTeam().length),[s]);return(0,v.jsx)(d.Z,{...r,ref:t,onClick:e=>n(s),icon:(0,v.jsx)(S.p,{store:s,size:20,disabled:!0}),title:(0,v.jsx)(f.o,{teamStore:s}),right:r.focused?a:null,caption:i?(0,v.jsx)("div",{style:c.caption,children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",id:"teamPickerButton.teamItem.teamMemberCount",values:{numberOfMembers:u}})}):null})}));function j(){return(0,a.yK)((e=>({privateItemLockIcon:{position:"absolute",bottom:-2,right:-2,zIndex:1,width:10,height:10,fill:e.accentColors.red[500]},caption:{color:e.lightTextColor}})),[])}},80068:(e,t,s)=>{s.d(t,{Z:()=>m});s(67294);var n=s(24405),i=s(97880),o=s(9291),a=s(74523),r=s(18514),l=s(30765),d=s(85893);function c(e){switch(e){case"bestPractices":return(0,r.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,r.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,r.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,i.t1)(e)}}function u(e){return e||(0,d.jsx)(l.s,{children:(0,d.jsx)(o.FormattedMessage,{defaultMessage:"Learn about teamspaces",id:"teamsLearnMoreLink"})})}function m(e){let{onClick:t,message:s,helpCenterLocation:i,analyticsFrom:o,containerStyle:r}=e;window.__c={n:"TeamsLearnMoreLink"};const l=(0,n.yK)((()=>({button:{maxWidth:"100%"}})),[]);return(0,d.jsx)("div",{style:r,children:(0,d.jsx)(a.Z,{buttonStyle:l.button,title:u(s),analyticsFrom:o,href:c(i),onClick:t})})}},79414:(e,t,s)=>{s.d(t,{n:()=>p});s(67294);var n=s(86628),i=s(24405),o=s(7928),a=s(9291),r=s(31278),l=s(45653),d=s(71862),c=s(80993),u=s(85893);const m=c.Kt;function p(e){let{ownerStores:t,teamStore:s,isSmall:o=!1}=e;window.__c={n:"TeamOwnerIcons"};const a=o?m:d.Z,l=o?10:16,c=(0,i.yK)((e=>({container:{position:"relative",width:a,height:a},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[a]),{teamName:p,teamIcon:h}=(0,n.VK)((()=>({teamName:s.getName(),teamIcon:s.getIcon()})),[s]),f=e=>(0,u.jsx)(r.Z,{disabled:!0,title:p,icon:h,isEmptyPage:!1,size:e});return 0===t.length?f(a):(0,u.jsxs)("div",{style:c.container,children:[(0,u.jsx)(g,{isSmall:o,store:t[0]}),(0,u.jsx)("div",{style:c.teamBadge,children:f(l)})]})}function g(e){let{store:t,isSmall:s=!1,style:c={}}=e;window.__c={n:"OwnerIcon"};const p=(0,a.useIntl)(),g=s?m:d.Z,h=(0,i.yK)((e=>({icon:{width:g,height:g,borderRadius:g,boxShadow:e.avatarBoxShadow,...c}})),[g,c]),f=(0,n.VK)((()=>null!=t&&t.isDefined()?(0,o.Nz)(p,null==t?void 0:t.getModel()):void 0),[p,t]),x=f?(0,u.jsx)(l.Z,{avatarShouldShowShadow:!0,userStore:t,size:g}):(0,u.jsx)(r.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:f,size:g,icon:void 0});return(0,u.jsx)("div",{style:h.icon,children:x})}},14465:(e,t,s)=>{s.d(t,{z:()=>a});s(67294);var n=s(24405),i=s(82990),o=s(85893);function a(e){let{title:t,subtitle:s,style:a}=e;window.__c={n:"TeamSettingsHeader"};const r=(0,n.yK)((e=>({base:{width:"100%"},title:{fontWeight:i.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:i.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return(0,o.jsxs)("div",{style:{...r.base,...a},children:[(0,o.jsx)("div",{style:r.title,children:t}),s&&(0,o.jsx)("div",{style:r.subtitle,children:s})]})}},80993:(e,t,s)=>{s.d(t,{Kt:()=>u,MQ:()=>c,Ph:()=>m,oM:()=>d});var n=s(67294),i=s(24405),o=s(61519),a=s(89728),r=s(14465),l=s(85893);const d=15,c=8,u=20;function m(e){window.__c={n:"TeamSettingsList"};const t=(0,i.yK)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(a.Z,{onClick:e.onClick,style:t.button,children:(0,l.jsx)(p,{...e})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(p,{...e})]})}function p(e){let{title:t,rows:s,hideDividers:a=!1,itemStyle:r,onClick:u}=e;window.__c={n:"TeamSettingsListContainer"};const m=(0,i.yK)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:d,marginRight:d,paddingTop:c,paddingBottom:c,...r},divider:{marginLeft:d,marginRight:d,borderColor:`${e.regularDividerColor}`}})),[r]);return(0,l.jsx)("div",{style:{...m.container},children:(0,l.jsx)("ul",{style:m.list,children:s.map(((e,t)=>(0,l.jsxs)(n.Fragment,{children:[!a&&t>0&&(0,l.jsx)(o.Z,{size:1,innerStyle:m.divider}),(0,l.jsx)("li",{style:m.listItem,children:e},t)]},t)))})})}},14034:(e,t,s)=>{s.d(t,{E:()=>a});var n=s(480),i=s(86628),o=s(28020);function a(){var e;const t=(0,n.O7)();return(null===(e=(0,i.Kw)((0,o.k_)(t)))||void 0===e?void 0:e.userJoinedTeamsStores)??[]}},1083:(e,t,s)=>{s.d(t,{Q:()=>l});var n=s(480),i=s(86628),o=s(38755),a=s(80444),r=s(88280);function l(){const e=function(){const e=(0,n.O7)();return(0,i.VK)((()=>{const t=a.default.state.currentSpaceStore,s=r.subscriptionDataStoreInstance.state;return t?o.Cx(t)?s?{loading:!1,isUserTeamGuestOfSpace:o.di(e,s)}:{loading:!0}:{loading:!1,isUserTeamGuestOfSpace:!1}:{loading:!0}}),[e])}();return(0,i.VK)((()=>e.loading||e.isUserTeamGuestOfSpace),[e])}},64552:(e,t,s)=>{s.d(t,{e:()=>r});var n=s(480),i=s(86628),o=s(95697),a=s(80444);function r(e){const t=(0,n.O7)(),s=(0,i.VK)((()=>a.default.state.currentSpaceStore),[]);return(0,i.VK)((()=>(0,o.AL)({teamStore:e,spaceStore:s,userId:t.currentUser.id})),[s,t.currentUser.id,e])}},40215:(e,t,s)=>{s.d(t,{F:()=>g});var n=s(86628),i=s(59054),o=s(6287),a=s(54814),r=s(23924),l=s(77907),d=s(75822),c=s(62395),u=s(77080),m=s(42330),p=s(26136);function g(e){let{environment:t,spaceStore:s,joinedTeamIds:g,parentStore:h,moveToTargets:f,overrideDatabaseType:x}=e;const y=(0,n.VK)((()=>{const e=null==s?void 0:s.id;if(e)return function(e){if(!c.n.state)return;if(e!==c.n.state.spaceId)return;return c.n.state.typedDatabases}(e)}),[null==s?void 0:s.id]),S=(0,n.VK)((()=>u.default.checkGate("typed_move_to_improved_default_results")),[]),v=(0,l.useDependency)(l.deps.searchActions),[{value:b,status:M}]=(0,i.r5)((async()=>{if(y)return y;if(!s||!h)return;const e=m.ZP.getTargetsDatabaseType()??x;if(!e)return;if("resolved"!==v.status)return;const n=v.value;let i=[];if(S){const a=((await n.searchCollectionsWithRecents({environment:t,query:"",limit:20,databaseType:[e],spaceStore:s,parentStore:s,collectionViewBlockStore:void 0})).results||[]).map((e=>p.NW.createChildStore(h,{table:o.v,id:e})));i=(0,r.qJ)({typedDatabases:a,blocksToFilterParents:f})}else{const n=await a.rG({environment:t,spaceId:s.id,databaseType:e,parentStore:h})??[];i=(0,r.mL)({environment:t,typedDatabases:n,spaceStore:s,joinedTeamIds:g})}return c.n.setState({typedDatabases:i,spaceId:s.id}),m.ZP.setState({...m.ZP.state,variant:"typedInitialized"}),i}),[y,s,S,t,f,x,h,g,v.status,v.value],{debounce:d.vp,throttle:d.vp});return y?{success:!0,typedDatabases:y}:"resolved"===M&&b?{success:!0,typedDatabases:b}:{success:!1}}},22487:(e,t,s)=>{s.d(t,{K:()=>r});var n=s(86628),i=s(72141),o=s(95697),a=s(80444);function r(e){return(0,n.VK)((()=>{if(!e)return 0;const t=a.default.state.currentSpaceStore,s=a.default.state.currentUserStore;if(!i.YX((null==t?void 0:t.getRole())??"none")){return(0,o.tu)({currentUserStore:s,currentSpaceStore:t,teamStore:e,members:e.getMembers()}).length}return(0,o.tO)({teamStore:e,spaceStore:t}).length}),[e])}},26160:(e,t,s)=>{s.d(t,{U:()=>M});s(30541),s(67294);var n=s(480),i=s(86628),o=s(24405),a=s(8848),r=s(39812),l=s(40462),d=s(90199),c=s(49364),u=s(64684),m=s(9291),p=s(38755),g=s(12205),h=s(80444),f=s(44041),x=s(74136),y=s(85893);const S=function(e){let{tier:t}=e;const s=()=>"business"===t?(0,y.jsx)(m.FormattedMessage,{id:"upgradeToBusinessBadge",defaultMessage:"Business"}):(0,y.jsx)(m.FormattedMessage,{id:"upgradeToEnterpriseBadge",defaultMessage:"Enterprise"});return(0,y.jsx)(x.Z,{children:(0,y.jsx)(s,{})})};var v=s(11628),b=s(97082);function M(e){let{teamStore:t,isDefault:s,onChange:x=(()=>{})}=e;const M=(0,n.O7)(),w=(0,g.J)(),C=(0,b.y)(null==t?void 0:t.id),k=(0,v.P)(),T="business",I=(0,i.VK)((()=>h.default.state.currentSpaceStore),[]),P=(0,i.VK)((()=>{if(I)return(0,p.rn)(M,I)}),[M,I]),Z=(0,i.VK)((()=>{const e=null==t?void 0:t.getSettingsStore().getValue();return!!e&&("private"===(0,u.B5)(e)??!1)}),[t]),F=(0,o.yK)((()=>({openIcon:{width:20,height:20},lockIcon:{width:18,height:18},closedIcon:{width:20,height:20},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:5,marginRight:5}})),[]),_=(0,y.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces"}),A=(0,y.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamSpace.title",defaultMessage:"Default"}),R=(0,y.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open"}),D=(0,y.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed"}),B=(0,y.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private"}),L="dark"===(0,o.Fg)().mode?a.ZP.uiLightGray:a.ZP.black,O=[{key:"open",icon:e=>(0,y.jsx)("div",{style:F.iconContainer,children:(0,c.R)({...e,...F.openIcon})}),iconColor:L,level:R,title:R,caption:(0,y.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace"}),disabled:!1,onSelect:()=>x("open",!1)},{key:"closed",icon:e=>(0,y.jsx)("div",{style:F.iconContainer,children:(0,r.u)({...e,...F.closedIcon})}),iconColor:L,level:D,title:D,caption:(0,y.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join"}),disabled:!1,onSelect:()=>x("closed",!1)},{key:"private",icon:e=>(0,y.jsx)("div",{style:F.iconContainer,children:(0,d.b)({...e,...F.lockIcon})}),iconColor:L,level:B,title:k?B:(0,y.jsx)(j,{title:B,badge:(0,y.jsx)(S,{tier:T})}),caption:(0,y.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists"}),disabled:!k&&!w,tooltip:k?void 0:_,onSelect:()=>{if(!k&&!Z)return f.y(M,{from:"team_security_settings",for:T,dontOpenPlansOnCancel:!0});x("private",!1)}}];if(s||w){const e=s&&(!w||C),t={key:"default",icon:e=>(0,y.jsx)("div",{style:F.iconContainer,children:(0,l.o)({...e,...F.lockIcon})}),iconColor:L,level:A,title:A,caption:(0,y.jsx)(m.FormattedMessage,{id:"CreateTeamspaceMenu.defaultTeamspace.caption",defaultMessage:"Everyone at {spaceName} must be a member",values:{spaceName:P}}),disabled:!1,disableAllOptionsTooltip:e?w?(0,y.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions."}):(0,y.jsx)(m.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because you are not a workspace admin"}):void 0,onSelect:()=>x("open",!0)};O.unshift(t)}return O}function j(e){let{title:t,badge:s}=e;window.__c={n:"TitleWithBadge"};const n=(0,o.yK)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return(0,y.jsxs)("div",{style:n.container,children:[t,(0,y.jsx)("div",{style:n.badge,children:s})]})}},29318:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Le});var n=s(67294),i=s(480),o=s(86628),a=s(24405),r=s(15145),l=s(92996),d=s(11002),c=s(9291),u=s(50906),m=s(81193),p=s(54642),g=s(86282),h=s(75754),f=s(8055),x=s(82530),y=s(88833),S=s(86095),v=s(34517),b=s(74927),M=s(40663),j=s(50506),w=s(28020),C=s(98165),k=s(94660),T=s(80444),I=s(31931),P=s(59307);var Z=s(65435),F=s(51247),_=s(84465),A=s(94952),R=s(73314),D=s(97880),B=s(33929),L=s(77080);function O(e){const{subscriptionTier:t,userPersona:s,selectedTopCategory:n}=e,i=function(e){var t;const s=e??(null===(t=P.Z.state.data)||void 0===t?void 0:t.defaultCategoryId);if(!s)return;const n=(0,Z.oO)(s);if(!n)return;return{selectedTopCategory:s,allTemplates:N(n)}}(n);return i||function(e){return{selectedTopCategory:void 0,allTemplates:E(e)}}({subscriptionTier:t,userPersona:s})}function E(e){let{userPersona:t,subscriptionTier:s}=e;const n=B.default.getIntl();return Object.fromEntries((0,Z.Io)({userPersona:t,subscriptionTier:s}).map((e=>[e,[..._.gh[e].map((e=>(0,M.kY)((0,v.appConfigs)(),e))),..._.J9[e].filter((e=>(0,A.G)(e,L.default))).map((e=>(0,R.G)(e,n)))]])))}function N(e){return e.subcategories.reduce(((e,t)=>{let{id:s,templates:n}=t;return s&&null!=n&&n.length?{...e,[s]:n.map((e=>"preset"===e.type?(0,M.kY)((0,v.appConfigs)(),e.uri):"pageTemplate"===e.type?e.template:void(0,D.t1)(e)))}:e}),{})}var V=s(29949),U=s(41892),W=s(75071),K=s(21202),z=s(42922),q=s(31945),G=s(62896),H=s(73063),Q=s(16354),Y=s(64369),$=s(31192),J=s(55095);var X=s(82136),ee=s(26136),te=s(43119),se=s(14034),ne=s(85893);function ie(e){window.__c={n:"TemplateDetail"};const t=(0,i.O7)(),s=(0,c.useIntl)(),r=function(e){const[t,s]=n.useState(!1);return n.useEffect((()=>{const t=window.matchMedia(e);function n(e){s(e.matches)}return t.addEventListener("change",n),()=>{t.removeEventListener("change",n)}}),[e]),t}("(max-width: 960px)"),l=(0,a.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor},contentContainer:{margin:16,padding:"20px 24px",border:"1px solid rgba(0, 0, 0, 0.07)",borderRadius:8,background:e.sidebarBackground,display:"flex",flexDirection:"row",justifyContent:"space-between",columnGap:50,flexWrap:r?"wrap":"nowrap"},getTemplateColumn:{width:r?"100%":void 0,display:"flex",flexDirection:r?"column-reverse":"column"},madeByLabelV1:{marginTop:16,marginBottom:16},heroImg:{height:"100%",width:"100%"},getTemplateButton:{width:r?"100%":220,height:38,fontSize:16},addBadgeTeamTemplateButton:{textTransform:"none",color:e.blueColor},madeByV2Container:{marginBottom:16,display:"flex",flexDirection:"row",alignItems:"center",gap:6,width:"content-fit"},madeByV2Label:{fontSize:14,fontWeight:500},madeByV2AvatarContainer:{width:30,height:30,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden",backgroundColor:"rgb(245, 245, 245)"},madeByV2Avatar:{width:30,height:30},madeByV2NotionAvatar:{width:16,height:16}})),[r]),{status:d,selectedTemplate:u,cloneTo:p,selectedTeam:g}=(0,o.VK)((()=>V.Z.state),[]),h=(0,o.VK)((()=>{if("open"===d&&"preset"===(null==u?void 0:u.type)){const e=u.uri,t=(0,M.iX)((0,v.appConfigs)(),e),s=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&s)return{currentApp:t,currentPreset:s}}}),[d,u]),f=(0,o.VK)((()=>{if(u){if("preset"===u.type){var e;if(!h)return;const{currentPreset:s}=h,n=null===(e=s.previews)||void 0===e?void 0:e.find((e=>"previewRootId"in e)),i=n&&new ee.G(t,{table:K.iU,id:n.previewRootId,spaceId:n.spaceId}),o=i?(0,ne.jsx)("div",{style:{overflow:"hidden",paddingTop:64,paddingLeft:64,paddingRight:64},children:L.default.checkGate("page_view_block_refactor")?(0,ne.jsx)($.ZP,{store:i,loadingContainerStore:void 0,context:X.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:0,titleStyle:{fontSize:32},disabled:!0},i.id):(0,ne.jsx)(J.Z,{store:i,loadingContainerStore:void 0,context:X.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:0,titleStyle:{fontSize:32},disabled:!0},i.id)}):(0,ne.jsx)("img",{style:l.heroImg,src:U.Z.images.appPackages.projectPreview1Png});return[s.name,s.description,(0,ne.jsx)("img",{src:s.icon,style:{width:30,height:30}},s.uri),o]}if("pageTemplate"===u.type){const{template:e}=u,s=new ee.G(t,{table:K.iU,id:e.previewRootId,spaceId:e.spaceId}),n=s.isCollectionView()?64:0,i=(0,ne.jsx)("div",{style:{overflow:"hidden",paddingTop:n,paddingLeft:n,paddingRight:n},children:L.default.checkGate("page_view_block_refactor")?(0,ne.jsx)($.ZP,{store:s,loadingContainerStore:void 0,context:X.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:$.ZP.defaultPageCoverHeight(t),disabled:!0,style:{...s.isFullWidth()?{width:"calc(100% - 64px)",margin:`0 ${F.wN}px`}:{}}}):(0,ne.jsx)(J.Z,{store:s,loadingContainerStore:void 0,context:X.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:$.ZP.defaultPageCoverHeight(t),disabled:!0,style:{...s.isFullWidth()?{width:"calc(100% - 64px)",margin:"0 32px"}:{}}})});return[e.name,e.description,(0,ne.jsx)("span",{style:{fontSize:20,height:30},children:e.emoji?(0,ne.jsx)(G.Z,{children:e.emoji}):(0,ne.jsx)("img",{src:e.icon,style:{width:30,height:30}},e.icon)},e.rootId),i]}(0,D.t1)(u)}}),[h,t,u,l.heroImg]),x=(0,se.E)(),y=(0,o.VK)((()=>x.filter((e=>e.canAddOrRemoveTopLevelPages()))),[x]),{creatorName:S,creatorAvatar:b,creatorUrl:j}=(0,o.VK)((()=>{if(!u||"preset"===u.type)return{creatorName:"Notion",creatorAvatar:U.Z.images.notionLogoPng,creatorUrl:(0,Z.D2)("notion")};const{template:e}=u,{creatorId:s}=e;if(!s){const{creatorName:t,creatorAvatar:s,creatorHandle:n}=e;return{creatorName:t,creatorAvatar:s,creatorUrl:t&&n?(0,Z.D2)(n):void 0}}const n=new ee.yj(t,{table:"template_creator",id:s}),i=n.getName(),o=n.getCreatorAvatarWithProtocol(),a=n.getUsername();return{creatorName:i,creatorAvatar:o,creatorUrl:i&&a?(0,Z.D2)(a):void 0}}),[u,t]);if("open"!==d||void 0===u||!f)return null;const[w,C,T,I]=f,P=y.length>0&&"destination_picker"===p&&!g,_=(0,ne.jsx)(c.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"}),A=(0,ne.jsx)(z.Z,{style:l.getTemplateButton,onClick:()=>{e.onAcceptTemplate(u,g),m.ye(t,{template_name:w,from:V.Z.state.analyticsFrom,template_id:(0,k.gA)(u),target_team:null==g?void 0:g.id})},children:_}),R=(0,ne.jsx)(te.C,{showMemberCount:!0,showPrivate:!0,placementToOrigin:q.pO.Top,originGap:4,sectionTitle:(0,ne.jsx)(c.FormattedMessage,{...Z.cY.addToTeamspace}),renderOrigin:e=>(0,ne.jsx)(z.Z,{...e,style:l.getTemplateButton,children:_}),onTeamAccept:s=>{e.onAcceptTemplate(u,s),m.ye(t,{template_name:w,from:V.Z.state.analyticsFrom,template_id:(0,k.gA)(u),target_team:s.id})},onPrivateAccept:()=>{e.onAcceptTemplate(u),m.ye(t,{template_name:w,from:V.Z.state.analyticsFrom,template_id:(0,k.gA)(u),target_team:"private"})},right:(0,ne.jsx)(H.Z,{isBlue:!0,style:{borderRadius:"100px",pointerEvents:"none"},icon:W.f,hovered:!0,caption:(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"Add",id:"TemplateDetail.TeamItem.addButton"}),ariaLabel:s.formatMessage({id:"TemplateDetail.TeamItem.addButtonLabel",defaultMessage:"Add"}),captionStyle:l.addBadgeTeamTemplateButton})}),B=S?(0,ne.jsxs)(Q.Z,{style:{...l.madeByV2Container,...!j&&{cursor:"default"}},href:j,disabled:!j,external:!0,children:[b&&(0,ne.jsx)("div",{style:l.madeByV2AvatarContainer,children:(0,ne.jsx)("img",{src:b,style:b===U.Z.images.notionLogoPng?l.madeByV2NotionAvatar:l.madeByV2Avatar})}),(0,ne.jsx)(Y.Z,{style:l.madeByV2Label,children:(0,ne.jsx)(c.FormattedMessage,{id:"templateDetail.madeBy.label.v2",defaultMessage:"By {author}",values:{author:S}})})]}):null;return(0,ne.jsx)(ne.Fragment,{children:(0,ne.jsxs)("div",{style:l.container,children:[(0,ne.jsx)("div",{style:{height:"100%",overflowX:"hidden",overflowY:"auto",maskImage:"linear-gradient(black 80%, transparent 100%)",WebkitMaskImage:"linear-gradient(black 80%, transparent 100%)"},children:(0,ne.jsxs)("div",{style:{position:"relative"},children:[(0,ne.jsx)("div",{style:{marginTop:-20,opacity:1,zIndex:999,pointerEvents:"none"},children:I}),(0,ne.jsx)("div",{style:{backgroundColor:"transparent",position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:1e3}})]})}),(0,ne.jsxs)("div",{style:l.contentContainer,children:[(0,ne.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,ne.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:0},children:(0,ne.jsx)("div",{style:{display:"flex",flexDirection:"column",marginLeft:0},children:(0,ne.jsx)("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3,marginBottom:12},children:w})})}),(0,ne.jsx)("div",{children:B}),(0,ne.jsx)("div",{style:{fontSize:14},children:C})]}),(0,ne.jsx)("div",{style:l.getTemplateColumn,children:P?R:A})]})]})})}var oe=s(58573),ae=s(35840),re=s(50226),le=s(72126),de=s(73657),ce=s(52275),ue=s(61519),me=s(74194),pe=s(3386),ge=s(72495),he=s(18514),fe=s(14694);function xe(e){let{topCategoryId:t,categoryId:s}=e;window.__c={n:"TemplateGallerySidebarCategoryName"};const n=(0,c.useIntl)(),i=(0,a.yK)((e=>({sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"}})),[]),r=(0,o.VK)((()=>{const e=function(){var e;if(!t)return;const n=Z.oO(t);return n?null===(e=n.subcategories)||void 0===e?void 0:e.find((e=>e.id===s)):void 0}();if(e)return e.name;const i=_._5[s];return i?n.formatMessage(i):""}),[t,s,n]);return(0,ne.jsx)(fe.Z,{style:i.sidebarTitle,children:r})}var ye=s(83065);function Se(){window.__c={n:"TemplateGallerySidebarMoreFromCommunity"};const e=(0,i.O7)(),t=(0,a.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},icon:{width:14,height:14,marginLeft:6,transform:"rotate(45deg)"},linkContentV2Container:{display:"flex",flexDirection:"column",gap:4},linkContentV2Title:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:600,fontSize:14},linkContentV2Subtitle:{maxWidth:250,whiteSpace:"inherit",overflow:"inherit",fontWeight:400,fontSize:13}})),[]);return(0,ne.jsx)(Q.Z,{href:(0,he.UY)("templateGallery"),onClick:()=>m.T2(e),style:{display:"flex",flexDirection:"row",alignItems:"center"},external:!0,children:(0,ne.jsxs)("div",{style:t.linkContentV2Container,children:[(0,ne.jsxs)(Y.Z,{isInline:!1,style:t.linkContentV2Title,children:[(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"More templates",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.labe2"}),(0,ye._)(t.icon)]}),(0,ne.jsx)(Y.Z,{isInline:!1,isSecondaryColor:!0,style:t.linkContentV2Subtitle,children:(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"Discover thousands of templates made by Notion users like you",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.reason2"})})]})})}var ve=s(8848),be=s(42853),Me=s(98519),je=s(82990),we=s(51077),Ce=s(78140),ke=s(32163),Te=s(89728),Ie=s(87279),Pe=s(98742);function Ze(e){let{}=e;window.__c={n:"TemplateGalleryTopCategoryFilter"};const t=(0,a.yK)((e=>({newInAppGalleryTopCategoryFilterBarContainer:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginBottom:8},newInAppGalleryTopCategoryFilterButton:{display:"flex",alignItems:"center",justifyContent:"space-between",color:e.mediumTextColor,padding:"8px 12px",borderRadius:4,marginRight:0,fontSize:je.Z.fontSize.UIRegular.desktop,background:e.inputBackground},newInAppGalleryTopCategoryFilterChevronIcon:{width:15,height:15,fill:e.mediumIconColor}})),[]),{selectedTopCategory:s}=(0,o.VK)((()=>V.Z.state),[]),n=(0,o.VK)((()=>P.Z.getTopTemplateCategories()),[]),i=(0,o.VK)((()=>s?Z.oO(s):void 0),[s]),r=(0,o.VK)((()=>(null==n?void 0:n.length)>0),[n]);return r?(0,ne.jsx)("div",{style:t.newInAppGalleryTopCategoryFilterBarContainer,children:(0,ne.jsx)(q.ZP,{popupType:q.Z4.Popup,alignmentToOrigin:q.vR.End,placementToOrigin:q.pO.Bottom,sameWidthAsOrigin:!0,render:e=>(0,ne.jsx)(Ce.Z,{menuType:Ie.og.Popup,children:(0,ne.jsx)(ke.Z,{type:ke.i.Vertical,initialFocus:void 0,sections:[{key:"top-category",items:n.map((e=>({key:e.id,action:()=>{if(!r)return;const t=N(e);V.Z.setState({...V.Z.state,selectedTopCategory:e.id,allTemplates:t,limitResults:Z.JL(t)})},render:t=>(0,ne.jsx)(ce.Z,{...t,title:(0,ne.jsx)(Fe,{category:e,showSelected:e.id===s})})}))),render:e=>(0,ne.jsx)(ge.Z,{...e})}],onAccept:()=>e.close()})}),renderOrigin:e=>(0,ne.jsxs)(Te.Z,{...(0,Pe.Z)(e,{onClick:()=>{}}),style:t.newInAppGalleryTopCategoryFilterButton,children:[(0,ne.jsx)(Fe,{category:i}),(0,be.i)(t.newInAppGalleryTopCategoryFilterChevronIcon)]})})}):null}function Fe(e){let{category:t,showSelected:s=!1}=e;window.__c={n:"TemplateGalleryTopCategoryWithIcon"};const n=(0,a.yK)((e=>({selectedIconStyle:{width:14,height:14,fill:ve.ZP.defaultText},categorySelection:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,lineHeight:"20px"},categoryButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}})),[]);return t?(0,ne.jsxs)("span",{style:n.categoryButtonContainer,children:[(0,ne.jsxs)("span",{style:n.categorySelection,children:[(0,ne.jsx)(we.Z,{type:"notion_icon",size:20,icon:t.icon.name,isLoading:!1,progressPercent:void 0,largeIcon:!0}),(0,ne.jsx)("span",{children:t.name})]}),s&&(0,ne.jsx)("span",{children:(0,Me.k)(n.selectedIconStyle)})]}):null}const _e=(0,c.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.allTemplates",defaultMessage:"All templates"},noResults:{id:"templateGallery.sidebar.results",defaultMessage:"No results"}});function Ae(){window.__c={n:"TemplateGallerySidebar"};const[e,t]=(0,n.useState)(""),s=(0,c.useIntl)(),r=(0,i.O7)(),{selectedCategory:l,status:d}=(0,o.VK)((()=>V.Z.state),[]),[u,p]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(!u){const t=V.Z.state.selectedTemplate;var e;if(t)null===(e=document)||void 0===e||null===(e=e.getElementById(`tg-${"uri"in t?v.presetUriToHumanReadableName[t.uri]:t.template.name}`))||void 0===e||e.scrollIntoView({block:"center"}),p(!0)}}),[u]),(0,n.useEffect)((()=>{"closed"===d&&p(!1)}),[p,d]);const g=(0,a.yK)((e=>({sidebar:{height:"100%",width:F.dm,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},sidebarMoreFromCommunityContainer:{padding:12,borderTop:`1px solid ${e.accentColors.translucentGray[200]}`},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},filterBar:{display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6},newInAppGalleryBrandContainer:{display:"flex",alignItems:"center",width:"100%",gap:6,marginBottom:10},newInAppGalleryBrandName:{fontSize:15,fontWeight:600,color:e.regularTextColor},newInAppGalleryBrandIcon:{width:18,height:15,fill:e.regularTextColor},newInAppGallerySearchBarContainer:{padding:"0px 12px"}})),[]),h=(0,n.useMemo)((()=>(0,ne.jsx)(pe.Z,{capture:!0,onBackspace:le.yR,onLeft:le.yR,onRight:le.yR,onSelectAll:le.yR,onRedo:le.yR,onUndo:le.yR,onCut:le.yR,onCopy:le.yR,onPaste:le.yR,onKeypress:le.yR,onDelete:le.yR,onTab:le.yR,children:(0,ne.jsx)(me.Z,{placeholder:s.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:(0,ae.R)(g.searchIcon),showClearButton:!0,format:me.B.Small,value:e,style:g.searchBar,onChange:e=>t(e.target.value)})})),[e,s,g.searchBar,g.searchIcon]);return(0,ne.jsxs)("div",{style:g.sidebar,children:[(0,ne.jsxs)("div",{style:g.header,children:[(0,ne.jsxs)(Q.Z,{href:(0,he.UY)("templateGallery"),onClick:()=>m.Ib(r),style:g.newInAppGalleryBrandContainer,external:!0,children:[(0,re.I)(g.newInAppGalleryBrandIcon),(0,ne.jsx)("span",{style:g.newInAppGalleryBrandName,children:(0,ne.jsx)(c.FormattedMessage,{id:"templateGallery.brand.title",defaultMessage:"Templates"})})]}),(0,ne.jsx)(Ze,{})]}),(0,ne.jsx)("div",{style:g.newInAppGallerySearchBarContainer,children:h}),(0,ne.jsx)(Re,{currentQuery:e,selectedCategory:l}),(0,ne.jsxs)("div",{children:[(0,ne.jsx)(ue.Z,{size:"0"}),(0,ne.jsx)("div",{style:g.sidebarMoreFromCommunityContainer,children:(0,ne.jsx)(Se,{})})]})]})}function Re(e){window.__c={n:"TemplateGallerySidebarItemList"};const{currentQuery:t,selectedCategory:s}=e,i=""!==t||void 0!==s,{allTemplates:r,selectedTopCategory:l,status:d,limitResults:u}=(0,o.VK)((()=>V.Z.state),[]),m=(0,a.yK)((e=>({button:{height:44,padding:"8px 0",borderRadius:4,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},categoryDiv:{marginBottom:i?0:14},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.buttonHoveredBackground,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:4,background:e.buttonHoveredBackground},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12},sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"},sidebarShowMore:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"2px 2px 0 6px"}})),[i]),p=(0,o.VK)((()=>{if("open"!==d||void 0===r)return[];const e=new Set;return Object.fromEntries(Object.entries(r).filter((e=>{let[t]=e;return void 0===s||t===s})).map((s=>{let[n,i]=s;return[n,(0,oe.ZP)(t.replaceAll("-",""),i,(e=>`${e.name}`.replaceAll("-",""))).filter((t=>{const s=e.has(t.name);return e.add(t.name),!s}))]})))}),[d,r,s,t]),g=(0,n.useCallback)((e=>{"open"===d&&void 0!==u&&V.Z.setState({...V.Z.state,limitResults:{...u,[e]:!1}})}),[u,d]);return"open"!==d?null:(0,ne.jsx)("div",{style:{flexGrow:1,width:"100%",overflowX:"hidden",overflowY:"auto"},children:(0,ne.jsxs)(ge.Z,{desktopTitleStyle:{paddingLeft:8},children:[Object.entries(p).map((e=>{let[t,s]=e;if(0===s.length)return;const n=(null==u?void 0:u[t])&&!i&&s.length>k.IJ+1,o=n?s.length-k.IJ:0,a=n?s.slice(0,k.IJ):s;return(0,ne.jsxs)("div",{style:m.categoryDiv,children:[!i&&(0,ne.jsx)(xe,{topCategoryId:l,categoryId:t}),a.map((e=>"uri"in e?(0,ne.jsx)(De,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri}},e.uri):(0,ne.jsx)(De,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e}},e.id))),n&&o>0?(0,ne.jsx)(ce.Z,{style:m.sidebarShowMore,focused:!1,onClick:()=>g(t),title:(0,ne.jsx)(c.FormattedMessage,{defaultMessage:"{numNotShown} more...",id:"templateGallerySidebar.category.showMore",values:{numNotShown:o}})}):void 0]},t)})),0===Object.values(p).flatMap((e=>e)).length&&(0,ne.jsx)(de.Z,{caption:B.default.formatMessage(_e.noResults),style:{lineHeight:"14px",padding:6,margin:0}})]})})}function De(e){var t;window.__c={n:"TemplateGallerySidebarItem"};const s=(0,i.O7)(),r=(0,a.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},itemText:{marginLeft:5},unSelectedItemText:{color:e.mediumTextColor},selectedItemText:{color:e.regularTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500},hoveredItem:{background:e.buttonHoveredBackground},presetIcon:{width:16,height:16,fontSize:16,color:e.regularEmojiColor},presetTitle:{fontSize:14},presetDescription:{fontSize:12}})),[]),{status:l,selectedTemplate:d,analyticsFrom:c}=(0,o.VK)((()=>V.Z.state),[]),u=(0,o.VK)((()=>"open"===l&&le.Xy(d,e.template)),[l,e.template,d]),p=(0,n.useCallback)((()=>{const t="uri"in e.template?v.presetUriToHumanReadableName[e.template.uri]:e.template.template.previewRootId,n=(0,k.W4)({templateGalleryItem:t});f.c4({environment:s,url:n}),m.n1(s,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name,page_prepopulated_template_id:t,from:c})}),[c,s,e.template]);if("open"!==l)return null;const g=null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?(0,ne.jsx)("img",{src:e.icon,style:r.presetIcon}):(0,ne.jsx)("div",{style:r.presetIcon,children:(0,ne.jsx)(G.Z,{children:e.emoji??e.icon??""})}),h=`tg-${"uri"in e.template?v.presetUriToHumanReadableName[e.template.uri]:e.template.template.name}`;return(0,ne.jsx)(ce.Z,{id:h,desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...r.button,...u?r.selectedItem:void 0},textWrapperStyle:{...u?r.selectedItemText:r.unSelectedItemText,...r.itemText},focused:!1,icon:g,title:(0,ne.jsx)("span",{style:r.presetTitle,children:e.name}),shouldWrapCaption:!0,hoveredStyle:r.hoveredItem,onClick:p})}const Be=["companyHome","defaultWiki","engineeringWiki","salesWiki","teamWiki"];function Le(){window.__c={n:"TemplateGalleryModal"};const e=(0,i.Fy)(),t=(0,i.O7)(),s=(0,c.useIntl)(),d=(0,n.useRef)(void 0),_=(0,a.yK)((t=>({modal:{width:e.isMobile?"auto":`${F.E2}vw`,height:e.isMobile?"auto":`${F.YQ}vh`,borderRadius:8}})),[e.isMobile]),A=(0,o.VK)((()=>T.default.state.currentSpaceStore),[]),{templateGalleryItem:R}=(0,o.VK)((()=>t.RouterStore.state.route),[t.RouterStore]),{status:D,allTemplates:B,selectedTemplate:L,cloneTo:E,limitResults:N}=(0,o.VK)((()=>V.Z.state),[]);(0,n.useEffect)((()=>{if(R)return d.current=window.setTimeout((()=>{V.Z.setState({...V.Z.state,status:"closed"})}),1e4),()=>{void 0!==d.current&&window.clearTimeout(d.current)}}),[]);const U=(0,n.useRef)(void 0);(0,n.useEffect)((()=>{U.current&&(U.current=void 0)}),[null==A?void 0:A.id]),(0,n.useEffect)((()=>{var e;U.current&&"opening"!==D||"closed"!==D&&(U.current||(U.current=async function(e){const{environment:t,spaceId:s}=e,n=await p.getInAppCategoriesAndTemplates(t,{spaceId:s});return"success"===n.type&&(P.Z.setState({data:n.data}),"current"===n.data.version)}({environment:t,spaceId:null==A?void 0:A.id})),null===(e=U.current)||void 0===e||e.then((()=>{var e,t;const s=R&&Z.vY(R),{selectedTopCategory:n,allTemplates:i}=O({userPersona:null===(e=T.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.persona,subscriptionTier:null===(t=T.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier(),selectedTopCategory:s});V.Z.setState({...V.Z.state,selectedTopCategory:n,allTemplates:i,limitResults:Z.JL(i)})})).finally((()=>{void 0!==d.current&&window.clearTimeout(d.current)})))}),[t,null==A?void 0:A.id,U,D,R]),(0,n.useEffect)((()=>{if(void 0!==B&&"opening"===D){const e=void 0!==L&&(void 0===R||"gallery"===R)?L:Oe({templateGalleryItem:R,allTemplates:B});return V.Z.setState({...V.Z.state,status:"open",allTemplates:B,selectedTemplate:e,limitResults:N??Z.JL(B),cloneTo:V.Z.state.cloneTo,analyticsFrom:V.Z.state.analyticsFrom}),void m.jW(t,{template_name:"preset"===e.type?e.uri:e.template.name,template_id:(0,k.gA)(e),from:V.Z.state.analyticsFrom})}}),[R,t,B,D,L,E,N]),(0,n.useEffect)((()=>{"open"===D&&void 0!==B&&void 0!==R&&"gallery"!==R&&V.Z.setState({...V.Z.state,selectedTemplate:Oe({templateGalleryItem:R,allTemplates:B})})}),[B,D,R]);const W=(0,o.VK)((()=>{const e=(0,w.np)();if("open"===D&&"current_page"===E&&e&&e.isEmptyPage())return e}),[E,D]),K=(0,n.useCallback)((async(e,s)=>{var n,i,o;V.Z.setState({...V.Z.state,status:"closed",selectedTemplate:void 0});const{currentSpaceStore:a,currentSpaceViewStore:d}=T.default.state,c=null==W||!W.getParentStore()||"block"!==(null===(n=W.getParentStore())||void 0===n?void 0:n.table)&&"space"!==(null===(i=W.getParentStore())||void 0===i?void 0:i.table)&&"team"!==(null===(o=W.getParentStore())||void 0===o?void 0:o.table)?s||a:W.getParentStore(),f=Date.now();let j;if("preset"===e.type&&(0,l.SA)(e.uri)){var w;const n=e.uri,i=null===(w=(0,M.iX)((0,v.appConfigs)(),n))||void 0===w?void 0:w.uri;if(!(i&&a&&d&&c))return;const o=s||C.VP(c);if(o){if(!(await async function(e){let{environment:t,spaceId:s,presetUri:n,teamStore:i}=e;return await(0,I.l)({environment:t,spaceId:s,presetUri:n,parentStore:i,teamId:i.id,from:"template_gallery"})}({environment:t,spaceId:a.id,presetUri:n,teamStore:o})))return}const r=W||(s?s.getTeamPagesStores().find((e=>e.getFormat().app_config_uri&&e.getFormat().app_config_uri===i)):void 0);x.createAndCommit({environment:t,userAction:"templateGallery.getTemplate",perform:e=>{const s=(0,v.appConfigs)().find((e=>e.uri===i)),o=null==s?void 0:s.presets.find((e=>e.uri===n));if(d&&o){const s=y.initializeApp({environment:t,spaceViewStore:d,appUri:i,presetUri:o.uri,appParentStore:c,temporaryContainerBlockStore:r,transaction:e,from:"template_gallery"});y.markTasksDatabaseTemplateIfNeeded(s),S.createSprintPage({environment:t,spaceViewStore:d,appParentStore:c,transaction:e,blockStores:s,creationEntryPoint:{type:"preset",presetUri:o.uri}})}}}),p.finalizeAppTemplate(t,{})}else{const n="preset"===e.type?(0,b.CQ)(e.uri):e.template;if(!n)return;if(!a||!d)return;const i={environment:t,item:n,spaceStore:a,spaceViewStore:d,useMinimalTemplates:!1,from:"template_gallery"},o=W?await g.rC({...i,isPrivate:!1,initializeStore:W,type:"inExistingStore"}):s?await g.rC({...i,isPrivate:!1,teamStore:s,type:"inTeam",appendOrPrepend:"append"}):await g.rC({...i,isPrivate:!0,type:"inSpace"});j=o,o&&h._({environment:t,store:o,pageVisitSource:r.tY.Create})}const k="preset"===e.type?e.uri:e.template.name,P=Date.now()-f,Z=W?!C.VP(W):!Boolean(s),F=Z||null==s?void 0:s.id,_=j?j.id:null==W?void 0:W.id;m.en(t,{template_name:k,destination:Z?"private":"team",template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:P,team_id:F,created_page_id:_}),u.W2j(t,{type:"page",from:"template_gallery",new_page_id:_,creating_block_id:_}),"preset"===e.type&&(0,l.SA)(e.uri)&&j&&m.bR(t,{preset_uri:e.uri,created_block_stores:[j],from:"template_gallery",destination_team_id:F}),"pageTemplate"===e.type&&Ne(e.template.id)&&j&&m.Jw(t,{from:"template_gallery",wiki_block_id:j.id,destination_team_id:F,wiki_template_id:e.template.id})}),[t,W]),z=(0,n.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=T.default.state,{RouterStore:s}=t,n=s.state.route;if(e&&"page"===n.name){const e=(0,k.p8)();f.c4({environment:t,url:e})}}),[t]);return(0,ne.jsx)(j.Z,{ariaLabel:s.formatMessage({id:"templateGallery.dialogLabel",defaultMessage:"Templates"}),open:"open"===D,innerStyle:_.modal,onDismiss:z,render:()=>"open"!==D?null:(0,ne.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,ne.jsx)(Ae,{}),(0,ne.jsx)(ie,{onAcceptTemplate:K})]})})}function Oe(e){let{templateGalleryItem:t,allTemplates:s}=e;if(!t||"gallery"===t){var n;return"team"===(null===(n=T.default.state.currentSpaceStore)||void 0===n?void 0:n.getPlanType())?{type:"preset",uri:l.Yb}:Ee(s)}const i=Object.values(s).flatMap((e=>e)).find((e=>"uri"in e?v.presetUriToHumanReadableName[e.uri]===t:e.previewRootId===t));return i?"uri"in i?{type:"preset",uri:i.uri}:{type:"pageTemplate",template:i}:Ee(s)}function Ee(e){const t=e[Object.keys(e)[0]][0];return"uri"in t?{type:"preset",uri:t.uri}:{type:"pageTemplate",template:t}}function Ne(e){return Be.some((t=>d.Y[t].nameMessage.id===e))}},47054:(e,t,s)=>{s.d(t,{AD:()=>l});s(57658);var n=s(30120),i=s(59730),o=s(63143);function a(e){if(void 0===e)return n.ou.utc();const t={zone:"utc"};return"number"==typeof e?n.ou.fromMillis(e,t):n.ou.fromISO(e,t)}function r(e,t){const s=t?a(t):n.ou.utc(),o=a(e??function(e){const{days:t,endDate:s,startDate:o}=e;if(t<=0)throw new i.p8("Days must be greater than 0");const r=s?a(s):n.ou.utc();if(!r.isValid)throw new i.p8(`endDate ${s} is in an invalid format`);const l=o?a(o).toMillis():0,d=r.minus({days:t-1}).toMillis();return Math.max(d,l)}({days:7,endDate:t}));if(!o.isValid)throw new i.p8(`startDate ${e} is in an invalid format`);if(!s.isValid)throw new i.p8(`endDate ${t} is in an invalid format`);if(o>s)throw new i.p8(`startDate ${e} => ${o.toISO()} is after endDate ${t} => ${s.toISO()}`);return{startTimestamp:o.toMillis(),endTimestamp:s.toMillis()}}function l(e,t){const{startTimestamp:s,endTimestamp:n}=r(e,t),i=[];for(var l=s;l<=n;)i.push(a(l).toISODate()),l+=o.A0;return i}},39248:(e,t,s)=>{s.d(t,{E:()=>r});var n=s(4615),i=s(89101),o=s(64002);function a(e,t){const s=t.trim().toLowerCase(),n=(0,o.Of)(s).replace(/\./g,"-");return n?`${n}-${e}`:e}function r(e,t){if(!(0,n.e)(e))return`${i._j.integrations}/${e}`;const s=a(e,void 0===t?"":t);return`${i._j.integrations}/${s}`}},57222:(e,t,s)=>{s.d(t,{t:()=>n});const n=e=>({"en-US":{label:"English",caption:e.formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"Deutsch",caption:e.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE"})},"ko-KR":{label:"한국어",caption:e.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:e.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:e.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:e.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:e.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:e.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:e.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:e.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})},"da-DK":{label:"Dansk",caption:e.formatMessage({defaultMessage:"Danish",id:"languagePicker.captions.danishDk"})},"fi-FI":{label:"Suomi",caption:e.formatMessage({defaultMessage:"Finnish",id:"languagePicker.captions.finnishFi"})},"nb-NO":{label:"Norsk",caption:e.formatMessage({defaultMessage:"Norwegian",id:"languagePicker.captions.norwegianNo"})},"nl-NL":{label:"Nederlands",caption:e.formatMessage({defaultMessage:"Dutch",id:"languagePicker.captions.dutchNl"})},"sv-SE":{label:"Svenska",caption:e.formatMessage({defaultMessage:"Swedish",id:"languagePicker.captions.swedishSe"})},pseudo:{label:"🤡Pseudolocale🤡",caption:e.formatMessage({defaultMessage:"Pseudolocale",id:"languagePicker.captions.pseudolocale"})}})}}]);