"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1536],{61652:(e,t,s)=>{s.d(t,{y1:()=>ne,BO:()=>ie,Qr:()=>re,gJ:()=>ge,PN:()=>de,ZO:()=>H,hN:()=>me,g:()=>pe,Mj:()=>te,$G:()=>J,AW:()=>K,Tp:()=>ue,zh:()=>he,GI:()=>le,q$:()=>Q});s(67294);var n=s(68626),i=s(42875),r=s(59730),o=s(15157),a=s(72126),l=s(29477),d=s(21202),p=s(19889),c=s(9291),u=s(27617),m=s(86628),g=s(24405),h=s(82990),x=s(19306),f=s(61519),v=s(68785),M=s(85893);const y={fontWeight:h.Z.fontWeight.semibold};const b=function(e){let{exportProgressStore:t,disabledExportTeamNames:s}=e;window.__c={n:"ExportProgress"};const{messageStyle:n,spinnerContainerStyle:i}=(0,g.yK)((e=>({messageStyle:{fontSize:14,color:e.mediumTextColor,textAlign:"center"},spinnerContainerStyle:{marginTop:24,marginBottom:24,display:"flex",justifyContent:"center"}})),[]);return(0,M.jsxs)("div",{style:n,children:[(0,M.jsx)("div",{style:i,children:(0,M.jsx)(v.Z,{})}),(0,M.jsx)(C,{exportProgressStore:t}),(0,M.jsx)(T,{exportProgressStore:t}),(0,M.jsx)(S,{disabledExportTeamNames:s})]})};function S(e){let{disabledExportTeamNames:t}=e;return t.length>0?(0,M.jsxs)("span",{children:[(0,M.jsx)(f.Z,{size:10}),(0,M.jsx)("p",{children:(0,M.jsx)(c.FormattedMessage,{id:"exportActions.exportDisabledTeams.message",defaultMessage:"Export is disabled for the following teamspaces: <b>{teamNames}</b>",values:{teamNames:(0,x.W)(t),b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,M.jsx)("span",{style:y,children:t})}}})})]}):null}function T(e){let{exportProgressStore:t}=e;window.__c={n:"Email"};const{targetEmailAddress:s}=(0,m.VK)((()=>t.state),[t]);return s?(0,M.jsx)("p",{children:(0,M.jsx)(c.FormattedMessage,{id:"exportProgressDialog.emailMessage",defaultMessage:"We'll also send you an email with the download link."})}):null}function C(e){let{exportProgressStore:t}=e;window.__c={n:"Progress"};const s=(0,m.VK)((()=>t.state.pagesExported),[t]);return s>0?(0,M.jsx)("p",{children:(0,M.jsx)(c.FormattedMessage,{id:"exportProgressDialog.exportedPagesMessage",defaultMessage:"{pagesExported, plural, one {{pagesExported} page exported} other {{pagesExported} pages exported}}",values:{pagesExported:s}})}):(0,M.jsx)("p",{children:(0,M.jsx)(c.FormattedMessage,{id:"exportProgressDialog.exportStartedMessage",defaultMessage:"Exportingâ€¦"})})}var w=s(19037),_=s(33954),j=s(33929),I=s(37034),k=s(25976),Z=s(80444),O=s(77556),P=s(71071),F=s(49085);class E extends F.default{getInitialState(){return{pagesExported:0}}}const R=E;var A=s(26136),B=s(20454),L=s(88893),V=s(50906),z=s(91536),D=s(54642),N=s(47307),U=s(99813),W=s(92625);const q=(0,c.defineMessages)({exporting:{id:"exportActions.exporting.loadingMessage",defaultMessage:"Exporting"},exportAuditLogEmail:{id:"exportActions.auditLog.exporting.EmailMessage",defaultMessage:"Your CSV export is currently being generated. The generated CSV has a 2-hour delay from the real time audit log. Once it is ready, an email will be sent to you with the download link."},exportCSVEmail:{id:"exportActions.exportingCSV.EmailMessage",defaultMessage:"Your CSV export is currently being generated. Once it is ready, an email will be sent to you with the download link."},exportFailed:{id:"exportActions.exportFailedError.message",defaultMessage:"Export failed."},adminMessage:{defaultMessage:"Admin",id:"export.userPermissionsRole.admin.message"},workspaceOwnerMessage:{defaultMessage:"Workspace owner",id:"export.userPermissionsRole.workspaceOwner.message"},memberMessage:{defaultMessage:"Member",id:"export.userPermissionsRole.member.message"},membershipAdminMessage:{defaultMessage:"Membership admin",id:"export.userPermissionsRole.membershipAdmin.message"},guestMessage:{defaultMessage:"Guest",id:"export.userPermissionsRole.guest.message"},idMessage:{defaultMessage:"ID",id:"export.csvHeader.id"},emailMessage:{defaultMessage:"Email",id:"export.csvHeader.email"},nameMessage:{defaultMessage:"Name",id:"export.csvHeader.name"},roleMessage:{defaultMessage:"Role",id:"export.csvHeader.role"},permissionGroupsMessage:{defaultMessage:"Permission groups",id:"export.csvHeader.permissionGroups"},pagesMessage:{defaultMessage:"Pages",id:"export.csvHeader.pages"},partitionMessage:{defaultMessage:"Export is still in progress due to file size. We will send you an email about its progress.",id:"export.exportPartitioned.message"},privatePageMessage:{defaultMessage:"Private page",id:"export.privatePageTitle.message"},pageTitleAndIdMessage:{defaultMessage:"{pageTitle} ({pageId})",id:"export.pageTitleAndId.message"},pageSeparatorMessage:{defaultMessage:", ",id:"export.pageSeparator.message"}});async function H(e,t){if(!se({environment:e,...t}))return void V.y4(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});const{currentUserStore:s}=Z.default.state;if(!s)return void V.y4(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});const n=s.getEmail();if(!n)return void V.y4(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive});V.Md8(e,{target:"block",format:t.exportOptions.exportType,recursive:t.recursive}),"currentView"===t.exportOptions.collectionViewExportType&&(t.exportOptions.preferredViewMap=G(s.id));const i=D.exportBlock(e,t);await $(e,i,t.recursive,n)}async function K(e,t){if(!se({environment:e,recursive:!0,exportOptions:t.exportOptions}))return void V.y4(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});const{currentUserStore:s}=Z.default.state;if(!s)return void V.y4(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});const n=s.getEmail();if(!n)return void V.y4(e,{target:"space",format:t.exportOptions.exportType,recursive:!0});V.Md8(e,{target:"space",format:t.exportOptions.exportType,recursive:!0}),"currentView"===t.exportOptions.collectionViewExportType&&(t.exportOptions.preferredViewMap=G(s.id));const i=D.exportSpace(e,t);await $(e,i,!0,n)}async function $(e,t,s,n){const{currentSpaceViewStore:i,currentSpaceStore:r}=Z.default.state;if(!i)return;const o=new R;o.setState({pagesExported:0,targetEmailAddress:n});let a,d=!1;const p=i.getTeamsStores().filter((e=>e.getSetting("disable_export"))).flatMap((e=>e.getName()||[]));if(s){const t=p.length>0?6e3:1250;a=(0,l.Vs)(t);const s={exportProgressStore:o,disabledExportTeamNames:p};N.showDialog({message:(0,M.jsx)(b,{...s}),showCancel:!1,keepFocus:!0,disableBackgroundDismiss:!0,items:[{label:(0,M.jsx)(c.FormattedMessage,{id:"exportProgressDialog.closeButton.label",defaultMessage:"Close"}),onAccept:()=>{he({environment:e,spaceId:null==r?void 0:r.id}),d=!0}}]})}else a=Promise.resolve(),W.j({message:q.exporting});for await(const l of t){if(d)return;if(l.error)return W.x(),void N.showErrorMessage(j.default.formatMessage(q.exportFailed));{const{value:t}=l;if("complete"===t.type||"partition"===t.type)return await a,W.x(),void("complete"===t.type?(N.dismissDialog(),!d&&t.exportURL&&U.oi(e,t.exportURL)):N.showMessage({message:j.default.formatMessage(q.partitionMessage)}));o.setState({...o.state,pagesExported:t.pagesExported})}}}function G(e){const t={};return o.Z.scan(((s,n)=>{if(s.includes(O.Z.PREFERENCE_KEY_PREFIX)&&s.includes(e)){const e=s.split(O.Z.PREFERENCE_KEY_PREFIX)[1];e&&n&&(t[e]=n)}})),t}function Q(e){const{root:t,environment:s,isCollectionViewExportTypeSupported:n}=e,r=s.currentUser.id,o=ae(r),a=o&&o.exportType||"markdown",l=n?"currentView":void 0,d="pdf"===a?{exportType:"pdf",timeZone:(0,i.r)(),pdfFormat:le(r),locale:"en",collectionViewExportType:l}:{exportType:a,timeZone:(0,i.r)(),locale:"en",collectionViewExportType:l};ie(s,{open:!0,root:t,recursive:"space"===t.table,exportOptions:d,shouldExportComments:!1})}const Y=(e,t)=>{switch(t){case"editor":return e.formatMessage(q.workspaceOwnerMessage);case"membership_admin":return e.formatMessage(q.membershipAdminMessage);case"read_and_write":return e.formatMessage(q.memberMessage);case"none":return e.formatMessage(q.guestMessage);default:return n.log({level:"error",from:"exportActions",type:"roleNotFound",data:{miscDataToConvertToString:{role:t}}}),""}};async function J(e,t){const{spaceStore:s,subscriptionData:n,intl:i}=t,r=s.getPermissionGroups();await D.exportSpaceMembers(e,{spaceId:s.getSpaceId()});const o=a.oA(await Promise.all(n.users.map((async e=>{const t=B.U.createChildStore(s,{table:p.KJ,id:e.userId});await t.load();const n=t.getEmail(),o=t.getFullName(i),l=a.oA(r.filter((t=>(t.user_ids||[]).includes(e.userId))).map((e=>e.name)).sort());if(n||o)return[n||"",o||"",Y(i,e.role),l.join(","),t.id]}))));X(ee([[q.emailMessage,q.nameMessage,q.roleMessage,q.permissionGroupsMessage,q.idMessage].map((e=>i.formatMessage(e))),...o]),"members.csv")}function X(e,t){const s=document.createElement("a");s.setAttribute("href",`data:text/csv;charset=utf-8,${encodeURIComponent(e)}`),s.setAttribute("download",t),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)}function ee(e){return e.map((e=>e.map((e=>((e=e.replace(/"/g,'""')).search(/("|,|\n)/g)>=0&&(e=`"${e}"`),e))).join(","))).join("\n")}async function te(e,t){let{guests:s,intl:n,spaceStore:i}=t;await D.exportSpaceGuests(e,{spaceId:i.getSpaceId()});const r=n.formatMessage(q.pageSeparatorMessage),o=a.oA(await Promise.all(s.map((async t=>{const s=B.U.createChildStore(i,{table:p.KJ,id:t.userId});async function o(t){const s=A.G.createChildStore(i.getPagesStore(),{table:d.iU,id:t});return await s.load(),(0,I.V)(s,n,e,!1)??n.formatMessage(q.privatePageMessage)}const[,...a]=await Promise.all([s.load(),...t.guestPageIds.map((e=>async function(e){return n.formatMessage(q.pageTitleAndIdMessage,{pageId:e,pageTitle:await o(e)})}(e)))]),l=s.getEmail(),c=s.getFullName(n);if(l||c)return[l||"",c||"",a.join(r),s.id]})))),l=[[q.emailMessage,q.nameMessage,q.pagesMessage,q.idMessage].map((e=>n.formatMessage(e))),...o];X(ee(l),"guests.csv"),z.LA(e,{line_count:l.length})}function se(e){return!("pdf"===e.exportOptions.exportType&&e.recursive)||ne(e.environment)}function ne(e){return(0,L.qb)(e,"enterprise")||(0,L.qb)(e,"business")||w._T()}function ie(e,t){const s=P.ZP.state,n=e.currentUser.id;let i=t;if(P.Sw(i)&&!ne(e))if("space"===i.root.table){const e=s.open&&!P.Sw(s)?s.exportOptions.exportType:"html";i={...i,exportOptions:{...i.exportOptions,exportType:e}}}else i={...i,recursive:!1};if(!se({environment:e,...i}))throw new r.D3("Invalid export options",{data:i});P.ZP.setState(i),function(e){const t=P.ZP.state;if(t.open){const s={...ae(e),exportType:t.exportOptions.exportType};"pdf"===t.exportOptions.exportType&&(s.pdfFormat=t.exportOptions.pdfFormat),o.Z.set({userId:e,key:oe,value:s})}}(n)}function re(){P.ZP.setState({open:!1,shouldExportComments:!1})}const oe="ExportSettings";function ae(e){return o.Z.get({userId:e,key:oe})}function le(e){const t=ae(e);return t&&t.pdfFormat||P.jR()}async function de(e,t){const{currentUserStore:s}=Z.default.state,{spaceId:i}=t;if(!s)return n.log({level:"error",from:"exportActions",type:"exportAuditLogCSV-currentUserStoreNotFound",data:{miscDataToConvertToString:{spaceId:i}}}),N.showMessage({message:j.default.formatMessage(q.exportFailed)}),void V.y4(e,{target:"auditLog",format:"csv",recursive:!1});if(!s.isDefined())return n.log({level:"error",from:"exportActions",type:"exportAuditLogCSV-currentUserValueNotFound",data:{miscDataToConvertToString:{spaceId:i}}}),N.showMessage({message:j.default.formatMessage(q.exportFailed)}),void V.y4(e,{target:"auditLog",format:"csv",recursive:!1});V.Md8(e,{target:"auditLog",format:"csv",recursive:!1});const r=D.exportAuditLog(e,t);await ce(r,q.exportAuditLogEmail)}async function pe(e){const{environment:t,data:s}=e;V.Md8(t,{target:"domainClaimableSpaces",format:"csv",recursive:!1});const n=D.exportDomainClaimableSpaces(t,s);await ce(n,q.exportCSVEmail)}async function ce(e,t){const s=await e.next();if(s.value.error){const e=(0,_.HV)(j.default.getIntl(),s.value.error);N.showErrorMessage(e)}else N.showMessage({message:j.default.formatMessage(t)})}async function ue(e,t){V.Md8(e,{target:"userAnalytics",format:"csv",recursive:!1});const s=D.exportUserAnalytics(e,t);await ce(s,q.exportCSVEmail)}async function me(e,t){V.Md8(e,{target:"contentAnalytics",format:"csv",recursive:!1});const s=D.exportContentAnalytics(e,t);await ce(s,q.exportCSVEmail)}async function ge(e,t){V.Md8(e,{target:"adminContentSearchAnalytics",format:"csv",recursive:!1});const s=D.exportAdminContentSearch(e,{spaceId:t.spaceId,sort:{field:"relevance",direction:"desc"},query:t.filters.query,audience:t.filters.audience,lastEditedTime:(0,u.Hq)(t.filters.lastEditedTime),createdTime:(0,u.Hq)(t.filters.createdTime),createdBy:t.filters.createdBy,sharedWith:t.filters.sharedWith,teamspaceIds:t.filters.teamIds});await ce(s,q.exportCSVEmail)}async function he(e){let{environment:t,spaceId:s}=e;if(!s)return;const n=await D.getActiveExportTasks(t,{spaceId:s});"success"===n.type&&k.Z.setState({count:n.data.length})}},27617:(e,t,s)=>{s.d(t,{Hq:()=>g,Ij:()=>m,KN:()=>a,PM:()=>d,Qb:()=>c,Zy:()=>p,dd:()=>o,eW:()=>u,mK:()=>h,o0:()=>l});var n=s(7057),i=s(53877),r=s(42875);function o(e,t){return(0,n.ZW)(i.OQ.notionDateTimeToLuxon(e,t.locale),"short")}function a(e,t){return(0,n.ZW)(i.OQ.notionDateTimeToLuxon(e,t.locale),"time")}function l(e,t){return i.OQ.notionDateTimeToLuxon(e,t.locale).toFormat(i._F)}function d(e,t){let s={starting:void 0,ending:void 0};var n,i,o,a;if(t.starting&&t.ending)s={starting:{type:"datetime",start_time:"",start_date:t.starting.start_date,time_zone:""},ending:{type:"datetime",start_time:"",start_date:t.ending.start_date,time_zone:""}},null!==(n=e.starting)&&void 0!==n&&n.start_time&&null!==(i=e.starting)&&void 0!==i&&i.time_zone&&(s.starting={...s.starting,start_time:e.starting.start_time,time_zone:e.starting.time_zone}),null!==(o=e.ending)&&void 0!==o&&o.start_time&&null!==(a=e.ending)&&void 0!==a&&a.time_zone?s.ending={...s.ending,start_time:e.ending.start_time,time_zone:e.ending.time_zone}:s={starting:{...s.starting,start_time:"00:00",time_zone:(0,r.r)()},ending:{...s.ending,start_time:"23:59",time_zone:(0,r.r)()}};else if(t.starting){var l,d;s=null!==(l=e.starting)&&void 0!==l&&l.start_time&&null!==(d=e.starting)&&void 0!==d&&d.time_zone?{starting:{type:"datetime",start_date:t.starting.start_date,start_time:e.starting.start_time,time_zone:e.starting.time_zone},ending:e.ending}:{starting:{type:"datetime",start_date:t.starting.start_date,start_time:"00:00",time_zone:(0,r.r)()},ending:e.ending}}else if(t.ending){var p,c;s=null!==(p=e.ending)&&void 0!==p&&p.start_time&&null!==(c=e.ending)&&void 0!==c&&c.time_zone?{ending:{type:"datetime",start_date:t.ending.start_date,start_time:e.ending.start_time,time_zone:e.ending.time_zone},starting:e.starting}:{ending:{type:"datetime",start_date:t.ending.start_date,start_time:"23:59",time_zone:(0,r.r)()},starting:e.starting}}else s={starting:e.starting,ending:e.ending};return s}function p(e){return e.starting&&e.ending?{starting:{type:"date",start_date:e.starting.start_date},ending:{type:"date",start_date:e.ending.start_date}}:e.starting?{starting:{type:"date",start_date:e.starting.start_date}}:e.ending?{ending:{type:"date",start_date:e.ending.start_date}}:{}}function c(e){if(e)return{type:"date",start_date:e.start_date}}function u(e){return`${e.actorType}:${e.actorId}`}function m(e){const t=e.split(":");if(2===t.length)return"bot"===t[0]?{actorId:t[1],actorType:"bot"}:"notion_user"===t[0]?{actorId:t[1],actorType:"notion_user"}:void 0}function g(e){return{starting:e.starting?{type:"date",start_date:e.starting.start_date}:void 0,ending:e.ending?{type:"date",start_date:e.ending.start_date}:void 0}}function h(e){return void 0===e.starting&&void 0===e.ending}},86125:(e,t,s)=>{s.d(t,{Z:()=>o});s(67294);var n=s(9291),i=s(74136),r=s(85893);function o(e){return(0,r.jsx)(i.Z,{...e,children:"membership_admin"===e.role?(0,r.jsx)(n.FormattedMessage,{id:"spacePermissionsSettings.user.membershipAdmin",defaultMessage:"Membership admin"}):(0,r.jsx)(n.FormattedMessage,{id:"spacePermissionsSettings.user.workspaceOwner",defaultMessage:"Workspace owner"})})}},21752:(e,t,s)=>{s.d(t,{K:()=>x,Z:()=>f});s(67294);var n=s(86628),i=s(54368),r=s(77420),o=s(19889),a=s(97880),l=s(9291),d=s(86125),p=s(88198),c=s(70301),u=s(64369),m=s(45653),g=s(85893);function h(e){const{actorStore:t,avatar:s,isLarge:n}=e,l=n?32:28;return t?t.table===r.cZ?(0,g.jsx)(c.Z,{botStore:t,size:l}):t.table===o.KJ?(0,g.jsx)(m.Z,{userStore:t,size:l}):t.table===i.y?(0,g.jsx)(m.Z,{userStore:void 0,size:l}):void(0,a.t1)(t):s?(0,g.jsx)(m.Z,{avatar:s,size:l}):(0,g.jsx)(m.Z,{userStore:void 0,size:l})}function x(e){return"membership_admin"===e?"membership_admin":"editor"===e||"admin"===e?"admin":"none"===e||"guest"===e?"guest":"team_level_guest"===e?"team_level_guest":void("member"!==e&&"read_and_write"!==e&&"no_access"!==e&&"not_in_space"!==e&&e&&(0,a.t1)(e))}const f=function(e){window.__c={n:"CellMemberAvatar"};const t=(0,l.useIntl)(),{actorStore:s,avatar:i,containerStyle:r,id:o,spaceRole:a,avatarBadge:c,caption:m,isLarge:x}=e,f="admin"===a||"membership_admin"===a,v="guest"===a||"team_level_guest"===a,M=(0,n.VK)((()=>s?s.getDisplayName(t):null==i?void 0:i.name),[s,i,t]),y=(0,n.VK)((()=>Boolean(m)?m:s?s.getDetail():null==i?void 0:i.email),[m,s,i]);return(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:x?"unset":300,marginLeft:x?2:0,...r},children:[(0,g.jsxs)("div",{style:{position:"relative",...!x&&{height:28,width:28}},children:[(0,g.jsx)(h,{actorStore:s,avatar:i,isLarge:x}),c]}),(0,g.jsxs)("div",{style:{minWidth:0,marginLeft:x?10:6,marginRight:x?10:6},children:[(0,g.jsxs)("div",{id:o,style:{display:"flex",gap:4},children:[(0,g.jsx)(u.Z,{className:"notranslate",children:M}),f&&(0,g.jsx)(d.Z,{role:a}),v&&(0,g.jsx)(p.b,{labelType:a})]}),(0,g.jsx)(u.Z,{isSmall:!0,style:{display:"flex"},children:(0,g.jsx)(u.Z,{isSmall:!0,children:y})})]})]})}},33338:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var n=s(480),i=s(24405),r=s(42853),o=s(64921),a=s(85893);function l(e){window.__c={n:"CollectionViewFilterPill"};const{icon:t,title:s,on:l,hasDiff:p,wrapStyle:c,innerStyle:u,hideChevron:m}=e,g=(0,i.Fg)(),h=(0,n.O7)();return(0,a.jsxs)("div",{style:{borderRadius:14,marginRight:6,display:"inline-flex",...p&&{position:"relative"},...c},children:[(0,a.jsxs)(o.Z,{disabled:e.disabled,style:d(Boolean(l),g,u,h.device.isMobile),hoveredStyle:l?{background:g.outlineBlueButtonHoveredBackground}:void 0,pressedStyle:l?{background:g.outlineBlueButtonPressedBackground}:void 0,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,onDoubleClick:e.onDoubleClick,children:[t,s,!m&&(0,r.i)({width:10,marginLeft:4,marginTop:1,fill:l?g.blueColor:g.lightIconColor})]}),p&&(0,a.jsx)("div",{style:{position:"absolute",top:-2,right:-2,background:"dark"===g.mode?g.accentColors.orange[500]:g.accentColors.orange[300],border:`1px solid ${g.contentBackground}`,width:9,height:9,borderRadius:9}})]})}function d(e,t,s,n){return{fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderRadius:32,height:n?28:24,lineHeight:n?"28px":"24px",padding:"0 8px",border:`1px solid ${t.outlineButtonBorder}`,color:t.mediumTextColor,...e&&{color:t.blueColor,border:`1px solid ${t.filterPillBorder}`,background:t.filterPillBackground},...s}}},255:(e,t,s)=>{s.d(t,{Z:()=>a});s(67294);var n=s(480),i=s(53465),r=s(73063),o=s(85893);const a=function(e){window.__c={n:"MenuItemRemoveButton"};const t=(0,n.O7)(),s={removeFilterButton:{height:void 0,width:void 0},removeFilterButtonMobile:{marginRight:-12,marginTop:-12,marginBottom:-12,paddingRight:12,paddingTop:12,paddingBottom:12}},{onClick:a,disabled:l}=e,{device:d}=t,p=d.isMobile?{...s.removeFilterButton,...s.removeFilterButtonMobile}:s.removeFilterButton;return(0,o.jsx)(r.Z,{icon:i.X,onClick:a,disabled:l,disableBackground:!0,style:p})}},97680:(e,t,s)=>{s.d(t,{Z:()=>g});s(67294);var n=s(480),i=s(66897),r=s(97880),o=s(9291),a=s(98742),l=s(4023),d=s(52275),p=s(26388),c=s(70301),u=s(45653),m=s(85893);const g=function(e){window.__c={n:"UserMenuItem"};const{actor:t,userTitle:s,useEmailAsTooltip:g,tooltip:h,tooltipPlacement:x}=e,f=(0,n.O7)(),v=(0,o.useIntl)(),M=t.asActor&&t.isUser()?t.email:void 0,y=g&&M?M:h,b=f.device.isMobile?24:20;let S;return(0,i.YU)(t)?S=(0,m.jsx)(c.Z,{botValue:null==t?void 0:t.asActor,size:b}):(0,i.$S)(t)?S=(0,m.jsx)(u.Z,{userValue:null==t?void 0:t.asActor,size:b}):(0,i.Iq)(t)?S=(0,m.jsx)(u.Z,{userValue:void 0,size:b}):(0,r.t1)(t),(0,m.jsx)(p.ZP,{placement:x??l.u.Bottom,alignment:l.v.Start,textWrap:!0,render:n=>(0,m.jsx)(d.Z,{...(0,a.Z)(n,e),icon:S,title:s??(0,i.$4)(v,t),className:"notranslate"}),disableTooltip:!y,renderTooltip:()=>y})}},8319:(e,t,s)=>{s.d(t,{z:()=>z,Z:()=>N});var n=s(67294),i=s(83355),r=s(47453),o=s(72126),a=s(97880),l=s(9291),d=s(75024),p=s(49085);class c extends p.default{getInitialState(){return{isMenuOpen:!1,inputTemporaryValue:"",indexToReplace:void 0,popupOriginRect:void 0}}}const u=c;var m=s(33338),g=s(42922),h=s(52275),x=s(89728),f=s(53437),v=s(72495),M=s(75689),y=s(91642),b=s(480),S=s(68626),T=s(91155),C=s(23586),w=s(87279),_=s(29798),j=s(72087),I=s(78140),k=s(32163),Z=s(43765),O=s(40721),P=s(47082),F=s(85893);const E={input:{marginTop:8,marginLeft:8,marginRight:8,boxSizing:"border-box",width:"auto"},menu:{width:250,maxHeight:"40vh"},inputMenu:{maxHeight:"20vh"}};class R extends i.Z{constructor(){super(...arguments),this.storeTypes={requestStore:j.Z,menuListStore:_.Z},this.renderRequest=(e,t,s)=>{const{labelText:n,value:i}=this.props,{menuListStore:r}=this.stores,o=e=>(0,F.jsx)(v.Z,{...e,title:n.resultSectionTitle,loading:!s});if(e)return S.log({level:"error",from:n.componentDebugName,type:"requestFailed",error:(0,T.Ui)(e),data:{miscDataToConvertToString:{query:i}}}),(0,F.jsx)(o,{children:(0,F.jsx)(Z.Z,{title:(0,F.jsx)(l.FormattedMessage,{defaultMessage:"Something went wrong.",id:"search.inputMenu.errorMessage"})})});if(!t)return(0,F.jsx)(o,{children:(0,F.jsx)(Z.Z,{title:(0,F.jsx)(l.FormattedMessage,{defaultMessage:"Loadingâ€¦",id:"search.inputMenu.loading.message"})})});if(t&&0===t.length)return(0,F.jsx)(o,{children:(0,F.jsx)(Z.Z,{title:(0,F.jsx)(l.FormattedMessage,{defaultMessage:"No results found.",id:"search.inputMenu.noResults.message"})})});const a={key:"results",items:t.map((e=>{return t=e,s=this.props.renderResultMenuItem,n=this.props.onConfirm,{key:t,action:()=>n(t),render:e=>s(t,e)};var t,s,n})),render:o};return(0,F.jsx)(k.Z,{type:k.i.Vertical,store:r,initialFocus:0,sections:[a]})}}renderComponent(){const{value:e,items:t,performRequest:s}=this.props,{requestStore:n}=this.stores,i={query:e,current:t};return(0,F.jsx)(I.Z,{...V(this.environment,this.props.onDismiss,this.props.labelText,this.props.value,this.props.items,this.props.onChange,this.props.renderToken,this.props.onRemove,this.props.onClear,this.props.disabled),children:(0,F.jsx)(C.Z,{debounce:100,requestStore:n,request:i,performRequest:s,render:this.renderRequest})})}}R.displayName="SearchTokenInputMenu";const A=R;function B(e){const{device:t}=e;return t.isMobile}function L(e){let{labelText:t,value:s,items:n,disabled:i,onChange:r,renderToken:a,onRemove:l,onClear:d}=e;window.__c={n:"TokenInputComponent"};const p=(0,b.O7)(),c=n.map((e=>a(e,{onRemove:()=>l(e)})));return(0,F.jsx)(P.Z,{focus:!B(p)||void 0,focusAfterAnimation:!0,format:P.U.FilterValue,tokens:c,placeholder:t.tokenInputPlaceholder,onRemoveLastToken:()=>function(e,t){const s=o.Z$(e);s&&t(s)}(n,l),onClearButtonClick:d,value:s,onChange:r,showClearButton:!0,disabled:Boolean(i),style:E.inputMenu})}function V(e,t,s,n,i,r,o,a,l,d){if(B(e)){return{menuType:w.og.Modal,title:s.title,right:(0,F.jsx)(O.DoneMenuText,{}),onClickRight:t,header:(0,F.jsx)(L,{labelText:s,value:n,items:i,disabled:d,onChange:r,renderToken:o,onRemove:a,onClear:l})}}return{menuType:w.og.Popup,onClickOutside:t,header:(0,F.jsx)(L,{labelText:s,value:n,items:i,disabled:d,onChange:r,renderToken:o,onRemove:a,onClear:l}),...E.menu}}let z=function(e){return e.Button="Button",e.Section="Section",e.Pill="Pill",e}({});class D extends i.Z{constructor(){super(...arguments),this.animationFrame=void 0,this.origin=n.createRef(),this.storeTypes={componentStore:u},this.renderMobileFilterSummary=e=>{const{title:t,items:s,renderItemForSummary:i}=this.props,{disableFilters:r}=e,o=K(this.environment,this.props.mode),a={...d.mK,...o.summary},l=s.length-1,p=(0,F.jsx)("ul",{style:a,children:s.map(((e,t)=>(0,F.jsx)("li",{style:o.summaryItem,children:(0,F.jsxs)(n.Fragment,{children:[i(e),t!==l&&","," "]})},e)))});return(0,F.jsx)(M.Z,{disabled:r,onClick:this.handleMenuOpenMobile,onClickClear:()=>W(this.props.onChange),label:t,title:p})},this.renderMenu=()=>{const{renderToken:e,renderFooter:t,allowApplyBatchSelection:s}=this.props,{componentStore:{state:n}}=this.stores;return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(A,{...this.props,value:n.inputTemporaryValue,onChange:this.handleMenuInputChange,onDismiss:this.handleMenuClose,onConfirm:this.handleItemConfirm,onClear:()=>{this.handleClearTemporary(),W(this.props.onChange)},onRemove:e=>H(e,this.props.items,this.props.onChange),renderToken:e}),t&&(0,F.jsxs)(v.Z,{topBorder:!0,style:{padding:6,justifyContent:"space-between",display:"flex"},children:[(0,F.jsx)(x.Z,{onClick:()=>{W(this.props.onChange)},children:(0,F.jsx)(l.FormattedMessage,{id:"searchTokenFilter.clearButton",defaultMessage:"Clear"})}),s&&(0,F.jsx)(g.Z,{onClick:()=>{this.handleMenuClose("applyButton")},children:(0,F.jsx)(l.FormattedMessage,{id:"searchTokenFilter.applyButton",defaultMessage:"Apply"})})]})]})},this.handleMenuOpen=e=>{const{onMenuOpen:t}=this.props;t&&t(),this.scheduleMeasurement(void 0,(t=>({...t,isMenuOpen:!0,indexToReplace:e})))},this.handleMenuOpenMobile=()=>{const{componentStore:e}=this.stores;e.setState({...e.state,isMenuOpen:!0})},this.handleMenuClose=e=>{const{onMenuDismiss:t}=this.props,{componentStore:s}=this.stores;this.clearInput(),s.setState({...s.state,isMenuOpen:!1,indexToReplace:void 0}),t&&t(e)},this.handleClearTemporary=()=>{const{componentStore:e}=this.stores;e.setState({...e.state,inputTemporaryValue:""})},this.handleItemConfirm=e=>{const{items:t}=this.props,{componentStore:s}=this.stores,{indexToReplace:n}=s.state;"number"==typeof n&&n<t.length?function(e,t,s,n){const i=s.slice(0,e).concat(t,s.slice(e+1));n(i)}(n,e,this.props.items,this.props.onChange):t.includes(e)&&z.Pill?U(e,this.props.items,this.props.onChange):function(e,t,s){const n=t.concat(e);s(o.jj(n))}(e,this.props.items,this.props.onChange),this.props.keepInputOnItemConfirm||this.clearInput()},this.handleMenuInputChange=e=>{const{componentStore:t}=this.stores,{target:s}=e;t.setState({...t.state,inputTemporaryValue:String(s.value)})},this.scheduleMeasurement=(e,t)=>{this.animationFrame=requestAnimationFrame(this.measureOriginRect(t))},this.measureOriginRect=e=>t=>{const{componentStore:s}=this.stores;if(!this.origin)return;if(!this.origin.current)return;const n=e?e(s.state):s.state;s.setState({...n,popupOriginRect:this.origin.current.getBoundingClientRect()})},this.isMenuOpen=()=>{const{componentStore:{state:e}}=this.stores;return e.isMenuOpen},this.clearInput=()=>{const{componentStore:e}=this.stores;e.setState({...e.state,inputTemporaryValue:"",indexToReplace:void 0})}}didMount(){window.addEventListener("resize",this.scheduleMeasurement)}willUnmount(){window.removeEventListener("resize",this.scheduleMeasurement),this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0)}didUpdate(e){(e.items.length!==this.props.items.length||e.mode!==this.props.mode)&&this.scheduleMeasurement()}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,disabled:s}=this.props,{componentStore:{state:n}}=this.stores,i=s||n.isMenuOpen;let r;const o=(()=>e===z.Section?(r=t,this.renderSectionOrigin()):e===z.Button?this.renderButtonOrigin():e===z.Pill?this.renderPillOrigin():void(0,a.t1)(e))();return(0,F.jsxs)(y.Z,{title:r,marginAfter:e===z.Section,style:K(this.environment,this.props.mode).sectionMenuItem,children:[e!==z.Pill&&this.renderFilters({disableFilters:i,showLabel:!1}),o,(0,F.jsx)(f.ZP,{popupType:f.ZP.PopupType.Popup,placementToOrigin:f.ZP.Placement.Bottom,alignmentToOrigin:f.ZP.Alignment.Start,open:this.isMenuOpen(),originRect:n.popupOriginRect,render:()=>this.renderMenu(),onDismiss:this.handleMenuClose,keepFocus:!0,preventScaleTransition:!0})]})}renderButtonOrigin(){const{icon:e,title:t,disabled:s,focused:n}=this.props,i=K(this.environment,this.props.mode),r=q(this.theme),o={...i.menuItem,...r.buttonMenuItem};return(0,F.jsx)("div",{ref:this.origin,style:i.menuItemWrapper,children:(0,F.jsx)(h.Z,{disabled:s||this.isMenuOpen(),icon:e(i.icon),title:t,focused:n,onClick:e=>this.handleMenuOpen(),style:o})})}renderPillOrigin(){const{icon:e,title:t,disabled:s,iconStyles:n}=this.props,i=K(this.environment,this.props.mode),r=this.props.mode===z.Pill&&this.props.hasItemsSelected;return(0,F.jsx)("div",{ref:this.origin,style:i.menuItemWrapper,children:(0,F.jsx)(m.Z,{on:r,icon:e({...i.icon,...n}),title:(0,F.jsx)("span",{children:t}),onClick:e=>this.handleMenuOpen(),wrapStyle:{opacity:s?.4:1}})})}renderSectionOrigin(){const{addItemLabel:e,disabled:t}=this.props,s=K(this.environment,this.props.mode),i=q(this.theme);return(0,F.jsxs)(n.Fragment,{children:[(0,F.jsx)("div",{ref:this.origin,style:s.menuItemWrapper}),(0,F.jsx)(h.Z,{disabled:t||this.isMenuOpen(),icon:(0,r.R)(s.iconSmall),title:e,focused:!1,onClick:e=>this.handleMenuOpen(),style:{...s.appendListItemButton,...i.appendListItemButton}})]})}renderMobile(e){const{disabled:t}=this.props,s=t||this.isMenuOpen(),n=e===z.Section?this.renderMobileFilterSummary({disableFilters:s}):this.renderMobileButtonOrigin({disableFilters:s});return(0,F.jsx)(f.ZP,{popupType:f.ZP.PopupType.SlideUp,open:this.isMenuOpen(),origin:n,render:this.renderMenu,onDismiss:this.handleMenuClose,keepFocus:!0})}renderMobileButtonOrigin(e){const{icon:t,title:s}=this.props,n=K(this.environment,this.props.mode);return(0,F.jsx)(h.Z,{disabled:e.disableFilters,focused:!1,icon:t({...n.icon}),title:s,onClick:e=>this.handleMenuOpenMobile()})}renderFilters(e){const{items:t,renderFilter:s}=this.props,{device:n}=this.environment,i=t.map(((t,i)=>(0,F.jsx)("li",{children:s(t,{disabled:e.disableFilters,onRemove:()=>H(t,this.props.items,this.props.onChange),onClick:()=>n.isMobile?this.handleMenuOpenMobile():this.handleMenuOpen(i)})},`${t}_${i}`)));return(0,F.jsx)("ul",{style:d.mK,children:i})}}D.displayName="SearchTokenFilter";const N=D;function U(e,t,s){s(t.filter((t=>t!==e)))}function W(e){e([])}function q(e){return{buttonMenuItem:{color:e.mediumTextColor},appendListItemButton:{color:e.lightTextColor}}}function H(e,t,s){U(e,t,s)}function K(e,t){return{menuItem:{minHeight:void 0,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},menuItemWrapper:{display:"flex"},sectionMenuItem:{display:"flex"},appendListItemButton:{minHeight:void 0,paddingTop:4,paddingBottom:4,fontSize:d.yv(e,"UIRegular")},icon:{height:16,width:16,marginRight:"Pill"===t?6:-2,fill:"currentColor"},iconSmall:{height:12,width:12},summary:{display:"inline"},summaryItem:{display:"inline"}}}},75689:(e,t,s)=>{s.d(t,{Z:()=>p});s(67294);var n=s(83355),i=s(82990),r=s(52275),o=s(24006),a=s(255),l=s(85893);class d extends n.Z{renderComponent(){const{disabled:e,label:t,title:s,onClick:n,isToggle:i,...o}=this.props,a={menuItemLabel:{color:this.theme.lightTextColor}};const d=c(this.environment),p=(0,l.jsx)("span",{style:a.menuItemLabel,children:t});return(0,l.jsx)(r.Z,{focused:!1,...o,inline:i,disabled:e,icon:p,title:s,right:this.renderRight(),onClick:n,dontShrinkIcon:!0,dontShrinkRight:!0,shouldWrapTitle:!0,style:d.menuItem,desktopIconStyle:d.menuItemLabel})}renderRight(){const{disabled:e}=this.props,t=c(this.environment).rightWrapper;return this.props.isToggle?(0,l.jsx)("div",{style:t,children:(0,l.jsx)(o.Z,{on:this.props.isToggleActive,onClick:this.props.onClick})}):(0,l.jsx)(a.Z,{disabled:e,onClick:this.props.onClickClear})}}d.displayName="SearchFilterSummaryMenuItem";const p=d;function c(e){return{menuItem:{background:void 0,minHeight:void 0,fontSize:e.device.isMobile?i.Z.fontSize.UISmall.mobile:i.Z.fontSize.UIRegular.desktop,paddingTop:e.device.isMobile?12:4,paddingBottom:e.device.isMobile?12:4},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginTop:0},rightWrapper:{display:"flex",alignItems:"center",marginTop:"-50%",marginBottom:"-50%",height:44}}}},91642:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var n=s(72495),i=s(85893);const r=function(e){const t={desktopTitleStyle:{marginBottom:4},marginAfter:{marginBottom:16}},{title:s,marginAfter:r,desktopStyle:o,desktopTitleStyle:a,...l}=e,d=(r||o)&&{...r&&t.marginAfter,...o},p=a?{...t.desktopTitleStyle,...a}:t.desktopTitleStyle;return(0,i.jsx)(n.Z,{isTitleUppercase:!0,disableDesktopPadding:!0,enableActionSheetTitle:!0,desktopStyle:d,desktopTitleStyle:p,shouldShowBottomDivider:!1,title:s,...l})}},25976:(e,t,s)=>{s.d(t,{Z:()=>r});var n=s(49085);class i extends n.default{getInitialState(){return{count:0}}}const r=new i},71071:(e,t,s)=>{s.d(t,{Sw:()=>o,ZP:()=>d,jR:()=>a});var n=s(13991),i=s(49085);const r=["en","en-us","en-ca"];function o(e){return"pdf"===e.exportOptions.exportType}function a(){return r.includes(n.SP.toLowerCase())?"Letter":"A4"}class l extends i.default{getInitialState(){return{open:!1,shouldExportComments:!1}}}const d=new l}}]);